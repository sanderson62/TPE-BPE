* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page   1
* EL131.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL131.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page   2
* EL131.cbl
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28******************************************************************
    29
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page   3
* EL131.cbl
    31 ENVIRONMENT DIVISION.
    32
    33 DATA DIVISION.
    34
    35 WORKING-STORAGE SECTION.
    36 01  DFH-START PIC X(04).
    37 01  LCP-TIME-OF-DAY-XX.
    38     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    39     05  FILLER                    PIC 99.
    40 01  LCP-CICS-TIME                 PIC 9(15).
    41
    42 77  FILLER  PIC X(32)  VALUE '********************************'.
    43 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    44 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    45
    46*                            COPY ELCSCTM.
    47******************************************************************
    48*                                                                *
    49*                                                                *
    50*                            ELCSCTM                             *
    51*                            VMOD=2.001                          *
    52*                                                                *
    53*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    54*                                                                *
    55******************************************************************
    56 01  SECURITY-MESSAGE.
    57     12  FILLER                          PIC X(30)
    58            VALUE '** LOGIC SECURITY VIOLATION -'.
    59     12  SM-READ                         PIC X(6).
    60     12  FILLER                          PIC X(5)
    61            VALUE ' PGM='.
    62     12  SM-PGM                          PIC X(6).
    63     12  FILLER                          PIC X(5)
    64            VALUE ' OPR='.
    65     12  SM-PROCESSOR-ID                 PIC X(4).
    66     12  FILLER                          PIC X(6)
    67            VALUE ' TERM='.
    68     12  SM-TERMID                       PIC X(4).
    69     12  FILLER                          PIC XX   VALUE SPACE.
    70     12  SM-JUL-DATE                     PIC 9(5).
    71     12  FILLER                          PIC X    VALUE SPACE.
    72     12  SM-TIME                         PIC 99.99.
    73
    74
    75*                            COPY ELCSCRTY.
    76******************************************************************
    77*                                                                *
    78*                                                                *
    79*                            ELCSCRTY                            *
    80*                            VMOD=2.001                          *
    81*                                                                *
    82*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    83*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    84*        SAVED IN PI-SECURITY-ADDRESS.                           *
    85*                                                                *
    86******************************************************************
    87 01  SECURITY-CONTROL.
    88     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page   4
* EL131.cbl
    89     12  FILLER                       PIC XX    VALUE 'SC'.
    90     12  SC-CREDIT-CODES.
    91         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    92             20  SC-CREDIT-DISPLAY    PIC X.
    93             20  SC-CREDIT-UPDATE     PIC X.
    94     12  SC-CLAIMS-CODES.
    95         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    96             20  SC-CLAIMS-DISPLAY    PIC X.
    97             20  SC-CLAIMS-UPDATE     PIC X.
    98
    99*                            COPY ELCNWA.
   100*****************************************************************
   101*                                                               *
   102*                                                               *
   103*                            ELCNWA.                            *
   104*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   105*                            VMOD=2.003                         *
   106*                                                               *
   107*            M O V E   N A M E   W O R K   A R E A.             *
   108*                                                               *
   109*****************************************************************.
   110
   111 01  WS-NAME-WORK-AREA.
   112     05  WS-INSURED-LAST-NAME        PIC X(15).
   113     05  WS-INSURED-1ST-NAME         PIC X(12).
   114     05  WS-INSURED-MID-INIT         PIC X.
   115
   116     05  WS-NAME-WORK.
   117         10  WS-NW                   PIC X
   118             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   119
   120     05  WS-NAME-WORK2.
   121         10  WS-NW2                  PIC X
   122             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   123                                        NWA-INDEX0.
   124
   125     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   126                                     COMP-3.
   127
   128
   129 01  WS-DATE-AREA.
   130     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   131     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   132     12  SAVE-DATE-CCYYMMDD.
   133         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   134         16  SAVE-DATE-YMD.
   135             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   136             20  FILLER         PIC X(4)    VALUE SPACES.
   137
   138 01  WS-BLANK                   PIC X       VALUE ' '.
   139
   140 01  CSO-WORK-FIELDS.
   141     05  WS-HOLD-CLAIM-STATUS    PIC X.
   142
   143 01  LITERALS-NUMBERS.
   144     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   145     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   146     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page   5
* EL131.cbl
   147     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   148     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   149     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   150     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   151
   152     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   153     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   154     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   155     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   156     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   157     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   158     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   159     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   160     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   161
   162     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   163
   164     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   165
   166     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   167     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   168     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   169     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   170     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   171     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   172     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   173     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   174     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   175     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   176     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   177
   178     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   179     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   180     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   181     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   182         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   183     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   184     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   185     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   186     12  WS-CLAIM-SEQU.
   187         16  FILLER              PIC X VALUE '('.
   188         16  WS-CURRENT-SEQU     PIC Z9.
   189         16  FILLER              PIC X(04) VALUE ' OF '.
   190         16  WS-OF-SEQU          PIC Z9.
   191         16  FILLER              PIC X VALUE ')'.
   192     12  WS-EDIT-BEN-CODE        PIC XX.
   193         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   194                                          '90' THRU '99'.
   195
   196     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   197     12  WS-EDIT-NUMBER          PIC ZZZ9.
   198
   199     12  WS-RESPONSE             PIC S9(8)   COMP.
   200         88  WS-RESP-NORMAL                  VALUE +00.
   201         88  WS-RESP-NOTFND                  VALUE +13.
   202
   203     12  WS-MOS-PAID             PIC 999.
   204     12  WS-ODD-DAYS             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page   6
* EL131.cbl
   205     12  WS-REM-MOS              PIC 999.
   206     12  WS-REM-DAYS             PIC 99.
   207     12  WS-TERM-IN-DAYS         PIC 9(4).
   208     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   209
   210     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   211     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   212     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   213     12  WS-RESET-SW             PIC X       VALUE 'N'.
   214     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   215     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   216     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   217
   218 01  DMD-DATE-YYYYMMDD.
   219     12  DMD-DECADE          PIC XX      VALUE SPACES.
   220     12  DMD-YYMMDD.
   221         16  DMD-YY          PIC XX      VALUE SPACES.
   222         16  DMD-MM          PIC XX      VALUE SPACES.
   223         16  DMD-DD          PIC XX      VALUE SPACES.
   224
   225 01  DMD-DATE-MMDDYYYY.
   226     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   227     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   228     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   229     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   230     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   231     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   232
   233 01  WS-MAIL-CODE.
   234     12  FILLER              PIC X.
   235     12  DMD-MAIL-CODE.
   236         16  WS-MAIL-4       PIC X(4).
   237         16  WS-MAIL-5       PIC X.
   238     12  FILLER              PIC X(4).
   239
   240     12  W-NAME-LAST             PIC  X(15).
   241     12  W-NAME-FIRST            PIC  X(15).
   242     12  W-NAME-MIDDLE.
   243         16  FILLER              PIC  X.
   244         16  W-NAME-MIDDLE-2     PIC  X.
   245         16  FILLER              PIC  X(13).
   246
   247*    COPY ELCDCTB.
   248******************************************************************
   249*                                                                *
   250*                                                                *
   251*                            ELCDCTB.                            *
   252*                            VMOD=2.002                          *
   253*                                                                *
   254*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   255*       COMMUNICATIONS AREA                                      *
   256*                                                                *
   257******************************************************************
   258 01  DCT-COMMUNICATION-AREA.
   259     12  DCT-BILLING-BANK-ID      PIC  X(05).
   260     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   261     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   262     12  DCT-PRODUCT-CODE         PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page   7
* EL131.cbl
   263     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   264     12  DCT-RETURN-CODE          PIC  X(02).
   265     12  DCT-MAIL-CODE            PIC  X(05).
   266     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   267     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page   8
* EL131.cbl
   269 01  ERROR-SWITCHES.
   270     12  ERROR-SWITCH            PIC X.
   271         88  SCREEN-ERROR                    VALUE 'X'.
   272     12  MSTR-KEY-SWITCH         PIC X.
   273         88  MSTR-KEY-CHANGED                VALUE 'X'.
   274     12  CERT-KEY-SWITCH         PIC X.
   275*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   276         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   277*********SET TO Y IF PRIMARY KEY WILL CHANGE
   278         88  CERT-KEY-CHANGED                VALUE 'Y'.
   279     12  MSTR-SWITCH             PIC X.
   280         88  MSTR-UPDATES                    VALUE 'X'.
   281     12  CERT-SWITCH             PIC X.
   282         88  CERT-UPDATES                    VALUE 'X'.
   283     12  UPDATE-SWITCH           PIC X.
   284         88  UPDATES-PRESENT                 VALUE 'X'.
   285     12  TRLR-SWITCH             PIC X.
   286         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   287         88  UPDATE-MADE                     VALUE 'Y'.
   288     12  NINETY-TRLR-SWITCH      PIC X.
   289         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   290     12  EARNINGS-CALC-SWITCH    PIC X.
   291         88  TEX-REG                         VALUE '4'.
   292         88  NET-PAY                         VALUE '5'.
   293     12  DLYACTV-SW              PIC X       VALUE 'N'.
   294         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page   9
* EL131.cbl
   296 01  EDIT-WORK-AREA.
   297     12  COUNT-2                 PIC 9.
   298     12  CALL-PGM                PIC X(8).
   299     12  TRANS-ID                PIC X(4).
   300     12  CHECK-PFKEYS            PIC 99.
   301     12  CHECK-MAINT             PIC X.
   302         88  ADD-ALPHA-RECORD                VALUE 'A'.
   303         88  CHANGE-CLAIM                    VALUE 'C'.
   304         88  DELETE-CLAIM                    VALUE 'D'.
   305         88  CHANGE-NAME                     VALUE 'N'.
   306         88  VALID-OPTIONS                   VALUE 'A' 'C'
   307                                                   'D' 'N'.
   308
   309     12  HOLD-BENEFIT            PIC XX.
   310     12  HOLD-FREQ               PIC XX.
   311     12  HOLD-REPORTED           PIC XX.
   312     12  HOLD-INCUR              PIC XX.
   313     12  HOLD-PDTHRU             PIC XX.
   314     12  HOLD-ADDON              PIC XX.
   315     12  HOLD-NODAYS             PIC 9(4).
   316     12  HOLD-NOPMTS             PIC 9(3).
   317     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   318     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   319     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   320     12  HOLD-BIRTH              PIC XX.
   321     12  HOLD-END                PIC XX.
   322     12  HOLD-EFF                PIC XX.
   323     12  HOLD-ENTRY              PIC XX.
   324     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   325     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   326     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   327     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   328     12  HOLD-LF-CV-CAN          PIC XX.
   329     12  HOLD-AH-CV-CAN          PIC XX.
   330     12  DIVIDE-QUOT             PIC 9(3).
   331     12  DIVIDE-REM              PIC 9(3).
   332
   333     12  WS-ALPHA-DATE.
   334         16  WS-ALPHA-YEAR.
   335             20  WS-ALPHA-YY-1   PIC 99.
   336             20  WS-ALPHA-YY-2   PIC 99.
   337         16  WS-ALPHA-MM         PIC 99.
   338         16  WS-ALPHA-DD         PIC 99.
   339
   340     12  BUILD-VALID-DATE.
   341         16  BUILD-MONTH         PIC 99.
   342         16  BUILD-DAY           PIC 99.
   343         16  BUILD-YEAR          PIC 99.
   344     12  DEEDIT-MMYY-INPUT.
   345         16  FILLER              PIC X.
   346         16  DEEDIT-MONTH        PIC XX.
   347         16  DEEDIT-YEAR         PIC XX.
   348     12  DEEDIT-BEN              PIC 9(9)V99.
   349     12  DEEDIT-DATE-INPUT.
   350         16  FILLER              PIC XX.
   351         16  DEEDIT-DATE         PIC X(6).
   352     12  WORK-DATE-MDY.
   353         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  10
* EL131.cbl
   354         16  FILLER              PIC X(4).
   355         16  YEAR-WORK           PIC XX.
   356     12  WORK-DATE-MY.
   357         16  WORK-MONTH          PIC XX.
   358         16  WORK-SLASH          PIC X       VALUE '/'.
   359         16  WORK-YEAR           PIC XX.
   360     12  HOLD-DATE.
   361         16  HOLD-MONTH          PIC 99.
   362         16  FILLER              PIC X(4).
   363         16  HOLD-YEAR           PIC 99.
   364     12  SPLIT-INFO-LINE-1.
   365         16  SPLIT-INFO-DESC     PIC X(15).
   366         16  FILLER              PIC X(5)    VALUE ' OLD='.
   367         16  SPLIT-INFO-OLD      PIC X(40).
   368     12  EFF-TERM-MO             PIC 9(4).
   369     12  CURR-MO                 PIC 9(4).
   370     12  WS-BIN-CURRENT-DT       PIC XX.
   371     12  WS-CALC-METHOD          PIC X.
   372     12  WS-INITIALS.
   373         16  WS-INIT-1           PIC X.
   374         16  WS-INIT-2           PIC X.
   375     12  WS-REIN-TABLE.
   376         16  WS-REIN-1           PIC X.
   377         16  WS-REIN-2           PIC X.
   378         16  WS-REIN-3           PIC X.
   379     12  PI-KEY.
   380         16  PI-TERM             PIC X(4).
   381         16  PI-QUAL             PIC X(4).
   382     12  CHECK-KEY               PIC X(20).
   383     12  SAVE-ACCT-KEY           PIC X(20).
   384     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   385     12  WS-SOC-SEC-NUMBER.
   386         16  WS-SOC-SEC-NO       PIC 9(9).
   387         16  WS-SOC-SEC-BLANK    PIC X(2).
   388     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   389         16  WS-SSN-1-3          PIC 9(3).
   390         16  WS-SSN-DASH1        PIC X(1).
   391         16  WS-SSN-4-5          PIC 9(2).
   392         16  WS-SSN-DASH2        PIC X(1).
   393         16  WS-SSN-6-9          PIC 9(4).
   394
   395 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   396     12  M                   PIC S9(7)V99           VALUE ZEROS.
   397     12  L                   PIC S9(7)V99           VALUE ZEROS.
   398     12  N                   PIC S9(3)              VALUE ZEROS.
   399     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   400     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   401     12  I                   PIC S99V9(5)           VALUE ZEROS.
   402     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   403     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   404     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   405     12  R                   PIC S9(3)              VALUE ZEROS.
   406     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   407     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   408     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   409     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   410     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   411     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  11
* EL131.cbl
   412     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   413     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   414     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   415
   416 01  TERM-CALC-WORK-AREA.
   417     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   418     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   419     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   420     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   421     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   422     12  V-EXPONENTS.
   423        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   424     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   425
   426 01  TIME-IN.
   427     12  UN-HOURS                PIC XX.
   428     12  UN-MINUTES              PIC XX.
   429     12  FILLER                  PIC XX.
   430
   431 01  TIME-OUT.
   432     12  FOR-HOURS               PIC XX.
   433     12  FILLER                  PIC X       VALUE '.'.
   434     12  FOR-MINUTES             PIC XX.
   435
   436 01  ERROR-NUMBERS.
   437     12  ER-0000                 PIC X(4)    VALUE '0000'.
   438     12  ER-0004                 PIC X(4)    VALUE '0004'.
   439     12  ER-0008                 PIC X(4)    VALUE '0008'.
   440     12  ER-0023                 PIC X(4)    VALUE '0023'.
   441     12  ER-0029                 PIC X(4)    VALUE '0029'.
   442     12  ER-0068                 PIC X(4)    VALUE '0068'.
   443     12  ER-0070                 PIC X(4)    VALUE '0070'.
   444     12  ER-0149                 PIC X(4)    VALUE '0149'.
   445     12  ER-0154                 PIC X(4)    VALUE '0154'.
   446     12  ER-0169                 PIC X(4)    VALUE '0169'.
   447     12  ER-0192                 PIC X(4)    VALUE '0192'.
   448     12  ER-0199                 PIC X(4)    VALUE '0199'.
   449     12  ER-0203                 PIC X(4)    VALUE '0203'.
   450     12  ER-0204                 PIC X(4)    VALUE '0204'.
   451     12  ER-0205                 PIC X(4)    VALUE '0205'.
   452     12  ER-0206                 PIC X(4)    VALUE '0206'.
   453     12  ER-0208                 PIC X(4)    VALUE '0208'.
   454     12  ER-0210                 PIC X(4)    VALUE '0210'.
   455     12  ER-0215                 PIC X(4)    VALUE '0215'.
   456     12  ER-0219                 PIC X(4)    VALUE '0219'.
   457     12  ER-0220                 PIC X(4)    VALUE '0220'.
   458     12  ER-0222                 PIC X(4)    VALUE '0222'.
   459     12  ER-0223                 PIC X(4)    VALUE '0223'.
   460     12  ER-0224                 PIC X(4)    VALUE '0224'.
   461     12  ER-0227                 PIC X(4)    VALUE '0227'.
   462     12  ER-0230                 PIC X(4)    VALUE '0230'.
   463     12  ER-0232                 PIC X(4)    VALUE '0232'.
   464     12  ER-0233                 PIC X(4)    VALUE '0233'.
   465     12  ER-0236                 PIC X(4)    VALUE '0236'.
   466     12  ER-0237                 PIC X(4)    VALUE '0237'.
   467     12  ER-0238                 PIC X(4)    VALUE '0238'.
   468     12  ER-0240                 PIC X(4)    VALUE '0240'.
   469     12  ER-0241                 PIC X(4)    VALUE '0241'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  12
* EL131.cbl
   470     12  ER-0243                 PIC X(4)    VALUE '0243'.
   471     12  ER-0244                 PIC X(4)    VALUE '0244'.
   472     12  ER-0246                 PIC X(4)    VALUE '0246'.
   473     12  ER-0247                 PIC X(4)    VALUE '0247'.
   474     12  ER-0248                 PIC X(4)    VALUE '0248'.
   475     12  ER-0250                 PIC X(4)    VALUE '0250'.
   476     12  ER-0251                 PIC X(4)    VALUE '0251'.
   477     12  ER-0253                 PIC X(4)    VALUE '0253'.
   478     12  ER-0256                 PIC X(4)    VALUE '0256'.
   479     12  ER-0257                 PIC X(4)    VALUE '0257'.
   480     12  ER-0258                 PIC X(4)    VALUE '0258'.
   481     12  ER-0259                 PIC X(4)    VALUE '0259'.
   482     12  ER-0260                 PIC X(4)    VALUE '0260'.
   483     12  ER-0261                 PIC X(4)    VALUE '0261'.
   484     12  ER-0262                 PIC X(4)    VALUE '0262'.
   485     12  ER-0263                 PIC X(4)    VALUE '0263'.
   486     12  ER-0273                 PIC X(4)    VALUE '0273'.
   487     12  ER-0274                 PIC X(4)    VALUE '0274'.
   488     12  ER-0276                 PIC X(4)    VALUE '0276'.
   489     12  ER-0282                 PIC X(4)    VALUE '0282'.
   490     12  ER-0283                 PIC X(4)    VALUE '0283'.
   491     12  ER-0309                 PIC X(4)    VALUE '0309'.
   492     12  ER-0310                 PIC X(4)    VALUE '0310'.
   493     12  ER-0311                 PIC X(4)    VALUE '0311'.
   494     12  ER-0333                 PIC X(4)    VALUE '0333'.
   495     12  ER-0360                 PIC X(4)    VALUE '0360'.
   496     12  ER-0377                 PIC X(4)    VALUE '0377'.
   497     12  ER-0402                 PIC X(4)    VALUE '0402'.
   498     12  ER-0416                 PIC X(4)    VALUE '0416'.
   499     12  ER-0426                 PIC X(4)    VALUE '0426'.
   500     12  ER-0427                 PIC X(4)    VALUE '0427'.
   501     12  ER-0428                 PIC X(4)    VALUE '0428'.
   502     12  ER-0429                 PIC X(4)    VALUE '0429'.
   503     12  ER-0430                 PIC X(4)    VALUE '0430'.
   504     12  ER-0475                 PIC X(4)    VALUE '0475'.
   505     12  ER-0491                 PIC X(4)    VALUE '0491'.
   506     12  ER-0509                 PIC X(4)    VALUE '0509'.
   507     12  ER-0510                 PIC X(4)    VALUE '0510'.
   508     12  ER-0519                 PIC X(4)    VALUE '0519'.
   509     12  ER-0520                 PIC X(4)    VALUE '0520'.
   510     12  ER-0521                 PIC X(4)    VALUE '0521'.
   511     12  ER-0547                 PIC X(4)    VALUE '0547'.
   512     12  ER-0548                 PIC X(4)    VALUE '0548'.
   513     12  ER-0549                 PIC X(4)    VALUE '0549'.
   514     12  ER-0565                 PIC X(4)    VALUE '0565'.
   515     12  ER-0598                 PIC X(4)    VALUE '0598'.
   516     12  ER-0639                 PIC X(4)    VALUE '0639'.
   517     12  ER-0797                 PIC X(4)    VALUE '0797'.
   518     12  ER-0802                 PIC X(4)    VALUE '0802'.
   519     12  ER-0803                 PIC X(4)    VALUE '0803'.
   520     12  ER-0849                 PIC X(4)    VALUE '0849'.
   521     12  ER-0885                 PIC X(4)    VALUE '0885'.
   522     12  ER-0887                 PIC X(4)    VALUE '0887'.
   523     12  ER-0919                 PIC X(4)    VALUE '0919'.
   524     12  ER-0921                 PIC X(4)    VALUE '0921'.
   525     12  ER-0938                 PIC X(4)    VALUE '0938'.
   526     12  ER-0946                 PIC X(4)    VALUE '0946'.
   527     12  ER-0947                 PIC X(4)    VALUE '0947'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  13
* EL131.cbl
   528     12  ER-0948                 PIC X(4)    VALUE '0948'.
   529     12  ER-0949                 PIC X(4)    VALUE '0949'.
   530     12  ER-0950                 PIC X(4)    VALUE '0950'.
   531     12  ER-0951                 PIC X(4)    VALUE '0951'.
   532     12  ER-0954                 PIC X(4)    VALUE '0954'.
   533     12  ER-0974                 PIC X(4)    VALUE '0974'.
   534     12  ER-0975                 PIC X(4)    VALUE '0975'.
   535     12  ER-2280                 PIC X(4)    VALUE '2280'.
   536     12  ER-2878                 PIC X(4)    VALUE '2878'.
   537     12  ER-7641                 PIC X(4)    VALUE '7641'.
   538     12  ER-7642                 PIC X(4)    VALUE '7642'.
   539     12  ER-7650                 PIC X(4)    VALUE '7650'.
   540     12  ER-7651                 PIC X(4)    VALUE '7651'.
   541     12  ER-7687                 PIC X(4)    VALUE '7687'.
   542     12  ER-7689                 PIC X(4)    VALUE '7689'.
   543     12  ER-7690                 PIC X(4)    VALUE '7690'.
   544     12  ER-7691                 PIC X(4)    VALUE '7691'.
   545     12  ER-8003                 PIC X(4)    VALUE '8003'.
   546     12  ER-8051                 PIC X(4)    VALUE '8051'.
   547     12  ER-8052                 PIC X(4)    VALUE '8052'.
   548     12  ER-8053                 PIC X(4)    VALUE '8053'.
   549     12  ER-8054                 PIC X(4)    VALUE '8054'.
   550     12  ER-8055                 PIC X(4)    VALUE '8055'.
   551     12  ER-8056                 PIC X(4)    VALUE '8056'.
   552     12  ER-8057                 PIC X(4)    VALUE '8057'.
   553     12  ER-8058                 PIC X(4)    VALUE '8058'.
   554     12  ER-8059                 PIC X(4)    VALUE '8059'.
   555     12  ER-8060                 PIC X(4)    VALUE '8060'.
   556     12  ER-8061                 PIC X(4)    VALUE '8061'.
   557     12  ER-8062                 PIC X(4)    VALUE '8062'.
   558     12  ER-8063                 PIC X(4)    VALUE '8063'.
   559     12  ER-8064                 PIC X(4)    VALUE '8064'.
   560     12  ER-8065                 PIC X(4)    VALUE '8065'.
   561     12  ER-8066                 PIC X(4)    VALUE '8066'.
   562     12  ER-8152                 PIC X(4)    VALUE '8152'.
   563     12  ER-8153                 PIC X(4)    VALUE '8153'.
   564     12  ER-8154                 PIC X(4)    VALUE '8154'.
   565     12  ER-8155                 PIC X(4)    VALUE '8155'.
   566
   567 01  MSTR-KEY.
   568     12  COMPANY-CODE            PIC X.
   569     12  CARRIER-CODE            PIC X.
   570     12  CLAIM-NO                PIC X(7).
   571     12  CERT-NO.
   572         16  CERT-NO-PRIME       PIC X(10).
   573         16  CERT-NO-SUFX        PIC X.
   574
   575 01  WS-SAVE-CLAIM-KEY.
   576     12  WS-SAVE-COMPANY-CD      PIC X.
   577     12  WS-SAVE-CARRIER         PIC X.
   578     12  WS-SAVE-CLAIM-NO        PIC X(7).
   579     12  WS-SAVE-CERT-NO.
   580         16  WS-CERT-NO-PRIME    PIC X(10).
   581         16  WS-CERT-NO-SUFX     PIC X.
   582
   583 01  CERT-KEY.
   584     12  CERT-COMPANY-CODE       PIC X.
   585     12  CERT-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  14
* EL131.cbl
   586     12  CERT-GROUP              PIC X(6).
   587     12  CERT-STATE              PIC XX.
   588     12  CERT-ACCOUNT            PIC X(10).
   589     12  CERT-DATE               PIC XX.
   590     12  CERT-CERT.
   591         16  CERT-CERT-PRIME     PIC X(10).
   592         16  CERT-CERT-SUFX      PIC X.
   593
   594 01  NOTE-KEY.
   595     12  NOTE-COMP-CD            PIC X.
   596     12  NOTE-CERT-KEY.
   597         16  NOTE-CARRIER        PIC X.
   598         16  NOTE-GROUP          PIC X(6).
   599         16  NOTE-STATE          PIC XX.
   600         16  NOTE-ACCOUNT        PIC X(10).
   601         16  NOTE-DATE           PIC XX.
   602         16  NOTE-CERT-NO        PIC X(11).
   603
   604 01  TRLR-KEY.
   605     12  TRLR-MAIN-KEY.
   606         16  TRLR-COMPANY-CD     PIC X.
   607         16  TRLR-CARRIER        PIC X.
   608         16  TRLR-CLAIM-NO       PIC X(07).
   609         16  TRLR-CERT-NO        PIC X(11).
   610     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   611
   612 01  BENEFIT-KEY.
   613     12  BEN-CO-ID               PIC X(3).
   614     12  BEN-REC-TYPE            PIC X.
   615     12  FILLER                  PIC XX.
   616     12  BEN-ACC-CD              PIC XX.
   617     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   618
   619 01  CNTL-KEY.
   620     12  CNTL-CO-ID              PIC X(3).
   621     12  CNTL-REC-TYPE           PIC X.
   622     12  CNTL-PROC-ID            PIC X(4).
   623     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   624         16  CNTL-STATE-NUMBER   PIC XX.
   625         16  FILLER              PIC XX.
   626     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   627         16  FILLER              PIC X(3).
   628         16  CNTL-CARRIER        PIC X.
   629     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   630
   631 01  ACTQ-KEY                    PIC X(20).
   632
   633 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   634
   635 01  CHKQ-KEY.
   636     12  CHKQ-COMPANY-CODE       PIC X.
   637     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   638     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   639
   640 01  ARCH-KEY.
   641     12  ARCH-COMPANY-CODE       PIC X.
   642     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   643     12  ARCH-RECORD-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  15
* EL131.cbl
   644     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   645
   646 01  ACCT-KEY.
   647     05  ACCT-PARTIAL-KEY.
   648         12  ACCT-COMPANY-CODE   PIC X.
   649         12  ACCT-CARRIER        PIC X.
   650         12  ACCT-GROUP          PIC X(6).
   651         12  ACCT-STATE          PIC XX.
   652         12  ACCT-ACCOUNT        PIC X(10).
   653     05  ACCT-DATE               PIC XX.
   654
   655 01  WS-ELBENE-KEY.
   656     12  WS-ELBENE-COMPANY-CD    PIC X.
   657     12  WS-ELBENE-RECORD-TYPE   PIC X.
   658     12  WS-ELBENE-ID            PIC X(10).
   659
   660 01  ELALPH-KEY.
   661     12  ELALPH-COMPANY-CD       PIC X.
   662     12  ELALPH-SOURCE           PIC X.
   663     12  ELALPH-NAME.
   664         16  ELALPH-LAST-NAME    PIC X(15).
   665         16  ELALPH-FIRST-NAME.
   666             20  ELALPH-FIRST-INIT   PIC X.
   667             20  FILLER              PIC X(11).
   668         16  ELALPH-MIDDLE-INIT  PIC X.
   669     12  ELALPH-DATE             PIC X(08).
   670     12  ELALPH-TIME             PIC S9(04)    COMP.
   671
   672 01  COMP-LENGTHS.
   673     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   674     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   675     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   676     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   677     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   678     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   679     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   680     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   681     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   682     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   683     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   684     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   685     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   686     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  16
* EL131.cbl
   688*                                COPY ELCLNKLT.
   689******************************************************************
   690*                                                                *
   691*                                                                *
   692*                           ELCLNKLT                             *
   693*                            VMOD=2.003                          *
   694*                                                                *
   695*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   696*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   697*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   698*                                                                *
   699*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   700*   COMPLETING THE REQUIRED FIELDS.                              *
   701*                                                                *
   702*   THE CALLING PROGRAM SHOULD CHECK:                            *
   703*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   704*                              9999 INDICATES AN UNKNOWN ABEND   *
   705*                                   WAS DETECTED.                *
   706*                              ALL OTHER VALUES ARE NORMAL ERROR *
   707*                              CODES FOUND IN THE ERROR FILE.    *
   708******************************************************************
   709 01  W-1523-LINKDATA.
   710     12  W-1523-COMMON-PI-DATA.
   711         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   712         16  FILLER              PIC  X(67).
   713         16  W-1523-COMPANY-CD   PIC  X(01).
   714         16  FILLER              PIC  X(10).
   715         16  W-1523-CONTROL-IN-PROGRESS.
   716             20  W-1523-CARRIER  PIC  X(01).
   717             20  W-1523-GROUPING PIC  X(06).
   718             20  W-1523-STATE    PIC  X(02).
   719             20  W-1523-ACCOUNT  PIC  X(10).
   720             20  W-1523-CLAIM-CERT-GRP.
   721                 24  W-1523-CLAIM-NO
   722                                 PIC  X(07).
   723                 24  W-1523-CERT-NO.
   724                     28  W-1523-CERT-PRIME
   725                                 PIC  X(10).
   726                     28  W-1523-CERT-SFX
   727                                 PIC  X(01).
   728                 24  W-1523-CERT-EFF-DT
   729                                 PIC  X(02).
   730         16  FILLER              PIC X(265).
   731
   732     12  W-1523-WORK-AREA.
   733         16  W-1523-FORM-NUMBER  PIC  X(04).
   734         16  W-1523-NUMBER-COPIES
   735                                 PIC  9(01).
   736         16  W-1523-ADDR-TYPE    PIC  X(02).
   737         16  W-1523-FOLLOW-UP-DATE
   738                                 PIC  X(02).
   739         16  W-1523-RESEND-DATE  PIC  X(02).
   740         16  W-1523-ERROR-CODE   PIC  9(04).
   741             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   742             88  W-1523-FATAL-ERROR
   743                                    VALUES  0006 0013 0042
   744                                            0154 0168 0169
   745                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  17
* EL131.cbl
   746                                            0179 0186 0281
   747                                            0332 2055 3697
   748                                            3698 3699 3770
   749                                            3771 3772 7675
   750                                            9106 9808 9883
   751                                            9887.
   752             88  W-1523-STOP-ERRORS
   753                                    VALUES  0013 0042 0154
   754                                            0168 0169 0172
   755                                            0281 0332 2055
   756                                            3698 3699 7675
   757                                            9106 9808 9883
   758                                            9999.
   759         16  W-1523-REASON       PIC  X(70).
   760         16  W-1523-ARCHIVE-NUMBER
   761                                 PIC  9(08).
   762     12  W-1523-POINTER-AREA.
   763         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   764         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   765         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   766         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   767         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  18
* EL131.cbl
   769*                                COPY ELCINTF.
   770******************************************************************
   771*                                                                *
   772*                                                                *
   773*                            ELCINTF.                            *
   774*                            VMOD=2.017                          *
   775*                                                                *
   776*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   777*                                                                *
   778*       LENGTH = 1024                                            *
   779*                                                                *
   780******************************************************************
   781 01  PROGRAM-INTERFACE-BLOCK.
   782     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   783     12  PI-CALLING-PROGRAM              PIC X(8).
   784     12  PI-SAVED-PROGRAM-1              PIC X(8).
   785     12  PI-SAVED-PROGRAM-2              PIC X(8).
   786     12  PI-SAVED-PROGRAM-3              PIC X(8).
   787     12  PI-SAVED-PROGRAM-4              PIC X(8).
   788     12  PI-SAVED-PROGRAM-5              PIC X(8).
   789     12  PI-SAVED-PROGRAM-6              PIC X(8).
   790     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   791     12  PI-COMPANY-ID                   PIC XXX.
   792     12  PI-COMPANY-CD                   PIC X.
   793
   794     12  PI-COMPANY-PASSWORD             PIC X(8).
   795
   796     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   797
   798     12  PI-CONTROL-IN-PROGRESS.
   799         16  PI-CARRIER                  PIC X.
   800         16  PI-GROUPING                 PIC X(6).
   801         16  PI-STATE                    PIC XX.
   802         16  PI-ACCOUNT                  PIC X(10).
   803         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   804                                         PIC X(10).
   805         16  PI-CLAIM-CERT-GRP.
   806             20  PI-CLAIM-NO             PIC X(7).
   807             20  PI-CERT-NO.
   808                 25  PI-CERT-PRIME       PIC X(10).
   809                 25  PI-CERT-SFX         PIC X.
   810             20  PI-CERT-EFF-DT          PIC XX.
   811         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   812             20  PI-PLAN-CODE            PIC X(2).
   813             20  PI-REVISION-NUMBER      PIC X(3).
   814             20  PI-PLAN-EFF-DT          PIC X(2).
   815             20  PI-PLAN-EXP-DT          PIC X(2).
   816             20  FILLER                  PIC X(11).
   817         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   818             20  PI-OE-REFERENCE-1.
   819                 25  PI-OE-REF-1-PRIME   PIC X(18).
   820                 25  PI-OE-REF-1-SUFF    PIC XX.
   821
   822     12  PI-SESSION-IN-PROGRESS          PIC X.
   823         88  CLAIM-SESSION                   VALUE '1'.
   824         88  CREDIT-SESSION                  VALUE '2'.
   825         88  WARRANTY-SESSION                VALUE '3'.
   826         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  19
* EL131.cbl
   827         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   828
   829
   830*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   831
   832     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   833     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   834
   835     12  PI-CREDIT-USER                  PIC X.
   836         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   837         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   838
   839     12  PI-CLAIM-USER                   PIC X.
   840         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   841         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   842
   843     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   844         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   845         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   846         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   847         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   848         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   849
   850     12  PI-PROCESSOR-ID                 PIC X(4).
   851
   852     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   853
   854     12  PI-MEMBER-CAPTION               PIC X(10).
   855
   856     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   857         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   858
   859     12  PI-LIFE-OVERRIDE-L1             PIC X.
   860     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   861     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   862     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   863
   864     12  PI-AH-OVERRIDE-L1               PIC X.
   865     12  PI-AH-OVERRIDE-L2               PIC XX.
   866     12  PI-AH-OVERRIDE-L6               PIC X(6).
   867     12  PI-AH-OVERRIDE-L12              PIC X(12).
   868
   869     12  PI-NEW-SYSTEM                   PIC X(2).
   870
   871     12  PI-PRIMARY-CERT-NO              PIC X(11).
   872     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   873         88  PI-USES-PAID-TO                 VALUE '1'.
   874     12  PI-CRDTCRD-SYSTEM.
   875         16  PI-CRDTCRD-USER             PIC X.
   876             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   877             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   878         16  PI-CC-MONTH-END-DT          PIC XX.
   879     12  PI-PROCESSOR-PRINTER            PIC X(4).
   880
   881     12  PI-OE-REFERENCE-2.
   882         16  PI-OE-REF-2-PRIME           PIC X(10).
   883         16  PI-OE-REF-2-SUFF            PIC X.
   884
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  20
* EL131.cbl
   885     12  PI-REM-TRM-CALC-OPTION          PIC X.
   886
   887     12  PI-LANGUAGE-TYPE                PIC X.
   888             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   889             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   890             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   891
   892     12  PI-POLICY-LINKAGE-IND           PIC X.
   893         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   894         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   895                                                   LOW-VALUES.
   896
   897     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   898     12  PI-CLAIM-PW-SESSION             PIC X(1).
   899         88  PI-CLAIM-CREDIT                 VALUE '1'.
   900         88  PI-CLAIM-CONVEN                 VALUE '2'.
   901     12  FILLER                          PIC X(4).
   902
   903     12  PI-SYSTEM-LEVEL                 PIC X(145).
   904
   905     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   906         PI-SYSTEM-LEVEL.
   907
   908         16  PI-ENTRY-CODES.
   909             20  PI-ENTRY-CD-1           PIC X.
   910             20  PI-ENTRY-CD-2           PIC X.
   911
   912         16  PI-RETURN-CODES.
   913             20  PI-RETURN-CD-1          PIC X.
   914             20  PI-RETURN-CD-2          PIC X.
   915
   916         16  PI-UPDATE-STATUS-SAVE.
   917             20  PI-UPDATE-BY            PIC X(4).
   918             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   919
   920         16  PI-LOWER-CASE-LETTERS       PIC X.
   921             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   922
   923*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   924*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   925*            88  CARRIER-CLM-CNTL            VALUE '2'.
   926
   927         16  PI-CERT-ACCESS-CONTROL      PIC X.
   928             88  ST-ACCNT-CNTL               VALUE ' '.
   929             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   930             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   931             88  ACCNT-CNTL                  VALUE '3'.
   932             88  CARR-ACCNT-CNTL             VALUE '4'.
   933
   934         16  PI-PROCESSOR-CAP-LIST.
   935             20  PI-SYSTEM-CONTROLS.
   936                24 PI-SYSTEM-DISPLAY     PIC X.
   937                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   938                24 PI-SYSTEM-MODIFY      PIC X.
   939                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   940             20  FILLER                  PIC XX.
   941             20  PI-DISPLAY-CAP          PIC X.
   942                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  21
* EL131.cbl
   943             20  PI-MODIFY-CAP           PIC X.
   944                 88  MODIFY-CAP              VALUE 'Y'.
   945             20  PI-MSG-AT-LOGON-CAP     PIC X.
   946                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   947             20  PI-FORCE-CAP            PIC X.
   948                 88  FORCE-CAP               VALUE 'Y'.
   949
   950         16  PI-PROGRAM-CONTROLS.
   951             20  PI-PGM-PRINT-OPT        PIC X.
   952             20  PI-PGM-FORMAT-OPT       PIC X.
   953             20  PI-PGM-PROCESS-OPT      PIC X.
   954             20  PI-PGM-TOTALS-OPT       PIC X.
   955
   956         16  PI-HELP-INTERFACE.
   957             20  PI-LAST-ERROR-NO        PIC X(4).
   958             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   959
   960         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   961             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   962
   963         16  PI-CR-CONTROL-IN-PROGRESS.
   964             20  PI-CR-CARRIER           PIC X.
   965             20  PI-CR-GROUPING          PIC X(6).
   966             20  PI-CR-STATE             PIC XX.
   967             20  PI-CR-ACCOUNT           PIC X(10).
   968             20  PI-CR-FIN-RESP          PIC X(10).
   969             20  PI-CR-TYPE              PIC X.
   970
   971         16  PI-CR-BATCH-NUMBER          PIC X(6).
   972
   973         16  PI-CR-MONTH-END-DT          PIC XX.
   974
   975         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   976             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   977             88  PI-ZERO-CARRIER             VALUE '1'.
   978             88  PI-ZERO-GROUPING            VALUE '2'.
   979             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   980
   981         16  PI-CARRIER-SECURITY         PIC X.
   982             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   983
   984         16  PI-ACCOUNT-SECURITY         PIC X(10).
   985             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   986             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   987
   988         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   989             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   990                                         INDEXED BY PI-ACCESS-NDX
   991                                         PIC X.
   992
   993         16  PI-GA-BILLING-CONTROL       PIC X.
   994             88  PI-GA-BILLING               VALUE '1'.
   995
   996         16  PI-MAIL-PROCESSING          PIC X.
   997             88  PI-MAIL-YES                 VALUE 'Y'.
   998
   999         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1000
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  22
* EL131.cbl
  1001         16  PI-AR-SYSTEM.
  1002             20  PI-AR-PROCESSING-CNTL   PIC X.
  1003                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1004             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1005             20  PI-AR-MONTH-END-DT      PIC XX.
  1006
  1007         16  PI-MP-SYSTEM.
  1008             20  PI-MORTGAGE-USER            PIC X.
  1009                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1010                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1011             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1012                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1013                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1014                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1015                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1016                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1017             20  PI-MP-MONTH-END-DT          PIC XX.
  1018             20  PI-MP-REFERENCE-NO.
  1019                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1020                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1021
  1022         16  PI-LABEL-CONTROL            PIC X(01).
  1023             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1024             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1025
  1026         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1027             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1028
  1029         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1030             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1031             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1032
  1033         16  FILLER                      PIC X(14).
  1034
  1035     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1036******************************************************************
  1037     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1038         16  PI-NO-PMTS                    PIC 9(4).
  1039         16  PI-CERT-SWITCH                PIC X.
  1040             88  CREATED-CERT              VALUE '2'.
  1041         16  PI-PREM-TYPE                  PIC X.
  1042         16  PI-SAVE-CERT-NO.
  1043             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1044             20  PI-SAVE-CERT-NO-SUFX      PIC X.
  1045         16  FILLER                        PIC X(46).
  1046         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1047         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1048         16  PI-REC-FOUND-SW               PIC X.
  1049         16  PI-LETTER-SW                  PIC X.
  1050         16  PI-PREV-TRLR-KEY              PIC X(22).
  1051         16  FILLER                        PIC X(547).
  1052
  1053 01  SAVE-RECORD                 PIC X(450).
  1054
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  23
* EL131.cbl
  1056*                                COPY ELCLOGOF SUPPRESS.
  1057******************************************************************
  1058*                                                                *
  1059*                                                                *
  1060*                            ELCLOGOF.                           *
  1061*                            VMOD=2.001                          *
  1062*                                                                *
  1063*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1064*                                                                *
  1065******************************************************************
  1066 01  CLASIC-LOGOFF.
  1067     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1068     12  LOGOFF-TEXT.
  1069         16  FILLER          PIC X(5)    VALUE SPACES.
  1070         16  LOGOFF-MSG.
  1071             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1072             20  FILLER      PIC X       VALUE SPACES.
  1073             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1074         16  FILLER          PIC X(80)
  1075           VALUE '* YOU ARE NOW LOGGED OFF'.
  1076         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1077         16  FILLER          PIC X       VALUE QUOTE.
  1078         16  LOGOFF-SYS-MSG  PIC X(17)
  1079           VALUE 'S CLAS-IC SYSTEM '.
  1080     12  TEXT-MESSAGES.
  1081         16  UNACCESS-MSG    PIC X(29)
  1082             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1083         16  PGMIDERR-MSG    PIC X(17)
  1084             VALUE 'PROGRAM NOT FOUND'.
  1085
  1086*                                COPY ELCATTR SUPPRESS.
  1087******************************************************************
  1088*                                                                *
  1089*                            ELCATTR.                            *
  1090*                            VMOD=2.001                          *
  1091*                                                                *
  1092*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1093*                                                                *
  1094*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1095*                                                                *
  1096*                   POS 1   P=PROTECTED                          *
  1097*                           U=UNPROTECTED                        *
  1098*                           S=ASKIP                              *
  1099*                   POS 2   A=ALPHA/NUMERIC                      *
  1100*                           N=NUMERIC                            *
  1101*                   POS 3   N=NORMAL                             *
  1102*                           B=BRIGHT                             *
  1103*                           D=DARK                               *
  1104*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1105*                           OF=MODIFIED DATA TAG OFF             *
  1106*                                                                *
  1107*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1108******************************************************************
  1109 01  ATTRIBUTE-LIST.
  1110     12  AL-PABOF            PIC X       VALUE 'Y'.
  1111     12  AL-PABON            PIC X       VALUE 'Z'.
  1112     12  AL-PADOF            PIC X       VALUE '%'.
  1113     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  24
* EL131.cbl
  1114     12  AL-PANOF            PIC X       VALUE '-'.
  1115     12  AL-PANON            PIC X       VALUE '/'.
  1116     12  AL-SABOF            PIC X       VALUE '8'.
  1117     12  AL-SABON            PIC X       VALUE '9'.
  1118     12  AL-SADOF            PIC X       VALUE '@'.
  1119     12  AL-SADON            PIC X       VALUE QUOTE.
  1120     12  AL-SANOF            PIC X       VALUE '0'.
  1121     12  AL-SANON            PIC X       VALUE '1'.
  1122     12  AL-UABOF            PIC X       VALUE 'H'.
  1123     12  AL-UABON            PIC X       VALUE 'I'.
  1124     12  AL-UADOF            PIC X       VALUE '<'.
  1125     12  AL-UADON            PIC X       VALUE '('.
  1126     12  AL-UANOF            PIC X       VALUE ' '.
  1127     12  AL-UANON            PIC X       VALUE 'A'.
  1128     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1129     12  AL-UNBON            PIC X       VALUE 'R'.
  1130     12  AL-UNDOF            PIC X       VALUE '*'.
  1131     12  AL-UNDON            PIC X       VALUE ')'.
  1132     12  AL-UNNOF            PIC X       VALUE '&'.
  1133     12  AL-UNNON            PIC X       VALUE 'J'.
  1134
  1135*                                COPY ELCAID SUPPRESS.
  1136******************************************************************
  1137*                                                                *
  1138*                            ELCAID.                             *
  1139*                            VMOD=2.001                          *
  1140*                                                                *
  1141*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1142*                                                                *
  1143*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1144*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1145******************************************************************
  1146
  1147 01  DFHAID.
  1148   02  DFHNULL   PIC  X  VALUE  ' '.
  1149   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1150   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1151   02  DFHPEN    PIC  X  VALUE  '='.
  1152   02  DFHOPID   PIC  X  VALUE  'W'.
  1153   02  DFHPA1    PIC  X  VALUE  '%'.
  1154   02  DFHPA2    PIC  X  VALUE  '>'.
  1155   02  DFHPA3    PIC  X  VALUE  ','.
  1156   02  DFHPF1    PIC  X  VALUE  '1'.
  1157   02  DFHPF2    PIC  X  VALUE  '2'.
  1158   02  DFHPF3    PIC  X  VALUE  '3'.
  1159   02  DFHPF4    PIC  X  VALUE  '4'.
  1160   02  DFHPF5    PIC  X  VALUE  '5'.
  1161   02  DFHPF6    PIC  X  VALUE  '6'.
  1162   02  DFHPF7    PIC  X  VALUE  '7'.
  1163   02  DFHPF8    PIC  X  VALUE  '8'.
  1164   02  DFHPF9    PIC  X  VALUE  '9'.
  1165   02  DFHPF10   PIC  X  VALUE  ':'.
  1166   02  DFHPF11   PIC  X  VALUE  '#'.
  1167   02  DFHPF12   PIC  X  VALUE  '@'.
  1168   02  DFHPF13   PIC  X  VALUE  'A'.
  1169   02  DFHPF14   PIC  X  VALUE  'B'.
  1170   02  DFHPF15   PIC  X  VALUE  'C'.
  1171   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  25
* EL131.cbl
  1172   02  DFHPF17   PIC  X  VALUE  'E'.
  1173   02  DFHPF18   PIC  X  VALUE  'F'.
  1174   02  DFHPF19   PIC  X  VALUE  'G'.
  1175   02  DFHPF20   PIC  X  VALUE  'H'.
  1176   02  DFHPF21   PIC  X  VALUE  'I'.
  1177*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1178   02  DFHPF22   PIC  X  VALUE  '['.
  1179   02  DFHPF23   PIC  X  VALUE  '.'.
  1180   02  DFHPF24   PIC  X  VALUE  '<'.
  1181   02  DFHMSRE   PIC  X  VALUE  'X'.
  1182   02  DFHSTRF   PIC  X  VALUE  'h'.
  1183   02  DFHTRIG   PIC  X  VALUE  '"'.
  1184 01  FILLER REDEFINES DFHAID.
  1185     12  FILLER                  PIC X(8).
  1186     12  AID-KEYS OCCURS 24 TIMES.
  1187         16  FILLER              PIC X.
  1188
  1189*                                COPY EL131S.
  1190 01  EL131AI.
  1191     05  FILLER            PIC  X(0012).
  1192*    -------------------------------
  1193     05  DATEL PIC S9(0004) COMP.
  1194     05  DATEF PIC  X(0001).
  1195     05  FILLER REDEFINES DATEF.
  1196         10  DATEA PIC  X(0001).
  1197     05  DATEI PIC  X(0008).
  1198*    -------------------------------
  1199     05  TIMEL PIC S9(0004) COMP.
  1200     05  TIMEF PIC  X(0001).
  1201     05  FILLER REDEFINES TIMEF.
  1202         10  TIMEA PIC  X(0001).
  1203     05  TIMEI PIC  X(0005).
  1204*    -------------------------------
  1205     05  SEQUL PIC S9(0004) COMP.
  1206     05  SEQUF PIC  X(0001).
  1207     05  FILLER REDEFINES SEQUF.
  1208         10  SEQUA PIC  X(0001).
  1209     05  SEQUI PIC  X(0010).
  1210*    -------------------------------
  1211     05  COMPL PIC S9(0004) COMP.
  1212     05  COMPF PIC  X(0001).
  1213     05  FILLER REDEFINES COMPF.
  1214         10  COMPA PIC  X(0001).
  1215     05  COMPI PIC  X(0003).
  1216*    -------------------------------
  1217     05  USERIDL PIC S9(0004) COMP.
  1218     05  USERIDF PIC  X(0001).
  1219     05  FILLER REDEFINES USERIDF.
  1220         10  USERIDA PIC  X(0001).
  1221     05  USERIDI PIC  X(0004).
  1222*    -------------------------------
  1223     05  CCNOL PIC S9(0004) COMP.
  1224     05  CCNOF PIC  X(0001).
  1225     05  FILLER REDEFINES CCNOF.
  1226         10  CCNOA PIC  X(0001).
  1227     05  CCNOI PIC  X(0016).
  1228*    -------------------------------
  1229     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  26
* EL131.cbl
  1230     05  MAINTF PIC  X(0001).
  1231     05  FILLER REDEFINES MAINTF.
  1232         10  MAINTA PIC  X(0001).
  1233     05  MAINTI PIC  X(0001).
  1234*    -------------------------------
  1235     05  CLAIML PIC S9(0004) COMP.
  1236     05  CLAIMF PIC  X(0001).
  1237     05  FILLER REDEFINES CLAIMF.
  1238         10  CLAIMA PIC  X(0001).
  1239     05  CLAIMI PIC  X(0007).
  1240*    -------------------------------
  1241     05  CARRL PIC S9(0004) COMP.
  1242     05  CARRF PIC  X(0001).
  1243     05  FILLER REDEFINES CARRF.
  1244         10  CARRA PIC  X(0001).
  1245     05  CARRI PIC  X(0001).
  1246*    -------------------------------
  1247     05  CERTL PIC S9(0004) COMP.
  1248     05  CERTF PIC  X(0001).
  1249     05  FILLER REDEFINES CERTF.
  1250         10  CERTA PIC  X(0001).
  1251     05  CERTI PIC  X(0010).
  1252*    -------------------------------
  1253     05  SUFXL PIC S9(0004) COMP.
  1254     05  SUFXF PIC  X(0001).
  1255     05  FILLER REDEFINES SUFXF.
  1256         10  SUFXA PIC  X(0001).
  1257     05  SUFXI PIC  X(0001).
  1258*    -------------------------------
  1259     05  TYPEL PIC S9(0004) COMP.
  1260     05  TYPEF PIC  X(0001).
  1261     05  FILLER REDEFINES TYPEF.
  1262         10  TYPEA PIC  X(0001).
  1263     05  TYPEI PIC  X(0001).
  1264*    -------------------------------
  1265     05  LABEL1L PIC S9(0004) COMP.
  1266     05  LABEL1F PIC  X(0001).
  1267     05  FILLER REDEFINES LABEL1F.
  1268         10  LABEL1A PIC  X(0001).
  1269     05  LABEL1I PIC  X(0011).
  1270*    -------------------------------
  1271     05  PCERTNOL PIC S9(0004) COMP.
  1272     05  PCERTNOF PIC  X(0001).
  1273     05  FILLER REDEFINES PCERTNOF.
  1274         10  PCERTNOA PIC  X(0001).
  1275     05  PCERTNOI PIC  X(0010).
  1276*    -------------------------------
  1277     05  PSUFXL PIC S9(0004) COMP.
  1278     05  PSUFXF PIC  X(0001).
  1279     05  FILLER REDEFINES PSUFXF.
  1280         10  PSUFXA PIC  X(0001).
  1281     05  PSUFXI PIC  X(0001).
  1282*    -------------------------------
  1283     05  STATUSL PIC S9(0004) COMP.
  1284     05  STATUSF PIC  X(0001).
  1285     05  FILLER REDEFINES STATUSF.
  1286         10  STATUSA PIC  X(0001).
  1287     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  27
* EL131.cbl
  1288*    -------------------------------
  1289     05  INCL PIC S9(0004) COMP.
  1290     05  INCF PIC  X(0001).
  1291     05  FILLER REDEFINES INCF.
  1292         10  INCA PIC  X(0001).
  1293     05  INCI PIC  X(0008).
  1294*    -------------------------------
  1295     05  REPL PIC S9(0004) COMP.
  1296     05  REPF PIC  X(0001).
  1297     05  FILLER REDEFINES REPF.
  1298         10  REPA PIC  X(0001).
  1299     05  REPI PIC  X(0008).
  1300*    -------------------------------
  1301     05  CAUSEL PIC S9(0004) COMP.
  1302     05  CAUSEF PIC  X(0001).
  1303     05  FILLER REDEFINES CAUSEF.
  1304         10  CAUSEA PIC  X(0001).
  1305     05  CAUSEI PIC  X(0006).
  1306*    -------------------------------
  1307     05  ENDL PIC S9(0004) COMP.
  1308     05  ENDF PIC  X(0001).
  1309     05  FILLER REDEFINES ENDF.
  1310         10  ENDA PIC  X(0001).
  1311     05  ENDI PIC  X(0008).
  1312*    -------------------------------
  1313     05  DIAGL PIC S9(0004) COMP.
  1314     05  DIAGF PIC  X(0001).
  1315     05  FILLER REDEFINES DIAGF.
  1316         10  DIAGA PIC  X(0001).
  1317     05  DIAGI PIC  X(0060).
  1318*    -------------------------------
  1319     05  BENEL PIC S9(0004) COMP.
  1320     05  BENEF PIC  X(0001).
  1321     05  FILLER REDEFINES BENEF.
  1322         10  BENEA PIC  X(0001).
  1323     05  BENEI PIC  X(0010).
  1324*    -------------------------------
  1325     05  BIRTHL PIC S9(0004) COMP.
  1326     05  BIRTHF PIC  X(0001).
  1327     05  FILLER REDEFINES BIRTHF.
  1328         10  BIRTHA PIC  X(0001).
  1329     05  BIRTHI PIC  X(0008).
  1330*    -------------------------------
  1331     05  SOCIALL PIC S9(0004) COMP.
  1332     05  SOCIALF PIC  X(0001).
  1333     05  FILLER REDEFINES SOCIALF.
  1334         10  SOCIALA PIC  X(0001).
  1335     05  SOCIALI PIC  X(0011).
  1336*    -------------------------------
  1337     05  SEXL PIC S9(0004) COMP.
  1338     05  SEXF PIC  X(0001).
  1339     05  FILLER REDEFINES SEXF.
  1340         10  SEXA PIC  X(0001).
  1341     05  SEXI PIC  X(0001).
  1342*    -------------------------------
  1343     05  MLNAMEL PIC S9(0004) COMP.
  1344     05  MLNAMEF PIC  X(0001).
  1345     05  FILLER REDEFINES MLNAMEF.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  28
* EL131.cbl
  1346         10  MLNAMEA PIC  X(0001).
  1347     05  MLNAMEI PIC  X(0015).
  1348*    -------------------------------
  1349     05  MFNAMEL PIC S9(0004) COMP.
  1350     05  MFNAMEF PIC  X(0001).
  1351     05  FILLER REDEFINES MFNAMEF.
  1352         10  MFNAMEA PIC  X(0001).
  1353     05  MFNAMEI PIC  X(0012).
  1354*    -------------------------------
  1355     05  MMINITL PIC S9(0004) COMP.
  1356     05  MMINITF PIC  X(0001).
  1357     05  FILLER REDEFINES MMINITF.
  1358         10  MMINITA PIC  X(0001).
  1359     05  MMINITI PIC  X(0001).
  1360*    -------------------------------
  1361     05  LOANNOL PIC S9(0004) COMP.
  1362     05  LOANNOF PIC  X(0001).
  1363     05  FILLER REDEFINES LOANNOF.
  1364         10  LOANNOA PIC  X(0001).
  1365     05  LOANNOI PIC  X(0008).
  1366*    -------------------------------
  1367     05  CRTLNMEL PIC S9(0004) COMP.
  1368     05  CRTLNMEF PIC  X(0001).
  1369     05  FILLER REDEFINES CRTLNMEF.
  1370         10  CRTLNMEA PIC  X(0001).
  1371     05  CRTLNMEI PIC  X(0015).
  1372*    -------------------------------
  1373     05  CRTFNMEL PIC S9(0004) COMP.
  1374     05  CRTFNMEF PIC  X(0001).
  1375     05  FILLER REDEFINES CRTFNMEF.
  1376         10  CRTFNMEA PIC  X(0001).
  1377     05  CRTFNMEI PIC  X(0012).
  1378*    -------------------------------
  1379     05  CRTINITL PIC S9(0004) COMP.
  1380     05  CRTINITF PIC  X(0001).
  1381     05  FILLER REDEFINES CRTINITF.
  1382         10  CRTINITA PIC  X(0001).
  1383     05  CRTINITI PIC  X(0001).
  1384*    -------------------------------
  1385     05  LOANBALL PIC S9(0004) COMP.
  1386     05  LOANBALF PIC  X(0001).
  1387     05  FILLER REDEFINES LOANBALF.
  1388         10  LOANBALA PIC  X(0001).
  1389     05  LOANBALI PIC  9(7)V99.
  1390*    -------------------------------
  1391     05  PROCL PIC S9(0004) COMP.
  1392     05  PROCF PIC  X(0001).
  1393     05  FILLER REDEFINES PROCF.
  1394         10  PROCA PIC  X(0001).
  1395     05  PROCI PIC  X(0004).
  1396*    -------------------------------
  1397     05  SUPVL PIC S9(0004) COMP.
  1398     05  SUPVF PIC  X(0001).
  1399     05  FILLER REDEFINES SUPVF.
  1400         10  SUPVA PIC  X(0001).
  1401     05  SUPVI PIC  X(0001).
  1402*    -------------------------------
  1403     05  PRICDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  29
* EL131.cbl
  1404     05  PRICDF PIC  X(0001).
  1405     05  FILLER REDEFINES PRICDF.
  1406         10  PRICDA PIC  X(0001).
  1407     05  PRICDI PIC  X(0001).
  1408*    -------------------------------
  1409     05  FILETOL PIC S9(0004) COMP.
  1410     05  FILETOF PIC  X(0001).
  1411     05  FILLER REDEFINES FILETOF.
  1412         10  FILETOA PIC  X(0001).
  1413     05  FILETOI PIC  X(0004).
  1414*    -------------------------------
  1415     05  PTHRHDGL PIC S9(0004) COMP.
  1416     05  PTHRHDGF PIC  X(0001).
  1417     05  FILLER REDEFINES PTHRHDGF.
  1418         10  PTHRHDGA PIC  X(0001).
  1419     05  PTHRHDGI PIC  X(0010).
  1420*    -------------------------------
  1421     05  PDTHRUL PIC S9(0004) COMP.
  1422     05  PDTHRUF PIC  X(0001).
  1423     05  FILLER REDEFINES PDTHRUF.
  1424         10  PDTHRUA PIC  X(0001).
  1425     05  PDTHRUI PIC  X(0008).
  1426*    -------------------------------
  1427     05  PDAMTL PIC S9(0004) COMP.
  1428     05  PDAMTF PIC  X(0001).
  1429     05  FILLER REDEFINES PDAMTF.
  1430         10  PDAMTA PIC  X(0001).
  1431     05  PDAMTI PIC  9(7)V99.
  1432*    -------------------------------
  1433     05  NODAYSL PIC S9(0004) COMP.
  1434     05  NODAYSF PIC  X(0001).
  1435     05  FILLER REDEFINES NODAYSF.
  1436         10  NODAYSA PIC  X(0001).
  1437     05  NODAYSI PIC  9(5).
  1438*    -------------------------------
  1439     05  NOPMTSL PIC S9(0004) COMP.
  1440     05  NOPMTSF PIC  X(0001).
  1441     05  FILLER REDEFINES NOPMTSF.
  1442         10  NOPMTSA PIC  X(0001).
  1443     05  NOPMTSI PIC  9(4).
  1444*    -------------------------------
  1445     05  FORMTYPL PIC S9(0004) COMP.
  1446     05  FORMTYPF PIC  X(0001).
  1447     05  FILLER REDEFINES FORMTYPF.
  1448         10  FORMTYPA PIC  X(0001).
  1449     05  FORMTYPI PIC  X(0001).
  1450*    -------------------------------
  1451     05  ESTL PIC S9(0004) COMP.
  1452     05  ESTF PIC  X(0001).
  1453     05  FILLER REDEFINES ESTF.
  1454         10  ESTA PIC  X(0001).
  1455     05  ESTI PIC  X(0008).
  1456*    -------------------------------
  1457     05  AUIDL PIC S9(0004) COMP.
  1458     05  AUIDF PIC  X(0001).
  1459     05  FILLER REDEFINES AUIDF.
  1460         10  AUIDA PIC  X(0001).
  1461     05  AUIDI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  30
* EL131.cbl
  1462*    -------------------------------
  1463     05  OCCL PIC S9(0004) COMP.
  1464     05  OCCF PIC  X(0001).
  1465     05  FILLER REDEFINES OCCF.
  1466         10  OCCA PIC  X(0001).
  1467     05  OCCI PIC  X(0006).
  1468*    -------------------------------
  1469     05  MNTDTL PIC S9(0004) COMP.
  1470     05  MNTDTF PIC  X(0001).
  1471     05  FILLER REDEFINES MNTDTF.
  1472         10  MNTDTA PIC  X(0001).
  1473     05  MNTDTI PIC  X(0008).
  1474*    -------------------------------
  1475     05  MNTTYPEL PIC S9(0004) COMP.
  1476     05  MNTTYPEF PIC  X(0001).
  1477     05  FILLER REDEFINES MNTTYPEF.
  1478         10  MNTTYPEA PIC  X(0001).
  1479     05  MNTTYPEI PIC  X(0006).
  1480*    -------------------------------
  1481     05  CERTCARL PIC S9(0004) COMP.
  1482     05  CERTCARF PIC  X(0001).
  1483     05  FILLER REDEFINES CERTCARF.
  1484         10  CERTCARA PIC  X(0001).
  1485     05  CERTCARI PIC  X(0001).
  1486*    -------------------------------
  1487     05  CERTGRPL PIC S9(0004) COMP.
  1488     05  CERTGRPF PIC  X(0001).
  1489     05  FILLER REDEFINES CERTGRPF.
  1490         10  CERTGRPA PIC  X(0001).
  1491     05  CERTGRPI PIC  X(0006).
  1492*    -------------------------------
  1493     05  CERTSTL PIC S9(0004) COMP.
  1494     05  CERTSTF PIC  X(0001).
  1495     05  FILLER REDEFINES CERTSTF.
  1496         10  CERTSTA PIC  X(0001).
  1497     05  CERTSTI PIC  X(0002).
  1498*    -------------------------------
  1499     05  CERTACTL PIC S9(0004) COMP.
  1500     05  CERTACTF PIC  X(0001).
  1501     05  FILLER REDEFINES CERTACTF.
  1502         10  CERTACTA PIC  X(0001).
  1503     05  CERTACTI PIC  X(0010).
  1504*    -------------------------------
  1505     05  CERTEFFL PIC S9(0004) COMP.
  1506     05  CERTEFFF PIC  X(0001).
  1507     05  FILLER REDEFINES CERTEFFF.
  1508         10  CERTEFFA PIC  X(0001).
  1509     05  CERTEFFI PIC  X(0008).
  1510*    -------------------------------
  1511     05  ISSAGEL PIC S9(0004) COMP.
  1512     05  ISSAGEF PIC  X(0001).
  1513     05  FILLER REDEFINES ISSAGEF.
  1514         10  ISSAGEA PIC  X(0001).
  1515     05  ISSAGEI PIC  X(0002).
  1516*    -------------------------------
  1517     05  APRL PIC S9(0004) COMP.
  1518     05  APRF PIC  X(0001).
  1519     05  FILLER REDEFINES APRF.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  31
* EL131.cbl
  1520         10  APRA PIC  X(0001).
  1521     05  APRI PIC  9(4)V9(4).
  1522*    -------------------------------
  1523     05  PMTFREQL PIC S9(0004) COMP.
  1524     05  PMTFREQF PIC  X(0001).
  1525     05  FILLER REDEFINES PMTFREQF.
  1526         10  PMTFREQA PIC  X(0001).
  1527     05  PMTFREQI PIC  99.
  1528*    -------------------------------
  1529     05  INDGRPL PIC S9(0004) COMP.
  1530     05  INDGRPF PIC  X(0001).
  1531     05  FILLER REDEFINES INDGRPF.
  1532         10  INDGRPA PIC  X(0001).
  1533     05  INDGRPI PIC  X(0001).
  1534*    -------------------------------
  1535     05  PREMTYPL PIC S9(0004) COMP.
  1536     05  PREMTYPF PIC  X(0001).
  1537     05  FILLER REDEFINES PREMTYPF.
  1538         10  PREMTYPA PIC  X(0001).
  1539     05  PREMTYPI PIC  X(0001).
  1540*    -------------------------------
  1541     05  REINCDL PIC S9(0004) COMP.
  1542     05  REINCDF PIC  X(0001).
  1543     05  FILLER REDEFINES REINCDF.
  1544         10  REINCDA PIC  X(0001).
  1545     05  REINCDI PIC  X(0001).
  1546*    -------------------------------
  1547     05  JNTLNMEL PIC S9(0004) COMP.
  1548     05  JNTLNMEF PIC  X(0001).
  1549     05  FILLER REDEFINES JNTLNMEF.
  1550         10  JNTLNMEA PIC  X(0001).
  1551     05  JNTLNMEI PIC  X(0015).
  1552*    -------------------------------
  1553     05  JNTFNMEL PIC S9(0004) COMP.
  1554     05  JNTFNMEF PIC  X(0001).
  1555     05  FILLER REDEFINES JNTFNMEF.
  1556         10  JNTFNMEA PIC  X(0001).
  1557     05  JNTFNMEI PIC  X(0012).
  1558*    -------------------------------
  1559     05  JNTINITL PIC S9(0004) COMP.
  1560     05  JNTINITF PIC  X(0001).
  1561     05  FILLER REDEFINES JNTINITF.
  1562         10  JNTINITA PIC  X(0001).
  1563     05  JNTINITI PIC  X(0001).
  1564*    -------------------------------
  1565     05  JNTAGEL PIC S9(0004) COMP.
  1566     05  JNTAGEF PIC  X(0001).
  1567     05  FILLER REDEFINES JNTAGEF.
  1568         10  JNTAGEA PIC  X(0001).
  1569     05  JNTAGEI PIC  X(0002).
  1570*    -------------------------------
  1571     05  ADDONDTL PIC S9(0004) COMP.
  1572     05  ADDONDTF PIC  X(0001).
  1573     05  FILLER REDEFINES ADDONDTF.
  1574         10  ADDONDTA PIC  X(0001).
  1575     05  ADDONDTI PIC  X(0008).
  1576*    -------------------------------
  1577     05  LCVDSCRL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  32
* EL131.cbl
  1578     05  LCVDSCRF PIC  X(0001).
  1579     05  FILLER REDEFINES LCVDSCRF.
  1580         10  LCVDSCRA PIC  X(0001).
  1581     05  LCVDSCRI PIC  X(0006).
  1582*    -------------------------------
  1583     05  LCVKINDL PIC S9(0004) COMP.
  1584     05  LCVKINDF PIC  X(0001).
  1585     05  FILLER REDEFINES LCVKINDF.
  1586         10  LCVKINDA PIC  X(0001).
  1587     05  LCVKINDI PIC  X(0003).
  1588*    -------------------------------
  1589     05  LCVCDL PIC S9(0004) COMP.
  1590     05  LCVCDF PIC  X(0001).
  1591     05  FILLER REDEFINES LCVCDF.
  1592         10  LCVCDA PIC  X(0001).
  1593     05  LCVCDI PIC  X(0002).
  1594*    -------------------------------
  1595     05  LCVOTRML PIC S9(0004) COMP.
  1596     05  LCVOTRMF PIC  X(0001).
  1597     05  FILLER REDEFINES LCVOTRMF.
  1598         10  LCVOTRMA PIC  X(0001).
  1599     05  LCVOTRMI PIC  999.
  1600*    -------------------------------
  1601     05  LCVRTRML PIC S9(0004) COMP.
  1602     05  LCVRTRMF PIC  X(0001).
  1603     05  FILLER REDEFINES LCVRTRMF.
  1604         10  LCVRTRMA PIC  X(0001).
  1605     05  LCVRTRMI PIC  X(0003).
  1606*    -------------------------------
  1607     05  LCVRATEL PIC S9(0004) COMP.
  1608     05  LCVRATEF PIC  X(0001).
  1609     05  FILLER REDEFINES LCVRATEF.
  1610         10  LCVRATEA PIC  X(0001).
  1611     05  LCVRATEI PIC  9999V99.
  1612*    -------------------------------
  1613     05  LCVBENEL PIC S9(0004) COMP.
  1614     05  LCVBENEF PIC  X(0001).
  1615     05  FILLER REDEFINES LCVBENEF.
  1616         10  LCVBENEA PIC  X(0001).
  1617     05  LCVBENEI PIC  9(9)V99.
  1618*    -------------------------------
  1619     05  LCVFORML PIC S9(0004) COMP.
  1620     05  LCVFORMF PIC  X(0001).
  1621     05  FILLER REDEFINES LCVFORMF.
  1622         10  LCVFORMA PIC  X(0001).
  1623     05  LCVFORMI PIC  X(0012).
  1624*    -------------------------------
  1625     05  LCVCNDTL PIC S9(0004) COMP.
  1626     05  LCVCNDTF PIC  X(0001).
  1627     05  FILLER REDEFINES LCVCNDTF.
  1628         10  LCVCNDTA PIC  X(0001).
  1629     05  LCVCNDTI PIC  X(0008).
  1630*    -------------------------------
  1631     05  LCVEXITL PIC S9(0004) COMP.
  1632     05  LCVEXITF PIC  X(0001).
  1633     05  FILLER REDEFINES LCVEXITF.
  1634         10  LCVEXITA PIC  X(0001).
  1635     05  LCVEXITI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  33
* EL131.cbl
  1636*    -------------------------------
  1637     05  LCVSTATL PIC S9(0004) COMP.
  1638     05  LCVSTATF PIC  X(0001).
  1639     05  FILLER REDEFINES LCVSTATF.
  1640         10  LCVSTATA PIC  X(0001).
  1641     05  LCVSTATI PIC  X(0006).
  1642*    -------------------------------
  1643     05  ACVDSCRL PIC S9(0004) COMP.
  1644     05  ACVDSCRF PIC  X(0001).
  1645     05  FILLER REDEFINES ACVDSCRF.
  1646         10  ACVDSCRA PIC  X(0001).
  1647     05  ACVDSCRI PIC  X(0006).
  1648*    -------------------------------
  1649     05  ACVKINDL PIC S9(0004) COMP.
  1650     05  ACVKINDF PIC  X(0001).
  1651     05  FILLER REDEFINES ACVKINDF.
  1652         10  ACVKINDA PIC  X(0001).
  1653     05  ACVKINDI PIC  X(0003).
  1654*    -------------------------------
  1655     05  ACVCDL PIC S9(0004) COMP.
  1656     05  ACVCDF PIC  X(0001).
  1657     05  FILLER REDEFINES ACVCDF.
  1658         10  ACVCDA PIC  X(0001).
  1659     05  ACVCDI PIC  X(0002).
  1660*    -------------------------------
  1661     05  ACVOTRML PIC S9(0004) COMP.
  1662     05  ACVOTRMF PIC  X(0001).
  1663     05  FILLER REDEFINES ACVOTRMF.
  1664         10  ACVOTRMA PIC  X(0001).
  1665     05  ACVOTRMI PIC  999.
  1666*    -------------------------------
  1667     05  ACVRTRML PIC S9(0004) COMP.
  1668     05  ACVRTRMF PIC  X(0001).
  1669     05  FILLER REDEFINES ACVRTRMF.
  1670         10  ACVRTRMA PIC  X(0001).
  1671     05  ACVRTRMI PIC  X(0003).
  1672*    -------------------------------
  1673     05  ACVRATEL PIC S9(0004) COMP.
  1674     05  ACVRATEF PIC  X(0001).
  1675     05  FILLER REDEFINES ACVRATEF.
  1676         10  ACVRATEA PIC  X(0001).
  1677     05  ACVRATEI PIC  9999V99.
  1678*    -------------------------------
  1679     05  ACVBENEL PIC S9(0004) COMP.
  1680     05  ACVBENEF PIC  X(0001).
  1681     05  FILLER REDEFINES ACVBENEF.
  1682         10  ACVBENEA PIC  X(0001).
  1683     05  ACVBENEI PIC  9(9)V99.
  1684*    -------------------------------
  1685     05  ACVFORML PIC S9(0004) COMP.
  1686     05  ACVFORMF PIC  X(0001).
  1687     05  FILLER REDEFINES ACVFORMF.
  1688         10  ACVFORMA PIC  X(0001).
  1689     05  ACVFORMI PIC  X(0012).
  1690*    -------------------------------
  1691     05  ACVCNDTL PIC S9(0004) COMP.
  1692     05  ACVCNDTF PIC  X(0001).
  1693     05  FILLER REDEFINES ACVCNDTF.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  34
* EL131.cbl
  1694         10  ACVCNDTA PIC  X(0001).
  1695     05  ACVCNDTI PIC  X(0008).
  1696*    -------------------------------
  1697     05  ACVEXITL PIC S9(0004) COMP.
  1698     05  ACVEXITF PIC  X(0001).
  1699     05  FILLER REDEFINES ACVEXITF.
  1700         10  ACVEXITA PIC  X(0001).
  1701     05  ACVEXITI PIC  X(0008).
  1702*    -------------------------------
  1703     05  ACVSTATL PIC S9(0004) COMP.
  1704     05  ACVSTATF PIC  X(0001).
  1705     05  FILLER REDEFINES ACVSTATF.
  1706         10  ACVSTATA PIC  X(0001).
  1707     05  ACVSTATI PIC  X(0006).
  1708*    -------------------------------
  1709     05  DAYSPL PIC S9(0004) COMP.
  1710     05  DAYSPF PIC  X(0001).
  1711     05  FILLER REDEFINES DAYSPF.
  1712         10  DAYSPA PIC  X(0001).
  1713     05  DAYSPI PIC  X(0003).
  1714*    -------------------------------
  1715     05  LABEL2L PIC S9(0004) COMP.
  1716     05  LABEL2F PIC  X(0001).
  1717     05  FILLER REDEFINES LABEL2F.
  1718         10  LABEL2A PIC  X(0001).
  1719     05  LABEL2I PIC  X(0014).
  1720*    -------------------------------
  1721     05  BCERT1L PIC S9(0004) COMP.
  1722     05  BCERT1F PIC  X(0001).
  1723     05  FILLER REDEFINES BCERT1F.
  1724         10  BCERT1A PIC  X(0001).
  1725     05  BCERT1I PIC  X(0010).
  1726*    -------------------------------
  1727     05  BSUFX1L PIC S9(0004) COMP.
  1728     05  BSUFX1F PIC  X(0001).
  1729     05  FILLER REDEFINES BSUFX1F.
  1730         10  BSUFX1A PIC  X(0001).
  1731     05  BSUFX1I PIC  X(0001).
  1732*    -------------------------------
  1733     05  BCERT2L PIC S9(0004) COMP.
  1734     05  BCERT2F PIC  X(0001).
  1735     05  FILLER REDEFINES BCERT2F.
  1736         10  BCERT2A PIC  X(0001).
  1737     05  BCERT2I PIC  X(0010).
  1738*    -------------------------------
  1739     05  BSUFX2L PIC S9(0004) COMP.
  1740     05  BSUFX2F PIC  X(0001).
  1741     05  FILLER REDEFINES BSUFX2F.
  1742         10  BSUFX2A PIC  X(0001).
  1743     05  BSUFX2I PIC  X(0001).
  1744*    -------------------------------
  1745     05  BCERT3L PIC S9(0004) COMP.
  1746     05  BCERT3F PIC  X(0001).
  1747     05  FILLER REDEFINES BCERT3F.
  1748         10  BCERT3A PIC  X(0001).
  1749     05  BCERT3I PIC  X(0010).
  1750*    -------------------------------
  1751     05  BSUFX3L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  35
* EL131.cbl
  1752     05  BSUFX3F PIC  X(0001).
  1753     05  FILLER REDEFINES BSUFX3F.
  1754         10  BSUFX3A PIC  X(0001).
  1755     05  BSUFX3I PIC  X(0001).
  1756*    -------------------------------
  1757     05  BCERT4L PIC S9(0004) COMP.
  1758     05  BCERT4F PIC  X(0001).
  1759     05  FILLER REDEFINES BCERT4F.
  1760         10  BCERT4A PIC  X(0001).
  1761     05  BCERT4I PIC  X(0010).
  1762*    -------------------------------
  1763     05  BSUFX4L PIC S9(0004) COMP.
  1764     05  BSUFX4F PIC  X(0001).
  1765     05  FILLER REDEFINES BSUFX4F.
  1766         10  BSUFX4A PIC  X(0001).
  1767     05  BSUFX4I PIC  X(0001).
  1768*    -------------------------------
  1769     05  BCERT5L PIC S9(0004) COMP.
  1770     05  BCERT5F PIC  X(0001).
  1771     05  FILLER REDEFINES BCERT5F.
  1772         10  BCERT5A PIC  X(0001).
  1773     05  BCERT5I PIC  X(0010).
  1774*    -------------------------------
  1775     05  BSUFX5L PIC S9(0004) COMP.
  1776     05  BSUFX5F PIC  X(0001).
  1777     05  FILLER REDEFINES BSUFX5F.
  1778         10  BSUFX5A PIC  X(0001).
  1779     05  BSUFX5I PIC  X(0001).
  1780*    -------------------------------
  1781     05  MSG1L PIC S9(0004) COMP.
  1782     05  MSG1F PIC  X(0001).
  1783     05  FILLER REDEFINES MSG1F.
  1784         10  MSG1A PIC  X(0001).
  1785     05  MSG1I PIC  X(0072).
  1786*    -------------------------------
  1787     05  PFKEYL PIC S9(0004) COMP.
  1788     05  PFKEYF PIC  X(0001).
  1789     05  FILLER REDEFINES PFKEYF.
  1790         10  PFKEYA PIC  X(0001).
  1791     05  PFKEYI PIC  99.
  1792*    -------------------------------
  1793     05  PFKEY6L PIC S9(0004) COMP.
  1794     05  PFKEY6F PIC  X(0001).
  1795     05  FILLER REDEFINES PFKEY6F.
  1796         10  PFKEY6A PIC  X(0001).
  1797     05  PFKEY6I PIC  X(0016).
  1798 01  EL131AO REDEFINES EL131AI.
  1799     05  FILLER            PIC  X(0012).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  DATEO PIC  X(0008).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  TIMEO PIC  99.99.
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  SEQUO PIC  X(0010).
  1809*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  36
* EL131.cbl
  1810     05  FILLER            PIC  X(0003).
  1811     05  COMPO PIC  X(0003).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  USERIDO PIC  X(0004).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  CCNOO PIC  X(0016).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  MAINTO PIC  X(0001).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  CLAIMO PIC  X(0007).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  CARRO PIC  X(0001).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  CERTO PIC  X(0010).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  SUFXO PIC  X(0001).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  TYPEO PIC  X(0001).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  LABEL1O PIC  X(0011).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  PCERTNOO PIC  X(0010).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  PSUFXO PIC  X(0001).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  STATUSO PIC  X(0006).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  INCO PIC  X(0008).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  REPO PIC  X(0008).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  CAUSEO PIC  X(0006).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  ENDO PIC  X(0008).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  DIAGO PIC  X(0060).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  BENEO PIC  X(0010).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  37
* EL131.cbl
  1868     05  BIRTHO PIC  X(0008).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  SOCIALO PIC  X(0011).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  SEXO PIC  X(0001).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  MLNAMEO PIC  X(0015).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  MFNAMEO PIC  X(0012).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  MMINITO PIC  X(0001).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  LOANNOO PIC  X(0008).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  CRTLNMEO PIC  X(0015).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  CRTFNMEO PIC  X(0012).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  CRTINITO PIC  X(0001).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  LOANBALO PIC  ZZZZZ9.99.
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  PROCO PIC  X(0004).
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  SUPVO PIC  X(0001).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  PRICDO PIC  X(0001).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  FILETOO PIC  X(0004).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  PTHRHDGO PIC  X(0010).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  PDTHRUO PIC  X(0008).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  PDAMTO PIC  Z(06).99.
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  NODAYSO PIC  ZZZ99.
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  NOPMTSO PIC  ZZ99.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  38
* EL131.cbl
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  FORMTYPO PIC  X(0001).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  ESTO PIC  X(0008).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  AUIDO PIC  X(0004).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  OCCO PIC  X(0006).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  MNTDTO PIC  X(0008).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  MNTTYPEO PIC  X(0006).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  CERTCARO PIC  X(0001).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  CERTGRPO PIC  X(0006).
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  CERTSTO PIC  X(0002).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  CERTACTO PIC  X(0010).
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  CERTEFFO PIC  X(0008).
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  ISSAGEO PIC  X(0002).
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  APRO PIC  9(3).9(4).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  PMTFREQO PIC  99.
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
  1970     05  INDGRPO PIC  X(0001).
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  PREMTYPO PIC  X(0001).
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
  1976     05  REINCDO PIC  X(0001).
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  JNTLNMEO PIC  X(0015).
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
  1982     05  JNTFNMEO PIC  X(0012).
  1983*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  39
* EL131.cbl
  1984     05  FILLER            PIC  X(0003).
  1985     05  JNTINITO PIC  X(0001).
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  JNTAGEO PIC  X(0002).
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
  1991     05  ADDONDTO PIC  X(0008).
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  LCVDSCRO PIC  X(0006).
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  LCVKINDO PIC  X(0003).
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  LCVCDO PIC  X(0002).
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  LCVOTRMO PIC  999.
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  LCVRTRMO PIC  999.
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  LCVRATEO PIC  ZZZ.ZZ.
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  LCVFORMO PIC  X(0012).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  LCVCNDTO PIC  X(0008).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  LCVEXITO PIC  X(0008).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  LCVSTATO PIC  X(0006).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  ACVDSCRO PIC  X(0006).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  ACVKINDO PIC  X(0003).
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  ACVCDO PIC  X(0002).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  ACVOTRMO PIC  999.
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  ACVRTRMO PIC  999.
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  40
* EL131.cbl
  2042     05  ACVRATEO PIC  ZZZ.ZZ.
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  ACVFORMO PIC  X(0012).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  ACVCNDTO PIC  X(0008).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  ACVEXITO PIC  X(0008).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  ACVSTATO PIC  X(0006).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  DAYSPO PIC  X(0003).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  LABEL2O PIC  X(0014).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  BCERT1O PIC  X(0010).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  BSUFX1O PIC  X(0001).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  BCERT2O PIC  X(0010).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  BSUFX2O PIC  X(0001).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  BCERT3O PIC  X(0010).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  BSUFX3O PIC  X(0001).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  BCERT4O PIC  X(0010).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  BSUFX4O PIC  X(0001).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  BCERT5O PIC  X(0010).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  BSUFX5O PIC  X(0001).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  MSG1O PIC  X(0072).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  PFKEYO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  41
* EL131.cbl
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  PFKEY6O PIC  X(0016).
  2103*    -------------------------------
  2104
  2105*                                COPY ELCEMIB SUPPRESS.
  2106******************************************************************
  2107*                                                                *
  2108*                                                                *
  2109*                            ELCEMIB.                            *
  2110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2111*                            VMOD=2.005                          *
  2112*                                                                *
  2113*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2114*                                                                *
  2115******************************************************************
  2116 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2117     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2118     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2119     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2120     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2121     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2122     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2123     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2124     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2125     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2126         88  EMI-NO-ERRORS                    VALUE '1'.
  2127         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2128         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2129     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2130         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2131     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2132         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2133         88  EMI-AREA1-FULL                   VALUE '2'.
  2134     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2135         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2136         88  EMI-AREA2-FULL                   VALUE '2'.
  2137     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2138         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2139         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2140         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2141         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2142         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2143     12  EMI-ERROR-LINES.
  2144         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2145         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2146         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2147         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2148             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2149                 24  EMI-ERR-NUM         PIC X(4).
  2150                 24  EMI-FILLER          PIC X.
  2151                 24  EMI-SEV             PIC X.
  2152                 24  FILLER              PIC X.
  2153             20  FILLER                  PIC X(02).
  2154     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2155         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2156             20  EMI-ERROR-NUMBER    PIC X(4).
  2157             20  EMI-FILL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  42
* EL131.cbl
  2158             20  EMI-SEVERITY        PIC X.
  2159             20  FILLER              PIC X.
  2160             20  EMI-ERROR-TEXT.
  2161                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2162                 24  FILLER          PIC X(55).
  2163     12  EMI-SEVERITY-SAVE           PIC X.
  2164         88  EMI-NOTE                    VALUE 'N'.
  2165         88  EMI-WARNING                 VALUE 'W'.
  2166         88  EMI-FORCABLE                VALUE 'F'.
  2167         88  EMI-FATAL                   VALUE 'X'.
  2168     12  EMI-MESSAGE-FLAG            PIC X.
  2169         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2170         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2171     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2172     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2173         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2174         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2175         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2176     12  FILLER                      PIC X(137)  VALUE SPACES.
  2177     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2178     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2179     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2180     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2181
  2182*                                COPY ELCJPFX SUPPRESS.
  2183******************************************************************
  2184*                                                                *
  2185*                                                                *
  2186*                            ELCJPFX.                            *
  2187*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2188*                            VMOD=2.002                          *
  2189*                                                                *
  2190*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2191*                                                                *
  2192*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2193*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2194*        ELCNTL - CONTROL FILE                                   *
  2195*        ELMSTR - CLAIM MASTERS                                  *
  2196*        ELTRLR - ACTIVITY TRAILERS                              *
  2197*        ELCHKQ - CHECK QUE                                      *
  2198******************************************************************
  2199 01  JOURNAL-RECORD.
  2200     12  JP-USER-ID                  PIC X(4).
  2201     12  JP-FILE-ID                  PIC X(8).
  2202     12  JP-PROGRAM-ID               PIC X(8).
  2203     12  JP-RECORD-TYPE              PIC X.
  2204         88 JP-ADD              VALUE 'A'.
  2205         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2206         88 JP-AFTER-CHANGE     VALUE 'C'.
  2207         88 JP-DELETE           VALUE 'D'.
  2208         88 JP-GENERIC-DELETE   VALUE 'G'.
  2209         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2210         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2211     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2212     12  JP-RECORD-AREA
  2213
  2214
  2215                                 PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  43
* EL131.cbl
  2216
  2217*                                COPY ELCCALC SUPPRESS.
  2218******************************************************************
  2219*                                                                *
  2220*                           ELCCALC.                            *
  2221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2222*                            VMOD=2.025                          *
  2223*                                                                *
  2224*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2225*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2226*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2227*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2228*                                                                *
  2229*  PASSED TO ELRTRM                                              *
  2230*  -----------------                                             *
  2231*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2232*  ORIGINAL TERM                                                 *
  2233*  BEGINNING DATE                                                *
  2234*  ENDING DATE                                                   *
  2235*  COMPANY I.D.                                                  *
  2236*  ACCOUNT MASTER USER FIELD                                     *
  2237*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2238*  FREE LOOK DAYS                                                *
  2239*                                                                *
  2240*  RETURNED FROM ELRTRM                                          *
  2241*  ---------------------                                         *
  2242*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2243*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2244*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2245*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2246*----------------------------------------------------------------*
  2247*  PASSED TO ELRAMT                                              *
  2248*  ----------------                                              *
  2249*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2250*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2251*  ORIGINAL AMOUNT                                               *
  2252*  ALTERNATE BENEFIT (BALLON)                                    *
  2253*  A.P.R. - NET PAY ONLY                                         *
  2254*  METHOD
  2255*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2256*  COMPANY I.D.                                                  *
  2257*  BENEFIT TYPE                                                  *
  2258*                                                                *
  2259*  RETURNED FROM ELRAMT                                          *
  2260*  --------------------                                          *
  2261*  REMAINING AMOUNT 1 - CURRENT                                  *
  2262*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2263*  REMAINING AMOUNT FACTOR
  2264*----------------------------------------------------------------*
  2265*  PASSED TO ELRESV                                              *
  2266*  -----------------                                             *
  2267*  CERTIFICATE EFFECTIVE DATE                                    *
  2268*  VALUATION DATE                                                *
  2269*  PAID THRU DATE                                                *
  2270*  BENEFIT                                                       *
  2271*  INCURRED DATE                                                 *
  2272*  REPORTED DATE                                                 *
  2273*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  44
* EL131.cbl
  2274*  TERM                                                          *
  2275*  CDT PERCENT                                                   *
  2276*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2277* *CLAIM TYPE (LIFE, A/H)                                        *
  2278* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2279* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2280*                                                                *
  2281*  RETURNED FROM ELRESV                                          *
  2282*  --------------------                                          *
  2283*  CDT TABLE USED                                                *
  2284*  CDT FACTOR USED                                               *
  2285*  PAY TO CURRENT RESERVE                                        *
  2286*  I.B.N.R. - A/H ONLY                                           *
  2287*  FUTURE (ACCRUED) AH ONLY                                      *
  2288*----------------------------------------------------------------*
  2289*  PASSED TO ELRATE                                              *
  2290*  ----------------                                              *
  2291*  CERT ISSUE DATE                                               *
  2292*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2293*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2294*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2295*  STATE CODE (CLIENT DEFINED)                                   *
  2296*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2297*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2298*  DEVIATION CODE                                                *
  2299*  ISSUE AGE                                                     *
  2300*  ORIGINAL BENEFIT AMOUNT                                       *
  2301*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2302*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2303*  BENEFIT KIND (LIFE OR A/H)                                    *
  2304*  A.P.R.                                                        *
  2305*  METHOD
  2306*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2307*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2308*  COMPANY I.D. (3 CHARACTER)                                    *
  2309*  BENEFIT CODE                                                  *
  2310*  BENEFIT OVERRIDE CODE                                         *
  2311*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2312*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2313*  JOINT INDICATOR (CSL ONLY)                                    *
  2314*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2315*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2316*                                                                *
  2317*  RETURNED FROM ELRATE                                          *
  2318*  --------------------                                          *
  2319*  CALCULATED PREMIUM                                            *
  2320*  PREMIUM RATE                                                  *
  2321*  MORTALITY CODE                                                *
  2322*  MAX ATTAINED AGE                                              *
  2323*  MAX AGE                                                       *
  2324*  MAX TERM                                                      *
  2325*  MAX MONTHLY BENEFIT                                           *
  2326*  MAX TOTAL BENIFIT                                             *
  2327*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2328*----------------------------------------------------------------*
  2329*  PASSED TO ELRFND                                              *
  2330*  ----------------                                              *
  2331*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  45
* EL131.cbl
  2332*  REFUND DATE                                                   *
  2333*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2334*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2335*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2336*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2337*  STATE CODE (CLIENT DEFINED)                                   *
  2338*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2339*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2340*  DEVIATION CODE                                                *
  2341*  ISSUE AGE                                                     *
  2342*  ORIGINAL BENEFIT AMOUNT                                       *
  2343*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2344*  PROCESS TYPE (CANCEL)                                         *
  2345*  BENEFIT KIND (LIFE OR A/H)                                    *
  2346*  A.P.R.                                                        *
  2347*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2348*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2349*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2350*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2351*  COMPANY I.D. (3 CHARACTER)                                    *
  2352*  BENEFIT CODE                                                  *
  2353*  BENEFIT OVERRIDE CODE                                         *
  2354*                                                                *
  2355*  RETURNED FROM ELRFND                                          *
  2356*  --------------------                                          *
  2357*  CALCULATED REFUND                                             *
  2358*----------------------------------------------------------------*
  2359*  PASSED TO ELEARN                                              *
  2360*  ----------------                                              *
  2361*  CERT ISSUE DATE                                               *
  2362*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2363*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2364*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2365*  STATE CODE (CLIENT DEFINED)                                   *
  2366*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2367*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2368*  DEVIATION CODE                                                *
  2369*  ISSUE AGE                                                     *
  2370*  ORIGINAL BENEFIT AMOUNT                                       *
  2371*  BENEFIT KIND (LIFE OR A/H)                                    *
  2372*  A.P.R.                                                        *
  2373*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2374*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2375*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2376*  COMPANY I.D. (3 CHARACTER)                                    *
  2377*  BENEFIT CODE                                                  *
  2378*  BENEFIT OVERRIDE CODE                                         *
  2379*                                                                *
  2380*  RETURNED FROM ELEARN                                          *
  2381*  --------------------                                          *
  2382*  INDICATED  EARNINGS                                           *
  2383*----------------------------------------------------------------*
  2384*                 LENGTH = 450                                   *
  2385*                                                                *
  2386******************************************************************
  2387******************************************************************
  2388*                   C H A N G E   L O G
  2389*
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  46
* EL131.cbl
  2390* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2391*-----------------------------------------------------------------
  2392*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2393* EFFECTIVE    NUMBER
  2394*-----------------------------------------------------------------
  2395* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2396* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2397* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2398* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2399* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2400* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2401* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2402* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2403* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2404******************************************************************
  2405
  2406 01  CALCULATION-PASS-AREA.
  2407     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2408                                     COMP.
  2409
  2410     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2411       88  NO-CP-ERROR                             VALUE ZERO.
  2412       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2413                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2414       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2415       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2416       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2417       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2418       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2419       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2420       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2421       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2422       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2423       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2424       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2425       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2426       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2427       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2428       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2429       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2430       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2431
  2432     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2433       88  NO-CP-ERROR-2                           VALUE ZERO.
  2434***********************  INPUT AREAS ****************************
  2435
  2436     12  CP-CALCULATION-AREA.
  2437         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2438         16  CP-CERT-EFF-DT        PIC XX.
  2439         16  CP-VALUATION-DT       PIC XX.
  2440         16  CP-PAID-THRU-DT       PIC XX.
  2441         16  CP-BENEFIT-TYPE       PIC X.
  2442           88  CP-AH                               VALUE 'A' 'D'
  2443                                                   'I' 'U'.
  2444           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2445           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2446         16  CP-INCURRED-DT        PIC XX.
  2447         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  47
* EL131.cbl
  2448         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2449         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2450         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2451                                     COMP-3.
  2452         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2453                                     COMP-3.
  2454         16  CP-CDT-METHOD         PIC X.
  2455           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2456           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2457           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2458         16  CP-CLAIM-TYPE         PIC X.
  2459           88  CP-AH-CLAIM                         VALUE 'A'.
  2460           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2461         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2462                                     COMP-3.
  2463         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2464                                     COMP-3.
  2465         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2466                                     COMP-3.
  2467         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2468                                     COMP-3.
  2469         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2470                                     COMP-3.
  2471         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2472                                     COMP-3.
  2473         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2474                                     COMP-3.
  2475         16  CP-REM-TERM-METHOD    PIC X.
  2476           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2477           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2478           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2479           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2480           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2481           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2482           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2483         16  CP-EARNING-METHOD     PIC X.
  2484           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2485           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2486           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2487           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2488           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2489           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2490           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2491           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2492           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2493           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2494           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2495           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2496           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2497           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2498         16  CP-PROCESS-TYPE       PIC X.
  2499           88  CP-CLAIM                            VALUE '1'.
  2500           88  CP-CANCEL                           VALUE '2'.
  2501           88  CP-ISSUE                            VALUE '3'.
  2502         16  CP-SPECIAL-CALC-CD    PIC X.
  2503           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2504           88  CP-1-MTH-INTEREST               VALUE ' '.
  2505           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  48
* EL131.cbl
  2506           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2507           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2508           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2509           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2510           88  CP-FARM-PLAN                    VALUE 'F'.
  2511           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2512           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2513           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2514           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2515           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2516           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2517           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2518           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2519           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2520           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2521                                                     'W' 'X'.
  2522           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2523           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2524           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2525           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2526           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2527           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2528           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2529           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2530           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2531           88  CP-CSL-METH-1                   VALUE '5'.
  2532           88  CP-CSL-METH-2                   VALUE '6'.
  2533           88  CP-CSL-METH-3                   VALUE '7'.
  2534           88  CP-CSL-METH-4                   VALUE '8'.
  2535
  2536         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2537                                     COMP-3.
  2538         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2539         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2540         16  CP-STATE              PIC XX          VALUE SPACE.
  2541         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2542         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2543           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2544               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2545         16  CP-R78-OPTION         PIC X.
  2546           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2547           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2548
  2549         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2550         16  CP-IBNR-RESERVE-SW    PIC X.
  2551         16  CP-CLAIM-STATUS       PIC X.
  2552         16  CP-RATE-FILE          PIC X.
  2553         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2554                                     COMP-3.
  2555
  2556         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2557         16  CP-AH-OVERRIDE-CODE   PIC X.
  2558
  2559         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2560                                     COMP-3.
  2561         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2562                                   PIC S9(5)V99 COMP-3.
  2563         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  49
* EL131.cbl
  2564                                     COMP-3.
  2565         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2566                                     COMP-3.
  2567         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2568                                     COMP-3.
  2569         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2570                                  PIC S9(7)V99 COMP-3.
  2571
  2572         16  CP-PAID-FROM-DATE     PIC X(02).
  2573         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2574         16  CP-EXT-DAYS-CALC      PIC X.
  2575           88  CP-EXT-NO-CHG                   VALUE ' '.
  2576           88  CP-EXT-CHG-LF                   VALUE '1'.
  2577           88  CP-EXT-CHG-AH                   VALUE '2'.
  2578           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2579         16  CP-DOMICILE-STATE     PIC XX.
  2580         16  CP-CARRIER            PIC X.
  2581         16  CP-REIN-FLAG          PIC X.
  2582         16  CP-REM-TRM-CALC-OPTION PIC X.
  2583           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2584                      '2' '3' '4' '5'.
  2585           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2586           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2587           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2588           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2589           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2590           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2591           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2592           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2593         16  CP-SIG-SWITCH         PIC X.
  2594         16  CP-RATING-METHOD      PIC X.
  2595           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2596           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2597           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2598           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2599           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2600           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2601           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2602           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2603           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2604         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2605                                     COMP-3.
  2606         16  CP-BEN-CATEGORY       PIC X.
  2607         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2608         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2609                                   PIC S99V9(5) COMP-3.
  2610         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2611         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2612                                   PIC S99V9(5) COMP-3.
  2613         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2614         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2615         16  CP-EXPIRE-DT          PIC XX.
  2616         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2617         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2618         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2619         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2620         16  CP-DDF-SPEC-CALC      PIC X.
  2621             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  50
* EL131.cbl
  2622             88  CP-CALC-CLP              VALUE 'C'.
  2623         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2624         16  CP-CANCEL-REASON      PIC X.
  2625         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2626         16  CP-PMT-MODE           PIC X.
  2627         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2628         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2629         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2630         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2631         16  FILLER                PIC X.
  2632
  2633***************    OUTPUT FROM ELRESV   ************************
  2634
  2635         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2636
  2637         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2638                                     COMP-3.
  2639         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2640                                     COMP-3.
  2641         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2642                                     COMP-3.
  2643         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2644                                     COMP-3.
  2645         16  FILLER                PIC X(09).
  2646***************    OUTPUT FROM ELRTRM   *************************
  2647
  2648         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2649                                     COMP-3.
  2650         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2651                                     COMP-3.
  2652         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2653                                     COMP-3.
  2654         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2655                                     COMP-3.
  2656         16  FILLER                PIC X(12).
  2657
  2658***************    OUTPUT FROM ELRAMT   *************************
  2659
  2660         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2661                                     COMP-3.
  2662         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2663                                     COMP-3.
  2664         16  FILLER                PIC X(12).
  2665
  2666***************    OUTPUT FROM ELRATE   *************************
  2667
  2668         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2669                                     COMP-3.
  2670         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2671                                     COMP-3.
  2672         16  CP-MORTALITY-CODE     PIC X(4).
  2673         16  CP-RATE-EDIT-FLAG     PIC X.
  2674             88  CP-RATES-NEED-APR                  VALUE '1'.
  2675         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2676                                     COMP-3.
  2677         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2678         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2679         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  51
* EL131.cbl
  2680                                   PIC S9(7)V99 COMP-3.
  2681         16  FILLER                PIC X(07).
  2682
  2683***************    OUTPUT FROM ELRFND   *************************
  2684
  2685         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2686                                     COMP-3.
  2687         16  CP-REFUND-TYPE-USED   PIC X.
  2688           88  CP-R-AS-R78                         VALUE '1'.
  2689           88  CP-R-AS-PRORATA                     VALUE '2'.
  2690           88  CP-R-AS-CALIF                       VALUE '3'.
  2691           88  CP-R-AS-TEXAS                       VALUE '4'.
  2692           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2693           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2694           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2695           88  CP-R-AS-MEAN                        VALUE '8'.
  2696           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2697           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2698           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2699           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2700           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2701           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2702         16  FILLER                PIC X(12).
  2703
  2704***************    OUTPUT FROM ELEARN   *************************
  2705
  2706         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2707                                     COMP-3.
  2708         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2709                                     COMP-3.
  2710         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2711                                     COMP-3.
  2712         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2713                                     COMP-3.
  2714         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2715                                     COMP-3.
  2716         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2717                                     COMP-3.
  2718         16  CP-EARNING-TYPE-USED  PIC X.
  2719           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2720           88  CP-E-AS-R78                         VALUE '1'.
  2721           88  CP-E-AS-PRORATA                     VALUE '2'.
  2722           88  CP-E-AS-TEXAS                       VALUE '4'.
  2723           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2724           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2725           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2726           88  CP-E-AS-MEAN                        VALUE '8'.
  2727           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2728         16  FILLER                PIC X(12).
  2729
  2730***************    OUTPUT FROM ELPMNT   *************************
  2731
  2732         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2733                                     COMP-3.
  2734         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2735                                     COMP-3.
  2736         16  FILLER                PIC X(12).
  2737
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  52
* EL131.cbl
  2738***************   MISC WORK AREAS    *****************************
  2739         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2740                                     COMP-3.
  2741         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2742                                     COMP-3.
  2743         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2744                                     COMP-3.
  2745         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2746                                     COMP-3.
  2747         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2748                                     COMP-3.
  2749         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2750                                     COMP-3.
  2751         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2752             88  OPEN-RATE-FILE                   VALUE 'O'.
  2753             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2754             88  IO-ERROR                         VALUE 'E'.
  2755
  2756         16  CP-FIRST-PAY-DATE     PIC XX.
  2757
  2758         16  CP-JOINT-INDICATOR    PIC X.
  2759
  2760         16  CP-RESERVE-REMAINING-TERM
  2761                                   PIC S9(4)V9    VALUE ZERO
  2762                                     COMP-3.
  2763
  2764         16  CP-INSURED-BIRTH-DT   PIC XX.
  2765
  2766         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2767                                     COMP-3.
  2768
  2769         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2770                                     COMP-3.
  2771
  2772         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2773                                     COMP-3.
  2774
  2775         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2776                                     COMP-3.
  2777
  2778         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2779                                     COMP-3.
  2780
  2781         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2782                                     COMP-3.
  2783
  2784         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2785                                     COMP-3.
  2786
  2787         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2788             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2789
  2790         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2791                                     COMP-3.
  2792         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2793                                     COMP-3.
  2794         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2795         16  FILLER                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  53
* EL131.cbl
  2796******************************************************************
  2797
  2798*                                COPY ELCDATE SUPPRESS.
  2799******************************************************************
  2800*                                                                *
  2801*                                                                *
  2802*                            ELCDATE.                            *
  2803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2804*                            VMOD=2.003
  2805*                                                                *
  2806*                                                                *
  2807*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2808*                 LENGTH = 200                                   *
  2809******************************************************************
  2810
  2811 01  DATE-CONVERSION-DATA.
  2812     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2813     12  DC-OPTION-CODE                PIC X.
  2814         88  BIN-TO-GREG                VALUE ' '.
  2815         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2816         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2817         88  YMD-GREG-TO-BIN            VALUE '3'.
  2818         88  MDY-GREG-TO-BIN            VALUE '4'.
  2819         88  JULIAN-TO-BIN              VALUE '5'.
  2820         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2821         88  FIND-CENTURY               VALUE '7'.
  2822         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2823         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2824         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2825         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2826         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2827         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2828         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2829         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2830         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2831         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2832         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2833         88  BIN-3-TO-GREG              VALUE 'I'.
  2834         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2835         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2836         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2837         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2838         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2839         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2840         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2841         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2842         88  THREE-CHARACTER-BIN
  2843                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2844         88  GREGORIAN-TO-BIN
  2845                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2846         88  BIN-TO-GREGORIAN
  2847                  VALUES ' ' '1' 'I' '8' 'G'.
  2848         88  JULIAN-TO-BINARY
  2849                  VALUES '5' 'C' 'E' 'F'.
  2850     12  DC-ERROR-CODE                 PIC X.
  2851         88  NO-CONVERSION-ERROR        VALUE ' '.
  2852         88  DATE-CONVERSION-ERROR
  2853                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  54
* EL131.cbl
  2854         88  DATE-IS-ZERO               VALUE '1'.
  2855         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2856         88  DATE-IS-INVALID            VALUE '3'.
  2857         88  DATE1-GREATER-DATE2        VALUE '4'.
  2858         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2859         88  DATE-INVALID-OPTION        VALUE '9'.
  2860         88  INVALID-CENTURY            VALUE 'A'.
  2861         88  ONLY-CENTURY               VALUE 'B'.
  2862         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2863         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2864     12  DC-END-OF-MONTH               PIC X.
  2865         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2866     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2867         88  USE-NORMAL-PROCESS         VALUE ' '.
  2868         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2869         88  ADJUST-UP-100-YRS          VALUE '2'.
  2870     12  FILLER                        PIC X.
  2871     12  DC-CONVERSION-DATES.
  2872         16  DC-BIN-DATE-1             PIC XX.
  2873         16  DC-BIN-DATE-2             PIC XX.
  2874         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2875         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2876                       DC-GREG-DATE-1-EDIT.
  2877             20  DC-EDIT1-MONTH        PIC 99.
  2878             20  SLASH1-1              PIC X.
  2879             20  DC-EDIT1-DAY          PIC 99.
  2880             20  SLASH1-2              PIC X.
  2881             20  DC-EDIT1-YEAR         PIC 99.
  2882         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2883         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2884                     DC-GREG-DATE-2-EDIT.
  2885             20  DC-EDIT2-MONTH        PIC 99.
  2886             20  SLASH2-1              PIC X.
  2887             20  DC-EDIT2-DAY          PIC 99.
  2888             20  SLASH2-2              PIC X.
  2889             20  DC-EDIT2-YEAR         PIC 99.
  2890         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2891         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2892                     DC-GREG-DATE-1-YMD.
  2893             20  DC-YMD-YEAR           PIC 99.
  2894             20  DC-YMD-MONTH          PIC 99.
  2895             20  DC-YMD-DAY            PIC 99.
  2896         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2897         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2898                      DC-GREG-DATE-1-MDY.
  2899             20  DC-MDY-MONTH          PIC 99.
  2900             20  DC-MDY-DAY            PIC 99.
  2901             20  DC-MDY-YEAR           PIC 99.
  2902         16  DC-GREG-DATE-1-ALPHA.
  2903             20  DC-ALPHA-MONTH        PIC X(10).
  2904             20  DC-ALPHA-DAY          PIC 99.
  2905             20  FILLER                PIC XX.
  2906             20  DC-ALPHA-CENTURY.
  2907                 24 DC-ALPHA-CEN-N     PIC 99.
  2908             20  DC-ALPHA-YEAR         PIC 99.
  2909         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2910         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2911         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  55
* EL131.cbl
  2912         16  DC-JULIAN-DATE            PIC 9(05).
  2913         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2914                                       PIC 9(05).
  2915         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2916             20  DC-JULIAN-YEAR        PIC 99.
  2917             20  DC-JULIAN-DAYS        PIC 999.
  2918         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2919         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2920         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2921     12  DATE-CONVERSION-VARIBLES.
  2922         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2923         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2924             20  FILLER                PIC 9(3).
  2925             20  HOLD-CEN-1-CCYY.
  2926                 24  HOLD-CEN-1-CC     PIC 99.
  2927                 24  HOLD-CEN-1-YY     PIC 99.
  2928             20  HOLD-CEN-1-MO         PIC 99.
  2929             20  HOLD-CEN-1-DA         PIC 99.
  2930         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2931             20  HOLD-CEN-1-R-MO       PIC 99.
  2932             20  HOLD-CEN-1-R-DA       PIC 99.
  2933             20  HOLD-CEN-1-R-CCYY.
  2934                 24  HOLD-CEN-1-R-CC   PIC 99.
  2935                 24  HOLD-CEN-1-R-YY   PIC 99.
  2936             20  FILLER                PIC 9(3).
  2937         16  HOLD-CENTURY-1-X.
  2938             20  FILLER                PIC X(3)  VALUE SPACES.
  2939             20  HOLD-CEN-1-X-CCYY.
  2940                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2941                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2942             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2943             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2944         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2945             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2946             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2947             20  HOLD-CEN-1-R-X-CCYY.
  2948                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2949                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2950             20  FILLER                PIC XXX.
  2951         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2952         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2953         16  DC-JULIAN-DATE-1          PIC 9(07).
  2954         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2955             20  DC-JULIAN-1-CCYY.
  2956                 24  DC-JULIAN-1-CC    PIC 99.
  2957                 24  DC-JULIAN-1-YR    PIC 99.
  2958             20  DC-JULIAN-DA-1        PIC 999.
  2959         16  DC-JULIAN-DATE-2          PIC 9(07).
  2960         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2961             20  DC-JULIAN-2-CCYY.
  2962                 24  DC-JULIAN-2-CC    PIC 99.
  2963                 24  DC-JULIAN-2-YR    PIC 99.
  2964             20  DC-JULIAN-DA-2        PIC 999.
  2965         16  DC-GREG-DATE-A-EDIT.
  2966             20  DC-EDITA-MONTH        PIC 99.
  2967             20  SLASHA-1              PIC X VALUE '/'.
  2968             20  DC-EDITA-DAY          PIC 99.
  2969             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  56
* EL131.cbl
  2970             20  DC-EDITA-CCYY.
  2971                 24  DC-EDITA-CENT     PIC 99.
  2972                 24  DC-EDITA-YEAR     PIC 99.
  2973         16  DC-GREG-DATE-B-EDIT.
  2974             20  DC-EDITB-MONTH        PIC 99.
  2975             20  SLASHB-1              PIC X VALUE '/'.
  2976             20  DC-EDITB-DAY          PIC 99.
  2977             20  SLASHB-2              PIC X VALUE '/'.
  2978             20  DC-EDITB-CCYY.
  2979                 24  DC-EDITB-CENT     PIC 99.
  2980                 24  DC-EDITB-YEAR     PIC 99.
  2981         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2982         16  DC-GREG-DATE-CYMD-R REDEFINES
  2983                              DC-GREG-DATE-CYMD.
  2984             20  DC-CYMD-CEN           PIC 99.
  2985             20  DC-CYMD-YEAR          PIC 99.
  2986             20  DC-CYMD-MONTH         PIC 99.
  2987             20  DC-CYMD-DAY           PIC 99.
  2988         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2989         16  DC-GREG-DATE-MDCY-R REDEFINES
  2990                              DC-GREG-DATE-MDCY.
  2991             20  DC-MDCY-MONTH         PIC 99.
  2992             20  DC-MDCY-DAY           PIC 99.
  2993             20  DC-MDCY-CEN           PIC 99.
  2994             20  DC-MDCY-YEAR          PIC 99.
  2995    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2996        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2997    12  DC-EL310-DATE                  PIC X(21).
  2998    12  FILLER                         PIC X(28).
  2999
  3000*                                COPY ELCDMO.
  3001******************************************************************
  3002*                                                                *
  3003*                                                                *
  3004*                            ELCDMO.                             *
  3005*                            VMOD=2.004                          *
  3006*                                                                *
  3007*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3008*        COMMUNICATION AREA                                      *
  3009*   FILE TYPE = NA                                               *
  3010*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3011*                                                                *
  3012******************************************************************
  3013 01  DMO-COMMUNICATION-AREA.
  3014     12  DM-RECORD-TYPE                  PIC  X(02).
  3015             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3016             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3017             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3018     12  DM-DIST-CODE                    PIC  X(04).
  3019     12  DM-MAIL-CODE                    PIC  X(05).
  3020     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3021     12  DM-INSURED-NAME                 PIC  X(30).
  3022     12  DM-CLAIM-NO                     PIC  X(07).
  3023     12  DM-CLAIM-TYPE                   PIC  X.
  3024
  3025     12  DM-STATUS-DATA-AREA.
  3026         16  DM-CLAIM-STATUS             PIC  X.
  3027             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  57
* EL131.cbl
  3028             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3029             88  DM-CLOSED                        VALUE '3'.
  3030             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3031             88  DM-DEFAULT                       VALUE '9'.
  3032         16  DM-STATUS-DATE              PIC  X(08).
  3033******YYYYMMDD
  3034         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3035             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3036             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3037             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3038             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3039             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3040             88  DM-RE-OPENED                     VALUE 'R'.
  3041             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3042             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3043             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3044         16  DM-STAT-CARRIER             PIC X.
  3045
  3046     12  DM-DRAFT-DATA-AREA.
  3047         16  DM-PAYMENT-TYPE             PIC  X.
  3048             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3049         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3050         16  DM-PAYMENT-DATE             PIC  X(08).
  3051******YYYYMMDD
  3052         16  DM-CERT-NO                  PIC  X(11).
  3053         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3054         16  DM-CARRIER                  PIC  X.
  3055
  3056     12  DM-RETURN-CODE                  PIC  XX.
  3057
  3058****************************************************************
  3059*
  3060* Copyright (c) 2007 by Clerity Solutions, Inc.
  3061* All rights reserved.
  3062*
  3063****************************************************************
  3064 01  DFHEIV.
  3065   02  DFHEIV0               PIC X(35).
  3066   02  DFHEIV1               PIC X(08).
  3067   02  DFHEIV2               PIC X(08).
  3068   02  DFHEIV3               PIC X(08).
  3069   02  DFHEIV4               PIC X(06).
  3070   02  DFHEIV5               PIC X(04).
  3071   02  DFHEIV6               PIC X(04).
  3072   02  DFHEIV7               PIC X(02).
  3073   02  DFHEIV8               PIC X(02).
  3074   02  DFHEIV9               PIC X(01).
  3075   02  DFHEIV10              PIC S9(7) COMP-3.
  3076   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3077   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3078   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3079   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3080   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3081   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3082   02  DFHEIV17              PIC X(04).
  3083   02  DFHEIV18              PIC X(04).
  3084   02  DFHEIV19              PIC X(04).
  3085   02  DFHEIV20              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  58
* EL131.cbl
  3086   02  DFHEIV21              USAGE IS POINTER.
  3087   02  DFHEIV22              USAGE IS POINTER.
  3088   02  DFHEIV23              USAGE IS POINTER.
  3089   02  DFHEIV24              USAGE IS POINTER.
  3090   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3091   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3092   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3093   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3094   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3095   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3096   02  FILLER                PIC X(02).
  3097   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3098   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3099   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3100   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3101   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3102 LINKAGE  SECTION.
  3103*****************************************************************
  3104*                                                               *
  3105* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3106* All rights reserved.                                          *
  3107*                                                               *
  3108*****************************************************************
  3109 01  dfheiblk.
  3110     02  eibtime          pic s9(7) comp-3.
  3111     02  eibdate          pic s9(7) comp-3.
  3112     02  eibtrnid         pic x(4).
  3113     02  eibtaskn         pic s9(7) comp-3.
  3114     02  eibtrmid         pic x(4).
  3115     02  dfheigdi         pic s9(4) comp.
  3116     02  eibcposn         pic s9(4) comp.
  3117     02  eibcalen         pic s9(4) comp.
  3118     02  eibaid           pic x(1).
  3119     02  eibfiller1       pic x(1).
  3120     02  eibfn            pic x(2).
  3121     02  eibfiller2       pic x(2).
  3122     02  eibrcode         pic x(6).
  3123     02  eibfiller3       pic x(2).
  3124     02  eibds            pic x(8).
  3125     02  eibreqid         pic x(8).
  3126     02  eibrsrce         pic x(8).
  3127     02  eibsync          pic x(1).
  3128     02  eibfree          pic x(1).
  3129     02  eibrecv          pic x(1).
  3130     02  eibsend          pic x(1).
  3131     02  eibatt           pic x(1).
  3132     02  eibeoc           pic x(1).
  3133     02  eibfmh           pic x(1).
  3134     02  eibcompl         pic x(1).
  3135     02  eibsig           pic x(1).
  3136     02  eibconf          pic x(1).
  3137     02  eiberr           pic x(1).
  3138     02  eibrldbk         pic x(1).
  3139     02  eiberrcd         pic x(4).
  3140     02  eibsynrb         pic x(1).
  3141     02  eibnodat         pic x(1).
  3142     02  eibfiller5       pic x(2).
  3143     02  eibresp          pic 9(09) comp.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  59
* EL131.cbl
  3144     02  eibresp2         pic 9(09) comp.
  3145     02  dfheigdj         pic s9(4) comp.
  3146     02  dfheigdk         pic s9(4) comp.
  3147 01  DFHCOMMAREA                 PIC X(1024).
  3148
  3149*                                COPY ELCMSTR.
  3150******************************************************************
  3151*                                                                *
  3152*                            ELCMSTR.                            *
  3153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3154*                            VMOD=2.012                          *
  3155*                                                                *
  3156*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3157*                                                                *
  3158*   FILE TYPE = VSAM,KSDS                                        *
  3159*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3160*                                                                *
  3161*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3162*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3163*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3164*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3165*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3166*                                                 RKP=75,LEN=21  *
  3167*                                                                *
  3168*   **** NOTE ****                                               *
  3169*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3170*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3171*                                                                *
  3172*   LOG = YES                                                    *
  3173*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3174******************************************************************
  3175*                   C H A N G E   L O G
  3176*
  3177* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3178*-----------------------------------------------------------------
  3179*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3180* EFFECTIVE    NUMBER
  3181*-----------------------------------------------------------------
  3182* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3183* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3184******************************************************************
  3185 01  CLAIM-MASTER.
  3186     12  CL-RECORD-ID                PIC XX.
  3187         88  VALID-CL-ID         VALUE 'CL'.
  3188
  3189     12  CL-CONTROL-PRIMARY.
  3190         16  CL-COMPANY-CD           PIC X.
  3191         16  CL-CARRIER              PIC X.
  3192         16  CL-CLAIM-NO             PIC X(7).
  3193         16  CL-CERT-NO.
  3194             20  CL-CERT-PRIME       PIC X(10).
  3195             20  CL-CERT-SFX         PIC X.
  3196
  3197     12  CL-CONTROL-BY-NAME.
  3198         16  CL-COMPANY-CD-A1        PIC X.
  3199         16  CL-INSURED-LAST-NAME    PIC X(15).
  3200         16  CL-INSURED-NAME.
  3201             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  60
* EL131.cbl
  3202             20  CL-INSURED-MID-INIT PIC X.
  3203
  3204     12  CL-CONTROL-BY-SSN.
  3205         16  CL-COMPANY-CD-A2        PIC X.
  3206         16  CL-SOC-SEC-NO.
  3207             20  CL-SSN-STATE        PIC XX.
  3208             20  CL-SSN-ACCOUNT      PIC X(6).
  3209             20  CL-SSN-LN3          PIC X(3).
  3210
  3211     12  CL-CONTROL-BY-CERT-NO.
  3212         16  CL-COMPANY-CD-A4        PIC X.
  3213         16  CL-CERT-NO-A4.
  3214             20  CL-CERT-A4-PRIME    PIC X(10).
  3215             20  CL-CERT-A4-SFX      PIC X.
  3216
  3217     12  CL-CONTROL-BY-CCN.
  3218         16  CL-COMPANY-CD-A5        PIC X.
  3219         16  CL-CCN-A5.
  3220             20  CL-CCN.
  3221                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3222                 24  CL-CCN-PRIME-A5 PIC X(12).
  3223             20  CL-CCN-FILLER-A5    PIC X(4).
  3224
  3225     12  CL-INSURED-PROFILE-DATA.
  3226         16  CL-INSURED-BIRTH-DT     PIC XX.
  3227         16  CL-INSURED-SEX-CD       PIC X.
  3228             88  INSURED-IS-MALE        VALUE 'M'.
  3229             88  INSURED-IS-FEMALE      VALUE 'F'.
  3230             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3231         16  CL-INSURED-OCC-CD       PIC X(6).
  3232         16  FILLER                  PIC X(5).
  3233
  3234     12  CL-PROCESSING-INFO.
  3235         16  CL-PROCESSOR-ID         PIC X(4).
  3236         16  CL-CLAIM-STATUS         PIC X.
  3237             88  CLAIM-IS-OPEN          VALUE 'O'.
  3238             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3239         16  CL-CLAIM-TYPE           PIC X.
  3240*            88  AH-CLAIM               VALUE 'A'.
  3241*            88  LIFE-CLAIM             VALUE 'L'.
  3242*            88  PROPERTY-CLAIM         VALUE 'P'.
  3243*            88  IUI-CLAIM              VALUE 'I'.
  3244*            88  GAP-CLAIM              VALUE 'G'.
  3245         16  CL-CLAIM-PREM-TYPE      PIC X.
  3246             88  SINGLE-PREMIUM         VALUE '1'.
  3247             88  O-B-COVERAGE           VALUE '2'.
  3248             88  OPEN-END-COVERAGE      VALUE '3'.
  3249         16  CL-INCURRED-DT          PIC XX.
  3250         16  CL-REPORTED-DT          PIC XX.
  3251         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3252         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3253         16  CL-LAST-PMT-DT          PIC XX.
  3254         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3255         16  CL-PAID-THRU-DT         PIC XX.
  3256         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3257         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3258         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3259         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  61
* EL131.cbl
  3260             88  CL-360-DAY-YR          VALUE '1'.
  3261             88  CL-365-DAY-YR          VALUE '2'.
  3262             88  CL-FULL-MONTHS         VALUE '3'.
  3263         16  CL-CAUSE-CD             PIC X(6).
  3264
  3265         16  CL-PRIME-CERT-NO.
  3266             20  CL-PRIME-CERT-PRIME PIC X(10).
  3267             20  CL-PRIME-CERT-SFX   PIC X.
  3268
  3269         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3270             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3271             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3272
  3273         16  CL-MICROFILM-NO         PIC X(10).
  3274         16  CL-PROG-FORM-TYPE       PIC X.
  3275         16  CL-LAST-ADD-ON-DT       PIC XX.
  3276
  3277         16  CL-LAST-REOPEN-DT       PIC XX.
  3278         16  CL-LAST-CLOSE-DT        PIC XX.
  3279         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3280             88  FINAL-PAID             VALUE '1'.
  3281             88  CLAIM-DENIED           VALUE '2'.
  3282             88  AUTO-CLOSE             VALUE '3'.
  3283             88  MANUAL-CLOSE           VALUE '4'.
  3284             88  BENEFITS-CHANGED       VALUE 'C'.
  3285             88  SETUP-ERRORS           VALUE 'E'.
  3286         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3287         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3288         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3289             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3290         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3291         16  FILLER                  PIC X.
  3292
  3293     12  CL-CERTIFICATE-DATA.
  3294         16  CL-CERT-ORIGIN          PIC X.
  3295             88  CERT-WAS-ONLINE        VALUE '1'.
  3296             88  CERT-WAS-CREATED       VALUE '2'.
  3297             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3298         16  CL-CERT-KEY-DATA.
  3299             20  CL-CERT-CARRIER     PIC X.
  3300             20  CL-CERT-GROUPING    PIC X(6).
  3301             20  CL-CERT-STATE       PIC XX.
  3302             20  CL-CERT-ACCOUNT.
  3303                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3304                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3305             20  CL-CERT-EFF-DT      PIC XX.
  3306
  3307     12  CL-STATUS-CONTROLS.
  3308         16  CL-PRIORITY-CD          PIC X.
  3309             88  CONFIDENTIAL-DATA      VALUE '8'.
  3310             88  HIGHEST-PRIORITY       VALUE '9'.
  3311         16  CL-SUPV-ATTN-CD         PIC X.
  3312             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3313             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3314         16  CL-PURGED-DT            PIC XX.
  3315         16  CL-RESTORED-DT          PIC XX.
  3316         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3317         16  CL-NEXT-RESEND-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  62
* EL131.cbl
  3318         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3319         16  FILLER                  PIC XX.
  3320         16  CL-LAST-MAINT-DT        PIC XX.
  3321         16  CL-LAST-MAINT-USER      PIC X(4).
  3322         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3323         16  CL-LAST-MAINT-TYPE      PIC X.
  3324             88  CLAIM-SET-UP           VALUE ' '.
  3325             88  PAYMENT-MADE           VALUE '1'.
  3326             88  LETTER-SENT            VALUE '2'.
  3327             88  MASTER-WAS-ALTERED     VALUE '3'.
  3328             88  MASTER-WAS-RESTORED    VALUE '4'.
  3329             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3330             88  FILE-CONVERTED         VALUE '6'.
  3331             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3332             88  ERROR-CORRECTION       VALUE 'E'.
  3333         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3334         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3335         16  CL-BENEFICIARY          PIC X(10).
  3336         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3337         16  CL-DENIAL-TYPE          PIC X.
  3338             88  CL-TYPE-DENIAL          VALUE '1'.
  3339             88  CL-TYPE-RESCISSION      VALUE '2'.
  3340             88  CL-TYPE-REFORMATION     VALUE '3'.
  3341             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3342             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3343         16  FILLER                  PIC X(5).
  3344
  3345     12  CL-TRAILER-CONTROLS.
  3346         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3347             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3348             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3349             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3350         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3351         16  FILLER                  PIC XX.
  3352         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3353         16  CL-ADDRESS-TRAILER-CNT.
  3354             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3355                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3356             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3357                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3358             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3359                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3360             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3361                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3362             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3363                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3364             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3365                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3366             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3367                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3368
  3369     12  CL-CV-REFERENCE-NO.
  3370         16  CL-CV-REFNO-PRIME       PIC X(18).
  3371         16  CL-CV-REFNO-SFX         PIC XX.
  3372
  3373     12  CL-FILE-LOCATION            PIC X(4).
  3374
  3375     12  CL-PROCESS-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  63
* EL131.cbl
  3376         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3377             88  NO-FATAL-ERRORS        VALUE ZERO.
  3378         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3379             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3380
  3381     12  CL-PRODUCT-CD               PIC X.
  3382
  3383     12  CL-CURRENT-KEY-DATA.
  3384         16  CL-CURRENT-CARRIER      PIC X.
  3385         16  CL-CURRENT-GROUPING     PIC X(6).
  3386         16  CL-CURRENT-STATE        PIC XX.
  3387         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3388
  3389     12  CL-ASSOCIATES               PIC X.
  3390         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3391         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3392         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3393         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3394
  3395     12  CL-ACTIVITY-CODE            PIC 99.
  3396     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3397     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3398
  3399     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3400     12  CL-LAG-REPORT-CODE          PIC 9.
  3401     12  CL-LOAN-TYPE                PIC XX.
  3402     12  CL-LEGAL-STATE              PIC XX.
  3403
  3404*    12  FILLER                      PIC X(5).
  3405     12  CL-YESNOSW                  PIC X.
  3406     12  FILLER                      PIC X(4).
  3407
  3408*                                COPY ELCCERT.
  3409******************************************************************
  3410*                                                                *
  3411*                            ELCCERT.                            *
  3412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3413*                            VMOD=2.013                          *
  3414*                                                                *
  3415*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3416*                                                                *
  3417*   FILE TYPE = VSAM,KSDS                                        *
  3418*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3419*                                                                *
  3420*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3421*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3422*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3423*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3424*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3425*                                                                *
  3426*   LOG = YES                                                    *
  3427*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3428******************************************************************
  3429*                   C H A N G E   L O G
  3430*
  3431* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3432*-----------------------------------------------------------------
  3433*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  64
* EL131.cbl
  3434* EFFECTIVE    NUMBER
  3435*-----------------------------------------------------------------
  3436* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3437* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3438* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3439* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3440* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3441* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3442* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3443* 032612  CR2011110200001  PEMA  AHL CHANGES
  3444******************************************************************
  3445
  3446 01  CERTIFICATE-MASTER.
  3447     12  CM-RECORD-ID                      PIC XX.
  3448         88  VALID-CM-ID                      VALUE 'CM'.
  3449
  3450     12  CM-CONTROL-PRIMARY.
  3451         16  CM-COMPANY-CD                 PIC X.
  3452         16  CM-CARRIER                    PIC X.
  3453         16  CM-GROUPING.
  3454             20  CM-GROUPING-PREFIX        PIC X(3).
  3455             20  CM-GROUPING-PRIME         PIC X(3).
  3456         16  CM-STATE                      PIC XX.
  3457         16  CM-ACCOUNT.
  3458             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3459             20  CM-ACCOUNT-PRIME          PIC X(6).
  3460         16  CM-CERT-EFF-DT                PIC XX.
  3461         16  CM-CERT-NO.
  3462             20  CM-CERT-PRIME             PIC X(10).
  3463             20  CM-CERT-SFX               PIC X.
  3464
  3465     12  CM-CONTROL-BY-NAME.
  3466         16  CM-COMPANY-CD-A1              PIC X.
  3467         16  CM-INSURED-LAST-NAME          PIC X(15).
  3468         16  CM-INSURED-INITIALS.
  3469             20  CM-INSURED-INITIAL1       PIC X.
  3470             20  CM-INSURED-INITIAL2       PIC X.
  3471
  3472     12  CM-CONTROL-BY-SSN.
  3473         16  CM-COMPANY-CD-A2              PIC X.
  3474         16  CM-SOC-SEC-NO.
  3475             20  CM-SSN-STATE              PIC XX.
  3476             20  CM-SSN-ACCOUNT            PIC X(6).
  3477             20  CM-SSN-LN3.
  3478                 25  CM-INSURED-INITIALS-A2.
  3479                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3480                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3481                 25 CM-PART-LAST-NAME-A2         PIC X.
  3482
  3483     12  CM-CONTROL-BY-CERT-NO.
  3484         16  CM-COMPANY-CD-A4              PIC X.
  3485         16  CM-CERT-NO-A4                 PIC X(11).
  3486
  3487     12  CM-CONTROL-BY-MEMB.
  3488         16  CM-COMPANY-CD-A5              PIC X.
  3489         16  CM-MEMBER-NO.
  3490             20  CM-MEMB-STATE             PIC XX.
  3491             20  CM-MEMB-ACCOUNT           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  65
* EL131.cbl
  3492             20  CM-MEMB-LN4.
  3493                 25  CM-INSURED-INITIALS-A5.
  3494                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3495                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3496                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3497
  3498     12  CM-INSURED-PROFILE-DATA.
  3499         16  CM-INSURED-FIRST-NAME.
  3500             20  CM-INSURED-1ST-INIT       PIC X.
  3501             20  FILLER                    PIC X(9).
  3502         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3503         16  CM-INSURED-SEX                PIC X.
  3504             88  CM-SEX-MALE                  VALUE 'M'.
  3505             88  CM-SEX-FEMAL                 VALUE 'F'.
  3506         16  CM-INSURED-JOINT-AGE          PIC 99.
  3507         16  CM-JOINT-INSURED-NAME.
  3508             20  CM-JT-LAST-NAME           PIC X(15).
  3509             20  CM-JT-FIRST-NAME.
  3510                 24  CM-JT-1ST-INIT        PIC X.
  3511                 24  FILLER                PIC X(9).
  3512             20  CM-JT-INITIAL             PIC X.
  3513
  3514     12  CM-LIFE-DATA.
  3515         16  CM-LF-BENEFIT-CD              PIC XX.
  3516         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3517         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3518         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3519         16  CM-LF-DEV-CODE                PIC XXX.
  3520         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3521         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3522         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3523         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3524         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3525         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3526         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3527         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3528         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3529         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3530         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3531         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3532         16  FILLER                        PIC XX.
  3533
  3534     12  CM-AH-DATA.
  3535         16  CM-AH-BENEFIT-CD              PIC XX.
  3536         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3537         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3538         16  CM-AH-DEV-CODE                PIC XXX.
  3539         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3540         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3541         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3542         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3543         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3544         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3545         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3546         16  CM-AH-PAID-THRU-DT            PIC XX.
  3547             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3548         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3549         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  66
* EL131.cbl
  3550         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3551         16  FILLER                        PIC X.
  3552
  3553     12  CM-LOAN-INFORMATION.
  3554         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3555         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3556                                           PIC S9(5)V99  COMP-3.
  3557         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3558         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3559         16  CM-PAY-FREQUENCY              PIC S99.
  3560         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3561         16  CM-RATE-CLASS                 PIC XX.
  3562         16  CM-BENEFICIARY                PIC X(25).
  3563         16  CM-POLICY-FORM-NO             PIC X(12).
  3564         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3565         16  CM-LAST-ADD-ON-DT             PIC XX.
  3566         16  CM-DEDUCTIBLE-AMOUNTS.
  3567             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3568             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3569         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3570             20  CM-RESIDENT-STATE         PIC XX.
  3571             20  CM-RATE-CODE              PIC X(4).
  3572             20  FILLER                    PIC XX.
  3573         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3574             20  CM-LOAN-OFFICER           PIC X(5).
  3575             20  FILLER                    PIC XXX.
  3576         16  CM-CSR-CODE                   PIC XXX.
  3577         16  CM-UNDERWRITING-CODE          PIC X.
  3578             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3579         16  CM-POST-CARD-IND              PIC X.
  3580         16  CM-NH-INTERFACE-SW            PIC X.
  3581         16  CM-PREMIUM-TYPE               PIC X.
  3582             88  CM-SING-PRM                  VALUE '1'.
  3583             88  CM-O-B-COVERAGE              VALUE '2'.
  3584             88  CM-OPEN-END                  VALUE '3'.
  3585         16  CM-IND-GRP-TYPE               PIC X.
  3586             88  CM-INDIVIDUAL                VALUE 'I'.
  3587             88  CM-GROUP                     VALUE 'G'.
  3588         16  CM-SKIP-CODE                  PIC X.
  3589             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3590             88  SKIP-JULY                    VALUE '1'.
  3591             88  SKIP-AUGUST                  VALUE '2'.
  3592             88  SKIP-SEPTEMBER               VALUE '3'.
  3593             88  SKIP-JULY-AUG                VALUE '4'.
  3594             88  SKIP-AUG-SEPT                VALUE '5'.
  3595             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3596             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3597             88  SKIP-JUNE                    VALUE '8'.
  3598             88  SKIP-JUNE-JULY               VALUE '9'.
  3599             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3600             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3601         16  CM-PAYMENT-MODE               PIC X.
  3602             88  PAY-MONTHLY                  VALUE SPACE.
  3603             88  PAY-WEEKLY                   VALUE '1'.
  3604             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3605             88  PAY-BI-WEEKLY                VALUE '3'.
  3606             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3607         16  CM-LOAN-NUMBER                PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  67
* EL131.cbl
  3608         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3609         16  CM-OLD-LOF                    PIC XXX.
  3610*        16  CM-LOAN-OFFICER               PIC XXX.
  3611         16  CM-REIN-TABLE                 PIC XXX.
  3612         16  CM-SPECIAL-REIN-CODE          PIC X.
  3613         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3614         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3615         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3616
  3617     12  CM-STATUS-DATA.
  3618         16  CM-ENTRY-STATUS               PIC X.
  3619         16  CM-ENTRY-DT                   PIC XX.
  3620
  3621         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3622         16  CM-LF-CANCEL-DT               PIC XX.
  3623         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3624
  3625         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3626         16  CM-LF-DEATH-DT                PIC XX.
  3627         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3628
  3629         16  CM-LF-CURRENT-STATUS          PIC X.
  3630             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3631                                                'M' '4' '5' '9'.
  3632             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3633             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3634             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3635             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3636             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3637             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3638             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3639             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3640             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3641             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3642             88  CM-LF-DECLINED               VALUE 'D'.
  3643             88  CM-LF-VOIDED                 VALUE 'V'.
  3644
  3645         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3646         16  CM-AH-CANCEL-DT               PIC XX.
  3647         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3648
  3649         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3650         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3651         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3652
  3653         16  CM-AH-CURRENT-STATUS          PIC X.
  3654             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3655                                                'M' '4' '5' '9'.
  3656             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3657             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3658             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3659             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3660             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3661             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3662             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3663             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3664             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3665             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  68
* EL131.cbl
  3666             88  CM-AH-DECLINED               VALUE 'D'.
  3667             88  CM-AH-VOIDED                 VALUE 'V'.
  3668
  3669         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3670             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3671             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3672             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3673         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3674
  3675         16  CM-ENTRY-BATCH                PIC X(6).
  3676         16  CM-LF-EXIT-BATCH              PIC X(6).
  3677         16  CM-AH-EXIT-BATCH              PIC X(6).
  3678         16  CM-LAST-MONTH-END             PIC XX.
  3679
  3680     12  CM-NOTE-SW                        PIC X.
  3681         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3682         88  CERT-NOTES-PRESENT               VALUE '1'.
  3683         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3684         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3685         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3686         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3687         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3688         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3689     12  CM-COMP-EXCP-SW                   PIC X.
  3690         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3691         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3692     12  CM-INSURED-ADDRESS-SW             PIC X.
  3693         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  3694         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3695
  3696*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3697     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  3698     12  FILLER                            PIC X.
  3699
  3700*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  3701     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3702     12  FILLER                            PIC X.
  3703*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3704     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3705
  3706     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3707         88  CERT-ADDED-BATCH                 VALUE ' '.
  3708         88  CERT-ADDED-ONLINE                VALUE '1'.
  3709         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3710         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3711         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3712     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3713         88  CERT-AS-LOADED                   VALUE ' '.
  3714         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3715         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3716         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3717         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3718         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3719         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3720         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3721
  3722     12  CM-ACCOUNT-COMM-PCTS.
  3723         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  69
* EL131.cbl
  3724         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3725
  3726     12  CM-USER-FIELD                     PIC X.
  3727     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  3728     12  CM-CLP-STATE                      PIC XX.
  3729     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  3730     12  CM-USER-RESERVED                  PIC XXX.
  3731     12  FILLER REDEFINES CM-USER-RESERVED.
  3732         16  CM-AH-CLASS-CD                PIC XX.
  3733         16  F                             PIC X.
  3734******************************************************************
  3735
  3736*                                COPY ELCTRLR.
  3737******************************************************************
  3738*                                                                *
  3739*                            ELCTRLR.                            *
  3740*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3741*                            VMOD=2.014                          *
  3742*                                                                *
  3743*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  3744*                                                                *
  3745*   FILE TYPE = VSAM,KSDS                                        *
  3746*   RECORD SIZE = 200    RECFORM = FIXED                         *
  3747*                                                                *
  3748*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  3749*       ALTERNATE INDEX = NONE                                   *
  3750*                                                                *
  3751*   LOG = YES                                                    *
  3752*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3753******************************************************************
  3754*                   C H A N G E   L O G
  3755*
  3756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3757*-----------------------------------------------------------------
  3758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3759* EFFECTIVE    NUMBER
  3760*-----------------------------------------------------------------
  3761* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3762* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  3763* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  3764* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  3765* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  3766* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  3767* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  3768* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  3769* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  3770* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  3771* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  3772* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  3773* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  3774******************************************************************
  3775 01  ACTIVITY-TRAILERS.
  3776     12  AT-RECORD-ID                    PIC XX.
  3777         88  VALID-AT-ID                       VALUE 'AT'.
  3778
  3779     12  AT-CONTROL-PRIMARY.
  3780         16  AT-COMPANY-CD               PIC X.
  3781         16  AT-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  70
* EL131.cbl
  3782         16  AT-CLAIM-NO                 PIC X(7).
  3783         16  AT-CERT-NO.
  3784             20  AT-CERT-PRIME           PIC X(10).
  3785             20  AT-CERT-SFX             PIC X.
  3786         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  3787             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  3788             88  AT-LAST-TRL-AVAIL            VALUE +100.
  3789             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  3790             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  3791             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  3792             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  3793             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  3794             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  3795             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  3796             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  3797             88  AT-DIAGNOSIS-TRL             VALUE +90.
  3798             88  AT-BENEFICIARY-TRL           VALUE +91.
  3799             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  3800             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  3801
  3802     12  AT-TRAILER-TYPE                 PIC X.
  3803         88  RESERVE-EXPENSE-TR               VALUE '1'.
  3804         88  PAYMENT-TR                       VALUE '2'.
  3805         88  AUTO-PAY-TR                      VALUE '3'.
  3806         88  CORRESPONDENCE-TR                VALUE '4'.
  3807         88  ADDRESS-TR                       VALUE '5'.
  3808         88  GENERAL-INFO-TR                  VALUE '6'.
  3809         88  AUTO-PROMPT-TR                   VALUE '7'.
  3810         88  DENIAL-TR                        VALUE '8'.
  3811         88  INCURRED-CHG-TR                  VALUE '9'.
  3812         88  FORM-CONTROL-TR                  VALUE 'A'.
  3813
  3814     12  AT-RECORDED-DT                  PIC XX.
  3815     12  AT-RECORDED-BY                  PIC X(4).
  3816     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  3817
  3818     12  AT-TRAILER-BODY                 PIC X(165).
  3819
  3820     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  3821         16  AT-RESERVE-CONTROLS.
  3822             20  AT-MANUAL-SW            PIC X.
  3823                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  3824             20  AT-FUTURE-SW            PIC X.
  3825                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  3826             20  AT-PTC-SW               PIC X.
  3827                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  3828             20  AT-IBNR-SW              PIC X.
  3829                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  3830             20  AT-PTC-LF-SW            PIC X.
  3831                 88  AT-LF-PTC-USED          VALUE '1'.
  3832             20  AT-CDT-ACCESS-METHOD    PIC X.
  3833                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  3834                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  3835                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  3836             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  3837         16  AT-LAST-COMPUTED-DT         PIC XX.
  3838         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  3839         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  71
* EL131.cbl
  3840         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  3841         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3842         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  3843         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  3844         16  AT-EXPENSE-CONTROLS.
  3845             20  AT-EXPENSE-METHOD       PIC X.
  3846                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  3847                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  3848                 88  PERCENT-OF-PMT           VALUE '3'.
  3849                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  3850             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  3851             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  3852         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  3853         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  3854
  3855         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  3856         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  3857
  3858*        16  FILLER                      PIC X(53).
  3859         16  FILLER                      PIC X(47).
  3860
  3861         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  3862         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  3863
  3864         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  3865             20  AT-OPEN-CLOSE-DATE      PIC XX.
  3866             20  AT-OPEN-CLOSE-TYPE      PIC X.
  3867*                    C = CLOSED
  3868*                    O = OPEN
  3869             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  3870*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  3871
  3872     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  3873         16  AT-PAYMENT-TYPE             PIC X.
  3874             88  PARTIAL-PAYMENT                VALUE '1'.
  3875             88  FINAL-PAYMENT                  VALUE '2'.
  3876             88  LUMP-SUM-PAYMENT               VALUE '3'.
  3877             88  ADDITIONAL-PAYMENT             VALUE '4'.
  3878             88  CHARGEABLE-EXPENSE             VALUE '5'.
  3879             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  3880             88  VOIDED-PAYMENT                 VALUE '9'.
  3881             88  TRANSFER                       VALUE 'T'.
  3882             88  LIFE-INTEREST                  VALUE 'I'.
  3883
  3884         16  AT-CLAIM-TYPE               PIC X.
  3885             88  PAID-FOR-AH                    VALUE 'A'.
  3886             88  PAID-FOR-LIFE                  VALUE 'L'.
  3887             88  PAID-FOR-IUI                   VALUE 'I'.
  3888             88  PAID-FOR-GAP                   VALUE 'G'.
  3889         16  AT-CLAIM-PREM-TYPE          PIC X.
  3890             88  AT-SINGLE-PREMIUM              VALUE '1'.
  3891             88  AT-O-B-COVERAGE                VALUE '2'.
  3892             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  3893         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  3894         16  AT-CHECK-NO                 PIC X(7).
  3895         16  AT-PAID-FROM-DT             PIC XX.
  3896         16  AT-PAID-THRU-DT             PIC XX.
  3897         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  72
* EL131.cbl
  3898         16  FILLER                      PIC X.
  3899         16  AT-PAYEES-NAME              PIC X(30).
  3900         16  AT-PAYMENT-ORIGIN           PIC X.
  3901             88  ONLINE-MANUAL-PMT              VALUE '1'.
  3902             88  ONLINE-AUTO-PMT                VALUE '2'.
  3903             88  OFFLINE-PMT                    VALUE '3'.
  3904         16  AT-CHECK-WRITTEN-DT         PIC XX.
  3905         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  3906         16  AT-VOID-DATA.
  3907             20  AT-VOID-DT              PIC XX.
  3908*00144       20  AT-VOID-REASON          PIC X(30).
  3909             20  AT-VOID-REASON          PIC X(26).
  3910         16  AT-PMT-APPROVED-BY          PIC X(04).
  3911         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  3912         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  3913         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  3914                                         PIC S99V9(5)  COMP-3.
  3915         16  AT-CREDIT-INTERFACE.
  3916             20  AT-PMT-SELECT-DT        PIC XX.
  3917                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  3918             20  AT-PMT-ACCEPT-DT        PIC XX.
  3919                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  3920             20  AT-VOID-SELECT-DT       PIC XX.
  3921                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  3922             20  AT-VOID-ACCEPT-DT       PIC XX.
  3923                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  3924
  3925         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  3926                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3927                 88  CONVERSION-PAYMENT           VALUE +99999999.
  3928         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  3929
  3930         16  AT-FORCE-CONTROL            PIC X.
  3931             88  PAYMENT-WAS-FORCED           VALUE '1'.
  3932         16  AT-PREV-LAST-PMT-DT         PIC XX.
  3933         16  AT-PREV-PAID-THRU-DT        PIC XX.
  3934         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  3935         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  3936         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  3937         16  AT-BENEFIT-TYPE             PIC X.
  3938
  3939         16  AT-EXPENSE-TYPE             PIC X.
  3940         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  3941
  3942         16  AT-PAYEE-TYPE-CD.
  3943             20  AT-PAYEE-TYPE           PIC X.
  3944                 88  INSURED-PAID           VALUE 'I'.
  3945                 88  BENEFICIARY-PAID       VALUE 'B'.
  3946                 88  ACCOUNT-PAID           VALUE 'A'.
  3947                 88  OTHER-1-PAID           VALUE 'O'.
  3948                 88  OTHER-2-PAID           VALUE 'Q'.
  3949                 88  DOCTOR-PAID            VALUE 'P'.
  3950                 88  EMPLOYER-PAID          VALUE 'E'.
  3951             20  AT-PAYEE-SEQ            PIC X.
  3952
  3953         16  AT-CASH-PAYMENT             PIC X.
  3954         16  AT-GROUPED-PAYMENT          PIC X.
  3955         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  73
* EL131.cbl
  3956         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  3957         16  AT-APPROVED-LEVEL           PIC X.
  3958         16  AT-VOID-TYPE                PIC X.
  3959             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  3960             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  3961         16  AT-AIG-UNEMP-IND            PIC X.
  3962             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  3963         16  AT-ASSOCIATES               PIC X.
  3964             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  3965             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  3966
  3967         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  3968         16  AT-CV-PMT-CODE              PIC X.
  3969             88  FULL-DEATH-PAYMENT         VALUE '1'.
  3970             88  HALF-DEATH-PAYMENT         VALUE '2'.
  3971             88  FULL-ADD-PAYMENT           VALUE '3'.
  3972             88  HALF-ADD-PAYMENT           VALUE '4'.
  3973             88  FULL-RIDER-PAYMENT         VALUE '5'.
  3974             88  HALF-RIDER-PAYMENT         VALUE '6'.
  3975             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  3976             88  ADDL-PAYMENT               VALUE '8'.
  3977
  3978         16  AT-EOB-CODE1                PIC XXX.
  3979         16  AT-EOB-CODE2                PIC XXX.
  3980         16  AT-EOB-CODE3                PIC XXX.
  3981         16  AT-EOB-CODE4                PIC XXX.
  3982         16  FILLER REDEFINES AT-EOB-CODE4.
  3983             20  AT-INT-PMT-SELECT-DT    PIC XX.
  3984             20  FILLER                  PIC X.
  3985         16  AT-EOB-CODE5                PIC XXX.
  3986         16  FILLER REDEFINES AT-EOB-CODE5.
  3987             20  AT-PMT-PROOF-DT         PIC XX.
  3988             20  FILLER                  PIC X.
  3989
  3990         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  3991             88  AT-PRINT-EOB            VALUE 'Y'.
  3992
  3993         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  3994         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  3995
  3996     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  3997         16  AT-SCHEDULE-START-DT        PIC XX.
  3998         16  AT-SCHEDULE-END-DT          PIC XX.
  3999         16  AT-TERMINATED-DT            PIC XX.
  4000         16  AT-LAST-PMT-TYPE            PIC X.
  4001             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4002             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4003         16  AT-FIRST-PMT-DATA.
  4004             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4005             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4006             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4007         16  AT-REGULAR-PMT-DATA.
  4008             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4009             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4010             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4011         16  AT-AUTO-PAYEE-CD.
  4012             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4013                 88  INSURED-PAID-AUTO      VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  74
* EL131.cbl
  4014                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4015                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4016                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4017                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4018             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4019         16  AT-AUTO-PAY-DAY             PIC 99.
  4020         16  AT-AUTO-CASH                PIC X.
  4021             88  AT-CASH                      VALUE 'Y'.
  4022             88  AT-NON-CASH                  VALUE 'N'.
  4023*        16  FILLER                      PIC X(129).
  4024         16  AT-AUTO-END-LETTER          PIC X(4).
  4025         16  FILLER                      PIC X(125).
  4026
  4027         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4028         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4029
  4030     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4031         16  AT-LETTER-SENT-DT           PIC XX.
  4032         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4033         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4034         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4035         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4036         16  AT-LETTER-ORIGIN            PIC X.
  4037             88  ONLINE-CREATION              VALUE '1' '3'.
  4038             88  OFFLINE-CREATION             VALUE '2' '4'.
  4039             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4040             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4041         16  AT-STD-LETTER-FORM          PIC X(4).
  4042         16  AT-REASON-TEXT              PIC X(70).
  4043         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4044         16  AT-ADDRESEE-TYPE            PIC X.
  4045              88  INSURED-ADDRESEE            VALUE 'I'.
  4046              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4047              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4048              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4049              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4050              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4051              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4052         16  AT-ADDRESSEE-NAME           PIC X(30).
  4053         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4054         16  AT-RESEND-PRINT-DATE        PIC XX.
  4055         16  AT-CORR-SOL-UNSOL           PIC X.
  4056         16  AT-LETTER-PURGED-DT         PIC XX.
  4057*
  4058*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4059*
  4060         16  AT-CSO-REDEFINITION.
  4061             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4062             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4063             20  AT-LETTER-TO-BENE       PIC X(1).
  4064             20  AT-STOP-LETTER-DT       PIC X(2).
  4065             20  FILLER                  PIC X(19).
  4066*             20  FILLER                  PIC X(27).
  4067             20  AT-CSO-LETTER-STATUS    PIC X.
  4068                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4069                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4070                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4071             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  75
* EL131.cbl
  4072             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4073*
  4074*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4075*
  4076*        16  FILLER                      PIC X(26).
  4077*
  4078*        16  AT-DMD-BSR-CODE             PIC X.
  4079*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4080*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4081*
  4082*        16  AT-DMD-LETTER-STATUS        PIC X.
  4083*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4084*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4085*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4086*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4087*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4088
  4089         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4090         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4091
  4092     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4093         16  AT-ADDRESS-TYPE             PIC X.
  4094             88  INSURED-ADDRESS               VALUE 'I'.
  4095             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4096             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4097             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4098             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4099             88  OTHER-ADDRESS-1               VALUE 'O'.
  4100             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4101         16  AT-MAIL-TO-NAME             PIC X(30).
  4102         16  AT-ADDRESS-LINE-1           PIC X(30).
  4103         16  AT-ADDRESS-LINE-2           PIC X(30).
  4104         16  AT-CITY-STATE.
  4105             20  AT-CITY                 PIC X(28).
  4106             20  AT-STATE                PIC XX.
  4107         16  AT-ZIP.
  4108             20  AT-ZIP-CODE.
  4109                 24  AT-ZIP-1ST          PIC X.
  4110                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4111                 24  FILLER              PIC X(4).
  4112             20  AT-ZIP-PLUS4            PIC X(4).
  4113         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4114             20  AT-CAN-POSTAL-1         PIC XXX.
  4115             20  AT-CAN-POSTAL-2         PIC XXX.
  4116             20  FILLER                  PIC XXX.
  4117         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4118*         16  FILLER                      PIC X(23).
  4119         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4120         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4121         16  FILLER                      PIC X(13).
  4122         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4123         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4124
  4125     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4126         16  AT-INFO-LINE-1              PIC X(60).
  4127         16  AT-INFO-LINE-2              PIC X(60).
  4128         16  AT-INFO-TRAILER-TYPE        PIC X.
  4129             88  AT-PAYMENT-NOTE         VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  76
* EL131.cbl
  4130             88  AT-CALL-NOTE            VALUE 'C'.
  4131             88  AT-MAINT-NOTE           VALUE 'M'.
  4132             88  AT-CERT-CHANGE          VALUE 'X'.
  4133             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4134             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4135         16  AT-CALL-TYPE                PIC X.
  4136             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4137             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4138         16  AT-NOTE-CONTINUATION        PIC X.
  4139             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4140         16  AT-EOB-CODES-EXIST          PIC X.
  4141             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4142         16  FILLER                      PIC X(35).
  4143         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4144         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4145
  4146     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4147         16  AT-PROMPT-LINE-1            PIC X(60).
  4148         16  AT-PROMPT-LINE-2            PIC X(60).
  4149         16  AT-PROMPT-START-DT          PIC XX.
  4150         16  AT-PROMPT-END-DT            PIC XX.
  4151         16  FILLER                      PIC X(35).
  4152         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4153         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4154
  4155     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4156         16  AT-DENIAL-INFO-1            PIC X(60).
  4157         16  AT-DENIAL-INFO-2            PIC X(60).
  4158         16  AT-DENIAL-DT                PIC XX.
  4159         16  AT-RETRACTION-DT            PIC XX.
  4160         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4161*         16  FILLER                      PIC X(31).
  4162         16  AT-DENIAL-PROOF-DT          PIC XX.
  4163         16  FILLER                      PIC X(29).
  4164         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4165         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4166
  4167     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4168         16  AT-OLD-INCURRED-DT          PIC XX.
  4169         16  AT-OLD-REPORTED-DT          PIC XX.
  4170         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4171         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4172         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4173         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4174         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4175         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4176         16  FILLER                      PIC X(26).
  4177         16  AT-OLD-DIAG-CODE            PIC X(6).
  4178         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4179         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4180         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4181         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4182         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4183         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4184         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4185         16  FILLER                      PIC X(25).
  4186         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4187
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  77
* EL131.cbl
  4188     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4189         16  AT-FORM-SEND-ON-DT          PIC XX.
  4190         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4191         16  AT-FORM-RE-SEND-DT          PIC XX.
  4192         16  AT-FORM-ANSWERED-DT         PIC XX.
  4193         16  AT-FORM-PRINTED-DT          PIC XX.
  4194         16  AT-FORM-REPRINT-DT          PIC XX.
  4195         16  AT-FORM-TYPE                PIC X.
  4196             88  INITIAL-FORM                  VALUE '1'.
  4197             88  PROGRESS-FORM                 VALUE '2'.
  4198         16  AT-INSTRUCT-LN-1            PIC X(28).
  4199         16  AT-INSTRUCT-LN-2            PIC X(28).
  4200         16  AT-INSTRUCT-LN-3            PIC X(28).
  4201         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4202         16  AT-FORM-ADDRESS             PIC X.
  4203             88  FORM-TO-INSURED              VALUE 'I'.
  4204             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4205             88  FORM-TO-OTHER-1              VALUE 'O'.
  4206             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4207         16  AT-RELATED-1.
  4208             20 AT-REL-CARR-1            PIC X.
  4209             20 AT-REL-CLAIM-1           PIC X(7).
  4210             20 AT-REL-CERT-1            PIC X(11).
  4211         16  AT-RELATED-2.
  4212             20 AT-REL-CARR-2            PIC X.
  4213             20 AT-REL-CLAIM-2           PIC X(7).
  4214             20 AT-REL-CERT-2            PIC X(11).
  4215         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4216         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4217         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4218         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4219         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4220         16  AT-STOP-FORM-DT             PIC X(2).
  4221
  4222         16  FILLER                      PIC X(09).
  4223         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4224         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4225******************************************************************
  4226
  4227*                                COPY ELCCNTL.
  4228******************************************************************
  4229*                                                                *
  4230*                                                                *
  4231*                            ELCCNTL.                            *
  4232*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4233*                            VMOD=2.059                          *
  4234*                                                                *
  4235*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4236*                                                                *
  4237*   FILE TYPE = VSAM,KSDS                                        *
  4238*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4239*                                                                *
  4240*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4241*       ALTERNATE INDEX = NONE                                   *
  4242*                                                                *
  4243*   LOG = YES                                                    *
  4244*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4245******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  78
* EL131.cbl
  4246*                   C H A N G E   L O G
  4247*
  4248* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4249*-----------------------------------------------------------------
  4250*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4251* EFFECTIVE    NUMBER
  4252*-----------------------------------------------------------------
  4253* 082503                   PEMA  ADD BENEFIT GROUP
  4254* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4255* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4256* 092705    2005050300006  PEMA  ADD SPP LEASES
  4257* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4258* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4259* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4260* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4261* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4262******************************************************************
  4263*
  4264 01  CONTROL-FILE.
  4265     12  CF-RECORD-ID                       PIC XX.
  4266         88  VALID-CF-ID                        VALUE 'CF'.
  4267
  4268     12  CF-CONTROL-PRIMARY.
  4269         16  CF-COMPANY-ID                  PIC XXX.
  4270         16  CF-RECORD-TYPE                 PIC X.
  4271             88  CF-COMPANY-MASTER              VALUE '1'.
  4272             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4273             88  CF-STATE-MASTER                VALUE '3'.
  4274             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4275             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4276             88  CF-CARRIER-MASTER              VALUE '6'.
  4277             88  CF-MORTALITY-MASTER            VALUE '7'.
  4278             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4279             88  CF-TERMINAL-MASTER             VALUE '9'.
  4280             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4281             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4282             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4283             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4284             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4285             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4286             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4287             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4288             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4289         16  CF-ACCESS-CD-GENL              PIC X(4).
  4290         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4291             20  CF-PROCESSOR               PIC X(4).
  4292         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4293             20  CF-STATE-CODE              PIC XX.
  4294             20  FILLER                     PIC XX.
  4295         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4296             20  FILLER                     PIC XX.
  4297             20  CF-HI-BEN-IN-REC           PIC XX.
  4298         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4299             20  FILLER                     PIC XXX.
  4300             20  CF-CARRIER-CNTL            PIC X.
  4301         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4302             20  FILLER                     PIC XX.
  4303             20  CF-HI-TYPE-IN-REC          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  79
* EL131.cbl
  4304         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4305             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4306                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4307             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4308             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4309         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4310             20  FILLER                     PIC X.
  4311             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4312         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4313             20  FILLER                     PIC XX.
  4314             20  CF-MORTGAGE-PLAN           PIC XX.
  4315         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4316
  4317     12  CF-LAST-MAINT-DT                   PIC XX.
  4318     12  CF-LAST-MAINT-BY                   PIC X(4).
  4319     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4320
  4321     12  CF-RECORD-BODY                     PIC X(728).
  4322
  4323
  4324****************************************************************
  4325*             COMPANY MASTER RECORD                            *
  4326****************************************************************
  4327
  4328     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4329         16  CF-COMPANY-ADDRESS.
  4330             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4331             20  CF-CL-IN-CARE-OF           PIC X(30).
  4332             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4333             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4334             20  CF-CL-CITY-STATE           PIC X(30).
  4335             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4336             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4337         16  CF-COMPANY-CD                  PIC X.
  4338         16  CF-COMPANY-PASSWORD            PIC X(8).
  4339         16  CF-SECURITY-OPTION             PIC X.
  4340             88  ALL-SECURITY                   VALUE '1'.
  4341             88  COMPANY-VERIFY                 VALUE '2'.
  4342             88  PROCESSOR-VERIFY               VALUE '3'.
  4343             88  NO-SECURITY                    VALUE '4'.
  4344             88  ALL-BUT-TERM                   VALUE '5'.
  4345         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4346             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4347         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4348             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4349         16  CF-INFORCE-LOCATION            PIC X.
  4350             88  CERTS-ARE-ONLINE               VALUE '1'.
  4351             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4352             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4353         16  CF-LOWER-CASE-LETTERS          PIC X.
  4354         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4355             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4356             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4357             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4358             88  CF-ACCNT-CNTL                  VALUE '3'.
  4359             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4360
  4361         16  CF-FORMS-PRINTER-ID            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  80
* EL131.cbl
  4362         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4363
  4364         16  CF-LGX-CREDIT-USER             PIC X.
  4365             88  CO-IS-NOT-USER                 VALUE 'N'.
  4366             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4367
  4368         16 CF-CREDIT-CALC-CODES.
  4369             20  CF-CR-REM-TERM-CALC PIC X.
  4370               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4371               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4372               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4373               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4374               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4375               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4376               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4377             20  CF-CR-R78-METHOD           PIC X.
  4378               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4379               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4380
  4381         16  CF-CLAIM-CONTROL-COUNTS.
  4382             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4383                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4384
  4385             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4386                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4387
  4388             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4389                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4390
  4391             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4392                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4393
  4394         16  CF-CURRENT-MONTH-END           PIC XX.
  4395
  4396         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4397             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4398             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4399             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4400             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4401                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4402                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4403             20  CF-CO-PREM-REJECT-SW       PIC X.
  4404                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4405                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4406             20  CF-CO-REF-REJECT-SW        PIC X.
  4407                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4408                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4409
  4410         16  CF-CO-REPORTING-DT             PIC XX.
  4411         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4412         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4413           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4414           88  CF-CO-MONTH-END                  VALUE '1'.
  4415
  4416         16  CF-LGX-CLAIM-USER              PIC X.
  4417             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4418             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4419
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  81
* EL131.cbl
  4420         16  CF-CREDIT-EDIT-CONTROLS.
  4421             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4422             20  CF-MIN-AGE                 PIC 99.
  4423             20  CF-DEFAULT-AGE             PIC 99.
  4424             20  CF-MIN-TERM                PIC S999      COMP-3.
  4425             20  CF-MAX-TERM                PIC S999      COMP-3.
  4426             20  CF-DEFAULT-SEX             PIC X.
  4427             20  CF-JOINT-AGE-INPUT         PIC X.
  4428                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4429             20  CF-BIRTH-DATE-INPUT        PIC X.
  4430                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4431             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4432                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4433                 88  CF-ZERO-CARRIER            VALUE '1'.
  4434                 88  CF-ZERO-GROUPING           VALUE '2'.
  4435                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4436             20  CF-EDIT-SW                 PIC X.
  4437                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4438             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4439             20  CF-CR-PR-METHOD            PIC X.
  4440               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4441               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4442             20  FILLER                     PIC X.
  4443
  4444         16  CF-CREDIT-MISC-CONTROLS.
  4445             20  CF-REIN-TABLE-SW           PIC X.
  4446                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4447             20  CF-COMP-TABLE-SW           PIC X.
  4448                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4449             20  CF-EXPERIENCE-RETENTION-AGE
  4450                                            PIC S9        COMP-3.
  4451             20  CF-CONVERSION-DT           PIC XX.
  4452             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4453             20  CF-RUN-FREQUENCY-SW        PIC X.
  4454                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4455                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4456
  4457             20  CF-CR-CHECK-NO-CONTROL.
  4458                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4459                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4460                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4461                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4462                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4463                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4464
  4465                 24  CF-CR-CHECK-COUNT       REDEFINES
  4466                     CF-CR-CHECK-COUNTER      PIC X(4).
  4467
  4468                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4469                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4470
  4471                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4472                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4473                 24  CF-MAIL-PROCESSING       PIC X.
  4474                     88  MAIL-PROCESSING          VALUE 'Y'.
  4475
  4476         16  CF-MISC-SYSTEM-CONTROL.
  4477             20  CF-SYSTEM-C                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  82
* EL131.cbl
  4478                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4479             20  CF-SYSTEM-D                 PIC X.
  4480                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4481             20  CF-SOC-SEC-NO-SW            PIC X.
  4482                 88  SOC-SEC-NO-USED             VALUE '1'.
  4483             20  CF-MEMBER-NO-SW             PIC X.
  4484                 88  MEMBER-NO-USED              VALUE '1'.
  4485             20  CF-TAX-ID-NUMBER            PIC X(11).
  4486             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4487             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4488                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4489                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4490                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4491                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4492             20  CF-SYSTEM-E                 PIC X.
  4493                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4494
  4495         16  CF-LGX-LIFE-USER               PIC X.
  4496             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4497             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4498
  4499         16  CF-CR-MONTH-END-DT             PIC XX.
  4500
  4501         16  CF-FILE-MAINT-DATES.
  4502             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4503                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4504             20  CF-LAST-BATCH       REDEFINES
  4505                 CF-LAST-BATCH-NO               PIC X(4).
  4506             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4507             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4508             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4509             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4510             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4511             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4512             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4513             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4514             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4515             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4516
  4517         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4518         16  FILLER                         PIC X.
  4519
  4520         16  CF-ALT-MORT-CODE               PIC X(4).
  4521         16  CF-MEMBER-CAPTION              PIC X(10).
  4522
  4523         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4524             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4525             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4526             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4527             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4528             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4529
  4530         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4531
  4532         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4533         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4534         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4535         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  83
* EL131.cbl
  4536
  4537         16  CF-AH-OVERRIDE-L1              PIC X.
  4538         16  CF-AH-OVERRIDE-L2              PIC XX.
  4539         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4540         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4541
  4542         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4543         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4544
  4545         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4546         16  CF-AR-LAST-EL860-DT            PIC XX.
  4547         16  CF-MP-MONTH-END-DT             PIC XX.
  4548
  4549         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4550         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4551             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4552
  4553         16  CF-AR-MONTH-END-DT             PIC XX.
  4554
  4555         16  CF-CRDTCRD-USER                PIC X.
  4556             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4557             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4558
  4559         16  CF-CC-MONTH-END-DT             PIC XX.
  4560
  4561         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4562
  4563         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4564             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4565             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4566             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4567         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4568         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4569         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4570         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4571             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4572             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4573         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4574         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4575         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4576             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4577         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4578
  4579         16  CF-CL-ZIP-CODE.
  4580             20  CF-CL-ZIP-PRIME.
  4581                 24  CF-CL-ZIP-1ST          PIC X.
  4582                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4583                 24  FILLER                 PIC X(4).
  4584             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4585         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4586             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4587             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4588             20  FILLER                     PIC XXX.
  4589
  4590         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4591         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4592         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4593         16  CF-CO-OPTION-START-DATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  84
* EL131.cbl
  4594         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4595           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4596                                                      '3' '4'.
  4597           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4598           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4599           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4600           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4601           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4602           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4603
  4604         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4605
  4606         16  CF-PAYMENT-APPROVAL-LEVELS.
  4607             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4608             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4609             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4610             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4611             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4612             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4613
  4614         16  CF-END-USER-REPORTING-USER     PIC X.
  4615             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4616             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4617
  4618         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4619             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4620             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4621
  4622         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4623
  4624         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4625         16  FILLER                         PIC X.
  4626
  4627         16  CF-CREDIT-ARCHIVE-CNTL.
  4628             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4629             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4630             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4631
  4632         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4633
  4634         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4635             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4636             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4637
  4638         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4639             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4640             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4641
  4642         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4643
  4644         16  CF-CO-ACH-ID-CODE              PIC  X.
  4645             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4646             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4647             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4648         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4649         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4650         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4651         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  85
* EL131.cbl
  4652         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4653         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4654         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4655         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4656         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4657                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4658         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4659                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4660
  4661         16  CF-CO-OVER-SHORT.
  4662             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4663             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4664
  4665*         16  FILLER                         PIC X(102).
  4666         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4667             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4668             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4669
  4670         16  CF-AH-APPROVAL-DAYS.
  4671             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4672             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4673             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4674             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4675
  4676         16  FILLER                         PIC X(82).
  4677****************************************************************
  4678*             PROCESSOR/USER RECORD                            *
  4679****************************************************************
  4680
  4681     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4682         16  CF-PROCESSOR-NAME              PIC X(30).
  4683         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4684         16  CF-PROCESSOR-TITLE             PIC X(26).
  4685         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4686                 88  MESSAGE-YES                VALUE 'Y'.
  4687                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4688
  4689*****************************************************
  4690****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4691****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4692****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4693****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4694*****************************************************
  4695
  4696         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4697             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4698             20  CF-APPLICATION-FORCE       PIC X.
  4699             20  CF-INDIVIDUAL-APP.
  4700                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4701                     28  CF-BROWSE-APP      PIC X.
  4702                     28  CF-UPDATE-APP      PIC X.
  4703
  4704         16  CF-CURRENT-TERM-ON             PIC X(4).
  4705         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4706             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4707             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4708             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4709             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  86
* EL131.cbl
  4710             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4711             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4712             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4713         16  CF-PROCESSOR-CARRIER           PIC X.
  4714             88  NO-CARRIER-SECURITY            VALUE ' '.
  4715         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4716             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4717         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4718             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4719         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4720             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4721
  4722         16  CF-PROC-SYS-ACCESS-SW.
  4723             20  CF-PROC-CREDIT-CLAIMS-SW.
  4724                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4725                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4726                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4727                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4728             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4729                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4730                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4731             20  CF-PROC-LIFE-GNRLDGR-SW.
  4732                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4733                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4734                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4735                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4736             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4737                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4738                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4739         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4740             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4741             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4742         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4743
  4744         16  CF-APPROVAL-LEVEL                  PIC X.
  4745             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4746             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4747             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4748             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4749
  4750         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4751
  4752         16  CF-LANGUAGE-TYPE                   PIC X.
  4753             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4754             88  CF-LANG-IS-FR                      VALUE 'F'.
  4755         16  FILLER                             PIC  X(240).
  4756
  4757****************************************************************
  4758*             PROCESSOR/REMINDERS RECORD                       *
  4759****************************************************************
  4760
  4761     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4762         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4763             20  CF-START-REMIND-DT         PIC XX.
  4764             20  CF-END-REMIND-DT           PIC XX.
  4765             20  CF-REMINDER-TEXT           PIC X(50).
  4766         16  FILLER                         PIC X(296).
  4767
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  87
* EL131.cbl
  4768
  4769****************************************************************
  4770*             STATE MASTER RECORD                              *
  4771****************************************************************
  4772
  4773     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4774         16  CF-STATE-ABBREVIATION          PIC XX.
  4775         16  CF-STATE-NAME                  PIC X(25).
  4776         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4777         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4778             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4779             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4780             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4781             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4782                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4783                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4784             20  CF-ST-PREM-REJECT-SW       PIC X.
  4785                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4786                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4787             20  CF-ST-REF-REJECT-SW        PIC X.
  4788                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4789                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4790         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4791         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4792         16  CF-ST-REFUND-RULES.
  4793             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4794             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4795             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4796         16  CF-ST-FST-PMT-EXTENSION.
  4797             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4798             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4799                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4800                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4801                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4802                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4803         16  CF-ST-STATE-CALL.
  4804             20  CF-ST-CALL-UNEARNED        PIC X.
  4805             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4806             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4807         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4808             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4809             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4810         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4811         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4812         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4813         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4814         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4815         16  FILLER                         PIC X.
  4816         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4817             20  CF-ST-BENEFIT-CD           PIC XX.
  4818             20  CF-ST-BENEFIT-KIND         PIC X.
  4819                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4820                 88  CF-ST-AH-KIND              VALUE 'A'.
  4821             20  CF-ST-REM-TERM-CALC        PIC X.
  4822                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4823                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4824                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4825                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  88
* EL131.cbl
  4826                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4827                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4828                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4829                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4830
  4831             20  CF-ST-REFUND-CALC          PIC X.
  4832                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4833                 88  ST-REFD-BY-R78             VALUE '1'.
  4834                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4835                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4836                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4837                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4838                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4839                 88  ST-REFD-UTAH               VALUE '7'.
  4840                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4841                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4842                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4843
  4844             20  CF-ST-EARNING-CALC         PIC X.
  4845                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4846                 88  ST-EARN-BY-R78             VALUE '1'.
  4847                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4848                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4849                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4850                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4851                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4852                 88  ST-EARN-MEAN               VALUE '8'.
  4853                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4854
  4855             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4856                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4857                 88  ST-OVRD-BY-R78             VALUE '1'.
  4858                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4859                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4860                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4861                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4862                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4863                 88  ST-OVRD-MEAN               VALUE '8'.
  4864                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4865             20  FILLER                     PIC X.
  4866
  4867         16  CF-ST-COMMISSION-CAPS.
  4868             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4869             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4870             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4871             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4872         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4873                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4874
  4875         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4876
  4877         16  CF-ST-STATUTORY-INTEREST.
  4878             20  CF-ST-STAT-DATE-FROM       PIC X.
  4879                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4880                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4881             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4882             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4883             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  89
* EL131.cbl
  4884             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4885             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4886
  4887         16  CF-ST-OVER-SHORT.
  4888             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4889             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4890
  4891         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4892
  4893         16  CF-ST-RT-CALC                  PIC X.
  4894
  4895         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4896         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4897         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4898         16  CF-ST-RF-LR-CALC               PIC X.
  4899         16  CF-ST-RF-LL-CALC               PIC X.
  4900         16  CF-ST-RF-LN-CALC               PIC X.
  4901         16  CF-ST-RF-AH-CALC               PIC X.
  4902         16  CF-ST-RF-CP-CALC               PIC X.
  4903*        16  FILLER                         PIC X(206).
  4904*CIDMOD         16  FILLER                         PIC X(192).
  4905         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4906             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4907         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4908         16  CF-ST-VFY-2ND-BENE             PIC X.
  4909         16  FILLER                         PIC X(186).
  4910
  4911****************************************************************
  4912*             BENEFIT MASTER RECORD                            *
  4913****************************************************************
  4914
  4915     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4916         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4917             20  CF-BENEFIT-CODE            PIC XX.
  4918             20  CF-BENEFIT-NUMERIC  REDEFINES
  4919                 CF-BENEFIT-CODE            PIC XX.
  4920             20  CF-BENEFIT-ALPHA           PIC XXX.
  4921             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4922             20  CF-BENEFIT-COMMENT         PIC X(10).
  4923
  4924             20  CF-LF-COVERAGE-TYPE        PIC X.
  4925                 88  CF-REDUCING                VALUE 'R'.
  4926                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4927
  4928             20  CF-SPECIAL-CALC-CD         PIC X.
  4929                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4930                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4931                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4932                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4933                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4934                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4935                 88  CF-FARM-PLAN               VALUE 'F'.
  4936                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4937                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4938                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4939                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4940                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4941                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  90
* EL131.cbl
  4942                 88  CF-PRUDENTIAL              VALUE 'P'.
  4943                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4944                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4945                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4946                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4947                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4948                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4949
  4950             20  CF-JOINT-INDICATOR         PIC X.
  4951                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4952
  4953*            20  FILLER                     PIC X(12).
  4954             20  FILLER                     PIC X(11).
  4955             20  CF-BENEFIT-CATEGORY        PIC X.
  4956             20  CF-LOAN-TYPE               PIC X(8).
  4957
  4958             20  CF-CO-REM-TERM-CALC        PIC X.
  4959                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4960                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4961                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4962                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4963                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4964
  4965             20  CF-CO-EARNINGS-CALC        PIC X.
  4966                 88  CO-EARN-BY-R78             VALUE '1'.
  4967                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4968                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4969                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4970                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4971                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4972                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4973                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4974
  4975             20  CF-CO-REFUND-CALC          PIC X.
  4976                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4977                 88  CO-REFD-BY-R78             VALUE '1'.
  4978                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4979                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4980                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4981                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4982                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4983                 88  CO-REFD-MEAN               VALUE '8'.
  4984                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4985                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4986                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4987
  4988             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4989                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4990                 88  CO-OVRD-BY-R78             VALUE '1'.
  4991                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4992                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4993                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4994                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4995                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4996                 88  CO-OVRD-MEAN               VALUE '8'.
  4997                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4998
  4999             20  CF-CO-BEN-I-G-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  91
* EL131.cbl
  5000                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5001                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5002                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5003
  5004         16  FILLER                         PIC X(304).
  5005
  5006
  5007****************************************************************
  5008*             CARRIER MASTER RECORD                            *
  5009****************************************************************
  5010
  5011     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5012         16  CF-ADDRESS-DATA.
  5013             20  CF-MAIL-TO-NAME            PIC X(30).
  5014             20  CF-IN-CARE-OF              PIC X(30).
  5015             20  CF-ADDRESS-LINE-1          PIC X(30).
  5016             20  CF-ADDRESS-LINE-2          PIC X(30).
  5017             20  CF-CITY-STATE              PIC X(30).
  5018             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5019             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5020
  5021         16  CF-CLAIM-NO-CONTROL.
  5022             20  CF-CLAIM-NO-METHOD         PIC X.
  5023                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5024                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5025                 88  CLAIM-NO-SEQ               VALUE '3'.
  5026                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5027             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5028                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5029                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5030                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5031
  5032         16  CF-CHECK-NO-CONTROL.
  5033             20  CF-CHECK-NO-METHOD         PIC X.
  5034                 88  CHECK-NO-MANUAL            VALUE '1'.
  5035                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5036                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5037                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5038             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5039                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5040
  5041         16  CF-DOMICILE-STATE              PIC XX.
  5042
  5043         16  CF-EXPENSE-CONTROLS.
  5044             20  CF-EXPENSE-METHOD          PIC X.
  5045                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5046                 88  DOLLARS-PER-PMT            VALUE '2'.
  5047                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5048                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5049             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5050             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5051
  5052         16  CF-CORRESPONDENCE-CONTROL.
  5053             20  CF-LETTER-RESEND-OPT       PIC X.
  5054                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5055                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5056             20  FILLER                     PIC X(4).
  5057
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  92
* EL131.cbl
  5058         16  CF-RESERVE-CONTROLS.
  5059             20  CF-MANUAL-SW               PIC X.
  5060                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5061             20  CF-FUTURE-SW               PIC X.
  5062                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5063             20  CF-PTC-SW                  PIC X.
  5064                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5065             20  CF-IBNR-SW                 PIC X.
  5066                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5067             20  CF-PTC-LF-SW               PIC X.
  5068                 88  CF-LF-PTC-USED             VALUE '1'.
  5069             20  CF-CDT-ACCESS-METHOD       PIC X.
  5070                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5071                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5072                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5073             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5074
  5075         16  CF-CLAIM-CALC-METHOD           PIC X.
  5076             88  360-PLUS-MONTHS                VALUE '1'.
  5077             88  365-PLUS-MONTHS                VALUE '2'.
  5078             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5079             88  360-DAILY                      VALUE '4'.
  5080             88  365-DAILY                      VALUE '5'.
  5081
  5082         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5083         16  FILLER                         PIC X(11).
  5084
  5085         16  CF-LIMIT-AMOUNTS.
  5086             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5087             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5088             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5089             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5090             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5091             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5092             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5093             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5094             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5095             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5096
  5097         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5098         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5099         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5100
  5101         16  CF-ZIP-CODE.
  5102             20  CF-ZIP-PRIME.
  5103                 24  CF-ZIP-1ST             PIC X.
  5104                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5105                 24  FILLER                 PIC X(4).
  5106             20  CF-ZIP-PLUS4               PIC X(4).
  5107         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5108             20  CF-CAN-POSTAL-1            PIC XXX.
  5109             20  CF-CAN-POSTAL-2            PIC XXX.
  5110             20  FILLER                     PIC XXX.
  5111
  5112         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5113         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5114         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5115
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  93
* EL131.cbl
  5116         16  CF-RATING-SWITCH               PIC X.
  5117             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5118             88  CF-NO-RATING                   VALUE 'N'.
  5119
  5120         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5121
  5122         16  CF-CARRIER-OVER-SHORT.
  5123             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5124             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5125
  5126         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5127         16  CF-SECPAY-SWITCH               PIC X.
  5128             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5129             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5130         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5131         16  FILLER                         PIC X(448).
  5132*        16  FILLER                         PIC X(452).
  5133
  5134
  5135****************************************************************
  5136*             MORTALITY MASTER RECORD                          *
  5137****************************************************************
  5138
  5139     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5140         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5141                                INDEXED BY CF-MORT-NDX.
  5142             20  CF-MORT-TABLE              PIC X(5).
  5143             20  CF-MORT-TABLE-TYPE         PIC X.
  5144                 88  CF-MORT-JOINT              VALUE 'J'.
  5145                 88  CF-MORT-SINGLE             VALUE 'S'.
  5146                 88  CF-MORT-COMBINED           VALUE 'C'.
  5147                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5148                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5149             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5150             20  CF-MORT-AGE-METHOD         PIC XX.
  5151                 88  CF-AGE-LAST                VALUE 'AL'.
  5152                 88  CF-AGE-NEAR                VALUE 'AN'.
  5153             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5154             20  CF-MORT-ADJUSTMENT-DIRECTION
  5155                                            PIC X.
  5156                 88  CF-MINUS                   VALUE '-'.
  5157                 88  CF-PLUS                    VALUE '+'.
  5158             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5159             20  CF-MORT-JOINT-CODE         PIC X.
  5160                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5161             20  CF-MORT-PC-Q               PIC X.
  5162                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5163             20  CF-MORT-TABLE-CODE         PIC X(4).
  5164             20  CF-MORT-COMMENTS           PIC X(15).
  5165             20  FILLER                     PIC X(14).
  5166
  5167         16  FILLER                         PIC X(251).
  5168
  5169
  5170****************************************************************
  5171*             BUSSINESS TYPE MASTER RECORD                     *
  5172****************************************************************
  5173
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  94
* EL131.cbl
  5174     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5175* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5176* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5177* AND RECORD 05 IS TYPES 81-99
  5178         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5179             20  CF-BUSINESS-TITLE          PIC  X(19).
  5180             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5181                                            PIC S9V9(4) COMP-3.
  5182             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5183             20  FILLER                     PIC  X.
  5184         16  FILLER                         PIC  X(248).
  5185
  5186
  5187****************************************************************
  5188*             TERMINAL MASTER RECORD                           *
  5189****************************************************************
  5190
  5191     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5192
  5193         16  CF-COMPANY-TERMINALS.
  5194             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5195                                  PIC X(4).
  5196         16  FILLER               PIC X(248).
  5197
  5198
  5199****************************************************************
  5200*             LIFE EDIT MASTER RECORD                          *
  5201****************************************************************
  5202
  5203     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5204         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5205             20  CF-LIFE-CODE-IN            PIC XX.
  5206             20  CF-LIFE-CODE-OUT           PIC XX.
  5207         16  FILLER                         PIC X(248).
  5208
  5209
  5210****************************************************************
  5211*             AH EDIT MASTER RECORD                            *
  5212****************************************************************
  5213
  5214     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5215         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5216             20  CF-AH-CODE-IN              PIC XXX.
  5217             20  CF-AH-CODE-OUT             PIC XX.
  5218         16  FILLER                         PIC X(248).
  5219
  5220
  5221****************************************************************
  5222*             CREDIBILITY TABLES                               *
  5223****************************************************************
  5224
  5225     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5226         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5227                             INDEXED BY CF-CRDB-NDX.
  5228             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5229             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5230             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5231         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  95
* EL131.cbl
  5232
  5233
  5234****************************************************************
  5235*             REPORT CUSTOMIZATION RECORD                      *
  5236****************************************************************
  5237
  5238     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5239         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5240             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5241             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5242             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5243**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5244****       A T-TRANSFER.                                   ****
  5245             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5246
  5247         16  FILLER                         PIC XX.
  5248
  5249         16  CF-CARRIER-CNTL-OPT.
  5250             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5251                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5252                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5253             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5254                                            PIC X.
  5255         16  CF-GROUP-CNTL-OPT.
  5256             20  CF-GROUP-OPT-SEQ           PIC 9.
  5257                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5258                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5259             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5260                                            PIC X(6).
  5261         16  CF-STATE-CNTL-OPT.
  5262             20  CF-STATE-OPT-SEQ           PIC 9.
  5263                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5264                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5265             20  CF-STATE-SELECT OCCURS 3 TIMES
  5266                                            PIC XX.
  5267         16  CF-ACCOUNT-CNTL-OPT.
  5268             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5269                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5270                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5271             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5272                                            PIC X(10).
  5273         16  CF-BUS-TYP-CNTL-OPT.
  5274             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5275                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5276                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5277             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5278                                            PIC XX.
  5279         16  CF-LF-TYP-CNTL-OPT.
  5280             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5281                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5282                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5283             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5284                                            PIC XX.
  5285         16  CF-AH-TYP-CNTL-OPT.
  5286             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5287                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5288                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5289             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  96
* EL131.cbl
  5290                                            PIC XX.
  5291         16  CF-REPTCD1-CNTL-OPT.
  5292             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5293                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5294                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5295             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5296                                            PIC X(10).
  5297         16  CF-REPTCD2-CNTL-OPT.
  5298             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5299                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5300                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5301             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5302                                            PIC X(10).
  5303         16  CF-USER1-CNTL-OPT.
  5304             20  CF-USER1-OPT-SEQ           PIC 9.
  5305                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5306                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5307             20  CF-USER1-SELECT OCCURS 3 TIMES
  5308                                            PIC X(10).
  5309         16  CF-USER2-CNTL-OPT.
  5310             20  CF-USER2-OPT-SEQ           PIC 9.
  5311                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5312                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5313             20  CF-USER2-SELECT OCCURS 3 TIMES
  5314                                            PIC X(10).
  5315         16  CF-USER3-CNTL-OPT.
  5316             20  CF-USER3-OPT-SEQ           PIC 9.
  5317                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5318                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5319             20  CF-USER3-SELECT OCCURS 3 TIMES
  5320                                            PIC X(10).
  5321         16  CF-USER4-CNTL-OPT.
  5322             20  CF-USER4-OPT-SEQ           PIC 9.
  5323                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5324                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5325             20  CF-USER4-SELECT OCCURS 3 TIMES
  5326                                            PIC X(10).
  5327         16  CF-USER5-CNTL-OPT.
  5328             20  CF-USER5-OPT-SEQ           PIC 9.
  5329                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5330                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5331             20  CF-USER5-SELECT OCCURS 3 TIMES
  5332                                            PIC X(10).
  5333         16  CF-REINS-CNTL-OPT.
  5334             20  CF-REINS-OPT-SEQ           PIC 9.
  5335                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5336                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5337             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5338                 24  CF-REINS-PRIME         PIC XXX.
  5339                 24  CF-REINS-SUB           PIC XXX.
  5340
  5341         16  CF-AGENT-CNTL-OPT.
  5342             20  CF-AGENT-OPT-SEQ           PIC 9.
  5343                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5344                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5345             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5346                                            PIC X(10).
  5347
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  97
* EL131.cbl
  5348         16  FILLER                         PIC X(43).
  5349
  5350         16  CF-LOSS-RATIO-SELECT.
  5351             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5352             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5353         16  CF-ENTRY-DATE-SELECT.
  5354             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5355             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5356         16  CF-EFFECTIVE-DATE-SELECT.
  5357             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5358             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5359
  5360         16  CF-EXCEPTION-LIST-IND          PIC X.
  5361             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5362
  5363         16  FILLER                         PIC X(318).
  5364
  5365****************************************************************
  5366*                  EXCEPTION REPORTING RECORD                  *
  5367****************************************************************
  5368
  5369     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5370         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5371             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5372
  5373         16  CF-COMBINED-LIFE-AH-OPT.
  5374             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5375             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5376             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5377             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5378
  5379         16  CF-LIFE-OPT.
  5380             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5381             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5382             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5383             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5384             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5385             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5386             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5387             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5388             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5389             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5390
  5391         16  CF-AH-OPT.
  5392             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5393             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5394             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5395             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5396             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5397             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5398             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5399             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5400             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5401             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5402
  5403         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5404             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5405             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  98
* EL131.cbl
  5406             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5407
  5408         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5409
  5410         16  FILLER                         PIC X(673).
  5411
  5412
  5413****************************************************************
  5414*             MORTGAGE SYSTEM PLAN RECORD                      *
  5415****************************************************************
  5416
  5417     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5418         16  CF-PLAN-TYPE                   PIC X.
  5419             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5420             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5421             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5422         16  CF-PLAN-ABBREV                 PIC XXX.
  5423         16  CF-PLAN-DESCRIPT               PIC X(10).
  5424         16  CF-PLAN-NOTES                  PIC X(20).
  5425         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5426         16  CF-PLAN-UNDERWRITING.
  5427             20  CF-PLAN-TERM-DATA.
  5428                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5429                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5430             20  CF-PLAN-AGE-DATA.
  5431                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5432                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5433                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5434             20  CF-PLAN-BENEFIT-DATA.
  5435                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5436                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5437                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5438                                            PIC S9(7)V99  COMP-3.
  5439         16  CF-PLAN-POLICY-FORMS.
  5440             20  CF-POLICY-FORM             PIC X(12).
  5441             20  CF-MASTER-APPLICATION      PIC X(12).
  5442             20  CF-MASTER-POLICY           PIC X(12).
  5443         16  CF-PLAN-RATING.
  5444             20  CF-RATE-CODE               PIC X(5).
  5445             20  CF-SEX-RATING              PIC X.
  5446                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5447                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5448             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5449             20  CF-SUB-STD-TYPE            PIC X.
  5450                 88  CF-PCT-OF-PREM            VALUE '1'.
  5451                 88  CF-PCT-OF-BENE            VALUE '2'.
  5452         16  CF-PLAN-PREM-TOLERANCES.
  5453             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5454             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5455         16  CF-PLAN-PYMT-TOLERANCES.
  5456             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5457             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5458         16  CF-PLAN-MISC-DATA.
  5459             20  FILLER                     PIC X.
  5460             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5461             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5462         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5463         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page  99
* EL131.cbl
  5464             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5465                                                     '1'.
  5466             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5467                                                     '2'.
  5468         16  CF-MIB-SEARCH-SW               PIC X.
  5469             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5470             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5471             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5472             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5473         16  CF-ALPHA-SEARCH-SW             PIC X.
  5474             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5475             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5476             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5477             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5478             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5479             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5480             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5481             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5482             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5483             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5484                                                     'A' 'B' 'C'
  5485                                                     'X' 'Y' 'Z'.
  5486         16  CF-EFF-DT-RULE-SW              PIC X.
  5487             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5488             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5489             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5490             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5491             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5492         16  FILLER                         PIC X(4).
  5493         16  CF-HEALTH-QUESTIONS            PIC X.
  5494             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5495         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5496         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5497         16  CF-PLAN-SNGL-JNT               PIC X.
  5498             88  CF-COMBINED-PLAN              VALUE 'C'.
  5499             88  CF-JNT-PLAN                   VALUE 'J'.
  5500             88  CF-SNGL-PLAN                  VALUE 'S'.
  5501         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5502         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5503         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5504         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5505         16  CF-RERATE-CNTL                 PIC  X.
  5506             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5507             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5508             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5509             88  CF-AUTO-RECALC                 VALUE '4'.
  5510         16  CF-BENEFIT-TYPE                PIC  X.
  5511             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5512             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5513         16  CF-POLICY-FEE                  PIC S999V99
  5514                                                    COMP-3.
  5515         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5516         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5517         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5518         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5519         16  FILLER                         PIC  X(32).
  5520         16  CF-TERMINATION-FORM            PIC  X(04).
  5521         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 100
* EL131.cbl
  5522         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5523                                                       COMP-3.
  5524         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5525         16  CF-ISSUE-LETTER                PIC  X(4).
  5526         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5527         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5528             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5529             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5530         16  CF-MP-REFUND-CALC              PIC X.
  5531             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5532             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5533             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5534             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5535             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5536             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5537             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5538             88  CF-MP-REFD-MEAN                VALUE '8'.
  5539         16  CF-ALT-RATE-CODE               PIC  X(5).
  5540
  5541
  5542         16  FILLER                         PIC X(498).
  5543****************************************************************
  5544*             MORTGAGE COMPANY MASTER RECORD                   *
  5545****************************************************************
  5546
  5547     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5548         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5549         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5550             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5551             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5552             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5553             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5554             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5555
  5556         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5557         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5558         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5559         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5560         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5561
  5562         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5563             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5564         16  CF-MP-RECON-USE-IND            PIC X(1).
  5565             88  CF-MP-USE-RECON             VALUE 'Y'.
  5566         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5567             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5568         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5569             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5570             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5571         16  FILLER                         PIC X(1).
  5572         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5573             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5574         16  CF-MORTG-MIB-VERSION           PIC X.
  5575             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5576             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5577             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5578         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5579             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 101
* EL131.cbl
  5580                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5581             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5582                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5583             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5584                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5585             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5586                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5587             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5588                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5589             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5590                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5591         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5592         16  FILLER                         PIC X(7).
  5593         16  CF-MORTG-DESTINATION-SYMBOL.
  5594             20  CF-MORTG-MIB-COMM          PIC X(5).
  5595             20  CF-MORTG-MIB-TERM          PIC X(5).
  5596         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5597             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5598         16  FILLER                         PIC X(03).
  5599         16  CF-MP-CHECK-NO-CONTROL.
  5600             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5601                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5602                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5603                                                ' ' LOW-VALUES.
  5604                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5605                                               VALUE '3'.
  5606         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5607         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5608         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5609             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5610                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5611             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5612                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5613             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5614                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5615             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5616                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5617             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5618                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5619             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5620                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5621         16  CF-MORTG-BILLING-AREA.
  5622             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5623                                            PIC X.
  5624         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5625         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5626         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5627         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5628             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5629             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5630         16  FILLER                         PIC X.
  5631         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5632             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5633             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5634         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5635         16  FILLER                         PIC X(8).
  5636         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5637         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 102
* EL131.cbl
  5638         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5639         16  CF-ACH-COMPANY-ID.
  5640             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5641                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5642                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5643                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5644             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5645         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5646             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5647         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5648             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5649             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5650         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5651         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5652         16  FILLER                         PIC X(536).
  5653
  5654****************************************************************
  5655*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5656****************************************************************
  5657
  5658     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5659         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5660             20  CF-FEMALE-HEIGHT.
  5661                 24  CF-FEMALE-FT           PIC 99.
  5662                 24  CF-FEMALE-IN           PIC 99.
  5663             20  CF-FEMALE-MIN-WT           PIC 999.
  5664             20  CF-FEMALE-MAX-WT           PIC 999.
  5665         16  FILLER                         PIC X(428).
  5666
  5667     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5668         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5669             20  CF-MALE-HEIGHT.
  5670                 24  CF-MALE-FT             PIC 99.
  5671                 24  CF-MALE-IN             PIC 99.
  5672             20  CF-MALE-MIN-WT             PIC 999.
  5673             20  CF-MALE-MAX-WT             PIC 999.
  5674         16  FILLER                         PIC X(428).
  5675******************************************************************
  5676*             AUTOMATIC ACTIVITY RECORD                          *
  5677******************************************************************
  5678     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5679         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5680             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5681             20  CF-SYS-LETTER-ID           PIC X(04).
  5682             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5683             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5684             20  CF-SYS-RESET-SW            PIC X(01).
  5685             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5686             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5687
  5688         16  FILLER                         PIC X(50).
  5689
  5690         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5691             20  CF-USER-ACTIVE-SW          PIC X(01).
  5692             20  CF-USER-LETTER-ID          PIC X(04).
  5693             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5694             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5695             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 103
* EL131.cbl
  5696             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5697             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5698             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5699
  5700         16  FILLER                         PIC X(246).
  5701
  5702*                                COPY ELCACTQ.
  5703******************************************************************
  5704*                                                                *
  5705*                            ELCACTQ.                            *
  5706*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  5707*                            VMOD=2.004                          *
  5708*                                                                *
  5709*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  5710*                                                                *
  5711*   FILE TYPE = VSAM,KSDS                                        *
  5712*   RECORD SIZE = 60     RECFORM = FIXED                         *
  5713*                                                                *
  5714*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  5715*       ALTERNATE INDEX = NONE                                   *
  5716*                                                                *
  5717*   LOG = YES                                                    *
  5718*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5719*                                                                *
  5720*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  5721******************************************************************
  5722
  5723 01  ACTIVITY-QUE.
  5724     12  AQ-RECORD-ID                PIC XX.
  5725         88  VALID-AQ-ID                VALUE 'AQ'.
  5726
  5727     12  AQ-CONTROL-PRIMARY.
  5728         16  AQ-COMPANY-CD           PIC X.
  5729         16  AQ-CARRIER              PIC X.
  5730         16  AQ-CLAIM-NO             PIC X(7).
  5731         16  AQ-CERT-NO.
  5732             20  AQ-CERT-PRIME       PIC X(10).
  5733             20  AQ-CERT-SFX         PIC X.
  5734
  5735     12  AQ-PENDING-ACTIVITY-FLAGS.
  5736         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  5737         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  5738             88  PENDING-PAYMENTS       VALUE '1'.
  5739         16  AQ-PENDING-STATUS-FLAG  PIC X.
  5740             88  PENDING-FULL-PRINT     VALUE '1'.
  5741             88  PENDING-PART-PRINT     VALUE '2'.
  5742         16  AQ-PENDING-LETTER-FLAG  PIC X.
  5743             88  PENDING-LETTERS        VALUE '1'.
  5744         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  5745             88  PENDING-RESTORE        VALUE 'C'.
  5746             88  PENDING-RESTORE-LETTER VALUE 'L'.
  5747
  5748     12  FILLER                      PIC X(20).
  5749
  5750     12  AQ-RESEND-DATE              PIC XX.
  5751     12  AQ-FOLLOWUP-DATE            PIC XX.
  5752     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  5753     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 104
* EL131.cbl
  5754     12  AQ-AUTO-LETTER              PIC X(4).
  5755     12  FILLER                      PIC XX.
  5756     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  5757*****************************************************************
  5758
  5759*                                COPY ERCACCT.
  5760******************************************************************
  5761*                                                                *
  5762*                                                                *
  5763*                            ERCACCT                             *
  5764*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5765*                            VMOD=2.031                          *
  5766*                                                                *
  5767*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5768*                                                                *
  5769*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5770*   VSAM ACCOUNT MASTER FILES.                                   *
  5771*                                                                *
  5772*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5773*                                                                *
  5774*   FILE TYPE = VSAM,KSDS                                        *
  5775*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5776*                                                                *
  5777*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5778*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5779*                                                                *
  5780*   LOG = NO                                                     *
  5781*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5782*                                                                *
  5783*                                                                *
  5784******************************************************************
  5785*                   C H A N G E   L O G
  5786*
  5787* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5788*-----------------------------------------------------------------
  5789*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5790* EFFECTIVE    NUMBER
  5791*-----------------------------------------------------------------
  5792* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5793* 092705    2005050300006  PEMA  ADD SPP LEASES
  5794* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5795* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5796* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5797* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5798* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5799******************************************************************
  5800
  5801 01  ACCOUNT-MASTER.
  5802     12  AM-RECORD-ID                      PIC XX.
  5803         88  VALID-AM-ID                      VALUE 'AM'.
  5804
  5805     12  AM-CONTROL-PRIMARY.
  5806         16  AM-COMPANY-CD                 PIC X.
  5807         16  AM-MSTR-CNTRL.
  5808             20  AM-CONTROL-A.
  5809                 24  AM-CARRIER            PIC X.
  5810                 24  AM-GROUPING.
  5811                     28 AM-GROUPING-PREFIX PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 105
* EL131.cbl
  5812                     28 AM-GROUPING-PRIME  PIC XXX.
  5813                 24  AM-STATE              PIC XX.
  5814                 24  AM-ACCOUNT.
  5815                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5816                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5817             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5818                                           PIC X(19).
  5819             20  AM-CNTRL-B.
  5820                 24  AM-EXPIRATION-DT      PIC XX.
  5821                 24  FILLER                PIC X(4).
  5822             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5823                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5824
  5825     12  AM-CONTROL-BY-VAR-GRP.
  5826         16  AM-COMPANY-CD-A1              PIC X.
  5827         16  AM-VG-CARRIER                 PIC X.
  5828         16  AM-VG-GROUPING                PIC X(6).
  5829         16  AM-VG-STATE                   PIC XX.
  5830         16  AM-VG-ACCOUNT                 PIC X(10).
  5831         16  AM-VG-DATE.
  5832             20  AM-VG-EXPIRATION-DT       PIC XX.
  5833             20  FILLER                    PIC X(4).
  5834         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5835                                           PIC 9(11)      COMP-3.
  5836     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5837         16  FILLER                        PIC X(10).
  5838         16  AM-VG-KEY3.
  5839             20  AM-VG3-ACCOUNT            PIC X(10).
  5840             20  AM-VG3-EXP-DT             PIC XX.
  5841         16  FILLER                        PIC X(4).
  5842     12  AM-MAINT-INFORMATION.
  5843         16  AM-LAST-MAINT-DT              PIC XX.
  5844         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5845         16  AM-LAST-MAINT-USER            PIC X(4).
  5846         16  FILLER                        PIC XX.
  5847
  5848     12  AM-EFFECTIVE-DT                   PIC XX.
  5849     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5850
  5851     12  AM-PREV-DATES  COMP-3.
  5852         16  AM-PREV-EXP-DT                PIC 9(11).
  5853         16  AM-PREV-EFF-DT                PIC 9(11).
  5854
  5855     12  AM-REPORT-CODE-1                  PIC X(10).
  5856     12  AM-REPORT-CODE-2                  PIC X(10).
  5857
  5858     12  AM-CITY-CODE                      PIC X(4).
  5859     12  AM-COUNTY-PARISH                  PIC X(6).
  5860
  5861     12  AM-NAME                           PIC X(30).
  5862     12  AM-PERSON                         PIC X(30).
  5863     12  AM-ADDRS                          PIC X(30).
  5864     12  AM-CITY.
  5865         16  AM-ADDR-CITY                  PIC X(28).
  5866         16  AM-ADDR-STATE                 PIC XX.
  5867     12  AM-ZIP.
  5868         16  AM-ZIP-PRIME.
  5869             20  AM-ZIP-PRI-1ST            PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 106
* EL131.cbl
  5870                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5871             20  FILLER                    PIC X(4).
  5872         16  AM-ZIP-PLUS4                  PIC X(4).
  5873     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5874         16  AM-CAN-POSTAL-1               PIC XXX.
  5875         16  AM-CAN-POSTAL-2               PIC XXX.
  5876         16  FILLER                        PIC XXX.
  5877     12  AM-TEL-NO.
  5878         16  AM-AREA-CODE                  PIC 999.
  5879         16  AM-TEL-PRE                    PIC 999.
  5880         16  AM-TEL-NBR                    PIC 9(4).
  5881     12  AM-TEL-LOC                        PIC X.
  5882         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5883         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5884
  5885     12  AM-COMM-STRUCTURE.
  5886         16  AM-DEFN-1.
  5887             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5888                 24  AM-AGT.
  5889                     28  AM-AGT-PREFIX     PIC X(4).
  5890                     28  AM-AGT-PRIME      PIC X(6).
  5891                 24  AM-COM-TYP            PIC X.
  5892                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5893                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5894                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5895                 24  AM-RECALC-LV-INDIC    PIC X.
  5896                 24  AM-RETRO-LV-INDIC     PIC X.
  5897                 24  AM-GL-CODES           PIC X.
  5898                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5899                 24  FILLER                PIC X(01).
  5900         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5901             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5902                 24  FILLER                PIC X(11).
  5903                 24  AM-L-COMA             PIC XXX.
  5904                 24  AM-J-COMA             PIC XXX.
  5905                 24  AM-A-COMA             PIC XXX.
  5906                 24  FILLER                PIC X(6).
  5907
  5908     12  AM-COMM-CHANGE-STATUS             PIC X.
  5909         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5910
  5911     12  AM-CSR-CODE                       PIC X(4).
  5912
  5913     12  AM-BILLING-STATUS                 PIC X.
  5914         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5915         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5916     12  AM-AUTO-REFUND-SW                 PIC X.
  5917         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5918         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5919     12  AM-GPCD                           PIC 99.
  5920     12  AM-IG                             PIC X.
  5921         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5922         88  AM-HAS-GROUP                     VALUE '2'.
  5923     12  AM-STATUS                         PIC X.
  5924         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5925         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5926         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5927         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 107
* EL131.cbl
  5928         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5929         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5930     12  AM-REMIT-TO                       PIC 99.
  5931     12  AM-ID-NO                          PIC X(11).
  5932
  5933     12  AM-CAL-TABLE                      PIC XX.
  5934     12  AM-LF-DEVIATION                   PIC XXX.
  5935     12  AM-AH-DEVIATION                   PIC XXX.
  5936     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5937     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5938     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5939     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5940     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5941     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5942
  5943     12  AM-USER-FIELDS.
  5944         16  AM-FLD-1                      PIC XX.
  5945         16  AM-FLD-2                      PIC XX.
  5946         16  AM-FLD-3                      PIC XX.
  5947         16  AM-FLD-4                      PIC XX.
  5948         16  AM-FLD-5                      PIC XX.
  5949
  5950     12  AM-1ST-PROD-DATE.
  5951         16  AM-1ST-PROD-YR                PIC XX.
  5952         16  AM-1ST-PROD-MO                PIC XX.
  5953         16  AM-1ST-PROD-DA                PIC XX.
  5954     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5955     12  AM-CERTS-PURGED-DATE.
  5956         16  AM-PUR-YR                     PIC XX.
  5957         16  AM-PUR-MO                     PIC XX.
  5958         16  AM-PUR-DA                     PIC XX.
  5959     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5960     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5961     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5962     12  AM-INACTIVE-DATE.
  5963         16  AM-INA-MO                     PIC 99.
  5964         16  AM-INA-DA                     PIC 99.
  5965         16  AM-INA-YR                     PIC 99.
  5966     12  AM-AR-HI-CERT-DATE                PIC XX.
  5967
  5968     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5969     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5970
  5971     12  AM-OB-PAYMENT-MODE                PIC X.
  5972         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5973         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5974         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5975         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5976
  5977     12  AM-AH-ONLY-INDICATOR              PIC X.
  5978         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5979         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5980
  5981     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5982
  5983     12  AM-OVER-SHORT.
  5984         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5985         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 108
* EL131.cbl
  5986
  5987     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5988     12  AM-DCC-CLP-STATE                  PIC XX.
  5989
  5990     12  AM-RECALC-COMM                    PIC X.
  5991     12  AM-RECALC-REIN                    PIC X.
  5992
  5993     12  AM-REI-TABLE                      PIC XXX.
  5994     12  AM-REI-ET-LF                      PIC X.
  5995     12  AM-REI-ET-AH                      PIC X.
  5996     12  AM-REI-PE-LF                      PIC X.
  5997     12  AM-REI-PE-AH                      PIC X.
  5998     12  AM-REI-PRT-ST                     PIC X.
  5999     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6000     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6001     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6002     12  AM-REI-GROUP-A                    PIC X(6).
  6003     12  AM-REI-MORT                       PIC X(4).
  6004     12  AM-REI-PRT-OW                     PIC X.
  6005     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6006     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6007     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6008     12  AM-REI-GROUP-B                    PIC X(6).
  6009
  6010     12  AM-TRUST-TYPE                     PIC X(2).
  6011
  6012     12  AM-EMPLOYER-STMT-USED             PIC X.
  6013     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6014
  6015     12  AM-STD-AH-TYPE                    PIC XX.
  6016     12  AM-EARN-METHODS.
  6017         16  AM-EARN-METHOD-R              PIC X.
  6018             88 AM-REF-RL-R78                 VALUE 'R'.
  6019             88 AM-REF-RL-PR                  VALUE 'P'.
  6020             88 AM-REF-RL-MEAN                VALUE 'M'.
  6021             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6022         16  AM-EARN-METHOD-L              PIC X.
  6023             88 AM-REF-LL-R78                 VALUE 'R'.
  6024             88 AM-REF-LL-PR                  VALUE 'P'.
  6025             88 AM-REF-LL-MEAN                VALUE 'M'.
  6026             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6027         16  AM-EARN-METHOD-A              PIC X.
  6028             88 AM-REF-AH-R78                 VALUE 'R'.
  6029             88 AM-REF-AH-PR                  VALUE 'P'.
  6030             88 AM-REF-AH-MEAN                VALUE 'M'.
  6031             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6032             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6033             88 AM-REF-AH-NET                 VALUE 'N'.
  6034
  6035     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6036     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6037     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6038
  6039     12  AM-RET-Y-N                        PIC X.
  6040     12  AM-RET-P-E                        PIC X.
  6041     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6042     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6043     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 109
* EL131.cbl
  6044     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6045         16  AM-POOL-PRIME                 PIC XXX.
  6046         16  AM-POOL-SUB                   PIC XXX.
  6047     12  AM-RETRO-EARNINGS.
  6048         16  AM-RET-EARN-R                 PIC X.
  6049         16  AM-RET-EARN-L                 PIC X.
  6050         16  AM-RET-EARN-A                 PIC X.
  6051     12  AM-RET-ST-TAX-USE                 PIC X.
  6052         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6053         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6054     12  AM-RETRO-BEG-EARNINGS.
  6055         16  AM-RET-BEG-EARN-R             PIC X.
  6056         16  AM-RET-BEG-EARN-L             PIC X.
  6057         16  AM-RET-BEG-EARN-A             PIC X.
  6058     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6059     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6060
  6061     12  AM-USER-SELECT-OPTIONS.
  6062         16  AM-USER-SELECT-1              PIC X(10).
  6063         16  AM-USER-SELECT-2              PIC X(10).
  6064         16  AM-USER-SELECT-3              PIC X(10).
  6065         16  AM-USER-SELECT-4              PIC X(10).
  6066         16  AM-USER-SELECT-5              PIC X(10).
  6067
  6068     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6069
  6070     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6071
  6072     12  AM-RPT045A-SWITCH                 PIC X.
  6073         88  RPT045A-OFF                   VALUE 'N'.
  6074
  6075     12  AM-INSURANCE-LIMITS.
  6076         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6077         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6078
  6079     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6080         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6081
  6082     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6083         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6084         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6085
  6086     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6087
  6088     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6089     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6090     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6091     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6092     12  AM-DCC-UEF-STATE                  PIC XX.
  6093     12  FILLER                            PIC XXX.
  6094     12  AM-REPORT-CODE-3                  PIC X(10).
  6095*    12  FILLER                            PIC X(22).
  6096
  6097     12  AM-RESERVE-DATE.
  6098         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6099         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6100         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6101
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 110
* EL131.cbl
  6102     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6103     12  AM-NOTIFICATION-TYPES.
  6104         16  AM-NOTIF-OF-LETTERS           PIC X.
  6105         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6106         16  AM-NOTIF-OF-REPORTS           PIC X.
  6107         16  AM-NOTIF-OF-STATUS            PIC X.
  6108
  6109     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6110         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6111         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6112         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6113         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6114
  6115     12  AM-BENEFIT-CONTROLS.
  6116         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6117             20  AM-BENEFIT-CODE           PIC XX.
  6118             20  AM-BENEFIT-TYPE           PIC X.
  6119             20  AM-BENEFIT-REVISION       PIC XXX.
  6120             20  AM-BENEFIT-REM-TERM       PIC X.
  6121             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6122             20  FILLER                    PIC XX.
  6123         16  FILLER                        PIC X(80).
  6124
  6125     12  AM-TRANSFER-DATA.
  6126         16  AM-TRANSFERRED-FROM.
  6127             20  AM-TRNFROM-CARRIER        PIC X.
  6128             20  AM-TRNFROM-GROUPING.
  6129                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6130                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6131             20  AM-TRNFROM-STATE          PIC XX.
  6132             20  AM-TRNFROM-ACCOUNT.
  6133                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6134                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6135             20  AM-TRNFROM-DTE            PIC XX.
  6136         16  AM-TRANSFERRED-TO.
  6137             20  AM-TRNTO-CARRIER          PIC X.
  6138             20  AM-TRNTO-GROUPING.
  6139                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6140                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6141             20  AM-TRNTO-STATE            PIC XX.
  6142             20  AM-TRNTO-ACCOUNT.
  6143                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6144                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6145             20  AM-TRNTO-DTE              PIC XX.
  6146         16  FILLER                        PIC X(10).
  6147
  6148     12  AM-SAVED-REMIT-TO                 PIC 99.
  6149
  6150     12  AM-COMM-STRUCTURE-SAVED.
  6151         16  AM-DEFN-1-SAVED.
  6152             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6153                 24  AM-AGT-SV             PIC X(10).
  6154                 24  AM-COM-TYP-SV         PIC X.
  6155                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6156                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6157                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6158                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6159                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 111
* EL131.cbl
  6160                 24  AM-GL-CODES-SV        PIC X.
  6161                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6162                 24  FILLER                PIC X.
  6163         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6164             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6165                 24  FILLER                PIC X(11).
  6166                 24  AM-L-COMA-SV          PIC XXX.
  6167                 24  AM-J-COMA-SV          PIC XXX.
  6168                 24  AM-A-COMA-SV          PIC XXX.
  6169                 24  FILLER                PIC X(6).
  6170
  6171     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6172         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6173            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6174            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6175            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6176
  6177     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6178     12  FILLER                            PIC X(120).
  6179
  6180     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6181         16  AM-CONTROL-NAME               PIC X(30).
  6182         16  AM-EXECUTIVE-ONE.
  6183             20  AM-EXEC1-NAME             PIC X(15).
  6184             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6185                                                          COMP-3.
  6186             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6187                                                          COMP-3.
  6188         16  AM-EXECUTIVE-TWO.
  6189             20  AM-EXEC2-NAME             PIC X(15).
  6190             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6191                                                          COMP-3.
  6192             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6193                                                          COMP-3.
  6194
  6195     12  AM-RETRO-ADDITIONAL-DATA.
  6196         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6197         16  AM-RETRO-PREM-P-E             PIC X.
  6198         16  AM-RETRO-CLMS-P-I             PIC X.
  6199         16  AM-RETRO-RET-BRACKET-LF.
  6200             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6201                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6202                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6203             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6204                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6205                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6206             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6207                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6208                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6209         16  AM-RETRO-RET-BRACKET-AH.
  6210             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6211                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6212                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6213                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6214             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6215                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6216                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6217             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 112
* EL131.cbl
  6218                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6219                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6220
  6221     12  AM-COMMENTS.
  6222         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6223
  6224     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6225         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6226         16  AM-FLI-BILLING-CODE           PIC X.
  6227         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6228         16  AM-FLI-UNITED-IDENT           PIC X.
  6229         16  AM-FLI-INTEREST-LOST-DATA.
  6230             20  AM-FLI-BANK-NO            PIC X(5).
  6231             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6232             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6233             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6234         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6235             20  AM-FLI-AGT                PIC X(9).
  6236             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6237             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6238         16  FILLER                        PIC X(102).
  6239
  6240     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6241         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6242             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6243             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6244             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6245             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6246             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6247         16  FILLER                          PIC X(10).
  6248******************************************************************
  6249
  6250*                                COPY ELCCHKQ.
  6251******************************************************************
  6252*                                                                *
  6253*                                                                *
  6254*                            ELCCHKQ.                            *
  6255*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6256*                            VMOD=2.007                          *
  6257*                                                                *
  6258*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6259*                                                                *
  6260*   FILE TYPE = VSAM,KSDS                                        *
  6261*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6262*                                                                *
  6263*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6264*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6265*                                                                *
  6266*   LOG = YES                                                    *
  6267*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6268******************************************************************
  6269 01  CHECK-QUE.
  6270     12  CQ-RECORD-ID                PIC XX.
  6271         88  VALID-CQ-ID         VALUE 'CQ'.
  6272
  6273     12  CQ-CONTROL-PRIMARY.
  6274         16  CQ-COMPANY-CD           PIC X.
  6275         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 113
* EL131.cbl
  6276         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6277
  6278     12  CQ-CONTROL-BY-PAYEE.
  6279         16  CQ-CONTROL-BY-NUMBER.
  6280             20  CQ-COMPANY-CD-A1     PIC X.
  6281             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6282         16  CQ-PAYEE-CARRIER        PIC X.
  6283         16  CQ-PAYEE-GROUPING       PIC X(6).
  6284         16  CQ-PAYEE-STATE          PIC XX.
  6285         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6286         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6287
  6288     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6289         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6290         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6291         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6292         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6293         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6294         16  FILLER                  PIC X(3).
  6295
  6296     12  CQ-ENTRY-TYPE               PIC X.
  6297             88  CHECK-ON-QUE           VALUE 'Q'.
  6298             88  ALIGNMENT-CHECK        VALUE 'A'.
  6299             88  SPOILED-CHECK          VALUE 'S'.
  6300             88  PAYMENT-ABORTED        VALUE 'X'.
  6301
  6302     12  CQ-CLAIM-MAST-CNTL.
  6303         16  CQ-CARRIER              PIC X.
  6304         16  CQ-CLAIM-NO             PIC X(7).
  6305         16  CQ-CERT-NO.
  6306             20  CQ-CERT-PRIME       PIC X(10).
  6307             20  CQ-CERT-SFX         PIC X.
  6308         16  CQ-CLAIM-TYPE           PIC X.
  6309             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6310             88  CQ-AH-CLAIM            VALUE 'A'.
  6311         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6312             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6313             88  CQ-O-B-COVERAGE        VALUE '2'.
  6314             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6315
  6316     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6317     12  CQ-CHECK-NUMBER             PIC X(7).
  6318     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6319     12  CQ-PAYMENT-TYPE             PIC X.
  6320             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6321             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6322             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6323             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6324             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6325             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6326             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6327             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6328     12  CQ-VOID-INDICATOR           PIC X.
  6329             88  CHECK-IS-STOPPED          VALUE 'S'.
  6330             88  CHECK-IS-VOID             VALUE 'V'.
  6331     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6332     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6333     12  CQ-CHECK-BY-USER            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 114
* EL131.cbl
  6334     12  CQ-PRE-NUMBERING-SW         PIC X.
  6335       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6336       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6337
  6338     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6339     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6340     12  CQ-LEDGER-FLAG              PIC X(01).
  6341     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6342     12  CQ-LAST-UPDATED-DT          PIC XX.
  6343     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6344     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6345
  6346     12  FILLER                      PIC X(04).
  6347
  6348******************************************************************
  6349
  6350*                                COPY ELCARCH.
  6351******************************************************************
  6352*                                                                *
  6353*                            ELCARCH.                            *
  6354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6355*                            VMOD=2.007                          *
  6356*                                                                *
  6357*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6358*                                                                *
  6359*   FILE TYPE = VSAM,KSDS                                        *
  6360*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6361*                                                                *
  6362*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6363*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6364*                                                                *
  6365*   LOG = NO                                                     *
  6366*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6367*                                                                *
  6368*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6369******************************************************************
  6370 01  LETTER-ARCHIVE.
  6371     12  LA-RECORD-ID                PIC XX.
  6372         88  VALID-LA-ID                VALUE 'LA'.
  6373
  6374     12  LA-CONTROL-PRIMARY.
  6375         16  LA-COMPANY-CD           PIC X.
  6376         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6377         16  LA-RECORD-TYPE          PIC X.
  6378             88  LA-HEADER-DATA         VALUE '1'.
  6379             88  LA-ADDRESS-DATA        VALUE '2'.
  6380             88  LA-TEXT-DATA           VALUE '3'.
  6381             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6382         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6383
  6384     12  LA-CONTROL-BY-TYPE.
  6385         16  LA-COMPANY-CD-A1        PIC X.
  6386         16  LA-RECORD-TYPE-A1       PIC X.
  6387         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6388         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6389
  6390     12  LA-TEXT-RECORD.
  6391         16  LA-SKIP-CONTROL         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 115
* EL131.cbl
  6392             88  NO-LINES-SKIPPED       VALUE SPACES.
  6393             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6394         16  LA-TEXT-LINE            PIC X(70).
  6395
  6396     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6397         16  FILLER                  PIC XX.
  6398         16  LA-ADDRESS-LINE         PIC X(30).
  6399         16  FILLER                  PIC X(40).
  6400
  6401     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6402         16  FILLER                  PIC XX.
  6403         16  LA-CARRIER              PIC X.
  6404         16  LA-CLAIM-NO             PIC X(7).
  6405         16  LA-CERT-NO.
  6406             20  LA-CERT-PRIME       PIC X(10).
  6407             20  LA-CERT-SFX         PIC X.
  6408         16  LA-NO-OF-COPIES         PIC S9.
  6409         16  LA-RESEND-DATE          PIC XX.
  6410         16  LA-PROCESSOR-CD         PIC X(4).
  6411         16  LA-CREATION-DT          PIC XX.
  6412         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6413         16  LA-RESEND-PRINT-DATE    PIC XX.
  6414         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6415         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6416*
  6417* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6418*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6419*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6420*   I        20  LA-DMD-RES-ST           PIC XX.
  6421*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6422*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6423*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6424*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6425*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6426*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6427*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6428*   I        20  LA-DMD-UND-CODE         PIC XX.
  6429*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6430*   V    16  FILLER                  PIC X(15).
  6431* -----
  6432*
  6433* REINSERTED  CSO  MODS
  6434*
  6435         16  FILLER.
  6436             20  FILLER                  PIC X(29).
  6437             20  LA-CSO-LETTER-STATUS    PIC X.
  6438                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6439                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6440                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6441             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6442             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6443*
  6444
  6445     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6446         16  FILLER                  PIC XX.
  6447         16  LA4-CARRIER             PIC X.
  6448         16  LA4-CLAIM-NO            PIC X(7).
  6449         16  LA4-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 116
* EL131.cbl
  6450             20  LA4-CERT-PRIME      PIC X(10).
  6451             20  LA4-CERT-SFX        PIC X.
  6452         16  LA4-NO-OF-COPIES        PIC S9.
  6453         16  LA4-RESEND-DATE         PIC XX.
  6454         16  LA4-PROCESSOR-CD        PIC X(4).
  6455         16  LA4-CREATION-DT         PIC XX.
  6456         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6457         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6458         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6459         16  LA4-FORM-TYPE           PIC X.
  6460             88  LA4-INITIAL-FORM    VALUE '1'.
  6461             88  LA4-PROGRESS-FORM   VALUE '2'.
  6462         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6463         16  LA4-STATE               PIC X(02).
  6464         16  FILLER                  PIC X(31).
  6465******************************************************************
  6466
  6467*                                COPY ELCBENE.
  6468******************************************************************
  6469*                                                                *
  6470*                            ELCBENE.                            *
  6471*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6472*                            VMOD=2.006                          *
  6473*                                                                *
  6474*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6475*                                                                *
  6476*   FILE TYPE = VSAM,KSDS                                        *
  6477*   RECORD SIZE = 500   RECFORM = FIX                            *
  6478*                                                                *
  6479*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6480*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6481*                                                                *
  6482*   LOG = YES                                                    *
  6483*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6484*                                                                *
  6485*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6486******************************************************************
  6487
  6488 01  BENEFICIARY-MASTER.
  6489     12  BE-RECORD-ID                PIC XX.
  6490         88  VALID-BE-ID                VALUE 'BE'.
  6491
  6492     12  BE-CONTROL-PRIMARY.
  6493         16  BE-COMPANY-CD           PIC X.
  6494         16  BE-RECORD-TYPE          PIC X.
  6495             88  BENEFICIARY-RECORD  VALUE 'B'.
  6496             88  ADJUSTOR-RECORD     VALUE 'A'.
  6497         16  BE-BENEFICIARY          PIC X(10).
  6498     12  BE-CONTROL-BY-NAME.
  6499         16  BE-COMPANY-CD-A1        PIC X.
  6500         16  BE-RECORD-TYPE-A1       PIC X.
  6501         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6502         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6503
  6504     12  BE-LAST-MAINT-DT            PIC XX.
  6505     12  BE-LAST-MAINT-BY            PIC X(4).
  6506     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6507
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 117
* EL131.cbl
  6508     12  BE-ADDRESS-DATA.
  6509         16  BE-MAIL-TO-NAME         PIC X(30).
  6510         16  BE-ADDRESS-LINE-1       PIC X(30).
  6511         16  BE-ADDRESS-LINE-2       PIC X(30).
  6512         16  BE-ADDRESS-LINE-3       PIC X(30).
  6513         16  BE-CITY-STATE.
  6514             20  BE-CITY             PIC X(28).
  6515             20  BE-STATE            PIC XX.
  6516         16  BE-ZIP-CODE.
  6517             20  BE-ZIP-PRIME.
  6518                 24  BE-ZIP-1ST      PIC X.
  6519                     88  BE-CANADIAN-POST-CODE
  6520                                         VALUE 'A' THRU 'Z'.
  6521                 24  FILLER          PIC X(4).
  6522             20  BE-ZIP-PLUS4        PIC X(4).
  6523         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6524             20  BE-CAN-POSTAL-1     PIC XXX.
  6525             20  BE-CAN-POSTAL-2     PIC XXX.
  6526             20  FILLER              PIC XXX.
  6527         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6528         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6529
  6530******************************************************************
  6531*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6532*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6533******************************************************************
  6534     12  BE-CARRIER                  PIC X.
  6535
  6536     12  BE-ADDRESS-DATA2.
  6537         16  BE-MAIL-TO-NAME2        PIC X(30).
  6538         16  BE-ADDRESS-LINE-12      PIC X(30).
  6539         16  BE-ADDRESS-LINE-22      PIC X(30).
  6540         16  BE-ADDRESS-LINE-32      PIC X(30).
  6541         16  BE-CITY-STATE2.
  6542             20  BE-CITY2            PIC X(28).
  6543             20  BE-STATE2           PIC XX.
  6544         16  BE-ZIP-CODE2.
  6545             20  BE-ZIP-PRIME2.
  6546                 24  BE-ZIP-1ST2     PIC X.
  6547                     88  BE-CANADIAN-POST-CODE2
  6548                                         VALUE 'A' THRU 'Z'.
  6549                 24  FILLER          PIC X(4).
  6550             20  BE-ZIP-PLUS42       PIC X(4).
  6551         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6552             20  BE-CAN-POSTAL-12    PIC XXX.
  6553             20  BE-CAN-POSTAL-22    PIC XXX.
  6554             20  FILLER              PIC XXX.
  6555         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6556         16  BE-BILLING-STMT-DATA.
  6557             20  BE-BSR              PIC X.
  6558                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6559                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6560             20  BE-BSR-FROM         PIC X(30).
  6561             20  BE-BSR-DEPT         PIC X(30).
  6562             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6563             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6564             20  BE-OUTPUT-TYPE      PIC X.
  6565                 88  BE-FAX-OUTPUT         VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 118
* EL131.cbl
  6566                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6567
  6568     12  FILLER                      PIC X(28).
  6569******************************************************************
  6570
  6571*                                COPY ELCDAR.
  6572******************************************************************
  6573*                                                                *
  6574*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6575*   FILE TYPE = VSAM,KSDS                                        *
  6576*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6577*   BASE CLUSTER = DLYACTV                                       *
  6578*   LOG = YES                                                    *
  6579*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6580*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6581*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6582*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6583*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6584*               BY PROGRAM "LGINFCE".                            *
  6585*                                                                *
  6586******************************************************************
  6587 01  DAILY-ACTIVITY-RECORD.
  6588     05  DA-KEY.
  6589         10  DA-COMP-CD          PIC X.
  6590         10  DA-CARRIER          PIC X.
  6591         10  DA-CLAIM-NO         PIC X(7).
  6592         10  DA-CERT-NO.
  6593             15  DA-CERT-PRIME   PIC X(10).
  6594             15  DA-CERT-SFX     PIC X.
  6595     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6596     05  DA-RECORD-TYPE          PIC X.
  6597     05  FILLER                  PIC X(2).
  6598******************************************************************
  6599
  6600*                                COPY ELCALPH.
  6601******************************************************************
  6602*                                                                *
  6603*                            ELCALPH.                            *
  6604*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6605*                            VMOD=2.003                          *
  6606*                                                                *
  6607*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  6608*                                                                *
  6609*   FILE TYPE = VSAM,KSDS                                        *
  6610*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6611*                                                                *
  6612*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6613*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6614*                                                                *
  6615*   LOG = YES                                                    *
  6616*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6617*                                                                *
  6618*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  6619******************************************************************
  6620
  6621 01  ALPHA-INDEX.
  6622     12  AI-RECORD-ID                         PIC XX.
  6623         88  VALID-AI-ID                  VALUE 'AI'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 119
* EL131.cbl
  6624     12  AI-CONTROL-PRIMARY.
  6625         16  AI-COMPANY-CD                     PIC X.
  6626         16  AI-SOURCE                         PIC X.
  6627             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  6628             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  6629         16  AI-NAME.
  6630             20  AI-LAST-NAME                  PIC X(15).
  6631             20  AI-FIRST-NAME.
  6632                 24  AI-FIRST-INITIAL          PIC X.
  6633                 24  FILLER                    PIC X(11).
  6634             20  AI-MIDDLE-INIT                PIC X.
  6635         16  AI-DATE                           PIC X(8).
  6636         16  AI-TIME                           PIC S9(07) COMP-3.
  6637
  6638     12  AI-CONTROL-BY-ADMIN-KEY.
  6639         16  AI-CM-COMPANY-CD                  PIC X.
  6640         16  AI-CM-SOURCE                      PIC X.
  6641         16  AI-CM-CARRIER                     PIC X.
  6642         16  AI-CM-GROUPING.
  6643             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  6644             20  AI-CM-GROUPING-PRIME          PIC X(3).
  6645         16  AI-CM-STATE                       PIC XX.
  6646         16  AI-CM-PRODUCER.
  6647             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  6648             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  6649         16  AI-CM-CERT-EFF-DT                 PIC XX.
  6650         16  AI-CM-CERTIFICATE-NUMBER.
  6651             20  AI-CM-CERT-PRIME              PIC X(10).
  6652             20  AI-CM-CERT-SFX                PIC X.
  6653         16  AI-CM-DATE                        PIC X(8).
  6654         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  6655         16  FILLER                            PIC X(11).
  6656
  6657     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  6658         AI-CONTROL-BY-ADMIN-KEY.
  6659         16  AI-CL-COMPANY-CD                  PIC X.
  6660         16  AI-CL-SOURCE                      PIC X.
  6661         16  AI-CL-CARRIER                     PIC X.
  6662         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  6663         16  AI-CL-CERTIFICATE-NUMBER.
  6664             20  AI-CL-CERT-PRIME              PIC X(10).
  6665             20  AI-CL-CERT-SFX                PIC X.
  6666         16  AI-CL-DATE                        PIC X(8).
  6667         16  AI-CL-INCURRED-DATE               PIC XX.
  6668         16  AI-CL-CLOSE-DATE                  PIC XX.
  6669         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  6670         16  AI-CREDIT-CARD-NUMBER.
  6671             20  AI-CCN.
  6672                 24  AI-CCN-PREFIX             PIC X(4).
  6673                 24  AI-CCN-PRIME              PIC X(12).
  6674             20  AI-CCN-FILLER                 PIC X(4).
  6675
  6676     12  AI-MAINT-INFO.
  6677         16  AI-LAST-MAINT-BY                  PIC X(4).
  6678         16  AI-LAST-MAINT-DT                  PIC XX.
  6679         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6680
  6681     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 120
* EL131.cbl
  6682
  6683     12  FILLER                                PIC X(15).
  6684
  6685
  6686*                                COPY ERCDMDNT.
  6687******************************************************************
  6688*                                                                *
  6689*                            ERCDMDNT                            *
  6690*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6691*                            VMOD=2.005                          *
  6692*                                                                *
  6693*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  6694*                                                                *
  6695*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  6696*                                                                *
  6697*        FILE TYPE= VSAM,KSDS                                    *
  6698*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6699*                                                                *
  6700*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6701*                                                                *
  6702*        LOG = YES                                               *
  6703*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6704*                                                                *
  6705******************************************************************
  6706
  6707 01  CERTIFICATE-NOTE.
  6708     12  CN-RECORD-ID                     PIC  XX.
  6709         88  VALID-CN-ID                      VALUE 'CN'.
  6710
  6711     12  CN-CONTROL-PRIMARY.
  6712         16  CN-COMPANY-CD                PIC X.
  6713         16  CN-CERT-KEY.
  6714             20  CN-CARRIER               PIC X.
  6715             20  CN-GROUPING.
  6716                 24  CN-GROUPING-PREFIX   PIC XXX.
  6717                 24  CN-GROUPING-PRIME    PIC XXX.
  6718             20  CN-STATE                 PIC XX.
  6719             20  CN-ACCOUNT.
  6720                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  6721                 24  CN-ACCOUNT-PRIME     PIC X(6).
  6722             20  CN-CERT-EFF-DT           PIC XX.
  6723             20  CN-CERT-NO.
  6724                 24  CN-CERT-PRIME        PIC X(10).
  6725                 24  CN-CERT-SFX          PIC X.
  6726
  6727     12  CN-BILLING-START-LINE-NO         PIC 99.
  6728     12  CN-BILLING-END-LINE-NO           PIC 99.
  6729
  6730     12  CN-LINES.
  6731         16  CN-LINE                      PIC X(77)  OCCURS 10.
  6732
  6733     12  CN-CSI-NOTES REDEFINES CN-LINES.
  6734         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  6735         16  CN-CSI-GENERAL-DATA-AREA.
  6736             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  6737
  6738         16  CN-CSI-GENERAL-DATA-R REDEFINES
  6739             CN-CSI-GENERAL-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 121
* EL131.cbl
  6740             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  6741             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  6742             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  6743             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  6744             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  6745             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  6746             20  CN-CSI-GEN-INFRM-MI          PIC X.
  6747             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  6748             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  6749             20  FILLER                       PIC XX.
  6750             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  6751             20  FILLER                       PIC X(38).
  6752
  6753         16  CN-CSI-PRODUCT-DATA-AREA.
  6754             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  6755
  6756         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  6757             CN-CSI-PRODUCT-DATA-AREA.
  6758             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  6759             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  6760             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  6761             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  6762             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  6763             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  6764             20  FILLER                   PIC XX.
  6765             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  6766             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  6767             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  6768             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  6769             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  6770             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  6771             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  6772             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  6773             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  6774             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  6775             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  6776             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  6777             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  6778             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  6779             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  6780             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  6781             20  CN-CSI-CC-TERM-AGE       PIC 999.
  6782             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  6783             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  6784             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  6785             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  6786             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  6787             20  FILLER                   PIC X(25).
  6788
  6789         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  6790             CN-CSI-CREDIT-CARD-DATA.
  6791             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  6792             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  6793             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  6794             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  6795             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  6796             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  6797             20  FILLER                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 122
* EL131.cbl
  6798             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  6799             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  6800             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  6801             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  6802             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  6803             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  6804             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  6805             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  6806             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  6807             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  6808             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  6809             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  6810             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  6811             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  6812             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  6813             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  6814             20  CN-CSI-FL-TERM-AGE       PIC 999.
  6815             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  6816             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  6817             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  6818             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  6819             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  6820             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  6821             20  FILLER                   PIC X(17).
  6822
  6823         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  6824             CN-CSI-FAMILY-LEAVE-DATA.
  6825             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  6826             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  6827             20  CN-CSI-SL-BENE-REL       PIC X(8).
  6828             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  6829             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  6830             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  6831             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  6832             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  6833             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  6834             20  CN-CSI-SL-INT-ON-PROCEEDS
  6835                                          PIC S9(5)V99  COMP-3.
  6836             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  6837             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  6838             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  6839             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  6840             20  CN-CSI-SL-POLICY-BENEFITS
  6841                                          PIC S9(5)V99  COMP-3.
  6842             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  6843             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  6844             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  6845             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  6846             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  6847             20  CN-CSI-SL-PREM-MODE      PIC 99.
  6848             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  6849             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  6850             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  6851             20  CN-CSI-SL-STATE-NOT      PIC X.
  6852             20  FILLER                   PIC XX.
  6853
  6854         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  6855             CN-CSI-SENIOR-LIFE-DATA.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 123
* EL131.cbl
  6856             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  6857             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  6858             20  CN-CSI-PP-BEN-PAID-TO-DATE
  6859                                          PIC S9(5)V99  COMP-3.
  6860             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  6861             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  6862             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  6863             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  6864             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  6865             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  6866             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  6867             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  6868             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  6869             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  6870             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  6871             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  6872             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  6873             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  6874             20  CN-CSI-PP-REPAIR         PIC X.
  6875             20  CN-CSI-PP-REPLACE        PIC X.
  6876             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  6877             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  6878             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  6879             20  CN-CSI-PP-TERM-AGE       PIC 999.
  6880             20  FILLER                   PIC X(5).
  6881
  6882         16  CN-CSI-EXT-WARR-DATA REDEFINES
  6883             CN-CSI-PURCH-PROP-DATA.
  6884             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  6885             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  6886             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  6887             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  6888             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  6889             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  6890             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  6891             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  6892             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  6893             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  6894             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  6895             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  6896             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  6897             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  6898             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  6899             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  6900             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  6901             20  CN-CSI-EW-REPLACE        PIC X.
  6902             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  6903             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  6904             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  6905             20  CN-CSI-EW-TERM-AGE       PIC 999.
  6906             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  6907             20  FILLER                   PIC X(4).
  6908
  6909     12  CN-LAST-MAINT-DT                 PIC XX.
  6910     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  6911     12  CN-LAST-MAINT-USER               PIC X(4).
  6912     12  FILLER                           PIC X(6).
  6913
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 124
* EL131.cbl
  6914******************************************************************
  6915
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 125
* EL131.cbl
  6917 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  6918                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  6919                          CONTROL-FILE ACTIVITY-QUE
  6920                          ACCOUNT-MASTER CHECK-QUE
  6921                          LETTER-ARCHIVE BENEFICIARY-MASTER
  6922                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  6923                          CERTIFICATE-NOTE.
  6924 0000-DFHEXIT SECTION.
  6925     MOVE '9#                    $   ' TO DFHEIV0.
  6926     MOVE 'EL131' TO DFHEIV1.
  6927     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6928
  6929     IF EIBCALEN = ZERO
  6930         GO TO 8800-UNAUTHORIZED-ACCESS.
  6931
  6932     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6933     MOVE '5'                    TO DC-OPTION-CODE.
  6934     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  6935     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6936     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  6937     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6938
  6939     IF SAVE-DATE-YY GREATER 70
  6940         MOVE 19                 TO SAVE-DATE-CC
  6941      ELSE
  6942         MOVE 20                 TO SAVE-DATE-CC.
  6943
  6944
  6945* EXEC CICS HANDLE CONDITION
  6946*        PGMIDERR (8820-XCTL-ERROR)
  6947*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  6948*        ERROR    (9990-ABEND)
  6949*    END-EXEC.
  6950*    MOVE '"$LI.                 ! " #00006940' TO DFHEIV0
  6951     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  6952     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6953     MOVE X'2220233030303036393430' TO DFHEIV0(25:11)
  6954     CALL 'kxdfhei1' USING DFHEIV0
  6955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6956
  6957
  6958     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  6959     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6960     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6961
  6962     INITIALIZE    EDIT-WORK-AREA.
  6963     MOVE '/'                    TO WORK-SLASH.
  6964     MOVE SPACES                 TO ERROR-SWITCHES.
  6965
  6966     MOVE TRAN-ID                TO TRANS-ID.
  6967     MOVE EIBTRMID               TO PI-TERM.
  6968     MOVE MAP-ID                 TO PI-QUAL.
  6969
  6970     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  6971
  6972     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6973         MOVE LOW-VALUES         TO EL131AO
  6974         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 126
* EL131.cbl
  6975         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6976         MOVE -1                 TO MAINTL
  6977         GO TO 8110-SEND-DATA.
  6978
  6979     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  6980         MOVE LOW-VALUES         TO EL131AO
  6981         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  6982         MOVE 'X'                TO PI-RETURN-CD-1
  6983         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  6984         MOVE -1                 TO MAINTL
  6985         GO TO 8100-SEND-MAP.
  6986
  6987     IF EIBAID = DFHCLEAR
  6988         GO TO 8200-RETURN-PRIOR.
  6989
  6990     IF PI-PROCESSOR-ID = 'LGXX'
  6991         NEXT SENTENCE
  6992     ELSE
  6993
  6994* EXEC CICS READQ TS
  6995*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6996*            INTO    (SECURITY-CONTROL)
  6997*            LENGTH  (SC-COMM-LENGTH)
  6998*            ITEM    (SC-ITEM)
  6999*        END-EXEC
  7000*    MOVE '*$II   L              ''   #00006981' TO DFHEIV0
  7001     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7002     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7003     MOVE X'2020233030303036393831' TO DFHEIV0(25:11)
  7004     CALL 'kxdfhei1' USING DFHEIV0,
  7005           PI-SECURITY-TEMP-STORE-ID,
  7006           SECURITY-CONTROL,
  7007           SC-COMM-LENGTH,
  7008           SC-ITEM,
  7009           DFHEIV99,
  7010           DFHEIV99
  7011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7012         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7013         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7014         IF NOT DISPLAY-CAP
  7015             MOVE 'READ'               TO  SM-READ
  7016             PERFORM 9995-SECURITY-VIOLATION
  7017             MOVE ER-0070              TO  EMI-ERROR
  7018             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7019             GO TO 8100-SEND-MAP.
  7020
  7021
  7022* EXEC CICS RECEIVE
  7023*        MAP    ('EL131A')
  7024*        MAPSET ('EL131S')
  7025*    END-EXEC.
  7026     MOVE 'EL131A' TO DFHEIV1
  7027     MOVE 'EL131S' TO DFHEIV2
  7028*    MOVE '8"T                   ''   #00006996' TO DFHEIV0
  7029     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7030     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7031     MOVE X'2020233030303036393936' TO DFHEIV0(25:11)
  7032     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 127
* EL131.cbl
  7033           DFHEIV1,
  7034           EL131AI,
  7035           DFHEIV99,
  7036           DFHEIV2,
  7037           DFHEIV99,
  7038           DFHEIV99
  7039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7040
  7041
  7042     IF PFKEYL GREATER THAN ZERO
  7043         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7044
  7045     IF SCREEN-ERROR
  7046         MOVE ER-0004 TO EMI-ERROR
  7047         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7048         MOVE -1 TO MAINTL
  7049         GO TO 8110-SEND-DATA.
  7050
  7051     IF EIBAID = DFHPF3
  7052         GO TO 8500-TRLR-MNT.
  7053
  7054     IF EIBAID = DFHPF4
  7055         GO TO 8600-ADDR-MNT.
  7056
  7057     IF EIBAID = DFHPF5
  7058         GO TO 8700-CERT-MNT.
  7059
  7060     IF PI-COMPANY-ID = 'DMD'
  7061       IF EIBAID = DFHPF6
  7062         GO TO 8750-DMD-CLM-FIX.
  7063
  7064     IF EIBAID = DFHPF7
  7065         GO TO 4000-FORCE-ERRORS.
  7066
  7067     IF EIBAID = DFHPF12
  7068         GO TO 8300-GET-HELP.
  7069
  7070     IF EIBAID = DFHPF23
  7071         GO TO 8810-PF23-ENTERED.
  7072
  7073     IF EIBAID = DFHPF24
  7074         GO TO 8400-RETURN-MASTER.
  7075
  7076     IF EIBAID NOT = DFHENTER
  7077         MOVE ER-0029            TO EMI-ERROR
  7078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7079         MOVE -1                 TO MAINTL
  7080         GO TO 8110-SEND-DATA.
  7081
  7082     IF PI-RETURN-CD-1 =  'X'
  7083         MOVE ER-0311            TO EMI-ERROR
  7084         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7085         MOVE -1                 TO MAINTL
  7086         GO TO 8110-SEND-DATA.
  7087
  7088     IF MAINTI = 'A'
  7089         GO TO 0500-ADD-ALPHA-ONLY.
  7090
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 128
* EL131.cbl
  7091     IF MAINTI = 'N'
  7092         GO TO 0600-CHANGE-NAME.
  7093
  7094     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7095
  7096     IF SCREEN-ERROR
  7097         GO TO 8110-SEND-DATA.
  7098
  7099     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7100         MOVE ER-0276            TO EMI-ERROR
  7101         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7102         MOVE -1                 TO MAINTL
  7103         GO TO 8110-SEND-DATA.
  7104
  7105     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7106
  7107     IF SCREEN-ERROR
  7108         GO TO 8110-SEND-DATA.
  7109
  7110     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7111
  7112     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7113
  7114     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7115         GO TO 8110-SEND-DATA.
  7116
  7117     IF EMI-FATAL-CTR GREATER THAN ZERO
  7118         GO TO 8110-SEND-DATA.
  7119
  7120     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7121
  7122     IF WS-OPEN-CLOSE-SW = 'Y'
  7123         IF PI-LETTER-SW = 'Y'
  7124             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7125             MOVE 'T'            TO  CNTL-REC-TYPE
  7126             MOVE SPACES         TO  CNTL-PROC-ID
  7127             MOVE +0             TO  CNTL-SEQ-NO
  7128
  7129* EXEC CICS READ
  7130*                DATASET   (CNTL-FILE-ID)
  7131*                RIDFLD    (CNTL-KEY)
  7132*                SET       (ADDRESS OF CONTROL-FILE)
  7133*            END-EXEC
  7134*    MOVE '&"S        E          (   #00007087' TO DFHEIV0
  7135     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7137     MOVE X'2020233030303037303837' TO DFHEIV0(25:11)
  7138     CALL 'kxdfhei1' USING DFHEIV0,
  7139           CNTL-FILE-ID,
  7140           DFHEIV20,
  7141           DFHEIV99,
  7142           CNTL-KEY,
  7143           DFHEIV99,
  7144           DFHEIV99,
  7145           DFHEIV99
  7146     SET ADDRESS OF CONTROL-FILE TO
  7147         DFHEIV20
  7148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 129
* EL131.cbl
  7149             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7150
  7151     MOVE ER-0000                TO EMI-ERROR.
  7152     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7153
  7154     MOVE SPACE                  TO MAINTO.
  7155     MOVE -1                     TO MAINTL.
  7156     GO TO 8100-SEND-MAP.
  7157
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 130
* EL131.cbl
  7159 0100-UPDATE-PI.
  7160     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7161         GO TO 0110-UPDATE-UP.
  7162
  7163     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7164     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7165     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7166     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7167     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7168     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7169     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7170     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7171     GO TO 0120-UPDATE-PI-EXIT.
  7172
  7173 0110-UPDATE-UP.
  7174     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7175     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7176     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7177     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7178     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7179     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7180     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7181     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7182
  7183
  7184* EXEC CICS HANDLE CONDITION
  7185*         QIDERR    (0130-TS-ERROR)
  7186*         ITEMERR   (0130-TS-ERROR)
  7187*    END-EXEC.
  7188*    MOVE '"$N<                  ! # #00007126' TO DFHEIV0
  7189     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7191     MOVE X'2320233030303037313236' TO DFHEIV0(25:11)
  7192     CALL 'kxdfhei1' USING DFHEIV0
  7193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7194
  7195
  7196
  7197* EXEC CICS READQ TS
  7198*         QUEUE    (PI-KEY)
  7199*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7200*         LENGTH   (PI-COMM-LENGTH)
  7201*    END-EXEC.
  7202*    MOVE '*$I    L              ''   #00007131' TO DFHEIV0
  7203     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7204     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7205     MOVE X'2020233030303037313331' TO DFHEIV0(25:11)
  7206     CALL 'kxdfhei1' USING DFHEIV0,
  7207           PI-KEY,
  7208           PROGRAM-INTERFACE-BLOCK,
  7209           PI-COMM-LENGTH,
  7210           DFHEIV99,
  7211           DFHEIV99,
  7212           DFHEIV99
  7213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7214
  7215
  7216
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 131
* EL131.cbl
  7217* EXEC CICS DELETEQ TS
  7218*         QUEUE    (PI-KEY)
  7219*    END-EXEC.
  7220*    MOVE '*&                    #   #00007137' TO DFHEIV0
  7221     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7222     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7223     MOVE X'2020233030303037313337' TO DFHEIV0(25:11)
  7224     CALL 'kxdfhei1' USING DFHEIV0,
  7225           PI-KEY,
  7226           DFHEIV99
  7227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7228
  7229
  7230 0120-UPDATE-PI-EXIT.
  7231     EXIT.
  7232
  7233 0130-TS-ERROR.
  7234     MOVE LOW-VALUES             TO EL131AO.
  7235     MOVE ER-0192                TO EMI-ERROR.
  7236
  7237     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7238
  7239     GO TO 8100-SEND-MAP.
  7240
  7241 0200-TRANS-PF.
  7242     IF EIBAID NOT = DFHENTER
  7243         MOVE 'X'                TO ERROR-SWITCH
  7244         GO TO 0210-EXIT.
  7245
  7246     IF PFKEYI NOT NUMERIC
  7247         MOVE 'X'                TO ERROR-SWITCH
  7248         GO TO 0210-EXIT.
  7249
  7250     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7251
  7252     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7253         MOVE 'X' TO ERROR-SWITCH
  7254         GO TO 0210-EXIT.
  7255
  7256     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7257
  7258 0210-EXIT.
  7259     EXIT.
  7260
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 132
* EL131.cbl
  7262 0500-ADD-ALPHA-ONLY.
  7263******************************************************************
  7264*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7265*    RECORD.                                                     *
  7266******************************************************************
  7267
  7268     IF MLNAMEL = +0 AND
  7269        MFNAMEL = +0 AND
  7270        MMINITL = +0
  7271         MOVE ER-0797                TO  EMI-ERROR
  7272         MOVE -1                     TO  MAINTL
  7273         MOVE AL-UABON               TO  MAINTA
  7274         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7275         GO TO 8110-SEND-DATA.
  7276
  7277     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7278     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7279     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7280     MOVE PI-CERT-NO                 TO  CERT-NO.
  7281
  7282
  7283* EXEC CICS READ
  7284*        DATASET   (CLMS-FILE-ID)
  7285*        RIDFLD    (MSTR-KEY)
  7286*        SET       (ADDRESS OF CLAIM-MASTER)
  7287*    END-EXEC.
  7288*    MOVE '&"S        E          (   #00007193' TO DFHEIV0
  7289     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7290     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7291     MOVE X'2020233030303037313933' TO DFHEIV0(25:11)
  7292     CALL 'kxdfhei1' USING DFHEIV0,
  7293           CLMS-FILE-ID,
  7294           DFHEIV20,
  7295           DFHEIV99,
  7296           MSTR-KEY,
  7297           DFHEIV99,
  7298           DFHEIV99,
  7299           DFHEIV99
  7300     SET ADDRESS OF CLAIM-MASTER TO
  7301         DFHEIV20
  7302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7303
  7304
  7305
  7306* EXEC CICS GETMAIN
  7307*        SET       (ADDRESS OF ALPHA-INDEX)
  7308*        LENGTH    (ALPH-LENGTH)
  7309*        INITIMG   (GETMAIN-SPACE)
  7310*    END-EXEC.
  7311*    MOVE ',"IL                  $   #00007199' TO DFHEIV0
  7312     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7313     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7314     MOVE X'2020233030303037313939' TO DFHEIV0(25:11)
  7315     CALL 'kxdfhei1' USING DFHEIV0,
  7316           DFHEIV20,
  7317           ALPH-LENGTH,
  7318           GETMAIN-SPACE
  7319     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 133
* EL131.cbl
  7320         DFHEIV20
  7321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7322
  7323
  7324     MOVE 'AI'                       TO  AI-RECORD-ID.
  7325     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7326                                         AI-CL-COMPANY-CD.
  7327     MOVE 'C'                        TO  AI-SOURCE
  7328                                         AI-CL-SOURCE.
  7329
  7330     IF MLNAMEL IS GREATER THAN +0
  7331         MOVE MLNAMEI                TO  AI-LAST-NAME
  7332     ELSE
  7333         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7334
  7335     IF MFNAMEL IS GREATER THAN +0
  7336         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7337     ELSE
  7338         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7339
  7340     IF MMINITL IS GREATER THAN +0
  7341         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7342     ELSE
  7343         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7344
  7345     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7346     MOVE '5'                        TO  DC-OPTION-CODE.
  7347     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7348     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7349     IF BUILD-YEAR IS GREATER THAN 50
  7350         MOVE '19'                   TO  WS-ALPHA-YY-1
  7351         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7352         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7353         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7354     ELSE
  7355         MOVE '20'                   TO  WS-ALPHA-YY-1
  7356         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7357         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7358         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7359
  7360     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7361                                         AI-CL-DATE.
  7362
  7363     MOVE EIBTIME                    TO  AI-TIME
  7364                                         AI-CL-TIME.
  7365
  7366     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7367     MOVE 'C'                        TO  AI-CL-SOURCE.
  7368     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7369     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7370     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7371     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7372     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7373
  7374     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7375     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7376     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7377
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 134
* EL131.cbl
  7378
  7379* EXEC CICS WRITE
  7380*        DATASET   (ALPH-FILE-ID)
  7381*        RIDFLD    (AI-CONTROL-PRIMARY)
  7382*        FROM      (ALPHA-INDEX)
  7383*    END-EXEC.
  7384     MOVE LENGTH OF
  7385      ALPHA-INDEX
  7386       TO DFHEIV11
  7387*    MOVE '&$ L                  ''   #00007259' TO DFHEIV0
  7388     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7389     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7390     MOVE X'2020233030303037323539' TO DFHEIV0(25:11)
  7391     CALL 'kxdfhei1' USING DFHEIV0,
  7392           ALPH-FILE-ID,
  7393           ALPHA-INDEX,
  7394           DFHEIV11,
  7395           AI-CONTROL-PRIMARY,
  7396           DFHEIV99,
  7397           DFHEIV99
  7398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7399
  7400
  7401     MOVE LOW-VALUES                 TO  EL131AO.
  7402     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7403     MOVE ER-0000                    TO  EMI-ERROR.
  7404     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7405     MOVE -1                         TO  MAINTL.
  7406     GO TO 8100-SEND-MAP.
  7407
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 135
* EL131.cbl
  7409 0600-CHANGE-NAME.
  7410******************************************************************
  7411*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7412*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7413******************************************************************
  7414
  7415     IF MLNAMEL = +0 AND
  7416        MFNAMEL = +0 AND
  7417        MMINITL = +0
  7418         MOVE ER-0276                TO  EMI-ERROR
  7419         MOVE -1                     TO  MAINTL
  7420         MOVE AL-UABON               TO  MAINTA
  7421         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7422         GO TO 8110-SEND-DATA.
  7423
  7424     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7425     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7426     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7427     MOVE PI-CERT-NO                 TO  CERT-NO.
  7428
  7429
  7430* EXEC CICS READ
  7431*        DATASET   (CLMS-FILE-ID)
  7432*        RIDFLD    (MSTR-KEY)
  7433*        SET       (ADDRESS OF CLAIM-MASTER)
  7434*    END-EXEC.
  7435*    MOVE '&"S        E          (   #00007293' TO DFHEIV0
  7436     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7437     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7438     MOVE X'2020233030303037323933' TO DFHEIV0(25:11)
  7439     CALL 'kxdfhei1' USING DFHEIV0,
  7440           CLMS-FILE-ID,
  7441           DFHEIV20,
  7442           DFHEIV99,
  7443           MSTR-KEY,
  7444           DFHEIV99,
  7445           DFHEIV99,
  7446           DFHEIV99
  7447     SET ADDRESS OF CLAIM-MASTER TO
  7448         DFHEIV20
  7449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7450
  7451
  7452
  7453* EXEC CICS GETMAIN
  7454*        SET       (ADDRESS OF ALPHA-INDEX)
  7455*        LENGTH    (ALPH-LENGTH)
  7456*        INITIMG   (GETMAIN-SPACE)
  7457*    END-EXEC.
  7458*    MOVE ',"IL                  $   #00007299' TO DFHEIV0
  7459     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7460     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7461     MOVE X'2020233030303037323939' TO DFHEIV0(25:11)
  7462     CALL 'kxdfhei1' USING DFHEIV0,
  7463           DFHEIV20,
  7464           ALPH-LENGTH,
  7465           GETMAIN-SPACE
  7466     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 136
* EL131.cbl
  7467         DFHEIV20
  7468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7469
  7470
  7471     MOVE 'AI'                       TO  AI-RECORD-ID.
  7472     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7473                                         AI-CL-COMPANY-CD.
  7474     MOVE 'C'                        TO  AI-SOURCE
  7475                                         AI-CL-SOURCE.
  7476
  7477     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7478     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7479     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7480
  7481     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7482     MOVE '5'                        TO  DC-OPTION-CODE.
  7483     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7484     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7485     IF BUILD-YEAR IS GREATER THAN 50
  7486         MOVE '19'                   TO  WS-ALPHA-YY-1
  7487         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7488         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7489         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7490     ELSE
  7491         MOVE '20'                   TO  WS-ALPHA-YY-1
  7492         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7493         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7494         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7495
  7496     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7497                                         AI-CL-DATE.
  7498
  7499     MOVE EIBTIME                    TO  AI-TIME
  7500                                         AI-CL-TIME.
  7501
  7502     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7503     MOVE 'C'                        TO  AI-CL-SOURCE.
  7504     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7505     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7506     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7507     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7508     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7509
  7510     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7511     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7512     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7513
  7514     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7515         MOVE 'Y'                TO CL-YESNOSW
  7516     END-IF.
  7517
  7518
  7519* EXEC CICS WRITE
  7520*        DATASET   (ALPH-FILE-ID)
  7521*        RIDFLD    (AI-CONTROL-PRIMARY)
  7522*        FROM      (ALPHA-INDEX)
  7523*    END-EXEC.
  7524     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 137
* EL131.cbl
  7525      ALPHA-INDEX
  7526       TO DFHEIV11
  7527*    MOVE '&$ L                  ''   #00007352' TO DFHEIV0
  7528     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7529     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7530     MOVE X'2020233030303037333532' TO DFHEIV0(25:11)
  7531     CALL 'kxdfhei1' USING DFHEIV0,
  7532           ALPH-FILE-ID,
  7533           ALPHA-INDEX,
  7534           DFHEIV11,
  7535           AI-CONTROL-PRIMARY,
  7536           DFHEIV99,
  7537           DFHEIV99
  7538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7539
  7540
  7541
  7542* EXEC CICS READ
  7543*        DATASET   (CLMS-FILE-ID)
  7544*        RIDFLD    (MSTR-KEY)
  7545*        SET       (ADDRESS OF CLAIM-MASTER)
  7546*        UPDATE
  7547*    END-EXEC.
  7548*    MOVE '&"S        EU         (   #00007358' TO DFHEIV0
  7549     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7550     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7551     MOVE X'2020233030303037333538' TO DFHEIV0(25:11)
  7552     CALL 'kxdfhei1' USING DFHEIV0,
  7553           CLMS-FILE-ID,
  7554           DFHEIV20,
  7555           DFHEIV99,
  7556           MSTR-KEY,
  7557           DFHEIV99,
  7558           DFHEIV99,
  7559           DFHEIV99
  7560     SET ADDRESS OF CLAIM-MASTER TO
  7561         DFHEIV20
  7562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7563
  7564
  7565     if (cl-priority-cd = '8')
  7566        and (pi-processor-id not = 'PEMA'and 'JMS '
  7567             AND 'AMWA')
  7568        MOVE ER-8003             TO EMI-ERROR
  7569        PERFORM 9900-ERROR-FORMAT
  7570                                 THRU 9900-EXIT
  7571        MOVE -1                  TO MAINTL
  7572        GO TO 8110-SEND-DATA
  7573     end-if
  7574
  7575     IF MLNAMEL IS GREATER THAN +0
  7576         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  7577
  7578     IF MFNAMEL IS GREATER THAN +0
  7579         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  7580
  7581     IF MMINITL IS GREATER THAN +0
  7582         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 138
* EL131.cbl
  7583
  7584     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  7585     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  7586     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  7587     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  7588
  7589     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7590         MOVE 'Y'                TO CL-YESNOSW
  7591     END-IF.
  7592
  7593
  7594* EXEC CICS HANDLE CONDITION
  7595*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  7596*    END-EXEC.
  7597*    MOVE '"$$                   ! $ #00007393' TO DFHEIV0
  7598     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  7599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7600     MOVE X'2420233030303037333933' TO DFHEIV0(25:11)
  7601     CALL 'kxdfhei1' USING DFHEIV0
  7602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7603
  7604
  7605
  7606* EXEC CICS REWRITE
  7607*        DATASET   (CLMS-FILE-ID)
  7608*        FROM      (CLAIM-MASTER)
  7609*    END-EXEC.
  7610     MOVE LENGTH OF
  7611      CLAIM-MASTER
  7612       TO DFHEIV11
  7613*    MOVE '&& L                  %   #00007397' TO DFHEIV0
  7614     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7615     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7616     MOVE X'2020233030303037333937' TO DFHEIV0(25:11)
  7617     CALL 'kxdfhei1' USING DFHEIV0,
  7618           CLMS-FILE-ID,
  7619           CLAIM-MASTER,
  7620           DFHEIV11,
  7621           DFHEIV99
  7622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7623
  7624
  7625 0600-CONTINUE-NAME-UPDATE.
  7626
  7627     MOVE LOW-VALUES                 TO  EL131AO.
  7628     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7629     MOVE ER-0000                    TO  EMI-ERROR.
  7630     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7631     MOVE -1                         TO  MAINTL.
  7632     GO TO 8100-SEND-MAP.
  7633
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 139
* EL131.cbl
  7635 1000-EDIT-SCREEN.
  7636
  7637     MOVE MAINTI                 TO CHECK-MAINT.
  7638
  7639     IF NOT VALID-OPTIONS
  7640         MOVE 'X'                TO ERROR-SWITCH
  7641         MOVE -1                 TO MAINTL
  7642         MOVE AL-UABON           TO MAINTA
  7643         MOVE ER-0023            TO EMI-ERROR
  7644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7645         GO TO 1010-EXIT.
  7646
  7647     IF NOT MODIFY-CAP
  7648         MOVE 'UPDATE'           TO  SM-READ
  7649         PERFORM 9995-SECURITY-VIOLATION
  7650         MOVE ER-0070               TO  EMI-ERROR
  7651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7652         GO TO 8100-SEND-MAP.
  7653
  7654     IF DELETE-CLAIM
  7655         MOVE AL-UANON TO MAINTA
  7656         GO TO 1010-EXIT.
  7657
  7658     MOVE AL-UANON               TO MAINTA.
  7659
  7660     IF CCNOI GREATER THAN LOW-VALUES
  7661         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7662
  7663     IF PI-COMPANY-ID = 'CSL'
  7664        CONTINUE
  7665     ELSE
  7666        IF TYPEL > ZERO
  7667           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  7668              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7669                    PI-LIFE-OVERRIDE-L1))
  7670                       OR
  7671              ((PI-COMPANY-ID = 'DCC')
  7672              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7673                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  7674              MOVE AL-UANON      TO TYPEA
  7675              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  7676           ELSE
  7677              MOVE ER-0199       TO EMI-ERROR
  7678              PERFORM 9900-ERROR-FORMAT
  7679                                 THRU 9900-EXIT
  7680              MOVE AL-UABON      TO TYPEA
  7681              MOVE -1            TO TYPEL
  7682              MOVE 'X'           TO ERROR-SWITCH
  7683           END-IF
  7684        ELSE
  7685           MOVE AL-UANOF         TO TYPEA
  7686        END-IF
  7687     END-IF
  7688     IF STATUSI GREATER THAN LOW-VALUES
  7689         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  7690             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  7691             MOVE AL-UANON       TO STATUSA
  7692             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 140
* EL131.cbl
  7693             MOVE 'Y'            TO DLYACTV-SW
  7694         ELSE
  7695             MOVE ER-0333        TO EMI-ERROR
  7696             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7697             MOVE AL-UABON       TO STATUSA
  7698             MOVE -1             TO STATUSL
  7699             MOVE 'X'            TO ERROR-SWITCH
  7700         END-IF
  7701     ELSE
  7702         MOVE SPACE              TO TRLR-SWITCH
  7703         MOVE 'N'                TO DLYACTV-SW
  7704         MOVE AL-UANOF           TO STATUSA.
  7705
  7706     IF PROCI GREATER THAN LOW-VALUES
  7707         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  7708     ELSE
  7709         MOVE AL-UANOF TO PROCA.
  7710
  7711     IF SEXI GREATER THAN LOW-VALUES
  7712         IF SEXI = 'F' OR 'M'
  7713             MOVE AL-UANON       TO SEXA
  7714             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7715           ELSE
  7716             MOVE ER-0219        TO EMI-ERROR
  7717             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7718             MOVE AL-UABON       TO SEXA
  7719             MOVE -1             TO SEXL
  7720             MOVE 'X'            TO ERROR-SWITCH
  7721       ELSE
  7722         MOVE AL-UANOF           TO SEXA.
  7723
  7724     IF BIRTHL = +0
  7725         MOVE LOW-VALUES         TO  HOLD-BIRTH
  7726         MOVE AL-UANOF           TO  BIRTHA
  7727         GO TO 1000-CONTINUE-EDITS.
  7728
  7729     IF BIRTHI = SPACES
  7730         MOVE LOW-VALUES         TO  HOLD-BIRTH
  7731         MOVE 'X'                TO  UPDATE-SWITCH
  7732                                     MSTR-SWITCH
  7733         GO TO 1000-CONTINUE-EDITS.
  7734
  7735     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  7736     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  7737     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  7738     MOVE '4'                    TO  DC-OPTION-CODE.
  7739     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7740     IF DATE-CONVERSION-ERROR
  7741         MOVE ER-0220            TO  EMI-ERROR
  7742         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7743         MOVE AL-UABON           TO  BIRTHA
  7744         MOVE -1                 TO  BIRTHL
  7745         MOVE 'X'                TO  ERROR-SWITCH
  7746         GO TO 1000-CONTINUE-EDITS.
  7747
  7748******************************************************************
  7749**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  7750**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 141
* EL131.cbl
  7751**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  7752******************************************************************
  7753     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  7754         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  7755         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  7756         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  7757         MOVE '4'                TO  DC-OPTION-CODE
  7758         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  7759         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7760                                     DC-ELAPSED-DAYS
  7761         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7762         IF DATE-CONVERSION-ERROR
  7763             MOVE ER-0220        TO  EMI-ERROR
  7764             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7765             MOVE AL-UABON       TO  BIRTHA
  7766             MOVE -1             TO  BIRTHL
  7767             MOVE 'X'            TO  ERROR-SWITCH
  7768             GO TO 1000-CONTINUE-EDITS.
  7769
  7770     MOVE AL-UANON               TO  BIRTHA.
  7771     MOVE 'X'                    TO  UPDATE-SWITCH
  7772                                     MSTR-SWITCH.
  7773     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  7774     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  7775     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  7776
  7777 1000-CONTINUE-EDITS.
  7778
  7779     IF SOCIALI GREATER THAN LOW-VALUES
  7780         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  7781         IF WS-SOC-SEC-NO NUMERIC AND
  7782           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  7783             NEXT SENTENCE
  7784         ELSE
  7785            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  7786               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  7787               WS-SSN-DASH2 = '-'
  7788                 NEXT SENTENCE
  7789            ELSE
  7790                 MOVE ER-0887        TO  EMI-ERROR
  7791                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7792                 MOVE AL-UABON       TO  SOCIALA
  7793                 MOVE -1             TO  SOCIALL
  7794                 MOVE 'X'            TO  ERROR-SWITCH
  7795            END-IF
  7796        END-IF
  7797     END-IF.
  7798
  7799     IF SOCIALI GREATER THAN LOW-VALUES
  7800         MOVE AL-UANON           TO SOCIALA
  7801         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  7802     ELSE
  7803         MOVE AL-UANOF           TO SOCIALA.
  7804
  7805     IF OCCI GREATER THAN LOW-VALUES
  7806         MOVE AL-UANON           TO OCCA
  7807         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  7808     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 142
* EL131.cbl
  7809         MOVE AL-UANOF           TO OCCA.
  7810
  7811     IF BENEL NOT GREATER THAN ZERO
  7812            GO TO 1005-CONTINUE-EDITS.
  7813
  7814     IF BENEI = SPACES
  7815        MOVE 'X'                 TO UPDATE-SWITCH MSTR-SWITCH
  7816        GO TO 1005-CONTINUE-EDITS.
  7817
  7818
  7819* EXEC CICS HANDLE CONDITION
  7820*        NOTFND (1004-BENE-NOT-FOUND)
  7821*    END-EXEC.
  7822*    MOVE '"$I                   ! % #00007595' TO DFHEIV0
  7823     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7824     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7825     MOVE X'2520233030303037353935' TO DFHEIV0(25:11)
  7826     CALL 'kxdfhei1' USING DFHEIV0
  7827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7828
  7829
  7830     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  7831     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  7832     MOVE BENEI                  TO  WS-ELBENE-ID.
  7833
  7834
  7835* EXEC CICS READ
  7836*        DATASET ('ELBENE')
  7837*        RIDFLD  (WS-ELBENE-KEY)
  7838*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  7839*    END-EXEC.
  7840     MOVE 'ELBENE' TO DFHEIV1
  7841*    MOVE '&"S        E          (   #00007603' TO DFHEIV0
  7842     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7844     MOVE X'2020233030303037363033' TO DFHEIV0(25:11)
  7845     CALL 'kxdfhei1' USING DFHEIV0,
  7846           DFHEIV1,
  7847           DFHEIV20,
  7848           DFHEIV99,
  7849           WS-ELBENE-KEY,
  7850           DFHEIV99,
  7851           DFHEIV99,
  7852           DFHEIV99
  7853     SET ADDRESS OF BENEFICIARY-MASTER TO
  7854         DFHEIV20
  7855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7856
  7857
  7858     MOVE AL-UANON               TO  BENEA.
  7859     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7860
  7861     GO TO 1005-CONTINUE-EDITS.
  7862
  7863 1004-BENE-NOT-FOUND.
  7864     MOVE ER-0565                TO  EMI-ERROR.
  7865
  7866     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 143
* EL131.cbl
  7867     MOVE 'X'                    TO ERROR-SWITCH.
  7868     MOVE AL-UABON               TO BENEA.
  7869     MOVE -1                     TO BENEL.
  7870
  7871 1005-CONTINUE-EDITS.
  7872
  7873     IF DIAGI GREATER THAN LOW-VALUES
  7874         MOVE AL-UANON           TO DIAGA
  7875         MOVE 'X'                TO UPDATE-SWITCH
  7876                                    NINETY-TRLR-SWITCH
  7877     ELSE
  7878         MOVE AL-UANOF           TO DIAGA.
  7879
  7880     IF CAUSEI GREATER THAN LOW-VALUES
  7881         MOVE AL-UANON           TO CAUSEA
  7882         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  7883     ELSE
  7884         MOVE AL-UANOF           TO CAUSEA.
  7885
  7886     IF ENDL GREATER THAN ZERO
  7887         MOVE LOW-VALUES         TO HOLD-END
  7888         IF ENDI = SPACES
  7889             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7890         ELSE
  7891             MOVE ENDI           TO DEEDIT-DATE-INPUT
  7892
  7893* EXEC CICS BIF DEEDIT
  7894*                FIELD    (DEEDIT-DATE-INPUT)
  7895*                LENGTH   (DATE-LENGTH)
  7896*            END-EXEC
  7897*    MOVE '@"L                   #   #00007643' TO DFHEIV0
  7898     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7899     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7900     MOVE X'2020233030303037363433' TO DFHEIV0(25:11)
  7901     CALL 'kxdfhei1' USING DFHEIV0,
  7902           DEEDIT-DATE-INPUT,
  7903           DATE-LENGTH
  7904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7905             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7906             MOVE '4'            TO DC-OPTION-CODE
  7907             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7908             IF NOT DATE-CONVERSION-ERROR
  7909                 MOVE DC-BIN-DATE-1      TO HOLD-END
  7910                 MOVE AL-UANON   TO ENDA
  7911                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7912                 MOVE DC-GREG-DATE-1-EDIT TO ENDO
  7913             ELSE
  7914                 MOVE ER-0224    TO EMI-ERROR
  7915                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7916                 MOVE AL-UABON   TO ENDA
  7917                 MOVE -1         TO ENDL
  7918                 MOVE 'X'        TO ERROR-SWITCH
  7919       ELSE
  7920           MOVE AL-UANOF         TO ENDA.
  7921
  7922     IF INCL GREATER THAN ZERO
  7923         MOVE LOW-VALUES         TO HOLD-INCUR
  7924         IF INCI = SPACES
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 144
* EL131.cbl
  7925             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7926         ELSE
  7927             MOVE INCI           TO DEEDIT-DATE-INPUT
  7928
  7929* EXEC CICS BIF DEEDIT
  7930*                FIELD    (DEEDIT-DATE-INPUT)
  7931*                LENGTH   (DATE-LENGTH)
  7932*            END-EXEC
  7933*    MOVE '@"L                   #   #00007670' TO DFHEIV0
  7934     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7935     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7936     MOVE X'2020233030303037363730' TO DFHEIV0(25:11)
  7937     CALL 'kxdfhei1' USING DFHEIV0,
  7938           DEEDIT-DATE-INPUT,
  7939           DATE-LENGTH
  7940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7941             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7942             MOVE '4'            TO DC-OPTION-CODE
  7943             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7944             IF NOT DATE-CONVERSION-ERROR
  7945                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  7946                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7947                 MOVE AL-UANON           TO INCA
  7948                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  7949             ELSE
  7950                 MOVE ER-0222    TO EMI-ERROR
  7951                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7952                 MOVE AL-UABON   TO INCA
  7953                 MOVE -1         TO INCL
  7954                 MOVE 'X'        TO ERROR-SWITCH
  7955       ELSE
  7956           IF PI-NO-PMTS = ZEROS
  7957               MOVE AL-UANOF     TO INCA.
  7958
  7959     IF REPL GREATER THAN ZERO
  7960         MOVE LOW-VALUES         TO HOLD-REPORTED
  7961         IF REPI = SPACES
  7962             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7963         ELSE
  7964             MOVE REPI           TO DEEDIT-DATE-INPUT
  7965
  7966* EXEC CICS BIF DEEDIT
  7967*                FIELD    (DEEDIT-DATE-INPUT)
  7968*                LENGTH   (DATE-LENGTH)
  7969*            END-EXEC
  7970*    MOVE '@"L                   #   #00007698' TO DFHEIV0
  7971     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7972     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7973     MOVE X'2020233030303037363938' TO DFHEIV0(25:11)
  7974     CALL 'kxdfhei1' USING DFHEIV0,
  7975           DEEDIT-DATE-INPUT,
  7976           DATE-LENGTH
  7977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7978             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  7979             MOVE '4'            TO DC-OPTION-CODE
  7980             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  7981             IF NOT DATE-CONVERSION-ERROR
  7982                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 145
* EL131.cbl
  7983                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  7984                 MOVE AL-UANON   TO REPA
  7985                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  7986             ELSE
  7987                 MOVE ER-0223    TO EMI-ERROR
  7988                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7989                 MOVE AL-UABON   TO REPA
  7990                 MOVE -1         TO REPL
  7991                 MOVE 'X'        TO ERROR-SWITCH
  7992       ELSE
  7993         MOVE AL-UANOF TO REPA.
  7994
  7995     IF PDTHRUI GREATER THAN LOW-VALUES
  7996        MOVE LOW-VALUES         TO HOLD-PDTHRU
  7997        IF PDTHRUI = SPACES
  7998           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  7999        ELSE
  8000           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8001
  8002* EXEC CICS BIF DEEDIT
  8003*               FIELD    (DEEDIT-DATE-INPUT)
  8004*               LENGTH   (DATE-LENGTH)
  8005*          END-EXEC
  8006*    MOVE '@"L                   #   #00007725' TO DFHEIV0
  8007     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8008     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8009     MOVE X'2020233030303037373235' TO DFHEIV0(25:11)
  8010     CALL 'kxdfhei1' USING DFHEIV0,
  8011           DEEDIT-DATE-INPUT,
  8012           DATE-LENGTH
  8013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8014           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8015           MOVE '4'            TO DC-OPTION-CODE
  8016           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8017           IF NOT DATE-CONVERSION-ERROR
  8018              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8019              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8020              MOVE AL-UANON   TO PDTHRUA
  8021              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8022              IF PI-USES-PAID-TO
  8023                 MOVE '6'            TO DC-OPTION-CODE
  8024                 MOVE -1             TO DC-ELAPSED-DAYS
  8025                 MOVE +0             TO DC-ELAPSED-MONTHS
  8026                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8027                 IF NO-CONVERSION-ERROR
  8028                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8029                 ELSE
  8030                    NEXT SENTENCE
  8031              ELSE
  8032                 NEXT SENTENCE
  8033           ELSE
  8034              MOVE ER-0475    TO EMI-ERROR
  8035              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8036              MOVE AL-UABON   TO PDTHRUA
  8037              MOVE -1         TO PDTHRUL
  8038              MOVE 'X'        TO ERROR-SWITCH
  8039     ELSE
  8040        IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 146
* EL131.cbl
  8041           MOVE AL-UANOF        TO PDTHRUA.
  8042
  8043     IF PDAMTL GREATER THAN +0
  8044         MOVE ZEROS              TO HOLD-PDAMT
  8045
  8046* EXEC CICS BIF DEEDIT
  8047*            FIELD    (PDAMTI)
  8048*            LENGTH   (9)
  8049*        END-EXEC
  8050     MOVE 9
  8051       TO DFHEIV11
  8052*    MOVE '@"L                   #   #00007760' TO DFHEIV0
  8053     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8054     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8055     MOVE X'2020233030303037373630' TO DFHEIV0(25:11)
  8056     CALL 'kxdfhei1' USING DFHEIV0,
  8057           PDAMTI,
  8058           DFHEIV11
  8059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8060         IF PDAMTI NUMERIC
  8061             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8062             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8063             MOVE AL-UNNON       TO PDAMTA
  8064         ELSE
  8065             MOVE ER-0547        TO EMI-ERROR
  8066             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8067             MOVE AL-UNBON       TO PDAMTA
  8068             MOVE -1             TO PDAMTL
  8069             MOVE 'X'            TO ERROR-SWITCH
  8070     ELSE
  8071         IF MODIFY-CAP
  8072            MOVE AL-UNNOF        TO PDAMTA.
  8073
  8074     IF NODAYSI GREATER THAN LOW-VALUES
  8075         MOVE ZEROS              TO HOLD-NODAYS
  8076
  8077* EXEC CICS BIF DEEDIT
  8078*            FIELD (NODAYSI)
  8079*            LENGTH (5)
  8080*        END-EXEC
  8081     MOVE 5
  8082       TO DFHEIV11
  8083*    MOVE '@"L                   #   #00007780' TO DFHEIV0
  8084     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8085     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8086     MOVE X'2020233030303037373830' TO DFHEIV0(25:11)
  8087     CALL 'kxdfhei1' USING DFHEIV0,
  8088           NODAYSI,
  8089           DFHEIV11
  8090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8091         IF NODAYSI NUMERIC
  8092             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8093             MOVE AL-UNNON       TO NODAYSA
  8094             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8095         ELSE
  8096             MOVE ER-0491        TO EMI-ERROR
  8097             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8098             MOVE AL-UNBON       TO NODAYSA
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 147
* EL131.cbl
  8099             MOVE -1             TO NODAYSL
  8100             MOVE 'X'            TO ERROR-SWITCH
  8101     ELSE
  8102         IF MODIFY-CAP
  8103            MOVE AL-UNNOF        TO NODAYSA.
  8104
  8105     IF NOPMTSI GREATER THAN LOW-VALUES
  8106         MOVE ZEROS              TO HOLD-NOPMTS
  8107
  8108* EXEC CICS BIF DEEDIT
  8109*            FIELD (NOPMTSI)
  8110*            LENGTH (4)
  8111*        END-EXEC
  8112     MOVE 4
  8113       TO DFHEIV11
  8114*    MOVE '@"L                   #   #00007800' TO DFHEIV0
  8115     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8116     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8117     MOVE X'2020233030303037383030' TO DFHEIV0(25:11)
  8118     CALL 'kxdfhei1' USING DFHEIV0,
  8119           NOPMTSI,
  8120           DFHEIV11
  8121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8122         IF NOPMTSI NUMERIC
  8123             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8124             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8125             MOVE AL-UNNON       TO NOPMTSA
  8126           ELSE
  8127             MOVE ER-0548        TO EMI-ERROR
  8128             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8129             MOVE AL-UNBON       TO NOPMTSA
  8130             MOVE -1             TO NOPMTSL
  8131             MOVE 'X'            TO ERROR-SWITCH
  8132       ELSE
  8133         IF MODIFY-CAP
  8134            MOVE AL-UNNOF        TO NOPMTSA.
  8135
  8136     IF FORMTYPI GREATER THAN LOW-VALUES
  8137         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8138             MOVE AL-UANON       TO FORMTYPA
  8139             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8140           ELSE
  8141             MOVE ER-7650        TO EMI-ERROR
  8142             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8143             MOVE AL-UABON       TO FORMTYPA
  8144             MOVE -1             TO FORMTYPL
  8145             MOVE 'X'            TO ERROR-SWITCH
  8146       ELSE
  8147         MOVE AL-UANOF           TO FORMTYPA.
  8148
  8149     IF PRICDL GREATER THAN ZERO
  8150         IF (PRICDI = ' ') OR
  8151            (PRICDI GREATER THAN ZERO   AND
  8152             PRICDI NOT GREATER THAN '9')
  8153             MOVE AL-UANON       TO PRICDA
  8154             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8155         ELSE
  8156             MOVE ER-0274        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 148
* EL131.cbl
  8157             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8158             MOVE AL-UABON       TO PRICDA
  8159             MOVE -1             TO PRICDL
  8160             MOVE 'X'            TO ERROR-SWITCH
  8161     ELSE
  8162         MOVE AL-UANOF TO PRICDA.
  8163
  8164     IF PI-COMPANY-ID = 'DMD'
  8165     IF PRICDL GREATER THAN ZERO
  8166       IF SYSTEM-MODIFY-CAP  OR
  8167          PI-PROCESSOR-ID = 'LGXX'
  8168             NEXT SENTENCE
  8169           ELSE
  8170            IF CL-PRIORITY-CD = '9'  OR
  8171               PRICDI         = '9'
  8172                  MOVE ER-0938        TO EMI-ERROR
  8173                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8174                  MOVE AL-UABON       TO PRICDA
  8175                  MOVE -1             TO PRICDL
  8176                  MOVE 'X'            TO ERROR-SWITCH.
  8177
  8178     IF FILETOL GREATER THAN ZERO
  8179         MOVE AL-UANON           TO FILETOA
  8180         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8181     ELSE
  8182         MOVE AL-UANOF TO FILETOA.
  8183
  8184     IF SUPVL GREATER THAN ZERO
  8185         IF SUPVI = 'Y' OR 'N' OR SPACE
  8186             MOVE AL-UANON       TO SUPVA
  8187             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8188         ELSE
  8189             MOVE ER-0230        TO EMI-ERROR
  8190             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8191             MOVE AL-UABON       TO SUPVA
  8192             MOVE -1             TO SUPVL
  8193             MOVE 'X'            TO ERROR-SWITCH
  8194     ELSE
  8195         MOVE AL-UANOF           TO SUPVA.
  8196
  8197     IF MLNAMEL GREATER THAN ZERO
  8198         IF MLNAMEI GREATER THAN SPACES
  8199            MOVE AL-UANON        TO MLNAMEA
  8200            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8201                                     MSTR-KEY-SWITCH
  8202         ELSE
  8203            MOVE ER-0236         TO EMI-ERROR
  8204            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8205            MOVE AL-UABON        TO MLNAMEA
  8206            MOVE -1              TO MLNAMEL
  8207            MOVE 'X'             TO ERROR-SWITCH
  8208     ELSE
  8209         MOVE AL-UANOF           TO MLNAMEA.
  8210
  8211     IF MFNAMEI GREATER THAN LOW-VALUES
  8212         MOVE AL-UANON           TO MFNAMEA
  8213         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8214     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 149
* EL131.cbl
  8215         MOVE AL-UANOF           TO MFNAMEA.
  8216
  8217     IF MMINITI GREATER THAN LOW-VALUES
  8218         MOVE AL-UANON           TO MMINITA
  8219         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8220     ELSE
  8221         MOVE AL-UANOF           TO MMINITA.
  8222
  8223     IF CRTLNMEI GREATER THAN LOW-VALUES
  8224         IF CRTLNMEI NOT = SPACES
  8225            MOVE AL-UANON        TO CRTLNMEA
  8226            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8227                                     CERT-KEY-SWITCH
  8228        ELSE
  8229            MOVE ER-0236         TO EMI-ERROR
  8230            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8231            MOVE AL-UABON        TO CRTLNMEA
  8232            MOVE -1              TO CRTLNMEL
  8233            MOVE 'X'             TO ERROR-SWITCH
  8234     ELSE
  8235         MOVE AL-UANOF           TO CRTLNMEA.
  8236
  8237     IF CRTFNMEI GREATER THAN LOW-VALUES
  8238         MOVE AL-UANON           TO CRTFNMEA
  8239         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8240     ELSE
  8241         MOVE AL-UANOF           TO CRTFNMEA.
  8242
  8243     IF CRTINITI GREATER THAN LOW-VALUES
  8244         MOVE AL-UANON           TO CRTINITA
  8245         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8246     ELSE
  8247         MOVE AL-UANOF           TO CRTINITA.
  8248
  8249     IF ISSAGEL GREATER THAN ZERO
  8250         IF ISSAGEI NUMERIC
  8251            MOVE AL-UANON        TO ISSAGEA
  8252            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8253         ELSE
  8254            MOVE ER-0237         TO EMI-ERROR
  8255            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8256            MOVE AL-UABON        TO ISSAGEA
  8257            MOVE -1              TO ISSAGEL
  8258            MOVE 'X'             TO ERROR-SWITCH
  8259     ELSE
  8260         MOVE AL-UANOF           TO ISSAGEA.
  8261
  8262     IF JNTFNMEI GREATER THAN LOW-VALUES
  8263         MOVE AL-UANON           TO JNTFNMEA
  8264         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8265     ELSE
  8266         MOVE AL-UANOF           TO JNTFNMEA.
  8267
  8268     IF JNTLNMEI GREATER THAN LOW-VALUES
  8269         MOVE AL-UANON           TO JNTLNMEA
  8270         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8271     ELSE
  8272         MOVE AL-UANOF           TO JNTLNMEA.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 150
* EL131.cbl
  8273
  8274     IF JNTINITI GREATER THAN LOW-VALUES
  8275         MOVE AL-UANON           TO JNTINITA
  8276         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8277     ELSE
  8278         MOVE AL-UANOF           TO JNTINITA.
  8279
  8280     IF JNTAGEL GREATER THAN ZERO
  8281         IF JNTAGEI NUMERIC
  8282            MOVE AL-UANON        TO JNTAGEA
  8283            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8284         ELSE
  8285            MOVE ER-0238         TO EMI-ERROR
  8286            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8287            MOVE AL-UABON        TO JNTAGEA
  8288            MOVE -1              TO JNTAGEL
  8289            MOVE 'X'             TO ERROR-SWITCH
  8290     ELSE
  8291         MOVE AL-UANOF           TO JNTAGEA.
  8292
  8293     IF ADDONDTI GREATER THAN LOW-VALUES
  8294         MOVE LOW-VALUES         TO HOLD-ADDON
  8295         IF ADDONDTI = SPACES
  8296             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8297         ELSE
  8298             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8299
  8300* EXEC CICS BIF DEEDIT
  8301*                FIELD    (DEEDIT-DATE-INPUT)
  8302*                LENGTH   (DATE-LENGTH)
  8303*            END-EXEC
  8304*    MOVE '@"L                   #   #00007981' TO DFHEIV0
  8305     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8306     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8307     MOVE X'2020233030303037393831' TO DFHEIV0(25:11)
  8308     CALL 'kxdfhei1' USING DFHEIV0,
  8309           DEEDIT-DATE-INPUT,
  8310           DATE-LENGTH
  8311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8312             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8313             MOVE '4'            TO DC-OPTION-CODE
  8314             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8315             IF NOT DATE-CONVERSION-ERROR
  8316                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8317                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8318                                                  CERT-SWITCH
  8319                 MOVE AL-UANON   TO ADDONDTA
  8320                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8321             ELSE
  8322                 MOVE ER-7651    TO EMI-ERROR
  8323                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8324                 MOVE AL-UABON   TO ADDONDTA
  8325                 MOVE -1         TO ADDONDTL
  8326                 MOVE 'X'        TO ERROR-SWITCH
  8327       ELSE
  8328         MOVE AL-UANOF TO ADDONDTA.
  8329
  8330     IF LCVCDI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 151
* EL131.cbl
  8331         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8332         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8333     ELSE
  8334         MOVE AL-UANOF           TO LCVCDA.
  8335
  8336     IF ACVCDI GREATER THAN LOW-VALUES
  8337         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8338         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8339     ELSE
  8340         MOVE AL-UANOF           TO ACVCDA.
  8341
  8342     IF LCVOTRMI GREATER THAN LOW-VALUES
  8343
  8344* EXEC CICS BIF DEEDIT
  8345*            FIELD (LCVOTRMI)
  8346*            LENGTH(3)
  8347*        END-EXEC
  8348     MOVE 3
  8349       TO DFHEIV11
  8350*    MOVE '@"L                   #   #00008016' TO DFHEIV0
  8351     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8352     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8353     MOVE X'2020233030303038303136' TO DFHEIV0(25:11)
  8354     CALL 'kxdfhei1' USING DFHEIV0,
  8355           LCVOTRMI,
  8356           DFHEIV11
  8357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8358         IF LCVOTRMI IS NUMERIC
  8359             MOVE LCVOTRMI       TO LCVOTRMO
  8360             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8361             MOVE AL-UANON       TO LCVOTRMA
  8362         ELSE
  8363             MOVE ER-0241        TO EMI-ERROR
  8364             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8365             MOVE AL-UNBON       TO LCVOTRMA
  8366             MOVE 'X'            TO ERROR-SWITCH
  8367             MOVE -1             TO LCVOTRML
  8368     ELSE
  8369         MOVE AL-UANOF           TO LCVOTRMA.
  8370
  8371     IF ACVOTRMI GREATER THAN LOW-VALUES
  8372
  8373* EXEC CICS BIF DEEDIT
  8374*            FIELD (ACVOTRMI)
  8375*            LENGTH(3)
  8376*        END-EXEC
  8377     MOVE 3
  8378       TO DFHEIV11
  8379*    MOVE '@"L                   #   #00008034' TO DFHEIV0
  8380     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8381     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8382     MOVE X'2020233030303038303334' TO DFHEIV0(25:11)
  8383     CALL 'kxdfhei1' USING DFHEIV0,
  8384           ACVOTRMI,
  8385           DFHEIV11
  8386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8387         IF ACVOTRMI IS NUMERIC
  8388             MOVE ACVOTRMI       TO ACVOTRMO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 152
* EL131.cbl
  8389             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8390             MOVE AL-UANON       TO ACVOTRMA
  8391         ELSE
  8392             MOVE ER-0241        TO EMI-ERROR
  8393             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8394             MOVE AL-UNBON       TO ACVOTRMA
  8395             MOVE 'X'            TO ERROR-SWITCH
  8396             MOVE -1             TO ACVOTRML
  8397     ELSE
  8398         MOVE AL-UANOF           TO ACVOTRMA.
  8399
  8400     IF LCVRATEL GREATER THAN +0
  8401
  8402* EXEC CICS BIF DEEDIT
  8403*            FIELD (LCVRATEI)
  8404*            LENGTH(6)
  8405*        END-EXEC
  8406     MOVE 6
  8407       TO DFHEIV11
  8408*    MOVE '@"L                   #   #00008052' TO DFHEIV0
  8409     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8410     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8411     MOVE X'2020233030303038303532' TO DFHEIV0(25:11)
  8412     CALL 'kxdfhei1' USING DFHEIV0,
  8413           LCVRATEI,
  8414           DFHEIV11
  8415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8416         IF LCVRATEI IS NUMERIC
  8417             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8418             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8419             MOVE AL-UNNON       TO LCVRATEA
  8420         ELSE
  8421             MOVE ER-2280        TO EMI-ERROR
  8422             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8423             MOVE AL-UNBON       TO LCVRATEA
  8424             MOVE 'X'            TO ERROR-SWITCH
  8425             MOVE -1             TO LCVRATEL
  8426     ELSE
  8427         MOVE AL-UNNOF           TO LCVRATEA.
  8428
  8429     IF ACVRATEL GREATER THAN +0
  8430
  8431* EXEC CICS BIF DEEDIT
  8432*            FIELD (ACVRATEI)
  8433*            LENGTH(6)
  8434*        END-EXEC
  8435     MOVE 6
  8436       TO DFHEIV11
  8437*    MOVE '@"L                   #   #00008070' TO DFHEIV0
  8438     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8439     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8440     MOVE X'2020233030303038303730' TO DFHEIV0(25:11)
  8441     CALL 'kxdfhei1' USING DFHEIV0,
  8442           ACVRATEI,
  8443           DFHEIV11
  8444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8445         IF ACVRATEI IS NUMERIC
  8446             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 153
* EL131.cbl
  8447             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8448             MOVE AL-UNNON       TO ACVRATEA
  8449         ELSE
  8450             MOVE ER-2280        TO EMI-ERROR
  8451             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8452             MOVE AL-UNBON       TO ACVRATEA
  8453             MOVE 'X'            TO ERROR-SWITCH
  8454             MOVE -1             TO ACVRATEL
  8455     ELSE
  8456         MOVE AL-UNNOF           TO ACVRATEA.
  8457
  8458     IF LCVBENEL GREATER THAN ZERO
  8459
  8460* EXEC CICS BIF DEEDIT
  8461*            FIELD (LCVBENEI)
  8462*            LENGTH (11)
  8463*        END-EXEC
  8464     MOVE 11
  8465       TO DFHEIV11
  8466*    MOVE '@"L                   #   #00008088' TO DFHEIV0
  8467     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8468     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8469     MOVE X'2020233030303038303838' TO DFHEIV0(25:11)
  8470     CALL 'kxdfhei1' USING DFHEIV0,
  8471           LCVBENEI,
  8472           DFHEIV11
  8473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8474         IF LCVBENEI IS NUMERIC
  8475            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8476            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8477            MOVE AL-UNNON        TO LCVBENEA
  8478         ELSE
  8479            MOVE ER-0243         TO EMI-ERROR
  8480            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8481            MOVE AL-UNBON        TO LCVBENEA
  8482            MOVE -1              TO LCVBENEL
  8483            MOVE 'X'             TO ERROR-SWITCH
  8484     ELSE
  8485         MOVE AL-UANOF           TO LCVBENEA.
  8486
  8487     IF ACVBENEL GREATER THAN ZERO
  8488
  8489* EXEC CICS BIF DEEDIT
  8490*            FIELD (ACVBENEI)
  8491*            LENGTH (11)
  8492*        END-EXEC
  8493     MOVE 11
  8494       TO DFHEIV11
  8495*    MOVE '@"L                   #   #00008106' TO DFHEIV0
  8496     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8497     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8498     MOVE X'2020233030303038313036' TO DFHEIV0(25:11)
  8499     CALL 'kxdfhei1' USING DFHEIV0,
  8500           ACVBENEI,
  8501           DFHEIV11
  8502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8503         IF ACVBENEI IS NUMERIC
  8504            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 154
* EL131.cbl
  8505            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8506            MOVE AL-UNNON        TO ACVBENEA
  8507         ELSE
  8508            MOVE ER-0243         TO EMI-ERROR
  8509            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8510            MOVE AL-UNBON        TO ACVBENEA
  8511            MOVE -1              TO ACVBENEL
  8512            MOVE 'X'             TO ERROR-SWITCH
  8513     ELSE
  8514         MOVE AL-UANOF           TO ACVBENEA.
  8515
  8516     IF LCVFORMI GREATER THAN LOW-VALUES
  8517        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8518        MOVE AL-UANON            TO LCVFORMA
  8519     ELSE
  8520        MOVE AL-UANOF            TO LCVFORMA.
  8521
  8522     IF ACVFORMI GREATER THAN LOW-VALUES
  8523        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8524        MOVE AL-UANON            TO ACVFORMA
  8525     ELSE
  8526        MOVE AL-UANOF            TO ACVFORMA.
  8527
  8528     IF LCVCNDTL GREATER THAN ZERO
  8529         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8530         IF LCVCNDTI = SPACES
  8531             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8532         ELSE
  8533             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  8534             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8535             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8536             MOVE '4'            TO DC-OPTION-CODE
  8537             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8538             IF NOT DATE-CONVERSION-ERROR
  8539                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  8540                 MOVE AL-UANON   TO LCVCNDTA
  8541                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8542                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  8543             ELSE
  8544                 MOVE ER-0246    TO EMI-ERROR
  8545                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8546                 MOVE AL-UABON   TO LCVCNDTA
  8547                 MOVE -1         TO LCVCNDTL
  8548                 MOVE 'X'        TO ERROR-SWITCH
  8549     ELSE
  8550         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8551         MOVE AL-UANOF           TO LCVCNDTA.
  8552
  8553     IF ACVCNDTL GREATER THAN ZERO
  8554         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8555         IF ACVCNDTI = SPACES
  8556             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8557         ELSE
  8558             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  8559             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8560             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8561             MOVE '4'            TO DC-OPTION-CODE
  8562             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 155
* EL131.cbl
  8563             IF NOT DATE-CONVERSION-ERROR
  8564                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  8565                 MOVE AL-UANON   TO ACVCNDTA
  8566                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8567                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  8568             ELSE
  8569                 MOVE ER-0246    TO EMI-ERROR
  8570                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8571                 MOVE AL-UABON   TO ACVCNDTA
  8572                 MOVE -1         TO ACVCNDTL
  8573                 MOVE 'X'        TO ERROR-SWITCH
  8574     ELSE
  8575         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8576         MOVE AL-UANOF           TO ACVCNDTA.
  8577
  8578     IF APRL GREATER THAN +0
  8579
  8580* EXEC CICS BIF DEEDIT
  8581*            FIELD    (APRI)
  8582*            LENGTH   (8)
  8583*        END-EXEC
  8584     MOVE 8
  8585       TO DFHEIV11
  8586*    MOVE '@"L                   #   #00008186' TO DFHEIV0
  8587     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8588     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8589     MOVE X'2020233030303038313836' TO DFHEIV0(25:11)
  8590     CALL 'kxdfhei1' USING DFHEIV0,
  8591           APRI,
  8592           DFHEIV11
  8593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8594         IF APRI NUMERIC
  8595            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8596            MOVE APRI            TO HOLD-APR APRO
  8597            MOVE AL-UANON        TO APRA
  8598          ELSE
  8599            MOVE ER-0259         TO EMI-ERROR
  8600            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8601            MOVE AL-UABON        TO APRA
  8602            MOVE -1              TO APRL
  8603            MOVE 'X'             TO ERROR-SWITCH
  8604     ELSE
  8605         MOVE AL-UANOF           TO APRA.
  8606
  8607     IF PMTFREQL GREATER THAN ZERO
  8608
  8609* EXEC CICS BIF DEEDIT
  8610*            FIELD    (PMTFREQI)
  8611*            LENGTH   (2)
  8612*        END-EXEC
  8613     MOVE 2
  8614       TO DFHEIV11
  8615*    MOVE '@"L                   #   #00008204' TO DFHEIV0
  8616     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8617     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8618     MOVE X'2020233030303038323034' TO DFHEIV0(25:11)
  8619     CALL 'kxdfhei1' USING DFHEIV0,
  8620           PMTFREQI,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 156
* EL131.cbl
  8621           DFHEIV11
  8622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8623         IF PMTFREQI NUMERIC
  8624            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  8625            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8626            MOVE AL-UANON        TO PMTFREQA
  8627          ELSE
  8628            MOVE ER-0427         TO EMI-ERROR
  8629            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8630            MOVE AL-UABON        TO PMTFREQA
  8631            MOVE -1              TO PMTFREQL
  8632            MOVE 'X'             TO ERROR-SWITCH
  8633     ELSE
  8634         MOVE AL-UANOF           TO PMTFREQA.
  8635
  8636     IF INDGRPL GREATER THAN ZERO
  8637         IF INDGRPI = 'I' OR 'G' OR SPACE
  8638             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8639             MOVE AL-UANON       TO INDGRPA
  8640          ELSE
  8641             MOVE ER-0260        TO EMI-ERROR
  8642             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8643             MOVE AL-UABON       TO INDGRPA
  8644             MOVE -1             TO INDGRPL
  8645             MOVE 'X'            TO ERROR-SWITCH
  8646     ELSE
  8647         MOVE AL-UANOF           TO INDGRPA.
  8648
  8649     IF PREMTYPL GREATER THAN ZERO
  8650         IF PREMTYPI = '1' OR '2' OR '3'
  8651            MOVE PREMTYPI        TO PI-PREM-TYPE
  8652            MOVE AL-UNNON        TO PREMTYPA
  8653            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8654          ELSE
  8655            MOVE ER-0227         TO EMI-ERROR
  8656            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8657            MOVE AL-UNBON        TO PREMTYPA
  8658            MOVE -1              TO PREMTYPL
  8659            MOVE 'X'             TO ERROR-SWITCH
  8660     ELSE
  8661         MOVE AL-UANOF           TO PREMTYPA.
  8662
  8663     IF LOANBALL GREATER THAN ZERO
  8664
  8665* EXEC CICS BIF DEEDIT
  8666*             FIELD    (LOANBALI)
  8667*             LENGTH   (9)
  8668*        END-EXEC
  8669     MOVE 9
  8670       TO DFHEIV11
  8671*    MOVE '@"L                   #   #00008249' TO DFHEIV0
  8672     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8673     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8674     MOVE X'2020233030303038323439' TO DFHEIV0(25:11)
  8675     CALL 'kxdfhei1' USING DFHEIV0,
  8676           LOANBALI,
  8677           DFHEIV11
  8678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 157
* EL131.cbl
  8679         IF LOANBALI NUMERIC
  8680             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  8681             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  8682             MOVE AL-UNNON TO LOANBALA
  8683         ELSE
  8684             MOVE ER-0639        TO EMI-ERROR
  8685             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8686             MOVE AL-UNBON       TO LOANBALA
  8687             MOVE -1             TO LOANBALL
  8688             MOVE 'X'            TO ERROR-SWITCH
  8689     ELSE
  8690         MOVE AL-UNNOF           TO LOANBALA.
  8691
  8692     IF LOANNOL GREATER THAN ZERO
  8693        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8694        MOVE AL-UANON            TO LOANNOA
  8695     ELSE
  8696        MOVE AL-UANOF            TO LOANNOA.
  8697
  8698     IF REINCDI GREATER THAN LOW-VALUES
  8699        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8700        MOVE AL-UANON            TO REINCDA
  8701     ELSE
  8702        MOVE AL-UANOF            TO REINCDA.
  8703
  8704     IF CERTI GREATER THAN LOW-VALUES
  8705         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  8706     ELSE
  8707         MOVE AL-UANOF           TO CERTA.
  8708
  8709     IF CERTEFFI GREATER THAN LOW-VALUES
  8710         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  8711     ELSE
  8712         MOVE AL-UANOF           TO CERTEFFA.
  8713
  8714     IF CERTACTI GREATER THAN LOW-VALUES
  8715         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  8716     ELSE
  8717         MOVE AL-UANOF           TO CERTACTA.
  8718
  8719     IF CERTSTI GREATER THAN LOW-VALUES
  8720         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  8721     ELSE
  8722         MOVE AL-UANOF           TO CERTSTA.
  8723
  8724     IF CERTCARI GREATER THAN LOW-VALUES
  8725         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  8726     ELSE
  8727         MOVE AL-UANOF           TO CERTCARA.
  8728
  8729     IF DLYACTV-RECORD-NEEDED
  8730         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  8731                 1150-EXIT
  8732     END-IF.
  8733
  8734     IF CERTEFFI GREATER LOW-VALUES OR
  8735        CERTACTI GREATER LOW-VALUES OR
  8736        CERTSTI  GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 158
* EL131.cbl
  8737        CERTCARI GREATER LOW-VALUES OR
  8738        CERTGRPI GREATER LOW-VALUES
  8739        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  8740
  8741*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  8742*      IF PI-PREM-TYPE NOT = '1'  AND
  8743*         PI-NO-PMTS = ZEROS
  8744*          IF LOANBALL GREATER +0 OR
  8745*             ACVBENEL GREATER +0
  8746*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  8747
  8748     IF CERTL = ZEROS AND
  8749        SUFXL = ZEROS
  8750          GO TO 1010-EXIT.
  8751
  8752     IF CERTL GREATER THAN ZEROS
  8753         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  8754             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  8755             MOVE 'Y'            TO SKIP-ATTRIBUTE
  8756             MOVE 'X'            TO ERROR-SWITCH
  8757             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  8758
  8759     IF SUFXL GREATER THAN ZEROS
  8760         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  8761             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  8762             MOVE 'Y'            TO SKIP-ATTRIBUTE
  8763             MOVE 'X'            TO ERROR-SWITCH
  8764             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  8765
  8766 1010-EXIT.
  8767     EXIT.
  8768
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 159
* EL131.cbl
  8770 1120-EDIT-PROC.
  8771     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  8772     MOVE '2'                    TO CNTL-REC-TYPE.
  8773     MOVE PROCI                  TO CNTL-PROC-ID.
  8774     MOVE ZERO                   TO CNTL-SEQ-NO.
  8775
  8776
  8777* EXEC CICS HANDLE CONDITION
  8778*         NOTFND    (1120-CNTL-NOTFND)
  8779*    END-EXEC.
  8780*    MOVE '"$I                   ! & #00008350' TO DFHEIV0
  8781     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8783     MOVE X'2620233030303038333530' TO DFHEIV0(25:11)
  8784     CALL 'kxdfhei1' USING DFHEIV0
  8785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8786
  8787
  8788
  8789* EXEC CICS READ
  8790*         SET      (ADDRESS OF CONTROL-FILE)
  8791*         DATASET  (CNTL-FILE-ID)
  8792*         RIDFLD   (CNTL-KEY)
  8793*    END-EXEC.
  8794*    MOVE '&"S        E          (   #00008354' TO DFHEIV0
  8795     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8796     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8797     MOVE X'2020233030303038333534' TO DFHEIV0(25:11)
  8798     CALL 'kxdfhei1' USING DFHEIV0,
  8799           CNTL-FILE-ID,
  8800           DFHEIV20,
  8801           DFHEIV99,
  8802           CNTL-KEY,
  8803           DFHEIV99,
  8804           DFHEIV99,
  8805           DFHEIV99
  8806     SET ADDRESS OF CONTROL-FILE TO
  8807         DFHEIV20
  8808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8809
  8810
  8811     MOVE AL-UANON               TO PROCA.
  8812     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  8813     GO TO 1120-EXIT.
  8814
  8815 1120-CNTL-NOTFND.
  8816     MOVE ER-0273                TO EMI-ERROR.
  8817     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8818     MOVE AL-UABON               TO PROCA.
  8819     MOVE -1                     TO PROCL.
  8820     MOVE 'X'                    TO ERROR-SWITCH.
  8821
  8822 1120-EXIT.
  8823     EXIT.
  8824
  8825*************************************************************
  8826*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  8827*************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 160
* EL131.cbl
  8828
  8829 1150-OUTPUT-ACTIVITY-RECORD.
  8830
  8831
  8832* EXEC CICS GETMAIN
  8833*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  8834*        LENGTH (25)
  8835*        INITIMG (WS-BLANK)
  8836*    END-EXEC.
  8837     MOVE 25
  8838       TO DFHEIV11
  8839*    MOVE ',"IL                  $   #00008380' TO DFHEIV0
  8840     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8841     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8842     MOVE X'2020233030303038333830' TO DFHEIV0(25:11)
  8843     CALL 'kxdfhei1' USING DFHEIV0,
  8844           DFHEIV20,
  8845           DFHEIV11,
  8846           WS-BLANK
  8847     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  8848         DFHEIV20
  8849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8850
  8851
  8852     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  8853     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  8854     MOVE PI-CARRIER             TO DA-CARRIER.
  8855     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  8856     MOVE PI-CERT-NO             TO DA-CERT-NO.
  8857     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  8858     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  8859
  8860
  8861* EXEC CICS HANDLE CONDITION
  8862*        NOTOPEN (1150-NOTOPEN-ERROR)
  8863*        DUPREC (1150-EXIT)
  8864*    END-EXEC.
  8865*    MOVE '"$J%                  ! '' #00008394' TO DFHEIV0
  8866     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  8867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8868     MOVE X'2720233030303038333934' TO DFHEIV0(25:11)
  8869     CALL 'kxdfhei1' USING DFHEIV0
  8870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8871
  8872     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  8873     MOVE 'DLYACTV'              TO JP-FILE-ID.
  8874     MOVE 'A'                    TO JP-RECORD-TYPE.
  8875     MOVE +48                    TO JOURNAL-LENGTH.
  8876
  8877
  8878* EXEC CICS WRITE
  8879*        DATASET ('DLYACTV')
  8880*        RIDFLD (DA-KEY)
  8881*        FROM (DAILY-ACTIVITY-RECORD)
  8882*        LENGTH (25)
  8883*    END-EXEC.
  8884     MOVE 'DLYACTV' TO DFHEIV1
  8885     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 161
* EL131.cbl
  8886       TO DFHEIV11
  8887*    MOVE '&$ L                  ''   #00008403' TO DFHEIV0
  8888     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8889     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8890     MOVE X'2020233030303038343033' TO DFHEIV0(25:11)
  8891     CALL 'kxdfhei1' USING DFHEIV0,
  8892           DFHEIV1,
  8893           DAILY-ACTIVITY-RECORD,
  8894           DFHEIV11,
  8895           DA-KEY,
  8896           DFHEIV99,
  8897           DFHEIV99
  8898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8899
  8900
  8901     GO TO 1150-EXIT.
  8902
  8903 1150-NOTOPEN-ERROR.
  8904
  8905     MOVE '2955'                 TO EMI-ERROR.
  8906     MOVE -1                     TO MAINTL.
  8907     MOVE AL-UANON               TO MAINTA.
  8908     MOVE 'X'                    TO ERROR-SWITCH.
  8909     PERFORM 9900-ERROR-FORMAT THRU
  8910             9900-EXIT.
  8911
  8912 1150-EXIT.
  8913     EXIT.
  8914
  8915*************************************************************
  8916*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  8917*************************************************************
  8918
  8919 1240-EDIT-LIFE-CODE.
  8920
  8921     IF INVALID-BENEFIT-CODE
  8922         GO TO 1240-SET-ERROR.
  8923
  8924     MOVE SPACES                 TO BENEFIT-KEY.
  8925     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  8926     MOVE '4'                    TO BEN-REC-TYPE.
  8927     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  8928     MOVE ZERO                   TO BEN-SEQ-NO.
  8929
  8930
  8931* EXEC CICS READ GTEQ
  8932*         DATASET  (CNTL-FILE-ID)
  8933*         RIDFLD   (BENEFIT-KEY)
  8934*         SET      (ADDRESS OF CONTROL-FILE)
  8935*    END-EXEC.
  8936*    MOVE '&"S        G          (   #00008439' TO DFHEIV0
  8937     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8938     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8939     MOVE X'2020233030303038343339' TO DFHEIV0(25:11)
  8940     CALL 'kxdfhei1' USING DFHEIV0,
  8941           CNTL-FILE-ID,
  8942           DFHEIV20,
  8943           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 162
* EL131.cbl
  8944           BENEFIT-KEY,
  8945           DFHEIV99,
  8946           DFHEIV99,
  8947           DFHEIV99
  8948     SET ADDRESS OF CONTROL-FILE TO
  8949         DFHEIV20
  8950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8951
  8952
  8953     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  8954        CF-RECORD-TYPE NOT = '4'
  8955         GO TO 1240-SET-ERROR.
  8956
  8957     MOVE ZERO                   TO COUNT-2.
  8958     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  8959
  8960     IF SCREEN-ERROR
  8961         GO TO 1240-SET-ERROR.
  8962
  8963 1240-SET-CODE-SWITCHES.
  8964     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  8965     MOVE AL-UANON               TO LCVCDA.
  8966     GO TO 1240-EXIT.
  8967
  8968 1240-SET-ERROR.
  8969     MOVE ER-0240                TO EMI-ERROR.
  8970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8971     MOVE 'X'                    TO ERROR-SWITCH.
  8972     MOVE AL-UABON               TO LCVCDA.
  8973     MOVE -1                     TO LCVCDL.
  8974
  8975 1240-EXIT.
  8976     EXIT.
  8977
  8978 1310-EDIT-AH-CODE.
  8979     IF INVALID-BENEFIT-CODE
  8980         GO TO 1310-SET-ERROR.
  8981
  8982     MOVE SPACES                 TO BENEFIT-KEY.
  8983     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  8984     MOVE '5'                    TO BEN-REC-TYPE.
  8985     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  8986     MOVE ZERO                   TO BEN-SEQ-NO.
  8987
  8988
  8989* EXEC CICS READ GTEQ
  8990*         DATASET  (CNTL-FILE-ID)
  8991*         RIDFLD   (BENEFIT-KEY)
  8992*         SET      (ADDRESS OF CONTROL-FILE)
  8993*    END-EXEC.
  8994*    MOVE '&"S        G          (   #00008480' TO DFHEIV0
  8995     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8996     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8997     MOVE X'2020233030303038343830' TO DFHEIV0(25:11)
  8998     CALL 'kxdfhei1' USING DFHEIV0,
  8999           CNTL-FILE-ID,
  9000           DFHEIV20,
  9001           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 163
* EL131.cbl
  9002           BENEFIT-KEY,
  9003           DFHEIV99,
  9004           DFHEIV99,
  9005           DFHEIV99
  9006     SET ADDRESS OF CONTROL-FILE TO
  9007         DFHEIV20
  9008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9009
  9010
  9011     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9012        CF-RECORD-TYPE NOT = '5'
  9013         GO TO 1310-SET-ERROR.
  9014
  9015     MOVE ZERO                   TO COUNT-2.
  9016     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9017     IF SCREEN-ERROR
  9018         GO TO 1310-SET-ERROR.
  9019
  9020 1310-SET-CODE-SWITCHES.
  9021     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9022     MOVE AL-UANON               TO ACVCDA.
  9023     GO TO 1310-EXIT.
  9024
  9025 1310-SET-ERROR.
  9026     MOVE ER-0250                TO EMI-ERROR.
  9027     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9028     MOVE AL-UABON               TO ACVCDA.
  9029     MOVE 'X'                    TO ERROR-SWITCH.
  9030     MOVE -1                     TO ACVCDL.
  9031
  9032 1310-EXIT.
  9033     EXIT.
  9034
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 164
* EL131.cbl
  9036 1460-EDIT-CERT-NO.
  9037     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9038     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9039
  9040     IF WS-SAVE-CERT-NO = SPACES
  9041         MOVE ER-0203            TO EMI-ERROR
  9042         GO TO 1460-CERT-NO-ERROR.
  9043
  9044     IF WS-CERT-NO-PRIME = SPACES AND
  9045        WS-CERT-NO-SUFX GREATER THAN SPACE
  9046            MOVE ER-0210         TO EMI-ERROR
  9047            GO TO 1460-CERT-NO-ERROR.
  9048
  9049     MOVE 'X'                    TO UPDATE-SWITCH.
  9050     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9051     MOVE AL-UANON               TO CERTA.
  9052
  9053     IF SUFXL IS GREATER THAN 0
  9054         MOVE AL-UANON           TO SUFXA.
  9055
  9056     GO TO 1460-EXIT.
  9057
  9058 1460-CERT-NO-ERROR.
  9059     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9060     MOVE AL-UABON               TO SUFXA.
  9061     MOVE AL-UABON               TO CERTA.
  9062     MOVE -1                     TO CERTL.
  9063     MOVE 'X'                    TO ERROR-SWITCH.
  9064
  9065 1460-EXIT.
  9066     EXIT.
  9067
  9068 1470-EDIT-EFF.
  9069     IF CERTEFFI = SPACES
  9070         GO TO 1470-DATE-ERROR.
  9071
  9072     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9073     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9074     IF DEEDIT-DATE = ZERO
  9075         GO TO 1470-DATE-ERROR.
  9076
  9077     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9078     MOVE '4'                    TO DC-OPTION-CODE.
  9079     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9080     IF NOT DATE-CONVERSION-ERROR
  9081         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9082         MOVE AL-UANON           TO CERTEFFA
  9083         MOVE 'X'                TO UPDATE-SWITCH
  9084         MOVE 'Y'                TO CERT-KEY-SWITCH
  9085         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9086         GO TO 1470-EXIT.
  9087
  9088 1470-DATE-ERROR.
  9089     MOVE ER-0215                TO EMI-ERROR.
  9090     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9091     MOVE AL-UABON               TO CERTEFFA.
  9092     MOVE -1                     TO CERTEFFL.
  9093     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 165
* EL131.cbl
  9094
  9095 1470-EXIT.
  9096     EXIT.
  9097
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 166
* EL131.cbl
  9099 1480-EDIT-ACCT.
  9100     IF CERTACTI = SPACES
  9101         MOVE ER-0232            TO EMI-ERROR
  9102         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9103         MOVE AL-UABON           TO CERTACTA
  9104         MOVE -1                 TO CERTACTL
  9105         MOVE 'X'                TO ERROR-SWITCH
  9106     ELSE
  9107         MOVE 'X'                TO UPDATE-SWITCH
  9108         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9109
  9110 1480-EXIT.
  9111     EXIT.
  9112
  9113 1490-EDIT-STATE.
  9114     IF CERTSTI = SPACES
  9115         MOVE ER-0233            TO EMI-ERROR
  9116         GO TO 1490-STATE-ERROR.
  9117
  9118     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9119     MOVE '3'                    TO CNTL-REC-TYPE.
  9120     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9121     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9122     MOVE ZERO                   TO CNTL-SEQ-NO.
  9123
  9124
  9125* EXEC CICS HANDLE CONDITION
  9126*         NOTFND (1490-STATE-NOTFND)
  9127*    END-EXEC.
  9128*    MOVE '"$I                   ! ( #00008599' TO DFHEIV0
  9129     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9130     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9131     MOVE X'2820233030303038353939' TO DFHEIV0(25:11)
  9132     CALL 'kxdfhei1' USING DFHEIV0
  9133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9134
  9135
  9136
  9137* EXEC CICS READ
  9138*         SET        (ADDRESS OF CONTROL-FILE)
  9139*         DATASET    ('ELCNTL')
  9140*         RIDFLD     (CNTL-KEY)
  9141*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9142*         GENERIC
  9143*    END-EXEC.
  9144     MOVE 'ELCNTL' TO DFHEIV1
  9145*    MOVE '&"S  KG    E          (   #00008603' TO DFHEIV0
  9146     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9148     MOVE X'2020233030303038363033' TO DFHEIV0(25:11)
  9149     CALL 'kxdfhei1' USING DFHEIV0,
  9150           DFHEIV1,
  9151           DFHEIV20,
  9152           DFHEIV99,
  9153           CNTL-KEY,
  9154           CNTL-GENERIC-LENGTH,
  9155           DFHEIV99,
  9156           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 167
* EL131.cbl
  9157     SET ADDRESS OF CONTROL-FILE TO
  9158         DFHEIV20
  9159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9160
  9161
  9162     MOVE AL-UANON               TO CERTSTA.
  9163     MOVE 'X'                    TO UPDATE-SWITCH.
  9164     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9165     GO TO 1490-EXIT.
  9166
  9167 1490-STATE-NOTFND.
  9168     MOVE ER-0149                TO EMI-ERROR.
  9169
  9170 1490-STATE-ERROR.
  9171     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9172     MOVE AL-UABON               TO CERTSTA.
  9173     MOVE -1                     TO CERTSTL.
  9174     MOVE 'X'                    TO ERROR-SWITCH.
  9175
  9176 1490-EXIT.
  9177     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 168
* EL131.cbl
  9179 1500-EDIT-CARR.
  9180     IF CERTCARI = SPACES
  9181         GO TO 1500-CARR-NOTFND.
  9182
  9183     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9184     MOVE '6'                    TO CNTL-REC-TYPE.
  9185     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9186     MOVE CERTCARI               TO CNTL-CARRIER.
  9187     MOVE ZERO                   TO CNTL-SEQ-NO.
  9188
  9189
  9190* EXEC CICS HANDLE CONDITION
  9191*         NOTFND   (1500-CARR-NOTFND)
  9192*    END-EXEC.
  9193*    MOVE '"$I                   ! ) #00008638' TO DFHEIV0
  9194     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9196     MOVE X'2920233030303038363338' TO DFHEIV0(25:11)
  9197     CALL 'kxdfhei1' USING DFHEIV0
  9198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9199
  9200
  9201
  9202* EXEC CICS READ
  9203*         SET        (ADDRESS OF CONTROL-FILE)
  9204*         DATASET    ('ELCNTL')
  9205*         RIDFLD     (CNTL-KEY)
  9206*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9207*         GENERIC
  9208*    END-EXEC.
  9209     MOVE 'ELCNTL' TO DFHEIV1
  9210*    MOVE '&"S  KG    E          (   #00008642' TO DFHEIV0
  9211     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9212     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9213     MOVE X'2020233030303038363432' TO DFHEIV0(25:11)
  9214     CALL 'kxdfhei1' USING DFHEIV0,
  9215           DFHEIV1,
  9216           DFHEIV20,
  9217           DFHEIV99,
  9218           CNTL-KEY,
  9219           CNTL-GENERIC-LENGTH,
  9220           DFHEIV99,
  9221           DFHEIV99
  9222     SET ADDRESS OF CONTROL-FILE TO
  9223         DFHEIV20
  9224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9225
  9226
  9227     MOVE AL-UANON               TO CERTCARA.
  9228     MOVE 'X'                    TO UPDATE-SWITCH.
  9229     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9230     GO TO 1500-EXIT.
  9231
  9232 1500-CARR-NOTFND.
  9233     MOVE ER-0360                TO EMI-ERROR.
  9234     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9235     MOVE AL-UABON               TO CERTCARA.
  9236     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 169
* EL131.cbl
  9237     MOVE 'X'                    TO ERROR-SWITCH.
  9238
  9239 1500-EXIT.
  9240     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 170
* EL131.cbl
  9242 1510-DEEDIT-DATE.
  9243
  9244* EXEC CICS BIF DEEDIT
  9245*         FIELD    (DEEDIT-DATE-INPUT)
  9246*         LENGTH   (DATE-LENGTH)
  9247*    END-EXEC.
  9248*    MOVE '@"L                   #   #00008666' TO DFHEIV0
  9249     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9250     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9251     MOVE X'2020233030303038363636' TO DFHEIV0(25:11)
  9252     CALL 'kxdfhei1' USING DFHEIV0,
  9253           DEEDIT-DATE-INPUT,
  9254           DATE-LENGTH
  9255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9256
  9257
  9258 1510-EXIT.
  9259     EXIT.
  9260
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 171
* EL131.cbl
  9262 1620-VERIFY-ACCT.
  9263
  9264     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9265     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9266     MOVE PI-GROUPING            TO ACCT-GROUP.
  9267     MOVE PI-STATE               TO ACCT-STATE.
  9268     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9269
  9270     IF CERTEFFI GREATER THAN LOW-VALUES
  9271         MOVE HOLD-EFF           TO ACCT-DATE
  9272     ELSE
  9273         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9274
  9275     IF CERTACTI GREATER THAN LOW-VALUES
  9276         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9277     IF CERTSTI GREATER THAN LOW-VALUES
  9278         MOVE CERTSTI            TO  ACCT-STATE.
  9279     IF CERTCARI GREATER THAN LOW-VALUES
  9280         MOVE CERTCARI           TO  ACCT-CARRIER.
  9281     IF CERTGRPI GREATER THAN LOW-VALUES
  9282         MOVE CERTGRPI           TO ACCT-GROUP.
  9283
  9284     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9285
  9286
  9287* EXEC CICS HANDLE CONDITION
  9288*         NOTFND  (1620-ACCT-NOTFND)
  9289*    END-EXEC.
  9290*    MOVE '"$I                   ! * #00008699' TO DFHEIV0
  9291     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9293     MOVE X'2A20233030303038363939' TO DFHEIV0(25:11)
  9294     CALL 'kxdfhei1' USING DFHEIV0
  9295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9296
  9297
  9298
  9299* EXEC CICS STARTBR
  9300*         DATASET   (ACCT-FILE-ID)
  9301*         RIDFLD    (ACCT-KEY)
  9302*    END-EXEC.
  9303     MOVE 0
  9304       TO DFHEIV11
  9305*    MOVE '&,         G          &   #00008703' TO DFHEIV0
  9306     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9307     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9308     MOVE X'2020233030303038373033' TO DFHEIV0(25:11)
  9309     CALL 'kxdfhei1' USING DFHEIV0,
  9310           ACCT-FILE-ID,
  9311           ACCT-KEY,
  9312           DFHEIV99,
  9313           DFHEIV11,
  9314           DFHEIV99
  9315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9316
  9317
  9318 1620-ACCT-LOOP.
  9319
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 172
* EL131.cbl
  9320
  9321* EXEC CICS READNEXT
  9322*         DATASET  (ACCT-FILE-ID)
  9323*         RIDFLD   (ACCT-KEY)
  9324*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9325*    END-EXEC.
  9326     MOVE 0
  9327       TO DFHEIV11
  9328*    MOVE '&.S                   )   #00008710' TO DFHEIV0
  9329     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9330     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9331     MOVE X'2020233030303038373130' TO DFHEIV0(25:11)
  9332     CALL 'kxdfhei1' USING DFHEIV0,
  9333           ACCT-FILE-ID,
  9334           DFHEIV20,
  9335           DFHEIV99,
  9336           ACCT-KEY,
  9337           DFHEIV99,
  9338           DFHEIV11,
  9339           DFHEIV99,
  9340           DFHEIV99
  9341     SET ADDRESS OF ACCOUNT-MASTER TO
  9342         DFHEIV20
  9343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9344
  9345
  9346     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9347         GO TO 1620-ACCT-NOTFND.
  9348
  9349     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9350        HOLD-EFF     LESS AM-EXPIRATION-DT
  9351         NEXT SENTENCE
  9352     ELSE
  9353         GO TO 1620-ACCT-LOOP.
  9354
  9355     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9356         GO TO 1620-ACCT-END-BROWSE.
  9357
  9358     IF LOANBALL GREATER THAN +0
  9359         IF AM-MAX-TOT-BEN NUMERIC  AND
  9360            AM-MAX-TOT-BEN GREATER THAN ZERO
  9361             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9362                 MOVE AL-UNBON     TO LOANBALA
  9363                 MOVE -1           TO LOANBALL
  9364                 MOVE 'X'          TO ERROR-SWITCH
  9365                 MOVE ER-7641      TO EMI-ERROR
  9366                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9367
  9368     IF ACVBENEL GREATER THAN +0
  9369         IF AM-MAX-MON-BEN NUMERIC  AND
  9370            AM-MAX-MON-BEN GREATER THAN ZERO
  9371             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9372                 MOVE AL-UNBON     TO ACVBENEA
  9373                 MOVE -1           TO ACVBENEL
  9374                 MOVE 'X'          TO ERROR-SWITCH
  9375                 MOVE ER-7642      TO EMI-ERROR
  9376                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9377
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 173
* EL131.cbl
  9378 1620-ACCT-END-BROWSE.
  9379
  9380
  9381* EXEC CICS ENDBR
  9382*         DATASET (ACCT-FILE-ID)
  9383*    END-EXEC.
  9384     MOVE 0
  9385       TO DFHEIV11
  9386*    MOVE '&2                    $   #00008750' TO DFHEIV0
  9387     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9388     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9389     MOVE X'2020233030303038373530' TO DFHEIV0(25:11)
  9390     CALL 'kxdfhei1' USING DFHEIV0,
  9391           ACCT-FILE-ID,
  9392           DFHEIV11,
  9393           DFHEIV99
  9394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9395
  9396
  9397     GO TO 1620-EXIT.
  9398
  9399 1620-ACCT-NOTFND.
  9400
  9401     MOVE -1                     TO MAINTL.
  9402     MOVE 'X'                    TO ERROR-SWITCH.
  9403     MOVE ER-0426                TO EMI-ERROR.
  9404     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9405
  9406 1620-EXIT.
  9407     EXIT.
  9408
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 174
* EL131.cbl
  9410 2000-UPDATE-CLAIM.
  9411
  9412     MOVE SPACES                 TO ERROR-SWITCH.
  9413     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9414     MOVE PI-CARRIER             TO CARRIER-CODE.
  9415     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9416     MOVE PI-CERT-NO             TO CERT-NO.
  9417
  9418     IF DELETE-CLAIM
  9419         GO TO 3000-DELETE-CLAIM.
  9420
  9421     IF  NOT MODIFY-CAP
  9422         MOVE ER-0070            TO EMI-ERROR
  9423         MOVE 'X'                TO ERROR-SWITCH
  9424         MOVE -1                 TO MAINTL
  9425         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9426         GO TO 2000-EXIT.
  9427
  9428     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9429     MOVE ZERO                   TO TRLR-SEQ-NO.
  9430
  9431
  9432* EXEC CICS READ UPDATE
  9433*         SET       (ADDRESS OF CLAIM-MASTER)
  9434*         DATASET   (CLMS-FILE-ID)
  9435*         RIDFLD    (MSTR-KEY)
  9436*    END-EXEC.
  9437*    MOVE '&"S        EU         (   #00008788' TO DFHEIV0
  9438     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9439     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9440     MOVE X'2020233030303038373838' TO DFHEIV0(25:11)
  9441     CALL 'kxdfhei1' USING DFHEIV0,
  9442           CLMS-FILE-ID,
  9443           DFHEIV20,
  9444           DFHEIV99,
  9445           MSTR-KEY,
  9446           DFHEIV99,
  9447           DFHEIV99,
  9448           DFHEIV99
  9449     SET ADDRESS OF CLAIM-MASTER TO
  9450         DFHEIV20
  9451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9452
  9453
  9454     if (cl-priority-cd = '8')
  9455        and (pi-processor-id not = 'PEMA' and 'JMS '
  9456             AND 'AMWA')
  9457        MOVE ER-8003             TO EMI-ERROR
  9458        PERFORM 9900-ERROR-FORMAT
  9459                                 THRU 9900-EXIT
  9460        MOVE -1                  TO MAINTL
  9461        GO TO 8110-SEND-DATA
  9462     end-if
  9463
  9464     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
  9465         MOVE ER-0068            TO EMI-ERROR
  9466         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9467         GO TO 2000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 175
* EL131.cbl
  9468
  9469     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
  9470         MOVE ER-0068            TO EMI-ERROR
  9471         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9472         GO TO 2000-EXIT.
  9473
  9474     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  9475         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
  9476
  9477     IF CL-PURGED-DT NOT = LOW-VALUES
  9478         MOVE ER-7691            TO EMI-ERROR
  9479         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9480         GO TO 2000-EXIT.
  9481
  9482     IF CERT-KEY-CHANGED
  9483         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
  9484
  9485     IF SCREEN-ERROR
  9486         MOVE ER-0068            TO EMI-ERROR
  9487         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9488         GO TO 2000-EXIT.
  9489
  9490     IF NINETY-TRLR-UPDATED
  9491         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
  9492
  9493     IF MSTR-KEY-CHANGED
  9494         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
  9495        ELSE
  9496         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
  9497
  9498     IF TRLR-UPDATE-REQUIRED
  9499         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
  9500
  9501 2000-CHECK-CERT.
  9502     IF NOT CERT-UPDATES
  9503         GO TO 2000-EXIT.
  9504
  9505     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9506     MOVE PI-CARRIER             TO CERT-CARRIER.
  9507     MOVE PI-GROUPING            TO CERT-GROUP.
  9508     MOVE PI-STATE               TO CERT-STATE.
  9509     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9510     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9511     MOVE PI-CERT-NO             TO CERT-CERT.
  9512
  9513     IF CERT-ALT-KEY-CHANGED
  9514         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
  9515     ELSE
  9516         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
  9517
  9518 2000-EXIT.
  9519     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 176
* EL131.cbl
  9521 2010-RELEASE-REC.
  9522
  9523* EXEC CICS UNLOCK
  9524*         DATASET  (CLMS-FILE-ID)
  9525*    END-EXEC
  9526*    MOVE '&*                    #   #00008862' TO DFHEIV0
  9527     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9528     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9529     MOVE X'2020233030303038383632' TO DFHEIV0(25:11)
  9530     CALL 'kxdfhei1' USING DFHEIV0,
  9531           CLMS-FILE-ID,
  9532           DFHEIV99
  9533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9534
  9535     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9536     MOVE 'X'                    TO ERROR-SWITCH.
  9537
  9538 2010-EXIT.
  9539     EXIT.
  9540
  9541 2020-NORMAL-UPDATE.
  9542     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9543
  9544     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9545
  9546     IF WS-OPEN-CLOSE-SW = 'Y'
  9547       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9548       IF PI-REC-FOUND-SW = 'Y'
  9549         IF CL-ACTIVITY-CODE = 09
  9550           NEXT SENTENCE
  9551         ELSE
  9552           IF WS-RESET-SW = 'Y'
  9553             IF CL-CLAIM-STATUS = 'C'
  9554               MOVE 07               TO  CL-ACTIVITY-CODE
  9555               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9556               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
  9557             ELSE
  9558               MOVE 08               TO  CL-ACTIVITY-CODE
  9559               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9560               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
  9561
  9562     IF PI-COMPANY-ID = 'CID' or 'AHL'
  9563         MOVE 'Y'                TO CL-YESNOSW
  9564     END-IF.
  9565
  9566
  9567* EXEC CICS HANDLE CONDITION
  9568*         DUPKEY   (2020-EXIT)
  9569*    END-EXEC.
  9570*    MOVE '"$$                   ! + #00008897' TO DFHEIV0
  9571     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9573     MOVE X'2B20233030303038383937' TO DFHEIV0(25:11)
  9574     CALL 'kxdfhei1' USING DFHEIV0
  9575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9576
  9577
  9578
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 177
* EL131.cbl
  9579* EXEC CICS REWRITE
  9580*         DATASET   (CLMS-FILE-ID)
  9581*         FROM      (CLAIM-MASTER)
  9582*    END-EXEC.
  9583     MOVE LENGTH OF
  9584      CLAIM-MASTER
  9585       TO DFHEIV11
  9586*    MOVE '&& L                  %   #00008901' TO DFHEIV0
  9587     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9588     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9589     MOVE X'2020233030303038393031' TO DFHEIV0(25:11)
  9590     CALL 'kxdfhei1' USING DFHEIV0,
  9591           CLMS-FILE-ID,
  9592           CLAIM-MASTER,
  9593           DFHEIV11,
  9594           DFHEIV99
  9595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9596
  9597
  9598 2020-EXIT.
  9599     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 178
* EL131.cbl
  9601 2030-KEY-UPDATE.
  9602     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
  9603
  9604
  9605* EXEC CICS DELETE
  9606*        DATASET  (CLMS-FILE-ID)
  9607*    END-EXEC.
  9608*    MOVE '&(                    &   #00008912' TO DFHEIV0
  9609     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9610     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9611     MOVE X'2020233030303038393132' TO DFHEIV0(25:11)
  9612     CALL 'kxdfhei1' USING DFHEIV0,
  9613           CLMS-FILE-ID,
  9614           DFHEIV99,
  9615           DFHEIV99,
  9616           DFHEIV99,
  9617           DFHEIV99
  9618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9619
  9620
  9621
  9622* EXEC CICS GETMAIN
  9623*         SET      (ADDRESS OF CLAIM-MASTER)
  9624*         LENGTH   (MSTR-LENGTH)
  9625*         INITIMG  (GETMAIN-SPACE)
  9626*    END-EXEC.
  9627*    MOVE ',"IL                  $   #00008916' TO DFHEIV0
  9628     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9629     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9630     MOVE X'2020233030303038393136' TO DFHEIV0(25:11)
  9631     CALL 'kxdfhei1' USING DFHEIV0,
  9632           DFHEIV20,
  9633           MSTR-LENGTH,
  9634           GETMAIN-SPACE
  9635     SET ADDRESS OF CLAIM-MASTER TO
  9636         DFHEIV20
  9637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9638
  9639
  9640     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
  9641
  9642     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9643
  9644     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9645
  9646     IF WS-OPEN-CLOSE-SW = 'Y'
  9647       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9648         IF PI-REC-FOUND-SW = 'Y'
  9649           IF CL-ACTIVITY-CODE = 09
  9650             NEXT SENTENCE
  9651           ELSE
  9652             IF WS-RESET-SW = 'Y'
  9653               IF CL-CLAIM-STATUS = 'C'
  9654                 MOVE 07             TO  CL-ACTIVITY-CODE
  9655                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9656                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
  9657               ELSE
  9658                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 179
* EL131.cbl
  9659                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9660                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
  9661
  9662
  9663* EXEC CICS HANDLE CONDITION
  9664*         DUPKEY    (2030-EXIT)
  9665*    END-EXEC.
  9666*    MOVE '"$$                   ! , #00008944' TO DFHEIV0
  9667     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9668     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9669     MOVE X'2C20233030303038393434' TO DFHEIV0(25:11)
  9670     CALL 'kxdfhei1' USING DFHEIV0
  9671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9672
  9673
  9674** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
  9675*    MOVE CL-CERT-NO             TO CL-CCN-A5.
  9676
  9677     IF PI-COMPANY-ID = 'CID' OR 'AHL'
  9678         MOVE 'Y'                TO CL-YESNOSW
  9679     END-IF.
  9680
  9681
  9682* EXEC CICS WRITE
  9683*         DATASET   (CLMS-FILE-ID)
  9684*         RIDFLD    (MSTR-KEY)
  9685*         FROM      (CLAIM-MASTER)
  9686*    END-EXEC.
  9687     MOVE LENGTH OF
  9688      CLAIM-MASTER
  9689       TO DFHEIV11
  9690*    MOVE '&$ L                  ''   #00008955' TO DFHEIV0
  9691     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9692     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9693     MOVE X'2020233030303038393535' TO DFHEIV0(25:11)
  9694     CALL 'kxdfhei1' USING DFHEIV0,
  9695           CLMS-FILE-ID,
  9696           CLAIM-MASTER,
  9697           DFHEIV11,
  9698           MSTR-KEY,
  9699           DFHEIV99,
  9700           DFHEIV99
  9701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9702
  9703
  9704 2030-EXIT.
  9705     EXIT.
  9706
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 180
* EL131.cbl
  9708 2040-NORMAL-UPDATE.
  9709
  9710* EXEC CICS READ UPDATE
  9711*         DATASET  (CERT-FILE-ID)
  9712*         RIDFLD   (CERT-KEY)
  9713*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9714*    END-EXEC.
  9715*    MOVE '&"S        EU         (   #00008966' TO DFHEIV0
  9716     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9717     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9718     MOVE X'2020233030303038393636' TO DFHEIV0(25:11)
  9719     CALL 'kxdfhei1' USING DFHEIV0,
  9720           CERT-FILE-ID,
  9721           DFHEIV20,
  9722           DFHEIV99,
  9723           CERT-KEY,
  9724           DFHEIV99,
  9725           DFHEIV99,
  9726           DFHEIV99
  9727     SET ADDRESS OF CERTIFICATE-MASTER TO
  9728         DFHEIV20
  9729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9730
  9731
  9732     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
  9733
  9734
  9735* EXEC CICS HANDLE CONDITION
  9736*         DUPKEY   (2040-EXIT)
  9737*    END-EXEC.
  9738*    MOVE '"$$                   ! - #00008974' TO DFHEIV0
  9739     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9740     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9741     MOVE X'2D20233030303038393734' TO DFHEIV0(25:11)
  9742     CALL 'kxdfhei1' USING DFHEIV0
  9743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9744
  9745
  9746
  9747* EXEC CICS REWRITE
  9748*         DATASET  (CERT-FILE-ID)
  9749*         FROM     (CERTIFICATE-MASTER)
  9750*    END-EXEC.
  9751     MOVE LENGTH OF
  9752      CERTIFICATE-MASTER
  9753       TO DFHEIV11
  9754*    MOVE '&& L                  %   #00008978' TO DFHEIV0
  9755     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9756     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9757     MOVE X'2020233030303038393738' TO DFHEIV0(25:11)
  9758     CALL 'kxdfhei1' USING DFHEIV0,
  9759           CERT-FILE-ID,
  9760           CERTIFICATE-MASTER,
  9761           DFHEIV11,
  9762           DFHEIV99
  9763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9764
  9765
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 181
* EL131.cbl
  9766 2040-EXIT.
  9767     EXIT.
  9768
  9769 2050-KEY-UPDATE.
  9770
  9771* EXEC CICS READ UPDATE
  9772*         DATASET  (CERT-FILE-ID)
  9773*         RIDFLD   (CERT-KEY)
  9774*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9775*    END-EXEC.
  9776*    MOVE '&"S        EU         (   #00008987' TO DFHEIV0
  9777     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9778     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9779     MOVE X'2020233030303038393837' TO DFHEIV0(25:11)
  9780     CALL 'kxdfhei1' USING DFHEIV0,
  9781           CERT-FILE-ID,
  9782           DFHEIV20,
  9783           DFHEIV99,
  9784           CERT-KEY,
  9785           DFHEIV99,
  9786           DFHEIV99,
  9787           DFHEIV99
  9788     SET ADDRESS OF CERTIFICATE-MASTER TO
  9789         DFHEIV20
  9790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9791
  9792
  9793     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
  9794
  9795
  9796* EXEC CICS DELETE
  9797*         DATASET   (CERT-FILE-ID)
  9798*    END-EXEC.
  9799*    MOVE '&(                    &   #00008995' TO DFHEIV0
  9800     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9801     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9802     MOVE X'2020233030303038393935' TO DFHEIV0(25:11)
  9803     CALL 'kxdfhei1' USING DFHEIV0,
  9804           CERT-FILE-ID,
  9805           DFHEIV99,
  9806           DFHEIV99,
  9807           DFHEIV99,
  9808           DFHEIV99
  9809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9810
  9811
  9812
  9813* EXEC CICS GETMAIN
  9814*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9815*         LENGTH    (CERT-LENGTH)
  9816*         INITIMG   (GETMAIN-SPACE)
  9817*    END-EXEC.
  9818*    MOVE ',"IL                  $   #00008999' TO DFHEIV0
  9819     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9820     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9821     MOVE X'2020233030303038393939' TO DFHEIV0(25:11)
  9822     CALL 'kxdfhei1' USING DFHEIV0,
  9823           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 182
* EL131.cbl
  9824           CERT-LENGTH,
  9825           GETMAIN-SPACE
  9826     SET ADDRESS OF CERTIFICATE-MASTER TO
  9827         DFHEIV20
  9828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9829
  9830
  9831     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
  9832
  9833     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
  9834
  9835
  9836* EXEC CICS HANDLE CONDITION
  9837*         DUPKEY (2050-EXIT)
  9838*    END-EXEC.
  9839*    MOVE '"$$                   ! . #00009009' TO DFHEIV0
  9840     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9842     MOVE X'2E20233030303039303039' TO DFHEIV0(25:11)
  9843     CALL 'kxdfhei1' USING DFHEIV0
  9844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9845
  9846
  9847
  9848* EXEC CICS WRITE
  9849*         DATASET  (CERT-FILE-ID)
  9850*         RIDFLD   (CERT-KEY)
  9851*         FROM     (CERTIFICATE-MASTER)
  9852*    END-EXEC.
  9853     MOVE LENGTH OF
  9854      CERTIFICATE-MASTER
  9855       TO DFHEIV11
  9856*    MOVE '&$ L                  ''   #00009013' TO DFHEIV0
  9857     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9858     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9859     MOVE X'2020233030303039303133' TO DFHEIV0(25:11)
  9860     CALL 'kxdfhei1' USING DFHEIV0,
  9861           CERT-FILE-ID,
  9862           CERTIFICATE-MASTER,
  9863           DFHEIV11,
  9864           CERT-KEY,
  9865           DFHEIV99,
  9866           DFHEIV99
  9867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9868
  9869
  9870 2050-EXIT.
  9871     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 183
* EL131.cbl
  9873 2060-CHANGE-CERT.
  9874     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9875     MOVE PI-CARRIER             TO CERT-CARRIER.
  9876     MOVE PI-GROUPING            TO CERT-GROUP.
  9877     MOVE PI-STATE               TO CERT-STATE.
  9878     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9879     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9880     MOVE PI-CERT-NO             TO CERT-CERT.
  9881     IF CERTEFFI GREATER THAN LOW-VALUES
  9882         MOVE HOLD-EFF           TO CERT-DATE.
  9883     IF CERTACTI GREATER THAN LOW-VALUES
  9884         MOVE CERTACTI           TO CERT-ACCOUNT.
  9885     IF CERTSTI GREATER THAN LOW-VALUES
  9886         MOVE CERTSTI            TO CERT-STATE.
  9887     IF CERTCARI GREATER THAN LOW-VALUES
  9888         MOVE CERTCARI           TO CERT-CARRIER.
  9889     IF CERTGRPI GREATER THAN LOW-VALUES
  9890         MOVE CERTGRPI           TO CERT-GROUP.
  9891     IF CERTI GREATER THAN LOW-VALUES
  9892         MOVE CERTI              TO CERT-CERT-PRIME.
  9893     IF SUFXI GREATER THAN LOW-VALUES
  9894         MOVE SUFXI              TO CERT-CERT-SUFX.
  9895
  9896
  9897* EXEC CICS HANDLE CONDITION
  9898*         NOTFND   (2060-CERT-NOTFND)
  9899*    END-EXEC.
  9900*    MOVE '"$I                   ! / #00009045' TO DFHEIV0
  9901     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9903     MOVE X'2F20233030303039303435' TO DFHEIV0(25:11)
  9904     CALL 'kxdfhei1' USING DFHEIV0
  9905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9906
  9907
  9908
  9909* EXEC CICS READ UPDATE
  9910*         DATASET  (CERT-FILE-ID)
  9911*         RIDFLD   (CERT-KEY)
  9912*         SET      (ADDRESS OF CERTIFICATE-MASTER)
  9913*    END-EXEC.
  9914*    MOVE '&"S        EU         (   #00009049' TO DFHEIV0
  9915     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9916     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9917     MOVE X'2020233030303039303439' TO DFHEIV0(25:11)
  9918     CALL 'kxdfhei1' USING DFHEIV0,
  9919           CERT-FILE-ID,
  9920           DFHEIV20,
  9921           DFHEIV99,
  9922           CERT-KEY,
  9923           DFHEIV99,
  9924           DFHEIV99,
  9925           DFHEIV99
  9926     SET ADDRESS OF CERTIFICATE-MASTER TO
  9927         DFHEIV20
  9928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9929
  9930
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 184
* EL131.cbl
  9931     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
  9932
  9933     IF CM-CLAIM-INTERFACE-SW = SPACES
  9934        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
  9935
  9936
  9937* EXEC CICS HANDLE CONDITION
  9938*         DUPKEY   (2060-DUPKEY)
  9939*    END-EXEC.
  9940*    MOVE '"$$                   ! 0 #00009060' TO DFHEIV0
  9941     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9942     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9943     MOVE X'3020233030303039303630' TO DFHEIV0(25:11)
  9944     CALL 'kxdfhei1' USING DFHEIV0
  9945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9946
  9947
  9948
  9949* EXEC CICS REWRITE
  9950*         DATASET  (CERT-FILE-ID)
  9951*         FROM     (CERTIFICATE-MASTER)
  9952*    END-EXEC.
  9953     MOVE LENGTH OF
  9954      CERTIFICATE-MASTER
  9955       TO DFHEIV11
  9956*    MOVE '&& L                  %   #00009064' TO DFHEIV0
  9957     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9958     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9959     MOVE X'2020233030303039303634' TO DFHEIV0(25:11)
  9960     CALL 'kxdfhei1' USING DFHEIV0,
  9961           CERT-FILE-ID,
  9962           CERTIFICATE-MASTER,
  9963           DFHEIV11,
  9964           DFHEIV99
  9965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9966
  9967
  9968 2060-DUPKEY.
  9969
  9970     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
  9971
  9972 2060-CHANGE-TRLR-ACTQ.
  9973     IF SCREEN-ERROR
  9974         GO TO 2060-EXIT.
  9975
  9976     IF CERTI    GREATER LOW-VALUES OR
  9977        SUFXI    GREATER LOW-VALUES OR
  9978        CERTCARI GREATER LOW-VALUES
  9979         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
  9980         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
  9981
  9982     MOVE SPACES                 TO CERT-KEY-SWITCH
  9983                                    CERT-SWITCH
  9984                                    TRLR-SWITCH
  9985                                    NINETY-TRLR-SWITCH.
  9986     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
  9987     GO TO 2060-EXIT.
  9988
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 185
* EL131.cbl
  9989 2060-CERT-NOTFND.
  9990     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
  9991
  9992     IF WS-REC-FOUND-SW = 'N'
  9993         MOVE ER-0206            TO  EMI-ERROR
  9994         MOVE -1                 TO  MAINTL
  9995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9996
  9997* EXEC CICS UNLOCK
  9998*            DATASET   (CLMS-FILE-ID)
  9999*        END-EXEC
 10000*    MOVE '&*                    #   #00009097' TO DFHEIV0
 10001     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10002     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10003     MOVE X'2020233030303039303937' TO DFHEIV0(25:11)
 10004     CALL 'kxdfhei1' USING DFHEIV0,
 10005           CLMS-FILE-ID,
 10006           DFHEIV99
 10007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10008         GO TO 8110-SEND-DATA.
 10009
 10010     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10011
 10012     GO TO 2060-CHANGE-TRLR-ACTQ.
 10013
 10014 2060-EXIT.
 10015     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 186
* EL131.cbl
 10017 2070-CHECK-OLD.
 10018
 10019
 10020* EXEC CICS HANDLE CONDITION
 10021*        NOTFND   (2070-NOT-FOUND)
 10022*    END-EXEC.
 10023*    MOVE '"$I                   ! 1 #00009111' TO DFHEIV0
 10024     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10025     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10026     MOVE X'3120233030303039313131' TO DFHEIV0(25:11)
 10027     CALL 'kxdfhei1' USING DFHEIV0
 10028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10029
 10030
 10031     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10032     MOVE PI-CARRIER             TO CERT-CARRIER.
 10033     MOVE PI-GROUPING            TO CERT-GROUP.
 10034     MOVE PI-STATE               TO CERT-STATE.
 10035     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10036     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10037     MOVE PI-CERT-NO             TO CERT-CERT.
 10038
 10039
 10040* EXEC CICS READ UPDATE
 10041*         DATASET  (CERT-FILE-ID)
 10042*         RIDFLD   (CERT-KEY)
 10043*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10044*    END-EXEC.
 10045*    MOVE '&"S        EU         (   #00009123' TO DFHEIV0
 10046     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10047     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10048     MOVE X'2020233030303039313233' TO DFHEIV0(25:11)
 10049     CALL 'kxdfhei1' USING DFHEIV0,
 10050           CERT-FILE-ID,
 10051           DFHEIV20,
 10052           DFHEIV99,
 10053           CERT-KEY,
 10054           DFHEIV99,
 10055           DFHEIV99,
 10056           DFHEIV99
 10057     SET ADDRESS OF CERTIFICATE-MASTER TO
 10058         DFHEIV20
 10059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10060
 10061
 10062     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10063     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10064     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10065
 10066     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10067         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10068
 10069     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10070       AND
 10071        CERT-WAS-CREATED-FOR-CLAIM
 10072         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10073
 10074* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 187
* EL131.cbl
 10075*             DATASET   (CERT-FILE-ID)
 10076*        END-EXEC
 10077*    MOVE '&(                    &   #00009140' TO DFHEIV0
 10078     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10079     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10080     MOVE X'2020233030303039313430' TO DFHEIV0(25:11)
 10081     CALL 'kxdfhei1' USING DFHEIV0,
 10082           CERT-FILE-ID,
 10083           DFHEIV99,
 10084           DFHEIV99,
 10085           DFHEIV99,
 10086           DFHEIV99
 10087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10088         GO TO 2070-EXIT.
 10089
 10090     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10091         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10092
 10093
 10094* EXEC CICS HANDLE CONDITION
 10095*         DUPKEY   (2070-EXIT)
 10096*    END-EXEC.
 10097*    MOVE '"$$                   ! 2 #00009148' TO DFHEIV0
 10098     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10100     MOVE X'3220233030303039313438' TO DFHEIV0(25:11)
 10101     CALL 'kxdfhei1' USING DFHEIV0
 10102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10103
 10104
 10105
 10106* EXEC CICS REWRITE
 10107*         DATASET  (CERT-FILE-ID)
 10108*         FROM     (CERTIFICATE-MASTER)
 10109*    END-EXEC.
 10110     MOVE LENGTH OF
 10111      CERTIFICATE-MASTER
 10112       TO DFHEIV11
 10113*    MOVE '&& L                  %   #00009152' TO DFHEIV0
 10114     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10115     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10116     MOVE X'2020233030303039313532' TO DFHEIV0(25:11)
 10117     CALL 'kxdfhei1' USING DFHEIV0,
 10118           CERT-FILE-ID,
 10119           CERTIFICATE-MASTER,
 10120           DFHEIV11,
 10121           DFHEIV99
 10122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10123
 10124
 10125     GO TO 2070-EXIT.
 10126
 10127 2070-NOT-FOUND.
 10128     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10129
 10130 2070-EXIT.
 10131     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 188
* EL131.cbl
 10133 2080-CREATE-CERT.
 10134
 10135* EXEC CICS GETMAIN
 10136*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10137*         LENGTH    (CERT-LENGTH)
 10138*         INITIMG   (GETMAIN-SPACE)
 10139*    END-EXEC.
 10140*    MOVE ',"IL                  $   #00009166' TO DFHEIV0
 10141     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10142     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10143     MOVE X'2020233030303039313636' TO DFHEIV0(25:11)
 10144     CALL 'kxdfhei1' USING DFHEIV0,
 10145           DFHEIV20,
 10146           CERT-LENGTH,
 10147           GETMAIN-SPACE
 10148     SET ADDRESS OF CERTIFICATE-MASTER TO
 10149         DFHEIV20
 10150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10151
 10152
 10153     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10154
 10155     IF CERTEFFI GREATER THAN LOW-VALUES
 10156         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10157                                    DC-BIN-DATE-1
 10158         MOVE '6'                TO DC-OPTION-CODE
 10159         MOVE +1                 TO DC-ELAPSED-MONTHS
 10160         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10161         IF NO-CONVERSION-ERROR
 10162             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10163
 10164     IF CERTACTI GREATER THAN LOW-VALUES
 10165         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10166     IF CERTSTI GREATER THAN LOW-VALUES
 10167         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10168     IF CERTCARI GREATER THAN LOW-VALUES
 10169         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10170     IF CERTGRPI GREATER THAN LOW-VALUES
 10171         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10172     IF CERTI GREATER THAN LOW-VALUES
 10173         MOVE CERTI              TO CERT-CERT-PRIME
 10174                                    CM-CERT-PRIME
 10175         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10176
 10177     IF SUFXI GREATER THAN LOW-VALUES
 10178         MOVE SUFXI              TO CERT-CERT-SUFX
 10179                                    CM-CERT-SFX
 10180         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10181
 10182     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10183
 10184     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10185
 10186     MOVE SPACES                 TO CM-ENTRY-BATCH
 10187                                    CM-LF-EXIT-BATCH
 10188                                    CM-AH-EXIT-BATCH
 10189                                    CM-CREDIT-INTERFACE-SW-1
 10190                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 189
* EL131.cbl
 10191
 10192     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10193                               '9' OR 'D' OR 'V'
 10194         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10195
 10196     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10197                               '9' OR 'D' OR 'V'
 10198         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10199
 10200     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10201                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10202     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10203
 10204
 10205* EXEC CICS HANDLE CONDITION
 10206*         DUPKEY (2080-EXIT)
 10207*    END-EXEC.
 10208*    MOVE '"$$                   ! 3 #00009223' TO DFHEIV0
 10209     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10210     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10211     MOVE X'3320233030303039323233' TO DFHEIV0(25:11)
 10212     CALL 'kxdfhei1' USING DFHEIV0
 10213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10214
 10215
 10216
 10217* EXEC CICS WRITE
 10218*         DATASET  (CERT-FILE-ID)
 10219*         RIDFLD   (CERT-KEY)
 10220*         FROM     (CERTIFICATE-MASTER)
 10221*    END-EXEC.
 10222     MOVE LENGTH OF
 10223      CERTIFICATE-MASTER
 10224       TO DFHEIV11
 10225*    MOVE '&$ L                  ''   #00009227' TO DFHEIV0
 10226     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10227     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10228     MOVE X'2020233030303039323237' TO DFHEIV0(25:11)
 10229     CALL 'kxdfhei1' USING DFHEIV0,
 10230           CERT-FILE-ID,
 10231           CERTIFICATE-MASTER,
 10232           DFHEIV11,
 10233           CERT-KEY,
 10234           DFHEIV99,
 10235           DFHEIV99
 10236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10237
 10238
 10239 2080-EXIT.
 10240     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 190
* EL131.cbl
 10242 2100-MOVE-MSTR.
 10243     IF TYPEI GREATER THAN LOW-VALUES
 10244         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10245
 10246     IF STATUSI = LOW-VALUES
 10247         GO TO 2100-NO-STATUS-CHANGE.
 10248
 10249     IF STATUSI = 'OPEN' OR 'O'
 10250         IF CL-CLAIM-STATUS = 'O'
 10251             MOVE SPACES         TO TRLR-SWITCH
 10252                 GO TO 2100-NO-STATUS-CHANGE.
 10253
 10254     IF STATUSI = 'CLOSED' OR 'C'
 10255         IF CL-CLAIM-STATUS = 'C'
 10256             MOVE SPACES         TO TRLR-SWITCH
 10257                 GO TO 2100-NO-STATUS-CHANGE.
 10258
 10259     IF PI-COMPANY-ID = 'DMD'
 10260        IF STATUSI = 'OPEN' OR 'O'
 10261           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10262              MOVE ZERO       TO STATUSL
 10263              MOVE LOW-VALUES TO STATUSI
 10264              GO TO 2100-NO-STATUS-CHANGE.
 10265
 10266     IF PI-COMPANY-ID = 'DMD'
 10267         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10268
 10269     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10270
 10271 2100-NO-STATUS-CHANGE.
 10272
 10273     IF CCNOI GREATER THAN LOW-VALUES
 10274         MOVE CCNOI              TO CL-CCN.
 10275
 10276     IF PROCI GREATER THAN LOW-VALUES
 10277         MOVE PROCI              TO CL-PROCESSOR-ID.
 10278
 10279     IF SEXI GREATER THAN LOW-VALUES
 10280         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10281
 10282     IF BIRTHI GREATER THAN LOW-VALUES
 10283         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10284
 10285     IF SOCIALI GREATER THAN LOW-VALUES
 10286       AND
 10287        SOCIALI = SPACES
 10288         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10289         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10290         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10291     ELSE
 10292         IF SOCIALI GREATER THAN LOW-VALUES
 10293             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10294
 10295     IF OCCI GREATER THAN LOW-VALUES
 10296         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10297
 10298     IF BENEL GREATER THAN ZERO
 10299         MOVE BENEI              TO CL-BENEFICIARY.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 191
* EL131.cbl
 10300
 10301     IF DIAGI GREATER THAN LOW-VALUES
 10302         MOVE DIAGI              TO WS-DIAGNOSIS.
 10303
 10304     IF PREMTYPI GREATER THAN LOW-VALUES
 10305         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10306
 10307     IF CAUSEI GREATER THAN LOW-VALUES
 10308         MOVE CAUSEI             TO CL-CAUSE-CD.
 10309
 10310     IF ENDI GREATER THAN LOW-VALUES
 10311         MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10312
 10313     IF PDTHRUI GREATER THAN LOW-VALUES
 10314        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10315
 10316     IF PDAMTL GREATER THAN +0
 10317        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10318
 10319     IF NODAYSI GREATER THAN LOW-VALUES
 10320        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10321
 10322     IF NOPMTSI GREATER THAN LOW-VALUES
 10323        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10324
 10325     IF FORMTYPI GREATER THAN LOW-VALUES
 10326        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10327
 10328     IF INCI GREATER THAN LOW-VALUES
 10329        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10330
 10331     IF REPI GREATER THAN LOW-VALUES
 10332        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10333
 10334     IF ADDONDTI GREATER THAN LOW-VALUES
 10335        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10336
 10337     IF PRICDI GREATER THAN LOW-VALUES
 10338         MOVE PRICDI             TO CL-PRIORITY-CD.
 10339
 10340     IF FILETOI GREATER THAN LOW-VALUES
 10341         MOVE FILETOI            TO CL-FILE-LOCATION.
 10342
 10343     IF SUPVI GREATER THAN LOW-VALUES
 10344         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10345
 10346     IF MLNAMEI GREATER THAN LOW-VALUES
 10347         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10348
 10349     IF MFNAMEI GREATER THAN LOW-VALUES
 10350         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10351
 10352     IF MMINITI GREATER THAN LOW-VALUES
 10353         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10354
 10355     IF CERTEFFI GREATER THAN LOW-VALUES
 10356         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10357
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 192
* EL131.cbl
 10358     IF CERTACTI GREATER THAN LOW-VALUES
 10359         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10360
 10361     IF CERTSTI GREATER THAN LOW-VALUES
 10362         MOVE CERTSTI            TO CL-CERT-STATE.
 10363
 10364     IF CERTCARI GREATER THAN LOW-VALUES
 10365         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10366                                    CL-CARRIER.
 10367
 10368     IF CERTGRPI GREATER THAN LOW-VALUES
 10369         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10370
 10371     IF CERTI GREATER THAN LOW-VALUES
 10372         MOVE CERTI              TO CERT-NO-PRIME.
 10373
 10374     IF SUFXI GREATER THAN LOW-VALUES
 10375         MOVE SUFXI              TO CERT-NO-SUFX.
 10376
 10377     MOVE CERT-NO                TO CL-CERT-NO
 10378                                    CL-CERT-NO-A4.
 10379
 10380     IF PI-COMPANY-ID = 'FLA'
 10381          NEXT SENTENCE
 10382     ELSE
 10383         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10384         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10385         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10386         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10387
 10388     IF TRLR-UPDATE-REQUIRED
 10389        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10390        MOVE ZEROS              TO TRLR-SEQ-NO
 10391
 10392* EXEC CICS READ
 10393*            DATASET   (TRLR-FILE-ID)
 10394*            RIDFLD    (TRLR-KEY)
 10395*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10396*       END-EXEC
 10397*    MOVE '&"S        E          (   #00009385' TO DFHEIV0
 10398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10400     MOVE X'2020233030303039333835' TO DFHEIV0(25:11)
 10401     CALL 'kxdfhei1' USING DFHEIV0,
 10402           TRLR-FILE-ID,
 10403           DFHEIV20,
 10404           DFHEIV99,
 10405           TRLR-KEY,
 10406           DFHEIV99,
 10407           DFHEIV99,
 10408           DFHEIV99
 10409     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10410         DFHEIV20
 10411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10412        IF AT-TRAILER-TYPE = '1'
 10413           MOVE +1 TO MISC-SUB
 10414           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10415           MISC-SUB GREATER THAN +6 OR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 193
* EL131.cbl
 10416           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10417           IF MISC-SUB GREATER THAN +1
 10418              SUBTRACT +1 FROM MISC-SUB
 10419              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10420                 GO TO 2100-BYPASS-LAST-UPDATE.
 10421
 10422     IF TRLR-UPDATE-REQUIRED AND
 10423        CLAIM-IS-OPEN
 10424         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10425     ELSE
 10426         IF TRLR-UPDATE-REQUIRED AND
 10427            CLAIM-IS-CLOSED
 10428             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10429             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10430
 10431 2100-BYPASS-LAST-UPDATE.
 10432     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10433     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10434
 10435     GO TO 2100-EXIT.
 10436
 10437 2100-BUMP-OPEN-CLOSE-HIST.
 10438     ADD +1                      TO MISC-SUB.
 10439
 10440 2100-EXIT.
 10441     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 194
* EL131.cbl
 10443 2200-MOVE-CERT.
 10444     IF CRTLNMEI GREATER THAN LOW-VALUES
 10445         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 10446
 10447     IF CRTFNMEI GREATER THAN LOW-VALUES
 10448         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 10449         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 10450
 10451     IF CRTINITI GREATER THAN LOW-VALUES
 10452         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 10453
 10454     IF CM-INSURED-INITIALS = SPACES
 10455         MOVE '**'               TO CM-INSURED-INITIALS.
 10456
 10457     IF ISSAGEI GREATER THAN LOW-VALUES
 10458         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 10459
 10460     IF JNTFNMEI GREATER THAN LOW-VALUES
 10461         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 10462
 10463     IF JNTLNMEI GREATER THAN LOW-VALUES
 10464         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 10465
 10466     IF JNTINITI GREATER THAN LOW-VALUES
 10467         MOVE JNTINITI           TO CM-JT-INITIAL.
 10468
 10469     IF JNTAGEI GREATER THAN LOW-VALUES
 10470         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 10471
 10472     IF ADDONDTI GREATER THAN LOW-VALUES
 10473        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 10474
 10475     IF LCVCDI GREATER THAN LOW-VALUES
 10476        IF LCVCDI = SPACES OR ZEROS
 10477           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 10478        ELSE
 10479           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 10480
 10481     IF LCVOTRMI GREATER THAN LOW-VALUES
 10482         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 10483
 10484     IF LCVRATEL GREATER THAN +0
 10485         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 10486
 10487     IF LCVBENEL GREATER THAN +0
 10488         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 10489
 10490     IF LCVFORMI GREATER THAN LOW-VALUES
 10491         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 10492
 10493     IF LCVCNDTI = LOW-VALUES
 10494        GO TO 2210-SET-STATUS.
 10495
 10496     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 10497        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10498        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 10499        GO TO 2210-SET-STATUS.
 10500
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 195
* EL131.cbl
 10501     IF CM-LF-CURRENT-STATUS = '7'
 10502        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 10503        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10504        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10505                                    CM-LF-DEATH-DT
 10506        GO TO 2210-SET-STATUS.
 10507
 10508     IF CM-LF-CURRENT-STATUS = '8'
 10509        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10510        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10511                                    CM-LF-CANCEL-DT.
 10512
 10513 2210-SET-STATUS.
 10514
 10515     IF CM-LF-CURRENT-STATUS = SPACES
 10516         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10517
 10518     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 10519         MOVE '6'                TO DC-OPTION-CODE
 10520         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 10521         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 10522         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10523         IF NO-CONVERSION-ERROR
 10524             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 10525         ELSE
 10526             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 10527     ELSE
 10528         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 10529
 10530 2215-PROCESS-AH-SIDE.
 10531
 10532     IF ACVCDI GREATER THAN LOW-VALUES
 10533        IF ACVCDI = SPACES OR ZEROS
 10534           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 10535        ELSE
 10536           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 10537
 10538     IF ACVOTRMI GREATER THAN LOW-VALUES
 10539         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 10540
 10541     IF ACVRATEL GREATER THAN +0
 10542         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 10543
 10544     IF ACVBENEL GREATER THAN +0
 10545         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 10546                                    PI-PAYMENT-AMT.
 10547
 10548     IF ACVFORMI GREATER THAN LOW-VALUES
 10549         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 10550
 10551     IF ACVCNDTI = LOW-VALUES
 10552        GO TO 2220-SET-STATUS.
 10553
 10554     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 10555        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10556        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 10557        GO TO 2220-SET-STATUS.
 10558
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 196
* EL131.cbl
 10559     IF CM-AH-CURRENT-STATUS = '6'
 10560        MOVE CM-AH-STATUS-AT-SETTLEMENT
 10561                                 TO CM-AH-CURRENT-STATUS
 10562        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10563        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10564                                    CM-AH-SETTLEMENT-DT
 10565        GO TO 2220-SET-STATUS.
 10566
 10567     IF CM-AH-CURRENT-STATUS = '8'
 10568        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10569        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10570                                    CM-AH-CANCEL-DT.
 10571
 10572 2220-SET-STATUS.
 10573     IF CM-AH-CURRENT-STATUS = SPACES
 10574         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10575
 10576     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 10577         MOVE '6'                TO DC-OPTION-CODE
 10578         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 10579         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 10580         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10581         IF NO-CONVERSION-ERROR
 10582             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 10583         ELSE
 10584             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 10585     ELSE
 10586         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 10587
 10588 2225-FINISH-CERT.
 10589     IF APRL GREATER THAN +0
 10590         MOVE HOLD-APR           TO CM-LOAN-APR.
 10591
 10592     IF PMTFREQI GREATER THAN LOW-VALUES
 10593         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 10594
 10595     IF INDGRPI GREATER THAN LOW-VALUES
 10596         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 10597
 10598     IF LOANNOI GREATER THAN LOW-VALUES
 10599        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 10600
 10601     IF LOANBALL GREATER THAN +0
 10602        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 10603
 10604     IF PREMTYPI GREATER THAN LOW-VALUES
 10605         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 10606
 10607     IF REINCDI GREATER THAN LOW-VALUES
 10608         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10609                                    WS-REIN-1
 10610                                    WS-REIN-2
 10611                                    WS-REIN-3
 10612         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 10613
 10614     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 10615
 10616     MOVE ZEROS                  TO CM-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 197
* EL131.cbl
 10617                                    CM-LIFE-COMM-PCT
 10618                                    CM-AH-COMM-PCT.
 10619
 10620*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 10621*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 10622*         PI-NO-PMTS = ZEROS
 10623*          IF LOANBALL GREATER THAN +0          OR
 10624*             ACVBENEL GREATER THAN +0          OR
 10625*             APRL     GREATER THAN +0          OR
 10626*             LCVRATEL GREATER THAN +0          OR
 10627*             ACVRATEL GREATER THAN +0
 10628*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 10629
 10630 2200-EXIT.
 10631     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 198
* EL131.cbl
 10633 2300-UPDATE-TRLR.
 10634
 10635
 10636* EXEC CICS READ UPDATE
 10637*         DATASET  (TRLR-FILE-ID)
 10638*         RIDFLD   (TRLR-KEY)
 10639*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10640*    END-EXEC.
 10641*    MOVE '&"S        EU         (   #00009613' TO DFHEIV0
 10642     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10643     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10644     MOVE X'2020233030303039363133' TO DFHEIV0(25:11)
 10645     CALL 'kxdfhei1' USING DFHEIV0,
 10646           TRLR-FILE-ID,
 10647           DFHEIV20,
 10648           DFHEIV99,
 10649           TRLR-KEY,
 10650           DFHEIV99,
 10651           DFHEIV99,
 10652           DFHEIV99
 10653     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10654         DFHEIV20
 10655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10656
 10657
 10658     MOVE ZERO                   TO COUNT-2.
 10659
 10660     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 10661         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 10662
 10663     IF NOT UPDATE-MADE
 10664         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 10665
 10666
 10667* EXEC CICS REWRITE
 10668*         DATASET  (TRLR-FILE-ID)
 10669*         FROM     (ACTIVITY-TRAILERS)
 10670*    END-EXEC.
 10671     MOVE LENGTH OF
 10672      ACTIVITY-TRAILERS
 10673       TO DFHEIV11
 10674*    MOVE '&& L                  %   #00009627' TO DFHEIV0
 10675     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10676     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10677     MOVE X'2020233030303039363237' TO DFHEIV0(25:11)
 10678     CALL 'kxdfhei1' USING DFHEIV0,
 10679           TRLR-FILE-ID,
 10680           ACTIVITY-TRAILERS,
 10681           DFHEIV11,
 10682           DFHEIV99
 10683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10684
 10685
 10686 2300-EXIT.
 10687     EXIT.
 10688
 10689 2310-INS-STATUS.
 10690     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 199
* EL131.cbl
 10691     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 10692         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 10693         MOVE 'Y'                TO TRLR-SWITCH.
 10694
 10695 2310-EXIT.
 10696     EXIT.
 10697
 10698 2320-SHIFT-STATUS.
 10699     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 10700        MOVE 6                   TO COUNT-2
 10701        GO TO 2320-EXIT.
 10702
 10703     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 10704     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 10705     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 10706     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 10707     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 10708     MOVE 6       TO COUNT-2.
 10709     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 10710
 10711 2320-EXIT.
 10712     EXIT.
 10713
 10714 2330-ADD-UPDATE.
 10715
 10716     IF COUNT-2 GREATER THAN 1
 10717        COMPUTE MISC-SUB = (COUNT-2 - 1)
 10718        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10719           GO TO 2330-EXIT.
 10720
 10721     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 10722                                   AT-RESERVES-LAST-MAINT-DT
 10723
 10724     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 10725     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 10726     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 10727     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 10728
 10729 2330-EXIT.
 10730     EXIT.
 10731
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 200
* EL131.cbl
 10733 2400-UPDATE-TRLR.
 10734
 10735* EXEC CICS HANDLE CONDITION
 10736*         NOTFND    (2400-TRLR-NOTFND)
 10737*         ENDFILE   (2410-EXIT)
 10738*    END-EXEC.
 10739*    MOVE '"$I''                  ! 4 #00009680' TO DFHEIV0
 10740     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10742     MOVE X'3420233030303039363830' TO DFHEIV0(25:11)
 10743     CALL 'kxdfhei1' USING DFHEIV0
 10744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10745
 10746
 10747
 10748* EXEC CICS STARTBR
 10749*        DATASET (TRLR-FILE-ID)
 10750*        RIDFLD  (TRLR-KEY)
 10751*    END-EXEC.
 10752     MOVE 0
 10753       TO DFHEIV11
 10754*    MOVE '&,         G          &   #00009685' TO DFHEIV0
 10755     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10756     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10757     MOVE X'2020233030303039363835' TO DFHEIV0(25:11)
 10758     CALL 'kxdfhei1' USING DFHEIV0,
 10759           TRLR-FILE-ID,
 10760           TRLR-KEY,
 10761           DFHEIV99,
 10762           DFHEIV11,
 10763           DFHEIV99
 10764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10765
 10766
 10767
 10768* EXEC CICS GETMAIN
 10769*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10770*         LENGTH    (TRLR-LENGTH)
 10771*         INITIMG   (GETMAIN-SPACE)
 10772*    END-EXEC.
 10773*    MOVE ',"IL                  $   #00009690' TO DFHEIV0
 10774     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10775     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10776     MOVE X'2020233030303039363930' TO DFHEIV0(25:11)
 10777     CALL 'kxdfhei1' USING DFHEIV0,
 10778           DFHEIV20,
 10779           TRLR-LENGTH,
 10780           GETMAIN-SPACE
 10781     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10782         DFHEIV20
 10783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10784
 10785
 10786     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 10787
 10788
 10789* EXEC CICS ENDBR
 10790*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 201
* EL131.cbl
 10791*    END-EXEC.
 10792     MOVE 0
 10793       TO DFHEIV11
 10794*    MOVE '&2                    $   #00009698' TO DFHEIV0
 10795     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10796     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10797     MOVE X'2020233030303039363938' TO DFHEIV0(25:11)
 10798     CALL 'kxdfhei1' USING DFHEIV0,
 10799           TRLR-FILE-ID,
 10800           DFHEIV11,
 10801           DFHEIV99
 10802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10803
 10804
 10805     GO TO 2400-EXIT.
 10806
 10807 2400-TRLR-NOTFND.
 10808     MOVE ER-0205                TO EMI-ERROR.
 10809     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10810     MOVE 'X'                    TO ERROR-SWITCH.
 10811
 10812 2400-EXIT.
 10813     EXIT.
 10814
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 202
* EL131.cbl
 10816 2410-CHANGE-TRLR.
 10817
 10818* EXEC CICS READNEXT
 10819*        DATASET (TRLR-FILE-ID)
 10820*        RIDFLD  (TRLR-KEY)
 10821*        INTO    (ACTIVITY-TRAILERS)
 10822*    END-EXEC.
 10823     MOVE LENGTH OF
 10824      ACTIVITY-TRAILERS
 10825       TO DFHEIV12
 10826     MOVE 0
 10827       TO DFHEIV11
 10828*    MOVE '&.IL                  )   #00009714' TO DFHEIV0
 10829     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 10830     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10831     MOVE X'2020233030303039373134' TO DFHEIV0(25:11)
 10832     CALL 'kxdfhei1' USING DFHEIV0,
 10833           TRLR-FILE-ID,
 10834           ACTIVITY-TRAILERS,
 10835           DFHEIV12,
 10836           TRLR-KEY,
 10837           DFHEIV99,
 10838           DFHEIV11,
 10839           DFHEIV99,
 10840           DFHEIV99
 10841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10842
 10843
 10844     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 10845        GO TO 2410-CHANGE-TRLR.
 10846
 10847     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 10848                                    CHECK-KEY.
 10849
 10850     IF CHECK-KEY NOT = MSTR-KEY
 10851         GO TO 2410-EXIT.
 10852
 10853
 10854* EXEC CICS ENDBR
 10855*        DATASET (TRLR-FILE-ID)
 10856*    END-EXEC.
 10857     MOVE 0
 10858       TO DFHEIV11
 10859*    MOVE '&2                    $   #00009729' TO DFHEIV0
 10860     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10861     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10862     MOVE X'2020233030303039373239' TO DFHEIV0(25:11)
 10863     CALL 'kxdfhei1' USING DFHEIV0,
 10864           TRLR-FILE-ID,
 10865           DFHEIV11,
 10866           DFHEIV99
 10867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10868
 10869
 10870
 10871* EXEC CICS READ UPDATE
 10872*        DATASET (TRLR-FILE-ID)
 10873*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 203
* EL131.cbl
 10874*        INTO    (ACTIVITY-TRAILERS)
 10875*    END-EXEC.
 10876     MOVE LENGTH OF
 10877      ACTIVITY-TRAILERS
 10878       TO DFHEIV11
 10879*    MOVE '&"IL       EU         (   #00009733' TO DFHEIV0
 10880     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10881     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10882     MOVE X'2020233030303039373333' TO DFHEIV0(25:11)
 10883     CALL 'kxdfhei1' USING DFHEIV0,
 10884           TRLR-FILE-ID,
 10885           ACTIVITY-TRAILERS,
 10886           DFHEIV11,
 10887           TRLR-KEY,
 10888           DFHEIV99,
 10889           DFHEIV99,
 10890           DFHEIV99
 10891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10892
 10893
 10894
 10895* EXEC CICS DELETE
 10896*        DATASET (TRLR-FILE-ID)
 10897*    END-EXEC.
 10898*    MOVE '&(                    &   #00009739' TO DFHEIV0
 10899     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10900     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10901     MOVE X'2020233030303039373339' TO DFHEIV0(25:11)
 10902     CALL 'kxdfhei1' USING DFHEIV0,
 10903           TRLR-FILE-ID,
 10904           DFHEIV99,
 10905           DFHEIV99,
 10906           DFHEIV99,
 10907           DFHEIV99
 10908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10909
 10910
 10911     IF AT-SEQUENCE-NO = ZERO AND
 10912        TRLR-UPDATE-REQUIRED
 10913         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 10914
 10915     IF CERTI GREATER THAN LOW-VALUES
 10916        MOVE CERTI               TO AT-CERT-PRIME.
 10917
 10918     IF SUFXI GREATER THAN LOW-VALUES
 10919        MOVE SUFXI               TO AT-CERT-SFX.
 10920
 10921     IF CERTCARI GREATER THAN LOW-VALUES
 10922        MOVE CERTCARI            TO AT-CARRIER.
 10923
 10924     IF PAYMENT-TR
 10925        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 10926           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 10927              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 10928
 10929     IF CORRESPONDENCE-TR
 10930        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 10931           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 204
* EL131.cbl
 10932
 10933
 10934* EXEC CICS WRITE
 10935*         DATASET  (TRLR-FILE-ID)
 10936*         RIDFLD   (AT-CONTROL-PRIMARY)
 10937*         FROM     (ACTIVITY-TRAILERS)
 10938*    END-EXEC.
 10939     MOVE LENGTH OF
 10940      ACTIVITY-TRAILERS
 10941       TO DFHEIV11
 10942*    MOVE '&$ L                  ''   #00009765' TO DFHEIV0
 10943     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10944     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10945     MOVE X'2020233030303039373635' TO DFHEIV0(25:11)
 10946     CALL 'kxdfhei1' USING DFHEIV0,
 10947           TRLR-FILE-ID,
 10948           ACTIVITY-TRAILERS,
 10949           DFHEIV11,
 10950           AT-CONTROL-PRIMARY,
 10951           DFHEIV99,
 10952           DFHEIV99
 10953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10954
 10955
 10956
 10957* EXEC CICS STARTBR
 10958*         DATASET  (TRLR-FILE-ID)
 10959*         RIDFLD   (TRLR-KEY)
 10960*    END-EXEC.
 10961     MOVE 0
 10962       TO DFHEIV11
 10963*    MOVE '&,         G          &   #00009771' TO DFHEIV0
 10964     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10965     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10966     MOVE X'2020233030303039373731' TO DFHEIV0(25:11)
 10967     CALL 'kxdfhei1' USING DFHEIV0,
 10968           TRLR-FILE-ID,
 10969           TRLR-KEY,
 10970           DFHEIV99,
 10971           DFHEIV11,
 10972           DFHEIV99
 10973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10974
 10975
 10976     GO TO 2410-CHANGE-TRLR.
 10977
 10978 2410-EXIT.
 10979     EXIT.
 10980
 10981 2420-UPDATE-TRLR.
 10982     MOVE ZERO TO COUNT-2.
 10983     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 10984         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 10985
 10986     IF NOT UPDATE-MADE
 10987         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 10988
 10989 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 205
* EL131.cbl
 10990     EXIT.
 10991
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 206
* EL131.cbl
 10993 2425-UPDATE-NINETY-TRLR.
 10994
 10995     MOVE +90                    TO TRLR-SEQ-NO.
 10996
 10997
 10998* EXEC CICS HANDLE CONDITION
 10999*         NOTFND    (2425-NINETY-NOTFND)
 11000*         ENDFILE   (2425-NINETY-NOTFND)
 11001*    END-EXEC.
 11002*    MOVE '"$I''                  ! 5 #00009797' TO DFHEIV0
 11003     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11005     MOVE X'3520233030303039373937' TO DFHEIV0(25:11)
 11006     CALL 'kxdfhei1' USING DFHEIV0
 11007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11008
 11009
 11010
 11011* EXEC CICS READ UPDATE
 11012*        DATASET (TRLR-FILE-ID)
 11013*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11014*        RIDFLD  (TRLR-KEY)
 11015*    END-EXEC.
 11016*    MOVE '&"S        EU         (   #00009802' TO DFHEIV0
 11017     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11018     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11019     MOVE X'2020233030303039383032' TO DFHEIV0(25:11)
 11020     CALL 'kxdfhei1' USING DFHEIV0,
 11021           TRLR-FILE-ID,
 11022           DFHEIV20,
 11023           DFHEIV99,
 11024           TRLR-KEY,
 11025           DFHEIV99,
 11026           DFHEIV99,
 11027           DFHEIV99
 11028     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11029         DFHEIV20
 11030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11031
 11032
 11033     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 11034
 11035     MOVE DIAGI                 TO AT-INFO-LINE-1.
 11036
 11037
 11038* EXEC CICS REWRITE
 11039*        DATASET (TRLR-FILE-ID)
 11040*        FROM    (ACTIVITY-TRAILERS)
 11041*    END-EXEC.
 11042     MOVE LENGTH OF
 11043      ACTIVITY-TRAILERS
 11044       TO DFHEIV11
 11045*    MOVE '&& L                  %   #00009812' TO DFHEIV0
 11046     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11047     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11048     MOVE X'2020233030303039383132' TO DFHEIV0(25:11)
 11049     CALL 'kxdfhei1' USING DFHEIV0,
 11050           TRLR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 207
* EL131.cbl
 11051           ACTIVITY-TRAILERS,
 11052           DFHEIV11,
 11053           DFHEIV99
 11054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11055
 11056
 11057     IF DIAGI NOT = WS-DIAGNOSIS
 11058         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11059         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11060         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11061
 11062     GO TO 2425-EXIT.
 11063
 11064 2425-NINETY-NOTFND.
 11065
 11066
 11067* EXEC CICS GETMAIN
 11068*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11069*         LENGTH    (TRLR-LENGTH)
 11070*         INITIMG   (GETMAIN-SPACE)
 11071*    END-EXEC.
 11072*    MOVE ',"IL                  $   #00009826' TO DFHEIV0
 11073     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11074     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11075     MOVE X'2020233030303039383236' TO DFHEIV0(25:11)
 11076     CALL 'kxdfhei1' USING DFHEIV0,
 11077           DFHEIV20,
 11078           TRLR-LENGTH,
 11079           GETMAIN-SPACE
 11080     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11081         DFHEIV20
 11082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11083
 11084
 11085     MOVE +90                  TO TRLR-SEQ-NO.
 11086     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11087
 11088     MOVE 'AT'                 TO AT-RECORD-ID
 11089     MOVE '6'                  TO AT-TRAILER-TYPE
 11090     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11091                                  AT-GEN-INFO-LAST-MAINT-DT
 11092     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11093                                  AT-GEN-INFO-LAST-UPDATED-BY
 11094     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11095     MOVE DIAGI                TO AT-INFO-LINE-1.
 11096
 11097
 11098* EXEC CICS WRITE
 11099*        DATASET (TRLR-FILE-ID)
 11100*        FROM    (ACTIVITY-TRAILERS)
 11101*        RIDFLD  (TRLR-KEY)
 11102*    END-EXEC.
 11103     MOVE LENGTH OF
 11104      ACTIVITY-TRAILERS
 11105       TO DFHEIV11
 11106*    MOVE '&$ L                  ''   #00009844' TO DFHEIV0
 11107     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11108     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 208
* EL131.cbl
 11109     MOVE X'2020233030303039383434' TO DFHEIV0(25:11)
 11110     CALL 'kxdfhei1' USING DFHEIV0,
 11111           TRLR-FILE-ID,
 11112           ACTIVITY-TRAILERS,
 11113           DFHEIV11,
 11114           TRLR-KEY,
 11115           DFHEIV99,
 11116           DFHEIV99
 11117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11118
 11119
 11120 2425-EXIT.
 11121     EXIT.
 11122
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 209
* EL131.cbl
 11124 2430-UPDATE-ACTQ.
 11125
 11126* EXEC CICS HANDLE CONDITION
 11127*         NOTFND    (2430-EXIT)
 11128*         ENDFILE   (2440-EXIT)
 11129*    END-EXEC.
 11130*    MOVE '"$I''                  ! 6 #00009855' TO DFHEIV0
 11131     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11133     MOVE X'3620233030303039383535' TO DFHEIV0(25:11)
 11134     CALL 'kxdfhei1' USING DFHEIV0
 11135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11136
 11137
 11138
 11139* EXEC CICS STARTBR
 11140*         DATASET  (ACTQ-FILE-ID)
 11141*         RIDFLD   (ACTQ-KEY)
 11142*    END-EXEC.
 11143     MOVE 0
 11144       TO DFHEIV11
 11145*    MOVE '&,         G          &   #00009860' TO DFHEIV0
 11146     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11147     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11148     MOVE X'2020233030303039383630' TO DFHEIV0(25:11)
 11149     CALL 'kxdfhei1' USING DFHEIV0,
 11150           ACTQ-FILE-ID,
 11151           ACTQ-KEY,
 11152           DFHEIV99,
 11153           DFHEIV11,
 11154           DFHEIV99
 11155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11156
 11157
 11158
 11159* EXEC CICS GETMAIN
 11160*         SET      (ADDRESS OF ACTIVITY-QUE)
 11161*         LENGTH   (ACTQ-LENGTH)
 11162*         INITIMG  (GETMAIN-SPACE)
 11163*    END-EXEC.
 11164*    MOVE ',"IL                  $   #00009865' TO DFHEIV0
 11165     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11166     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11167     MOVE X'2020233030303039383635' TO DFHEIV0(25:11)
 11168     CALL 'kxdfhei1' USING DFHEIV0,
 11169           DFHEIV20,
 11170           ACTQ-LENGTH,
 11171           GETMAIN-SPACE
 11172     SET ADDRESS OF ACTIVITY-QUE TO
 11173         DFHEIV20
 11174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11175
 11176
 11177     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11178
 11179 2430-EXIT.
 11180     EXIT.
 11181
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 210
* EL131.cbl
 11182 2440-CHANGE-ACTQ.
 11183
 11184
 11185* EXEC CICS READNEXT
 11186*         DATASET  (ACTQ-FILE-ID)
 11187*         RIDFLD   (ACTQ-KEY)
 11188*         INTO     (ACTIVITY-QUE)
 11189*    END-EXEC.
 11190     MOVE LENGTH OF
 11191      ACTIVITY-QUE
 11192       TO DFHEIV12
 11193     MOVE 0
 11194       TO DFHEIV11
 11195*    MOVE '&.IL                  )   #00009878' TO DFHEIV0
 11196     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11197     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11198     MOVE X'2020233030303039383738' TO DFHEIV0(25:11)
 11199     CALL 'kxdfhei1' USING DFHEIV0,
 11200           ACTQ-FILE-ID,
 11201           ACTIVITY-QUE,
 11202           DFHEIV12,
 11203           ACTQ-KEY,
 11204           DFHEIV99,
 11205           DFHEIV11,
 11206           DFHEIV99,
 11207           DFHEIV99
 11208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11209
 11210
 11211
 11212* EXEC CICS ENDBR
 11213*         DATASET (ACTQ-FILE-ID)
 11214*    END-EXEC.
 11215     MOVE 0
 11216       TO DFHEIV11
 11217*    MOVE '&2                    $   #00009884' TO DFHEIV0
 11218     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11219     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11220     MOVE X'2020233030303039383834' TO DFHEIV0(25:11)
 11221     CALL 'kxdfhei1' USING DFHEIV0,
 11222           ACTQ-FILE-ID,
 11223           DFHEIV11,
 11224           DFHEIV99
 11225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11226
 11227
 11228     IF ACTQ-KEY NOT = MSTR-KEY
 11229         GO TO 2440-EXIT.
 11230
 11231
 11232* EXEC CICS READ UPDATE
 11233*         DATASET  (ACTQ-FILE-ID)
 11234*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11235*         SET      (ADDRESS OF ACTIVITY-QUE)
 11236*    END-EXEC.
 11237*    MOVE '&"S        EU         (   #00009891' TO DFHEIV0
 11238     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11239     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 211
* EL131.cbl
 11240     MOVE X'2020233030303039383931' TO DFHEIV0(25:11)
 11241     CALL 'kxdfhei1' USING DFHEIV0,
 11242           ACTQ-FILE-ID,
 11243           DFHEIV20,
 11244           DFHEIV99,
 11245           AQ-CONTROL-PRIMARY,
 11246           DFHEIV99,
 11247           DFHEIV99,
 11248           DFHEIV99
 11249     SET ADDRESS OF ACTIVITY-QUE TO
 11250         DFHEIV20
 11251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11252
 11253
 11254     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 11255
 11256
 11257* EXEC CICS DELETE
 11258*         DATASET (ACTQ-FILE-ID)
 11259*    END-EXEC.
 11260*    MOVE '&(                    &   #00009899' TO DFHEIV0
 11261     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11262     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11263     MOVE X'2020233030303039383939' TO DFHEIV0(25:11)
 11264     CALL 'kxdfhei1' USING DFHEIV0,
 11265           ACTQ-FILE-ID,
 11266           DFHEIV99,
 11267           DFHEIV99,
 11268           DFHEIV99,
 11269           DFHEIV99
 11270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11271
 11272
 11273     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 11274     IF CERTI GREATER THAN LOW-VALUES
 11275        MOVE CERTI               TO AQ-CERT-PRIME.
 11276     IF SUFXI GREATER THAN LOW-VALUES
 11277        MOVE SUFXI               TO AQ-CERT-SFX.
 11278     IF CERTCARI GREATER THAN LOW-VALUES
 11279        MOVE CERTCARI            TO AQ-CARRIER.
 11280
 11281
 11282* EXEC CICS HANDLE CONDITION
 11283*         DUPREC   (2440-EXIT)
 11284*    END-EXEC.
 11285*    MOVE '"$%                   ! 7 #00009911' TO DFHEIV0
 11286     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11288     MOVE X'3720233030303039393131' TO DFHEIV0(25:11)
 11289     CALL 'kxdfhei1' USING DFHEIV0
 11290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11291
 11292
 11293
 11294* EXEC CICS WRITE
 11295*         DATASET  (ACTQ-FILE-ID)
 11296*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11297*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 212
* EL131.cbl
 11298*    END-EXEC.
 11299     MOVE LENGTH OF
 11300      ACTIVITY-QUE
 11301       TO DFHEIV11
 11302*    MOVE '&$ L                  ''   #00009915' TO DFHEIV0
 11303     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11304     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11305     MOVE X'2020233030303039393135' TO DFHEIV0(25:11)
 11306     CALL 'kxdfhei1' USING DFHEIV0,
 11307           ACTQ-FILE-ID,
 11308           ACTIVITY-QUE,
 11309           DFHEIV11,
 11310           AQ-CONTROL-PRIMARY,
 11311           DFHEIV99,
 11312           DFHEIV99
 11313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11314
 11315
 11316 2440-EXIT.
 11317     EXIT.
 11318
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 213
* EL131.cbl
 11320 2460-UPDATE-CHECKQ.
 11321
 11322* EXEC CICS HANDLE CONDITION
 11323*         NOTFND   (2460-EXIT)
 11324*    END-EXEC.
 11325*    MOVE '"$I                   ! 8 #00009926' TO DFHEIV0
 11326     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11328     MOVE X'3820233030303039393236' TO DFHEIV0(25:11)
 11329     CALL 'kxdfhei1' USING DFHEIV0
 11330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11331
 11332
 11333     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 11334     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 11335     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 11336
 11337
 11338* EXEC CICS READ UPDATE
 11339*         DATASET   (CHKQ-FILE-ID)
 11340*         RIDFLD    (CHKQ-KEY)
 11341*         SET       (ADDRESS OF CHECK-QUE)
 11342*    END-EXEC.
 11343*    MOVE '&"S        EU         (   #00009934' TO DFHEIV0
 11344     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11345     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11346     MOVE X'2020233030303039393334' TO DFHEIV0(25:11)
 11347     CALL 'kxdfhei1' USING DFHEIV0,
 11348           CHKQ-FILE-ID,
 11349           DFHEIV20,
 11350           DFHEIV99,
 11351           CHKQ-KEY,
 11352           DFHEIV99,
 11353           DFHEIV99,
 11354           DFHEIV99
 11355     SET ADDRESS OF CHECK-QUE TO
 11356         DFHEIV20
 11357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11358
 11359
 11360     IF CERTI GREATER THAN LOW-VALUES
 11361        MOVE CERTI               TO CQ-CERT-PRIME.
 11362     IF SUFXI GREATER THAN LOW-VALUES
 11363        MOVE SUFXI               TO CQ-CERT-SFX.
 11364     IF CERTCARI GREATER THAN LOW-VALUES
 11365        MOVE CERTCARI            TO CQ-CARRIER.
 11366
 11367
 11368* EXEC CICS REWRITE
 11369*         DATASET  (CHKQ-FILE-ID)
 11370*         FROM     (CHECK-QUE)
 11371*    END-EXEC.
 11372     MOVE LENGTH OF
 11373      CHECK-QUE
 11374       TO DFHEIV11
 11375*    MOVE '&& L                  %   #00009947' TO DFHEIV0
 11376     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11377     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 214
* EL131.cbl
 11378     MOVE X'2020233030303039393437' TO DFHEIV0(25:11)
 11379     CALL 'kxdfhei1' USING DFHEIV0,
 11380           CHKQ-FILE-ID,
 11381           CHECK-QUE,
 11382           DFHEIV11,
 11383           DFHEIV99
 11384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11385
 11386
 11387 2460-EXIT.
 11388     EXIT.
 11389
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 215
* EL131.cbl
 11391 2475-UPDATE-LETTER.
 11392
 11393* EXEC CICS HANDLE CONDITION
 11394*         NOTFND   (2475-EXIT)
 11395*    END-EXEC.
 11396*    MOVE '"$I                   ! 9 #00009957' TO DFHEIV0
 11397     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11399     MOVE X'3920233030303039393537' TO DFHEIV0(25:11)
 11400     CALL 'kxdfhei1' USING DFHEIV0
 11401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11402
 11403
 11404     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 11405     MOVE '1'                    TO ARCH-RECORD-TYPE.
 11406     MOVE ZEROS                  TO ARCH-SEQ-NO.
 11407     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 11408
 11409
 11410* EXEC CICS READ UPDATE
 11411*         DATASET   (ARCH-FILE-ID)
 11412*         RIDFLD    (ARCH-KEY)
 11413*         SET       (ADDRESS OF LETTER-ARCHIVE)
 11414*    END-EXEC.
 11415*    MOVE '&"S        EU         (   #00009966' TO DFHEIV0
 11416     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11417     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11418     MOVE X'2020233030303039393636' TO DFHEIV0(25:11)
 11419     CALL 'kxdfhei1' USING DFHEIV0,
 11420           ARCH-FILE-ID,
 11421           DFHEIV20,
 11422           DFHEIV99,
 11423           ARCH-KEY,
 11424           DFHEIV99,
 11425           DFHEIV99,
 11426           DFHEIV99
 11427     SET ADDRESS OF LETTER-ARCHIVE TO
 11428         DFHEIV20
 11429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11430
 11431
 11432* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 11433* TO THIS MASTER-KEY INFORMATION.
 11434
 11435     IF LA-CARRIER  = CARRIER-CODE AND
 11436        LA-CLAIM-NO = CLAIM-NO     AND
 11437        LA-CERT-NO  = CERT-NO
 11438        NEXT SENTENCE
 11439     ELSE
 11440        GO TO 2475-UNLOCK.
 11441
 11442     IF CERTI GREATER THAN LOW-VALUES
 11443        MOVE CERTI               TO LA-CERT-PRIME.
 11444     IF SUFXI GREATER THAN LOW-VALUES
 11445        MOVE SUFXI               TO LA-CERT-SFX.
 11446     IF CERTCARI GREATER THAN LOW-VALUES
 11447        MOVE CERTCARI            TO LA-CARRIER.
 11448
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 216
* EL131.cbl
 11449
 11450* EXEC CICS REWRITE
 11451*         DATASET  (ARCH-FILE-ID)
 11452*         FROM     (LETTER-ARCHIVE)
 11453*    END-EXEC.
 11454     MOVE LENGTH OF
 11455      LETTER-ARCHIVE
 11456       TO DFHEIV11
 11457*    MOVE '&& L                  %   #00009989' TO DFHEIV0
 11458     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11459     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11460     MOVE X'2020233030303039393839' TO DFHEIV0(25:11)
 11461     CALL 'kxdfhei1' USING DFHEIV0,
 11462           ARCH-FILE-ID,
 11463           LETTER-ARCHIVE,
 11464           DFHEIV11,
 11465           DFHEIV99
 11466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11467
 11468
 11469     GO TO 2475-EXIT.
 11470
 11471 2475-UNLOCK.
 11472
 11473* EXEC CICS UNLOCK
 11474*         DATASET  (ARCH-FILE-ID)
 11475*    END-EXEC.
 11476*    MOVE '&*                    #   #00009997' TO DFHEIV0
 11477     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11478     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11479     MOVE X'2020233030303039393937' TO DFHEIV0(25:11)
 11480     CALL 'kxdfhei1' USING DFHEIV0,
 11481           ARCH-FILE-ID,
 11482           DFHEIV99
 11483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11484
 11485
 11486 2475-EXIT.
 11487     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 217
* EL131.cbl
 11489 2600-CREATE-MAINT-NOTE.
 11490     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 11491     MOVE '1'                    TO CNTL-REC-TYPE.
 11492     MOVE SPACES                 TO CNTL-PROC-ID.
 11493     MOVE ZERO                   TO CNTL-SEQ-NO.
 11494
 11495
 11496* EXEC CICS READ
 11497*         SET        (ADDRESS OF CONTROL-FILE)
 11498*         DATASET    ('ELCNTL')
 11499*         RIDFLD     (CNTL-KEY)
 11500*    END-EXEC.
 11501     MOVE 'ELCNTL' TO DFHEIV1
 11502*    MOVE '&"S        E          (   #00010010' TO DFHEIV0
 11503     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11505     MOVE X'2020233030303130303130' TO DFHEIV0(25:11)
 11506     CALL 'kxdfhei1' USING DFHEIV0,
 11507           DFHEIV1,
 11508           DFHEIV20,
 11509           DFHEIV99,
 11510           CNTL-KEY,
 11511           DFHEIV99,
 11512           DFHEIV99,
 11513           DFHEIV99
 11514     SET ADDRESS OF CONTROL-FILE TO
 11515         DFHEIV20
 11516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11517
 11518
 11519     IF CO-NO-USE-AUDIT-CHANGES
 11520         GO TO 2600-EXIT.
 11521
 11522     IF PROCL GREATER ZERO
 11523     IF PROCI NOT = LOW-VALUES
 11524     IF PROCI NOT = CL-PROCESSOR-ID
 11525         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 11526         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 11527         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11528
 11529     IF SEXL GREATER ZERO
 11530     IF SEXI NOT = LOW-VALUES
 11531     IF SEXI NOT = CL-INSURED-SEX-CD
 11532         MOVE 'SEX'                TO SPLIT-INFO-DESC
 11533         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 11534         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11535
 11536     IF BIRTHL GREATER ZERO
 11537     IF HOLD-BIRTH NOT = LOW-VALUES
 11538     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 11539         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 11540         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 11541         MOVE SPACES               TO DC-OPTION-CODE
 11542         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11543         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11544         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11545
 11546     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 218
* EL131.cbl
 11547     IF SOCIALI NOT = LOW-VALUES
 11548     IF SOCIALI NOT = CL-SOC-SEC-NO
 11549         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 11550         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 11551         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11552
 11553     IF OCCL GREATER ZERO
 11554     IF OCCI NOT = LOW-VALUES
 11555     IF OCCI NOT = CL-INSURED-OCC-CD
 11556         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 11557         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 11558         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11559
 11560     IF BENEL GREATER ZERO
 11561     IF BENEI NOT = LOW-VALUES
 11562     IF BENEI NOT = CL-BENEFICIARY
 11563         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 11564         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 11565         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11566
 11567     IF PREMTYPL GREATER ZERO
 11568     IF PREMTYPI NOT = LOW-VALUES
 11569     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 11570         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 11571         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 11572         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11573
 11574     IF CAUSEL GREATER ZERO
 11575     IF CAUSEI NOT = LOW-VALUES
 11576     IF CAUSEI NOT = CL-CAUSE-CD
 11577         MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 11578         MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 11579         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11580
 11581     IF ENDL GREATER ZERO
 11582     IF HOLD-END NOT = LOW-VALUES
 11583     IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 11584         MOVE 'END DT'             TO SPLIT-INFO-DESC
 11585         MOVE CL-EST-END-OF-DISAB-DT
 11586                                   TO DC-BIN-DATE-1
 11587         MOVE SPACES               TO DC-OPTION-CODE
 11588         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11589         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11590         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11591
 11592     IF PDTHRUL GREATER ZERO
 11593     IF HOLD-PDTHRU NOT = LOW-VALUES
 11594     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 11595         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 11596         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 11597         MOVE SPACES               TO DC-OPTION-CODE
 11598         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11599         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11600         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11601
 11602     IF PDAMTL GREATER ZERO
 11603     IF HOLD-PDAMT NOT = ZEROS
 11604     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 219
* EL131.cbl
 11605         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 11606         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 11607         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 11608         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11609
 11610     IF NODAYSL GREATER ZERO
 11611     IF HOLD-NODAYS NOT = ZEROS
 11612     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 11613         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 11614         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 11615         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 11616         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11617
 11618     IF NOPMTSL GREATER ZERO
 11619     IF HOLD-NOPMTS NOT = ZEROS
 11620     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 11621         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 11622         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 11623         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 11624         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11625
 11626     IF FORMTYPL GREATER ZERO
 11627     IF FORMTYPI NOT = LOW-VALUES
 11628     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 11629         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 11630         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 11631         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11632
 11633     IF REPL GREATER ZERO
 11634     IF HOLD-REPORTED NOT = LOW-VALUES
 11635     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 11636         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 11637         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 11638         MOVE SPACES               TO DC-OPTION-CODE
 11639         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11640         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11641         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11642
 11643     IF ADDONDTL GREATER ZERO
 11644     IF HOLD-ADDON NOT = LOW-VALUES
 11645     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 11646         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 11647         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 11648         MOVE SPACES               TO DC-OPTION-CODE
 11649         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11650         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11651         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11652
 11653     IF PRICDL GREATER ZERO
 11654     IF PRICDI NOT = LOW-VALUES
 11655     IF PRICDI NOT = CL-PRIORITY-CD
 11656         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 11657         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 11658         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11659
 11660     IF FILETOL GREATER ZERO
 11661     IF FILETOI NOT = LOW-VALUES
 11662     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 220
* EL131.cbl
 11663         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 11664         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 11665         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11666
 11667     IF SUPVL GREATER ZERO
 11668     IF SUPVI NOT = LOW-VALUES
 11669     IF SUPVI NOT = CL-SUPV-ATTN-CD
 11670         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 11671         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 11672         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11673
 11674     IF MLNAMEL GREATER ZERO
 11675     IF MLNAMEI NOT = LOW-VALUES
 11676     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 11677         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 11678         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 11679         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11680
 11681     IF MFNAMEL GREATER ZERO
 11682     IF MFNAMEI NOT = LOW-VALUES
 11683     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 11684         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 11685         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 11686         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11687
 11688     IF MMINITL GREATER ZERO
 11689     IF MMINITI NOT = LOW-VALUES
 11690     IF MMINITI NOT = CL-INSURED-MID-INIT
 11691         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 11692         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 11693         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11694
 11695     IF CERTEFFL GREATER ZERO
 11696     IF HOLD-EFF NOT = LOW-VALUES
 11697     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 11698         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 11699         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 11700         MOVE SPACES               TO DC-OPTION-CODE
 11701         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11702         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 11703         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11704
 11705     IF CERTACTL GREATER ZERO
 11706     IF CERTACTI NOT = LOW-VALUES
 11707     IF CERTACTI NOT = CL-CERT-ACCOUNT
 11708         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 11709         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 11710         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11711
 11712     IF CERTSTL GREATER ZERO
 11713     IF CERTSTI NOT = LOW-VALUES
 11714     IF CERTSTI NOT = CL-CERT-STATE
 11715         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 11716         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 11717         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11718
 11719     IF CERTCARL GREATER ZERO
 11720     IF CERTCARI NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 221
* EL131.cbl
 11721     IF CERTCARI NOT = CL-CERT-CARRIER
 11722         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 11723         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 11724         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11725
 11726     IF CERTGRPL GREATER ZERO
 11727     IF CERTGRPI NOT = LOW-VALUES
 11728     IF CERTGRPI NOT = CL-CERT-GROUPING
 11729         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 11730         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 11731         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11732
 11733     IF CERTL GREATER ZERO OR
 11734        SUFXL GREATER ZERO
 11735     IF (CERTI NOT = LOW-VALUES AND
 11736                     CL-CERT-PRIME)
 11737                OR
 11738        (SUFXI NOT = LOW-VALUES AND
 11739                     CL-CERT-SFX)
 11740         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 11741         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 11742         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11743
 11744 2600-EXIT.
 11745      EXIT.
 11746
 11747 2650-WRITE-MAINT-NOTE.
 11748
 11749* EXEC CICS GETMAIN
 11750*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11751*         LENGTH   (TRLR-LENGTH)
 11752*         INITIMG  (GETMAIN-SPACE)
 11753*    END-EXEC.
 11754*    MOVE ',"IL                  $   #00010245' TO DFHEIV0
 11755     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11756     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11757     MOVE X'2020233030303130323435' TO DFHEIV0(25:11)
 11758     CALL 'kxdfhei1' USING DFHEIV0,
 11759           DFHEIV20,
 11760           TRLR-LENGTH,
 11761           GETMAIN-SPACE
 11762     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11763         DFHEIV20
 11764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11765
 11766
 11767
 11768* EXEC CICS HANDLE CONDITION
 11769*         DUPREC   (2650-EXIT)
 11770*    END-EXEC.
 11771*    MOVE '"$%                   ! : #00010251' TO DFHEIV0
 11772     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11773     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11774     MOVE X'3A20233030303130323531' TO DFHEIV0(25:11)
 11775     CALL 'kxdfhei1' USING DFHEIV0
 11776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11777
 11778
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 222
* EL131.cbl
 11779     MOVE SPACES             TO ACTIVITY-TRAILERS.
 11780
 11781     IF CERTL GREATER ZERO
 11782         MOVE CERTI          TO CL-CERT-PRIME.
 11783
 11784     IF SUFXL GREATER ZERO
 11785         MOVE SUFXI          TO CL-CERT-SFX.
 11786
 11787     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 11788
 11789     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 11790     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 11791
 11792     MOVE 'AT'               TO AT-RECORD-ID.
 11793
 11794     MOVE '6'                TO AT-TRAILER-TYPE.
 11795     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 11796                                AT-GEN-INFO-LAST-MAINT-DT.
 11797     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 11798                                AT-GEN-INFO-LAST-UPDATED-BY.
 11799     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 11800     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 11801     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 11802
 11803
 11804* EXEC CICS WRITE
 11805*         DATASET  (TRLR-FILE-ID)
 11806*         RIDFLD   (AT-CONTROL-PRIMARY)
 11807*         FROM     (ACTIVITY-TRAILERS)
 11808*    END-EXEC.
 11809     MOVE LENGTH OF
 11810      ACTIVITY-TRAILERS
 11811       TO DFHEIV11
 11812*    MOVE '&$ L                  ''   #00010279' TO DFHEIV0
 11813     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11814     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11815     MOVE X'2020233030303130323739' TO DFHEIV0(25:11)
 11816     CALL 'kxdfhei1' USING DFHEIV0,
 11817           TRLR-FILE-ID,
 11818           ACTIVITY-TRAILERS,
 11819           DFHEIV11,
 11820           AT-CONTROL-PRIMARY,
 11821           DFHEIV99,
 11822           DFHEIV99
 11823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11824
 11825
 11826 2650-EXIT.
 11827      EXIT.
 11828
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 223
* EL131.cbl
 11830 3000-DELETE-CLAIM.
 11831     IF  NOT MODIFY-CAP
 11832         MOVE ER-0070            TO EMI-ERROR
 11833         MOVE -1                 TO MAINTL
 11834         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11835         GO TO 8110-SEND-DATA.
 11836
 11837
 11838* EXEC CICS READ
 11839*         SET      (ADDRESS OF CLAIM-MASTER)
 11840*         DATASET  (CLMS-FILE-ID)
 11841*         RIDFLD   (MSTR-KEY)
 11842*    END-EXEC.
 11843*    MOVE '&"S        E          (   #00010296' TO DFHEIV0
 11844     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11846     MOVE X'2020233030303130323936' TO DFHEIV0(25:11)
 11847     CALL 'kxdfhei1' USING DFHEIV0,
 11848           CLMS-FILE-ID,
 11849           DFHEIV20,
 11850           DFHEIV99,
 11851           MSTR-KEY,
 11852           DFHEIV99,
 11853           DFHEIV99,
 11854           DFHEIV99
 11855     SET ADDRESS OF CLAIM-MASTER TO
 11856         DFHEIV20
 11857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11858
 11859
 11860     IF CL-1ST-TRL-AVAIL
 11861         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 11862     ELSE
 11863        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 11864        MOVE 0                   TO TRLR-SEQ-NO
 11865
 11866* EXEC CICS STARTBR
 11867*            DATASET (TRLR-FILE-ID)
 11868*            RIDFLD  (TRLR-KEY)
 11869*        END-EXEC
 11870     MOVE 0
 11871       TO DFHEIV11
 11872*    MOVE '&,         G          &   #00010307' TO DFHEIV0
 11873     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11874     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11875     MOVE X'2020233030303130333037' TO DFHEIV0(25:11)
 11876     CALL 'kxdfhei1' USING DFHEIV0,
 11877           TRLR-FILE-ID,
 11878           TRLR-KEY,
 11879           DFHEIV99,
 11880           DFHEIV11,
 11881           DFHEIV99
 11882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11883         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 11884
 11885* EXEC CICS ENDBR
 11886*            DATASET (TRLR-FILE-ID)
 11887*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 224
* EL131.cbl
 11888     MOVE 0
 11889       TO DFHEIV11
 11890*    MOVE '&2                    $   #00010312' TO DFHEIV0
 11891     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11892     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11893     MOVE X'2020233030303130333132' TO DFHEIV0(25:11)
 11894     CALL 'kxdfhei1' USING DFHEIV0,
 11895           TRLR-FILE-ID,
 11896           DFHEIV11,
 11897           DFHEIV99
 11898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11899        IF SCREEN-ERROR
 11900            MOVE ER-0208         TO EMI-ERROR
 11901            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11902            MOVE -1              TO MAINTL
 11903            GO TO 8110-SEND-DATA
 11904        ELSE
 11905            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 11906
 11907     IF SCREEN-ERROR
 11908         MOVE -1                 TO MAINTL
 11909         GO TO 8110-SEND-DATA.
 11910
 11911     MOVE -1                     TO ONE-OR-MIN1.
 11912     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 11913
 11914     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 11915         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 11916                                    WS-SAVE-CLAIM-KEY
 11917         MOVE +1                 TO ONE-OR-MIN1
 11918         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 11919
 11920     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 11921
 11922     MOVE LOW-VALUES             TO EL131AO.
 11923     MOVE ER-0000                TO EMI-ERROR.
 11924     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11925     MOVE 'X'                    TO PI-RETURN-CD-1.
 11926     MOVE -1                     TO MAINTL.
 11927     GO TO 8100-SEND-MAP.
 11928
 11929 3010-DEL-MSTR-TRLR.
 11930
 11931* EXEC CICS READ UPDATE
 11932*         SET       (ADDRESS OF CLAIM-MASTER)
 11933*         DATASET   (CLMS-FILE-ID)
 11934*         RIDFLD    (MSTR-KEY)
 11935*    END-EXEC.
 11936*    MOVE '&"S        EU         (   #00010346' TO DFHEIV0
 11937     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11938     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11939     MOVE X'2020233030303130333436' TO DFHEIV0(25:11)
 11940     CALL 'kxdfhei1' USING DFHEIV0,
 11941           CLMS-FILE-ID,
 11942           DFHEIV20,
 11943           DFHEIV99,
 11944           MSTR-KEY,
 11945           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 225
* EL131.cbl
 11946           DFHEIV99,
 11947           DFHEIV99
 11948     SET ADDRESS OF CLAIM-MASTER TO
 11949         DFHEIV20
 11950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11951
 11952
 11953     if (cl-priority-cd = '8')
 11954        and (pi-processor-id not = 'PEMA' and 'JMS '
 11955             AND 'AMWA')
 11956        MOVE ER-8003             TO EMI-ERROR
 11957        PERFORM 9900-ERROR-FORMAT
 11958                                 THRU 9900-EXIT
 11959        MOVE -1                  TO MAINTL
 11960        GO TO 8110-SEND-DATA
 11961     end-if
 11962
 11963     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 11964     MOVE ZERO                   TO TRLR-SEQ-NO.
 11965
 11966
 11967* EXEC CICS HANDLE CONDITION
 11968*         NOTFND    (3010-DEL-ACTQ)
 11969*         ENDFILE   (3040-EXIT)
 11970*    END-EXEC.
 11971*    MOVE '"$I''                  ! ; #00010365' TO DFHEIV0
 11972     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11974     MOVE X'3B20233030303130333635' TO DFHEIV0(25:11)
 11975     CALL 'kxdfhei1' USING DFHEIV0
 11976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11977
 11978
 11979     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 11980
 11981 3010-DEL-ACTQ.
 11982
 11983
 11984* EXEC CICS HANDLE CONDITION
 11985*         NOTFND    (3010-NO-ACTIVITY)
 11986*         ENDFILE   (3050-EXIT)
 11987*    END-EXEC.
 11988*    MOVE '"$I''                  ! < #00010374' TO DFHEIV0
 11989     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11991     MOVE X'3C20233030303130333734' TO DFHEIV0(25:11)
 11992     CALL 'kxdfhei1' USING DFHEIV0
 11993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11994
 11995
 11996
 11997* EXEC CICS STARTBR
 11998*         DATASET  (ACTQ-FILE-ID)
 11999*         RIDFLD   (ACTQ-KEY)
 12000*    END-EXEC.
 12001     MOVE 0
 12002       TO DFHEIV11
 12003*    MOVE '&,         G          &   #00010379' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 226
* EL131.cbl
 12004     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12005     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12006     MOVE X'2020233030303130333739' TO DFHEIV0(25:11)
 12007     CALL 'kxdfhei1' USING DFHEIV0,
 12008           ACTQ-FILE-ID,
 12009           ACTQ-KEY,
 12010           DFHEIV99,
 12011           DFHEIV11,
 12012           DFHEIV99
 12013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12014
 12015
 12016
 12017* EXEC CICS GETMAIN
 12018*         SET      (ADDRESS OF ACTIVITY-QUE)
 12019*         LENGTH   (ACTQ-LENGTH)
 12020*         INITIMG  (GETMAIN-SPACE)
 12021*    END-EXEC.
 12022*    MOVE ',"IL                  $   #00010384' TO DFHEIV0
 12023     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12024     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12025     MOVE X'2020233030303130333834' TO DFHEIV0(25:11)
 12026     CALL 'kxdfhei1' USING DFHEIV0,
 12027           DFHEIV20,
 12028           ACTQ-LENGTH,
 12029           GETMAIN-SPACE
 12030     SET ADDRESS OF ACTIVITY-QUE TO
 12031         DFHEIV20
 12032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12033
 12034
 12035     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 12036
 12037
 12038* EXEC CICS ENDBR
 12039*         DATASET (ACTQ-FILE-ID)
 12040*    END-EXEC.
 12041     MOVE 0
 12042       TO DFHEIV11
 12043*    MOVE '&2                    $   #00010392' TO DFHEIV0
 12044     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12045     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12046     MOVE X'2020233030303130333932' TO DFHEIV0(25:11)
 12047     CALL 'kxdfhei1' USING DFHEIV0,
 12048           ACTQ-FILE-ID,
 12049           DFHEIV11,
 12050           DFHEIV99
 12051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12052
 12053
 12054 3010-NO-ACTIVITY.
 12055
 12056
 12057* EXEC CICS HANDLE CONDITION
 12058*        NOTFND   (3010-CERT-NOT-FOUND)
 12059*    END-EXEC.
 12060*    MOVE '"$I                   ! = #00010398' TO DFHEIV0
 12061     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 227
* EL131.cbl
 12062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12063     MOVE X'3D20233030303130333938' TO DFHEIV0(25:11)
 12064     CALL 'kxdfhei1' USING DFHEIV0
 12065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12066
 12067
 12068     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12069     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12070     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12071     MOVE CL-CERT-STATE          TO CERT-STATE.
 12072     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12073     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12074     MOVE CL-CERT-NO             TO CERT-CERT.
 12075
 12076
 12077* EXEC CICS READ
 12078*        DATASET   (CERT-FILE-ID)
 12079*        RIDFLD    (CERT-KEY)
 12080*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12081*    END-EXEC.
 12082*    MOVE '&"S        E          (   #00010410' TO DFHEIV0
 12083     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12084     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12085     MOVE X'2020233030303130343130' TO DFHEIV0(25:11)
 12086     CALL 'kxdfhei1' USING DFHEIV0,
 12087           CERT-FILE-ID,
 12088           DFHEIV20,
 12089           DFHEIV99,
 12090           CERT-KEY,
 12091           DFHEIV99,
 12092           DFHEIV99,
 12093           DFHEIV99
 12094     SET ADDRESS OF CERTIFICATE-MASTER TO
 12095         DFHEIV20
 12096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12097
 12098
 12099     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12100         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12101     ELSE
 12102         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 12103
 12104 3010-CERT-NOT-FOUND.
 12105
 12106
 12107* EXEC CICS DELETE
 12108*        DATASET  (CLMS-FILE-ID)
 12109*    END-EXEC.
 12110*    MOVE '&(                    &   #00010423' TO DFHEIV0
 12111     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12112     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12113     MOVE X'2020233030303130343233' TO DFHEIV0(25:11)
 12114     CALL 'kxdfhei1' USING DFHEIV0,
 12115           CLMS-FILE-ID,
 12116           DFHEIV99,
 12117           DFHEIV99,
 12118           DFHEIV99,
 12119           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 228
* EL131.cbl
 12120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12121
 12122
 12123 3010-EXIT.
 12124      EXIT.
 12125
 12126 3020-UPDATE-CERT.
 12127
 12128* EXEC CICS READ UPDATE
 12129*         DATASET  (CERT-FILE-ID)
 12130*         RIDFLD   (CERT-KEY)
 12131*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12132*    END-EXEC.
 12133*    MOVE '&"S        EU         (   #00010431' TO DFHEIV0
 12134     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12135     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12136     MOVE X'2020233030303130343331' TO DFHEIV0(25:11)
 12137     CALL 'kxdfhei1' USING DFHEIV0,
 12138           CERT-FILE-ID,
 12139           DFHEIV20,
 12140           DFHEIV99,
 12141           CERT-KEY,
 12142           DFHEIV99,
 12143           DFHEIV99,
 12144           DFHEIV99
 12145     SET ADDRESS OF CERTIFICATE-MASTER TO
 12146         DFHEIV20
 12147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12148
 12149
 12150     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 12151
 12152
 12153* EXEC CICS HANDLE CONDITION
 12154*         DUPKEY   (3020-EXIT)
 12155*    END-EXEC.
 12156*    MOVE '"$$                   ! > #00010439' TO DFHEIV0
 12157     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12158     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12159     MOVE X'3E20233030303130343339' TO DFHEIV0(25:11)
 12160     CALL 'kxdfhei1' USING DFHEIV0
 12161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12162
 12163
 12164
 12165* EXEC CICS REWRITE
 12166*         DATASET  (CERT-FILE-ID)
 12167*         FROM     (CERTIFICATE-MASTER)
 12168*    END-EXEC.
 12169     MOVE LENGTH OF
 12170      CERTIFICATE-MASTER
 12171       TO DFHEIV11
 12172*    MOVE '&& L                  %   #00010443' TO DFHEIV0
 12173     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12174     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12175     MOVE X'2020233030303130343433' TO DFHEIV0(25:11)
 12176     CALL 'kxdfhei1' USING DFHEIV0,
 12177           CERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 229
* EL131.cbl
 12178           CERTIFICATE-MASTER,
 12179           DFHEIV11,
 12180           DFHEIV99
 12181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12182
 12183
 12184 3020-EXIT.
 12185     EXIT.
 12186
 12187 3030-DELETE-CERT.
 12188
 12189* EXEC CICS READ UPDATE
 12190*         DATASET  (CERT-FILE-ID)
 12191*         RIDFLD   (CERT-KEY)
 12192*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12193*    END-EXEC.
 12194*    MOVE '&"S        EU         (   #00010452' TO DFHEIV0
 12195     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12196     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12197     MOVE X'2020233030303130343532' TO DFHEIV0(25:11)
 12198     CALL 'kxdfhei1' USING DFHEIV0,
 12199           CERT-FILE-ID,
 12200           DFHEIV20,
 12201           DFHEIV99,
 12202           CERT-KEY,
 12203           DFHEIV99,
 12204           DFHEIV99,
 12205           DFHEIV99
 12206     SET ADDRESS OF CERTIFICATE-MASTER TO
 12207         DFHEIV20
 12208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12209
 12210
 12211
 12212* EXEC CICS DELETE
 12213*         DATASET   (CERT-FILE-ID)
 12214*    END-EXEC.
 12215*    MOVE '&(                    &   #00010458' TO DFHEIV0
 12216     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12217     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12218     MOVE X'2020233030303130343538' TO DFHEIV0(25:11)
 12219     CALL 'kxdfhei1' USING DFHEIV0,
 12220           CERT-FILE-ID,
 12221           DFHEIV99,
 12222           DFHEIV99,
 12223           DFHEIV99,
 12224           DFHEIV99
 12225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12226
 12227
 12228 3030-EXIT.
 12229     EXIT.
 12230
 12231 3040-DELETE-TRLR.
 12232
 12233* EXEC CICS READ
 12234*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12235*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 230
* EL131.cbl
 12236*         RIDFLD   (TRLR-KEY)
 12237*         GTEQ
 12238*    END-EXEC.
 12239*    MOVE '&"S        G          (   #00010466' TO DFHEIV0
 12240     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12241     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12242     MOVE X'2020233030303130343636' TO DFHEIV0(25:11)
 12243     CALL 'kxdfhei1' USING DFHEIV0,
 12244           TRLR-FILE-ID,
 12245           DFHEIV20,
 12246           DFHEIV99,
 12247           TRLR-KEY,
 12248           DFHEIV99,
 12249           DFHEIV99,
 12250           DFHEIV99
 12251     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12252         DFHEIV20
 12253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12254
 12255
 12256     IF PI-COMPANY-CD = AT-COMPANY-CD
 12257        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 12258        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 12259           GO TO 3040-EXIT
 12260        ELSE
 12261           NEXT SENTENCE
 12262     ELSE
 12263        GO TO 3040-EXIT.
 12264
 12265
 12266* EXEC CICS DELETE
 12267*         DATASET  (TRLR-FILE-ID)
 12268*         RIDFLD   (TRLR-KEY)
 12269*    END-EXEC.
 12270*    MOVE '&(  R                 &   #00010482' TO DFHEIV0
 12271     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12272     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12273     MOVE X'2020233030303130343832' TO DFHEIV0(25:11)
 12274     CALL 'kxdfhei1' USING DFHEIV0,
 12275           TRLR-FILE-ID,
 12276           TRLR-KEY,
 12277           DFHEIV99,
 12278           DFHEIV99,
 12279           DFHEIV99
 12280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12281
 12282
 12283     GO TO 3040-DELETE-TRLR.
 12284
 12285 3040-EXIT.
 12286     EXIT.
 12287
 12288 3050-DELETE-ACTQ.
 12289
 12290* EXEC CICS READNEXT
 12291*         DATASET  (ACTQ-FILE-ID)
 12292*         RIDFLD   (ACTQ-KEY)
 12293*         INTO     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 231
* EL131.cbl
 12294*    END-EXEC.
 12295     MOVE LENGTH OF
 12296      ACTIVITY-QUE
 12297       TO DFHEIV12
 12298     MOVE 0
 12299       TO DFHEIV11
 12300*    MOVE '&.IL                  )   #00010493' TO DFHEIV0
 12301     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12302     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12303     MOVE X'2020233030303130343933' TO DFHEIV0(25:11)
 12304     CALL 'kxdfhei1' USING DFHEIV0,
 12305           ACTQ-FILE-ID,
 12306           ACTIVITY-QUE,
 12307           DFHEIV12,
 12308           ACTQ-KEY,
 12309           DFHEIV99,
 12310           DFHEIV11,
 12311           DFHEIV99,
 12312           DFHEIV99
 12313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12314
 12315
 12316     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 12317         GO TO 3050-EXIT.
 12318
 12319
 12320* EXEC CICS ENDBR
 12321*         DATASET  (ACTQ-FILE-ID)
 12322*    END-EXEC.
 12323     MOVE 0
 12324       TO DFHEIV11
 12325*    MOVE '&2                    $   #00010502' TO DFHEIV0
 12326     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12327     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12328     MOVE X'2020233030303130353032' TO DFHEIV0(25:11)
 12329     CALL 'kxdfhei1' USING DFHEIV0,
 12330           ACTQ-FILE-ID,
 12331           DFHEIV11,
 12332           DFHEIV99
 12333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12334
 12335
 12336
 12337* EXEC CICS DELETE
 12338*         DATASET   (ACTQ-FILE-ID)
 12339*         RIDFLD    (ACTQ-KEY)
 12340*    END-EXEC.
 12341*    MOVE '&(  R                 &   #00010506' TO DFHEIV0
 12342     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12343     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12344     MOVE X'2020233030303130353036' TO DFHEIV0(25:11)
 12345     CALL 'kxdfhei1' USING DFHEIV0,
 12346           ACTQ-FILE-ID,
 12347           ACTQ-KEY,
 12348           DFHEIV99,
 12349           DFHEIV99,
 12350           DFHEIV99
 12351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 232
* EL131.cbl
 12352
 12353
 12354
 12355* EXEC CICS STARTBR
 12356*         DATASET   (ACTQ-FILE-ID)
 12357*         RIDFLD    (ACTQ-KEY)
 12358*    END-EXEC.
 12359     MOVE 0
 12360       TO DFHEIV11
 12361*    MOVE '&,         G          &   #00010511' TO DFHEIV0
 12362     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12363     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12364     MOVE X'2020233030303130353131' TO DFHEIV0(25:11)
 12365     CALL 'kxdfhei1' USING DFHEIV0,
 12366           ACTQ-FILE-ID,
 12367           ACTQ-KEY,
 12368           DFHEIV99,
 12369           DFHEIV11,
 12370           DFHEIV99
 12371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12372
 12373
 12374     GO TO 3050-DELETE-ACTQ.
 12375
 12376 3050-EXIT.
 12377     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 233
* EL131.cbl
 12379 3060-READ-TRLR.
 12380
 12381* EXEC CICS HANDLE CONDITION
 12382*         NOTFND    (3060-EXIT)
 12383*         ENDFILE   (3060-EXIT)
 12384*    END-EXEC.
 12385*    MOVE '"$I''                  ! ? #00010522' TO DFHEIV0
 12386     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12388     MOVE X'3F20233030303130353232' TO DFHEIV0(25:11)
 12389     CALL 'kxdfhei1' USING DFHEIV0
 12390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12391
 12392
 12393 3060-LOOP.
 12394
 12395* EXEC CICS READNEXT
 12396*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12397*         DATASET  (TRLR-FILE-ID)
 12398*         RIDFLD   (TRLR-KEY)
 12399*    END-EXEC.
 12400     MOVE 0
 12401       TO DFHEIV11
 12402*    MOVE '&.S                   )   #00010528' TO DFHEIV0
 12403     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12404     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12405     MOVE X'2020233030303130353238' TO DFHEIV0(25:11)
 12406     CALL 'kxdfhei1' USING DFHEIV0,
 12407           TRLR-FILE-ID,
 12408           DFHEIV20,
 12409           DFHEIV99,
 12410           TRLR-KEY,
 12411           DFHEIV99,
 12412           DFHEIV11,
 12413           DFHEIV99,
 12414           DFHEIV99
 12415     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12416         DFHEIV20
 12417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12418
 12419
 12420     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 12421         GO TO 3060-EXIT.
 12422
 12423     IF FORM-CONTROL-TR
 12424         IF AT-RECORDED-DT = SAVE-BIN-DATE
 12425             NEXT SENTENCE
 12426         ELSE
 12427             MOVE 'X'            TO ERROR-SWITCH
 12428             GO TO 3060-EXIT
 12429     ELSE
 12430         IF PAYMENT-TR OR CORRESPONDENCE-TR
 12431            MOVE 'X'                 TO ERROR-SWITCH
 12432            GO TO 3060-EXIT.
 12433
 12434     GO TO 3060-LOOP.
 12435
 12436 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 234
* EL131.cbl
 12437     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 235
* EL131.cbl
 12439 4000-FORCE-ERRORS.
 12440     IF PI-RETURN-CD-1 = 'X'
 12441         MOVE ER-0311            TO EMI-ERROR
 12442         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12443         MOVE -1                 TO MAINTL
 12444         GO TO 8110-SEND-DATA.
 12445
 12446     IF NOT FORCE-CAP
 12447         MOVE ER-0416            TO EMI-ERROR
 12448         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12449         MOVE -1                 TO MAINTL
 12450         GO TO 8110-SEND-DATA.
 12451
 12452     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 12453     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 12454     IF EMI-FATAL-CTR GREATER THAN ZERO
 12455         GO TO 4000-FATAL-ERRORS.
 12456
 12457     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 12458
 12459     IF EMI-FATAL-CTR GREATER THAN ZERO
 12460         GO TO 4000-FATAL-ERRORS.
 12461
 12462     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 12463
 12464     IF EMI-FATAL-CTR GREATER THAN ZERO
 12465         GO TO 4000-FATAL-ERRORS.
 12466
 12467     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 12468     MOVE AL-UANOF               TO CERTA.
 12469     MOVE ER-0000 TO EMI-ERROR.
 12470     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12471
 12472 4000-FATAL-ERRORS.
 12473     MOVE -1                     TO MAINTL.
 12474     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 236
* EL131.cbl
 12476 5000-BUILD-MAP.
 12477     IF PI-RETURN-CD-1 = SPACE
 12478         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 12479
 12480     MOVE SPACE                  TO PI-RETURN-CD-1.
 12481
 12482     MOVE LOW-VALUES             TO EL131AI.
 12483
 12484     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 12485     MOVE PI-CARRIER             TO CARRIER-CODE.
 12486     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 12487     MOVE PI-CERT-NO             TO CERT-NO.
 12488
 12489 5000-READ-CLAIM-MASTER.
 12490
 12491
 12492* EXEC CICS READ
 12493*         SET      (ADDRESS OF CLAIM-MASTER)
 12494*         DATASET  (CLMS-FILE-ID)
 12495*         RIDFLD   (MSTR-KEY)
 12496*    END-EXEC.
 12497*    MOVE '&"S        E          (   #00010605' TO DFHEIV0
 12498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12500     MOVE X'2020233030303130363035' TO DFHEIV0(25:11)
 12501     CALL 'kxdfhei1' USING DFHEIV0,
 12502           CLMS-FILE-ID,
 12503           DFHEIV20,
 12504           DFHEIV99,
 12505           MSTR-KEY,
 12506           DFHEIV99,
 12507           DFHEIV99,
 12508           DFHEIV99
 12509     SET ADDRESS OF CLAIM-MASTER TO
 12510         DFHEIV20
 12511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12512
 12513
 12514     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 12515
 12516 5000-READ-DIAGNOSIS-TRAILER.
 12517
 12518
 12519* EXEC CICS HANDLE CONDITION
 12520*         NOTFND (5000-TRLR-NOT-FOUND)
 12521*    END-EXEC.
 12522*    MOVE '"$I                   ! @ #00010615' TO DFHEIV0
 12523     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12525     MOVE X'4020233030303130363135' TO DFHEIV0(25:11)
 12526     CALL 'kxdfhei1' USING DFHEIV0
 12527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12528
 12529
 12530     MOVE MSTR-KEY               TO TRLR-KEY.
 12531     MOVE NINETY                 TO TRLR-SEQ-NO.
 12532
 12533
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 237
* EL131.cbl
 12534* EXEC CICS READ
 12535*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12536*         DATASET  (TRLR-FILE-ID)
 12537*         RIDFLD   (TRLR-KEY)
 12538*    END-EXEC.
 12539*    MOVE '&"S        E          (   #00010622' TO DFHEIV0
 12540     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12542     MOVE X'2020233030303130363232' TO DFHEIV0(25:11)
 12543     CALL 'kxdfhei1' USING DFHEIV0,
 12544           TRLR-FILE-ID,
 12545           DFHEIV20,
 12546           DFHEIV99,
 12547           TRLR-KEY,
 12548           DFHEIV99,
 12549           DFHEIV99,
 12550           DFHEIV99
 12551     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12552         DFHEIV20
 12553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12554
 12555
 12556     MOVE AT-INFO-LINE-1         TO DIAGO.
 12557
 12558 5000-READ-CERTIFICATE-MASTER.
 12559
 12560     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 12561     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 12562     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 12563     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 12564     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 12565     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 12566     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 12567
 12568
 12569* EXEC CICS HANDLE CONDITION
 12570*         NOTFND (5000-CERT-NOT-FOUND)
 12571*    END-EXEC.
 12572*    MOVE '"$I                   ! A #00010640' TO DFHEIV0
 12573     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12575     MOVE X'4120233030303130363430' TO DFHEIV0(25:11)
 12576     CALL 'kxdfhei1' USING DFHEIV0
 12577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12578
 12579
 12580
 12581* EXEC CICS READ
 12582*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12583*         DATASET  (CERT-FILE-ID)
 12584*         RIDFLD   (CERT-KEY)
 12585*    END-EXEC.
 12586*    MOVE '&"S        E          (   #00010644' TO DFHEIV0
 12587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12589     MOVE X'2020233030303130363434' TO DFHEIV0(25:11)
 12590     CALL 'kxdfhei1' USING DFHEIV0,
 12591           CERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 238
* EL131.cbl
 12592           DFHEIV20,
 12593           DFHEIV99,
 12594           CERT-KEY,
 12595           DFHEIV99,
 12596           DFHEIV99,
 12597           DFHEIV99
 12598     SET ADDRESS OF CERTIFICATE-MASTER TO
 12599         DFHEIV20
 12600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12601
 12602
 12603     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 12604     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 12605
 12606     GO TO 5000-EXIT.
 12607
 12608 5000-TRLR-NOT-FOUND.
 12609     MOVE ER-7687                TO EMI-ERROR.
 12610     MOVE -1                     TO DIAGL.
 12611     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12612     GO TO 5000-EXIT.
 12613
 12614 5000-CERT-NOT-FOUND.
 12615     MOVE ER-0206                TO EMI-ERROR.
 12616     MOVE -1                     TO CERTL.
 12617     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12618
 12619 5000-EXIT.
 12620     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 239
* EL131.cbl
 12622 5010-RESET-PI-AREA.
 12623     IF CERTI GREATER THAN LOW-VALUES
 12624         MOVE CERTI              TO PI-CERT-PRIME.
 12625
 12626     IF SUFXI GREATER THAN LOW-VALUES
 12627         MOVE SUFXI              TO PI-CERT-SFX.
 12628
 12629     IF CERTEFFI GREATER THAN LOW-VALUES
 12630         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 12631
 12632     IF CERTACTI GREATER THAN LOW-VALUES
 12633         MOVE CERTACTI           TO PI-ACCOUNT.
 12634
 12635     IF CERTSTI GREATER THAN LOW-VALUES
 12636         MOVE CERTSTI            TO PI-STATE.
 12637
 12638     IF CERTCARI GREATER THAN LOW-VALUES
 12639         MOVE CERTCARI           TO PI-CARRIER.
 12640
 12641     IF CERTGRPI GREATER THAN LOW-VALUES
 12642         MOVE CERTGRPI           TO PI-GROUPING.
 12643
 12644 5010-EXIT.
 12645     EXIT.
 12646
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 240
* EL131.cbl
 12648 5020-MOVE-MSTR.
 12649
 12650     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 12651     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 12652     MOVE WS-CLAIM-SEQU          TO SEQUO.
 12653     MOVE AL-SABON               TO SEQUA.
 12654     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 12655     MOVE CL-CLAIM-TYPE          TO TYPEO.
 12656
 12657     IF CL-TOTAL-PAID-AMT  = +0 AND
 12658        CL-LAST-PMT-AMT    = +0 AND
 12659        CL-NO-OF-PMTS-MADE = +0
 12660          MOVE AL-UANON          TO TYPEA.
 12661
 12662     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 12663     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 12664     MOVE CL-CERT-PRIME          TO CERTO.
 12665     MOVE CL-CERT-SFX            TO SUFXO.
 12666     MOVE CL-CERT-CARRIER        TO CARRO.
 12667
 12668     IF CL-CLAIM-STATUS = 'C'
 12669         MOVE 'CLOSED'           TO STATUSO
 12670     ELSE
 12671         MOVE 'OPEN  '           TO STATUSO.
 12672
 12673     MOVE CL-PROCESSOR-ID        TO PROCO.
 12674
 12675     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 12676     MOVE CL-CCN                 TO CCNOO.
 12677
 12678     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 12679     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 12680     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 12681     MOVE CL-INSURED-SEX-CD      TO SEXO.
 12682
 12683     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 12684         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 12685         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12686         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12687         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 12688     ELSE
 12689         MOVE SPACES             TO BIRTHO.
 12690
 12691     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 12692        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 12693         NEXT SENTENCE
 12694       ELSE
 12695         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 12696
 12697     IF PI-COMPANY-ID = 'DMD'
 12698       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 12699          IF SOCIALO = SPACES OR LOW-VALUES
 12700            MOVE ER-0885         TO EMI-ERROR
 12701            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12702
 12703     MOVE CL-INSURED-OCC-CD      TO OCCO.
 12704     MOVE CL-CAUSE-CD            TO CAUSEO.
 12705
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 241
* EL131.cbl
 12706     IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 12707         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 12708         MOVE SPACES                 TO DC-OPTION-CODE
 12709         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12710         MOVE DC-GREG-DATE-1-EDIT TO ENDO
 12711     ELSE
 12712         MOVE SPACES             TO ENDO.
 12713
 12714     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 12715        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 12716        MOVE SPACES             TO DC-OPTION-CODE
 12717        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12718        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 12719        IF PI-USES-PAID-TO
 12720           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 12721           MOVE '6'                TO DC-OPTION-CODE
 12722           MOVE +1                 TO DC-ELAPSED-DAYS
 12723           MOVE +0                 TO DC-ELAPSED-MONTHS
 12724           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12725           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 12726        ELSE
 12727           NEXT SENTENCE
 12728     ELSE
 12729        MOVE SPACES             TO PDTHRUO.
 12730
 12731     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 12732     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 12733     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 12734     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 12735
 12736     IF MODIFY-CAP
 12737        MOVE AL-UNNOF            TO PDAMTA
 12738                                    NODAYSA
 12739                                    NOPMTSA
 12740        MOVE AL-UANOF            TO PDTHRUA.
 12741
 12742     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 12743         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 12744         MOVE SPACES             TO DC-OPTION-CODE
 12745         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12746         MOVE DC-GREG-DATE-1-EDIT TO INCO
 12747     ELSE
 12748         MOVE SPACES             TO INCO.
 12749
 12750     IF CL-NO-OF-PMTS-MADE = ZEROS
 12751        MOVE AL-UANOF            TO INCA.
 12752
 12753     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 12754
 12755     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 12756         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 12757         MOVE SPACES             TO DC-OPTION-CODE
 12758         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12759         MOVE DC-GREG-DATE-1-EDIT TO REPO
 12760     ELSE
 12761         MOVE SPACES             TO REPO.
 12762
 12763     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 242
* EL131.cbl
 12764         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 12765         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12766         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12767         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 12768     ELSE
 12769         MOVE SPACES             TO ESTO.
 12770
 12771     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 12772         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 12773         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12774         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12775         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 12776     ELSE
 12777         MOVE SPACES             TO MNTDTO.
 12778
 12779
 12780     IF CL-LAST-MAINT-TYPE = SPACE
 12781         MOVE 'SET-UP'           TO MNTTYPEO
 12782     ELSE
 12783     IF CL-LAST-MAINT-TYPE = '1'
 12784         MOVE 'PAYMNT'           TO MNTTYPEO
 12785     ELSE
 12786     IF CL-LAST-MAINT-TYPE = '2'
 12787         MOVE 'LETTER'           TO MNTTYPEO
 12788     ELSE
 12789     IF CL-LAST-MAINT-TYPE = '3'
 12790         MOVE 'UPDATE'           TO MNTTYPEO
 12791     ELSE
 12792     IF CL-LAST-MAINT-TYPE = '4'
 12793         MOVE 'RESTOR'           TO MNTTYPEO
 12794     ELSE
 12795     IF CL-LAST-MAINT-TYPE = '5'
 12796         MOVE 'INC DT'           TO MNTTYPEO
 12797     ELSE
 12798     IF CL-LAST-MAINT-TYPE = '6'
 12799         MOVE ' CONV'            TO MNTTYPEO
 12800     ELSE
 12801     IF CL-LAST-MAINT-TYPE = 'C'
 12802         MOVE 'CHGBEN'           TO MNTTYPEO
 12803     ELSE
 12804     IF CL-LAST-MAINT-TYPE = 'E'
 12805         MOVE 'ERRCOR'           TO MNTTYPEO
 12806     ELSE
 12807         MOVE SPACES             TO MNTTYPEO.
 12808
 12809     MOVE CL-BENEFICIARY         TO BENEO.
 12810     MOVE CL-FILE-LOCATION       TO FILETOO.
 12811     MOVE CL-PRIORITY-CD         TO PRICDO.
 12812     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 12813     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 12814     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 12815
 12816 5020-EXIT.
 12817     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 243
* EL131.cbl
 12819 5030-MOVE-CERT.
 12820
 12821     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 12822         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12823         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 12824         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12825         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 12826       ELSE
 12827         MOVE SPACES             TO CERTEFFO
 12828         MOVE ZERO               TO HOLD-DATE.
 12829
 12830     MOVE CM-ACCOUNT             TO CERTACTO.
 12831     MOVE CM-STATE               TO CERTSTO PI-STATE.
 12832     MOVE CM-GROUPING            TO CERTGRPO.
 12833     MOVE CM-CARRIER             TO CERTCARO.
 12834     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 12835     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 12836     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 12837     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 12838     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 12839     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 12840     MOVE CM-JT-INITIAL          TO JNTINITO.
 12841     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 12842
 12843*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 12844     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12845     MOVE '3'                    TO CNTL-REC-TYPE.
 12846     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 12847     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 12848     MOVE ZERO                   TO CNTL-SEQ-NO.
 12849
 12850
 12851* EXEC CICS READ
 12852*         SET        (ADDRESS OF CONTROL-FILE)
 12853*         DATASET    ('ELCNTL')
 12854*         RIDFLD     (CNTL-KEY)
 12855*         RESP       (WS-RESPONSE)
 12856*    END-EXEC.
 12857     MOVE 'ELCNTL' TO DFHEIV1
 12858*    MOVE '&"S        E          (  N#00010897' TO DFHEIV0
 12859     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12860     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12861     MOVE X'204E233030303130383937' TO DFHEIV0(25:11)
 12862     CALL 'kxdfhei1' USING DFHEIV0,
 12863           DFHEIV1,
 12864           DFHEIV20,
 12865           DFHEIV99,
 12866           CNTL-KEY,
 12867           DFHEIV99,
 12868           DFHEIV99,
 12869           DFHEIV99
 12870     SET ADDRESS OF CONTROL-FILE TO
 12871         DFHEIV20
 12872     MOVE EIBRESP  TO WS-RESPONSE
 12873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12874
 12875
 12876     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 244
* EL131.cbl
 12877        MOVE ZERO                TO CP-FREE-LOOK
 12878     ELSE
 12879        MOVE CF-ST-FREE-LOOK-PERIOD
 12880                                 TO CP-FREE-LOOK.
 12881
 12882     IF CM-LF-BENEFIT-CD = '00'
 12883        GO TO 5030-MOVE-CERT-AH.
 12884
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 245
* EL131.cbl
 12886     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 12887     MOVE '5'                    TO DC-OPTION-CODE
 12888     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12889     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 12890     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 12891     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 12892     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 12893     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 12894     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12895     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 12896     MOVE '4'                    TO CP-REM-TERM-METHOD
 12897     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 12898     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12899     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 12900
 12901     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 12902     IF CM-LF-PREMIUM-RATE NUMERIC
 12903         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 12904     ELSE
 12905         MOVE ZEROS              TO LCVRATEO.
 12906
 12907     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 12908         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 12909
 12910     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 12911
 12912     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 12913
 12914     IF CM-LF-CURRENT-STATUS = '8'
 12915        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 12916            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 12917            MOVE ' '             TO DC-OPTION-CODE
 12918            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12919            IF NOT DATE-CONVERSION-ERROR
 12920                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 12921
 12922     IF CM-LF-CURRENT-STATUS = '7'
 12923        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 12924            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 12925            MOVE ' '             TO DC-OPTION-CODE
 12926            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12927            IF NOT DATE-CONVERSION-ERROR
 12928                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 12929
 12930     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 12931         MOVE ' '                TO DC-OPTION-CODE
 12932         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 12933         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12934         IF NOT DATE-CONVERSION-ERROR
 12935             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 12936             MOVE HOLD-MONTH     TO WORK-MONTH
 12937             MOVE HOLD-YEAR      TO WORK-YEAR
 12938             MOVE WORK-DATE-MY   TO LCVEXITO.
 12939
 12940     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 12941        IF CP-REMAINING-TERM-3 = ZEROS
 12942           MOVE 'EXPIRED'        TO LCVSTATO
 12943        ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 246
* EL131.cbl
 12944           MOVE 'ACTIVE'         TO LCVSTATO.
 12945
 12946     IF CM-LF-CURRENT-STATUS = '2'
 12947        MOVE 'PEND   '           TO LCVSTATO.
 12948     IF CM-LF-CURRENT-STATUS = '3'
 12949        MOVE 'RESTORE'           TO LCVSTATO.
 12950     IF CM-LF-CURRENT-STATUS = '5'
 12951        MOVE 'REISSUE'           TO LCVSTATO.
 12952     IF CM-LF-CURRENT-STATUS = '6'
 12953        MOVE 'LMP DIS'           TO LCVSTATO.
 12954     IF CM-LF-CURRENT-STATUS = '7'
 12955        MOVE 'DEATH  '           TO LCVSTATO.
 12956     IF CM-LF-CURRENT-STATUS = '8'
 12957        MOVE 'CANCEL '           TO LCVSTATO.
 12958     IF CM-LF-CURRENT-STATUS = '9'
 12959        MOVE 'RE-ONLY'           TO LCVSTATO.
 12960     IF CM-LF-CURRENT-STATUS = 'V'
 12961        MOVE 'VOID   '           TO LCVSTATO.
 12962     IF CM-LF-CURRENT-STATUS = 'D'
 12963        MOVE 'DECLINE'           TO LCVSTATO.
 12964
 12965     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 12966     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 12967     MOVE '4'                    TO BEN-REC-TYPE.
 12968     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 12969     MOVE ZERO                   TO BEN-SEQ-NO.
 12970
 12971
 12972* EXEC CICS READ GTEQ
 12973*         DATASET  (CNTL-FILE-ID)
 12974*         RIDFLD   (BENEFIT-KEY)
 12975*         SET      (ADDRESS OF CONTROL-FILE)
 12976*    END-EXEC.
 12977*    MOVE '&"S        G          (   #00010999' TO DFHEIV0
 12978     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12979     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12980     MOVE X'2020233030303130393939' TO DFHEIV0(25:11)
 12981     CALL 'kxdfhei1' USING DFHEIV0,
 12982           CNTL-FILE-ID,
 12983           DFHEIV20,
 12984           DFHEIV99,
 12985           BENEFIT-KEY,
 12986           DFHEIV99,
 12987           DFHEIV99,
 12988           DFHEIV99
 12989     SET ADDRESS OF CONTROL-FILE TO
 12990         DFHEIV20
 12991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12992
 12993
 12994     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 12995        CF-RECORD-TYPE NOT = '4'
 12996         MOVE ER-0240            TO EMI-ERROR
 12997         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12998         GO TO 5030-MOVE-CERT-FINISH.
 12999
 13000     MOVE ZERO                   TO COUNT-2.
 13001     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 247
* EL131.cbl
 13002
 13003     IF SCREEN-ERROR
 13004         MOVE ER-0282            TO EMI-ERROR
 13005         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13006        ELSE
 13007         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 13008
 13009 5030-MOVE-CERT-AH.
 13010
 13011     IF CM-LF-BENEFIT-CD = '00'
 13012         IF CM-AH-BENEFIT-CD = '00'
 13013             GO TO 5030-MOVE-CERT-FINISH.
 13014
 13015     IF CM-AH-BENEFIT-CD = '00'
 13016        MOVE SPACES             TO ACVKINDO
 13017        COMPUTE PI-PAYMENT-AMT =
 13018                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 13019        GO TO 5030-MOVE-CERT-FINISH.
 13020
 13021     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13022     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 13023     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 13024     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 13025     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 13026     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13027     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13028     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 13029
 13030**DMD **********************************************
 13031     IF PI-COMPANY-ID = 'DMD'
 13032         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 13033                                   CM-PMT-EXTENSION-DAYS
 13034         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 13035                                      CL-NO-OF-DAYS-PAID
 13036         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 13037             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 13038         MOVE WS-REM-MOS         TO ACVRTRMO
 13039                                    CP-REMAINING-TERM-3
 13040         MOVE WS-REM-DAYS        TO DAYSPO
 13041         GO TO 5030-SKIP-RTRM.
 13042**DMD **********************************************
 13043
 13044     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13045     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13046     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 13047     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13048
 13049 5030-SKIP-RTRM.
 13050     IF CM-AH-PREMIUM-RATE NUMERIC
 13051         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13052     ELSE
 13053         MOVE ZEROS              TO ACVRATEO.
 13054
 13055     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 13056     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 13057
 13058     IF CM-AH-CURRENT-STATUS = '8'
 13059        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 248
* EL131.cbl
 13060            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13061            MOVE ' '             TO DC-OPTION-CODE
 13062            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13063            IF NOT DATE-CONVERSION-ERROR
 13064                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13065
 13066     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13067        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13068            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 13069            MOVE ' '             TO DC-OPTION-CODE
 13070            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13071            IF NOT DATE-CONVERSION-ERROR
 13072                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13073
 13074     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13075        IF CP-REMAINING-TERM-3 = ZEROS
 13076           MOVE 'EXPIRED'        TO ACVSTATO
 13077        ELSE
 13078           MOVE 'ACTIVE'         TO ACVSTATO.
 13079
 13080     IF CM-AH-CURRENT-STATUS = '2'
 13081        MOVE 'PEND   '           TO ACVSTATO.
 13082     IF CM-AH-CURRENT-STATUS = '3'
 13083        MOVE 'RESTORE'           TO ACVSTATO.
 13084     IF CM-AH-CURRENT-STATUS = '5'
 13085        MOVE 'REISSUE'           TO ACVSTATO.
 13086     IF CM-AH-CURRENT-STATUS = '6'
 13087        MOVE 'LMP DIS'           TO ACVSTATO.
 13088     IF CM-AH-CURRENT-STATUS = '7'
 13089        MOVE 'DEATH  '           TO ACVSTATO.
 13090     IF CM-AH-CURRENT-STATUS = '8'
 13091        MOVE 'CANCEL '           TO ACVSTATO.
 13092     IF CM-AH-CURRENT-STATUS = '9'
 13093        MOVE 'RE-ONLY'           TO ACVSTATO.
 13094     IF CM-AH-CURRENT-STATUS = 'V'
 13095        MOVE 'VOID   '           TO ACVSTATO.
 13096     IF CM-AH-CURRENT-STATUS = '9'
 13097        MOVE 'DECLINE'           TO ACVSTATO.
 13098
 13099     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13100         MOVE ' '                TO DC-OPTION-CODE
 13101         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13102         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13103         IF NOT DATE-CONVERSION-ERROR
 13104             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 13105             MOVE HOLD-MONTH     TO WORK-MONTH
 13106             MOVE HOLD-YEAR      TO WORK-YEAR
 13107             MOVE WORK-DATE-MY   TO ACVEXITO.
 13108
 13109     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 13110
 13111     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 13112     MOVE '5'                    TO BEN-REC-TYPE.
 13113     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 13114     MOVE ZERO                   TO BEN-SEQ-NO.
 13115
 13116
 13117* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 249
* EL131.cbl
 13118*         DATASET  (CNTL-FILE-ID)
 13119*         RIDFLD   (BENEFIT-KEY)
 13120*         SET      (ADDRESS OF CONTROL-FILE)
 13121*    END-EXEC.
 13122*    MOVE '&"S        G          (   #00011127' TO DFHEIV0
 13123     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13125     MOVE X'2020233030303131313237' TO DFHEIV0(25:11)
 13126     CALL 'kxdfhei1' USING DFHEIV0,
 13127           CNTL-FILE-ID,
 13128           DFHEIV20,
 13129           DFHEIV99,
 13130           BENEFIT-KEY,
 13131           DFHEIV99,
 13132           DFHEIV99,
 13133           DFHEIV99
 13134     SET ADDRESS OF CONTROL-FILE TO
 13135         DFHEIV20
 13136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13137
 13138
 13139     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 13140        CF-RECORD-TYPE NOT = '5'
 13141         MOVE ER-0250            TO EMI-ERROR
 13142         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13143         GO TO 5030-MOVE-CERT-FINISH.
 13144
 13145     MOVE ZERO                   TO COUNT-2.
 13146     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 13147
 13148     IF SCREEN-ERROR
 13149         MOVE ER-0283            TO EMI-ERROR
 13150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13151       ELSE
 13152         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 13153
 13154 5030-MOVE-CERT-FINISH.
 13155
 13156     MOVE CM-LOAN-APR            TO APRO.
 13157     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 13158     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 13159     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 13160     MOVE CM-LOAN-NUMBER         TO LOANNOO
 13161     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 13162     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 13163
 13164     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 13165         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 13166         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13167         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13168         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 13169     ELSE
 13170         MOVE SPACES               TO ADDONDTO.
 13171
 13172     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 13173
 13174 5030-EXIT.
 13175     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 250
* EL131.cbl
 13177 5040-FIND-BENEFIT.
 13178     ADD 1                       TO COUNT-2.
 13179     IF COUNT-2 GREATER THAN 8
 13180         GO TO 5050-BENEFIT-NOTFND.
 13181
 13182     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 13183         GO TO 5060-EXIT.
 13184
 13185     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 13186         GO TO 5050-BENEFIT-NOTFND.
 13187
 13188     GO TO 5040-FIND-BENEFIT.
 13189
 13190 5050-BENEFIT-NOTFND.
 13191     MOVE 'X'                    TO ERROR-SWITCH.
 13192
 13193 5060-EXIT.
 13194     EXIT.
 13195
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 251
* EL131.cbl
 13197 6000-CALCULATE-CERT-TERM.
 13198
 13199     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 13200         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 13201     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 13202         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 13203     IF CM-LOAN-APR NOT NUMERIC
 13204         MOVE ZEROS              TO CM-LOAN-APR.
 13205
 13206*    IF WS-CALC-METHOD  = 'G'
 13207         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 13208*     ELSE
 13209*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 13210
 13211     IF N GREATER 120
 13212         MOVE 120                TO N.
 13213
 13214     MOVE '6'                    TO DC-OPTION-CODE.
 13215     MOVE N                      TO DC-ELAPSED-MONTHS.
 13216     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13217     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13218
 13219     IF CM-LF-BENEFIT-CD NOT = ZERO
 13220         MOVE N                  TO CM-LF-ORIG-TERM
 13221         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 13222         IF NO-CONVERSION-ERROR
 13223             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 13224
 13225     IF CM-AH-BENEFIT-CD NOT = ZERO
 13226         MOVE N                  TO CM-AH-ORIG-TERM
 13227         IF NO-CONVERSION-ERROR
 13228             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 13229
 13230 6000-EXIT.
 13231      EXIT.
 13232
 13233 6100-CALC-GROSS-TERM.
 13234     MOVE CM-LOAN-BALANCE         TO L.
 13235     MOVE PI-PAYMENT-AMT          TO M.
 13236
 13237     COMPUTE N = L / M.
 13238     IF N LESS 1
 13239         MOVE 1  TO N.
 13240
 13241     IF CM-LF-BENEFIT-CD NOT = ZERO
 13242         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 13243     ELSE
 13244         MOVE ZEROS               TO WS-LF-RATE.
 13245
 13246     IF CM-AH-BENEFIT-CD NOT = ZERO
 13247         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 13248     ELSE
 13249         MOVE ZEROS               TO WS-AH-RATE.
 13250
 13251     COMPUTE I = CM-LOAN-APR / +1200.
 13252
 13253 6105-LOOP.
 13254     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 252
* EL131.cbl
 13255         GO TO 6200-EXIT.
 13256     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 13257     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 13258         ADD 1 TO N
 13259         GO TO 6105-LOOP.
 13260
 13261 6200-EXIT.
 13262      EXIT.
 13263
 13264 6210-CALC-LEFT-RIGHTONE.
 13265      MOVE L         TO LEFT-TOT-1.
 13266      SUBTRACT 1 FROM N.
 13267      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 13268      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 13269      ADD 1 TO N.
 13270 6211-CALC-TERM1.
 13271      MOVE N         TO TERM1.
 13272      MULTIPLY M BY TERM1.
 13273 6212-LOOP.
 13274      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 13275      ADD 1 TO A-N.
 13276      MULTIPLY A-N BY TERM1.
 13277      SUBTRACT 1 FROM A-N.
 13278      ADD TERM1 TO LEFT-TOT-1.
 13279 6213-CALC-TERM2.
 13280      MOVE M         TO TERM2.
 13281      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 13282      MULTIPLY IA-N BY TERM2.
 13283      SUBTRACT TERM2 FROM LEFT-TOT-1.
 13284 6215-CALC-RIGHTONE.
 13285      MOVE M         TO RIGHT-TOT-1.
 13286      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 13287      MULTIPLY A-N BY RIGHT-TOT-1.
 13288 6220-EXIT.
 13289      EXIT.
 13290
 13291 6300-CALC-A-N.
 13292     IF N LESS 1
 13293         MOVE 0     TO A-N
 13294         GO TO 6300-EXIT.
 13295     IF I = 0
 13296         MOVE .00001 TO I.
 13297     ADD 1 TO I.
 13298     DIVIDE I INTO 1 GIVING V.
 13299     SUBTRACT 1 FROM I.
 13300     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 13301     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 13302     DIVIDE I INTO TERM3 GIVING A-N.
 13303 6300-EXIT.
 13304      EXIT.
 13305
 13306 6350-CALC-IA-N.
 13307     IF N LESS 1
 13308         MOVE 0      TO IA-N
 13309         GO TO 6400-EXIT.
 13310     ADD 1 TO N.
 13311     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 13312     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 253
* EL131.cbl
 13313     MULTIPLY N BY V-EX-N GIVING TERM3.
 13314     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 13315     SUBTRACT V FROM 1 GIVING TERM4.
 13316     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 13317 6400-EXIT.
 13318      EXIT.
 13319
 13320 6450-CALC-V-EX-N.
 13321     IF N LESS 1
 13322         MOVE 1    TO V-EX-N
 13323         GO TO 6490-EXIT.
 13324     MOVE N        TO NV-STORE.
 13325     IF V-EX-ONETIME = 1  OR
 13326        V NOT = V-EXPONENT (1)
 13327          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 13328 6460-LOOP.
 13329     IF N GREATER 248
 13330         MOVE 248 TO N.
 13331     IF N = 1
 13332         MOVE V               TO V-EX-N
 13333      ELSE
 13334         MOVE V-EXPONENT (N)  TO V-EX-N.
 13335     GO TO 6490-EXIT.
 13336
 13337 6470-BUILD-V-EX-TABLE.
 13338     MOVE 2      TO N.
 13339     MOVE V      TO V-EXPONENT (1)
 13340                    V-EX-N.
 13341 6471-LOOP.
 13342     MULTIPLY V BY V-EX-N.
 13343     MOVE V-EX-N   TO V-EXPONENT (N).
 13344     ADD 1 TO N.
 13345     IF N LESS 248
 13346         GO TO 6471-LOOP.
 13347     MOVE NV-STORE     TO N.
 13348     MOVE 0            TO V-EX-ONETIME.
 13349 6480-EXIT.
 13350      EXIT.
 13351
 13352 6490-EXIT.
 13353      EXIT.
 13354
 13355 6500-CALC-NET-TERM.
 13356     MOVE CM-LOAN-BALANCE         TO L.
 13357     MOVE PI-PAYMENT-AMT          TO M.
 13358
 13359     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 13360     IF WS-REMAIN GREATER ZERO
 13361         ADD 1 TO N.
 13362     IF N = 0
 13363         MOVE 1 TO N.
 13364
 13365 6700-EXIT.
 13366      EXIT.
 13367
 13368 6999-CALC-TERM-EXIT.
 13369     EXIT.
 13370
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 254
* EL131.cbl
 13372 7000-RESET-ATTRIBUTE.
 13373
 13374     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 13375                                    CERTSTA   CERTCARA
 13376                                    CERTGRPA.
 13377     MOVE -1                     TO CERTCARL.
 13378
 13379 7000-EXIT.
 13380     EXIT.
 13381
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 255
* EL131.cbl
 13383 7600-BROWSE-CLAIM.
 13384
 13385
 13386* EXEC CICS READ
 13387*        DATASET(CLMS-FILE-ID)
 13388*        SET    (ADDRESS OF CLAIM-MASTER)
 13389*        RIDFLD (MSTR-KEY)
 13390*        GENERIC
 13391*        EQUAL
 13392*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 13393*    END-EXEC.
 13394*    MOVE '&"S  KG    E          (   #00011379' TO DFHEIV0
 13395     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 13396     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13397     MOVE X'2020233030303131333739' TO DFHEIV0(25:11)
 13398     CALL 'kxdfhei1' USING DFHEIV0,
 13399           CLMS-FILE-ID,
 13400           DFHEIV20,
 13401           DFHEIV99,
 13402           MSTR-KEY,
 13403           ELMSTR-GENERIC-LENGTH,
 13404           DFHEIV99,
 13405           DFHEIV99
 13406     SET ADDRESS OF CLAIM-MASTER TO
 13407         DFHEIV20
 13408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13409
 13410
 13411     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 13412
 13413     if cl-assoc-cert-total = 0
 13414        move 1 to cl-assoc-cert-total
 13415     end-if
 13416     IF CL-ASSOC-CERT-SEQU = 0
 13417        MOVE 1 TO CL-ASSOC-CERT-SEQU
 13418     END-IF
 13419
 13420     IF CL-ASSOC-CERT-TOTAL = 1
 13421         MOVE AL-SADOF           TO BCERT1A
 13422                                    BSUFX1A
 13423                                    BCERT2A
 13424                                    BSUFX2A
 13425                                    BCERT3A
 13426                                    BSUFX3A
 13427                                    BCERT4A
 13428                                    BSUFX4A
 13429                                    BCERT5A
 13430                                    BSUFX5A
 13431                                    PCERTNOA
 13432                                    PSUFXA
 13433                                    LABEL1A
 13434                                    LABEL2A
 13435         GO TO 7699-EXIT.
 13436
 13437 7610-BROWSE-CLAIM-LOOP.
 13438
 13439     MOVE LOW-VALUES             TO BCERT1O
 13440                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 256
* EL131.cbl
 13441                                    BCERT2O
 13442                                    BSUFX2O
 13443                                    BCERT3O
 13444                                    BSUFX3O
 13445                                    BCERT4O
 13446                                    BSUFX4O
 13447                                    BCERT5O
 13448                                    BSUFX5O.
 13449
 13450
 13451* EXEC CICS HANDLE CONDITION
 13452*        ENDFILE  (7630-END-BROWSE)
 13453*    END-EXEC.
 13454*    MOVE '"$''                   ! B #00011427' TO DFHEIV0
 13455     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13457     MOVE X'4220233030303131343237' TO DFHEIV0(25:11)
 13458     CALL 'kxdfhei1' USING DFHEIV0
 13459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13460
 13461
 13462
 13463* EXEC CICS STARTBR
 13464*        DATASET    (CLMS-FILE-ID)
 13465*        RIDFLD     (MSTR-KEY)
 13466*    END-EXEC.
 13467     MOVE 0
 13468       TO DFHEIV11
 13469*    MOVE '&,         G          &   #00011431' TO DFHEIV0
 13470     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13471     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13472     MOVE X'2020233030303131343331' TO DFHEIV0(25:11)
 13473     CALL 'kxdfhei1' USING DFHEIV0,
 13474           CLMS-FILE-ID,
 13475           MSTR-KEY,
 13476           DFHEIV99,
 13477           DFHEIV11,
 13478           DFHEIV99
 13479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13480
 13481
 13482     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 13483
 13484 7620-READ-CLAIM-LOOP.
 13485
 13486
 13487* EXEC CICS READNEXT
 13488*        DATASET   (CLMS-FILE-ID)
 13489*        SET       (ADDRESS OF CLAIM-MASTER)
 13490*        RIDFLD    (MSTR-KEY)
 13491*    END-EXEC.
 13492     MOVE 0
 13493       TO DFHEIV11
 13494*    MOVE '&.S                   )   #00011440' TO DFHEIV0
 13495     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13496     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13497     MOVE X'2020233030303131343430' TO DFHEIV0(25:11)
 13498     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 257
* EL131.cbl
 13499           CLMS-FILE-ID,
 13500           DFHEIV20,
 13501           DFHEIV99,
 13502           MSTR-KEY,
 13503           DFHEIV99,
 13504           DFHEIV11,
 13505           DFHEIV99,
 13506           DFHEIV99
 13507     SET ADDRESS OF CLAIM-MASTER TO
 13508         DFHEIV20
 13509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13510
 13511
 13512     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 13513        CL-CARRIER     NOT = CARRI           OR
 13514        CL-CLAIM-NO    NOT = CLAIMI
 13515        GO TO 7630-END-BROWSE.
 13516
 13517     IF WS-ASSOCIATED-CERTS = 1
 13518         MOVE CL-CERT-PRIME      TO BCERT1O
 13519         MOVE CL-CERT-SFX        TO BSUFX1O.
 13520
 13521     IF WS-ASSOCIATED-CERTS = 2
 13522         MOVE CL-CERT-PRIME      TO BCERT2O
 13523         MOVE CL-CERT-SFX        TO BSUFX2O.
 13524
 13525     IF WS-ASSOCIATED-CERTS = 3
 13526         MOVE CL-CERT-PRIME      TO BCERT3O
 13527         MOVE CL-CERT-SFX        TO BSUFX3O.
 13528
 13529     IF WS-ASSOCIATED-CERTS = 4
 13530         MOVE CL-CERT-PRIME      TO BCERT4O
 13531         MOVE CL-CERT-SFX        TO BSUFX4O.
 13532
 13533     IF WS-ASSOCIATED-CERTS = 5
 13534         MOVE CL-CERT-PRIME      TO BCERT5O
 13535         MOVE CL-CERT-SFX        TO BSUFX5O
 13536     ELSE
 13537         ADD +1                  TO WS-ASSOCIATED-CERTS
 13538         GO TO 7620-READ-CLAIM-LOOP.
 13539
 13540 7630-END-BROWSE.
 13541
 13542
 13543* EXEC CICS ENDBR
 13544*        DATASET   (CLMS-FILE-ID)
 13545*    END-EXEC.
 13546     MOVE 0
 13547       TO DFHEIV11
 13548*    MOVE '&2                    $   #00011476' TO DFHEIV0
 13549     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13550     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13551     MOVE X'2020233030303131343736' TO DFHEIV0(25:11)
 13552     CALL 'kxdfhei1' USING DFHEIV0,
 13553           CLMS-FILE-ID,
 13554           DFHEIV11,
 13555           DFHEIV99
 13556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 258
* EL131.cbl
 13557
 13558
 13559 7640-HIGHLIGHT-CERT-DISPLAYED.
 13560
 13561     MOVE AL-SANON               TO BCERT1A
 13562                                    BSUFX1A
 13563                                    BCERT2A
 13564                                    BSUFX2A
 13565                                    BCERT3A
 13566                                    BSUFX3A
 13567                                    BCERT4A
 13568                                    BSUFX4A
 13569                                    BCERT5A
 13570                                    BSUFX5A.
 13571
 13572     IF BCERT1O = CERTI AND
 13573        BSUFX1O = SUFXI
 13574            MOVE AL-SABON        TO BCERT1A
 13575                                    BSUFX1A.
 13576
 13577     IF BCERT2O = CERTI AND
 13578        BSUFX2O = SUFXI
 13579            MOVE AL-SABON        TO BCERT2A
 13580                                    BSUFX2A.
 13581
 13582     IF BCERT3O = CERTI AND
 13583        BSUFX3O = SUFXI
 13584            MOVE AL-SABON        TO BCERT3A
 13585                                    BSUFX3A.
 13586
 13587     IF BCERT4O = CERTI AND
 13588        BSUFX4O = SUFXI
 13589            MOVE AL-SABON        TO BCERT4A
 13590                                    BSUFX4A.
 13591
 13592     IF BCERT5O = CERTI AND
 13593        BSUFX5O = SUFXI
 13594            MOVE AL-SABON        TO BCERT5A
 13595                                    BSUFX5A.
 13596
 13597 7699-EXIT.
 13598     EXIT.
 13599
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 259
* EL131.cbl
 13601 7700-CHECK-SEQUENCE.
 13602
 13603
 13604* EXEC CICS HANDLE CONDITION
 13605*        ENDFILE  (7799-EXIT)
 13606*        NOTFND   (7799-EXIT)
 13607*    END-EXEC.
 13608*    MOVE '"$''I                  ! C #00011524' TO DFHEIV0
 13609     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 13610     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13611     MOVE X'4320233030303131353234' TO DFHEIV0(25:11)
 13612     CALL 'kxdfhei1' USING DFHEIV0
 13613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13614
 13615
 13616
 13617* EXEC CICS READ
 13618*        DATASET(CLMS-FILE-ID)
 13619*        SET    (ADDRESS OF CLAIM-MASTER)
 13620*        RIDFLD (MSTR-KEY)
 13621*        GENERIC
 13622*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 13623*    END-EXEC.
 13624*    MOVE '&"S  KG    E          (   #00011529' TO DFHEIV0
 13625     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 13626     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13627     MOVE X'2020233030303131353239' TO DFHEIV0(25:11)
 13628     CALL 'kxdfhei1' USING DFHEIV0,
 13629           CLMS-FILE-ID,
 13630           DFHEIV20,
 13631           DFHEIV99,
 13632           MSTR-KEY,
 13633           ELMSTR-GENERIC-LENGTH,
 13634           DFHEIV99,
 13635           DFHEIV99
 13636     SET ADDRESS OF CLAIM-MASTER TO
 13637         DFHEIV20
 13638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13639
 13640
 13641     COMPUTE WS-ASSOC-CERT-TOTAL =
 13642             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 13643
 13644     GO TO 7799-EXIT.
 13645
 13646 7710-RESEQUENCE-CLAIMS.
 13647
 13648
 13649* EXEC CICS HANDLE CONDITION
 13650*        ENDFILE  (7799-EXIT)
 13651*    END-EXEC.
 13652*    MOVE '"$''                   ! D #00011544' TO DFHEIV0
 13653     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13655     MOVE X'4420233030303131353434' TO DFHEIV0(25:11)
 13656     CALL 'kxdfhei1' USING DFHEIV0
 13657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13658
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 260
* EL131.cbl
 13659
 13660
 13661* EXEC CICS STARTBR
 13662*        DATASET(CLMS-FILE-ID)
 13663*        RIDFLD (MSTR-KEY)
 13664*    END-EXEC.
 13665     MOVE 0
 13666       TO DFHEIV11
 13667*    MOVE '&,         G          &   #00011548' TO DFHEIV0
 13668     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13669     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13670     MOVE X'2020233030303131353438' TO DFHEIV0(25:11)
 13671     CALL 'kxdfhei1' USING DFHEIV0,
 13672           CLMS-FILE-ID,
 13673           MSTR-KEY,
 13674           DFHEIV99,
 13675           DFHEIV11,
 13676           DFHEIV99
 13677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13678
 13679
 13680     COMPUTE WS-ASSOC-CERT-SEQU =
 13681             WS-ASSOC-CERT-SEQU + 1.
 13682
 13683     COMPUTE WS-READNEXT-SWITCH =
 13684             WS-READNEXT-SWITCH + 1.
 13685
 13686 7720-READ-CLAIM-LOOP.
 13687
 13688
 13689* EXEC CICS READNEXT
 13690*        DATASET(CLMS-FILE-ID)
 13691*        SET    (ADDRESS OF CLAIM-MASTER)
 13692*        RIDFLD (MSTR-KEY)
 13693*    END-EXEC.
 13694     MOVE 0
 13695       TO DFHEIV11
 13696*    MOVE '&.S                   )   #00011561' TO DFHEIV0
 13697     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13698     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13699     MOVE X'2020233030303131353631' TO DFHEIV0(25:11)
 13700     CALL 'kxdfhei1' USING DFHEIV0,
 13701           CLMS-FILE-ID,
 13702           DFHEIV20,
 13703           DFHEIV99,
 13704           MSTR-KEY,
 13705           DFHEIV99,
 13706           DFHEIV11,
 13707           DFHEIV99,
 13708           DFHEIV99
 13709     SET ADDRESS OF CLAIM-MASTER TO
 13710         DFHEIV20
 13711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13712
 13713
 13714     IF WS-READNEXT-SWITCH = 1
 13715         ADD 1                   TO WS-READNEXT-SWITCH
 13716         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 261
* EL131.cbl
 13717
 13718 7730-END-BROWSE.
 13719
 13720
 13721* EXEC CICS ENDBR
 13722*        DATASET(CLMS-FILE-ID)
 13723*    END-EXEC.
 13724     MOVE 0
 13725       TO DFHEIV11
 13726*    MOVE '&2                    $   #00011573' TO DFHEIV0
 13727     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13728     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13729     MOVE X'2020233030303131353733' TO DFHEIV0(25:11)
 13730     CALL 'kxdfhei1' USING DFHEIV0,
 13731           CLMS-FILE-ID,
 13732           DFHEIV11,
 13733           DFHEIV99
 13734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13735
 13736
 13737 7740-READ-CLAIM-UPDATE.
 13738
 13739     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 13740        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 13741        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 13742        GO TO 7799-EXIT
 13743     ELSE
 13744        MOVE ZERO                TO WS-READNEXT-SWITCH.
 13745
 13746
 13747* EXEC CICS READ
 13748*        DATASET(CLMS-FILE-ID)
 13749*        SET    (ADDRESS OF CLAIM-MASTER)
 13750*        RIDFLD (MSTR-KEY)
 13751*        UPDATE
 13752*    END-EXEC.
 13753*    MOVE '&"S        EU         (   #00011586' TO DFHEIV0
 13754     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13755     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13756     MOVE X'2020233030303131353836' TO DFHEIV0(25:11)
 13757     CALL 'kxdfhei1' USING DFHEIV0,
 13758           CLMS-FILE-ID,
 13759           DFHEIV20,
 13760           DFHEIV99,
 13761           MSTR-KEY,
 13762           DFHEIV99,
 13763           DFHEIV99,
 13764           DFHEIV99
 13765     SET ADDRESS OF CLAIM-MASTER TO
 13766         DFHEIV20
 13767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13768
 13769
 13770     if (cl-priority-cd = '8')
 13771        and (pi-processor-id not = 'PEMA' and 'JMS '
 13772             AND 'AMWA')
 13773        MOVE ER-8003             TO EMI-ERROR
 13774        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 262
* EL131.cbl
 13775                                 THRU 9900-EXIT
 13776        MOVE -1                  TO MAINTL
 13777        GO TO 8110-SEND-DATA
 13778     end-if
 13779
 13780     IF PI-COMPANY-ID = 'CID' or 'AHL'
 13781         MOVE 'Y'                TO CL-YESNOSW
 13782     END-IF.
 13783
 13784     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 13785     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 13786
 13787
 13788* EXEC CICS REWRITE
 13789*         DATASET(CLMS-FILE-ID)
 13790*         FROM   (CLAIM-MASTER)
 13791*    END-EXEC.
 13792     MOVE LENGTH OF
 13793      CLAIM-MASTER
 13794       TO DFHEIV11
 13795*    MOVE '&& L                  %   #00011610' TO DFHEIV0
 13796     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13797     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13798     MOVE X'2020233030303131363130' TO DFHEIV0(25:11)
 13799     CALL 'kxdfhei1' USING DFHEIV0,
 13800           CLMS-FILE-ID,
 13801           CLAIM-MASTER,
 13802           DFHEIV11,
 13803           DFHEIV99
 13804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13805
 13806
 13807     GO TO 7710-RESEQUENCE-CLAIMS.
 13808
 13809 7799-EXIT.
 13810     EXIT.
 13811
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 263
* EL131.cbl
 13813 7800-CHECK-AUTO-ACTIVITY.
 13814
 13815
 13816* EXEC CICS HANDLE CONDITION
 13817*        NOTFND   (7800-NOT-FOUND)
 13818*    END-EXEC.
 13819*    MOVE '"$I                   ! E #00011623' TO DFHEIV0
 13820     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13821     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13822     MOVE X'4520233030303131363233' TO DFHEIV0(25:11)
 13823     CALL 'kxdfhei1' USING DFHEIV0
 13824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13825
 13826
 13827     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 13828     MOVE 'T'                        TO  CNTL-REC-TYPE.
 13829     MOVE SPACES                     TO  CNTL-PROC-ID.
 13830     MOVE +0                         TO  CNTL-SEQ-NO.
 13831
 13832
 13833* EXEC CICS READ
 13834*        DATASET   (CNTL-FILE-ID)
 13835*        RIDFLD    (CNTL-KEY)
 13836*        SET       (ADDRESS OF CONTROL-FILE)
 13837*    END-EXEC.
 13838*    MOVE '&"S        E          (   #00011632' TO DFHEIV0
 13839     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13841     MOVE X'2020233030303131363332' TO DFHEIV0(25:11)
 13842     CALL 'kxdfhei1' USING DFHEIV0,
 13843           CNTL-FILE-ID,
 13844           DFHEIV20,
 13845           DFHEIV99,
 13846           CNTL-KEY,
 13847           DFHEIV99,
 13848           DFHEIV99,
 13849           DFHEIV99
 13850     SET ADDRESS OF CONTROL-FILE TO
 13851         DFHEIV20
 13852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13853
 13854
 13855     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 13856         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 13857
 13858     IF CL-ACTIVITY-CODE NOT = ZEROS
 13859         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 13860         IF MISC-SUB IS GREATER THAN +9
 13861             SUBTRACT +9 FROM MISC-SUB
 13862             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 13863         ELSE
 13864             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 13865     ELSE
 13866         MOVE 'Y'                              TO  WS-RESET-SW.
 13867
 13868     IF STATUSI = 'C' OR 'CLOSED'
 13869         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 13870             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 264
* EL131.cbl
 13871                                         PI-LETTER-SW
 13872             GO TO 7800-EXIT.
 13873
 13874     IF STATUSI = 'C' OR 'CLOSED'
 13875         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 13876             MOVE 'N'                TO  PI-LETTER-SW
 13877         ELSE
 13878             MOVE 'Y'                TO  PI-LETTER-SW.
 13879
 13880     IF STATUSI = 'O' OR 'OPEN'
 13881         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 13882             MOVE 'N'                TO  PI-REC-FOUND-SW
 13883                                         PI-LETTER-SW
 13884             GO TO 7800-EXIT.
 13885
 13886     IF STATUSI = 'O' OR 'OPEN'
 13887         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 13888             MOVE 'N'                TO  PI-LETTER-SW
 13889         ELSE
 13890             MOVE 'Y'                TO  PI-LETTER-SW.
 13891
 13892     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 13893     GO TO 7800-EXIT.
 13894
 13895 7800-NOT-FOUND.
 13896
 13897     MOVE 'N'                        TO  PI-REC-FOUND-SW
 13898                                         PI-LETTER-SW.
 13899
 13900 7800-EXIT.
 13901     EXIT.
 13902
 13903 7850-AUTO-LETTER-WRITER.
 13904
 13905     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 13906     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 13907
 13908     IF STATUSI = 'C' OR 'CLOSED'
 13909         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 13910     ELSE
 13911         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 13912
 13913     IF STATUSI = 'C' OR 'CLOSED'
 13914         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 13915             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13916             MOVE '6'                TO  DC-OPTION-CODE
 13917             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 13918             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13919             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13920             IF NO-CONVERSION-ERROR
 13921                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 13922             ELSE
 13923                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 13924
 13925     IF STATUSI = 'C' OR 'CLOSED'
 13926         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 13927             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13928             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 265
* EL131.cbl
 13929             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 13930             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13931             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13932             IF NO-CONVERSION-ERROR
 13933                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 13934             ELSE
 13935                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 13936
 13937     IF STATUSI = 'O' OR 'OPEN'
 13938         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 13939             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13940             MOVE '6'                TO  DC-OPTION-CODE
 13941             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 13942             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13943             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13944             IF NO-CONVERSION-ERROR
 13945                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 13946             ELSE
 13947                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 13948
 13949     IF STATUSI = 'O' OR 'OPEN'
 13950         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 13951             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 13952             MOVE '6'                TO  DC-OPTION-CODE
 13953             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 13954             MOVE +0                 TO  DC-ELAPSED-MONTHS
 13955             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13956             IF NO-CONVERSION-ERROR
 13957                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 13958             ELSE
 13959                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 13960
 13961
 13962* EXEC CICS LINK
 13963*        PROGRAM    (LINK-1523)
 13964*        COMMAREA   (W-1523-LINKDATA)
 13965*        LENGTH     (W-1523-COMM-LENGTH)
 13966*    END-EXEC.
 13967*    MOVE '."C                   ''   #00011744' TO DFHEIV0
 13968     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13969     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13970     MOVE X'2020233030303131373434' TO DFHEIV0(25:11)
 13971     CALL 'kxdfhei1' USING DFHEIV0,
 13972           LINK-1523,
 13973           W-1523-LINKDATA,
 13974           W-1523-COMM-LENGTH,
 13975           DFHEIV99,
 13976           DFHEIV99,
 13977           DFHEIV99
 13978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13979
 13980
 13981     IF W-1523-ERROR-CODE = ZEROS
 13982         GO TO 7850-EXIT.
 13983
 13984     IF W-1523-FATAL-ERROR
 13985         MOVE ER-0802                TO  EMI-ERROR
 13986         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 266
* EL131.cbl
 13987
 13988     IF W-1523-ERROR-CODE = 0191
 13989         MOVE ER-0803                TO  EMI-ERROR
 13990         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13991
 13992 7850-EXIT.
 13993     EXIT.
 13994
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 267
* EL131.cbl
 13996 8000-CREATE-DMO-REC.
 13997     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 13998     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 13999     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 14000
 14001
 14002* EXEC CICS HANDLE CONDITION
 14003*         NOTFND   (8000-NOTE-NOT-FOUND)
 14004*    END-EXEC.
 14005*    MOVE '"$I                   ! F #00011770' TO DFHEIV0
 14006     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14007     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14008     MOVE X'4620233030303131373730' TO DFHEIV0(25:11)
 14009     CALL 'kxdfhei1' USING DFHEIV0
 14010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14011
 14012
 14013
 14014* EXEC CICS READ
 14015*         DATASET(NOTE-FILE-ID)
 14016*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14017*         RIDFLD (NOTE-KEY)
 14018*    END-EXEC.
 14019*    MOVE '&"S        E          (   #00011774' TO DFHEIV0
 14020     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14021     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14022     MOVE X'2020233030303131373734' TO DFHEIV0(25:11)
 14023     CALL 'kxdfhei1' USING DFHEIV0,
 14024           NOTE-FILE-ID,
 14025           DFHEIV20,
 14026           DFHEIV99,
 14027           NOTE-KEY,
 14028           DFHEIV99,
 14029           DFHEIV99,
 14030           DFHEIV99
 14031     SET ADDRESS OF CERTIFICATE-NOTE TO
 14032         DFHEIV20
 14033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14034
 14035
 14036     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14037     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14038     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14039
 14040     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 14041         MOVE 'CC'               TO DCT-PRODUCT-CODE
 14042     ELSE
 14043         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14044
 14045     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14046     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14047
 14048
 14049* EXEC CICS LINK
 14050*        PROGRAM    ('DLO006')
 14051*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14052*        LENGTH     (WS-DCT-LENGTH)
 14053*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 268
* EL131.cbl
 14054     MOVE 'DLO006' TO DFHEIV1
 14055*    MOVE '."C                   ''   #00011792' TO DFHEIV0
 14056     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14057     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14058     MOVE X'2020233030303131373932' TO DFHEIV0(25:11)
 14059     CALL 'kxdfhei1' USING DFHEIV0,
 14060           DFHEIV1,
 14061           DCT-COMMUNICATION-AREA,
 14062           WS-DCT-LENGTH,
 14063           DFHEIV99,
 14064           DFHEIV99,
 14065           DFHEIV99
 14066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14067
 14068
 14069     IF  DCT-RETURN-CODE = 'OK'
 14070         GO TO 8000-CONT.
 14071
 14072     IF DCT-RETURN-CODE = '01' OR '02'
 14073         GO TO 8000-EXIT.
 14074
 14075     IF DCT-RETURN-CODE = '03'
 14076         MOVE ER-0951            TO EMI-ERROR
 14077         MOVE -1                 TO MAINTL
 14078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14079         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14080         GO TO 8110-SEND-DATA.
 14081
 14082     IF DCT-RETURN-CODE = '04'
 14083         MOVE ER-0946            TO EMI-ERROR
 14084         MOVE -1                 TO MAINTL
 14085         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14086         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14087         GO TO 8110-SEND-DATA.
 14088
 14089     IF DCT-RETURN-CODE = '05'
 14090         MOVE ER-0947            TO EMI-ERROR
 14091         MOVE -1                 TO MAINTL
 14092         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14093         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14094         GO TO 8110-SEND-DATA.
 14095
 14096     IF DCT-RETURN-CODE = '06'
 14097         MOVE ER-0921            TO EMI-ERROR
 14098         MOVE -1                 TO MAINTL
 14099         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14100         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14101         GO TO 8110-SEND-DATA.
 14102
 14103     IF DCT-RETURN-CODE = '07'
 14104         MOVE ER-0919            TO EMI-ERROR
 14105         MOVE -1                 TO MAINTL
 14106         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14107         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14108         GO TO 8110-SEND-DATA.
 14109
 14110     IF DCT-RETURN-CODE = '08'
 14111         MOVE ER-0948            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 269
* EL131.cbl
 14112         MOVE -1                 TO MAINTL
 14113         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14114         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14115         GO TO 8110-SEND-DATA.
 14116
 14117     IF DCT-RETURN-CODE = 'N1'
 14118         MOVE ER-0950            TO EMI-ERROR
 14119         MOVE -1                 TO MAINTL
 14120         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14121         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14122         GO TO 8110-SEND-DATA.
 14123
 14124     IF DCT-RETURN-CODE = 'E1'
 14125         MOVE ER-0974            TO EMI-ERROR
 14126         MOVE -1                 TO MAINTL
 14127         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14128         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14129         GO TO 8110-SEND-DATA.
 14130
 14131     IF DCT-RETURN-CODE = 'E2'
 14132         MOVE ER-0975            TO EMI-ERROR
 14133         MOVE -1                 TO MAINTL
 14134         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14135         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14136         GO TO 8110-SEND-DATA.
 14137
 14138     IF DCT-RETURN-CODE NOT = 'OK'
 14139         MOVE ER-0949            TO EMI-ERROR
 14140         MOVE -1                 TO MAINTL
 14141         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14142         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14143         GO TO 8110-SEND-DATA.
 14144
 14145 8000-CONT.
 14146
 14147     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14148     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14149     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14150     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14151     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14152     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14153     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14154     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14155
 14156     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14157     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14158     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14159     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 14160     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14161
 14162     IF STATUSI = 'OPEN' OR 'O'
 14163         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 14164      ELSE
 14165         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 14166
 14167     IF STATUSI = 'OPEN' OR 'O'
 14168        IF CL-NO-OF-PMTS-MADE = 0
 14169         MOVE '1'                TO DM-CLAIM-STATUS
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 270
* EL131.cbl
 14170      ELSE
 14171         MOVE '2'                TO DM-CLAIM-STATUS.
 14172
 14173     IF STATUSI = 'CLOSED' OR 'C'
 14174        IF NOT FINAL-PAID
 14175         MOVE '3'                TO DM-CLAIM-STATUS
 14176      ELSE
 14177         MOVE '4'                TO DM-CLAIM-STATUS.
 14178
 14179     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14180
 14181
 14182* EXEC CICS LINK
 14183*        PROGRAM    ('DLO025')
 14184*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14185*        LENGTH     (WS-DMO-LENGTH)
 14186*    END-EXEC.
 14187     MOVE 'DLO025' TO DFHEIV1
 14188*    MOVE '."C                   ''   #00011910' TO DFHEIV0
 14189     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14190     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14191     MOVE X'2020233030303131393130' TO DFHEIV0(25:11)
 14192     CALL 'kxdfhei1' USING DFHEIV0,
 14193           DFHEIV1,
 14194           DMO-COMMUNICATION-AREA,
 14195           WS-DMO-LENGTH,
 14196           DFHEIV99,
 14197           DFHEIV99,
 14198           DFHEIV99
 14199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14200
 14201
 14202     IF  DM-RETURN-CODE = 'OK'
 14203         GO TO 8000-EXIT.
 14204
 14205     IF DM-RETURN-CODE = '01'
 14206         MOVE ER-8051            TO EMI-ERROR
 14207         MOVE -1                 TO MAINTL
 14208         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14209         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14210         GO TO 8110-SEND-DATA.
 14211
 14212     IF DM-RETURN-CODE = '02'
 14213         MOVE ER-8052            TO EMI-ERROR
 14214         MOVE -1                 TO MAINTL
 14215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14216         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14217         GO TO 8110-SEND-DATA.
 14218
 14219     IF DM-RETURN-CODE = '03'
 14220         MOVE ER-8053            TO EMI-ERROR
 14221         MOVE -1                 TO MAINTL
 14222         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14223         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14224         GO TO 8110-SEND-DATA.
 14225
 14226     IF DM-RETURN-CODE = '04'
 14227         MOVE ER-8054            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 271
* EL131.cbl
 14228         MOVE -1                 TO MAINTL
 14229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14230         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14231         GO TO 8110-SEND-DATA.
 14232
 14233     IF DM-RETURN-CODE = '05'
 14234         MOVE ER-8055            TO EMI-ERROR
 14235         MOVE -1                 TO MAINTL
 14236         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14237         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14238         GO TO 8110-SEND-DATA.
 14239
 14240     IF DM-RETURN-CODE = '06'
 14241         MOVE ER-8056            TO EMI-ERROR
 14242         MOVE -1                 TO MAINTL
 14243         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14244         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14245         GO TO 8110-SEND-DATA.
 14246
 14247     IF DM-RETURN-CODE = '07'
 14248         MOVE ER-8057            TO EMI-ERROR
 14249         MOVE -1                 TO MAINTL
 14250         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14251         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14252         GO TO 8110-SEND-DATA.
 14253
 14254     IF DM-RETURN-CODE = '08'
 14255         MOVE ER-8058            TO EMI-ERROR
 14256         MOVE -1                 TO MAINTL
 14257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14258         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14259         GO TO 8110-SEND-DATA.
 14260
 14261     IF DM-RETURN-CODE = '09'
 14262         MOVE ER-8059            TO EMI-ERROR
 14263         MOVE -1                 TO MAINTL
 14264         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14265         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14266         GO TO 8110-SEND-DATA.
 14267
 14268     IF DM-RETURN-CODE = '10'
 14269         MOVE ER-8060            TO EMI-ERROR
 14270         MOVE -1                 TO MAINTL
 14271         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14272         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14273         GO TO 8110-SEND-DATA.
 14274
 14275     IF DM-RETURN-CODE = '11'
 14276         MOVE ER-8061            TO EMI-ERROR
 14277         MOVE -1                 TO MAINTL
 14278         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14279         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14280         GO TO 8110-SEND-DATA.
 14281
 14282     IF DM-RETURN-CODE = '12'
 14283         MOVE ER-8062            TO EMI-ERROR
 14284         MOVE -1                 TO MAINTL
 14285         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 272
* EL131.cbl
 14286         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14287         GO TO 8110-SEND-DATA.
 14288
 14289     IF DM-RETURN-CODE = '13'
 14290         MOVE ER-8063            TO EMI-ERROR
 14291         MOVE -1                 TO MAINTL
 14292         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14293         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14294         GO TO 8110-SEND-DATA.
 14295
 14296     IF DM-RETURN-CODE = '14'
 14297         MOVE ER-8064            TO EMI-ERROR
 14298         MOVE -1                 TO MAINTL
 14299         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14300         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14301         GO TO 8110-SEND-DATA.
 14302
 14303     IF DM-RETURN-CODE = '15'
 14304         MOVE ER-8065            TO EMI-ERROR
 14305         MOVE -1                 TO MAINTL
 14306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14307         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14308         GO TO 8110-SEND-DATA.
 14309
 14310     IF DM-RETURN-CODE = '16'
 14311         MOVE ER-8154            TO EMI-ERROR
 14312         MOVE -1                 TO MAINTL
 14313         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14314         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14315         GO TO 8110-SEND-DATA.
 14316
 14317     IF DM-RETURN-CODE = '17'
 14318         MOVE ER-8155            TO EMI-ERROR
 14319         MOVE -1                 TO MAINTL
 14320         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14321         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14322         GO TO 8110-SEND-DATA.
 14323
 14324     IF DM-RETURN-CODE = 'N1'
 14325         MOVE ER-8152            TO EMI-ERROR
 14326         MOVE -1                 TO MAINTL
 14327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14328         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14329         GO TO 8110-SEND-DATA.
 14330
 14331     IF DM-RETURN-CODE = 'E1'
 14332         MOVE ER-8153            TO EMI-ERROR
 14333         MOVE -1                 TO MAINTL
 14334         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14335         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14336         GO TO 8110-SEND-DATA.
 14337
 14338     MOVE ER-8066                TO EMI-ERROR.
 14339     MOVE -1                     TO MAINTL.
 14340     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14341     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
 14342     GO TO 8110-SEND-DATA.
 14343
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 273
* EL131.cbl
 14344 8000-NOTE-NOT-FOUND.
 14345
 14346* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14347*    MOVE '6"R                   !   #00012059' TO DFHEIV0
 14348     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14350     MOVE X'2020233030303132303539' TO DFHEIV0(25:11)
 14351     CALL 'kxdfhei1' USING DFHEIV0
 14352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14353
 14354     MOVE ER-0954                TO EMI-ERROR.
 14355     MOVE -1                     TO MAINTL.
 14356     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14357     GO TO 8110-SEND-DATA.
 14358
 14359 8000-EXIT.
 14360     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 274
* EL131.cbl
 14362 8050-FORMAT-LAST-NAME-1ST.
 14363*****************************************************************
 14364*             M O V E   N A M E   R O U T I N E                 *
 14365*                                                               *
 14366*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14367*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14368*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 14369*                                                               *
 14370*                  FIELD               VALUE                    *
 14371*                  -----               -----                    *
 14372*           W-NAME-LAST    (CL15)      SMITH                    *
 14373*           W-NAME-FIRST   (CL15)      JOHN                     *
 14374*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14375*                                                               *
 14376*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 14377*                SMITH, JOHN ALLEN                              *
 14378*                     OR                                        *
 14379*                SMITH, JOHN A.                                 *
 14380*                                                               *
 14381*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 14382*     COPYBOOK, ELCNWA.                                         *
 14383*****************************************************************.
 14384
 14385     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14386     MOVE ZERO                   TO WS-NAME-SW.
 14387     SET NWA-INDEX               TO +1.
 14388
 14389     IF W-NAME-LAST   = SPACES  AND
 14390        W-NAME-MIDDLE = SPACES
 14391          MOVE +1                TO WS-NAME-SW.
 14392
 14393     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14394     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14395
 14396     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14397     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14398
 14399     SET NWA-INDEX UP BY +1.
 14400
 14401     IF W-NAME-MIDDLE NOT = SPACES
 14402         IF W-NAME-MIDDLE-2 = SPACES
 14403             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14404             SET NWA-INDEX UP BY +1
 14405             MOVE '.'            TO WS-NW (NWA-INDEX)
 14406             SET NWA-INDEX UP BY +2
 14407         ELSE
 14408             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14409             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 14410
 14411 8050-EXIT.
 14412     EXIT.
 14413
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 275
* EL131.cbl
 14415 8060-MOVE-NAME.
 14416     IF WS-NAME-SW GREATER THAN +1
 14417         GO TO 8060-EXIT.
 14418
 14419     IF WS-NAME-WORK2 = SPACES
 14420         GO TO 8060-EXIT.
 14421
 14422     SET NWA-INDEX2            TO +1.
 14423     SET NWA-INDEX3            TO +2.
 14424
 14425 8060-MOVE-NAME-CYCLE.
 14426     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14427
 14428     IF NWA-INDEX LESS THAN +30
 14429         SET NWA-INDEX UP BY +1
 14430     ELSE
 14431         ADD +2 TO  WS-NAME-SW
 14432         GO TO 8060-EXIT.
 14433
 14434     IF NWA-INDEX2 LESS THAN +20
 14435         SET NWA-INDEX3 UP BY +1
 14436         SET NWA-INDEX2 UP BY +1.
 14437
 14438     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 14439        WS-NW2 (NWA-INDEX3) = SPACES
 14440         IF WS-NAME-SW = ZERO
 14441             MOVE ','            TO WS-NW (NWA-INDEX)
 14442             SET NWA-INDEX UP BY +2
 14443             MOVE +1             TO WS-NAME-SW
 14444             GO TO 8060-EXIT
 14445         ELSE
 14446             GO TO 8060-EXIT.
 14447
 14448     GO TO 8060-MOVE-NAME-CYCLE.
 14449
 14450 8060-EXIT.
 14451     EXIT.
 14452
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 276
* EL131.cbl
 14454
 14455 8070-UNLOCK-CLAIM-MSTR.
 14456
 14457* EXEC CICS UNLOCK
 14458*        DATASET   (CLMS-FILE-ID)
 14459*    END-EXEC.
 14460*    MOVE '&*                    #   #00012162' TO DFHEIV0
 14461     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 14462     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14463     MOVE X'2020233030303132313632' TO DFHEIV0(25:11)
 14464     CALL 'kxdfhei1' USING DFHEIV0,
 14465           CLMS-FILE-ID,
 14466           DFHEIV99
 14467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14468
 14469
 14470 8070-EXIT.
 14471      EXIT.
 14472
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 277
* EL131.cbl
 14474 8100-SEND-MAP.
 14475     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 14476
 14477     IF NOT PI-NO-CARRIER-SECURITY
 14478        MOVE AL-SANOF            TO CERTCARA.
 14479     IF NOT PI-NO-ACCOUNT-SECURITY
 14480        MOVE AL-SANOF            TO CERTACTA.
 14481
 14482     IF PI-PROCESSOR-ID = 'LGXX'
 14483        MOVE AL-UANON            TO CCNOA.
 14484
 14485     IF PI-COMPANY-ID = 'DMD'
 14486        NEXT SENTENCE
 14487     ELSE
 14488        MOVE AL-SADOF            TO PFKEY6A.
 14489
 14490     IF PI-USES-PAID-TO
 14491        MOVE 'PAID TO  :' TO PTHRHDGO.
 14492
 14493
 14494* EXEC CICS SEND
 14495*         MAP     ('EL131A')
 14496*         MAPSET  ('EL131S')
 14497*         ERASE
 14498*         FREEKB
 14499*         CURSOR
 14500*    END-EXEC.
 14501     MOVE 'EL131A' TO DFHEIV1
 14502     MOVE -1
 14503       TO DFHEIV11
 14504     MOVE 'EL131S' TO DFHEIV2
 14505*    MOVE '8$     CT  E F  H     ,   #00012189' TO DFHEIV0
 14506     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 14507     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 14508     MOVE X'2020233030303132313839' TO DFHEIV0(25:11)
 14509     CALL 'kxdfhei1' USING DFHEIV0,
 14510           DFHEIV1,
 14511           EL131AO,
 14512           DFHEIV99,
 14513           DFHEIV2,
 14514           DFHEIV99,
 14515           DFHEIV99,
 14516           DFHEIV99,
 14517           DFHEIV11,
 14518           DFHEIV99,
 14519           DFHEIV99,
 14520           DFHEIV99
 14521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14522
 14523
 14524     GO TO 9000-RETURN-TRANS.
 14525
 14526 8110-SEND-DATA.
 14527     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 14528
 14529     IF PI-USES-PAID-TO
 14530        MOVE 'PAID TO  :' TO PTHRHDGO.
 14531
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 278
* EL131.cbl
 14532     IF PI-PROCESSOR-ID = 'LGXX'
 14533        MOVE AL-UANON            TO CCNOA.
 14534
 14535     IF PI-COMPANY-ID = 'DMD'
 14536        NEXT SENTENCE
 14537     ELSE
 14538        MOVE AL-SADOF            TO PFKEY6A.
 14539
 14540
 14541* EXEC CICS SEND
 14542*         MAP      ('EL131A')
 14543*         MAPSET   ('EL131S')
 14544*         DATAONLY
 14545*         FREEKB
 14546*         CURSOR
 14547*    END-EXEC.
 14548     MOVE 'EL131A' TO DFHEIV1
 14549     MOVE -1
 14550       TO DFHEIV11
 14551     MOVE 'EL131S' TO DFHEIV2
 14552*    MOVE '8$D    CT    F  H     ,   #00012213' TO DFHEIV0
 14553     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 14554     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 14555     MOVE X'2020233030303132323133' TO DFHEIV0(25:11)
 14556     CALL 'kxdfhei1' USING DFHEIV0,
 14557           DFHEIV1,
 14558           EL131AO,
 14559           DFHEIV99,
 14560           DFHEIV2,
 14561           DFHEIV99,
 14562           DFHEIV99,
 14563           DFHEIV99,
 14564           DFHEIV11,
 14565           DFHEIV99,
 14566           DFHEIV99,
 14567           DFHEIV99
 14568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14569
 14570
 14571     GO TO 9000-RETURN-TRANS.
 14572
 14573 8120-FORMAT-TIME-DATE.
 14574
 14575     IF SKIP-ATTRIBUTE = 'Y'
 14576        MOVE SPACES              TO SKIP-ATTRIBUTE
 14577        MOVE ER-0598             TO EMI-ERROR
 14578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14579        GO TO 8125-SKIP-ATTRIBUTE.
 14580
 14581     IF PI-COMPANY-ID = 'DMD'
 14582         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 14583                                    CERTCARA  CERTGRPA.
 14584
 14585     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 14586                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 14587                                    JNTINITA  JNTAGEA   APRA
 14588                                    LCVCDA    LCVOTRMA  LCVRTRMA
 14589                                    LCVBENEA  LCVFORMA  LCVCNDTA
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 279
* EL131.cbl
 14590                                    LCVEXITA  LCVSTATA  LCVKINDA
 14591                                    ACVCDA    ACVOTRMA  ACVRTRMA
 14592                                    ACVBENEA  ACVFORMA  ACVCNDTA
 14593                                    ACVEXITA  ACVSTATA  ACVKINDA
 14594                                    PMTFREQA  INDGRPA   PREMTYPA
 14595                                    REINCDA   LCVRATEA  ACVRATEA
 14596                                    ADDONDTA.
 14597
 14598*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 14599*       IF PI-COMPANY-ID = 'DMD'
 14600*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 14601*                                   SUFXA
 14602*                                   PDAMTA    NODAYSA   NOPMTSA
 14603*                                   INCA      OCCA
 14604*          IF NOT SYSTEM-MODIFY-CAP
 14605*              MOVE AL-SANOF         TO PDTHRUA.
 14606
 14607     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 14608         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 14609
 14610 8125-SKIP-ATTRIBUTE.
 14611
 14612     MOVE SAVE-DATE              TO DATEO.
 14613
 14614* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 14615*    END-EXEC
 14616*    MOVE '0"A                   "   #00012263' TO DFHEIV0
 14617     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 14618     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 14619     MOVE X'2020233030303132323633' TO DFHEIV0(25:11)
 14620     CALL 'kxdfhei1' USING DFHEIV0,
 14621           LCP-CICS-TIME
 14622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14623
 14624* EXEC CICS FORMATTIME
 14625*              ABSTIME(LCP-CICS-TIME)
 14626*              TIME(LCP-TIME-OF-DAY-XX)
 14627*    END-EXEC
 14628*    MOVE 'j$(     (             #   #00012265' TO DFHEIV0
 14629     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 14630     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14631     MOVE X'2020233030303132323635' TO DFHEIV0(25:11)
 14632     CALL 'kxdfhei1' USING DFHEIV0,
 14633           LCP-CICS-TIME,
 14634           LCP-TIME-OF-DAY-XX
 14635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14636     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 14637     MOVE UN-HOURS               TO FOR-HOURS.
 14638     MOVE UN-MINUTES             TO FOR-MINUTES.
 14639     MOVE TIME-OUT               TO TIMEO.
 14640     MOVE PI-COMPANY-ID          TO COMPO.
 14641     MOVE PI-PROCESSOR-ID        TO USERIDO.
 14642     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 14643     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 14644     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 14645
 14646 8130-EXIT.
 14647     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 280
* EL131.cbl
 14648
 14649 8150-ENTERED-CLAIM-NOTFOUND.
 14650
 14651     MOVE ER-0204                TO EMI-ERROR.
 14652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14653     MOVE -1                     TO MAINTL.
 14654     GO TO 8100-SEND-MAP.
 14655
 14656 8200-RETURN-PRIOR.
 14657     MOVE SPACE                  TO PI-RETURN-CD-1.
 14658     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 14659     GO TO 9200-XCTL.
 14660
 14661 8300-GET-HELP.
 14662     MOVE XCTL-EL010             TO CALL-PGM.
 14663     GO TO 9200-XCTL.
 14664
 14665 8400-RETURN-MASTER.
 14666     MOVE SPACE                  TO PI-RETURN-CD-1.
 14667     MOVE XCTL-EL126             TO CALL-PGM.
 14668     GO TO 9200-XCTL.
 14669
 14670 8500-TRLR-MNT.
 14671     IF PI-RETURN-CD-1 = 'X'
 14672         MOVE ER-0311            TO EMI-ERROR
 14673         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14674         MOVE -1                 TO MAINTL
 14675         GO TO 8110-SEND-DATA.
 14676
 14677
 14678* EXEC CICS WRITEQ TS
 14679*         QUEUE     (PI-KEY)
 14680*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14681*         LENGTH    (PI-COMM-LENGTH)
 14682*    END-EXEC.
 14683*    MOVE '*"                    ''   #00012310' TO DFHEIV0
 14684     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14685     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14686     MOVE X'2020233030303132333130' TO DFHEIV0(25:11)
 14687     CALL 'kxdfhei1' USING DFHEIV0,
 14688           PI-KEY,
 14689           PROGRAM-INTERFACE-BLOCK,
 14690           PI-COMM-LENGTH,
 14691           DFHEIV99,
 14692           DFHEIV99,
 14693           DFHEIV99
 14694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14695
 14696
 14697     MOVE XCTL-EL142             TO CALL-PGM.
 14698     GO TO 9200-XCTL.
 14699
 14700 8600-ADDR-MNT.
 14701     IF PI-RETURN-CD-1 = 'X'
 14702         MOVE ER-0311            TO EMI-ERROR
 14703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14704         MOVE -1                 TO MAINTL
 14705         GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 281
* EL131.cbl
 14706
 14707
 14708* EXEC CICS WRITEQ TS
 14709*         QUEUE     (PI-KEY)
 14710*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14711*         LENGTH    (PI-COMM-LENGTH)
 14712*    END-EXEC.
 14713*    MOVE '*"                    ''   #00012326' TO DFHEIV0
 14714     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14715     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14716     MOVE X'2020233030303132333236' TO DFHEIV0(25:11)
 14717     CALL 'kxdfhei1' USING DFHEIV0,
 14718           PI-KEY,
 14719           PROGRAM-INTERFACE-BLOCK,
 14720           PI-COMM-LENGTH,
 14721           DFHEIV99,
 14722           DFHEIV99,
 14723           DFHEIV99
 14724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14725
 14726
 14727     MOVE XCTL-EL141             TO CALL-PGM.
 14728     GO TO 9200-XCTL.
 14729
 14730 8700-CERT-MNT.
 14731     IF PI-RETURN-CD-1 = 'X'
 14732         MOVE ER-7690            TO EMI-ERROR
 14733         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14734         MOVE -1                 TO MAINTL
 14735         GO TO 8110-SEND-DATA.
 14736
 14737
 14738* EXEC CICS WRITEQ TS
 14739*         QUEUE     (PI-KEY)
 14740*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14741*         LENGTH    (PI-COMM-LENGTH)
 14742*    END-EXEC.
 14743*    MOVE '*"                    ''   #00012342' TO DFHEIV0
 14744     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14745     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14746     MOVE X'2020233030303132333432' TO DFHEIV0(25:11)
 14747     CALL 'kxdfhei1' USING DFHEIV0,
 14748           PI-KEY,
 14749           PROGRAM-INTERFACE-BLOCK,
 14750           PI-COMM-LENGTH,
 14751           DFHEIV99,
 14752           DFHEIV99,
 14753           DFHEIV99
 14754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14755
 14756
 14757     MOVE XCTL-EL1273            TO CALL-PGM.
 14758     GO TO 9200-XCTL.
 14759
 14760 8750-DMD-CLM-FIX.
 14761
 14762* EXEC CICS WRITEQ TS
 14763*         QUEUE     (PI-KEY)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 282
* EL131.cbl
 14764*         FROM      (PROGRAM-INTERFACE-BLOCK)
 14765*         LENGTH    (PI-COMM-LENGTH)
 14766*    END-EXEC.
 14767*    MOVE '*"                    ''   #00012352' TO DFHEIV0
 14768     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 14769     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14770     MOVE X'2020233030303132333532' TO DFHEIV0(25:11)
 14771     CALL 'kxdfhei1' USING DFHEIV0,
 14772           PI-KEY,
 14773           PROGRAM-INTERFACE-BLOCK,
 14774           PI-COMM-LENGTH,
 14775           DFHEIV99,
 14776           DFHEIV99,
 14777           DFHEIV99
 14778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14779
 14780
 14781     MOVE XCTL-EL400DMD          TO CALL-PGM.
 14782     GO TO 9200-XCTL.
 14783
 14784 8800-UNAUTHORIZED-ACCESS.
 14785     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 14786     GO TO 8990-SEND-TEXT.
 14787
 14788 8810-PF23-ENTERED.
 14789     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 14790     MOVE XCTL-EL005             TO CALL-PGM.
 14791     GO TO 9200-XCTL.
 14792
 14793 8820-XCTL-ERROR.
 14794
 14795* EXEC CICS HANDLE CONDITION
 14796*        PGMIDERR (8990-SEND-TEXT)
 14797*    END-EXEC.
 14798*    MOVE '"$L                   ! G #00012371' TO DFHEIV0
 14799     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 14800     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14801     MOVE X'4720233030303132333731' TO DFHEIV0(25:11)
 14802     CALL 'kxdfhei1' USING DFHEIV0
 14803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14804
 14805
 14806     MOVE SPACE                 TO PI-ENTRY-CD-1.
 14807     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 14808     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 14809     MOVE XCTL-EL005            TO CALL-PGM.
 14810     GO TO 9200-XCTL.
 14811
 14812 8990-SEND-TEXT.
 14813
 14814* EXEC CICS SEND TEXT
 14815*         FROM      (LOGOFF-TEXT)
 14816*         LENGTH    (LOGOFF-LENGTH)
 14817*         ERASE
 14818*         FREEKB
 14819*    END-EXEC.
 14820*    MOVE '8&      T  E F  H   F -   #00012382' TO DFHEIV0
 14821     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 283
* EL131.cbl
 14822     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 14823     MOVE X'2020233030303132333832' TO DFHEIV0(25:11)
 14824     CALL 'kxdfhei1' USING DFHEIV0,
 14825           LOGOFF-TEXT,
 14826           LOGOFF-LENGTH,
 14827           DFHEIV99,
 14828           DFHEIV99,
 14829           DFHEIV99,
 14830           DFHEIV99,
 14831           DFHEIV99,
 14832           DFHEIV99,
 14833           DFHEIV99,
 14834           DFHEIV99,
 14835           DFHEIV99,
 14836           DFHEIV99
 14837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14838
 14839
 14840     GO TO 9100-RETURN-CICS.
 14841
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 284
* EL131.cbl
 14843 9000-RETURN-TRANS.
 14844
 14845* EXEC CICS RETURN
 14846*         TRANSID   (TRANS-ID)
 14847*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 14848*         LENGTH    (PI-COMM-LENGTH)
 14849*    END-EXEC.
 14850*    MOVE '.(CT                  &   #00012393' TO DFHEIV0
 14851     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 14852     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14853     MOVE X'2020233030303132333933' TO DFHEIV0(25:11)
 14854     CALL 'kxdfhei1' USING DFHEIV0,
 14855           TRANS-ID,
 14856           PROGRAM-INTERFACE-BLOCK,
 14857           PI-COMM-LENGTH,
 14858           DFHEIV99,
 14859           DFHEIV99
 14860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14861
 14862
 14863
 14864* GOBACK.
 14865     MOVE '9%                    "   ' TO DFHEIV0
 14866     MOVE 'EL131' TO DFHEIV1
 14867     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 14868     GOBACK.
 14869
 14870 9100-RETURN-CICS.
 14871
 14872* EXEC CICS RETURN
 14873*    END-EXEC.
 14874*    MOVE '.(                    &   #00012402' TO DFHEIV0
 14875     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 14876     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14877     MOVE X'2020233030303132343032' TO DFHEIV0(25:11)
 14878     CALL 'kxdfhei1' USING DFHEIV0,
 14879           DFHEIV99,
 14880           DFHEIV99,
 14881           DFHEIV99,
 14882           DFHEIV99,
 14883           DFHEIV99
 14884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14885
 14886
 14887
 14888* GOBACK.
 14889     MOVE '9%                    "   ' TO DFHEIV0
 14890     MOVE 'EL131' TO DFHEIV1
 14891     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 14892     GOBACK.
 14893
 14894 9200-XCTL.
 14895
 14896* EXEC CICS XCTL
 14897*         PROGRAM    (CALL-PGM)
 14898*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 14899*         LENGTH     (PI-COMM-LENGTH)
 14900*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 285
* EL131.cbl
 14901*    MOVE '.$C                   $   #00012408' TO DFHEIV0
 14902     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 14903     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14904     MOVE X'2020233030303132343038' TO DFHEIV0(25:11)
 14905     CALL 'kxdfhei1' USING DFHEIV0,
 14906           CALL-PGM,
 14907           PROGRAM-INTERFACE-BLOCK,
 14908           PI-COMM-LENGTH
 14909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14910
 14911
 14912 9700-LINK-RTRM-FILE-ID.
 14913
 14914* EXEC CICS LINK
 14915*        PROGRAM  (RTRM-FILE-ID)
 14916*        COMMAREA (CALCULATION-PASS-AREA)
 14917*        LENGTH   (CP-COMM-LENGTH)
 14918*    END-EXEC.
 14919*    MOVE '."C                   ''   #00012415' TO DFHEIV0
 14920     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14921     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14922     MOVE X'2020233030303132343135' TO DFHEIV0(25:11)
 14923     CALL 'kxdfhei1' USING DFHEIV0,
 14924           RTRM-FILE-ID,
 14925           CALCULATION-PASS-AREA,
 14926           CP-COMM-LENGTH,
 14927           DFHEIV99,
 14928           DFHEIV99,
 14929           DFHEIV99
 14930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14931
 14932
 14933 9700-EXIT.
 14934      EXIT.
 14935
 14936 9800-CONVERT-DATE.
 14937     MOVE SPACES TO DC-ERROR-CODE.
 14938
 14939* EXEC CICS LINK
 14940*         PROGRAM    (DATE-CONV)
 14941*         COMMAREA   (DATE-CONVERSION-DATA)
 14942*         LENGTH     (DC-COMM-LENGTH)
 14943*    END-EXEC.
 14944*    MOVE '."C                   ''   #00012426' TO DFHEIV0
 14945     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14946     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14947     MOVE X'2020233030303132343236' TO DFHEIV0(25:11)
 14948     CALL 'kxdfhei1' USING DFHEIV0,
 14949           DATE-CONV,
 14950           DATE-CONVERSION-DATA,
 14951           DC-COMM-LENGTH,
 14952           DFHEIV99,
 14953           DFHEIV99,
 14954           DFHEIV99
 14955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14956
 14957
 14958 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 286
* EL131.cbl
 14959     EXIT.
 14960
 14961 9900-ERROR-FORMAT.
 14962
 14963* EXEC CICS LINK
 14964*         PROGRAM    (XCTL-EL001)
 14965*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 14966*         LENGTH     (EMI-COMM-LENGTH)
 14967*    END-EXEC.
 14968*    MOVE '."C                   ''   #00012436' TO DFHEIV0
 14969     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14970     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14971     MOVE X'2020233030303132343336' TO DFHEIV0(25:11)
 14972     CALL 'kxdfhei1' USING DFHEIV0,
 14973           XCTL-EL001,
 14974           ERROR-MESSAGE-INTERFACE-BLOCK,
 14975           EMI-COMM-LENGTH,
 14976           DFHEIV99,
 14977           DFHEIV99,
 14978           DFHEIV99
 14979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14980
 14981
 14982 9900-EXIT.
 14983     EXIT.
 14984
 14985 9990-ABEND.
 14986     MOVE DFHEIBLK               TO EMI-LINE1.
 14987
 14988* EXEC CICS LINK
 14989*         PROGRAM   (XCTL-EL004)
 14990*         COMMAREA  (EMI-LINE1)
 14991*         LENGTH    (72)
 14992*     END-EXEC.
 14993     MOVE 72
 14994       TO DFHEIV11
 14995*    MOVE '."C                   ''   #00012447' TO DFHEIV0
 14996     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14997     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14998     MOVE X'2020233030303132343437' TO DFHEIV0(25:11)
 14999     CALL 'kxdfhei1' USING DFHEIV0,
 15000           XCTL-EL004,
 15001           EMI-LINE1,
 15002           DFHEIV11,
 15003           DFHEIV99,
 15004           DFHEIV99,
 15005           DFHEIV99
 15006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15007
 15008
 15009     MOVE -1                     TO  MAINTL
 15010
 15011     GO TO 8110-SEND-DATA.
 15012
 15013 9995-SECURITY-VIOLATION.
 15014*           COPY ELCSCTP.
 15015******************************************************************
 15016*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 287
* EL131.cbl
 15017*                            ELCSCTP                             *
 15018*                            VMOD=2.001                          *
 15019*                                                                *
 15020*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 15021******************************************************************
 15022
 15023
 15024     MOVE EIBDATE          TO SM-JUL-DATE.
 15025     MOVE EIBTRMID         TO SM-TERMID.
 15026     MOVE THIS-PGM         TO SM-PGM.
 15027     MOVE EIBTIME          TO TIME-IN.
 15028     MOVE TIME-OUT         TO SM-TIME.
 15029     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 15030
 15031
 15032* EXEC CICS LINK
 15033*         PROGRAM  ('EL003')
 15034*         COMMAREA (SECURITY-MESSAGE)
 15035*         LENGTH   (80)
 15036*    END-EXEC.
 15037     MOVE 'EL003' TO DFHEIV1
 15038     MOVE 80
 15039       TO DFHEIV11
 15040*    MOVE '."C                   ''   #00012475' TO DFHEIV0
 15041     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15042     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15043     MOVE X'2020233030303132343735' TO DFHEIV0(25:11)
 15044     CALL 'kxdfhei1' USING DFHEIV0,
 15045           DFHEIV1,
 15046           SECURITY-MESSAGE,
 15047           DFHEIV11,
 15048           DFHEIV99,
 15049           DFHEIV99,
 15050           DFHEIV99
 15051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15052
 15053
 15054******************************************************************
 15055
 15056
 15057
 15058 9999-DFHBACK SECTION.
 15059     MOVE '9%                    "   ' TO DFHEIV0
 15060     MOVE 'EL131' TO DFHEIV1
 15061     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15062     GOBACK.
 15063 9999-DFHEXIT.
 15064     IF DFHEIGDJ EQUAL 0001
 15065         NEXT SENTENCE
 15066     ELSE IF DFHEIGDJ EQUAL 2
 15067         GO TO 8820-XCTL-ERROR,
 15068               8150-ENTERED-CLAIM-NOTFOUND,
 15069               9990-ABEND
 15070         DEPENDING ON DFHEIGDI
 15071     ELSE IF DFHEIGDJ EQUAL 3
 15072         GO TO 0130-TS-ERROR,
 15073               0130-TS-ERROR
 15074         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 288
* EL131.cbl
 15075     ELSE IF DFHEIGDJ EQUAL 4
 15076         GO TO 0600-CONTINUE-NAME-UPDATE
 15077         DEPENDING ON DFHEIGDI
 15078     ELSE IF DFHEIGDJ EQUAL 5
 15079         GO TO 1004-BENE-NOT-FOUND
 15080         DEPENDING ON DFHEIGDI
 15081     ELSE IF DFHEIGDJ EQUAL 6
 15082         GO TO 1120-CNTL-NOTFND
 15083         DEPENDING ON DFHEIGDI
 15084     ELSE IF DFHEIGDJ EQUAL 7
 15085         GO TO 1150-NOTOPEN-ERROR,
 15086               1150-EXIT
 15087         DEPENDING ON DFHEIGDI
 15088     ELSE IF DFHEIGDJ EQUAL 8
 15089         GO TO 1490-STATE-NOTFND
 15090         DEPENDING ON DFHEIGDI
 15091     ELSE IF DFHEIGDJ EQUAL 9
 15092         GO TO 1500-CARR-NOTFND
 15093         DEPENDING ON DFHEIGDI
 15094     ELSE IF DFHEIGDJ EQUAL 10
 15095         GO TO 1620-ACCT-NOTFND
 15096         DEPENDING ON DFHEIGDI
 15097     ELSE IF DFHEIGDJ EQUAL 11
 15098         GO TO 2020-EXIT
 15099         DEPENDING ON DFHEIGDI
 15100     ELSE IF DFHEIGDJ EQUAL 12
 15101         GO TO 2030-EXIT
 15102         DEPENDING ON DFHEIGDI
 15103     ELSE IF DFHEIGDJ EQUAL 13
 15104         GO TO 2040-EXIT
 15105         DEPENDING ON DFHEIGDI
 15106     ELSE IF DFHEIGDJ EQUAL 14
 15107         GO TO 2050-EXIT
 15108         DEPENDING ON DFHEIGDI
 15109     ELSE IF DFHEIGDJ EQUAL 15
 15110         GO TO 2060-CERT-NOTFND
 15111         DEPENDING ON DFHEIGDI
 15112     ELSE IF DFHEIGDJ EQUAL 16
 15113         GO TO 2060-DUPKEY
 15114         DEPENDING ON DFHEIGDI
 15115     ELSE IF DFHEIGDJ EQUAL 17
 15116         GO TO 2070-NOT-FOUND
 15117         DEPENDING ON DFHEIGDI
 15118     ELSE IF DFHEIGDJ EQUAL 18
 15119         GO TO 2070-EXIT
 15120         DEPENDING ON DFHEIGDI
 15121     ELSE IF DFHEIGDJ EQUAL 19
 15122         GO TO 2080-EXIT
 15123         DEPENDING ON DFHEIGDI
 15124     ELSE IF DFHEIGDJ EQUAL 20
 15125         GO TO 2400-TRLR-NOTFND,
 15126               2410-EXIT
 15127         DEPENDING ON DFHEIGDI
 15128     ELSE IF DFHEIGDJ EQUAL 21
 15129         GO TO 2425-NINETY-NOTFND,
 15130               2425-NINETY-NOTFND
 15131         DEPENDING ON DFHEIGDI
 15132     ELSE IF DFHEIGDJ EQUAL 22
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 289
* EL131.cbl
 15133         GO TO 2430-EXIT,
 15134               2440-EXIT
 15135         DEPENDING ON DFHEIGDI
 15136     ELSE IF DFHEIGDJ EQUAL 23
 15137         GO TO 2440-EXIT
 15138         DEPENDING ON DFHEIGDI
 15139     ELSE IF DFHEIGDJ EQUAL 24
 15140         GO TO 2460-EXIT
 15141         DEPENDING ON DFHEIGDI
 15142     ELSE IF DFHEIGDJ EQUAL 25
 15143         GO TO 2475-EXIT
 15144         DEPENDING ON DFHEIGDI
 15145     ELSE IF DFHEIGDJ EQUAL 26
 15146         GO TO 2650-EXIT
 15147         DEPENDING ON DFHEIGDI
 15148     ELSE IF DFHEIGDJ EQUAL 27
 15149         GO TO 3010-DEL-ACTQ,
 15150               3040-EXIT
 15151         DEPENDING ON DFHEIGDI
 15152     ELSE IF DFHEIGDJ EQUAL 28
 15153         GO TO 3010-NO-ACTIVITY,
 15154               3050-EXIT
 15155         DEPENDING ON DFHEIGDI
 15156     ELSE IF DFHEIGDJ EQUAL 29
 15157         GO TO 3010-CERT-NOT-FOUND
 15158         DEPENDING ON DFHEIGDI
 15159     ELSE IF DFHEIGDJ EQUAL 30
 15160         GO TO 3020-EXIT
 15161         DEPENDING ON DFHEIGDI
 15162     ELSE IF DFHEIGDJ EQUAL 31
 15163         GO TO 3060-EXIT,
 15164               3060-EXIT
 15165         DEPENDING ON DFHEIGDI
 15166     ELSE IF DFHEIGDJ EQUAL 32
 15167         GO TO 5000-TRLR-NOT-FOUND
 15168         DEPENDING ON DFHEIGDI
 15169     ELSE IF DFHEIGDJ EQUAL 33
 15170         GO TO 5000-CERT-NOT-FOUND
 15171         DEPENDING ON DFHEIGDI
 15172     ELSE IF DFHEIGDJ EQUAL 34
 15173         GO TO 7630-END-BROWSE
 15174         DEPENDING ON DFHEIGDI
 15175     ELSE IF DFHEIGDJ EQUAL 35
 15176         GO TO 7799-EXIT,
 15177               7799-EXIT
 15178         DEPENDING ON DFHEIGDI
 15179     ELSE IF DFHEIGDJ EQUAL 36
 15180         GO TO 7799-EXIT
 15181         DEPENDING ON DFHEIGDI
 15182     ELSE IF DFHEIGDJ EQUAL 37
 15183         GO TO 7800-NOT-FOUND
 15184         DEPENDING ON DFHEIGDI
 15185     ELSE IF DFHEIGDJ EQUAL 38
 15186         GO TO 8000-NOTE-NOT-FOUND
 15187         DEPENDING ON DFHEIGDI
 15188     ELSE IF DFHEIGDJ EQUAL 39
 15189         GO TO 8990-SEND-TEXT
 15190         DEPENDING ON DFHEIGDI.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:14 Page 290
* EL131.cbl
 15191     MOVE '9%                    "   ' TO DFHEIV0
 15192     MOVE 'EL131' TO DFHEIV1
 15193     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15194     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       10884     Code:       51598
