* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    45* 121417  IR2017121200001  PEMA  Correct assignment of ben period
    46* 011118  CR2016052500002  TANA  Add Message for pre-existing
    47* 052918  CR2018031500002  TANA  Add Message for filing time limit
    48* 061418  IR2018053000003  TANA  Fix Causal state / filing limit
    49* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    50* 071720  CR2019112600001  TANA  Remove filing time limit error
    51******************************************************************
    52
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page   3
* EL130.cbl
    54 ENVIRONMENT DIVISION.
    55 DATA DIVISION.
    56 WORKING-STORAGE SECTION.
    57 01  DFH-START PIC X(04).
    58 77  FILLER  PIC X(32)  VALUE '********************************'.
    59 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    60 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    61 77  A1                          PIC S999 COMP-3 VALUE +0.
    62 77  E1                          PIC S999 COMP-3 VALUE +0.
    63 77  s1                          pic s999 comp-3 value +0.
    64 77  s2                          pic s999 comp-3 value +0.
    65 77  P1                          PIC S999 COMP-3 VALUE +0.
    66 77  P2                          PIC S999 COMP-3 VALUE +0.
    67 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    68 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    69 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    70 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    71 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    72 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    73 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    74 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    75     88  ERPDEF-FOUND                 VALUE 'Y'.
    76 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    77 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    78 77  ws-dcc-product-code         pic xxx value spaces.
    79 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    80 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    81 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    82 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    83 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    84 77  ws-zero-bens-avail          pic x value ' '.
    85 77  WS-PRE-EXISTING-PER         PIC 99    VALUE ZEROS.
    86*    COPY ELCSCTM.
    87******************************************************************
    88*                                                                *
    89*                                                                *
    90*                            ELCSCTM                             *
    91*                            VMOD=2.001                          *
    92*                                                                *
    93*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-MESSAGE.
    97     12  FILLER                          PIC X(30)
    98            VALUE '** LOGIC SECURITY VIOLATION -'.
    99     12  SM-READ                         PIC X(6).
   100     12  FILLER                          PIC X(5)
   101            VALUE ' PGM='.
   102     12  SM-PGM                          PIC X(6).
   103     12  FILLER                          PIC X(5)
   104            VALUE ' OPR='.
   105     12  SM-PROCESSOR-ID                 PIC X(4).
   106     12  FILLER                          PIC X(6)
   107            VALUE ' TERM='.
   108     12  SM-TERMID                       PIC X(4).
   109     12  FILLER                          PIC XX   VALUE SPACE.
   110     12  SM-JUL-DATE                     PIC 9(5).
   111     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page   4
* EL130.cbl
   112     12  SM-TIME                         PIC 99.99.
   113
   114
   115*    COPY ELCSCRTY.
   116******************************************************************
   117*                                                                *
   118*                                                                *
   119*                            ELCSCRTY                            *
   120*                            VMOD=2.001                          *
   121*                                                                *
   122*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   123*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   124*        SAVED IN PI-SECURITY-ADDRESS.                           *
   125*                                                                *
   126******************************************************************
   127 01  SECURITY-CONTROL.
   128     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   129     12  FILLER                       PIC XX    VALUE 'SC'.
   130     12  SC-CREDIT-CODES.
   131         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   132             20  SC-CREDIT-DISPLAY    PIC X.
   133             20  SC-CREDIT-UPDATE     PIC X.
   134     12  SC-CLAIMS-CODES.
   135         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   136             20  SC-CLAIMS-DISPLAY    PIC X.
   137             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page   5
* EL130.cbl
   139 01  WS-DATE-AREA.
   140     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   141     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   142     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   143
   144 01  ws-dcc-error-line.
   145     05  filler occurs 15.
   146         10  ws-error-no        pic x(4).
   147 01  WS-CRI-SSN-WORK-AREA.
   148     05  WS-CRI-SOC-SEC-NO.
   149         10  WS-SS-REPT-CD       PIC X(5).
   150         10  WS-SS-LAST-NAME     PIC X(5).
   151         10  WS-SS-INITIAL       PIC X.
   152
   153     05  WS-CRI-REPORT-CODE.
   154         10  FILLER              PIC X(5).
   155         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   156
   157     05  WS-CRI-LAST-NAME.
   158         10  WS-CRI-NAME-MOVE    PIC X(5).
   159         10  FILLER              PIC X(10).
   160
   161 01  STANDARD-AREAS.
   162     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   163     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   164     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   165     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   166     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   167     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   168     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   169     12  PGM-NAME            PIC X(8).
   170     12  TIME-IN             PIC S9(7).
   171     12  TIME-OUT-R  REDEFINES TIME-IN.
   172         16  FILLER          PIC X.
   173         16  TIME-OUT        PIC 99V99.
   174         16  FILLER          PIC X(2).
   175     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   176     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   177     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   178     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   179     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   180     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   181     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   182     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   183     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   184     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   185     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   186     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   187     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   188     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   189     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   190     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   191     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   192     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   193     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   194     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   195     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   196     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page   6
* EL130.cbl
   197     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   198     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   199     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   200     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   201     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   202     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   203     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   204     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   205     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   206     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   207     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   208     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   209     12  FILE-ID             PIC X(8).
   210     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   211     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   212     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   213     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   214     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   215     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   216     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   217     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   218     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   219
   220 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   221     12  M                   PIC S9(7)V99           VALUE ZEROS.
   222     12  L                   PIC S9(7)V99           VALUE ZEROS.
   223     12  N                   PIC S9(3)              VALUE ZEROS.
   224     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   225     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   226     12  I                   PIC S99V9(5)           VALUE ZEROS.
   227     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   228     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   229     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   230     12  R                   PIC S9(3)              VALUE ZEROS.
   231     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   232     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   233     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   234     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   235     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   236     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   237     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   238     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   239     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   240
   241 01  TERM-CALC-WORK-AREA.
   242     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   243     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   244     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   245     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   246     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   247     12  V-EXPONENTS.
   248        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   249     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   250
   251 01  MISC-WORK-AREAS.
   252     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   253     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   254     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page   7
* EL130.cbl
   255     12  QID.
   256         16  QID-TERM        PIC X(4).
   257         16  FILLER          PIC X(4)    VALUE '130A'.
   258     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   259     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   260     12  WS-GROUP-NO.
   261         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   262         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   263
   264     12  WS-RESPONSE         PIC S9(8)   COMP.
   265         88  WS-RESP-NORMAL              VALUE +00.
   266         88  WS-RESP-ERROR               VALUE +01.
   267         88  WS-RESP-NOTFND              VALUE +13.
   268         88  WS-RESP-DUPKEY              VALUE +15.
   269         88  WS-RESP-NOTOPEN             VALUE +19.
   270         88  WS-RESP-ENDFILE             VALUE +20.
   271
   272***************************************************************
   273*                                                             *
   274*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   275*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   276*    CHANGES WITH IN MAP EL130A.                              *
   277*                                                             *
   278***************************************************************
   279
   280     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   281     12  WS-SAVE-CLAIM-MASTER.
   282         16  FILLER                    PIC XX.
   283         16  WS-SAVE-CLAIM-KEY.
   284             20  WS-SAVE-COMPANY-CD    PIC X.
   285             20  WS-SAVE-CARRIER       PIC X.
   286             20  WS-SAVE-CLAIM-NO      PIC X(7).
   287             20  WS-SAVE-CERT-NO       PIC X(11).
   288         16  FILLER                    PIC X(328).
   289     12  SAVE-CURRENT-DATE         PIC XX.
   290     12  SAVE-CONTROL              PIC X(39).
   291     12  SAVE-ERACCT-KEY           PIC X(26).
   292     12  SAVE-COUNTER              PIC S9(8)   COMP.
   293     12  SAVE-METHOD               PIC X.
   294     12  SAVE-COMPANY-ID           PIC XXX.
   295     12  SAVE-COMPANY-CD           PIC X.
   296     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   297     12  SAVE-CREDIT-USER          PIC X.
   298     12  SAVE-CLAIM-USER           PIC X.
   299     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   300     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   301     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   302     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   303     12  SAVE-AH-OVERRIDE-L1       PIC X.
   304     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   305     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   306     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   307     12  FILLER                    PIC X.
   308*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   309     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   310     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   311     12  SAVE-EL127-TO-EL130-CNTRL.
   312         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page   8
* EL130.cbl
   313         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   314         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   315             20  SAVE-EL127-CARRIER  PIC X.
   316             20  SAVE-EL127-GROUPING PIC X(6).
   317             20  SAVE-EL127-STATE    PIC X(2).
   318             20  SAVE-EL127-ACCOUNT  PIC X(10).
   319             20  SAVE-EL127-CERT-NO  PIC X(11).
   320             20  SAVE-EL127-EFF-DT   PIC XX.
   321     12  SAVE-EL659-TO-EL130-CNTRL.
   322         16  SAVE-EL659-CARRIER    PIC X.
   323         16  SAVE-EL659-GROUPING   PIC X(6).
   324         16  SAVE-EL659-STATE      PIC XX.
   325         16  SAVE-EL659-ACCOUNT    PIC X(10).
   326     12  DIVIDE-QUOT               PIC 999.
   327     12  DIVIDE-REM                PIC 999.
   328     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   329     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   330     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   331     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   332     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   333     12  WS-RESERVE-CONTROLS       PIC X(9).
   334     12  WS-EXPENSE-CONTROLS       PIC X(7).
   335     12  WS-REIN-TABLE.
   336         16  WS-REIN-1             PIC X            VALUE SPACE.
   337         16  WS-REIN-2             PIC X            VALUE SPACE.
   338         16  WS-REIN-3             PIC X            VALUE SPACE.
   339     12  WS-BENE-CALC-METHOD       PIC X.
   340     12  ws-lf-joint-indicator     pic x.
   341     12  ws-ah-joint-indicator     pic x.
   342     12  WS-EARNINGS-CALC          PIC X.
   343     12  WS-LF-EARNINGS-CALC       PIC X.
   344         88 TEX-REG                VALUE '4'.
   345         88 NET-PAY                VALUE '5'.
   346     12  WS-AH-EARNINGS-CALC       PIC X.
   347     12  WS-SPECIAL-CALC-CD        PIC X(01).
   348     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   349     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   350     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   351     12  WS-ICD-CODE-1             PIC X(8).
   352     12  WS-ICD-CODE-2             PIC X(8).
   353     12  WS-CLAIM-NUMBER.
   354         16  WS-CN-PREFIX.
   355             20  WS-CN-PRF-A PIC X.
   356             20  WS-CN-PRF-B PIC X.
   357         16  WS-CN-NUMBER    PIC 9(5).
   358     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   359     12  WS-CLAIM-SEQU.
   360         16  FILLER          PIC X    VALUE '('.
   361         16  WS-CURRENT-SEQU PIC Z9.
   362         16  FILLER          PIC X(4) VALUE ' OF '.
   363         16  WS-OF-SEQU      PIC Z9.
   364         16  FILLER          PIC X    VALUE ')'.
   365     12  DATE-WORK.
   366       14  FILLER                PIC XX.
   367       14  DATE-MM               PIC XX.
   368       14  DATE-DD               PIC XX.
   369       14  DATE-YY               PIC XX.
   370     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page   9
* EL130.cbl
   371         16  CURR-MM.
   372           18  CURR-M1           PIC 9.
   373           18  CURR-M2           PIC 9.
   374         16  FILLER              PIC X(5).
   375         16  CURR-YEAR           PIC 9.
   376     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   377     12  SUB                     PIC 99.
   378     12  MY-DATE.
   379         16  MY-MM               PIC XX.
   380         16  FILLER              PIC X VALUE '/'.
   381         16  MY-YY               PIC XX.
   382
   383     12  WS-EDIT-BEN-CODE        PIC XX.
   384         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   385                                          '90' THRU '99'.
   386
   387     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   388     12  WS-BEN-HOLD             PIC XX.
   389     12  WS-BEN-ALPHA-HOLD.
   390         15  WS-BEN-ALPHA-2      PIC XX.
   391         15  WS-BEN-ALPHA-1      PIC X.
   392     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   393     12  WS-REC-TYPE             PIC X.
   394     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   395     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   396     12  ARCH-NUMBER             PIC S9(8)   COMP.
   397     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   398         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   399         88  REIN-REC-FOUND                  VALUE 'Y'.
   400
   401     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   402     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   403
   404
   405 01  CSO-WORK-FIELDS.
   406     12  WS-BLANK            PIC X       VALUE ' '.
   407
   408     12  WS-MA-CONTROL-PRIMARY.
   409         16  WS-MA-COMPANY-CD        PIC  X.
   410         16  WS-MA-CARRIER           PIC  X.
   411         16  WS-MA-GROUPING          PIC  X(6).
   412         16  WS-MA-STATE             PIC  XX.
   413         16  WS-MA-ACCOUNT           PIC  X(10).
   414         16  WS-MA-CERT-EFF-DT       PIC  XX.
   415         16  WS-MA-CERT-NO.
   416             20  WS-MA-CERT-PRIME    PIC  X(10).
   417             20  WS-MA-CERT-SFX      PIC  X.
   418
   419     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   420     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   421     12  WS-SOC-SEC-NUMBER.
   422         16  WS-SOC-SEC-NO       PIC 9(9).
   423         16  WS-SOC-SEC-BLANK    PIC X(2).
   424     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   425         16  WS-SSN-1-3          PIC 9(3).
   426         16  WS-SSN-DASH1        PIC X(1).
   427         16  WS-SSN-4-5          PIC 9(2).
   428         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  10
* EL130.cbl
   429         16  WS-SSN-6-9          PIC 9(4).
   430
   431     12  WS-DIAG-VIN-MSG.
   432         16  FILLER          PIC X(11)
   433             VALUE 'VIN NUMBER '.
   434         16  WS-DIAG-VIN     PIC X(17).
   435
   436     12  WS-VERIFY-NOTE      PIC X(34)
   437         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   438
   439     12  WS-CAUSAL-NOTE      PIC X(40)
   440         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   441
   442     12  WS-VFY-SSN-NOTE     PIC X(25)
   443         VALUE 'SSN VERIFICATION REQUIRED'.
   444
   445     12  WS-FILING-NOTE     PIC X(30)
   446         VALUE 'FILING TIME LIMIT EXCEEDED'.
   447
   448 01  MAP-DATE-AREAS.
   449     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   450     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   451     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   452     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   453     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   454     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   455     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   456     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   457     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   458     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   459     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   460     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   461     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   462     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   463     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   464     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   465     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   466     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   467     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   468         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   469     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   470     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   471     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   472     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   473
   474 01  ACCESS-KEYS.
   475     12  ELACTQ-KEY.
   476         16  ELACTQ-COMPANY-CD       PIC X.
   477         16  ELACTQ-CARRIER          PIC X.
   478         16  ELACTQ-CLAIM-NO         PIC X(7).
   479         16  ELACTQ-CERT-NO          PIC X(11).
   480     12  ELMSTR-KEY.
   481         16  MSTR-COMP-CD            PIC X.
   482         16  MSTR-CARRIER            PIC X.
   483         16  MSTR-CLAIM-NO           PIC X(7).
   484         16  MSTR-CERT-NO.
   485             20  MSTR-CERT-NO-PRIME  PIC X(10).
   486             20  MSTR-CERT-NO-SUFX   PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  11
* EL130.cbl
   487     12  SAVE-ELMSTR-KEY.
   488         16  SAVE-COMP-CD            PIC X.
   489         16  SAVE-CARRIER            PIC X.
   490         16  SAVE-CLAIM-NO           PIC X(7).
   491         16  SAVE-CERT-NO.
   492             20  SAVE-CERT-NO-PRIME  PIC X(10).
   493             20  SAVE-CERT-NO-SUFX   PIC X.
   494     12  ELMSTR5-KEY.
   495         16  MSTR5-COMP-CD           PIC X.
   496         16  MSTR5-CERT-NO.
   497             20  MSTR5-CERT-NO-PRIME PIC X(10).
   498             20  MSTR5-CERT-NO-SUFX  PIC X.
   499     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   500         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   501         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   502         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   503     12  ELCNTL-KEY.
   504         16  CNTL-COMP-ID    PIC X(3).
   505         16  CNTL-REC-TYPE   PIC X.
   506         16  CNTL-ACCESS.
   507             20  FILLER      PIC XX.
   508             20  CNTL-BENEFIT.
   509                 24  FILLER  PIC X.
   510                 24  CNTL-CARRIER PIC X.
   511         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   512     12  ELCERT-KEY.
   513         16  CERT-COMP-CD    PIC X.
   514         16  CERT-CARRIER    PIC X.
   515         16  CERT-GROUPING   PIC X(6).
   516         16  CERT-STATE      PIC X(2).
   517         16  CERT-ACCOUNT.
   518             20  CERT-ACCOUNT-PREFIX PIC X(4).
   519             20  CERT-ACCOUNT-PRIME  PIC X(6).
   520         16  CERT-EFF-DT     PIC XX.
   521         16  CERT-CERT-NO.
   522             20  CERT-CERT-NO-PRIME  PIC X(10).
   523             20  CERT-CERT-NO-SUFX   PIC X.
   524     12  ELCERT-KEY-5.
   525         16  CERT-COMP-CD-5      PIC X.
   526         16  CERT-CERT-5.
   527             20  CERT-CERT-5-PRIME   PIC X(10).
   528             20  CERT-CERT-5-SUFX    PIC X.
   529     12  ERACCT-KEY.
   530         16  ACCT-COMP-CD    PIC X.
   531         16  ACCT-CARRIER    PIC X.
   532         16  ACCT-GROUPING   PIC X(6).
   533         16  ACCT-STATE      PIC X(2).
   534         16  ACCT-ACCOUNT    PIC X(10).
   535         16  ACCT-EXP-DT     PIC XX.
   536     12  ELTRLR-KEY.
   537         16  TRLR-COMP-CD    PIC X.
   538         16  TRLR-CARRIER    PIC X.
   539         16  TRLR-CLAIM-NO   PIC X(7).
   540         16  TRLR-CERT-NO.
   541             20  TRLR-CERT-NO-PRIME  PIC X(10).
   542             20  TRLR-CERT-NO-SUFX   PIC X.
   543         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   544         16  TRLR-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  12
* EL130.cbl
   545     12  ELBENE-KEY.
   546         16  BENE-COMP-CD    PIC X.
   547         16  BENE-RCD-TYPE   PIC X.
   548         16  BENE-CODE       PIC X(10).
   549     12  ERREIN-KEY.
   550         16  REIN-COMP-CD        PIC X(01).
   551         16  REIN-TYPE           PIC X(01).
   552         16  REIN-TABLE-CO.
   553             20  REIN-CODE-1     PIC X(01).
   554             20  REIN-CODE-2     PIC X(01).
   555             20  REIN-CODE-3     PIC X(01).
   556         16  FILLER              PIC X(03).
   557     12  ELCRTT-KEY.
   558         16  CTRLR-COMP-CD       PIC X.
   559         16  CTRLR-CARRIER       PIC X.
   560         16  CTRLR-GROUPING      PIC X(6).
   561         16  CTRLR-STATE         PIC X(2).
   562         16  CTRLR-ACCOUNT       PIC X(10).
   563         16  CTRLR-EFF-DT        PIC XX.
   564         16  CTRLR-CERT-NO       PIC X(11).
   565         16  CTRLR-REC-TYPE      PIC X.
   566 01  ws-acct-found-sw            pic x value ' '.
   567     88  acct-found                value 'Y'.
   568 01  ERPDEF-KEY-SAVE             PIC X(18).
   569 01  ERPDEF-KEY.
   570     12  ERPDEF-COMPANY-CD       PIC X.
   571     12  ERPDEF-STATE            PIC XX.
   572     12  ERPDEF-PROD-CD          PIC XXX.
   573     12  F                       PIC X(7).
   574     12  ERPDEF-BEN-TYPE         PIC X.
   575     12  ERPDEF-BEN-CODE         PIC XX.
   576     12  ERPDEF-EXP-DT           PIC XX.
   577 01  ERROR-MESSAGES.
   578     12  ER-0000                 PIC X(4)  VALUE '0000'.
   579     12  ER-0004                 PIC X(4)  VALUE '0004'.
   580     12  ER-0019                 PIC X(4)  VALUE '0019'.
   581     12  ER-0023                 PIC X(4)  VALUE '0023'.
   582     12  ER-0029                 PIC X(4)  VALUE '0029'.
   583     12  ER-0033                 PIC X(4)  VALUE '0033'.
   584     12  ER-0068                 PIC X(4)  VALUE '0068'.
   585     12  ER-0070                 PIC X(4)  VALUE '0070'.
   586     12  ER-0194                 PIC X(4)  VALUE '0194'.
   587     12  ER-0202                 PIC X(4)  VALUE '0202'.
   588     12  ER-0203                 PIC X(4)  VALUE '0203'.
   589     12  ER-0204                 PIC X(4)  VALUE '0204'.
   590     12  ER-0205                 PIC X(4)  VALUE '0205'.
   591     12  ER-0206                 PIC X(4)  VALUE '0206'.
   592     12  ER-0207                 PIC X(4)  VALUE '0207'.
   593     12  ER-0213                 PIC X(4)  VALUE '0213'.
   594     12  ER-0214                 PIC X(4)  VALUE '0214'.
   595     12  ER-0217                 PIC X(4)  VALUE '0217'.
   596     12  ER-0219                 PIC X(4)  VALUE '0219'.
   597     12  ER-0220                 PIC X(4)  VALUE '0220'.
   598     12  ER-0221                 PIC X(4)  VALUE '0221'.
   599     12  ER-0222                 PIC X(4)  VALUE '0222'.
   600     12  ER-0223                 PIC X(4)  VALUE '0223'.
   601     12  ER-0224                 PIC X(4)  VALUE '0224'.
   602     12  ER-0225                 PIC X(4)  VALUE '0225'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  13
* EL130.cbl
   603     12  ER-0226                 PIC X(4)  VALUE '0226'.
   604     12  ER-0227                 PIC X(4)  VALUE '0227'.
   605     12  ER-0229                 PIC X(4)  VALUE '0229'.
   606     12  ER-0230                 PIC X(4)  VALUE '0230'.
   607     12  ER-0231                 PIC X(4)  VALUE '0231'.
   608     12  ER-0232                 PIC X(4)  VALUE '0232'.
   609     12  ER-0233                 PIC X(4)  VALUE '0233'.
   610     12  ER-0234                 PIC X(4)  VALUE '0234'.
   611     12  ER-0235                 PIC X(4)  VALUE '0235'.
   612     12  ER-0236                 PIC X(4)  VALUE '0236'.
   613     12  ER-0237                 PIC X(4)  VALUE '0237'.
   614     12  ER-0238                 PIC X(4)  VALUE '0238'.
   615     12  ER-0239                 PIC X(4)  VALUE '0239'.
   616     12  ER-0240                 PIC X(4)  VALUE '0240'.
   617     12  ER-0241                 PIC X(4)  VALUE '0241'.
   618     12  ER-0243                 PIC X(4)  VALUE '0243'.
   619     12  ER-0244                 PIC X(4)  VALUE '0244'.
   620     12  ER-0245                 PIC X(4)  VALUE '0245'.
   621     12  ER-0246                 PIC X(4)  VALUE '0246'.
   622     12  ER-0247                 PIC X(4)  VALUE '0247'.
   623     12  ER-0248                 PIC X(4)  VALUE '0248'.
   624     12  ER-0250                 PIC X(4)  VALUE '0250'.
   625     12  ER-0251                 PIC X(4)  VALUE '0251'.
   626     12  ER-0252                 PIC X(4)  VALUE '0252'.
   627     12  ER-0253                 PIC X(4)  VALUE '0253'.
   628     12  ER-0254                 PIC X(4)  VALUE '0254'.
   629     12  ER-0257                 PIC X(4)  VALUE '0257'.
   630     12  ER-0258                 PIC X(4)  VALUE '0258'.
   631     12  ER-0260                 PIC X(4)  VALUE '0260'.
   632     12  ER-0261                 PIC X(4)  VALUE '0261'.
   633     12  ER-0263                 PIC X(4)  VALUE '0263'.
   634     12  ER-0264                 PIC X(4)  VALUE '0264'.
   635     12  ER-0265                 PIC X(4)  VALUE '0265'.
   636     12  ER-0266                 PIC X(4)  VALUE '0266'.
   637     12  ER-0267                 PIC X(4)  VALUE '0267'.
   638     12  ER-0334                 PIC X(4)  VALUE '0334'.
   639     12  ER-0337                 PIC X(4)  VALUE '0337'.
   640     12  ER-0412                 PIC X(4)  VALUE '0412'.
   641     12  ER-0413                 PIC X(4)  VALUE '0413'.
   642     12  ER-0428                 PIC X(4)  VALUE '0428'.
   643     12  ER-0429                 PIC X(4)  VALUE '0429'.
   644     12  ER-0430                 PIC X(4)  VALUE '0430'.
   645     12  ER-0433                 PIC X(4)  VALUE '0433'.
   646     12  ER-0434                 PIC X(4)  VALUE '0434'.
   647     12  ER-0458                 PIC X(4)  VALUE '0458'.
   648     12  ER-0489                 PIC X(4)  VALUE '0489'.
   649     12  ER-0509                 PIC X(4)  VALUE '0509'.
   650     12  ER-0510                 PIC X(4)  VALUE '0510'.
   651     12  ER-0511                 PIC X(4)  VALUE '0511'.
   652     12  ER-0512                 PIC X(4)  VALUE '0512'.
   653     12  ER-0516                 PIC X(4)  VALUE '0516'.
   654     12  ER-0517                 PIC X(4)  VALUE '0517'.
   655     12  ER-0518                 PIC X(4)  VALUE '0518'.
   656     12  ER-0519                 PIC X(4)  VALUE '0519'.
   657     12  ER-0520                 PIC X(4)  VALUE '0520'.
   658     12  ER-0521                 PIC X(4)  VALUE '0521'.
   659     12  ER-0522                 PIC X(4)  VALUE '0522'.
   660     12  ER-0523                 PIC X(4)  VALUE '0523'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  14
* EL130.cbl
   661     12  ER-0544                 PIC X(4)  VALUE '0544'.
   662     12  ER-0546                 PIC X(4)  VALUE '0546'.
   663     12  ER-0558                 PIC X(4)  VALUE '0558'.
   664     12  ER-0560                 PIC X(4)  VALUE '0560'.
   665     12  ER-0562                 PIC X(4)  VALUE '0562'.
   666     12  ER-0565                 PIC X(4)  VALUE '0565'.
   667     12  ER-0569                 PIC X(4)  VALUE '0569'.
   668     12  ER-0693                 PIC X(4)  VALUE '0693'.
   669     12  ER-0715                 PIC X(4)  VALUE '0715'.
   670     12  ER-0840                 PIC X(4)  VALUE '0840'.
   671     12  ER-0841                 PIC X(4)  VALUE '0841'.
   672     12  ER-0842                 PIC X(4)  VALUE '0842'.
   673     12  ER-0843                 PIC X(4)  VALUE '0843'.
   674     12  ER-0878                 PIC X(4)  VALUE '0878'.
   675     12  ER-0887                 PIC X(4)  VALUE '0887'.
   676     12  ER-0992                 PIC X(4)  VALUE '0992'.
   677     12  ER-1651                 PIC X(4)  VALUE '1651'.
   678     12  ER-1652                 PIC X(4)  VALUE '1652'.
   679     12  ER-1653                 PIC X(4)  VALUE '1653'.
   680     12  ER-1654                 PIC X(4)  VALUE '1654'.
   681     12  ER-1655                 PIC X(4)  VALUE '1655'.
   682     12  er-1659                 pic x(4)  value '1659'.
   683     12  er-1660                 pic x(4)  value '1660'.
   684     12  er-1661                 pic x(4)  value '1661'.
   685     12  er-1671                 pic x(4)  value '1671'.
   686     12  er-1672                 pic x(4)  value '1672'.
   687     12  er-1673                 pic x(4)  value '1673'.
   688     12  er-1675                 pic x(4)  value '1675'.
   689     12  er-1676                 pic x(4)  value '1676'.
   690     12  ER-1677                 PIC X(4)  VALUE '1677'.
   691     12  ER-1679                 PIC X(4)  VALUE '1679'.
   692     12  ER-2280                 PIC X(4)  VALUE '2280'.
   693     12  ER-2370                 PIC X(4)  VALUE '2370'.
   694     12  ER-2371                 PIC X(4)  VALUE '2371'.
   695     12  ER-2378                 PIC X(4)  VALUE '2378'.
   696     12  ER-2380                 PIC X(4)  VALUE '2380'.
   697     12  ER-2566                 PIC X(4)  VALUE '2566'.
   698     12  ER-2848                 PIC X(4)  VALUE '2848'.
   699     12  ER-3548                 PIC X(4)  VALUE '3548'.
   700     12  ER-7008                 PIC X(4)  VALUE '7008'.
   701     12  ER-7319                 PIC X(4)  VALUE '7319'.
   702     12  ER-7321                 PIC X(4)  VALUE '7321'.
   703     12  ER-7352                 PIC X(4)  VALUE '7352'.
   704     12  ER-7353                 PIC X(4)  VALUE '7353'.
   705     12  ER-7572                 PIC X(4)  VALUE '7572'.
   706     12  ER-7575                 PIC X(4)  VALUE '7575'.
   707     12  ER-7577                 PIC X(4)  VALUE '7577'.
   708     12  ER-7582                 PIC X(4)  VALUE '7582'.
   709     12  ER-7634                 PIC X(4)  VALUE '7634'.
   710     12  ER-7635                 PIC X(4)  VALUE '7635'.
   711     12  ER-7636                 PIC X(4)  VALUE '7636'.
   712     12  ER-7637                 PIC X(4)  VALUE '7637'.
   713     12  ER-7638                 PIC X(4)  VALUE '7638'.
   714     12  ER-7639                 PIC X(4)  VALUE '7639'.
   715     12  ER-7640                 PIC X(4)  VALUE '7640'.
   716     12  ER-7641                 PIC X(4)  VALUE '7641'.
   717     12  ER-7642                 PIC X(4)  VALUE '7642'.
   718     12  ER-7643                 PIC X(4)  VALUE '7643'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  15
* EL130.cbl
   719     12  ER-7646                 PIC X(4)  VALUE '7646'.
   720     12  ER-7647                 PIC X(4)  VALUE '7647'.
   721     12  ER-7648                 PIC X(4)  VALUE '7648'.
   722     12  ER-7649                 PIC X(4)  VALUE '7649'.
   723     12  ER-7651                 PIC X(4)  VALUE '7651'.
   724     12  ER-7670                 PIC X(4)  VALUE '7670'.
   725     12  ER-7671                 PIC X(4)  VALUE '7671'.
   726     12  ER-7686                 PIC X(4)  VALUE '7686'.
   727     12  ER-7688                 PIC X(4)  VALUE '7688'.
   728     12  ER-7689                 PIC X(4)  VALUE '7689'.
   729     12  ER-7691                 PIC X(4)  VALUE '7691'.
   730*    COPY ERCPDEF.
   731******************************************************************
   732*                                                                *
   733*                                                                *
   734*                            ERCPDEF.                            *
   735*                                                                *
   736*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   737*                                                                *
   738*    FILE TYPE = VSAM,KSDS                                       *
   739*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   740*                                                                *
   741*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   742*                                                                *
   743*    LOG = YES                                                   *
   744*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   745******************************************************************
   746*                   C H A N G E   L O G
   747*
   748* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   749*-----------------------------------------------------------------
   750*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   751* EFFECTIVE    NUMBER
   752*-----------------------------------------------------------------
   753* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   754* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   755* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   756* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   757******************************************************************
   758 01  PRODUCT-MASTER.
   759    12  PD-RECORD-ID                 PIC X(02).
   760        88  VALID-PD-ID                  VALUE 'PD'.
   761    12  PD-CONTROL-PRIMARY.
   762        16  PD-COMPANY-CD            PIC X.
   763        16  PD-STATE                 PIC XX.
   764        16  PD-PRODUCT-CD            PIC XXX.
   765        16  PD-FILLER                PIC X(7).
   766        16  PD-BEN-TYPE              PIC X.
   767        16  PD-BEN-CODE              PIC XX.
   768        16  PD-PROD-EXP-DT           PIC XX.
   769    12  FILLER                       PIC X(50).
   770    12  PD-PRODUCT-DATA OCCURS 8.
   771        16  PD-PROD-CODE             PIC X.
   772            88  PD-PROD-LIFE           VALUE 'L'.
   773            88  PD-PROD-PROP           VALUE 'P'.
   774            88  PD-PROD-AH             VALUE 'A'.
   775            88  PD-PROD-IU             VALUE 'I'.
   776            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  16
* EL130.cbl
   777            88  PD-PROD-FAML           VALUE 'F'.
   778            88  PD-PROD-OTH            VALUE 'O'.
   779        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   780        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   781        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   782        16  PD-MAX-TERM              PIC S999        COMP-3.
   783        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   784        16  FILLER                   PIC X.
   785        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   786        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   787        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   788        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   789        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   790        16  PD-REC-CRIT-PERIOD       PIC 99.
   791        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   792            20  PD-RECURRING-YN      PIC X.
   793            20  FILLER               PIC X.
   794        16  PD-RTW-MOS               PIC 99.
   795        16  PD-MAX-EXTENSION         PIC 99.
   796        16  pd-ben-pct               pic sv999 comp-3.
   797*       16  FILLER                   PIC XX.
   798    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   799    12  PD-TERM-LIMITS OCCURS 15.
   800        16  PD-LOW-TERM              PIC S999        COMP-3.
   801        16  PD-HI-TERM               PIC S999        COMP-3.
   802*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   803    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   804        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   805        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   806    12  PD-EARN-FACTORS.
   807        16  FILLER OCCURS 15.
   808            20  FILLER OCCURS 15.
   809                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   810    12  PD-PRODUCT-DESC              PIC X(80).
   811    12  PD-TRUNCATED                 PIC X.
   812    12  FILLER                       PIC X(59).
   813    12  PD-MAINT-INFORMATION.
   814        16  PD-LAST-MAINT-DT         PIC X(02).
   815        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   816        16  PD-LAST-MAINT-BY         PIC X(04).
   817*    COPY ELCLNKLT.
   818******************************************************************
   819*                                                                *
   820*                                                                *
   821*                           ELCLNKLT                             *
   822*                            VMOD=2.003                          *
   823*                                                                *
   824*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   825*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   826*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   827*                                                                *
   828*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   829*   COMPLETING THE REQUIRED FIELDS.                              *
   830*                                                                *
   831*   THE CALLING PROGRAM SHOULD CHECK:                            *
   832*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   833*                              9999 INDICATES AN UNKNOWN ABEND   *
   834*                                   WAS DETECTED.                *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  17
* EL130.cbl
   835*                              ALL OTHER VALUES ARE NORMAL ERROR *
   836*                              CODES FOUND IN THE ERROR FILE.    *
   837******************************************************************
   838 01  W-1523-LINKDATA.
   839     12  W-1523-COMMON-PI-DATA.
   840         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   841         16  FILLER              PIC  X(67).
   842         16  W-1523-COMPANY-CD   PIC  X(01).
   843         16  FILLER              PIC  X(10).
   844         16  W-1523-CONTROL-IN-PROGRESS.
   845             20  W-1523-CARRIER  PIC  X(01).
   846             20  W-1523-GROUPING PIC  X(06).
   847             20  W-1523-STATE    PIC  X(02).
   848             20  W-1523-ACCOUNT  PIC  X(10).
   849             20  W-1523-CLAIM-CERT-GRP.
   850                 24  W-1523-CLAIM-NO
   851                                 PIC  X(07).
   852                 24  W-1523-CERT-NO.
   853                     28  W-1523-CERT-PRIME
   854                                 PIC  X(10).
   855                     28  W-1523-CERT-SFX
   856                                 PIC  X(01).
   857                 24  W-1523-CERT-EFF-DT
   858                                 PIC  X(02).
   859         16  FILLER              PIC X(265).
   860
   861     12  W-1523-WORK-AREA.
   862         16  W-1523-FORM-NUMBER  PIC  X(04).
   863         16  W-1523-NUMBER-COPIES
   864                                 PIC  9(01).
   865         16  W-1523-ADDR-TYPE    PIC  X(02).
   866         16  W-1523-FOLLOW-UP-DATE
   867                                 PIC  X(02).
   868         16  W-1523-RESEND-DATE  PIC  X(02).
   869         16  W-1523-ERROR-CODE   PIC  9(04).
   870             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   871             88  W-1523-FATAL-ERROR
   872                                    VALUES  0006 0013 0042
   873                                            0154 0168 0169
   874                                            0176 9999 0172
   875                                            0179 0186 0281
   876                                            0332 2055 3697
   877                                            3698 3699 3770
   878                                            3771 3772 7675
   879                                            9106 9808 9883
   880                                            9887.
   881             88  W-1523-STOP-ERRORS
   882                                    VALUES  0013 0042 0154
   883                                            0168 0169 0172
   884                                            0281 0332 2055
   885                                            3698 3699 7675
   886                                            9106 9808 9883
   887                                            9999.
   888         16  W-1523-REASON       PIC  X(70).
   889         16  W-1523-ARCHIVE-NUMBER
   890                                 PIC  9(08).
   891     12  W-1523-POINTER-AREA.
   892         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  18
* EL130.cbl
   893         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   894         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   895         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   896         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  19
* EL130.cbl
   898*    COPY ELCINTF.
   899******************************************************************
   900*                                                                *
   901*                                                                *
   902*                            ELCINTF.                            *
   903*                            VMOD=2.017                          *
   904*                                                                *
   905*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   906*                                                                *
   907*       LENGTH = 1024                                            *
   908*                                                                *
   909******************************************************************
   910*                   C H A N G E   L O G
   911*
   912* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   913*-----------------------------------------------------------------
   914*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   915* EFFECTIVE    NUMBER
   916*-----------------------------------------------------------------
   917* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   918******************************************************************
   919 01  PROGRAM-INTERFACE-BLOCK.
   920     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   921     12  PI-CALLING-PROGRAM              PIC X(8).
   922     12  PI-SAVED-PROGRAM-1              PIC X(8).
   923     12  PI-SAVED-PROGRAM-2              PIC X(8).
   924     12  PI-SAVED-PROGRAM-3              PIC X(8).
   925     12  PI-SAVED-PROGRAM-4              PIC X(8).
   926     12  PI-SAVED-PROGRAM-5              PIC X(8).
   927     12  PI-SAVED-PROGRAM-6              PIC X(8).
   928     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   929     12  PI-COMPANY-ID                   PIC XXX.
   930     12  PI-COMPANY-CD                   PIC X.
   931
   932     12  PI-COMPANY-PASSWORD             PIC X(8).
   933
   934     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   935
   936     12  PI-CONTROL-IN-PROGRESS.
   937         16  PI-CARRIER                  PIC X.
   938         16  PI-GROUPING                 PIC X(6).
   939         16  PI-STATE                    PIC XX.
   940         16  PI-ACCOUNT                  PIC X(10).
   941         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   942                                         PIC X(10).
   943         16  PI-CLAIM-CERT-GRP.
   944             20  PI-CLAIM-NO             PIC X(7).
   945             20  PI-CERT-NO.
   946                 25  PI-CERT-PRIME       PIC X(10).
   947                 25  PI-CERT-SFX         PIC X.
   948             20  PI-CERT-EFF-DT          PIC XX.
   949         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   950             20  PI-PLAN-CODE            PIC X(2).
   951             20  PI-REVISION-NUMBER      PIC X(3).
   952             20  PI-PLAN-EFF-DT          PIC X(2).
   953             20  PI-PLAN-EXP-DT          PIC X(2).
   954             20  FILLER                  PIC X(11).
   955         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  20
* EL130.cbl
   956             20  PI-OE-REFERENCE-1.
   957                 25  PI-OE-REF-1-PRIME   PIC X(18).
   958                 25  PI-OE-REF-1-SUFF    PIC XX.
   959
   960     12  PI-SESSION-IN-PROGRESS          PIC X.
   961         88  CLAIM-SESSION                   VALUE '1'.
   962         88  CREDIT-SESSION                  VALUE '2'.
   963         88  WARRANTY-SESSION                VALUE '3'.
   964         88  MORTGAGE-SESSION                VALUE '4'.
   965         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   966
   967
   968*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   969
   970     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   971     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   972
   973     12  PI-CREDIT-USER                  PIC X.
   974         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   975         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   976
   977     12  PI-CLAIM-USER                   PIC X.
   978         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   979         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   980
   981     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   982         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   983         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   984         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   985         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   986         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   987
   988     12  PI-PROCESSOR-ID                 PIC X(4).
   989
   990     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   991
   992     12  PI-MEMBER-CAPTION               PIC X(10).
   993
   994     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   995         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   996
   997     12  PI-LIFE-OVERRIDE-L1             PIC X.
   998     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   999     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1000     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1001
  1002     12  PI-AH-OVERRIDE-L1               PIC X.
  1003     12  PI-AH-OVERRIDE-L2               PIC XX.
  1004     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1005     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1006
  1007     12  PI-NEW-SYSTEM                   PIC X(2).
  1008
  1009     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1010     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1011         88  PI-USES-PAID-TO                 VALUE '1'.
  1012     12  PI-CRDTCRD-SYSTEM.
  1013         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  21
* EL130.cbl
  1014             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1015             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1016         16  PI-CC-MONTH-END-DT          PIC XX.
  1017     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1018
  1019     12  PI-OE-REFERENCE-2.
  1020         16  PI-OE-REF-2-PRIME           PIC X(10).
  1021         16  PI-OE-REF-2-SUFF            PIC X.
  1022
  1023     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1024
  1025     12  PI-LANGUAGE-TYPE                PIC X.
  1026             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1027             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1028             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1029
  1030     12  PI-POLICY-LINKAGE-IND           PIC X.
  1031         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1032         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1033                                                   LOW-VALUES.
  1034
  1035     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1036     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1037         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1038         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1039
  1040     12  PI-PROCESSOR-CSR-IND            PIC X.
  1041         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1042         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1043
  1044     12  FILLER                          PIC X(3).
  1045
  1046     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1047
  1048     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1049         PI-SYSTEM-LEVEL.
  1050
  1051         16  PI-ENTRY-CODES.
  1052             20  PI-ENTRY-CD-1           PIC X.
  1053             20  PI-ENTRY-CD-2           PIC X.
  1054
  1055         16  PI-RETURN-CODES.
  1056             20  PI-RETURN-CD-1          PIC X.
  1057             20  PI-RETURN-CD-2          PIC X.
  1058
  1059         16  PI-UPDATE-STATUS-SAVE.
  1060             20  PI-UPDATE-BY            PIC X(4).
  1061             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1062
  1063         16  PI-LOWER-CASE-LETTERS       PIC X.
  1064             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1065
  1066*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1067*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1068*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1069
  1070         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1071             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  22
* EL130.cbl
  1072             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1073             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1074             88  ACCNT-CNTL                  VALUE '3'.
  1075             88  CARR-ACCNT-CNTL             VALUE '4'.
  1076
  1077         16  PI-PROCESSOR-CAP-LIST.
  1078             20  PI-SYSTEM-CONTROLS.
  1079                24 PI-SYSTEM-DISPLAY     PIC X.
  1080                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1081                24 PI-SYSTEM-MODIFY      PIC X.
  1082                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1083             20  FILLER                  PIC XX.
  1084             20  PI-DISPLAY-CAP          PIC X.
  1085                 88  DISPLAY-CAP             VALUE 'Y'.
  1086             20  PI-MODIFY-CAP           PIC X.
  1087                 88  MODIFY-CAP              VALUE 'Y'.
  1088             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1089                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1090             20  PI-FORCE-CAP            PIC X.
  1091                 88  FORCE-CAP               VALUE 'Y'.
  1092
  1093         16  PI-PROGRAM-CONTROLS.
  1094             20  PI-PGM-PRINT-OPT        PIC X.
  1095             20  PI-PGM-FORMAT-OPT       PIC X.
  1096             20  PI-PGM-PROCESS-OPT      PIC X.
  1097             20  PI-PGM-TOTALS-OPT       PIC X.
  1098
  1099         16  PI-HELP-INTERFACE.
  1100             20  PI-LAST-ERROR-NO        PIC X(4).
  1101             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1102
  1103         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1104             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1105
  1106         16  PI-CR-CONTROL-IN-PROGRESS.
  1107             20  PI-CR-CARRIER           PIC X.
  1108             20  PI-CR-GROUPING          PIC X(6).
  1109             20  PI-CR-STATE             PIC XX.
  1110             20  PI-CR-ACCOUNT           PIC X(10).
  1111             20  PI-CR-FIN-RESP          PIC X(10).
  1112             20  PI-CR-TYPE              PIC X.
  1113
  1114         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1115
  1116         16  PI-CR-MONTH-END-DT          PIC XX.
  1117
  1118         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1119             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1120             88  PI-ZERO-CARRIER             VALUE '1'.
  1121             88  PI-ZERO-GROUPING            VALUE '2'.
  1122             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1123
  1124         16  PI-CARRIER-SECURITY         PIC X.
  1125             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1126
  1127         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1128             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1129             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  23
* EL130.cbl
  1130
  1131         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1132             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1133                                         INDEXED BY PI-ACCESS-NDX
  1134                                         PIC X.
  1135
  1136         16  PI-GA-BILLING-CONTROL       PIC X.
  1137             88  PI-GA-BILLING               VALUE '1'.
  1138
  1139         16  PI-MAIL-PROCESSING          PIC X.
  1140             88  PI-MAIL-YES                 VALUE 'Y'.
  1141
  1142         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1143
  1144         16  PI-AR-SYSTEM.
  1145             20  PI-AR-PROCESSING-CNTL   PIC X.
  1146                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1147             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1148             20  PI-AR-MONTH-END-DT      PIC XX.
  1149
  1150         16  PI-MP-SYSTEM.
  1151             20  PI-MORTGAGE-USER            PIC X.
  1152                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1153                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1154             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1155                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1156                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1157                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1158                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1159                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1160             20  PI-MP-MONTH-END-DT          PIC XX.
  1161             20  PI-MP-REFERENCE-NO.
  1162                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1163                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1164
  1165         16  PI-LABEL-CONTROL            PIC X(01).
  1166             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1167             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1168
  1169         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1170             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1171
  1172         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1173             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1174             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1175
  1176         16  FILLER                      PIC X(14).
  1177
  1178     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1179******************************************************************
  1180     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1181         16  PI-MSTR-DT               PIC XX.
  1182         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1183         16  PI-TRLR-DT               PIC XX.
  1184         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1185         16  PI-LAST-CLAIM            PIC X(7).
  1186         16  PI-LAST-CARR             PIC X.
  1187         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  24
* EL130.cbl
  1188             20  PI-LAST-CERT-PRIME   PIC X(10).
  1189             20  PI-LAST-CERT-SUFX    PIC X.
  1190         16  PI-LAST-CLAIM-TYPE       PIC X.
  1191         16  PI-CURSOR                PIC S9(4)   COMP.
  1192         16  PI-SAVE-CERT.
  1193             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1194             20  PI-SAVE-CERT-SUFX    PIC X.
  1195         16  PI-SAVE-EFFDT            PIC X(2).
  1196         16  PI-SAVE-ACCOUNT          PIC X(10).
  1197         16  PI-INCURR-SW             PIC X.
  1198         16  PI-PRT-OPT               PIC X.
  1199         16  PI-ALT-PRT               PIC X(4).
  1200         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1201             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1202         16  FILLER                   PIC X(272).
  1203         16  PI-EL127-TO-EL130-CNTRL.
  1204             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1205             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1206             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1207                 24  PI-EL127-CARRIER        PIC X.
  1208                 24  PI-EL127-GROUPING       PIC X(6).
  1209                 24  PI-EL127-STATE          PIC X(2).
  1210                 24  PI-EL127-ACCOUNT        PIC X(10).
  1211                 24  PI-EL127-CERT-NO.
  1212                     28  PI-EL127-CERT-PRIME PIC X(10).
  1213                     28  PI-EL127-CERT-SUFX  PIC X.
  1214                 24  PI-EL127-EFF-DT         PIC XX.
  1215*        16  FILLER                          PIC X(50).
  1216         16  FILLER                          PIC X(31).
  1217         16  PI-EL659-TO-EL130-CNTRL.
  1218             20  PI-EL659-CARRIER            PIC X.
  1219             20  PI-EL659-GROUPING           PIC X(6).
  1220             20  PI-EL659-STATE              PIC XX.
  1221             20  PI-EL659-ACCOUNT            PIC X(10).
  1222
  1223         16  FILLER                          PIC X(19).
  1224
  1225         16  PI-SAVE-INCUR-DT                PIC X(02).
  1226         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1227*         16  FILLER                          PIC X(65).
  1228         16  PI-ST-VFY-2ND-BENE              PIC X.
  1229         16  PI-ST-CAUSAL-STATE              PIC X.
  1230         16  pi-dcc-max-benefits             pic s999 comp-3.
  1231         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1232         16  pi-emi-sub                      pic 99.
  1233         16  FILLER                          PIC X(53).
  1234
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  25
* EL130.cbl
  1236*    COPY EL130S.
  1237 01  EL130AI.
  1238     05  FILLER            PIC  X(0012).
  1239*    -------------------------------
  1240     05  RUNDTEL PIC S9(0004) COMP.
  1241     05  RUNDTEF PIC  X(0001).
  1242     05  FILLER REDEFINES RUNDTEF.
  1243         10  RUNDTEA PIC  X(0001).
  1244     05  RUNDTEI PIC  X(0008).
  1245*    -------------------------------
  1246     05  RUNTIMEL PIC S9(0004) COMP.
  1247     05  RUNTIMEF PIC  X(0001).
  1248     05  FILLER REDEFINES RUNTIMEF.
  1249         10  RUNTIMEA PIC  X(0001).
  1250     05  RUNTIMEI PIC  X(0005).
  1251*    -------------------------------
  1252     05  COMPL PIC S9(0004) COMP.
  1253     05  COMPF PIC  X(0001).
  1254     05  FILLER REDEFINES COMPF.
  1255         10  COMPA PIC  X(0001).
  1256     05  COMPI PIC  X(0003).
  1257*    -------------------------------
  1258     05  SEQUL PIC S9(0004) COMP.
  1259     05  SEQUF PIC  X(0001).
  1260     05  FILLER REDEFINES SEQUF.
  1261         10  SEQUA PIC  X(0001).
  1262     05  SEQUI PIC  X(0010).
  1263*    -------------------------------
  1264     05  MAINTL PIC S9(0004) COMP.
  1265     05  MAINTF PIC  X(0001).
  1266     05  FILLER REDEFINES MAINTF.
  1267         10  MAINTA PIC  X(0001).
  1268     05  MAINTI PIC  X(0001).
  1269*    -------------------------------
  1270     05  CLMNOL PIC S9(0004) COMP.
  1271     05  CLMNOF PIC  X(0001).
  1272     05  FILLER REDEFINES CLMNOF.
  1273         10  CLMNOA PIC  X(0001).
  1274     05  CLMNOI PIC  X(0007).
  1275*    -------------------------------
  1276     05  CLMCARRL PIC S9(0004) COMP.
  1277     05  CLMCARRF PIC  X(0001).
  1278     05  FILLER REDEFINES CLMCARRF.
  1279         10  CLMCARRA PIC  X(0001).
  1280     05  CLMCARRI PIC  X(0001).
  1281*    -------------------------------
  1282     05  CLMTYPEL PIC S9(0004) COMP.
  1283     05  CLMTYPEF PIC  X(0001).
  1284     05  FILLER REDEFINES CLMTYPEF.
  1285         10  CLMTYPEA PIC  X(0001).
  1286     05  CLMTYPEI PIC  X(0001).
  1287*    -------------------------------
  1288     05  CERTNOL PIC S9(0004) COMP.
  1289     05  CERTNOF PIC  X(0001).
  1290     05  FILLER REDEFINES CERTNOF.
  1291         10  CERTNOA PIC  X(0001).
  1292     05  CERTNOI PIC  X(0010).
  1293*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  26
* EL130.cbl
  1294     05  SUFXL PIC S9(0004) COMP.
  1295     05  SUFXF PIC  X(0001).
  1296     05  FILLER REDEFINES SUFXF.
  1297         10  SUFXA PIC  X(0001).
  1298     05  SUFXI PIC  X(0001).
  1299*    -------------------------------
  1300     05  PCERTNOL PIC S9(0004) COMP.
  1301     05  PCERTNOF PIC  X(0001).
  1302     05  FILLER REDEFINES PCERTNOF.
  1303         10  PCERTNOA PIC  X(0001).
  1304     05  PCERTNOI PIC  X(0010).
  1305*    -------------------------------
  1306     05  PSUFXL PIC S9(0004) COMP.
  1307     05  PSUFXF PIC  X(0001).
  1308     05  FILLER REDEFINES PSUFXF.
  1309         10  PSUFXA PIC  X(0001).
  1310     05  PSUFXI PIC  X(0001).
  1311*    -------------------------------
  1312     05  INCURL PIC S9(0004) COMP.
  1313     05  INCURF PIC  X(0001).
  1314     05  FILLER REDEFINES INCURF.
  1315         10  INCURA PIC  X(0001).
  1316     05  INCURI PIC  X(0008).
  1317*    -------------------------------
  1318     05  REPORTL PIC S9(0004) COMP.
  1319     05  REPORTF PIC  X(0001).
  1320     05  FILLER REDEFINES REPORTF.
  1321         10  REPORTA PIC  X(0001).
  1322     05  REPORTI PIC  X(0008).
  1323*    -------------------------------
  1324     05  ICD1L PIC S9(0004) COMP.
  1325     05  ICD1F PIC  X(0001).
  1326     05  FILLER REDEFINES ICD1F.
  1327         10  ICD1A PIC  X(0001).
  1328     05  ICD1I PIC  X(0008).
  1329*    -------------------------------
  1330     05  ICD2L PIC S9(0004) COMP.
  1331     05  ICD2F PIC  X(0001).
  1332     05  FILLER REDEFINES ICD2F.
  1333         10  ICD2A PIC  X(0001).
  1334     05  ICD2I PIC  X(0008).
  1335*    -------------------------------
  1336     05  DIAGL PIC S9(0004) COMP.
  1337     05  DIAGF PIC  X(0001).
  1338     05  FILLER REDEFINES DIAGF.
  1339         10  DIAGA PIC  X(0001).
  1340     05  DIAGI PIC  X(0060).
  1341*    -------------------------------
  1342     05  BENECDL PIC S9(0004) COMP.
  1343     05  BENECDF PIC  X(0001).
  1344     05  FILLER REDEFINES BENECDF.
  1345         10  BENECDA PIC  X(0001).
  1346     05  BENECDI PIC  X(0010).
  1347*    -------------------------------
  1348     05  BIRTHDTL PIC S9(0004) COMP.
  1349     05  BIRTHDTF PIC  X(0001).
  1350     05  FILLER REDEFINES BIRTHDTF.
  1351         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  27
* EL130.cbl
  1352     05  BIRTHDTI PIC  X(0008).
  1353*    -------------------------------
  1354     05  SSNL PIC S9(0004) COMP.
  1355     05  SSNF PIC  X(0001).
  1356     05  FILLER REDEFINES SSNF.
  1357         10  SSNA PIC  X(0001).
  1358     05  SSNI PIC  X(0011).
  1359*    -------------------------------
  1360     05  SEXL PIC S9(0004) COMP.
  1361     05  SEXF PIC  X(0001).
  1362     05  FILLER REDEFINES SEXF.
  1363         10  SEXA PIC  X(0001).
  1364     05  SEXI PIC  X(0001).
  1365*    -------------------------------
  1366     05  INSTYPEL PIC S9(0004) COMP.
  1367     05  INSTYPEF PIC  X(0001).
  1368     05  FILLER REDEFINES INSTYPEF.
  1369         10  INSTYPEA PIC  X(0001).
  1370     05  INSTYPEI PIC  X(0001).
  1371*    -------------------------------
  1372     05  LSTNMEL PIC S9(0004) COMP.
  1373     05  LSTNMEF PIC  X(0001).
  1374     05  FILLER REDEFINES LSTNMEF.
  1375         10  LSTNMEA PIC  X(0001).
  1376     05  LSTNMEI PIC  X(0015).
  1377*    -------------------------------
  1378     05  FSTNMEL PIC S9(0004) COMP.
  1379     05  FSTNMEF PIC  X(0001).
  1380     05  FILLER REDEFINES FSTNMEF.
  1381         10  FSTNMEA PIC  X(0001).
  1382     05  FSTNMEI PIC  X(0012).
  1383*    -------------------------------
  1384     05  INITL PIC S9(0004) COMP.
  1385     05  INITF PIC  X(0001).
  1386     05  FILLER REDEFINES INITF.
  1387         10  INITA PIC  X(0001).
  1388     05  INITI PIC  X(0001).
  1389*    -------------------------------
  1390     05  LOANNOL PIC S9(0004) COMP.
  1391     05  LOANNOF PIC  X(0001).
  1392     05  FILLER REDEFINES LOANNOF.
  1393         10  LOANNOA PIC  X(0001).
  1394     05  LOANNOI PIC  X(0008).
  1395*    -------------------------------
  1396     05  CRTLNMEL PIC S9(0004) COMP.
  1397     05  CRTLNMEF PIC  X(0001).
  1398     05  FILLER REDEFINES CRTLNMEF.
  1399         10  CRTLNMEA PIC  X(0001).
  1400     05  CRTLNMEI PIC  X(0015).
  1401*    -------------------------------
  1402     05  CRTFNMEL PIC S9(0004) COMP.
  1403     05  CRTFNMEF PIC  X(0001).
  1404     05  FILLER REDEFINES CRTFNMEF.
  1405         10  CRTFNMEA PIC  X(0001).
  1406     05  CRTFNMEI PIC  X(0012).
  1407*    -------------------------------
  1408     05  CRTINITL PIC S9(0004) COMP.
  1409     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  28
* EL130.cbl
  1410     05  FILLER REDEFINES CRTINITF.
  1411         10  CRTINITA PIC  X(0001).
  1412     05  CRTINITI PIC  X(0001).
  1413*    -------------------------------
  1414     05  LOANBALL PIC S9(0004) COMP.
  1415     05  LOANBALF PIC  X(0001).
  1416     05  FILLER REDEFINES LOANBALF.
  1417         10  LOANBALA PIC  X(0001).
  1418     05  LOANBALI PIC  9(7)V99.
  1419*    -------------------------------
  1420     05  MANRSVL PIC S9(0004) COMP.
  1421     05  MANRSVF PIC  X(0001).
  1422     05  FILLER REDEFINES MANRSVF.
  1423         10  MANRSVA PIC  X(0001).
  1424     05  MANRSVI PIC  9(7)V99.
  1425*    -------------------------------
  1426     05  SUPVL PIC S9(0004) COMP.
  1427     05  SUPVF PIC  X(0001).
  1428     05  FILLER REDEFINES SUPVF.
  1429         10  SUPVA PIC  X(0001).
  1430     05  SUPVI PIC  X(0001).
  1431*    -------------------------------
  1432     05  PRICDL PIC S9(0004) COMP.
  1433     05  PRICDF PIC  X(0001).
  1434     05  FILLER REDEFINES PRICDF.
  1435         10  PRICDA PIC  X(0001).
  1436     05  PRICDI PIC  X(0001).
  1437*    -------------------------------
  1438     05  PRODL PIC S9(0004) COMP.
  1439     05  PRODF PIC  X(0001).
  1440     05  FILLER REDEFINES PRODF.
  1441         10  PRODA PIC  X(0001).
  1442     05  PRODI PIC  X(0008).
  1443*    -------------------------------
  1444     05  PRODCDL PIC S9(0004) COMP.
  1445     05  PRODCDF PIC  X(0001).
  1446     05  FILLER REDEFINES PRODCDF.
  1447         10  PRODCDA PIC  X(0001).
  1448     05  PRODCDI PIC  X(0001).
  1449*    -------------------------------
  1450     05  FILETOL PIC S9(0004) COMP.
  1451     05  FILETOF PIC  X(0001).
  1452     05  FILLER REDEFINES FILETOF.
  1453         10  FILETOA PIC  X(0001).
  1454     05  FILETOI PIC  X(0004).
  1455*    -------------------------------
  1456     05  PROCCDL PIC S9(0004) COMP.
  1457     05  PROCCDF PIC  X(0001).
  1458     05  FILLER REDEFINES PROCCDF.
  1459         10  PROCCDA PIC  X(0001).
  1460     05  PROCCDI PIC  X(0004).
  1461*    -------------------------------
  1462     05  RELCLML PIC S9(0004) COMP.
  1463     05  RELCLMF PIC  X(0001).
  1464     05  FILLER REDEFINES RELCLMF.
  1465         10  RELCLMA PIC  X(0001).
  1466     05  RELCLMI PIC  X(0007).
  1467*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  29
* EL130.cbl
  1468     05  PRTOPTL PIC S9(0004) COMP.
  1469     05  PRTOPTF PIC  X(0001).
  1470     05  FILLER REDEFINES PRTOPTF.
  1471         10  PRTOPTA PIC  X(0001).
  1472     05  PRTOPTI PIC  X(0001).
  1473*    -------------------------------
  1474     05  ALTPRTL PIC S9(0004) COMP.
  1475     05  ALTPRTF PIC  X(0001).
  1476     05  FILLER REDEFINES ALTPRTF.
  1477         10  ALTPRTA PIC  X(0001).
  1478     05  ALTPRTI PIC  X(0004).
  1479*    -------------------------------
  1480     05  CERTMTL PIC S9(0004) COMP.
  1481     05  CERTMTF PIC  X(0001).
  1482     05  FILLER REDEFINES CERTMTF.
  1483         10  CERTMTA PIC  X(0001).
  1484     05  CERTMTI PIC  X(0001).
  1485*    -------------------------------
  1486     05  CRTCARRL PIC S9(0004) COMP.
  1487     05  CRTCARRF PIC  X(0001).
  1488     05  FILLER REDEFINES CRTCARRF.
  1489         10  CRTCARRA PIC  X(0001).
  1490     05  CRTCARRI PIC  X(0001).
  1491*    -------------------------------
  1492     05  GROUPL PIC S9(0004) COMP.
  1493     05  GROUPF PIC  X(0001).
  1494     05  FILLER REDEFINES GROUPF.
  1495         10  GROUPA PIC  X(0001).
  1496     05  GROUPI PIC  X(0006).
  1497*    -------------------------------
  1498     05  STATEL PIC S9(0004) COMP.
  1499     05  STATEF PIC  X(0001).
  1500     05  FILLER REDEFINES STATEF.
  1501         10  STATEA PIC  X(0001).
  1502     05  STATEI PIC  X(0002).
  1503*    -------------------------------
  1504     05  ACCOUNTL PIC S9(0004) COMP.
  1505     05  ACCOUNTF PIC  X(0001).
  1506     05  FILLER REDEFINES ACCOUNTF.
  1507         10  ACCOUNTA PIC  X(0001).
  1508     05  ACCOUNTI PIC  X(0010).
  1509*    -------------------------------
  1510     05  EFFDTL PIC S9(0004) COMP.
  1511     05  EFFDTF PIC  X(0001).
  1512     05  FILLER REDEFINES EFFDTF.
  1513         10  EFFDTA PIC  X(0001).
  1514     05  EFFDTI PIC  X(0008).
  1515*    -------------------------------
  1516     05  CRTSSNL PIC S9(0004) COMP.
  1517     05  CRTSSNF PIC  X(0001).
  1518     05  FILLER REDEFINES CRTSSNF.
  1519         10  CRTSSNA PIC  X(0001).
  1520     05  CRTSSNI PIC  X(0011).
  1521*    -------------------------------
  1522     05  MEMCAPL PIC S9(0004) COMP.
  1523     05  MEMCAPF PIC  X(0001).
  1524     05  FILLER REDEFINES MEMCAPF.
  1525         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  30
* EL130.cbl
  1526     05  MEMCAPI PIC  X(0010).
  1527*    -------------------------------
  1528     05  MEMBERL PIC S9(0004) COMP.
  1529     05  MEMBERF PIC  X(0001).
  1530     05  FILLER REDEFINES MEMBERF.
  1531         10  MEMBERA PIC  X(0001).
  1532     05  MEMBERI PIC  X(0012).
  1533*    -------------------------------
  1534     05  REINCDL PIC S9(0004) COMP.
  1535     05  REINCDF PIC  X(0001).
  1536     05  FILLER REDEFINES REINCDF.
  1537         10  REINCDA PIC  X(0001).
  1538     05  REINCDI PIC  X(0001).
  1539*    -------------------------------
  1540     05  ISSAGEL PIC S9(0004) COMP.
  1541     05  ISSAGEF PIC  X(0001).
  1542     05  FILLER REDEFINES ISSAGEF.
  1543         10  ISSAGEA PIC  X(0001).
  1544     05  ISSAGEI PIC  X(0002).
  1545*    -------------------------------
  1546     05  APRL PIC S9(0004) COMP.
  1547     05  APRF PIC  X(0001).
  1548     05  FILLER REDEFINES APRF.
  1549         10  APRA PIC  X(0001).
  1550     05  APRI PIC  9(4)V9(4).
  1551*    -------------------------------
  1552     05  PMTFREQL PIC S9(0004) COMP.
  1553     05  PMTFREQF PIC  X(0001).
  1554     05  FILLER REDEFINES PMTFREQF.
  1555         10  PMTFREQA PIC  X(0001).
  1556     05  PMTFREQI PIC  99.
  1557*    -------------------------------
  1558     05  INDGRPL PIC S9(0004) COMP.
  1559     05  INDGRPF PIC  X(0001).
  1560     05  FILLER REDEFINES INDGRPF.
  1561         10  INDGRPA PIC  X(0001).
  1562     05  INDGRPI PIC  X(0001).
  1563*    -------------------------------
  1564     05  PREMTYPL PIC S9(0004) COMP.
  1565     05  PREMTYPF PIC  X(0001).
  1566     05  FILLER REDEFINES PREMTYPF.
  1567         10  PREMTYPA PIC  X(0001).
  1568     05  PREMTYPI PIC  X(0001).
  1569*    -------------------------------
  1570     05  ADDONDTL PIC S9(0004) COMP.
  1571     05  ADDONDTF PIC  X(0001).
  1572     05  FILLER REDEFINES ADDONDTF.
  1573         10  ADDONDTA PIC  X(0001).
  1574     05  ADDONDTI PIC  X(0008).
  1575*    -------------------------------
  1576     05  JNTLNMEL PIC S9(0004) COMP.
  1577     05  JNTLNMEF PIC  X(0001).
  1578     05  FILLER REDEFINES JNTLNMEF.
  1579         10  JNTLNMEA PIC  X(0001).
  1580     05  JNTLNMEI PIC  X(0015).
  1581*    -------------------------------
  1582     05  JNTFNMEL PIC S9(0004) COMP.
  1583     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  31
* EL130.cbl
  1584     05  FILLER REDEFINES JNTFNMEF.
  1585         10  JNTFNMEA PIC  X(0001).
  1586     05  JNTFNMEI PIC  X(0002).
  1587*    -------------------------------
  1588     05  JNTINITL PIC S9(0004) COMP.
  1589     05  JNTINITF PIC  X(0001).
  1590     05  FILLER REDEFINES JNTINITF.
  1591         10  JNTINITA PIC  X(0001).
  1592     05  JNTINITI PIC  X(0001).
  1593*    -------------------------------
  1594     05  JNTAGEL PIC S9(0004) COMP.
  1595     05  JNTAGEF PIC  X(0001).
  1596     05  FILLER REDEFINES JNTAGEF.
  1597         10  JNTAGEA PIC  X(0001).
  1598     05  JNTAGEI PIC  X(0002).
  1599*    -------------------------------
  1600     05  LCVDSCRL PIC S9(0004) COMP.
  1601     05  LCVDSCRF PIC  X(0001).
  1602     05  FILLER REDEFINES LCVDSCRF.
  1603         10  LCVDSCRA PIC  X(0001).
  1604     05  LCVDSCRI PIC  X(0006).
  1605*    -------------------------------
  1606     05  LCVKINDL PIC S9(0004) COMP.
  1607     05  LCVKINDF PIC  X(0001).
  1608     05  FILLER REDEFINES LCVKINDF.
  1609         10  LCVKINDA PIC  X(0001).
  1610     05  LCVKINDI PIC  X(0003).
  1611*    -------------------------------
  1612     05  LCVCDL PIC S9(0004) COMP.
  1613     05  LCVCDF PIC  X(0001).
  1614     05  FILLER REDEFINES LCVCDF.
  1615         10  LCVCDA PIC  X(0001).
  1616     05  LCVCDI PIC  X(0002).
  1617*    -------------------------------
  1618     05  LCVOTRML PIC S9(0004) COMP.
  1619     05  LCVOTRMF PIC  X(0001).
  1620     05  FILLER REDEFINES LCVOTRMF.
  1621         10  LCVOTRMA PIC  X(0001).
  1622     05  LCVOTRMI PIC  999.
  1623*    -------------------------------
  1624     05  LCVRTRML PIC S9(0004) COMP.
  1625     05  LCVRTRMF PIC  X(0001).
  1626     05  FILLER REDEFINES LCVRTRMF.
  1627         10  LCVRTRMA PIC  X(0001).
  1628     05  LCVRTRMI PIC  X(0003).
  1629*    -------------------------------
  1630     05  LCVRATEL PIC S9(0004) COMP.
  1631     05  LCVRATEF PIC  X(0001).
  1632     05  FILLER REDEFINES LCVRATEF.
  1633         10  LCVRATEA PIC  X(0001).
  1634     05  LCVRATEI PIC  9999V99.
  1635*    -------------------------------
  1636     05  LCVBENEL PIC S9(0004) COMP.
  1637     05  LCVBENEF PIC  X(0001).
  1638     05  FILLER REDEFINES LCVBENEF.
  1639         10  LCVBENEA PIC  X(0001).
  1640     05  LCVBENEI PIC  9(9)V99.
  1641*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  32
* EL130.cbl
  1642     05  LCVFORML PIC S9(0004) COMP.
  1643     05  LCVFORMF PIC  X(0001).
  1644     05  FILLER REDEFINES LCVFORMF.
  1645         10  LCVFORMA PIC  X(0001).
  1646     05  LCVFORMI PIC  X(0012).
  1647*    -------------------------------
  1648     05  LCVCNDTL PIC S9(0004) COMP.
  1649     05  LCVCNDTF PIC  X(0001).
  1650     05  FILLER REDEFINES LCVCNDTF.
  1651         10  LCVCNDTA PIC  X(0001).
  1652     05  LCVCNDTI PIC  X(0008).
  1653*    -------------------------------
  1654     05  LCVEXITL PIC S9(0004) COMP.
  1655     05  LCVEXITF PIC  X(0001).
  1656     05  FILLER REDEFINES LCVEXITF.
  1657         10  LCVEXITA PIC  X(0001).
  1658     05  LCVEXITI PIC  X(0008).
  1659*    -------------------------------
  1660     05  LCVSTATL PIC S9(0004) COMP.
  1661     05  LCVSTATF PIC  X(0001).
  1662     05  FILLER REDEFINES LCVSTATF.
  1663         10  LCVSTATA PIC  X(0001).
  1664     05  LCVSTATI PIC  X(0006).
  1665*    -------------------------------
  1666     05  ACVDSCRL PIC S9(0004) COMP.
  1667     05  ACVDSCRF PIC  X(0001).
  1668     05  FILLER REDEFINES ACVDSCRF.
  1669         10  ACVDSCRA PIC  X(0001).
  1670     05  ACVDSCRI PIC  X(0006).
  1671*    -------------------------------
  1672     05  ACVKINDL PIC S9(0004) COMP.
  1673     05  ACVKINDF PIC  X(0001).
  1674     05  FILLER REDEFINES ACVKINDF.
  1675         10  ACVKINDA PIC  X(0001).
  1676     05  ACVKINDI PIC  X(0003).
  1677*    -------------------------------
  1678     05  ACVCDL PIC S9(0004) COMP.
  1679     05  ACVCDF PIC  X(0001).
  1680     05  FILLER REDEFINES ACVCDF.
  1681         10  ACVCDA PIC  X(0001).
  1682     05  ACVCDI PIC  X(0002).
  1683*    -------------------------------
  1684     05  ACVOTRML PIC S9(0004) COMP.
  1685     05  ACVOTRMF PIC  X(0001).
  1686     05  FILLER REDEFINES ACVOTRMF.
  1687         10  ACVOTRMA PIC  X(0001).
  1688     05  ACVOTRMI PIC  999.
  1689*    -------------------------------
  1690     05  ACVRTRML PIC S9(0004) COMP.
  1691     05  ACVRTRMF PIC  X(0001).
  1692     05  FILLER REDEFINES ACVRTRMF.
  1693         10  ACVRTRMA PIC  X(0001).
  1694     05  ACVRTRMI PIC  X(0003).
  1695*    -------------------------------
  1696     05  ACVRATEL PIC S9(0004) COMP.
  1697     05  ACVRATEF PIC  X(0001).
  1698     05  FILLER REDEFINES ACVRATEF.
  1699         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  33
* EL130.cbl
  1700     05  ACVRATEI PIC  9999V99.
  1701*    -------------------------------
  1702     05  ACVBENEL PIC S9(0004) COMP.
  1703     05  ACVBENEF PIC  X(0001).
  1704     05  FILLER REDEFINES ACVBENEF.
  1705         10  ACVBENEA PIC  X(0001).
  1706     05  ACVBENEI PIC  9(9)V99.
  1707*    -------------------------------
  1708     05  ACVFORML PIC S9(0004) COMP.
  1709     05  ACVFORMF PIC  X(0001).
  1710     05  FILLER REDEFINES ACVFORMF.
  1711         10  ACVFORMA PIC  X(0001).
  1712     05  ACVFORMI PIC  X(0012).
  1713*    -------------------------------
  1714     05  ACVCNDTL PIC S9(0004) COMP.
  1715     05  ACVCNDTF PIC  X(0001).
  1716     05  FILLER REDEFINES ACVCNDTF.
  1717         10  ACVCNDTA PIC  X(0001).
  1718     05  ACVCNDTI PIC  X(0008).
  1719*    -------------------------------
  1720     05  ACVEXITL PIC S9(0004) COMP.
  1721     05  ACVEXITF PIC  X(0001).
  1722     05  FILLER REDEFINES ACVEXITF.
  1723         10  ACVEXITA PIC  X(0001).
  1724     05  ACVEXITI PIC  X(0008).
  1725*    -------------------------------
  1726     05  ACVSTATL PIC S9(0004) COMP.
  1727     05  ACVSTATF PIC  X(0001).
  1728     05  FILLER REDEFINES ACVSTATF.
  1729         10  ACVSTATA PIC  X(0001).
  1730     05  ACVSTATI PIC  X(0006).
  1731*    -------------------------------
  1732     05  ERRMSG1L PIC S9(0004) COMP.
  1733     05  ERRMSG1F PIC  X(0001).
  1734     05  FILLER REDEFINES ERRMSG1F.
  1735         10  ERRMSG1A PIC  X(0001).
  1736     05  ERRMSG1I PIC  X(0072).
  1737*    -------------------------------
  1738     05  ERRMSG2L PIC S9(0004) COMP.
  1739     05  ERRMSG2F PIC  X(0001).
  1740     05  FILLER REDEFINES ERRMSG2F.
  1741         10  ERRMSG2A PIC  X(0001).
  1742     05  ERRMSG2I PIC  X(0072).
  1743*    -------------------------------
  1744     05  BCERT1L PIC S9(0004) COMP.
  1745     05  BCERT1F PIC  X(0001).
  1746     05  FILLER REDEFINES BCERT1F.
  1747         10  BCERT1A PIC  X(0001).
  1748     05  BCERT1I PIC  X(0010).
  1749*    -------------------------------
  1750     05  BSUFX1L PIC S9(0004) COMP.
  1751     05  BSUFX1F PIC  X(0001).
  1752     05  FILLER REDEFINES BSUFX1F.
  1753         10  BSUFX1A PIC  X(0001).
  1754     05  BSUFX1I PIC  X(0001).
  1755*    -------------------------------
  1756     05  BCERT2L PIC S9(0004) COMP.
  1757     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  34
* EL130.cbl
  1758     05  FILLER REDEFINES BCERT2F.
  1759         10  BCERT2A PIC  X(0001).
  1760     05  BCERT2I PIC  X(0010).
  1761*    -------------------------------
  1762     05  BSUFX2L PIC S9(0004) COMP.
  1763     05  BSUFX2F PIC  X(0001).
  1764     05  FILLER REDEFINES BSUFX2F.
  1765         10  BSUFX2A PIC  X(0001).
  1766     05  BSUFX2I PIC  X(0001).
  1767*    -------------------------------
  1768     05  BCERT3L PIC S9(0004) COMP.
  1769     05  BCERT3F PIC  X(0001).
  1770     05  FILLER REDEFINES BCERT3F.
  1771         10  BCERT3A PIC  X(0001).
  1772     05  BCERT3I PIC  X(0010).
  1773*    -------------------------------
  1774     05  BSUFX3L PIC S9(0004) COMP.
  1775     05  BSUFX3F PIC  X(0001).
  1776     05  FILLER REDEFINES BSUFX3F.
  1777         10  BSUFX3A PIC  X(0001).
  1778     05  BSUFX3I PIC  X(0001).
  1779*    -------------------------------
  1780     05  BCERT4L PIC S9(0004) COMP.
  1781     05  BCERT4F PIC  X(0001).
  1782     05  FILLER REDEFINES BCERT4F.
  1783         10  BCERT4A PIC  X(0001).
  1784     05  BCERT4I PIC  X(0010).
  1785*    -------------------------------
  1786     05  BSUFX4L PIC S9(0004) COMP.
  1787     05  BSUFX4F PIC  X(0001).
  1788     05  FILLER REDEFINES BSUFX4F.
  1789         10  BSUFX4A PIC  X(0001).
  1790     05  BSUFX4I PIC  X(0001).
  1791*    -------------------------------
  1792     05  BCERT5L PIC S9(0004) COMP.
  1793     05  BCERT5F PIC  X(0001).
  1794     05  FILLER REDEFINES BCERT5F.
  1795         10  BCERT5A PIC  X(0001).
  1796     05  BCERT5I PIC  X(0010).
  1797*    -------------------------------
  1798     05  BSUFX5L PIC S9(0004) COMP.
  1799     05  BSUFX5F PIC  X(0001).
  1800     05  FILLER REDEFINES BSUFX5F.
  1801         10  BSUFX5A PIC  X(0001).
  1802     05  BSUFX5I PIC  X(0001).
  1803*    -------------------------------
  1804     05  ENTERPFL PIC S9(0004) COMP.
  1805     05  ENTERPFF PIC  X(0001).
  1806     05  FILLER REDEFINES ENTERPFF.
  1807         10  ENTERPFA PIC  X(0001).
  1808     05  ENTERPFI PIC  99.
  1809*    -------------------------------
  1810     05  PF5L PIC S9(0004) COMP.
  1811     05  PF5F PIC  X(0001).
  1812     05  FILLER REDEFINES PF5F.
  1813         10  PF5A PIC  X(0001).
  1814     05  PF5I PIC  X(0013).
  1815 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  35
* EL130.cbl
  1816     05  FILLER            PIC  X(0012).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  RUNDTEO PIC  X(0008).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  RUNTIMEO PIC  99.99.
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  COMPO PIC  X(0003).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  SEQUO PIC  X(0010).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  MAINTO PIC  X(0001).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  CLMNOO PIC  X(0007).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  CLMCARRO PIC  X(0001).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  CLMTYPEO PIC  X(0001).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  CERTNOO PIC  X(0010).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  SUFXO PIC  X(0001).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  PCERTNOO PIC  X(0010).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  PSUFXO PIC  X(0001).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  INCURO PIC  X(0008).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  REPORTO PIC  X(0008).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  ICD1O PIC  X(0008).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  ICD2O PIC  X(0008).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  DIAGO PIC  X(0060).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  BENECDO PIC  X(0010).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  36
* EL130.cbl
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  SSNO PIC  X(0011).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  SEXO PIC  X(0001).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  INSTYPEO PIC  X(0001).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  LSTNMEO PIC  X(0015).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  FSTNMEO PIC  X(0012).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  INITO PIC  X(0001).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  LOANNOO PIC  X(0008).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  CRTLNMEO PIC  X(0015).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  CRTFNMEO PIC  X(0012).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  CRTINITO PIC  X(0001).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  LOANBALO PIC  ZZZZZ9.99.
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  MANRSVO PIC  Z(5)9.99.
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  SUPVO PIC  X(0001).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  PRICDO PIC  X(0001).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  PRODO PIC  X(0008).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  PRODCDO PIC  X(0001).
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  FILETOO PIC  X(0004).
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  PROCCDO PIC  X(0004).
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  RELCLMO PIC  X(0007).
  1931*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  37
* EL130.cbl
  1932     05  FILLER            PIC  X(0003).
  1933     05  PRTOPTO PIC  X(0001).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  ALTPRTO PIC  X(0004).
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  CERTMTO PIC  X(0001).
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  CRTCARRO PIC  X(0001).
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  GROUPO PIC  X(0006).
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  STATEO PIC  X(0002).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  ACCOUNTO PIC  X(0010).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  EFFDTO PIC  X(0008).
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  CRTSSNO PIC  X(0011).
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  MEMCAPO PIC  X(0010).
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  MEMBERO PIC  X(0012).
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  REINCDO PIC  X(0001).
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  ISSAGEO PIC  X(0002).
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  APRO PIC  9(3).9(4).
  1973*    -------------------------------
  1974     05  FILLER            PIC  X(0003).
  1975     05  PMTFREQO PIC  99.
  1976*    -------------------------------
  1977     05  FILLER            PIC  X(0003).
  1978     05  INDGRPO PIC  X(0001).
  1979*    -------------------------------
  1980     05  FILLER            PIC  X(0003).
  1981     05  PREMTYPO PIC  X(0001).
  1982*    -------------------------------
  1983     05  FILLER            PIC  X(0003).
  1984     05  ADDONDTO PIC  X(0008).
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  JNTLNMEO PIC  X(0015).
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  38
* EL130.cbl
  1990     05  JNTFNMEO PIC  X(0002).
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  JNTINITO PIC  X(0001).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  JNTAGEO PIC  X(0002).
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  LCVDSCRO PIC  X(0006).
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  LCVKINDO PIC  X(0003).
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  LCVCDO PIC  X(0002).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  LCVOTRMO PIC  999.
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  LCVRTRMO PIC  ZZZ.
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  LCVRATEO PIC  ZZZ.ZZ.
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  LCVFORMO PIC  X(0012).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  LCVCNDTO PIC  X(0008).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  LCVEXITO PIC  X(0008).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  LCVSTATO PIC  X(0006).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  ACVDSCRO PIC  X(0006).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  ACVKINDO PIC  X(0003).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  ACVCDO PIC  X(0002).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  ACVOTRMO PIC  999.
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  ACVRTRMO PIC  ZZZ.
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  39
* EL130.cbl
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  ACVFORMO PIC  X(0012).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  ACVCNDTO PIC  X(0008).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  ACVEXITO PIC  X(0008).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  ACVSTATO PIC  X(0006).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  ERRMSG1O PIC  X(0072).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  ERRMSG2O PIC  X(0072).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  BCERT1O PIC  X(0010).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  BSUFX1O PIC  X(0001).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  BCERT2O PIC  X(0010).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  BSUFX2O PIC  X(0001).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  BCERT3O PIC  X(0010).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  BSUFX3O PIC  X(0001).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  BCERT4O PIC  X(0010).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  BSUFX4O PIC  X(0001).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  BCERT5O PIC  X(0010).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  BSUFX5O PIC  X(0001).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  ENTERPFO PIC  X(0002).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  PF5O PIC  X(0013).
  2105*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  40
* EL130.cbl
  2107*    COPY ELCDATE.
  2108******************************************************************
  2109*                                                                *
  2110*                                                                *
  2111*                            ELCDATE.                            *
  2112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2113*                            VMOD=2.003
  2114*                                                                *
  2115*                                                                *
  2116*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2117*                 LENGTH = 200                                   *
  2118******************************************************************
  2119
  2120 01  DATE-CONVERSION-DATA.
  2121     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2122     12  DC-OPTION-CODE                PIC X.
  2123         88  BIN-TO-GREG                VALUE ' '.
  2124         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2125         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2126         88  YMD-GREG-TO-BIN            VALUE '3'.
  2127         88  MDY-GREG-TO-BIN            VALUE '4'.
  2128         88  JULIAN-TO-BIN              VALUE '5'.
  2129         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2130         88  FIND-CENTURY               VALUE '7'.
  2131         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2132         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2133         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2134         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2135         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2136         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2137         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2138         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2139         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2140         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2141         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2142         88  BIN-3-TO-GREG              VALUE 'I'.
  2143         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2144         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2145         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2146         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2147         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2148         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2149         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2150         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2151         88  THREE-CHARACTER-BIN
  2152                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2153         88  GREGORIAN-TO-BIN
  2154                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2155         88  BIN-TO-GREGORIAN
  2156                  VALUES ' ' '1' 'I' '8' 'G'.
  2157         88  JULIAN-TO-BINARY
  2158                  VALUES '5' 'C' 'E' 'F'.
  2159     12  DC-ERROR-CODE                 PIC X.
  2160         88  NO-CONVERSION-ERROR        VALUE ' '.
  2161         88  DATE-CONVERSION-ERROR
  2162                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2163         88  DATE-IS-ZERO               VALUE '1'.
  2164         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  41
* EL130.cbl
  2165         88  DATE-IS-INVALID            VALUE '3'.
  2166         88  DATE1-GREATER-DATE2        VALUE '4'.
  2167         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2168         88  DATE-INVALID-OPTION        VALUE '9'.
  2169         88  INVALID-CENTURY            VALUE 'A'.
  2170         88  ONLY-CENTURY               VALUE 'B'.
  2171         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2172         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2173     12  DC-END-OF-MONTH               PIC X.
  2174         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2175     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2176         88  USE-NORMAL-PROCESS         VALUE ' '.
  2177         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2178         88  ADJUST-UP-100-YRS          VALUE '2'.
  2179     12  FILLER                        PIC X.
  2180     12  DC-CONVERSION-DATES.
  2181         16  DC-BIN-DATE-1             PIC XX.
  2182         16  DC-BIN-DATE-2             PIC XX.
  2183         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2184         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2185                       DC-GREG-DATE-1-EDIT.
  2186             20  DC-EDIT1-MONTH        PIC 99.
  2187             20  SLASH1-1              PIC X.
  2188             20  DC-EDIT1-DAY          PIC 99.
  2189             20  SLASH1-2              PIC X.
  2190             20  DC-EDIT1-YEAR         PIC 99.
  2191         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2192         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2193                     DC-GREG-DATE-2-EDIT.
  2194             20  DC-EDIT2-MONTH        PIC 99.
  2195             20  SLASH2-1              PIC X.
  2196             20  DC-EDIT2-DAY          PIC 99.
  2197             20  SLASH2-2              PIC X.
  2198             20  DC-EDIT2-YEAR         PIC 99.
  2199         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2200         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2201                     DC-GREG-DATE-1-YMD.
  2202             20  DC-YMD-YEAR           PIC 99.
  2203             20  DC-YMD-MONTH          PIC 99.
  2204             20  DC-YMD-DAY            PIC 99.
  2205         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2206         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2207                      DC-GREG-DATE-1-MDY.
  2208             20  DC-MDY-MONTH          PIC 99.
  2209             20  DC-MDY-DAY            PIC 99.
  2210             20  DC-MDY-YEAR           PIC 99.
  2211         16  DC-GREG-DATE-1-ALPHA.
  2212             20  DC-ALPHA-MONTH        PIC X(10).
  2213             20  DC-ALPHA-DAY          PIC 99.
  2214             20  FILLER                PIC XX.
  2215             20  DC-ALPHA-CENTURY.
  2216                 24 DC-ALPHA-CEN-N     PIC 99.
  2217             20  DC-ALPHA-YEAR         PIC 99.
  2218         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2219         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2220         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2221         16  DC-JULIAN-DATE            PIC 9(05).
  2222         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  42
* EL130.cbl
  2223                                       PIC 9(05).
  2224         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2225             20  DC-JULIAN-YEAR        PIC 99.
  2226             20  DC-JULIAN-DAYS        PIC 999.
  2227         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2228         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2229         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2230     12  DATE-CONVERSION-VARIBLES.
  2231         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2232         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2233             20  FILLER                PIC 9(3).
  2234             20  HOLD-CEN-1-CCYY.
  2235                 24  HOLD-CEN-1-CC     PIC 99.
  2236                 24  HOLD-CEN-1-YY     PIC 99.
  2237             20  HOLD-CEN-1-MO         PIC 99.
  2238             20  HOLD-CEN-1-DA         PIC 99.
  2239         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2240             20  HOLD-CEN-1-R-MO       PIC 99.
  2241             20  HOLD-CEN-1-R-DA       PIC 99.
  2242             20  HOLD-CEN-1-R-CCYY.
  2243                 24  HOLD-CEN-1-R-CC   PIC 99.
  2244                 24  HOLD-CEN-1-R-YY   PIC 99.
  2245             20  FILLER                PIC 9(3).
  2246         16  HOLD-CENTURY-1-X.
  2247             20  FILLER                PIC X(3)  VALUE SPACES.
  2248             20  HOLD-CEN-1-X-CCYY.
  2249                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2250                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2251             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2252             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2253         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2254             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2255             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2256             20  HOLD-CEN-1-R-X-CCYY.
  2257                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2258                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2259             20  FILLER                PIC XXX.
  2260         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2261         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2262         16  DC-JULIAN-DATE-1          PIC 9(07).
  2263         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2264             20  DC-JULIAN-1-CCYY.
  2265                 24  DC-JULIAN-1-CC    PIC 99.
  2266                 24  DC-JULIAN-1-YR    PIC 99.
  2267             20  DC-JULIAN-DA-1        PIC 999.
  2268         16  DC-JULIAN-DATE-2          PIC 9(07).
  2269         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2270             20  DC-JULIAN-2-CCYY.
  2271                 24  DC-JULIAN-2-CC    PIC 99.
  2272                 24  DC-JULIAN-2-YR    PIC 99.
  2273             20  DC-JULIAN-DA-2        PIC 999.
  2274         16  DC-GREG-DATE-A-EDIT.
  2275             20  DC-EDITA-MONTH        PIC 99.
  2276             20  SLASHA-1              PIC X VALUE '/'.
  2277             20  DC-EDITA-DAY          PIC 99.
  2278             20  SLASHA-2              PIC X VALUE '/'.
  2279             20  DC-EDITA-CCYY.
  2280                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  43
* EL130.cbl
  2281                 24  DC-EDITA-YEAR     PIC 99.
  2282         16  DC-GREG-DATE-B-EDIT.
  2283             20  DC-EDITB-MONTH        PIC 99.
  2284             20  SLASHB-1              PIC X VALUE '/'.
  2285             20  DC-EDITB-DAY          PIC 99.
  2286             20  SLASHB-2              PIC X VALUE '/'.
  2287             20  DC-EDITB-CCYY.
  2288                 24  DC-EDITB-CENT     PIC 99.
  2289                 24  DC-EDITB-YEAR     PIC 99.
  2290         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2291         16  DC-GREG-DATE-CYMD-R REDEFINES
  2292                              DC-GREG-DATE-CYMD.
  2293             20  DC-CYMD-CEN           PIC 99.
  2294             20  DC-CYMD-YEAR          PIC 99.
  2295             20  DC-CYMD-MONTH         PIC 99.
  2296             20  DC-CYMD-DAY           PIC 99.
  2297         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2298         16  DC-GREG-DATE-MDCY-R REDEFINES
  2299                              DC-GREG-DATE-MDCY.
  2300             20  DC-MDCY-MONTH         PIC 99.
  2301             20  DC-MDCY-DAY           PIC 99.
  2302             20  DC-MDCY-CEN           PIC 99.
  2303             20  DC-MDCY-YEAR          PIC 99.
  2304    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2305        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2306    12  DC-EL310-DATE                  PIC X(21).
  2307    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  44
* EL130.cbl
  2309*    COPY ELCCALC.
  2310******************************************************************
  2311*                                                                *
  2312*                           ELCCALC.                            *
  2313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2314*                            VMOD=2.025                          *
  2315*                                                                *
  2316*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2317*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2318*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2319*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2320*                                                                *
  2321*  PASSED TO ELRTRM                                              *
  2322*  -----------------                                             *
  2323*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2324*  ORIGINAL TERM                                                 *
  2325*  BEGINNING DATE                                                *
  2326*  ENDING DATE                                                   *
  2327*  COMPANY I.D.                                                  *
  2328*  ACCOUNT MASTER USER FIELD                                     *
  2329*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2330*  FREE LOOK DAYS                                                *
  2331*                                                                *
  2332*  RETURNED FROM ELRTRM                                          *
  2333*  ---------------------                                         *
  2334*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2335*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2336*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2337*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2338*----------------------------------------------------------------*
  2339*  PASSED TO ELRAMT                                              *
  2340*  ----------------                                              *
  2341*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2342*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2343*  ORIGINAL AMOUNT                                               *
  2344*  ALTERNATE BENEFIT (BALLON)                                    *
  2345*  A.P.R. - NET PAY ONLY                                         *
  2346*  METHOD
  2347*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2348*  COMPANY I.D.                                                  *
  2349*  BENEFIT TYPE                                                  *
  2350*                                                                *
  2351*  RETURNED FROM ELRAMT                                          *
  2352*  --------------------                                          *
  2353*  REMAINING AMOUNT 1 - CURRENT                                  *
  2354*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2355*  REMAINING AMOUNT FACTOR
  2356*----------------------------------------------------------------*
  2357*  PASSED TO ELRESV                                              *
  2358*  -----------------                                             *
  2359*  CERTIFICATE EFFECTIVE DATE                                    *
  2360*  VALUATION DATE                                                *
  2361*  PAID THRU DATE                                                *
  2362*  BENEFIT                                                       *
  2363*  INCURRED DATE                                                 *
  2364*  REPORTED DATE                                                 *
  2365*  ISSUE AGE                                                     *
  2366*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  45
* EL130.cbl
  2367*  CDT PERCENT                                                   *
  2368*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2369* *CLAIM TYPE (LIFE, A/H)                                        *
  2370* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2371* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2372*                                                                *
  2373*  RETURNED FROM ELRESV                                          *
  2374*  --------------------                                          *
  2375*  CDT TABLE USED                                                *
  2376*  CDT FACTOR USED                                               *
  2377*  PAY TO CURRENT RESERVE                                        *
  2378*  I.B.N.R. - A/H ONLY                                           *
  2379*  FUTURE (ACCRUED) AH ONLY                                      *
  2380*----------------------------------------------------------------*
  2381*  PASSED TO ELRATE                                              *
  2382*  ----------------                                              *
  2383*  CERT ISSUE DATE                                               *
  2384*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2385*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2386*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2387*  STATE CODE (CLIENT DEFINED)                                   *
  2388*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2389*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2390*  DEVIATION CODE                                                *
  2391*  ISSUE AGE                                                     *
  2392*  ORIGINAL BENEFIT AMOUNT                                       *
  2393*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2394*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2395*  BENEFIT KIND (LIFE OR A/H)                                    *
  2396*  A.P.R.                                                        *
  2397*  METHOD
  2398*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2399*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2400*  COMPANY I.D. (3 CHARACTER)                                    *
  2401*  BENEFIT CODE                                                  *
  2402*  BENEFIT OVERRIDE CODE                                         *
  2403*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2404*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2405*  JOINT INDICATOR (CSL ONLY)                                    *
  2406*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2407*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2408*                                                                *
  2409*  RETURNED FROM ELRATE                                          *
  2410*  --------------------                                          *
  2411*  CALCULATED PREMIUM                                            *
  2412*  PREMIUM RATE                                                  *
  2413*  MORTALITY CODE                                                *
  2414*  MAX ATTAINED AGE                                              *
  2415*  MAX AGE                                                       *
  2416*  MAX TERM                                                      *
  2417*  MAX MONTHLY BENEFIT                                           *
  2418*  MAX TOTAL BENIFIT                                             *
  2419*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2420*----------------------------------------------------------------*
  2421*  PASSED TO ELRFND                                              *
  2422*  ----------------                                              *
  2423*  CERT ISSUE DATE                                               *
  2424*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  46
* EL130.cbl
  2425*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2426*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2427*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2428*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2429*  STATE CODE (CLIENT DEFINED)                                   *
  2430*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2431*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2432*  DEVIATION CODE                                                *
  2433*  ISSUE AGE                                                     *
  2434*  ORIGINAL BENEFIT AMOUNT                                       *
  2435*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2436*  PROCESS TYPE (CANCEL)                                         *
  2437*  BENEFIT KIND (LIFE OR A/H)                                    *
  2438*  A.P.R.                                                        *
  2439*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2440*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2441*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2442*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2443*  COMPANY I.D. (3 CHARACTER)                                    *
  2444*  BENEFIT CODE                                                  *
  2445*  BENEFIT OVERRIDE CODE                                         *
  2446*                                                                *
  2447*  RETURNED FROM ELRFND                                          *
  2448*  --------------------                                          *
  2449*  CALCULATED REFUND                                             *
  2450*----------------------------------------------------------------*
  2451*  PASSED TO ELEARN                                              *
  2452*  ----------------                                              *
  2453*  CERT ISSUE DATE                                               *
  2454*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2455*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2456*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2457*  STATE CODE (CLIENT DEFINED)                                   *
  2458*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2459*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2460*  DEVIATION CODE                                                *
  2461*  ISSUE AGE                                                     *
  2462*  ORIGINAL BENEFIT AMOUNT                                       *
  2463*  BENEFIT KIND (LIFE OR A/H)                                    *
  2464*  A.P.R.                                                        *
  2465*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2466*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2467*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2468*  COMPANY I.D. (3 CHARACTER)                                    *
  2469*  BENEFIT CODE                                                  *
  2470*  BENEFIT OVERRIDE CODE                                         *
  2471*                                                                *
  2472*  RETURNED FROM ELEARN                                          *
  2473*  --------------------                                          *
  2474*  INDICATED  EARNINGS                                           *
  2475*----------------------------------------------------------------*
  2476*                 LENGTH = 450                                   *
  2477*                                                                *
  2478******************************************************************
  2479******************************************************************
  2480*                   C H A N G E   L O G
  2481*
  2482* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  47
* EL130.cbl
  2483*-----------------------------------------------------------------
  2484*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2485* EFFECTIVE    NUMBER
  2486*-----------------------------------------------------------------
  2487* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2488* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2489* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2490* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2491* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2492* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2493* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2494* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2495* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2496* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2497* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2498* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  2499******************************************************************
  2500
  2501 01  CALCULATION-PASS-AREA.
  2502     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2503                                     COMP.
  2504
  2505     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2506       88  NO-CP-ERROR                             VALUE ZERO.
  2507       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2508                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
  2509       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2510       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2511       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2512       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2513       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2514       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2515       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2516       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2517       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2518       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2519       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2520       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2521       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2522       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2523       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2524       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2525       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2526       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
  2527
  2528     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2529       88  NO-CP-ERROR-2                           VALUE ZERO.
  2530***********************  INPUT AREAS ****************************
  2531
  2532     12  CP-CALCULATION-AREA.
  2533         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2534         16  CP-CERT-EFF-DT        PIC XX.
  2535         16  CP-VALUATION-DT       PIC XX.
  2536         16  CP-PAID-THRU-DT       PIC XX.
  2537         16  CP-BENEFIT-TYPE       PIC X.
  2538           88  CP-AH                               VALUE 'A' 'D'
  2539                                                   'I' 'U'.
  2540           88  CP-REDUCING-LIFE                    VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  48
* EL130.cbl
  2541           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2542         16  CP-INCURRED-DT        PIC XX.
  2543         16  CP-REPORTED-DT        PIC XX.
  2544         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2545         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2546         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2547                                     COMP-3.
  2548         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2549                                     COMP-3.
  2550         16  CP-CDT-METHOD         PIC X.
  2551           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2552           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2553           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2554         16  CP-CLAIM-TYPE         PIC X.
  2555           88  CP-AH-CLAIM                         VALUE 'A'.
  2556           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2557         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2558                                     COMP-3.
  2559         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2560                                     COMP-3.
  2561         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2562                                     COMP-3.
  2563         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2564                                     COMP-3.
  2565         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2566                                     COMP-3.
  2567         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2568                                     COMP-3.
  2569         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2570                                     COMP-3.
  2571         16  CP-REM-TERM-METHOD    PIC X.
  2572           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2573           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2574           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2575           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2576           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2577           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2578           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2579         16  CP-EARNING-METHOD     PIC X.
  2580           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2581           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2582           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2583           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2584           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2585           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2586           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2587           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2588           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2589           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2590           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2591           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2592           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2593           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2594         16  CP-PROCESS-TYPE       PIC X.
  2595           88  CP-CLAIM                            VALUE '1'.
  2596           88  CP-CANCEL                           VALUE '2'.
  2597           88  CP-ISSUE                            VALUE '3'.
  2598         16  CP-SPECIAL-CALC-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  49
* EL130.cbl
  2599           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2600           88  CP-1-MTH-INTEREST               VALUE ' '.
  2601           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2602           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2603           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2604           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2605           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2606           88  CP-FARM-PLAN                    VALUE 'F'.
  2607           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2608           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2609           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2610           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2611           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2612           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2613           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2614           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2615           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2616           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2617                                                     'W' 'X'.
  2618           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2619           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2620           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2621           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2622           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2623           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2624           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2625           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2626           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2627           88  CP-CSL-METH-1                   VALUE '5'.
  2628           88  CP-CSL-METH-2                   VALUE '6'.
  2629           88  CP-CSL-METH-3                   VALUE '7'.
  2630           88  CP-CSL-METH-4                   VALUE '8'.
  2631
  2632         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2633                                     COMP-3.
  2634         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2635         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2636         16  CP-STATE              PIC XX          VALUE SPACE.
  2637         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2638         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2639           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2640               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2641         16  CP-R78-OPTION         PIC X.
  2642           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2643           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2644
  2645         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2646         16  CP-IBNR-RESERVE-SW    PIC X.
  2647         16  CP-CLAIM-STATUS       PIC X.
  2648         16  CP-RATE-FILE          PIC X.
  2649         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2650                                     COMP-3.
  2651
  2652         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2653         16  CP-AH-OVERRIDE-CODE   PIC X.
  2654
  2655         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2656                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  50
* EL130.cbl
  2657         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2658                                   PIC S9(5)V99 COMP-3.
  2659         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2660                                     COMP-3.
  2661         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2662                                     COMP-3.
  2663         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2664                                     COMP-3.
  2665         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2666                                  PIC S9(7)V99 COMP-3.
  2667
  2668         16  CP-PAID-FROM-DATE     PIC X(02).
  2669         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2670         16  CP-EXT-DAYS-CALC      PIC X.
  2671           88  CP-EXT-NO-CHG                   VALUE ' '.
  2672           88  CP-EXT-CHG-LF                   VALUE '1'.
  2673           88  CP-EXT-CHG-AH                   VALUE '2'.
  2674           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2675         16  CP-DOMICILE-STATE     PIC XX.
  2676         16  CP-CARRIER            PIC X.
  2677         16  CP-REIN-FLAG          PIC X.
  2678         16  CP-REM-TRM-CALC-OPTION PIC X.
  2679           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2680                      '2' '3' '4' '5'.
  2681           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2682           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2683           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2684           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2685           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2686           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2687           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2688           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2689         16  CP-SIG-SWITCH         PIC X.
  2690         16  CP-RATING-METHOD      PIC X.
  2691           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2692           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2693           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2694           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2695           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2696           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2697           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2698           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2699           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2700         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2701                                     COMP-3.
  2702         16  CP-BEN-CATEGORY       PIC X.
  2703         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2704         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2705                                   PIC S99V9(5) COMP-3.
  2706         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2707         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2708                                   PIC S99V9(5) COMP-3.
  2709         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2710         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2711         16  CP-EXPIRE-DT          PIC XX.
  2712         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2713         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2714         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  51
* EL130.cbl
  2715         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2716         16  CP-DDF-SPEC-CALC      PIC X.
  2717             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2718             88  CP-CALC-CLP              VALUE 'C'.
  2719         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2720         16  CP-CANCEL-REASON      PIC X.
  2721         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2722         16  CP-PMT-MODE           PIC X.
  2723         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2724         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2725         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2726         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2727         16  FILLER                PIC X.
  2728
  2729***************    OUTPUT FROM ELRESV   ************************
  2730
  2731         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2732
  2733         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2734                                     COMP-3.
  2735         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2736                                     COMP-3.
  2737         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2738                                     COMP-3.
  2739         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2740                                     COMP-3.
  2741         16  FILLER                PIC X(09).
  2742***************    OUTPUT FROM ELRTRM   *************************
  2743
  2744         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2745                                     COMP-3.
  2746         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2747                                     COMP-3.
  2748         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2749                                     COMP-3.
  2750         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2751                                     COMP-3.
  2752         16  FILLER                PIC X(12).
  2753
  2754***************    OUTPUT FROM ELRAMT   *************************
  2755
  2756         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2757                                     COMP-3.
  2758         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2759                                     COMP-3.
  2760         16  FILLER                PIC X(12).
  2761
  2762***************    OUTPUT FROM ELRATE   *************************
  2763
  2764         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2765                                     COMP-3.
  2766         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2767                                     COMP-3.
  2768         16  CP-MORTALITY-CODE     PIC X(4).
  2769         16  CP-RATE-EDIT-FLAG     PIC X.
  2770             88  CP-RATES-NEED-APR                  VALUE '1'.
  2771         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2772                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  52
* EL130.cbl
  2773         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2774         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2775         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2776                                   PIC S9(7)V99 COMP-3.
  2777         16  FILLER                PIC X(07).
  2778
  2779***************    OUTPUT FROM ELRFND   *************************
  2780
  2781         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2782                                     COMP-3.
  2783         16  CP-REFUND-TYPE-USED   PIC X.
  2784           88  CP-R-AS-R78                         VALUE '1'.
  2785           88  CP-R-AS-PRORATA                     VALUE '2'.
  2786           88  CP-R-AS-CALIF                       VALUE '3'.
  2787           88  CP-R-AS-TEXAS                       VALUE '4'.
  2788           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2789           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2790           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2791           88  CP-R-AS-MEAN                        VALUE '8'.
  2792           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2793           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2794           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2795           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2796           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2797           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2798         16  FILLER                PIC X(12).
  2799
  2800***************    OUTPUT FROM ELEARN   *************************
  2801
  2802         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2803                                     COMP-3.
  2804         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2805                                     COMP-3.
  2806         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2807                                     COMP-3.
  2808         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2809                                     COMP-3.
  2810         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2811                                     COMP-3.
  2812         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2813                                     COMP-3.
  2814         16  CP-EARNING-TYPE-USED  PIC X.
  2815           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2816           88  CP-E-AS-R78                         VALUE '1'.
  2817           88  CP-E-AS-PRORATA                     VALUE '2'.
  2818           88  CP-E-AS-TEXAS                       VALUE '4'.
  2819           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2820           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2821           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2822           88  CP-E-AS-MEAN                        VALUE '8'.
  2823           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2824         16  FILLER                PIC X(12).
  2825
  2826***************    OUTPUT FROM ELPMNT   *************************
  2827
  2828         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2829                                     COMP-3.
  2830         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  53
* EL130.cbl
  2831                                     COMP-3.
  2832         16  FILLER                PIC X(12).
  2833
  2834***************   MISC WORK AREAS    *****************************
  2835         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2836                                     COMP-3.
  2837         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2838                                     COMP-3.
  2839         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2840                                     COMP-3.
  2841         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2842                                     COMP-3.
  2843         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2844                                     COMP-3.
  2845         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2846                                     COMP-3.
  2847         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2848             88  OPEN-RATE-FILE                   VALUE 'O'.
  2849             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2850             88  IO-ERROR                         VALUE 'E'.
  2851
  2852         16  CP-FIRST-PAY-DATE     PIC XX.
  2853
  2854         16  CP-JOINT-INDICATOR    PIC X.
  2855
  2856         16  CP-RESERVE-REMAINING-TERM
  2857                                   PIC S9(4)V9    VALUE ZERO
  2858                                     COMP-3.
  2859
  2860         16  CP-INSURED-BIRTH-DT   PIC XX.
  2861
  2862         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2863                                     COMP-3.
  2864
  2865         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2866                                     COMP-3.
  2867
  2868         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2869                                     COMP-3.
  2870
  2871         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2872                                     COMP-3.
  2873
  2874         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2875                                     COMP-3.
  2876
  2877         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2878                                     COMP-3.
  2879
  2880         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2881                                     COMP-3.
  2882
  2883         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2884             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2885
  2886         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2887                                     COMP-3.
  2888         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  54
* EL130.cbl
  2889                                     COMP-3.
  2890         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2891         16  cp-extra-periods      pic 9 value zeros.
  2892         16  cp-net-only-state     pic x value spaces.
  2893         16  FILLER                PIC X(13).
  2894******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  55
* EL130.cbl
  2896*    COPY ELCLOGOF.
  2897******************************************************************
  2898*                                                                *
  2899*                                                                *
  2900*                            ELCLOGOF.                           *
  2901*                            VMOD=2.001                          *
  2902*                                                                *
  2903*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2904*                                                                *
  2905******************************************************************
  2906 01  CLASIC-LOGOFF.
  2907     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2908     12  LOGOFF-TEXT.
  2909         16  FILLER          PIC X(5)    VALUE SPACES.
  2910         16  LOGOFF-MSG.
  2911             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2912             20  FILLER      PIC X       VALUE SPACES.
  2913             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2914         16  FILLER          PIC X(80)
  2915           VALUE '* YOU ARE NOW LOGGED OFF'.
  2916         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2917         16  FILLER          PIC X       VALUE QUOTE.
  2918         16  LOGOFF-SYS-MSG  PIC X(17)
  2919           VALUE 'S CLAS-IC SYSTEM '.
  2920     12  TEXT-MESSAGES.
  2921         16  UNACCESS-MSG    PIC X(29)
  2922             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2923         16  PGMIDERR-MSG    PIC X(17)
  2924             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  56
* EL130.cbl
  2926*    COPY ELCATTR.
  2927******************************************************************
  2928*                                                                *
  2929*                            ELCATTR.                            *
  2930*                            VMOD=2.001                          *
  2931*                                                                *
  2932*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2933*                                                                *
  2934*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2935*                                                                *
  2936*                   POS 1   P=PROTECTED                          *
  2937*                           U=UNPROTECTED                        *
  2938*                           S=ASKIP                              *
  2939*                   POS 2   A=ALPHA/NUMERIC                      *
  2940*                           N=NUMERIC                            *
  2941*                   POS 3   N=NORMAL                             *
  2942*                           B=BRIGHT                             *
  2943*                           D=DARK                               *
  2944*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2945*                           OF=MODIFIED DATA TAG OFF             *
  2946*                                                                *
  2947*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2948******************************************************************
  2949 01  ATTRIBUTE-LIST.
  2950     12  AL-PABOF            PIC X       VALUE 'Y'.
  2951     12  AL-PABON            PIC X       VALUE 'Z'.
  2952     12  AL-PADOF            PIC X       VALUE '%'.
  2953     12  AL-PADON            PIC X       VALUE '_'.
  2954     12  AL-PANOF            PIC X       VALUE '-'.
  2955     12  AL-PANON            PIC X       VALUE '/'.
  2956     12  AL-SABOF            PIC X       VALUE '8'.
  2957     12  AL-SABON            PIC X       VALUE '9'.
  2958     12  AL-SADOF            PIC X       VALUE '@'.
  2959     12  AL-SADON            PIC X       VALUE QUOTE.
  2960     12  AL-SANOF            PIC X       VALUE '0'.
  2961     12  AL-SANON            PIC X       VALUE '1'.
  2962     12  AL-UABOF            PIC X       VALUE 'H'.
  2963     12  AL-UABON            PIC X       VALUE 'I'.
  2964     12  AL-UADOF            PIC X       VALUE '<'.
  2965     12  AL-UADON            PIC X       VALUE '('.
  2966     12  AL-UANOF            PIC X       VALUE ' '.
  2967     12  AL-UANON            PIC X       VALUE 'A'.
  2968     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2969     12  AL-UNBON            PIC X       VALUE 'R'.
  2970     12  AL-UNDOF            PIC X       VALUE '*'.
  2971     12  AL-UNDON            PIC X       VALUE ')'.
  2972     12  AL-UNNOF            PIC X       VALUE '&'.
  2973     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  57
* EL130.cbl
  2975*    COPY ELCEMIB.
  2976******************************************************************
  2977*                                                                *
  2978*                                                                *
  2979*                            ELCEMIB.                            *
  2980*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2981*                            VMOD=2.005                          *
  2982*                                                                *
  2983*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2984*                                                                *
  2985******************************************************************
  2986 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2987     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2988     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2989     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2990     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2991     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2992     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2993     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2994     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2995     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2996         88  EMI-NO-ERRORS                    VALUE '1'.
  2997         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2998         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2999     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3000         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3001     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3002         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3003         88  EMI-AREA1-FULL                   VALUE '2'.
  3004     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3005         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3006         88  EMI-AREA2-FULL                   VALUE '2'.
  3007     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3008         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3009         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3010         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3011         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3012         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3013     12  EMI-ERROR-LINES.
  3014         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3015         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3016         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3017         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3018             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3019                 24  EMI-ERR-NUM         PIC X(4).
  3020                 24  EMI-FILLER          PIC X.
  3021                 24  EMI-SEV             PIC X.
  3022                 24  FILLER              PIC X.
  3023             20  FILLER                  PIC X(02).
  3024     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3025         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3026             20  EMI-ERROR-NUMBER    PIC X(4).
  3027             20  EMI-FILL            PIC X.
  3028             20  EMI-SEVERITY        PIC X.
  3029             20  FILLER              PIC X.
  3030             20  EMI-ERROR-TEXT.
  3031                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3032                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  58
* EL130.cbl
  3033     12  EMI-SEVERITY-SAVE           PIC X.
  3034         88  EMI-NOTE                    VALUE 'N'.
  3035         88  EMI-WARNING                 VALUE 'W'.
  3036         88  EMI-FORCABLE                VALUE 'F'.
  3037         88  EMI-FATAL                   VALUE 'X'.
  3038     12  EMI-MESSAGE-FLAG            PIC X.
  3039         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3040         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3041     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3042     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3043         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3044         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3045         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3046     12  emi-claim-no                pic x(7).
  3047     12  emi-claim-type              pic x(6).
  3048     12  FILLER                      PIC X(124)  VALUE SPACES.
  3049     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3050     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3051     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3052     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  59
* EL130.cbl
  3054*    COPY ELCJPFX.
  3055******************************************************************
  3056*                                                                *
  3057*                                                                *
  3058*                            ELCJPFX.                            *
  3059*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3060*                            VMOD=2.002                          *
  3061*                                                                *
  3062*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3063*                                                                *
  3064*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3065*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3066*        ELCNTL - CONTROL FILE                                   *
  3067*        ELMSTR - CLAIM MASTERS                                  *
  3068*        ELTRLR - ACTIVITY TRAILERS                              *
  3069*        ELCHKQ - CHECK QUE                                      *
  3070******************************************************************
  3071 01  JOURNAL-RECORD.
  3072     12  jp-date                     pic s9(5) comp-3.
  3073     12  jp-time                     pic s9(7) comp-3.
  3074     12  JP-USER-ID                  PIC X(4).
  3075     12  JP-FILE-ID                  PIC X(8).
  3076     12  JP-PROGRAM-ID               PIC X(8).
  3077     12  JP-RECORD-TYPE              PIC X.
  3078         88 JP-ADD              VALUE 'A'.
  3079         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3080         88 JP-AFTER-CHANGE     VALUE 'C'.
  3081         88 JP-DELETE           VALUE 'D'.
  3082         88 JP-GENERIC-DELETE   VALUE 'G'.
  3083         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3084         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3085     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3086     12  JP-RECORD-AREA
  3087
  3088
  3089         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  60
* EL130.cbl
  3091*    COPY ELCAID.
  3092******************************************************************
  3093*                                                                *
  3094*                            ELCAID.                             *
  3095*                            VMOD=2.001                          *
  3096*                                                                *
  3097*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3098*                                                                *
  3099*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3100*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3101******************************************************************
  3102
  3103 01  DFHAID.
  3104   02  DFHNULL   PIC  X  VALUE  ' '.
  3105   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3106   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3107   02  DFHPEN    PIC  X  VALUE  '='.
  3108   02  DFHOPID   PIC  X  VALUE  'W'.
  3109   02  DFHPA1    PIC  X  VALUE  '%'.
  3110   02  DFHPA2    PIC  X  VALUE  '>'.
  3111   02  DFHPA3    PIC  X  VALUE  ','.
  3112   02  DFHPF1    PIC  X  VALUE  '1'.
  3113   02  DFHPF2    PIC  X  VALUE  '2'.
  3114   02  DFHPF3    PIC  X  VALUE  '3'.
  3115   02  DFHPF4    PIC  X  VALUE  '4'.
  3116   02  DFHPF5    PIC  X  VALUE  '5'.
  3117   02  DFHPF6    PIC  X  VALUE  '6'.
  3118   02  DFHPF7    PIC  X  VALUE  '7'.
  3119   02  DFHPF8    PIC  X  VALUE  '8'.
  3120   02  DFHPF9    PIC  X  VALUE  '9'.
  3121   02  DFHPF10   PIC  X  VALUE  ':'.
  3122   02  DFHPF11   PIC  X  VALUE  '#'.
  3123   02  DFHPF12   PIC  X  VALUE  '@'.
  3124   02  DFHPF13   PIC  X  VALUE  'A'.
  3125   02  DFHPF14   PIC  X  VALUE  'B'.
  3126   02  DFHPF15   PIC  X  VALUE  'C'.
  3127   02  DFHPF16   PIC  X  VALUE  'D'.
  3128   02  DFHPF17   PIC  X  VALUE  'E'.
  3129   02  DFHPF18   PIC  X  VALUE  'F'.
  3130   02  DFHPF19   PIC  X  VALUE  'G'.
  3131   02  DFHPF20   PIC  X  VALUE  'H'.
  3132   02  DFHPF21   PIC  X  VALUE  'I'.
  3133*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3134   02  DFHPF22   PIC  X  VALUE  '['.
  3135   02  DFHPF23   PIC  X  VALUE  '.'.
  3136   02  DFHPF24   PIC  X  VALUE  '<'.
  3137   02  DFHMSRE   PIC  X  VALUE  'X'.
  3138   02  DFHSTRF   PIC  X  VALUE  'h'.
  3139   02  DFHTRIG   PIC  X  VALUE  '"'.
  3140
  3141 01  FILLER    REDEFINES DFHAID.
  3142     12  FILLER              PIC X(8).
  3143     12  PF-VALUES           PIC X       OCCURS 12.
  3144
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  61
* EL130.cbl
  3146****************************************************************
  3147*
  3148* Copyright (c) 2007-2013 Dell Inc.
  3149* All rights reserved.
  3150*
  3151****************************************************************
  3152 01  DFHEIV.
  3153   02  DFHEIV0               PIC X(35).
  3154   02  DFHEIV1               PIC X(08).
  3155   02  DFHEIV2               PIC X(08).
  3156   02  DFHEIV3               PIC X(08).
  3157   02  DFHEIV4               PIC X(06).
  3158   02  DFHEIV5               PIC X(04).
  3159   02  DFHEIV6               PIC X(04).
  3160   02  DFHEIV7               PIC X(02).
  3161   02  DFHEIV8               PIC X(02).
  3162   02  DFHEIV9               PIC X(01).
  3163   02  DFHEIV10              PIC S9(7) COMP-3.
  3164   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3165   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3166   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3167   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3168   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3169   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3170   02  DFHEIV17              PIC X(04).
  3171   02  DFHEIV18              PIC X(04).
  3172   02  DFHEIV19              PIC X(04).
  3173   02  DFHEIV20              USAGE IS POINTER.
  3174   02  DFHEIV21              USAGE IS POINTER.
  3175   02  DFHEIV22              USAGE IS POINTER.
  3176   02  DFHEIV23              USAGE IS POINTER.
  3177   02  DFHEIV24              USAGE IS POINTER.
  3178   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3179   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3180   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3181   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3182   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3183   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3184   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3185   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3186   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3187   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3188   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3189   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3190   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3191   02  FILLER                PIC X(02).
  3192   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3193   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3194   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3195   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3196   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3197   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3198   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3199 LINKAGE  SECTION.
  3200*****************************************************************
  3201*                                                               *
  3202* Copyright (c) 2007-2013 Dell Inc.                             *
  3203* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  62
* EL130.cbl
  3204*                                                               *
  3205*****************************************************************
  3206 01  dfheiblk.
  3207     02  eibtime          pic s9(7) comp-3.
  3208     02  eibdate          pic s9(7) comp-3.
  3209     02  eibtrnid         pic x(4).
  3210     02  eibtaskn         pic s9(7) comp-3.
  3211     02  eibtrmid         pic x(4).
  3212     02  dfheigdi         pic s9(4) comp.
  3213     02  eibcposn         pic s9(4) comp.
  3214     02  eibcalen         pic s9(4) comp.
  3215     02  eibaid           pic x(1).
  3216     02  eibfiller1       pic x(1).
  3217     02  eibfn            pic x(2).
  3218     02  eibfiller2       pic x(2).
  3219     02  eibrcode         pic x(6).
  3220     02  eibfiller3       pic x(2).
  3221     02  eibds            pic x(8).
  3222     02  eibreqid         pic x(8).
  3223     02  eibrsrce         pic x(8).
  3224     02  eibsync          pic x(1).
  3225     02  eibfree          pic x(1).
  3226     02  eibrecv          pic x(1).
  3227     02  eibsend          pic x(1).
  3228     02  eibatt           pic x(1).
  3229     02  eibeoc           pic x(1).
  3230     02  eibfmh           pic x(1).
  3231     02  eibcompl         pic x(1).
  3232     02  eibsig           pic x(1).
  3233     02  eibconf          pic x(1).
  3234     02  eiberr           pic x(1).
  3235     02  eibrldbk         pic x(1).
  3236     02  eiberrcd         pic x(4).
  3237     02  eibsynrb         pic x(1).
  3238     02  eibnodat         pic x(1).
  3239     02  eibfiller5       pic x(2).
  3240     02  eibresp          pic s9(8) comp.
  3241     02  eibresp2         pic s9(8) comp.
  3242     02  dfheigdj         pic s9(4) comp.
  3243     02  dfheigdk         pic s9(4) comp.
  3244
  3245 01  DFHCOMMAREA             PIC X(1024).
  3246
  3247*01 PARMLIST .
  3248*    02  FILLER              PIC S9(8)   COMP.
  3249*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3250*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3251*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3252*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3253*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3254*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3255*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3256*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3257*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  63
* EL130.cbl
  3259*    COPY ELCMSTR.
  3260******************************************************************
  3261*                                                                *
  3262*                            ELCMSTR.                            *
  3263*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3264*                            VMOD=2.012                          *
  3265*                                                                *
  3266*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3267*                                                                *
  3268*   FILE TYPE = VSAM,KSDS                                        *
  3269*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3270*                                                                *
  3271*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3272*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3273*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3274*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3275*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3276*                                                 RKP=75,LEN=21  *
  3277*                                                                *
  3278*   **** NOTE ****                                               *
  3279*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3280*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3281*                                                                *
  3282*   LOG = YES                                                    *
  3283*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3284******************************************************************
  3285*                   C H A N G E   L O G
  3286*
  3287* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3288*-----------------------------------------------------------------
  3289*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3290* EFFECTIVE    NUMBER
  3291*-----------------------------------------------------------------
  3292* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3293* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3294* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3295* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3296* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3297* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3298* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3299******************************************************************
  3300 01  CLAIM-MASTER.
  3301     12  CL-RECORD-ID                PIC XX.
  3302         88  VALID-CL-ID         VALUE 'CL'.
  3303
  3304     12  CL-CONTROL-PRIMARY.
  3305         16  CL-COMPANY-CD           PIC X.
  3306         16  CL-CARRIER              PIC X.
  3307         16  CL-CLAIM-NO             PIC X(7).
  3308         16  CL-CERT-NO.
  3309             20  CL-CERT-PRIME       PIC X(10).
  3310             20  CL-CERT-SFX         PIC X.
  3311
  3312     12  CL-CONTROL-BY-NAME.
  3313         16  CL-COMPANY-CD-A1        PIC X.
  3314         16  CL-INSURED-LAST-NAME    PIC X(15).
  3315         16  CL-INSURED-NAME.
  3316             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  64
* EL130.cbl
  3317             20  CL-INSURED-MID-INIT PIC X.
  3318
  3319     12  CL-CONTROL-BY-SSN.
  3320         16  CL-COMPANY-CD-A2        PIC X.
  3321         16  CL-SOC-SEC-NO.
  3322             20  CL-SSN-STATE        PIC XX.
  3323             20  CL-SSN-ACCOUNT      PIC X(6).
  3324             20  CL-SSN-LN3          PIC X(3).
  3325
  3326     12  CL-CONTROL-BY-CERT-NO.
  3327         16  CL-COMPANY-CD-A4        PIC X.
  3328         16  CL-CERT-NO-A4.
  3329             20  CL-CERT-A4-PRIME    PIC X(10).
  3330             20  CL-CERT-A4-SFX      PIC X.
  3331
  3332     12  CL-CONTROL-BY-CCN.
  3333         16  CL-COMPANY-CD-A5        PIC X.
  3334         16  CL-CCN-A5.
  3335             20  CL-CCN.
  3336                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3337                 24  CL-CCN-PRIME-A5 PIC X(12).
  3338             20  CL-CCN-FILLER-A5    PIC X(4).
  3339
  3340     12  CL-INSURED-PROFILE-DATA.
  3341         16  CL-INSURED-BIRTH-DT     PIC XX.
  3342         16  CL-INSURED-SEX-CD       PIC X.
  3343             88  INSURED-IS-MALE        VALUE 'M'.
  3344             88  INSURED-IS-FEMALE      VALUE 'F'.
  3345             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3346         16  CL-INSURED-OCC-CD       PIC X(6).
  3347         16  FILLER                  PIC X(5).
  3348
  3349     12  CL-PROCESSING-INFO.
  3350         16  CL-PROCESSOR-ID         PIC X(4).
  3351         16  CL-CLAIM-STATUS         PIC X.
  3352             88  CLAIM-IS-OPEN          VALUE 'O'.
  3353             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3354         16  CL-CLAIM-TYPE           PIC X.
  3355*            88  AH-CLAIM               VALUE 'A'.
  3356*            88  LIFE-CLAIM             VALUE 'L'.
  3357*            88  PROPERTY-CLAIM         VALUE 'P'.
  3358*            88  IUI-CLAIM              VALUE 'I'.
  3359*            88  GAP-CLAIM              VALUE 'G'.
  3360*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3361*            88  OTHER-CLAIM            VALUE 'O'.
  3362         16  CL-CLAIM-PREM-TYPE      PIC X.
  3363             88  SINGLE-PREMIUM         VALUE '1'.
  3364             88  O-B-COVERAGE           VALUE '2'.
  3365             88  OPEN-END-COVERAGE      VALUE '3'.
  3366         16  CL-INCURRED-DT          PIC XX.
  3367         16  CL-REPORTED-DT          PIC XX.
  3368         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3369         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3370         16  CL-LAST-PMT-DT          PIC XX.
  3371         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3372         16  CL-PAID-THRU-DT         PIC XX.
  3373         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3374         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  65
* EL130.cbl
  3375         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3376         16  CL-PMT-CALC-METHOD      PIC X.
  3377             88  CL-360-DAY-YR          VALUE '1'.
  3378             88  CL-365-DAY-YR          VALUE '2'.
  3379             88  CL-FULL-MONTHS         VALUE '3'.
  3380         16  CL-CAUSE-CD             PIC X(6).
  3381
  3382         16  CL-PRIME-CERT-NO.
  3383             20  CL-PRIME-CERT-PRIME PIC X(10).
  3384             20  CL-PRIME-CERT-SFX   PIC X.
  3385
  3386         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3387             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3388             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3389
  3390         16  CL-MICROFILM-NO         PIC X(10).
  3391         16  FILLER REDEFINES CL-MICROFILM-NO.
  3392             20  CL-BENEFIT-PERIOD   PIC 99.
  3393             20  FILLER              PIC X(8).
  3394         16  CL-PROG-FORM-TYPE       PIC X.
  3395         16  CL-LAST-ADD-ON-DT       PIC XX.
  3396
  3397         16  CL-LAST-REOPEN-DT       PIC XX.
  3398         16  CL-LAST-CLOSE-DT        PIC XX.
  3399         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3400             88  FINAL-PAID             VALUE '1'.
  3401             88  CLAIM-DENIED           VALUE '2'.
  3402             88  AUTO-CLOSE             VALUE '3'.
  3403             88  MANUAL-CLOSE           VALUE '4'.
  3404             88  BENEFITS-CHANGED       VALUE 'C'.
  3405             88  SETUP-ERRORS           VALUE 'E'.
  3406         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3407         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3408         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3409             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3410         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3411         16  FILLER                  PIC X.
  3412
  3413     12  CL-CERTIFICATE-DATA.
  3414         16  CL-CERT-ORIGIN          PIC X.
  3415             88  CERT-WAS-ONLINE        VALUE '1'.
  3416             88  CERT-WAS-CREATED       VALUE '2'.
  3417             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3418         16  CL-CERT-KEY-DATA.
  3419             20  CL-CERT-CARRIER     PIC X.
  3420             20  CL-CERT-GROUPING    PIC X(6).
  3421             20  CL-CERT-STATE       PIC XX.
  3422             20  CL-CERT-ACCOUNT.
  3423                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3424                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3425             20  CL-CERT-EFF-DT      PIC XX.
  3426
  3427     12  CL-STATUS-CONTROLS.
  3428         16  CL-PRIORITY-CD          PIC X.
  3429             88  CONFIDENTIAL-DATA      VALUE '8'.
  3430             88  HIGHEST-PRIORITY       VALUE '9'.
  3431         16  CL-SUPV-ATTN-CD         PIC X.
  3432             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  66
* EL130.cbl
  3433             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3434         16  CL-PURGED-DT            PIC XX.
  3435         16  CL-RESTORED-DT          PIC XX.
  3436         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3437         16  CL-NEXT-RESEND-DT       PIC XX.
  3438         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3439         16  CL-CRITICAL-PERIOD      PIC 99.
  3440*        16  FILLER                  PIC XX.
  3441         16  CL-LAST-MAINT-DT        PIC XX.
  3442         16  CL-LAST-MAINT-USER      PIC X(4).
  3443         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3444         16  CL-LAST-MAINT-TYPE      PIC X.
  3445             88  CLAIM-SET-UP           VALUE ' '.
  3446             88  PAYMENT-MADE           VALUE '1'.
  3447             88  LETTER-SENT            VALUE '2'.
  3448             88  MASTER-WAS-ALTERED     VALUE '3'.
  3449             88  MASTER-WAS-RESTORED    VALUE '4'.
  3450             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3451             88  FILE-CONVERTED         VALUE '6'.
  3452             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3453             88  ERROR-CORRECTION       VALUE 'E'.
  3454         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3455         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3456         16  CL-BENEFICIARY          PIC X(10).
  3457         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3458         16  CL-DENIAL-TYPE          PIC X.
  3459             88  CL-TYPE-DENIAL          VALUE '1'.
  3460             88  CL-TYPE-RESCISSION      VALUE '2'.
  3461             88  CL-TYPE-REFORMATION     VALUE '3'.
  3462             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3463             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3464         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3465         16  filler                  pic x(3).
  3466*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3467*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3468*        16  CL-RTW-DT               PIC XX.
  3469
  3470     12  CL-TRAILER-CONTROLS.
  3471         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3472             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3473             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3474             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3475         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3476         16  FILLER                  PIC XX.
  3477         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3478         16  CL-ADDRESS-TRAILER-CNT.
  3479             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3480                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3481             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3482                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3483             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3484                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3485             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3486                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3487             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3488                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3489             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3490                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  67
* EL130.cbl
  3491             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3492                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3493
  3494     12  CL-CV-REFERENCE-NO.
  3495         16  CL-CV-REFNO-PRIME       PIC X(18).
  3496         16  CL-CV-REFNO-SFX         PIC XX.
  3497
  3498     12  CL-FILE-LOCATION            PIC X(4).
  3499
  3500     12  CL-PROCESS-ERRORS.
  3501         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3502             88  NO-FATAL-ERRORS        VALUE ZERO.
  3503         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3504             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3505
  3506     12  CL-PRODUCT-CD               PIC X.
  3507
  3508     12  CL-CURRENT-KEY-DATA.
  3509         16  CL-CURRENT-CARRIER      PIC X.
  3510         16  CL-CURRENT-GROUPING     PIC X(6).
  3511         16  CL-CURRENT-STATE        PIC XX.
  3512         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3513
  3514     12  CL-ASSOCIATES               PIC X.
  3515         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3516         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3517         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3518         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3519
  3520     12  CL-ACTIVITY-CODE            PIC 99.
  3521     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3522     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3523
  3524     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3525     12  CL-LAG-REPORT-CODE          PIC 9.
  3526     12  CL-LOAN-TYPE                PIC XX.
  3527     12  CL-LEGAL-STATE              PIC XX.
  3528
  3529     12  CL-YESNOSW                  PIC X.
  3530     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3531         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3532         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3533         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3534     12  cl-insured-type             pic x.
  3535         88  cl-claim-on-primary         value 'P'.
  3536         88  cl-claim-on-co-borrower     value 'C'.
  3537     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  68
* EL130.cbl
  3539*    COPY ELCCNTL.
  3540******************************************************************
  3541*                                                                *
  3542*                                                                *
  3543*                            ELCCNTL.                            *
  3544*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3545*                            VMOD=2.059                          *
  3546*                                                                *
  3547*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3548*                                                                *
  3549*   FILE TYPE = VSAM,KSDS                                        *
  3550*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3551*                                                                *
  3552*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3553*       ALTERNATE INDEX = NONE                                   *
  3554*                                                                *
  3555*   LOG = YES                                                    *
  3556*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3557******************************************************************
  3558*                   C H A N G E   L O G
  3559*
  3560* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3561*-----------------------------------------------------------------
  3562*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3563* EFFECTIVE    NUMBER
  3564*-----------------------------------------------------------------
  3565* 082503                   PEMA  ADD BENEFIT GROUP
  3566* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3567* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3568* 092705    2005050300006  PEMA  ADD SPP LEASES
  3569* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3570* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3571* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3572* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3573* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3574* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3575* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3576* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3577* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3578* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3579* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  3580******************************************************************
  3581*
  3582 01  CONTROL-FILE.
  3583     12  CF-RECORD-ID                       PIC XX.
  3584         88  VALID-CF-ID                        VALUE 'CF'.
  3585
  3586     12  CF-CONTROL-PRIMARY.
  3587         16  CF-COMPANY-ID                  PIC XXX.
  3588         16  CF-RECORD-TYPE                 PIC X.
  3589             88  CF-COMPANY-MASTER              VALUE '1'.
  3590             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3591             88  CF-STATE-MASTER                VALUE '3'.
  3592             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3593             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3594             88  CF-CARRIER-MASTER              VALUE '6'.
  3595             88  CF-MORTALITY-MASTER            VALUE '7'.
  3596             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  69
* EL130.cbl
  3597             88  CF-TERMINAL-MASTER             VALUE '9'.
  3598             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3599             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3600             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3601             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3602             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3603             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3604             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3605             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3606             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3607         16  CF-ACCESS-CD-GENL              PIC X(4).
  3608         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3609             20  CF-PROCESSOR               PIC X(4).
  3610         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3611             20  CF-STATE-CODE              PIC XX.
  3612             20  FILLER                     PIC XX.
  3613         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3614             20  FILLER                     PIC XX.
  3615             20  CF-HI-BEN-IN-REC           PIC XX.
  3616         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3617             20  FILLER                     PIC XXX.
  3618             20  CF-CARRIER-CNTL            PIC X.
  3619         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3620             20  FILLER                     PIC XX.
  3621             20  CF-HI-TYPE-IN-REC          PIC 99.
  3622         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3623             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3624                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3625             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3626             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3627         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3628             20  FILLER                     PIC X.
  3629             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3630         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3631             20  FILLER                     PIC XX.
  3632             20  CF-MORTGAGE-PLAN           PIC XX.
  3633         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3634
  3635     12  CF-LAST-MAINT-DT                   PIC XX.
  3636     12  CF-LAST-MAINT-BY                   PIC X(4).
  3637     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3638
  3639     12  CF-RECORD-BODY                     PIC X(728).
  3640
  3641
  3642****************************************************************
  3643*             COMPANY MASTER RECORD                            *
  3644****************************************************************
  3645
  3646     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3647         16  CF-COMPANY-ADDRESS.
  3648             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3649             20  CF-CL-IN-CARE-OF           PIC X(30).
  3650             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3651             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3652             20  CF-CL-CITY-STATE           PIC X(30).
  3653             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3654             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  70
* EL130.cbl
  3655         16  CF-COMPANY-CD                  PIC X.
  3656         16  CF-COMPANY-PASSWORD            PIC X(8).
  3657         16  CF-SECURITY-OPTION             PIC X.
  3658             88  ALL-SECURITY                   VALUE '1'.
  3659             88  COMPANY-VERIFY                 VALUE '2'.
  3660             88  PROCESSOR-VERIFY               VALUE '3'.
  3661             88  NO-SECURITY                    VALUE '4'.
  3662             88  ALL-BUT-TERM                   VALUE '5'.
  3663         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3664             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3665         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3666             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3667         16  CF-INFORCE-LOCATION            PIC X.
  3668             88  CERTS-ARE-ONLINE               VALUE '1'.
  3669             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3670             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3671         16  CF-LOWER-CASE-LETTERS          PIC X.
  3672         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3673             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3674             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3675             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3676             88  CF-ACCNT-CNTL                  VALUE '3'.
  3677             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3678
  3679         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3680         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3681
  3682         16  CF-LGX-CREDIT-USER             PIC X.
  3683             88  CO-IS-NOT-USER                 VALUE 'N'.
  3684             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3685
  3686         16 CF-CREDIT-CALC-CODES.
  3687             20  CF-CR-REM-TERM-CALC PIC X.
  3688               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3689               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3690               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3691               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3692               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3693               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3694               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3695             20  CF-CR-R78-METHOD           PIC X.
  3696               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3697               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3698
  3699         16  CF-CLAIM-CONTROL-COUNTS.
  3700             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3701                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3702
  3703             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3704                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3705
  3706             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3707                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3708
  3709             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3710                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3711
  3712         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  71
* EL130.cbl
  3713
  3714         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3715             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3716             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3717             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3718             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3719                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3720                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3721             20  CF-CO-PREM-REJECT-SW       PIC X.
  3722                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3723                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3724             20  CF-CO-REF-REJECT-SW        PIC X.
  3725                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3726                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3727
  3728         16  CF-CO-REPORTING-DT             PIC XX.
  3729         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3730         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3731           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3732           88  CF-CO-MONTH-END                  VALUE '1'.
  3733
  3734         16  CF-LGX-CLAIM-USER              PIC X.
  3735             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3736             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3737
  3738         16  CF-CREDIT-EDIT-CONTROLS.
  3739             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3740             20  CF-MIN-AGE                 PIC 99.
  3741             20  CF-DEFAULT-AGE             PIC 99.
  3742             20  CF-MIN-TERM                PIC S999      COMP-3.
  3743             20  CF-MAX-TERM                PIC S999      COMP-3.
  3744             20  CF-DEFAULT-SEX             PIC X.
  3745             20  CF-JOINT-AGE-INPUT         PIC X.
  3746                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3747             20  CF-BIRTH-DATE-INPUT        PIC X.
  3748                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3749             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3750                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3751                 88  CF-ZERO-CARRIER            VALUE '1'.
  3752                 88  CF-ZERO-GROUPING           VALUE '2'.
  3753                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3754             20  CF-EDIT-SW                 PIC X.
  3755                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3756             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3757             20  CF-CR-PR-METHOD            PIC X.
  3758               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3759               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3760             20  FILLER                     PIC X.
  3761
  3762         16  CF-CREDIT-MISC-CONTROLS.
  3763             20  CF-REIN-TABLE-SW           PIC X.
  3764                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3765             20  CF-COMP-TABLE-SW           PIC X.
  3766                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3767             20  CF-EXPERIENCE-RETENTION-AGE
  3768                                            PIC S9        COMP-3.
  3769             20  CF-CONVERSION-DT           PIC XX.
  3770             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  72
* EL130.cbl
  3771             20  CF-RUN-FREQUENCY-SW        PIC X.
  3772                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3773                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3774
  3775             20  CF-CR-CHECK-NO-CONTROL.
  3776                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3777                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3778                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3779                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3780                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3781                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3782
  3783                 24  CF-CR-CHECK-COUNT       REDEFINES
  3784                     CF-CR-CHECK-COUNTER      PIC X(4).
  3785
  3786                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3787                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3788
  3789                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3790                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3791                 24  CF-MAIL-PROCESSING       PIC X.
  3792                     88  MAIL-PROCESSING          VALUE 'Y'.
  3793
  3794         16  CF-MISC-SYSTEM-CONTROL.
  3795             20  CF-SYSTEM-C                 PIC X.
  3796                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3797             20  CF-SYSTEM-D                 PIC X.
  3798                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3799             20  CF-SOC-SEC-NO-SW            PIC X.
  3800                 88  SOC-SEC-NO-USED             VALUE '1'.
  3801             20  CF-MEMBER-NO-SW             PIC X.
  3802                 88  MEMBER-NO-USED              VALUE '1'.
  3803             20  CF-TAX-ID-NUMBER            PIC X(11).
  3804             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3805             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3806                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3807                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3808                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3809                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3810             20  CF-SYSTEM-E                 PIC X.
  3811                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3812
  3813         16  CF-LGX-LIFE-USER               PIC X.
  3814             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3815             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3816
  3817         16  CF-CR-MONTH-END-DT             PIC XX.
  3818
  3819         16  CF-FILE-MAINT-DATES.
  3820             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3821                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3822             20  CF-LAST-BATCH       REDEFINES
  3823                 CF-LAST-BATCH-NO               PIC X(4).
  3824             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3825             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3826             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3827             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3828             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  73
* EL130.cbl
  3829             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3830             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3831             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3832             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3833             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3834
  3835         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3836         16  FILLER                         PIC X.
  3837
  3838         16  CF-ALT-MORT-CODE               PIC X(4).
  3839         16  CF-MEMBER-CAPTION              PIC X(10).
  3840
  3841         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3842             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3843             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3844             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3845             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3846             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3847
  3848         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3849
  3850         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3851         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3852         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3853         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3854
  3855         16  CF-AH-OVERRIDE-L1              PIC X.
  3856         16  CF-AH-OVERRIDE-L2              PIC XX.
  3857         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3858         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3859
  3860         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3861         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3862
  3863         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3864         16  CF-AR-LAST-EL860-DT            PIC XX.
  3865         16  CF-MP-MONTH-END-DT             PIC XX.
  3866
  3867         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3868         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3869             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3870
  3871         16  CF-AR-MONTH-END-DT             PIC XX.
  3872
  3873         16  CF-CRDTCRD-USER                PIC X.
  3874             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3875             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3876
  3877         16  CF-CC-MONTH-END-DT             PIC XX.
  3878
  3879         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3880
  3881         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3882             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3883             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3884             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3885         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3886         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  74
* EL130.cbl
  3887         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3888         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3889             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3890             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3891         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3892         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3893         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3894             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3895         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3896
  3897         16  CF-CL-ZIP-CODE.
  3898             20  CF-CL-ZIP-PRIME.
  3899                 24  CF-CL-ZIP-1ST          PIC X.
  3900                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3901                 24  FILLER                 PIC X(4).
  3902             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3903         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3904             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3905             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3906             20  FILLER                     PIC XXX.
  3907
  3908         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3909         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3910         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3911         16  CF-CO-OPTION-START-DATE        PIC XX.
  3912         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3913           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3914                                                      '3' '4'.
  3915           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3916           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3917           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3918           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3919           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3920           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3921
  3922         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3923
  3924         16  CF-PAYMENT-APPROVAL-LEVELS.
  3925             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3926             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3927             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3928             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3929             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3930             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3931
  3932         16  CF-END-USER-REPORTING-USER     PIC X.
  3933             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3934             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3935
  3936         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3937             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3938             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3939
  3940         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3941
  3942         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3943         16  FILLER                         PIC X.
  3944
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  75
* EL130.cbl
  3945         16  CF-CREDIT-ARCHIVE-CNTL.
  3946             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3947             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3948             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3949
  3950         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3951
  3952         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3953             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3954             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3955
  3956         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3957             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3958             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3959
  3960         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3961
  3962         16  CF-CO-ACH-ID-CODE              PIC  X.
  3963             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3964             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3965             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3966         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3967         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3968         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3969         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3970         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3971         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3972         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3973         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3974         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3975                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3976         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3977                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3978
  3979         16  CF-CO-OVER-SHORT.
  3980             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3981             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3982
  3983*         16  FILLER                         PIC X(102).
  3984         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3985             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3986             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3987
  3988         16  CF-AH-APPROVAL-DAYS.
  3989             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3990             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3991             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3992             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3993
  3994         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3995
  3996         16  CF-APPROV-LEV-5.
  3997             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3998             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3999             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4000
  4001         16  FILLER                         PIC X(68).
  4002****************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  76
* EL130.cbl
  4003*             PROCESSOR/USER RECORD                            *
  4004****************************************************************
  4005
  4006     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4007         16  CF-PROCESSOR-NAME              PIC X(30).
  4008         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4009         16  CF-PROCESSOR-TITLE             PIC X(26).
  4010         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4011                 88  MESSAGE-YES                VALUE 'Y'.
  4012                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4013
  4014*****************************************************
  4015****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4016****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4017****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4018****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4019*****************************************************
  4020
  4021         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4022             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4023             20  CF-APPLICATION-FORCE       PIC X.
  4024             20  CF-INDIVIDUAL-APP.
  4025                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4026                     28  CF-BROWSE-APP      PIC X.
  4027                     28  CF-UPDATE-APP      PIC X.
  4028
  4029         16  CF-CURRENT-TERM-ON             PIC X(4).
  4030         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4031             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4032             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4033             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4034             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4035             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4036             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4037             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4038         16  CF-PROCESSOR-CARRIER           PIC X.
  4039             88  NO-CARRIER-SECURITY            VALUE ' '.
  4040         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4041             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4042         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4043             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4044         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4045             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4046
  4047         16  CF-PROC-SYS-ACCESS-SW.
  4048             20  CF-PROC-CREDIT-CLAIMS-SW.
  4049                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4050                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4051                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4052                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4053             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4054                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4055                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4056             20  CF-PROC-LIFE-GNRLDGR-SW.
  4057                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4058                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4059                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4060                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  77
* EL130.cbl
  4061             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4062                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4063                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4064         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4065             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4066             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4067         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4068
  4069         16  CF-APPROVAL-LEVEL                  PIC X.
  4070             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4071             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4072             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4073             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4074             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4075
  4076         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4077
  4078         16  CF-LANGUAGE-TYPE                   PIC X.
  4079             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4080             88  CF-LANG-IS-FR                      VALUE 'F'.
  4081
  4082         16  CF-CSR-IND                         PIC X.
  4083         16  FILLER                             PIC X(239).
  4084
  4085****************************************************************
  4086*             PROCESSOR/REMINDERS RECORD                       *
  4087****************************************************************
  4088
  4089     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4090         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4091             20  CF-START-REMIND-DT         PIC XX.
  4092             20  CF-END-REMIND-DT           PIC XX.
  4093             20  CF-REMINDER-TEXT           PIC X(50).
  4094         16  FILLER                         PIC X(296).
  4095
  4096
  4097****************************************************************
  4098*             STATE MASTER RECORD                              *
  4099****************************************************************
  4100
  4101     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4102         16  CF-STATE-ABBREVIATION          PIC XX.
  4103         16  CF-STATE-NAME                  PIC X(25).
  4104         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4105         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4106             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4107             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4108             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4109             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4110                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4111                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4112             20  CF-ST-PREM-REJECT-SW       PIC X.
  4113                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4114                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4115             20  CF-ST-REF-REJECT-SW        PIC X.
  4116                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4117                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4118         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  78
* EL130.cbl
  4119         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4120         16  CF-ST-REFUND-RULES.
  4121             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4122             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4123             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4124         16  CF-ST-FST-PMT-EXTENSION.
  4125             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4126             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4127                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4128                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4129                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4130                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4131         16  CF-ST-STATE-CALL.
  4132             20  CF-ST-CALL-UNEARNED        PIC X.
  4133             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4134             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4135         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4136             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4137             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4138         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4139         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4140         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4141         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4142         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4143         16  FILLER                         PIC X.
  4144         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4145             20  CF-ST-BENEFIT-CD           PIC XX.
  4146             20  CF-ST-BENEFIT-KIND         PIC X.
  4147                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4148                 88  CF-ST-AH-KIND              VALUE 'A'.
  4149             20  CF-ST-REM-TERM-CALC        PIC X.
  4150                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4151                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4152                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4153                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4154                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4155                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4156                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4157                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4158
  4159             20  CF-ST-REFUND-CALC          PIC X.
  4160                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4161                 88  ST-REFD-BY-R78             VALUE '1'.
  4162                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4163                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4164                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4165                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4166                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4167                 88  ST-REFD-UTAH               VALUE '7'.
  4168                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4169                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4170                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4171
  4172             20  CF-ST-EARNING-CALC         PIC X.
  4173                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4174                 88  ST-EARN-BY-R78             VALUE '1'.
  4175                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4176                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  79
* EL130.cbl
  4177                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4178                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4179                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4180                 88  ST-EARN-MEAN               VALUE '8'.
  4181                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4182
  4183             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4184                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4185                 88  ST-OVRD-BY-R78             VALUE '1'.
  4186                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4187                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4188                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4189                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4190                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4191                 88  ST-OVRD-MEAN               VALUE '8'.
  4192                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4193             20  cf-st-extra-periods        pic 9.
  4194*            20  FILLER                     PIC X.
  4195
  4196         16  CF-ST-COMMISSION-CAPS.
  4197             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4198             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4199             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4200             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4201         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4202                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4203                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4204                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4205
  4206         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4207
  4208         16  CF-ST-STATUTORY-INTEREST.
  4209             20  CF-ST-STAT-DATE-FROM       PIC X.
  4210                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4211                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4212             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4213             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4214             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4215             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4216             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4217
  4218         16  CF-ST-OVER-SHORT.
  4219             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4220             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4221
  4222         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4223
  4224         16  CF-ST-RT-CALC                  PIC X.
  4225
  4226         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4227         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4228         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4229         16  CF-ST-RF-LR-CALC               PIC X.
  4230         16  CF-ST-RF-LL-CALC               PIC X.
  4231         16  CF-ST-RF-LN-CALC               PIC X.
  4232         16  CF-ST-RF-AH-CALC               PIC X.
  4233         16  CF-ST-RF-CP-CALC               PIC X.
  4234*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  80
* EL130.cbl
  4235*CIDMOD         16  FILLER                         PIC X(192).
  4236         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4237             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4238         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4239         16  CF-ST-VFY-2ND-BENE             PIC X.
  4240         16  CF-ST-CAUSAL-STATE             PIC X.
  4241         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4242         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4243         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4244             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4245         16  CF-ST-NET-ONLY-STATE           PIC X.
  4246             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4247         16  cf-commission-cap-required     pic x.
  4248         16  CF-ST-GA-COMMISSION-CAPS.
  4249             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4250             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4251             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4252             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4253         16  CF-ST-TOT-COMMISSION-CAPS.
  4254             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4255             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4256             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4257             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4258         16  FILLER                         PIC X(156).
  4259
  4260****************************************************************
  4261*             BENEFIT MASTER RECORD                            *
  4262****************************************************************
  4263
  4264     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4265         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4266             20  CF-BENEFIT-CODE            PIC XX.
  4267             20  CF-BENEFIT-NUMERIC  REDEFINES
  4268                 CF-BENEFIT-CODE            PIC XX.
  4269             20  CF-BENEFIT-ALPHA           PIC XXX.
  4270             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4271             20  CF-BENEFIT-COMMENT         PIC X(10).
  4272
  4273             20  CF-LF-COVERAGE-TYPE        PIC X.
  4274                 88  CF-REDUCING                VALUE 'R'.
  4275                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4276
  4277             20  CF-SPECIAL-CALC-CD         PIC X.
  4278                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4279                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4280                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4281                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4282                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4283                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4284                 88  CF-FARM-PLAN               VALUE 'F'.
  4285                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4286                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4287                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4288                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4289                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4290                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4291                 88  CF-PRUDENTIAL              VALUE 'P'.
  4292                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  81
* EL130.cbl
  4293                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4294                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4295                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4296                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4297                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4298
  4299             20  CF-JOINT-INDICATOR         PIC X.
  4300                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4301
  4302*            20  FILLER                     PIC X(12).
  4303             20  cf-maximum-benefits        pic s999 comp-3.
  4304             20  FILLER                     PIC X(09).
  4305             20  CF-BENEFIT-CATEGORY        PIC X.
  4306             20  CF-LOAN-TYPE               PIC X(8).
  4307
  4308             20  CF-CO-REM-TERM-CALC        PIC X.
  4309                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4310                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4311                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4312                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4313                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4314
  4315             20  CF-CO-EARNINGS-CALC        PIC X.
  4316                 88  CO-EARN-BY-R78             VALUE '1'.
  4317                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4318                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4319                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4320                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4321                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4322                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4323                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4324
  4325             20  CF-CO-REFUND-CALC          PIC X.
  4326                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4327                 88  CO-REFD-BY-R78             VALUE '1'.
  4328                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4329                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4330                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4331                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4332                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4333                 88  CO-REFD-MEAN               VALUE '8'.
  4334                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4335                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4336                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4337
  4338             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4339                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4340                 88  CO-OVRD-BY-R78             VALUE '1'.
  4341                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4342                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4343                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4344                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4345                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4346                 88  CO-OVRD-MEAN               VALUE '8'.
  4347                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4348
  4349             20  CF-CO-BEN-I-G-CD           PIC X.
  4350                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  82
* EL130.cbl
  4351                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4352                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4353
  4354         16  FILLER                         PIC X(304).
  4355
  4356
  4357****************************************************************
  4358*             CARRIER MASTER RECORD                            *
  4359****************************************************************
  4360
  4361     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4362         16  CF-ADDRESS-DATA.
  4363             20  CF-MAIL-TO-NAME            PIC X(30).
  4364             20  CF-IN-CARE-OF              PIC X(30).
  4365             20  CF-ADDRESS-LINE-1          PIC X(30).
  4366             20  CF-ADDRESS-LINE-2          PIC X(30).
  4367             20  CF-CITY-STATE              PIC X(30).
  4368             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4369             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4370
  4371         16  CF-CLAIM-NO-CONTROL.
  4372             20  CF-CLAIM-NO-METHOD         PIC X.
  4373                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4374                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4375                 88  CLAIM-NO-SEQ               VALUE '3'.
  4376                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4377             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4378                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4379                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4380                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4381
  4382         16  CF-CHECK-NO-CONTROL.
  4383             20  CF-CHECK-NO-METHOD         PIC X.
  4384                 88  CHECK-NO-MANUAL            VALUE '1'.
  4385                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4386                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4387                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4388             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4389                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4390
  4391         16  CF-DOMICILE-STATE              PIC XX.
  4392
  4393         16  CF-EXPENSE-CONTROLS.
  4394             20  CF-EXPENSE-METHOD          PIC X.
  4395                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4396                 88  DOLLARS-PER-PMT            VALUE '2'.
  4397                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4398                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4399             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4400             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4401
  4402         16  CF-CORRESPONDENCE-CONTROL.
  4403             20  CF-LETTER-RESEND-OPT       PIC X.
  4404                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4405                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4406             20  FILLER                     PIC X(4).
  4407
  4408         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  83
* EL130.cbl
  4409             20  CF-MANUAL-SW               PIC X.
  4410                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4411             20  CF-FUTURE-SW               PIC X.
  4412                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4413             20  CF-PTC-SW                  PIC X.
  4414                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4415             20  CF-IBNR-SW                 PIC X.
  4416                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4417             20  CF-PTC-LF-SW               PIC X.
  4418                 88  CF-LF-PTC-USED             VALUE '1'.
  4419             20  CF-CDT-ACCESS-METHOD       PIC X.
  4420                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4421                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4422                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4423             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4424
  4425         16  CF-CLAIM-CALC-METHOD           PIC X.
  4426             88  360-PLUS-MONTHS                VALUE '1'.
  4427             88  365-PLUS-MONTHS                VALUE '2'.
  4428             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4429             88  360-DAILY                      VALUE '4'.
  4430             88  365-DAILY                      VALUE '5'.
  4431
  4432         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4433         16  FILLER                         PIC X(11).
  4434
  4435         16  CF-LIMIT-AMOUNTS.
  4436             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4437             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4438             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4439             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4440             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4441             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4442             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4443             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4444             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4445             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4446
  4447         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4448         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4449         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4450
  4451         16  CF-ZIP-CODE.
  4452             20  CF-ZIP-PRIME.
  4453                 24  CF-ZIP-1ST             PIC X.
  4454                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4455                 24  FILLER                 PIC X(4).
  4456             20  CF-ZIP-PLUS4               PIC X(4).
  4457         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4458             20  CF-CAN-POSTAL-1            PIC XXX.
  4459             20  CF-CAN-POSTAL-2            PIC XXX.
  4460             20  FILLER                     PIC XXX.
  4461
  4462         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4463         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4464         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4465
  4466         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  84
* EL130.cbl
  4467             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4468             88  CF-NO-RATING                   VALUE 'N'.
  4469
  4470         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4471
  4472         16  CF-CARRIER-OVER-SHORT.
  4473             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4474             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4475
  4476         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4477         16  CF-SECPAY-SWITCH               PIC X.
  4478             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4479             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4480         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4481         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4482         16  FILLER                         PIC X(444).
  4483*        16  FILLER                         PIC X(452).
  4484
  4485
  4486****************************************************************
  4487*             MORTALITY MASTER RECORD                          *
  4488****************************************************************
  4489
  4490     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4491         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4492                                INDEXED BY CF-MORT-NDX.
  4493             20  CF-MORT-TABLE              PIC X(5).
  4494             20  CF-MORT-TABLE-TYPE         PIC X.
  4495                 88  CF-MORT-JOINT              VALUE 'J'.
  4496                 88  CF-MORT-SINGLE             VALUE 'S'.
  4497                 88  CF-MORT-COMBINED           VALUE 'C'.
  4498                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4499                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4500             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4501             20  CF-MORT-AGE-METHOD         PIC XX.
  4502                 88  CF-AGE-LAST                VALUE 'AL'.
  4503                 88  CF-AGE-NEAR                VALUE 'AN'.
  4504             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4505             20  CF-MORT-ADJUSTMENT-DIRECTION
  4506                                            PIC X.
  4507                 88  CF-MINUS                   VALUE '-'.
  4508                 88  CF-PLUS                    VALUE '+'.
  4509             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4510             20  CF-MORT-JOINT-CODE         PIC X.
  4511                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4512             20  CF-MORT-PC-Q               PIC X.
  4513                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4514             20  CF-MORT-TABLE-CODE         PIC X(4).
  4515             20  CF-MORT-COMMENTS           PIC X(15).
  4516             20  FILLER                     PIC X(14).
  4517
  4518         16  FILLER                         PIC X(251).
  4519
  4520
  4521****************************************************************
  4522*             BUSSINESS TYPE MASTER RECORD                     *
  4523****************************************************************
  4524
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  85
* EL130.cbl
  4525     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4526* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4527* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4528* AND RECORD 05 IS TYPES 81-99
  4529         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4530             20  CF-BUSINESS-TITLE          PIC  X(19).
  4531             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4532                                            PIC S9V9(4) COMP-3.
  4533             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4534             20  FILLER                     PIC  X.
  4535         16  FILLER                         PIC  X(248).
  4536
  4537
  4538****************************************************************
  4539*             TERMINAL MASTER RECORD                           *
  4540****************************************************************
  4541
  4542     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4543
  4544         16  CF-COMPANY-TERMINALS.
  4545             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4546                                  PIC X(4).
  4547         16  FILLER               PIC X(248).
  4548
  4549
  4550****************************************************************
  4551*             LIFE EDIT MASTER RECORD                          *
  4552****************************************************************
  4553
  4554     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4555         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4556             20  CF-LIFE-CODE-IN            PIC XX.
  4557             20  CF-LIFE-CODE-OUT           PIC XX.
  4558         16  FILLER                         PIC X(248).
  4559
  4560
  4561****************************************************************
  4562*             AH EDIT MASTER RECORD                            *
  4563****************************************************************
  4564
  4565     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4566         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4567             20  CF-AH-CODE-IN              PIC XXX.
  4568             20  CF-AH-CODE-OUT             PIC XX.
  4569         16  FILLER                         PIC X(248).
  4570
  4571
  4572****************************************************************
  4573*             CREDIBILITY TABLES                               *
  4574****************************************************************
  4575
  4576     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4577         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4578                             INDEXED BY CF-CRDB-NDX.
  4579             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4580             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4581             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4582         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  86
* EL130.cbl
  4583
  4584
  4585****************************************************************
  4586*             REPORT CUSTOMIZATION RECORD                      *
  4587****************************************************************
  4588
  4589     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4590         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4591             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4592             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4593             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4594**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4595****       A T-TRANSFER.                                   ****
  4596             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4597
  4598         16  FILLER                         PIC XX.
  4599
  4600         16  CF-CARRIER-CNTL-OPT.
  4601             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4602                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4603                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4604             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4605                                            PIC X.
  4606         16  CF-GROUP-CNTL-OPT.
  4607             20  CF-GROUP-OPT-SEQ           PIC 9.
  4608                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4609                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4610             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4611                                            PIC X(6).
  4612         16  CF-STATE-CNTL-OPT.
  4613             20  CF-STATE-OPT-SEQ           PIC 9.
  4614                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4615                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4616             20  CF-STATE-SELECT OCCURS 3 TIMES
  4617                                            PIC XX.
  4618         16  CF-ACCOUNT-CNTL-OPT.
  4619             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4620                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4621                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4622             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4623                                            PIC X(10).
  4624         16  CF-BUS-TYP-CNTL-OPT.
  4625             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4626                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4627                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4628             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4629                                            PIC XX.
  4630         16  CF-LF-TYP-CNTL-OPT.
  4631             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4632                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4633                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4634             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4635                                            PIC XX.
  4636         16  CF-AH-TYP-CNTL-OPT.
  4637             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4638                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4639                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4640             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  87
* EL130.cbl
  4641                                            PIC XX.
  4642         16  CF-REPTCD1-CNTL-OPT.
  4643             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4644                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4645                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4646             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4647                                            PIC X(10).
  4648         16  CF-REPTCD2-CNTL-OPT.
  4649             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4650                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4651                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4652             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4653                                            PIC X(10).
  4654         16  CF-USER1-CNTL-OPT.
  4655             20  CF-USER1-OPT-SEQ           PIC 9.
  4656                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4657                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4658             20  CF-USER1-SELECT OCCURS 3 TIMES
  4659                                            PIC X(10).
  4660         16  CF-USER2-CNTL-OPT.
  4661             20  CF-USER2-OPT-SEQ           PIC 9.
  4662                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4663                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4664             20  CF-USER2-SELECT OCCURS 3 TIMES
  4665                                            PIC X(10).
  4666         16  CF-USER3-CNTL-OPT.
  4667             20  CF-USER3-OPT-SEQ           PIC 9.
  4668                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4669                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4670             20  CF-USER3-SELECT OCCURS 3 TIMES
  4671                                            PIC X(10).
  4672         16  CF-USER4-CNTL-OPT.
  4673             20  CF-USER4-OPT-SEQ           PIC 9.
  4674                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4675                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4676             20  CF-USER4-SELECT OCCURS 3 TIMES
  4677                                            PIC X(10).
  4678         16  CF-USER5-CNTL-OPT.
  4679             20  CF-USER5-OPT-SEQ           PIC 9.
  4680                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4681                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4682             20  CF-USER5-SELECT OCCURS 3 TIMES
  4683                                            PIC X(10).
  4684         16  CF-REINS-CNTL-OPT.
  4685             20  CF-REINS-OPT-SEQ           PIC 9.
  4686                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4687                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4688             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4689                 24  CF-REINS-PRIME         PIC XXX.
  4690                 24  CF-REINS-SUB           PIC XXX.
  4691
  4692         16  CF-AGENT-CNTL-OPT.
  4693             20  CF-AGENT-OPT-SEQ           PIC 9.
  4694                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4695                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4696             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4697                                            PIC X(10).
  4698
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  88
* EL130.cbl
  4699         16  FILLER                         PIC X(43).
  4700
  4701         16  CF-LOSS-RATIO-SELECT.
  4702             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4703             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4704         16  CF-ENTRY-DATE-SELECT.
  4705             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4706             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4707         16  CF-EFFECTIVE-DATE-SELECT.
  4708             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4709             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4710
  4711         16  CF-EXCEPTION-LIST-IND          PIC X.
  4712             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4713
  4714         16  FILLER                         PIC X(318).
  4715
  4716****************************************************************
  4717*                  EXCEPTION REPORTING RECORD                  *
  4718****************************************************************
  4719
  4720     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4721         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4722             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4723
  4724         16  CF-COMBINED-LIFE-AH-OPT.
  4725             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4726             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4727             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4728             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4729
  4730         16  CF-LIFE-OPT.
  4731             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4732             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4733             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4734             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4735             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4736             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4737             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4738             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4739             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4740             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4741
  4742         16  CF-AH-OPT.
  4743             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4744             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4745             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4746             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4747             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4748             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4749             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4750             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4751             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4752             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4753
  4754         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4755             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4756             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  89
* EL130.cbl
  4757             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4758
  4759         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4760
  4761         16  FILLER                         PIC X(673).
  4762
  4763
  4764****************************************************************
  4765*             MORTGAGE SYSTEM PLAN RECORD                      *
  4766****************************************************************
  4767
  4768     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4769         16  CF-PLAN-TYPE                   PIC X.
  4770             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4771             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4772             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4773         16  CF-PLAN-ABBREV                 PIC XXX.
  4774         16  CF-PLAN-DESCRIPT               PIC X(10).
  4775         16  CF-PLAN-NOTES                  PIC X(20).
  4776         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4777         16  CF-PLAN-UNDERWRITING.
  4778             20  CF-PLAN-TERM-DATA.
  4779                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4780                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4781             20  CF-PLAN-AGE-DATA.
  4782                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4783                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4784                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4785             20  CF-PLAN-BENEFIT-DATA.
  4786                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4787                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4788                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4789                                            PIC S9(7)V99  COMP-3.
  4790         16  CF-PLAN-POLICY-FORMS.
  4791             20  CF-POLICY-FORM             PIC X(12).
  4792             20  CF-MASTER-APPLICATION      PIC X(12).
  4793             20  CF-MASTER-POLICY           PIC X(12).
  4794         16  CF-PLAN-RATING.
  4795             20  CF-RATE-CODE               PIC X(5).
  4796             20  CF-SEX-RATING              PIC X.
  4797                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4798                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4799             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4800             20  CF-SUB-STD-TYPE            PIC X.
  4801                 88  CF-PCT-OF-PREM            VALUE '1'.
  4802                 88  CF-PCT-OF-BENE            VALUE '2'.
  4803         16  CF-PLAN-PREM-TOLERANCES.
  4804             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4805             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4806         16  CF-PLAN-PYMT-TOLERANCES.
  4807             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4808             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4809         16  CF-PLAN-MISC-DATA.
  4810             20  FILLER                     PIC X.
  4811             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4812             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4813         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4814         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  90
* EL130.cbl
  4815             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4816                                                     '1'.
  4817             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4818                                                     '2'.
  4819         16  CF-MIB-SEARCH-SW               PIC X.
  4820             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4821             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4822             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4823             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4824         16  CF-ALPHA-SEARCH-SW             PIC X.
  4825             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4826             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4827             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4828             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4829             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4830             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4831             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4832             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4833             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4834             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4835                                                     'A' 'B' 'C'
  4836                                                     'X' 'Y' 'Z'.
  4837         16  CF-EFF-DT-RULE-SW              PIC X.
  4838             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4839             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4840             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4841             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4842             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4843         16  FILLER                         PIC X(4).
  4844         16  CF-HEALTH-QUESTIONS            PIC X.
  4845             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4846         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4847         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4848         16  CF-PLAN-SNGL-JNT               PIC X.
  4849             88  CF-COMBINED-PLAN              VALUE 'C'.
  4850             88  CF-JNT-PLAN                   VALUE 'J'.
  4851             88  CF-SNGL-PLAN                  VALUE 'S'.
  4852         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4853         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4854         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4855         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4856         16  CF-RERATE-CNTL                 PIC  X.
  4857             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4858             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4859             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4860             88  CF-AUTO-RECALC                 VALUE '4'.
  4861         16  CF-BENEFIT-TYPE                PIC  X.
  4862             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4863             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4864         16  CF-POLICY-FEE                  PIC S999V99
  4865                                                    COMP-3.
  4866         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4867         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4868         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4869         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4870         16  FILLER                         PIC  X(32).
  4871         16  CF-TERMINATION-FORM            PIC  X(04).
  4872         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  91
* EL130.cbl
  4873         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4874                                                       COMP-3.
  4875         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4876         16  CF-ISSUE-LETTER                PIC  X(4).
  4877         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4878         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4879             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4880             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4881         16  CF-MP-REFUND-CALC              PIC X.
  4882             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4883             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4884             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4885             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4886             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4887             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4888             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4889             88  CF-MP-REFD-MEAN                VALUE '8'.
  4890         16  CF-ALT-RATE-CODE               PIC  X(5).
  4891
  4892
  4893         16  FILLER                         PIC X(498).
  4894****************************************************************
  4895*             MORTGAGE COMPANY MASTER RECORD                   *
  4896****************************************************************
  4897
  4898     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4899         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4900         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4901             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4902             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4903             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4904             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4905             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4906
  4907         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4908         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4909         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4910         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4911         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4912
  4913         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4914             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4915         16  CF-MP-RECON-USE-IND            PIC X(1).
  4916             88  CF-MP-USE-RECON             VALUE 'Y'.
  4917         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4918             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4919         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4920             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4921             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4922         16  FILLER                         PIC X(1).
  4923         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4924             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4925         16  CF-MORTG-MIB-VERSION           PIC X.
  4926             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4927             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4928             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4929         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4930             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  92
* EL130.cbl
  4931                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4932             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4933                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4934             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4935                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4936             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4937                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4938             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4939                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4940             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4941                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4942         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4943         16  FILLER                         PIC X(7).
  4944         16  CF-MORTG-DESTINATION-SYMBOL.
  4945             20  CF-MORTG-MIB-COMM          PIC X(5).
  4946             20  CF-MORTG-MIB-TERM          PIC X(5).
  4947         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4948             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4949         16  FILLER                         PIC X(03).
  4950         16  CF-MP-CHECK-NO-CONTROL.
  4951             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4952                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4953                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4954                                                ' ' LOW-VALUES.
  4955                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4956                                               VALUE '3'.
  4957         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4958         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4959         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4960             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4961                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4962             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4963                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4964             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4965                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4966             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4967                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4968             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4969                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4970             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4971                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4972         16  CF-MORTG-BILLING-AREA.
  4973             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4974                                            PIC X.
  4975         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4976         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4977         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4978         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4979             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4980             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4981         16  FILLER                         PIC X.
  4982         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4983             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4984             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4985         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4986         16  FILLER                         PIC X(8).
  4987         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4988         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  93
* EL130.cbl
  4989         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4990         16  CF-ACH-COMPANY-ID.
  4991             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4992                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4993                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4994                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4995             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4996         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4997             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4998         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4999             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5000             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5001         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5002         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5003         16  FILLER                         PIC X(536).
  5004
  5005****************************************************************
  5006*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5007****************************************************************
  5008
  5009     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5010         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5011             20  CF-FEMALE-HEIGHT.
  5012                 24  CF-FEMALE-FT           PIC 99.
  5013                 24  CF-FEMALE-IN           PIC 99.
  5014             20  CF-FEMALE-MIN-WT           PIC 999.
  5015             20  CF-FEMALE-MAX-WT           PIC 999.
  5016         16  FILLER                         PIC X(428).
  5017
  5018     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5019         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5020             20  CF-MALE-HEIGHT.
  5021                 24  CF-MALE-FT             PIC 99.
  5022                 24  CF-MALE-IN             PIC 99.
  5023             20  CF-MALE-MIN-WT             PIC 999.
  5024             20  CF-MALE-MAX-WT             PIC 999.
  5025         16  FILLER                         PIC X(428).
  5026******************************************************************
  5027*             AUTOMATIC ACTIVITY RECORD                          *
  5028******************************************************************
  5029     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5030         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5031             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5032             20  CF-SYS-LETTER-ID           PIC X(04).
  5033             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5034             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5035             20  CF-SYS-RESET-SW            PIC X(01).
  5036             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5037             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5038
  5039         16  FILLER                         PIC X(50).
  5040
  5041         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5042             20  CF-USER-ACTIVE-SW          PIC X(01).
  5043             20  CF-USER-LETTER-ID          PIC X(04).
  5044             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5045             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5046             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  94
* EL130.cbl
  5047             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5048             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5049             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5050
  5051         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  95
* EL130.cbl
  5053*    COPY ELCCERT.
  5054******************************************************************
  5055*                                                                *
  5056*                            ELCCERT.                            *
  5057*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5058*                            VMOD=2.013                          *
  5059*                                                                *
  5060*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5061*                                                                *
  5062*   FILE TYPE = VSAM,KSDS                                        *
  5063*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5064*                                                                *
  5065*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5066*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5067*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5068*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5069*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5070*                                                                *
  5071*   LOG = YES                                                    *
  5072*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5073******************************************************************
  5074*                   C H A N G E   L O G
  5075*
  5076* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5077*-----------------------------------------------------------------
  5078*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5079* EFFECTIVE    NUMBER
  5080*-----------------------------------------------------------------
  5081* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5082* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5083* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5084* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5085* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5086* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5087* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5088* 032612  CR2011110200001  PEMA  AHL CHANGES
  5089* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5090* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5091* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5092******************************************************************
  5093
  5094 01  CERTIFICATE-MASTER.
  5095     12  CM-RECORD-ID                      PIC XX.
  5096         88  VALID-CM-ID                      VALUE 'CM'.
  5097
  5098     12  CM-CONTROL-PRIMARY.
  5099         16  CM-COMPANY-CD                 PIC X.
  5100         16  CM-CARRIER                    PIC X.
  5101         16  CM-GROUPING.
  5102             20  CM-GROUPING-PREFIX        PIC X(3).
  5103             20  CM-GROUPING-PRIME         PIC X(3).
  5104         16  CM-STATE                      PIC XX.
  5105         16  CM-ACCOUNT.
  5106             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5107             20  CM-ACCOUNT-PRIME          PIC X(6).
  5108         16  CM-CERT-EFF-DT                PIC XX.
  5109         16  CM-CERT-NO.
  5110             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  96
* EL130.cbl
  5111             20  CM-CERT-SFX               PIC X.
  5112
  5113     12  CM-CONTROL-BY-NAME.
  5114         16  CM-COMPANY-CD-A1              PIC X.
  5115         16  CM-INSURED-LAST-NAME          PIC X(15).
  5116         16  CM-INSURED-INITIALS.
  5117             20  CM-INSURED-INITIAL1       PIC X.
  5118             20  CM-INSURED-INITIAL2       PIC X.
  5119
  5120     12  CM-CONTROL-BY-SSN.
  5121         16  CM-COMPANY-CD-A2              PIC X.
  5122         16  CM-SOC-SEC-NO.
  5123             20  CM-SSN-STATE              PIC XX.
  5124             20  CM-SSN-ACCOUNT            PIC X(6).
  5125             20  CM-SSN-LN3.
  5126                 25  CM-INSURED-INITIALS-A2.
  5127                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5128                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5129                 25 CM-PART-LAST-NAME-A2         PIC X.
  5130
  5131     12  CM-CONTROL-BY-CERT-NO.
  5132         16  CM-COMPANY-CD-A4              PIC X.
  5133         16  CM-CERT-NO-A4                 PIC X(11).
  5134
  5135     12  CM-CONTROL-BY-MEMB.
  5136         16  CM-COMPANY-CD-A5              PIC X.
  5137         16  CM-MEMBER-NO.
  5138             20  CM-MEMB-STATE             PIC XX.
  5139             20  CM-MEMB-ACCOUNT           PIC X(6).
  5140             20  CM-MEMB-LN4.
  5141                 25  CM-INSURED-INITIALS-A5.
  5142                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5143                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5144                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5145
  5146     12  CM-INSURED-PROFILE-DATA.
  5147         16  CM-INSURED-FIRST-NAME.
  5148             20  CM-INSURED-1ST-INIT       PIC X.
  5149             20  FILLER                    PIC X(9).
  5150         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5151         16  CM-INSURED-SEX                PIC X.
  5152             88  CM-SEX-MALE                  VALUE 'M'.
  5153             88  CM-SEX-FEMAL                 VALUE 'F'.
  5154         16  CM-INSURED-JOINT-AGE          PIC 99.
  5155         16  CM-JOINT-INSURED-NAME.
  5156             20  CM-JT-LAST-NAME           PIC X(15).
  5157             20  CM-JT-FIRST-NAME.
  5158                 24  CM-JT-1ST-INIT        PIC X.
  5159                 24  FILLER                PIC X(9).
  5160             20  CM-JT-INITIAL             PIC X.
  5161
  5162     12  CM-LIFE-DATA.
  5163         16  CM-LF-BENEFIT-CD              PIC XX.
  5164         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5165         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5166         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5167         16  CM-LF-DEV-CODE                PIC XXX.
  5168         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  97
* EL130.cbl
  5169         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5170         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5171         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5172         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5173         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5174         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5175         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5176         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5177         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5178         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5179         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5180         16  cm-temp-epiq                  pic xx.
  5181             88  EPIQ-CLASS                  value 'EQ'.
  5182*        16  FILLER                        PIC XX.
  5183
  5184     12  CM-AH-DATA.
  5185         16  CM-AH-BENEFIT-CD              PIC XX.
  5186         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5187         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5188         16  CM-AH-DEV-CODE                PIC XXX.
  5189         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5190         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5191         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5192         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5193         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5194         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5195         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5196         16  CM-AH-PAID-THRU-DT            PIC XX.
  5197             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5198         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5199         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5200         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5201         16  FILLER                        PIC X.
  5202
  5203     12  CM-LOAN-INFORMATION.
  5204         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5205         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5206                                           PIC S9(5)V99  COMP-3.
  5207         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5208         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5209         16  CM-PAY-FREQUENCY              PIC S99.
  5210         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5211         16  CM-RATE-CLASS                 PIC XX.
  5212         16  CM-BENEFICIARY                PIC X(25).
  5213         16  CM-POLICY-FORM-NO             PIC X(12).
  5214         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5215         16  CM-LAST-ADD-ON-DT             PIC XX.
  5216         16  CM-DEDUCTIBLE-AMOUNTS.
  5217             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5218             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5219         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5220             20  CM-RESIDENT-STATE         PIC XX.
  5221             20  CM-RATE-CODE              PIC X(4).
  5222             20  FILLER                    PIC XX.
  5223         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5224             20  CM-LOAN-OFFICER           PIC X(5).
  5225             20  FILLER                    PIC XXX.
  5226         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  98
* EL130.cbl
  5227         16  CM-UNDERWRITING-CODE          PIC X.
  5228             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5229         16  CM-POST-CARD-IND              PIC X.
  5230         16  CM-REF-INTERFACE-SW           PIC X.
  5231         16  CM-PREMIUM-TYPE               PIC X.
  5232             88  CM-SING-PRM                  VALUE '1'.
  5233             88  CM-O-B-COVERAGE              VALUE '2'.
  5234             88  CM-OPEN-END                  VALUE '3'.
  5235         16  CM-IND-GRP-TYPE               PIC X.
  5236             88  CM-INDIVIDUAL                VALUE 'I'.
  5237             88  CM-GROUP                     VALUE 'G'.
  5238         16  CM-SKIP-CODE                  PIC X.
  5239             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5240             88  SKIP-JULY                    VALUE '1'.
  5241             88  SKIP-AUGUST                  VALUE '2'.
  5242             88  SKIP-SEPTEMBER               VALUE '3'.
  5243             88  SKIP-JULY-AUG                VALUE '4'.
  5244             88  SKIP-AUG-SEPT                VALUE '5'.
  5245             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5246             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5247             88  SKIP-JUNE                    VALUE '8'.
  5248             88  SKIP-JUNE-JULY               VALUE '9'.
  5249             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5250             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5251         16  CM-PAYMENT-MODE               PIC X.
  5252             88  PAY-MONTHLY                  VALUE SPACE.
  5253             88  PAY-WEEKLY                   VALUE '1'.
  5254             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5255             88  PAY-BI-WEEKLY                VALUE '3'.
  5256             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5257         16  CM-LOAN-NUMBER                PIC X(8).
  5258         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5259         16  CM-OLD-LOF                    PIC XXX.
  5260*        16  CM-LOAN-OFFICER               PIC XXX.
  5261         16  CM-REIN-TABLE                 PIC XXX.
  5262         16  CM-SPECIAL-REIN-CODE          PIC X.
  5263         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5264         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5265         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5266
  5267     12  CM-STATUS-DATA.
  5268         16  CM-ENTRY-STATUS               PIC X.
  5269         16  CM-ENTRY-DT                   PIC XX.
  5270
  5271         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5272         16  CM-LF-CANCEL-DT               PIC XX.
  5273         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5274
  5275         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5276         16  CM-LF-DEATH-DT                PIC XX.
  5277         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5278
  5279         16  CM-LF-CURRENT-STATUS          PIC X.
  5280             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5281                                                'M' '4' '5' '9'.
  5282             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5283             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5284             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page  99
* EL130.cbl
  5285             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5286             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5287             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5288             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5289             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5290             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5291             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5292             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5293             88  CM-LF-DECLINED               VALUE 'D'.
  5294             88  CM-LF-VOIDED                 VALUE 'V'.
  5295
  5296         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5297         16  CM-AH-CANCEL-DT               PIC XX.
  5298         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5299
  5300         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5301         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5302         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5303
  5304         16  CM-AH-CURRENT-STATUS          PIC X.
  5305             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5306                                                'M' '4' '5' '9'.
  5307             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5308             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5309             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5310             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5311             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5312             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5313             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5314             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5315             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5316             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5317             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5318             88  CM-AH-DECLINED               VALUE 'D'.
  5319             88  CM-AH-VOIDED                 VALUE 'V'.
  5320
  5321         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5322             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5323             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5324             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5325         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5326
  5327         16  CM-ENTRY-BATCH                PIC X(6).
  5328         16  CM-LF-EXIT-BATCH              PIC X(6).
  5329         16  CM-AH-EXIT-BATCH              PIC X(6).
  5330         16  CM-LAST-MONTH-END             PIC XX.
  5331
  5332     12  CM-NOTE-SW                        PIC X.
  5333         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5334         88  CERT-NOTES-PRESENT               VALUE '1'.
  5335         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5336         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5337         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5338         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5339         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5340         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5341     12  CM-COMP-EXCP-SW                   PIC X.
  5342         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 100
* EL130.cbl
  5343         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5344     12  CM-INSURED-ADDRESS-SW             PIC X.
  5345         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5346         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5347
  5348*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5349     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5350     12  FILLER                            PIC X.
  5351
  5352*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5353     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5354     12  FILLER                            PIC X.
  5355*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5356     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5357
  5358     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5359         88  CERT-ADDED-BATCH                 VALUE ' '.
  5360         88  CERT-ADDED-ONLINE                VALUE '1'.
  5361         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5362         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5363         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5364     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5365         88  CERT-AS-LOADED                   VALUE ' '.
  5366         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5367         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5368         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5369         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5370         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5371         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5372         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5373
  5374     12  CM-ACCOUNT-COMM-PCTS.
  5375         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5376         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5377
  5378     12  CM-USER-FIELD                     PIC X.
  5379     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5380     12  CM-CLP-STATE                      PIC XX.
  5381     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5382     12  CM-USER-RESERVED                  PIC XXX.
  5383     12  FILLER REDEFINES CM-USER-RESERVED.
  5384         16  CM-AH-CLASS-CD                PIC XX.
  5385         16  F                             PIC X.
  5386******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 101
* EL130.cbl
  5388*    COPY ERCACCT.
  5389******************************************************************
  5390*                                                                *
  5391*                                                                *
  5392*                            ERCACCT                             *
  5393*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5394*                            VMOD=2.031                          *
  5395*                                                                *
  5396*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5397*                                                                *
  5398*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5399*   VSAM ACCOUNT MASTER FILES.                                   *
  5400*                                                                *
  5401*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5402*                                                                *
  5403*   FILE TYPE = VSAM,KSDS                                        *
  5404*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5405*                                                                *
  5406*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5407*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5408*                                                                *
  5409*   LOG = NO                                                     *
  5410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5411*                                                                *
  5412*                                                                *
  5413******************************************************************
  5414*                   C H A N G E   L O G
  5415*
  5416* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5417*-----------------------------------------------------------------
  5418*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5419* EFFECTIVE    NUMBER
  5420*-----------------------------------------------------------------
  5421* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5422* 092705    2005050300006  PEMA  ADD SPP LEASES
  5423* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5424* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5425* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5426* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5427* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5428* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  5429******************************************************************
  5430
  5431 01  ACCOUNT-MASTER.
  5432     12  AM-RECORD-ID                      PIC XX.
  5433         88  VALID-AM-ID                      VALUE 'AM'.
  5434
  5435     12  AM-CONTROL-PRIMARY.
  5436         16  AM-COMPANY-CD                 PIC X.
  5437         16  AM-MSTR-CNTRL.
  5438             20  AM-CONTROL-A.
  5439                 24  AM-CARRIER            PIC X.
  5440                 24  AM-GROUPING.
  5441                     28 AM-GROUPING-PREFIX PIC XXX.
  5442                     28 AM-GROUPING-PRIME  PIC XXX.
  5443                 24  AM-STATE              PIC XX.
  5444                 24  AM-ACCOUNT.
  5445                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 102
* EL130.cbl
  5446                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5447             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5448                                           PIC X(19).
  5449             20  AM-CNTRL-B.
  5450                 24  AM-EXPIRATION-DT      PIC XX.
  5451                 24  FILLER                PIC X(4).
  5452             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5453                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5454
  5455     12  AM-CONTROL-BY-VAR-GRP.
  5456         16  AM-COMPANY-CD-A1              PIC X.
  5457         16  AM-VG-CARRIER                 PIC X.
  5458         16  AM-VG-GROUPING                PIC X(6).
  5459         16  AM-VG-STATE                   PIC XX.
  5460         16  AM-VG-ACCOUNT                 PIC X(10).
  5461         16  AM-VG-DATE.
  5462             20  AM-VG-EXPIRATION-DT       PIC XX.
  5463             20  FILLER                    PIC X(4).
  5464         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5465                                           PIC 9(11)      COMP-3.
  5466     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5467         16  FILLER                        PIC X(10).
  5468         16  AM-VG-KEY3.
  5469             20  AM-VG3-ACCOUNT            PIC X(10).
  5470             20  AM-VG3-EXP-DT             PIC XX.
  5471         16  FILLER                        PIC X(4).
  5472     12  AM-MAINT-INFORMATION.
  5473         16  AM-LAST-MAINT-DT              PIC XX.
  5474         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5475         16  AM-LAST-MAINT-USER            PIC X(4).
  5476         16  FILLER                        PIC XX.
  5477
  5478     12  AM-EFFECTIVE-DT                   PIC XX.
  5479     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5480
  5481     12  AM-PREV-DATES  COMP-3.
  5482         16  AM-PREV-EXP-DT                PIC 9(11).
  5483         16  AM-PREV-EFF-DT                PIC 9(11).
  5484
  5485     12  AM-REPORT-CODE-1                  PIC X(10).
  5486     12  AM-REPORT-CODE-2                  PIC X(10).
  5487
  5488     12  AM-CITY-CODE                      PIC X(4).
  5489     12  AM-COUNTY-PARISH                  PIC X(6).
  5490
  5491     12  AM-NAME                           PIC X(30).
  5492     12  AM-PERSON                         PIC X(30).
  5493     12  AM-ADDRS                          PIC X(30).
  5494     12  AM-CITY.
  5495         16  AM-ADDR-CITY                  PIC X(28).
  5496         16  AM-ADDR-STATE                 PIC XX.
  5497     12  AM-ZIP.
  5498         16  AM-ZIP-PRIME.
  5499             20  AM-ZIP-PRI-1ST            PIC X.
  5500                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5501             20  FILLER                    PIC X(4).
  5502         16  AM-ZIP-PLUS4                  PIC X(4).
  5503     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 103
* EL130.cbl
  5504         16  AM-CAN-POSTAL-1               PIC XXX.
  5505         16  AM-CAN-POSTAL-2               PIC XXX.
  5506         16  FILLER                        PIC XXX.
  5507     12  AM-TEL-NO.
  5508         16  AM-AREA-CODE                  PIC 999.
  5509         16  AM-TEL-PRE                    PIC 999.
  5510         16  AM-TEL-NBR                    PIC 9(4).
  5511     12  AM-TEL-LOC                        PIC X.
  5512         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5513         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5514
  5515     12  AM-COMM-STRUCTURE.
  5516         16  AM-DEFN-1.
  5517             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5518                 24  AM-AGT.
  5519                     28  AM-AGT-PREFIX     PIC X(4).
  5520                     28  AM-AGT-PRIME      PIC X(6).
  5521                 24  AM-COM-TYP            PIC X.
  5522                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5523                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5524                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5525                 24  AM-RECALC-LV-INDIC    PIC X.
  5526                 24  AM-RETRO-LV-INDIC     PIC X.
  5527                 24  AM-GL-CODES           PIC X.
  5528                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5529                 24  FILLER                PIC X(01).
  5530         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5531             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5532                 24  FILLER                PIC X(11).
  5533                 24  AM-L-COMA             PIC XXX.
  5534                 24  AM-J-COMA             PIC XXX.
  5535                 24  AM-A-COMA             PIC XXX.
  5536                 24  FILLER                PIC X(6).
  5537
  5538     12  AM-COMM-CHANGE-STATUS             PIC X.
  5539         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5540
  5541     12  AM-CSR-CODE                       PIC X(4).
  5542
  5543     12  AM-BILLING-STATUS                 PIC X.
  5544         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5545         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5546     12  AM-AUTO-REFUND-SW                 PIC X.
  5547         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5548         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5549     12  AM-GPCD                           PIC 99.
  5550     12  AM-IG                             PIC X.
  5551         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5552         88  AM-HAS-GROUP                     VALUE '2'.
  5553     12  AM-STATUS                         PIC X.
  5554         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5555         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5556         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5557         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5558         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5559         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5560         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  5561         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 104
* EL130.cbl
  5562         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  5563         88  AM-ACCOUNT-PENDING               VALUE '9'.
  5564     12  AM-REMIT-TO                       PIC 99.
  5565     12  AM-ID-NO                          PIC X(11).
  5566
  5567     12  AM-CAL-TABLE                      PIC XX.
  5568     12  AM-LF-DEVIATION                   PIC XXX.
  5569     12  AM-AH-DEVIATION                   PIC XXX.
  5570     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5571     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5572     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5573     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5574     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5575     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5576
  5577     12  AM-USER-FIELDS.
  5578         16  AM-FLD-1                      PIC XX.
  5579         16  AM-FLD-2                      PIC XX.
  5580         16  AM-FLD-3                      PIC XX.
  5581         16  AM-FLD-4                      PIC XX.
  5582         16  AM-FLD-5                      PIC XX.
  5583
  5584     12  AM-1ST-PROD-DATE.
  5585         16  AM-1ST-PROD-YR                PIC XX.
  5586         16  AM-1ST-PROD-MO                PIC XX.
  5587         16  AM-1ST-PROD-DA                PIC XX.
  5588     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5589     12  AM-CERTS-PURGED-DATE.
  5590         16  AM-PUR-YR                     PIC XX.
  5591         16  AM-PUR-MO                     PIC XX.
  5592         16  AM-PUR-DA                     PIC XX.
  5593     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5594     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5595     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5596     12  AM-INACTIVE-DATE.
  5597         16  AM-INA-MO                     PIC 99.
  5598         16  AM-INA-DA                     PIC 99.
  5599         16  AM-INA-YR                     PIC 99.
  5600     12  AM-AR-HI-CERT-DATE                PIC XX.
  5601
  5602     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5603     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5604
  5605     12  AM-OB-PAYMENT-MODE                PIC X.
  5606         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5607         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5608         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5609         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5610
  5611     12  AM-AH-ONLY-INDICATOR              PIC X.
  5612         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5613         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5614
  5615     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5616
  5617     12  AM-OVER-SHORT.
  5618         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5619         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 105
* EL130.cbl
  5620
  5621     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5622     12  AM-DCC-CLP-STATE                  PIC XX.
  5623
  5624     12  AM-RECALC-COMM                    PIC X.
  5625     12  AM-RECALC-REIN                    PIC X.
  5626
  5627     12  AM-REI-TABLE                      PIC XXX.
  5628     12  AM-REI-ET-LF                      PIC X.
  5629     12  AM-REI-ET-AH                      PIC X.
  5630     12  AM-REI-PE-LF                      PIC X.
  5631     12  AM-REI-PE-AH                      PIC X.
  5632     12  AM-REI-PRT-ST                     PIC X.
  5633     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5634     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5635     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5636     12  AM-REI-GROUP-A                    PIC X(6).
  5637     12  AM-REI-MORT                       PIC X(4).
  5638     12  AM-REI-PRT-OW                     PIC X.
  5639     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5640     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5641     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5642     12  AM-REI-GROUP-B                    PIC X(6).
  5643
  5644     12  AM-TRUST-TYPE                     PIC X(2).
  5645
  5646     12  AM-EMPLOYER-STMT-USED             PIC X.
  5647     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5648
  5649     12  AM-STD-AH-TYPE                    PIC XX.
  5650     12  AM-EARN-METHODS.
  5651         16  AM-EARN-METHOD-R              PIC X.
  5652             88 AM-REF-RL-R78                 VALUE 'R'.
  5653             88 AM-REF-RL-PR                  VALUE 'P'.
  5654             88 AM-REF-RL-MEAN                VALUE 'M'.
  5655             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5656         16  AM-EARN-METHOD-L              PIC X.
  5657             88 AM-REF-LL-R78                 VALUE 'R'.
  5658             88 AM-REF-LL-PR                  VALUE 'P'.
  5659             88 AM-REF-LL-MEAN                VALUE 'M'.
  5660             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5661         16  AM-EARN-METHOD-A              PIC X.
  5662             88 AM-REF-AH-R78                 VALUE 'R'.
  5663             88 AM-REF-AH-PR                  VALUE 'P'.
  5664             88 AM-REF-AH-MEAN                VALUE 'M'.
  5665             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5666             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5667             88 AM-REF-AH-NET                 VALUE 'N'.
  5668
  5669     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5670     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5671     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5672
  5673     12  AM-RET-Y-N                        PIC X.
  5674     12  AM-RET-P-E                        PIC X.
  5675     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5676     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5677     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 106
* EL130.cbl
  5678     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5679         16  AM-POOL-PRIME                 PIC XXX.
  5680         16  AM-POOL-SUB                   PIC XXX.
  5681     12  AM-RETRO-EARNINGS.
  5682         16  AM-RET-EARN-R                 PIC X.
  5683         16  AM-RET-EARN-L                 PIC X.
  5684         16  AM-RET-EARN-A                 PIC X.
  5685     12  AM-RET-ST-TAX-USE                 PIC X.
  5686         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5687         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5688     12  AM-RETRO-BEG-EARNINGS.
  5689         16  AM-RET-BEG-EARN-R             PIC X.
  5690         16  AM-RET-BEG-EARN-L             PIC X.
  5691         16  AM-RET-BEG-EARN-A             PIC X.
  5692     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5693     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5694
  5695     12  AM-USER-SELECT-OPTIONS.
  5696         16  AM-USER-SELECT-1              PIC X(10).
  5697         16  AM-USER-SELECT-2              PIC X(10).
  5698         16  AM-USER-SELECT-3              PIC X(10).
  5699         16  AM-USER-SELECT-4              PIC X(10).
  5700         16  AM-USER-SELECT-5              PIC X(10).
  5701
  5702     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5703
  5704     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5705
  5706     12  AM-RPT045A-SWITCH                 PIC X.
  5707         88  RPT045A-OFF                   VALUE 'N'.
  5708
  5709     12  AM-INSURANCE-LIMITS.
  5710         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5711         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5712
  5713     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5714         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5715
  5716     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5717         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5718         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5719
  5720     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5721
  5722     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5723     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5724     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5725     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5726     12  AM-DCC-UEF-STATE                  PIC XX.
  5727     12  FILLER                            PIC XXX.
  5728     12  AM-REPORT-CODE-3                  PIC X(10).
  5729*    12  FILLER                            PIC X(22).
  5730
  5731     12  AM-RESERVE-DATE.
  5732         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5733         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5734         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5735
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 107
* EL130.cbl
  5736     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5737     12  AM-NOTIFICATION-TYPES.
  5738         16  AM-NOTIF-OF-LETTERS           PIC X.
  5739         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5740         16  AM-NOTIF-OF-REPORTS           PIC X.
  5741         16  AM-NOTIF-OF-STATUS            PIC X.
  5742
  5743     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5744         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5745         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5746         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5747         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5748
  5749     12  AM-BENEFIT-CONTROLS.
  5750         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5751             20  AM-BENEFIT-CODE           PIC XX.
  5752             20  AM-BENEFIT-TYPE           PIC X.
  5753             20  AM-BENEFIT-REVISION       PIC XXX.
  5754             20  AM-BENEFIT-REM-TERM       PIC X.
  5755             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5756             20  FILLER                    PIC XX.
  5757         16  FILLER                        PIC X(80).
  5758
  5759     12  AM-TRANSFER-DATA.
  5760         16  AM-TRANSFERRED-FROM.
  5761             20  AM-TRNFROM-CARRIER        PIC X.
  5762             20  AM-TRNFROM-GROUPING.
  5763                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5764                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5765             20  AM-TRNFROM-STATE          PIC XX.
  5766             20  AM-TRNFROM-ACCOUNT.
  5767                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5768                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5769             20  AM-TRNFROM-DTE            PIC XX.
  5770         16  AM-TRANSFERRED-TO.
  5771             20  AM-TRNTO-CARRIER          PIC X.
  5772             20  AM-TRNTO-GROUPING.
  5773                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5774                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5775             20  AM-TRNTO-STATE            PIC XX.
  5776             20  AM-TRNTO-ACCOUNT.
  5777                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5778                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5779             20  AM-TRNTO-DTE              PIC XX.
  5780         16  FILLER                        PIC X(10).
  5781
  5782     12  AM-SAVED-REMIT-TO                 PIC 99.
  5783
  5784     12  AM-COMM-STRUCTURE-SAVED.
  5785         16  AM-DEFN-1-SAVED.
  5786             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5787                 24  AM-AGT-SV             PIC X(10).
  5788                 24  AM-COM-TYP-SV         PIC X.
  5789                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5790                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5791                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5792                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5793                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 108
* EL130.cbl
  5794                 24  AM-GL-CODES-SV        PIC X.
  5795                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5796                 24  FILLER                PIC X.
  5797         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5798             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5799                 24  FILLER                PIC X(11).
  5800                 24  AM-L-COMA-SV          PIC XXX.
  5801                 24  AM-J-COMA-SV          PIC XXX.
  5802                 24  AM-A-COMA-SV          PIC XXX.
  5803                 24  FILLER                PIC X(6).
  5804
  5805     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5806         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5807            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5808            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5809            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5810
  5811     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5812     12  FILLER                            PIC X(120).
  5813
  5814     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5815         16  AM-CONTROL-NAME               PIC X(30).
  5816         16  AM-EXECUTIVE-ONE.
  5817             20  AM-EXEC1-NAME             PIC X(15).
  5818             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5819                                                          COMP-3.
  5820             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5821                                                          COMP-3.
  5822         16  AM-EXECUTIVE-TWO.
  5823             20  AM-EXEC2-NAME             PIC X(15).
  5824             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5825                                                          COMP-3.
  5826             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5827                                                          COMP-3.
  5828
  5829     12  AM-RETRO-ADDITIONAL-DATA.
  5830         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5831         16  AM-RETRO-PREM-P-E             PIC X.
  5832         16  AM-RETRO-CLMS-P-I             PIC X.
  5833         16  AM-RETRO-RET-BRACKET-LF.
  5834             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5835                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5836                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5837             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5838                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5839                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5840             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5841                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5842                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5843         16  AM-RETRO-RET-BRACKET-AH.
  5844             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5845                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5846                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5847                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5848             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5849                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5850                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5851             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 109
* EL130.cbl
  5852                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5853                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5854
  5855     12  AM-COMMENTS.
  5856         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5857
  5858     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5859         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5860         16  AM-FLI-BILLING-CODE           PIC X.
  5861         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5862         16  AM-FLI-UNITED-IDENT           PIC X.
  5863         16  AM-FLI-INTEREST-LOST-DATA.
  5864             20  AM-FLI-BANK-NO            PIC X(5).
  5865             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5866             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5867             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5868         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5869             20  AM-FLI-AGT                PIC X(9).
  5870             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5871             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5872         16  FILLER                        PIC X(102).
  5873
  5874     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5875         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5876             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5877             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5878             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5879             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5880             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5881         16  FILLER                          PIC X(10).
  5882******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 110
* EL130.cbl
  5884*    COPY ELCTRLR.
  5885******************************************************************
  5886*                                                                *
  5887*                            ELCTRLR.                            *
  5888*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5889*                            VMOD=2.014                          *
  5890*                                                                *
  5891*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5892*                                                                *
  5893*   FILE TYPE = VSAM,KSDS                                        *
  5894*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5895*                                                                *
  5896*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5897*       ALTERNATE INDEX = NONE                                   *
  5898*                                                                *
  5899*   LOG = YES                                                    *
  5900*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5901******************************************************************
  5902*                   C H A N G E   L O G
  5903*
  5904* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5905*-----------------------------------------------------------------
  5906*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5907* EFFECTIVE    NUMBER
  5908*-----------------------------------------------------------------
  5909* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5910* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5911* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5912* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5913* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5914* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5915* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5916* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5917* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5918* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5919* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5920* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5921* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5922* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5923* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5924* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5925* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5926* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5927* 040814    2014030500002  AJRA  ADD ICD CODES
  5928* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5929* 013017  CR2016053100001  PEMA  ACH PROCESSING
  5930* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  5931* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5932* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  5933******************************************************************
  5934 01  ACTIVITY-TRAILERS.
  5935     12  AT-RECORD-ID                    PIC XX.
  5936         88  VALID-AT-ID                       VALUE 'AT'.
  5937
  5938     12  AT-CONTROL-PRIMARY.
  5939         16  AT-COMPANY-CD               PIC X.
  5940         16  AT-CARRIER                  PIC X.
  5941         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 111
* EL130.cbl
  5942         16  AT-CERT-NO.
  5943             20  AT-CERT-PRIME           PIC X(10).
  5944             20  AT-CERT-SFX             PIC X.
  5945         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5946             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5947             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5948             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5949             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5950             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5951             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5952             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5953             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5954             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5955             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5956             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5957             88  AT-BENEFICIARY-TRL           VALUE +91.
  5958             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5959             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5960             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5961             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5962
  5963     12  AT-TRAILER-TYPE                 PIC X.
  5964         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5965         88  PAYMENT-TR                       VALUE '2'.
  5966         88  AUTO-PAY-TR                      VALUE '3'.
  5967         88  CORRESPONDENCE-TR                VALUE '4'.
  5968         88  ADDRESS-TR                       VALUE '5'.
  5969         88  GENERAL-INFO-TR                  VALUE '6'.
  5970         88  AUTO-PROMPT-TR                   VALUE '7'.
  5971         88  DENIAL-TR                        VALUE '8'.
  5972         88  INCURRED-CHG-TR                  VALUE '9'.
  5973         88  FORM-CONTROL-TR                  VALUE 'A'.
  5974
  5975     12  AT-RECORDED-DT                  PIC XX.
  5976     12  AT-RECORDED-BY                  PIC X(4).
  5977     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5978
  5979     12  AT-TRAILER-BODY                 PIC X(165).
  5980
  5981     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5982         16  AT-RESERVE-CONTROLS.
  5983             20  AT-MANUAL-SW            PIC X.
  5984                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5985             20  AT-FUTURE-SW            PIC X.
  5986                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5987             20  AT-PTC-SW               PIC X.
  5988                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5989             20  AT-IBNR-SW              PIC X.
  5990                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5991             20  AT-PTC-LF-SW            PIC X.
  5992                 88  AT-LF-PTC-USED          VALUE '1'.
  5993             20  AT-CDT-ACCESS-METHOD    PIC X.
  5994                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5995                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5996                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5997             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5998         16  AT-LAST-COMPUTED-DT         PIC XX.
  5999         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 112
* EL130.cbl
  6000         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6001         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6002         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6003         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6004         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6005         16  AT-EXPENSE-CONTROLS.
  6006             20  AT-EXPENSE-METHOD       PIC X.
  6007                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6008                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6009                 88  PERCENT-OF-PMT           VALUE '3'.
  6010                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6011             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6012             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6013         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6014         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6015
  6016         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6017         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6018
  6019*        16  FILLER                      PIC X(53).
  6020         16  FILLER                      PIC X(47).
  6021
  6022         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6023         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6024
  6025         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6026             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6027             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6028*                    C = CLOSED
  6029*                    O = OPEN
  6030             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6031*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6032
  6033     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6034         16  AT-PAYMENT-TYPE             PIC X.
  6035             88  PARTIAL-PAYMENT                VALUE '1'.
  6036             88  FINAL-PAYMENT                  VALUE '2'.
  6037             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6038             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6039             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6040             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6041             88  VOIDED-PAYMENT                 VALUE '9'.
  6042             88  TRANSFER                       VALUE 'T'.
  6043             88  LIFE-INTEREST                  VALUE 'I'.
  6044
  6045         16  AT-CLAIM-TYPE               PIC X.
  6046             88  PAID-FOR-AH                    VALUE 'A'.
  6047             88  PAID-FOR-LIFE                  VALUE 'L'.
  6048             88  PAID-FOR-IUI                   VALUE 'I'.
  6049             88  PAID-FOR-GAP                   VALUE 'G'.
  6050             88  PAID-FOR-FAM                   VALUE 'F'.
  6051             88  PAID-FOR-OTH                   VALUE 'O'.
  6052         16  AT-CLAIM-PREM-TYPE          PIC X.
  6053             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6054             88  AT-O-B-COVERAGE                VALUE '2'.
  6055             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6056         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6057         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 113
* EL130.cbl
  6058         16  AT-PAID-FROM-DT             PIC XX.
  6059         16  AT-PAID-THRU-DT             PIC XX.
  6060         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6061         16  AT-ACH-PAYMENT              PIC X.
  6062*        16  FILLER                      PIC X.
  6063         16  AT-PAYEES-NAME              PIC X(30).
  6064         16  AT-PAYMENT-ORIGIN           PIC X.
  6065             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6066             88  ONLINE-AUTO-PMT                VALUE '2'.
  6067             88  OFFLINE-PMT                    VALUE '3'.
  6068         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6069         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6070         16  AT-VOID-DATA.
  6071             20  AT-VOID-DT              PIC XX.
  6072*00144       20  AT-VOID-REASON          PIC X(30).
  6073             20  AT-VOID-REASON          PIC X(26).
  6074         16  AT-PMT-APPROVED-BY          PIC X(04).
  6075         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6076         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6077         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6078                                         PIC S99V9(5)  COMP-3.
  6079         16  AT-CREDIT-INTERFACE.
  6080             20  AT-PMT-SELECT-DT        PIC XX.
  6081                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6082             20  AT-PMT-ACCEPT-DT        PIC XX.
  6083                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6084             20  AT-VOID-SELECT-DT       PIC XX.
  6085                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6086             20  AT-VOID-ACCEPT-DT       PIC XX.
  6087                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6088
  6089         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6090                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6091                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6092         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6093
  6094         16  AT-FORCE-CONTROL            PIC X.
  6095             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6096         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6097         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6098         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6099         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6100         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6101         16  AT-BENEFIT-TYPE             PIC X.
  6102
  6103         16  AT-EXPENSE-TYPE             PIC X.
  6104         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6105
  6106         16  AT-PAYEE-TYPE-CD.
  6107             20  AT-PAYEE-TYPE           PIC X.
  6108                 88  INSURED-PAID           VALUE 'I'.
  6109                 88  BENEFICIARY-PAID       VALUE 'B'.
  6110                 88  ACCOUNT-PAID           VALUE 'A'.
  6111                 88  OTHER-1-PAID           VALUE 'O'.
  6112                 88  OTHER-2-PAID           VALUE 'Q'.
  6113                 88  DOCTOR-PAID            VALUE 'P'.
  6114                 88  EMPLOYER-PAID          VALUE 'E'.
  6115             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 114
* EL130.cbl
  6116
  6117         16  AT-CASH-PAYMENT             PIC X.
  6118         16  AT-GROUPED-PAYMENT          PIC X.
  6119         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6120         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6121         16  AT-APPROVED-LEVEL           PIC X.
  6122         16  AT-VOID-TYPE                PIC X.
  6123             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6124             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6125         16  AT-AIG-UNEMP-IND            PIC X.
  6126             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6127         16  AT-ASSOCIATES               PIC X.
  6128             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6129             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6130
  6131         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6132         16  AT-CV-PMT-CODE              PIC X.
  6133             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6134             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6135             88  FULL-ADD-PAYMENT           VALUE '3'.
  6136             88  HALF-ADD-PAYMENT           VALUE '4'.
  6137             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6138             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6139             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6140             88  ADDL-PAYMENT               VALUE '8'.
  6141
  6142         16  AT-EOB-CODE1                PIC XXX.
  6143         16  AT-EOB-CODE2                PIC XXX.
  6144         16  AT-EOB-CODE3                PIC XXX.
  6145         16  FILLER REDEFINES AT-EOB-CODE3.
  6146             20  AT-PRINT-CLM-FORM       PIC X.
  6147             20  AT-PRINT-SURVEY         PIC X.
  6148             20  AT-SPECIAL-RELEASE      PIC X.
  6149         16  AT-EOB-CODE4                PIC XXX.
  6150         16  FILLER REDEFINES AT-EOB-CODE4.
  6151             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6152             20  FILLER                  PIC X.
  6153         16  AT-EOB-CODE5                PIC XXX.
  6154         16  FILLER REDEFINES AT-EOB-CODE5.
  6155             20  AT-PMT-PROOF-DT         PIC XX.
  6156             20  FILLER                  PIC X.
  6157
  6158         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6159             88  AT-PRINT-EOB            VALUE 'Y'.
  6160
  6161         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6162         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6163
  6164     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6165         16  AT-SCHEDULE-START-DT        PIC XX.
  6166         16  AT-SCHEDULE-END-DT          PIC XX.
  6167         16  AT-TERMINATED-DT            PIC XX.
  6168         16  AT-LAST-PMT-TYPE            PIC X.
  6169             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6170             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6171         16  AT-FIRST-PMT-DATA.
  6172             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6173             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 115
* EL130.cbl
  6174             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6175         16  AT-REGULAR-PMT-DATA.
  6176             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6177             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6178             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6179         16  AT-AUTO-PAYEE-CD.
  6180             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6181                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6182                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6183                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6184                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6185                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6186             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6187         16  AT-AUTO-PAY-DAY             PIC 99.
  6188         16  AT-AUTO-CASH                PIC X.
  6189             88  AT-CASH                      VALUE 'Y'.
  6190             88  AT-NON-CASH                  VALUE 'N'.
  6191*        16  FILLER                      PIC X(129).
  6192         16  AT-AUTO-END-LETTER          PIC X(4).
  6193         16  FILLER                      PIC X(125).
  6194
  6195         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6196         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6197
  6198     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6199         16  AT-LETTER-SENT-DT           PIC XX.
  6200         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6201         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6202         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6203         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6204         16  AT-LETTER-ORIGIN            PIC X.
  6205             88  ONLINE-CREATION              VALUE '1' '3'.
  6206             88  OFFLINE-CREATION             VALUE '2' '4'.
  6207             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6208             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6209         16  AT-STD-LETTER-FORM          PIC X(4).
  6210         16  AT-REASON-TEXT              PIC X(70).
  6211         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6212         16  AT-ADDRESEE-TYPE            PIC X.
  6213              88  INSURED-ADDRESEE            VALUE 'I'.
  6214              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6215              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6216              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6217              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6218              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6219              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6220         16  AT-ADDRESSEE-NAME           PIC X(30).
  6221         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6222         16  AT-RESEND-PRINT-DATE        PIC XX.
  6223         16  AT-CORR-SOL-UNSOL           PIC X.
  6224         16  AT-LETTER-PURGED-DT         PIC XX.
  6225*
  6226*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6227*
  6228         16  AT-CSO-REDEFINITION.
  6229             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6230             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6231             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 116
* EL130.cbl
  6232             20  AT-STOP-LETTER-DT       PIC X(2).
  6233             20  AT-AUTH-RCVD            PIC X(1).
  6234             20  FILLER                  PIC X(18).
  6235*             20  FILLER                  PIC X(27).
  6236             20  AT-CSO-LETTER-STATUS    PIC X.
  6237                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6238                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6239                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6240             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6241             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6242*
  6243*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6244*
  6245*        16  FILLER                      PIC X(26).
  6246*
  6247*        16  AT-DMD-BSR-CODE             PIC X.
  6248*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6249*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6250*
  6251*        16  AT-DMD-LETTER-STATUS        PIC X.
  6252*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6253*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6254*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6255*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6256*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6257
  6258         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6259         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6260
  6261     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6262         16  AT-ADDRESS-TYPE             PIC X.
  6263             88  INSURED-ADDRESS               VALUE 'I'.
  6264             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6265             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6266             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6267             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6268             88  OTHER-ADDRESS-1               VALUE 'O'.
  6269             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6270         16  AT-MAIL-TO-NAME             PIC X(30).
  6271         16  AT-ADDRESS-LINE-1           PIC X(30).
  6272         16  AT-ADDRESS-LINE-2           PIC X(30).
  6273         16  AT-CITY-STATE.
  6274             20  AT-CITY                 PIC X(28).
  6275             20  AT-STATE                PIC XX.
  6276         16  AT-ZIP.
  6277             20  AT-ZIP-CODE.
  6278                 24  AT-ZIP-1ST          PIC X.
  6279                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6280                 24  FILLER              PIC X(4).
  6281             20  AT-ZIP-PLUS4            PIC X(4).
  6282         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6283             20  AT-CAN-POSTAL-1         PIC XXX.
  6284             20  AT-CAN-POSTAL-2         PIC XXX.
  6285             20  FILLER                  PIC XXX.
  6286         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6287*         16  FILLER                      PIC X(23).
  6288         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6289         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 117
* EL130.cbl
  6290         16  FILLER                      PIC X(13).
  6291         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6292         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6293
  6294     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6295         16  AT-INFO-LINE-1              PIC X(60).
  6296         16  FILLER REDEFINES AT-INFO-LINE-1.
  6297             20  AT-NOTE-ERROR-NO OCCURS 15
  6298                                         PIC X(4).
  6299         16  AT-INFO-LINE-2              PIC X(60).
  6300         16  FILLER REDEFINES AT-INFO-LINE-2.
  6301             20  AT-ICD-CODE-1           PIC X(8).
  6302             20  AT-ICD-CODE-2           PIC X(8).
  6303             20  FILLER                  PIC X(44).
  6304         16  AT-INFO-TRAILER-TYPE        PIC X.
  6305             88  AT-ERRORS-NOTE          VALUE 'E'.
  6306             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6307             88  AT-CALL-NOTE            VALUE 'C'.
  6308             88  AT-MAINT-NOTE           VALUE 'M'.
  6309             88  AT-CERT-CHANGE          VALUE 'X'.
  6310             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6311             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6312             88  AT-CERT-CANCELLED       VALUE 'T'.
  6313         16  AT-CALL-TYPE                PIC X.
  6314             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6315             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  6316             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6317         16  AT-NOTE-CONTINUATION        PIC X.
  6318             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6319         16  AT-EOB-CODES-EXIST          PIC X.
  6320             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6321         16  FILLER                      PIC X(35).
  6322         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6323         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6324
  6325     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6326         16  AT-PROMPT-LINE-1            PIC X(60).
  6327         16  AT-PROMPT-LINE-2            PIC X(60).
  6328         16  AT-PROMPT-START-DT          PIC XX.
  6329         16  AT-PROMPT-END-DT            PIC XX.
  6330         16  FILLER                      PIC X(35).
  6331         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6332         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6333
  6334     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6335         16  AT-DENIAL-INFO-1            PIC X(60).
  6336         16  AT-DENIAL-INFO-2            PIC X(60).
  6337         16  AT-DENIAL-DT                PIC XX.
  6338         16  AT-RETRACTION-DT            PIC XX.
  6339         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6340*         16  FILLER                      PIC X(31).
  6341         16  AT-DENIAL-PROOF-DT          PIC XX.
  6342         16  FILLER                      PIC X(29).
  6343         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6344         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6345
  6346     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6347         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 118
* EL130.cbl
  6348         16  AT-OLD-REPORTED-DT          PIC XX.
  6349         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6350         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6351         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6352         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6353         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6354         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6355         16  FILLER                      PIC X(26).
  6356         16  AT-OLD-DIAG-CODE            PIC X(6).
  6357         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6358         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6359         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6360         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6361         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6362         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6363         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6364         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6365         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6366         16  FILLER                      PIC X(9).
  6367         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6368
  6369     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6370         16  AT-FORM-SEND-ON-DT          PIC XX.
  6371         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6372         16  AT-FORM-RE-SEND-DT          PIC XX.
  6373         16  AT-FORM-ANSWERED-DT         PIC XX.
  6374         16  AT-FORM-PRINTED-DT          PIC XX.
  6375         16  AT-FORM-REPRINT-DT          PIC XX.
  6376         16  AT-FORM-TYPE                PIC X.
  6377             88  INITIAL-FORM                  VALUE '1'.
  6378             88  PROGRESS-FORM                 VALUE '2'.
  6379         16  AT-INSTRUCT-LN-1            PIC X(28).
  6380         16  AT-INSTRUCT-LN-2            PIC X(28).
  6381         16  AT-INSTRUCT-LN-3            PIC X(28).
  6382         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6383         16  AT-FORM-ADDRESS             PIC X.
  6384             88  FORM-TO-INSURED              VALUE 'I'.
  6385             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6386             88  FORM-TO-OTHER-1              VALUE 'O'.
  6387             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6388         16  AT-RELATED-1.
  6389             20 AT-REL-CARR-1            PIC X.
  6390             20 AT-REL-CLAIM-1           PIC X(7).
  6391             20 AT-REL-CERT-1            PIC X(11).
  6392         16  AT-RELATED-2.
  6393             20 AT-REL-CARR-2            PIC X.
  6394             20 AT-REL-CLAIM-2           PIC X(7).
  6395             20 AT-REL-CERT-2            PIC X(11).
  6396         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6397         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6398         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6399         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6400         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6401         16  AT-STOP-FORM-DT             PIC X(2).
  6402
  6403         16  FILLER                      PIC X(09).
  6404         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6405         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 119
* EL130.cbl
  6406******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 120
* EL130.cbl
  6408*    COPY ELCBENE.
  6409******************************************************************
  6410*                                                                *
  6411*                            ELCBENE.                            *
  6412*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6413*                            VMOD=2.006                          *
  6414*                                                                *
  6415*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6416*                                                                *
  6417*   FILE TYPE = VSAM,KSDS                                        *
  6418*   RECORD SIZE = 500   RECFORM = FIX                            *
  6419*                                                                *
  6420*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6421*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6422*                                                                *
  6423*   LOG = YES                                                    *
  6424*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6425*                                                                *
  6426*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6427******************************************************************
  6428*                   C H A N G E   L O G
  6429*
  6430* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6431*-----------------------------------------------------------------
  6432*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6433* EFFECTIVE    NUMBER
  6434*-----------------------------------------------------------------
  6435* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6436* 082317  CR2017082100003  PEMA  Add sub type
  6437* 032019  CR2019011400002  PEMA  Add email address for ach report
  6438******************************************************************
  6439
  6440 01  BENEFICIARY-MASTER.
  6441     12  BE-RECORD-ID                PIC XX.
  6442         88  VALID-BE-ID                VALUE 'BE'.
  6443
  6444     12  BE-CONTROL-PRIMARY.
  6445         16  BE-COMPANY-CD           PIC X.
  6446         16  BE-RECORD-TYPE          PIC X.
  6447             88  BENEFICIARY-RECORD  VALUE 'B'.
  6448             88  ADJUSTOR-RECORD     VALUE 'A'.
  6449         16  BE-BENEFICIARY          PIC X(10).
  6450     12  BE-CONTROL-BY-NAME.
  6451         16  BE-COMPANY-CD-A1        PIC X.
  6452         16  BE-RECORD-TYPE-A1       PIC X.
  6453         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6454         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6455
  6456     12  BE-LAST-MAINT-DT            PIC XX.
  6457     12  BE-LAST-MAINT-BY            PIC X(4).
  6458     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6459
  6460     12  BE-ADDRESS-DATA.
  6461         16  BE-MAIL-TO-NAME         PIC X(30).
  6462         16  BE-ADDRESS-LINE-1       PIC X(30).
  6463         16  BE-ADDRESS-LINE-2       PIC X(30).
  6464         16  BE-ADDRESS-LINE-3       PIC X(30).
  6465         16  BE-CITY-STATE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 121
* EL130.cbl
  6466             20  BE-CITY             PIC X(28).
  6467             20  BE-STATE            PIC XX.
  6468         16  BE-ZIP-CODE.
  6469             20  BE-ZIP-PRIME.
  6470                 24  BE-ZIP-1ST      PIC X.
  6471                     88  BE-CANADIAN-POST-CODE
  6472                                         VALUE 'A' THRU 'Z'.
  6473                 24  FILLER          PIC X(4).
  6474             20  BE-ZIP-PLUS4        PIC X(4).
  6475         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6476             20  BE-CAN-POSTAL-1     PIC XXX.
  6477             20  BE-CAN-POSTAL-2     PIC XXX.
  6478             20  FILLER              PIC XXX.
  6479         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6480         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6481
  6482******************************************************************
  6483*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6484*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6485******************************************************************
  6486     12  BE-CARRIER                  PIC X.
  6487
  6488     12  BE-ADDRESS-DATA2.
  6489         16  BE-MAIL-TO-NAME2        PIC X(30).
  6490         16  BE-ADDRESS-LINE-12      PIC X(30).
  6491         16  BE-ADDRESS-LINE-22      PIC X(30).
  6492         16  BE-ADDRESS-LINE-32      PIC X(30).
  6493         16  BE-CITY-STATE2.
  6494             20  BE-CITY2            PIC X(28).
  6495             20  BE-STATE2           PIC XX.
  6496         16  BE-ZIP-CODE2.
  6497             20  BE-ZIP-PRIME2.
  6498                 24  BE-ZIP-1ST2     PIC X.
  6499                     88  BE-CANADIAN-POST-CODE2
  6500                                         VALUE 'A' THRU 'Z'.
  6501                 24  FILLER          PIC X(4).
  6502             20  BE-ZIP-PLUS42       PIC X(4).
  6503         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6504             20  BE-CAN-POSTAL-12    PIC XXX.
  6505             20  BE-CAN-POSTAL-22    PIC XXX.
  6506             20  FILLER              PIC XXX.
  6507         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6508         16  BE-ACH-DATA.
  6509             20  BE-ACH-YES-OR-NO    PIC X.
  6510                 88  BE-ON-ACH       VALUE 'Y'.
  6511                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  6512             20  BE-ACH-ABA-ROUTING-NUMBER
  6513                                     PIC X(15).
  6514             20  BE-ACH-BANK-ACCOUNT-NUMBER
  6515                                     PIC X(20).
  6516             20  BE-ACH-SUB-TYPE     PIC XX.
  6517             20  BE-ACH-EMAIL-YN     PIC X.
  6518                 88  BE-EMAIL-ACH-RPT  VALUE 'Y'.
  6519             20  be-ach-email-addr   PIC X(40).
  6520         16  BE-BILLING-STMT-DATA.
  6521*            20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6522             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6523             20  BE-OUTPUT-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 122
* EL130.cbl
  6524                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6525                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6526
  6527     12  filler                      PIC X(16).
  6528******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 123
* EL130.cbl
  6530*    COPY ELCDAR.
  6531******************************************************************
  6532*                                                                *
  6533*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6534*   FILE TYPE = VSAM,KSDS                                        *
  6535*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6536*   BASE CLUSTER = DLYACTV                                       *
  6537*   LOG = YES                                                    *
  6538*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6539*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6540*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6541*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6542*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6543*               BY PROGRAM "LGINFCE".                            *
  6544*                                                                *
  6545******************************************************************
  6546 01  DAILY-ACTIVITY-RECORD.
  6547     05  DA-KEY.
  6548         10  DA-COMP-CD          PIC X.
  6549         10  DA-CARRIER          PIC X.
  6550         10  DA-CLAIM-NO         PIC X(7).
  6551         10  DA-CERT-NO.
  6552             15  DA-CERT-PRIME   PIC X(10).
  6553             15  DA-CERT-SFX     PIC X.
  6554     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6555     05  DA-RECORD-TYPE          PIC X.
  6556     05  FILLER                  PIC X(2).
  6557******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 124
* EL130.cbl
  6559*    COPY ELCACTQ.
  6560******************************************************************
  6561*                                                                *
  6562*                            ELCACTQ.                            *
  6563*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6564*                            VMOD=2.004                          *
  6565*                                                                *
  6566*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6567*                                                                *
  6568*   FILE TYPE = VSAM,KSDS                                        *
  6569*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6570*                                                                *
  6571*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6572*       ALTERNATE INDEX = NONE                                   *
  6573*                                                                *
  6574*   LOG = YES                                                    *
  6575*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6576*                                                                *
  6577*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6578******************************************************************
  6579
  6580 01  ACTIVITY-QUE.
  6581     12  AQ-RECORD-ID                PIC XX.
  6582         88  VALID-AQ-ID                VALUE 'AQ'.
  6583
  6584     12  AQ-CONTROL-PRIMARY.
  6585         16  AQ-COMPANY-CD           PIC X.
  6586         16  AQ-CARRIER              PIC X.
  6587         16  AQ-CLAIM-NO             PIC X(7).
  6588         16  AQ-CERT-NO.
  6589             20  AQ-CERT-PRIME       PIC X(10).
  6590             20  AQ-CERT-SFX         PIC X.
  6591
  6592     12  AQ-PENDING-ACTIVITY-FLAGS.
  6593         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6594         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6595             88  PENDING-PAYMENTS       VALUE '1'.
  6596         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6597             88  PENDING-FULL-PRINT     VALUE '1'.
  6598             88  PENDING-PART-PRINT     VALUE '2'.
  6599         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6600             88  PENDING-LETTERS        VALUE '1'.
  6601         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6602             88  PENDING-RESTORE        VALUE 'C'.
  6603             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6604
  6605     12  FILLER                      PIC X(20).
  6606
  6607     12  AQ-RESEND-DATE              PIC XX.
  6608     12  AQ-FOLLOWUP-DATE            PIC XX.
  6609     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6610     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6611     12  AQ-AUTO-LETTER              PIC X(4).
  6612     12  FILLER                      PIC XX.
  6613     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6614*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 125
* EL130.cbl
  6616*    COPY ELCARCH.
  6617******************************************************************
  6618*                                                                *
  6619*                            ELCARCH.                            *
  6620*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6621*                            VMOD=2.007                          *
  6622*                                                                *
  6623*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6624*                                                                *
  6625*   FILE TYPE = VSAM,KSDS                                        *
  6626*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6627*                                                                *
  6628*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6629*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6630*                                                                *
  6631*   LOG = NO                                                     *
  6632*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6633*                                                                *
  6634*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6635******************************************************************
  6636 01  LETTER-ARCHIVE.
  6637     12  LA-RECORD-ID                PIC XX.
  6638         88  VALID-LA-ID                VALUE 'LA'.
  6639
  6640     12  LA-CONTROL-PRIMARY.
  6641         16  LA-COMPANY-CD           PIC X.
  6642         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6643         16  LA-RECORD-TYPE          PIC X.
  6644             88  LA-HEADER-DATA         VALUE '1'.
  6645             88  LA-ADDRESS-DATA        VALUE '2'.
  6646             88  LA-TEXT-DATA           VALUE '3'.
  6647             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6648         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6649
  6650     12  LA-CONTROL-BY-TYPE.
  6651         16  LA-COMPANY-CD-A1        PIC X.
  6652         16  LA-RECORD-TYPE-A1       PIC X.
  6653         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6654         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6655
  6656     12  LA-TEXT-RECORD.
  6657         16  LA-SKIP-CONTROL         PIC XX.
  6658             88  NO-LINES-SKIPPED       VALUE SPACES.
  6659             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6660         16  LA-TEXT-LINE            PIC X(70).
  6661
  6662     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6663         16  FILLER                  PIC XX.
  6664         16  LA-ADDRESS-LINE         PIC X(30).
  6665         16  FILLER                  PIC X(40).
  6666
  6667     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6668         16  FILLER                  PIC XX.
  6669         16  LA-CARRIER              PIC X.
  6670         16  LA-CLAIM-NO             PIC X(7).
  6671         16  LA-CERT-NO.
  6672             20  LA-CERT-PRIME       PIC X(10).
  6673             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 126
* EL130.cbl
  6674         16  LA-NO-OF-COPIES         PIC S9.
  6675         16  LA-RESEND-DATE          PIC XX.
  6676         16  LA-PROCESSOR-CD         PIC X(4).
  6677         16  LA-CREATION-DT          PIC XX.
  6678         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6679         16  LA-RESEND-PRINT-DATE    PIC XX.
  6680         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6681         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6682*
  6683* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6684*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6685*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6686*   I        20  LA-DMD-RES-ST           PIC XX.
  6687*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6688*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6689*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6690*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6691*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6692*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6693*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6694*   I        20  LA-DMD-UND-CODE         PIC XX.
  6695*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6696*   V    16  FILLER                  PIC X(15).
  6697* -----
  6698*
  6699* REINSERTED  CSO  MODS
  6700*
  6701         16  FILLER.
  6702             20  FILLER                  PIC X(29).
  6703             20  LA-CSO-LETTER-STATUS    PIC X.
  6704                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6705                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6706                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6707             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6708             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6709*
  6710
  6711     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6712         16  FILLER                  PIC XX.
  6713         16  LA4-CARRIER             PIC X.
  6714         16  LA4-CLAIM-NO            PIC X(7).
  6715         16  LA4-CERT-NO.
  6716             20  LA4-CERT-PRIME      PIC X(10).
  6717             20  LA4-CERT-SFX        PIC X.
  6718         16  LA4-NO-OF-COPIES        PIC S9.
  6719         16  LA4-RESEND-DATE         PIC XX.
  6720         16  LA4-PROCESSOR-CD        PIC X(4).
  6721         16  LA4-CREATION-DT         PIC XX.
  6722         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6723         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6724         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6725         16  LA4-FORM-TYPE           PIC X.
  6726             88  LA4-INITIAL-FORM    VALUE '1'.
  6727             88  LA4-PROGRESS-FORM   VALUE '2'.
  6728         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6729         16  LA4-STATE               PIC X(02).
  6730         16  FILLER                  PIC X(31).
  6731******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 127
* EL130.cbl
  6733*    COPY ERCREIN.
  6734******************************************************************
  6735*                                                                *
  6736*                            ERCREIN                             *
  6737*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6738*                            VMOD=2.010                          *
  6739*                                                                *
  6740*   ONLINE CREDIT SYSTEM                                         *
  6741*                                                                *
  6742*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6743*                                                                *
  6744*   FILE TYPE = VSAM,KSDS                                        *
  6745*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6746*                                                                *
  6747*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6748*       ALTERNATE PATH = NONE                                    *
  6749*                                                                *
  6750*   LOG = NO                                                     *
  6751*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6752*                                                                *
  6753******************************************************************
  6754*                   C H A N G E   L O G
  6755*
  6756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6757*-----------------------------------------------------------------
  6758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6759* EFFECTIVE    NUMBER
  6760*-----------------------------------------------------------------
  6761* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6762* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6763******************************************************************
  6764 01  REINSURANCE-RECORD.
  6765     12  RE-RECORD-ID                      PIC XX.
  6766         88  VALID-RE-ID                      VALUE 'RE'.
  6767
  6768     12  RE-CONTROL-PRIMARY.
  6769         16  RE-COMPANY-CD                 PIC X.
  6770         16  RE-KEY.
  6771             20  RE-CODE                   PIC X.
  6772                 88  RE-TABLE-RECORD          VALUE 'A'.
  6773                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6774             20  RE-TABLE                  PIC XXX.
  6775             20  FILLER                    PIC XXX.
  6776         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6777             20  FILLER                    PIC X.
  6778             20  RE-COMPANY.
  6779                 24  RE-COMP-PRIME         PIC XXX.
  6780                 24  RE-COMP-SUB           PIC XXX.
  6781
  6782     12  RE-MAINT-INFORMATION.
  6783         16  RE-LAST-MAINT-DT              PIC XX.
  6784         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6785         16  RE-LAST-MAINT-USER            PIC X(4).
  6786         16  FILLER                        PIC X(10).
  6787
  6788     12  RE-TABLE-DATA.
  6789         16  RE-100-COMP                   PIC 99.
  6790
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 128
* EL130.cbl
  6791         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6792             20  RE-REI-COMP-NO.
  6793                 24  RE-REI-COMP           PIC XXX.
  6794                 24  RE-REI-COMP-SUB       PIC XXX.
  6795             20  RE-LF-QC                  PIC X.
  6796             20  RE-AH-QC                  PIC X.
  6797             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6798             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6799             20  RE-LFAGE-LO               PIC 99.
  6800             20  RE-LFAGE-HI               PIC 99.
  6801             20  RE-AHAGE-LO               PIC 99.
  6802             20  RE-AHAGE-HI               PIC 99.
  6803             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6804             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6805             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6806             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6807             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6808             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6809             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6810             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6811             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6812             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6813             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6814             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6815             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6816             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6817             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6818             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6819             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6820             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6821             20  RE-LF-BEN-CODE            PIC X.
  6822             20  RE-AH-BEN-CODE            PIC X.
  6823             20  RE-INTERACTIVE            PIC X.
  6824             20  RE-REMAINING              PIC X.
  6825             20  RE-LF-RUNOFF-SW           PIC X.
  6826             20  RE-AH-RUNOFF-SW           PIC X.
  6827             20  FILLER                    PIC X(19).
  6828
  6829         16  RE-COMP-INFO-END              PIC X(6).
  6830         16  RE-NSP-ST-CD-LF               PIC XX.
  6831         16  RE-NSP-ST-CD-AH               PIC XX.
  6832         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6833             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6834
  6835         16  FILLER                        PIC X(27).
  6836
  6837     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6838         16  RE-NAME                       PIC X(30).
  6839         16  RE-LF-PE                      PIC X.
  6840         16  RE-AH-PE                      PIC X.
  6841         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6842         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6843         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6844         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6845         16  RE-PRT-ST                     PIC X.
  6846         16  RE-PRT-OW                     PIC X.
  6847         16  RE-MORT-CODE                  PIC X(4).
  6848         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 129
* EL130.cbl
  6849         16  RE-ZERO-LF-FEE                PIC X.
  6850         16  RE-ZERO-AH-FEE                PIC X.
  6851         16  RE-CEDE-NAME                  PIC X(30).
  6852         16  RE-LF-COMM                    PIC X.
  6853         16  RE-AH-COMM                    PIC X.
  6854         16  RE-LF-TAX                     PIC X.
  6855         16  RE-AH-TAX                     PIC X.
  6856         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6857         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6858         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6859
  6860         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6861             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6862
  6863         16  RE-LF-CEDING-FEE-BRACKETS.
  6864             20  RE-LF-FEE-METHOD          PIC X.
  6865                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6866                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6867                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6868                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6869             20  RE-LF-FEE-BASIS           PIC X.
  6870                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6871                 88  RE-LF-NET-CEDED               VALUE '2'.
  6872                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6873                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6874                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6875                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6876                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6877                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6878             20  FILLER                    PIC XXX.
  6879             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6880                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6881                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6882
  6883         16  RE-AH-CEDING-FEE-BRACKETS.
  6884             20  RE-AH-FEE-METHOD          PIC X.
  6885                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6886                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6887                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6888                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6889             20  RE-AH-FEE-BASIS           PIC X.
  6890                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6891                 88  RE-AH-NET-CEDED               VALUE '2'.
  6892                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6893                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6894                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6895                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6896                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6897                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6898             20  FILLER                    PIC XXX.
  6899             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6900                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6901                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6902
  6903         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6904
  6905         16  RE-OLD-CEDING-STMT            PIC X.
  6906
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 130
* EL130.cbl
  6907         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6908         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6909         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6910         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6911         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6912         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6913         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6914         16  RE-MORT-SW                    PIC X.
  6915         16  RE-CEDING-TYPE-FLAG           PIC X.
  6916             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6917             88  RE-CEDED                          VALUE 'C'.
  6918             88  RE-ASSUMED                        VALUE 'A'.
  6919             88  RE-PHANTOM                        VALUE 'P'.
  6920
  6921         16  RE-CEDING-STMT-OPT-A          PIC X.
  6922             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6923         16  RE-CEDING-STMT-OPT-B          PIC X.
  6924             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6925         16  RE-CEDING-STMT-OPT-C          PIC X.
  6926             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6927         16  RE-CEDING-STMT-OPT-D          PIC X.
  6928             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6929         16  RE-CEDING-STMT-OPT-E          PIC X.
  6930             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6931
  6932         16  RE-PRT-CRSV                   PIC X.
  6933
  6934         16  RE-GL-CENTER                  PIC X(4).
  6935
  6936         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6937
  6938         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6939
  6940         16  RE-EARN-STOP-CODE             PIC X.
  6941             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6942             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6943
  6944         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6945             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6946
  6947         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6948         16  FILLER                        PIC X(2281).
  6949
  6950         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6951
  6952******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 131
* EL130.cbl
  6954*    COPY ERCMAIL.
  6955******************************************************************
  6956*                                                                *
  6957*                                                                *
  6958*                            ERCMAIL                             *
  6959*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6960*                            VMOD=2.003                          *
  6961*                                                                *
  6962*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6963*                                                                *
  6964*   FILE TYPE = VSAM,KSDS                                        *
  6965*   RECORD SIZE = 374   RECFORM = FIX                            *
  6966*                                                                *
  6967*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6968*   ALTERNATE PATH    = NOT USED                                 *
  6969*                                                                *
  6970*   LOG = YES                                                    *
  6971*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6972******************************************************************
  6973*                   C H A N G E   L O G
  6974*
  6975* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6976*-----------------------------------------------------------------
  6977*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6978* EFFECTIVE    NUMBER
  6979*-----------------------------------------------------------------
  6980* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6981* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6982* 111108                   PEMA  ADD CRED BENE ADDR2
  6983******************************************************************
  6984
  6985 01  MAILING-DATA.
  6986     12  MA-RECORD-ID                      PIC XX.
  6987         88  VALID-MA-ID                       VALUE 'MA'.
  6988
  6989     12  MA-CONTROL-PRIMARY.
  6990         16  MA-COMPANY-CD                 PIC X.
  6991         16  MA-CARRIER                    PIC X.
  6992         16  MA-GROUPING.
  6993             20  MA-GROUPING-PREFIX        PIC XXX.
  6994             20  MA-GROUPING-PRIME         PIC XXX.
  6995         16  MA-STATE                      PIC XX.
  6996         16  MA-ACCOUNT.
  6997             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6998             20  MA-ACCOUNT-PRIME          PIC X(6).
  6999         16  MA-CERT-EFF-DT                PIC XX.
  7000         16  MA-CERT-NO.
  7001             20  MA-CERT-PRIME             PIC X(10).
  7002             20  MA-CERT-SFX               PIC X.
  7003
  7004     12  FILLER                            PIC XX.
  7005
  7006     12  MA-ACCESS-CONTROL.
  7007         16  MA-SOURCE-SYSTEM              PIC XX.
  7008             88  MA-FROM-CREDIT                VALUE 'CR'.
  7009             88  MA-FROM-VSI                   VALUE 'VS'.
  7010             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7011             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 132
* EL130.cbl
  7012         16  MA-RECORD-ADD-DT              PIC XX.
  7013         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7014         16  MA-LAST-MAINT-DT              PIC XX.
  7015         16  MA-LAST-MAINT-BY              PIC XXXX.
  7016         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7017
  7018     12  MA-PROFILE-INFO.
  7019         16  MA-QUALIFY-CODE-1             PIC XX.
  7020         16  MA-QUALIFY-CODE-2             PIC XX.
  7021         16  MA-QUALIFY-CODE-3             PIC XX.
  7022         16  MA-QUALIFY-CODE-4             PIC XX.
  7023         16  MA-QUALIFY-CODE-5             PIC XX.
  7024
  7025         16  MA-INSURED-LAST-NAME          PIC X(15).
  7026         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7027         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7028         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7029         16  MA-INSURED-BIRTH-DT           PIC XX.
  7030         16  MA-INSURED-SEX                PIC X.
  7031             88  MA-SEX-MALE                   VALUE 'M'.
  7032             88  MA-SEX-FEMALE                 VALUE 'F'.
  7033         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7034
  7035         16  MA-ADDRESS-CORRECTED          PIC X.
  7036         16  MA-JOINT-BIRTH-DT             PIC XX.
  7037*        16  FILLER                        PIC X(12).
  7038
  7039         16  MA-ADDRESS-LINE-1             PIC X(30).
  7040         16  MA-ADDRESS-LINE-2             PIC X(30).
  7041         16  MA-CITY-STATE.
  7042             20  MA-CITY                   PIC X(28).
  7043             20  MA-ADDR-STATE             PIC XX.
  7044         16  MA-ZIP.
  7045             20  MA-ZIP-CODE.
  7046                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7047                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7048                 24  FILLER                PIC X(4).
  7049             20  MA-ZIP-PLUS4              PIC X(4).
  7050         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7051             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7052             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7053             20  FILLER                    PIC X(3).
  7054
  7055         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7056
  7057         16  FILLER                        PIC XXX.
  7058*        16  FILLER                        PIC X(10).
  7059
  7060     12  MA-CRED-BENE-INFO.
  7061         16  MA-CRED-BENE-NAME                 PIC X(25).
  7062         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7063         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7064         16  MA-CRED-BENE-CTYST.
  7065             20  MA-CRED-BENE-CITY             PIC X(28).
  7066             20  MA-CRED-BENE-STATE            PIC XX.
  7067         16  MA-CRED-BENE-ZIP.
  7068             20  MA-CB-ZIP-CODE.
  7069                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 133
* EL130.cbl
  7070                     88  MA-CB-CANADIAN-POST-CODE
  7071                                           VALUE 'A' THRU 'Z'.
  7072                 24  FILLER                    PIC X(4).
  7073             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7074         16  MA-CB-CANADIAN-POSTAL-CODE
  7075                            REDEFINES MA-CRED-BENE-ZIP.
  7076             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7077             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7078             20  FILLER                        PIC X(3).
  7079     12  MA-POST-CARD-MAIL-DATA.
  7080         16  MA-MAIL-DATA OCCURS 7.
  7081             20  MA-MAIL-TYPE              PIC X.
  7082                 88  MA-12MO-MAILING           VALUE '1'.
  7083                 88  MA-EXP-MAILING            VALUE '2'.
  7084             20  MA-MAIL-STATUS            PIC X.
  7085                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7086                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7087                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7088             20  MA-MAIL-DATE              PIC XX.
  7089     12  FILLER                            PIC XX.
  7090     12  FILLER                            PIC XX.
  7091*    12  FILLER                            PIC X(30).
  7092******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 134
* EL130.cbl
  7094*    COPY ELCCRTT.
  7095******************************************************************
  7096*                                                                *
  7097*                            ELCCRTT.                            *
  7098*                                                                *
  7099*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7100*                                                                *
  7101*   FILE TYPE = VSAM,KSDS                                        *
  7102*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7103*                                                                *
  7104*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7105*                                                                *
  7106*   LOG = YES                                                    *
  7107*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7108******************************************************************
  7109*                   C H A N G E   L O G
  7110*
  7111* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7112*-----------------------------------------------------------------
  7113*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7114* EFFECTIVE    NUMBER
  7115*-----------------------------------------------------------------
  7116* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7117* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7118* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7119* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7120* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7121* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7122* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7123* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7124* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7125* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7126* 091318  CR2018073000001  PEMA  ADD Refund methods
  7127* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7128******************************************************************
  7129
  7130 01  CERTIFICATE-TRAILERS.
  7131     12  CS-RECORD-ID                      PIC XX.
  7132         88  VALID-CS-ID                      VALUE 'CS'.
  7133
  7134     12  CS-CONTROL-PRIMARY.
  7135         16  CS-COMPANY-CD                 PIC X.
  7136         16  CS-CARRIER                    PIC X.
  7137         16  CS-GROUPING                   PIC X(6).
  7138         16  CS-STATE                      PIC XX.
  7139         16  CS-ACCOUNT                    PIC X(10).
  7140         16  CS-CERT-EFF-DT                PIC XX.
  7141         16  CS-CERT-NO.
  7142             20  CS-CERT-PRIME             PIC X(10).
  7143             20  CS-CERT-SFX               PIC X.
  7144         16  CS-TRAILER-TYPE               PIC X.
  7145             88  COMM-TRLR           VALUE 'A'.
  7146             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7147             88  CERT-DATA-TRLR      VALUE 'C'.
  7148
  7149     12  CS-DATA-AREA                      PIC X(516).
  7150
  7151     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 135
* EL130.cbl
  7152         16  CS-BANK-COMMISSION-AREA.
  7153             20  CS-BANK-COMMS       OCCURS 10.
  7154                 24  CS-AGT                PIC X(10).
  7155                 24  CS-COM-TYP            PIC X.
  7156                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7157                 24  CS-RECALC-LV-INDIC    PIC X.
  7158                 24  FILLER                PIC X(10).
  7159         16  FILLER                        PIC X(256).
  7160
  7161     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7162****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7163         16  CS-MB-CLAIM-DATA OCCURS 24.
  7164             20  CS-CLAIM-NO               PIC X(7).
  7165             20  CS-CLAIM-TYPE             PIC X.
  7166                 88  CS-AH-CLM               VALUE 'A'.
  7167                 88  CS-IU-CLM               VALUE 'I'.
  7168                 88  CS-GP-CLM               VALUE 'G'.
  7169                 88  CS-LF-CLM               VALUE 'L'.
  7170                 88  CS-PR-CLM               VALUE 'P'.
  7171                 88  CS-FL-CLM               VALUE 'F'.
  7172                 88  CS-OT-CLM               VALUE 'O'.
  7173             20  CS-INSURED-TYPE           PIC X.
  7174                 88  CS-PRIM-INSURED          VALUE 'P'.
  7175                 88  CS-CO-BORROWER           VALUE 'C'.
  7176             20  CS-BENEFIT-PERIOD         PIC 99.
  7177             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7178             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7179             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7180         16  FILLER                        PIC X(12).
  7181     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7182         16  CS-VIN-NUMBER                 PIC X(17).
  7183         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7184         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7185         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7186         16  cs-agent-name.
  7187             20  cs-agent-fname            pic x(20).
  7188             20  cs-agent-mi               pic x.
  7189             20  cs-agent-lname            pic x(25).
  7190         16  cs-license-no                 pic x(15).
  7191         16  cs-npn-number                 pic x(10).
  7192         16  cs-agent-edit-status          pic x.
  7193             88  cs-ae-refer-to-manager      value 'M'.
  7194             88  cs-ae-cover-sheet           value 'C'.
  7195             88  cs-ae-sig-form              value 'S'.
  7196             88  cs-ae-verified              value 'V'.
  7197             88  cs-unidentified-signature   value 'U'.
  7198             88  cs-cert-returned            value 'R'.
  7199             88  cs-accept-no-commission     value 'N'.
  7200         16  cs-year                       pic 9999.
  7201         16  cs-make                       pic x(20).
  7202         16  cs-model                      pic x(20).
  7203         16  cs-future                     pic x(20).
  7204         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7205         16  cs-claim-verification-status  pic x.
  7206             88  cs-clm-ver-eligible         value 'A'.
  7207             88  cs-clm-ver-partial-elig     value 'B'.
  7208             88  cs-clm-ver-not-eligible     value 'C'.
  7209             88  cs-clm-ver-not-elig-opn-clm value 'D'.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 136
* EL130.cbl
  7210             88  cs-clm-ver-not-part-elig-rw value 'E'.
  7211             88  cs-clm-ver-ND-CERT          value 'F'.
  7212             88  cs-clm-ver-spec-other       value 'G'.
  7213             88  cs-clam-ver-pratial-corrected
  7214                                             value 'H'.
  7215             88  cs-clm-ver-no-matches       value 'I'.
  7216             88  cs-clm-ver-not-elig-corrected
  7217                                             value 'J'.
  7218             88  cs-clm-ver-needs-review     value 'R'.
  7219             88  cs-clm-ver-sent-to-claims   value 'W'.
  7220         16  CS-LF-REFUND-METHOD           PIC X.
  7221         16  CS-AH-REFUND-METHOD           PIC X.
  7222         16  FILLER                        PIC X(353). *> was 420
  7223*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 137
* EL130.cbl
  7225
  7226 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7227                          CONTROL-FILE CERTIFICATE-MASTER
  7228                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7229                          BENEFICIARY-MASTER
  7230                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7231                          LETTER-ARCHIVE REINSURANCE-RECORD
  7232                          MAILING-DATA CERTIFICATE-TRAILERS.
  7233 0000-DFHEXIT SECTION.
  7234     MOVE '9#                    $   ' TO DFHEIV0.
  7235     MOVE 'EL130' TO DFHEIV1.
  7236     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7237     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7238     MOVE '5'                    TO DC-OPTION-CODE.
  7239     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7240     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7241     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7242
  7243     IF EIBCALEN = ZERO
  7244         GO TO 8800-UNAUTHORIZED-ACCESS
  7245     END-IF.
  7246
  7247     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7248     MOVE EIBTRMID               TO QID-TERM.
  7249     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7250     move spaces                 to emi-error-lines
  7251     MOVE '2'                    TO EMI-SWITCH2.
  7252     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7253     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7254
  7255
  7256* EXEC CICS HANDLE CONDITION
  7257*        QIDERR     (0100-TEST-ENTRY)
  7258*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7259*        PGMIDERR   (9600-PGMID-ERROR)
  7260*        TERMIDERR  (8820-TERM-ERROR)
  7261*        TRANSIDERR (8830-TRAN-ERROR)
  7262*        ERROR      (9990-ABEND)
  7263*    END-EXEC.
  7264*    MOVE '"$N?L[\.              ! " #00007251' TO DFHEIV0
  7265     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7267     MOVE X'2220233030303037323531' TO DFHEIV0(25:11)
  7268     CALL 'kxdfhei1' USING DFHEIV0
  7269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7270
  7271
  7272     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7273        PI-CALLING-PROGRAM   = XCTL-6592
  7274         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7275     ELSE
  7276         MOVE SPACES             TO RETURNED-FROM
  7277     END-IF.
  7278
  7279     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7280         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7281             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7282             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 138
* EL130.cbl
  7283             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7284             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7285             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7286             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7287             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7288             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7289         ELSE
  7290             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7291             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7292             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7293             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7294             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7295             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7296             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7297             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7298         END-IF
  7299     END-IF.
  7300
  7301     IF EIBTRNID = TRANS-ID
  7302         IF EIBAID = DFHCLEAR
  7303             GO TO 9400-CLEAR
  7304         ELSE
  7305             GO TO 0200-RECEIVE
  7306         END-IF
  7307     END-IF.
  7308
  7309     IF RETURNED-FROM NOT = SPACES
  7310         GO TO 0600-RECOVER-TEMP-STORAGE
  7311     END-IF.
  7312
  7313     MOVE LOW-VALUES TO EL130AO.
  7314     move zeros to pi-dcc-max-amt
  7315                   pi-dcc-max-benefits
  7316
  7317
  7318
  7319* EXEC CICS DELETEQ TS
  7320*         QUEUE   (QID)
  7321*    END-EXEC.
  7322*    MOVE '*&                    #   #00007306' TO DFHEIV0
  7323     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7324     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7325     MOVE X'2020233030303037333036' TO DFHEIV0(25:11)
  7326     CALL 'kxdfhei1' USING DFHEIV0,
  7327           QID,
  7328           DFHEIV99
  7329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7330
  7331
  7332 0100-TEST-ENTRY.
  7333     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7334         GO TO 0650-FROM-EL127
  7335     ELSE
  7336         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7337                                    PI-CERT-PROCESSED
  7338                                    PI-LETTER-ERROR-CODE
  7339     END-IF.
  7340
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 139
* EL130.cbl
  7341     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7342         GO TO 0640-FROM-EL132
  7343     END-IF.
  7344
  7345     GO TO 8100-SEND-INITIAL-MAP.
  7346
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 140
* EL130.cbl
  7348 0200-RECEIVE.
  7349     MOVE LOW-VALUES             TO EL130AI.
  7350
  7351     IF PI-PROCESSOR-ID = 'LGXX'
  7352*        NEXT SENTENCE
  7353         CONTINUE
  7354     ELSE
  7355
  7356* EXEC CICS READQ TS
  7357*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7358*            INTO    (SECURITY-CONTROL)
  7359*            LENGTH  (SC-COMM-LENGTH)
  7360*            ITEM    (SC-ITEM)
  7361*        END-EXEC
  7362*    MOVE '*$II   L              ''   #00007333' TO DFHEIV0
  7363     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7364     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7365     MOVE X'2020233030303037333333' TO DFHEIV0(25:11)
  7366     CALL 'kxdfhei1' USING DFHEIV0,
  7367           PI-SECURITY-TEMP-STORE-ID,
  7368           SECURITY-CONTROL,
  7369           SC-COMM-LENGTH,
  7370           SC-ITEM,
  7371           DFHEIV99,
  7372           DFHEIV99
  7373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7374         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7375         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7376         IF NOT DISPLAY-CAP
  7377             MOVE 'READ'              TO  SM-READ
  7378             PERFORM 9995-SECURITY-VIOLATION
  7379             MOVE ER-0070             TO  EMI-ERROR
  7380             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7381             GO TO 8100-SEND-INITIAL-MAP
  7382         END-IF
  7383     END-IF.
  7384
  7385     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7386         MOVE ER-7008 TO EMI-ERROR
  7387         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7388         MOVE -1 TO MAINTL
  7389         GO TO 8200-SEND-DATAONLY
  7390     END-IF.
  7391
  7392
  7393
  7394* EXEC CICS RECEIVE
  7395*         MAP     (MAP-NAME)
  7396*         MAPSET  (MAPSET-NAME)
  7397*         INTO    (EL130AI)
  7398*    END-EXEC.
  7399     MOVE LENGTH OF
  7400      EL130AI
  7401       TO DFHEIV11
  7402*    MOVE '8"T I  L              ''   #00007358' TO DFHEIV0
  7403     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7404     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7405     MOVE X'2020233030303037333538' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 141
* EL130.cbl
  7406     CALL 'kxdfhei1' USING DFHEIV0,
  7407           MAP-NAME,
  7408           EL130AI,
  7409           DFHEIV11,
  7410           MAPSET-NAME,
  7411           DFHEIV99,
  7412           DFHEIV99
  7413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7414
  7415
  7416     IF NOT PI-NO-CARRIER-SECURITY
  7417        MOVE +1                  TO CLMCARRL
  7418        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7419     END-IF.
  7420
  7421     IF ENTERPFL = ZERO
  7422         GO TO 0300-CHECK-PFKEYS
  7423     END-IF.
  7424
  7425     IF EIBAID NOT = DFHENTER
  7426         MOVE ER-0004            TO EMI-ERROR
  7427         GO TO 0320-INPUT-ERROR
  7428     END-IF.
  7429
  7430     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7431         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7432     ELSE
  7433         MOVE ER-0029            TO EMI-ERROR
  7434         GO TO 0320-INPUT-ERROR
  7435     END-IF.
  7436
  7437 0300-CHECK-PFKEYS.
  7438     IF EIBAID = DFHPF23
  7439         GO TO 8810-PF23
  7440     END-IF.
  7441
  7442     IF EIBAID = DFHPF24
  7443         GO TO 9200-RETURN-MAIN-MENU
  7444     END-IF.
  7445
  7446     IF EIBAID = DFHPF12
  7447         GO TO 9500-PF12
  7448     END-IF.
  7449
  7450     IF EIBAID = DFHPF3
  7451         MOVE SPACES              TO MAINTI
  7452         MOVE ZEROS               TO MAINTL
  7453         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7454         MOVE XCTL-127            TO PGM-NAME
  7455         GO TO 9300-XCTL
  7456     END-IF.
  7457
  7458     IF EIBAID = DFHPF4
  7459         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7460         MOVE XCTL-132            TO PGM-NAME
  7461         GO TO 9300-XCTL
  7462     END-IF.
  7463
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 142
* EL130.cbl
  7464     IF EIBAID = DFHPF13
  7465         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7466             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7467             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7468             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7469             MOVE PI-STATE            TO  PI-CR-STATE
  7470             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7471             MOVE XCTL-650            TO  PGM-NAME
  7472             GO TO 9300-XCTL
  7473         ELSE
  7474             MOVE -1                  TO  ENTERPFL
  7475             MOVE ER-2566             TO  EMI-ERROR
  7476             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7477             GO TO 8100-SEND-INITIAL-MAP
  7478         END-IF
  7479     END-IF.
  7480
  7481     IF EIBAID = DFHPF5
  7482         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7483             ADD +1 TO PI-CERT-PROCESSED
  7484             GO TO 0650-FROM-EL127
  7485         ELSE
  7486             MOVE ER-7686         TO EMI-ERROR
  7487             GO TO 0320-INPUT-ERROR
  7488         END-IF
  7489     END-IF.
  7490
  7491     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7492         GO TO 0800-TEST-PREVIOUS-CONTROL
  7493     END-IF.
  7494
  7495     IF PI-HAS-CLAS-IC-CRDTCRD
  7496         IF EIBAID = DFHPF10
  7497             MOVE XCTL-725          TO PGM-NAME
  7498             GO TO 9300-XCTL
  7499         END-IF
  7500     END-IF.
  7501
  7502     IF EIBAID = DFHPF14
  7503         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7504         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7505         MOVE XCTL-659            TO PGM-NAME
  7506         GO TO 9300-XCTL
  7507     END-IF.
  7508
  7509     IF EIBAID = DFHPF15
  7510         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7511         MOVE XCTL-114            TO PGM-NAME
  7512         GO TO 9300-XCTL
  7513     END-IF.
  7514
  7515*    IF EIBAID = DFHPF11
  7516*       GO TO 0600-RECOVER-TEMP-STORAGE
  7517*    END-IF
  7518     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7519         GO TO 0330-EDIT-DATA
  7520     END-IF.
  7521
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 143
* EL130.cbl
  7522     MOVE ER-0029                TO EMI-ERROR.
  7523
  7524 0320-INPUT-ERROR.
  7525     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7526
  7527     MOVE AL-UNBON               TO ENTERPFA.
  7528
  7529     IF ENTERPFL = ZERO
  7530         MOVE -1                 TO MAINTL
  7531     ELSE
  7532         MOVE -1                 TO ENTERPFL
  7533     END-IF.
  7534
  7535     GO TO 8200-SEND-DATAONLY.
  7536
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 144
* EL130.cbl
  7538 0330-EDIT-DATA.
  7539
  7540     IF MAINTI = 'S'
  7541         IF PRTOPTL GREATER THAN 0
  7542             IF PRTOPTI NOT = 'N' AND 'L'
  7543                 MOVE AL-UABON   TO  PRTOPTA
  7544                 MOVE -1         TO  PRTOPTL
  7545                 MOVE ER-0334    TO  EMI-ERROR
  7546                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7547                 GO TO 8200-SEND-DATAONLY
  7548             ELSE
  7549                 IF PRTOPTI = 'L'
  7550                     GO TO 0400-CREATE-ELACTQ
  7551                 ELSE
  7552                     GO TO 0480-PRINT-NOW
  7553                 END-IF
  7554             END-IF
  7555         ELSE
  7556             GO TO 1000-SHOW-CLAIM
  7557         END-IF
  7558     END-IF.
  7559
  7560     IF NOT MODIFY-CAP
  7561         MOVE 'UPDATE'       TO  SM-READ
  7562         PERFORM 9995-SECURITY-VIOLATION
  7563         MOVE ER-0070        TO  EMI-ERROR
  7564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7565         GO TO 8100-SEND-INITIAL-MAP
  7566     END-IF.
  7567
  7568     IF MAINTI = 'D'
  7569         GO TO 2000-DELETE-CLAIM
  7570     END-IF.
  7571
  7572     IF MAINTI = 'A'
  7573         GO TO 3000-ADD-CLAIM
  7574     END-IF.
  7575
  7576     IF MAINTI = 'I'
  7577         GO TO 5000-INCURRED-CHANGE
  7578     END-IF.
  7579
  7580     MOVE ER-0023                TO EMI-ERROR.
  7581     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7582     MOVE -1                     TO MAINTL.
  7583     MOVE AL-UABON               TO MAINTA.
  7584
  7585     GO TO 8200-SEND-DATAONLY.
  7586
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 145
* EL130.cbl
  7588 0400-CREATE-ELACTQ.
  7589     IF CLMNOI   = PI-LAST-CLAIM      AND
  7590        CLMCARRI = PI-LAST-CARR       AND
  7591        CERTNOI  = PI-LAST-CERT-PRIME AND
  7592        SUFXI    = PI-LAST-CERT-SUFX
  7593         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7594         MOVE PI-LAST-CARR       TO PI-CARRIER
  7595         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7596     ELSE
  7597         MOVE ER-0207            TO EMI-ERROR
  7598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7599         MOVE -1                 TO MAINTL
  7600         GO TO 8200-SEND-DATAONLY
  7601     END-IF.
  7602
  7603     IF (NOT PI-NO-CARRIER-SECURITY OR
  7604         NOT PI-NO-ACCOUNT-SECURITY)
  7605         MOVE AL-UABON      TO  PRTOPTA
  7606         MOVE -1            TO  PRTOPTL
  7607         MOVE ER-2378       TO  EMI-ERROR
  7608         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7609         GO TO 8200-SEND-DATAONLY
  7610     END-IF.
  7611
  7612     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7613     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7614     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7615     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7616
  7617
  7618
  7619* EXEC CICS HANDLE CONDITION
  7620*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7621*    END-EXEC.
  7622*    MOVE '"$I                   ! # #00007566' TO DFHEIV0
  7623     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7624     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7625     MOVE X'2320233030303037353636' TO DFHEIV0(25:11)
  7626     CALL 'kxdfhei1' USING DFHEIV0
  7627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7628
  7629
  7630
  7631
  7632* EXEC CICS READ
  7633*         UPDATE
  7634*         DATASET    (ELACTQ-DSID)
  7635*         SET        (ADDRESS OF ACTIVITY-QUE)
  7636*         RIDFLD     (ELACTQ-KEY)
  7637*    END-EXEC.
  7638*    MOVE '&"S        EU         (   #00007571' TO DFHEIV0
  7639     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7640     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7641     MOVE X'2020233030303037353731' TO DFHEIV0(25:11)
  7642     CALL 'kxdfhei1' USING DFHEIV0,
  7643           ELACTQ-DSID,
  7644           DFHEIV20,
  7645           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 146
* EL130.cbl
  7646           ELACTQ-KEY,
  7647           DFHEIV99,
  7648           DFHEIV99,
  7649           DFHEIV99
  7650     SET ADDRESS OF ACTIVITY-QUE TO
  7651         DFHEIV20
  7652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7653
  7654
  7655     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7656     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7657
  7658
  7659
  7660* EXEC CICS REWRITE
  7661*         DATASET     (ELACTQ-DSID)
  7662*         FROM        (ACTIVITY-QUE)
  7663*    END-EXEC.
  7664     MOVE LENGTH OF
  7665      ACTIVITY-QUE
  7666       TO DFHEIV11
  7667*    MOVE '&& L                  %   #00007582' TO DFHEIV0
  7668     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7669     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7670     MOVE X'2020233030303037353832' TO DFHEIV0(25:11)
  7671     CALL 'kxdfhei1' USING DFHEIV0,
  7672           ELACTQ-DSID,
  7673           ACTIVITY-QUE,
  7674           DFHEIV11,
  7675           DFHEIV99
  7676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7677
  7678
  7679     GO TO 0470-STATUS-FINISH.
  7680
  7681 0450-ADD-ELACTQ-RECORD.
  7682
  7683
  7684* EXEC CICS GETMAIN
  7685*        SET     (ADDRESS OF ACTIVITY-QUE)
  7686*        LENGTH  (ELACTQ-LENGTH)
  7687*        INITIMG (GETMAIN-SPACE)
  7688*    END-EXEC.
  7689*    MOVE ',"IL                  $   #00007591' TO DFHEIV0
  7690     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7691     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7692     MOVE X'2020233030303037353931' TO DFHEIV0(25:11)
  7693     CALL 'kxdfhei1' USING DFHEIV0,
  7694           DFHEIV20,
  7695           ELACTQ-LENGTH,
  7696           GETMAIN-SPACE
  7697     SET ADDRESS OF ACTIVITY-QUE TO
  7698         DFHEIV20
  7699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7700
  7701
  7702     MOVE 'AQ'              TO AQ-RECORD-ID.
  7703     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 147
* EL130.cbl
  7704     MOVE +0                TO AQ-PAYMENT-COUNTER
  7705                               AQ-PMT-UNAPPROVED-COUNT.
  7706     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7707                               AQ-FOLLOWUP-DATE.
  7708     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7709     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7710
  7711
  7712
  7713* EXEC CICS WRITE
  7714*         DATASET     (ELACTQ-DSID)
  7715*         FROM        (ACTIVITY-QUE)
  7716*         RIDFLD      (ELACTQ-KEY)
  7717*    END-EXEC.
  7718     MOVE LENGTH OF
  7719      ACTIVITY-QUE
  7720       TO DFHEIV11
  7721*    MOVE '&$ L                  ''   #00007607' TO DFHEIV0
  7722     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7723     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7724     MOVE X'2020233030303037363037' TO DFHEIV0(25:11)
  7725     CALL 'kxdfhei1' USING DFHEIV0,
  7726           ELACTQ-DSID,
  7727           ACTIVITY-QUE,
  7728           DFHEIV11,
  7729           ELACTQ-KEY,
  7730           DFHEIV99,
  7731           DFHEIV99
  7732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7733
  7734
  7735 0470-STATUS-FINISH.
  7736     MOVE AL-UANOF               TO  PRTOPTA
  7737                                     ALTPRTA.
  7738
  7739     MOVE SPACES                 TO  PRTOPTO
  7740                                     ALTPRTO.
  7741
  7742     MOVE ER-0000                TO EMI-ERROR.
  7743     MOVE -1                     TO MAINTL.
  7744     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7745     GO TO 8100-SEND-INITIAL-MAP.
  7746
  7747 0480-PRINT-NOW.
  7748
  7749
  7750* EXEC CICS HANDLE CONDITION
  7751*        TERMIDERR   (8820-TERM-ERROR)
  7752*        TRANSIDERR  (8830-TRAN-ERROR)
  7753*    END-EXEC.
  7754*    MOVE '"$[\                  ! $ #00007627' TO DFHEIV0
  7755     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7757     MOVE X'2420233030303037363237' TO DFHEIV0(25:11)
  7758     CALL 'kxdfhei1' USING DFHEIV0
  7759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7760
  7761
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 148
* EL130.cbl
  7762     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7763     MOVE '1'                    TO  CNTL-REC-TYPE.
  7764     MOVE SPACES                 TO  CNTL-ACCESS.
  7765     MOVE +0                     TO  CNTL-SEQ-NO.
  7766     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7767
  7768     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7769
  7770     IF CF-FORMS-PRINTER-ID = SPACES
  7771         IF ALTPRTL NOT GREATER THAN 0
  7772             MOVE ER-0337        TO  EMI-ERROR
  7773             MOVE -1             TO  ALTPRTL
  7774             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7775             GO TO 8200-SEND-DATAONLY
  7776         END-IF
  7777     END-IF.
  7778
  7779     IF ALTPRTL GREATER THAN 0
  7780         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7781     END-IF.
  7782
  7783     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7784     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7785     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7786
  7787
  7788
  7789* EXEC CICS START
  7790*        TRANSID   (START-TRANS-ID)
  7791*        TERMID    (CF-FORMS-PRINTER-ID)
  7792*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7793*        LENGTH    (PI-COMM-LENGTH)
  7794*    END-EXEC.
  7795*    MOVE '0( LFT                1   #00007658' TO DFHEIV0
  7796     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7797     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7798     MOVE X'2020233030303037363538' TO DFHEIV0(25:11)
  7799     CALL 'kxdfhei1' USING DFHEIV0,
  7800           DFHEIV99,
  7801           START-TRANS-ID,
  7802           DFHEIV99,
  7803           PROGRAM-INTERFACE-BLOCK,
  7804           PI-COMM-LENGTH,
  7805           CF-FORMS-PRINTER-ID,
  7806           DFHEIV99,
  7807           DFHEIV99,
  7808           DFHEIV99,
  7809           DFHEIV99,
  7810           DFHEIV99,
  7811           DFHEIV99,
  7812           DFHEIV99,
  7813           DFHEIV99,
  7814           DFHEIV99,
  7815           DFHEIV99
  7816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7817
  7818
  7819     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 149
* EL130.cbl
  7820                                     ALTPRTA.
  7821
  7822     MOVE SPACES                 TO  PRTOPTO
  7823                                     ALTPRTO.
  7824
  7825     MOVE ER-0000                TO  EMI-ERROR.
  7826     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7827     MOVE -1                     TO  MAINTL.
  7828     GO TO 8100-SEND-INITIAL-MAP.
  7829
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 150
* EL130.cbl
  7831 0500-CREATE-TEMP-STORAGE.
  7832     MOVE EIBCPOSN               TO PI-CURSOR.
  7833
  7834    move emi-line1               to errmsg1o
  7835    move emi-line2               to errmsg2o
  7836    move emi-sub                 to pi-emi-sub
  7837
  7838
  7839* EXEC CICS WRITEQ TS
  7840*        QUEUE   (QID)
  7841*        FROM    (EL130AI)
  7842*        LENGTH  (QID-MAP-LENGTH)
  7843*    END-EXEC.
  7844*    MOVE '*"     L              ''   #00007684' TO DFHEIV0
  7845     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7846     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7847     MOVE X'2020233030303037363834' TO DFHEIV0(25:11)
  7848     CALL 'kxdfhei1' USING DFHEIV0,
  7849           QID,
  7850           EL130AI,
  7851           QID-MAP-LENGTH,
  7852           DFHEIV99,
  7853           DFHEIV99,
  7854           DFHEIV99
  7855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7856
  7857
  7858
  7859
  7860* EXEC CICS WRITEQ TS
  7861*        QUEUE    (QID)
  7862*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7863*        LENGTH   (PI-COMM-LENGTH)
  7864*    END-EXEC.
  7865*    MOVE '*"     L              ''   #00007691' TO DFHEIV0
  7866     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7867     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7868     MOVE X'2020233030303037363931' TO DFHEIV0(25:11)
  7869     CALL 'kxdfhei1' USING DFHEIV0,
  7870           QID,
  7871           PROGRAM-INTERFACE-BLOCK,
  7872           PI-COMM-LENGTH,
  7873           DFHEIV99,
  7874           DFHEIV99,
  7875           DFHEIV99
  7876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7877
  7878
  7879 0599-EXIT.
  7880      EXIT.
  7881
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 151
* EL130.cbl
  7883 0600-RECOVER-TEMP-STORAGE.
  7884     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7885     MOVE PI-EL127-TO-EL130-CNTRL
  7886                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7887     MOVE PI-EL659-TO-EL130-CNTRL
  7888                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7889     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7890     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7891     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7892     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7893     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7894     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7895     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7896     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7897     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7898     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7899     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7900     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7901     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7902     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7903     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7904     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7905                                 TO SAVE-BENEFICIARY
  7906
  7907
  7908
  7909* EXEC CICS HANDLE CONDITION
  7910*        NOTFND  (0660-NOT-FOUND)
  7911*        QIDERR  (0670-QIDERR)
  7912*    END-EXEC.
  7913*    MOVE '"$IN                  ! % #00007726' TO DFHEIV0
  7914     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7916     MOVE X'2520233030303037373236' TO DFHEIV0(25:11)
  7917     CALL 'kxdfhei1' USING DFHEIV0
  7918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7919
  7920
  7921
  7922
  7923* EXEC CICS READQ TS
  7924*        QUEUE    (QID)
  7925*        INTO     (EL130AI)
  7926*        LENGTH   (QID-MAP-LENGTH)
  7927*    END-EXEC.
  7928*    MOVE '*$I    L              ''   #00007732' TO DFHEIV0
  7929     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7930     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7931     MOVE X'2020233030303037373332' TO DFHEIV0(25:11)
  7932     CALL 'kxdfhei1' USING DFHEIV0,
  7933           QID,
  7934           EL130AI,
  7935           QID-MAP-LENGTH,
  7936           DFHEIV99,
  7937           DFHEIV99,
  7938           DFHEIV99
  7939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7940
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 152
* EL130.cbl
  7941
  7942     IF RETURNED-FROM = XCTL-131
  7943        IF CLAIM-DELETED-BY-EL131
  7944            MOVE LOW-VALUES      TO CERTNOI
  7945                                    SUFXI
  7946            MOVE ZEROS           TO CERTNOL
  7947                                    SUFXL
  7948         END-IF
  7949     END-IF.
  7950
  7951     IF RETURNED-FROM = XCTL-131
  7952         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7953         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7954                                    PI-CERT-PROCESSED
  7955     ELSE
  7956
  7957
  7958* EXEC CICS READQ TS
  7959*             QUEUE   (QID)
  7960*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7961*             LENGTH  (PI-COMM-LENGTH)
  7962*        END-EXEC
  7963*    MOVE '*$I    L              ''   #00007753' TO DFHEIV0
  7964     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7965     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7966     MOVE X'2020233030303037373533' TO DFHEIV0(25:11)
  7967     CALL 'kxdfhei1' USING DFHEIV0,
  7968           QID,
  7969           PROGRAM-INTERFACE-BLOCK,
  7970           PI-COMM-LENGTH,
  7971           DFHEIV99,
  7972           DFHEIV99,
  7973           DFHEIV99
  7974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7975     END-IF.
  7976
  7977
  7978* EXEC CICS DELETEQ TS
  7979*        QUEUE   (QID)
  7980*    END-EXEC.
  7981*    MOVE '*&                    #   #00007760' TO DFHEIV0
  7982     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7983     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7984     MOVE X'2020233030303037373630' TO DFHEIV0(25:11)
  7985     CALL 'kxdfhei1' USING DFHEIV0,
  7986           QID,
  7987           DFHEIV99
  7988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7989
  7990
  7991     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7992
  7993     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7994         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7995         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7996         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7997         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7998         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 153
* EL130.cbl
  7999         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  8000         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  8001         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  8002         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  8003         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  8004         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  8005         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  8006         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  8007         MOVE SAVE-CERT-ACCESS-CONTROL
  8008                                    TO PI-CERT-ACCESS-CONTROL
  8009         MOVE SAVE-CARRIER-CONTROL-LEVEL
  8010                                    TO PI-CARRIER-CONTROL-LEVEL
  8011     END-IF.
  8012
  8013*    IF EIBAID = DFHPF11
  8014*       move errmsg1i            to emi-line1
  8015*       move errmsg2i            to emi-line2
  8016*       move pi-emi-sub          to emi-sub
  8017*       go to 8200-SEND-DATAONLY
  8018*    end-if
  8019     IF RETURNED-FROM = XCTL-127
  8020         MOVE SAVE-EL127-TO-EL130-CNTRL
  8021                                 TO PI-EL127-TO-EL130-CNTRL
  8022     END-IF.
  8023
  8024     IF RETURNED-FROM = XCTL-6592
  8025        MOVE SAVE-EL659-TO-EL130-CNTRL
  8026                                 TO PI-EL659-TO-EL130-CNTRL
  8027     END-IF.
  8028
  8029     IF RETURNED-FROM = XCTL-114
  8030        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  8031           MOVE SAVE-BENEFICIARY TO BENECDI
  8032           MOVE +10              TO BENECDL
  8033           MOVE -1               TO BIRTHDTL
  8034        END-IF
  8035     END-IF.
  8036     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  8037
  8038     IF MAINTL NOT = ZERO
  8039         MOVE AL-UANON           TO MAINTA
  8040     END-IF.
  8041
  8042     IF ENTERPFL NOT = ZERO
  8043         MOVE AL-UNNON           TO ENTERPFA
  8044     END-IF.
  8045
  8046     IF RETURNED-FROM = XCTL-127
  8047         GO TO 0650-FROM-EL127
  8048     END-IF.
  8049
  8050     IF RETURNED-FROM = XCTL-132
  8051         GO TO 0640-FROM-EL132
  8052     END-IF.
  8053
  8054     IF RETURNED-FROM = XCTL-650
  8055         MOVE AL-SABON           TO PF5A
  8056         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 154
* EL130.cbl
  8057     END-IF.
  8058
  8059     IF RETURNED-FROM = XCTL-6592
  8060         GO TO 0630-FROM-EL6592
  8061     END-IF.
  8062
  8063     IF MAINTI = 'S' OR 'I'
  8064        GO TO 1000-SHOW-CLAIM
  8065     END-IF.
  8066
  8067     GO TO 8100-SEND-INITIAL-MAP.
  8068
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 155
* EL130.cbl
  8070 0630-FROM-EL6592.
  8071     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  8072     MOVE PI-EL659-GROUPING      TO GROUPO.
  8073     MOVE PI-EL659-STATE         TO STATEO.
  8074     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  8075
  8076     MOVE AL-UANON               TO CRTCARRA
  8077                                    GROUPA
  8078                                    STATEA
  8079                                    ACCOUNTA.
  8080     GO TO 8100-SEND-INITIAL-MAP.
  8081
  8082 0640-FROM-EL132.
  8083     IF PI-CLAIM-NO = SPACES
  8084         GO TO 0645-NO-CLAIM-SELECTED
  8085     END-IF.
  8086
  8087     MOVE LOW-VALUES             TO EL130AI.
  8088     MOVE 'MSTR'                 TO FILE-SWITCH.
  8089     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8090     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8091     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  8092                                    CLMNOO.
  8093     MOVE AL-UANON               TO CLMNOA.
  8094     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8095
  8096
  8097
  8098* EXEC CICS HANDLE CONDITION
  8099*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8100*    END-EXEC.
  8101*    MOVE '"$I                   ! & #00007870' TO DFHEIV0
  8102     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8103     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8104     MOVE X'2620233030303037383730' TO DFHEIV0(25:11)
  8105     CALL 'kxdfhei1' USING DFHEIV0
  8106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8107
  8108
  8109     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8110     MOVE 'X'                    TO CLAIM-SWITCH.
  8111     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8112     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8113     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8114     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8115     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8116     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8117
  8118     MOVE ER-0213                TO EMI-ERROR.
  8119     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8120     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  8121     GO TO 8100-SEND-INITIAL-MAP.
  8122
  8123 0645-NO-CLAIM-SELECTED.
  8124
  8125     IF MAINTI = 'S' OR 'I'
  8126        GO TO 1000-SHOW-CLAIM
  8127     END-IF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 156
* EL130.cbl
  8128
  8129     GO TO 8100-SEND-INITIAL-MAP.
  8130
  8131 0650-FROM-EL127.
  8132
  8133     IF PI-CERT-SELECT-CNT GREATER THAN +6
  8134         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  8135                                    PI-CERT-PROCESSED
  8136     END-IF.
  8137
  8138     IF PI-RETURN-TO-PROGRAM = XCTL-727
  8139         MOVE +1                 TO PI-CERT-SELECT-CNT
  8140                                    PI-CERT-PROCESSED
  8141         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  8142         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  8143         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  8144         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  8145         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  8146         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  8147     END-IF.
  8148
  8149     IF PI-CERT-SELECT-CNT = ZERO
  8150         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8151             MOVE CERTNOI        TO PI-CERT-NO
  8152             MOVE SUFXI          TO PI-CERT-SFX
  8153             GO TO 3000-READ-CERT
  8154         ELSE
  8155             GO TO 8100-SEND-INITIAL-MAP
  8156         END-IF
  8157     END-IF.
  8158
  8159     MOVE AL-SABON               TO PF5A.
  8160
  8161     IF PI-CERT-PROCESSED = 1
  8162         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8163     END-IF.
  8164
  8165     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8166     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8167
  8168     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8169     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8170                                 TO CERT-CARRIER
  8171                                    PI-CARRIER.
  8172     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8173                                 TO CERT-GROUPING
  8174                                    PI-GROUPING.
  8175     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8176                                 TO CERT-STATE
  8177                                    PI-STATE.
  8178     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8179                                 TO CERT-ACCOUNT
  8180                                    PI-ACCOUNT.
  8181     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8182                                 TO CERT-EFF-DT
  8183                                    PI-CERT-EFF-DT.
  8184     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8185                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 157
* EL130.cbl
  8186                                    PI-CERT-NO.
  8187
  8188     MOVE 'CERT'                 TO FILE-SWITCH.
  8189     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8190
  8191     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8192     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8193     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8194
  8195     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8196         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8197         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8198         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8199         IF INCURRED-DATE-MATCH
  8200             MOVE ER-7352        TO EMI-ERROR
  8201             MOVE -1             TO CERTNOL
  8202             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8203         ELSE
  8204             IF NO-CLAIMS-FOR-CERT
  8205                 MOVE ER-7353    TO EMI-ERROR
  8206                 MOVE -1         TO CERTNOL
  8207                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8208             ELSE
  8209                 MOVE ER-0558    TO EMI-ERROR
  8210                 MOVE -1         TO CERTNOL
  8211                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8212             END-IF
  8213         END-IF
  8214     END-IF.
  8215
  8216     MOVE SPACES                 TO PI-PRT-OPT
  8217                                    PI-ALT-PRT.
  8218
  8219     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8220
  8221     if (ws-lf-joint-indicator not = 'J')
  8222        and (ws-ah-joint-indicator not = 'J')
  8223        move 'P'                 to INSTYPEO
  8224        MOVE AL-UANON            TO INSTYPEA
  8225     end-if
  8226     IF LSTNMEL NOT GREATER ZERO
  8227        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8228         MOVE CRTLNMEI           TO  LSTNMEO
  8229         MOVE CRTFNMEI           TO  FSTNMEO
  8230         MOVE CRTINITI           TO  INITO
  8231         MOVE AL-UANON           TO  LSTNMEA
  8232                                     FSTNMEA
  8233                                     INITA
  8234     END-IF.
  8235
  8236     IF SSNL GREATER ZERO
  8237         GO TO 0655-SKIP-SOCIAL-SECURITY
  8238     END-IF.
  8239
  8240     IF CRTSSNI = SPACES OR LOW-VALUES
  8241         GO TO 0655-SKIP-SOCIAL-SECURITY
  8242     END-IF.
  8243
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 158
* EL130.cbl
  8244     IF CM-SSN-STATE   = CM-STATE AND
  8245        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8246            GO TO 0655-SKIP-SOCIAL-SECURITY
  8247     END-IF.
  8248
  8249     MOVE CRTSSNI                TO SSNO
  8250     MOVE AL-UANON               TO SSNA.
  8251
  8252 0655-SKIP-SOCIAL-SECURITY.
  8253
  8254     IF CLMCARRL NOT = ZERO  AND
  8255        CLMCARRI NOT = CRTCARRI
  8256        MOVE ER-0562             TO EMI-ERROR
  8257        MOVE AL-UABON            TO CLMCARRA
  8258        MOVE -1                  TO CLMCARRL
  8259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8260     END-IF.
  8261
  8262     IF CLMCARRL = ZERO
  8263        MOVE AL-UANON            TO CLMCARRA
  8264        MOVE CRTCARRI            TO CLMCARRI
  8265     END-IF.
  8266
  8267     MOVE 'A'                    TO MAINTO.
  8268     MOVE AL-UANON               TO MAINTA.
  8269
  8270     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8271        GO TO 8100-SEND-INITIAL-MAP
  8272     ELSE
  8273        GO TO 8150-SEND-MAP-CURSOR
  8274     END-IF.
  8275
  8276 0660-NOT-FOUND.
  8277     MOVE ER-0214                TO EMI-ERROR.
  8278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8279     GO TO 8100-SEND-INITIAL-MAP.
  8280
  8281 0670-QIDERR.
  8282     MOVE ER-0033                TO EMI-ERROR.
  8283     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8284     GO TO 8100-SEND-INITIAL-MAP.
  8285
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 159
* EL130.cbl
  8287 0680-PLUG-SELECTED-CERTS.
  8288
  8289     MOVE AL-SANON               TO BCERT1A
  8290                                    BSUFX1A
  8291                                    BCERT2A
  8292                                    BSUFX2A
  8293                                    BCERT3A
  8294                                    BSUFX3A
  8295                                    BCERT4A
  8296                                    BSUFX4A
  8297                                    BCERT5A
  8298                                    BSUFX5A.
  8299
  8300     IF PCERTNOO = SPACES OR LOW-VALUES
  8301         MOVE PI-EL127-CERT-PRIME (1)
  8302                                 TO PCERTNOO
  8303         MOVE PI-EL127-CERT-SUFX  (1)
  8304                                 TO PSUFXO
  8305     END-IF.
  8306
  8307     MOVE PI-EL127-CERT-PRIME (1)
  8308                                 TO BCERT1O.
  8309     MOVE PI-EL127-CERT-SUFX  (1)
  8310                                 TO BSUFX1O.
  8311
  8312     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8313         MOVE PI-EL127-CERT-PRIME (2)
  8314                                 TO BCERT2O
  8315         MOVE PI-EL127-CERT-SUFX  (2)
  8316                                 TO BSUFX2O
  8317     ELSE
  8318         MOVE LOW-VALUES         TO BCERT2O
  8319                                    BSUFX2O
  8320     END-IF.
  8321
  8322     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8323         MOVE PI-EL127-CERT-PRIME (3)
  8324                                 TO BCERT3O
  8325         MOVE PI-EL127-CERT-SUFX  (3)
  8326                                 TO BSUFX3O
  8327     ELSE
  8328         MOVE LOW-VALUES         TO BCERT3O
  8329                                    BSUFX3O
  8330     END-IF.
  8331
  8332     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8333         MOVE PI-EL127-CERT-PRIME (4)
  8334                                 TO BCERT4O
  8335         MOVE PI-EL127-CERT-SUFX  (4)
  8336                                 TO BSUFX4O
  8337     ELSE
  8338         MOVE LOW-VALUES         TO BCERT4O
  8339                                    BSUFX4O
  8340     END-IF.
  8341
  8342     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8343         MOVE PI-EL127-CERT-PRIME (5)
  8344                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 160
* EL130.cbl
  8345         MOVE PI-EL127-CERT-SUFX  (5)
  8346                                 TO BSUFX5O
  8347     ELSE
  8348         MOVE LOW-VALUES         TO BCERT5O
  8349                                    BSUFX5O
  8350     END-IF.
  8351
  8352 0680-EXIT.
  8353     EXIT.
  8354
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 161
* EL130.cbl
  8356 0690-HIGHLIGHT-CERTS.
  8357
  8358     MOVE AL-UANON               TO PCERTNOA
  8359                                    PSUFXA.
  8360
  8361     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8362        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8363            MOVE AL-SABON        TO BCERT1A
  8364                                    BSUFX1A
  8365     ELSE
  8366         MOVE AL-SANON           TO BCERT1A
  8367                                    BSUFX1A
  8368     END-IF.
  8369
  8370     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8371        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8372            MOVE AL-SABON        TO BCERT2A
  8373                                    BSUFX2A
  8374     ELSE
  8375         MOVE AL-SANON           TO BCERT2A
  8376                                    BSUFX2A
  8377     END-IF.
  8378
  8379     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8380        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8381            MOVE AL-SABON        TO BCERT3A
  8382                                    BSUFX3A
  8383     ELSE
  8384         MOVE AL-SANON           TO BCERT3A
  8385                                    BSUFX3A
  8386     END-IF.
  8387
  8388     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8389        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8390            MOVE AL-SABON        TO BCERT4A
  8391                                    BSUFX4A
  8392     ELSE
  8393         MOVE AL-SANON           TO BCERT4A
  8394                                    BSUFX4A
  8395     END-IF.
  8396
  8397     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8398        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8399            MOVE AL-SABON        TO BCERT5A
  8400                                    BSUFX5A
  8401     ELSE
  8402         MOVE AL-SANON           TO BCERT5A
  8403                                    BSUFX5A
  8404     END-IF.
  8405
  8406 0690-EXIT.
  8407     EXIT.
  8408
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 162
* EL130.cbl
  8410 0800-TEST-PREVIOUS-CONTROL.
  8411     IF CLMNOI   = PI-LAST-CLAIM       AND
  8412        CLMCARRI = PI-LAST-CARR        AND
  8413        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8414        SUFXI    = PI-LAST-CERT-SUFX
  8415*        NEXT SENTENCE
  8416         CONTINUE
  8417     ELSE
  8418         MOVE ER-0207            TO EMI-ERROR
  8419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8420         MOVE -1                 TO MAINTL
  8421         GO TO 8200-SEND-DATAONLY
  8422     END-IF.
  8423
  8424     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8425
  8426     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8427     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8428     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8429
  8430     IF EIBAID = DFHPF7
  8431         MOVE XCTL-157           TO PGM-NAME
  8432     END-IF.
  8433
  8434     IF EIBAID = DFHPF8
  8435         MOVE XCTL-141           TO PGM-NAME
  8436     END-IF.
  8437
  8438     IF EIBAID = DFHPF9
  8439        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8440                                    PI-SAVED-PROGRAM-2
  8441                                    PI-SAVED-PROGRAM-3
  8442                                    PI-SAVED-PROGRAM-4
  8443                                    PI-SAVED-PROGRAM-5
  8444                                    PI-SAVED-PROGRAM-6
  8445        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8446        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8447        MOVE XCTL-150            TO PGM-NAME
  8448     END-IF.
  8449
  8450     GO TO 9300-XCTL.
  8451
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 163
* EL130.cbl
  8453 1000-SHOW-CLAIM.
  8454
  8455     IF CLMNOL = ZERO
  8456         MOVE -1                 TO CLMNOL
  8457         MOVE AL-UABON           TO CLMNOA
  8458         MOVE ER-0202            TO EMI-ERROR
  8459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8460     ELSE
  8461         MOVE AL-UANON           TO CLMNOA
  8462     END-IF.
  8463
  8464     IF PI-NO-CARRIER-SECURITY
  8465        IF CLMCARRL = ZERO
  8466             MOVE -1             TO CLMCARRL
  8467             MOVE AL-UABON       TO CLMCARRA
  8468             MOVE ER-0194        TO EMI-ERROR
  8469             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8470         ELSE
  8471             MOVE AL-UANON       TO CLMCARRA
  8472         END-IF
  8473     END-IF.
  8474
  8475     IF SUFXL = ZERO
  8476         MOVE SPACES             TO SUFXI
  8477         MOVE AL-UANON           TO SUFXA
  8478     ELSE
  8479         MOVE AL-UANON           TO SUFXA
  8480     END-IF.
  8481
  8482     IF NOT EMI-NO-ERRORS
  8483         GO TO 1050-SEND-CHECK
  8484     END-IF.
  8485
  8486
  8487
  8488* EXEC CICS HANDLE CONDITION
  8489*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8490*    END-EXEC.
  8491*    MOVE '"$I                   ! '' #00008252' TO DFHEIV0
  8492     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8493     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8494     MOVE X'2720233030303038323532' TO DFHEIV0(25:11)
  8495     CALL 'kxdfhei1' USING DFHEIV0
  8496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8497
  8498
  8499     MOVE 'MSTR'                 TO FILE-SWITCH
  8500     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8501
  8502     MOVE CLMCARRI               TO MSTR-CARRIER.
  8503     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8504
  8505     IF CERTNOL = ZERO     OR
  8506        CERTNOI = SPACES   OR
  8507        CERTNOI = LOW-VALUES
  8508         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8509         MOVE AL-SANON        TO CERTNOA
  8510                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 164
* EL130.cbl
  8511     ELSE
  8512         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8513     END-IF.
  8514
  8515     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8516     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8517
  8518
  8519
  8520* EXEC CICS HANDLE CONDITION
  8521*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8522*    END-EXEC.
  8523*    MOVE '"$I                   ! ( #00008276' TO DFHEIV0
  8524     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8525     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8526     MOVE X'2820233030303038323736' TO DFHEIV0(25:11)
  8527     CALL 'kxdfhei1' USING DFHEIV0
  8528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8529
  8530
  8531     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8532
  8533     IF NOT PI-NO-ACCOUNT-SECURITY
  8534         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8535           MOVE ER-2371          TO EMI-ERROR
  8536           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8537           MOVE -1               TO MAINTL
  8538           GO TO 8200-SEND-DATAONLY
  8539         END-IF
  8540     END-IF.
  8541
  8542
  8543
  8544* EXEC CICS HANDLE CONDITION
  8545*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8546*    END-EXEC.
  8547*    MOVE '"$I                   ! ) #00008292' TO DFHEIV0
  8548     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8550     MOVE X'2920233030303038323932' TO DFHEIV0(25:11)
  8551     CALL 'kxdfhei1' USING DFHEIV0
  8552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8553
  8554
  8555     MOVE 'Y'                    TO CLAIM-SWITCH.
  8556     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8557     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8558     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8559     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8560     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8561
  8562 1000-SHOW-END-OF-PERFORM.
  8563
  8564     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8565     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8566     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8567     MOVE CL-CERT-STATE          TO CERT-STATE.
  8568     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 165
* EL130.cbl
  8569     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8570     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8571
  8572     MOVE 'CERT'                 TO FILE-SWITCH.
  8573
  8574     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8575
  8576     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8577     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8578     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8579     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8580     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8581     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8582     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8583     MOVE CLMCARRI               TO PI-LAST-CARR.
  8584
  8585     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8586
  8587     IF MAINTI = 'I'
  8588         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8589                 BIRTHDTA  LSTNMEA   RELCLMA
  8590                 LOANNOA   LOANBALA  BENECDA
  8591         MOVE AL-SANON TO  SSNA
  8592         MOVE SPACES   TO  INCURI    REPORTI
  8593         MOVE 'Y'      TO PI-INCURR-SW
  8594         MOVE ER-0522  TO EMI-ERROR
  8595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8596     ELSE
  8597         MOVE ' '      TO PI-INCURR-SW
  8598     END-IF.
  8599
  8600     MOVE -1                     TO MAINTL.
  8601     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8602     MOVE CERT-GROUPING          TO PI-GROUPING.
  8603     MOVE CERT-STATE             TO PI-STATE.
  8604     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8605     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8606     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8607     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8608
  8609     IF RETURNED-FROM NOT = SPACES
  8610         GO TO 8100-SEND-INITIAL-MAP
  8611     ELSE
  8612         GO TO 8200-SEND-DATAONLY
  8613     END-IF.
  8614
  8615 1025-SHOW-RECORD-NOT-FOUND.
  8616
  8617     IF FILE-SWITCH = 'MSTR'
  8618         MOVE ER-0204            TO EMI-ERROR
  8619     ELSE
  8620         IF FILE-SWITCH = 'TRLR'
  8621             MOVE ER-0205        TO EMI-ERROR
  8622         ELSE
  8623             MOVE ER-0206        TO EMI-ERROR
  8624         END-IF
  8625     END-IF.
  8626
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 166
* EL130.cbl
  8627     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8628
  8629 1050-SEND-CHECK.
  8630
  8631     IF RETURNED-FROM NOT = SPACES
  8632         GO TO 8100-SEND-INITIAL-MAP
  8633     ELSE
  8634         MOVE -1                 TO MAINTL
  8635         GO TO 8200-SEND-DATAONLY
  8636     END-IF.
  8637
  8638 2000-DELETE-CLAIM.
  8639     IF NOT MODIFY-CAP
  8640         MOVE ER-0070            TO EMI-ERROR
  8641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8642         MOVE -1                 TO MAINTL
  8643         GO TO 8200-SEND-DATAONLY
  8644     END-IF.
  8645
  8646     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8647        CLMCARRI NOT = PI-LAST-CARR        OR
  8648        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8649        SUFXI    NOT = PI-LAST-CERT-SUFX
  8650         MOVE ER-0207            TO EMI-ERROR
  8651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8652         MOVE -1                 TO MAINTL
  8653         GO TO 8200-SEND-DATAONLY
  8654     END-IF.
  8655
  8656
  8657
  8658* EXEC CICS HANDLE CONDITION
  8659*        NOTFND   (2050-DELETE-NOT-FOUND)
  8660*    END-EXEC.
  8661*    MOVE '"$I                   ! * #00008398' TO DFHEIV0
  8662     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8664     MOVE X'2A20233030303038333938' TO DFHEIV0(25:11)
  8665     CALL 'kxdfhei1' USING DFHEIV0
  8666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8667
  8668
  8669     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8670
  8671     MOVE CLMCARRI               TO MSTR-CARRIER.
  8672     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8673     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8674     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8675
  8676     MOVE 'MSTR'                 TO FILE-SWITCH.
  8677     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8678
  8679     MOVE 'Y'                    TO CLAIM-SWITCH.
  8680
  8681     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8682        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8683         MOVE ER-0068        TO EMI-ERROR
  8684         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 167
* EL130.cbl
  8685         MOVE -1             TO MAINTL
  8686         GO TO 8200-SEND-DATAONLY
  8687     END-IF.
  8688
  8689     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8690         MOVE ER-0569            TO EMI-ERROR
  8691         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8692         MOVE -1                 TO MAINTL
  8693         GO TO 8200-SEND-DATAONLY
  8694     END-IF.
  8695
  8696     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8697         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8698     END-IF.
  8699
  8700     IF CL-PURGED-DT NOT = LOW-VALUES
  8701         MOVE ER-7691            TO EMI-ERROR
  8702         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8703         MOVE -1                 TO MAINTL
  8704         GO TO 8200-SEND-DATAONLY
  8705     END-IF.
  8706
  8707     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8708     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8709     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8710     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8711     MOVE +0                     TO TRLR-SEQ-NO.
  8712     MOVE '1'                    TO TRLR-TYPE.
  8713
  8714     MOVE 'TRLR'                 TO FILE-SWITCH.
  8715
  8716
  8717
  8718* EXEC CICS READ
  8719*        UPDATE
  8720*        DATASET  (ELTRLR-DSID)
  8721*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8722*        RIDFLD   (ELTRLR-KEY)
  8723*    END-EXEC.
  8724*    MOVE '&"S        EU         (   #00008450' TO DFHEIV0
  8725     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8726     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8727     MOVE X'2020233030303038343530' TO DFHEIV0(25:11)
  8728     CALL 'kxdfhei1' USING DFHEIV0,
  8729           ELTRLR-DSID,
  8730           DFHEIV20,
  8731           DFHEIV99,
  8732           ELTRLR-KEY,
  8733           DFHEIV99,
  8734           DFHEIV99,
  8735           DFHEIV99
  8736     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8737         DFHEIV20
  8738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8739
  8740
  8741     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8742        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 168
* EL130.cbl
  8743         MOVE ER-0068        TO EMI-ERROR
  8744         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8745         MOVE -1             TO MAINTL
  8746         GO TO 8200-SEND-DATAONLY
  8747     END-IF.
  8748
  8749
  8750
  8751* EXEC CICS DELETE
  8752*        DATASET   (ELTRLR-DSID)
  8753*    END-EXEC.
  8754*    MOVE '&(                    &   #00008466' TO DFHEIV0
  8755     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8756     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8757     MOVE X'2020233030303038343636' TO DFHEIV0(25:11)
  8758     CALL 'kxdfhei1' USING DFHEIV0,
  8759           ELTRLR-DSID,
  8760           DFHEIV99,
  8761           DFHEIV99,
  8762           DFHEIV99,
  8763           DFHEIV99
  8764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8765
  8766
  8767     MOVE +90                    TO TRLR-SEQ-NO.
  8768     MOVE '6'                    TO TRLR-TYPE.
  8769
  8770
  8771
  8772* EXEC CICS READ
  8773*        UPDATE
  8774*        DATASET  (ELTRLR-DSID)
  8775*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8776*        RIDFLD   (ELTRLR-KEY)
  8777*    END-EXEC.
  8778*    MOVE '&"S        EU         (   #00008474' TO DFHEIV0
  8779     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8780     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8781     MOVE X'2020233030303038343734' TO DFHEIV0(25:11)
  8782     CALL 'kxdfhei1' USING DFHEIV0,
  8783           ELTRLR-DSID,
  8784           DFHEIV20,
  8785           DFHEIV99,
  8786           ELTRLR-KEY,
  8787           DFHEIV99,
  8788           DFHEIV99,
  8789           DFHEIV99
  8790     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8791         DFHEIV20
  8792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8793
  8794
  8795
  8796
  8797* EXEC CICS DELETE
  8798*        DATASET   (ELTRLR-DSID)
  8799*    END-EXEC.
  8800*    MOVE '&(                    &   #00008482' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 169
* EL130.cbl
  8801     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8802     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8803     MOVE X'2020233030303038343832' TO DFHEIV0(25:11)
  8804     CALL 'kxdfhei1' USING DFHEIV0,
  8805           ELTRLR-DSID,
  8806           DFHEIV99,
  8807           DFHEIV99,
  8808           DFHEIV99,
  8809           DFHEIV99
  8810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8811
  8812
  8813     MOVE +91                    TO TRLR-SEQ-NO.
  8814     MOVE '6'                    TO TRLR-TYPE.
  8815
  8816
  8817
  8818* EXEC CICS READ
  8819*        UPDATE
  8820*        DATASET  (ELTRLR-DSID)
  8821*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8822*        RIDFLD   (ELTRLR-KEY)
  8823*        RESP     (WS-RESPONSE)
  8824*    END-EXEC
  8825*    MOVE '&"S        EU         (  N#00008490' TO DFHEIV0
  8826     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8827     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8828     MOVE X'204E233030303038343930' TO DFHEIV0(25:11)
  8829     CALL 'kxdfhei1' USING DFHEIV0,
  8830           ELTRLR-DSID,
  8831           DFHEIV20,
  8832           DFHEIV99,
  8833           ELTRLR-KEY,
  8834           DFHEIV99,
  8835           DFHEIV99,
  8836           DFHEIV99
  8837     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8838         DFHEIV20
  8839     MOVE EIBRESP  TO WS-RESPONSE
  8840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8841
  8842     IF WS-RESP-NORMAL
  8843
  8844* EXEC CICS DELETE
  8845*          DATASET   (ELTRLR-DSID)
  8846*       END-EXEC
  8847*    MOVE '&(                    &   #00008499' TO DFHEIV0
  8848     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8849     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8850     MOVE X'2020233030303038343939' TO DFHEIV0(25:11)
  8851     CALL 'kxdfhei1' USING DFHEIV0,
  8852           ELTRLR-DSID,
  8853           DFHEIV99,
  8854           DFHEIV99,
  8855           DFHEIV99,
  8856           DFHEIV99
  8857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8858     END-IF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 170
* EL130.cbl
  8859
  8860     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8861     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8862     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8863     MOVE CL-CERT-STATE          TO CERT-STATE.
  8864     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8865     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8866     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8867
  8868     MOVE 'CERT'                 TO FILE-SWITCH.
  8869
  8870     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8871
  8872     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8873
  8874     IF WS-NUM-HOLD NOT = +0
  8875         GO TO 2005-REWRITE-CERT
  8876     END-IF.
  8877
  8878     IF NOT CERT-WAS-CREATED
  8879         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8880         GO TO 2005-REWRITE-CERT
  8881     END-IF.
  8882
  8883
  8884
  8885* EXEC CICS DELETE
  8886*        DATASET   (ELCERT-DSID)
  8887*    END-EXEC.
  8888*    MOVE '&(                    &   #00008528' TO DFHEIV0
  8889     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8890     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8891     MOVE X'2020233030303038353238' TO DFHEIV0(25:11)
  8892     CALL 'kxdfhei1' USING DFHEIV0,
  8893           ELCERT-DSID,
  8894           DFHEIV99,
  8895           DFHEIV99,
  8896           DFHEIV99,
  8897           DFHEIV99
  8898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8899
  8900
  8901     GO TO 2010-DELETE-CL.
  8902
  8903 2005-REWRITE-CERT.
  8904
  8905     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8906
  8907
  8908
  8909* EXEC CICS HANDLE CONDITION
  8910*         DUPKEY   (2010-DELETE-CL)
  8911*    END-EXEC.
  8912*    MOVE '"$$                   ! + #00008539' TO DFHEIV0
  8913     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8914     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8915     MOVE X'2B20233030303038353339' TO DFHEIV0(25:11)
  8916     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 171
* EL130.cbl
  8917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8918
  8919
  8920
  8921
  8922* EXEC CICS REWRITE
  8923*        DATASET  (ELCERT-DSID)
  8924*        FROM     (CERTIFICATE-MASTER)
  8925*    END-EXEC.
  8926     MOVE LENGTH OF
  8927      CERTIFICATE-MASTER
  8928       TO DFHEIV11
  8929*    MOVE '&& L                  %   #00008544' TO DFHEIV0
  8930     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8931     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8932     MOVE X'2020233030303038353434' TO DFHEIV0(25:11)
  8933     CALL 'kxdfhei1' USING DFHEIV0,
  8934           ELCERT-DSID,
  8935           CERTIFICATE-MASTER,
  8936           DFHEIV11,
  8937           DFHEIV99
  8938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8939
  8940
  8941 2010-DELETE-CL.
  8942
  8943
  8944
  8945* EXEC CICS DELETE
  8946*        DATASET  (ELMSTR-DSID)
  8947*    END-EXEC.
  8948*    MOVE '&(                    &   #00008552' TO DFHEIV0
  8949     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8950     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8951     MOVE X'2020233030303038353532' TO DFHEIV0(25:11)
  8952     CALL 'kxdfhei1' USING DFHEIV0,
  8953           ELMSTR-DSID,
  8954           DFHEIV99,
  8955           DFHEIV99,
  8956           DFHEIV99,
  8957           DFHEIV99
  8958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8959
  8960
  8961     MOVE -1                     TO ONE-OR-MIN1.
  8962     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8963
  8964     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8965         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8966                                    WS-SAVE-CLAIM-KEY
  8967         MOVE +1                 TO ONE-OR-MIN1
  8968         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8969     END-IF.
  8970
  8971     MOVE ER-0000                TO EMI-ERROR.
  8972     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8973     MOVE LOW-VALUES             TO EL130AO.
  8974     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 172
* EL130.cbl
  8975     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8976     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8977                                    PI-CERT-PROCESSED
  8978                                    PI-LETTER-ERROR-CODE.
  8979     GO TO 8100-SEND-INITIAL-MAP.
  8980
  8981 2050-DELETE-NOT-FOUND.
  8982     IF FILE-SWITCH = 'MSTR'
  8983         MOVE -1                 TO CLMNOL
  8984         MOVE ER-0204            TO EMI-ERROR
  8985     ELSE
  8986         IF FILE-SWITCH = 'TRLR'
  8987             MOVE -1             TO MAINTL
  8988             MOVE ER-0205        TO EMI-ERROR
  8989         ELSE
  8990             MOVE -1             TO CERTNOL
  8991             MOVE ER-0206        TO EMI-ERROR
  8992         END-IF
  8993     END-IF.
  8994
  8995     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8996     GO TO 8200-SEND-DATAONLY.
  8997
  8998 3000-ADD-CLAIM.
  8999     IF NOT MODIFY-CAP
  9000         MOVE ER-0070            TO EMI-ERROR
  9001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9002         MOVE -1                 TO MAINTL
  9003         GO TO 8200-SEND-DATAONLY
  9004     END-IF.
  9005
  9006     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  9007
  9008     IF CERTMTI = 'S'
  9009         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  9010            SUFXI    = PI-SAVE-CERT-SUFX   AND
  9011            WS-EFFDT = PI-SAVE-EFFDT       AND
  9012            ACCOUNTI = PI-SAVE-ACCOUNT
  9013             IF EMI-ERROR = 0
  9014                 GO TO 3010-TEST-FOR-ERRORS
  9015             ELSE
  9016                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  9017                 MOVE PI-CARRIER       TO  CERT-CARRIER
  9018                 MOVE PI-GROUPING      TO  CERT-GROUPING
  9019                 MOVE PI-STATE         TO  CERT-STATE
  9020                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  9021                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  9022                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  9023
  9024
  9025* EXEC CICS HANDLE CONDITION
  9026*                    NOTFND   (3010-TEST-FOR-ERRORS)
  9027*                END-EXEC
  9028*    MOVE '"$I                   ! , #00008619' TO DFHEIV0
  9029     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9030     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9031     MOVE X'2C20233030303038363139' TO DFHEIV0(25:11)
  9032     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 173
* EL130.cbl
  9033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9034                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  9035                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  9036                 GO TO 3010-TEST-FOR-ERRORS
  9037             END-IF
  9038         END-IF
  9039     END-IF.
  9040
  9041     IF CERTMTI = 'A'
  9042         IF NOT PI-NO-CARRIER-SECURITY OR
  9043             NOT PI-NO-ACCOUNT-SECURITY
  9044             MOVE ER-2370          TO EMI-ERROR
  9045             MOVE -1               TO MAINTL
  9046             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9047             GO TO 8200-SEND-DATAONLY
  9048         ELSE
  9049             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  9050             GO TO 3010-TEST-FOR-ERRORS
  9051         END-IF
  9052     END-IF.
  9053
  9054     IF CERTNOL = ZEROS
  9055        GO TO 3010-TEST-FOR-ERRORS
  9056     END-IF.
  9057
  9058 3000-READ-CERT.
  9059
  9060     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  9061                                    MSTR5-COMP-CD.
  9062     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  9063                                    MSTR5-CERT-NO-PRIME.
  9064     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  9065                                    MSTR5-CERT-NO-SUFX.
  9066
  9067
  9068
  9069* EXEC CICS HANDLE CONDITION
  9070*         DUPKEY   (3008-DUP-ERROR)
  9071*         NOTFND   (3009-NOT-FOUND)
  9072*    END-EXEC
  9073*    MOVE '"$$I                  ! - #00008656' TO DFHEIV0
  9074     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  9075     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9076     MOVE X'2D20233030303038363536' TO DFHEIV0(25:11)
  9077     CALL 'kxdfhei1' USING DFHEIV0
  9078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9079
  9080     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  9081
  9082     IF NOT PI-NO-ACCOUNT-SECURITY
  9083         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  9084             MOVE ER-2371          TO EMI-ERROR
  9085             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9086             MOVE -1               TO MAINTL
  9087             GO TO 8200-SEND-DATAONLY
  9088         END-IF
  9089     END-IF.
  9090
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 174
* EL130.cbl
  9091     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  9092     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  9093     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  9094     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  9095     MOVE CM-CARRIER             TO PI-CARRIER.
  9096     MOVE CM-GROUPING            TO PI-GROUPING.
  9097     MOVE CM-STATE               TO PI-STATE.
  9098     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  9099     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  9100     MOVE CM-CERT-NO             TO PI-CERT-NO.
  9101     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  9102
  9103     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  9104         IF LSTNMEO = SPACES OR LOW-VALUES
  9105             MOVE CRTLNMEI       TO  LSTNMEO
  9106             MOVE AL-UANON       TO  LSTNMEA
  9107         END-IF
  9108     END-IF.
  9109
  9110     MOVE 'S'                    TO CERTMTO.
  9111*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  9112     MOVE AL-SANON               TO CERTNOA.
  9113     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  9114                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  9115     IF EMI-NO-ERRORS
  9116         MOVE -1                  TO MAINTL
  9117     END-IF.
  9118
  9119     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9120         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9121         IF INCURRED-DATE-MATCH
  9122             MOVE ER-7352         TO EMI-ERROR
  9123             MOVE -1              TO CERTNOL
  9124             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9125         ELSE
  9126             IF NO-CLAIMS-FOR-CERT
  9127                 MOVE ER-7353     TO EMI-ERROR
  9128                 MOVE -1          TO CERTNOL
  9129                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9130             ELSE
  9131                 MOVE ER-0558     TO EMI-ERROR
  9132                 MOVE -1          TO CERTNOL
  9133                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9134                 GO TO 3010-TEST-FOR-ERRORS
  9135             END-IF
  9136         END-IF
  9137     END-IF.
  9138
  9139 3007-SEND-SCREEN.
  9140     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9141         GO TO 8150-SEND-MAP-CURSOR
  9142     ELSE
  9143         GO TO 8200-SEND-DATAONLY
  9144     END-IF.
  9145
  9146 3008-DUP-ERROR.
  9147     MOVE ER-0560                TO EMI-ERROR.
  9148     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 175
* EL130.cbl
  9149     MOVE -1                     TO CERTNOL.
  9150     GO TO 3007-SEND-SCREEN.
  9151
  9152 3009-NOT-FOUND.
  9153     MOVE ER-0214                TO EMI-ERROR.
  9154     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9155     MOVE -1                     TO CERTNOL.
  9156     GO TO 3007-SEND-SCREEN.
  9157
  9158 3010-TEST-FOR-ERRORS.
  9159
  9160     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9161     perform 6500-get-acct    thru 6500-exit
  9162     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9163*     perform 6500-get-acct    thru 6500-exit
  9164
  9165     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9166     move +0                     to e1
  9167     move spaces                 to ws-dcc-error-line
  9168     move ' '                    to ws-zero-bens-avail
  9169
  9170     if ws-dcc-product-code not = spaces
  9171        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9172        IF ERPDEF-FOUND
  9173           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9174           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9175           MOVE '1'              TO DC-OPTION-CODE
  9176           MOVE +0               TO DC-ELAPSED-MONTHS
  9177                                    DC-ELAPSED-DAYS
  9178           PERFORM 9700-LINK-DATE-CONVERT
  9179                                 THRU 9700-EXIT
  9180           IF NO-CONVERSION-ERROR
  9181              MOVE DC-ELAPSED-MONTHS
  9182                                 TO WS-MONTHS-BETWEEN
  9183              IF DC-ELAPSED-DAYS > 1
  9184                 ADD 1 TO WS-MONTHS-BETWEEN
  9185              END-IF
  9186           ELSE
  9187              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9188           END-IF
  9189
  9190           evaluate true
  9191              when (ws-excl-period not = zeros)
  9192                 and (ws-months-between <= ws-excl-period)
  9193                 MOVE -1         TO MAINTL
  9194                 add +1          to e1
  9195                 move 'Y'        to ws-zero-bens-avail
  9196                 MOVE ER-1651    TO EMI-ERROR
  9197                                    ws-error-no (e1)
  9198                 PERFORM 9900-ERROR-FORMAT
  9199                                 THRU 9900-EXIT
  9200              when (ws-cov-ends not = zeros)
  9201                 and (ws-months-between > ws-cov-ends)
  9202                 MOVE -1         TO MAINTL
  9203                 add +1          to e1
  9204                 move 'Y'        to ws-zero-bens-avail
  9205                 MOVE ER-1653    TO EMI-ERROR
  9206                                    ws-error-no (e1)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 176
* EL130.cbl
  9207                 evaluate true
  9208                    when clmtypei = 'L'
  9209                       move '  LF  ' to emi-claim-type
  9210                    when clmtypei = 'I'
  9211                       move '  IU  ' to emi-claim-type
  9212                    when clmtypei = 'F'
  9213                       move '  FL  ' to emi-claim-type
  9214                    when other
  9215                       move '  AH  ' to emi-claim-type
  9216                 end-evaluate
  9217                 PERFORM 9900-ERROR-FORMAT
  9218                                 THRU 9900-EXIT
  9219              when (ws-acc-period not = zeros)
  9220                 and (ws-months-between <= ws-acc-period)
  9221                 MOVE -1         TO MAINTL
  9222                 add +1          to e1
  9223                 MOVE ER-1652    TO EMI-ERROR
  9224                                    ws-error-no (e1)
  9225                 PERFORM 9900-ERROR-FORMAT
  9226                                 THRU 9900-EXIT
  9227                 add +1          to e1
  9228                 move er-1655    to emi-error
  9229                                    ws-error-no (e1)
  9230                 PERFORM 9900-ERROR-FORMAT
  9231                                 THRU 9900-EXIT
  9232              when clmtypei = 'I'
  9233                 add +1          to e1
  9234                 move er-1661    to emi-error
  9235                                    ws-error-no (e1)
  9236                 PERFORM 9900-ERROR-FORMAT
  9237                                 THRU 9900-EXIT
  9238           end-evaluate
  9239           IF (WS-PRE-EXISTING-PER NOT = ZEROS)
  9240              AND (WS-MONTHS-BETWEEN <= WS-PRE-EXISTING-PER)
  9241              MOVE -1         TO MAINTL
  9242              ADD +1          TO E1
  9243              MOVE ER-1677    TO EMI-ERROR
  9244                                 WS-ERROR-NO (E1)
  9245              PERFORM 9900-ERROR-FORMAT
  9246                              THRU 9900-EXIT
  9247           END-IF
  9248        END-IF
  9249*       perform 3996-read-cert-claim-trailer
  9250*                                thru 3996-exit
  9251     END-IF
  9252     perform 3996-read-cert-claim-trailer
  9253                                 thru 3996-exit
  9254     IF CERTMTI NOT = 'A'
  9255         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9256             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9257             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9258             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9259             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9260             IF INCURRED-DATE-MATCH
  9261                 MOVE ER-7352         TO EMI-ERROR
  9262                 MOVE -1              TO CERTNOL
  9263                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9264             ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 177
* EL130.cbl
  9265                 IF NO-CLAIMS-FOR-CERT
  9266                     MOVE ER-7353     TO EMI-ERROR
  9267                     MOVE -1          TO CERTNOL
  9268                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9269                 ELSE
  9270                     MOVE ER-0558     TO EMI-ERROR
  9271                     MOVE -1          TO CERTNOL
  9272                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9273                 END-IF
  9274             END-IF
  9275         END-IF
  9276     END-IF.
  9277
  9278     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9279         MOVE ER-0433             TO EMI-ERROR
  9280         MOVE -1                  TO MAINTL
  9281         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9282         GO TO 8200-SEND-DATAONLY
  9283     END-IF.
  9284
  9285     IF (EMI-NO-ERRORS)
  9286        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9287         GO TO 3015-TRY-TO-BUILD
  9288     END-IF.
  9289
  9290     IF EIBAID = DFHPF6
  9291         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9292             MOVE ER-0434         TO EMI-ERROR
  9293             MOVE -1              TO MAINTL
  9294             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9295             GO TO 8200-SEND-DATAONLY
  9296         ELSE
  9297             MOVE +1              TO INCURL
  9298             GO TO 3015-TRY-TO-BUILD
  9299         END-IF
  9300     END-IF.
  9301
  9302     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9303         GO TO 8150-SEND-MAP-CURSOR
  9304     ELSE
  9305         GO TO 8200-SEND-DATAONLY
  9306     END-IF.
  9307
  9308 3015-TRY-TO-BUILD.
  9309     IF CLMNOL EQUAL ZERO
  9310         GO TO 3030-BUILD-CONT
  9311     END-IF.
  9312
  9313
  9314
  9315* EXEC CICS HANDLE CONDITION
  9316*        NOTFND   (3030-BUILD-CONT)
  9317*    END-EXEC.
  9318*    MOVE '"$I                   ! . #00008895' TO DFHEIV0
  9319     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9320     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9321     MOVE X'2E20233030303038383935' TO DFHEIV0(25:11)
  9322     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 178
* EL130.cbl
  9323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9324
  9325
  9326     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9327
  9328     MOVE CLMCARRI               TO MSTR-CARRIER.
  9329     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9330     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9331     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9332
  9333     MOVE 'MSTR'                 TO FILE-SWITCH.
  9334
  9335     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9336
  9337     MOVE ER-0221                TO EMI-ERROR.
  9338
  9339     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9340     MOVE -1                     TO MAINTL.
  9341     GO TO 8200-SEND-DATAONLY.
  9342
  9343 3030-BUILD-CONT.
  9344     IF (CERTMTI NOT = 'A')
  9345        and (pi-company-id not = 'DCC' and 'VPP')
  9346         GO TO 3060-BUILD-CONT
  9347     END-IF.
  9348
  9349
  9350
  9351* EXEC CICS HANDLE CONDITION
  9352*        NOTFND   (3033-ACCT-NOT-FOUND)
  9353*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9354*    END-EXEC.
  9355*    MOVE '"$I''                  ! / #00008923' TO DFHEIV0
  9356     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9358     MOVE X'2F20233030303038393233' TO DFHEIV0(25:11)
  9359     CALL 'kxdfhei1' USING DFHEIV0
  9360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9361
  9362
  9363     MOVE SPACES                 TO ERACCT-KEY.
  9364
  9365     IF CARR-GROUP-ST-ACCNT-CNTL
  9366         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9367         MOVE CRTCARRI           TO ACCT-CARRIER
  9368         MOVE GROUPI             TO ACCT-GROUPING
  9369         MOVE STATEI             TO ACCT-STATE
  9370         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9371         GO TO 3031-MOVE-ACCT-KEY
  9372     END-IF.
  9373
  9374     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9375     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9376
  9377     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9378         MOVE STATEI             TO ACCT-STATE
  9379     END-IF.
  9380
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 179
* EL130.cbl
  9381     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9382         MOVE CRTCARRI           TO ACCT-CARRIER
  9383     END-IF.
  9384
  9385 3031-MOVE-ACCT-KEY.
  9386     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9387
  9388
  9389
  9390* EXEC CICS STARTBR
  9391*        DATASET     (ERACCT2-DSID)
  9392*        RIDFLD      (SAVE-ERACCT-KEY)
  9393*        GENERIC
  9394*        KEYLENGTH   (20)
  9395*    END-EXEC.
  9396     MOVE 20
  9397       TO DFHEIV11
  9398     MOVE 0
  9399       TO DFHEIV12
  9400*    MOVE '&,   KG    G          &   #00008954' TO DFHEIV0
  9401     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9402     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9403     MOVE X'2020233030303038393534' TO DFHEIV0(25:11)
  9404     CALL 'kxdfhei1' USING DFHEIV0,
  9405           ERACCT2-DSID,
  9406           SAVE-ERACCT-KEY,
  9407           DFHEIV11,
  9408           DFHEIV12,
  9409           DFHEIV99
  9410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9411
  9412
  9413
  9414
  9415* EXEC CICS HANDLE CONDITION
  9416*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9417*    END-EXEC.
  9418*    MOVE '"$''                   ! 0 #00008962' TO DFHEIV0
  9419     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9421     MOVE X'3020233030303038393632' TO DFHEIV0(25:11)
  9422     CALL 'kxdfhei1' USING DFHEIV0
  9423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9424
  9425
  9426 3031-READ-ACCT-LOOP.
  9427
  9428
  9429* EXEC CICS READNEXT
  9430*        DATASET   (ERACCT2-DSID)
  9431*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9432*        RIDFLD    (SAVE-ERACCT-KEY)
  9433*    END-EXEC.
  9434     MOVE 0
  9435       TO DFHEIV11
  9436*    MOVE '&.S                   )   #00008968' TO DFHEIV0
  9437     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9438     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 180
* EL130.cbl
  9439     MOVE X'2020233030303038393638' TO DFHEIV0(25:11)
  9440     CALL 'kxdfhei1' USING DFHEIV0,
  9441           ERACCT2-DSID,
  9442           DFHEIV20,
  9443           DFHEIV99,
  9444           SAVE-ERACCT-KEY,
  9445           DFHEIV99,
  9446           DFHEIV11,
  9447           DFHEIV99,
  9448           DFHEIV99
  9449     SET ADDRESS OF ACCOUNT-MASTER TO
  9450         DFHEIV20
  9451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9452
  9453
  9454     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9455        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9456        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9457        ACCT-STATE    NOT = AM-VG-STATE       OR
  9458        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9459         GO TO 3033-ACCT-NOT-FOUND
  9460     END-IF.
  9461
  9462     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9463        WS-EFFDT LESS AM-EXPIRATION-DT
  9464         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9465         MOVE AM-CARRIER       TO CERT-CARRIER
  9466         MOVE AM-GROUPING      TO CERT-GROUPING
  9467         MOVE AM-STATE         TO CERT-STATE
  9468         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9469         MOVE WS-EFFDT         TO CERT-EFF-DT
  9470         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9471         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9472         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9473         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9474     END-IF.
  9475
  9476     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9477         GO TO 3031-READ-ACCT-LOOP
  9478     END-IF.
  9479
  9480 3032-NOT-IN-DT-RANGE.
  9481     MOVE ER-0226                TO EMI-ERROR.
  9482     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9483     MOVE -1                     TO EFFDTL.
  9484     GO TO 8200-SEND-DATAONLY.
  9485
  9486 3033-ACCT-NOT-FOUND.
  9487     MOVE ER-0226 TO EMI-ERROR.
  9488     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9489     MOVE -1                     TO ACCOUNTL.
  9490     GO TO 8200-SEND-DATAONLY.
  9491
  9492 3034-CHECK-EMPLOYER-STATEMENT.
  9493
  9494     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9495*        NEXT SENTENCE
  9496         CONTINUE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 181
* EL130.cbl
  9497     ELSE
  9498         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9499     END-IF.
  9500
  9501     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9502     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9503     MOVE '1'                    TO  DC-OPTION-CODE.
  9504     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9505                                     DC-ELAPSED-DAYS.
  9506     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9507
  9508     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9509         DC-ELAPSED-DAYS LESS THAN +31)
  9510                      OR
  9511        (AM-EMPLOYER-STMT-USED = '2' AND
  9512         DC-ELAPSED-DAYS LESS THAN +61)
  9513                      OR
  9514        (AM-EMPLOYER-STMT-USED = '3' AND
  9515         DC-ELAPSED-DAYS LESS THAN +91)
  9516            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9517     END-IF.
  9518
  9519 3034-CHECK-ACCOUNT-LIMITS.
  9520
  9521     IF CERTMTI NOT = 'A'
  9522         GO TO 3060-BUILD-CONT
  9523     END-IF.
  9524
  9525     IF AM-STATUS NOT = '0'
  9526         MOVE ER-0225                TO EMI-ERROR
  9527         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9528         MOVE -1                     TO ACCOUNTL
  9529     END-IF.
  9530
  9531     IF EIBAID = DFHPF6
  9532         IF EMI-FATAL-CTR NOT = ZERO
  9533             MOVE ER-0434         TO EMI-ERROR
  9534             MOVE -1              TO MAINTL
  9535             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9536             GO TO 8200-SEND-DATAONLY
  9537         END-IF
  9538     END-IF.
  9539
  9540*    IF PI-COMPANY-ID NOT = 'CRI'
  9541*        GO TO 3035-END-BROWSE
  9542*    END-IF.
  9543
  9544 3035-END-BROWSE.
  9545
  9546
  9547* EXEC CICS ENDBR
  9548*        DATASET    (ERACCT2-DSID)
  9549*    END-EXEC.
  9550     MOVE 0
  9551       TO DFHEIV11
  9552*    MOVE '&2                    $   #00009066' TO DFHEIV0
  9553     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9554     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 182
* EL130.cbl
  9555     MOVE X'2020233030303039303636' TO DFHEIV0(25:11)
  9556     CALL 'kxdfhei1' USING DFHEIV0,
  9557           ERACCT2-DSID,
  9558           DFHEIV11,
  9559           DFHEIV99
  9560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9561
  9562
  9563 3040-CHECK-CERT-ALREADY-ON.
  9564
  9565
  9566* EXEC CICS HANDLE CONDITION
  9567*        NOTFND   (3070-BUILD-CONT)
  9568*    END-EXEC.
  9569*    MOVE '"$I                   ! 1 #00009072' TO DFHEIV0
  9570     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9572     MOVE X'3120233030303039303732' TO DFHEIV0(25:11)
  9573     CALL 'kxdfhei1' USING DFHEIV0
  9574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9575
  9576
  9577     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9578
  9579     MOVE ER-0229                TO EMI-ERROR.
  9580     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9581     MOVE -1                     TO MAINTL.
  9582     GO TO 8200-SEND-DATAONLY.
  9583
  9584 3060-BUILD-CONT.
  9585     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9586     MOVE CRTCARRI               TO CERT-CARRIER.
  9587     MOVE GROUPI                 TO CERT-GROUPING.
  9588     MOVE STATEI                 TO CERT-STATE.
  9589     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9590     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9591     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9592     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9593
  9594
  9595
  9596* EXEC CICS HANDLE CONDITION
  9597*        NOTFND  (3065-CERT-NOT-FOUND)
  9598*    END-EXEC.
  9599*    MOVE '"$I                   ! 2 #00009094' TO DFHEIV0
  9600     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9602     MOVE X'3220233030303039303934' TO DFHEIV0(25:11)
  9603     CALL 'kxdfhei1' USING DFHEIV0
  9604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9605
  9606
  9607     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9608
  9609     GO TO 3070-BUILD-CONT.
  9610
  9611 3065-CERT-NOT-FOUND.
  9612     MOVE ER-0244                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 183
* EL130.cbl
  9613     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9614     MOVE -1                     TO CERTNOL.
  9615     GO TO 8200-SEND-DATAONLY.
  9616
  9617 3070-BUILD-CONT.
  9618     IF CLMNOL NOT = ZERO
  9619         GO TO 3200-BUILD-ZERO-TRAILER
  9620     END-IF.
  9621
  9622     MOVE SPACES                 TO ELCNTL-KEY.
  9623
  9624     IF CONTROL-IS-ACTUAL-CARRIER
  9625         MOVE PI-CARRIER         TO CNTL-CARRIER
  9626     ELSE
  9627         MOVE PI-CARRIER-CONTROL-LEVEL
  9628                                 TO CNTL-CARRIER
  9629     END-IF.
  9630
  9631     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9632     MOVE '6'                    TO CNTL-REC-TYPE.
  9633     MOVE +0                     TO CNTL-SEQ-NO.
  9634
  9635
  9636
  9637* EXEC CICS HANDLE CONDITION
  9638*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9639*    END-EXEC.
  9640*    MOVE '"$I                   ! 3 #00009127' TO DFHEIV0
  9641     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9643     MOVE X'3320233030303039313237' TO DFHEIV0(25:11)
  9644     CALL 'kxdfhei1' USING DFHEIV0
  9645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9646
  9647
  9648
  9649
  9650* EXEC CICS READ
  9651*        UPDATE
  9652*        DATASET   (ELCNTL-DSID)
  9653*        SET       (ADDRESS OF CONTROL-FILE)
  9654*        RIDFLD    (ELCNTL-KEY)
  9655*    END-EXEC.
  9656*    MOVE '&"S        EU         (   #00009132' TO DFHEIV0
  9657     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9658     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9659     MOVE X'2020233030303039313332' TO DFHEIV0(25:11)
  9660     CALL 'kxdfhei1' USING DFHEIV0,
  9661           ELCNTL-DSID,
  9662           DFHEIV20,
  9663           DFHEIV99,
  9664           ELCNTL-KEY,
  9665           DFHEIV99,
  9666           DFHEIV99,
  9667           DFHEIV99
  9668     SET ADDRESS OF CONTROL-FILE TO
  9669         DFHEIV20
  9670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 184
* EL130.cbl
  9671
  9672
  9673     IF CLAIM-NO-MANUAL
  9674         GO TO 3120-CLAIM-MUST-BE-INPUT
  9675     END-IF.
  9676
  9677     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9678     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9679
  9680     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' OR 'VPP'
  9681         CONTINUE
  9682     ELSE
  9683         GO TO 3080-ASSIGN-LOOP
  9684     END-IF.
  9685
  9686
  9687
  9688* EXEC CICS UNLOCK
  9689*        DATASET   (ELCNTL-DSID)
  9690*    END-EXEC.
  9691*    MOVE '&*                    #   #00009153' TO DFHEIV0
  9692     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9693     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9694     MOVE X'2020233030303039313533' TO DFHEIV0(25:11)
  9695     CALL 'kxdfhei1' USING DFHEIV0,
  9696           ELCNTL-DSID,
  9697           DFHEIV99
  9698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9699
  9700
  9701     MOVE '1'                    TO CNTL-REC-TYPE.
  9702     MOVE SPACES                 TO CNTL-ACCESS.
  9703
  9704     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9705
  9706
  9707
  9708* EXEC CICS HANDLE CONDITION
  9709*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9710*    END-EXEC.
  9711*    MOVE '"$I                   ! 4 #00009163' TO DFHEIV0
  9712     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9714     MOVE X'3420233030303039313633' TO DFHEIV0(25:11)
  9715     CALL 'kxdfhei1' USING DFHEIV0
  9716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9717
  9718
  9719     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9720
  9721     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9722
  9723 3080-ASSIGN-LOOP.
  9724     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9725        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9726         MOVE +0                 TO SAVE-COUNTER
  9727     END-IF.
  9728
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 185
* EL130.cbl
  9729     ADD +1 TO SAVE-COUNTER.
  9730
  9731     IF SAVE-METHOD  = '3'
  9732         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9733         GO TO 3090-SET-COMP
  9734     END-IF.
  9735
  9736     IF SAVE-METHOD  = '4'
  9737         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9738         MOVE CLMCARRI           TO WS-CN-PRF-A
  9739         GO TO 3090-SET-COMP
  9740     END-IF.
  9741
  9742     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9743     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9744     MOVE SAVE-DATE              TO CURR-DATE.
  9745
  9746     IF CURR-MM LESS '10'
  9747         MOVE CURR-M2             TO WS-CN-PRF-B
  9748     END-IF.
  9749
  9750     IF CURR-MM = '10'
  9751        MOVE 'A'                 TO WS-CN-PRF-B
  9752     END-IF.
  9753     IF CURR-MM = '11'
  9754        MOVE 'B'                 TO WS-CN-PRF-B
  9755     END-IF.
  9756     IF CURR-MM = '12'
  9757        MOVE 'C'                 TO WS-CN-PRF-B
  9758     END-IF.
  9759
  9760     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9761
  9762 3090-SET-COMP.
  9763
  9764     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9765     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9766                                    CLMNOO.
  9767     MOVE AL-UANON               TO CLMNOA.
  9768     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9769     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9770     MOVE CLMCARRI               TO MSTR-CARRIER.
  9771
  9772
  9773
  9774* EXEC CICS HANDLE CONDITION
  9775*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9776*    END-EXEC.
  9777*    MOVE '"$I                   ! 5 #00009221' TO DFHEIV0
  9778     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9780     MOVE X'3520233030303039323231' TO DFHEIV0(25:11)
  9781     CALL 'kxdfhei1' USING DFHEIV0
  9782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9783
  9784
  9785     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9786
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 186
* EL130.cbl
  9787     GO TO 3080-ASSIGN-LOOP.
  9788
  9789 3100-CARRIER-NOT-FOUND.
  9790     MOVE ER-0252                TO EMI-ERROR.
  9791     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9792     MOVE -1                     TO CLMCARRL.
  9793     GO TO 8200-SEND-DATAONLY.
  9794
  9795 3110-COMPANY-NOT-FOUND.
  9796     MOVE ER-0254                TO EMI-ERROR.
  9797     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9798     MOVE -1                     TO MAINTL.
  9799     GO TO 8200-SEND-DATAONLY.
  9800
  9801 3120-CLAIM-MUST-BE-INPUT.
  9802     MOVE ER-0264                TO EMI-ERROR.
  9803     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9804     MOVE -1                     TO CLMNOL.
  9805     GO TO 8200-SEND-DATAONLY.
  9806
  9807 3200-BUILD-ZERO-TRAILER.
  9808
  9809
  9810* EXEC CICS HANDLE CONDITION
  9811*        NOTFND
  9812*    END-EXEC.
  9813*    MOVE '"$                   ! 6 #00009249' TO DFHEIV0
  9814     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9816     MOVE X'3620233030303039323439' TO DFHEIV0(25:11)
  9817     CALL 'kxdfhei1' USING DFHEIV0
  9818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9819
  9820
  9821
  9822
  9823* EXEC CICS GETMAIN
  9824*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9825*        LENGTH  (ELTRLR-LENGTH)
  9826*    END-EXEC.
  9827*    MOVE '," L                  $   #00009254' TO DFHEIV0
  9828     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9829     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9830     MOVE X'2020233030303039323534' TO DFHEIV0(25:11)
  9831     CALL 'kxdfhei1' USING DFHEIV0,
  9832           DFHEIV20,
  9833           ELTRLR-LENGTH,
  9834           DFHEIV99
  9835     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9836         DFHEIV20
  9837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9838
  9839
  9840     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9841     MOVE 'AT'                   TO AT-RECORD-ID.
  9842
  9843     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9844     MOVE CLMCARRI               TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 187
* EL130.cbl
  9845     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9846     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9847     MOVE +0                     TO AT-SEQUENCE-NO.
  9848     MOVE '1'                    TO AT-TRAILER-TYPE.
  9849
  9850     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9851     MOVE '5'                    TO DC-OPTION-CODE.
  9852     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9853     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9854                                    AT-RESERVES-LAST-MAINT-DT.
  9855
  9856     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9857                                    AT-RESERVES-LAST-UPDATED-BY.
  9858
  9859     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9860
  9861     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9862
  9863     MOVE +0                     TO AT-FUTURE-RESERVE
  9864                                    AT-IBNR-RESERVE
  9865                                    AT-PAY-CURRENT-RESERVE
  9866                                    AT-INITIAL-MANUAL-RESERVE
  9867                                    AT-CURRENT-MANUAL-RESERVE
  9868                                    AT-ITD-LIFE-REFUNDS
  9869                                    AT-ITD-AH-REFUNDS
  9870                                    AT-ITD-ADDITIONAL-RESERVE.
  9871
  9872     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9873
  9874     IF MANRSVL NOT = ZERO
  9875         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9876                                    AT-CURRENT-MANUAL-RESERVE
  9877     END-IF.
  9878
  9879     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9880
  9881     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9882                                    AT-ITD-CHARGEABLE-EXPENSE.
  9883
  9884     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9885     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9886     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9887
  9888
  9889
  9890* EXEC CICS WRITE
  9891*        DATASET   (ELTRLR-DSID)
  9892*        FROM      (ACTIVITY-TRAILERS)
  9893*        RIDFLD    (AT-CONTROL-PRIMARY)
  9894*    END-EXEC.
  9895     MOVE LENGTH OF
  9896      ACTIVITY-TRAILERS
  9897       TO DFHEIV11
  9898*    MOVE '&$ L                  ''   #00009308' TO DFHEIV0
  9899     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9900     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9901     MOVE X'2020233030303039333038' TO DFHEIV0(25:11)
  9902     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 188
* EL130.cbl
  9903           ELTRLR-DSID,
  9904           ACTIVITY-TRAILERS,
  9905           DFHEIV11,
  9906           AT-CONTROL-PRIMARY,
  9907           DFHEIV99,
  9908           DFHEIV99
  9909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9910
  9911
  9912     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9913
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 189
* EL130.cbl
  9915
  9916 3250-BUILD-I1-ADDRESS-TRAILER.
  9917
  9918     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9919     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9920     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9921     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9922     MOVE GROUPI                 TO WS-MA-GROUPING.
  9923     MOVE STATEI                 TO WS-MA-STATE.
  9924     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9925     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9926     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9927     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9928
  9929
  9930* EXEC CICS HANDLE CONDITION
  9931*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9932*    END-EXEC.
  9933*    MOVE '"$I                   ! 7 #00009331' TO DFHEIV0
  9934     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9936     MOVE X'3720233030303039333331' TO DFHEIV0(25:11)
  9937     CALL 'kxdfhei1' USING DFHEIV0
  9938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9939
  9940
  9941
  9942* EXEC CICS READ
  9943*        EQUAL
  9944*        DATASET   (ERMAIL-DSID)
  9945*        SET       (ADDRESS OF MAILING-DATA)
  9946*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9947*    END-EXEC.
  9948*    MOVE '&"S        E          (   #00009335' TO DFHEIV0
  9949     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9950     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9951     MOVE X'2020233030303039333335' TO DFHEIV0(25:11)
  9952     CALL 'kxdfhei1' USING DFHEIV0,
  9953           ERMAIL-DSID,
  9954           DFHEIV20,
  9955           DFHEIV99,
  9956           WS-MA-CONTROL-PRIMARY,
  9957           DFHEIV99,
  9958           DFHEIV99,
  9959           DFHEIV99
  9960     SET ADDRESS OF MAILING-DATA TO
  9961         DFHEIV20
  9962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9963
  9964
  9965     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9966         GO TO 3290-NO-INSURED-ADDRESS
  9967     END-IF.
  9968
  9969     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9970     MOVE 'AT'                   TO AT-RECORD-ID.
  9971
  9972     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 190
* EL130.cbl
  9973     MOVE CLMCARRI               TO AT-CARRIER.
  9974     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9975     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9976     MOVE +1                     TO AT-SEQUENCE-NO.
  9977     MOVE '5'                    TO AT-TRAILER-TYPE.
  9978
  9979     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9980     IF MA-INSURED-MIDDLE-INIT > SPACES
  9981        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9982               ' ' DELIMITED BY SIZE
  9983               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9984               ' ' DELIMITED BY SIZE
  9985               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9986        INTO AT-MAIL-TO-NAME
  9987     ELSE
  9988        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9989               ' ' DELIMITED BY SIZE
  9990               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9991        INTO AT-MAIL-TO-NAME
  9992     END-IF.
  9993     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9994     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9995*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9996     MOVE MA-CITY                TO AT-CITY
  9997     MOVE MA-ADDR-STATE          TO AT-STATE
  9998     MOVE MA-ZIP                 TO AT-ZIP
  9999     MOVE MA-PHONE-NO            TO AT-PHONE-NO
 10000
 10001     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10002                                    AT-ADDRESS-LAST-MAINT-DT.
 10003
 10004     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10005                                    AT-ADDRESS-LAST-UPDATED-BY.
 10006
 10007     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10008
 10009
 10010* EXEC CICS WRITE
 10011*        DATASET   (ELTRLR-DSID)
 10012*        FROM      (ACTIVITY-TRAILERS)
 10013*        RIDFLD    (AT-CONTROL-PRIMARY)
 10014*    END-EXEC.
 10015     MOVE LENGTH OF
 10016      ACTIVITY-TRAILERS
 10017       TO DFHEIV11
 10018*    MOVE '&$ L                  ''   #00009386' TO DFHEIV0
 10019     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10020     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10021     MOVE X'2020233030303039333836' TO DFHEIV0(25:11)
 10022     CALL 'kxdfhei1' USING DFHEIV0,
 10023           ELTRLR-DSID,
 10024           ACTIVITY-TRAILERS,
 10025           DFHEIV11,
 10026           AT-CONTROL-PRIMARY,
 10027           DFHEIV99,
 10028           DFHEIV99
 10029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10030
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 191
* EL130.cbl
 10031
 10032     ADD +1                      TO WS-INSURED-ADDR-CNT.
 10033     GO TO 3300-BUILD-NINETY-TRAILER.
 10034
 10035 3290-NO-INSURED-ADDRESS.
 10036      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
 10037
 10038 3300-BUILD-NINETY-TRAILER.
 10039
 10040     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10041     MOVE 'AT'                   TO AT-RECORD-ID.
 10042
 10043     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10044     MOVE CLMCARRI               TO AT-CARRIER.
 10045
 10046     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10047     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10048     MOVE +90                    TO AT-SEQUENCE-NO.
 10049     MOVE '6'                    TO AT-TRAILER-TYPE.
 10050
 10051     IF DIAGL NOT = ZERO
 10052         MOVE DIAGI              TO AT-INFO-LINE-1
 10053     END-IF.
 10054
 10055     IF ICD1L NOT = ZERO
 10056         MOVE ICD1I              TO AT-ICD-CODE-1
 10057     END-IF.
 10058
 10059     IF ICD2L NOT = ZERO
 10060         MOVE ICD2I              TO AT-ICD-CODE-2
 10061     END-IF.
 10062
 10063     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10064                                    AT-GEN-INFO-LAST-MAINT-DT.
 10065
 10066     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10067                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10068     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10069
 10070
 10071
 10072* EXEC CICS WRITE
 10073*        DATASET   (ELTRLR-DSID)
 10074*        FROM      (ACTIVITY-TRAILERS)
 10075*        RIDFLD    (AT-CONTROL-PRIMARY)
 10076*    END-EXEC.
 10077     MOVE LENGTH OF
 10078      ACTIVITY-TRAILERS
 10079       TO DFHEIV11
 10080*    MOVE '&$ L                  ''   #00009431' TO DFHEIV0
 10081     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10082     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10083     MOVE X'2020233030303039343331' TO DFHEIV0(25:11)
 10084     CALL 'kxdfhei1' USING DFHEIV0,
 10085           ELTRLR-DSID,
 10086           ACTIVITY-TRAILERS,
 10087           DFHEIV11,
 10088           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 192
* EL130.cbl
 10089           DFHEIV99,
 10090           DFHEIV99
 10091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10092
 10093
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 193
* EL130.cbl
 10095 3400-CHECK-CERT-MAINT.
 10096
 10097     IF CERTMTI = 'A'
 10098         GO TO 3600-BUILD-NEW-CERT
 10099     END-IF.
 10100
 10101     IF NO-CLAIM-ATTACHED
 10102         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
 10103     END-IF.
 10104
 10105     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
 10106
 10107     IF CM-LF-CURRENT-STATUS = '2' OR
 10108        CM-AH-CURRENT-STATUS = '2'
 10109         GO TO 3400-REWRITE-CERT
 10110     END-IF.
 10111
 10112     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10113
 10114 3400-REWRITE-CERT.
 10115
 10116
 10117
 10118* EXEC CICS HANDLE CONDITION
 10119*        DUPKEY (3410-DUP-KEY)
 10120*    END-EXEC.
 10121*    MOVE '"$$                   ! 8 #00009460' TO DFHEIV0
 10122     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10124     MOVE X'3820233030303039343630' TO DFHEIV0(25:11)
 10125     CALL 'kxdfhei1' USING DFHEIV0
 10126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10127
 10128
 10129
 10130
 10131* EXEC CICS REWRITE
 10132*        DATASET   (ELCERT-DSID)
 10133*        FROM      (CERTIFICATE-MASTER)
 10134*    END-EXEC.
 10135     MOVE LENGTH OF
 10136      CERTIFICATE-MASTER
 10137       TO DFHEIV11
 10138*    MOVE '&& L                  %   #00009465' TO DFHEIV0
 10139     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10140     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10141     MOVE X'2020233030303039343635' TO DFHEIV0(25:11)
 10142     CALL 'kxdfhei1' USING DFHEIV0,
 10143           ELCERT-DSID,
 10144           CERTIFICATE-MASTER,
 10145           DFHEIV11,
 10146           DFHEIV99
 10147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10148
 10149
 10150 3410-DUP-KEY.
 10151     GO TO 3800-BUILD-NEW-CLAIM.
 10152
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 194
* EL130.cbl
 10153 3600-BUILD-NEW-CERT.
 10154
 10155
 10156* EXEC CICS GETMAIN
 10157*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 10158*        LENGTH   (ELCERT-LENGTH)
 10159*    END-EXEC.
 10160*    MOVE '," L                  $   #00009475' TO DFHEIV0
 10161     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10162     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10163     MOVE X'2020233030303039343735' TO DFHEIV0(25:11)
 10164     CALL 'kxdfhei1' USING DFHEIV0,
 10165           DFHEIV20,
 10166           ELCERT-LENGTH,
 10167           DFHEIV99
 10168     SET ADDRESS OF CERTIFICATE-MASTER TO
 10169         DFHEIV20
 10170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10171
 10172
 10173     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10174
 10175     MOVE 'CM'                   TO CM-RECORD-ID.
 10176
 10177     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10178                                    CM-COMPANY-CD-A1
 10179                                    CM-COMPANY-CD-A2
 10180                                    CM-COMPANY-CD-A4
 10181                                    CM-COMPANY-CD-A5.
 10182
 10183     MOVE CERT-CARRIER           TO CM-CARRIER.
 10184     MOVE CERT-GROUPING          TO CM-GROUPING.
 10185     MOVE CERT-STATE             TO CM-STATE.
 10186     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10187     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10188     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10189
 10190     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10191                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10192                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10193                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10194                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10195                       CM-LIVES              CM-LOAN-TERM
 10196                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10197                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10198                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10199                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10200                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10201                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10202                       CM-LF-ALT-PREMIUM-RATE
 10203                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10204                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10205                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10206                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10207                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10208
 10209     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10210                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 195
* EL130.cbl
 10211                                    CM-AH-SETTLEMENT-DT
 10212                                    CM-AH-CANCEL-EXIT-DT
 10213                                    CM-AH-SETTLEMENT-EXIT-DT
 10214                                    CM-LF-LOAN-EXPIRE-DT
 10215                                    CM-LF-CANCEL-DT
 10216                                    CM-LF-DEATH-DT
 10217                                    CM-LF-CANCEL-EXIT-DT
 10218                                    CM-LF-DEATH-EXIT-DT
 10219                                    CM-LAST-ADD-ON-DT
 10220                                    CM-ENTRY-DT.
 10221
 10222     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10223     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10224     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10225
 10226     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10227                                    CM-PART-LAST-NAME-A2
 10228                                    CM-PART-LAST-NAME-A5.
 10229
 10230     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10231                                    CM-INSURED-INITIAL1-A2
 10232                                    CM-INSURED-INITIAL1-A5
 10233                                    CM-INSURED-FIRST-NAME.
 10234
 10235     IF CRTINITL GREATER ZERO
 10236         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10237                                    CM-INSURED-INITIAL2-A2
 10238                                    CM-INSURED-INITIAL2-A5
 10239     ELSE
 10240         MOVE SPACES             TO CM-INSURED-INITIAL2
 10241                                    CM-INSURED-INITIAL2-A2
 10242                                    CM-INSURED-INITIAL2-A5
 10243     END-IF.
 10244
 10245     IF CM-INSURED-INITIALS = SPACES
 10246         MOVE '**'               TO CM-INSURED-INITIALS
 10247     END-IF.
 10248
 10249     IF MEMBERL GREATER ZERO
 10250         MOVE MEMBERI              TO CM-MEMBER-NO
 10251     ELSE
 10252         MOVE CERT-STATE           TO CM-MEMB-STATE
 10253         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10254         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10255         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10256     END-IF.
 10257
 10258     IF JNTLNMEL GREATER ZERO
 10259         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10260     END-IF.
 10261
 10262     IF JNTFNMEL GREATER ZERO
 10263         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10264     END-IF.
 10265
 10266     IF JNTINITL GREATER ZERO
 10267         MOVE JNTINITI           TO CM-JT-INITIAL
 10268     END-IF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 196
* EL130.cbl
 10269
 10270     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10271
 10272
 10273
 10274* EXEC CICS HANDLE CONDITION
 10275*        DUPKEY   (3690-CERT-WRITTEN)
 10276*    END-EXEC.
 10277*    MOVE '"$$                   ! 9 #00009580' TO DFHEIV0
 10278     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10280     MOVE X'3920233030303039353830' TO DFHEIV0(25:11)
 10281     CALL 'kxdfhei1' USING DFHEIV0
 10282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10283
 10284
 10285
 10286
 10287* EXEC CICS WRITE
 10288*        DATASET   (ELCERT-DSID)
 10289*        FROM      (CERTIFICATE-MASTER)
 10290*        RIDFLD    (CM-CONTROL-PRIMARY)
 10291*    END-EXEC.
 10292     MOVE LENGTH OF
 10293      CERTIFICATE-MASTER
 10294       TO DFHEIV11
 10295*    MOVE '&$ L                  ''   #00009585' TO DFHEIV0
 10296     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10297     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10298     MOVE X'2020233030303039353835' TO DFHEIV0(25:11)
 10299     CALL 'kxdfhei1' USING DFHEIV0,
 10300           ELCERT-DSID,
 10301           CERTIFICATE-MASTER,
 10302           DFHEIV11,
 10303           CM-CONTROL-PRIMARY,
 10304           DFHEIV99,
 10305           DFHEIV99
 10306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10307
 10308
 10309 3690-CERT-WRITTEN.
 10310
 10311     GO TO 3800-BUILD-NEW-CLAIM.
 10312
 10313 3690-EXIT.
 10314      EXIT.
 10315
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 197
* EL130.cbl
 10317 3700-BUILD-CERT.
 10318
 10319     IF CERTMTI NOT = 'A'
 10320         GO TO 3700-FINISH-CERT-BUILD
 10321     END-IF.
 10322
 10323     IF CERTMTI = 'A'
 10324         IF LCVCDL = ZEROS
 10325             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10326                                    CM-LF-ORIG-TERM
 10327                                    CM-LF-BENEFIT-AMT
 10328                                    CM-LF-PREMIUM-RATE
 10329             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10330         END-IF
 10331     END-IF.
 10332
 10333     IF LCVCDL GREATER ZERO
 10334         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10335     END-IF.
 10336
 10337     IF LCVOTRML GREATER ZERO
 10338         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10339     END-IF.
 10340
 10341     IF LCVBENEL GREATER ZERO
 10342         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10343     END-IF.
 10344
 10345     IF LCVRATEL GREATER ZERO
 10346         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10347     END-IF.
 10348
 10349     IF WS-EXPIRE NOT = LOW-VALUES
 10350         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10351     END-IF.
 10352
 10353     IF LCVFORML GREATER ZERO
 10354         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10355     END-IF.
 10356
 10357     IF LCVCNDTL = ZERO
 10358        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10359     END-IF.
 10360
 10361     IF WS-LCVCNDT NOT = LOW-VALUES
 10362        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10363        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10364        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10365     END-IF.
 10366
 10367     IF CM-LF-CURRENT-STATUS = '7'
 10368        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10369        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10370        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10371                                    CM-LF-DEATH-DT
 10372        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10373     END-IF.
 10374
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 198
* EL130.cbl
 10375     IF CM-LF-CURRENT-STATUS = '8'
 10376        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10377        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10378     END-IF.
 10379
 10380 3700-BUILD-AH-COVERAGE-SIDE.
 10381
 10382     IF CERTMTI = 'A'
 10383         IF ACVCDL = ZEROS
 10384             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10385                                    CM-AH-ORIG-TERM
 10386                                    CM-AH-BENEFIT-AMT
 10387                                    CM-AH-PREMIUM-RATE
 10388             GO TO 3700-COVERAGE-BUILT
 10389         END-IF
 10390     END-IF.
 10391
 10392     IF ACVCDL GREATER ZERO
 10393         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10394     END-IF.
 10395
 10396     IF ACVOTRML GREATER ZERO
 10397         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10398     END-IF.
 10399
 10400     IF ACVBENEL GREATER ZERO
 10401         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10402     END-IF.
 10403
 10404     IF ACVRATEL GREATER ZERO
 10405         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10406     END-IF.
 10407
 10408     IF WS-EXPIRE NOT = LOW-VALUES
 10409         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10410     END-IF.
 10411
 10412     IF ACVFORML GREATER ZERO
 10413         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10414     END-IF.
 10415
 10416     IF ACVCNDTL = ZERO
 10417        GO TO 3700-COVERAGE-BUILT
 10418     END-IF.
 10419
 10420     IF WS-ACVCNDT NOT = LOW-VALUES
 10421        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10422        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10423        GO TO 3700-COVERAGE-BUILT
 10424     END-IF.
 10425
 10426     IF CM-AH-CURRENT-STATUS = '6'
 10427        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10428        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10429        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10430        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10431        GO TO 3700-COVERAGE-BUILT
 10432     END-IF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 199
* EL130.cbl
 10433
 10434     IF CM-AH-CURRENT-STATUS = '8'
 10435        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10436        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10437     END-IF.
 10438
 10439 3700-COVERAGE-BUILT.
 10440     IF ISSAGEL GREATER ZERO
 10441         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10442     END-IF.
 10443
 10444     IF JNTAGEL GREATER ZERO
 10445         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10446     END-IF.
 10447
 10448     IF SEXL GREATER ZERO
 10449         MOVE SEXI               TO CM-INSURED-SEX
 10450     END-IF.
 10451
 10452     IF APRL GREATER ZERO
 10453         MOVE WS-APR             TO CM-LOAN-APR
 10454     END-IF.
 10455
 10456     IF PMTFREQL GREATER ZERO
 10457         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10458     END-IF.
 10459
 10460     IF INDGRPL GREATER ZERO
 10461         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10462     END-IF.
 10463
 10464     IF CERTMTI = 'A'
 10465         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10466     END-IF.
 10467
 10468     IF REINCDL GREATER ZERO
 10469         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10470                                    WS-REIN-1
 10471                                    WS-REIN-2
 10472                                    WS-REIN-3
 10473         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10474     END-IF.
 10475
 10476     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10477         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10478     END-IF.
 10479
 10480     IF CRTSSNL GREATER ZERO
 10481         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10482     ELSE
 10483         IF SSNL GREATER ZERO
 10484             MOVE SSNI           TO CM-SOC-SEC-NO
 10485         END-IF
 10486     END-IF.
 10487
 10488     IF CRTSSNL = ZERO AND
 10489        SSNL    = ZERO
 10490         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 200
* EL130.cbl
 10491         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10492         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10493         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10494     END-IF.
 10495
 10496     IF CM-LF-CURRENT-STATUS = SPACES
 10497         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10498     END-IF.
 10499
 10500     IF CM-AH-CURRENT-STATUS = SPACES
 10501         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10502     END-IF.
 10503
 10504     IF CERTMTI = 'A'
 10505         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10506     END-IF.
 10507
 10508 3700-FINISH-CERT-BUILD.
 10509
 10510     IF LOANNOL GREATER ZERO
 10511         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10512     END-IF.
 10513
 10514     IF LOANBALL GREATER ZERO
 10515         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10516     END-IF.
 10517
 10518     IF PREMTYPL GREATER ZERO
 10519         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10520     END-IF.
 10521
 10522 3700-EXIT.
 10523      EXIT.
 10524
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 201
* EL130.cbl
 10526 3800-BUILD-NEW-CLAIM.
 10527
 10528*************************************************************
 10529*****           START OF ACTIVITY FILE PROCESSING          **
 10530*************************************************************
 10531     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10532         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10533                 6700-EXIT
 10534     END-IF.
 10535*************************************************************
 10536*****            END OF ACTIVITY FILE PROCESSING           **
 10537*************************************************************
 10538
 10539
 10540
 10541
 10542* EXEC CICS GETMAIN
 10543*        SET     (ADDRESS OF CLAIM-MASTER)
 10544*        LENGTH  (ELMSTR-LENGTH)
 10545*    END-EXEC.
 10546*    MOVE '," L                  $   #00009823' TO DFHEIV0
 10547     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10548     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10549     MOVE X'2020233030303039383233' TO DFHEIV0(25:11)
 10550     CALL 'kxdfhei1' USING DFHEIV0,
 10551           DFHEIV20,
 10552           ELMSTR-LENGTH,
 10553           DFHEIV99
 10554     SET ADDRESS OF CLAIM-MASTER TO
 10555         DFHEIV20
 10556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10557
 10558
 10559     MOVE SPACES TO CLAIM-MASTER.
 10560
 10561     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10562         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10563         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10564         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10565         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10566         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10567         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10568         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10569
 10570     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10571             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10572             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10573             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10574             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10575             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10576             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10577             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10578             CL-FORCEABLE-ERROR-CNT.
 10579
 10580     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10581
 10582     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10583                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 202
* EL130.cbl
 10584                                    CL-LAG-REPORT-CODE
 10585                                    CL-CRITICAL-PERIOD
 10586*                                   CL-CRIT-PER-RTW-MOS
 10587     move 01                     to cl-benefit-period
 10588
 10589     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10590     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10591
 10592     IF BENECDL NOT = ZEROS
 10593        MOVE BENECDI             TO CL-BENEFICIARY
 10594     END-IF.
 10595
 10596     MOVE 'CL'                   TO CL-RECORD-ID.
 10597     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10598
 10599     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10600                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10601                             CL-COMPANY-CD-A5.
 10602
 10603     MOVE CLMCARRI               TO CL-CARRIER.
 10604
 10605     IF CLMNOL = ZERO
 10606         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10607     ELSE
 10608         MOVE CLMNOI             TO CL-CLAIM-NO
 10609     END-IF.
 10610
 10611     MOVE CERTNOI                TO CL-CERT-PRIME
 10612                                    CL-CERT-A4-PRIME.
 10613
 10614     MOVE SUFXI                  TO CL-CERT-SFX
 10615                                    CL-CERT-A4-SFX.
 10616
 10617     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10618
 10619     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10620
 10621     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10622
 10623     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10624
 10625     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10626     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10627
 10628     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10629
 10630     IF CERTMTI = 'A'
 10631         MOVE '2'                TO CL-CERT-ORIGIN
 10632     ELSE
 10633         MOVE '1'                TO CL-CERT-ORIGIN
 10634     END-IF.
 10635
 10636     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10637     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10638     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10639     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10640     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10641
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 203
* EL130.cbl
 10642 3820-REWRITE-CONTROL-FILE.
 10643
 10644     IF CLMNOL GREATER ZERO
 10645         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10646     END-IF.
 10647
 10648     IF CF-RECORD-TYPE = '6'
 10649         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10650     ELSE
 10651         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10652     END-IF.
 10653
 10654
 10655
 10656* EXEC CICS REWRITE
 10657*        DATASET   (ELCNTL-DSID)
 10658*        FROM      (CONTROL-FILE)
 10659*    END-EXEC.
 10660     MOVE LENGTH OF
 10661      CONTROL-FILE
 10662       TO DFHEIV11
 10663*    MOVE '&& L                  %   #00009924' TO DFHEIV0
 10664     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10665     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10666     MOVE X'2020233030303039393234' TO DFHEIV0(25:11)
 10667     CALL 'kxdfhei1' USING DFHEIV0,
 10668           ELCNTL-DSID,
 10669           CONTROL-FILE,
 10670           DFHEIV11,
 10671           DFHEIV99
 10672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10673
 10674
 10675 3830-SEQUENCE-CLAIM-RECORDS.
 10676
 10677     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10678     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10679     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10680
 10681     IF WS-ASSOC-CERT-TOTAL = ZERO
 10682         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10683                                    CL-ASSOC-CERT-TOTAL
 10684         GO TO 3840-WRITE-CLAIM-MASTER
 10685     END-IF.
 10686
 10687     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10688         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10689     ELSE
 10690         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10691     END-IF.
 10692
 10693     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10694     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10695     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10696
 10697 3840-WRITE-CLAIM-MASTER.
 10698
 10699     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 204
* EL130.cbl
 10700     IF WS-REC-FOUND-SW = 'Y'
 10701         MOVE 01                 TO  CL-ACTIVITY-CODE
 10702         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10703         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10704     END-IF.
 10705
 10706
 10707
 10708* EXEC CICS HANDLE CONDITION
 10709*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10710*    END-EXEC.
 10711*    MOVE '"$$                   ! : #00009961' TO DFHEIV0
 10712     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10714     MOVE X'3A20233030303039393631' TO DFHEIV0(25:11)
 10715     CALL 'kxdfhei1' USING DFHEIV0
 10716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10717
 10718
 10719** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10720     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10721
 10722
 10723*       CL-CERT-NO
 10724*    IF CL-COMPANY-CD = X'04'
 10725*    ELSE
 10726*       IF CL-COMPANY-CD = X'05'
 10727*       ELSE
 10728*       END-IF
 10729*    END-IF
 10730
 10731* EXEC CICS WRITE
 10732*        DATASET   (ELMSTR-DSID)
 10733*        FROM      (CLAIM-MASTER)
 10734*        RIDFLD    (CL-CONTROL-PRIMARY)
 10735*    END-EXEC.
 10736     MOVE LENGTH OF
 10737      CLAIM-MASTER
 10738       TO DFHEIV11
 10739*    MOVE '&$ L                  ''   #00009981' TO DFHEIV0
 10740     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10742     MOVE X'2020233030303039393831' TO DFHEIV0(25:11)
 10743     CALL 'kxdfhei1' USING DFHEIV0,
 10744           ELMSTR-DSID,
 10745           CLAIM-MASTER,
 10746           DFHEIV11,
 10747           CL-CONTROL-PRIMARY,
 10748           DFHEIV99,
 10749           DFHEIV99
 10750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10751
 10752
 10753 3850-CLAIM-MSTR-WRITTEN.
 10754
 10755     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10756         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10757     END-IF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 205
* EL130.cbl
 10758
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 206
* EL130.cbl
 10760 3990-ADD-DONE.
 10761*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10762*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10763*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10764*                                  EMI-ERROR-LINES.
 10765
 10766     IF CLMNOL = ZERO
 10767         move spaces             to emi-claim-no
 10768         MOVE ER-0265            TO EMI-ERROR
 10769         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10770         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10771                                    PI-LAST-CLAIM
 10772     ELSE
 10773         MOVE CLMNOI             TO PI-LAST-CLAIM
 10774                                    MSTR-CLAIM-NO
 10775         MOVE ER-0000            TO EMI-ERROR
 10776         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10777     END-IF.
 10778
 10779     IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O')
 10780       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10781         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10782         MOVE ER-7575            TO EMI-ERROR
 10783         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10784     END-IF.
 10785
 10786     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 10787       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10788         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10789         MOVE ER-7582            TO EMI-ERROR
 10790         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10791     END-IF.
 10792
 10793     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 10794        PERFORM 3991-CHECK-2-YEAR-CONTESTABLE THRU 3991-EXIT
 10795     END-IF.
 10796     IF WS-NO-INSURED-ADDRESS = 'Y'
 10797         MOVE ER-3548            TO EMI-ERROR
 10798         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10799     END-IF.
 10800
 10801     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10802       (PI-ST-CAUSAL-STATE = 'L' AND
 10803             (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'))   OR
 10804       (PI-ST-CAUSAL-STATE = 'A' AND
 10805              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10806         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10807         MOVE ER-7577            TO EMI-ERROR
 10808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10809     END-IF.
 10810     if pi-company-id = 'DCC' OR 'VPP'
 10811        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10812                                 THRU 3994C-EXIT
 10813     end-if
 10814*052918IF CLMTYPEI = PI-AH-OVERRIDE-L1
 10815*052918  AND PI-COMPANY-ID = 'CID'
 10816*052918   SET ELAPSED-BETWEEN-BIN TO TRUE
 10817*052918   MOVE ZERO               TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 207
* EL130.cbl
 10818*052918                              DC-ELAPSED-DAYS
 10819*052918
 10820*052918   MOVE CL-INCURRED-DT  TO DC-BIN-DATE-1
 10821*052918   MOVE WS-TODAY-DT TO DC-BIN-DATE-2
 10822*052918   PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10823*052918   IF DC-ODD-DAYS-OVER > ZERO
 10824*052918      ADD 1 TO DC-ELAPSED-MONTHS
 10825*052918   END-IF
 10826*052918
 10827*052918   IF PI-STATE = 'HI'
 10828*052918     AND DC-ELAPSED-MONTHS <= 18
 10829*052918      CONTINUE
 10830*052918   ELSE
 10831*052918      IF DC-ELAPSED-MONTHS > 15
 10832*052918         MOVE ER-7572            TO EMI-ERROR
 10833*052918         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10834*052918         PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10835*052918      END-IF
 10836*052918   END-IF
 10837*052918
 10838*052918END-IF.
 10839     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10840     MOVE CLMCARRI                   TO  PI-CARRIER.
 10841     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10842     MOVE SUFXI                      TO  PI-CERT-SFX.
 10843
 10844     IF WS-LETTER-SW = 'Y'
 10845         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10846         IF W-1523-ERROR-CODE NOT = ZEROS
 10847             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10848             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10849         END-IF
 10850     END-IF.
 10851
 10852     perform 3998-update-cert-claim-trailer
 10853                                 thru 3998-exit
 10854     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10855     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10856     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10857     MOVE CLMCARRI               TO PI-LAST-CARR.
 10858
 10859     IF PRTOPTL GREATER THAN 0
 10860         MOVE PRTOPTI            TO PI-PRT-OPT
 10861     END-IF.
 10862     IF ALTPRTL GREATER THAN 0
 10863         MOVE ALTPRTI            TO PI-ALT-PRT
 10864     END-IF.
 10865
 10866     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10867         MOVE LOW-VALUES         TO EL130AI
 10868         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10869         MOVE AL-SANON           TO CERTNOA
 10870         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10871         MOVE AL-SANON           TO SUFXA
 10872         MOVE PI-LAST-CARR       TO CLMCARRO
 10873         MOVE AL-UANON           TO CLMCARRA
 10874         MOVE PI-LAST-CLAIM      TO CLMNOO
 10875         MOVE AL-UANON           TO CLMNOA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 208
* EL130.cbl
 10876         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10877         MOVE AL-UANON           TO CLMTYPEA
 10878     ELSE
 10879         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10880         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10881     END-IF.
 10882
 10883     IF PI-PRT-OPT = 'N' OR 'L'
 10884         MOVE PI-PRT-OPT         TO PRTOPTO
 10885         MOVE 1                  TO PRTOPTL
 10886     END-IF.
 10887
 10888     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10889         MOVE PI-ALT-PRT         TO ALTPRTO
 10890         MOVE 4                  TO ALTPRTL
 10891     END-IF.
 10892
 10893     IF PRTOPTL GREATER THAN 0
 10894         IF PRTOPTI = 'L'
 10895             GO TO 0400-CREATE-ELACTQ
 10896         ELSE
 10897             GO TO 0480-PRINT-NOW
 10898         END-IF
 10899     END-IF.
 10900     move 'S'                    to mainti
 10901     PERFORM 0500-CREATE-TEMP-STORAGE
 10902                                 THRU 0599-EXIT
 10903     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10904         GO TO 8100-SEND-INITIAL-MAP
 10905     ELSE
 10906         MOVE LOW-VALUES         TO MAINTO
 10907         MOVE -1                 TO MAINTL
 10908         GO TO 8200-SEND-DATAONLY
 10909     END-IF.
 10910
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 209
* EL130.cbl
 10912 3991-CHECK-2-YEAR-CONTESTABLE.
 10913     SET ELAPSED-BETWEEN-BIN TO TRUE
 10914     MOVE ZERO               TO DC-ELAPSED-MONTHS
 10915                                DC-ELAPSED-DAYS
 10916
 10917     MOVE PI-SAVE-EFFDT  TO DC-BIN-DATE-1.
 10918     MOVE CL-INCURRED-DT TO DC-BIN-DATE-2.
 10919     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10920     IF DC-ODD-DAYS-OVER > ZERO
 10921        ADD 1 TO DC-ELAPSED-MONTHS
 10922     END-IF
 10923
 10924     IF DC-ELAPSED-MONTHS <= 24
 10925        MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
 10926        MOVE ZERO           TO DC-ELAPSED-MONTHS
 10927                               DC-ELAPSED-DAYS
 10928        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10929        IF DC-ODD-DAYS-OVER > ZERO
 10930           ADD 1 TO DC-ELAPSED-MONTHS
 10931        END-IF
 10932        IF DC-ELAPSED-MONTHS > 24
 10933           MOVE ER-1679            TO EMI-ERROR
 10934           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10935           PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10936        END-IF
 10937     END-IF.
 10938
 10939 3991-EXIT.
 10940     EXIT.
 10941 3992-BUILD-TRAILER.
 10942
 10943     MOVE SPACES             TO AT-GENERAL-INFO-TR
 10944     INITIALIZE AT-GENERAL-INFO-TR
 10945     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 10946     MOVE 'AT'               TO AT-RECORD-ID
 10947     IF EMI-ERROR = ER-7572
 10948        MOVE +97             TO AT-SEQUENCE-NO
 10949     ELSE
 10950        MOVE +96             TO AT-SEQUENCE-NO
 10951     END-IF
 10952     MOVE '6'                TO AT-TRAILER-TYPE
 10953     MOVE WS-TODAY-DT        TO AT-RECORDED-DT
 10954                                AT-GEN-INFO-LAST-MAINT-DT
 10955     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 10956                                AT-GEN-INFO-LAST-UPDATED-BY
 10957     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 10958
 10959     IF EMI-ERROR = ER-7572
 10960        MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 10961     ELSE
 10962        MOVE EMI-LINE2 TO AT-INFO-LINE-1
 10963     END-IF
 10964     MOVE SPACES             TO AT-INFO-LINE-2.
 10965
 10966 3992-WRITE.
 10967
 10968
 10969* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 210
* EL130.cbl
 10970*        DUPREC    (3992-DUPREC)
 10971*    END-EXEC.
 10972*    MOVE '"$%                   ! ; #00010202' TO DFHEIV0
 10973     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10975     MOVE X'3B20233030303130323032' TO DFHEIV0(25:11)
 10976     CALL 'kxdfhei1' USING DFHEIV0
 10977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10978
 10979
 10980
 10981* EXEC CICS WRITE
 10982*         DATASET     ('ELTRLR')
 10983*         FROM        (ACTIVITY-TRAILERS)
 10984*         RIDFLD      (AT-CONTROL-PRIMARY)
 10985*     END-EXEC.
 10986     MOVE LENGTH OF
 10987      ACTIVITY-TRAILERS
 10988       TO DFHEIV11
 10989     MOVE 'ELTRLR' TO DFHEIV1
 10990*    MOVE '&$ L                  ''   #00010206' TO DFHEIV0
 10991     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10992     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10993     MOVE X'2020233030303130323036' TO DFHEIV0(25:11)
 10994     CALL 'kxdfhei1' USING DFHEIV0,
 10995           DFHEIV1,
 10996           ACTIVITY-TRAILERS,
 10997           DFHEIV11,
 10998           AT-CONTROL-PRIMARY,
 10999           DFHEIV99,
 11000           DFHEIV99
 11001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11002
 11003
 11004     GO TO 3992-EXIT.
 11005
 11006 3992-DUPREC.
 11007     SUBTRACT +1 FROM AT-SEQUENCE-NO.
 11008     GO TO 3992-WRITE.
 11009
 11010 3992-EXIT.
 11011     EXIT.
 11012 3993-MODIFY-SCREEN-ATTRB.
 11013
 11014     IF CERTMTL GREATER ZERO
 11015         MOVE AL-UANON           TO CERTMTA
 11016     END-IF.
 11017
 11018     IF EFFDTL GREATER ZERO
 11019         MOVE AL-UANON           TO EFFDTA
 11020     END-IF.
 11021
 11022     IF ACCOUNTL GREATER ZERO
 11023         MOVE AL-UANON           TO ACCOUNTA
 11024     END-IF.
 11025
 11026     IF STATEL GREATER ZERO
 11027         MOVE AL-UANON           TO STATEA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 211
* EL130.cbl
 11028     END-IF.
 11029
 11030     IF CRTCARRL GREATER ZERO
 11031         MOVE AL-UANON           TO CRTCARRA
 11032     END-IF.
 11033
 11034     IF GROUPL GREATER ZERO
 11035         MOVE AL-UANON           TO GROUPA
 11036     END-IF.
 11037
 11038     IF CRTLNMEL GREATER ZERO
 11039         MOVE AL-UANON           TO CRTLNMEA
 11040     END-IF.
 11041
 11042     IF CRTFNMEL GREATER ZERO
 11043         MOVE AL-UANON           TO CRTFNMEA
 11044     END-IF.
 11045
 11046     IF CRTINITL GREATER ZERO
 11047         MOVE AL-UANON           TO CRTINITA
 11048     END-IF.
 11049
 11050     IF ISSAGEL GREATER ZERO
 11051         MOVE AL-UNNON           TO ISSAGEA
 11052     END-IF.
 11053
 11054     IF JNTLNMEL GREATER ZERO
 11055         MOVE AL-UANON           TO JNTLNMEA
 11056     END-IF.
 11057
 11058     IF JNTFNMEL GREATER ZERO
 11059         MOVE AL-UANON           TO JNTFNMEA
 11060     END-IF.
 11061
 11062     IF JNTINITL GREATER ZERO
 11063         MOVE AL-UANON           TO JNTINITA
 11064     END-IF.
 11065
 11066     IF JNTAGEL GREATER ZERO
 11067         MOVE AL-UNNON           TO JNTAGEA
 11068     END-IF.
 11069
 11070     IF CRTSSNL GREATER ZERO
 11071         MOVE AL-UANON           TO CRTSSNA
 11072     END-IF.
 11073
 11074     IF ACVDSCRL GREATER ZERO
 11075         MOVE AL-SANON           TO ACVDSCRA
 11076     END-IF.
 11077
 11078     IF ACVKINDL GREATER ZERO
 11079         MOVE AL-SANON           TO ACVKINDA
 11080     END-IF.
 11081
 11082     IF ACVCDL GREATER ZERO
 11083         MOVE AL-UANON           TO ACVCDA
 11084     END-IF.
 11085
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 212
* EL130.cbl
 11086     IF ACVOTRML GREATER ZERO
 11087         MOVE AL-UNNON           TO ACVOTRMA
 11088     END-IF.
 11089
 11090     IF ACVRTRML GREATER ZERO
 11091         MOVE AL-UNNON           TO ACVRTRMA
 11092     END-IF.
 11093
 11094     IF ACVRATEL GREATER ZERO
 11095         MOVE AL-UNNON           TO ACVRATEA
 11096     END-IF.
 11097
 11098     IF ACVBENEL GREATER ZERO
 11099         MOVE AL-UNNON           TO ACVBENEA
 11100     END-IF.
 11101
 11102     IF ACVFORML GREATER ZERO
 11103         MOVE AL-UANON           TO ACVFORMA
 11104     END-IF.
 11105
 11106     IF ACVCNDTL GREATER ZERO
 11107         MOVE AL-UANON           TO ACVCNDTA
 11108     END-IF.
 11109
 11110     IF ACVEXITL GREATER ZERO
 11111         MOVE AL-UANON           TO ACVEXITA
 11112     END-IF.
 11113
 11114     IF ACVSTATL GREATER ZERO
 11115         MOVE AL-UANON           TO ACVSTATA
 11116     END-IF.
 11117
 11118     IF LCVDSCRL GREATER ZERO
 11119         MOVE AL-SANON           TO LCVDSCRA
 11120     END-IF.
 11121
 11122     IF LCVKINDL GREATER ZERO
 11123         MOVE AL-SANON           TO LCVKINDA
 11124     END-IF.
 11125
 11126     IF LCVCDL GREATER ZERO
 11127         MOVE AL-UANON           TO LCVCDA
 11128     END-IF.
 11129
 11130     IF LCVOTRML GREATER ZERO
 11131         MOVE AL-UNNON           TO LCVOTRMA
 11132     END-IF.
 11133
 11134     IF LCVRTRML GREATER ZERO
 11135         MOVE AL-UNNON           TO LCVRTRMA
 11136     END-IF.
 11137
 11138     IF LCVRATEL GREATER ZERO
 11139         MOVE AL-UNNON           TO LCVRATEA
 11140     END-IF.
 11141
 11142     IF LCVBENEL GREATER ZERO
 11143         MOVE AL-UNNON           TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 213
* EL130.cbl
 11144     END-IF.
 11145
 11146     IF LCVFORML GREATER ZERO
 11147         MOVE AL-UANON           TO LCVFORMA
 11148     END-IF.
 11149
 11150     IF LCVCNDTL GREATER ZERO
 11151         MOVE AL-UANON           TO LCVCNDTA
 11152     END-IF.
 11153
 11154     IF LCVEXITL GREATER ZERO
 11155         MOVE AL-UANON           TO LCVEXITA
 11156     END-IF.
 11157
 11158     IF LCVSTATL GREATER ZERO
 11159         MOVE AL-UANON           TO LCVSTATA
 11160     END-IF.
 11161
 11162     IF MEMCAPL GREATER ZERO
 11163         MOVE AL-UANON           TO MEMCAPA
 11164     END-IF.
 11165
 11166     IF APRL GREATER ZERO
 11167         MOVE AL-UNNON           TO APRA
 11168     END-IF.
 11169
 11170     IF PMTFREQL GREATER ZERO
 11171         MOVE AL-UNNON           TO PMTFREQA
 11172     END-IF.
 11173
 11174     IF INDGRPL GREATER ZERO
 11175         MOVE AL-UANON           TO INDGRPA
 11176     END-IF.
 11177
 11178     IF PREMTYPL GREATER ZERO
 11179         MOVE AL-UANON           TO PREMTYPA
 11180     END-IF.
 11181
 11182     IF REINCDL GREATER ZERO
 11183         MOVE AL-UANON           TO REINCDA
 11184     END-IF.
 11185
 11186     IF ADDONDTL GREATER ZERO
 11187         MOVE AL-UANON           TO ADDONDTA
 11188     END-IF.
 11189
 11190     IF MEMBERL GREATER ZERO
 11191         MOVE AL-UANON           TO MEMBERA
 11192     END-IF.
 11193
 11194     IF BCERT1L GREATER ZERO
 11195         MOVE AL-SANON           TO BCERT1A
 11196                                    BSUFX1A
 11197     END-IF.
 11198
 11199     IF BCERT2L GREATER ZERO
 11200         MOVE AL-SANON           TO BCERT2A
 11201                                    BSUFX2A
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 214
* EL130.cbl
 11202     END-IF.
 11203
 11204     IF BCERT3L GREATER ZERO
 11205         MOVE AL-SANON           TO BCERT3A
 11206                                    BSUFX3A
 11207     END-IF.
 11208
 11209     IF BCERT4L GREATER ZERO
 11210         MOVE AL-SANON           TO BCERT4A
 11211                                    BSUFX4A
 11212     END-IF.
 11213
 11214     IF BCERT5L GREATER ZERO
 11215         MOVE AL-SANON           TO BCERT5A
 11216                                    BSUFX5A
 11217     END-IF.
 11218
 11219 3993-MODIFY-CLAIM-ATTRB.
 11220
 11221     IF PCERTNOL GREATER ZERO
 11222         MOVE AL-UANON           TO PCERTNOA
 11223     END-IF.
 11224
 11225     IF PSUFXL GREATER ZERO
 11226         MOVE AL-UANON           TO PSUFXA
 11227     END-IF.
 11228
 11229     IF LSTNMEL GREATER ZERO
 11230         MOVE AL-UANON           TO LSTNMEA
 11231     END-IF.
 11232
 11233     IF FSTNMEL GREATER ZERO
 11234         MOVE AL-UANON           TO FSTNMEA
 11235     END-IF.
 11236
 11237     IF INITL GREATER ZERO
 11238         MOVE AL-UANON           TO INITA
 11239     END-IF.
 11240
 11241     IF SEXL GREATER ZERO
 11242         MOVE AL-UANON           TO SEXA
 11243     END-IF.
 11244
 11245     IF BIRTHDTL GREATER ZERO
 11246         MOVE AL-UANON           TO BIRTHDTA
 11247     END-IF.
 11248
 11249     IF SSNL GREATER ZERO
 11250         MOVE AL-UANON           TO SSNA
 11251     END-IF.
 11252
 11253     IF INCURL GREATER ZERO
 11254         MOVE AL-UANON           TO INCURA
 11255     END-IF.
 11256
 11257     IF REPORTL GREATER ZERO
 11258         MOVE AL-UANON           TO REPORTA
 11259     END-IF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 215
* EL130.cbl
 11260
 11261*    IF ESTENDL GREATER ZERO
 11262*        MOVE AL-UANON           TO ESTENDA
 11263*    END-IF.
 11264
 11265     IF DIAGL GREATER ZERO
 11266         MOVE AL-UANON           TO DIAGA
 11267     END-IF.
 11268*
 11269     IF ICD1L GREATER ZERO
 11270         MOVE AL-UANON           TO ICD1A
 11271     END-IF.
 11272
 11273     IF ICD2L GREATER ZERO
 11274         MOVE AL-UANON           TO ICD2A
 11275     END-IF.
 11276
 11277*    IF CAUSEL GREATER ZERO
 11278*        MOVE AL-UANON           TO CAUSEA
 11279*    END-IF.
 11280
 11281     IF MANRSVL GREATER ZERO
 11282         MOVE AL-UNNON           TO MANRSVA
 11283     END-IF.
 11284
 11285     IF RELCLML GREATER ZERO
 11286         MOVE AL-UANON           TO RELCLMA
 11287     END-IF.
 11288
 11289     IF LOANNOL GREATER ZERO
 11290         MOVE AL-UANON           TO LOANNOA
 11291     END-IF.
 11292
 11293     IF LOANBALL GREATER ZERO
 11294         MOVE AL-UNNON           TO LOANBALA
 11295     END-IF.
 11296
 11297     IF PROCCDL GREATER ZERO
 11298         MOVE AL-UANON           TO PROCCDA
 11299     END-IF.
 11300
 11301     IF BENECDL GREATER THAN ZERO
 11302         MOVE AL-UANON           TO  BENECDA
 11303     END-IF.
 11304
 11305     IF PRICDL GREATER ZERO
 11306         MOVE AL-UANON           TO PRICDA
 11307     END-IF.
 11308
 11309     IF SUPVL GREATER ZERO
 11310         MOVE AL-UANON           TO SUPVA
 11311     END-IF.
 11312
 11313     IF FILETOL GREATER ZERO
 11314         MOVE AL-UANON           TO FILETOA
 11315     END-IF.
 11316
 11317
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 216
* EL130.cbl
 11318 3993-MODIFY-CLAIM-KEY-ATTRB.
 11319
 11320     IF CLMNOL GREATER ZERO
 11321         MOVE AL-UANON           TO CLMNOA
 11322     END-IF.
 11323
 11324     IF CLMCARRL GREATER ZERO
 11325         MOVE AL-UANON           TO CLMCARRA
 11326     END-IF.
 11327
 11328     IF CLMTYPEL GREATER ZERO
 11329         MOVE AL-UANON           TO CLMTYPEA
 11330     END-IF.
 11331
 11332     IF CERTNOL GREATER ZERO
 11333         MOVE AL-SANON           TO CERTNOA
 11334     END-IF.
 11335
 11336     IF SUFXL GREATER ZERO
 11337         MOVE AL-SANON           TO SUFXA
 11338     END-IF.
 11339
 11340 3993-EXIT.
 11341     EXIT.
 11342
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 217
* EL130.cbl
 11344 3994-BUILD-NINETY-THREE-TRAILER.
 11345
 11346     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11347     MOVE 'AT'                   TO AT-RECORD-ID.
 11348
 11349     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11350     MOVE CLMCARRI               TO AT-CARRIER.
 11351
 11352     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11353     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11354     MOVE +93                    TO AT-SEQUENCE-NO.
 11355     MOVE '6'                    TO AT-TRAILER-TYPE.
 11356     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11357
 11358     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'
 11359         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11360     ELSE
 11361         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11362     END-IF
 11363
 11364     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11365                                    AT-GEN-INFO-LAST-MAINT-DT.
 11366
 11367     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11368                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11369     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11370
 11371
 11372
 11373* EXEC CICS WRITE
 11374*        DATASET   (ELTRLR-DSID)
 11375*        FROM      (ACTIVITY-TRAILERS)
 11376*        RIDFLD    (AT-CONTROL-PRIMARY)
 11377*    END-EXEC.
 11378     MOVE LENGTH OF
 11379      ACTIVITY-TRAILERS
 11380       TO DFHEIV11
 11381*    MOVE '&$ L                  ''   #00010580' TO DFHEIV0
 11382     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11383     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11384     MOVE X'2020233030303130353830' TO DFHEIV0(25:11)
 11385     CALL 'kxdfhei1' USING DFHEIV0,
 11386           ELTRLR-DSID,
 11387           ACTIVITY-TRAILERS,
 11388           DFHEIV11,
 11389           AT-CONTROL-PRIMARY,
 11390           DFHEIV99,
 11391           DFHEIV99
 11392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11393
 11394
 11395 3994-EXIT.
 11396     EXIT.
 11397
 11398 3994B-BUILD-NINETY-FOUR-TRAILER.
 11399
 11400     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11401     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 218
* EL130.cbl
 11402
 11403     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11404     MOVE CLMCARRI               TO AT-CARRIER.
 11405
 11406     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11407     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11408     MOVE +94                    TO AT-SEQUENCE-NO.
 11409     MOVE '6'                    TO AT-TRAILER-TYPE.
 11410     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11411
 11412     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11413
 11414     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11415                                    AT-GEN-INFO-LAST-MAINT-DT.
 11416
 11417     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11418                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11419     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11420
 11421
 11422
 11423* EXEC CICS WRITE
 11424*        DATASET   (ELTRLR-DSID)
 11425*        FROM      (ACTIVITY-TRAILERS)
 11426*        RIDFLD    (AT-CONTROL-PRIMARY)
 11427*    END-EXEC.
 11428     MOVE LENGTH OF
 11429      ACTIVITY-TRAILERS
 11430       TO DFHEIV11
 11431*    MOVE '&$ L                  ''   #00010613' TO DFHEIV0
 11432     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11433     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11434     MOVE X'2020233030303130363133' TO DFHEIV0(25:11)
 11435     CALL 'kxdfhei1' USING DFHEIV0,
 11436           ELTRLR-DSID,
 11437           ACTIVITY-TRAILERS,
 11438           DFHEIV11,
 11439           AT-CONTROL-PRIMARY,
 11440           DFHEIV99,
 11441           DFHEIV99
 11442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11443
 11444
 11445 3994B-EXIT.
 11446     EXIT.
 11447 3994C-BUILD-NINETY-FIVE-TRAILER.
 11448
 11449     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11450     MOVE 'AT'                   TO AT-RECORD-ID
 11451
 11452     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11453     MOVE CLMCARRI               TO AT-CARRIER
 11454
 11455     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11456     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11457     MOVE +95                    TO AT-SEQUENCE-NO
 11458     MOVE '6'                    TO AT-TRAILER-TYPE
 11459     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 219
* EL130.cbl
 11460
 11461     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11462                                    AT-GEN-INFO-LAST-MAINT-DT
 11463
 11464     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11465                                    AT-GEN-INFO-LAST-UPDATED-BY
 11466     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11467
 11468     perform varying e1 from +1 by +1 until
 11469        ws-error-no (e1) = spaces
 11470        move ws-error-no (e1)    to at-note-error-no (e1)
 11471     end-perform
 11472
 11473     if at-info-line-1 not = spaces
 11474
 11475* EXEC CICS WRITE
 11476*          DATASET  (ELTRLR-DSID)
 11477*          FROM     (ACTIVITY-TRAILERS)
 11478*          RIDFLD   (AT-CONTROL-PRIMARY)
 11479*       END-EXEC
 11480     MOVE LENGTH OF
 11481      ACTIVITY-TRAILERS
 11482       TO DFHEIV11
 11483*    MOVE '&$ L                  ''   #00010648' TO DFHEIV0
 11484     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11485     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11486     MOVE X'2020233030303130363438' TO DFHEIV0(25:11)
 11487     CALL 'kxdfhei1' USING DFHEIV0,
 11488           ELTRLR-DSID,
 11489           ACTIVITY-TRAILERS,
 11490           DFHEIV11,
 11491           AT-CONTROL-PRIMARY,
 11492           DFHEIV99,
 11493           DFHEIV99
 11494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11495     end-if
 11496
 11497     .
 11498 3994C-EXIT.
 11499     EXIT.
 11500 3995-BUILD-CLAIM-RECORD.
 11501     IF PROCCDL GREATER ZERO
 11502         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11503     ELSE
 11504         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11505     END-IF.
 11506
 11507     IF FSTNMEL GREATER ZERO
 11508         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11509     END-IF.
 11510
 11511     IF INITL GREATER ZERO
 11512         MOVE INITI              TO CL-INSURED-MID-INIT
 11513     END-IF.
 11514
 11515     IF BIRTHDTL GREATER ZERO
 11516         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11517     END-IF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 220
* EL130.cbl
 11518
 11519     IF SEXL GREATER ZERO
 11520         MOVE SEXI               TO CL-INSURED-SEX-CD
 11521     END-IF.
 11522
 11523     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11524
 11525*    IF CLMTYPEL GREATER ZERO
 11526     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11527*    END-IF.
 11528
 11529     IF PREMTYPL GREATER ZERO
 11530         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11531     END-IF.
 11532
 11533     IF INCURL GREATER ZERO
 11534         MOVE WS-INCUR           TO CL-INCURRED-DT
 11535     END-IF.
 11536
 11537     IF (PI-COMPANY-ID = 'DCC' OR 'VPP')
 11538        AND (ERPDEF-FOUND)
 11539        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11540*       MOVE WS-CRIT-PER-RECURRENT
 11541*                                TO CL-CRIT-PER-RECURRENT
 11542*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11543        if ws-crit-per-recurrent > 01
 11544           move zeros            to cl-benefit-period
 11545        end-if
 11546     ELSE
 11547        IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
 11548           MOVE CM-LF-CRITICAL-PERIOD
 11549                                 TO CL-CRITICAL-PERIOD
 11550        ELSE
 11551           MOVE CM-AH-CRITICAL-PERIOD
 11552                                 TO CL-CRITICAL-PERIOD
 11553        END-IF
 11554     END-IF
 11555
 11556     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11557        COMPUTE DC-ELAPSED-MONTHS =
 11558           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11559        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11560        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11561        MOVE '6'                 TO DC-OPTION-CODE
 11562        PERFORM 9700-LINK-DATE-CONVERT
 11563                                 THRU 9700-EXIT
 11564        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11565     END-IF
 11566
 11567     if instypel > zero
 11568        move instypei            to cl-insured-type
 11569     end-if
 11570     IF REPORTL GREATER ZERO
 11571         MOVE WS-REPORT          TO CL-REPORTED-DT
 11572     END-IF.
 11573
 11574     IF EIBAID = DFHPF6
 11575         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 221
* EL130.cbl
 11576             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11577                 IF EMI-FORCABLE-CTR = +1
 11578                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11579                 END-IF
 11580         END-IF
 11581     END-IF.
 11582
 11583*    IF ESTENDL GREATER ZERO
 11584*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11585*    END-IF.
 11586
 11587     IF ADDONDTL GREATER ZERO
 11588         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11589     END-IF.
 11590
 11591*    IF CAUSEL GREATER ZERO
 11592*        MOVE CAUSEI             TO CL-CAUSE-CD
 11593*    END-IF.
 11594
 11595     IF SSNL GREATER ZERO
 11596         MOVE SSNI               TO CL-SOC-SEC-NO
 11597     ELSE
 11598         MOVE CERT-STATE         TO CL-SSN-STATE
 11599         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11600         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11601     END-IF.
 11602
 11603     IF PRICDL GREATER ZERO
 11604         MOVE PRICDI             TO CL-PRIORITY-CD
 11605     END-IF.
 11606
 11607     IF SUPVL GREATER ZERO
 11608         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11609     END-IF.
 11610
 11611     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11612     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11613     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11614
 11615     IF RELCLML GREATER ZERO
 11616         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11617     END-IF.
 11618
 11619     IF FILETOL GREATER ZERO
 11620         MOVE FILETOI            TO CL-FILE-LOCATION
 11621     END-IF.
 11622
 11623 3995-EXIT.
 11624      EXIT.
 11625 3996-read-cert-claim-trailer.
 11626
 11627     move cm-ah-benefit-amt      to ws-monthly-benefit
 11628     if (pi-dcc-max-amt < ws-monthly-benefit)
 11629        and (pi-dcc-max-amt not = zeros)
 11630        move pi-dcc-max-amt      to ws-monthly-benefit
 11631     end-if
 11632
 11633     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 222
* EL130.cbl
 11634     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11635     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11636     MOVE CM-STATE               TO CTRLR-STATE
 11637     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11638     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11639     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11640     MOVE 'B'                    TO CTRLR-REC-TYPE
 11641
 11642* EXEC CICS READ
 11643*       DATASET  (ELCRTT-DSID)
 11644*       set     (address of CERTIFICATE-TRAILERS)
 11645*       RIDFLD   (ELCRTT-KEY)
 11646*       RESP     (WS-RESPONSE)
 11647*    END-EXEC
 11648*    MOVE '&"S        E          (  N#00010799' TO DFHEIV0
 11649     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11650     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11651     MOVE X'204E233030303130373939' TO DFHEIV0(25:11)
 11652     CALL 'kxdfhei1' USING DFHEIV0,
 11653           ELCRTT-DSID,
 11654           DFHEIV20,
 11655           DFHEIV99,
 11656           ELCRTT-KEY,
 11657           DFHEIV99,
 11658           DFHEIV99,
 11659           DFHEIV99
 11660     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11661         DFHEIV20
 11662     MOVE EIBRESP  TO WS-RESPONSE
 11663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11664***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11665***                                                            ***
 11666***  This may need some work here. I think I should accumulate ***
 11667***  all the claims with the same claim type?????????          ***
 11668***                                                            ***
 11669***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11670     IF WS-RESP-NORMAL
 11671        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11672        perform varying s1 from +1 by +1 until
 11673           (s1 > +24)
 11674           or (cs-claim-no (s1) = spaces)
 11675           if cs-claim-type (s1) = clmtypei
 11676              move er-1659       to ws-error-no (e1)
 11677              compute ws-tot-days-paid =
 11678                 ws-tot-days-paid + cs-days-paid (s1)
 11679              compute ws-tot-amt-paid =
 11680                 ws-tot-amt-paid + cs-total-paid (s1)
 11681           end-if
 11682        end-perform
 11683*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11684*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11685*           and (pi-dcc-max-benefits not = zeros)
 11686*           add +1                to e1
 11687*           MOVE ER-1660          TO EMI-ERROR
 11688*                                    ws-error-no (e1)
 11689*           PERFORM 9900-ERROR-FORMAT
 11690*                                 THRU 9900-EXIT
 11691*        end-if
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 223
* EL130.cbl
 11692     end-if
 11693**       if instypei = 'P'
 11694**          move +1 to s1
 11695**       else
 11696**          MOVE +2 to s1
 11697**       end-if
 11698*
 11699*        move +1 to s1
 11700*        evaluate clmtypei
 11701*           when 'A'
 11702*              move +1 to s2
 11703*           when 'I'
 11704*              move +2 to s2
 11705*           when 'G'
 11706*              move +3 to s2
 11707*           when 'L'
 11708*              move +4 to s2
 11709*           when 'P'
 11710*              move +5 to s2
 11711*        end-evaluate
 11712*        if cs-claim-type (s1 s2) = clmtypei
 11713*           if cs-no-of-claims (s1 s2) > zeros
 11714*              move er-1659       to ws-error-no (e1)
 11715*           end-if
 11716*           compute WS-BENEFITS-PREV-PAID =
 11717*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11718*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11719*              and (pi-dcc-max-benefits not = zeros)
 11720*              add +1             to e1
 11721*              MOVE ER-1660       TO EMI-ERROR
 11722*                                    ws-error-no (e1)
 11723*              PERFORM 9900-ERROR-FORMAT
 11724*                                 THRU 9900-EXIT
 11725*           end-if
 11726*        end-if
 11727*     end-if
 11728
 11729     .
 11730 3996-exit.
 11731     exit.
 11732
 11733 3997-GET-ERPDEF.
 11734
 11735     if cm-clp-state = spaces or low-values or zeros
 11736        move cm-state            to cm-clp-state
 11737     end-if
 11738     MOVE SPACES                 TO WS-ERPDEF-SW
 11739     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11740                                    WS-CRIT-PER-RTW-MOS
 11741                                    WS-CRIT-PER-RECURRENT
 11742
 11743     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11744     MOVE CM-clp-state        TO ERPDEF-STATE
 11745     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11746***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11747***                                                            ***
 11748***  If they set up a claim where there is no coverage on the  ***
 11749***  addendum with the intention of denying.  We need to do    ***
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 224
* EL130.cbl
 11750***  some funky stuff here.                                    ***
 11751***                                                            ***
 11752***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11753
 11754     evaluate true
 11755        when (clmtypei = 'L' or 'P')
 11756           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 11757              and 'CU')
 11758           move 'L'              to erpdef-ben-type
 11759           move cm-lf-benefit-cd to erpdef-ben-code
 11760        when (clmtypei not = 'L' and 'P')
 11761           and (cm-ah-benefit-cd not = '00' and '  ')
 11762           move 'A'              to erpdef-ben-type
 11763           move cm-ah-benefit-cd to erpdef-ben-code
 11764        when (clmtypei not = 'L' and 'P')
 11765           and (cm-ah-benefit-cd = '00' or '  ')
 11766           move 'L'              to erpdef-ben-type
 11767           move cm-lf-benefit-cd to erpdef-ben-code
 11768        when (clmtypei = 'L' or 'P')
 11769           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 11770           move 'A'              to erpdef-ben-type
 11771           move cm-ah-benefit-cd to erpdef-ben-code
 11772        when other
 11773           move 'A'              to erpdef-ben-type
 11774           move cm-ah-benefit-cd to erpdef-ben-code
 11775     end-evaluate
 11776*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11777*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11778     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11779     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11780
 11781
 11782* EXEC CICS STARTBR
 11783*        DATASET  ('ERPDEF')
 11784*        RIDFLD   (ERPDEF-KEY)
 11785*        GTEQ
 11786*        RESP     (WS-RESPONSE)
 11787*    END-EXEC
 11788     MOVE 'ERPDEF' TO DFHEIV1
 11789     MOVE 0
 11790       TO DFHEIV11
 11791*    MOVE '&,         G          &  N#00010922' TO DFHEIV0
 11792     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11793     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11794     MOVE X'204E233030303130393232' TO DFHEIV0(25:11)
 11795     CALL 'kxdfhei1' USING DFHEIV0,
 11796           DFHEIV1,
 11797           ERPDEF-KEY,
 11798           DFHEIV99,
 11799           DFHEIV11,
 11800           DFHEIV99
 11801     MOVE EIBRESP  TO WS-RESPONSE
 11802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11803
 11804     IF WS-RESP-NORMAL
 11805
 11806* EXEC CICS READNEXT
 11807*          DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 225
* EL130.cbl
 11808*          INTO     (PRODUCT-MASTER)
 11809*          RIDFLD   (ERPDEF-KEY)
 11810*          RESP     (WS-RESPONSE)
 11811*       END-EXEC
 11812     MOVE LENGTH OF
 11813      PRODUCT-MASTER
 11814       TO DFHEIV12
 11815     MOVE 'ERPDEF' TO DFHEIV1
 11816     MOVE 0
 11817       TO DFHEIV11
 11818*    MOVE '&.IL                  )  N#00010930' TO DFHEIV0
 11819     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11820     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11821     MOVE X'204E233030303130393330' TO DFHEIV0(25:11)
 11822     CALL 'kxdfhei1' USING DFHEIV0,
 11823           DFHEIV1,
 11824           PRODUCT-MASTER,
 11825           DFHEIV12,
 11826           ERPDEF-KEY,
 11827           DFHEIV99,
 11828           DFHEIV11,
 11829           DFHEIV99,
 11830           DFHEIV99
 11831     MOVE EIBRESP  TO WS-RESPONSE
 11832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11833
 11834        IF WS-RESP-NORMAL
 11835           IF (ERPDEF-KEY-SAVE (1:16) =
 11836              PD-CONTROL-PRIMARY (1:16))
 11837              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11838
 11839              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11840                 (A1 > +8)
 11841                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11842              END-PERFORM
 11843              IF A1 < +9
 11844                 SET ERPDEF-FOUND TO TRUE
 11845                 move pd-max-amt (a1)
 11846                              to pi-dcc-max-amt
 11847                 MOVE PD-CRIT-PERIOD (A1)
 11848                              TO WS-MAX-BENEFITS
 11849                                 pi-dcc-max-benefits
 11850                 if pd-rec-crit-period (a1) not numeric
 11851                    move 01      to pd-rec-crit-period (a1)
 11852                 end-if
 11853                 MOVE PD-REC-CRIT-PERIOD (A1)
 11854                              TO WS-CRIT-PER-RECURRENT
 11855                 IF PD-RTW-MOS (A1) NUMERIC
 11856                    MOVE PD-RTW-MOS (A1)
 11857                              TO WS-CRIT-PER-RTW-MOS
 11858                 ELSE
 11859                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11860                 END-IF
 11861                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11862                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11863                                 TO WS-EXCL-PERIOD
 11864                 END-IF
 11865                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 226
* EL130.cbl
 11866                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11867                                 TO WS-COV-ENDS
 11868                 END-IF
 11869                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11870                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11871                                 TO WS-ACC-PERIOD
 11872                 END-IF
 11873                 IF PD-PRE-EXIST-EXCL-TYPE (A1) NUMERIC
 11874                    MOVE PD-PRE-EXIST-EXCL-TYPE (A1)
 11875                                 TO WS-PRE-EXISTING-PER
 11876                 END-IF
 11877              else
 11878                 MOVE -1         TO MAINTL
 11879                 move er-1673    to emi-error
 11880                 PERFORM 9900-ERROR-FORMAT
 11881                                 THRU 9900-EXIT
 11882              END-IF
 11883           else
 11884              MOVE -1            TO MAINTL
 11885              move er-1671       to emi-error
 11886              PERFORM 9900-ERROR-FORMAT
 11887                                 THRU 9900-EXIT
 11888           END-IF
 11889        END-IF
 11890     END-IF
 11891
 11892     .
 11893 3997-EXIT.
 11894     EXIT.
 11895
 11896 3998-update-cert-claim-trailer.
 11897
 11898
 11899* EXEC CICS GETMAIN
 11900*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11901*       LENGTH   (ELCRTT-LENGTH)
 11902*       INITIMG  (GETMAIN-SPACE)
 11903*    END-EXEC
 11904*    MOVE ',"IL                  $   #00011001' TO DFHEIV0
 11905     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11906     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11907     MOVE X'2020233030303131303031' TO DFHEIV0(25:11)
 11908     CALL 'kxdfhei1' USING DFHEIV0,
 11909           DFHEIV20,
 11910           ELCRTT-LENGTH,
 11911           GETMAIN-SPACE
 11912     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11913         DFHEIV20
 11914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11915
 11916     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11917     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11918     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11919     MOVE CM-STATE         TO CTRLR-STATE
 11920     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11921     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11922     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11923     MOVE 'B'              TO CTRLR-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 227
* EL130.cbl
 11924
 11925* EXEC CICS READ
 11926*       UPDATE
 11927*       DATASET  (ELCRTT-DSID)
 11928*       into     (CERTIFICATE-TRAILERS)
 11929*       RIDFLD   (ELCRTT-KEY)
 11930*       RESP     (WS-RESPONSE)
 11931*    END-EXEC
 11932     MOVE LENGTH OF
 11933      CERTIFICATE-TRAILERS
 11934       TO DFHEIV11
 11935*    MOVE '&"IL       EU         (  N#00011015' TO DFHEIV0
 11936     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11937     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11938     MOVE X'204E233030303131303135' TO DFHEIV0(25:11)
 11939     CALL 'kxdfhei1' USING DFHEIV0,
 11940           ELCRTT-DSID,
 11941           CERTIFICATE-TRAILERS,
 11942           DFHEIV11,
 11943           ELCRTT-KEY,
 11944           DFHEIV99,
 11945           DFHEIV99,
 11946           DFHEIV99
 11947     MOVE EIBRESP  TO WS-RESPONSE
 11948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11949     IF WS-RESP-NORMAL
 11950        perform varying s1 from +1 by +1 until
 11951           (s1 > +24)
 11952           or (cs-claim-no (s1) = spaces)
 11953        end-perform
 11954        if s1 < +25
 11955           perform 3999-upd-crt-trlr thru 3999-exit
 11956
 11957* EXEC CICS REWRITE
 11958*             DATASET  (ELCRTT-DSID)
 11959*             from     (CERTIFICATE-TRAILERS)
 11960*             RESP     (WS-RESPONSE)
 11961*          END-EXEC
 11962     MOVE LENGTH OF
 11963      CERTIFICATE-TRAILERS
 11964       TO DFHEIV11
 11965*    MOVE '&& L                  %  N#00011029' TO DFHEIV0
 11966     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11967     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11968     MOVE X'204E233030303131303239' TO DFHEIV0(25:11)
 11969     CALL 'kxdfhei1' USING DFHEIV0,
 11970           ELCRTT-DSID,
 11971           CERTIFICATE-TRAILERS,
 11972           DFHEIV11,
 11973           DFHEIV99
 11974     MOVE EIBRESP  TO WS-RESPONSE
 11975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11976        end-if
 11977     else
 11978        if ws-resp-notfnd
 11979           move 'CS'             to certificate-trailers
 11980           move cm-control-primary to cs-control-primary
 11981           move 'B'              to cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 228
* EL130.cbl
 11982           perform varying s1 from +1 by +1 until s1 > +24
 11983              move zeros         to cs-days-paid (s1)
 11984                                    cs-total-paid (s1)
 11985                                    cs-benefit-period (s1)
 11986                                    cs-remaining-bens (s1)
 11987           end-perform
 11988           move +1               to s1
 11989           perform 3999-upd-crt-trlr
 11990                                 thru 3999-exit
 11991
 11992* EXEC CICS WRITE
 11993*             DATASET  (ELCRTT-DSID)
 11994*             from     (CERTIFICATE-TRAILERS)
 11995*             RIDFLD   (cs-control-primary)
 11996*             RESP     (WS-RESPONSE)
 11997*          END-EXEC
 11998     MOVE LENGTH OF
 11999      CERTIFICATE-TRAILERS
 12000       TO DFHEIV11
 12001*    MOVE '&$ L                  ''  N#00011049' TO DFHEIV0
 12002     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12003     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12004     MOVE X'204E233030303131303439' TO DFHEIV0(25:11)
 12005     CALL 'kxdfhei1' USING DFHEIV0,
 12006           ELCRTT-DSID,
 12007           CERTIFICATE-TRAILERS,
 12008           DFHEIV11,
 12009           cs-control-primary,
 12010           DFHEIV99,
 12011           DFHEIV99
 12012     MOVE EIBRESP  TO WS-RESPONSE
 12013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12014        end-if
 12015     END-IF
 12016
 12017     .
 12018 3998-exit.
 12019     exit.
 12020
 12021 3999-upd-crt-trlr.
 12022     move clmnoi                 to cs-claim-no       (s1)
 12023     move clmtypei               to cs-claim-type     (s1)
 12024     move instypei               to cs-insured-type   (s1)
 12025     if ws-crit-per-recurrent > 01
 12026        move zeros               to cs-benefit-period(s1)
 12027     else
 12028        move 01                  to cs-benefit-period(s1)
 12029     end-if
 12030*    move cl-benefit-period      to cs-benefit-period (s1)
 12031*    move cl-critical-period     to cs-remaining-bens (s1)
 12032     move zeros                  to cs-remaining-bens (s1)
 12033     .
 12034 3999-exit.
 12035     exit.
 12036 4000-CALCULATE-CERT-TERM.
 12037
 12038     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 12039
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 229
* EL130.cbl
 12040     MOVE N                      TO WS-TERM.
 12041
 12042     IF WS-TERM GREATER 120
 12043         MOVE 120                TO WS-TERM
 12044     END-IF.
 12045
 12046 4000-CALC-TERM-EXIT.
 12047      EXIT.
 12048
 12049 4100-CALC-GROSS-TERM.
 12050     MOVE HOLD-LOAN-BAL           TO L.
 12051     MOVE WS-ACVBENE              TO M.
 12052     COMPUTE N = L / M.
 12053     IF N LESS 1
 12054         MOVE 1  TO N
 12055     END-IF.
 12056
 12057     IF LCVCDL GREATER ZERO
 12058         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 12059     ELSE
 12060         MOVE ZEROS               TO WS-LF-RATE
 12061     END-IF.
 12062
 12063     IF ACVCDL GREATER ZERO
 12064         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 12065     ELSE
 12066         MOVE ZEROS               TO WS-AH-RATE
 12067     END-IF.
 12068
 12069     COMPUTE I = WS-APR / +1200.
 12070
 12071 4105-LOOP.
 12072     IF N GREATER 240
 12073         GO TO 4200-EXIT
 12074     END-IF.
 12075
 12076     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 12077
 12078     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 12079         ADD 1 TO N
 12080         GO TO 4105-LOOP
 12081     END-IF.
 12082
 12083 4200-EXIT.
 12084      EXIT.
 12085
 12086 4210-CALC-LEFT-RIGHTONE.
 12087      MOVE L         TO LEFT-TOT-1.
 12088      SUBTRACT 1 FROM N.
 12089      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12090      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 12091      ADD 1 TO N.
 12092
 12093 4211-CALC-TERM1.
 12094      MOVE N         TO TERM1.
 12095      MULTIPLY M BY TERM1.
 12096
 12097 4212-LOOP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 230
* EL130.cbl
 12098      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 12099      ADD 1 TO A-N.
 12100      MULTIPLY A-N BY TERM1.
 12101      SUBTRACT 1 FROM A-N.
 12102      ADD TERM1 TO LEFT-TOT-1.
 12103
 12104 4213-CALC-TERM2.
 12105      MOVE M         TO TERM2.
 12106      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 12107      MULTIPLY IA-N BY TERM2.
 12108      SUBTRACT TERM2 FROM LEFT-TOT-1.
 12109
 12110 4215-CALC-RIGHTONE.
 12111      MOVE M         TO RIGHT-TOT-1.
 12112      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12113      MULTIPLY A-N BY RIGHT-TOT-1.
 12114
 12115 4220-EXIT.
 12116      EXIT.
 12117
 12118 4300-CALC-A-N.
 12119     IF N LESS 1
 12120         MOVE 0     TO A-N
 12121         GO TO 4300-EXIT
 12122     END-IF.
 12123
 12124     IF I = 0
 12125         MOVE .00001 TO I
 12126     END-IF.
 12127
 12128     ADD 1 TO I.
 12129     DIVIDE I INTO 1 GIVING V.
 12130     SUBTRACT 1 FROM I.
 12131     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12132     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 12133     DIVIDE I INTO TERM3 GIVING A-N.
 12134
 12135 4300-EXIT.
 12136      EXIT.
 12137
 12138 4350-CALC-IA-N.
 12139     IF N LESS 1
 12140         MOVE 0      TO IA-N
 12141         GO TO 4400-EXIT
 12142     END-IF.
 12143
 12144     ADD 1 TO N.
 12145     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12146     SUBTRACT 1 FROM N.
 12147     MULTIPLY N BY V-EX-N GIVING TERM3.
 12148     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 12149     SUBTRACT V FROM 1 GIVING TERM4.
 12150     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 12151
 12152 4400-EXIT.
 12153      EXIT.
 12154
 12155 4450-CALC-V-EX-N.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 231
* EL130.cbl
 12156     IF N LESS 1
 12157         MOVE 1    TO V-EX-N
 12158         GO TO 4490-EXIT
 12159     END-IF.
 12160
 12161     MOVE N        TO NV-STORE.
 12162
 12163     IF V-EX-ONETIME = 1  OR
 12164        V NOT = V-EXPONENT (1)
 12165          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 12166     END-IF.
 12167
 12168 4460-LOOP.
 12169     IF N GREATER 248
 12170         MOVE 248 TO N
 12171     END-IF.
 12172
 12173     IF N = 1
 12174         MOVE V               TO V-EX-N
 12175     ELSE
 12176         MOVE V-EXPONENT (N)  TO V-EX-N
 12177     END-IF.
 12178
 12179     GO TO 4490-EXIT.
 12180
 12181 4470-BUILD-V-EX-TABLE.
 12182     MOVE 2      TO N.
 12183     MOVE V      TO V-EXPONENT (1)
 12184                    V-EX-N.
 12185
 12186 4471-LOOP.
 12187     MULTIPLY V BY V-EX-N.
 12188     MOVE V-EX-N   TO V-EXPONENT (N).
 12189
 12190     ADD 1 TO N.
 12191     IF N LESS 248
 12192         GO TO 4471-LOOP
 12193     END-IF.
 12194
 12195     MOVE NV-STORE     TO N.
 12196     MOVE ZERO         TO V-EX-ONETIME.
 12197
 12198 4480-EXIT.
 12199      EXIT.
 12200
 12201 4490-EXIT.
 12202      EXIT.
 12203
 12204 4500-CALC-NET-TERM.
 12205     MOVE HOLD-LOAN-BAL           TO L.
 12206     MOVE WS-ACVBENE              TO M.
 12207     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 12208
 12209     IF WS-REMAIN GREATER ZERO
 12210         ADD 1 TO N
 12211     END-IF.
 12212
 12213     IF N = 0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 232
* EL130.cbl
 12214         MOVE 1 TO N
 12215     END-IF.
 12216
 12217 4700-EXIT.
 12218      EXIT.
 12219
 12220 4999-CALC-TERM-EXIT.
 12221     EXIT.
 12222
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 233
* EL130.cbl
 12224 5000-INCURRED-CHANGE.
 12225     IF NOT MODIFY-CAP
 12226         MOVE ER-0070            TO EMI-ERROR
 12227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12228         MOVE -1                 TO MAINTL
 12229         GO TO 8200-SEND-DATAONLY
 12230     END-IF.
 12231
 12232     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 12233        CLMCARRI     NOT = PI-LAST-CARR        OR
 12234        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 12235        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 12236        PI-INCURR-SW NOT = 'Y'
 12237          GO TO 1000-SHOW-CLAIM
 12238     END-IF.
 12239
 12240     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 12241     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 12242     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 12243
 12244     IF EMI-NO-ERRORS
 12245         GO TO 5000-TRY-TO-BUILD
 12246     END-IF.
 12247
 12248     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 12249        MOVE ER-0433             TO EMI-ERROR
 12250        MOVE -1                  TO MAINTL
 12251        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12252        GO TO 8200-SEND-DATAONLY
 12253     END-IF.
 12254
 12255     IF EIBAID = DFHPF6
 12256         IF EMI-FATAL-CTR NOT EQUAL ZERO
 12257            MOVE ER-0434         TO EMI-ERROR
 12258            MOVE -1              TO MAINTL
 12259            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12260            GO TO 8200-SEND-DATAONLY
 12261         ELSE
 12262            MOVE +1              TO INCURL
 12263            GO TO 5000-TRY-TO-BUILD
 12264         END-IF
 12265     END-IF.
 12266
 12267     GO TO 8200-SEND-DATAONLY.
 12268
 12269 5000-TRY-TO-BUILD.
 12270
 12271     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 12272
 12273     MOVE CLMCARRI               TO MSTR-CARRIER.
 12274
 12275     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 12276     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 12277     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 12278
 12279     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 12280
 12281     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 234
* EL130.cbl
 12282         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 12283     END-IF.
 12284
 12285     IF CL-PURGED-DT NOT = LOW-VALUES
 12286
 12287
 12288* EXEC CICS UNLOCK
 12289*            DATASET   (ELMSTR-DSID)
 12290*        END-EXEC
 12291*    MOVE '&*                    #   #00011328' TO DFHEIV0
 12292     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12293     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12294     MOVE X'2020233030303131333238' TO DFHEIV0(25:11)
 12295     CALL 'kxdfhei1' USING DFHEIV0,
 12296           ELMSTR-DSID,
 12297           DFHEIV99
 12298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12299         MOVE ER-7691            TO EMI-ERROR
 12300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12301         MOVE -1                 TO MAINTL
 12302         GO TO 8200-SEND-DATAONLY
 12303     END-IF.
 12304
 12305     IF CL-AUTO-PAY-SEQ NOT = ZERO
 12306
 12307
 12308* EXEC CICS UNLOCK
 12309*            DATASET   (ELMSTR-DSID)
 12310*       END-EXEC
 12311*    MOVE '&*                    #   #00011339' TO DFHEIV0
 12312     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12313     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12314     MOVE X'2020233030303131333339' TO DFHEIV0(25:11)
 12315     CALL 'kxdfhei1' USING DFHEIV0,
 12316           ELMSTR-DSID,
 12317           DFHEIV99
 12318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12319         MOVE ER-0523             TO EMI-ERROR
 12320         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12321         MOVE -1                  TO MAINTL
 12322         GO TO 8200-SEND-DATAONLY
 12323     END-IF.
 12324
 12325     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12326
 12327     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12328     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12329     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12330     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12331     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12332
 12333     IF MANRSVL GREATER ZERO
 12334        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12335                                    AT-CURRENT-MANUAL-RESERVE
 12336     END-IF.
 12337     MOVE 1                      TO SUB.
 12338
 12339 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 235
* EL130.cbl
 12340     IF SUB = 1
 12341        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12342        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12343        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12344     ELSE
 12345        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12346        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12347                                    AT-OPEN-CLOSE-REASON (SUB)
 12348     END-IF.
 12349
 12350     IF SUB NOT = 6
 12351        ADD 1                    TO SUB
 12352        GO TO 5010-LOOP
 12353     END-IF.
 12354
 12355 5020-UPDATE.
 12356
 12357     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12358
 12359     IF DIAGL = ZERO
 12360       AND ICD1L = ZERO
 12361       AND ICD2L = ZERO
 12362         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12363         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12364         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12365         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12366         GO TO 5025-BYPASS-UPDATE
 12367     END-IF.
 12368
 12369     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12370
 12371     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12372     IF DIAGL NOT = ZERO
 12373         MOVE DIAGI              TO AT-INFO-LINE-1
 12374     END-IF.
 12375
 12376     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12377     IF ICD1L NOT = ZERO
 12378         MOVE ICD1I              TO AT-ICD-CODE-1
 12379     END-IF.
 12380
 12381     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12382     IF ICD2L NOT = ZERO
 12383         MOVE ICD2I              TO AT-ICD-CODE-2
 12384     END-IF.
 12385
 12386     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12387
 12388 5025-BYPASS-UPDATE.
 12389
 12390
 12391
 12392* EXEC CICS GETMAIN
 12393*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12394*        LENGTH   (ELTRLR-LENGTH)
 12395*    END-EXEC.
 12396*    MOVE '," L                  $   #00011414' TO DFHEIV0
 12397     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 236
* EL130.cbl
 12398     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12399     MOVE X'2020233030303131343134' TO DFHEIV0(25:11)
 12400     CALL 'kxdfhei1' USING DFHEIV0,
 12401           DFHEIV20,
 12402           ELTRLR-LENGTH,
 12403           DFHEIV99
 12404     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12405         DFHEIV20
 12406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12407
 12408
 12409     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12410     MOVE 'AT'                   TO AT-RECORD-ID.
 12411
 12412     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12413     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12414     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12415     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12416     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12417     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12418     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12419     MOVE '9'                    TO AT-TRAILER-TYPE.
 12420     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12421     MOVE '5'                    TO DC-OPTION-CODE.
 12422     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12423     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12424
 12425     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12426     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12427
 12428     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12429     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12430     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12431     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12432     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12433     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12434     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12435     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12436     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12437     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12438     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12439     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12440
 12441     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12442     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12443     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12444     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12445     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12446
 12447
 12448
 12449* EXEC CICS WRITE
 12450*        DATASET   (ELTRLR-DSID)
 12451*        FROM      (ACTIVITY-TRAILERS)
 12452*        RIDFLD    (AT-CONTROL-PRIMARY)
 12453*    END-EXEC.
 12454     MOVE LENGTH OF
 12455      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 237
* EL130.cbl
 12456       TO DFHEIV11
 12457*    MOVE '&$ L                  ''   #00011458' TO DFHEIV0
 12458     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12459     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12460     MOVE X'2020233030303131343538' TO DFHEIV0(25:11)
 12461     CALL 'kxdfhei1' USING DFHEIV0,
 12462           ELTRLR-DSID,
 12463           ACTIVITY-TRAILERS,
 12464           DFHEIV11,
 12465           AT-CONTROL-PRIMARY,
 12466           DFHEIV99,
 12467           DFHEIV99
 12468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12469
 12470
 12471     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12472     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12473     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12474     MOVE CL-CERT-STATE          TO CERT-STATE.
 12475     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12476     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12477     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12478
 12479
 12480
 12481* EXEC CICS HANDLE CONDITION
 12482*        NOTFND   (5050-CERT-NOT-FOUND)
 12483*    END-EXEC.
 12484*    MOVE '"$I                   ! < #00011473' TO DFHEIV0
 12485     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12487     MOVE X'3C20233030303131343733' TO DFHEIV0(25:11)
 12488     CALL 'kxdfhei1' USING DFHEIV0
 12489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12490
 12491
 12492     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12493
 12494     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12495
 12496
 12497
 12498* EXEC CICS HANDLE CONDITION
 12499*         DUPKEY   (5030-CERT-WRITTEN)
 12500*    END-EXEC.
 12501*    MOVE '"$$                   ! = #00011482' TO DFHEIV0
 12502     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12504     MOVE X'3D20233030303131343832' TO DFHEIV0(25:11)
 12505     CALL 'kxdfhei1' USING DFHEIV0
 12506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12507
 12508
 12509
 12510
 12511* EXEC CICS REWRITE
 12512*        DATASET  (ELCERT-DSID)
 12513*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 238
* EL130.cbl
 12514*    END-EXEC.
 12515     MOVE LENGTH OF
 12516      CERTIFICATE-MASTER
 12517       TO DFHEIV11
 12518*    MOVE '&& L                  %   #00011487' TO DFHEIV0
 12519     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12520     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12521     MOVE X'2020233030303131343837' TO DFHEIV0(25:11)
 12522     CALL 'kxdfhei1' USING DFHEIV0,
 12523           ELCERT-DSID,
 12524           CERTIFICATE-MASTER,
 12525           DFHEIV11,
 12526           DFHEIV99
 12527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12528
 12529
 12530 5030-CERT-WRITTEN.
 12531
 12532     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12533                                    CL-INCURRED-DT
 12534                                    CL-REPORTED-DT
 12535                                    CL-EST-END-OF-DISAB-DT
 12536                                    CL-PAID-THRU-DT.
 12537
 12538     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12539                                    CL-NO-OF-PMTS-MADE
 12540                                    CL-NO-OF-DAYS-PAID.
 12541
 12542     IF CLAIM-IS-CLOSED
 12543        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12544        MOVE 'O'                 TO CL-CLAIM-STATUS
 12545     END-IF.
 12546
 12547     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12548     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12549     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12550
 12551
 12552
 12553* EXEC CICS HANDLE CONDITION
 12554*         DUPKEY   (5035-CLAIM-WRITTEN)
 12555*    END-EXEC.
 12556*    MOVE '"$$                   ! > #00011514' TO DFHEIV0
 12557     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12558     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12559     MOVE X'3E20233030303131353134' TO DFHEIV0(25:11)
 12560     CALL 'kxdfhei1' USING DFHEIV0
 12561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12562
 12563
 12564
 12565
 12566* EXEC CICS REWRITE
 12567*        DATASET   (ELMSTR-DSID)
 12568*        FROM      (CLAIM-MASTER)
 12569*    END-EXEC.
 12570     MOVE LENGTH OF
 12571      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 239
* EL130.cbl
 12572       TO DFHEIV11
 12573*    MOVE '&& L                  %   #00011519' TO DFHEIV0
 12574     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12575     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12576     MOVE X'2020233030303131353139' TO DFHEIV0(25:11)
 12577     CALL 'kxdfhei1' USING DFHEIV0,
 12578           ELMSTR-DSID,
 12579           CLAIM-MASTER,
 12580           DFHEIV11,
 12581           DFHEIV99
 12582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12583
 12584
 12585 5035-CLAIM-WRITTEN.
 12586
 12587     MOVE ER-0000                TO EMI-ERROR.
 12588     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12589
 12590     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12591     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12592     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12593     MOVE CLMCARRI               TO PI-LAST-CARR.
 12594
 12595     IF PRTOPTL GREATER ZERO
 12596         MOVE PRTOPTI            TO PI-PRT-OPT
 12597     END-IF.
 12598
 12599     IF ALTPRTL GREATER ZERO
 12600         MOVE ALTPRTI            TO PI-ALT-PRT
 12601     END-IF.
 12602
 12603     MOVE LOW-VALUES             TO EL130AI.
 12604
 12605     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12606     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12607     MOVE PI-LAST-CARR           TO CLMCARRO.
 12608     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12609
 12610     IF PI-PRT-OPT = 'N' OR 'L'
 12611         MOVE PI-PRT-OPT         TO PRTOPTO
 12612         MOVE 1                  TO PRTOPTL
 12613     END-IF.
 12614
 12615     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12616         MOVE PI-ALT-PRT         TO ALTPRTO
 12617         MOVE 4                  TO ALTPRTL
 12618     END-IF.
 12619
 12620     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12621     MOVE AL-SANON               TO CERTNOA SUFXA.
 12622
 12623     MOVE SPACES                 TO PI-INCURR-SW.
 12624
 12625     IF PRTOPTL GREATER ZERO
 12626         IF PRTOPTI = 'L'
 12627             GO TO 0400-CREATE-ELACTQ
 12628         ELSE
 12629             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 240
* EL130.cbl
 12630         END-IF
 12631     END-IF.
 12632
 12633     GO TO 8100-SEND-INITIAL-MAP.
 12634
 12635 5050-CERT-NOT-FOUND.
 12636
 12637     MOVE ER-0244                TO EMI-ERROR.
 12638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12639     MOVE -1                     TO CERTNOL.
 12640     GO TO 8200-SEND-DATAONLY.
 12641
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 241
* EL130.cbl
 12643 5500-BUILD-FORM-TRAILER.
 12644*************************************************************
 12645*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12646*************************************************************
 12647
 12648     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12649
 12650     IF  WS-BEN-ALPHA-2 = '30'
 12651         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12652         MOVE '6'                TO DC-OPTION-CODE
 12653         IF CL-CARRIER = 'C'
 12654             MOVE +14            TO DC-ELAPSED-DAYS
 12655             MOVE +0             TO DC-ELAPSED-MONTHS
 12656             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12657             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12658         ELSE
 12659             MOVE +21            TO DC-ELAPSED-DAYS
 12660             MOVE +0             TO DC-ELAPSED-MONTHS
 12661             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12662             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12663         END-IF
 12664     END-IF.
 12665
 12666
 12667
 12668* EXEC CICS GETMAIN
 12669*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12670*         LENGTH   (ELTRLR-LENGTH)
 12671*         INITIMG  (GETMAIN-SPACE)
 12672*    END-EXEC.
 12673*    MOVE ',"IL                  $   #00011606' TO DFHEIV0
 12674     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12675     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12676     MOVE X'2020233030303131363036' TO DFHEIV0(25:11)
 12677     CALL 'kxdfhei1' USING DFHEIV0,
 12678           DFHEIV20,
 12679           ELTRLR-LENGTH,
 12680           GETMAIN-SPACE
 12681     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12682         DFHEIV20
 12683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12684
 12685
 12686     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12687     MOVE 'AT'                   TO AT-RECORD-ID.
 12688
 12689     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12690     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12691     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12692     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12693                                    AT-FORM-LAST-MAINT-DT.
 12694     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12695                                    AT-FORM-LAST-UPDATED-BY.
 12696     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12697     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12698     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12699                                    AT-FORM-RE-SEND-DT
 12700                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 242
* EL130.cbl
 12701                                    AT-EMP-FORM-ANSWERED-DT
 12702                                    AT-PHY-FORM-ANSWERED-DT
 12703                                    AT-EMP-FORM-SEND-ON-DT
 12704                                    AT-FORM-PRINTED-DT
 12705                                    AT-FORM-REPRINT-DT.
 12706     MOVE '1'                    TO AT-FORM-TYPE.
 12707
 12708     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12709                                    AT-INSTRUCT-LN-2
 12710                                    AT-INSTRUCT-LN-3.
 12711
 12712     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12713     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12714
 12715     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12716
 12717     IF AM-EMPLOYER-STMT-USED = 'Y'
 12718        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12719     END-IF.
 12720
 12721
 12722
 12723* EXEC CICS WRITE
 12724*         DATASET  (ELTRLR-DSID)
 12725*         FROM     (ACTIVITY-TRAILERS)
 12726*         RIDFLD   (AT-CONTROL-PRIMARY)
 12727*    END-EXEC.
 12728     MOVE LENGTH OF
 12729      ACTIVITY-TRAILERS
 12730       TO DFHEIV11
 12731*    MOVE '&$ L                  ''   #00011648' TO DFHEIV0
 12732     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12733     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12734     MOVE X'2020233030303131363438' TO DFHEIV0(25:11)
 12735     CALL 'kxdfhei1' USING DFHEIV0,
 12736           ELTRLR-DSID,
 12737           ACTIVITY-TRAILERS,
 12738           DFHEIV11,
 12739           AT-CONTROL-PRIMARY,
 12740           DFHEIV99,
 12741           DFHEIV99
 12742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12743
 12744
 12745 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 243
* EL130.cbl
 12747*************************************************************
 12748*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12749*************************************************************
 12750
 12751 5700-BUILD-ARCHIVE-HEADER.
 12752
 12753     MOVE '1'                    TO CNTL-REC-TYPE.
 12754     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12755     MOVE SPACES                 TO CNTL-ACCESS.
 12756
 12757
 12758
 12759* EXEC CICS READ
 12760*         DATASET  (ELCNTL-DSID)
 12761*         SET      (ADDRESS OF CONTROL-FILE)
 12762*         RIDFLD   (ELCNTL-KEY)
 12763*         UPDATE
 12764*    END-EXEC.
 12765*    MOVE '&"S        EU         (   #00011667' TO DFHEIV0
 12766     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12767     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12768     MOVE X'2020233030303131363637' TO DFHEIV0(25:11)
 12769     CALL 'kxdfhei1' USING DFHEIV0,
 12770           ELCNTL-DSID,
 12771           DFHEIV20,
 12772           DFHEIV99,
 12773           ELCNTL-KEY,
 12774           DFHEIV99,
 12775           DFHEIV99,
 12776           DFHEIV99
 12777     SET ADDRESS OF CONTROL-FILE TO
 12778         DFHEIV20
 12779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12780
 12781
 12782     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12783
 12784     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12785
 12786
 12787
 12788* EXEC CICS REWRITE
 12789*         FROM     (CONTROL-FILE)
 12790*         DATASET  (ELCNTL-DSID)
 12791*    END-EXEC.
 12792     MOVE LENGTH OF
 12793      CONTROL-FILE
 12794       TO DFHEIV11
 12795*    MOVE '&& L                  %   #00011679' TO DFHEIV0
 12796     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12797     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12798     MOVE X'2020233030303131363739' TO DFHEIV0(25:11)
 12799     CALL 'kxdfhei1' USING DFHEIV0,
 12800           ELCNTL-DSID,
 12801           CONTROL-FILE,
 12802           DFHEIV11,
 12803           DFHEIV99
 12804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 244
* EL130.cbl
 12805
 12806
 12807
 12808
 12809* EXEC CICS HANDLE CONDITION
 12810*         NOTOPEN  (9990-ABEND)
 12811*         DUPKEY   (5799-EXIT)
 12812*    END-EXEC.
 12813*    MOVE '"$J$                  ! ? #00011685' TO DFHEIV0
 12814     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12816     MOVE X'3F20233030303131363835' TO DFHEIV0(25:11)
 12817     CALL 'kxdfhei1' USING DFHEIV0
 12818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12819
 12820
 12821
 12822
 12823* EXEC CICS GETMAIN
 12824*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12825*         LENGTH  (ELARCH-LENGTH)
 12826*    END-EXEC.
 12827*    MOVE '," L                  $   #00011691' TO DFHEIV0
 12828     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12829     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12830     MOVE X'2020233030303131363931' TO DFHEIV0(25:11)
 12831     CALL 'kxdfhei1' USING DFHEIV0,
 12832           DFHEIV20,
 12833           ELARCH-LENGTH,
 12834           DFHEIV99
 12835     SET ADDRESS OF LETTER-ARCHIVE TO
 12836         DFHEIV20
 12837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12838
 12839
 12840     MOVE SPACES                 TO LETTER-ARCHIVE.
 12841     MOVE 'LA'                   TO LA-RECORD-ID.
 12842     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12843                                    LA-ARCHIVE-NO-A1.
 12844     MOVE '4'                    TO LA-RECORD-TYPE
 12845                                    LA-RECORD-TYPE-A1.
 12846     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12847                                    LA-LINE-SEQ-NO-A1.
 12848     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12849                                    LA-COMPANY-CD-A1.
 12850     MOVE CL-CARRIER             TO LA4-CARRIER.
 12851     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12852     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12853     MOVE CL-CERT-STATE          TO LA4-STATE.
 12854     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12855     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12856     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12857     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12858                                    LA4-RESEND-PRINT-DATE
 12859                                    LA4-FORM-REM-PRINT-DT
 12860                                    LA4-RESEND-DATE.
 12861     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12862     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 245
* EL130.cbl
 12863
 12864
 12865
 12866* EXEC CICS WRITE
 12867*         DATASET  (ELARCH-DSID)
 12868*         FROM     (LETTER-ARCHIVE)
 12869*         RIDFLD   (LA-CONTROL-PRIMARY)
 12870*    END-EXEC.
 12871     MOVE LENGTH OF
 12872      LETTER-ARCHIVE
 12873       TO DFHEIV11
 12874*    MOVE '&$ L                  ''   #00011721' TO DFHEIV0
 12875     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12876     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12877     MOVE X'2020233030303131373231' TO DFHEIV0(25:11)
 12878     CALL 'kxdfhei1' USING DFHEIV0,
 12879           ELARCH-DSID,
 12880           LETTER-ARCHIVE,
 12881           DFHEIV11,
 12882           LA-CONTROL-PRIMARY,
 12883           DFHEIV99,
 12884           DFHEIV99
 12885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12886
 12887
 12888 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 246
* EL130.cbl
 12890 6000-EDIT-CLAIM-DATA.
 12891
 12892     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12893     MOVE '2'                    TO DC-OPTION-CODE.
 12894     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12895     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12896
 12897     IF MAINTL NOT = ZERO
 12898         MOVE AL-UANON           TO MAINTA
 12899     END-IF
 12900
 12901     IF CLMNOL GREATER ZERO
 12902         IF CLMNOI = SPACES OR LOW-VALUES
 12903             MOVE -1             TO CLMNOL
 12904             MOVE AL-UABON       TO CLMNOA
 12905             MOVE ER-7688        TO EMI-ERROR
 12906             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12907         ELSE
 12908             MOVE AL-UANON       TO CLMNOA
 12909         END-IF
 12910     END-IF.
 12911
 12912     IF CERTNOL = ZERO
 12913         MOVE -1                 TO CERTNOL
 12914         MOVE AL-SABON           TO CERTNOA
 12915         MOVE ER-0203            TO EMI-ERROR
 12916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12917     ELSE
 12918         MOVE AL-SANON           TO CERTNOA
 12919     END-IF.
 12920
 12921     IF SUFXL = ZERO
 12922         MOVE SPACES             TO SUFXI
 12923         MOVE AL-SANON           TO SUFXA
 12924     ELSE
 12925         MOVE AL-SANON           TO SUFXA
 12926     END-IF.
 12927
 12928     IF CLMCARRL = ZERO
 12929         MOVE -1                 TO CLMCARRL
 12930         MOVE ER-0194            TO EMI-ERROR
 12931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12932     ELSE
 12933         MOVE CLMCARRI           TO PI-CARRIER
 12934         IF PI-NO-CARRIER-SECURITY
 12935             MOVE AL-UANON       TO CLMCARRA
 12936         END-IF
 12937     END-IF.
 12938
 12939     IF CLMTYPEL > ZERO
 12940        IF ((PI-COMPANY-ID = 'DCC' OR 'VPP')
 12941           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 12942              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G' AND 'F'))
 12943                        OR
 12944           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12945           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1 AND 'O'
 12946              AND PI-AH-OVERRIDE-L1))
 12947              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 247
* EL130.cbl
 12948              MOVE AL-UABON       TO CLMTYPEA
 12949              MOVE ER-7634        TO EMI-ERROR
 12950              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12951        ELSE
 12952           MOVE AL-UANON       TO CLMTYPEA
 12953        END-IF
 12954     ELSE
 12955        IF MAINTI = 'A'
 12956           MOVE -1             TO CLMTYPEL
 12957           MOVE AL-UABON       TO CLMTYPEA
 12958           MOVE ER-0546        TO EMI-ERROR
 12959           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12960        END-IF
 12961     END-IF
 12962     if instypel > ZERO
 12963        if instypei = 'P' OR 'C'
 12964           move al-uanon         to instypea
 12965        else
 12966           MOVE -1               TO INSTYPEL
 12967           MOVE AL-UABON         TO INSTYPEA
 12968           MOVE ER-1654          TO EMI-ERROR
 12969           PERFORM 9900-ERROR-FORMAT
 12970                                 THRU 9900-EXIT
 12971        END-IF
 12972     ELSE
 12973        IF MAINTI = 'A'
 12974           MOVE -1               TO INSTYPEL
 12975           MOVE AL-UABON         TO INSTYPEA
 12976           MOVE ER-1654          TO EMI-ERROR
 12977           PERFORM 9900-ERROR-FORMAT
 12978                                 THRU 9900-EXIT
 12979        END-IF
 12980     END-IF
 12981     if (instypel <> zeros)
 12982        and (emi-error not = er-1654)
 12983        and (instypei = 'C')
 12984        and (crtfnmei = fstnmei)
 12985        move er-1675             to emi-error
 12986        MOVE -1                  TO INSTYPEL
 12987        MOVE AL-UABON            TO INSTYPEA
 12988        PERFORM 9900-ERROR-FORMAT
 12989                                 THRU 9900-EXIT
 12990    end-if
 12991     if (instypel <> zeros)
 12992        and (emi-error not = er-1654)
 12993        and (instypei = 'P')
 12994        and (crtfnmei <> fstnmei)
 12995        move er-1676             to emi-error
 12996        MOVE -1                  TO INSTYPEL
 12997        MOVE AL-UABON            TO INSTYPEA
 12998        PERFORM 9900-ERROR-FORMAT
 12999                                 THRU 9900-EXIT
 13000    end-if
 13001     IF PCERTNOL = ZERO
 13002        MOVE CERTNOI             TO PCERTNOI
 13003        MOVE CERTNOL             TO PCERTNOL
 13004        MOVE AL-UANON            TO PCERTNOA
 13005     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 248
* EL130.cbl
 13006        MOVE AL-UANON            TO PCERTNOA
 13007     END-IF.
 13008
 13009     IF PSUFXL = ZERO
 13010        MOVE SUFXI               TO PSUFXI
 13011        MOVE SUFXL               TO PSUFXL
 13012        MOVE AL-UANON            TO PSUFXA
 13013     ELSE
 13014        MOVE AL-UANON            TO PSUFXA
 13015     END-IF.
 13016
 13017     IF MAINTI = 'I'
 13018         GO TO 6020-EDIT
 13019     END-IF.
 13020
 13021     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 13022         MOVE -1                 TO LSTNMEL
 13023         MOVE ER-0236            TO EMI-ERROR
 13024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13025     ELSE
 13026         MOVE AL-UANON           TO LSTNMEA
 13027     END-IF.
 13028     if fstnmel not = zeros
 13029        move al-uanon            to fstnmea
 13030     end-if
 13031     IF SEXL > ZEROS
 13032        IF SEXI = 'M' OR 'F'
 13033           move al-uanon         to sexa
 13034           CONTINUE
 13035        ELSE
 13036           MOVE -1               TO SEXL
 13037           MOVE AL-UABON         TO SEXA
 13038           MOVE ER-0219          TO EMI-ERROR
 13039           PERFORM 9900-ERROR-FORMAT
 13040                                 THRU 9900-EXIT
 13041        END-IF
 13042     ELSE
 13043        IF MAINTI = 'A'
 13044           MOVE -1               TO SEXL
 13045           MOVE AL-UABON         TO SEXA
 13046           MOVE ER-0219          TO EMI-ERROR
 13047           PERFORM 9900-ERROR-FORMAT
 13048                                 THRU 9900-EXIT
 13049        END-IF
 13050     END-IF
 13051     IF SSNL GREATER THAN ZERO
 13052         MOVE SSNI TO WS-SOC-SEC-NUMBER
 13053         IF WS-SOC-SEC-NO NUMERIC AND
 13054           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 13055             NEXT SENTENCE
 13056         ELSE
 13057            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 13058               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 13059               WS-SSN-DASH2 = '-'
 13060                 NEXT SENTENCE
 13061            ELSE
 13062                 MOVE ER-0887        TO  EMI-ERROR
 13063                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 249
* EL130.cbl
 13064                 MOVE AL-UABON       TO  SSNA
 13065                 MOVE -1             TO  SSNL
 13066            END-IF
 13067        END-IF
 13068     END-IF.
 13069
 13070     IF BIRTHDTL = ZERO
 13071         GO TO 6020-EDIT
 13072     END-IF.
 13073
 13074     IF BIRTHDTL GREATER ZERO
 13075         MOVE BIRTHDTI           TO DATE-WORK
 13076         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13077         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13078         MOVE '4'                TO DC-OPTION-CODE
 13079         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13080         IF DATE-CONVERSION-ERROR
 13081             MOVE AL-UABON       TO BIRTHDTA
 13082             MOVE -1             TO BIRTHDTL
 13083             MOVE ER-0220        TO EMI-ERROR
 13084             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13085             GO TO 6020-EDIT
 13086         END-IF
 13087     END-IF.
 13088
 13089******************************************************************
 13090**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 13091**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 13092**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 13093******************************************************************
 13094
 13095     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 13096         MOVE BIRTHDTI           TO  DATE-WORK
 13097         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13098         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 13099         MOVE '4'                TO  DC-OPTION-CODE
 13100         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 13101         MOVE +0                 TO  DC-ELAPSED-MONTHS
 13102                                     DC-ELAPSED-DAYS
 13103         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13104         IF DATE-CONVERSION-ERROR
 13105             MOVE AL-UABON       TO  BIRTHDTA
 13106             MOVE -1             TO  BIRTHDTL
 13107             MOVE ER-0220        TO  EMI-ERROR
 13108             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13109             GO TO 6020-EDIT
 13110         END-IF
 13111     END-IF.
 13112
 13113     MOVE AL-UANON               TO  BIRTHDTA.
 13114     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 13115     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 13116     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 13117
 13118 6020-EDIT.
 13119     IF INCURL GREATER ZERO
 13120         MOVE INCURI             TO DATE-WORK
 13121         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 250
* EL130.cbl
 13122         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13123         MOVE '4'                TO DC-OPTION-CODE
 13124         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13125         IF DATE-CONVERSION-ERROR
 13126             MOVE AL-UABON       TO INCURA
 13127             MOVE -1             TO INCURL
 13128             MOVE ER-0222        TO EMI-ERROR
 13129             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13130         ELSE
 13131             MOVE AL-UANON       TO INCURA
 13132             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 13133             MOVE DC-BIN-DATE-1  TO WS-INCUR
 13134                                    PI-SAVE-INCUR-DT
 13135             IF WS-INCUR GREATER THAN WS-TODAY-DT
 13136                 MOVE ER-0511     TO EMI-ERROR
 13137                 MOVE -1          TO INCURL
 13138                 MOVE AL-UABON    TO INCURA
 13139                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13140             ELSE
 13141*                NEXT SENTENCE
 13142                 CONTINUE
 13143             END-IF
 13144         END-IF
 13145     ELSE
 13146         MOVE ER-0516         TO EMI-ERROR
 13147         MOVE AL-UABON        TO INCURA
 13148         MOVE -1              TO INCURL
 13149         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13150     END-IF.
 13151
 13152     IF REPORTL GREATER ZERO
 13153         MOVE REPORTI            TO DATE-WORK
 13154         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13155         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13156         MOVE '4'                TO DC-OPTION-CODE
 13157         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13158         IF DATE-CONVERSION-ERROR
 13159             MOVE AL-UABON       TO REPORTA
 13160             MOVE -1             TO REPORTL
 13161             MOVE ER-0223        TO EMI-ERROR
 13162             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13163         ELSE
 13164             MOVE AL-UANON       TO REPORTA
 13165             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 13166             MOVE DC-BIN-DATE-1  TO WS-REPORT
 13167             IF WS-REPORT GREATER THAN WS-TODAY-DT
 13168                 MOVE ER-0512     TO EMI-ERROR
 13169                 MOVE -1          TO REPORTL
 13170                 MOVE AL-UABON    TO REPORTA
 13171                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13172             ELSE
 13173*                NEXT SENTENCE
 13174                 CONTINUE
 13175             END-IF
 13176         END-IF
 13177     ELSE
 13178         MOVE ER-0517         TO EMI-ERROR
 13179         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 251
* EL130.cbl
 13180         MOVE AL-UABON        TO REPORTA
 13181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13182     END-IF.
 13183
 13184     IF WS-REPORT NOT = LOW-VALUES
 13185         IF WS-INCUR GREATER THAN WS-REPORT
 13186             MOVE AL-UABON       TO REPORTA
 13187             MOVE -1             TO REPORTL
 13188             MOVE ER-0509        TO EMI-ERROR
 13189             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13190         END-IF
 13191     END-IF.
 13192
 13193     IF ICD1L GREATER THAN ZERO
 13194         IF (ICD1I GREATER THAN SPACES) AND
 13195            (ICD1I(4:1) NOT = '.')
 13196             IF ICD1I(4:1) = ' '
 13197                 MOVE '.' TO ICD1I(4:1)
 13198             ELSE
 13199                 IF ICD1I(8:1) = ' '
 13200                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 13201                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 13202                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 13203                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 13204                     MOVE '.'        TO ICD1I(4:1)
 13205                 END-IF
 13206             END-IF
 13207         END-IF
 13208         IF (ICD1I GREATER THAN SPACES) AND
 13209            (ICD1I(1:1) NOT > ' ' OR
 13210             ICD1I(2:1) NOT > ' ' OR
 13211             ICD1I(3:1) NOT > ' ' OR
 13212             ICD1I(4:1) NOT = '.')
 13213              MOVE ER-0992        TO  EMI-ERROR
 13214              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13215              MOVE AL-UABON       TO ICD1A
 13216              MOVE -1             TO ICD1L
 13217         END-IF
 13218     END-IF.
 13219
 13220     IF ICD2L GREATER THAN ZERO
 13221         IF (ICD2I GREATER THAN SPACES) AND
 13222            (ICD2I(4:1) NOT = '.')
 13223             IF ICD2I(4:1) = ' '
 13224                 MOVE '.' TO ICD2I(4:1)
 13225             ELSE
 13226                 IF ICD2I(8:1) = ' '
 13227                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 13228                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 13229                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 13230                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 13231                     MOVE '.'        TO ICD2I(4:1)
 13232                 END-IF
 13233             END-IF
 13234         END-IF
 13235         IF (ICD2I GREATER THAN SPACES) AND
 13236            (ICD2I(1:1) NOT > ' ' OR
 13237             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 252
* EL130.cbl
 13238             ICD2I(3:1) NOT > ' ' OR
 13239             ICD2I(4:1) NOT = '.')
 13240              MOVE ER-0992        TO  EMI-ERROR
 13241              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13242              MOVE AL-UABON       TO ICD2A
 13243              MOVE -1             TO ICD2L
 13244         END-IF
 13245     END-IF
 13246
 13247*    IF ESTENDL GREATER ZERO
 13248*        MOVE ESTENDI            TO DATE-WORK
 13249*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13250*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13251*        MOVE '4'                TO DC-OPTION-CODE
 13252*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13253*        IF DATE-CONVERSION-ERROR
 13254*            MOVE AL-UABON       TO ESTENDA
 13255*            MOVE -1             TO ESTENDL
 13256*            MOVE ER-0224        TO EMI-ERROR
 13257*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13258*        ELSE
 13259*            MOVE AL-UANON       TO ESTENDA
 13260*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 13261*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 13262*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13263*               MOVE AL-UABON    TO ESTENDA
 13264*               MOVE -1          TO ESTENDL
 13265*               MOVE ER-0544     TO EMI-ERROR
 13266*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13267*            END-IF
 13268*        END-IF
 13269*    END-IF.
 13270*
 13271*    IF WS-ESTEND NOT = LOW-VALUES
 13272*        IF WS-INCUR GREATER THAN WS-ESTEND
 13273*            MOVE AL-UABON       TO ESTENDA
 13274*            MOVE -1             TO ESTENDL
 13275*            MOVE ER-0510        TO EMI-ERROR
 13276*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13277*        END-IF
 13278*    END-IF.
 13279
 13280     IF PRTOPTL GREATER ZERO
 13281         IF PRTOPTI NOT = 'N' AND 'L'
 13282             MOVE AL-UABON       TO PRTOPTA
 13283             MOVE -1             TO PRTOPTL
 13284             MOVE ER-0334        TO EMI-ERROR
 13285             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13286         END-IF
 13287     END-IF.
 13288
 13289     IF MANRSVL GREATER ZERO
 13290
 13291* EXEC CICS BIF DEEDIT
 13292*            FIELD   (MANRSVI)
 13293*            LENGTH  (9)
 13294*        END-EXEC
 13295     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 253
* EL130.cbl
 13296       TO DFHEIV11
 13297*    MOVE '@"L                   #   #00012129' TO DFHEIV0
 13298     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13299     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13300     MOVE X'2020233030303132313239' TO DFHEIV0(25:11)
 13301     CALL 'kxdfhei1' USING DFHEIV0,
 13302           MANRSVI,
 13303           DFHEIV11
 13304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13305         IF MANRSVI NOT NUMERIC
 13306             MOVE AL-UNBON       TO MANRSVA
 13307             MOVE -1             TO MANRSVL
 13308             MOVE ER-0489        TO EMI-ERROR
 13309             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13310         ELSE
 13311             MOVE AL-UNNON       TO MANRSVA
 13312             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 13313         END-IF
 13314     END-IF.
 13315
 13316     MOVE SPACES                 TO ELCNTL-KEY.
 13317
 13318     IF CONTROL-IS-ACTUAL-CARRIER
 13319         MOVE PI-CARRIER         TO CNTL-CARRIER
 13320     ELSE
 13321         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13322     END-IF.
 13323
 13324     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13325     MOVE '6'                    TO CNTL-REC-TYPE.
 13326     MOVE +0                     TO CNTL-SEQ-NO.
 13327
 13328
 13329
 13330* EXEC CICS HANDLE CONDITION
 13331*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13332*    END-EXEC.
 13333*    MOVE '"$I                   ! @ #00012157' TO DFHEIV0
 13334     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13336     MOVE X'4020233030303132313537' TO DFHEIV0(25:11)
 13337     CALL 'kxdfhei1' USING DFHEIV0
 13338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13339
 13340
 13341     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13342
 13343     IF NOT CF-MANUAL-RESERVES-USED AND
 13344           WS-MANRSV GREATER ZERO
 13345         MOVE ER-0518             TO EMI-ERROR
 13346         MOVE -1                  TO MANRSVL
 13347         MOVE AL-UNBON            TO MANRSVA
 13348         MOVE ZEROS               TO WS-MANRSV
 13349         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13350     END-IF.
 13351
 13352     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13353     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 254
* EL130.cbl
 13354
 13355     IF SUPVL GREATER ZERO
 13356         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13357             MOVE -1             TO SUPVL
 13358             MOVE AL-UABON       TO SUPVA
 13359             MOVE ER-0230        TO EMI-ERROR
 13360             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13361         ELSE
 13362             MOVE AL-UANON       TO SUPVA
 13363         END-IF
 13364     END-IF.
 13365
 13366     IF PROCCDL = ZERO
 13367        GO TO 6050-CONTINUE-EDITS
 13368     END-IF.
 13369
 13370     MOVE SPACES                 TO ELCNTL-KEY.
 13371     MOVE PROCCDI                TO CNTL-ACCESS.
 13372
 13373     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13374     MOVE '2'                    TO CNTL-REC-TYPE.
 13375     MOVE +0                     TO CNTL-SEQ-NO.
 13376
 13377
 13378
 13379* EXEC CICS HANDLE CONDITION
 13380*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13381*    END-EXEC.
 13382*    MOVE '"$I                   ! A #00012198' TO DFHEIV0
 13383     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13385     MOVE X'4120233030303132313938' TO DFHEIV0(25:11)
 13386     CALL 'kxdfhei1' USING DFHEIV0
 13387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13388
 13389
 13390     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13391
 13392     GO TO 6050-CONTINUE-EDITS.
 13393
 13394 6040-NO-PROCESSOR-RECORD.
 13395     MOVE ER-0019                TO EMI-ERROR.
 13396     MOVE -1                     TO PROCCDL.
 13397     MOVE AL-UABON               TO PROCCDA.
 13398     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13399
 13400 6050-CONTINUE-EDITS.
 13401     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13402           GO TO 6070-CONTINUE-EDITS
 13403     END-IF.
 13404
 13405     MOVE BENECDI                TO BENE-CODE.
 13406     MOVE 'B'                    TO BENE-RCD-TYPE.
 13407     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13408
 13409
 13410
 13411* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 255
* EL130.cbl
 13412*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13413*    END-EXEC.
 13414*    MOVE '"$I                   ! B #00012222' TO DFHEIV0
 13415     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13417     MOVE X'4220233030303132323232' TO DFHEIV0(25:11)
 13418     CALL 'kxdfhei1' USING DFHEIV0
 13419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13420
 13421
 13422
 13423* EXEC CICS READ
 13424*         DATASET   (ELBENE-DSID)
 13425*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13426*         RIDFLD    (ELBENE-KEY)
 13427*    END-EXEC.
 13428*    MOVE '&"S        E          (   #00012226' TO DFHEIV0
 13429     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13431     MOVE X'2020233030303132323236' TO DFHEIV0(25:11)
 13432     CALL 'kxdfhei1' USING DFHEIV0,
 13433           ELBENE-DSID,
 13434           DFHEIV20,
 13435           DFHEIV99,
 13436           ELBENE-KEY,
 13437           DFHEIV99,
 13438           DFHEIV99,
 13439           DFHEIV99
 13440     SET ADDRESS OF BENEFICIARY-MASTER TO
 13441         DFHEIV20
 13442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13443
 13444
 13445     GO TO 6070-CONTINUE-EDITS.
 13446
 13447 6060-NO-BENEFICIARY-RECORD.
 13448     MOVE ER-0565                TO EMI-ERROR.
 13449     MOVE -1                     TO BENECDL.
 13450     MOVE AL-UABON               TO BENECDA.
 13451     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13452
 13453
 13454 6070-CONTINUE-EDITS.
 13455     IF CERTMTL GREATER ZERO
 13456         IF CERTMTI NOT = 'A' AND 'S'
 13457             MOVE -1             TO CERTMTL
 13458             MOVE AL-UABON       TO CERTMTA
 13459             MOVE ER-0267        TO EMI-ERROR
 13460             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13461         ELSE
 13462             MOVE AL-UANON       TO CERTMTA
 13463         END-IF
 13464     ELSE
 13465         GO TO 6000-EXIT
 13466     END-IF.
 13467
 13468     IF EFFDTL GREATER ZERO
 13469         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 256
* EL130.cbl
 13470         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13471         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13472         MOVE '4'                TO DC-OPTION-CODE
 13473         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13474         IF DATE-CONVERSION-ERROR
 13475             MOVE AL-UABON       TO EFFDTA
 13476             MOVE -1             TO EFFDTL
 13477             MOVE ER-0231        TO EMI-ERROR
 13478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13479         ELSE
 13480             MOVE AL-UANON       TO EFFDTA
 13481             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13482             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13483         END-IF
 13484     ELSE
 13485         MOVE ER-0231            TO EMI-ERROR
 13486         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13487         MOVE -1                 TO EFFDTL
 13488         MOVE AL-UABON           TO EFFDTA
 13489     END-IF.
 13490
 13491     IF ACCOUNTL = ZERO
 13492         MOVE ER-0232            TO EMI-ERROR
 13493         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13494         MOVE AL-UABON           TO ACCOUNTA
 13495         MOVE -1                 TO ACCOUNTL
 13496     ELSE
 13497         MOVE AL-UANON           TO ACCOUNTA
 13498     END-IF.
 13499
 13500     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13501        (STATEL = ZERO)
 13502         MOVE ER-0233        TO EMI-ERROR
 13503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13504         MOVE AL-UABON       TO STATEA
 13505         MOVE -1             TO STATEL
 13506     ELSE
 13507         MOVE AL-UANON       TO STATEA
 13508     END-IF.
 13509
 13510     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13511        (CRTCARRL = ZERO)
 13512         MOVE ER-0234        TO EMI-ERROR
 13513         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13514         MOVE AL-UABON       TO CRTCARRA
 13515         MOVE -1             TO CRTCARRL
 13516     ELSE
 13517         MOVE AL-UANON       TO CRTCARRA
 13518     END-IF.
 13519
 13520     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13521        GROUPL = ZERO
 13522         MOVE ER-0235            TO EMI-ERROR
 13523         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13524         MOVE AL-UABON           TO GROUPA
 13525         MOVE -1                 TO GROUPL
 13526     ELSE
 13527         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 257
* EL130.cbl
 13528     END-IF.
 13529
 13530     IF CRTLNMEL = ZERO
 13531         IF LSTNMEI = SPACES OR LOW-VALUES
 13532             MOVE ER-0236            TO  EMI-ERROR
 13533             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13534             MOVE AL-UABON           TO  CRTLNMEA
 13535             MOVE -1                 TO  CRTLNMEL
 13536         ELSE
 13537             MOVE LSTNMEI            TO  CRTLNMEI
 13538             MOVE AL-UANON           TO  CRTLNMEA
 13539         END-IF
 13540     ELSE
 13541         MOVE AL-UANON               TO  CRTLNMEA
 13542     END-IF.
 13543
 13544     IF CRTFNMEL = ZERO
 13545         IF FSTNMEI = SPACES OR LOW-VALUES
 13546*            NEXT SENTENCE
 13547             CONTINUE
 13548         ELSE
 13549             MOVE FSTNMEI            TO  CRTFNMEI
 13550             MOVE AL-UANON           TO  CRTFNMEA
 13551         END-IF
 13552     END-IF.
 13553
 13554     IF CRTINITL = ZERO
 13555         IF INITI = SPACES OR LOW-VALUES
 13556*            NEXT SENTENCE
 13557             CONTINUE
 13558         ELSE
 13559             MOVE INITI              TO  CRTINITI
 13560             MOVE AL-UANON           TO  CRTINITA
 13561         END-IF
 13562     END-IF.
 13563
 13564 6000-EXIT.
 13565     EXIT.
 13566
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 258
* EL130.cbl
 13568 6200-EDIT-CERT-DATA.
 13569     IF ISSAGEL GREATER ZERO
 13570         IF ISSAGEI NOT NUMERIC
 13571             MOVE ER-0237        TO EMI-ERROR
 13572             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13573             MOVE -1             TO ISSAGEL
 13574             MOVE AL-UNBON       TO ISSAGEA
 13575         ELSE
 13576             MOVE AL-UNNON       TO ISSAGEA
 13577         END-IF
 13578     END-IF.
 13579
 13580     IF JNTAGEL GREATER ZERO
 13581         IF JNTAGEI NOT NUMERIC
 13582             MOVE ER-0238        TO EMI-ERROR
 13583             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13584             MOVE -1             TO JNTAGEL
 13585             MOVE AL-UNBON       TO JNTAGEA
 13586         ELSE
 13587             MOVE AL-UNNON       TO JNTAGEA
 13588         END-IF
 13589     END-IF.
 13590
 13591     IF LCVCDL GREATER ZERO
 13592         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13593         IF INVALID-BENEFIT-CODE
 13594             MOVE ER-7635        TO EMI-ERROR
 13595             MOVE -1             TO LCVCDL
 13596             MOVE AL-UABON       TO LCVCDA
 13597             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13598         ELSE
 13599             MOVE LCVCDI         TO WS-BEN-HOLD
 13600             MOVE '4'            TO WS-REC-TYPE
 13601             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13602             IF WS-BEN-ALPHA-HOLD = SPACES
 13603                MOVE ER-7635     TO EMI-ERROR
 13604                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13605                MOVE -1          TO LCVCDL
 13606                MOVE AL-UABON    TO LCVCDA
 13607             ELSE
 13608                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13609                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13610                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13611                MOVE AL-UANON           TO LCVCDA
 13612             END-IF
 13613         END-IF
 13614     END-IF.
 13615
 13616     IF ACVCDL GREATER ZERO
 13617         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13618         IF INVALID-BENEFIT-CODE
 13619             MOVE ER-7635        TO EMI-ERROR
 13620             MOVE -1             TO ACVCDL
 13621             MOVE AL-UABON       TO ACVCDA
 13622             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13623         ELSE
 13624             MOVE ACVCDI         TO WS-BEN-HOLD
 13625             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 259
* EL130.cbl
 13626             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13627             IF WS-BEN-ALPHA-HOLD = SPACES
 13628                MOVE ER-7635     TO EMI-ERROR
 13629                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13630                MOVE -1          TO ACVCDL
 13631                MOVE AL-UABON    TO ACVCDA
 13632             ELSE
 13633                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13634                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13635                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13636                MOVE AL-UANON           TO ACVCDA
 13637             END-IF
 13638         END-IF
 13639     END-IF.
 13640
 13641     IF LCVOTRML GREATER ZERO
 13642         IF LCVOTRMI NOT NUMERIC
 13643             MOVE ER-7636        TO EMI-ERROR
 13644             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13645             MOVE -1             TO LCVOTRML
 13646             MOVE AL-UNBON       TO LCVOTRMA
 13647         ELSE
 13648             MOVE AL-UNNON       TO LCVOTRMA
 13649         END-IF
 13650     END-IF.
 13651
 13652     IF ACVOTRML GREATER ZERO
 13653         IF ACVOTRMI NOT NUMERIC
 13654             MOVE ER-7636        TO EMI-ERROR
 13655             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13656             MOVE -1             TO ACVOTRML
 13657             MOVE AL-UNBON       TO ACVOTRMA
 13658         ELSE
 13659             MOVE AL-UNNON       TO ACVOTRMA
 13660         END-IF
 13661     END-IF.
 13662
 13663     IF LCVRATEL GREATER ZERO
 13664
 13665* EXEC CICS BIF DEEDIT
 13666*            FIELD    (LCVRATEI)
 13667*            LENGTH   (06)
 13668*        END-EXEC
 13669     MOVE 06
 13670       TO DFHEIV11
 13671*    MOVE '@"L                   #   #00012451' TO DFHEIV0
 13672     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13673     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13674     MOVE X'2020233030303132343531' TO DFHEIV0(25:11)
 13675     CALL 'kxdfhei1' USING DFHEIV0,
 13676           LCVRATEI,
 13677           DFHEIV11
 13678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13679         IF LCVRATEI NOT NUMERIC
 13680             MOVE AL-UNBON       TO LCVRATEA
 13681             MOVE -1             TO LCVRATEL
 13682             MOVE ER-2280        TO EMI-ERROR
 13683             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 260
* EL130.cbl
 13684         ELSE
 13685             MOVE AL-UNNON       TO LCVRATEA
 13686             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13687         END-IF
 13688     END-IF.
 13689
 13690     IF ACVRATEL GREATER ZERO
 13691
 13692* EXEC CICS BIF DEEDIT
 13693*            FIELD    (ACVRATEI)
 13694*            LENGTH   (06)
 13695*        END-EXEC
 13696     MOVE 06
 13697       TO DFHEIV11
 13698*    MOVE '@"L                   #   #00012467' TO DFHEIV0
 13699     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13700     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13701     MOVE X'2020233030303132343637' TO DFHEIV0(25:11)
 13702     CALL 'kxdfhei1' USING DFHEIV0,
 13703           ACVRATEI,
 13704           DFHEIV11
 13705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13706         IF ACVRATEI NOT NUMERIC
 13707             MOVE AL-UNBON       TO ACVRATEA
 13708             MOVE -1             TO ACVRATEL
 13709             MOVE ER-2280        TO EMI-ERROR
 13710             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13711         ELSE
 13712             MOVE AL-UNNON       TO ACVRATEA
 13713             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13714         END-IF
 13715     END-IF.
 13716
 13717     IF LCVBENEL GREATER ZERO
 13718
 13719* EXEC CICS BIF DEEDIT
 13720*            FIELD    (LCVBENEI)
 13721*            LENGTH   (11)
 13722*        END-EXEC
 13723     MOVE 11
 13724       TO DFHEIV11
 13725*    MOVE '@"L                   #   #00012483' TO DFHEIV0
 13726     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13727     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13728     MOVE X'2020233030303132343833' TO DFHEIV0(25:11)
 13729     CALL 'kxdfhei1' USING DFHEIV0,
 13730           LCVBENEI,
 13731           DFHEIV11
 13732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13733         IF LCVBENEI NOT NUMERIC
 13734             MOVE AL-UNBON       TO LCVBENEA
 13735             MOVE -1             TO LCVBENEL
 13736             MOVE ER-7637        TO EMI-ERROR
 13737             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13738         ELSE
 13739             MOVE AL-UNNON       TO LCVBENEA
 13740             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13741         END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 261
* EL130.cbl
 13742     END-IF.
 13743
 13744     IF ACVBENEL GREATER ZERO
 13745
 13746* EXEC CICS BIF DEEDIT
 13747*            FIELD    (ACVBENEI)
 13748*            LENGTH   (11)
 13749*        END-EXEC
 13750     MOVE 11
 13751       TO DFHEIV11
 13752*    MOVE '@"L                   #   #00012499' TO DFHEIV0
 13753     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13754     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13755     MOVE X'2020233030303132343939' TO DFHEIV0(25:11)
 13756     CALL 'kxdfhei1' USING DFHEIV0,
 13757           ACVBENEI,
 13758           DFHEIV11
 13759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13760         IF ACVBENEI NOT NUMERIC
 13761             MOVE AL-UNBON       TO ACVBENEA
 13762             MOVE -1             TO ACVBENEL
 13763             MOVE ER-7637        TO EMI-ERROR
 13764             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13765         ELSE
 13766             MOVE AL-UNNON       TO ACVBENEA
 13767             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13768         END-IF
 13769     END-IF.
 13770
 13771     IF LCVCNDTL GREATER ZERO
 13772         IF LCVCNDTI NOT = SPACES
 13773             MOVE LCVCNDTI        TO DATE-WORK
 13774             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13775             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13776             MOVE '4'             TO DC-OPTION-CODE
 13777             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13778             IF DATE-CONVERSION-ERROR
 13779                 MOVE AL-UABON    TO LCVCNDTA
 13780                 MOVE -1          TO LCVCNDTL
 13781                 MOVE ER-7638     TO EMI-ERROR
 13782                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13783             ELSE
 13784                 MOVE AL-UANON    TO LCVCNDTA
 13785                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13786                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13787             END-IF
 13788         END-IF
 13789     END-IF.
 13790
 13791     IF ACVCNDTL GREATER ZERO
 13792         IF ACVCNDTI NOT = SPACES
 13793             MOVE ACVCNDTI        TO DATE-WORK
 13794             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13795             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13796             MOVE '4'             TO DC-OPTION-CODE
 13797             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13798             IF DATE-CONVERSION-ERROR
 13799                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 262
* EL130.cbl
 13800                 MOVE -1          TO ACVCNDTL
 13801                 MOVE ER-7638     TO EMI-ERROR
 13802                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13803             ELSE
 13804                 MOVE AL-UANON    TO ACVCNDTA
 13805                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13806                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13807             END-IF
 13808         END-IF
 13809     END-IF.
 13810
 13811     IF ADDONDTL GREATER ZERO
 13812         MOVE ADDONDTI        TO DATE-WORK
 13813         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13814         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13815         MOVE '4'             TO DC-OPTION-CODE
 13816         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13817         IF DATE-CONVERSION-ERROR
 13818             MOVE AL-UABON    TO ADDONDTA
 13819             MOVE -1          TO ADDONDTL
 13820             MOVE ER-7651     TO EMI-ERROR
 13821             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13822         ELSE
 13823             MOVE AL-UANON    TO ADDONDTA
 13824             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13825             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13826         END-IF
 13827     END-IF.
 13828
 13829     IF APRL GREATER ZERO
 13830
 13831* EXEC CICS BIF DEEDIT
 13832*            FIELD    (APRI)
 13833*            LENGTH   (8)
 13834*        END-EXEC
 13835     MOVE 8
 13836       TO DFHEIV11
 13837*    MOVE '@"L                   #   #00012573' TO DFHEIV0
 13838     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13839     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13840     MOVE X'2020233030303132353733' TO DFHEIV0(25:11)
 13841     CALL 'kxdfhei1' USING DFHEIV0,
 13842           APRI,
 13843           DFHEIV11
 13844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13845         IF APRI NOT NUMERIC
 13846             MOVE AL-UNBON       TO APRA
 13847             MOVE -1             TO APRL
 13848             MOVE ER-0248        TO EMI-ERROR
 13849             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13850         ELSE
 13851             MOVE AL-UNNON       TO APRA
 13852             MOVE APRI           TO WS-APR APRO
 13853         END-IF
 13854     END-IF.
 13855
 13856     IF PMTFREQL GREATER ZERO
 13857
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 263
* EL130.cbl
 13858* EXEC CICS BIF DEEDIT
 13859*            FIELD   (PMTFREQI)
 13860*            LENGTH  (2)
 13861*        END-EXEC
 13862     MOVE 2
 13863       TO DFHEIV11
 13864*    MOVE '@"L                   #   #00012589' TO DFHEIV0
 13865     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13866     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13867     MOVE X'2020233030303132353839' TO DFHEIV0(25:11)
 13868     CALL 'kxdfhei1' USING DFHEIV0,
 13869           PMTFREQI,
 13870           DFHEIV11
 13871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13872         IF PMTFREQI NOT NUMERIC
 13873             MOVE -1             TO PMTFREQL
 13874             MOVE AL-UNBON       TO PMTFREQA
 13875             MOVE ER-0258        TO EMI-ERROR
 13876             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13877         ELSE
 13878             MOVE AL-UNNON       TO PMTFREQA
 13879             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13880         END-IF
 13881     END-IF.
 13882
 13883     IF INDGRPL GREATER ZERO
 13884         IF INDGRPI = 'I' OR 'G'
 13885             MOVE AL-UANON       TO INDGRPA
 13886         ELSE
 13887             MOVE -1 TO INDGRPL
 13888             MOVE AL-UABON       TO INDGRPA
 13889             MOVE ER-0260        TO EMI-ERROR
 13890             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13891         END-IF
 13892     END-IF.
 13893
 13894     IF LOANBALL GREATER ZERO
 13895         MOVE LOANBALI           TO DEEDIT-FIELD
 13896
 13897* EXEC CICS BIF DEEDIT
 13898*            FIELD   (DEEDIT-FIELD)
 13899*            LENGTH  (12)
 13900*        END-EXEC
 13901     MOVE 12
 13902       TO DFHEIV11
 13903*    MOVE '@"L                   #   #00012617' TO DFHEIV0
 13904     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13905     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13906     MOVE X'2020233030303132363137' TO DFHEIV0(25:11)
 13907     CALL 'kxdfhei1' USING DFHEIV0,
 13908           DEEDIT-FIELD,
 13909           DFHEIV11
 13910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13911         IF DEEDIT-FIELD NOT NUMERIC
 13912             MOVE AL-UNBON       TO LOANBALA
 13913             MOVE -1             TO LOANBALL
 13914             MOVE ER-0247        TO EMI-ERROR
 13915             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 264
* EL130.cbl
 13916         ELSE
 13917             MOVE AL-UNNON       TO LOANBALA
 13918             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13919         END-IF
 13920     END-IF.
 13921
 13922     IF PREMTYPL GREATER ZERO
 13923         IF (PREMTYPI = '1' OR '2' OR '3')
 13924             MOVE AL-UANON       TO PREMTYPA
 13925         ELSE
 13926             MOVE -1             TO PREMTYPL
 13927             MOVE AL-UABON       TO PREMTYPA
 13928             MOVE ER-0227        TO EMI-ERROR
 13929             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13930         END-IF
 13931     END-IF.
 13932
 13933     IF REINCDL GREATER ZERO
 13934         MOVE LOW-VALUES         TO  ERREIN-KEY
 13935         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13936         MOVE REINCDI            TO  REIN-CODE-1
 13937                                     REIN-CODE-2
 13938                                     REIN-CODE-3
 13939         MOVE 'A'                TO  REIN-TYPE
 13940         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13941         IF REIN-REC-NOT-FOUND
 13942             MOVE ER-0266        TO  EMI-ERROR
 13943             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13944             MOVE -1             TO  REINCDL
 13945             MOVE AL-UABON       TO  REINCDA
 13946         ELSE
 13947             MOVE AL-UANON       TO  REINCDA
 13948         END-IF
 13949     END-IF.
 13950
 13951     IF CERTMTI NOT = 'A'
 13952        GO TO 6200-EXIT
 13953     END-IF.
 13954
 13955     IF PREMTYPI = '1'
 13956         IF LCVCDL GREATER ZERO
 13957             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13958                 MOVE ER-0841        TO  EMI-ERROR
 13959                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13960                 MOVE -1             TO  PREMTYPL
 13961                 MOVE AL-UABON       TO  PREMTYPA
 13962             END-IF
 13963         END-IF
 13964     END-IF.
 13965
 13966     IF PREMTYPI = '1'
 13967         IF ACVCDL GREATER ZERO
 13968             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13969                 MOVE ER-0841        TO  EMI-ERROR
 13970                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13971                 MOVE -1             TO  PREMTYPL
 13972                 MOVE AL-UABON       TO  PREMTYPA
 13973             END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 265
* EL130.cbl
 13974         END-IF
 13975     END-IF.
 13976
 13977     IF PREMTYPI = '2'
 13978         IF LCVCDL GREATER ZERO
 13979             IF (PI-COMPANY-ID = 'HAN') AND
 13980                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13981                        OR
 13982                 WS-LF-SPECIAL-CALC-CD = 'O'
 13983*                NEXT SENTENCE
 13984                 CONTINUE
 13985             ELSE
 13986                 MOVE ER-0840        TO  EMI-ERROR
 13987                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13988                 MOVE -1             TO  PREMTYPL
 13989                 MOVE AL-UABON       TO  PREMTYPA
 13990             END-IF
 13991         END-IF
 13992     END-IF.
 13993
 13994     IF PREMTYPI = '2'
 13995         IF ACVCDL GREATER ZERO
 13996             IF (PI-COMPANY-ID = 'HAN')  AND
 13997                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13998                        OR
 13999                 WS-AH-SPECIAL-CALC-CD = 'O'
 14000*                NEXT SENTENCE
 14001                 CONTINUE
 14002             ELSE
 14003                 MOVE ER-0840        TO  EMI-ERROR
 14004                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14005                 MOVE -1             TO  PREMTYPL
 14006                 MOVE AL-UABON       TO  PREMTYPA
 14007             END-IF
 14008         END-IF
 14009     END-IF.
 14010
 14011     IF LCVCDL = ZEROS
 14012        GO TO 6200-EXIT
 14013     END-IF.
 14014
 14015     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 14016         IF PMTFREQI NOT = ZEROS
 14017             MOVE ER-0428        TO EMI-ERROR
 14018             MOVE -1             TO PMTFREQL
 14019             MOVE AL-UNBON       TO PMTFREQA
 14020             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14021             GO TO 6200-CHECK-APR
 14022         END-IF
 14023     END-IF.
 14024
 14025     IF PMTFREQL = ZEROS AND TEX-REG
 14026         MOVE ER-0429            TO EMI-ERROR
 14027         MOVE -1                 TO PMTFREQL
 14028         MOVE AL-UNBON           TO PMTFREQA
 14029         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14030         GO TO 6200-CHECK-APR
 14031     END-IF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 266
* EL130.cbl
 14032
 14033     IF LCVOTRMI NOT NUMERIC
 14034         GO TO 6200-CHECK-APR
 14035     END-IF.
 14036
 14037     IF WS-PMTFREQ NOT = ZERO
 14038         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 14039         GIVING DIVIDE-QUOT
 14040         REMAINDER DIVIDE-REM
 14041         IF DIVIDE-REM GREATER ZERO
 14042             MOVE ER-0430            TO EMI-ERROR
 14043             MOVE -1                 TO PMTFREQL
 14044             MOVE AL-UNBON           TO PMTFREQA
 14045             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14046         END-IF
 14047     END-IF.
 14048
 14049 6200-CHECK-APR.
 14050     IF NET-PAY AND APRL = ZEROS
 14051        MOVE ER-0257             TO EMI-ERROR
 14052        MOVE -1                  TO APRL
 14053        MOVE AL-UABON            TO APRA
 14054        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14055     END-IF.
 14056
 14057 6200-EXIT.
 14058     EXIT.
 14059
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 267
* EL130.cbl
 14061 6300-REQUIRED-CERT-EDIT.
 14062
 14063     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14064        GO TO 6300-REQUIRED-AH-EDIT
 14065     END-IF
 14066
 14067     IF LCVCDL = ZERO
 14068        MOVE ER-7639             TO EMI-ERROR
 14069        MOVE -1                  TO LCVCDL
 14070        MOVE AL-UABON            TO LCVCDA
 14071        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14072     END-IF.
 14073
 14074     IF LCVOTRML = ZERO
 14075        MOVE ER-7670             TO EMI-ERROR
 14076        MOVE -1                  TO LCVOTRML
 14077        MOVE AL-UNBON            TO LCVOTRMA
 14078        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14079     END-IF.
 14080
 14081     IF LCVBENEL = ZERO
 14082        MOVE ER-7671             TO EMI-ERROR
 14083        MOVE -1                  TO LCVBENEL
 14084        MOVE AL-UNBON            TO LCVBENEA
 14085        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14086     END-IF.
 14087
 14088     GO TO 6399-EXIT.
 14089
 14090 6300-REQUIRED-AH-EDIT.
 14091
 14092     IF ACVCDL = ZERO
 14093        MOVE ER-7639             TO EMI-ERROR
 14094        MOVE -1                  TO ACVCDL
 14095        MOVE AL-UABON            TO ACVCDA
 14096        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14097     END-IF.
 14098
 14099     IF ACVOTRML = ZERO
 14100         MOVE ER-7670             TO EMI-ERROR
 14101         MOVE -1                  TO ACVOTRML
 14102         MOVE AL-UNBON            TO ACVOTRMA
 14103         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14104     END-IF.
 14105
 14106     IF ACVBENEL = ZERO
 14107        MOVE ER-7671             TO EMI-ERROR
 14108        MOVE -1                  TO ACVBENEL
 14109        MOVE AL-UNBON            TO ACVBENEA
 14110        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14111     END-IF.
 14112
 14113 6399-EXIT.
 14114      EXIT.
 14115
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 268
* EL130.cbl
 14117 6400-TEST-CLAIM-REASONABILITY.
 14118
 14119     IF WS-INCUR = LOW-VALUES
 14120        GO TO 6499-EXIT
 14121     END-IF.
 14122
 14123     IF WS-EFFDT NOT = LOW-VALUES
 14124         IF WS-INCUR LESS WS-EFFDT
 14125             MOVE ER-0458          TO EMI-ERROR
 14126             MOVE -1               TO INCURL
 14127             MOVE AL-UABON         TO INCURA
 14128             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14129         END-IF
 14130     END-IF.
 14131
 14132     IF CERTMTI = 'A'
 14133        GO TO 6460-TEST-NEW-CERT
 14134     END-IF.
 14135
 14136     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 14137     MOVE CRTCARRI               TO CERT-CARRIER.
 14138     MOVE GROUPI                 TO CERT-GROUPING.
 14139     MOVE STATEI                 TO CERT-STATE.
 14140     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 14141     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 14142     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 14143
 14144
 14145
 14146* EXEC CICS HANDLE CONDITION
 14147*         DUPKEY   (6499-EXIT)
 14148*         NOTFND   (6499-EXIT)
 14149*    END-EXEC.
 14150*    MOVE '"$$I                  ! C #00012855' TO DFHEIV0
 14151     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 14152     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14153     MOVE X'4320233030303132383535' TO DFHEIV0(25:11)
 14154     CALL 'kxdfhei1' USING DFHEIV0
 14155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14156
 14157
 14158     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 14159
 14160     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 14161        'I' OR 'G' OR 'F')
 14162        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14163     ELSE
 14164        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14165     END-IF.
 14166
 14167     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14168     MOVE '6'                    TO DC-OPTION-CODE.
 14169     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14170
 14171     IF (WS-INCUR GREATER THAN DC-BIN-DATE-2)
 14172        and (dc-elapsed-months > zeros)
 14173        MOVE ER-0519             TO EMI-ERROR
 14174        MOVE -1                  TO INCURL
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 269
* EL130.cbl
 14175        MOVE AL-UABON            TO INCURA
 14176        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14177     END-IF.
 14178
 14179     IF CLMCARRI NOT = CRTCARRI
 14180        MOVE ER-0562             TO EMI-ERROR
 14181        MOVE AL-UABON            TO CLMCARRA
 14182        MOVE -1                  TO CLMCARRL
 14183        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14184     END-IF.
 14185
 14186     if (pi-company-id = 'DCC' OR 'VPP')
 14187        and (ws-dcc-product-code <> spaces)
 14188        continue
 14189     else
 14190      IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F') AND
 14191        CM-AH-BENEFIT-CD = '00')
 14192                  OR
 14193        ((CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O') AND
 14194        CM-LF-BENEFIT-CD = '00')
 14195         MOVE ER-0521         TO EMI-ERROR
 14196         MOVE AL-UABON        TO CLMTYPEA
 14197         MOVE -1              TO CLMTYPEL
 14198         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14199      END-IF
 14200     end-if
 14201*    IF CLMTYPEI = 'I' AND
 14202*       CM-AH-CRITICAL-PERIOD = +0
 14203*        MOVE ER-0521         TO EMI-ERROR
 14204*        MOVE AL-UABON        TO CLMTYPEA
 14205*        MOVE -1              TO CLMTYPEL
 14206*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14207*    END-IF
 14208
 14209*    IF PI-COMPANY-ID = 'CRI'
 14210*        IF MAINTI = 'A'
 14211*            IF CERT-PEND-ISSUE-ERROR  OR
 14212*               CERT-PEND-ISSUE-RETURNED
 14213*                MOVE -1                 TO CERTNOL
 14214*                MOVE AL-UABON           TO CERTNOA
 14215*                MOVE ER-7640            TO EMI-ERROR
 14216*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14217*            END-IF
 14218*        END-IF
 14219*    END-IF.
 14220
 14221     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 14222         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14223         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 14224             GO TO 6450-DATE-ERROR
 14225         END-IF
 14226     END-IF.
 14227
 14228     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 14229         (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'))
 14230         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 14231             GO TO 6450-DATE-ERROR
 14232         END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 270
* EL130.cbl
 14233     END-IF.
 14234
 14235     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14236         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 14237             GO TO 6450-DATE-ERROR
 14238         END-IF
 14239     END-IF.
 14240
 14241     GO TO 6499-EXIT.
 14242
 14243 6450-DATE-ERROR.
 14244     MOVE ER-0520                TO EMI-ERROR.
 14245     MOVE -1                     TO INCURL.
 14246     MOVE AL-UABON               TO INCURA.
 14247     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14248
 14249*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 14250*       (EMI-SEVERITY-SAVE = 'X')
 14251*        ADD 1                TO EMI-FORCABLE-CTR
 14252*        SUBTRACT 1 FROM EMI-FATAL-CTR
 14253*    END-IF.
 14254
 14255     GO TO 6499-EXIT.
 14256
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 271
* EL130.cbl
 14258 6460-TEST-NEW-CERT.
 14259
 14260     IF NOT EMI-NO-ERRORS
 14261        GO TO 6499-EXIT
 14262     END-IF.
 14263
 14264     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 14265
 14266     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14267          OR 'F') AND
 14268         ACVOTRML GREATER ZERO)
 14269        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 14270     END-IF.
 14271
 14272     IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O') AND
 14273         LCVOTRML GREATER ZERO
 14274        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 14275     END-IF.
 14276
 14277     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 14278
 14279*    IF PI-COMPANY-ID = 'HAN'
 14280*        IF ADDONDTL GREATER ZERO
 14281*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 14282*            IF CLMTYPEI = 'A'
 14283*                IF ACVOTRMI NOT = ZEROS
 14284*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 14285*                ELSE
 14286*                    NEXT SENTENCE
 14287*                    CONTINUE
 14288*                END-IF
 14289*            ELSE
 14290*                IF LCVOTRMI NOT = ZEROS
 14291*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 14292*                END-IF
 14293*            END-IF
 14294*        END-IF
 14295*    END-IF.
 14296
 14297     MOVE '6'                    TO DC-OPTION-CODE.
 14298     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14299
 14300     IF NO-CONVERSION-ERROR
 14301         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 14302     END-IF.
 14303
 14304     IF WS-INCUR GREATER THAN WS-EXPIRE
 14305        MOVE ER-0519             TO EMI-ERROR
 14306        MOVE -1                  TO INCURL
 14307        MOVE AL-UABON            TO INCURA
 14308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14309     END-IF.
 14310
 14311     IF CLMCARRI NOT = CRTCARRI
 14312        MOVE ER-0562             TO EMI-ERROR
 14313        MOVE AL-UABON            TO CLMCARRA
 14314        MOVE -1                  TO CLMCARRL
 14315        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 272
* EL130.cbl
 14316     END-IF.
 14317
 14318     if (pi-company-id = 'DCC' OR 'VPP')
 14319        and (ws-dcc-product-code <> spaces)
 14320        continue
 14321     else
 14322        IF (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 14323           and (ACVCDL = ZEROS)
 14324           MOVE ER-0521          TO EMI-ERROR
 14325           MOVE AL-UABON         TO CLMTYPEA
 14326           MOVE -1               TO CLMTYPEL
 14327           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14328        END-IF
 14329     end-if
 14330
 14331     if (pi-company-id = 'DCC' OR 'VPP')
 14332        and (ws-dcc-product-code <> spaces)
 14333        continue
 14334     else
 14335        IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O')
 14336           and (LCVCDL = ZEROS)
 14337           MOVE ER-0521          TO EMI-ERROR
 14338           MOVE AL-UABON         TO CLMTYPEA
 14339           MOVE -1               TO CLMTYPEL
 14340           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14341        END-IF
 14342     end-if
 14343
 14344     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'
 14345         IF LCVCNDTL GREATER ZERO
 14346             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14347                 GO TO 6450-DATE-ERROR
 14348             END-IF
 14349         END-IF
 14350     END-IF.
 14351
 14352     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14353         IF ACVCNDTL GREATER ZERO
 14354             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14355                 GO TO 6450-DATE-ERROR
 14356             END-IF
 14357         END-IF
 14358     END-IF.
 14359
 14360 6499-EXIT.
 14361     EXIT.
 14362 6500-get-acct.
 14363
 14364     MOVE SPACES                 TO ERACCT-KEY
 14365                                    ws-dcc-product-code
 14366                                    ws-acct-found-sw
 14367
 14368     IF CARR-GROUP-ST-ACCNT-CNTL
 14369        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14370        MOVE CRTCARRI            TO ACCT-CARRIER
 14371        MOVE GROUPI              TO ACCT-GROUPING
 14372        MOVE STATEI              TO ACCT-STATE
 14373        MOVE ACCOUNTI            TO ACCT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 273
* EL130.cbl
 14374        GO TO 6500-startbr
 14375     END-IF
 14376
 14377     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14378     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14379
 14380     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14381        MOVE STATEI             TO ACCT-STATE
 14382     END-IF
 14383
 14384     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 14385        MOVE CRTCARRI           TO ACCT-CARRIER
 14386     END-IF
 14387
 14388     .
 14389 6500-startbr.
 14390
 14391     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14392
 14393
 14394* EXEC CICS STARTBR
 14395*       DATASET     (ERACCT2-DSID)
 14396*       RIDFLD      (SAVE-ERACCT-KEY)
 14397*       GENERIC
 14398*       KEYLENGTH   (20)
 14399*       resp        (ws-response)
 14400*    END-EXEC
 14401     MOVE 20
 14402       TO DFHEIV11
 14403     MOVE 0
 14404       TO DFHEIV12
 14405*    MOVE '&,   KG    G          &  N#00013095' TO DFHEIV0
 14406     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14407     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14408     MOVE X'204E233030303133303935' TO DFHEIV0(25:11)
 14409     CALL 'kxdfhei1' USING DFHEIV0,
 14410           ERACCT2-DSID,
 14411           SAVE-ERACCT-KEY,
 14412           DFHEIV11,
 14413           DFHEIV12,
 14414           DFHEIV99
 14415     MOVE EIBRESP  TO ws-response
 14416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14417
 14418     if not ws-resp-normal
 14419        go to 6500-exit
 14420     end-if
 14421
 14422     .
 14423 6500-readnext.
 14424
 14425
 14426* EXEC CICS READNEXT
 14427*       DATASET   (ERACCT2-DSID)
 14428*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14429*       RIDFLD    (SAVE-ERACCT-KEY)
 14430*    END-EXEC
 14431     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 274
* EL130.cbl
 14432       TO DFHEIV11
 14433*    MOVE '&.S                   )   #00013110' TO DFHEIV0
 14434     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14435     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14436     MOVE X'2020233030303133313130' TO DFHEIV0(25:11)
 14437     CALL 'kxdfhei1' USING DFHEIV0,
 14438           ERACCT2-DSID,
 14439           DFHEIV20,
 14440           DFHEIV99,
 14441           SAVE-ERACCT-KEY,
 14442           DFHEIV99,
 14443           DFHEIV11,
 14444           DFHEIV99,
 14445           DFHEIV99
 14446     SET ADDRESS OF ACCOUNT-MASTER TO
 14447         DFHEIV20
 14448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14449
 14450     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14451        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14452        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14453        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14454        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14455        go to 6500-endbr
 14456     END-IF
 14457
 14458     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14459        and (WS-EFFDT < AM-EXPIRATION-DT)
 14460        set acct-found to true
 14461        MOVE AM-dcc-product-code to ws-dcc-product-code
 14462        GO TO 6500-endbr
 14463     END-IF
 14464
 14465     IF WS-EFFDT >= AM-EXPIRATION-DT
 14466         GO TO 6500-readnext
 14467     END-IF
 14468
 14469     .
 14470 6500-endbr.
 14471
 14472
 14473* EXEC CICS ENDBR
 14474*        DATASET    (ERACCT2-DSID)
 14475*    END-EXEC
 14476     MOVE 0
 14477       TO DFHEIV11
 14478*    MOVE '&2                    $   #00013138' TO DFHEIV0
 14479     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14480     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14481     MOVE X'2020233030303133313338' TO DFHEIV0(25:11)
 14482     CALL 'kxdfhei1' USING DFHEIV0,
 14483           ERACCT2-DSID,
 14484           DFHEIV11,
 14485           DFHEIV99
 14486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14487
 14488     .
 14489 6500-exit.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 275
* EL130.cbl
 14490     exit.
 14491 6600-CHECK-AUTO-ACTIVITY.
 14492
 14493
 14494* EXEC CICS HANDLE CONDITION
 14495*        NOTFND   (6600-NOT-FOUND)
 14496*    END-EXEC.
 14497*    MOVE '"$I                   ! D #00013147' TO DFHEIV0
 14498     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14500     MOVE X'4420233030303133313437' TO DFHEIV0(25:11)
 14501     CALL 'kxdfhei1' USING DFHEIV0
 14502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14503
 14504
 14505     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14506     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14507     MOVE SPACES                     TO  CNTL-ACCESS.
 14508     MOVE +0                         TO  CNTL-SEQ-NO.
 14509
 14510     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14511
 14512     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14513         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14514                                         WS-LETTER-SW
 14515         GO TO 6600-EXIT
 14516     END-IF.
 14517
 14518     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14519         MOVE 'N'                     TO  WS-LETTER-SW
 14520     ELSE
 14521         MOVE 'Y'                     TO  WS-LETTER-SW
 14522     END-IF.
 14523
 14524     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14525     GO TO 6600-EXIT.
 14526
 14527 6600-START-AUTO-LETTER-WRITER.
 14528
 14529     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14530     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14531
 14532     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14533
 14534     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14535         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14536         MOVE '6'                     TO  DC-OPTION-CODE
 14537         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14538         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14539         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14540         IF NO-CONVERSION-ERROR
 14541             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14542         ELSE
 14543             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14544         END-IF
 14545     END-IF.
 14546
 14547     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 276
* EL130.cbl
 14548         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14549         MOVE '6'                     TO  DC-OPTION-CODE
 14550         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14551         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14552         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14553         IF NO-CONVERSION-ERROR
 14554             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14555         ELSE
 14556             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14557         END-IF
 14558     END-IF.
 14559
 14560
 14561
 14562* EXEC CICS LINK
 14563*        PROGRAM    (LINK-1523)
 14564*        COMMAREA   (W-1523-LINKDATA)
 14565*        LENGTH     (W-1523-COMM-LENGTH)
 14566*    END-EXEC.
 14567*    MOVE '."C                   (   #00013207' TO DFHEIV0
 14568     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14570     MOVE X'2020233030303133323037' TO DFHEIV0(25:11)
 14571     CALL 'kxdfhei1' USING DFHEIV0,
 14572           LINK-1523,
 14573           W-1523-LINKDATA,
 14574           W-1523-COMM-LENGTH,
 14575           DFHEIV99,
 14576           DFHEIV99,
 14577           DFHEIV99,
 14578           DFHEIV99
 14579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14580
 14581
 14582     GO TO 6600-EXIT.
 14583
 14584 6600-NOT-FOUND.
 14585     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14586
 14587 6600-EXIT.
 14588     EXIT.
 14589
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 277
* EL130.cbl
 14590/
 14591*************************************************************
 14592*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14593*************************************************************
 14594
 14595 6700-OUTPUT-ACTIVITY-RECORD.
 14596
 14597
 14598
 14599* EXEC CICS GETMAIN
 14600*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14601*        LENGTH (DLYACTV-LENGTH)
 14602*        INITIMG (WS-BLANK)
 14603*    END-EXEC.
 14604*    MOVE ',"IL                  $   #00013229' TO DFHEIV0
 14605     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14606     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14607     MOVE X'2020233030303133323239' TO DFHEIV0(25:11)
 14608     CALL 'kxdfhei1' USING DFHEIV0,
 14609           DFHEIV20,
 14610           DLYACTV-LENGTH,
 14611           WS-BLANK
 14612     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14613         DFHEIV20
 14614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14615
 14616
 14617     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14618     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14619     MOVE CLMCARRI               TO DA-CARRIER.
 14620     IF CLMNOL EQUAL ZERO
 14621         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14622     ELSE
 14623         MOVE CLMNOI             TO DA-CLAIM-NO
 14624     END-IF.
 14625     MOVE CERTNOI                TO DA-CERT-PRIME.
 14626     MOVE SUFXI                  TO DA-CERT-SFX.
 14627     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14628     MOVE 'A'                    TO DA-RECORD-TYPE.
 14629
 14630
 14631* EXEC CICS HANDLE CONDITION
 14632*        NOTOPEN (6700-NOTOPEN-ERROR)
 14633*        DUPREC (6700-EXIT)
 14634*    END-EXEC.
 14635*    MOVE '"$J%                  ! E #00013248' TO DFHEIV0
 14636     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14638     MOVE X'4520233030303133323438' TO DFHEIV0(25:11)
 14639     CALL 'kxdfhei1' USING DFHEIV0
 14640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14641
 14642
 14643
 14644* EXEC CICS WRITE
 14645*        DATASET (DLYACTV-DSID)
 14646*        RIDFLD (DA-KEY)
 14647*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 278
* EL130.cbl
 14648*        LENGTH (DLYACTV-LENGTH)
 14649*    END-EXEC.
 14650*    MOVE '&$ L                  ''   #00013253' TO DFHEIV0
 14651     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14652     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14653     MOVE X'2020233030303133323533' TO DFHEIV0(25:11)
 14654     CALL 'kxdfhei1' USING DFHEIV0,
 14655           DLYACTV-DSID,
 14656           DAILY-ACTIVITY-RECORD,
 14657           DLYACTV-LENGTH,
 14658           DA-KEY,
 14659           DFHEIV99,
 14660           DFHEIV99
 14661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14662
 14663     GO TO 6700-EXIT.
 14664
 14665 6700-NOTOPEN-ERROR.
 14666     MOVE '2955'                 TO EMI-ERROR.
 14667     MOVE -1                     TO MAINTL.
 14668     MOVE AL-UANON               TO MAINTA.
 14669     PERFORM 9900-ERROR-FORMAT THRU
 14670             9900-EXIT.
 14671     GO TO 8200-SEND-DATAONLY.
 14672
 14673 6700-EXIT.
 14674     EXIT.
 14675
 14676*************************************************************
 14677*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14678*************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 279
* EL130.cbl
 14679/
 14680 6990-DEEDIT-DATE.
 14681
 14682
 14683* EXEC CICS BIF DEEDIT
 14684*        FIELD   (DATE-WORK)
 14685*        LENGTH  (8)
 14686*    END-EXEC.
 14687     MOVE 8
 14688       TO DFHEIV11
 14689*    MOVE '@"L                   #   #00013278' TO DFHEIV0
 14690     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14691     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14692     MOVE X'2020233030303133323738' TO DFHEIV0(25:11)
 14693     CALL 'kxdfhei1' USING DFHEIV0,
 14694           DATE-WORK,
 14695           DFHEIV11
 14696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14697
 14698 6990-EXIT.
 14699     EXIT.
 14700
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 280
* EL130.cbl
 14702 7000-BUILD-OUTPUT-MAP.
 14703
 14704     IF CLAIM-SWITCH = 'N'
 14705         GO TO 7050-BUILD-MAP-CERT-DATA
 14706     END-IF.
 14707
 14708     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14709         MOVE SPACES                 TO SEQUO
 14710         MOVE AL-SABOF               TO SEQUA
 14711     ELSE
 14712         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14713         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14714         MOVE WS-CLAIM-SEQU          TO SEQUO
 14715         MOVE AL-SABON               TO SEQUA
 14716     END-IF.
 14717
 14718     MOVE CL-CARRIER             TO CLMCARRO.
 14719     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14720     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14721     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14722     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14723     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14724     MOVE CL-INSURED-MID-INIT    TO INITO.
 14725     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14726     move cl-insured-type        to instypeo
 14727*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14728
 14729     MOVE AL-UANON               TO CLMCARRA
 14730                                    CLMTYPEA
 14731                                    PCERTNOA
 14732                                    PSUFXA
 14733                                    LSTNMEA
 14734                                    FSTNMEA
 14735                                    INITA
 14736                                    SEXA
 14737
 14738     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14739
 14740     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14741         MOVE ' '                 TO DC-OPTION-CODE
 14742         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14743         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14744         IF NOT DATE-CONVERSION-ERROR
 14745             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14746             MOVE AL-UANON            TO BIRTHDTA
 14747         END-IF
 14748     END-IF.
 14749
 14750     MOVE CL-SOC-SEC-NO          TO SSNO.
 14751     MOVE AL-UANON               TO SSNA.
 14752
 14753     IF CL-INCURRED-DT NOT = LOW-VALUES
 14754         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14755         MOVE ' '                TO DC-OPTION-CODE
 14756         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14757         IF NOT DATE-CONVERSION-ERROR
 14758             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14759             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 281
* EL130.cbl
 14760         END-IF
 14761     END-IF.
 14762
 14763     IF CL-REPORTED-DT NOT = LOW-VALUES
 14764         MOVE ' '                TO DC-OPTION-CODE
 14765         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14766         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14767         IF NOT DATE-CONVERSION-ERROR
 14768             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14769             MOVE AL-UANON            TO REPORTA
 14770         END-IF
 14771     END-IF.
 14772
 14773*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14774*        MOVE ' '                 TO DC-OPTION-CODE
 14775*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14776*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14777*        IF NOT DATE-CONVERSION-ERROR
 14778*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14779*            MOVE AL-UANON            TO ESTENDA
 14780*        END-IF
 14781*    END-IF.
 14782
 14783     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14784     MOVE WS-ICD-CODE-1          TO ICD1O.
 14785     MOVE WS-ICD-CODE-2          TO ICD2O.
 14786*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14787     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14788     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14789     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14790     MOVE CL-PRIORITY-CD         TO PRICDO.
 14791     MOVE AL-UANON               TO DIAGA
 14792                                    ICD1A
 14793                                    ICD2A
 14794*                                   CAUSEA
 14795                                    RELCLMA
 14796                                    PROCCDA
 14797                                    PRICDA.
 14798     MOVE AL-UNNON               TO MANRSVA.
 14799
 14800*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14801*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14802*        MOVE AL-UANON               TO PRODCDA
 14803*    END-IF.
 14804
 14805     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14806     MOVE CL-FILE-LOCATION       TO FILETOO.
 14807     MOVE CL-BENEFICIARY         TO BENECDO.
 14808     MOVE AL-UANON               TO SUPVA
 14809                                    FILETOA
 14810                                    BENECDA.
 14811
 14812     IF CLAIM-SWITCH = 'X'
 14813         GO TO 7099-EXIT
 14814     END-IF.
 14815
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 282
* EL130.cbl
 14817 7050-BUILD-MAP-CERT-DATA.
 14818     MOVE CM-CERT-PRIME          TO CERTNOO.
 14819     MOVE CM-CERT-SFX            TO SUFXO.
 14820     MOVE AL-SANON               TO CERTNOA
 14821                                    SUFXA.
 14822
 14823     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14824         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14825         MOVE ' '                TO DC-OPTION-CODE
 14826         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14827         IF NOT DATE-CONVERSION-ERROR
 14828             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14829         END-IF
 14830     END-IF.
 14831
 14832     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14833     MOVE CM-STATE               TO STATEO.
 14834     MOVE CM-CARRIER             TO CRTCARRO.
 14835     MOVE CM-GROUPING            TO GROUPO.
 14836     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14837     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14838     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14839     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14840     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14841     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14842     MOVE CM-JT-INITIAL          TO JNTINITO.
 14843     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14844     MOVE AL-UANON               TO ACCOUNTA
 14845                                    STATEA
 14846                                    CRTCARRA
 14847                                    GROUPA
 14848                                    CRTLNMEA
 14849                                    CRTFNMEA
 14850                                    CRTINITA
 14851                                    JNTLNMEA
 14852                                    JNTFNMEA
 14853                                    JNTINITA.
 14854     MOVE AL-UNNON               TO ISSAGEA
 14855                                    JNTAGEA.
 14856
 14857     IF CM-SSN-STATE   = CM-STATE AND
 14858        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14859*        NEXT SENTENCE
 14860         CONTINUE
 14861     ELSE
 14862         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14863     END-IF.
 14864
 14865     MOVE AL-UANON               TO CRTSSNA.
 14866
 14867     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14868     MOVE '2'                    TO DC-OPTION-CODE.
 14869     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14870     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14871
 14872*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14873     MOVE SPACES                 TO ELCNTL-KEY.
 14874     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 283
* EL130.cbl
 14875     MOVE '3'                    TO CNTL-REC-TYPE.
 14876     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14877     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14878
 14879
 14880
 14881* EXEC CICS READ
 14882*        DATASET  (ELCNTL-DSID)
 14883*        SET      (ADDRESS OF CONTROL-FILE)
 14884*        RIDFLD   (ELCNTL-KEY)
 14885*        RESP     (WS-RESPONSE)
 14886*    END-EXEC.
 14887*    MOVE '&"S        E          (  N#00013464' TO DFHEIV0
 14888     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14889     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14890     MOVE X'204E233030303133343634' TO DFHEIV0(25:11)
 14891     CALL 'kxdfhei1' USING DFHEIV0,
 14892           ELCNTL-DSID,
 14893           DFHEIV20,
 14894           DFHEIV99,
 14895           ELCNTL-KEY,
 14896           DFHEIV99,
 14897           DFHEIV99,
 14898           DFHEIV99
 14899     SET ADDRESS OF CONTROL-FILE TO
 14900         DFHEIV20
 14901     MOVE EIBRESP  TO WS-RESPONSE
 14902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14903
 14904
 14905     IF WS-RESP-NOTFND
 14906          MOVE ER-2848           TO EMI-ERROR
 14907          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14908          GO TO 8100-SEND-INITIAL-MAP
 14909     END-IF.
 14910
 14911     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14912     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14913     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 284
* EL130.cbl
 14915     IF CM-LF-BENEFIT-CD = '00'
 14916         MOVE ZEROS              TO LCVOTRMO
 14917                                    LCVRTRMO
 14918                                    LCVRATEO
 14919                                    LCVBENEO
 14920         MOVE SPACES             TO LCVDSCRO
 14921                                    LCVCDO
 14922                                    LCVKINDO
 14923                                    LCVFORMO
 14924                                    LCVCNDTO
 14925                                    LCVEXITO
 14926                                    LCVSTATO
 14927         IF CLMTYPEL GREATER THAN ZERO AND
 14928            CLMTYPEI = PI-LIFE-OVERRIDE-L1 OR 'O'
 14929                MOVE ER-0521     TO EMI-ERROR
 14930                MOVE AL-UABON    TO CLMTYPEA
 14931                MOVE -1          TO CLMTYPEL
 14932                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14933                GO TO 7060-FILL-AH-COVERAGE
 14934         ELSE
 14935             GO TO 7060-FILL-AH-COVERAGE
 14936         END-IF
 14937     END-IF.
 14938
 14939     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14940     MOVE AL-UANON               TO LCVDSCRA.
 14941     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14942     MOVE '4'                    TO WS-REC-TYPE.
 14943     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14944     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14945     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14946     MOVE AL-UANON               TO LCVCDA.
 14947     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14948                                    CP-ORIGINAL-TERM.
 14949     MOVE AL-UNNON               TO LCVOTRMA.
 14950     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14951     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14952     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14953     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14954     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14955     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14956
 14957     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14958     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14959
 14960     IF CM-LF-PREMIUM-RATE NUMERIC
 14961         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14962     ELSE
 14963         MOVE ZEROS              TO LCVRATEO
 14964     END-IF.
 14965
 14966     MOVE AL-UNNON               TO LCVRATEA.
 14967
 14968     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14969         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14970     END-IF.
 14971
 14972     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 285
* EL130.cbl
 14973
 14974     MOVE AL-UNNON               TO LCVBENEA.
 14975
 14976     IF CM-POLICY-FORM-NO NOT = SPACES
 14977         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14978     ELSE
 14979         MOVE WS-FORM-HOLD       TO LCVFORMO
 14980     END-IF.
 14981
 14982     MOVE SPACES                 TO WS-FORM-HOLD.
 14983     MOVE 'L'                    TO WS-REC-TYPE.
 14984     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14985
 14986     IF WS-FORM-HOLD NOT = SPACES
 14987         MOVE WS-FORM-HOLD       TO LCVFORMO
 14988         MOVE AL-UANON           TO LCVFORMA
 14989     END-IF.
 14990
 14991     IF CM-LF-CURRENT-STATUS = '8'
 14992         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14993             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14994             MOVE ' '             TO DC-OPTION-CODE
 14995             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14996             IF NOT DATE-CONVERSION-ERROR
 14997                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14998                 MOVE AL-UANON            TO LCVCNDTA
 14999             END-IF
 15000         END-IF
 15001     END-IF.
 15002
 15003     IF CM-LF-CURRENT-STATUS = '7'
 15004         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15005             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 15006             MOVE ' '            TO DC-OPTION-CODE
 15007             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15008             IF NOT DATE-CONVERSION-ERROR
 15009                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 15010                 MOVE AL-UANON   TO LCVCNDTA
 15011             END-IF
 15012         END-IF
 15013     END-IF.
 15014
 15015     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15016         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 15017             MOVE ' '            TO DC-OPTION-CODE
 15018             MOVE CM-LF-DEATH-EXIT-DT
 15019                                 TO DC-BIN-DATE-1
 15020             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15021             IF NOT DATE-CONVERSION-ERROR
 15022                 MOVE DC-GREG-DATE-1-EDIT
 15023                                 TO LCVEXITO
 15024             END-IF
 15025         END-IF
 15026     END-IF.
 15027
 15028     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15029         IF CP-REMAINING-TERM-3 = ZEROS
 15030             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 286
* EL130.cbl
 15031         ELSE
 15032             MOVE 'ACTIVE'       TO LCVSTATO
 15033         END-IF
 15034     END-IF.
 15035
 15036     IF CM-LF-CURRENT-STATUS = '2'
 15037        MOVE 'PEND  '            TO LCVSTATO
 15038     END-IF.
 15039     IF CM-LF-CURRENT-STATUS = '3'
 15040        MOVE 'RESTORE'           TO LCVSTATO
 15041     END-IF.
 15042     IF CM-LF-CURRENT-STATUS = '5'
 15043        MOVE 'REISSUE'           TO LCVSTATO
 15044     END-IF.
 15045     IF CM-LF-CURRENT-STATUS = '6'
 15046        MOVE 'LMP DIS'           TO LCVSTATO
 15047     END-IF.
 15048     IF CM-LF-CURRENT-STATUS = '7'
 15049        MOVE 'DEATH  '           TO LCVSTATO
 15050     END-IF.
 15051     IF CM-LF-CURRENT-STATUS = '8'
 15052        MOVE 'CANCEL '           TO LCVSTATO
 15053     END-IF.
 15054     IF CM-LF-CURRENT-STATUS = '9'
 15055        MOVE 'RE-ONLY'           TO LCVSTATO
 15056     END-IF.
 15057     IF CM-LF-CURRENT-STATUS = 'V'
 15058        MOVE 'VOID   '           TO LCVSTATO
 15059     END-IF.
 15060     IF CM-LF-CURRENT-STATUS = 'D'
 15061        MOVE 'DECLINE'           TO LCVSTATO
 15062     END-IF.
 15063
 15064     IF PI-COMPANY-ID = 'CID'
 15065         IF CM-LF-BENEFIT-CD >= '2O' AND
 15066            CM-LF-BENEFIT-CD <= '2V'
 15067             MOVE ER-0878       TO EMI-ERROR
 15068             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15069         END-IF
 15070     END-IF.
 15071
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 287
* EL130.cbl
 15073 7060-FILL-AH-COVERAGE.
 15074
 15075     IF CM-AH-BENEFIT-CD = '00'
 15076         MOVE ZEROS              TO ACVOTRMO
 15077                                    ACVRTRMO
 15078                                    ACVRATEO
 15079                                    ACVBENEO
 15080         MOVE SPACES             TO ACVDSCRO
 15081                                    ACVCDO
 15082                                    ACVKINDO
 15083                                    ACVFORMO
 15084                                    ACVCNDTO
 15085                                    ACVEXITO
 15086                                    ACVSTATO
 15087         IF (CLMTYPEL GREATER THAN ZERO AND
 15088             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 15089             MOVE ER-0521     TO EMI-ERROR
 15090             MOVE AL-UABON    TO CLMTYPEA
 15091             MOVE -1          TO CLMTYPEL
 15092             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15093             GO TO 7070-BUILD-MAP-FINISH
 15094         ELSE
 15095             GO TO 7070-BUILD-MAP-FINISH
 15096         END-IF
 15097     END-IF.
 15098
 15099     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15100     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 15101     MOVE AL-UANON               TO ACVDSCRA
 15102                                    ACVCDA.
 15103     MOVE '5'                    TO WS-REC-TYPE.
 15104     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 15105     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 15106
 15107     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 15108                                    CP-ORIGINAL-TERM.
 15109     MOVE AL-UNNON               TO ACVOTRMA.
 15110
 15111     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15112     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15113     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 15114     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15115     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15116     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15117
 15118     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 15119     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15120
 15121     IF CM-AH-PREMIUM-RATE NUMERIC
 15122         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15123     ELSE
 15124         MOVE ZEROS              TO ACVRATEO
 15125     END-IF.
 15126
 15127     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 15128     MOVE AL-UNNON               TO ACVRATEA
 15129                                    ACVBENEA.
 15130
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 288
* EL130.cbl
 15131     IF CM-POLICY-FORM-NO NOT = SPACES
 15132         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 15133     ELSE
 15134         MOVE WS-FORM-HOLD       TO ACVFORMO
 15135         MOVE SPACES TO WS-FORM-HOLD
 15136         MOVE 'A'                TO WS-REC-TYPE
 15137         PERFORM 7400-READ-STATE THRU 7499-EXIT
 15138         IF WS-FORM-HOLD NOT = SPACES
 15139             MOVE WS-FORM-HOLD   TO ACVFORMO
 15140         END-IF
 15141     END-IF.
 15142
 15143     MOVE AL-UANON               TO ACVFORMA.
 15144
 15145     IF CM-AH-CURRENT-STATUS = '8'
 15146         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 15147             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15148             MOVE ' '             TO DC-OPTION-CODE
 15149             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15150             IF NOT DATE-CONVERSION-ERROR
 15151                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15152                MOVE AL-UANON    TO ACVCNDTA
 15153             END-IF
 15154         END-IF
 15155     END-IF.
 15156
 15157     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15158         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15159             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 15160             MOVE ' '             TO DC-OPTION-CODE
 15161             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15162             IF NOT DATE-CONVERSION-ERROR
 15163                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15164                MOVE AL-UANON            TO ACVCNDTA
 15165             END-IF
 15166         END-IF
 15167     END-IF.
 15168
 15169     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15170         MOVE ' '                TO DC-OPTION-CODE
 15171         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15172         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15173         IF NOT DATE-CONVERSION-ERROR
 15174             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 15175         END-IF
 15176     END-IF.
 15177
 15178     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15179         IF CP-REMAINING-TERM-3 = ZEROS
 15180             MOVE 'EXPIRED'      TO ACVSTATO
 15181         ELSE
 15182             MOVE 'ACTIVE'       TO ACVSTATO
 15183         END-IF
 15184     END-IF.
 15185
 15186     IF CM-AH-CURRENT-STATUS = '2'
 15187         MOVE 'PEND  '           TO ACVSTATO
 15188     END-IF.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 289
* EL130.cbl
 15189     IF CM-AH-CURRENT-STATUS = '3'
 15190         MOVE 'RESTORE'          TO ACVSTATO
 15191     END-IF.
 15192     IF CM-AH-CURRENT-STATUS = '5'
 15193         MOVE 'REISSUE'          TO ACVSTATO
 15194     END-IF.
 15195     IF CM-AH-CURRENT-STATUS = '6'
 15196         MOVE 'LMP DIS'          TO ACVSTATO
 15197     END-IF.
 15198     IF CM-AH-CURRENT-STATUS = '7'
 15199         MOVE 'DEATH  '          TO ACVSTATO
 15200     END-IF.
 15201     IF CM-AH-CURRENT-STATUS = '8'
 15202         MOVE 'CANCEL '          TO ACVSTATO
 15203     END-IF.
 15204     IF CM-AH-CURRENT-STATUS = '9'
 15205         MOVE 'RE-ONLY'          TO ACVSTATO
 15206     END-IF.
 15207     IF CM-AH-CURRENT-STATUS = 'V'
 15208         MOVE 'VOID   '          TO ACVSTATO
 15209     END-IF.
 15210     IF CM-AH-CURRENT-STATUS = 'D'
 15211         MOVE 'DECLINE'          TO ACVSTATO
 15212     END-IF.
 15213
 15214     IF PI-COMPANY-ID = 'DCC' OR 'VPP'
 15215        IF CM-ACCOUNT (9:2) = 'BI'
 15216           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 15217           MOVE CM-CARRIER       TO CTRLR-CARRIER
 15218           MOVE CM-GROUPING      TO CTRLR-GROUPING
 15219           MOVE CM-STATE         TO CTRLR-STATE
 15220           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 15221           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 15222           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 15223           MOVE 'C'              TO CTRLR-REC-TYPE
 15224
 15225* EXEC CICS READ
 15226*            DATASET  (ELCRTT-DSID)
 15227*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 15228*            RIDFLD   (ELCRTT-KEY)
 15229*            RESP     (WS-RESPONSE)
 15230*          END-EXEC
 15231*    MOVE '&"S        E          (  N#00013790' TO DFHEIV0
 15232     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15234     MOVE X'204E233030303133373930' TO DFHEIV0(25:11)
 15235     CALL 'kxdfhei1' USING DFHEIV0,
 15236           ELCRTT-DSID,
 15237           DFHEIV20,
 15238           DFHEIV99,
 15239           ELCRTT-KEY,
 15240           DFHEIV99,
 15241           DFHEIV99,
 15242           DFHEIV99
 15243     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 15244         DFHEIV20
 15245     MOVE EIBRESP  TO WS-RESPONSE
 15246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 290
* EL130.cbl
 15247           IF WS-RESP-NORMAL
 15248               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 15249               MOVE WS-DIAG-VIN-MSG TO DIAGO
 15250               MOVE AL-UANON        TO DIAGA
 15251           END-IF
 15252        END-IF
 15253     END-IF.
 15254
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 291
* EL130.cbl
 15256 7070-BUILD-MAP-FINISH.
 15257     MOVE CM-LOAN-APR            TO APRO.
 15258     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15259     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15260     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 15261     MOVE AL-UNNON               TO APRA
 15262                                    PMTFREQA.
 15263     MOVE AL-UANON               TO INDGRPA
 15264                                    PREMTYPA.
 15265
 15266     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 15267         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 15268         MOVE AL-UANON               TO REINCDA
 15269     END-IF.
 15270
 15271     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 15272*        NEXT SENTENCE
 15273         CONTINUE
 15274     ELSE
 15275         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15276         MOVE ' '                TO DC-OPTION-CODE
 15277         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15278         IF NOT DATE-CONVERSION-ERROR
 15279             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 15280             MOVE AL-UANON            TO ADDONDTA
 15281         END-IF
 15282     END-IF.
 15283
 15284     IF CLAIM-SWITCH = 'N'
 15285         IF SEXL = ZEROS
 15286             MOVE CM-INSURED-SEX TO SEXO
 15287*            MOVE AL-UANON       TO SEXA
 15288         END-IF
 15289     END-IF.
 15290
 15291     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 15292         MOVE CM-MEMBER-NO       TO MEMBERO
 15293         MOVE AL-UANON           TO MEMBERA
 15294     END-IF.
 15295
 15296     IF MAINTI = 'A'
 15297         IF (LOANNOL = ZEROS OR
 15298             EIBAID = DFHPF5)
 15299             MOVE CM-LOAN-NUMBER TO LOANNOO
 15300             MOVE AL-UANON       TO LOANNOA
 15301         ELSE
 15302*            NEXT SENTENCE
 15303             CONTINUE
 15304         END-IF
 15305     ELSE
 15306         MOVE CM-LOAN-NUMBER     TO LOANNOO
 15307         MOVE AL-UANON           TO LOANNOA
 15308     END-IF.
 15309
 15310     IF MAINTI = 'A'
 15311         IF (LOANBALL = ZEROS OR
 15312             EIBAID = DFHPF5)
 15313             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 292
* EL130.cbl
 15314             MOVE AL-UNNON       TO LOANBALA
 15315         ELSE
 15316*            NEXT SENTENCE
 15317             CONTINUE
 15318         END-IF
 15319     ELSE
 15320         MOVE CM-LOAN-BALANCE    TO LOANBALO
 15321         MOVE AL-UNNON           TO LOANBALA
 15322     END-IF.
 15323
 15324     IF CM-PREMIUM-TYPE NOT = '3'
 15325         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15326             PERFORM 7200-PROTECT-CERT-FIELDS
 15327         ELSE
 15328             PERFORM 7300-RESET-KEY-ATTRBS
 15329         END-IF
 15330     ELSE
 15331         PERFORM 7300-RESET-KEY-ATTRBS
 15332     END-IF.
 15333
 15334*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15335*        NEXT SENTENCE
 15336*        CONTINUE
 15337*    ELSE
 15338         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15339*    END-IF.
 15340
 15341 7099-EXIT.
 15342     EXIT.
 15343
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 293
* EL130.cbl
 15345 7100-READ-BENEFIT.
 15346
 15347
 15348* EXEC CICS HANDLE CONDITION
 15349*         NOTFND   (7120-NOT-FOUND)
 15350*    END-EXEC.
 15351*    MOVE '"$I                   ! F #00013896' TO DFHEIV0
 15352     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15354     MOVE X'4620233030303133383936' TO DFHEIV0(25:11)
 15355     CALL 'kxdfhei1' USING DFHEIV0
 15356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15357
 15358
 15359     MOVE SPACES                 TO ELCNTL-KEY.
 15360     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15361     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15362     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15363     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15364
 15365 7105-READ-FILE.
 15366     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15367
 15368     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15369        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15370          GO TO 7120-NOT-FOUND
 15371     END-IF.
 15372
 15373     MOVE 1                      TO SUB.
 15374 7110-LOOP.
 15375     IF SUB = 9
 15376         GO TO 7120-NOT-FOUND
 15377     END-IF.
 15378
 15379     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15380         ADD 1                   TO SUB
 15381         GO TO 7110-LOOP
 15382     END-IF.
 15383
 15384     if ws-rec-type = '4'
 15385        move cf-joint-indicator (sub)
 15386                                 to ws-lf-joint-indicator
 15387     else
 15388        move cf-joint-indicator (sub)
 15389                                 to ws-ah-joint-indicator
 15390     end-if
 15391     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15392     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15393     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15394
 15395     GO TO 7199-EXIT.
 15396
 15397 7120-NOT-FOUND.
 15398     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15399                                    WS-FORM-HOLD.
 15400
 15401 7199-EXIT.
 15402      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 294
* EL130.cbl
 15403
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 295
* EL130.cbl
 15405 7200-PROTECT-CERT-FIELDS.
 15406     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15407                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15408                                LCVFORMA ACVFORMA JNTLNMEA
 15409                                JNTFNMEA JNTINITA.
 15410
 15411     IF CM-LF-CURRENT-STATUS = '2' OR
 15412        CM-AH-CURRENT-STATUS = '2'
 15413         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15414     END-IF.
 15415
 15416     MOVE AL-SANOF TO
 15417            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15418            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15419            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15420            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15421            LCVRATEA   ACVRATEA.
 15422
 15423     MOVE 'S'                    TO CERTMTI.
 15424
 15425 7300-RESET-KEY-ATTRBS.
 15426     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15427                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15428                                LCVFORMA ACVFORMA JNTLNMEA
 15429                                JNTFNMEA JNTINITA.
 15430
 15431     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15432         MOVE AL-SANOF           TO REINCDA
 15433     END-IF.
 15434
 15435     MOVE 'S'                    TO CERTMTI.
 15436
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 296
* EL130.cbl
 15438 7400-READ-STATE.
 15439
 15440
 15441* EXEC CICS HANDLE CONDITION
 15442*         NOTFND   (7499-EXIT)
 15443*    END-EXEC.
 15444*    MOVE '"$I                   ! G #00013981' TO DFHEIV0
 15445     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15447     MOVE X'4720233030303133393831' TO DFHEIV0(25:11)
 15448     CALL 'kxdfhei1' USING DFHEIV0
 15449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15450
 15451
 15452     MOVE SPACES                 TO ELCNTL-KEY.
 15453     MOVE CM-STATE               TO CNTL-ACCESS.
 15454     MOVE '3'                    TO CNTL-REC-TYPE.
 15455     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15456     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15457
 15458     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15459
 15460     MOVE 1                      TO SUB.
 15461
 15462 7410-LOOP.
 15463     IF SUB = 21
 15464        GO TO 7499-EXIT
 15465     END-IF.
 15466
 15467*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15468*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15469*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15470*        GO TO 7499-EXIT.
 15471
 15472     ADD 1                       TO SUB.
 15473     GO TO 7410-LOOP.
 15474
 15475 7499-EXIT.
 15476      EXIT.
 15477
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 297
* EL130.cbl
 15479 7500-BROWSE-FOR-DUPLICATE.
 15480
 15481     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15482
 15483
 15484
 15485* EXEC CICS HANDLE CONDITION
 15486*        NOTFND   (7500-EXIT)
 15487*        DUPKEY   (7500-DUPLICATE-KEY)
 15488*        ENDFILE  (7500-EXIT)
 15489*    END-EXEC.
 15490*    MOVE '"$I$''                 ! H #00014017' TO DFHEIV0
 15491     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15492     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15493     MOVE X'4820233030303134303137' TO DFHEIV0(25:11)
 15494     CALL 'kxdfhei1' USING DFHEIV0
 15495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15496
 15497
 15498
 15499
 15500* EXEC CICS STARTBR
 15501*        DATASET    (ELMSTR5-DSID)
 15502*        RIDFLD     (ELMSTR5-KEY)
 15503*    END-EXEC.
 15504     MOVE 0
 15505       TO DFHEIV11
 15506*    MOVE '&,         G          &   #00014024' TO DFHEIV0
 15507     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15508     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15509     MOVE X'2020233030303134303234' TO DFHEIV0(25:11)
 15510     CALL 'kxdfhei1' USING DFHEIV0,
 15511           ELMSTR5-DSID,
 15512           ELMSTR5-KEY,
 15513           DFHEIV99,
 15514           DFHEIV11,
 15515           DFHEIV99
 15516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15517
 15518
 15519
 15520
 15521* EXEC CICS HANDLE CONDITION
 15522*        ENDFILE  (7500-END-BROWSE)
 15523*    END-EXEC.
 15524*    MOVE '"$''                   ! I #00014030' TO DFHEIV0
 15525     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15527     MOVE X'4920233030303134303330' TO DFHEIV0(25:11)
 15528     CALL 'kxdfhei1' USING DFHEIV0
 15529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15530
 15531
 15532 7500-READ-CLAIM-LOOP.
 15533
 15534
 15535
 15536* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 298
* EL130.cbl
 15537*        DATASET   (ELMSTR5-DSID)
 15538*        SET       (ADDRESS OF CLAIM-MASTER)
 15539*        RIDFLD    (ELMSTR5-KEY)
 15540*    END-EXEC.
 15541     MOVE 0
 15542       TO DFHEIV11
 15543*    MOVE '&.S                   )   #00014037' TO DFHEIV0
 15544     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15545     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15546     MOVE X'2020233030303134303337' TO DFHEIV0(25:11)
 15547     CALL 'kxdfhei1' USING DFHEIV0,
 15548           ELMSTR5-DSID,
 15549           DFHEIV20,
 15550           DFHEIV99,
 15551           ELMSTR5-KEY,
 15552           DFHEIV99,
 15553           DFHEIV11,
 15554           DFHEIV99,
 15555           DFHEIV99
 15556     SET ADDRESS OF CLAIM-MASTER TO
 15557         DFHEIV20
 15558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15559
 15560
 15561 7500-DUPLICATE-KEY.
 15562
 15563     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15564        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15565        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15566        CL-CERT-STATE     NOT = CM-STATE       OR
 15567        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15568        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15569        CL-CERT-NO        NOT = CM-CERT-NO
 15570           GO TO 7500-CHECK-MATCH-COUNT
 15571     END-IF.
 15572
 15573     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15574
 15575     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15576        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15577        GO TO 7500-END-BROWSE
 15578     ELSE
 15579        GO TO 7500-READ-CLAIM-LOOP
 15580     END-IF.
 15581
 15582 7500-CHECK-MATCH-COUNT.
 15583
 15584     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15585        CL-CERT-NO    = CM-CERT-NO
 15586          GO TO 7500-READ-CLAIM-LOOP
 15587     END-IF.
 15588
 15589 7500-END-BROWSE.
 15590
 15591
 15592
 15593* EXEC CICS ENDBR
 15594*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 299
* EL130.cbl
 15595*    END-EXEC.
 15596     MOVE 0
 15597       TO DFHEIV11
 15598*    MOVE '&2                    $   #00014074' TO DFHEIV0
 15599     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15600     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15601     MOVE X'2020233030303134303734' TO DFHEIV0(25:11)
 15602     CALL 'kxdfhei1' USING DFHEIV0,
 15603           ELMSTR5-DSID,
 15604           DFHEIV11,
 15605           DFHEIV99
 15606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15607
 15608
 15609 7500-EXIT.
 15610     EXIT.
 15611
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 300
* EL130.cbl
 15613 7550-FALL-THRU-PARA.
 15614
 15615
 15616
 15617* EXEC CICS DUMP
 15618*         DUMPCODE ('E130')
 15619*         TASK
 15620*    END-EXEC.
 15621     MOVE 'E130' TO DFHEIV5
 15622*    MOVE '<"   T                $   #00014085' TO DFHEIV0
 15623     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15624     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15625     MOVE X'2020233030303134303835' TO DFHEIV0(25:11)
 15626     CALL 'kxdfhei1' USING DFHEIV0,
 15627           DFHEIV5,
 15628           DFHEIV99,
 15629           DFHEIV99
 15630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15631
 15632
 15633
 15634
 15635* EXEC CICS RETURN
 15636*    END-EXEC.
 15637*    MOVE '.(                    ''   #00014091' TO DFHEIV0
 15638     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15639     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15640     MOVE X'2020233030303134303931' TO DFHEIV0(25:11)
 15641     CALL 'kxdfhei1' USING DFHEIV0,
 15642           DFHEIV99,
 15643           DFHEIV99,
 15644           DFHEIV99,
 15645           DFHEIV99,
 15646           DFHEIV99,
 15647           DFHEIV99
 15648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15649
 15650
 15651 7600-BROWSE-CLAIM.
 15652
 15653
 15654
 15655* EXEC CICS READ
 15656*        DATASET(ELMSTR-DSID)
 15657*        SET    (ADDRESS OF CLAIM-MASTER)
 15658*        RIDFLD (ELMSTR-KEY)
 15659*        GENERIC
 15660*        EQUAL
 15661*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15662*    END-EXEC.
 15663*    MOVE '&"S  KG    E          (   #00014097' TO DFHEIV0
 15664     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15665     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15666     MOVE X'2020233030303134303937' TO DFHEIV0(25:11)
 15667     CALL 'kxdfhei1' USING DFHEIV0,
 15668           ELMSTR-DSID,
 15669           DFHEIV20,
 15670           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 301
* EL130.cbl
 15671           ELMSTR-KEY,
 15672           ELMSTR-GENERIC-LENGTH,
 15673           DFHEIV99,
 15674           DFHEIV99
 15675     SET ADDRESS OF CLAIM-MASTER TO
 15676         DFHEIV20
 15677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15678
 15679
 15680     MOVE CL-CERT-PRIME          TO CERTNOI.
 15681     MOVE CL-CERT-SFX            TO SUFXI.
 15682
 15683 7610-BROWSE-CLAIM-LOOP.
 15684
 15685     MOVE LOW-VALUES             TO BCERT1O
 15686                                    BSUFX1O
 15687                                    BCERT2O
 15688                                    BSUFX2O
 15689                                    BCERT3O
 15690                                    BSUFX3O
 15691                                    BCERT4O
 15692                                    BSUFX4O
 15693                                    BCERT5O
 15694                                    BSUFX5O.
 15695
 15696     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15697
 15698
 15699
 15700* EXEC CICS HANDLE CONDITION
 15701*        ENDFILE  (7630-END-BROWSE)
 15702*    END-EXEC.
 15703*    MOVE '"$''                   ! J #00014125' TO DFHEIV0
 15704     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15706     MOVE X'4A20233030303134313235' TO DFHEIV0(25:11)
 15707     CALL 'kxdfhei1' USING DFHEIV0
 15708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15709
 15710
 15711
 15712
 15713* EXEC CICS STARTBR
 15714*        DATASET    (ELMSTR-DSID)
 15715*        RIDFLD     (ELMSTR-KEY)
 15716*    END-EXEC.
 15717     MOVE 0
 15718       TO DFHEIV11
 15719*    MOVE '&,         G          &   #00014130' TO DFHEIV0
 15720     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15721     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15722     MOVE X'2020233030303134313330' TO DFHEIV0(25:11)
 15723     CALL 'kxdfhei1' USING DFHEIV0,
 15724           ELMSTR-DSID,
 15725           ELMSTR-KEY,
 15726           DFHEIV99,
 15727           DFHEIV11,
 15728           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 302
* EL130.cbl
 15729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15730
 15731
 15732     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15733
 15734 7620-READ-CLAIM-LOOP.
 15735
 15736
 15737
 15738* EXEC CICS READNEXT
 15739*        DATASET   (ELMSTR-DSID)
 15740*        SET       (ADDRESS OF CLAIM-MASTER)
 15741*        RIDFLD    (ELMSTR-KEY)
 15742*    END-EXEC.
 15743     MOVE 0
 15744       TO DFHEIV11
 15745*    MOVE '&.S                   )   #00014140' TO DFHEIV0
 15746     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15747     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15748     MOVE X'2020233030303134313430' TO DFHEIV0(25:11)
 15749     CALL 'kxdfhei1' USING DFHEIV0,
 15750           ELMSTR-DSID,
 15751           DFHEIV20,
 15752           DFHEIV99,
 15753           ELMSTR-KEY,
 15754           DFHEIV99,
 15755           DFHEIV11,
 15756           DFHEIV99,
 15757           DFHEIV99
 15758     SET ADDRESS OF CLAIM-MASTER TO
 15759         DFHEIV20
 15760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15761
 15762
 15763     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15764        CL-CARRIER     NOT = CLMCARRI       OR
 15765        CL-CLAIM-NO    NOT = CLMNOI
 15766          GO TO 7630-END-BROWSE
 15767     END-IF.
 15768
 15769     IF WS-ASSOCIATED-CERTS = 1
 15770         MOVE CL-CERT-PRIME      TO BCERT1O
 15771         MOVE CL-CERT-SFX        TO BSUFX1O
 15772     END-IF.
 15773
 15774     IF WS-ASSOCIATED-CERTS = 2
 15775         MOVE CL-CERT-PRIME      TO BCERT2O
 15776         MOVE CL-CERT-SFX        TO BSUFX2O
 15777     END-IF.
 15778
 15779     IF WS-ASSOCIATED-CERTS = 3
 15780         MOVE CL-CERT-PRIME      TO BCERT3O
 15781         MOVE CL-CERT-SFX        TO BSUFX3O
 15782     END-IF.
 15783
 15784     IF WS-ASSOCIATED-CERTS = 4
 15785         MOVE CL-CERT-PRIME      TO BCERT4O
 15786         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 303
* EL130.cbl
 15787     END-IF.
 15788
 15789     IF WS-ASSOCIATED-CERTS = 5
 15790         MOVE CL-CERT-PRIME      TO BCERT5O
 15791         MOVE CL-CERT-SFX        TO BSUFX5O
 15792     ELSE
 15793         ADD +1                  TO WS-ASSOCIATED-CERTS
 15794         GO TO 7620-READ-CLAIM-LOOP
 15795     END-IF.
 15796
 15797 7630-END-BROWSE.
 15798
 15799
 15800
 15801* EXEC CICS ENDBR
 15802*        DATASET   (ELMSTR-DSID)
 15803*    END-EXEC.
 15804     MOVE 0
 15805       TO DFHEIV11
 15806*    MOVE '&2                    $   #00014183' TO DFHEIV0
 15807     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15808     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15809     MOVE X'2020233030303134313833' TO DFHEIV0(25:11)
 15810     CALL 'kxdfhei1' USING DFHEIV0,
 15811           ELMSTR-DSID,
 15812           DFHEIV11,
 15813           DFHEIV99
 15814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15815
 15816
 15817 7640-HIGHLIGHT-CERT-DISPLAYED.
 15818
 15819     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15820     MOVE AL-SANON               TO BCERT1A
 15821                                    BSUFX1A
 15822                                    BCERT2A
 15823                                    BSUFX2A
 15824                                    BCERT3A
 15825                                    BSUFX3A
 15826                                    BCERT4A
 15827                                    BSUFX4A
 15828                                    BCERT5A
 15829                                    BSUFX5A.
 15830
 15831     IF BCERT1O = CERTNOI AND
 15832        BSUFX1O = SUFXI
 15833            MOVE AL-SABON        TO BCERT1A
 15834                                    BSUFX1A
 15835     END-IF.
 15836
 15837     IF BCERT2O = CERTNOI AND
 15838        BSUFX2O = SUFXI
 15839            MOVE AL-SABON        TO BCERT2A
 15840                                    BSUFX2A
 15841     END-IF.
 15842
 15843     IF BCERT3O = CERTNOI AND
 15844        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 304
* EL130.cbl
 15845            MOVE AL-SABON        TO BCERT3A
 15846                                    BSUFX3A
 15847     END-IF.
 15848
 15849     IF BCERT4O = CERTNOI AND
 15850        BSUFX4O = SUFXI
 15851            MOVE AL-SABON        TO BCERT4A
 15852                                    BSUFX4A
 15853     END-IF.
 15854
 15855     IF BCERT5O = CERTNOI AND
 15856        BSUFX5O = SUFXI
 15857            MOVE AL-SABON        TO BCERT5A
 15858                                    BSUFX5A
 15859     END-IF.
 15860
 15861 7699-EXIT.
 15862     EXIT.
 15863
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 305
* EL130.cbl
 15865 7700-CHECK-SEQUENCE.
 15866
 15867
 15868
 15869* EXEC CICS HANDLE CONDITION
 15870*        ENDFILE  (7799-EXIT)
 15871*        NOTFND   (7799-EXIT)
 15872*    END-EXEC.
 15873*    MOVE '"$''I                  ! K #00014238' TO DFHEIV0
 15874     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15875     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15876     MOVE X'4B20233030303134323338' TO DFHEIV0(25:11)
 15877     CALL 'kxdfhei1' USING DFHEIV0
 15878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15879
 15880
 15881
 15882
 15883* EXEC CICS READ
 15884*        DATASET(ELMSTR-DSID)
 15885*        SET    (ADDRESS OF CLAIM-MASTER)
 15886*        RIDFLD (ELMSTR-KEY)
 15887*        GENERIC
 15888*        EQUAL
 15889*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15890*    END-EXEC.
 15891*    MOVE '&"S  KG    E          (   #00014244' TO DFHEIV0
 15892     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15894     MOVE X'2020233030303134323434' TO DFHEIV0(25:11)
 15895     CALL 'kxdfhei1' USING DFHEIV0,
 15896           ELMSTR-DSID,
 15897           DFHEIV20,
 15898           DFHEIV99,
 15899           ELMSTR-KEY,
 15900           ELMSTR-GENERIC-LENGTH,
 15901           DFHEIV99,
 15902           DFHEIV99
 15903     SET ADDRESS OF CLAIM-MASTER TO
 15904         DFHEIV20
 15905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15906
 15907
 15908     COMPUTE WS-ASSOC-CERT-TOTAL =
 15909             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15910
 15911     GO TO 7799-EXIT.
 15912
 15913 7710-RESEQUENCE-CLAIMS.
 15914
 15915
 15916
 15917* EXEC CICS HANDLE CONDITION
 15918*        ENDFILE  (7790-END-BROWSE)
 15919*    END-EXEC.
 15920*    MOVE '"$''                   ! L #00014261' TO DFHEIV0
 15921     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 306
* EL130.cbl
 15923     MOVE X'4C20233030303134323631' TO DFHEIV0(25:11)
 15924     CALL 'kxdfhei1' USING DFHEIV0
 15925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15926
 15927
 15928
 15929
 15930* EXEC CICS STARTBR
 15931*        DATASET    (ELMSTR-DSID)
 15932*        RIDFLD     (ELMSTR-KEY)
 15933*    END-EXEC.
 15934     MOVE 0
 15935       TO DFHEIV11
 15936*    MOVE '&,         G          &   #00014266' TO DFHEIV0
 15937     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15938     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15939     MOVE X'2020233030303134323636' TO DFHEIV0(25:11)
 15940     CALL 'kxdfhei1' USING DFHEIV0,
 15941           ELMSTR-DSID,
 15942           ELMSTR-KEY,
 15943           DFHEIV99,
 15944           DFHEIV11,
 15945           DFHEIV99
 15946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15947
 15948
 15949     ADD +1 TO WS-ASSOC-CERT-SEQU
 15950               WS-READNEXT-SWITCH.
 15951
 15952 7720-READ-CLAIM-LOOP.
 15953
 15954
 15955
 15956* EXEC CICS READNEXT
 15957*        DATASET   (ELMSTR-DSID)
 15958*        SET       (ADDRESS OF CLAIM-MASTER)
 15959*        RIDFLD    (ELMSTR-KEY)
 15960*    END-EXEC.
 15961     MOVE 0
 15962       TO DFHEIV11
 15963*    MOVE '&.S                   )   #00014277' TO DFHEIV0
 15964     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15965     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15966     MOVE X'2020233030303134323737' TO DFHEIV0(25:11)
 15967     CALL 'kxdfhei1' USING DFHEIV0,
 15968           ELMSTR-DSID,
 15969           DFHEIV20,
 15970           DFHEIV99,
 15971           ELMSTR-KEY,
 15972           DFHEIV99,
 15973           DFHEIV11,
 15974           DFHEIV99,
 15975           DFHEIV99
 15976     SET ADDRESS OF CLAIM-MASTER TO
 15977         DFHEIV20
 15978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15979
 15980
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 307
* EL130.cbl
 15981     IF WS-READNEXT-SWITCH = 1
 15982         ADD 1 TO WS-READNEXT-SWITCH
 15983         GO TO 7720-READ-CLAIM-LOOP
 15984     END-IF.
 15985
 15986 7730-END-BROWSE.
 15987
 15988
 15989
 15990* EXEC CICS ENDBR
 15991*        DATASET   (ELMSTR-DSID)
 15992*    END-EXEC.
 15993     MOVE 0
 15994       TO DFHEIV11
 15995*    MOVE '&2                    $   #00014291' TO DFHEIV0
 15996     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15997     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15998     MOVE X'2020233030303134323931' TO DFHEIV0(25:11)
 15999     CALL 'kxdfhei1' USING DFHEIV0,
 16000           ELMSTR-DSID,
 16001           DFHEIV11,
 16002           DFHEIV99
 16003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16004
 16005
 16006 7740-READ-CLAIM-UPDATE.
 16007
 16008     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 16009        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 16010        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 16011          GO TO 7799-EXIT
 16012     ELSE
 16013          MOVE ZERO              TO WS-READNEXT-SWITCH
 16014     END-IF.
 16015
 16016
 16017
 16018* EXEC CICS READ
 16019*        DATASET(ELMSTR-DSID)
 16020*        SET    (ADDRESS OF CLAIM-MASTER)
 16021*        RIDFLD (ELMSTR-KEY)
 16022*        UPDATE
 16023*    END-EXEC.
 16024*    MOVE '&"S        EU         (   #00014306' TO DFHEIV0
 16025     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16026     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16027     MOVE X'2020233030303134333036' TO DFHEIV0(25:11)
 16028     CALL 'kxdfhei1' USING DFHEIV0,
 16029           ELMSTR-DSID,
 16030           DFHEIV20,
 16031           DFHEIV99,
 16032           ELMSTR-KEY,
 16033           DFHEIV99,
 16034           DFHEIV99,
 16035           DFHEIV99
 16036     SET ADDRESS OF CLAIM-MASTER TO
 16037         DFHEIV20
 16038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 308
* EL130.cbl
 16039
 16040
 16041     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16042     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16043
 16044
 16045
 16046* EXEC CICS REWRITE
 16047*         DATASET     (ELMSTR-DSID)
 16048*         FROM        (CLAIM-MASTER)
 16049*    END-EXEC.
 16050     MOVE LENGTH OF
 16051      CLAIM-MASTER
 16052       TO DFHEIV11
 16053*    MOVE '&& L                  %   #00014317' TO DFHEIV0
 16054     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16055     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16056     MOVE X'2020233030303134333137' TO DFHEIV0(25:11)
 16057     CALL 'kxdfhei1' USING DFHEIV0,
 16058           ELMSTR-DSID,
 16059           CLAIM-MASTER,
 16060           DFHEIV11,
 16061           DFHEIV99
 16062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16063
 16064
 16065     GO TO 7710-RESEQUENCE-CLAIMS.
 16066
 16067 7790-END-BROWSE.
 16068
 16069
 16070
 16071* EXEC CICS ENDBR
 16072*        DATASET   (ELMSTR-DSID)
 16073*    END-EXEC.
 16074     MOVE 0
 16075       TO DFHEIV11
 16076*    MOVE '&2                    $   #00014327' TO DFHEIV0
 16077     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16078     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16079     MOVE X'2020233030303134333237' TO DFHEIV0(25:11)
 16080     CALL 'kxdfhei1' USING DFHEIV0,
 16081           ELMSTR-DSID,
 16082           DFHEIV11,
 16083           DFHEIV99
 16084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16085
 16086
 16087 7799-EXIT.
 16088     EXIT.
 16089
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 309
* EL130.cbl
 16091************************************************
 16092*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 16093************************************************
 16094
 16095 7900-READ-ACTV-UPDATE.
 16096     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16097     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16098     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16099     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16100     MOVE +0                     TO TRLR-SEQ-NO.
 16101     MOVE '1'                    TO TRLR-TYPE.
 16102     GO TO 7900-READ-TRAILER-UPDATE.
 16103
 16104 7900-READ-NINETY-UPDATE.
 16105     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16106     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16107     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16108     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16109     MOVE +90                    TO TRLR-SEQ-NO.
 16110     MOVE '6'                    TO TRLR-TYPE.
 16111
 16112 7900-READ-TRAILER-UPDATE.
 16113
 16114
 16115* EXEC CICS READ  UPDATE
 16116*        DATASET    (ELTRLR-DSID)
 16117*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 16118*        RIDFLD     (ELTRLR-KEY)
 16119*    END-EXEC.
 16120*    MOVE '&"S        EU         (   #00014358' TO DFHEIV0
 16121     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16122     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16123     MOVE X'2020233030303134333538' TO DFHEIV0(25:11)
 16124     CALL 'kxdfhei1' USING DFHEIV0,
 16125           ELTRLR-DSID,
 16126           DFHEIV20,
 16127           DFHEIV99,
 16128           ELTRLR-KEY,
 16129           DFHEIV99,
 16130           DFHEIV99,
 16131           DFHEIV99
 16132     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16133         DFHEIV20
 16134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16135
 16136
 16137 7900-EXIT.
 16138      EXIT.
 16139
 16140 7910-READ-ACTV.
 16141     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16142     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16143     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16144     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16145     MOVE +0                     TO TRLR-SEQ-NO.
 16146     MOVE '1'                    TO TRLR-TYPE.
 16147     GO TO 7910-READ-TRAILER.
 16148
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 310
* EL130.cbl
 16149 7910-READ-NINETY.
 16150     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16151     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16152     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16153     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16154     MOVE +90                    TO TRLR-SEQ-NO.
 16155     MOVE '6'                    TO TRLR-TYPE.
 16156
 16157 7910-READ-TRAILER.
 16158     MOVE 'TRLR'                 TO FILE-SWITCH.
 16159
 16160
 16161
 16162* EXEC CICS READ
 16163*        DATASET   (ELTRLR-DSID)
 16164*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16165*        RIDFLD    (ELTRLR-KEY)
 16166*    END-EXEC.
 16167*    MOVE '&"S        E          (   #00014388' TO DFHEIV0
 16168     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16169     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16170     MOVE X'2020233030303134333838' TO DFHEIV0(25:11)
 16171     CALL 'kxdfhei1' USING DFHEIV0,
 16172           ELTRLR-DSID,
 16173           DFHEIV20,
 16174           DFHEIV99,
 16175           ELTRLR-KEY,
 16176           DFHEIV99,
 16177           DFHEIV99,
 16178           DFHEIV99
 16179     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16180         DFHEIV20
 16181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16182
 16183
 16184 7910-EXIT.
 16185      EXIT.
 16186
 16187 7915-REWRITE-TRAILER.
 16188
 16189
 16190* EXEC CICS REWRITE
 16191*        DATASET   (ELTRLR-DSID)
 16192*        FROM      (ACTIVITY-TRAILERS)
 16193*    END-EXEC.
 16194     MOVE LENGTH OF
 16195      ACTIVITY-TRAILERS
 16196       TO DFHEIV11
 16197*    MOVE '&& L                  %   #00014399' TO DFHEIV0
 16198     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16199     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16200     MOVE X'2020233030303134333939' TO DFHEIV0(25:11)
 16201     CALL 'kxdfhei1' USING DFHEIV0,
 16202           ELTRLR-DSID,
 16203           ACTIVITY-TRAILERS,
 16204           DFHEIV11,
 16205           DFHEIV99
 16206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 311
* EL130.cbl
 16207
 16208
 16209 7915-EXIT.
 16210      EXIT.
 16211
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 312
* EL130.cbl
 16213********************************************
 16214*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 16215********************************************
 16216
 16217 7920-READ-CLAIM-UPDATE.
 16218
 16219
 16220
 16221* EXEC CICS READ
 16222*        UPDATE
 16223*        DATASET   (ELMSTR-DSID)
 16224*        SET       (ADDRESS OF CLAIM-MASTER)
 16225*        RIDFLD    (ELMSTR-KEY)
 16226*    END-EXEC.
 16227*    MOVE '&"S        EU         (   #00014415' TO DFHEIV0
 16228     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16229     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16230     MOVE X'2020233030303134343135' TO DFHEIV0(25:11)
 16231     CALL 'kxdfhei1' USING DFHEIV0,
 16232           ELMSTR-DSID,
 16233           DFHEIV20,
 16234           DFHEIV99,
 16235           ELMSTR-KEY,
 16236           DFHEIV99,
 16237           DFHEIV99,
 16238           DFHEIV99
 16239     SET ADDRESS OF CLAIM-MASTER TO
 16240         DFHEIV20
 16241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16242
 16243
 16244 7920-EXIT.
 16245      EXIT.
 16246
 16247 7950-READ-CLAIM.
 16248
 16249
 16250* EXEC CICS READ
 16251*        DATASET   (ELMSTR-DSID)
 16252*        SET       (ADDRESS OF CLAIM-MASTER)
 16253*        RIDFLD    (ELMSTR-KEY)
 16254*    END-EXEC.
 16255*    MOVE '&"S        E          (   #00014427' TO DFHEIV0
 16256     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16257     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16258     MOVE X'2020233030303134343237' TO DFHEIV0(25:11)
 16259     CALL 'kxdfhei1' USING DFHEIV0,
 16260           ELMSTR-DSID,
 16261           DFHEIV20,
 16262           DFHEIV99,
 16263           ELMSTR-KEY,
 16264           DFHEIV99,
 16265           DFHEIV99,
 16266           DFHEIV99
 16267     SET ADDRESS OF CLAIM-MASTER TO
 16268         DFHEIV20
 16269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16270
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 313
* EL130.cbl
 16271
 16272 7950-EXIT.
 16273      EXIT.
 16274
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 314
* EL130.cbl
 16276***************************************
 16277*  I/O REQUESTS AGAINST CONTROL FILE  *
 16278***************************************
 16279
 16280 7960-READ-CNTL-UPDATE.
 16281
 16282
 16283* EXEC CICS READ
 16284*        UPDATE
 16285*        DATASET  (ELCNTL-DSID)
 16286*        SET      (ADDRESS OF CONTROL-FILE)
 16287*        RIDFLD   (ELCNTL-KEY)
 16288*    END-EXEC.
 16289*    MOVE '&"S        EU         (   #00014443' TO DFHEIV0
 16290     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16291     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16292     MOVE X'2020233030303134343433' TO DFHEIV0(25:11)
 16293     CALL 'kxdfhei1' USING DFHEIV0,
 16294           ELCNTL-DSID,
 16295           DFHEIV20,
 16296           DFHEIV99,
 16297           ELCNTL-KEY,
 16298           DFHEIV99,
 16299           DFHEIV99,
 16300           DFHEIV99
 16301     SET ADDRESS OF CONTROL-FILE TO
 16302         DFHEIV20
 16303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16304
 16305
 16306 7960-EXIT.
 16307      EXIT.
 16308
 16309 7970-READ-CNTL.
 16310
 16311
 16312* EXEC CICS READ
 16313*        DATASET  (ELCNTL-DSID)
 16314*        SET      (ADDRESS OF CONTROL-FILE)
 16315*        RIDFLD   (ELCNTL-KEY)
 16316*    END-EXEC.
 16317*    MOVE '&"S        E          (   #00014455' TO DFHEIV0
 16318     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16319     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16320     MOVE X'2020233030303134343535' TO DFHEIV0(25:11)
 16321     CALL 'kxdfhei1' USING DFHEIV0,
 16322           ELCNTL-DSID,
 16323           DFHEIV20,
 16324           DFHEIV99,
 16325           ELCNTL-KEY,
 16326           DFHEIV99,
 16327           DFHEIV99,
 16328           DFHEIV99
 16329     SET ADDRESS OF CONTROL-FILE TO
 16330         DFHEIV20
 16331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16332
 16333
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 315
* EL130.cbl
 16334 7970-EXIT.
 16335      EXIT.
 16336
 16337 7975-READ-CNTL-GTEQ.
 16338
 16339
 16340* EXEC CICS READ
 16341*         DATASET   (ELCNTL-DSID)
 16342*         SET       (ADDRESS OF CONTROL-FILE)
 16343*         RIDFLD    (ELCNTL-KEY)
 16344*         GTEQ
 16345*     END-EXEC.
 16346*    MOVE '&"S        G          (   #00014466' TO DFHEIV0
 16347     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16349     MOVE X'2020233030303134343636' TO DFHEIV0(25:11)
 16350     CALL 'kxdfhei1' USING DFHEIV0,
 16351           ELCNTL-DSID,
 16352           DFHEIV20,
 16353           DFHEIV99,
 16354           ELCNTL-KEY,
 16355           DFHEIV99,
 16356           DFHEIV99,
 16357           DFHEIV99
 16358     SET ADDRESS OF CONTROL-FILE TO
 16359         DFHEIV20
 16360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16361
 16362
 16363 7975-EXIT.
 16364      EXIT.
 16365
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 316
* EL130.cbl
 16367**************************************************
 16368*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16369**************************************************
 16370
 16371 7980-READ-CERT5.
 16372
 16373
 16374* EXEC CICS READ
 16375*         DATASET  (ELCERT5-DSID)
 16376*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16377*         RIDFLD   (ELCERT-KEY-5)
 16378*     END-EXEC.
 16379*    MOVE '&"S        E          (   #00014483' TO DFHEIV0
 16380     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16381     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16382     MOVE X'2020233030303134343833' TO DFHEIV0(25:11)
 16383     CALL 'kxdfhei1' USING DFHEIV0,
 16384           ELCERT5-DSID,
 16385           DFHEIV20,
 16386           DFHEIV99,
 16387           ELCERT-KEY-5,
 16388           DFHEIV99,
 16389           DFHEIV99,
 16390           DFHEIV99
 16391     SET ADDRESS OF CERTIFICATE-MASTER TO
 16392         DFHEIV20
 16393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16394
 16395
 16396 7980-EXIT.
 16397      EXIT.
 16398
 16399 7930-READ-CERT-UPDATE.
 16400
 16401
 16402* EXEC CICS READ
 16403*        DATASET  (ELCERT-DSID)
 16404*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16405*        RIDFLD   (ELCERT-KEY)
 16406*        UPDATE
 16407*    END-EXEC.
 16408*    MOVE '&"S        EU         (   #00014494' TO DFHEIV0
 16409     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16410     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16411     MOVE X'2020233030303134343934' TO DFHEIV0(25:11)
 16412     CALL 'kxdfhei1' USING DFHEIV0,
 16413           ELCERT-DSID,
 16414           DFHEIV20,
 16415           DFHEIV99,
 16416           ELCERT-KEY,
 16417           DFHEIV99,
 16418           DFHEIV99,
 16419           DFHEIV99
 16420     SET ADDRESS OF CERTIFICATE-MASTER TO
 16421         DFHEIV20
 16422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16423
 16424
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 317
* EL130.cbl
 16425 7930-EXIT.
 16426      EXIT.
 16427
 16428 7940-READ-CERT.
 16429
 16430
 16431* EXEC CICS READ
 16432*        DATASET  (ELCERT-DSID)
 16433*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16434*        RIDFLD   (ELCERT-KEY)
 16435*    END-EXEC.
 16436*    MOVE '&"S        E          (   #00014506' TO DFHEIV0
 16437     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16439     MOVE X'2020233030303134353036' TO DFHEIV0(25:11)
 16440     CALL 'kxdfhei1' USING DFHEIV0,
 16441           ELCERT-DSID,
 16442           DFHEIV20,
 16443           DFHEIV99,
 16444           ELCERT-KEY,
 16445           DFHEIV99,
 16446           DFHEIV99,
 16447           DFHEIV99
 16448     SET ADDRESS OF CERTIFICATE-MASTER TO
 16449         DFHEIV20
 16450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16451
 16452
 16453 7940-EXIT.
 16454      EXIT.
 16455
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 318
* EL130.cbl
 16457**************************************************
 16458*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16459**************************************************
 16460
 16461 7991-READ-BENE.
 16462
 16463
 16464* EXEC CICS READ
 16465*         DATASET   (ELBENE-DSID)
 16466*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16467*         RIDFLD    (ELBENE-KEY)
 16468*     END-EXEC.
 16469*    MOVE '&"S        E          (   #00014522' TO DFHEIV0
 16470     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16472     MOVE X'2020233030303134353232' TO DFHEIV0(25:11)
 16473     CALL 'kxdfhei1' USING DFHEIV0,
 16474           ELBENE-DSID,
 16475           DFHEIV20,
 16476           DFHEIV99,
 16477           ELBENE-KEY,
 16478           DFHEIV99,
 16479           DFHEIV99,
 16480           DFHEIV99
 16481     SET ADDRESS OF BENEFICIARY-MASTER TO
 16482         DFHEIV20
 16483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16484
 16485
 16486 7991-EXIT.
 16487      EXIT.
 16488
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 319
* EL130.cbl
 16490**************************************************
 16491*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16492**************************************************
 16493
 16494 7992-READ-REIN.
 16495
 16496
 16497
 16498* EXEC CICS HANDLE CONDITION
 16499*        NOTFND   (7992-NOT-FOUND)
 16500*    END-EXEC.
 16501*    MOVE '"$I                   ! M #00014539' TO DFHEIV0
 16502     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16504     MOVE X'4D20233030303134353339' TO DFHEIV0(25:11)
 16505     CALL 'kxdfhei1' USING DFHEIV0
 16506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16507
 16508
 16509
 16510
 16511* EXEC CICS READ
 16512*        DATASET   (ERREIN-DSID)
 16513*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16514*        RIDFLD    (ERREIN-KEY)
 16515*    END-EXEC.
 16516*    MOVE '&"S        E          (   #00014544' TO DFHEIV0
 16517     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16518     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16519     MOVE X'2020233030303134353434' TO DFHEIV0(25:11)
 16520     CALL 'kxdfhei1' USING DFHEIV0,
 16521           ERREIN-DSID,
 16522           DFHEIV20,
 16523           DFHEIV99,
 16524           ERREIN-KEY,
 16525           DFHEIV99,
 16526           DFHEIV99,
 16527           DFHEIV99
 16528     SET ADDRESS OF REINSURANCE-RECORD TO
 16529         DFHEIV20
 16530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16531
 16532
 16533     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16534
 16535     GO TO 7992-EXIT.
 16536
 16537 7992-NOT-FOUND.
 16538     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16539
 16540 7992-EXIT.
 16541     EXIT.
 16542
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 320
* EL130.cbl
 16544 8000-LOAD-ERROR-MESSAGES.
 16545     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16546
 16547     IF EMI-NO-ERRORS
 16548         GO TO 8000-EXIT
 16549     END-IF.
 16550
 16551     perform varying e1 from +1 by +1 until e1 > +3
 16552        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16553                                or '1655' or '1660'
 16554           move 'W'              to emi-severity (e1)
 16555        end-if
 16556     end-perform
 16557     IF EMI-NUMBER-OF-LINES = 1
 16558         MOVE EMI-LINE1          TO ERRMSG1O
 16559         GO TO 8000-EXIT
 16560     END-IF.
 16561
 16562     IF EMI-NUMBER-OF-LINES = 2
 16563          MOVE EMI-LINE1         TO ERRMSG1O
 16564          MOVE EMI-LINE2         TO ERRMSG2O
 16565          GO TO 8000-EXIT
 16566     END-IF.
 16567
 16568     MOVE EMI-LINE1              TO ERRMSG1O.
 16569
 16570 8000-EXIT.
 16571     EXIT.
 16572
 16573 8100-SEND-INITIAL-MAP.
 16574     MOVE SAVE-DATE              TO RUNDTEO.
 16575     MOVE EIBTIME                TO TIME-IN.
 16576     MOVE TIME-OUT               TO RUNTIMEO.
 16577     IF EIBAID = DFHPF11
 16578        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16580     end-if
 16581     IF RETURNED-FROM = XCTL-114
 16582        CONTINUE
 16583     ELSE
 16584        MOVE -1                  TO MAINTL
 16585     END-IF.
 16586
 16587*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16588         MOVE SPACES             TO PRODO.
 16589         MOVE AL-SANOF           TO PRODCDA.
 16590*    END-IF.
 16591
 16592     MOVE PI-COMPANY-ID          TO COMPO.
 16593     MOVE AL-PABOF               TO COMPA.
 16594     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16595     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16596     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16597
 16598     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16599
 16600     IF NOT PI-NO-CARRIER-SECURITY
 16601        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 321
* EL130.cbl
 16602        MOVE AL-SABOF            TO CLMCARRA
 16603     END-IF.
 16604
 16605     IF PI-PROCESSOR-ID = 'PEMA'
 16606        MOVE AL-UANON            TO CERTNOA
 16607                                    SUFXA
 16608     END-IF.
 16609*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16610*        NEXT SENTENCE
 16611*        CONTINUE
 16612*    ELSE
 16613         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16614*    END-IF.
 16615
 16616
 16617
 16618* EXEC CICS SEND
 16619*        MAP     (MAP-NAME)
 16620*        MAPSET  (MAPSET-NAME)
 16621*        FROM    (EL130AO)
 16622*        ERASE
 16623*        CURSOR
 16624*    END-EXEC.
 16625     MOVE LENGTH OF
 16626      EL130AO
 16627       TO DFHEIV12
 16628     MOVE -1
 16629       TO DFHEIV11
 16630*    MOVE '8$     CT  E    H L F ,   #00014634' TO DFHEIV0
 16631     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16632     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16633     MOVE X'2020233030303134363334' TO DFHEIV0(25:11)
 16634     CALL 'kxdfhei1' USING DFHEIV0,
 16635           MAP-NAME,
 16636           EL130AO,
 16637           DFHEIV12,
 16638           MAPSET-NAME,
 16639           DFHEIV99,
 16640           DFHEIV99,
 16641           DFHEIV99,
 16642           DFHEIV11,
 16643           DFHEIV99,
 16644           DFHEIV99,
 16645           DFHEIV99
 16646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16647
 16648
 16649     GO TO 9100-RETURN-TRAN.
 16650
 16651 8150-SEND-MAP-CURSOR.
 16652     MOVE SAVE-DATE              TO RUNDTEO.
 16653     MOVE EIBTIME                TO TIME-IN.
 16654     MOVE TIME-OUT               TO RUNTIMEO.
 16655     IF EIBAID = DFHPF11
 16656        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16658     end-if
 16659     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 322
* EL130.cbl
 16660     MOVE AL-PABOF               TO COMPA
 16661     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16662     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16663     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16664
 16665*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16666         MOVE SPACES             TO PRODO.
 16667         MOVE AL-SANOF           TO PRODCDA.
 16668*    END-IF.
 16669
 16670     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16671
 16672     IF NOT PI-NO-CARRIER-SECURITY
 16673         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16674         MOVE AL-SABOF            TO CLMCARRA
 16675     END-IF.
 16676
 16677     IF PI-PROCESSOR-ID = 'PEMA'
 16678        MOVE AL-UANON            TO CERTNOA
 16679                                    SUFXA
 16680     END-IF.
 16681*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16682*        NEXT SENTENCE
 16683*        CONTINUE
 16684*    ELSE
 16685         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16686*    END-IF.
 16687
 16688
 16689
 16690* EXEC CICS SEND
 16691*        MAP      (MAP-NAME)
 16692*        MAPSET   (MAPSET-NAME)
 16693*        FROM     (EL130AO)
 16694*        CURSOR   (PI-CURSOR)
 16695*        ERASE
 16696*    END-EXEC.
 16697     MOVE LENGTH OF
 16698      EL130AO
 16699       TO DFHEIV11
 16700*    MOVE '8$     CT  E    H L F ,   #00014682' TO DFHEIV0
 16701     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16702     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16703     MOVE X'2020233030303134363832' TO DFHEIV0(25:11)
 16704     CALL 'kxdfhei1' USING DFHEIV0,
 16705           MAP-NAME,
 16706           EL130AO,
 16707           DFHEIV11,
 16708           MAPSET-NAME,
 16709           DFHEIV99,
 16710           DFHEIV99,
 16711           DFHEIV99,
 16712           PI-CURSOR,
 16713           DFHEIV99,
 16714           DFHEIV99,
 16715           DFHEIV99
 16716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16717
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 323
* EL130.cbl
 16718
 16719     GO TO 9100-RETURN-TRAN.
 16720
 16721 8200-SEND-DATAONLY.
 16722     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16723
 16724     IF EIBAID = DFHPF11
 16725        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16727        go to 8100-send-initial-map
 16728     end-if
 16729*    IF EIBAID = DFHPF11
 16730*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16731*       move pi-last-claim       to emi-claim-no
 16732*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16733*       go to 8100-send-initial-map
 16734*    END-IF.
 16735     .
 16736 8200-BYPASS-ERROR.
 16737     MOVE SAVE-DATE              TO RUNDTEO.
 16738     MOVE EIBTIME                TO TIME-IN.
 16739     MOVE TIME-OUT               TO RUNTIMEO.
 16740     MOVE PI-COMPANY-ID          TO COMPO.
 16741     MOVE AL-PABOF               TO COMPA
 16742     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16743
 16744*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16745         MOVE SPACES             TO PRODO.
 16746         MOVE AL-SANOF           TO PRODCDA.
 16747*    END-IF.
 16748
 16749     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16750     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16751
 16752     IF PI-PROCESSOR-ID = 'PEMA'
 16753        MOVE AL-UANON            TO CERTNOA
 16754                                    SUFXA
 16755     END-IF.
 16756     IF NOT PI-NO-CARRIER-SECURITY
 16757        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16758        MOVE AL-SABOF            TO CLMCARRA
 16759     END-IF.
 16760
 16761*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16762*        NEXT SENTENCE
 16763*        CONTINUE
 16764*    ELSE
 16765         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16766*    END-IF.
 16767
 16768*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16769         MOVE AL-SANOF           TO PRODCDA.
 16770*    END-IF.
 16771
 16772
 16773
 16774* EXEC CICS SEND
 16775*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 324
* EL130.cbl
 16776*        MAPSET   (MAPSET-NAME)
 16777*        FROM     (EL130AO)
 16778*        DATAONLY
 16779*        CURSOR
 16780*    END-EXEC.
 16781     MOVE LENGTH OF
 16782      EL130AO
 16783       TO DFHEIV12
 16784     MOVE -1
 16785       TO DFHEIV11
 16786*    MOVE '8$D    CT       H L F ,   #00014744' TO DFHEIV0
 16787     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16788     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16789     MOVE X'2020233030303134373434' TO DFHEIV0(25:11)
 16790     CALL 'kxdfhei1' USING DFHEIV0,
 16791           MAP-NAME,
 16792           EL130AO,
 16793           DFHEIV12,
 16794           MAPSET-NAME,
 16795           DFHEIV99,
 16796           DFHEIV99,
 16797           DFHEIV99,
 16798           DFHEIV11,
 16799           DFHEIV99,
 16800           DFHEIV99,
 16801           DFHEIV99
 16802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16803
 16804
 16805     GO TO 9100-RETURN-TRAN.
 16806
 16807 8300-SEND-TEXT.
 16808
 16809
 16810* EXEC CICS SEND TEXT
 16811*        FROM     (LOGOFF-TEXT)
 16812*        LENGTH   (LOGOFF-LENGTH)
 16813*        ERASE
 16814*        FREEKB
 16815*    END-EXEC.
 16816*    MOVE '8&      T  E F  H   F -   #00014756' TO DFHEIV0
 16817     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16818     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16819     MOVE X'2020233030303134373536' TO DFHEIV0(25:11)
 16820     CALL 'kxdfhei1' USING DFHEIV0,
 16821           LOGOFF-TEXT,
 16822           LOGOFF-LENGTH,
 16823           DFHEIV99,
 16824           DFHEIV99,
 16825           DFHEIV99,
 16826           DFHEIV99,
 16827           DFHEIV99,
 16828           DFHEIV99,
 16829           DFHEIV99,
 16830           DFHEIV99,
 16831           DFHEIV99,
 16832           DFHEIV99
 16833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 325
* EL130.cbl
 16834
 16835
 16836
 16837
 16838* EXEC CICS RETURN
 16839*    END-EXEC.
 16840*    MOVE '.(                    ''   #00014764' TO DFHEIV0
 16841     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16842     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16843     MOVE X'2020233030303134373634' TO DFHEIV0(25:11)
 16844     CALL 'kxdfhei1' USING DFHEIV0,
 16845           DFHEIV99,
 16846           DFHEIV99,
 16847           DFHEIV99,
 16848           DFHEIV99,
 16849           DFHEIV99,
 16850           DFHEIV99
 16851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16852
 16853
 16854 8800-UNAUTHORIZED-ACCESS.
 16855     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16856     GO TO 8300-SEND-TEXT.
 16857
 16858 8810-PF23.
 16859     MOVE EIBAID TO PI-ENTRY-CD-1.
 16860     MOVE XCTL-005               TO PGM-NAME.
 16861     GO TO 9300-XCTL.
 16862
 16863 8820-TERM-ERROR.
 16864     MOVE ER-0412                TO EMI-ERROR.
 16865     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16866     MOVE -1                     TO MAINTL.
 16867     GO TO 8200-SEND-DATAONLY.
 16868
 16869 8830-TRAN-ERROR.
 16870     MOVE ER-0413                TO EMI-ERROR.
 16871     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16872     MOVE -1                     TO MAINTL.
 16873     GO TO 8200-SEND-DATAONLY.
 16874
 16875 9000-RETURN-CICS.
 16876
 16877
 16878* EXEC CICS RETURN
 16879*    END-EXEC.
 16880*    MOVE '.(                    ''   #00014790' TO DFHEIV0
 16881     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16882     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16883     MOVE X'2020233030303134373930' TO DFHEIV0(25:11)
 16884     CALL 'kxdfhei1' USING DFHEIV0,
 16885           DFHEIV99,
 16886           DFHEIV99,
 16887           DFHEIV99,
 16888           DFHEIV99,
 16889           DFHEIV99,
 16890           DFHEIV99
 16891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 326
* EL130.cbl
 16892
 16893
 16894 9100-RETURN-TRAN.
 16895     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16896     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16897
 16898
 16899
 16900* EXEC CICS RETURN
 16901*        TRANSID   (TRANS-ID)
 16902*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16903*        LENGTH    (PI-COMM-LENGTH)
 16904*    END-EXEC.
 16905*    MOVE '.(CT                  ''   #00014798' TO DFHEIV0
 16906     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16907     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16908     MOVE X'2020233030303134373938' TO DFHEIV0(25:11)
 16909     CALL 'kxdfhei1' USING DFHEIV0,
 16910           TRANS-ID,
 16911           PROGRAM-INTERFACE-BLOCK,
 16912           PI-COMM-LENGTH,
 16913           DFHEIV99,
 16914           DFHEIV99,
 16915           DFHEIV99
 16916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16917
 16918
 16919 9200-RETURN-MAIN-MENU.
 16920     MOVE XCTL-126               TO PGM-NAME.
 16921     GO TO 9300-XCTL.
 16922
 16923 9300-XCTL.
 16924
 16925
 16926* EXEC CICS XCTL
 16927*        PROGRAM   (PGM-NAME)
 16928*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16929*        LENGTH    (PI-COMM-LENGTH)
 16930*    END-EXEC.
 16931*    MOVE '.$C                   %   #00014810' TO DFHEIV0
 16932     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16933     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16934     MOVE X'2020233030303134383130' TO DFHEIV0(25:11)
 16935     CALL 'kxdfhei1' USING DFHEIV0,
 16936           PGM-NAME,
 16937           PROGRAM-INTERFACE-BLOCK,
 16938           PI-COMM-LENGTH,
 16939           DFHEIV99
 16940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16941
 16942
 16943 9400-CLEAR.
 16944     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16945     GO TO 9300-XCTL.
 16946
 16947 9500-PF12.
 16948     MOVE XCTL-010               TO PGM-NAME.
 16949     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 327
* EL130.cbl
 16950
 16951 9600-PGMID-ERROR.
 16952
 16953
 16954* EXEC CICS HANDLE CONDITION
 16955*        PGMIDERR  (8300-SEND-TEXT)
 16956*    END-EXEC.
 16957*    MOVE '"$L                   ! N #00014826' TO DFHEIV0
 16958     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16959     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16960     MOVE X'4E20233030303134383236' TO DFHEIV0(25:11)
 16961     CALL 'kxdfhei1' USING DFHEIV0
 16962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16963
 16964
 16965     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16966     MOVE ' '                    TO PI-ENTRY-CD-1.
 16967     MOVE XCTL-005               TO PGM-NAME.
 16968     MOVE PGM-NAME               TO LOGOFF-PGM.
 16969     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16970     GO TO 9300-XCTL.
 16971
 16972 9700-LINK-DATE-CONVERT.
 16973     MOVE LINK-ELDATCV           TO PGM-NAME.
 16974
 16975
 16976* EXEC CICS LINK
 16977*        PROGRAM    (PGM-NAME)
 16978*        COMMAREA   (DATE-CONVERSION-DATA)
 16979*        LENGTH     (DC-COMM-LENGTH)
 16980*    END-EXEC.
 16981*    MOVE '."C                   (   #00014840' TO DFHEIV0
 16982     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16983     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16984     MOVE X'2020233030303134383430' TO DFHEIV0(25:11)
 16985     CALL 'kxdfhei1' USING DFHEIV0,
 16986           PGM-NAME,
 16987           DATE-CONVERSION-DATA,
 16988           DC-COMM-LENGTH,
 16989           DFHEIV99,
 16990           DFHEIV99,
 16991           DFHEIV99,
 16992           DFHEIV99
 16993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16994
 16995
 16996 9700-EXIT.
 16997     EXIT.
 16998
 16999 9800-LINK-REM-TERM.
 17000     MOVE LINK-ELRTRM            TO PGM-NAME.
 17001
 17002
 17003* EXEC CICS LINK
 17004*        PROGRAM    (PGM-NAME)
 17005*        COMMAREA   (CALCULATION-PASS-AREA)
 17006*        LENGTH     (CP-COMM-LENGTH)
 17007*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 328
* EL130.cbl
 17008*    MOVE '."C                   (   #00014852' TO DFHEIV0
 17009     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17010     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17011     MOVE X'2020233030303134383532' TO DFHEIV0(25:11)
 17012     CALL 'kxdfhei1' USING DFHEIV0,
 17013           PGM-NAME,
 17014           CALCULATION-PASS-AREA,
 17015           CP-COMM-LENGTH,
 17016           DFHEIV99,
 17017           DFHEIV99,
 17018           DFHEIV99,
 17019           DFHEIV99
 17020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17021
 17022
 17023 9800-EXIT.
 17024     EXIT.
 17025
 17026 9900-ERROR-FORMAT.
 17027*    if emi-error = 1651 or 1652 or 1653 or 1655
 17028*       display ' 9900 error ' emi-error
 17029*       display emi-message-area (1)
 17030*       display emi-message-area (2)
 17031*       display emi-message-area (3)
 17032*    end-if
 17033     IF NOT EMI-ERRORS-COMPLETE
 17034         MOVE LINK-001           TO PGM-NAME
 17035
 17036* EXEC CICS LINK
 17037*            PROGRAM   (PGM-NAME)
 17038*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 17039*            LENGTH    (EMI-COMM-LENGTH)
 17040*        END-EXEC
 17041*    MOVE '."C                   (   #00014870' TO DFHEIV0
 17042     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17043     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17044     MOVE X'2020233030303134383730' TO DFHEIV0(25:11)
 17045     CALL 'kxdfhei1' USING DFHEIV0,
 17046           PGM-NAME,
 17047           ERROR-MESSAGE-INTERFACE-BLOCK,
 17048           EMI-COMM-LENGTH,
 17049           DFHEIV99,
 17050           DFHEIV99,
 17051           DFHEIV99,
 17052           DFHEIV99
 17053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17054         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 17055            subtract 1 from emi-fatal-ctr
 17056         end-if
 17057     END-IF.
 17058
 17059     .
 17060 9900-EXIT.
 17061     EXIT.
 17062
 17063 9990-ABEND.
 17064     MOVE -1                     TO MAINTL.
 17065     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 329
* EL130.cbl
 17066     MOVE DFHEIBLK               TO EMI-LINE1.
 17067
 17068
 17069* EXEC CICS LINK
 17070*        PROGRAM   (PGM-NAME)
 17071*        COMMAREA  (EMI-LINE1)
 17072*        LENGTH    (72)
 17073*    END-EXEC.
 17074     MOVE 72
 17075       TO DFHEIV11
 17076*    MOVE '."C                   (   #00014889' TO DFHEIV0
 17077     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17078     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17079     MOVE X'2020233030303134383839' TO DFHEIV0(25:11)
 17080     CALL 'kxdfhei1' USING DFHEIV0,
 17081           PGM-NAME,
 17082           EMI-LINE1,
 17083           DFHEIV11,
 17084           DFHEIV99,
 17085           DFHEIV99,
 17086           DFHEIV99,
 17087           DFHEIV99
 17088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17089
 17090
 17091     MOVE EMI-LINE1              TO ERRMSG2O.
 17092
 17093     GO TO 8200-BYPASS-ERROR.
 17094
 17095
 17096
 17097* GOBACK.
 17098     MOVE '9%                    "   ' TO DFHEIV0
 17099     MOVE 'EL130' TO DFHEIV1
 17100     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17101     GOBACK.
 17102
 17103 9995-SECURITY-VIOLATION.
 17104*             COPY ELCSCTP.
 17105******************************************************************
 17106*                                                                *
 17107*                            ELCSCTP                             *
 17108*                            VMOD=2.001                          *
 17109*                                                                *
 17110*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17111******************************************************************
 17112
 17113
 17114     MOVE EIBDATE          TO SM-JUL-DATE.
 17115     MOVE EIBTRMID         TO SM-TERMID.
 17116     MOVE THIS-PGM         TO SM-PGM.
 17117     MOVE EIBTIME          TO TIME-IN.
 17118     MOVE TIME-OUT         TO SM-TIME.
 17119     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17120
 17121
 17122* EXEC CICS LINK
 17123*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 330
* EL130.cbl
 17124*         COMMAREA (SECURITY-MESSAGE)
 17125*         LENGTH   (80)
 17126*    END-EXEC.
 17127     MOVE 'EL003' TO DFHEIV1
 17128     MOVE 80
 17129       TO DFHEIV11
 17130*    MOVE '."C                   (   #00014920' TO DFHEIV0
 17131     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17132     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17133     MOVE X'2020233030303134393230' TO DFHEIV0(25:11)
 17134     CALL 'kxdfhei1' USING DFHEIV0,
 17135           DFHEIV1,
 17136           SECURITY-MESSAGE,
 17137           DFHEIV11,
 17138           DFHEIV99,
 17139           DFHEIV99,
 17140           DFHEIV99,
 17141           DFHEIV99
 17142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17143
 17144
 17145******************************************************************
 17146
 17147
 17148 9995-EXIT.
 17149     EXIT.
 17150
 17151
 17152 9999-DFHBACK SECTION.
 17153     MOVE '9%                    "   ' TO DFHEIV0
 17154     MOVE 'EL130' TO DFHEIV1
 17155     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17156     GOBACK.
 17157 9999-DFHEXIT.
 17158     IF DFHEIGDJ EQUAL 0001
 17159         NEXT SENTENCE
 17160     ELSE IF DFHEIGDJ EQUAL 2
 17161         GO TO 0100-TEST-ENTRY,
 17162               8100-SEND-INITIAL-MAP,
 17163               9600-PGMID-ERROR,
 17164               8820-TERM-ERROR,
 17165               8830-TRAN-ERROR,
 17166               9990-ABEND
 17167         DEPENDING ON DFHEIGDI
 17168     ELSE IF DFHEIGDJ EQUAL 3
 17169         GO TO 0450-ADD-ELACTQ-RECORD
 17170         DEPENDING ON DFHEIGDI
 17171     ELSE IF DFHEIGDJ EQUAL 4
 17172         GO TO 8820-TERM-ERROR,
 17173               8830-TRAN-ERROR
 17174         DEPENDING ON DFHEIGDI
 17175     ELSE IF DFHEIGDJ EQUAL 5
 17176         GO TO 0660-NOT-FOUND,
 17177               0670-QIDERR
 17178         DEPENDING ON DFHEIGDI
 17179     ELSE IF DFHEIGDJ EQUAL 6
 17180         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17181         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 331
* EL130.cbl
 17182     ELSE IF DFHEIGDJ EQUAL 7
 17183         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17184         DEPENDING ON DFHEIGDI
 17185     ELSE IF DFHEIGDJ EQUAL 8
 17186         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17187         DEPENDING ON DFHEIGDI
 17188     ELSE IF DFHEIGDJ EQUAL 9
 17189         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17190         DEPENDING ON DFHEIGDI
 17191     ELSE IF DFHEIGDJ EQUAL 10
 17192         GO TO 2050-DELETE-NOT-FOUND
 17193         DEPENDING ON DFHEIGDI
 17194     ELSE IF DFHEIGDJ EQUAL 11
 17195         GO TO 2010-DELETE-CL
 17196         DEPENDING ON DFHEIGDI
 17197     ELSE IF DFHEIGDJ EQUAL 12
 17198         GO TO 3010-TEST-FOR-ERRORS
 17199         DEPENDING ON DFHEIGDI
 17200     ELSE IF DFHEIGDJ EQUAL 13
 17201         GO TO 3008-DUP-ERROR,
 17202               3009-NOT-FOUND
 17203         DEPENDING ON DFHEIGDI
 17204     ELSE IF DFHEIGDJ EQUAL 14
 17205         GO TO 3030-BUILD-CONT
 17206         DEPENDING ON DFHEIGDI
 17207     ELSE IF DFHEIGDJ EQUAL 15
 17208         GO TO 3033-ACCT-NOT-FOUND,
 17209               3033-ACCT-NOT-FOUND
 17210         DEPENDING ON DFHEIGDI
 17211     ELSE IF DFHEIGDJ EQUAL 16
 17212         GO TO 3032-NOT-IN-DT-RANGE
 17213         DEPENDING ON DFHEIGDI
 17214     ELSE IF DFHEIGDJ EQUAL 17
 17215         GO TO 3070-BUILD-CONT
 17216         DEPENDING ON DFHEIGDI
 17217     ELSE IF DFHEIGDJ EQUAL 18
 17218         GO TO 3065-CERT-NOT-FOUND
 17219         DEPENDING ON DFHEIGDI
 17220     ELSE IF DFHEIGDJ EQUAL 19
 17221         GO TO 3100-CARRIER-NOT-FOUND
 17222         DEPENDING ON DFHEIGDI
 17223     ELSE IF DFHEIGDJ EQUAL 20
 17224         GO TO 3110-COMPANY-NOT-FOUND
 17225         DEPENDING ON DFHEIGDI
 17226     ELSE IF DFHEIGDJ EQUAL 21
 17227         GO TO 3200-BUILD-ZERO-TRAILER
 17228         DEPENDING ON DFHEIGDI
 17229     ELSE IF DFHEIGDJ EQUAL 22
 17230         GO TO 9999-DFHBACK
 17231         DEPENDING ON DFHEIGDI
 17232     ELSE IF DFHEIGDJ EQUAL 23
 17233         GO TO 3290-NO-INSURED-ADDRESS
 17234         DEPENDING ON DFHEIGDI
 17235     ELSE IF DFHEIGDJ EQUAL 24
 17236         GO TO 3410-DUP-KEY
 17237         DEPENDING ON DFHEIGDI
 17238     ELSE IF DFHEIGDJ EQUAL 25
 17239         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 332
* EL130.cbl
 17240         DEPENDING ON DFHEIGDI
 17241     ELSE IF DFHEIGDJ EQUAL 26
 17242         GO TO 3850-CLAIM-MSTR-WRITTEN
 17243         DEPENDING ON DFHEIGDI
 17244     ELSE IF DFHEIGDJ EQUAL 27
 17245         GO TO 3992-DUPREC
 17246         DEPENDING ON DFHEIGDI
 17247     ELSE IF DFHEIGDJ EQUAL 28
 17248         GO TO 5050-CERT-NOT-FOUND
 17249         DEPENDING ON DFHEIGDI
 17250     ELSE IF DFHEIGDJ EQUAL 29
 17251         GO TO 5030-CERT-WRITTEN
 17252         DEPENDING ON DFHEIGDI
 17253     ELSE IF DFHEIGDJ EQUAL 30
 17254         GO TO 5035-CLAIM-WRITTEN
 17255         DEPENDING ON DFHEIGDI
 17256     ELSE IF DFHEIGDJ EQUAL 31
 17257         GO TO 9990-ABEND,
 17258               5799-EXIT
 17259         DEPENDING ON DFHEIGDI
 17260     ELSE IF DFHEIGDJ EQUAL 32
 17261         GO TO 3100-CARRIER-NOT-FOUND
 17262         DEPENDING ON DFHEIGDI
 17263     ELSE IF DFHEIGDJ EQUAL 33
 17264         GO TO 6040-NO-PROCESSOR-RECORD
 17265         DEPENDING ON DFHEIGDI
 17266     ELSE IF DFHEIGDJ EQUAL 34
 17267         GO TO 6060-NO-BENEFICIARY-RECORD
 17268         DEPENDING ON DFHEIGDI
 17269     ELSE IF DFHEIGDJ EQUAL 35
 17270         GO TO 6499-EXIT,
 17271               6499-EXIT
 17272         DEPENDING ON DFHEIGDI
 17273     ELSE IF DFHEIGDJ EQUAL 36
 17274         GO TO 6600-NOT-FOUND
 17275         DEPENDING ON DFHEIGDI
 17276     ELSE IF DFHEIGDJ EQUAL 37
 17277         GO TO 6700-NOTOPEN-ERROR,
 17278               6700-EXIT
 17279         DEPENDING ON DFHEIGDI
 17280     ELSE IF DFHEIGDJ EQUAL 38
 17281         GO TO 7120-NOT-FOUND
 17282         DEPENDING ON DFHEIGDI
 17283     ELSE IF DFHEIGDJ EQUAL 39
 17284         GO TO 7499-EXIT
 17285         DEPENDING ON DFHEIGDI
 17286     ELSE IF DFHEIGDJ EQUAL 40
 17287         GO TO 7500-EXIT,
 17288               7500-DUPLICATE-KEY,
 17289               7500-EXIT
 17290         DEPENDING ON DFHEIGDI
 17291     ELSE IF DFHEIGDJ EQUAL 41
 17292         GO TO 7500-END-BROWSE
 17293         DEPENDING ON DFHEIGDI
 17294     ELSE IF DFHEIGDJ EQUAL 42
 17295         GO TO 7630-END-BROWSE
 17296         DEPENDING ON DFHEIGDI
 17297     ELSE IF DFHEIGDJ EQUAL 43
* Micro Focus Server Express         V5.1 revision 000 17-Jul-20 09:31 Page 333
* EL130.cbl
 17298         GO TO 7799-EXIT,
 17299               7799-EXIT
 17300         DEPENDING ON DFHEIGDI
 17301     ELSE IF DFHEIGDJ EQUAL 44
 17302         GO TO 7790-END-BROWSE
 17303         DEPENDING ON DFHEIGDI
 17304     ELSE IF DFHEIGDJ EQUAL 45
 17305         GO TO 7992-NOT-FOUND
 17306         DEPENDING ON DFHEIGDI
 17307     ELSE IF DFHEIGDJ EQUAL 46
 17308         GO TO 8300-SEND-TEXT
 17309         DEPENDING ON DFHEIGDI.
 17310     MOVE '9%                    "   ' TO DFHEIV0
 17311     MOVE 'EL130' TO DFHEIV1
 17312     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17313     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12864     Code:       54999
