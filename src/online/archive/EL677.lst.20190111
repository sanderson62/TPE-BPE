* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    35* 091615  CR2015082000001  PEMA  ADD TOTAL ENDT PROCESSING
    36* 020317  IR2016110900001  PEMA  FIXED MISC PROBLEMS
    37* 060717  CR2017032900002  PEMA  CHANGE TEST DB
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    46 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    47 77  s1                          pic s999 comp-3 value +0.
    48 77  s2                          pic s999 comp-3 value +0.
    49 77  ws-display-amt              pic 9(9).99-.
    50 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    51 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    52 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    53 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    54 77  ws-browse-sw                pic x value spaces.
    55     88  i-say-when                 value 'Y'.
    56 77  ws-delete-sw                pic x value ' '.
    57     88  row-deleted                 value 'Y'.
    58 77  ws-sql-code                 pic s9(7) value zeros.
    59 77  ws-dis-sql-code             pic -9999999 value zeros.
    60 77  ws-match-sw                 pic x  value ' '.
    61     88  found-a-match             value 'Y'.
    62 77  ws-commit-sw                pic x value ' '.
    63     88  tbl-commited                value 'Y'.
    64 01  P pointer.
    65 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    66 01  var-ptr pointer.
    67 01  env-var-len                 pic 9(4)  binary.
    68 01  rc                          pic 9(9)  binary.
    69
    70 01  WS-KIXSYS.
    71     05  WS-KIX-FIL1             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   3
* EL677.cbl
    72     05  WS-KIX-APPS             PIC X(10).
    73     05  WS-KIX-ENV              PIC X(10).
    74     05  WS-KIX-MYENV            PIC X(10).
    75     05  WS-KIX-SYS              PIC X(10).
*   76 EXEC SQL
*   77    INCLUDE SQLDA
*   78 END-EXEC
    79 01 SQLDA sync.
    80    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    81    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    82    05 SQLN                  PIC S9(4) COMP-5 value 0.
    83    05 SQLD                  PIC S9(4) COMP-5 value 0.
    84    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    85       10 SQLTYPE            PIC S9(4) COMP-5.
    86       10 SQLLEN             PIC S9(4) COMP-5.
    87$IF P64 SET
    88X      *> For 64-bit environments, ensure that SQLDATA is
    89X      *> aligned on an 8-byte boundary.
    90X      10 FILLER             PIC S9(9) COMP-5.
    91$END
    92       10 SQLDATA            USAGE POINTER.
    93       10 SQLIND             USAGE POINTER.
    94       10 SQLNAME.
    95          15 SQLNAMEL        PIC S9(4) COMP-5.
    96          15 SQLNAMEC        PIC X(30).
    97
    98* Values for SQLTYPE
    99
   100 78  ESQL-DATE-CHAR              VALUE 384.
   101 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   102 78  ESQL-DATE-REC               VALUE 386.
   103 78  ESQL-DATE-REC-NULL          VALUE 387.
   104 78  ESQL-TIME-CHAR              VALUE 388.
   105 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   106 78  ESQL-TIME-REC               VALUE 390.
   107 78  ESQL-TIME-REC-NULL          VALUE 391.
   108 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   109 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   110 78  ESQL-TIMESTAMP-REC          VALUE 394.
   111 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   112 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   113 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   114 78  ESQL-TS-OFFSET-REC          VALUE 398.
   115 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   116 78  ESQL-LONGVARBINARY          VALUE 404.
   117 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   118 78  ESQL-LONGVARCHAR            VALUE 408.
   119 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   120 78  ESQL-BINARY                 VALUE 444.
   121 78  ESQL-BINARY-NULL            VALUE 445.
   122 78  ESQL-VARBINARY              VALUE 446.
   123 78  ESQL-VARBINARY-NULL         VALUE 447.
   124 78  ESQL-VARCHAR                VALUE 448.
   125 78  ESQL-VARCHAR-NULL           VALUE 449.
   126
   127 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   128 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   129
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-CHAR                   VALUE 452.
   131 78  ESQL-CHAR-NULL              VALUE 453.
   132
   133 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   134 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   135
   136 78  ESQL-DOUBLE                 VALUE 480.
   137 78  ESQL-DOUBLE-NULL            VALUE 481.
   138 78  ESQL-REAL                   VALUE 482.
   139 78  ESQL-REAL-NULL              VALUE 483.
   140 78  ESQL-DECIMAL                VALUE 484.
   141 78  ESQL-DECIMAL-NULL           VALUE 485.
   142 78  ESQL-INTEGER                VALUE 496.
   143 78  ESQL-INTEGER-NULL           VALUE 497.
   144 78  ESQL-SMALLINT               VALUE 500.
   145 78  ESQL-SMALLINT-NULL          VALUE 501.
   146 78  ESQL-TINYINT                VALUE 502.
   147 78  ESQL-TINYINT-NULL           VALUE 503.
*  148 EXEC SQL
*  149    INCLUDE SQLCA
*  150 END-EXEC
   151 01 SQLCA.
   152     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   153     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   154     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   155     05  SQLERRM.
   156         49  SQLERRML    PIC S9(4) COMP-5.
   157         49  SQLERRMC    PIC X(70).
   158     05  SQLERRP         PIC X(8).
   159     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   160     05  SQLWARN.
   161         10  SQLWARN0    PIC X.
   162         10  SQLWARN1    PIC X.
   163         10  SQLWARN2    PIC X.
   164         10  SQLWARN3    PIC X.
   165         10  SQLWARN4    PIC X.
   166         10  SQLWARN5    PIC X.
   167         10  SQLWARN6    PIC X.
   168         10  SQLWARN7    PIC X.
   169     05  SQLEXT.
   170         10  SQLWARN8    PIC X.
   171         10  SQLWARN9    PIC X.
   172         10  SQLWARN10   PIC X.
   173         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   174     05  SQLSTATE    PIC X(5).
   175 EXEC SQL
   176    BEGIN DECLARE SECTION
   177 END-EXEC
   178 01  ws-paid-bank-work-area.
   179     05  ws-pb-compid            pic x(9).
   180     05  ws-pb-check-no          pic x(10).
   181     05  ws-pb-bad-check-no      pic x(10).
   182     05  ws-check-amount         pic x(10).
   183 01  Paid-Bank-Info.
   184     05  pb-check-no             pic 9(10).
   185     05  pb-tran-type            pic x.
   186     05  pb-bank-acct-desc       pic x(50).
   187     05  pb-amount               pic x(12).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   5
* EL677.cbl
   188     05  pb-paid-date            pic x(25).
   189 01  ws-key-stuff.
   190     05  ws-compid               pic xxx.
   191     05  ws-carrier              pic x.
   192     05  ws-grouping             pic x(6).
   193     05  ws-state                pic xx.
   194     05  ws-account              pic x(10).
   195     05  ws-eff-date             pic x(10).
   196     05  ws-certificate          pic x(10).
   197     05  ws-cert-sfx             pic x.
   198     05  ws-seq-no               pic 999.
   199     05  ws-type                 pic x.
   200     05  ws-check-sub-type       pic x.
   201 01  sqlcmd                      pic x(1024).
   202 01  WS-MOE-DATE                 pic x(10).
   203 01  svr                         pic x(32).
   204 01  usr                         pic x(32).
   205 01  pass                        pic x(32).
   206 01  usr-pass                    pic x(64).
   207 01  ws-disp-code                pic s9(11).
   208***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   209***                                                            ***
   210***  These indicators are used to determine if a variable      ***
   211***  is passed nulls from sql. The indicator will be -1        ***
   212***  if the value on sql is nulls and +0 if the value is       ***
   213***  something other than nulls. Here is an example on how     ***
   214***  to use the indicator variables.                           ***
   215***                                                            ***
   216***     EXEC SQL                                               ***
   217***        fetch checkapp into                                 ***
   218***           :db-app-status :nu-app-status,                   ***
   219***           :db-app-by     :nu-app-by,                       ***
   220***           :db-app-date   :nu-app-date,                     ***
   221***           :db-app-batch  :nu-app-batch                     ***
   222***     END-EXEC                                               ***
   223***                                                            ***
   224***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   225 01  indicator-vaiables-for-nulls.
   226     05  nu-app-status           pic s9(4) comp value +0.
   227     05  nu-app-by               pic s9(4) comp value +0.
   228     05  nu-app-date             pic s9(4) comp value +0.
   229     05  nu-app-batch            pic s9(4) comp value +0.
   230     05  nu-fincar               pic s9(4) comp value +0.
   231 01  daily-check-request-rec.
   232     05  db-compid               pic xxx.
   233     05  db-carrier              pic x.
   234     05  db-grouping             pic x(6).
   235     05  db-state                pic xx.
   236     05  db-account              pic x(10).
   237     05  db-effdate              pic x(10).
   238     05  db-certificate          pic x(10).
   239     05  db-cert-sfx             pic x.
   240     05  db-seq-no               pic 999.
   241     05  db-type                 pic x.
   242     05  db-amount-n             pic 9(7).99.
   243     05  db-amount redefines db-amount-n
   244                                 pic x(10).
   245     05  db-checkno              pic x(15).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   6
* EL677.cbl
   246     05  db-checkdate            pic x(10).
   247     05  db-checkstatus          pic 9(5).
   248     05  db-releasebatch         pic 9(5).
   249     05  db-releasedt            pic x(10).
   250     05  db-releaseby            pic x(4).
   251     05  db-payeename1           pic x(30).
   252     05  db-payeename2           pic x(30).
   253     05  db-payeeaddr1           pic x(30).
   254     05  db-payeeaddr2           pic x(30).
   255     05  db-payeecity            pic x(30).
   256     05  db-payeest              pic xx.
   257     05  db-payeezip             pic x(10).
   258     05  db-fincar               pic x.
   259     05  db-fingrp               pic x(6).
   260     05  db-finresp              pic x(10).
   261     05  db-finacct              pic x(10).
   262     05  db-preparer             pic x(4).
   263     05  db-app-status           pic x(9).
   264     05  dp-app-status-n redefines db-app-status
   265                                 pic 9(9).
   266     05  db-app-by               pic x(20).
   267     05  db-app-date             pic x(30).
   268     05  db-app-batch            pic x(10).
   269     05  db-return-to            pic x(30).
   270     05  db-insured-name         pic x(30).
   271     05  db-check-sub-type       pic x.
   272 EXEC SQL
   273    END DECLARE SECTION
   274 END-EXEC
   275*                            COPY ELCSCTM.
   276******************************************************************
   277*                                                                *
   278*                                                                *
   279*                            ELCSCTM                             *
   280*                            VMOD=2.001                          *
   281*                                                                *
   282*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   283*                                                                *
   284******************************************************************
   285 01  SECURITY-MESSAGE.
   286     12  FILLER                          PIC X(30)
   287            VALUE '** LOGIC SECURITY VIOLATION -'.
   288     12  SM-READ                         PIC X(6).
   289     12  FILLER                          PIC X(5)
   290            VALUE ' PGM='.
   291     12  SM-PGM                          PIC X(6).
   292     12  FILLER                          PIC X(5)
   293            VALUE ' OPR='.
   294     12  SM-PROCESSOR-ID                 PIC X(4).
   295     12  FILLER                          PIC X(6)
   296            VALUE ' TERM='.
   297     12  SM-TERMID                       PIC X(4).
   298     12  FILLER                          PIC XX   VALUE SPACE.
   299     12  SM-JUL-DATE                     PIC 9(5).
   300     12  FILLER                          PIC X    VALUE SPACE.
   301     12  SM-TIME                         PIC 99.99.
   302
   303*                            COPY ELCSCRTY.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   7
* EL677.cbl
   304******************************************************************
   305*                                                                *
   306*                                                                *
   307*                            ELCSCRTY                            *
   308*                            VMOD=2.001                          *
   309*                                                                *
   310*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   311*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   312*        SAVED IN PI-SECURITY-ADDRESS.                           *
   313*                                                                *
   314******************************************************************
   315 01  SECURITY-CONTROL.
   316     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   317     12  FILLER                       PIC XX    VALUE 'SC'.
   318     12  SC-CREDIT-CODES.
   319         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   320             20  SC-CREDIT-DISPLAY    PIC X.
   321             20  SC-CREDIT-UPDATE     PIC X.
   322     12  SC-CLAIMS-CODES.
   323         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   324             20  SC-CLAIMS-DISPLAY    PIC X.
   325             20  SC-CLAIMS-UPDATE     PIC X.
   326 01  ws-dummy-erchek             pic x(600).
   327 01  filler.
   328     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   329     05  WS-CHECK-AMT-TMPX REDEFINES
   330         WS-CHECK-AMT-TMP        PIC X(10).
   331     05  ws-ind                     pic s9(4) comp value +0.
   332     05  ws-ind-red redefines ws-ind pic xx.
   333     05  ws-display-ind             pic s9(7) value zeros.
   334 01  ws-compare-erchek-key          pic x(33) value low-values.
   335 01  ws-eracct-sw                   pic x value ' '.
   336     88  eracct-found                 value 'Y'.
   337 01  ws-eracct-start-sw             pic x value ' '.
   338     88  eracct-start                 value 'Y'.
   339 01  WS-MISC-AREA.
   340     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   341     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   342     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   343
   344 01  ws-work-amt-alpha           pic x(10).
   345 01  ws-work-amt-num redefines ws-work-amt-alpha
   346                                 pic 9(8)v99.
   347 01  ws-user-defined.
   348     05  ws-user-reason         pic xxx.
   349     05  ws-user-cert-no        pic x(11).
   350     05  ws-user-name           pic x(28).
   351 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   352 01  STANDARD-AREAS.
   353     12  ws-connect-sw               pic x  value ' '.
   354         88  connected-to-db             value 'Y'.
   355     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   356     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   357     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   358     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   359     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   360     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   361     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   8
* EL677.cbl
   362     12  EL6318-TRANS-ID             PIC X(4)    VALUE 'EXBE'.
   363     12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.
   364     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   365     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   366     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   367     12  TIME-OUT-R  REDEFINES TIME-IN.
   368         16  FILLER                  PIC X.
   369         16  TIME-OUT                PIC 99V99.
   370         16  FILLER                  PIC XX.
   371     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   372     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   373     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   374     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   375     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   376     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   377     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   378     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   379     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   380     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   381     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   382     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   383     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   384     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   385     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   386     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   387     12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.
   388     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   389     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   390     12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
   391     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   392     12  QID.
   393         16  QID-TERM                PIC X(4)    VALUE SPACES.
   394         16  FILLER                  PIC X(4)    VALUE '677A'.
   395
   396 01  WORK-AREAS.
   397     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   398     12  WS-AM-WK REDEFINES WS-AM-WORK.
   399         16  WS-AM-NUM               PIC S9(7)V99.
   400         16  WS-AM-SIGN              PIC X.
   401     12  WS-CHECK-WORK.
   402         16  FILLER                  PIC X        VALUE SPACE.
   403         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   404     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   405     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   406     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   407     12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.
   408     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   409     12  WS-SV-CARRIER               PIC X       VALUE SPACES.
   410     12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.
   411     12  WS-SV-STATE                 PIC XX      VALUE SPACES.
   412     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   413     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   414     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   415         WS-DT-DEEDIT-FIELD.
   416         16  FILLER                  PIC X(4).
   417         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   418     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   419     12  WS-DEEDIT-FIELD-V0          REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page   9
* EL677.cbl
   420         WS-DEEDIT-FIELD-A           PIC S9(15).
   421
   422     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   423     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   424         88 WS-CERT-FOUND                        VALUE 'Y'.
   425         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   426     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   427         88 WS-PNDB-FOUND                        VALUE 'Y'.
   428         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   429     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   430         88  WS-PROCESS-CERT                     VALUE 'Y'.
   431     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   432         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   433     12  WS-PY-ENTRY-COMMENT.
   434         16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.
   435         16  FILLER                  PIC X(13)   VALUE
   436            ' MISC. CHECK '.
   437         16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.
   438         16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.
   439     12  WS-PY-REF-COMMENT.
   440         16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.
   441         16  FILLER                  PIC X(13)   VALUE
   442            ' REFUND PYMT '.
   443         16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.
   444         16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.
   445     12  WS-PY-END-COMMENT.
   446         16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.
   447         16  FILLER                  PIC X(13)   VALUE
   448            ' ENDORSEMENT '.
   449         16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.
   450         16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.
   451     12  WS-PY-DED-COMMENT.
   452         16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.
   453         16  FILLER                  PIC X(13)   VALUE
   454            ' STAT DEDUCT '.
   455         16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.
   456         16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.
   457     12  WS-PY-ADDL-COMMENT.
   458         16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.
   459         16  FILLER                  PIC X(13)   VALUE
   460            ' ADDL CHARGE '.
   461         16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.
   462         16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.
   463     12  WS-PY-REVERSAL-COMMENT.
   464         16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.
   465         16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE
   466            ' VOID REFUND '.
   467         16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.
   468         16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.
   469     12  WS-TMS-ENTRY-COMMENT.
   470         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   471         16  FILLER                  PIC XX      VALUE SPACES.
   472         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   473     12  WS-ZIP-CODE.
   474         16  WS-ZIP-PRIME.
   475             20  WS-ZIP-PRI-1ST      PIC X.
   476                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   477             20  FILLER              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  10
* EL677.cbl
   478         16  WS-ZIP-PLUS4            PIC X(4).
   479     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   480         16  WS-CAN-POST1-1          PIC XXX.
   481         16  WS-CAN-POST1-2.
   482             20  WS-CAN-POST-4TH     PIC X.
   483             20  FILLER              PIC XX.
   484         16  FILLER                  PIC XXX.
   485     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   486         16  WS-CAN-POST2-1          PIC XXX.
   487         16  FILLER                  PIC X.
   488         16  WS-CAN-POST2-2          PIC XXX.
   489         16  FILLER                  PIC XX.
   490
   491*                                    COPY ELCNWA.
   492*****************************************************************
   493*                                                               *
   494*                                                               *
   495*                            ELCNWA.                            *
   496*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   497*                            VMOD=2.003                         *
   498*                                                               *
   499*            M O V E   N A M E   W O R K   A R E A.             *
   500*                                                               *
   501*****************************************************************.
   502
   503 01  WS-NAME-WORK-AREA.
   504     05  WS-INSURED-LAST-NAME        PIC X(15).
   505     05  WS-INSURED-1ST-NAME         PIC X(12).
   506     05  WS-INSURED-MID-INIT         PIC X.
   507
   508     05  WS-NAME-WORK.
   509         10  WS-NW                   PIC X
   510             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   511
   512     05  WS-NAME-WORK2.
   513         10  WS-NW2                  PIC X
   514             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   515                                        NWA-INDEX0.
   516
   517     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   518                                     COMP-3.
   519
   520 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   521     88  RESP-NORMAL                    VALUE +0.
   522     88  resp-file-notfnd               value +12.
   523     88  RESP-NOTFND                    VALUE +13.
   524     88  resp-duprec                    value +14.
   525     88  resp-dupkey                    value +15.
   526     88  resp-invreq                    value +16.
   527     88  RESP-NOTOPEN                   VALUE +19.
   528     88  RESP-ENDFILE                   VALUE +20.
   529     88  resp-lengtherr                 value +22.
   530 01  ACCESS-KEYS.
   531     12  ELCNTL-KEY.
   532         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   533         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   534         16 ELCNTL-ACCESS.
   535             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  11
* EL677.cbl
   536             20  FILLER              PIC X       VALUE SPACES.
   537             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   538         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   539
   540     12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
   541
   542     12  ERACCT-KEY.
   543         16  ERACCT-CO               PIC X       VALUE SPACES.
   544         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   545         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   546         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   547         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   548         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   549         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   550
   551     12  SAVE-ERACCT-KEY.
   552         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   553         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   554         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   555         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   556         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   557         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   558         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   559
   560     12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
   561
   562     12  ERCOMP-KEY.
   563         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   564         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   565         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   566         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   567         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   568         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   569
   570     12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
   571
   572     12  ELCERT-KEY.
   573         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   574         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   575         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   576         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   577         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   578         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   579         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   580         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   581
   582     12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
   583
   584     12  ERPNDB-PRIMARY-KEY.
   585         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   586         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   587         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   588         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   589
   590     12  ERPNDB-ALT-KEY.
   591         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   592         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   593         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  12
* EL677.cbl
   594         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   595         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   596         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   597         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   598         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   599         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   600         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   601
   602     12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
   603
   604     12  ERPNDM-PRIMARY-KEY.
   605         16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.
   606         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   607         16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   608         16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   609
   610     12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
   611
   612     12  ERCHEK-KEY.
   613         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   614         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   615         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   616         16  CHEK-STATE              PIC XX      VALUE SPACES.
   617         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   618         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   619         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   620         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   621         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   622
   623     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   624     12  ERPYAJ-KEY.
   625         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   626         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   627         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   628         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   629         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   630         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   631         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   632
   633     12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
   634
   635 01  ERROR-NUMBERS.
   636     12  ER-0000                     PIC X(4)    VALUE '0000'.
   637     12  ER-0004                     PIC X(4)    VALUE '0004'.
   638     12  ER-0008                     PIC X(4)    VALUE '0008'.
   639     12  ER-0013                     PIC X(4)    VALUE '0013'.
   640     12  ER-0022                     PIC X(4)    VALUE '0022'.
   641     12  ER-0023                     PIC X(4)    VALUE '0023'.
   642     12  ER-0026                     PIC X(4)    VALUE '0026'.
   643     12  ER-0029                     PIC X(4)    VALUE '0029'.
   644     12  ER-0070                     PIC X(4)    VALUE '0070'.
   645     12  ER-0194                     PIC X(4)    VALUE '0194'.
   646     12  ER-0195                     PIC X(4)    VALUE '0195'.
   647     12  ER-0196                     PIC X(4)    VALUE '0196'.
   648     12  ER-0197                     PIC X(4)    VALUE '0197'.
   649     12  ER-0203                     PIC X(4)    VALUE '0203'.
   650     12  ER-0215                     PIC X(4)    VALUE '0215'.
   651     12  ER-0216                     PIC X(4)    VALUE '0216'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  13
* EL677.cbl
   652     12  ER-0433                     PIC X(4)    VALUE '0433'.
   653     12  ER-0565                     PIC X(4)    VALUE '0565'.
   654     12  ER-1159                     PIC X(4)    VALUE '1159'.
   655     12  ER-1162                     PIC X(4)    VALUE '1162'.
   656     12  ER-2056                     PIC X(4)    VALUE '2056'.
   657     12  ER-2208                     PIC X(4)    VALUE '2208'.
   658     12  ER-2209                     PIC X(4)    VALUE '2209'.
   659     12  ER-2210                     PIC X(4)    VALUE '2210'.
   660     12  ER-2230                     PIC X(4)    VALUE '2230'.
   661     12  ER-2237                     PIC X(4)    VALUE '2237'.
   662     12  ER-2238                     PIC X(4)    VALUE '2238'.
   663     12  ER-2294                     PIC X(4)    VALUE '2294'.
   664     12  ER-2394                     PIC X(4)    VALUE '2394'.
   665     12  ER-2438                     PIC X(4)    VALUE '2438'.
   666     12  ER-2439                     PIC X(4)    VALUE '2439'.
   667     12  ER-2583                     PIC X(4)    VALUE '2583'.
   668     12  ER-2600                     PIC X(4)    VALUE '2600'.
   669     12  ER-2726                     PIC X(4)    VALUE '2726'.
   670     12  ER-2905                     PIC X(4)    VALUE '2905'.
   671     12  ER-2906                     PIC X(4)    VALUE '2906'.
   672     12  ER-2907                     PIC X(4)    VALUE '2907'.
   673     12  ER-2908                     PIC X(4)    VALUE '2908'.
   674     12  ER-2909                     PIC X(4)    VALUE '2909'.
   675     12  ER-3044                     PIC X(4)    VALUE '3044'.
   676     12  ER-3046                     PIC X(4)    VALUE '3046'.
   677     12  ER-3047                     PIC X(4)    VALUE '3047'.
   678     12  ER-3445                     PIC X(4)    VALUE '3445'.
   679     12  er-3450                     pic x(4)    value '3450'.
   680     12  er-3451                     pic x(4)    value '3451'.
   681     12  er-3452                     pic x(4)    value '3452'.
   682     12  er-3453                     pic x(4)    value '3453'.
   683     12  er-3454                     pic x(4)    value '3454'.
   684     12  er-3455                     pic x(4)    value '3455'.
   685     12  er-3459                     pic x(4)    value '3459'.
   686     12  ER-7389                     PIC X(4)    VALUE '7389'.
   687     12  er-9999                     pic x(4)    value '9999'.
   688*                                    COPY ELCLOGOF.
   689******************************************************************
   690*                                                                *
   691*                                                                *
   692*                            ELCLOGOF.                           *
   693*                            VMOD=2.001                          *
   694*                                                                *
   695*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   696*                                                                *
   697******************************************************************
   698 01  CLASIC-LOGOFF.
   699     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   700     12  LOGOFF-TEXT.
   701         16  FILLER          PIC X(5)    VALUE SPACES.
   702         16  LOGOFF-MSG.
   703             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   704             20  FILLER      PIC X       VALUE SPACES.
   705             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   706         16  FILLER          PIC X(80)
   707           VALUE '* YOU ARE NOW LOGGED OFF'.
   708         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   709         16  FILLER          PIC X       VALUE QUOTE.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  14
* EL677.cbl
   710         16  LOGOFF-SYS-MSG  PIC X(17)
   711           VALUE 'S CLAS-IC SYSTEM '.
   712     12  TEXT-MESSAGES.
   713         16  UNACCESS-MSG    PIC X(29)
   714             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   715         16  PGMIDERR-MSG    PIC X(17)
   716             VALUE 'PROGRAM NOT FOUND'.
   717*                                    COPY ELCDATE.
   718******************************************************************
   719*                                                                *
   720*                                                                *
   721*                            ELCDATE.                            *
   722*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   723*                            VMOD=2.003
   724*                                                                *
   725*                                                                *
   726*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   727*                 LENGTH = 200                                   *
   728******************************************************************
   729
   730 01  DATE-CONVERSION-DATA.
   731     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   732     12  DC-OPTION-CODE                PIC X.
   733         88  BIN-TO-GREG                VALUE ' '.
   734         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   735         88  EDIT-GREG-TO-BIN           VALUE '2'.
   736         88  YMD-GREG-TO-BIN            VALUE '3'.
   737         88  MDY-GREG-TO-BIN            VALUE '4'.
   738         88  JULIAN-TO-BIN              VALUE '5'.
   739         88  BIN-PLUS-ELAPSED           VALUE '6'.
   740         88  FIND-CENTURY               VALUE '7'.
   741         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   742         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   743         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   744         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   745         88  JULIAN-TO-BIN-3            VALUE 'C'.
   746         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   747         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   748         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   749         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   750         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   751         88  CHECK-LEAP-YEAR            VALUE 'H'.
   752         88  BIN-3-TO-GREG              VALUE 'I'.
   753         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   754         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   755         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   756         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   757         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   758         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   759         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   760         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   761         88  THREE-CHARACTER-BIN
   762                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   763         88  GREGORIAN-TO-BIN
   764                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   765         88  BIN-TO-GREGORIAN
   766                  VALUES ' ' '1' 'I' '8' 'G'.
   767         88  JULIAN-TO-BINARY
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  15
* EL677.cbl
   768                  VALUES '5' 'C' 'E' 'F'.
   769     12  DC-ERROR-CODE                 PIC X.
   770         88  NO-CONVERSION-ERROR        VALUE ' '.
   771         88  DATE-CONVERSION-ERROR
   772                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   773         88  DATE-IS-ZERO               VALUE '1'.
   774         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   775         88  DATE-IS-INVALID            VALUE '3'.
   776         88  DATE1-GREATER-DATE2        VALUE '4'.
   777         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   778         88  DATE-INVALID-OPTION        VALUE '9'.
   779         88  INVALID-CENTURY            VALUE 'A'.
   780         88  ONLY-CENTURY               VALUE 'B'.
   781         88  ONLY-LEAP-YEAR             VALUE 'C'.
   782         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   783     12  DC-END-OF-MONTH               PIC X.
   784         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   785     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   786         88  USE-NORMAL-PROCESS         VALUE ' '.
   787         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   788         88  ADJUST-UP-100-YRS          VALUE '2'.
   789     12  FILLER                        PIC X.
   790     12  DC-CONVERSION-DATES.
   791         16  DC-BIN-DATE-1             PIC XX.
   792         16  DC-BIN-DATE-2             PIC XX.
   793         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   794         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   795                       DC-GREG-DATE-1-EDIT.
   796             20  DC-EDIT1-MONTH        PIC 99.
   797             20  SLASH1-1              PIC X.
   798             20  DC-EDIT1-DAY          PIC 99.
   799             20  SLASH1-2              PIC X.
   800             20  DC-EDIT1-YEAR         PIC 99.
   801         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   802         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   803                     DC-GREG-DATE-2-EDIT.
   804             20  DC-EDIT2-MONTH        PIC 99.
   805             20  SLASH2-1              PIC X.
   806             20  DC-EDIT2-DAY          PIC 99.
   807             20  SLASH2-2              PIC X.
   808             20  DC-EDIT2-YEAR         PIC 99.
   809         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   810         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   811                     DC-GREG-DATE-1-YMD.
   812             20  DC-YMD-YEAR           PIC 99.
   813             20  DC-YMD-MONTH          PIC 99.
   814             20  DC-YMD-DAY            PIC 99.
   815         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   816         16  DC-GREG-DATE-1-MDY-R REDEFINES
   817                      DC-GREG-DATE-1-MDY.
   818             20  DC-MDY-MONTH          PIC 99.
   819             20  DC-MDY-DAY            PIC 99.
   820             20  DC-MDY-YEAR           PIC 99.
   821         16  DC-GREG-DATE-1-ALPHA.
   822             20  DC-ALPHA-MONTH        PIC X(10).
   823             20  DC-ALPHA-DAY          PIC 99.
   824             20  FILLER                PIC XX.
   825             20  DC-ALPHA-CENTURY.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  16
* EL677.cbl
   826                 24 DC-ALPHA-CEN-N     PIC 99.
   827             20  DC-ALPHA-YEAR         PIC 99.
   828         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   829         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   830         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   831         16  DC-JULIAN-DATE            PIC 9(05).
   832         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   833                                       PIC 9(05).
   834         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   835             20  DC-JULIAN-YEAR        PIC 99.
   836             20  DC-JULIAN-DAYS        PIC 999.
   837         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   838         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   839         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   840     12  DATE-CONVERSION-VARIBLES.
   841         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   842         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   843             20  FILLER                PIC 9(3).
   844             20  HOLD-CEN-1-CCYY.
   845                 24  HOLD-CEN-1-CC     PIC 99.
   846                 24  HOLD-CEN-1-YY     PIC 99.
   847             20  HOLD-CEN-1-MO         PIC 99.
   848             20  HOLD-CEN-1-DA         PIC 99.
   849         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   850             20  HOLD-CEN-1-R-MO       PIC 99.
   851             20  HOLD-CEN-1-R-DA       PIC 99.
   852             20  HOLD-CEN-1-R-CCYY.
   853                 24  HOLD-CEN-1-R-CC   PIC 99.
   854                 24  HOLD-CEN-1-R-YY   PIC 99.
   855             20  FILLER                PIC 9(3).
   856         16  HOLD-CENTURY-1-X.
   857             20  FILLER                PIC X(3)  VALUE SPACES.
   858             20  HOLD-CEN-1-X-CCYY.
   859                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   860                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   861             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   862             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   863         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   864             20  HOLD-CEN-1-R-X-MO     PIC XX.
   865             20  HOLD-CEN-1-R-X-DA     PIC XX.
   866             20  HOLD-CEN-1-R-X-CCYY.
   867                 24  HOLD-CEN-1-R-X-CC PIC XX.
   868                 24  HOLD-CEN-1-R-X-YY PIC XX.
   869             20  FILLER                PIC XXX.
   870         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   871         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   872         16  DC-JULIAN-DATE-1          PIC 9(07).
   873         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   874             20  DC-JULIAN-1-CCYY.
   875                 24  DC-JULIAN-1-CC    PIC 99.
   876                 24  DC-JULIAN-1-YR    PIC 99.
   877             20  DC-JULIAN-DA-1        PIC 999.
   878         16  DC-JULIAN-DATE-2          PIC 9(07).
   879         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   880             20  DC-JULIAN-2-CCYY.
   881                 24  DC-JULIAN-2-CC    PIC 99.
   882                 24  DC-JULIAN-2-YR    PIC 99.
   883             20  DC-JULIAN-DA-2        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  17
* EL677.cbl
   884         16  DC-GREG-DATE-A-EDIT.
   885             20  DC-EDITA-MONTH        PIC 99.
   886             20  SLASHA-1              PIC X VALUE '/'.
   887             20  DC-EDITA-DAY          PIC 99.
   888             20  SLASHA-2              PIC X VALUE '/'.
   889             20  DC-EDITA-CCYY.
   890                 24  DC-EDITA-CENT     PIC 99.
   891                 24  DC-EDITA-YEAR     PIC 99.
   892         16  DC-GREG-DATE-B-EDIT.
   893             20  DC-EDITB-MONTH        PIC 99.
   894             20  SLASHB-1              PIC X VALUE '/'.
   895             20  DC-EDITB-DAY          PIC 99.
   896             20  SLASHB-2              PIC X VALUE '/'.
   897             20  DC-EDITB-CCYY.
   898                 24  DC-EDITB-CENT     PIC 99.
   899                 24  DC-EDITB-YEAR     PIC 99.
   900         16  DC-GREG-DATE-CYMD         PIC 9(08).
   901         16  DC-GREG-DATE-CYMD-R REDEFINES
   902                              DC-GREG-DATE-CYMD.
   903             20  DC-CYMD-CEN           PIC 99.
   904             20  DC-CYMD-YEAR          PIC 99.
   905             20  DC-CYMD-MONTH         PIC 99.
   906             20  DC-CYMD-DAY           PIC 99.
   907         16  DC-GREG-DATE-MDCY         PIC 9(08).
   908         16  DC-GREG-DATE-MDCY-R REDEFINES
   909                              DC-GREG-DATE-MDCY.
   910             20  DC-MDCY-MONTH         PIC 99.
   911             20  DC-MDCY-DAY           PIC 99.
   912             20  DC-MDCY-CEN           PIC 99.
   913             20  DC-MDCY-YEAR          PIC 99.
   914    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   915        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   916    12  DC-EL310-DATE                  PIC X(21).
   917    12  FILLER                         PIC X(28).
   918*                                    COPY ELCATTR.
   919******************************************************************
   920*                                                                *
   921*                            ELCATTR.                            *
   922*                            VMOD=2.001                          *
   923*                                                                *
   924*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   925*                                                                *
   926*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   927*                                                                *
   928*                   POS 1   P=PROTECTED                          *
   929*                           U=UNPROTECTED                        *
   930*                           S=ASKIP                              *
   931*                   POS 2   A=ALPHA/NUMERIC                      *
   932*                           N=NUMERIC                            *
   933*                   POS 3   N=NORMAL                             *
   934*                           B=BRIGHT                             *
   935*                           D=DARK                               *
   936*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   937*                           OF=MODIFIED DATA TAG OFF             *
   938*                                                                *
   939*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   940******************************************************************
   941 01  ATTRIBUTE-LIST.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  18
* EL677.cbl
   942     12  AL-PABOF            PIC X       VALUE 'Y'.
   943     12  AL-PABON            PIC X       VALUE 'Z'.
   944     12  AL-PADOF            PIC X       VALUE '%'.
   945     12  AL-PADON            PIC X       VALUE '_'.
   946     12  AL-PANOF            PIC X       VALUE '-'.
   947     12  AL-PANON            PIC X       VALUE '/'.
   948     12  AL-SABOF            PIC X       VALUE '8'.
   949     12  AL-SABON            PIC X       VALUE '9'.
   950     12  AL-SADOF            PIC X       VALUE '@'.
   951     12  AL-SADON            PIC X       VALUE QUOTE.
   952     12  AL-SANOF            PIC X       VALUE '0'.
   953     12  AL-SANON            PIC X       VALUE '1'.
   954     12  AL-UABOF            PIC X       VALUE 'H'.
   955     12  AL-UABON            PIC X       VALUE 'I'.
   956     12  AL-UADOF            PIC X       VALUE '<'.
   957     12  AL-UADON            PIC X       VALUE '('.
   958     12  AL-UANOF            PIC X       VALUE ' '.
   959     12  AL-UANON            PIC X       VALUE 'A'.
   960     12  AL-UNBOF            PIC X       VALUE 'Q'.
   961     12  AL-UNBON            PIC X       VALUE 'R'.
   962     12  AL-UNDOF            PIC X       VALUE '*'.
   963     12  AL-UNDON            PIC X       VALUE ')'.
   964     12  AL-UNNOF            PIC X       VALUE '&'.
   965     12  AL-UNNON            PIC X       VALUE 'J'.
   966*                                    COPY ELCEMIB.
   967******************************************************************
   968*                                                                *
   969*                                                                *
   970*                            ELCEMIB.                            *
   971*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   972*                            VMOD=2.005                          *
   973*                                                                *
   974*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   975*                                                                *
   976******************************************************************
   977 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   978     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   979     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   980     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   981     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   982     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   983     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   984     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   985     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   986     12  EMI-SWITCH1             PIC X        VALUE '1'.
   987         88  EMI-NO-ERRORS                    VALUE '1'.
   988         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   989         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   990     12  EMI-SWITCH2             PIC X        VALUE '1'.
   991         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   992     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   993         88  EMI-AREA1-EMPTY                  VALUE '1'.
   994         88  EMI-AREA1-FULL                   VALUE '2'.
   995     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   996         88  EMI-AREA2-EMPTY                  VALUE '1'.
   997         88  EMI-AREA2-FULL                   VALUE '2'.
   998     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   999         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  19
* EL677.cbl
  1000         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1001         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1002         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1003         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1004     12  EMI-ERROR-LINES.
  1005         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1006         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1007         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1008         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1009             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1010                 24  EMI-ERR-NUM         PIC X(4).
  1011                 24  EMI-FILLER          PIC X.
  1012                 24  EMI-SEV             PIC X.
  1013                 24  FILLER              PIC X.
  1014             20  FILLER                  PIC X(02).
  1015     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1016         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1017             20  EMI-ERROR-NUMBER    PIC X(4).
  1018             20  EMI-FILL            PIC X.
  1019             20  EMI-SEVERITY        PIC X.
  1020             20  FILLER              PIC X.
  1021             20  EMI-ERROR-TEXT.
  1022                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1023                 24  FILLER          PIC X(55).
  1024     12  EMI-SEVERITY-SAVE           PIC X.
  1025         88  EMI-NOTE                    VALUE 'N'.
  1026         88  EMI-WARNING                 VALUE 'W'.
  1027         88  EMI-FORCABLE                VALUE 'F'.
  1028         88  EMI-FATAL                   VALUE 'X'.
  1029     12  EMI-MESSAGE-FLAG            PIC X.
  1030         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1031         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1032     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1033     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1034         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1035         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1036         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1037     12  emi-claim-no                pic x(7).
  1038     12  emi-claim-type              pic x(6).
  1039     12  FILLER                      PIC X(124)  VALUE SPACES.
  1040     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1041     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1042     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1043     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1044*                                    COPY ELCINTF.
  1045******************************************************************
  1046*                                                                *
  1047*                                                                *
  1048*                            ELCINTF.                            *
  1049*                            VMOD=2.017                          *
  1050*                                                                *
  1051*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1052*                                                                *
  1053*       LENGTH = 1024                                            *
  1054*                                                                *
  1055******************************************************************
  1056*                   C H A N G E   L O G
  1057*
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  20
* EL677.cbl
  1058* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1059*-----------------------------------------------------------------
  1060*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1061* EFFECTIVE    NUMBER
  1062*-----------------------------------------------------------------
  1063* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1064******************************************************************
  1065 01  PROGRAM-INTERFACE-BLOCK.
  1066     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1067     12  PI-CALLING-PROGRAM              PIC X(8).
  1068     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1069     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1070     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1071     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1072     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1073     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1074     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1075     12  PI-COMPANY-ID                   PIC XXX.
  1076     12  PI-COMPANY-CD                   PIC X.
  1077
  1078     12  PI-COMPANY-PASSWORD             PIC X(8).
  1079
  1080     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1081
  1082     12  PI-CONTROL-IN-PROGRESS.
  1083         16  PI-CARRIER                  PIC X.
  1084         16  PI-GROUPING                 PIC X(6).
  1085         16  PI-STATE                    PIC XX.
  1086         16  PI-ACCOUNT                  PIC X(10).
  1087         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1088                                         PIC X(10).
  1089         16  PI-CLAIM-CERT-GRP.
  1090             20  PI-CLAIM-NO             PIC X(7).
  1091             20  PI-CERT-NO.
  1092                 25  PI-CERT-PRIME       PIC X(10).
  1093                 25  PI-CERT-SFX         PIC X.
  1094             20  PI-CERT-EFF-DT          PIC XX.
  1095         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1096             20  PI-PLAN-CODE            PIC X(2).
  1097             20  PI-REVISION-NUMBER      PIC X(3).
  1098             20  PI-PLAN-EFF-DT          PIC X(2).
  1099             20  PI-PLAN-EXP-DT          PIC X(2).
  1100             20  FILLER                  PIC X(11).
  1101         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1102             20  PI-OE-REFERENCE-1.
  1103                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1104                 25  PI-OE-REF-1-SUFF    PIC XX.
  1105
  1106     12  PI-SESSION-IN-PROGRESS          PIC X.
  1107         88  CLAIM-SESSION                   VALUE '1'.
  1108         88  CREDIT-SESSION                  VALUE '2'.
  1109         88  WARRANTY-SESSION                VALUE '3'.
  1110         88  MORTGAGE-SESSION                VALUE '4'.
  1111         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1112
  1113
  1114*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1115
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  21
* EL677.cbl
  1116     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1117     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1118
  1119     12  PI-CREDIT-USER                  PIC X.
  1120         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1121         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1122
  1123     12  PI-CLAIM-USER                   PIC X.
  1124         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1125         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1126
  1127     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1128         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1129         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1130         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1131         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1132         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1133
  1134     12  PI-PROCESSOR-ID                 PIC X(4).
  1135
  1136     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1137
  1138     12  PI-MEMBER-CAPTION               PIC X(10).
  1139
  1140     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1141         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1142
  1143     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1144     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1145     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1146     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1147
  1148     12  PI-AH-OVERRIDE-L1               PIC X.
  1149     12  PI-AH-OVERRIDE-L2               PIC XX.
  1150     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1151     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1152
  1153     12  PI-NEW-SYSTEM                   PIC X(2).
  1154
  1155     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1156     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1157         88  PI-USES-PAID-TO                 VALUE '1'.
  1158     12  PI-CRDTCRD-SYSTEM.
  1159         16  PI-CRDTCRD-USER             PIC X.
  1160             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1161             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1162         16  PI-CC-MONTH-END-DT          PIC XX.
  1163     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1164
  1165     12  PI-OE-REFERENCE-2.
  1166         16  PI-OE-REF-2-PRIME           PIC X(10).
  1167         16  PI-OE-REF-2-SUFF            PIC X.
  1168
  1169     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1170
  1171     12  PI-LANGUAGE-TYPE                PIC X.
  1172             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1173             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  22
* EL677.cbl
  1174             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1175
  1176     12  PI-POLICY-LINKAGE-IND           PIC X.
  1177         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1178         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1179                                                   LOW-VALUES.
  1180
  1181     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1182     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1183         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1184         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1185
  1186     12  PI-PROCESSOR-CSR-IND            PIC X.
  1187         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1188         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1189
  1190     12  FILLER                          PIC X(3).
  1191
  1192     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1193
  1194     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1195         PI-SYSTEM-LEVEL.
  1196
  1197         16  PI-ENTRY-CODES.
  1198             20  PI-ENTRY-CD-1           PIC X.
  1199             20  PI-ENTRY-CD-2           PIC X.
  1200
  1201         16  PI-RETURN-CODES.
  1202             20  PI-RETURN-CD-1          PIC X.
  1203             20  PI-RETURN-CD-2          PIC X.
  1204
  1205         16  PI-UPDATE-STATUS-SAVE.
  1206             20  PI-UPDATE-BY            PIC X(4).
  1207             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1208
  1209         16  PI-LOWER-CASE-LETTERS       PIC X.
  1210             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1211
  1212*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1213*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1214*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1215
  1216         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1217             88  ST-ACCNT-CNTL               VALUE ' '.
  1218             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1219             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1220             88  ACCNT-CNTL                  VALUE '3'.
  1221             88  CARR-ACCNT-CNTL             VALUE '4'.
  1222
  1223         16  PI-PROCESSOR-CAP-LIST.
  1224             20  PI-SYSTEM-CONTROLS.
  1225                24 PI-SYSTEM-DISPLAY     PIC X.
  1226                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1227                24 PI-SYSTEM-MODIFY      PIC X.
  1228                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1229             20  FILLER                  PIC XX.
  1230             20  PI-DISPLAY-CAP          PIC X.
  1231                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  23
* EL677.cbl
  1232             20  PI-MODIFY-CAP           PIC X.
  1233                 88  MODIFY-CAP              VALUE 'Y'.
  1234             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1235                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1236             20  PI-FORCE-CAP            PIC X.
  1237                 88  FORCE-CAP               VALUE 'Y'.
  1238
  1239         16  PI-PROGRAM-CONTROLS.
  1240             20  PI-PGM-PRINT-OPT        PIC X.
  1241             20  PI-PGM-FORMAT-OPT       PIC X.
  1242             20  PI-PGM-PROCESS-OPT      PIC X.
  1243             20  PI-PGM-TOTALS-OPT       PIC X.
  1244
  1245         16  PI-HELP-INTERFACE.
  1246             20  PI-LAST-ERROR-NO        PIC X(4).
  1247             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1248
  1249         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1250             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1251
  1252         16  PI-CR-CONTROL-IN-PROGRESS.
  1253             20  PI-CR-CARRIER           PIC X.
  1254             20  PI-CR-GROUPING          PIC X(6).
  1255             20  PI-CR-STATE             PIC XX.
  1256             20  PI-CR-ACCOUNT           PIC X(10).
  1257             20  PI-CR-FIN-RESP          PIC X(10).
  1258             20  PI-CR-TYPE              PIC X.
  1259
  1260         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1261
  1262         16  PI-CR-MONTH-END-DT          PIC XX.
  1263
  1264         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1265             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1266             88  PI-ZERO-CARRIER             VALUE '1'.
  1267             88  PI-ZERO-GROUPING            VALUE '2'.
  1268             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1269
  1270         16  PI-CARRIER-SECURITY         PIC X.
  1271             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1272
  1273         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1274             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1275             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1276
  1277         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1278             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1279                                         INDEXED BY PI-ACCESS-NDX
  1280                                         PIC X.
  1281
  1282         16  PI-GA-BILLING-CONTROL       PIC X.
  1283             88  PI-GA-BILLING               VALUE '1'.
  1284
  1285         16  PI-MAIL-PROCESSING          PIC X.
  1286             88  PI-MAIL-YES                 VALUE 'Y'.
  1287
  1288         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1289
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  24
* EL677.cbl
  1290         16  PI-AR-SYSTEM.
  1291             20  PI-AR-PROCESSING-CNTL   PIC X.
  1292                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1293             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1294             20  PI-AR-MONTH-END-DT      PIC XX.
  1295
  1296         16  PI-MP-SYSTEM.
  1297             20  PI-MORTGAGE-USER            PIC X.
  1298                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1299                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1300             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1301                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1302                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1303                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1304                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1305                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1306             20  PI-MP-MONTH-END-DT          PIC XX.
  1307             20  PI-MP-REFERENCE-NO.
  1308                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1309                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1310
  1311         16  PI-LABEL-CONTROL            PIC X(01).
  1312             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1313             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1314
  1315         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1316             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1317
  1318         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1319             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1320             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1321
  1322         16  FILLER                      PIC X(14).
  1323
  1324     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1325******************************************************************
  1326     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1327         16  PI-EOF-SW               PIC X.
  1328             88  PI-FILE-EOF                     VALUE 'Y'.
  1329         16  PI-PREV-MAINT           PIC X.
  1330         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1331         16  PI-ERCHEK-KEY.
  1332             20  PI-CHEK-COMP-CD     PIC X.
  1333             20  PI-CHEK-CARRIER     PIC X.
  1334             20  PI-CHEK-GROUPING    PIC X(6).
  1335             20  PI-CHEK-STATE       PIC XX.
  1336             20  PI-CHEK-ACCOUNT     PIC X(10).
  1337             20  PI-CHEK-EFF-DT      PIC XX.
  1338             20  PI-CHEK-CERT-NO     PIC X(10).
  1339             20  PI-CHEK-SUF-NO      PIC X.
  1340             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1341         16  PI-ACCOUNT-ADDRESS.
  1342             20  PI-AM-NAME          PIC X(30).
  1343             20  PI-AM-ADDRS         PIC X(30).
  1344             20  PI-AM-CITY-st.
  1345                 24  pi-am-city      PIC X(28).
  1346                 24  pi-am-st        pic xx.
  1347             20  PI-AM-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  25
* EL677.cbl
  1348                 24  PI-AM-ZIP-PRIME PIC X(5).
  1349                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1350         16  PI-PROCESS-CERT-SW          PIC X.
  1351             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1352         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1353             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1354         16  PI-PAYTO1                   PIC X(30).
  1355         16  PI-REFERENCE                PIC X(12).
  1356         16  PI-CANC-DT                  PIC XX.
  1357         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1358         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1359         16  PI-INSURED-NAME             PIC X(28).
  1360         16  PI-PFKEY                    PIC XXX.
  1361             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1362             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1363         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1364         16  PI-TYPE                     PIC X.
  1365         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1366         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1367         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1368         16  pi-chek-rec-cnt             pic s999 comp-3.
  1369         16  pi-am-csr                   pic x(4).
  1370         16  pi-return-to                pic x(30).
  1371         16  pi-prev-ded-comm            pic x.
  1372         16  pi-table-name               pic x(30).
  1373         16  pi-check-cashed             pic x.
  1374         16  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1375         16  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1376         16  pi-check-type               pic x.
  1377             88  pi-corr-check              value 'C'.
  1378             88  pi-ref-check               value 'R'.
  1379         16  pi-check-cut                pic x.
  1380         16  pi-prev-paid-this-month     pic s9(7)v99 comp-3.
  1381         16  pi-previous-deduct-comm     pic x.
  1382         16  FILLER                      PIC X(305). *> wass 311
  1383*                                    COPY ELCAID.
  1384******************************************************************
  1385*                                                                *
  1386*                            ELCAID.                             *
  1387*                            VMOD=2.001                          *
  1388*                                                                *
  1389*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1390*                                                                *
  1391*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1392*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1393******************************************************************
  1394
  1395 01  DFHAID.
  1396   02  DFHNULL   PIC  X  VALUE  ' '.
  1397   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1398   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1399   02  DFHPEN    PIC  X  VALUE  '='.
  1400   02  DFHOPID   PIC  X  VALUE  'W'.
  1401   02  DFHPA1    PIC  X  VALUE  '%'.
  1402   02  DFHPA2    PIC  X  VALUE  '>'.
  1403   02  DFHPA3    PIC  X  VALUE  ','.
  1404   02  DFHPF1    PIC  X  VALUE  '1'.
  1405   02  DFHPF2    PIC  X  VALUE  '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  26
* EL677.cbl
  1406   02  DFHPF3    PIC  X  VALUE  '3'.
  1407   02  DFHPF4    PIC  X  VALUE  '4'.
  1408   02  DFHPF5    PIC  X  VALUE  '5'.
  1409   02  DFHPF6    PIC  X  VALUE  '6'.
  1410   02  DFHPF7    PIC  X  VALUE  '7'.
  1411   02  DFHPF8    PIC  X  VALUE  '8'.
  1412   02  DFHPF9    PIC  X  VALUE  '9'.
  1413   02  DFHPF10   PIC  X  VALUE  ':'.
  1414   02  DFHPF11   PIC  X  VALUE  '#'.
  1415   02  DFHPF12   PIC  X  VALUE  '@'.
  1416   02  DFHPF13   PIC  X  VALUE  'A'.
  1417   02  DFHPF14   PIC  X  VALUE  'B'.
  1418   02  DFHPF15   PIC  X  VALUE  'C'.
  1419   02  DFHPF16   PIC  X  VALUE  'D'.
  1420   02  DFHPF17   PIC  X  VALUE  'E'.
  1421   02  DFHPF18   PIC  X  VALUE  'F'.
  1422   02  DFHPF19   PIC  X  VALUE  'G'.
  1423   02  DFHPF20   PIC  X  VALUE  'H'.
  1424   02  DFHPF21   PIC  X  VALUE  'I'.
  1425*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1426   02  DFHPF22   PIC  X  VALUE  '['.
  1427   02  DFHPF23   PIC  X  VALUE  '.'.
  1428   02  DFHPF24   PIC  X  VALUE  '<'.
  1429   02  DFHMSRE   PIC  X  VALUE  'X'.
  1430   02  DFHSTRF   PIC  X  VALUE  'h'.
  1431   02  DFHTRIG   PIC  X  VALUE  '"'.
  1432 01  FILLER    REDEFINES DFHAID.
  1433     12  FILLER                      PIC X(8).
  1434     12  PF-VALUES                   PIC X       OCCURS 24.
  1435     12  FILLER                      PIC X(3).
  1436*                                    COPY EL677S.
  1437 01  EL677AI.
  1438     05  FILLER            PIC  X(0012).
  1439*    -------------------------------
  1440     05  DATEL PIC S9(0004) COMP.
  1441     05  DATEF PIC  X(0001).
  1442     05  FILLER REDEFINES DATEF.
  1443         10  DATEA PIC  X(0001).
  1444     05  DATEI PIC  X(0008).
  1445*    -------------------------------
  1446     05  TIMEL PIC S9(0004) COMP.
  1447     05  TIMEF PIC  X(0001).
  1448     05  FILLER REDEFINES TIMEF.
  1449         10  TIMEA PIC  X(0001).
  1450     05  TIMEI PIC  X(0005).
  1451*    -------------------------------
  1452     05  MAINTL PIC S9(0004) COMP.
  1453     05  MAINTF PIC  X(0001).
  1454     05  FILLER REDEFINES MAINTF.
  1455         10  MAINTA PIC  X(0001).
  1456     05  MAINTI PIC  X(0001).
  1457*    -------------------------------
  1458     05  DMAINT1L PIC S9(0004) COMP.
  1459     05  DMAINT1F PIC  X(0001).
  1460     05  FILLER REDEFINES DMAINT1F.
  1461         10  DMAINT1A PIC  X(0001).
  1462     05  DMAINT1I PIC  X(0009).
  1463*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  27
* EL677.cbl
  1464     05  DMAINT2L PIC S9(0004) COMP.
  1465     05  DMAINT2F PIC  X(0001).
  1466     05  FILLER REDEFINES DMAINT2F.
  1467         10  DMAINT2A PIC  X(0001).
  1468     05  DMAINT2I PIC  X(0029).
  1469*    -------------------------------
  1470     05  CARRIERL PIC S9(0004) COMP.
  1471     05  CARRIERF PIC  X(0001).
  1472     05  FILLER REDEFINES CARRIERF.
  1473         10  CARRIERA PIC  X(0001).
  1474     05  CARRIERI PIC  X(0001).
  1475*    -------------------------------
  1476     05  GROUPL PIC S9(0004) COMP.
  1477     05  GROUPF PIC  X(0001).
  1478     05  FILLER REDEFINES GROUPF.
  1479         10  GROUPA PIC  X(0001).
  1480     05  GROUPI PIC  X(0006).
  1481*    -------------------------------
  1482     05  STATEL PIC S9(0004) COMP.
  1483     05  STATEF PIC  X(0001).
  1484     05  FILLER REDEFINES STATEF.
  1485         10  STATEA PIC  X(0001).
  1486     05  STATEI PIC  X(0002).
  1487*    -------------------------------
  1488     05  ACCTL PIC S9(0004) COMP.
  1489     05  ACCTF PIC  X(0001).
  1490     05  FILLER REDEFINES ACCTF.
  1491         10  ACCTA PIC  X(0001).
  1492     05  ACCTI PIC  X(0010).
  1493*    -------------------------------
  1494     05  EFFDTL PIC S9(0004) COMP.
  1495     05  EFFDTF PIC  X(0001).
  1496     05  FILLER REDEFINES EFFDTF.
  1497         10  EFFDTA PIC  X(0001).
  1498     05  EFFDTI PIC  X(0008).
  1499*    -------------------------------
  1500     05  CERTNOL PIC S9(0004) COMP.
  1501     05  CERTNOF PIC  X(0001).
  1502     05  FILLER REDEFINES CERTNOF.
  1503         10  CERTNOA PIC  X(0001).
  1504     05  CERTNOI PIC  X(0010).
  1505*    -------------------------------
  1506     05  SFXL PIC S9(0004) COMP.
  1507     05  SFXF PIC  X(0001).
  1508     05  FILLER REDEFINES SFXF.
  1509         10  SFXA PIC  X(0001).
  1510     05  SFXI PIC  X(0001).
  1511*    -------------------------------
  1512     05  SEQL PIC S9(0004) COMP.
  1513     05  SEQF PIC  X(0001).
  1514     05  FILLER REDEFINES SEQF.
  1515         10  SEQA PIC  X(0001).
  1516     05  SEQI PIC  99.
  1517*    -------------------------------
  1518     05  PAYTO1L PIC S9(0004) COMP.
  1519     05  PAYTO1F PIC  X(0001).
  1520     05  FILLER REDEFINES PAYTO1F.
  1521         10  PAYTO1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  28
* EL677.cbl
  1522     05  PAYTO1I PIC  X(0030).
  1523*    -------------------------------
  1524     05  CREATEDL PIC S9(0004) COMP.
  1525     05  CREATEDF PIC  X(0001).
  1526     05  FILLER REDEFINES CREATEDF.
  1527         10  CREATEDA PIC  X(0001).
  1528     05  CREATEDI PIC  X(0008).
  1529*    -------------------------------
  1530     05  CBYL PIC S9(0004) COMP.
  1531     05  CBYF PIC  X(0001).
  1532     05  FILLER REDEFINES CBYF.
  1533         10  CBYA PIC  X(0001).
  1534     05  CBYI PIC  X(0004).
  1535*    -------------------------------
  1536     05  PAYTO2L PIC S9(0004) COMP.
  1537     05  PAYTO2F PIC  X(0001).
  1538     05  FILLER REDEFINES PAYTO2F.
  1539         10  PAYTO2A PIC  X(0001).
  1540     05  PAYTO2I PIC  X(0030).
  1541*    -------------------------------
  1542     05  PAYEEL PIC S9(0004) COMP.
  1543     05  PAYEEF PIC  X(0001).
  1544     05  FILLER REDEFINES PAYEEF.
  1545         10  PAYEEA PIC  X(0001).
  1546     05  PAYEEI PIC  X(0006).
  1547*    -------------------------------
  1548     05  APVSTATL PIC S9(0004) COMP.
  1549     05  APVSTATF PIC  X(0001).
  1550     05  FILLER REDEFINES APVSTATF.
  1551         10  APVSTATA PIC  X(0001).
  1552     05  APVSTATI PIC  X(0009).
  1553*    -------------------------------
  1554     05  PAYAD1L PIC S9(0004) COMP.
  1555     05  PAYAD1F PIC  X(0001).
  1556     05  FILLER REDEFINES PAYAD1F.
  1557         10  PAYAD1A PIC  X(0001).
  1558     05  PAYAD1I PIC  X(0030).
  1559*    -------------------------------
  1560     05  APVDTL PIC S9(0004) COMP.
  1561     05  APVDTF PIC  X(0001).
  1562     05  FILLER REDEFINES APVDTF.
  1563         10  APVDTA PIC  X(0001).
  1564     05  APVDTI PIC  X(0008).
  1565*    -------------------------------
  1566     05  APVBYL PIC S9(0004) COMP.
  1567     05  APVBYF PIC  X(0001).
  1568     05  FILLER REDEFINES APVBYF.
  1569         10  APVBYA PIC  X(0001).
  1570     05  APVBYI PIC  X(0004).
  1571*    -------------------------------
  1572     05  PAYAD2L PIC S9(0004) COMP.
  1573     05  PAYAD2F PIC  X(0001).
  1574     05  FILLER REDEFINES PAYAD2F.
  1575         10  PAYAD2A PIC  X(0001).
  1576     05  PAYAD2I PIC  X(0030).
  1577*    -------------------------------
  1578     05  VOIDEDL PIC S9(0004) COMP.
  1579     05  VOIDEDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  29
* EL677.cbl
  1580     05  FILLER REDEFINES VOIDEDF.
  1581         10  VOIDEDA PIC  X(0001).
  1582     05  VOIDEDI PIC  X(0008).
  1583*    -------------------------------
  1584     05  VBYL PIC S9(0004) COMP.
  1585     05  VBYF PIC  X(0001).
  1586     05  FILLER REDEFINES VBYF.
  1587         10  VBYA PIC  X(0001).
  1588     05  VBYI PIC  X(0004).
  1589*    -------------------------------
  1590     05  PAYCTYL PIC S9(0004) COMP.
  1591     05  PAYCTYF PIC  X(0001).
  1592     05  FILLER REDEFINES PAYCTYF.
  1593         10  PAYCTYA PIC  X(0001).
  1594     05  PAYCTYI PIC  X(0028).
  1595*    -------------------------------
  1596     05  PAYSTL PIC S9(0004) COMP.
  1597     05  PAYSTF PIC  X(0001).
  1598     05  FILLER REDEFINES PAYSTF.
  1599         10  PAYSTA PIC  X(0001).
  1600     05  PAYSTI PIC  X(0002).
  1601*    -------------------------------
  1602     05  PRINTEDL PIC S9(0004) COMP.
  1603     05  PRINTEDF PIC  X(0001).
  1604     05  FILLER REDEFINES PRINTEDF.
  1605         10  PRINTEDA PIC  X(0001).
  1606     05  PRINTEDI PIC  X(0008).
  1607*    -------------------------------
  1608     05  PTOZIPL PIC S9(0004) COMP.
  1609     05  PTOZIPF PIC  X(0001).
  1610     05  FILLER REDEFINES PTOZIPF.
  1611         10  PTOZIPA PIC  X(0001).
  1612     05  PTOZIPI PIC  X(0009).
  1613*    -------------------------------
  1614     05  DEDCYNL PIC S9(0004) COMP.
  1615     05  DEDCYNF PIC  X(0001).
  1616     05  FILLER REDEFINES DEDCYNF.
  1617         10  DEDCYNA PIC  X(0001).
  1618     05  DEDCYNI PIC  X(0001).
  1619*    -------------------------------
  1620     05  CASHEDL PIC S9(0004) COMP.
  1621     05  CASHEDF PIC  X(0001).
  1622     05  FILLER REDEFINES CASHEDF.
  1623         10  CASHEDA PIC  X(0001).
  1624     05  CASHEDI PIC  X(0008).
  1625*    -------------------------------
  1626     05  RETTOL PIC S9(0004) COMP.
  1627     05  RETTOF PIC  X(0001).
  1628     05  FILLER REDEFINES RETTOF.
  1629         10  RETTOA PIC  X(0001).
  1630     05  RETTOI PIC  X(0030).
  1631*    -------------------------------
  1632     05  DPREML PIC S9(0004) COMP.
  1633     05  DPREMF PIC  X(0001).
  1634     05  FILLER REDEFINES DPREMF.
  1635         10  DPREMA PIC  X(0001).
  1636     05  DPREMI PIC  X(0005).
  1637*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  30
* EL677.cbl
  1638     05  PREML PIC S9(0004) COMP.
  1639     05  PREMF PIC  X(0001).
  1640     05  FILLER REDEFINES PREMF.
  1641         10  PREMA PIC  X(0001).
  1642     05  PREMI PIC  X(0008).
  1643*    -------------------------------
  1644     05  DCOMML PIC S9(0004) COMP.
  1645     05  DCOMMF PIC  X(0001).
  1646     05  FILLER REDEFINES DCOMMF.
  1647         10  DCOMMA PIC  X(0001).
  1648     05  DCOMMI PIC  X(0005).
  1649*    -------------------------------
  1650     05  ISSCOMML PIC S9(0004) COMP.
  1651     05  ISSCOMMF PIC  X(0001).
  1652     05  FILLER REDEFINES ISSCOMMF.
  1653         10  ISSCOMMA PIC  X(0001).
  1654     05  ISSCOMMI PIC  X(0008).
  1655*    -------------------------------
  1656     05  DREFL PIC S9(0004) COMP.
  1657     05  DREFF PIC  X(0001).
  1658     05  FILLER REDEFINES DREFF.
  1659         10  DREFA PIC  X(0001).
  1660     05  DREFI PIC  X(0004).
  1661*    -------------------------------
  1662     05  REFL PIC S9(0004) COMP.
  1663     05  REFF PIC  X(0001).
  1664     05  FILLER REDEFINES REFF.
  1665         10  REFA PIC  X(0001).
  1666     05  REFI PIC  X(0008).
  1667*    -------------------------------
  1668     05  DUECOMML PIC S9(0004) COMP.
  1669     05  DUECOMMF PIC  X(0001).
  1670     05  FILLER REDEFINES DUECOMMF.
  1671         10  DUECOMMA PIC  X(0001).
  1672     05  DUECOMMI PIC  X(0007).
  1673*    -------------------------------
  1674     05  UECOMML PIC S9(0004) COMP.
  1675     05  UECOMMF PIC  X(0001).
  1676     05  FILLER REDEFINES UECOMMF.
  1677         10  UECOMMA PIC  X(0001).
  1678     05  UECOMMI PIC  X(0008).
  1679*    -------------------------------
  1680     05  DPREPDL PIC S9(0004) COMP.
  1681     05  DPREPDF PIC  X(0001).
  1682     05  FILLER REDEFINES DPREPDF.
  1683         10  DPREPDA PIC  X(0001).
  1684     05  DPREPDI PIC  X(0006).
  1685*    -------------------------------
  1686     05  PREPDL PIC S9(0004) COMP.
  1687     05  PREPDF PIC  X(0001).
  1688     05  FILLER REDEFINES PREPDF.
  1689         10  PREPDA PIC  X(0001).
  1690     05  PREPDI PIC  X(0008).
  1691*    -------------------------------
  1692     05  AMOUNTL PIC S9(0004) COMP.
  1693     05  AMOUNTF PIC  X(0001).
  1694     05  FILLER REDEFINES AMOUNTF.
  1695         10  AMOUNTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  31
* EL677.cbl
  1696     05  AMOUNTI PIC  S9(9)V99.
  1697*    -------------------------------
  1698     05  CHECKL PIC S9(0004) COMP.
  1699     05  CHECKF PIC  X(0001).
  1700     05  FILLER REDEFINES CHECKF.
  1701         10  CHECKA PIC  X(0001).
  1702     05  CHECKI PIC  X(0007).
  1703*    -------------------------------
  1704     05  TYPEL PIC S9(0004) COMP.
  1705     05  TYPEF PIC  X(0001).
  1706     05  FILLER REDEFINES TYPEF.
  1707         10  TYPEA PIC  X(0001).
  1708     05  TYPEI PIC  X(0001).
  1709*    -------------------------------
  1710     05  REASONL PIC S9(0004) COMP.
  1711     05  REASONF PIC  X(0001).
  1712     05  FILLER REDEFINES REASONF.
  1713         10  REASONA PIC  X(0001).
  1714     05  REASONI PIC  X(0025).
  1715*    -------------------------------
  1716     05  VREASONL PIC S9(0004) COMP.
  1717     05  VREASONF PIC  X(0001).
  1718     05  FILLER REDEFINES VREASONF.
  1719         10  VREASONA PIC  X(0001).
  1720     05  VREASONI PIC  X(0024).
  1721*    -------------------------------
  1722     05  STUBL PIC S9(0004) COMP.
  1723     05  STUBF PIC  X(0001).
  1724     05  FILLER REDEFINES STUBF.
  1725         10  STUBA PIC  X(0001).
  1726     05  STUBI PIC  X(0030).
  1727*    -------------------------------
  1728     05  TEXT1L PIC S9(0004) COMP.
  1729     05  TEXT1F PIC  X(0001).
  1730     05  FILLER REDEFINES TEXT1F.
  1731         10  TEXT1A PIC  X(0001).
  1732     05  TEXT1I PIC  X(0050).
  1733*    -------------------------------
  1734     05  TEXT2L PIC S9(0004) COMP.
  1735     05  TEXT2F PIC  X(0001).
  1736     05  FILLER REDEFINES TEXT2F.
  1737         10  TEXT2A PIC  X(0001).
  1738     05  TEXT2I PIC  X(0050).
  1739*    -------------------------------
  1740     05  TEXT3L PIC S9(0004) COMP.
  1741     05  TEXT3F PIC  X(0001).
  1742     05  FILLER REDEFINES TEXT3F.
  1743         10  TEXT3A PIC  X(0001).
  1744     05  TEXT3I PIC  X(0040).
  1745*    -------------------------------
  1746     05  ERRMSG1L PIC S9(0004) COMP.
  1747     05  ERRMSG1F PIC  X(0001).
  1748     05  FILLER REDEFINES ERRMSG1F.
  1749         10  ERRMSG1A PIC  X(0001).
  1750     05  ERRMSG1I PIC  X(0079).
  1751*    -------------------------------
  1752     05  ERRMSG2L PIC S9(0004) COMP.
  1753     05  ERRMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  32
* EL677.cbl
  1754     05  FILLER REDEFINES ERRMSG2F.
  1755         10  ERRMSG2A PIC  X(0001).
  1756     05  ERRMSG2I PIC  X(0079).
  1757*    -------------------------------
  1758     05  PFENTERL PIC S9(0004) COMP.
  1759     05  PFENTERF PIC  X(0001).
  1760     05  FILLER REDEFINES PFENTERF.
  1761         10  PFENTERA PIC  X(0001).
  1762     05  PFENTERI PIC  9(2).
  1763*    -------------------------------
  1764     05  PF357L PIC S9(0004) COMP.
  1765     05  PF357F PIC  X(0001).
  1766     05  FILLER REDEFINES PF357F.
  1767         10  PF357A PIC  X(0001).
  1768     05  PF357I PIC  X(0050).
  1769*    -------------------------------
  1770     05  PF46L PIC S9(0004) COMP.
  1771     05  PF46F PIC  X(0001).
  1772     05  FILLER REDEFINES PF46F.
  1773         10  PF46A PIC  X(0001).
  1774     05  PF46I PIC  X(0033).
  1775 01  EL677AO REDEFINES EL677AI.
  1776     05  FILLER            PIC  X(0012).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  DATEO PIC  X(0008).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  TIMEO PIC  99.99.
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  MAINTO PIC  X(0001).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  DMAINT1O PIC  X(0009).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  DMAINT2O PIC  X(0029).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  CARRIERO PIC  X(0001).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  GROUPO PIC  X(0006).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  STATEO PIC  X(0002).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  ACCTO PIC  X(0010).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  EFFDTO PIC  99B99B99.
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  CERTNOO PIC  X(0010).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  33
* EL677.cbl
  1812     05  SFXO PIC  X(0001).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  SEQO PIC  99.
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  PAYTO1O PIC  X(0030).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  CREATEDO PIC  X(0008).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  CBYO PIC  X(0004).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  PAYTO2O PIC  X(0030).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  PAYEEO PIC  X(0006).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  APVSTATO PIC  X(0009).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  PAYAD1O PIC  X(0030).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  APVDTO PIC  X(0008).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  APVBYO PIC  X(0004).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  PAYAD2O PIC  X(0030).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  VOIDEDO PIC  X(0008).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  VBYO PIC  X(0004).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  PAYCTYO PIC  X(0028).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  PAYSTO PIC  X(0002).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  PRINTEDO PIC  99B99B99.
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  PTOZIPO PIC  X(0009).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  DEDCYNO PIC  X(0001).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  CASHEDO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  34
* EL677.cbl
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  RETTOO PIC  X(0030).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  DPREMO PIC  X(0005).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  PREMO PIC  Z(5).99.
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  DCOMMO PIC  X(0005).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  ISSCOMMO PIC  Z(5).99.
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  DREFO PIC  X(0004).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  REFO PIC  Z(5).99.
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  DUECOMMO PIC  X(0007).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  UECOMMO PIC  Z(5).99.
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  DPREPDO PIC  X(0006).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  PREPDO PIC  Z(5).99.
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  AMOUNTO PIC  Z(7).ZZ-.
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  CHECKO PIC  X(0007).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  TYPEO PIC  X(0001).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  REASONO PIC  X(0025).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  VREASONO PIC  X(0024).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  STUBO PIC  X(0030).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  TEXT1O PIC  X(0050).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  TEXT2O PIC  X(0050).
  1927*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  35
* EL677.cbl
  1928     05  FILLER            PIC  X(0003).
  1929     05  TEXT3O PIC  X(0040).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  ERRMSG1O PIC  X(0079).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  ERRMSG2O PIC  X(0079).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  PFENTERO PIC  99.
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  PF357O PIC  X(0050).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  PF46O PIC  X(0033).
  1945*    -------------------------------
  1946****************************************************************
  1947*
  1948* Copyright (c) 2007-2013 Dell Inc.
  1949* All rights reserved.
  1950*
  1951****************************************************************
  1952 01  DFHEIV.
  1953   02  DFHEIV0               PIC X(35).
  1954   02  DFHEIV1               PIC X(08).
  1955   02  DFHEIV2               PIC X(08).
  1956   02  DFHEIV3               PIC X(08).
  1957   02  DFHEIV4               PIC X(06).
  1958   02  DFHEIV5               PIC X(04).
  1959   02  DFHEIV6               PIC X(04).
  1960   02  DFHEIV7               PIC X(02).
  1961   02  DFHEIV8               PIC X(02).
  1962   02  DFHEIV9               PIC X(01).
  1963   02  DFHEIV10              PIC S9(7) COMP-3.
  1964   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1965   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1966   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1967   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1968   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1969   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1970   02  DFHEIV17              PIC X(04).
  1971   02  DFHEIV18              PIC X(04).
  1972   02  DFHEIV19              PIC X(04).
  1973   02  DFHEIV20              USAGE IS POINTER.
  1974   02  DFHEIV21              USAGE IS POINTER.
  1975   02  DFHEIV22              USAGE IS POINTER.
  1976   02  DFHEIV23              USAGE IS POINTER.
  1977   02  DFHEIV24              USAGE IS POINTER.
  1978   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1979   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1980   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1981   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1982   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1983   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1984   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1985   02  DFHEIV32              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  36
* EL677.cbl
  1986   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1987   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1988   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1989   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1990   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1991   02  FILLER                PIC X(02).
  1992   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1993   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1994   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1995   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1996   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1997   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1998   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1999 LINKAGE  SECTION.
  2000*****************************************************************
  2001*                                                               *
  2002* Copyright (c) 2007-2013 Dell Inc.                             *
  2003* All rights reserved.                                          *
  2004*                                                               *
  2005*****************************************************************
  2006 01  dfheiblk.
  2007     02  eibtime          pic s9(7) comp-3.
  2008     02  eibdate          pic s9(7) comp-3.
  2009     02  eibtrnid         pic x(4).
  2010     02  eibtaskn         pic s9(7) comp-3.
  2011     02  eibtrmid         pic x(4).
  2012     02  dfheigdi         pic s9(4) comp.
  2013     02  eibcposn         pic s9(4) comp.
  2014     02  eibcalen         pic s9(4) comp.
  2015     02  eibaid           pic x(1).
  2016     02  eibfiller1       pic x(1).
  2017     02  eibfn            pic x(2).
  2018     02  eibfiller2       pic x(2).
  2019     02  eibrcode         pic x(6).
  2020     02  eibfiller3       pic x(2).
  2021     02  eibds            pic x(8).
  2022     02  eibreqid         pic x(8).
  2023     02  eibrsrce         pic x(8).
  2024     02  eibsync          pic x(1).
  2025     02  eibfree          pic x(1).
  2026     02  eibrecv          pic x(1).
  2027     02  eibsend          pic x(1).
  2028     02  eibatt           pic x(1).
  2029     02  eibeoc           pic x(1).
  2030     02  eibfmh           pic x(1).
  2031     02  eibcompl         pic x(1).
  2032     02  eibsig           pic x(1).
  2033     02  eibconf          pic x(1).
  2034     02  eiberr           pic x(1).
  2035     02  eibrldbk         pic x(1).
  2036     02  eiberrcd         pic x(4).
  2037     02  eibsynrb         pic x(1).
  2038     02  eibnodat         pic x(1).
  2039     02  eibfiller5       pic x(2).
  2040     02  eibresp          pic s9(8) comp.
  2041     02  eibresp2         pic s9(8) comp.
  2042     02  dfheigdj         pic s9(4) comp.
  2043     02  dfheigdk         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  37
* EL677.cbl
  2044 01  DFHCOMMAREA.
  2045     05  filler                  PIC X(1024).
  2046 01  var  pic x(30).
  2047*                                    COPY ELCCNTL.
  2048******************************************************************
  2049*                                                                *
  2050*                                                                *
  2051*                            ELCCNTL.                            *
  2052*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2053*                            VMOD=2.059                          *
  2054*                                                                *
  2055*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2056*                                                                *
  2057*   FILE TYPE = VSAM,KSDS                                        *
  2058*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2059*                                                                *
  2060*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2061*       ALTERNATE INDEX = NONE                                   *
  2062*                                                                *
  2063*   LOG = YES                                                    *
  2064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2065******************************************************************
  2066*                   C H A N G E   L O G
  2067*
  2068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2069*-----------------------------------------------------------------
  2070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2071* EFFECTIVE    NUMBER
  2072*-----------------------------------------------------------------
  2073* 082503                   PEMA  ADD BENEFIT GROUP
  2074* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2075* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2076* 092705    2005050300006  PEMA  ADD SPP LEASES
  2077* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2078* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2079* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2080* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2081* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2082* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2083* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2084* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2085* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2086* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2087******************************************************************
  2088*
  2089 01  CONTROL-FILE.
  2090     12  CF-RECORD-ID                       PIC XX.
  2091         88  VALID-CF-ID                        VALUE 'CF'.
  2092
  2093     12  CF-CONTROL-PRIMARY.
  2094         16  CF-COMPANY-ID                  PIC XXX.
  2095         16  CF-RECORD-TYPE                 PIC X.
  2096             88  CF-COMPANY-MASTER              VALUE '1'.
  2097             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2098             88  CF-STATE-MASTER                VALUE '3'.
  2099             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2100             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2101             88  CF-CARRIER-MASTER              VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  38
* EL677.cbl
  2102             88  CF-MORTALITY-MASTER            VALUE '7'.
  2103             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2104             88  CF-TERMINAL-MASTER             VALUE '9'.
  2105             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2106             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2107             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2108             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2109             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2110             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2111             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2112             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2113             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2114         16  CF-ACCESS-CD-GENL              PIC X(4).
  2115         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2116             20  CF-PROCESSOR               PIC X(4).
  2117         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2118             20  CF-STATE-CODE              PIC XX.
  2119             20  FILLER                     PIC XX.
  2120         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2121             20  FILLER                     PIC XX.
  2122             20  CF-HI-BEN-IN-REC           PIC XX.
  2123         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2124             20  FILLER                     PIC XXX.
  2125             20  CF-CARRIER-CNTL            PIC X.
  2126         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2127             20  FILLER                     PIC XX.
  2128             20  CF-HI-TYPE-IN-REC          PIC 99.
  2129         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2130             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2131                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2132             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2133             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2134         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2135             20  FILLER                     PIC X.
  2136             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2137         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2138             20  FILLER                     PIC XX.
  2139             20  CF-MORTGAGE-PLAN           PIC XX.
  2140         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2141
  2142     12  CF-LAST-MAINT-DT                   PIC XX.
  2143     12  CF-LAST-MAINT-BY                   PIC X(4).
  2144     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2145
  2146     12  CF-RECORD-BODY                     PIC X(728).
  2147
  2148
  2149****************************************************************
  2150*             COMPANY MASTER RECORD                            *
  2151****************************************************************
  2152
  2153     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2154         16  CF-COMPANY-ADDRESS.
  2155             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2156             20  CF-CL-IN-CARE-OF           PIC X(30).
  2157             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2158             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2159             20  CF-CL-CITY-STATE           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  39
* EL677.cbl
  2160             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2161             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2162         16  CF-COMPANY-CD                  PIC X.
  2163         16  CF-COMPANY-PASSWORD            PIC X(8).
  2164         16  CF-SECURITY-OPTION             PIC X.
  2165             88  ALL-SECURITY                   VALUE '1'.
  2166             88  COMPANY-VERIFY                 VALUE '2'.
  2167             88  PROCESSOR-VERIFY               VALUE '3'.
  2168             88  NO-SECURITY                    VALUE '4'.
  2169             88  ALL-BUT-TERM                   VALUE '5'.
  2170         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2171             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2172         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2173             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2174         16  CF-INFORCE-LOCATION            PIC X.
  2175             88  CERTS-ARE-ONLINE               VALUE '1'.
  2176             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2177             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2178         16  CF-LOWER-CASE-LETTERS          PIC X.
  2179         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2180             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2181             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2182             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2183             88  CF-ACCNT-CNTL                  VALUE '3'.
  2184             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2185
  2186         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2187         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2188
  2189         16  CF-LGX-CREDIT-USER             PIC X.
  2190             88  CO-IS-NOT-USER                 VALUE 'N'.
  2191             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2192
  2193         16 CF-CREDIT-CALC-CODES.
  2194             20  CF-CR-REM-TERM-CALC PIC X.
  2195               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2196               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2197               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2198               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2199               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2200               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2201               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2202             20  CF-CR-R78-METHOD           PIC X.
  2203               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2204               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2205
  2206         16  CF-CLAIM-CONTROL-COUNTS.
  2207             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2208                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2209
  2210             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2211                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2212
  2213             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2214                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2215
  2216             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2217                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  40
* EL677.cbl
  2218
  2219         16  CF-CURRENT-MONTH-END           PIC XX.
  2220
  2221         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2222             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2223             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2224             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2225             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2226                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2227                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2228             20  CF-CO-PREM-REJECT-SW       PIC X.
  2229                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2230                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2231             20  CF-CO-REF-REJECT-SW        PIC X.
  2232                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2233                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2234
  2235         16  CF-CO-REPORTING-DT             PIC XX.
  2236         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2237         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2238           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2239           88  CF-CO-MONTH-END                  VALUE '1'.
  2240
  2241         16  CF-LGX-CLAIM-USER              PIC X.
  2242             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2243             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2244
  2245         16  CF-CREDIT-EDIT-CONTROLS.
  2246             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2247             20  CF-MIN-AGE                 PIC 99.
  2248             20  CF-DEFAULT-AGE             PIC 99.
  2249             20  CF-MIN-TERM                PIC S999      COMP-3.
  2250             20  CF-MAX-TERM                PIC S999      COMP-3.
  2251             20  CF-DEFAULT-SEX             PIC X.
  2252             20  CF-JOINT-AGE-INPUT         PIC X.
  2253                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2254             20  CF-BIRTH-DATE-INPUT        PIC X.
  2255                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2256             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2257                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2258                 88  CF-ZERO-CARRIER            VALUE '1'.
  2259                 88  CF-ZERO-GROUPING           VALUE '2'.
  2260                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2261             20  CF-EDIT-SW                 PIC X.
  2262                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2263             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2264             20  CF-CR-PR-METHOD            PIC X.
  2265               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2266               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2267             20  FILLER                     PIC X.
  2268
  2269         16  CF-CREDIT-MISC-CONTROLS.
  2270             20  CF-REIN-TABLE-SW           PIC X.
  2271                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2272             20  CF-COMP-TABLE-SW           PIC X.
  2273                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2274             20  CF-EXPERIENCE-RETENTION-AGE
  2275                                            PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  41
* EL677.cbl
  2276             20  CF-CONVERSION-DT           PIC XX.
  2277             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2278             20  CF-RUN-FREQUENCY-SW        PIC X.
  2279                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2280                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2281
  2282             20  CF-CR-CHECK-NO-CONTROL.
  2283                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2284                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2285                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2286                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2287                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2288                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2289
  2290                 24  CF-CR-CHECK-COUNT       REDEFINES
  2291                     CF-CR-CHECK-COUNTER      PIC X(4).
  2292
  2293                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2294                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2295
  2296                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2297                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2298                 24  CF-MAIL-PROCESSING       PIC X.
  2299                     88  MAIL-PROCESSING          VALUE 'Y'.
  2300
  2301         16  CF-MISC-SYSTEM-CONTROL.
  2302             20  CF-SYSTEM-C                 PIC X.
  2303                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2304             20  CF-SYSTEM-D                 PIC X.
  2305                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2306             20  CF-SOC-SEC-NO-SW            PIC X.
  2307                 88  SOC-SEC-NO-USED             VALUE '1'.
  2308             20  CF-MEMBER-NO-SW             PIC X.
  2309                 88  MEMBER-NO-USED              VALUE '1'.
  2310             20  CF-TAX-ID-NUMBER            PIC X(11).
  2311             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2312             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2313                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2314                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2315                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2316                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2317             20  CF-SYSTEM-E                 PIC X.
  2318                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2319
  2320         16  CF-LGX-LIFE-USER               PIC X.
  2321             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2322             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2323
  2324         16  CF-CR-MONTH-END-DT             PIC XX.
  2325
  2326         16  CF-FILE-MAINT-DATES.
  2327             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2328                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2329             20  CF-LAST-BATCH       REDEFINES
  2330                 CF-LAST-BATCH-NO               PIC X(4).
  2331             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2332             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2333             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  42
* EL677.cbl
  2334             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2335             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2336             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2337             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2338             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2339             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2340             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2341
  2342         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2343         16  FILLER                         PIC X.
  2344
  2345         16  CF-ALT-MORT-CODE               PIC X(4).
  2346         16  CF-MEMBER-CAPTION              PIC X(10).
  2347
  2348         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2349             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2350             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2351             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2352             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2353             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2354
  2355         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2356
  2357         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2358         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2359         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2360         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2361
  2362         16  CF-AH-OVERRIDE-L1              PIC X.
  2363         16  CF-AH-OVERRIDE-L2              PIC XX.
  2364         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2365         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2366
  2367         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2368         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2369
  2370         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2371         16  CF-AR-LAST-EL860-DT            PIC XX.
  2372         16  CF-MP-MONTH-END-DT             PIC XX.
  2373
  2374         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2375         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2376             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2377
  2378         16  CF-AR-MONTH-END-DT             PIC XX.
  2379
  2380         16  CF-CRDTCRD-USER                PIC X.
  2381             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2382             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2383
  2384         16  CF-CC-MONTH-END-DT             PIC XX.
  2385
  2386         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2387
  2388         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2389             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2390             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2391             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  43
* EL677.cbl
  2392         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2393         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2394         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2395         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2396             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2397             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2398         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2399         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2400         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2401             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2402         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2403
  2404         16  CF-CL-ZIP-CODE.
  2405             20  CF-CL-ZIP-PRIME.
  2406                 24  CF-CL-ZIP-1ST          PIC X.
  2407                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2408                 24  FILLER                 PIC X(4).
  2409             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2410         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2411             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2412             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2413             20  FILLER                     PIC XXX.
  2414
  2415         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2416         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2417         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2418         16  CF-CO-OPTION-START-DATE        PIC XX.
  2419         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2420           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2421                                                      '3' '4'.
  2422           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2423           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2424           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2425           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2426           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2427           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2428
  2429         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2430
  2431         16  CF-PAYMENT-APPROVAL-LEVELS.
  2432             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2433             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2434             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2435             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2436             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2437             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2438
  2439         16  CF-END-USER-REPORTING-USER     PIC X.
  2440             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2441             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2442
  2443         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2444             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2445             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2446
  2447         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2448
  2449         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  44
* EL677.cbl
  2450         16  FILLER                         PIC X.
  2451
  2452         16  CF-CREDIT-ARCHIVE-CNTL.
  2453             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2454             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2455             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2456
  2457         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2458
  2459         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2460             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2461             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2462
  2463         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2464             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2465             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2466
  2467         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2468
  2469         16  CF-CO-ACH-ID-CODE              PIC  X.
  2470             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2471             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2472             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2473         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2474         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2475         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2476         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2477         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2478         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2479         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2480         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2481         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2482                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2483         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2484                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2485
  2486         16  CF-CO-OVER-SHORT.
  2487             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2488             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2489
  2490*         16  FILLER                         PIC X(102).
  2491         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2492             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2493             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2494
  2495         16  CF-AH-APPROVAL-DAYS.
  2496             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2497             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2498             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2499             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2500
  2501         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2502
  2503         16  CF-APPROV-LEV-5.
  2504             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2505             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2506             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2507
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  45
* EL677.cbl
  2508         16  FILLER                         PIC X(68).
  2509****************************************************************
  2510*             PROCESSOR/USER RECORD                            *
  2511****************************************************************
  2512
  2513     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2514         16  CF-PROCESSOR-NAME              PIC X(30).
  2515         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2516         16  CF-PROCESSOR-TITLE             PIC X(26).
  2517         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2518                 88  MESSAGE-YES                VALUE 'Y'.
  2519                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2520
  2521*****************************************************
  2522****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2523****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2524****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2525****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2526*****************************************************
  2527
  2528         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2529             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2530             20  CF-APPLICATION-FORCE       PIC X.
  2531             20  CF-INDIVIDUAL-APP.
  2532                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2533                     28  CF-BROWSE-APP      PIC X.
  2534                     28  CF-UPDATE-APP      PIC X.
  2535
  2536         16  CF-CURRENT-TERM-ON             PIC X(4).
  2537         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2538             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2539             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2540             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2541             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2542             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2543             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2544             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2545         16  CF-PROCESSOR-CARRIER           PIC X.
  2546             88  NO-CARRIER-SECURITY            VALUE ' '.
  2547         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2548             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2549         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2550             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2551         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2552             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2553
  2554         16  CF-PROC-SYS-ACCESS-SW.
  2555             20  CF-PROC-CREDIT-CLAIMS-SW.
  2556                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2557                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2558                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2559                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2560             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2561                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2562                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2563             20  CF-PROC-LIFE-GNRLDGR-SW.
  2564                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2565                     88  ACCESS-TO-LIFE             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  46
* EL677.cbl
  2566                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2567                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2568             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2569                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2570                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2571         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2572             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2573             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2574         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2575
  2576         16  CF-APPROVAL-LEVEL                  PIC X.
  2577             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2578             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2579             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2580             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2581             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2582
  2583         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2584
  2585         16  CF-LANGUAGE-TYPE                   PIC X.
  2586             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2587             88  CF-LANG-IS-FR                      VALUE 'F'.
  2588
  2589         16  CF-CSR-IND                         PIC X.
  2590         16  FILLER                             PIC X(239).
  2591
  2592****************************************************************
  2593*             PROCESSOR/REMINDERS RECORD                       *
  2594****************************************************************
  2595
  2596     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2597         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2598             20  CF-START-REMIND-DT         PIC XX.
  2599             20  CF-END-REMIND-DT           PIC XX.
  2600             20  CF-REMINDER-TEXT           PIC X(50).
  2601         16  FILLER                         PIC X(296).
  2602
  2603
  2604****************************************************************
  2605*             STATE MASTER RECORD                              *
  2606****************************************************************
  2607
  2608     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2609         16  CF-STATE-ABBREVIATION          PIC XX.
  2610         16  CF-STATE-NAME                  PIC X(25).
  2611         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2612         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2613             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2614             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2615             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2616             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2617                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2618                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2619             20  CF-ST-PREM-REJECT-SW       PIC X.
  2620                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2621                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2622             20  CF-ST-REF-REJECT-SW        PIC X.
  2623                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  47
* EL677.cbl
  2624                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2625         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2626         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2627         16  CF-ST-REFUND-RULES.
  2628             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2629             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2630             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2631         16  CF-ST-FST-PMT-EXTENSION.
  2632             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2633             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2634                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2635                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2636                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2637                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2638         16  CF-ST-STATE-CALL.
  2639             20  CF-ST-CALL-UNEARNED        PIC X.
  2640             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2641             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2642         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2643             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2644             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2645         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2646         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2647         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2648         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2649         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2650         16  FILLER                         PIC X.
  2651         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2652             20  CF-ST-BENEFIT-CD           PIC XX.
  2653             20  CF-ST-BENEFIT-KIND         PIC X.
  2654                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2655                 88  CF-ST-AH-KIND              VALUE 'A'.
  2656             20  CF-ST-REM-TERM-CALC        PIC X.
  2657                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2658                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2659                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2660                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2661                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2662                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2663                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2664                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2665
  2666             20  CF-ST-REFUND-CALC          PIC X.
  2667                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2668                 88  ST-REFD-BY-R78             VALUE '1'.
  2669                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2670                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2671                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2672                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2673                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2674                 88  ST-REFD-UTAH               VALUE '7'.
  2675                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2676                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2677                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2678
  2679             20  CF-ST-EARNING-CALC         PIC X.
  2680                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2681                 88  ST-EARN-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  48
* EL677.cbl
  2682                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2683                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2684                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2685                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2686                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2687                 88  ST-EARN-MEAN               VALUE '8'.
  2688                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2689
  2690             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2691                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2692                 88  ST-OVRD-BY-R78             VALUE '1'.
  2693                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2694                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2695                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2696                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2697                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2698                 88  ST-OVRD-MEAN               VALUE '8'.
  2699                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2700             20  cf-st-extra-periods        pic 9.
  2701*            20  FILLER                     PIC X.
  2702
  2703         16  CF-ST-COMMISSION-CAPS.
  2704             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2705             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2706             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2707             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2708         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2709                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2710
  2711         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2712
  2713         16  CF-ST-STATUTORY-INTEREST.
  2714             20  CF-ST-STAT-DATE-FROM       PIC X.
  2715                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2716                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2717             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2718             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2719             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2720             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2721             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2722
  2723         16  CF-ST-OVER-SHORT.
  2724             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2725             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2726
  2727         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2728
  2729         16  CF-ST-RT-CALC                  PIC X.
  2730
  2731         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2732         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2733         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2734         16  CF-ST-RF-LR-CALC               PIC X.
  2735         16  CF-ST-RF-LL-CALC               PIC X.
  2736         16  CF-ST-RF-LN-CALC               PIC X.
  2737         16  CF-ST-RF-AH-CALC               PIC X.
  2738         16  CF-ST-RF-CP-CALC               PIC X.
  2739*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  49
* EL677.cbl
  2740*CIDMOD         16  FILLER                         PIC X(192).
  2741         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2742             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2743         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2744         16  CF-ST-VFY-2ND-BENE             PIC X.
  2745         16  CF-ST-CAUSAL-STATE             PIC X.
  2746         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2747         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2748         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2749             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2750         16  CF-ST-NET-ONLY-STATE           PIC X.
  2751             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2752         16  FILLER                         PIC X(181).
  2753
  2754****************************************************************
  2755*             BENEFIT MASTER RECORD                            *
  2756****************************************************************
  2757
  2758     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2759         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2760             20  CF-BENEFIT-CODE            PIC XX.
  2761             20  CF-BENEFIT-NUMERIC  REDEFINES
  2762                 CF-BENEFIT-CODE            PIC XX.
  2763             20  CF-BENEFIT-ALPHA           PIC XXX.
  2764             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2765             20  CF-BENEFIT-COMMENT         PIC X(10).
  2766
  2767             20  CF-LF-COVERAGE-TYPE        PIC X.
  2768                 88  CF-REDUCING                VALUE 'R'.
  2769                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2770
  2771             20  CF-SPECIAL-CALC-CD         PIC X.
  2772                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2773                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2774                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2775                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2776                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2777                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2778                 88  CF-FARM-PLAN               VALUE 'F'.
  2779                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2780                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2781                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2782                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2783                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2784                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2785                 88  CF-PRUDENTIAL              VALUE 'P'.
  2786                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2787                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2788                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2789                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2790                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2791                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2792
  2793             20  CF-JOINT-INDICATOR         PIC X.
  2794                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2795
  2796*            20  FILLER                     PIC X(12).
  2797             20  cf-maximum-benefits        pic s999 comp-3.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  50
* EL677.cbl
  2798             20  FILLER                     PIC X(09).
  2799             20  CF-BENEFIT-CATEGORY        PIC X.
  2800             20  CF-LOAN-TYPE               PIC X(8).
  2801
  2802             20  CF-CO-REM-TERM-CALC        PIC X.
  2803                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2804                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2805                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2806                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2807                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2808
  2809             20  CF-CO-EARNINGS-CALC        PIC X.
  2810                 88  CO-EARN-BY-R78             VALUE '1'.
  2811                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2812                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2813                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2814                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2815                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2816                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2817                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2818
  2819             20  CF-CO-REFUND-CALC          PIC X.
  2820                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2821                 88  CO-REFD-BY-R78             VALUE '1'.
  2822                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2823                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2824                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2825                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2826                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2827                 88  CO-REFD-MEAN               VALUE '8'.
  2828                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2829                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2830                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2831
  2832             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2833                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2834                 88  CO-OVRD-BY-R78             VALUE '1'.
  2835                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2836                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2837                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2838                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2839                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2840                 88  CO-OVRD-MEAN               VALUE '8'.
  2841                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2842
  2843             20  CF-CO-BEN-I-G-CD           PIC X.
  2844                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2845                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2846                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2847
  2848         16  FILLER                         PIC X(304).
  2849
  2850
  2851****************************************************************
  2852*             CARRIER MASTER RECORD                            *
  2853****************************************************************
  2854
  2855     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  51
* EL677.cbl
  2856         16  CF-ADDRESS-DATA.
  2857             20  CF-MAIL-TO-NAME            PIC X(30).
  2858             20  CF-IN-CARE-OF              PIC X(30).
  2859             20  CF-ADDRESS-LINE-1          PIC X(30).
  2860             20  CF-ADDRESS-LINE-2          PIC X(30).
  2861             20  CF-CITY-STATE              PIC X(30).
  2862             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2863             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2864
  2865         16  CF-CLAIM-NO-CONTROL.
  2866             20  CF-CLAIM-NO-METHOD         PIC X.
  2867                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2868                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2869                 88  CLAIM-NO-SEQ               VALUE '3'.
  2870                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2871             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2872                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2873                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2874                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2875
  2876         16  CF-CHECK-NO-CONTROL.
  2877             20  CF-CHECK-NO-METHOD         PIC X.
  2878                 88  CHECK-NO-MANUAL            VALUE '1'.
  2879                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2880                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2881                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2882             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2883                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2884
  2885         16  CF-DOMICILE-STATE              PIC XX.
  2886
  2887         16  CF-EXPENSE-CONTROLS.
  2888             20  CF-EXPENSE-METHOD          PIC X.
  2889                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2890                 88  DOLLARS-PER-PMT            VALUE '2'.
  2891                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2892                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2893             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2894             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2895
  2896         16  CF-CORRESPONDENCE-CONTROL.
  2897             20  CF-LETTER-RESEND-OPT       PIC X.
  2898                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2899                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2900             20  FILLER                     PIC X(4).
  2901
  2902         16  CF-RESERVE-CONTROLS.
  2903             20  CF-MANUAL-SW               PIC X.
  2904                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2905             20  CF-FUTURE-SW               PIC X.
  2906                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2907             20  CF-PTC-SW                  PIC X.
  2908                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2909             20  CF-IBNR-SW                 PIC X.
  2910                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2911             20  CF-PTC-LF-SW               PIC X.
  2912                 88  CF-LF-PTC-USED             VALUE '1'.
  2913             20  CF-CDT-ACCESS-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  52
* EL677.cbl
  2914                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2915                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2916                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2917             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2918
  2919         16  CF-CLAIM-CALC-METHOD           PIC X.
  2920             88  360-PLUS-MONTHS                VALUE '1'.
  2921             88  365-PLUS-MONTHS                VALUE '2'.
  2922             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2923             88  360-DAILY                      VALUE '4'.
  2924             88  365-DAILY                      VALUE '5'.
  2925
  2926         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2927         16  FILLER                         PIC X(11).
  2928
  2929         16  CF-LIMIT-AMOUNTS.
  2930             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2931             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2932             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2933             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2934             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2935             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2936             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2937             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2938             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2939             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2940
  2941         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2942         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2943         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2944
  2945         16  CF-ZIP-CODE.
  2946             20  CF-ZIP-PRIME.
  2947                 24  CF-ZIP-1ST             PIC X.
  2948                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2949                 24  FILLER                 PIC X(4).
  2950             20  CF-ZIP-PLUS4               PIC X(4).
  2951         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2952             20  CF-CAN-POSTAL-1            PIC XXX.
  2953             20  CF-CAN-POSTAL-2            PIC XXX.
  2954             20  FILLER                     PIC XXX.
  2955
  2956         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2957         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2958         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2959
  2960         16  CF-RATING-SWITCH               PIC X.
  2961             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2962             88  CF-NO-RATING                   VALUE 'N'.
  2963
  2964         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2965
  2966         16  CF-CARRIER-OVER-SHORT.
  2967             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2968             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2969
  2970         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2971         16  CF-SECPAY-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  53
* EL677.cbl
  2972             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2973             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2974         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2975         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2976         16  FILLER                         PIC X(444).
  2977*        16  FILLER                         PIC X(452).
  2978
  2979
  2980****************************************************************
  2981*             MORTALITY MASTER RECORD                          *
  2982****************************************************************
  2983
  2984     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2985         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2986                                INDEXED BY CF-MORT-NDX.
  2987             20  CF-MORT-TABLE              PIC X(5).
  2988             20  CF-MORT-TABLE-TYPE         PIC X.
  2989                 88  CF-MORT-JOINT              VALUE 'J'.
  2990                 88  CF-MORT-SINGLE             VALUE 'S'.
  2991                 88  CF-MORT-COMBINED           VALUE 'C'.
  2992                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2993                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2994             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2995             20  CF-MORT-AGE-METHOD         PIC XX.
  2996                 88  CF-AGE-LAST                VALUE 'AL'.
  2997                 88  CF-AGE-NEAR                VALUE 'AN'.
  2998             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2999             20  CF-MORT-ADJUSTMENT-DIRECTION
  3000                                            PIC X.
  3001                 88  CF-MINUS                   VALUE '-'.
  3002                 88  CF-PLUS                    VALUE '+'.
  3003             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3004             20  CF-MORT-JOINT-CODE         PIC X.
  3005                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3006             20  CF-MORT-PC-Q               PIC X.
  3007                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3008             20  CF-MORT-TABLE-CODE         PIC X(4).
  3009             20  CF-MORT-COMMENTS           PIC X(15).
  3010             20  FILLER                     PIC X(14).
  3011
  3012         16  FILLER                         PIC X(251).
  3013
  3014
  3015****************************************************************
  3016*             BUSSINESS TYPE MASTER RECORD                     *
  3017****************************************************************
  3018
  3019     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3020* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3021* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3022* AND RECORD 05 IS TYPES 81-99
  3023         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3024             20  CF-BUSINESS-TITLE          PIC  X(19).
  3025             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3026                                            PIC S9V9(4) COMP-3.
  3027             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3028             20  FILLER                     PIC  X.
  3029         16  FILLER                         PIC  X(248).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  54
* EL677.cbl
  3030
  3031
  3032****************************************************************
  3033*             TERMINAL MASTER RECORD                           *
  3034****************************************************************
  3035
  3036     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3037
  3038         16  CF-COMPANY-TERMINALS.
  3039             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3040                                  PIC X(4).
  3041         16  FILLER               PIC X(248).
  3042
  3043
  3044****************************************************************
  3045*             LIFE EDIT MASTER RECORD                          *
  3046****************************************************************
  3047
  3048     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3049         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3050             20  CF-LIFE-CODE-IN            PIC XX.
  3051             20  CF-LIFE-CODE-OUT           PIC XX.
  3052         16  FILLER                         PIC X(248).
  3053
  3054
  3055****************************************************************
  3056*             AH EDIT MASTER RECORD                            *
  3057****************************************************************
  3058
  3059     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3060         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3061             20  CF-AH-CODE-IN              PIC XXX.
  3062             20  CF-AH-CODE-OUT             PIC XX.
  3063         16  FILLER                         PIC X(248).
  3064
  3065
  3066****************************************************************
  3067*             CREDIBILITY TABLES                               *
  3068****************************************************************
  3069
  3070     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3071         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3072                             INDEXED BY CF-CRDB-NDX.
  3073             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3074             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3075             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3076         16  FILLER                         PIC  X(332).
  3077
  3078
  3079****************************************************************
  3080*             REPORT CUSTOMIZATION RECORD                      *
  3081****************************************************************
  3082
  3083     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3084         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3085             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3086             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3087             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  55
* EL677.cbl
  3088**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3089****       A T-TRANSFER.                                   ****
  3090             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3091
  3092         16  FILLER                         PIC XX.
  3093
  3094         16  CF-CARRIER-CNTL-OPT.
  3095             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3096                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3097                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3098             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3099                                            PIC X.
  3100         16  CF-GROUP-CNTL-OPT.
  3101             20  CF-GROUP-OPT-SEQ           PIC 9.
  3102                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3103                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3104             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3105                                            PIC X(6).
  3106         16  CF-STATE-CNTL-OPT.
  3107             20  CF-STATE-OPT-SEQ           PIC 9.
  3108                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3109                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3110             20  CF-STATE-SELECT OCCURS 3 TIMES
  3111                                            PIC XX.
  3112         16  CF-ACCOUNT-CNTL-OPT.
  3113             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3114                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3115                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3116             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3117                                            PIC X(10).
  3118         16  CF-BUS-TYP-CNTL-OPT.
  3119             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3120                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3121                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3122             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3123                                            PIC XX.
  3124         16  CF-LF-TYP-CNTL-OPT.
  3125             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3126                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3127                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3128             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3129                                            PIC XX.
  3130         16  CF-AH-TYP-CNTL-OPT.
  3131             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3132                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3133                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3134             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3135                                            PIC XX.
  3136         16  CF-REPTCD1-CNTL-OPT.
  3137             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3138                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3139                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3140             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3141                                            PIC X(10).
  3142         16  CF-REPTCD2-CNTL-OPT.
  3143             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3144                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3145                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  56
* EL677.cbl
  3146             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3147                                            PIC X(10).
  3148         16  CF-USER1-CNTL-OPT.
  3149             20  CF-USER1-OPT-SEQ           PIC 9.
  3150                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3151                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3152             20  CF-USER1-SELECT OCCURS 3 TIMES
  3153                                            PIC X(10).
  3154         16  CF-USER2-CNTL-OPT.
  3155             20  CF-USER2-OPT-SEQ           PIC 9.
  3156                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3157                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3158             20  CF-USER2-SELECT OCCURS 3 TIMES
  3159                                            PIC X(10).
  3160         16  CF-USER3-CNTL-OPT.
  3161             20  CF-USER3-OPT-SEQ           PIC 9.
  3162                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3163                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3164             20  CF-USER3-SELECT OCCURS 3 TIMES
  3165                                            PIC X(10).
  3166         16  CF-USER4-CNTL-OPT.
  3167             20  CF-USER4-OPT-SEQ           PIC 9.
  3168                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3169                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3170             20  CF-USER4-SELECT OCCURS 3 TIMES
  3171                                            PIC X(10).
  3172         16  CF-USER5-CNTL-OPT.
  3173             20  CF-USER5-OPT-SEQ           PIC 9.
  3174                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3175                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3176             20  CF-USER5-SELECT OCCURS 3 TIMES
  3177                                            PIC X(10).
  3178         16  CF-REINS-CNTL-OPT.
  3179             20  CF-REINS-OPT-SEQ           PIC 9.
  3180                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3181                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3182             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3183                 24  CF-REINS-PRIME         PIC XXX.
  3184                 24  CF-REINS-SUB           PIC XXX.
  3185
  3186         16  CF-AGENT-CNTL-OPT.
  3187             20  CF-AGENT-OPT-SEQ           PIC 9.
  3188                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3189                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3190             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3191                                            PIC X(10).
  3192
  3193         16  FILLER                         PIC X(43).
  3194
  3195         16  CF-LOSS-RATIO-SELECT.
  3196             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3197             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3198         16  CF-ENTRY-DATE-SELECT.
  3199             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3200             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3201         16  CF-EFFECTIVE-DATE-SELECT.
  3202             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3203             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  57
* EL677.cbl
  3204
  3205         16  CF-EXCEPTION-LIST-IND          PIC X.
  3206             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3207
  3208         16  FILLER                         PIC X(318).
  3209
  3210****************************************************************
  3211*                  EXCEPTION REPORTING RECORD                  *
  3212****************************************************************
  3213
  3214     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3215         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3216             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3217
  3218         16  CF-COMBINED-LIFE-AH-OPT.
  3219             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3220             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3221             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3222             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3223
  3224         16  CF-LIFE-OPT.
  3225             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3226             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3227             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3228             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3229             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3230             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3231             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3232             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3233             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3234             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3235
  3236         16  CF-AH-OPT.
  3237             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3238             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3239             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3240             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3241             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3242             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3243             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3244             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3245             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3246             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3247
  3248         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3249             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3250             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3251             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3252
  3253         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3254
  3255         16  FILLER                         PIC X(673).
  3256
  3257
  3258****************************************************************
  3259*             MORTGAGE SYSTEM PLAN RECORD                      *
  3260****************************************************************
  3261
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  58
* EL677.cbl
  3262     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3263         16  CF-PLAN-TYPE                   PIC X.
  3264             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3265             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3266             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3267         16  CF-PLAN-ABBREV                 PIC XXX.
  3268         16  CF-PLAN-DESCRIPT               PIC X(10).
  3269         16  CF-PLAN-NOTES                  PIC X(20).
  3270         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3271         16  CF-PLAN-UNDERWRITING.
  3272             20  CF-PLAN-TERM-DATA.
  3273                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3274                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3275             20  CF-PLAN-AGE-DATA.
  3276                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3277                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3278                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3279             20  CF-PLAN-BENEFIT-DATA.
  3280                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3281                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3282                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3283                                            PIC S9(7)V99  COMP-3.
  3284         16  CF-PLAN-POLICY-FORMS.
  3285             20  CF-POLICY-FORM             PIC X(12).
  3286             20  CF-MASTER-APPLICATION      PIC X(12).
  3287             20  CF-MASTER-POLICY           PIC X(12).
  3288         16  CF-PLAN-RATING.
  3289             20  CF-RATE-CODE               PIC X(5).
  3290             20  CF-SEX-RATING              PIC X.
  3291                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3292                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3293             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3294             20  CF-SUB-STD-TYPE            PIC X.
  3295                 88  CF-PCT-OF-PREM            VALUE '1'.
  3296                 88  CF-PCT-OF-BENE            VALUE '2'.
  3297         16  CF-PLAN-PREM-TOLERANCES.
  3298             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3299             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3300         16  CF-PLAN-PYMT-TOLERANCES.
  3301             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3302             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3303         16  CF-PLAN-MISC-DATA.
  3304             20  FILLER                     PIC X.
  3305             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3306             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3307         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3308         16  CF-PLAN-IND-GRP                PIC X.
  3309             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3310                                                     '1'.
  3311             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3312                                                     '2'.
  3313         16  CF-MIB-SEARCH-SW               PIC X.
  3314             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3315             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3316             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3317             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3318         16  CF-ALPHA-SEARCH-SW             PIC X.
  3319             88  CF-MIB-ALPHA-ALL              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  59
* EL677.cbl
  3320             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3321             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3322             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3323             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3324             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3325             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3326             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3327             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3328             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3329                                                     'A' 'B' 'C'
  3330                                                     'X' 'Y' 'Z'.
  3331         16  CF-EFF-DT-RULE-SW              PIC X.
  3332             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3333             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3334             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3335             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3336             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3337         16  FILLER                         PIC X(4).
  3338         16  CF-HEALTH-QUESTIONS            PIC X.
  3339             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3340         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3341         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3342         16  CF-PLAN-SNGL-JNT               PIC X.
  3343             88  CF-COMBINED-PLAN              VALUE 'C'.
  3344             88  CF-JNT-PLAN                   VALUE 'J'.
  3345             88  CF-SNGL-PLAN                  VALUE 'S'.
  3346         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3347         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3348         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3349         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3350         16  CF-RERATE-CNTL                 PIC  X.
  3351             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3352             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3353             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3354             88  CF-AUTO-RECALC                 VALUE '4'.
  3355         16  CF-BENEFIT-TYPE                PIC  X.
  3356             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3357             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3358         16  CF-POLICY-FEE                  PIC S999V99
  3359                                                    COMP-3.
  3360         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3361         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3362         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3363         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3364         16  FILLER                         PIC  X(32).
  3365         16  CF-TERMINATION-FORM            PIC  X(04).
  3366         16  FILLER                         PIC  X(08).
  3367         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3368                                                       COMP-3.
  3369         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3370         16  CF-ISSUE-LETTER                PIC  X(4).
  3371         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3372         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3373             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3374             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3375         16  CF-MP-REFUND-CALC              PIC X.
  3376             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3377             88  CF-MP-REFD-BY-R78              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  60
* EL677.cbl
  3378             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3379             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3380             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3381             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3382             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3383             88  CF-MP-REFD-MEAN                VALUE '8'.
  3384         16  CF-ALT-RATE-CODE               PIC  X(5).
  3385
  3386
  3387         16  FILLER                         PIC X(498).
  3388****************************************************************
  3389*             MORTGAGE COMPANY MASTER RECORD                   *
  3390****************************************************************
  3391
  3392     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3393         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3394         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3395             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3396             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3397             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3398             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3399             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3400
  3401         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3402         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3403         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3404         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3405         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3406
  3407         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3408             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3409         16  CF-MP-RECON-USE-IND            PIC X(1).
  3410             88  CF-MP-USE-RECON             VALUE 'Y'.
  3411         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3412             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3413         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3414             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3415             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3416         16  FILLER                         PIC X(1).
  3417         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3418             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3419         16  CF-MORTG-MIB-VERSION           PIC X.
  3420             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3421             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3422             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3423         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3424             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3425                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3426             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3427                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3428             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3429                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3430             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3431                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3432             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3433                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3434             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3435                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  61
* EL677.cbl
  3436         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3437         16  FILLER                         PIC X(7).
  3438         16  CF-MORTG-DESTINATION-SYMBOL.
  3439             20  CF-MORTG-MIB-COMM          PIC X(5).
  3440             20  CF-MORTG-MIB-TERM          PIC X(5).
  3441         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3442             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3443         16  FILLER                         PIC X(03).
  3444         16  CF-MP-CHECK-NO-CONTROL.
  3445             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3446                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3447                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3448                                                ' ' LOW-VALUES.
  3449                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3450                                               VALUE '3'.
  3451         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3452         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3453         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3454             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3455                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3456             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3457                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3458             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3459                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3460             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3461                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3462             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3463                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3464             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3465                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3466         16  CF-MORTG-BILLING-AREA.
  3467             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3468                                            PIC X.
  3469         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3470         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3471         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3472         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3473             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3474             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3475         16  FILLER                         PIC X.
  3476         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3477             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3478             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3479         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3480         16  FILLER                         PIC X(8).
  3481         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3482         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3483         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3484         16  CF-ACH-COMPANY-ID.
  3485             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3486                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3487                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3488                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3489             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3490         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3491             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3492         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3493             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  62
* EL677.cbl
  3494             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3495         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3496         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3497         16  FILLER                         PIC X(536).
  3498
  3499****************************************************************
  3500*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3501****************************************************************
  3502
  3503     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3504         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3505             20  CF-FEMALE-HEIGHT.
  3506                 24  CF-FEMALE-FT           PIC 99.
  3507                 24  CF-FEMALE-IN           PIC 99.
  3508             20  CF-FEMALE-MIN-WT           PIC 999.
  3509             20  CF-FEMALE-MAX-WT           PIC 999.
  3510         16  FILLER                         PIC X(428).
  3511
  3512     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3513         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3514             20  CF-MALE-HEIGHT.
  3515                 24  CF-MALE-FT             PIC 99.
  3516                 24  CF-MALE-IN             PIC 99.
  3517             20  CF-MALE-MIN-WT             PIC 999.
  3518             20  CF-MALE-MAX-WT             PIC 999.
  3519         16  FILLER                         PIC X(428).
  3520******************************************************************
  3521*             AUTOMATIC ACTIVITY RECORD                          *
  3522******************************************************************
  3523     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3524         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3525             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3526             20  CF-SYS-LETTER-ID           PIC X(04).
  3527             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3528             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3529             20  CF-SYS-RESET-SW            PIC X(01).
  3530             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3531             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3532
  3533         16  FILLER                         PIC X(50).
  3534
  3535         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3536             20  CF-USER-ACTIVE-SW          PIC X(01).
  3537             20  CF-USER-LETTER-ID          PIC X(04).
  3538             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3539             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3540             20  CF-USER-RESET-SW           PIC X(01).
  3541             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3542             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3543             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3544
  3545         16  FILLER                         PIC X(246).
  3546*                                    COPY ERCCHEK.
  3547******************************************************************
  3548*                                                                *
  3549*                                                                *
  3550*                            ERCCHEK                             *
  3551*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  63
* EL677.cbl
  3552*                            VMOD=2.008                          *
  3553*                                                                *
  3554*   FILE DESCRIPTION = CHECK RECORDS                             *
  3555*                                                                *
  3556*   FILE TYPE = VSAM,KSDS                                        *
  3557*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3558*                                                                *
  3559*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3560*       ALTERNATE INDEX = NONE                                   *
  3561*                                                                *
  3562*   LOG = YES                                                    *
  3563*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3564******************************************************************
  3565*                   C H A N G E   L O G
  3566*
  3567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3568*-----------------------------------------------------------------
  3569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3570* EFFECTIVE    NUMBER
  3571*-----------------------------------------------------------------
  3572* 021414    2003053000001  PEMA  changes for auto chk request
  3573******************************************************************
  3574 01  CHECK-RECORDS.
  3575     12  CH-RECORD-ID                      PIC XX.
  3576         88  VALID-CH-ID                      VALUE 'CH'.
  3577
  3578     12  CH-CONTROL-PRIMARY.
  3579         16  CH-COMPANY-CD                 PIC X.
  3580         16  CH-CARRIER                    PIC X.
  3581         16  CH-GROUPING                   PIC X(6).
  3582         16  CH-STATE                      PIC XX.
  3583         16  CH-ACCOUNT                    PIC X(10).
  3584         16  CH-CERT-EFF-DT                PIC XX.
  3585         16  CH-CERT-NO.
  3586             20  CH-CERT-PRIME             PIC X(10).
  3587             20  CH-CERT-SFX               PIC X.
  3588         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3589
  3590     12  CH-RECORDED-DT                    PIC XX.
  3591     12  CH-RECORDED-BY                    PIC X(4).
  3592     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3593
  3594     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3595     12  CH-CHECK-NO                       PIC X(7).
  3596     12  CH-REASON-FOR-CHECK               PIC X(25).
  3597     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3598     12  FILLER                            PIC X.
  3599
  3600     12  CH-PAYEE-INFO.
  3601         16  CH-PAYEE-NAME-1               PIC X(30).
  3602         16  CH-PAYEE-NAME-2               PIC X(30).
  3603         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3604         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3605         16  CH-PAYEE-CITY-ST.
  3606             20  CH-PAYEE-CITY             PIC X(28).
  3607             20  CH-PAYEE-STATE            PIC XX.
  3608         16  CH-PAYEE-ZIP-CODE.
  3609             20  CH-PAYEE-ZIP.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  64
* EL677.cbl
  3610                 24  CH-ZIP-PRI-1ST        PIC X.
  3611                     88  CH-CANADIAN-POST-CODE
  3612                                           VALUES 'A' THRU 'Z'.
  3613                 24  FILLER                PIC X(4).
  3614             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3615         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3616             20  CH-CAN-POSTAL-1           PIC XXX.
  3617             20  CH-CAN-POSTAL-2           PIC XXX.
  3618             20  FILLER                    PIC XXX.
  3619
  3620     12  CH-CHECK-STUB-TEXT.
  3621         16  CH-STUB-LINE-1                PIC X(30).
  3622         16  CH-TEXT-LINE-1                PIC X(50).
  3623         16  CH-TEXT-LINE-2                PIC X(50).
  3624         16  CH-TEXT-LINE-3                PIC X(40).
  3625     12  CH-RETURN-TO                      PIC X(30).
  3626
  3627     12  CH-COMPENSATION-CONTROL.
  3628         16  CH-COMP-CARRIER               PIC X.
  3629         16  CH-COMP-GROUPING              PIC X(6).
  3630         16  CH-COMP-FIN-RESP              PIC X(10).
  3631         16  CH-COMP-ACCOUNT               PIC X(10).
  3632
  3633     12  CH-CREDIT-SELECT-DT               PIC XX.
  3634     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3635     12  CH-PAYEE-CODE                     PIC X(6).
  3636
  3637     12  CH-VOID-DATA.
  3638         20  CH-VOID-DT                    PIC XX.
  3639         20  CH-VOID-BY                    PIC X(4).
  3640         20  CH-VOID-REASON                PIC X(25).
  3641
  3642     12  CH-APPROVAL-DATA.
  3643         20  CH-APPROVAL-DT                PIC XX.
  3644         20  CH-APPROVAL-STATUS            PIC X.
  3645             88  CH-IN-LIMBO                  VALUE ' '.
  3646             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3647             88  CH-APPROVED                  VALUE 'A'.
  3648             88  CH-DENIED                    VALUE 'D'.
  3649         20  CH-APPROVED-BY                PIC XXXX.
  3650     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3651             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3652     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3653
  3654     12  ch-released-dt                    pic xx.
  3655     12  ch-check-cashed-dt                pic xx.
  3656     12  FILLER                            PIC X.
  3657*    12  CH-CHECK-REFERENCE                PIC X(12).
  3658     12  CH-CHECK-ORIGIN-SW                PIC X.
  3659             88  CH-REFUND-CHECK              VALUE 'R'.
  3660             88  CH-MAINT-CHECK               VALUE 'M'.
  3661
  3662     12  CH-CANC-DT                        PIC XX.
  3663     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3664     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3665
  3666     12  CH-INSURED-NAME                   PIC X(28).
  3667
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  65
* EL677.cbl
  3668     12  ch-released-by                    pic x(4).
  3669     12  ch-csr                            pic x(4).
  3670     12  ch-deduct-commission              pic x.
  3671         88  ch-deduct-comm                  value 'Y'.
  3672         88  ch-do-not-deduct-comm           value 'N'.
  3673
  3674     12  FILLER                            PIC X(11).
  3675*    12  CH-LETTER-TABLE.
  3676*        16  CH-LETTERS OCCURS 3 TIMES
  3677*                       INDEXED BY CH-LT-NDX
  3678*                                          PIC X(04).
  3679
  3680     12  FILLER                            PIC X(07).
  3681
  3682*                                    COPY ERCACCT.
  3683******************************************************************
  3684*                                                                *
  3685*                                                                *
  3686*                            ERCACCT                             *
  3687*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3688*                            VMOD=2.031                          *
  3689*                                                                *
  3690*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3691*                                                                *
  3692*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3693*   VSAM ACCOUNT MASTER FILES.                                   *
  3694*                                                                *
  3695*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3696*                                                                *
  3697*   FILE TYPE = VSAM,KSDS                                        *
  3698*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3699*                                                                *
  3700*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3701*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3702*                                                                *
  3703*   LOG = NO                                                     *
  3704*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3705*                                                                *
  3706*                                                                *
  3707******************************************************************
  3708*                   C H A N G E   L O G
  3709*
  3710* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3711*-----------------------------------------------------------------
  3712*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3713* EFFECTIVE    NUMBER
  3714*-----------------------------------------------------------------
  3715* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3716* 092705    2005050300006  PEMA  ADD SPP LEASES
  3717* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3718* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3719* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3720* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3721* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3722* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  3723******************************************************************
  3724
  3725 01  ACCOUNT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  66
* EL677.cbl
  3726     12  AM-RECORD-ID                      PIC XX.
  3727         88  VALID-AM-ID                      VALUE 'AM'.
  3728
  3729     12  AM-CONTROL-PRIMARY.
  3730         16  AM-COMPANY-CD                 PIC X.
  3731         16  AM-MSTR-CNTRL.
  3732             20  AM-CONTROL-A.
  3733                 24  AM-CARRIER            PIC X.
  3734                 24  AM-GROUPING.
  3735                     28 AM-GROUPING-PREFIX PIC XXX.
  3736                     28 AM-GROUPING-PRIME  PIC XXX.
  3737                 24  AM-STATE              PIC XX.
  3738                 24  AM-ACCOUNT.
  3739                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3740                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3741             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3742                                           PIC X(19).
  3743             20  AM-CNTRL-B.
  3744                 24  AM-EXPIRATION-DT      PIC XX.
  3745                 24  FILLER                PIC X(4).
  3746             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3747                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3748
  3749     12  AM-CONTROL-BY-VAR-GRP.
  3750         16  AM-COMPANY-CD-A1              PIC X.
  3751         16  AM-VG-CARRIER                 PIC X.
  3752         16  AM-VG-GROUPING                PIC X(6).
  3753         16  AM-VG-STATE                   PIC XX.
  3754         16  AM-VG-ACCOUNT                 PIC X(10).
  3755         16  AM-VG-DATE.
  3756             20  AM-VG-EXPIRATION-DT       PIC XX.
  3757             20  FILLER                    PIC X(4).
  3758         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3759                                           PIC 9(11)      COMP-3.
  3760     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3761         16  FILLER                        PIC X(10).
  3762         16  AM-VG-KEY3.
  3763             20  AM-VG3-ACCOUNT            PIC X(10).
  3764             20  AM-VG3-EXP-DT             PIC XX.
  3765         16  FILLER                        PIC X(4).
  3766     12  AM-MAINT-INFORMATION.
  3767         16  AM-LAST-MAINT-DT              PIC XX.
  3768         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3769         16  AM-LAST-MAINT-USER            PIC X(4).
  3770         16  FILLER                        PIC XX.
  3771
  3772     12  AM-EFFECTIVE-DT                   PIC XX.
  3773     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3774
  3775     12  AM-PREV-DATES  COMP-3.
  3776         16  AM-PREV-EXP-DT                PIC 9(11).
  3777         16  AM-PREV-EFF-DT                PIC 9(11).
  3778
  3779     12  AM-REPORT-CODE-1                  PIC X(10).
  3780     12  AM-REPORT-CODE-2                  PIC X(10).
  3781
  3782     12  AM-CITY-CODE                      PIC X(4).
  3783     12  AM-COUNTY-PARISH                  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  67
* EL677.cbl
  3784
  3785     12  AM-NAME                           PIC X(30).
  3786     12  AM-PERSON                         PIC X(30).
  3787     12  AM-ADDRS                          PIC X(30).
  3788     12  AM-CITY.
  3789         16  AM-ADDR-CITY                  PIC X(28).
  3790         16  AM-ADDR-STATE                 PIC XX.
  3791     12  AM-ZIP.
  3792         16  AM-ZIP-PRIME.
  3793             20  AM-ZIP-PRI-1ST            PIC X.
  3794                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3795             20  FILLER                    PIC X(4).
  3796         16  AM-ZIP-PLUS4                  PIC X(4).
  3797     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3798         16  AM-CAN-POSTAL-1               PIC XXX.
  3799         16  AM-CAN-POSTAL-2               PIC XXX.
  3800         16  FILLER                        PIC XXX.
  3801     12  AM-TEL-NO.
  3802         16  AM-AREA-CODE                  PIC 999.
  3803         16  AM-TEL-PRE                    PIC 999.
  3804         16  AM-TEL-NBR                    PIC 9(4).
  3805     12  AM-TEL-LOC                        PIC X.
  3806         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3807         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3808
  3809     12  AM-COMM-STRUCTURE.
  3810         16  AM-DEFN-1.
  3811             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3812                 24  AM-AGT.
  3813                     28  AM-AGT-PREFIX     PIC X(4).
  3814                     28  AM-AGT-PRIME      PIC X(6).
  3815                 24  AM-COM-TYP            PIC X.
  3816                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3817                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3818                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3819                 24  AM-RECALC-LV-INDIC    PIC X.
  3820                 24  AM-RETRO-LV-INDIC     PIC X.
  3821                 24  AM-GL-CODES           PIC X.
  3822                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3823                 24  FILLER                PIC X(01).
  3824         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3825             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3826                 24  FILLER                PIC X(11).
  3827                 24  AM-L-COMA             PIC XXX.
  3828                 24  AM-J-COMA             PIC XXX.
  3829                 24  AM-A-COMA             PIC XXX.
  3830                 24  FILLER                PIC X(6).
  3831
  3832     12  AM-COMM-CHANGE-STATUS             PIC X.
  3833         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3834
  3835     12  AM-CSR-CODE                       PIC X(4).
  3836
  3837     12  AM-BILLING-STATUS                 PIC X.
  3838         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3839         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3840     12  AM-AUTO-REFUND-SW                 PIC X.
  3841         88  AUTO-REFUNDS-USED                VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  68
* EL677.cbl
  3842         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3843     12  AM-GPCD                           PIC 99.
  3844     12  AM-IG                             PIC X.
  3845         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3846         88  AM-HAS-GROUP                     VALUE '2'.
  3847     12  AM-STATUS                         PIC X.
  3848         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3849         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3850         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3851         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3852         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3853         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3854         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3855         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3856         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3857         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3858     12  AM-REMIT-TO                       PIC 99.
  3859     12  AM-ID-NO                          PIC X(11).
  3860
  3861     12  AM-CAL-TABLE                      PIC XX.
  3862     12  AM-LF-DEVIATION                   PIC XXX.
  3863     12  AM-AH-DEVIATION                   PIC XXX.
  3864     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3865     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3866     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3867     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3868     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3869     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3870
  3871     12  AM-USER-FIELDS.
  3872         16  AM-FLD-1                      PIC XX.
  3873         16  AM-FLD-2                      PIC XX.
  3874         16  AM-FLD-3                      PIC XX.
  3875         16  AM-FLD-4                      PIC XX.
  3876         16  AM-FLD-5                      PIC XX.
  3877
  3878     12  AM-1ST-PROD-DATE.
  3879         16  AM-1ST-PROD-YR                PIC XX.
  3880         16  AM-1ST-PROD-MO                PIC XX.
  3881         16  AM-1ST-PROD-DA                PIC XX.
  3882     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3883     12  AM-CERTS-PURGED-DATE.
  3884         16  AM-PUR-YR                     PIC XX.
  3885         16  AM-PUR-MO                     PIC XX.
  3886         16  AM-PUR-DA                     PIC XX.
  3887     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3888     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3889     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3890     12  AM-INACTIVE-DATE.
  3891         16  AM-INA-MO                     PIC 99.
  3892         16  AM-INA-DA                     PIC 99.
  3893         16  AM-INA-YR                     PIC 99.
  3894     12  AM-AR-HI-CERT-DATE                PIC XX.
  3895
  3896     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3897     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3898
  3899     12  AM-OB-PAYMENT-MODE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  69
* EL677.cbl
  3900         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3901         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3902         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3903         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3904
  3905     12  AM-AH-ONLY-INDICATOR              PIC X.
  3906         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3907         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3908
  3909     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3910
  3911     12  AM-OVER-SHORT.
  3912         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3913         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3914
  3915     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3916     12  AM-DCC-CLP-STATE                  PIC XX.
  3917
  3918     12  AM-RECALC-COMM                    PIC X.
  3919     12  AM-RECALC-REIN                    PIC X.
  3920
  3921     12  AM-REI-TABLE                      PIC XXX.
  3922     12  AM-REI-ET-LF                      PIC X.
  3923     12  AM-REI-ET-AH                      PIC X.
  3924     12  AM-REI-PE-LF                      PIC X.
  3925     12  AM-REI-PE-AH                      PIC X.
  3926     12  AM-REI-PRT-ST                     PIC X.
  3927     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3928     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3929     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3930     12  AM-REI-GROUP-A                    PIC X(6).
  3931     12  AM-REI-MORT                       PIC X(4).
  3932     12  AM-REI-PRT-OW                     PIC X.
  3933     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3934     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3935     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3936     12  AM-REI-GROUP-B                    PIC X(6).
  3937
  3938     12  AM-TRUST-TYPE                     PIC X(2).
  3939
  3940     12  AM-EMPLOYER-STMT-USED             PIC X.
  3941     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3942
  3943     12  AM-STD-AH-TYPE                    PIC XX.
  3944     12  AM-EARN-METHODS.
  3945         16  AM-EARN-METHOD-R              PIC X.
  3946             88 AM-REF-RL-R78                 VALUE 'R'.
  3947             88 AM-REF-RL-PR                  VALUE 'P'.
  3948             88 AM-REF-RL-MEAN                VALUE 'M'.
  3949             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3950         16  AM-EARN-METHOD-L              PIC X.
  3951             88 AM-REF-LL-R78                 VALUE 'R'.
  3952             88 AM-REF-LL-PR                  VALUE 'P'.
  3953             88 AM-REF-LL-MEAN                VALUE 'M'.
  3954             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3955         16  AM-EARN-METHOD-A              PIC X.
  3956             88 AM-REF-AH-R78                 VALUE 'R'.
  3957             88 AM-REF-AH-PR                  VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  70
* EL677.cbl
  3958             88 AM-REF-AH-MEAN                VALUE 'M'.
  3959             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3960             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3961             88 AM-REF-AH-NET                 VALUE 'N'.
  3962
  3963     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3964     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3965     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3966
  3967     12  AM-RET-Y-N                        PIC X.
  3968     12  AM-RET-P-E                        PIC X.
  3969     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3970     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3971     12  AM-RET-GRP                        PIC X(6).
  3972     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3973         16  AM-POOL-PRIME                 PIC XXX.
  3974         16  AM-POOL-SUB                   PIC XXX.
  3975     12  AM-RETRO-EARNINGS.
  3976         16  AM-RET-EARN-R                 PIC X.
  3977         16  AM-RET-EARN-L                 PIC X.
  3978         16  AM-RET-EARN-A                 PIC X.
  3979     12  AM-RET-ST-TAX-USE                 PIC X.
  3980         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3981         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3982     12  AM-RETRO-BEG-EARNINGS.
  3983         16  AM-RET-BEG-EARN-R             PIC X.
  3984         16  AM-RET-BEG-EARN-L             PIC X.
  3985         16  AM-RET-BEG-EARN-A             PIC X.
  3986     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3987     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3988
  3989     12  AM-USER-SELECT-OPTIONS.
  3990         16  AM-USER-SELECT-1              PIC X(10).
  3991         16  AM-USER-SELECT-2              PIC X(10).
  3992         16  AM-USER-SELECT-3              PIC X(10).
  3993         16  AM-USER-SELECT-4              PIC X(10).
  3994         16  AM-USER-SELECT-5              PIC X(10).
  3995
  3996     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3997
  3998     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3999
  4000     12  AM-RPT045A-SWITCH                 PIC X.
  4001         88  RPT045A-OFF                   VALUE 'N'.
  4002
  4003     12  AM-INSURANCE-LIMITS.
  4004         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4005         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4006
  4007     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4008         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4009
  4010     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4011         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4012         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4013
  4014     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4015
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  71
* EL677.cbl
  4016     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4017     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4018     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4019     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4020     12  AM-DCC-UEF-STATE                  PIC XX.
  4021     12  FILLER                            PIC XXX.
  4022     12  AM-REPORT-CODE-3                  PIC X(10).
  4023*    12  FILLER                            PIC X(22).
  4024
  4025     12  AM-RESERVE-DATE.
  4026         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4027         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4028         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4029
  4030     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4031     12  AM-NOTIFICATION-TYPES.
  4032         16  AM-NOTIF-OF-LETTERS           PIC X.
  4033         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4034         16  AM-NOTIF-OF-REPORTS           PIC X.
  4035         16  AM-NOTIF-OF-STATUS            PIC X.
  4036
  4037     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4038         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4039         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4040         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4041         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4042
  4043     12  AM-BENEFIT-CONTROLS.
  4044         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4045             20  AM-BENEFIT-CODE           PIC XX.
  4046             20  AM-BENEFIT-TYPE           PIC X.
  4047             20  AM-BENEFIT-REVISION       PIC XXX.
  4048             20  AM-BENEFIT-REM-TERM       PIC X.
  4049             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4050             20  FILLER                    PIC XX.
  4051         16  FILLER                        PIC X(80).
  4052
  4053     12  AM-TRANSFER-DATA.
  4054         16  AM-TRANSFERRED-FROM.
  4055             20  AM-TRNFROM-CARRIER        PIC X.
  4056             20  AM-TRNFROM-GROUPING.
  4057                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4058                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4059             20  AM-TRNFROM-STATE          PIC XX.
  4060             20  AM-TRNFROM-ACCOUNT.
  4061                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4062                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4063             20  AM-TRNFROM-DTE            PIC XX.
  4064         16  AM-TRANSFERRED-TO.
  4065             20  AM-TRNTO-CARRIER          PIC X.
  4066             20  AM-TRNTO-GROUPING.
  4067                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4068                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4069             20  AM-TRNTO-STATE            PIC XX.
  4070             20  AM-TRNTO-ACCOUNT.
  4071                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4072                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4073             20  AM-TRNTO-DTE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  72
* EL677.cbl
  4074         16  FILLER                        PIC X(10).
  4075
  4076     12  AM-SAVED-REMIT-TO                 PIC 99.
  4077
  4078     12  AM-COMM-STRUCTURE-SAVED.
  4079         16  AM-DEFN-1-SAVED.
  4080             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4081                 24  AM-AGT-SV             PIC X(10).
  4082                 24  AM-COM-TYP-SV         PIC X.
  4083                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4084                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4085                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4086                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4087                 24  FILLER                PIC X.
  4088                 24  AM-GL-CODES-SV        PIC X.
  4089                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4090                 24  FILLER                PIC X.
  4091         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4092             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4093                 24  FILLER                PIC X(11).
  4094                 24  AM-L-COMA-SV          PIC XXX.
  4095                 24  AM-J-COMA-SV          PIC XXX.
  4096                 24  AM-A-COMA-SV          PIC XXX.
  4097                 24  FILLER                PIC X(6).
  4098
  4099     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4100         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4101            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4102            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4103            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4104
  4105     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4106     12  FILLER                            PIC X(120).
  4107
  4108     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4109         16  AM-CONTROL-NAME               PIC X(30).
  4110         16  AM-EXECUTIVE-ONE.
  4111             20  AM-EXEC1-NAME             PIC X(15).
  4112             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4113                                                          COMP-3.
  4114             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4115                                                          COMP-3.
  4116         16  AM-EXECUTIVE-TWO.
  4117             20  AM-EXEC2-NAME             PIC X(15).
  4118             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4119                                                          COMP-3.
  4120             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4121                                                          COMP-3.
  4122
  4123     12  AM-RETRO-ADDITIONAL-DATA.
  4124         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4125         16  AM-RETRO-PREM-P-E             PIC X.
  4126         16  AM-RETRO-CLMS-P-I             PIC X.
  4127         16  AM-RETRO-RET-BRACKET-LF.
  4128             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4129                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4130                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4131             20  AM-RETRO-RET-BASIS-LF     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  73
* EL677.cbl
  4132                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4133                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4134             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4135                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4136                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4137         16  AM-RETRO-RET-BRACKET-AH.
  4138             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4139                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4140                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4141                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4142             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4143                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4144                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4145             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4146                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4147                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4148
  4149     12  AM-COMMENTS.
  4150         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4151
  4152     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4153         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4154         16  AM-FLI-BILLING-CODE           PIC X.
  4155         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4156         16  AM-FLI-UNITED-IDENT           PIC X.
  4157         16  AM-FLI-INTEREST-LOST-DATA.
  4158             20  AM-FLI-BANK-NO            PIC X(5).
  4159             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4160             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4161             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4162         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4163             20  AM-FLI-AGT                PIC X(9).
  4164             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4165             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4166         16  FILLER                        PIC X(102).
  4167
  4168     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4169         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4170             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4171             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4172             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4173             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4174             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4175         16  FILLER                          PIC X(10).
  4176******************************************************************
  4177*                                    COPY ERCCOMP.
  4178******************************************************************
  4179*                                                                *
  4180*                                                                *
  4181*                            ERCCOMP                             *
  4182*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4183*                            VMOD=2.019                          *
  4184*                                                                *
  4185*   ONLINE CREDIT SYSTEM                                         *
  4186*                                                                *
  4187*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4188*                                                                *
  4189*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  74
* EL677.cbl
  4190*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4191*                                                                *
  4192*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4193*       ALTERNATE PATH = NONE                                    *
  4194*                                                                *
  4195*   LOG = NO                                                     *
  4196*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4197*                                                                *
  4198******************************************************************
  4199*                   C H A N G E   L O G
  4200*
  4201* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4202*-----------------------------------------------------------------
  4203*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4204* EFFECTIVE    NUMBER
  4205*-----------------------------------------------------------------
  4206* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4207* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4208* 092205    2005050300006  PEMA  ADD LEASE FEE
  4209* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4210* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4211* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4212* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4213* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4214* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4215******************************************************************
  4216
  4217 01  COMPENSATION-MASTER.
  4218     12  CO-RECORD-ID                          PIC XX.
  4219         88  VALID-CO-ID                          VALUE 'CO'.
  4220
  4221     12  CO-CONTROL-PRIMARY.
  4222         16  CO-COMPANY-CD                     PIC X.
  4223         16  CO-CONTROL.
  4224             20  CO-CTL-1.
  4225                 24  CO-CARR-GROUP.
  4226                     28  CO-CARRIER            PIC X.
  4227                     28  CO-GROUPING.
  4228                         32  CO-GROUP-PREFIX   PIC XXX.
  4229                         32  CO-GROUP-PRIME    PIC XXX.
  4230                 24  CO-RESP-NO.
  4231                     28  CO-RESP-PREFIX        PIC X(4).
  4232                     28  CO-RESP-PRIME         PIC X(6).
  4233             20  CO-CTL-2.
  4234                 24  CO-ACCOUNT.
  4235                     28  CO-ACCT-PREFIX        PIC X(4).
  4236                     28  CO-ACCT-PRIME         PIC X(6).
  4237         16  CO-TYPE                           PIC X.
  4238             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4239             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4240             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4241
  4242     12  CO-MAINT-INFORMATION.
  4243         16  CO-LAST-MAINT-DT                  PIC XX.
  4244         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4245         16  CO-LAST-MAINT-USER                PIC X(4).
  4246     12  FILLER                                PIC XX.
  4247     12  CO-STMT-TYPE                          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  75
* EL677.cbl
  4248     12  CO-COMP-TYPE                          PIC X.
  4249         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4250     12  CO-STMT-OWNER                         PIC X(4).
  4251     12  CO-BALANCE-CONTROL                    PIC X.
  4252         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4253         88  CO-NO-BALANCE                        VALUE 'N'.
  4254
  4255     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4256         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4257         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4258         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4259
  4260     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4261         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4262         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4263
  4264     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4265     12  CO-GA-DIRECT-DEP                      PIC X.
  4266     12  CO-FUTURE-SPACE                       PIC X.
  4267         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4268
  4269     12  CO-ACCT-NAME                          PIC X(30).
  4270     12  CO-MAIL-NAME                          PIC X(30).
  4271     12  CO-ADDR-1                             PIC X(30).
  4272     12  CO-ADDR-2                             PIC X(30).
  4273     12  CO-ADDR-3.
  4274         16  CO-ADDR-CITY                      PIC X(27).
  4275         16  CO-ADDR-STATE                     PIC XX.
  4276     12  CO-CSO-1099                           PIC X.
  4277     12  CO-ZIP.
  4278         16  CO-ZIP-PRIME.
  4279             20  CO-ZIP-PRI-1ST                PIC X.
  4280                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4281             20  FILLER                        PIC X(4).
  4282         16  CO-ZIP-PLUS4                      PIC X(4).
  4283     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4284         16  CO-CAN-POSTAL-1                   PIC XXX.
  4285         16  CO-CAN-POSTAL-2                   PIC XXX.
  4286         16  FILLER                            PIC XXX.
  4287     12  CO-SOC-SEC                            PIC X(13).
  4288     12  CO-TELEPHONE.
  4289         16  CO-AREA-CODE                      PIC XXX.
  4290         16  CO-PREFIX                         PIC XXX.
  4291         16  CO-PHONE                          PIC X(4).
  4292
  4293     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4294
  4295     12  CO-AR-BAL-LEVEL                       PIC X.
  4296         88  CO-AR-REF-LVL                        VALUE '1'.
  4297         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4298         88  CO-AR-BILL-LVL                       VALUE '2'.
  4299         88  CO-AR-AGT-LVL                        VALUE '3'.
  4300         88  CO-AR-FR-LVL                         VALUE '4'.
  4301
  4302     12  CO-AR-NORMAL-PRINT                    PIC X.
  4303         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4304         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4305
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  76
* EL677.cbl
  4306     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4307
  4308     12  CO-AR-REPORTING                       PIC X.
  4309         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4310         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4311
  4312     12  CO-AR-PULL-CHECK                      PIC X.
  4313         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4314         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4315
  4316     12  CO-AR-BALANCE-PRINT                   PIC X.
  4317         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4318
  4319     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4320         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4321         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4322         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4323
  4324     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4325
  4326     12  CO-USER-CODE                          PIC X.
  4327     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4328
  4329******************************************************************
  4330*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4331*    THE LAST MONTH END RUN.
  4332******************************************************************
  4333
  4334     12  CO-LAST-ACTIVITY-DATE.
  4335         16  CO-ACT-YEAR                       PIC 99.
  4336         16  CO-ACT-MONTH                      PIC 99.
  4337         16  CO-ACT-DAY                        PIC 99.
  4338
  4339     12  CO-LAST-STMT-DT.
  4340         16  CO-LAST-STMT-YEAR                 PIC 99.
  4341         16  CO-LAST-STMT-MONTH                PIC 99.
  4342         16  CO-LAST-STMT-DAY                  PIC 99.
  4343
  4344     12  CO-MO-END-TOTALS.
  4345         16  CO-MONTHLY-TOTALS.
  4346             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4347             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4348             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4349             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4350             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4351
  4352         16  CO-AGING-TOTALS.
  4353             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4354             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4355             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4356             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4357
  4358         16  CO-YTD-TOTALS.
  4359             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4360             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4361
  4362         16  CO-OVER-UNDER-TOTALS.
  4363             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  77
* EL677.cbl
  4364             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4365
  4366     12  CO-MISCELLANEOUS-TOTALS.
  4367         16  CO-FICA-TOTALS.
  4368             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4369             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4370
  4371         16  CO-CLAIM-TOTALS.
  4372             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4373             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4374
  4375******************************************************************
  4376*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4377*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4378******************************************************************
  4379
  4380     12  CO-CURRENT-TOTALS.
  4381         16  CO-CURRENT-LAST-STMT-DT.
  4382             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4383             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4384             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4385
  4386         16  CO-CURRENT-MONTHLY-TOTALS.
  4387             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4388             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4389             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4390             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4391             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4392
  4393         16  CO-CURRENT-AGING-TOTALS.
  4394             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4395             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4396             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4397             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4398
  4399         16  CO-CURRENT-YTD-TOTALS.
  4400             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4401             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4402
  4403     12  CO-PAID-COMM-TOTALS.
  4404         16  CO-YTD-PAID-COMMS.
  4405             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4406             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4407
  4408     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4409         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4410         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4411
  4412     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4413         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4414         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4415         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4416         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4417         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4418         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4419         88  CO-FINAL-LETTER                  VALUE 'F'.
  4420         88  CO-RECONCILING                   VALUE 'R'.
  4421         88  CO-PHONE-CALL                    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  78
* EL677.cbl
  4422         88  CO-LEGAL                         VALUE 'L'.
  4423         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4424         88  CO-WRITE-OFF                     VALUE 'W'.
  4425         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4426
  4427     12  CO-CSR-CODE                       PIC X(4).
  4428
  4429     12  CO-GA-STATUS-INFO.
  4430         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4431         16  CO-GA-TERMINATION-DT          PIC XX.
  4432         16  CO-GA-STATUS-CODE             PIC X.
  4433             88  CO-GA-ACTIVE                 VALUE 'A'.
  4434             88  CO-GA-INACTIVE               VALUE 'I'.
  4435             88  CO-GA-PENDING                VALUE 'P'.
  4436         16  CO-GA-COMMENTS.
  4437             20  CO-GA-COMMENT-1           PIC X(40).
  4438             20  CO-GA-COMMENT-2           PIC X(40).
  4439             20  CO-GA-COMMENT-3           PIC X(40).
  4440             20  CO-GA-COMMENT-4           PIC X(40).
  4441
  4442     12  CO-RPTCD2                         PIC X(10).
  4443     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4444         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4445         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4446
  4447     12  CO-TYPE-AGENT                     PIC X(01).
  4448         88  CO-CORPORATION                   VALUE 'C'.
  4449         88  CO-PARTNERSHIP                   VALUE 'P'.
  4450         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4451         88  CO-TRUST                         VALUE 'T'.
  4452         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4453
  4454     12  CO-FAXNO.
  4455         16  CO-FAX-AREA-CODE                  PIC XXX.
  4456         16  CO-FAX-PREFIX                     PIC XXX.
  4457         16  CO-FAX-PHONE                      PIC X(4).
  4458
  4459     12  CO-BANK-INFORMATION.
  4460         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4461         16  CO-BANK-TRANSIT-NON REDEFINES
  4462             CO-BANK-TRANSIT-NO                PIC 9(8).
  4463
  4464         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4465     12  CO-MISC-DEDUCT-INFO REDEFINES
  4466                  CO-BANK-INFORMATION.
  4467         16  CO-MD-GL-ACCT                     PIC X(10).
  4468         16  CO-MD-DIV                         PIC XX.
  4469         16  CO-MD-CENTER                      PIC X(4).
  4470         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4471         16  CO-CREATE-AP-CHECK                PIC X.
  4472         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4473         16  FILLER                            PIC XXX.
  4474     12  CO-ACH-STATUS                         PIC X.
  4475         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4476         88  CO-ACH-PENDING                        VALUE 'P'.
  4477
  4478     12  CO-BILL-SW                            PIC X.
  4479     12  CO-CONTROL-NAME                       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  79
* EL677.cbl
  4480     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4481     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4482     12  CO-CLP-STATE                          PIC XX.
  4483     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4484     12  CO-SPP-REFUND-EDIT                    PIC X.
  4485
  4486******************************************************************
  4487*                                    COPY ELCCERT.
  4488******************************************************************
  4489*                                                                *
  4490*                            ELCCERT.                            *
  4491*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4492*                            VMOD=2.013                          *
  4493*                                                                *
  4494*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4495*                                                                *
  4496*   FILE TYPE = VSAM,KSDS                                        *
  4497*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4498*                                                                *
  4499*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4500*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4501*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4502*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4503*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4504*                                                                *
  4505*   LOG = YES                                                    *
  4506*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4507******************************************************************
  4508*                   C H A N G E   L O G
  4509*
  4510* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4511*-----------------------------------------------------------------
  4512*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4513* EFFECTIVE    NUMBER
  4514*-----------------------------------------------------------------
  4515* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4516* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4517* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4518* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4519* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4520* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4521* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4522* 032612  CR2011110200001  PEMA  AHL CHANGES
  4523* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4524* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4525******************************************************************
  4526
  4527 01  CERTIFICATE-MASTER.
  4528     12  CM-RECORD-ID                      PIC XX.
  4529         88  VALID-CM-ID                      VALUE 'CM'.
  4530
  4531     12  CM-CONTROL-PRIMARY.
  4532         16  CM-COMPANY-CD                 PIC X.
  4533         16  CM-CARRIER                    PIC X.
  4534         16  CM-GROUPING.
  4535             20  CM-GROUPING-PREFIX        PIC X(3).
  4536             20  CM-GROUPING-PRIME         PIC X(3).
  4537         16  CM-STATE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  80
* EL677.cbl
  4538         16  CM-ACCOUNT.
  4539             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4540             20  CM-ACCOUNT-PRIME          PIC X(6).
  4541         16  CM-CERT-EFF-DT                PIC XX.
  4542         16  CM-CERT-NO.
  4543             20  CM-CERT-PRIME             PIC X(10).
  4544             20  CM-CERT-SFX               PIC X.
  4545
  4546     12  CM-CONTROL-BY-NAME.
  4547         16  CM-COMPANY-CD-A1              PIC X.
  4548         16  CM-INSURED-LAST-NAME          PIC X(15).
  4549         16  CM-INSURED-INITIALS.
  4550             20  CM-INSURED-INITIAL1       PIC X.
  4551             20  CM-INSURED-INITIAL2       PIC X.
  4552
  4553     12  CM-CONTROL-BY-SSN.
  4554         16  CM-COMPANY-CD-A2              PIC X.
  4555         16  CM-SOC-SEC-NO.
  4556             20  CM-SSN-STATE              PIC XX.
  4557             20  CM-SSN-ACCOUNT            PIC X(6).
  4558             20  CM-SSN-LN3.
  4559                 25  CM-INSURED-INITIALS-A2.
  4560                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4561                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4562                 25 CM-PART-LAST-NAME-A2         PIC X.
  4563
  4564     12  CM-CONTROL-BY-CERT-NO.
  4565         16  CM-COMPANY-CD-A4              PIC X.
  4566         16  CM-CERT-NO-A4                 PIC X(11).
  4567
  4568     12  CM-CONTROL-BY-MEMB.
  4569         16  CM-COMPANY-CD-A5              PIC X.
  4570         16  CM-MEMBER-NO.
  4571             20  CM-MEMB-STATE             PIC XX.
  4572             20  CM-MEMB-ACCOUNT           PIC X(6).
  4573             20  CM-MEMB-LN4.
  4574                 25  CM-INSURED-INITIALS-A5.
  4575                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4576                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4577                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4578
  4579     12  CM-INSURED-PROFILE-DATA.
  4580         16  CM-INSURED-FIRST-NAME.
  4581             20  CM-INSURED-1ST-INIT       PIC X.
  4582             20  FILLER                    PIC X(9).
  4583         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4584         16  CM-INSURED-SEX                PIC X.
  4585             88  CM-SEX-MALE                  VALUE 'M'.
  4586             88  CM-SEX-FEMAL                 VALUE 'F'.
  4587         16  CM-INSURED-JOINT-AGE          PIC 99.
  4588         16  CM-JOINT-INSURED-NAME.
  4589             20  CM-JT-LAST-NAME           PIC X(15).
  4590             20  CM-JT-FIRST-NAME.
  4591                 24  CM-JT-1ST-INIT        PIC X.
  4592                 24  FILLER                PIC X(9).
  4593             20  CM-JT-INITIAL             PIC X.
  4594
  4595     12  CM-LIFE-DATA.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  81
* EL677.cbl
  4596         16  CM-LF-BENEFIT-CD              PIC XX.
  4597         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4598         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4599         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4600         16  CM-LF-DEV-CODE                PIC XXX.
  4601         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4602         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4603         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4604         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4605         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4606         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4607         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4608         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4609         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4610         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4611         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4612         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4613         16  cm-temp-epiq                  pic xx.
  4614             88  EPIQ-CLASS                  value 'EQ'.
  4615*        16  FILLER                        PIC XX.
  4616
  4617     12  CM-AH-DATA.
  4618         16  CM-AH-BENEFIT-CD              PIC XX.
  4619         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4620         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4621         16  CM-AH-DEV-CODE                PIC XXX.
  4622         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4623         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4624         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4625         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4626         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4627         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4628         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4629         16  CM-AH-PAID-THRU-DT            PIC XX.
  4630             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4631         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4632         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4633         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4634         16  FILLER                        PIC X.
  4635
  4636     12  CM-LOAN-INFORMATION.
  4637         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4638         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4639                                           PIC S9(5)V99  COMP-3.
  4640         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4641         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4642         16  CM-PAY-FREQUENCY              PIC S99.
  4643         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4644         16  CM-RATE-CLASS                 PIC XX.
  4645         16  CM-BENEFICIARY                PIC X(25).
  4646         16  CM-POLICY-FORM-NO             PIC X(12).
  4647         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4648         16  CM-LAST-ADD-ON-DT             PIC XX.
  4649         16  CM-DEDUCTIBLE-AMOUNTS.
  4650             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4651             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4652         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4653             20  CM-RESIDENT-STATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  82
* EL677.cbl
  4654             20  CM-RATE-CODE              PIC X(4).
  4655             20  FILLER                    PIC XX.
  4656         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4657             20  CM-LOAN-OFFICER           PIC X(5).
  4658             20  FILLER                    PIC XXX.
  4659         16  CM-CSR-CODE                   PIC XXX.
  4660         16  CM-UNDERWRITING-CODE          PIC X.
  4661             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4662         16  CM-POST-CARD-IND              PIC X.
  4663         16  CM-NH-INTERFACE-SW            PIC X.
  4664         16  CM-PREMIUM-TYPE               PIC X.
  4665             88  CM-SING-PRM                  VALUE '1'.
  4666             88  CM-O-B-COVERAGE              VALUE '2'.
  4667             88  CM-OPEN-END                  VALUE '3'.
  4668         16  CM-IND-GRP-TYPE               PIC X.
  4669             88  CM-INDIVIDUAL                VALUE 'I'.
  4670             88  CM-GROUP                     VALUE 'G'.
  4671         16  CM-SKIP-CODE                  PIC X.
  4672             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4673             88  SKIP-JULY                    VALUE '1'.
  4674             88  SKIP-AUGUST                  VALUE '2'.
  4675             88  SKIP-SEPTEMBER               VALUE '3'.
  4676             88  SKIP-JULY-AUG                VALUE '4'.
  4677             88  SKIP-AUG-SEPT                VALUE '5'.
  4678             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4679             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4680             88  SKIP-JUNE                    VALUE '8'.
  4681             88  SKIP-JUNE-JULY               VALUE '9'.
  4682             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4683             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4684         16  CM-PAYMENT-MODE               PIC X.
  4685             88  PAY-MONTHLY                  VALUE SPACE.
  4686             88  PAY-WEEKLY                   VALUE '1'.
  4687             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4688             88  PAY-BI-WEEKLY                VALUE '3'.
  4689             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4690         16  CM-LOAN-NUMBER                PIC X(8).
  4691         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4692         16  CM-OLD-LOF                    PIC XXX.
  4693*        16  CM-LOAN-OFFICER               PIC XXX.
  4694         16  CM-REIN-TABLE                 PIC XXX.
  4695         16  CM-SPECIAL-REIN-CODE          PIC X.
  4696         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4697         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4698         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4699
  4700     12  CM-STATUS-DATA.
  4701         16  CM-ENTRY-STATUS               PIC X.
  4702         16  CM-ENTRY-DT                   PIC XX.
  4703
  4704         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4705         16  CM-LF-CANCEL-DT               PIC XX.
  4706         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4707
  4708         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4709         16  CM-LF-DEATH-DT                PIC XX.
  4710         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4711
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  83
* EL677.cbl
  4712         16  CM-LF-CURRENT-STATUS          PIC X.
  4713             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4714                                                'M' '4' '5' '9'.
  4715             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4716             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4717             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4718             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4719             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4720             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4721             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4722             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4723             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4724             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4725             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4726             88  CM-LF-DECLINED               VALUE 'D'.
  4727             88  CM-LF-VOIDED                 VALUE 'V'.
  4728
  4729         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4730         16  CM-AH-CANCEL-DT               PIC XX.
  4731         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4732
  4733         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4734         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4735         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4736
  4737         16  CM-AH-CURRENT-STATUS          PIC X.
  4738             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4739                                                'M' '4' '5' '9'.
  4740             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4741             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4742             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4743             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4744             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4745             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4746             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4747             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4748             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4749             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4750             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4751             88  CM-AH-DECLINED               VALUE 'D'.
  4752             88  CM-AH-VOIDED                 VALUE 'V'.
  4753
  4754         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4755             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4756             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4757             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4758         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4759
  4760         16  CM-ENTRY-BATCH                PIC X(6).
  4761         16  CM-LF-EXIT-BATCH              PIC X(6).
  4762         16  CM-AH-EXIT-BATCH              PIC X(6).
  4763         16  CM-LAST-MONTH-END             PIC XX.
  4764
  4765     12  CM-NOTE-SW                        PIC X.
  4766         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4767         88  CERT-NOTES-PRESENT               VALUE '1'.
  4768         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4769         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  84
* EL677.cbl
  4770         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4771         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4772         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4773         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4774     12  CM-COMP-EXCP-SW                   PIC X.
  4775         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4776         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4777     12  CM-INSURED-ADDRESS-SW             PIC X.
  4778         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4779         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4780
  4781*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4782     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4783     12  FILLER                            PIC X.
  4784
  4785*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4786     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4787     12  FILLER                            PIC X.
  4788*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4789     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4790
  4791     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4792         88  CERT-ADDED-BATCH                 VALUE ' '.
  4793         88  CERT-ADDED-ONLINE                VALUE '1'.
  4794         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4795         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4796         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4797     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4798         88  CERT-AS-LOADED                   VALUE ' '.
  4799         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4800         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4801         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4802         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4803         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4804         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4805         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4806
  4807     12  CM-ACCOUNT-COMM-PCTS.
  4808         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4809         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4810
  4811     12  CM-USER-FIELD                     PIC X.
  4812     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4813     12  CM-CLP-STATE                      PIC XX.
  4814     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4815     12  CM-USER-RESERVED                  PIC XXX.
  4816     12  FILLER REDEFINES CM-USER-RESERVED.
  4817         16  CM-AH-CLASS-CD                PIC XX.
  4818         16  F                             PIC X.
  4819******************************************************************
  4820*                                    COPY ERCPNDB.
  4821******************************************************************
  4822*                                                                *
  4823*                                                                *
  4824*                            ERCPNDB.                            *
  4825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4826*                            VMOD=2.025                          *
  4827*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  85
* EL677.cbl
  4828*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4829*                                                                *
  4830******************************************************************
  4831*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4832*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4833******************************************************************
  4834*                                                                *
  4835*                                                                *
  4836*   FILE TYPE = VSAM,KSDS                                        *
  4837*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4838*                                                                *
  4839*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4840*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4841*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4842*                                                 RKP=13,LEN=36  *
  4843*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4844*                                      AND CHG-SEQ.)             *
  4845*                                                RKP=49,LEN=11   *
  4846*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4847*                                      AND CHG-SEQ.)             *
  4848*                                                RKP=60,LEN=15   *
  4849*                                                                *
  4850*   LOG = NO                                                     *
  4851*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4852******************************************************************
  4853******************************************************************
  4854*                   C H A N G E   L O G
  4855*
  4856* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4857*-----------------------------------------------------------------
  4858*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4859* EFFECTIVE    NUMBER
  4860*-----------------------------------------------------------------
  4861* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4862* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4863* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4864* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4865* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4866* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4867* 032306                   PEMA  ADD BOW LOAN NUMBER
  4868* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4869* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4870* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4871* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4872* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4873* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4874* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4875* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4876* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4877* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4878* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4879******************************************************************
  4880
  4881 01  PENDING-BUSINESS.
  4882     12  PB-RECORD-ID                     PIC XX.
  4883         88  VALID-PB-ID                        VALUE 'PB'.
  4884
  4885     12  PB-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  86
* EL677.cbl
  4886         16  PB-COMPANY-CD                PIC X.
  4887         16  PB-ENTRY-BATCH               PIC X(6).
  4888         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4889         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4890
  4891     12  PB-CONTROL-BY-ACCOUNT.
  4892         16  PB-COMPANY-CD-A1             PIC X.
  4893         16  PB-CARRIER                   PIC X.
  4894         16  PB-GROUPING.
  4895             20  PB-GROUPING-PREFIX       PIC XXX.
  4896             20  PB-GROUPING-PRIME        PIC XXX.
  4897         16  PB-STATE                     PIC XX.
  4898         16  PB-ACCOUNT.
  4899             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4900             20  PB-ACCOUNT-PRIME         PIC X(6).
  4901         16  PB-CERT-EFF-DT               PIC XX.
  4902         16  PB-CERT-NO.
  4903             20  PB-CERT-PRIME            PIC X(10).
  4904             20  PB-CERT-SFX              PIC X.
  4905         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4906
  4907         16  PB-RECORD-TYPE               PIC X.
  4908             88  PB-MAILING-DATA                VALUE '0'.
  4909             88  PB-ISSUE                       VALUE '1'.
  4910             88  PB-CANCELLATION                VALUE '2'.
  4911             88  PB-BATCH-TRAILER               VALUE '9'.
  4912
  4913     12  PB-CONTROL-BY-ORIG-BATCH.
  4914         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4915         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4916         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4917         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4918
  4919     12  PB-CONTROL-BY-CSR.
  4920         16  PB-CSR-COMPANY-CD            PIC X.
  4921         16  PB-CSR-ID                    PIC X(4).
  4922         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4923         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4924         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4925******************************************************************
  4926*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4927******************************************************************
  4928
  4929     12  PB-LAST-MAINT-DT                 PIC XX.
  4930     12  PB-LAST-MAINT-BY                 PIC X(4).
  4931     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4932
  4933     12  PB-RECORD-BODY                   PIC X(375).
  4934
  4935     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4936         16  PB-CERT-ORIGIN               PIC X.
  4937             88  CLASIC-CREATED-CERT         VALUE '1'.
  4938         16  PB-I-NAME.
  4939             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4940             20  PB-I-INSURED-FIRST-NAME.
  4941                 24  PB-I-INSURED-1ST-INIT PIC X.
  4942                 24  FILLER                PIC X(9).
  4943             20  PB-I-INSURED-MIDDLE-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  87
* EL677.cbl
  4944         16  PB-I-AGE                     PIC S99   COMP-3.
  4945         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4946         16  PB-I-BIRTHDAY                PIC XX.
  4947         16  PB-I-INSURED-SEX             PIC X.
  4948             88  PB-SEX-MALE     VALUE 'M'.
  4949             88  PB-SEX-FEMALE   VALUE 'F'.
  4950
  4951         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4952         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4953         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4954         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4955         16  PB-I-SKIP-CODE               PIC X.
  4956             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4957             88  PB-SKIP-JULY              VALUE '1'.
  4958             88  PB-SKIP-AUGUST            VALUE '2'.
  4959             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4960             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4961             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4962             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4963             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4964             88  PB-SKIP-JUNE              VALUE '8'.
  4965             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4966             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4967             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4968         16  PB-I-TERM-TYPE               PIC X.
  4969             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4970             88  PB-PAID-WEEKLY            VALUE 'W'.
  4971             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4972             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4973             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4974         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4975         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4976         16  PB-I-DATA-ENTRY-SW           PIC X.
  4977             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4978             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4979             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4980             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4981         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4982         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4983*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4984         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4985         16  FILLER                       PIC X.
  4986
  4987         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4988             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4989             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4990                                                   '90' THRU '99'.
  4991         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4992                                          PIC XX.
  4993         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4994         16  PB-I-AMOUNT-FINANCED REDEFINES
  4995                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4996         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4997         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4998                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4999         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5000         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5001         16  PB-I-CLP-AMOUNT REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  88
* EL677.cbl
  5002                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5003         16  PB-I-LF-CALC-FLAG            PIC X.
  5004             88 PB-COMP-LF-PREM               VALUE '?'.
  5005         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5006         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5007         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5008         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5009         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5010         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5011         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5012         16  PB-I-LF-ABBR                 PIC XXX.
  5013         16  PB-I-LF-INPUT-CD             PIC XX.
  5014
  5015         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5016             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5017             88  PB-INVALID-AH               VALUE '  ' '00'
  5018                                                   '90' THRU '99'.
  5019         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5020         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5021         16  PB-I-AH-CALC-FLAG            PIC X.
  5022             88 PB-COMP-AH-PREM                  VALUE '?'.
  5023         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5024         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5025         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  5026         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5027         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5028         16  PB-I-AH-ABBR                 PIC XXX.
  5029         16  PB-I-AH-INPUT-CD             PIC XXX.
  5030
  5031         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5032         16  PB-I-REIN-TABLE              PIC XXX.
  5033         16  PB-I-BUSINESS-TYPE           PIC 99.
  5034         16  PB-I-INDV-GRP-CD             PIC X.
  5035         16  PB-I-MORT-CODE.
  5036             20  PB-I-TABLE               PIC X.
  5037             20  PB-I-INTEREST            PIC XX.
  5038             20  PB-I-MORT-TYP            PIC X.
  5039         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5040         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5041         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5042         16  PB-I-INDV-GRP-OVRD           PIC X.
  5043         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5044         16  PB-I-SIG-SW                  PIC X.
  5045             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5046         16  PB-I-RATE-CLASS              PIC XX.
  5047         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5048         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5049         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5050         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5051         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5052         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5053         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5054         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5055         16  PB-I-OB-FLAG                 PIC X.
  5056             88  PB-I-OB                      VALUE 'B'.
  5057             88  PB-I-SUMMARY                 VALUE 'Z'.
  5058         16  PB-I-ENTRY-STATUS            PIC X.
  5059             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  89
* EL677.cbl
  5060                                              'M' '5' '9' '2'.
  5061             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5062             88  PB-I-POLICY-PENDING          VALUE '2'.
  5063             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5064             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5065             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  5066             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5067             88  PB-I-REIN-ONLY               VALUE '9'.
  5068             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5069             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5070             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5071             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5072         16  PB-I-INT-CODE                PIC X.
  5073             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5074             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5075         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5076         16  PB-I-SOC-SEC-NO              PIC X(11).
  5077         16  PB-I-MEMBER-NO               PIC X(12).
  5078         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5079*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5080         16  PB-I-OLD-LOF                 PIC XXX.
  5081         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5082         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5083         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5084         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5085         16  PB-I-LIFE-INDICATOR          PIC X.
  5086             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5087         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5088         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5089                                          PIC S9(5)V99    COMP-3.
  5090         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5091             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5092             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5093         16  PB-I-1ST-PMT-DT              PIC XX.
  5094         16  PB-I-JOINT-INSURED.
  5095             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5096             20 PB-I-JOINT-FIRST-NAME.
  5097                24  PB-I-JOINT-FIRST-INIT PIC X.
  5098                24  FILLER                PIC X(9).
  5099             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5100*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5101         16  PB-I-BENEFICIARY-NAME.
  5102             20  PB-I-BANK-NUMBER         PIC X(10).
  5103             20  FILLER                   PIC X(15).
  5104         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5105         16  PB-I-REFERENCE               PIC X(12).
  5106         16  FILLER REDEFINES PB-I-REFERENCE.
  5107             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5108             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5109             20  PB-I-CLP-STATE           PIC XX.
  5110         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5111             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5112             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5113             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5114         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5115         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5116         16  PB-I-RESIDENT-STATE          PIC XX.
  5117         16  PB-I-RATE-CODE               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  90
* EL677.cbl
  5118         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5119         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5120         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5121         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5122         16  PB-I-BANK-NOCHRGB            PIC 99.
  5123         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5124         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5125
  5126     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5127         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5128             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5129         16  PB-C-CANCEL-ORIGIN           PIC X.
  5130             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5131         16  PB-C-LF-CANCEL-DT            PIC XX.
  5132         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5133         16  PB-C-LF-CALC-REQ             PIC X.
  5134             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5135         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5136         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5137         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5138             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5139         16  PB-C-AH-CANCEL-DT            PIC XX.
  5140         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5141         16  PB-C-AH-CALC-REQ             PIC X.
  5142             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5143         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5144         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5145         16  PB-C-LAST-NAME               PIC X(15).
  5146         16  PB-C-REFUND-SW               PIC X.
  5147             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5148             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5149         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5150         16  PB-C-PAYEE-CODE              PIC X(6).
  5151         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5152         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5153         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5154         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5155         16  PB-C-REFERENCE               PIC X(12).
  5156         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5157         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5158         16  PB-C-POST-CARD-IND           PIC X.
  5159         16  PB-C-CANCEL-REASON           PIC X.
  5160         16  PB-C-REF-INTERFACE-SW        PIC X.
  5161         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5162         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5163         16  FILLER                       PIC X(01).
  5164*        16  FILLER                       PIC X(18).
  5165         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5166*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5167         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5168         16  PB-CANCELED-CERT-DATA.
  5169             20  PB-CI-INSURED-NAME.
  5170                 24  PB-CI-LAST-NAME      PIC X(15).
  5171                 24  PB-CI-INITIALS       PIC XX.
  5172             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5173             20  PB-CI-INSURED-SEX        PIC X.
  5174             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5175             20  PB-CI-LF-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  91
* EL677.cbl
  5176             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5177             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5178             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5179             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5180             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5181             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5182             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5183             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5184             20  PB-CI-RATE-CLASS         PIC XX.
  5185             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5186             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5187             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5188             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5189             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5190             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5191             20  PB-CI-LF-ABBR            PIC X(3).
  5192             20  PB-CI-AH-ABBR            PIC X(3).
  5193             20  PB-CI-OB-FLAG            PIC X.
  5194                 88  PB-CI-OB                VALUE 'B'.
  5195             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5196                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5197                                           'M' '4' '5' '9' '2'.
  5198                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5199                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5200                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5201                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5202                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5203                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5204                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5205                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5206                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5207                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5208                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5209                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5210                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5211             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5212                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5213                                           'M' '4' '5' '9' '2'.
  5214                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5215                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5216                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5217                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5218                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5219                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5220                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5221                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5222                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5223                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5224                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5225                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5226                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5227             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5228             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5229             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5230             20  PB-CI-MEMBER-NO          PIC X(12).
  5231             20  PB-CI-INT-CODE           PIC X.
  5232                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5233                 88  PB-CI-SIMPLE                  VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  92
* EL677.cbl
  5234             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5235             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5236             20  PB-CI-COMP-EXCP-SW       PIC X.
  5237                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5238                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5239             20  PB-CI-ENTRY-STATUS       PIC X.
  5240             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5241             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5242             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5243             20  PB-CI-DEATH-DT           PIC XX.
  5244             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5245             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5246             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5247             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5248             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5249             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5250             20  PB-CI-ENTRY-DT              PIC XX.
  5251             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5252             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5253             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5254             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5255             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5256             20  PB-CI-OLD-LOF               PIC XXX.
  5257*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5258             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5259             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5260             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5261             20  PB-CI-INDV-GRP-CD           PIC X.
  5262             20  PB-CI-BENEFICIARY-NAME.
  5263                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5264                 24  FILLER                  PIC X(15).
  5265             20  PB-CI-NOTE-SW               PIC X.
  5266             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5267             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5268             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5269             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5270             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5271             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5272             20  PB-CI-FIRST-NAME            PIC X(10).
  5273             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5274
  5275         16  FILLER                       PIC X(13).
  5276*032306  16  FILLER                       PIC X(27).
  5277*        16  FILLER                       PIC X(46).
  5278
  5279     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5280         16  FILLER                       PIC X(10).
  5281         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5282         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5283         16  PB-M-INSURED-MID-INIT        PIC X.
  5284         16  PB-M-INSURED-AGE             PIC 99.
  5285         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5286         16  PB-M-INSURED-SEX             PIC X.
  5287         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5288         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5289         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5290         16  PB-M-INSURED-CITY-STATE.
  5291             20  PB-M-INSURED-CITY        PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  93
* EL677.cbl
  5292             20  PB-M-INSURED-STATE       PIC XX.
  5293         16  PB-M-INSURED-ZIP-CODE.
  5294             20  PB-M-INSURED-ZIP-PRIME.
  5295                 24  PB-M-INSURED-ZIP-1   PIC X.
  5296                     88  PB-M-CANADIAN-POST-CODE
  5297                                             VALUE 'A' THRU 'Z'.
  5298                 24  FILLER               PIC X(4).
  5299             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5300         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5301                                        PB-M-INSURED-ZIP-CODE.
  5302             20  PM-M-INS-CAN-POST1       PIC XXX.
  5303             20  PM-M-INS-CAN-POST2       PIC XXX.
  5304             20  FILLER                   PIC XXX.
  5305         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5306         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5307         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5308         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5309         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5310         16  PB-M-CRED-BENE-CITYST.
  5311             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5312             20  PB-M-CRED-BENE-STATE     PIC XX.
  5313         16  FILLER                       PIC X(92).
  5314
  5315     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5316         16  FILLER                       PIC X(10).
  5317         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5318         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5319         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5320         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5321         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5322         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5323         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5324         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5325         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5326         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5327         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5328         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5329         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5330         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5331         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5332         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5333         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5334         16  PB-ACCOUNT-NAME              PIC X(30).
  5335         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5336         16  PB-REFERENCE                 PIC X(12).
  5337         16  PB-B-RECEIVED-DT             PIC XX.
  5338         16  FILLER                       PIC X(234).
  5339
  5340     12  PB-RECORD-STATUS.
  5341         16  PB-CREDIT-SELECT-DT          PIC XX.
  5342         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5343         16  PB-BILLED-DT                 PIC XX.
  5344         16  PB-BILLING-STATUS            PIC X.
  5345             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5346             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5347             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5348         16  PB-RECORD-BILL               PIC X.
  5349             88  PB-RECORD-ON-HOLD            VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  94
* EL677.cbl
  5350             88  PB-RECORD-RETURNED           VALUE 'R'.
  5351             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5352             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5353             88  PB-OVERRIDE-AH               VALUE 'A'.
  5354             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5355         16  PB-BATCH-ENTRY               PIC X.
  5356             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5357             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5358             88  PB-REISSUED-CERT             VALUE 'E'.
  5359             88  PB-CASH-CERT                 VALUE 'C'.
  5360             88  PB-MONTHLY-CERT              VALUE 'M'.
  5361             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5362             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5363             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5364         16  PB-FORCE-CODE                PIC X.
  5365             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5366             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5367             88  PB-CANCEL-FORCE              VALUE '8'.
  5368             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5369             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5370             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5371             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5372             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5373             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5374             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  5375             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5376         16  PB-FATAL-FLAG                PIC X.
  5377             88  PB-FATAL-ERRORS              VALUE 'X'.
  5378         16  PB-FORCE-ER-CD               PIC X.
  5379             88  PB-FORCE-ERRORS              VALUE 'F'.
  5380             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5381         16  PB-WARN-ER-CD                PIC X.
  5382             88  PB-WARNING-ERRORS            VALUE 'W'.
  5383         16  FILLER                       PIC X.
  5384         16  PB-OUT-BAL-CD                PIC X.
  5385             88  PB-OUT-OF-BAL                VALUE 'O'.
  5386         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5387         16  PB-AH-OVERRIDE-L1            PIC X.
  5388         16  PB-INPUT-DT                  PIC XX.
  5389         16  PB-INPUT-BY                  PIC X(4).
  5390         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5391         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5392         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5393         16  PB-LF-EARNING-METHOD         PIC X.
  5394         16  PB-AH-EARNING-METHOD         PIC X.
  5395         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5396         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5397         16  PB-REIN-CD                   PIC XXX.
  5398         16  PB-LF-REFUND-TYPE            PIC X.
  5399         16  PB-AH-REFUND-TYPE            PIC X.
  5400         16  PB-ACCT-EFF-DT               PIC XX.
  5401         16  PB-ACCT-EXP-DT               PIC XX.
  5402         16  PB-COMPANY-ID                PIC X(3).
  5403         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5404         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5405         16  PB-SV-CARRIER                PIC X.
  5406         16  PB-SV-GROUPING               PIC X(6).
  5407         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  95
* EL677.cbl
  5408         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5409         16  PB-GA-BILLING-INFO.
  5410             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5411                                          PIC XX.
  5412         16  PB-SV-REMIT-TO  REDEFINES
  5413             PB-GA-BILLING-INFO           PIC X(10).
  5414         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5415         16  PB-I-LOAN-OFFICER            PIC X(5).
  5416         16  PB-I-VIN                     PIC X(17).
  5417
  5418         16  FILLER                       PIC X(04).
  5419         16  IMNET-BYPASS-SW              PIC X.
  5420
  5421******************************************************************
  5422*                COMMON EDIT ERRORS                              *
  5423******************************************************************
  5424
  5425     12  PB-COMMON-ERRORS.
  5426         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5427                                           PIC S9(4)     COMP.
  5428
  5429******************************************************************
  5430*                                    COPY ERCPNDM.
  5431******************************************************************
  5432*                                                                *
  5433*                                                                *
  5434*                            ERCPNDM                             *
  5435*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5436*                            VMOD=2.003                          *
  5437*                                                                *
  5438*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5439*                                                                *
  5440*   FILE TYPE = VSAM,KSDS                                        *
  5441*   RECORD SIZE = 374   RECFORM = FIX                            *
  5442*                                                                *
  5443*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5444*   ALTERNATE PATH    = NOT USED                                 *
  5445*                                                                *
  5446*   LOG = YES                                                    *
  5447*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5448******************************************************************
  5449*                   C H A N G E   L O G
  5450*
  5451* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5452*-----------------------------------------------------------------
  5453*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5454* EFFECTIVE    NUMBER
  5455*-----------------------------------------------------------------
  5456* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5457* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5458* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5459******************************************************************
  5460
  5461 01  PENDING-MAILING-DATA.
  5462     12  PM-RECORD-ID                      PIC XX.
  5463         88  VALID-MA-ID                       VALUE 'PM'.
  5464
  5465     12  PM-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  96
* EL677.cbl
  5466         16  PM-COMPANY-CD                 PIC X.
  5467         16  PM-ENTRY-BATCH                PIC X(6).
  5468         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5469         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5470
  5471     12  FILLER                            PIC X(14).
  5472
  5473     12  PM-ACCESS-CONTROL.
  5474         16  PM-SOURCE-SYSTEM              PIC XX.
  5475             88  PM-FROM-CREDIT                VALUE 'CR'.
  5476             88  PM-FROM-VSI                   VALUE 'VS'.
  5477             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5478             88  PM-FROM-OTHER                 VALUE 'OT'.
  5479         16  PM-RECORD-ADD-DT              PIC XX.
  5480         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5481         16  PM-LAST-MAINT-DT              PIC XX.
  5482         16  PM-LAST-MAINT-BY              PIC XXXX.
  5483         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5484
  5485     12  PM-PROFILE-INFO.
  5486         16  PM-QUALIFY-CODE-1             PIC XX.
  5487         16  PM-QUALIFY-CODE-2             PIC XX.
  5488         16  PM-QUALIFY-CODE-3             PIC XX.
  5489         16  PM-QUALIFY-CODE-4             PIC XX.
  5490         16  PM-QUALIFY-CODE-5             PIC XX.
  5491
  5492         16  PM-INSURED-LAST-NAME          PIC X(15).
  5493         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5494         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5495         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5496         16  PM-INSURED-BIRTH-DT           PIC XX.
  5497         16  PM-INSURED-SEX                PIC X.
  5498             88  PM-SEX-MALE                   VALUE 'M'.
  5499             88  PM-SEX-FEMALE                 VALUE 'F'.
  5500         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5501
  5502         16  PM-ADDRESS-CORRECTED          PIC X.
  5503         16  PM-JOINT-BIRTH-DT             PIC XX.
  5504*        16  FILLER                        PIC X(12).
  5505
  5506         16  PM-ADDRESS-LINE-1             PIC X(30).
  5507         16  PM-ADDRESS-LINE-2             PIC X(30).
  5508         16  PM-CITY-STATE.
  5509             20  PM-CITY                   PIC X(28).
  5510             20  PM-STATE                  PIC XX.
  5511         16  PM-ZIP.
  5512             20  PM-ZIP-CODE.
  5513                 24  PM-ZIP-1              PIC X.
  5514                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5515                 24  FILLER                PIC X(4).
  5516             20  PM-ZIP-PLUS4              PIC X(4).
  5517         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5518             20  PM-CAN-POST1              PIC XXX.
  5519             20  PM-CAN-POST2              PIC XXX.
  5520             20  FILLER                    PIC XXX.
  5521
  5522         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5523
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  97
* EL677.cbl
  5524         16  FILLER                        PIC X(03).
  5525
  5526     12  PM-CRED-BENE-INFO.
  5527         16  PM-CRED-BENE-NAME             PIC X(25).
  5528         16  PM-CRED-BENE-ADDR             PIC X(30).
  5529         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5530         16  PM-CRED-BENE-CTYST.
  5531             20  PM-CRED-BENE-CITY         PIC X(28).
  5532             20  PM-CRED-BENE-STATE        PIC XX.
  5533         16  PM-CRED-BENE-ZIP.
  5534             20  PM-CB-ZIP-CODE.
  5535                 24  PM-CB-ZIP-1           PIC X.
  5536                     88  PM-CB-CANADIAN-POST-CODE
  5537                                  VALUE 'A' THRU 'Z'.
  5538                 24  FILLER                PIC X(4).
  5539             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5540         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5541             20  PM-CB-CAN-POST1           PIC XXX.
  5542             20  PM-CB-CAN-POST2           PIC XXX.
  5543             20  FILLER                    PIC XXX.
  5544     12  PM-POST-CARD-MAIL-DATA.
  5545         16  PM-MAIL-DATA OCCURS 7.
  5546             20  PM-MAIL-TYPE              PIC X.
  5547                 88  PM-12MO-MAILING           VALUE '1'.
  5548                 88  PM-EXP-MAILING            VALUE '2'.
  5549             20  PM-MAIL-STATUS            PIC X.
  5550                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5551                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5552                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5553             20  PM-MAIL-DATE              PIC XX.
  5554     12  FILLER                            PIC XX.
  5555     12  FILLER                            PIC X(12).
  5556*    12  FILLER                            PIC X(30).
  5557
  5558******************************************************************
  5559*                                    COPY ERCMAIL.
  5560******************************************************************
  5561*                                                                *
  5562*                                                                *
  5563*                            ERCMAIL                             *
  5564*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5565*                            VMOD=2.003                          *
  5566*                                                                *
  5567*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5568*                                                                *
  5569*   FILE TYPE = VSAM,KSDS                                        *
  5570*   RECORD SIZE = 374   RECFORM = FIX                            *
  5571*                                                                *
  5572*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5573*   ALTERNATE PATH    = NOT USED                                 *
  5574*                                                                *
  5575*   LOG = YES                                                    *
  5576*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5577******************************************************************
  5578*                   C H A N G E   L O G
  5579*
  5580* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5581*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  98
* EL677.cbl
  5582*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5583* EFFECTIVE    NUMBER
  5584*-----------------------------------------------------------------
  5585* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5586* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5587* 111108                   PEMA  ADD CRED BENE ADDR2
  5588******************************************************************
  5589
  5590 01  MAILING-DATA.
  5591     12  MA-RECORD-ID                      PIC XX.
  5592         88  VALID-MA-ID                       VALUE 'MA'.
  5593
  5594     12  MA-CONTROL-PRIMARY.
  5595         16  MA-COMPANY-CD                 PIC X.
  5596         16  MA-CARRIER                    PIC X.
  5597         16  MA-GROUPING.
  5598             20  MA-GROUPING-PREFIX        PIC XXX.
  5599             20  MA-GROUPING-PRIME         PIC XXX.
  5600         16  MA-STATE                      PIC XX.
  5601         16  MA-ACCOUNT.
  5602             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5603             20  MA-ACCOUNT-PRIME          PIC X(6).
  5604         16  MA-CERT-EFF-DT                PIC XX.
  5605         16  MA-CERT-NO.
  5606             20  MA-CERT-PRIME             PIC X(10).
  5607             20  MA-CERT-SFX               PIC X.
  5608
  5609     12  FILLER                            PIC XX.
  5610
  5611     12  MA-ACCESS-CONTROL.
  5612         16  MA-SOURCE-SYSTEM              PIC XX.
  5613             88  MA-FROM-CREDIT                VALUE 'CR'.
  5614             88  MA-FROM-VSI                   VALUE 'VS'.
  5615             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5616             88  MA-FROM-OTHER                 VALUE 'OT'.
  5617         16  MA-RECORD-ADD-DT              PIC XX.
  5618         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5619         16  MA-LAST-MAINT-DT              PIC XX.
  5620         16  MA-LAST-MAINT-BY              PIC XXXX.
  5621         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5622
  5623     12  MA-PROFILE-INFO.
  5624         16  MA-QUALIFY-CODE-1             PIC XX.
  5625         16  MA-QUALIFY-CODE-2             PIC XX.
  5626         16  MA-QUALIFY-CODE-3             PIC XX.
  5627         16  MA-QUALIFY-CODE-4             PIC XX.
  5628         16  MA-QUALIFY-CODE-5             PIC XX.
  5629
  5630         16  MA-INSURED-LAST-NAME          PIC X(15).
  5631         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5632         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5633         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5634         16  MA-INSURED-BIRTH-DT           PIC XX.
  5635         16  MA-INSURED-SEX                PIC X.
  5636             88  MA-SEX-MALE                   VALUE 'M'.
  5637             88  MA-SEX-FEMALE                 VALUE 'F'.
  5638         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5639
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page  99
* EL677.cbl
  5640         16  MA-ADDRESS-CORRECTED          PIC X.
  5641         16  MA-JOINT-BIRTH-DT             PIC XX.
  5642*        16  FILLER                        PIC X(12).
  5643
  5644         16  MA-ADDRESS-LINE-1             PIC X(30).
  5645         16  MA-ADDRESS-LINE-2             PIC X(30).
  5646         16  MA-CITY-STATE.
  5647             20  MA-CITY                   PIC X(28).
  5648             20  MA-ADDR-STATE             PIC XX.
  5649         16  MA-ZIP.
  5650             20  MA-ZIP-CODE.
  5651                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5652                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5653                 24  FILLER                PIC X(4).
  5654             20  MA-ZIP-PLUS4              PIC X(4).
  5655         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5656             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5657             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5658             20  FILLER                    PIC X(3).
  5659
  5660         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5661
  5662         16  FILLER                        PIC XXX.
  5663*        16  FILLER                        PIC X(10).
  5664
  5665     12  MA-CRED-BENE-INFO.
  5666         16  MA-CRED-BENE-NAME                 PIC X(25).
  5667         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5668         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5669         16  MA-CRED-BENE-CTYST.
  5670             20  MA-CRED-BENE-CITY             PIC X(28).
  5671             20  MA-CRED-BENE-STATE            PIC XX.
  5672         16  MA-CRED-BENE-ZIP.
  5673             20  MA-CB-ZIP-CODE.
  5674                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5675                     88  MA-CB-CANADIAN-POST-CODE
  5676                                           VALUE 'A' THRU 'Z'.
  5677                 24  FILLER                    PIC X(4).
  5678             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5679         16  MA-CB-CANADIAN-POSTAL-CODE
  5680                            REDEFINES MA-CRED-BENE-ZIP.
  5681             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5682             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5683             20  FILLER                        PIC X(3).
  5684     12  MA-POST-CARD-MAIL-DATA.
  5685         16  MA-MAIL-DATA OCCURS 7.
  5686             20  MA-MAIL-TYPE              PIC X.
  5687                 88  MA-12MO-MAILING           VALUE '1'.
  5688                 88  MA-EXP-MAILING            VALUE '2'.
  5689             20  MA-MAIL-STATUS            PIC X.
  5690                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5691                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5692                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5693             20  MA-MAIL-DATE              PIC XX.
  5694     12  FILLER                            PIC XX.
  5695     12  FILLER                            PIC XX.
  5696*    12  FILLER                            PIC X(30).
  5697******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 100
* EL677.cbl
  5698*                                    COPY ERCPYAJ.
  5699******************************************************************
  5700*                                                                *
  5701*                            ERCPYAJ                             *
  5702*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5703*                            VMOD=2.015                          *
  5704*                                                                *
  5705*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5706*                                                                *
  5707*                                                                *
  5708*   FILE TYPE = VSAM,KSDS                                        *
  5709*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5710*                                                                *
  5711*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5712*       ALTERNATE PATHS = NONE                                   *
  5713*                                                                *
  5714*   LOG = YES                                                    *
  5715*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5716******************************************************************
  5717******************************************************************
  5718*                   C H A N G E   L O G
  5719*
  5720* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5721*-----------------------------------------------------------------
  5722*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5723* EFFECTIVE    NUMBER
  5724*-----------------------------------------------------------------
  5725* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5726* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5727******************************************************************
  5728
  5729 01  PENDING-PAY-ADJ.
  5730     12  PY-RECORD-ID                     PIC XX.
  5731         88  VALID-PY-ID                        VALUE 'PY'.
  5732
  5733     12  PY-CONTROL-PRIMARY.
  5734         16  PY-COMPANY-CD                PIC X.
  5735         16  PY-CARRIER                   PIC X.
  5736         16  PY-GROUPING                  PIC X(6).
  5737         16  PY-FIN-RESP                  PIC X(10).
  5738         16  PY-ACCOUNT                   PIC X(10).
  5739         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5740                                          PIC X(10).
  5741         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5742         16  PY-RECORD-TYPE               PIC X.
  5743             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5744             88  PY-DEPOSIT                   VALUE 'D'.
  5745             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5746             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5747             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5748             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5749             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5750             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5751             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5752             88  PY-FICA-ENTRY                VALUE 'F'.
  5753             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5754             88  PY-POLICY-FEE                VALUE 'W'.
  5755             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 101
* EL677.cbl
  5756
  5757     12  PY-PYMT-TYPE                     PIC X.
  5758             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5759             88  PY-REINS-PYMT                VALUE 'R'.
  5760             88  PY-EXP-PYMT                  VALUE 'E'.
  5761
  5762     12  PY-BIL-INV                       PIC X(6).
  5763     12  PY-REF-NO                        PIC X(12).
  5764
  5765     12  PY-LAST-MAINT-DT                 PIC XX.
  5766     12  PY-LAST-MAINT-BY                 PIC X(4).
  5767     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5768
  5769     12  PY-PYADJ-RECORD.
  5770         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5771         16  PY-ENTRY-COMMENT             PIC X(30).
  5772         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5773             20  PY-GL-ACCOUNT            PIC X(10).
  5774             20  PY-GL-STATE              PIC X(02).
  5775             20  PY-GL-CANC-SW            PIC X(01).
  5776                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5777                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5778             20  PY-GL-COMMENT            PIC X(10).
  5779             20  FILLER      REDEFINES PY-GL-COMMENT.
  5780                 24  PY-GL-CHECK-NO       PIC 9(06).
  5781                 24  FILLER               PIC X(04).
  5782             20  FILLER                   PIC X(07).
  5783         16  PY-SAVE-ACCOUNT              PIC X(10).
  5784         16  PY-SAVE-TYPE                 PIC X(01).
  5785
  5786         16  PY-LETTERS.
  5787             20  PY-LETTER OCCURS 3 TIMES
  5788                           INDEXED BY PY-LET-NDX
  5789                                          PIC X(04).
  5790
  5791         16  PY-ERCOMP-TYPE               PIC X.
  5792             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5793             88  PY-GA-TYPE                   VALUE 'G'.
  5794             88  PY-BANK-TYPE                 VALUE 'B'.
  5795         16  FILLER                       PIC X(05).
  5796
  5797     12  PY-RECORD-STATUS.
  5798         16  PY-CREDIT-SELECT-DT          PIC XX.
  5799         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5800         16  PY-BILLED-DATE               PIC XX.
  5801         16  PY-REPORTED-DT               PIC XX.
  5802         16  PY-PMT-APPLIED               PIC X.
  5803             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5804             88  PY-GA-PMT                    VALUE 'G'.
  5805             88  PY-OVWRITE-PMT               VALUE 'O'.
  5806             88  PY-NON-AR-PMT                VALUE 'N'.
  5807         16  FILLER                       PIC X(5).
  5808         16  PY-INPUT-DT                  PIC XX.
  5809         16  PY-CHECK-NUMBER              PIC X(6).
  5810         16  PY-VOID-SW                   PIC X.
  5811             88  PY-CHECK-VOIDED              VALUE 'V'.
  5812         16  PY-CHECK-ORIGIN-SW           PIC X.
  5813             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 102
* EL677.cbl
  5814             88  PY-REFUND-CHECK              VALUE 'R'.
  5815             88  PY-GA-CHECK                  VALUE 'G'.
  5816             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5817             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5818         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5819         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5820         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5821         16  PY-BILL-FLAG                 PIC X.
  5822             88  PY-BILLED                    VALUE 'B'.
  5823         16  PY-AR-FLAG                   PIC X.
  5824             88  PY-AR-CYCLE                  VALUE 'C'.
  5825             88  PY-AR-MONTH-END              VALUE 'M'.
  5826         16  PY-AR-DATE                   PIC XX.
  5827
  5828     12  PY-GL-CODES.
  5829         16  PY-GL-DB                     PIC X(14).
  5830         16  PY-GL-CR                     PIC X(14).
  5831         16  PY-GL-FLAG                   PIC X.
  5832         16  PY-GL-DATE                   PIC XX.
  5833
  5834     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5835     12  FILLER                           PIC X(3).
  5836******************************************************************
  5837 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5838                          CHECK-RECORDS ACCOUNT-MASTER
  5839                          COMPENSATION-MASTER
  5840                          CERTIFICATE-MASTER PENDING-BUSINESS
  5841                          PENDING-MAILING-DATA MAILING-DATA
  5842                          PENDING-PAY-ADJ.
  5843 0000-DFHEXIT SECTION.
  5844     MOVE '9#                    $   ' TO DFHEIV0.
  5845     MOVE 'EL677' TO DFHEIV1.
  5846     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5847
  5848     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5849     MOVE '5'                    TO  DC-OPTION-CODE.
  5850     PERFORM 8500-DATE-CONVERT.
  5851     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5852     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5853     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5854
  5855     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5856
  5857     IF PI-AMOUNT NOT NUMERIC
  5858         MOVE ZEROS              TO  PI-AMOUNT.
  5859
  5860     IF EIBCALEN = 0
  5861         GO TO 8800-UNAUTHORIZED-ACCESS.
  5862     set P to address of KIXSYS
  5863     CALL "getenv" using by value P returning var-ptr
  5864     if var-ptr = null then
  5865        display ' kixsys not set '
  5866     else
  5867        set address of var to var-ptr
  5868        move 0 to env-var-len
  5869        inspect var tallying env-var-len
  5870          for characters before X'00'
  5871        unstring var (1:env-var-len) delimited by '/'
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 103
* EL677.cbl
  5872           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5873              WS-KIX-SYS
  5874        end-unstring
  5875     end-if
  5876     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5877     MOVE 2                      TO  EMI-SWITCH2.
  5878     MOVE EIBTRMID               TO  QID-TERM.
  5879
  5880     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5881         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5882
  5883     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5884         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5885             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5886             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5887             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5888             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5889             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5890             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5891             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5892             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5893         ELSE
  5894             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5895             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5896             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5897             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5898             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5899             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5900             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5901             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5902
  5903     MOVE LOW-VALUES             TO  EL677AI.
  5904
  5905     if eibtrnid not = trans-id
  5906        evaluate true
  5907           when pi-return-to-program = 'EL6315'
  5908              move pi-company-cd to pi-chek-comp-cd
  5909              move pi-carrier    to pi-chek-carrier
  5910              move pi-grouping   to pi-chek-grouping
  5911              move pi-state      to pi-chek-state
  5912              move pi-account    to pi-chek-account
  5913              move pi-cert-eff-dt to pi-chek-eff-dt
  5914              move pi-cert-prime to pi-chek-cert-no
  5915              move pi-cert-sfx   to pi-chek-suf-no
  5916              move +1            to pi-chek-sequence
  5917              move 'C'           to pi-check-type *> Correction
  5918              move 'S'           to mainti
  5919              move +1            to maintl
  5920              move al-uanon      to mainta
  5921              move dfhenter      to eibaid
  5922              go to 5000-browse-file
  5923           when pi-return-to-program = 'EL6318'
  5924              move 'C'           to pi-check-type *> Correction
  5925           when other
  5926              move 'R'           to pi-check-type *> Refund
  5927        end-evaluate
  5928     end-if
  5929     IF EIBTRNID NOT = TRANS-ID
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 104
* EL677.cbl
  5930         move pi-processor-id    to pi-return-to
  5931         move +1                 to dedcynl
  5932         move 'N'                to dedcyno
  5933         move al-uanon           to dedcyna
  5934         move dfhpf7             to eibaid
  5935         perform 6800-browse-previous-chek-recs *> totals up prev
  5936                                 thru 6800-exit
  5937         perform 5600-get-erpndb thru 5600-exit *> calc refund on
  5938                                                *> pending record
  5939         IF PI-TO-EL677-FROM-EL1273
  5940             MOVE 'S'            TO MAINTI
  5941             MOVE 1              TO MAINTL
  5942             MOVE AL-UABON       TO MAINTA
  5943             MOVE DFHENTER       TO EIBAID
  5944             GO TO 5000-BROWSE-FILE.
  5945
  5946     IF EIBTRNID NOT = TRANS-ID
  5947        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5948           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5949           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5950           IF PI-PROCESS-BENEFICIARY
  5951              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5952           ELSE
  5953              GO TO 6300-BUILD-CERT-SCREEN
  5954           end-if
  5955        ELSE
  5956           IF EIBTRNID NOT = EL6311-TRANS-ID and el6318-trans-id
  5957              GO TO 8100-SEND-INITIAL-MAP
  5958           ELSE
  5959              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5960              IF PI-PROCESS-BENEFICIARY
  5961                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5962              ELSE
  5963                 GO TO 6300-BUILD-CERT-SCREEN
  5964              end-if
  5965           end-if
  5966        end-if
  5967      end-if
  5968
  5969     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5970                                     PI-CHEK-COMP-CD.
  5971
  5972
  5973* EXEC CICS HANDLE CONDITION
  5974*        PGMIDERR  (9600-PGMID-ERROR)
  5975*        ERROR     (9990-ABEND)
  5976*    END-EXEC.
  5977*    MOVE '"$L.                  ! " #00005875' TO DFHEIV0
  5978     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5979     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5980     MOVE X'2220233030303035383735' TO DFHEIV0(25:11)
  5981     CALL 'kxdfhei1' USING DFHEIV0
  5982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5983
  5984
  5985     IF EIBAID = DFHCLEAR
  5986         GO TO 9400-CLEAR.
  5987
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 105
* EL677.cbl
  5988     IF PI-PROCESSOR-ID = 'LGXX'
  5989         GO TO 0200-RECEIVE.
  5990
  5991
  5992* EXEC CICS READQ TS
  5993*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5994*        INTO   (SECURITY-CONTROL)
  5995*        LENGTH (SC-COMM-LENGTH)
  5996*        ITEM   (SC-ITEM)
  5997*    END-EXEC.
  5998*    MOVE '*$II   L              ''   #00005886' TO DFHEIV0
  5999     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6000     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6001     MOVE X'2020233030303035383836' TO DFHEIV0(25:11)
  6002     CALL 'kxdfhei1' USING DFHEIV0,
  6003           PI-SECURITY-TEMP-STORE-ID,
  6004           SECURITY-CONTROL,
  6005           SC-COMM-LENGTH,
  6006           SC-ITEM,
  6007           DFHEIV99,
  6008           DFHEIV99
  6009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6010
  6011
  6012     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  6013     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  6014
  6015     IF NOT DISPLAY-CAP
  6016         MOVE 'READ'          TO SM-READ
  6017         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6018         MOVE ER-0070         TO  EMI-ERROR
  6019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6020         GO TO 8100-SEND-INITIAL-MAP.
  6021
  6022 0200-RECEIVE.
  6023     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6024         MOVE ER-1159            TO  EMI-ERROR
  6025         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6026         MOVE -1                 TO  PFENTERL
  6027         GO TO 8200-SEND-DATAONLY.
  6028
  6029
  6030* EXEC CICS HANDLE CONDITION
  6031*        MAPFAIL (8100-SEND-INITIAL-MAP)
  6032*    END-EXEC.
  6033*    MOVE '"$?                   ! # #00005910' TO DFHEIV0
  6034     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6035     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6036     MOVE X'2320233030303035393130' TO DFHEIV0(25:11)
  6037     CALL 'kxdfhei1' USING DFHEIV0
  6038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6039
  6040
  6041
  6042* EXEC CICS RECEIVE
  6043*        MAP      (EL677A)
  6044*        MAPSET   (MAPSET-NAME)
  6045*        INTO     (EL677AI)
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 106
* EL677.cbl
  6046*    END-EXEC.
  6047     MOVE LENGTH OF
  6048      EL677AI
  6049       TO DFHEIV11
  6050*    MOVE '8"T I  L              ''   #00005914' TO DFHEIV0
  6051     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6052     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6053     MOVE X'2020233030303035393134' TO DFHEIV0(25:11)
  6054     CALL 'kxdfhei1' USING DFHEIV0,
  6055           EL677A,
  6056           EL677AI,
  6057           DFHEIV11,
  6058           MAPSET-NAME,
  6059           DFHEIV99,
  6060           DFHEIV99
  6061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6062
  6063
  6064     IF PFENTERL GREATER ZERO
  6065         IF EIBAID NOT = DFHENTER
  6066             MOVE ER-0004        TO  EMI-ERROR
  6067             MOVE AL-UNBOF       TO  PFENTERA
  6068             MOVE -1             TO  PFENTERL
  6069             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6070             GO TO 8200-SEND-DATAONLY
  6071         ELSE
  6072             IF (PFENTERI NUMERIC) AND
  6073                (PFENTERI GREATER 0 AND LESS 25)
  6074                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  6075             ELSE
  6076                 MOVE ER-0029    TO  EMI-ERROR
  6077                 MOVE AL-UNBOF   TO  PFENTERA
  6078                 MOVE -1         TO  PFENTERL
  6079                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6080                 GO TO 8200-SEND-DATAONLY.
  6081 0300-CHECK-PFKEYS.
  6082     IF EIBAID = DFHPF23
  6083         GO TO 8810-PF23.
  6084
  6085     IF EIBAID = DFHPF24
  6086         GO TO 9200-RETURN-MAIN-MENU.
  6087
  6088     IF EIBAID = DFHPF12
  6089         GO TO 9500-PF12.
  6090
  6091     IF EIBAID = DFHPF1 OR DFHPF2
  6092         GO TO 5000-BROWSE-FILE.
  6093
  6094     if PI-TO-EL677-FROM-EL1273
  6095        and (eibaid not = dfhenter)
  6096        go to 0320-input-error
  6097     end-if
  6098     IF EIBAID = DFHPF3
  6099         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6100         MOVE 'PF3'              TO  PI-PFKEY
  6101         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6102         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6103             GO TO 9400-CLEAR
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 107
* EL677.cbl
  6104         ELSE
  6105             MOVE XCTL-1273      TO  PGM-NAME
  6106             GO TO 9300-XCTL.
  6107
  6108     IF EIBAID = DFHPF4
  6109         IF NOT FORCE-CAP
  6110             MOVE ER-0433        TO EMI-ERROR
  6111             MOVE -1             TO PFENTERL
  6112             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6113             GO TO 8200-SEND-DATAONLY.
  6114
  6115     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6116                             DFHPF5 OR DFHPF6 or dfhpf7
  6117         GO TO 1000-EDIT-DATA.
  6118
  6119*    IF EIBAID = DFHPF7
  6120*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6121*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6122*        MOVE XCTL-114           TO  PGM-NAME
  6123*        GO TO 9300-XCTL.
  6124
  6125 0320-INPUT-ERROR.
  6126     MOVE ER-0029                TO  EMI-ERROR.
  6127     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6128     MOVE -1                     TO  PFENTERL.
  6129     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 108
* EL677.cbl
  6131
  6132 1000-EDIT-DATA.
  6133     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D'
  6134         MOVE AL-UANON           TO MAINTA
  6135         IF MAINTI = 'C' OR 'V'
  6136             IF PI-PREV-MAINT = 'S'  OR  'C'
  6137                 NEXT SENTENCE
  6138             ELSE
  6139                 MOVE ER-2056    TO  EMI-ERROR
  6140                 MOVE -1         TO  MAINTL
  6141                 MOVE AL-UABON   TO  MAINTA
  6142                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6143                 GO TO 1100-EDIT-COMPLETE
  6144         ELSE
  6145             NEXT SENTENCE
  6146     ELSE
  6147         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6148            NEXT SENTENCE
  6149         ELSE
  6150            MOVE ER-0023            TO  EMI-ERROR
  6151            MOVE -1                 TO  MAINTL
  6152            MOVE AL-UABON           TO  MAINTA
  6153            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6154
  6155     IF MODIFY-CAP
  6156         NEXT SENTENCE
  6157       ELSE
  6158         IF MAINTI NOT = 'S'
  6159            MOVE 'UPDATE'       TO SM-READ
  6160            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6161            MOVE ER-0070        TO EMI-ERROR
  6162            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6163            GO TO 8100-SEND-INITIAL-MAP.
  6164
  6165     if (pi-return-to-program = 'EL1273')
  6166        and (MAINTI not = 'S' and 'V')
  6167        move 'S'                 to mainti
  6168        move +1                  to maintl
  6169        move al-uanon            to mainta
  6170     end-if
  6171     IF CARRIERI NOT = LOW-VALUES
  6172         MOVE AL-UANON           TO  CARRIERA
  6173         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6174         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6175                                     PI-CARRIER
  6176     ELSE
  6177         MOVE -1                 TO  CARRIERL
  6178         MOVE AL-UABON           TO  CARRIERA
  6179         MOVE ER-0194            TO  EMI-ERROR
  6180         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6181
  6182     IF GROUPI NOT = LOW-VALUES
  6183         MOVE AL-UANON           TO  GROUPA
  6184         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6185                                     PI-GROUPING
  6186     ELSE
  6187         MOVE -1                 TO  GROUPL
  6188         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 109
* EL677.cbl
  6189         MOVE ER-0195            TO  EMI-ERROR
  6190         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6191
  6192     IF STATEI NOT = LOW-VALUES
  6193         MOVE AL-UANON           TO  STATEA
  6194         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6195         MOVE STATEI             TO  PI-CHEK-STATE
  6196                                     PI-STATE
  6197     ELSE
  6198         MOVE -1                 TO  STATEL
  6199         MOVE AL-UABON           TO  STATEA
  6200         MOVE ER-0196            TO  EMI-ERROR
  6201         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6202
  6203     IF EFFDTL GREATER ZERO
  6204         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6205         PERFORM 8700-DEEDIT
  6206         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6207             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6208             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6209             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6210             MOVE '4'                TO  DC-OPTION-CODE
  6211             PERFORM 8500-DATE-CONVERT
  6212             IF DC-ERROR-CODE NOT = SPACES
  6213                 MOVE ER-0215        TO  EMI-ERROR
  6214                 PERFORM 9900-ERROR-FORMAT
  6215                 MOVE -1             TO  EFFDTL
  6216                 MOVE AL-UABON       TO  EFFDTA
  6217               ELSE
  6218                 MOVE AL-UANON       TO  EFFDTA
  6219                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6220                                         PI-CERT-EFF-DT
  6221           ELSE
  6222             MOVE ER-0215        TO  EMI-ERROR
  6223             PERFORM 9900-ERROR-FORMAT
  6224             MOVE -1             TO  EFFDTL
  6225             MOVE AL-UABON       TO  EFFDTA
  6226       ELSE
  6227         MOVE ER-0216            TO  EMI-ERROR
  6228         PERFORM 9900-ERROR-FORMAT
  6229         MOVE -1                 TO  EFFDTL
  6230         MOVE AL-UABOF           TO  EFFDTA.
  6231
  6232     IF ACCTI NOT = LOW-VALUES
  6233         MOVE AL-UANON           TO  ACCTA
  6234         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6235         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6236                                     PI-ACCOUNT
  6237     ELSE
  6238         MOVE -1                 TO  ACCTL
  6239         MOVE AL-UABON           TO  ACCTA
  6240         MOVE ER-0197            TO  EMI-ERROR
  6241         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6242
  6243     IF CERTNOI NOT = LOW-VALUES
  6244         MOVE AL-UANON           TO  CERTNOA
  6245         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6246                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 110
* EL677.cbl
  6247     ELSE
  6248         MOVE -1                 TO  CERTNOL
  6249         MOVE AL-UABON           TO  CERTNOA
  6250         MOVE ER-0203            TO  EMI-ERROR
  6251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6252
  6253     IF SFXI  = LOW-VALUES
  6254         MOVE SPACE              TO  SFXI.
  6255
  6256     MOVE AL-UANON               TO  SFXA.
  6257
  6258     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6259                                     PI-CERT-SFX.
  6260     IF SEQI = LOW-VALUES
  6261         MOVE +1                 TO  SEQI.
  6262
  6263     MOVE AL-UNNON               TO  SEQA.
  6264     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6265
  6266     IF PAYTO1L > 0
  6267         MOVE PAYTO1I            TO  PI-PAYTO1
  6268     ELSE
  6269         MOVE SPACES             TO  PI-PAYTO1.
  6270
  6271     IF AMOUNTL > 0
  6272
  6273* EXEC CICS BIF DEEDIT
  6274*            FIELD   (AMOUNTI)
  6275*            LENGTH  (11)
  6276*        END-EXEC
  6277     MOVE 11
  6278       TO DFHEIV11
  6279*    MOVE '@"L                   #   #00006128' TO DFHEIV0
  6280     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6281     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6282     MOVE X'2020233030303036313238' TO DFHEIV0(25:11)
  6283     CALL 'kxdfhei1' USING DFHEIV0,
  6284           AMOUNTI,
  6285           DFHEIV11
  6286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6287         MOVE AMOUNTI            TO  PI-AMOUNT
  6288     ELSE
  6289         MOVE ZEROS              TO  PI-AMOUNT.
  6290
  6291     IF TYPEL > 0
  6292         MOVE TYPEI              TO  PI-TYPE
  6293     ELSE
  6294         MOVE SPACE              TO  PI-TYPE.
  6295
  6296*    IF REFL > 0
  6297*        MOVE REFI               TO  PI-REFERENCE
  6298*    ELSE
  6299*        MOVE SPACES             TO  PI-REFERENCE.
  6300     if rettol not = zeros
  6301        move rettoi              to pi-return-to
  6302        MOVE AL-UANON            TO  RETTOA
  6303     end-if
  6304     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 111
* EL677.cbl
  6305        if dedcyni = 'Y' OR 'N'
  6306           move al-uanon         to dedcyna
  6307           continue
  6308        else
  6309           move er-3451          to emi-error
  6310           move -1               to dedcynl
  6311           move al-uabon         to dedcyna
  6312           perform 9900-error-format
  6313                                 thru 9900-exit
  6314        end-if
  6315     end-if
  6316
  6317     if mainti = 'V'
  6318        if (vreasonl > zeros)
  6319           and (vreasoni (1:2) not = spaces)
  6320           continue
  6321        else
  6322           move er-3454          to emi-error
  6323           move -1               to vreasonl
  6324           move al-uabon         to vreasona
  6325           perform 9900-error-format
  6326                                 thru 9900-exit
  6327        end-if
  6328     end-if
  6329     if (mainti = 'A')
  6330        and (pi-prev-paid > zeros)
  6331        and (pi-check-type = 'C')
  6332        move er-3459             to emi-error
  6333        move -1                  to maintl
  6334        move al-uabon            to mainta
  6335        perform 9900-error-format
  6336                                 thru 9900-exit
  6337     end-if
  6338     if mainti = 'A'
  6339        continue
  6340     else
  6341        IF MAINTI = 'S'
  6342           or pi-prev-maint = 'S'
  6343           GO TO 1100-EDIT-COMPLETE
  6344        end-if
  6345     end-if
  6346     IF EIBAID = DFHPF5
  6347        IF EMI-ERROR = ZEROS
  6348          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6349        ELSE
  6350          GO TO 1100-EDIT-COMPLETE.
  6351
  6352     IF EIBAID = DFHPF6
  6353        IF EMI-ERROR = ZEROS
  6354           GO TO 6300-BUILD-CERT-SCREEN
  6355         ELSE
  6356           GO TO 1100-EDIT-COMPLETE.
  6357
  6358     IF EIBAID = DFHPF7
  6359        IF EMI-ERROR = ZEROS
  6360           GO TO 6600-build-beneficiary-screen
  6361         ELSE
  6362           GO TO 1100-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 112
* EL677.cbl
  6363     if mainti = 'A'
  6364        if dedcynl not = zeros
  6365           if dedcyni <> pi-previous-deduct-comm
  6366              perform 6700-build-common
  6367                                 thru 6700-exit
  6368              MOVE WS-REFUND-AMOUNT
  6369                                 TO AMOUNTO
  6370              MOVE AL-UANON      TO PAYTO1A
  6371                                    PAYTO2A
  6372                                    PAYAD1A
  6373                                    PAYCTYA
  6374                                    paysta
  6375                                    PTOZIPA
  6376              GO TO 8100-send-initial-map
  6377           end-if
  6378        end-if
  6379     end-if
  6380*    if mainti = 'V'
  6381*       if (vreasonl > zeros)
  6382*          and (vreasoni (1:2) not = spaces)
  6383*          continue
  6384*       else
  6385*          move er-3454          to emi-error
  6386*          move -1               to vreasonl
  6387*          move al-uabon         to vreasona
  6388*          perform 9900-error-format
  6389*                                thru 9900-exit
  6390*       end-if
  6391*    end-if
  6392     IF MAINTI = 'A'
  6393        if (payto1i not = spaces and low-values)
  6394           and (payad1i not = spaces and low-values)
  6395           and (payctyi not = spaces and low-values)
  6396           and (paysti not = spaces and low-values)
  6397           and (ptozipi not = spaces and low-values)
  6398           continue
  6399        else
  6400           MOVE -1               TO PAYTO1L
  6401           MOVE ER-2907          TO EMI-ERROR
  6402           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6403        end-if
  6404     end-if
  6405
  6406     IF MAINTI = 'A'
  6407         IF EIBAID NOT = DFHPF4
  6408             MOVE DFHENTER       TO  EIBAID
  6409             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6410
  6411     IF MAINTI = 'S' OR 'V'
  6412         GO TO 1100-EDIT-COMPLETE.
  6413
  6414     IF PRINTEDL GREATER THAN +0
  6415         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6416         PERFORM 8700-DEEDIT
  6417         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6418             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6419             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6420             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 113
* EL677.cbl
  6421             MOVE '4'                TO  DC-OPTION-CODE
  6422             PERFORM 8500-DATE-CONVERT
  6423             IF DC-ERROR-CODE NOT = SPACES
  6424                 MOVE ER-3046        TO  EMI-ERROR
  6425                 PERFORM 9900-ERROR-FORMAT
  6426                 MOVE -1             TO  PRINTEDL
  6427                 MOVE AL-UABON       TO  PRINTEDA
  6428                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6429             ELSE
  6430                 MOVE AL-UANON       TO  PRINTEDA
  6431                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6432         ELSE
  6433             MOVE ER-3046        TO  EMI-ERROR
  6434             PERFORM 9900-ERROR-FORMAT
  6435             MOVE -1             TO  PRINTEDL
  6436             MOVE AL-UABON       TO  PRINTEDA
  6437             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
  6438
  6439     IF AMOUNTL = ZEROS
  6440         GO TO 1050-CK-AMT.
  6441
  6442*    EXEC CICS BIF DEEDIT
  6443*        FIELD   (AMOUNTI)
  6444*        LENGTH  (11)
  6445*    END-EXEC.
  6446
  6447     IF AMOUNTI NOT NUMERIC     OR
  6448        AMOUNTI LESS THAN ZERO  OR
  6449       (AMOUNTI = ZEROS  AND
  6450               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6451          MOVE ER-1159            TO  EMI-ERROR
  6452          MOVE -1                 TO  AMOUNTL
  6453          MOVE AL-UNBON           TO  AMOUNTA
  6454          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6455          GO TO 1100-EDIT-COMPLETE.
  6456
  6457     MOVE AMOUNTI                TO  WS-AM-WORK.
  6458
  6459     IF WS-AM-SIGN = SPACES
  6460         MOVE WS-AM-NUM          TO  WS-AMT
  6461         ADD 0                   TO  WS-AMT
  6462       ELSE
  6463         MOVE AMOUNTI            TO  WS-AMT
  6464         ADD 0                   TO  WS-AMT.
  6465
  6466     IF MAINTI = 'A'
  6467        IF EIBAID = DFHENTER
  6468           if (ws-amt + pi-prev-paid) >
  6469              (cm-lf-premium-amt + cm-lf-alt-premium-amt +
  6470                 cm-ah-premium-amt)
  6471              move zeros to ws-amt
  6472           end-if
  6473        end-if
  6474     end-if
  6475      MOVE WS-AMT                TO  AMOUNTO.
  6476      MOVE AL-UNNON              TO  AMOUNTA.
  6477
  6478 1050-CK-AMT.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 114
* EL677.cbl
  6479     IF AMOUNTL = ZEROS AND
  6480        MAINTI  = 'A'
  6481         MOVE ER-1159            TO  EMI-ERROR
  6482         MOVE -1                 TO  AMOUNTL
  6483         MOVE AL-UNBON           TO  AMOUNTA
  6484         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6485
  6486*    MOVE AL-UANON              TO  TYPEA.
  6487     if (amountl <> zeros)
  6488        if (ws-amt <= zeros)
  6489           and (pi-check-type <> 'C')
  6490           MOVE ER-9999          TO EMI-ERROR
  6491           MOVE -1               TO AMOUNTL
  6492           MOVE AL-UNBON         TO AMOUNTA
  6493           PERFORM 9900-ERROR-FORMAT
  6494                                 THRU 9900-EXIT
  6495        end-if
  6496     end-if
  6497     IF TYPEL GREATER THAN ZEROS
  6498         IF TYPEI = 'R' OR 'M' OR 'E' or 'C'
  6499             NEXT SENTENCE
  6500         ELSE
  6501             MOVE ER-3044    TO  EMI-ERROR
  6502             MOVE -1         TO  TYPEL
  6503             MOVE AL-PABON   TO  TYPEA
  6504             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6505     ELSE
  6506         IF MAINTI  = 'A'
  6507             MOVE ER-3044    TO  EMI-ERROR
  6508             MOVE -1         TO  TYPEL
  6509             MOVE AL-PABON   TO  TYPEA
  6510             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6511
  6512
  6513 1100-EDIT-COMPLETE.
  6514
  6515     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6516       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6517        EIBAID NOT = DFHPF4)
  6518         GO TO 8200-SEND-DATAONLY.
  6519
  6520     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6521
  6522     IF MAINTI = 'A'
  6523         GO TO 2000-ADD-RECORD.
  6524
  6525*    IF MAINTI = 'C' OR 'V'
  6526     IF MAINTI = 'V'
  6527         GO TO 3000-CHANGE-RECORD.
  6528
  6529     IF MAINTI = 'S' or 'C'
  6530         GO TO 5000-BROWSE-FILE.
  6531
  6532     if mainti = 'D'
  6533        go to 3400-delete-record
  6534     end-if
  6535     .
  6536 1200-VERIFY-CARRIER-ID.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 115
* EL677.cbl
  6537     MOVE SPACES                 TO ELCNTL-KEY.
  6538     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6539     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6540     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6541     MOVE +0                     TO ELCNTL-SEQ.
  6542
  6543
  6544* EXEC CICS HANDLE CONDITION
  6545*        NOTFND   (1290-NO-CARRIER)
  6546*    END-EXEC.
  6547*    MOVE '"$I                   ! $ #00006388' TO DFHEIV0
  6548     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6550     MOVE X'2420233030303036333838' TO DFHEIV0(25:11)
  6551     CALL 'kxdfhei1' USING DFHEIV0
  6552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6553
  6554
  6555
  6556* EXEC CICS READ
  6557*        DATASET   (ELCNTL-FILE-ID)
  6558*        SET       (ADDRESS OF CONTROL-FILE)
  6559*        RIDFLD    (ELCNTL-KEY)
  6560*    END-EXEC.
  6561*    MOVE '&"S        E          (   #00006392' TO DFHEIV0
  6562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6564     MOVE X'2020233030303036333932' TO DFHEIV0(25:11)
  6565     CALL 'kxdfhei1' USING DFHEIV0,
  6566           ELCNTL-FILE-ID,
  6567           DFHEIV20,
  6568           DFHEIV99,
  6569           ELCNTL-KEY,
  6570           DFHEIV99,
  6571           DFHEIV99,
  6572           DFHEIV99
  6573     SET ADDRESS OF CONTROL-FILE TO
  6574         DFHEIV20
  6575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6576
  6577
  6578     GO TO 1200-EXIT.
  6579
  6580 1290-NO-CARRIER.
  6581     MOVE ER-2208                TO EMI-ERROR.
  6582     MOVE -1                     TO CARRIERL.
  6583     MOVE AL-UABON               TO CARRIERA.
  6584     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6585
  6586 1200-EXIT.
  6587      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 116
* EL677.cbl
  6589 1300-VERIFY-STATE-ID.
  6590     MOVE SPACES                 TO ELCNTL-KEY.
  6591     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6592     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6593     MOVE STATEI                 TO ELCNTL-STATE.
  6594     MOVE +0                     TO ELCNTL-SEQ.
  6595
  6596
  6597* EXEC CICS HANDLE CONDITION
  6598*        NOTFND   (1380-NO-STATE)
  6599*    END-EXEC.
  6600*    MOVE '"$I                   ! % #00006416' TO DFHEIV0
  6601     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6603     MOVE X'2520233030303036343136' TO DFHEIV0(25:11)
  6604     CALL 'kxdfhei1' USING DFHEIV0
  6605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6606
  6607
  6608
  6609* EXEC CICS READ
  6610*        DATASET   (ELCNTL-FILE-ID)
  6611*        SET       (ADDRESS OF CONTROL-FILE)
  6612*        RIDFLD    (ELCNTL-KEY)
  6613*    END-EXEC.
  6614*    MOVE '&"S        E          (   #00006420' TO DFHEIV0
  6615     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6617     MOVE X'2020233030303036343230' TO DFHEIV0(25:11)
  6618     CALL 'kxdfhei1' USING DFHEIV0,
  6619           ELCNTL-FILE-ID,
  6620           DFHEIV20,
  6621           DFHEIV99,
  6622           ELCNTL-KEY,
  6623           DFHEIV99,
  6624           DFHEIV99,
  6625           DFHEIV99
  6626     SET ADDRESS OF CONTROL-FILE TO
  6627         DFHEIV20
  6628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6629
  6630
  6631     GO TO 1390-EXIT.
  6632
  6633 1380-NO-STATE.
  6634     MOVE ER-2209                TO EMI-ERROR.
  6635     MOVE -1                     TO STATEL.
  6636     MOVE AL-UABON               TO STATEA.
  6637     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6638
  6639 1390-EXIT.
  6640      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 117
* EL677.cbl
  6642
  6643 1400-VERIFY-ACCOUNT.
  6644     IF EIBAID = DFHPF5
  6645         GO TO 1410-BUILD-ACCOUNT-KEY.
  6646
  6647     IF MAINTL GREATER +0
  6648         NEXT SENTENCE
  6649       ELSE
  6650         GO TO 1490-EXIT.
  6651
  6652*    IF MAINTI = 'A' OR 'C' OR 'V'
  6653     IF MAINTI = 'A' OR 'V'
  6654         NEXT SENTENCE
  6655       ELSE
  6656         GO TO 1490-EXIT.
  6657
  6658 1410-BUILD-ACCOUNT-KEY.
  6659     MOVE CARRIERI               TO ERACCT-CARRIER.
  6660     MOVE GROUPI                 TO ERACCT-GROUPING
  6661     MOVE STATEI                 TO ERACCT-STATE.
  6662     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6663     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6664
  6665     MOVE '2'                    TO DC-OPTION-CODE.
  6666     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6667
  6668     PERFORM 8500-DATE-CONVERT.
  6669     IF DATE-CONVERSION-ERROR
  6670        GO TO 1480-ACCOUNT-INVALID.
  6671
  6672     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6673    .
  6674 1420-get-eracct.
  6675     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6676
  6677
  6678* EXEC CICS HANDLE CONDITION
  6679*        NOTFND   (1480-ACCOUNT-INVALID)
  6680*        ENDFILE  (1480-ACCOUNT-INVALID)
  6681*    END-EXEC.
  6682*    MOVE '"$I''                  ! & #00006472' TO DFHEIV0
  6683     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6684     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6685     MOVE X'2620233030303036343732' TO DFHEIV0(25:11)
  6686     CALL 'kxdfhei1' USING DFHEIV0
  6687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6688
  6689
  6690
  6691* EXEC CICS STARTBR
  6692*        DATASET   (ERACCT-FILE-ID)
  6693*        RIDFLD    (ERACCT-KEY)
  6694*    END-EXEC.
  6695     MOVE 0
  6696       TO DFHEIV11
  6697*    MOVE '&,         G          &   #00006477' TO DFHEIV0
  6698     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6699     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 118
* EL677.cbl
  6700     MOVE X'2020233030303036343737' TO DFHEIV0(25:11)
  6701     CALL 'kxdfhei1' USING DFHEIV0,
  6702           ERACCT-FILE-ID,
  6703           ERACCT-KEY,
  6704           DFHEIV99,
  6705           DFHEIV11,
  6706           DFHEIV99
  6707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6708
  6709
  6710     set eracct-start to true
  6711     .
  6712 1420-READNEXT-ACCOUNT-MASTER.
  6713
  6714* EXEC CICS READNEXT
  6715*        DATASET   (ERACCT-FILE-ID)
  6716*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6717*        RIDFLD    (ERACCT-KEY)
  6718*    END-EXEC.
  6719     MOVE 0
  6720       TO DFHEIV11
  6721*    MOVE '&.S                   )   #00006485' TO DFHEIV0
  6722     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6723     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6724     MOVE X'2020233030303036343835' TO DFHEIV0(25:11)
  6725     CALL 'kxdfhei1' USING DFHEIV0,
  6726           ERACCT-FILE-ID,
  6727           DFHEIV20,
  6728           DFHEIV99,
  6729           ERACCT-KEY,
  6730           DFHEIV99,
  6731           DFHEIV11,
  6732           DFHEIV99,
  6733           DFHEIV99
  6734     SET ADDRESS OF ACCOUNT-MASTER TO
  6735         DFHEIV20
  6736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6737
  6738
  6739*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6740*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6741*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6742*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6743*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6744*         GO TO 1480-ACCOUNT-INVALID.
  6745*
  6746*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6747*        GO TO 1480-ACCOUNT-INVALID.
  6748*
  6749*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6750*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6751
  6752     evaluate true
  6753        when (save-eracct-key (1:20) not =
  6754           am-control-primary (1:20))
  6755           and (not eracct-found)
  6756           go to 1480-account-invalid
  6757        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 119
* EL677.cbl
  6758           am-control-primary (1:20))
  6759           and (eracct-found)
  6760           move ws-hold-eracct-record
  6761                                 to account-master
  6762        when (sv-acct-exp-date < am-effective-dt)
  6763           and (not eracct-found)
  6764           go to 1480-account-invalid
  6765        when sv-acct-exp-date >= am-expiration-dt
  6766           go to 1420-readnext-account-master
  6767        when am-expiration-dt = high-values
  6768           continue
  6769        when other
  6770           set eracct-found to true
  6771           move account-master   to ws-hold-eracct-record
  6772           go to 1420-readnext-account-master
  6773     end-evaluate
  6774     if eracct-start
  6775
  6776* exec cics endbr
  6777*          dataset  (eracct-file-id)
  6778*       end-exec
  6779     MOVE 0
  6780       TO DFHEIV11
  6781*    MOVE '&2                    $   #00006527' TO DFHEIV0
  6782     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6783     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6784     MOVE X'2020233030303036353237' TO DFHEIV0(25:11)
  6785     CALL 'kxdfhei1' USING DFHEIV0,
  6786           eracct-file-id,
  6787           DFHEIV11,
  6788           DFHEIV99
  6789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6790     end-if
  6791*    if am-expiration-dt = high-values
  6792*       continue
  6793*    else
  6794*       move account-master      to ws-hold-eracct-record
  6795*       go to 1420-readnext-account-master
  6796*    end-if
  6797     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6798     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6799     MOVE AM-STATE               TO PI-CR-STATE.
  6800     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6801
  6802     MOVE AM-NAME                TO PI-AM-NAME.
  6803     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6804     MOVE AM-CITY                TO PI-AM-CITY-st
  6805     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6806     move am-csr-code            to pi-am-csr
  6807
  6808     MOVE +0                     TO WS-SUB.
  6809
  6810 1430-FIND-ACC-AGT.
  6811     ADD +1                      TO WS-SUB.
  6812
  6813     IF  WS-SUB GREATER +10
  6814         GO TO 1480-ACCOUNT-INVALID.
  6815
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 120
* EL677.cbl
  6816     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F')
  6817         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6818       ELSE
  6819         GO TO 1430-FIND-ACC-AGT.
  6820
  6821     MOVE AL-UANON               TO CARRIERA
  6822                                    GROUPA
  6823                                    STATEA.
  6824
  6825     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6826
  6827     GO TO 1490-EXIT.
  6828
  6829 1480-ACCOUNT-INVALID.
  6830     MOVE -1                     TO CARRIERL
  6831     MOVE AL-UANON               TO CARRIERA
  6832                                    GROUPA
  6833                                    STATEA
  6834                                    ACCTA.
  6835     MOVE ER-2210                TO EMI-ERROR.
  6836     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6837     GO TO 8200-SEND-DATAONLY.
  6838
  6839 1490-EXIT.
  6840      EXIT.
  6841
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 121
* EL677.cbl
  6843 1500-VERIFY-PENDING-BUS-REC.
  6844     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6845     if pi-corr-check
  6846        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW
  6847        go to 1590-exit
  6848     end-if
  6849
  6850* EXEC CICS HANDLE CONDITION
  6851*        NOTFND   (1590-EXIT)
  6852*    END-EXEC.
  6853*    MOVE '"$I                   ! '' #00006589' TO DFHEIV0
  6854     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6855     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6856     MOVE X'2720233030303036353839' TO DFHEIV0(25:11)
  6857     CALL 'kxdfhei1' USING DFHEIV0
  6858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6859
  6860
  6861
  6862     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6863     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6864     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6865     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6866     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6867     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6868     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6869     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6870     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6871     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6872
  6873     IF ST-ACCNT-CNTL  OR
  6874        ACCNT-CNTL
  6875          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6876
  6877     IF ST-ACCNT-CNTL      OR
  6878        CARR-ST-ACCNT-CNTL OR
  6879        ACCNT-CNTL         OR
  6880        CARR-ACCNT-CNTL
  6881          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6882
  6883     IF ACCNT-CNTL OR
  6884        CARR-ACCNT-CNTL
  6885          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6886
  6887
  6888* EXEC CICS READ
  6889*         DATASET   (ERPNDB-ALT-FILE-ID)
  6890*         SET       (ADDRESS OF PENDING-BUSINESS)
  6891*         RIDFLD    (ERPNDB-ALT-KEY)
  6892*     END-EXEC.
  6893*    MOVE '&"S        E          (   #00006619' TO DFHEIV0
  6894     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6896     MOVE X'2020233030303036363139' TO DFHEIV0(25:11)
  6897     CALL 'kxdfhei1' USING DFHEIV0,
  6898           ERPNDB-ALT-FILE-ID,
  6899           DFHEIV20,
  6900           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 122
* EL677.cbl
  6901           ERPNDB-ALT-KEY,
  6902           DFHEIV99,
  6903           DFHEIV99,
  6904           DFHEIV99
  6905     SET ADDRESS OF PENDING-BUSINESS TO
  6906         DFHEIV20
  6907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6908
  6909
  6910     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6911
  6912     IF PB-C-PAYEE-CODE GREATER SPACES
  6913        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6914
  6915     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6916*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6917
  6918     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6919     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6920
  6921     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6922         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6923     ELSE
  6924         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6925
  6926*    IF MAINTI = 'A' OR 'C'
  6927*      IF PB-C-REFUND-CREATED
  6928*          MOVE -1               TO  MAINTL
  6929*          MOVE ER-3445          TO  EMI-ERROR
  6930*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6931
  6932 1590-EXIT.
  6933      EXIT.
  6934
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 123
* EL677.cbl
  6936 2000-ADD-RECORD.
  6937
  6938* EXEC CICS GETMAIN
  6939*        SET      (ADDRESS OF CHECK-RECORDS)
  6940*        LENGTH   (600)
  6941*        INITIMG  (GETMAIN-SPACE)
  6942*    END-EXEC.
  6943     MOVE 600
  6944       TO DFHEIV11
  6945*    MOVE ',"IL                  $   #00006652' TO DFHEIV0
  6946     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6947     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6948     MOVE X'2020233030303036363532' TO DFHEIV0(25:11)
  6949     CALL 'kxdfhei1' USING DFHEIV0,
  6950           DFHEIV20,
  6951           DFHEIV11,
  6952           GETMAIN-SPACE
  6953     SET ADDRESS OF CHECK-RECORDS TO
  6954         DFHEIV20
  6955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6956
  6957
  6958     MOVE 'CH'                   TO CH-RECORD-ID.
  6959     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6960     MOVE CARRIERI               TO CH-CARRIER.
  6961     MOVE GROUPI                 TO CH-GROUPING.
  6962     MOVE STATEI                 TO CH-STATE.
  6963     MOVE ACCTI                  TO CH-ACCOUNT.
  6964
  6965     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6966     MOVE '2'                    TO DC-OPTION-CODE.
  6967     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6968     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6969
  6970     MOVE CERTNOI                TO CH-CERT-PRIME.
  6971     MOVE SFXI                   TO CH-CERT-SFX.
  6972
  6973     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6974
  6975     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6976                                    ch-released-by
  6977     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6978
  6979     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6980     MOVE '5'                    TO DC-OPTION-CODE.
  6981     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6982     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6983                                    ch-released-dt
  6984
  6985     move 'P'                    to ch-approval-status
  6986
  6987     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6988                                    CH-VOID-DT
  6989                                    CH-CREDIT-ACCEPT-DT
  6990                                    CH-CANC-DT
  6991                                    ch-approval-dt
  6992                                    ch-check-cashed-dt
  6993     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 124
* EL677.cbl
  6994                                    CH-AH-REFUND
  6995*                                   CH-DEDUCT-WITHHELD
  6996*                                   CH-ADDITIONAL-CHARGE.
  6997
  6998     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  6999
  7000     if pi-prev-paid not numeric
  7001        move zeros               to pi-prev-paid
  7002     end-if
  7003     if pi-prev-paid-this-month not numeric
  7004        move zeros               to pi-prev-paid-this-month
  7005     end-if
  7006     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7007       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7008        EIBAID NOT = DFHPF4)
  7009         GO TO 8200-SEND-DATAONLY.
  7010
  7011     add ch-amount-paid to pi-prev-paid
  7012     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  7013     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  7014     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  7015     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  7016     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  7017     move pi-am-csr              to ch-csr
  7018     .
  7019 2100-WRITE-RECORD.
  7020
  7021* exec cics read
  7022*       dataset    (erchek-file-id)
  7023*       into       (ws-dummy-erchek)
  7024*       ridfld     (ch-control-primary)
  7025*       resp       (ws-response)
  7026*    end-exec
  7027     MOVE LENGTH OF
  7028      ws-dummy-erchek
  7029       TO DFHEIV11
  7030*    MOVE '&"IL       E          (  N#00006720' TO DFHEIV0
  7031     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7032     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7033     MOVE X'204E233030303036373230' TO DFHEIV0(25:11)
  7034     CALL 'kxdfhei1' USING DFHEIV0,
  7035           erchek-file-id,
  7036           ws-dummy-erchek,
  7037           DFHEIV11,
  7038           ch-control-primary,
  7039           DFHEIV99,
  7040           DFHEIV99,
  7041           DFHEIV99
  7042     MOVE EIBRESP  TO ws-response
  7043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7044     if RESP-NOTFND
  7045        continue
  7046     else
  7047        add +1 to ch-sequence-no
  7048        add 1 to seqi
  7049        go to 2100-write-record
  7050     end-if
  7051     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 125
* EL677.cbl
  7052
  7053* EXEC CICS HANDLE CONDITION
  7054*        DUPREC (2200-DUPREC)
  7055*    END-EXEC.
  7056*    MOVE '"$%                   ! ( #00006734' TO DFHEIV0
  7057     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7059     MOVE X'2820233030303036373334' TO DFHEIV0(25:11)
  7060     CALL 'kxdfhei1' USING DFHEIV0
  7061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7062
  7063
  7064     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  7065     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  7066                                    CH-CHECK-QUE-SEQUENCE
  7067
  7068
  7069* EXEC CICS WRITE
  7070*        DATASET  (ERCHEK-FILE-ID)
  7071*        FROM     (CHECK-RECORDS)
  7072*        RIDFLD   (CH-CONTROL-PRIMARY)
  7073*        resp     (ws-response)
  7074*    END-EXEC.
  7075     MOVE LENGTH OF
  7076      CHECK-RECORDS
  7077       TO DFHEIV11
  7078*    MOVE '&$ L                  ''  N#00006742' TO DFHEIV0
  7079     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7080     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7081     MOVE X'204E233030303036373432' TO DFHEIV0(25:11)
  7082     CALL 'kxdfhei1' USING DFHEIV0,
  7083           ERCHEK-FILE-ID,
  7084           CHECK-RECORDS,
  7085           DFHEIV11,
  7086           CH-CONTROL-PRIMARY,
  7087           DFHEIV99,
  7088           DFHEIV99
  7089     MOVE EIBRESP  TO ws-response
  7090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7091
  7092     if resp-normal and pi-check-type = 'C'
  7093        move 'Y'                 to pi-check-cut
  7094     end-if
  7095     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  7096             ERCHEK-RECORD-LENGTH + 23.
  7097
  7098     if pi-check-type not = 'C'
  7099        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7100                                 THRU 6200-EXIT
  7101        if resp-normal
  7102           MOVE 'Y'              TO PB-C-REFUND-SW
  7103           add +1 to pi-chek-rec-cnt
  7104           perform 6210-rewrite-pndb
  7105                                 thru 6210-exit
  7106*          PERFORM 2700-WRITE-SQL THRU 2700-EXIT
  7107        end-if
  7108     end-if
  7109*    PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 126
* EL677.cbl
  7110
  7111     IF EMI-NO-ERRORS
  7112         MOVE ER-0000            TO EMI-ERROR
  7113     ELSE
  7114         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7115            EIBAID = DFHPF4
  7116             MOVE ER-2600        TO EMI-ERROR.
  7117
  7118     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7119
  7120     MOVE LOW-VALUES             TO EL677AI.
  7121
  7122     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7123     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7124     MOVE PI-CHEK-STATE          TO STATEO.
  7125     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7126
  7127     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7128     MOVE SPACE                  TO DC-OPTION-CODE.
  7129     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7130     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7131
  7132     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7133     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7134     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7135
  7136     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7137                                    ACCTA     EFFDTA  CERTNOA
  7138                                    SFXA.
  7139     MOVE AL-UNNON               TO SEQA.
  7140     go to 5000-browse-file
  7141     GO TO 8100-SEND-INITIAL-MAP.
  7142
  7143 2200-DUPREC.
  7144     ADD +1 TO CH-SEQUENCE-NO.
  7145     MOVE CH-SEQUENCE-NO         TO SEQO
  7146                                    PI-CHEK-SEQUENCE
  7147                                    CHEK-RECORD-SEQ.
  7148     GO TO 2100-WRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 127
* EL677.cbl
  7150
  7151 2500-WRITE-PAY-ADJ.
  7152
  7153     PERFORM 2600-READ-CONTROL-FILE THRU 2600-EXIT.
  7154
  7155     IF CH-AMOUNT-PAID = ZEROS
  7156         GO TO 2510-CONTINUE.
  7157     PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.
  7158     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  7159
  7160 2510-CONTINUE.
  7161
  7162     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  7163         GO TO 2580-HANDLE-ELCNTL-FILE.
  7164
  7165 2550-BUILD-ERPYAJ-RECORD.
  7166
  7167
  7168* EXEC CICS GETMAIN
  7169*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7170*        LENGTH  (200)
  7171*        INITIMG (GETMAIN-SPACE)
  7172*    END-EXEC.
  7173     MOVE 200
  7174       TO DFHEIV11
  7175*    MOVE ',"IL                  $   #00006823' TO DFHEIV0
  7176     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7177     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7178     MOVE X'2020233030303036383233' TO DFHEIV0(25:11)
  7179     CALL 'kxdfhei1' USING DFHEIV0,
  7180           DFHEIV20,
  7181           DFHEIV11,
  7182           GETMAIN-SPACE
  7183     SET ADDRESS OF PENDING-PAY-ADJ TO
  7184         DFHEIV20
  7185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7186
  7187
  7188     MOVE SPACES                 TO PENDING-PAY-ADJ.
  7189     MOVE 'PY'                   TO PY-RECORD-ID.
  7190     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7191
  7192     MOVE CARRIERI               TO PY-CARRIER.
  7193     IF PI-ZERO-CARRIER  OR
  7194        PI-ZERO-CAR-GROUP
  7195         MOVE ZERO               TO PY-CARRIER.
  7196
  7197     MOVE GROUPI                 TO PY-GROUPING.
  7198     IF PI-ZERO-GROUPING  OR
  7199        PI-ZERO-CAR-GROUP
  7200         MOVE ZERO               TO PY-GROUPING.
  7201
  7202     MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.
  7203     MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.
  7204     MOVE 'C'                    TO PY-RECORD-TYPE.
  7205     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7206
  7207     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 128
* EL677.cbl
  7208                                    WS-PY-REF-DATE
  7209                                    WS-PY-END-DATE
  7210                                    WS-PY-DED-DATE
  7211                                    WS-PY-ADDL-DATE.
  7212     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7213     MOVE CERTNOI                TO WS-PY-CURRENT-CERT
  7214                                    WS-PY-REF-CERT
  7215                                    WS-PY-END-CERT
  7216                                    WS-PY-DED-CERT
  7217                                    WS-PY-ADDL-CERT
  7218                                    WS-TMS-PY-CERT.
  7219     IF SFXI NOT = LOW-VALUES
  7220         MOVE SFXI               TO WS-PY-CURRENT-SUFFIX
  7221                                    WS-PY-REF-SUFFIX
  7222                                    WS-PY-END-SUFFIX
  7223                                    WS-PY-DED-SUFFIX
  7224                                    WS-PY-ADDL-SUFFIX
  7225     ELSE
  7226         MOVE SPACE              TO WS-PY-CURRENT-SUFFIX
  7227                                    WS-PY-REF-SUFFIX
  7228                                    WS-PY-END-SUFFIX
  7229                                    WS-PY-DED-SUFFIX
  7230                                    WS-PY-ADDL-SUFFIX.
  7231
  7232     IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'
  7233         MOVE WS-TMS-ENTRY-COMMENT
  7234                                 TO PY-ENTRY-COMMENT
  7235     ELSE
  7236         IF TYPEI EQUAL 'R'
  7237             MOVE WS-PY-REF-COMMENT
  7238                                 TO PY-ENTRY-COMMENT
  7239         ELSE
  7240             IF TYPEI EQUAL 'E'
  7241                 MOVE WS-PY-END-COMMENT
  7242                                 TO PY-ENTRY-COMMENT
  7243             ELSE
  7244                 MOVE WS-PY-ENTRY-COMMENT
  7245                                 TO PY-ENTRY-COMMENT.
  7246
  7247     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.
  7248
  7249     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7250     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7251     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7252                                    PY-INPUT-DT.
  7253*    MOVE +0                     TO PY-CHECK-QUE-CONTROL
  7254*                                   PY-CHECK-QUE-SEQUENCE.
  7255     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7256                                    PY-REPORTED-DT
  7257                                    PY-CHECK-WRITTEN-DT
  7258                                    PY-BILLED-DATE
  7259                                    PY-AR-DATE
  7260                                    PY-GL-DATE.
  7261     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7262     MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.
  7263*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7264
  7265     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 129
* EL677.cbl
  7266         MOVE 'B'                TO PY-PYMT-TYPE
  7267         MOVE 'A'                TO PY-PMT-APPLIED.
  7268
  7269 2559-BUILD-EXIT.
  7270     EXIT.
  7271
  7272 2570-WRITE-ERPYAJ-RECORD.
  7273
  7274
  7275* EXEC CICS HANDLE CONDITION
  7276*        DUPREC (2577-DUPREC)
  7277*    END-EXEC.
  7278*    MOVE '"$%                   ! ) #00006915' TO DFHEIV0
  7279     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7280     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7281     MOVE X'2920233030303036393135' TO DFHEIV0(25:11)
  7282     CALL 'kxdfhei1' USING DFHEIV0
  7283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7284
  7285
  7286
  7287* EXEC CICS WRITE
  7288*        DATASET (ERPYAJ-FILE-ID)
  7289*        FROM    (PENDING-PAY-ADJ)
  7290*        RIDFLD  (PY-CONTROL-PRIMARY)
  7291*    END-EXEC.
  7292     MOVE LENGTH OF
  7293      PENDING-PAY-ADJ
  7294       TO DFHEIV11
  7295*    MOVE '&$ L                  ''   #00006919' TO DFHEIV0
  7296     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7297     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7298     MOVE X'2020233030303036393139' TO DFHEIV0(25:11)
  7299     CALL 'kxdfhei1' USING DFHEIV0,
  7300           ERPYAJ-FILE-ID,
  7301           PENDING-PAY-ADJ,
  7302           DFHEIV11,
  7303           PY-CONTROL-PRIMARY,
  7304           DFHEIV99,
  7305           DFHEIV99
  7306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7307
  7308
  7309     GO TO 2579-WRITE-EXIT.
  7310
  7311 2577-DUPREC.
  7312     ADD +1 TO PY-FILE-SEQ-NO.
  7313
  7314     GO TO 2570-WRITE-ERPYAJ-RECORD.
  7315
  7316 2579-WRITE-EXIT.
  7317     EXIT.
  7318
  7319 2580-HANDLE-ELCNTL-FILE.
  7320
  7321     IF CR-CHECK-NO-AUTO-SEQ
  7322         PERFORM 2650-REWRITE-CONTROL-FILE THRU 2650-EXIT
  7323     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 130
* EL677.cbl
  7324
  7325* EXEC CICS UNLOCK
  7326*            DATASET (ELCNTL-FILE-ID)
  7327*        END-EXEC.
  7328*    MOVE '&*                    #   #00006940' TO DFHEIV0
  7329     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7330     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7331     MOVE X'2020233030303036393430' TO DFHEIV0(25:11)
  7332     CALL 'kxdfhei1' USING DFHEIV0,
  7333           ELCNTL-FILE-ID,
  7334           DFHEIV99
  7335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7336
  7337
  7338 2590-EXIT.
  7339      EXIT.
  7340
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 131
* EL677.cbl
  7342
  7343 2600-READ-CONTROL-FILE.
  7344     MOVE SPACES                 TO ELCNTL-KEY.
  7345     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  7346     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7347     MOVE +0                     TO ELCNTL-SEQ.
  7348
  7349
  7350* EXEC CICS HANDLE CONDITION
  7351*        NOTFND   (2600-NO-CO-MASTER)
  7352*    END-EXEC.
  7353*    MOVE '"$I                   ! * #00006955' TO DFHEIV0
  7354     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7355     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7356     MOVE X'2A20233030303036393535' TO DFHEIV0(25:11)
  7357     CALL 'kxdfhei1' USING DFHEIV0
  7358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7359
  7360
  7361
  7362* EXEC CICS READ
  7363*        DATASET   (ELCNTL-FILE-ID)
  7364*        SET       (ADDRESS OF CONTROL-FILE)
  7365*        RIDFLD    (ELCNTL-KEY)
  7366*    END-EXEC.
  7367*    MOVE '&"S        E          (   #00006959' TO DFHEIV0
  7368     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7369     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7370     MOVE X'2020233030303036393539' TO DFHEIV0(25:11)
  7371     CALL 'kxdfhei1' USING DFHEIV0,
  7372           ELCNTL-FILE-ID,
  7373           DFHEIV20,
  7374           DFHEIV99,
  7375           ELCNTL-KEY,
  7376           DFHEIV99,
  7377           DFHEIV99,
  7378           DFHEIV99
  7379     SET ADDRESS OF CONTROL-FILE TO
  7380         DFHEIV20
  7381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7382
  7383
  7384     GO TO 2600-EXIT
  7385
  7386     .
  7387 2600-NO-CO-MASTER.
  7388     MOVE ER-0022                TO  EMI-ERROR.
  7389     MOVE -1                     TO  CARRIERL.
  7390     MOVE AL-UABON               TO  CARRIERA.
  7391     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7392
  7393 2600-EXIT.
  7394      EXIT.
  7395
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 132
* EL677.cbl
  7397 2650-REWRITE-CONTROL-FILE.
  7398
  7399* EXEC CICS READ
  7400*        DATASET   (ELCNTL-FILE-ID)
  7401*        SET       (ADDRESS OF CONTROL-FILE)
  7402*        RIDFLD    (ELCNTL-KEY)
  7403*        UPDATE
  7404*    END-EXEC.
  7405*    MOVE '&"S        EU         (   #00006979' TO DFHEIV0
  7406     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7407     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7408     MOVE X'2020233030303036393739' TO DFHEIV0(25:11)
  7409     CALL 'kxdfhei1' USING DFHEIV0,
  7410           ELCNTL-FILE-ID,
  7411           DFHEIV20,
  7412           DFHEIV99,
  7413           ELCNTL-KEY,
  7414           DFHEIV99,
  7415           DFHEIV99,
  7416           DFHEIV99
  7417     SET ADDRESS OF CONTROL-FILE TO
  7418         DFHEIV20
  7419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7420
  7421
  7422
  7423* EXEC CICS REWRITE
  7424*         DATASET (ELCNTL-FILE-ID)
  7425*         FROM    (CONTROL-FILE)
  7426*     END-EXEC.
  7427     MOVE LENGTH OF
  7428      CONTROL-FILE
  7429       TO DFHEIV11
  7430*    MOVE '&& L                  %   #00006986' TO DFHEIV0
  7431     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7432     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7433     MOVE X'2020233030303036393836' TO DFHEIV0(25:11)
  7434     CALL 'kxdfhei1' USING DFHEIV0,
  7435           ELCNTL-FILE-ID,
  7436           CONTROL-FILE,
  7437           DFHEIV11,
  7438           DFHEIV99
  7439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7440
  7441
  7442 2650-EXIT.
  7443      EXIT.
  7444 2700-WRITE-SQL.
  7445     perform 2710-build-rec      thru 2710-exit
  7446     perform 2720-insert-row     thru 2720-exit
  7447     perform 4300-FINISH-UP-DB   thru 4300-exit
  7448     .
  7449 2700-EXIT.
  7450     EXIT.
  7451 2710-BUILD-REC.
  7452     move spaces                 to daily-check-request-rec
  7453     move pi-company-id          to db-compid
  7454     move ch-carrier             to db-carrier
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 133
* EL677.cbl
  7455                                    db-fincar
  7456     move ch-grouping            to db-grouping
  7457                                    db-fingrp
  7458     move ch-state               to db-state
  7459     move ch-account             to db-account
  7460     move ch-cert-eff-dt         to dc-bin-date-1
  7461     move ' '                    to dc-option-code
  7462     perform 8500-date-convert   thru 8500-exit
  7463     if no-conversion-error
  7464        move dc-greg-date-a-edit to db-effdate
  7465     else
  7466        move spaces              to db-effdate
  7467     end-if
  7468     move ch-cert-prime          to db-certificate
  7469     move ch-cert-sfx            to db-cert-sfx
  7470     move ch-sequence-no         to db-seq-no
  7471     move '1'                    to db-type
  7472                                    db-check-sub-type
  7473     if pi-check-type = 'C'
  7474        move '2'                 to db-check-sub-type
  7475     end-if
  7476     move ch-amount-paid         to db-amount-n
  7477     move zeros                  to db-checkstatus
  7478     move ch-check-que-control   to db-releasebatch
  7479     move save-bin-date          to dc-bin-date-1
  7480     move ' '                    to dc-option-code
  7481     perform 8500-date-convert   thru 8500-exit
  7482     if no-conversion-error
  7483        move dc-greg-date-a-edit to db-releasedt
  7484     else
  7485        move spaces              to db-releasedt
  7486     end-if
  7487     move pi-processor-id        to db-releaseby
  7488     move ch-payee-name-1        to db-payeename1
  7489     move ch-payee-name-2        to db-payeename2
  7490     move ch-payee-address-1     to db-payeeaddr1
  7491     move ch-payee-address-2     to db-payeeaddr2
  7492     move ch-payee-city          to db-payeecity
  7493     move ch-payee-state         to db-payeest
  7494     move ch-payee-zip-code      to db-payeezip
  7495     move ch-comp-fin-resp       to db-finresp
  7496     move ch-comp-account        to db-finacct
  7497     move ch-recorded-by         to db-preparer
  7498     move ch-return-to           to db-return-to
  7499     move pi-table-name          to db-insured-name
  7500     .
  7501 2710-EXIT.
  7502     EXIT.
  7503 2720-INSERT-ROW.
  7504     if not connected-to-db
  7505        perform 4100-CONNECT-TO-DB
  7506                                 thru 4100-exit
  7507     end-if
  7508     EXEC SQL
  7509        INSERT into ChkApp_Check (
  7510           Company,
  7511           CertCarrier,
  7512           CertGroup,
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 134
* EL677.cbl
  7513           CertState,
  7514           CertAccount,
  7515           CertEffDate,
  7516           CertNumber,
  7517           CertNumberSuf,
  7518           CheckSeqNbr,
  7519           CheckType,
  7520           CheckAmount,
  7521           ReleaseBatchNbr,
  7522           ReleaseDate,
  7523           ReleasedBy,
  7524           PayeeName1,
  7525           PayeeName2,
  7526           PayeeAddress1,
  7527           PayeeAddress2,
  7528           PayeeCity,
  7529           PayeeState,
  7530           PayeeZip,
  7531           CompCarrier,
  7532           CompGroup,
  7533           CompFinResp,
  7534           CompAccount,
  7535           Preparer,
  7536           ReturnTo,
  7537           InsuredName,
  7538           CheckSubType)
  7539         VALUES (
  7540           :DB-CompId,
  7541           :DB-Carrier,
  7542           :DB-Grouping,
  7543           :DB-State,
  7544           :DB-Account,
  7545           :DB-EffDate,
  7546           :DB-Certificate,
  7547           :db-cert-sfx,
  7548           :DB-Seq-No,
  7549           :DB-Type,
  7550           :db-amount,
  7551           :db-releasebatch,
  7552           :db-releasedt,
  7553           :db-releaseby,
  7554           :db-payeename1,
  7555           :db-payeename2,
  7556           :db-payeeaddr1,
  7557           :db-payeeaddr2,
  7558           :db-payeecity,
  7559           :db-payeest,
  7560           :db-payeezip,
  7561           :db-fincar,
  7562           :db-fingrp,
  7563           :db-finresp,
  7564           :db-finacct,
  7565           :db-preparer,
  7566           :db-return-to,
  7567           :db-insured-name,
  7568           :db-check-sub-type)
  7569     END-EXEC
  7570     if sqlcode = -2601
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 135
* EL677.cbl
  7571        add +1                   to ch-sequence-no
  7572        move ch-sequence-no      to DB-Seq-No
  7573        go to 2720-insert-row
  7574     end-if
  7575     if sqlcode not = 0
  7576        display "Error: cannot insert row "
  7577        display ' sql return code ' sqlcode
  7578        move sqlcode to ws-sql-code
  7579        move ws-sql-code to ws-dis-sql-code
  7580        display ' dis sql code ' ws-dis-sql-code
  7581        display ' sql err mess    ' sqlerrmc
  7582        move sqlcode to ws-sql-code
  7583        move ws-sql-code to ws-dis-sql-code
  7584        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7585           into EMI-MESSAGE-AREA (1)
  7586        end-string
  7587        display ' msga1 ' emi-message-area (1)
  7588        perform 4300-FINISH-UP-DB thru 4300-exit
  7589        go to 8200-send-dataonly
  7590*       goback
  7591     end-if
  7592     .
  7593 2720-EXIT.
  7594     EXIT.
  7595 3000-CHANGE-RECORD.
  7596
  7597* EXEC CICS HANDLE CONDITION
  7598*        NOTFND (3900-RECORD-NOTFND)
  7599*    END-EXEC.
  7600*    MOVE '"$I                   ! + #00007145' TO DFHEIV0
  7601     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7603     MOVE X'2B20233030303037313435' TO DFHEIV0(25:11)
  7604     CALL 'kxdfhei1' USING DFHEIV0
  7605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7606
  7607
  7608
  7609* EXEC CICS READ
  7610*        DATASET  (ERCHEK-FILE-ID)
  7611*        SET      (ADDRESS OF CHECK-RECORDS)
  7612*        RIDFLD   (PI-ERCHEK-KEY)
  7613*        UPDATE
  7614*    END-EXEC.
  7615*    MOVE '&"S        EU         (   #00007149' TO DFHEIV0
  7616     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7617     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7618     MOVE X'2020233030303037313439' TO DFHEIV0(25:11)
  7619     CALL 'kxdfhei1' USING DFHEIV0,
  7620           ERCHEK-FILE-ID,
  7621           DFHEIV20,
  7622           DFHEIV99,
  7623           PI-ERCHEK-KEY,
  7624           DFHEIV99,
  7625           DFHEIV99,
  7626           DFHEIV99
  7627     SET ADDRESS OF CHECK-RECORDS TO
  7628         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 136
* EL677.cbl
  7629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7630
  7631
  7632     IF CH-LF-REFUND NOT NUMERIC
  7633         MOVE ZEROS              TO CH-LF-REFUND.
  7634     IF CH-AH-REFUND NOT NUMERIC
  7635         MOVE ZEROS              TO CH-AH-REFUND.
  7636*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7637*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7638*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7639*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7640
  7641     IF VREASONL NOT = ZEROS
  7642         MOVE VREASONI           TO  CH-VOID-REASON.
  7643
  7644     IF MAINTI = 'V'
  7645        GO TO 3050-void-processing
  7646     end-if
  7647
  7648     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7649
  7650     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7651
  7652     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7653       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7654        EIBAID NOT = DFHPF4)
  7655         GO TO 8200-SEND-DATAONLY.
  7656     go to 3100-rewrite-record
  7657     .
  7658 3050-void-processing.
  7659     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7660     if sqlcode = 0
  7661        perform 4200-get-tbl-row thru 4200-exit
  7662        if sqlcode = 0
  7663           if nu-app-date = -1
  7664              move -1            to maintl
  7665              move er-3453       to emi-error
  7666              move al-uabon      to mainta
  7667              perform 9900-error-format
  7668                                 thru 9900-exit
  7669              perform 4300-FINISH-UP-DB thru 4300-exit
  7670              go to 8200-send-dataonly
  7671           end-if
  7672        end-if
  7673        if connected-to-db
  7674           perform 4300-FINISH-UP-DB thru 4300-exit
  7675        end-if
  7676     end-if
  7677     if (ch-check-written-dt = low-values)
  7678        or (ch-check-no = spaces)
  7679        move -1                  to maintl
  7680        move er-3455             to emi-error
  7681        move al-uabon            to mainta
  7682        perform 9900-error-format
  7683                                 thru 9900-exit
  7684        perform 4300-FINISH-UP-DB thru 4300-exit
  7685        go to 8200-send-dataonly
  7686     end-if
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 137
* EL677.cbl
  7687     .
  7688 3100-REWRITE-RECORD.
  7689     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7690
  7691     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7692     MOVE '5'                    TO DC-OPTION-CODE.
  7693     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7694
  7695     IF MAINTI = 'C'
  7696       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7697     end-if
  7698*      IF MANUAL-CHECK-WRITTEN
  7699*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.
  7700
  7701     IF MAINTI = 'V'
  7702        IF (CH-VOID-DT = LOW-VALUES)
  7703           and (pi-check-cashed = spaces)
  7704           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7705           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7706*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT
  7707           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7708           if pi-chek-rec-cnt = +1
  7709              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7710                                 THRU 6200-EXIT
  7711              if resp-normal
  7712                 MOVE ' '        TO PB-C-REFUND-SW
  7713                 perform 6210-rewrite-pndb
  7714                                 thru 6210-exit
  7715              end-if
  7716           end-if
  7717        ELSE
  7718           MOVE -1               TO MAINTL
  7719           MOVE ER-2583          TO EMI-ERROR
  7720           MOVE AL-UABON         TO MAINTA
  7721           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7722           GO TO 8200-SEND-DATAONLY
  7723        end-if
  7724     end-if
  7725
  7726     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7727
  7728
  7729* EXEC CICS REWRITE
  7730*        DATASET  (ERCHEK-FILE-ID)
  7731*        FROM     (CHECK-RECORDS)
  7732*    END-EXEC.
  7733     MOVE LENGTH OF
  7734      CHECK-RECORDS
  7735       TO DFHEIV11
  7736*    MOVE '&& L                  %   #00007252' TO DFHEIV0
  7737     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7738     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7739     MOVE X'2020233030303037323532' TO DFHEIV0(25:11)
  7740     CALL 'kxdfhei1' USING DFHEIV0,
  7741           ERCHEK-FILE-ID,
  7742           CHECK-RECORDS,
  7743           DFHEIV11,
  7744           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 138
* EL677.cbl
  7745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7746
  7747
  7748     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7749        (MAINTI EQUAL 'C')          AND
  7750        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7751            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7752
  7753     IF EMI-NO-ERRORS
  7754         MOVE ER-0000            TO EMI-ERROR
  7755     ELSE
  7756         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7757            EIBAID = DFHPF4
  7758             MOVE ER-2600        TO EMI-ERROR.
  7759
  7760     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7761
  7762     MOVE LOW-VALUES             TO EL677AI.
  7763
  7764     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7765     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7766     MOVE PI-CHEK-STATE          TO STATEO.
  7767     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7768
  7769     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7770     MOVE SPACE                  TO DC-OPTION-CODE.
  7771     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7772     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7773
  7774     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7775     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7776     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7777
  7778     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7779                                     ACCTA   EFFDTA
  7780                                    CERTNOA   SFXA.
  7781
  7782     MOVE AL-UNNON               TO SEQA.
  7783     go to 5000-browse-file
  7784*    GO TO 8100-SEND-INITIAL-MAP.
  7785
  7786     .
  7787 3200-PAY-ADJS-REVERSAL.
  7788
  7789     IF CH-AMOUNT-PAID NOT = ZEROS
  7790         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7791         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7792
  7793     GO TO 3290-EXIT
  7794     .
  7795 3250-BUILD-ERPYAJ-REVERSAL.
  7796
  7797
  7798* EXEC CICS GETMAIN
  7799*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7800*        LENGTH  (200)
  7801*        INITIMG (GETMAIN-SPACE)
  7802*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 139
* EL677.cbl
  7803     MOVE 200
  7804       TO DFHEIV11
  7805*    MOVE ',"IL                  $   #00007306' TO DFHEIV0
  7806     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7807     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7808     MOVE X'2020233030303037333036' TO DFHEIV0(25:11)
  7809     CALL 'kxdfhei1' USING DFHEIV0,
  7810           DFHEIV20,
  7811           DFHEIV11,
  7812           GETMAIN-SPACE
  7813     SET ADDRESS OF PENDING-PAY-ADJ TO
  7814         DFHEIV20
  7815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7816
  7817
  7818     MOVE 'PY'                   TO PY-RECORD-ID.
  7819     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7820
  7821     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7822     IF PI-ZERO-CARRIER  OR
  7823        PI-ZERO-CAR-GROUP
  7824         MOVE ZERO               TO PY-CARRIER.
  7825
  7826     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7827     IF PI-ZERO-GROUPING  OR
  7828        PI-ZERO-CAR-GROUP
  7829         MOVE ZERO               TO PY-GROUPING.
  7830
  7831     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7832     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7833     MOVE 'R'                    TO PY-RECORD-TYPE.
  7834     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7835     move '1825011300'           to py-gl-account
  7836     move 'VOID REFCK'           TO py-gl-comment
  7837     move ch-amount-paid         to py-entry-amt
  7838*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7839
  7840     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7841     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7842
  7843     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7844     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7845     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7846                                    PY-INPUT-DT.
  7847*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7848*                                   PY-CHECK-QUE-SEQUENCE.
  7849     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7850                                    PY-BILLED-DATE
  7851                                    PY-REPORTED-DT
  7852                                    PY-CHECK-WRITTEN-DT
  7853                                    PY-AR-DATE
  7854                                    PY-GL-DATE.
  7855     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7856     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7857*    MOVE 'V'                    TO PY-VOID-SW.
  7858*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7859
  7860     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 140
* EL677.cbl
  7861         MOVE 'B'                TO PY-PYMT-TYPE
  7862         MOVE 'A'                TO PY-PMT-APPLIED.
  7863
  7864 3259-BUILD-EXIT.
  7865     EXIT.
  7866
  7867 3280-WRITE-ERPYAJ-REVERSAL.
  7868
  7869
  7870* EXEC CICS HANDLE CONDITION
  7871*        DUPREC (3287-DUPREC)
  7872*    END-EXEC.
  7873*    MOVE '"$%                   ! , #00007363' TO DFHEIV0
  7874     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7875     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7876     MOVE X'2C20233030303037333633' TO DFHEIV0(25:11)
  7877     CALL 'kxdfhei1' USING DFHEIV0
  7878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7879
  7880
  7881
  7882* EXEC CICS WRITE
  7883*        DATASET (ERPYAJ-FILE-ID)
  7884*        FROM    (PENDING-PAY-ADJ)
  7885*        RIDFLD  (PY-CONTROL-PRIMARY)
  7886*    END-EXEC.
  7887     MOVE LENGTH OF
  7888      PENDING-PAY-ADJ
  7889       TO DFHEIV11
  7890*    MOVE '&$ L                  ''   #00007367' TO DFHEIV0
  7891     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7892     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7893     MOVE X'2020233030303037333637' TO DFHEIV0(25:11)
  7894     CALL 'kxdfhei1' USING DFHEIV0,
  7895           ERPYAJ-FILE-ID,
  7896           PENDING-PAY-ADJ,
  7897           DFHEIV11,
  7898           PY-CONTROL-PRIMARY,
  7899           DFHEIV99,
  7900           DFHEIV99
  7901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7902
  7903
  7904     GO TO 3289-WRITE-EXIT.
  7905
  7906 3287-DUPREC.
  7907     ADD +1 TO PY-FILE-SEQ-NO.
  7908
  7909     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7910
  7911 3289-WRITE-EXIT.
  7912     EXIT.
  7913
  7914 3290-EXIT.
  7915      EXIT.
  7916
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 141
* EL677.cbl
  7918 3300-UPDATE-ERPYAJ.
  7919
  7920
  7921* EXEC CICS GETMAIN
  7922*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7923*        LENGTH  (200)
  7924*        INITIMG (GETMAIN-SPACE)
  7925*    END-EXEC.
  7926     MOVE 200
  7927       TO DFHEIV11
  7928*    MOVE ',"IL                  $   #00007389' TO DFHEIV0
  7929     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7930     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7931     MOVE X'2020233030303037333839' TO DFHEIV0(25:11)
  7932     CALL 'kxdfhei1' USING DFHEIV0,
  7933           DFHEIV20,
  7934           DFHEIV11,
  7935           GETMAIN-SPACE
  7936     SET ADDRESS OF PENDING-PAY-ADJ TO
  7937         DFHEIV20
  7938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7939
  7940
  7941     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7942     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7943     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7944     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7945     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7946     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7947     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7948
  7949
  7950* EXEC CICS HANDLE CONDITION
  7951*        NOTFND   (3390-EXIT)
  7952*        ENDFILE  (3390-EXIT)
  7953*    END-EXEC.
  7954*    MOVE '"$I''                  ! - #00007403' TO DFHEIV0
  7955     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7957     MOVE X'2D20233030303037343033' TO DFHEIV0(25:11)
  7958     CALL 'kxdfhei1' USING DFHEIV0
  7959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7960
  7961
  7962 3320-READNEXT-ERPYAJ.
  7963
  7964
  7965* EXEC CICS READ
  7966*        DATASET  (ERPYAJ-FILE-ID)
  7967*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7968*        RIDFLD   (ERPYAJ-KEY)
  7969*        GTEQ
  7970*    END-EXEC.
  7971*    MOVE '&"S        G          (   #00007410' TO DFHEIV0
  7972     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7973     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7974     MOVE X'2020233030303037343130' TO DFHEIV0(25:11)
  7975     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 142
* EL677.cbl
  7976           ERPYAJ-FILE-ID,
  7977           DFHEIV20,
  7978           DFHEIV99,
  7979           ERPYAJ-KEY,
  7980           DFHEIV99,
  7981           DFHEIV99,
  7982           DFHEIV99
  7983     SET ADDRESS OF PENDING-PAY-ADJ TO
  7984         DFHEIV20
  7985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7986
  7987
  7988     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7989
  7990     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7991        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7992        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7993        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7994        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7995        (PY-RECORD-TYPE   NOT = 'C')
  7996          GO TO 3390-EXIT.
  7997
  7998     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7999         ADD +1 TO PYAJ-FILE-SEQ-NO
  8000         GO TO 3320-READNEXT-ERPYAJ.
  8001
  8002
  8003* EXEC CICS READ UPDATE
  8004*        DATASET   (ERPYAJ-FILE-ID)
  8005*        RIDFLD    (ERPYAJ-KEY)
  8006*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  8007*    END-EXEC.
  8008*    MOVE '&"S        EU         (   #00007431' TO DFHEIV0
  8009     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8010     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8011     MOVE X'2020233030303037343331' TO DFHEIV0(25:11)
  8012     CALL 'kxdfhei1' USING DFHEIV0,
  8013           ERPYAJ-FILE-ID,
  8014           DFHEIV20,
  8015           DFHEIV99,
  8016           ERPYAJ-KEY,
  8017           DFHEIV99,
  8018           DFHEIV99,
  8019           DFHEIV99
  8020     SET ADDRESS OF PENDING-PAY-ADJ TO
  8021         DFHEIV20
  8022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8023
  8024
  8025     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  8026     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  8027
  8028     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  8029
  8030     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  8031     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  8032     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  8033
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 143
* EL677.cbl
  8034
  8035* EXEC CICS REWRITE
  8036*        DATASET  (ERPYAJ-FILE-ID)
  8037*        FROM     (PENDING-PAY-ADJ)
  8038*    END-EXEC.
  8039     MOVE LENGTH OF
  8040      PENDING-PAY-ADJ
  8041       TO DFHEIV11
  8042*    MOVE '&& L                  %   #00007446' TO DFHEIV0
  8043     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8044     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8045     MOVE X'2020233030303037343436' TO DFHEIV0(25:11)
  8046     CALL 'kxdfhei1' USING DFHEIV0,
  8047           ERPYAJ-FILE-ID,
  8048           PENDING-PAY-ADJ,
  8049           DFHEIV11,
  8050           DFHEIV99
  8051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8052
  8053
  8054 3390-EXIT.
  8055      EXIT.
  8056
  8057 3400-delete-record.
  8058
  8059* EXEC CICS READ
  8060*        DATASET  (ERCHEK-FILE-ID)
  8061*        SET      (ADDRESS OF CHECK-RECORDS)
  8062*        RIDFLD   (PI-ERCHEK-KEY)
  8063*        UPDATE
  8064*        resp     (ws-response)
  8065*    END-EXEC
  8066*    MOVE '&"S        EU         (  N#00007455' TO DFHEIV0
  8067     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8068     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8069     MOVE X'204E233030303037343535' TO DFHEIV0(25:11)
  8070     CALL 'kxdfhei1' USING DFHEIV0,
  8071           ERCHEK-FILE-ID,
  8072           DFHEIV20,
  8073           DFHEIV99,
  8074           PI-ERCHEK-KEY,
  8075           DFHEIV99,
  8076           DFHEIV99,
  8077           DFHEIV99
  8078     SET ADDRESS OF CHECK-RECORDS TO
  8079         DFHEIV20
  8080     MOVE EIBRESP  TO ws-response
  8081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8082     if (ch-in-limbo or ch-approv-pending)
  8083        and (ch-void-dt = low-values)
  8084        and (ch-check-written-dt = low-values)
  8085        and (ch-credit-accept-dt = low-values)
  8086        perform 3500-check-tbl   thru 3500-exit
  8087        if (row-deleted and tbl-commited)
  8088*          or (emi-error = er-3450)
  8089
  8090* exec cics delete
  8091*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 144
* EL677.cbl
  8092*          end-exec
  8093*    MOVE '&(                    &   #00007469' TO DFHEIV0
  8094     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8095     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8096     MOVE X'2020233030303037343639' TO DFHEIV0(25:11)
  8097     CALL 'kxdfhei1' USING DFHEIV0,
  8098           erchek-file-id,
  8099           DFHEIV99,
  8100           DFHEIV99,
  8101           DFHEIV99,
  8102           DFHEIV99
  8103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8104           move spaces to pi-check-cut
  8105        end-if
  8106     else
  8107        move -1               to maintl
  8108        move er-3452          to emi-error
  8109        move al-uabon         to mainta
  8110        perform 9900-error-format
  8111                                 thru 9900-exit
  8112        go to 8200-send-dataonly
  8113     end-if
  8114     if pi-chek-rec-cnt = +1
  8115        PERFORM 6200-UPDATE-PENDING-BUS-REC
  8116                                 THRU 6200-EXIT
  8117        if resp-normal
  8118           MOVE ' '              TO PB-C-REFUND-SW
  8119           perform 6210-rewrite-pndb
  8120                                 thru 6210-exit
  8121        end-if
  8122     end-if
  8123     MOVE ER-0000            TO EMI-ERROR
  8124     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8125     MOVE LOW-VALUES             TO EL677AI.
  8126     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  8127     MOVE PI-CHEK-GROUPING       TO GROUPO.
  8128     MOVE PI-CHEK-STATE          TO STATEO.
  8129     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  8130     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  8131     MOVE SPACE                  TO DC-OPTION-CODE.
  8132     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8133     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  8134     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  8135     MOVE PI-CHEK-SUF-NO         TO SFXO.
  8136     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  8137     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8138                                    ACCTA   EFFDTA
  8139                                    CERTNOA   SFXA.
  8140     MOVE AL-UNNON               TO SEQA.
  8141     GO TO 8100-SEND-INITIAL-MAP
  8142     .
  8143 3400-exit.
  8144     exit.
  8145 3500-check-tbl.
  8146     perform 4100-CONNECT-TO-DB  thru 4100-exit
  8147*    if sqlcode = 0
  8148*       perform 4150-open-cursor    thru 4150-exit
  8149*    end-if
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 145
* EL677.cbl
  8150     if sqlcode = 0
  8151        perform 4200-get-tbl-row thru 4200-exit
  8152     end-if
  8153      if sqlcode = 0
  8154         if (nu-app-date = -1)
  8155            or (db-app-status = '2')
  8156            perform 4250-delete-row thru 4250-exit
  8157         else
  8158           MOVE ER-3452            TO  EMI-ERROR
  8159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8160           MOVE -1                 TO  PFENTERL
  8161           GO TO 8200-SEND-DATAONLY
  8162        end-if
  8163      else
  8164         MOVE ER-3450            TO  EMI-ERROR
  8165         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8166         MOVE -1                 TO  PFENTERL
  8167*        GO TO 8200-SEND-DATAONLY
  8168      end-if
  8169     if connected-to-db
  8170        perform 4300-FINISH-UP-DB thru 4300-exit
  8171     end-if
  8172     .
  8173 3500-exit.
  8174     exit.
  8175 3700-UPDATE-ERCHKQ.
  8176*    MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.
  8177*    MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.
  8178*    MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.
  8179*
  8180*    EXEC CICS HANDLE CONDITION
  8181*        NOTFND (3780-CHECK-NOTFND)
  8182*    END-EXEC.
  8183*
  8184*    EXEC CICS READ
  8185*        DATASET  (ERCHKQ-FILE-ID)
  8186*        SET      (ADDRESS OF CHECK-QUE)
  8187*        RIDFLD   (ERCHKQ-KEY)
  8188*        UPDATE
  8189*    END-EXEC.
  8190*
  8191*    IF MAINTI = 'C'
  8192*        IF MANUAL-CHECK-WRITTEN
  8193*            MOVE 'M'                 TO CQ-ENTRY-TYPE
  8194*            MOVE +1                  TO CQ-TIMES-PRINTED
  8195*            MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER
  8196*            MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT
  8197*            MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  8198*
  8199*    IF MAINTI = 'V'
  8200*        MOVE 'V'                TO CQ-ENTRY-TYPE
  8201*                                   CQ-VOID-INDICATOR
  8202*        MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.
  8203*
  8204*    MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.
  8205*
  8206*    EXEC CICS REWRITE
  8207*        DATASET  (ERCHKQ-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 146
* EL677.cbl
  8208*        FROM     (CHECK-QUE)
  8209*    END-EXEC.
  8210*
  8211*    GO TO 3790-EXIT.
  8212*
  8213*3780-CHECK-NOTFND.
  8214*    MOVE ER-2905                TO EMI-ERROR.
  8215*    MOVE -1                     TO CARRIERL
  8216*    MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8217*                                   ACCTA     EFFDTA  CERTNOA
  8218*                                   SFXA      SEQA.
  8219*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8220     .
  8221 3790-EXIT.
  8222      EXIT.
  8223
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 147
* EL677.cbl
  8225
  8226 3900-RECORD-NOTFND.
  8227     MOVE ER-2908                TO EMI-ERROR.
  8228     MOVE -1                     TO CARRIERL
  8229     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8230                                    ACCTA     EFFDTA  CERTNOA
  8231                                    SFXA      SEQA.
  8232     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8233     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 148
* EL677.cbl
  8235 4000-ADD-CHANGE.
  8236     IF PAYTO1L NOT = ZEROS
  8237        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8238     END-IF
  8239
  8240     IF PAYTO2L NOT = ZEROS
  8241         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8242
  8243     IF PAYAD1L NOT = ZEROS
  8244         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8245
  8246     IF PAYAD2L NOT = ZEROS
  8247         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8248
  8249     IF PAYctyL NOT = ZEROS
  8250         MOVE payctyi            TO CH-PAYEE-CITY.
  8251
  8252     IF PAYstL NOT = ZEROS
  8253         MOVE paysti            TO CH-PAYEE-state.
  8254
  8255     IF PAYEEI GREATER SPACES
  8256        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8257
  8258     IF PTOZIPL  =  ZEROS
  8259         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8260         GO TO 4000-CK-REST.
  8261
  8262     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8263
  8264     IF NOT WS-CANADIAN-POST-CODE
  8265         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8266         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8267         GO TO 4000-CK-REST.
  8268
  8269     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8270     IF WS-CAN-POST-4TH = SPACE OR '-'
  8271         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8272         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8273     ELSE
  8274         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8275         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8276
  8277 4000-CK-REST.
  8278
  8279     IF RETTOL NOT = ZEROS
  8280        MOVE RETTOI TO CH-RETURN-TO.
  8281     if dedcynl not = zeros
  8282        move dedcyni             to ch-deduct-commission
  8283     end-if
  8284*    if dedcynl not = zeros
  8285*       if (dedcyni = 'Y')
  8286*          or (pi-prev-ded-comm = 'Y')
  8287*          compute ws-amt =
  8288*             pi-refund-on-pending-rec -
  8289*                pi-prev-paid - pi-ue-comm
  8290*       else
  8291*          if dedcyni = 'N'
  8292*             compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 149
* EL677.cbl
  8293*                pi-refund-on-pending-rec -
  8294*                   pi-prev-paid-this-month
  8295*          end-if
  8296*       end-if
  8297*    end-if
  8298     if pi-check-type = 'C'
  8299        compute ws-amt =
  8300           pi-endt-prm-diff - pi-prev-paid
  8301        if (dedcyni = 'Y')
  8302           or (pi-prev-ded-comm = 'Y')
  8303           compute ws-amt =
  8304              ws-amt - pi-ue-comm
  8305        end-if
  8306        if ws-amt <= zeros
  8307           move pi-endt-prm-diff to ws-amt
  8308        end-if
  8309     end-if
  8310     IF AMOUNTL NOT = ZEROS
  8311         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8312         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8313
  8314     IF CHECKL NOT = ZEROS
  8315         MOVE CHECKI             TO CH-CHECK-NO.
  8316
  8317     IF REASONL NOT = ZEROS
  8318         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8319
  8320*    IF DEDAMTL NOT = ZEROS
  8321*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8322*                                   DEDAMTO.
  8323
  8324*    IF ADDLCHGL NOT = ZEROS
  8325*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8326*                                   ADDLCHGO.
  8327
  8328     IF STUBL NOT = ZEROS
  8329         MOVE STUBI              TO CH-STUB-LINE-1.
  8330
  8331     IF TEXT1L NOT = ZEROS
  8332         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8333
  8334     IF TEXT2L NOT = ZEROS
  8335         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8336
  8337     IF TEXT3L NOT = ZEROS
  8338         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8339
  8340     IF TYPEL NOT = ZEROS
  8341         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8342
  8343*    MOVE LETTER1I               TO CH-LETTERS (1).
  8344*    MOVE LETTER2I               TO CH-LETTERS (2).
  8345*    MOVE LETTER3I               TO CH-LETTERS (3).
  8346
  8347*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8348     IF CH-CHECK-ORIGIN-SW = 'R'
  8349         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8350*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 150
* EL677.cbl
  8351         MOVE PI-CANC-DT             TO CH-CANC-DT
  8352         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8353         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8354     end-if
  8355     MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8356*    IF PI-AR-PROCESSING AND
  8357*       REFL NOT = ZERO
  8358*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8359
  8360 4000-EXIT.
  8361      EXIT.
  8362 4100-CONNECT-TO-DB.
  8363     move 'NTSQLTST2_ChkApprv'   to svr
  8364     move 'sa'                   to usr
  8365     move 'sql2008r2'            to pass
  8366
  8367     if ws-kix-myenv = 'cid1p'
  8368        move 'NTCSO2_ChkApprv'   to svr
  8369        move 'sa'                to usr
  8370        move 'ntcso2'            to pass
  8371     end-if
  8372     string
  8373         usr delimited space
  8374         "." delimited size
  8375         pass delimited space into usr-pass
  8376     end-string
  8377     EXEC SQL
  8378        CONNECT TO :svr USER :usr-pass
  8379     END-EXEC
  8380     if sqlcode not = 0
  8381        display "Error: cannot connect "
  8382        display sqlcode
  8383        display sqlerrmc
  8384     end-if
  8385     set connected-to-db to true
  8386     .
  8387 4100-EXIT.
  8388     EXIT.
  8389 4150-open-cursor.
  8390     move pi-company-id          to ws-compid
  8391     move ch-carrier             to ws-carrier
  8392     move ch-grouping            to ws-grouping
  8393     move ch-state               to ws-state
  8394     move ch-account             to ws-account
  8395     move ch-cert-eff-dt         to dc-bin-date-1
  8396     move ' '                    to dc-option-code
  8397     perform 8500-date-convert   thru 8500-exit
  8398     if no-conversion-error
  8399        move dc-greg-date-a-edit to ws-eff-date
  8400     end-if
  8401     move ch-cert-prime          to ws-certificate
  8402     move ch-cert-sfx            to ws-cert-sfx
  8403     move ch-sequence-no         to ws-seq-no
  8404     move '1'                    to ws-type
  8405                                    ws-check-sub-type
  8406     if pi-check-type = 'C'
  8407        move '2'                 to ws-check-sub-type
  8408     end-if
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 151
* EL677.cbl
  8409     EXEC SQL
  8410        DECLARE
  8411           checkapp cursor for
  8412        SELECT
  8413           ApprovalStatus,
  8414           MaintainedBy,
  8415           MaintainedDate,
  8416           ApprovalBatch
  8417        FROM
  8418           ChkApp_Check
  8419        WHERE
  8420           Company           = :ws-compid
  8421           and CertCarrier   = :ws-carrier
  8422           and CertGroup     = :ws-grouping
  8423           and CertState     = :ws-state
  8424           and CertAccount   = :ws-account
  8425           and CertEffDate   = :ws-eff-date
  8426           and CertNumber    = :ws-certificate
  8427           and CertNumberSuf = :ws-cert-sfx
  8428           and CheckSeqNbr   = :ws-seq-no
  8429           and CheckType     = :ws-type
  8430           and CheckSubType  = :ws-check-sub-type
  8431     END-EXEC
  8432     if sqlcode not = 0
  8433        display "Error: cannot declare cursor "
  8434        display ' sql retrun code ' sqlcode
  8435        display ' sql err mess    ' sqlerrmc
  8436        go to 4150-exit
  8437     end-if
  8438     EXEC SQL
  8439        open checkapp
  8440     END-EXEC
  8441     if sqlcode not = 0
  8442        display "Error: cannot open cursor "
  8443        display ' sql retrun code ' sqlcode
  8444        display ' sql err mess    ' sqlerrmc
  8445     end-if
  8446     .
  8447 4150-exit.
  8448     exit.
  8449 4200-get-tbl-row.
  8450***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8451***                                                            ***
  8452***  I'm only expecting one row so no cursor is declared       ***
  8453***                                                            ***
  8454***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8455     move pi-company-id          to ws-compid
  8456     move ch-carrier             to ws-carrier
  8457     move ch-grouping            to ws-grouping
  8458     move ch-state               to ws-state
  8459     move ch-account             to ws-account
  8460     move ch-cert-eff-dt         to dc-bin-date-1
  8461     move ' '                    to dc-option-code
  8462     perform 8500-date-convert   thru 8500-exit
  8463     if no-conversion-error
  8464        move dc-greg-date-a-edit to ws-eff-date
  8465     end-if
  8466     move ch-cert-prime          to ws-certificate
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 152
* EL677.cbl
  8467     move ch-cert-sfx            to ws-cert-sfx
  8468     move ch-sequence-no         to ws-seq-no
  8469     move '1'                    to ws-type
  8470                                    ws-check-sub-type
  8471     if pi-check-type = 'C'
  8472        move '2'                 to ws-check-sub-type
  8473     end-if
  8474     exec sql
  8475        SELECT
  8476           ApprovalStatus,
  8477           MaintainedBy,
  8478           MaintainedDate,
  8479           ApprovalBatch
  8480        INTO
  8481           :db-app-status :nu-app-status,
  8482           :db-app-by :nu-app-by,
  8483           :db-app-date :nu-app-date,
  8484           :db-app-batch :nu-app-batch
  8485        FROM
  8486           ChkApp_Check
  8487        WHERE
  8488           Company           = :ws-compid
  8489           and CertCarrier   = :ws-carrier
  8490           and CertGroup     = :ws-grouping
  8491           and CertState     = :ws-state
  8492           and CertAccount   = :ws-account
  8493           and CertEffDate   = :ws-eff-date
  8494           and CertNumber    = :ws-certificate
  8495           and CertNumberSuf = :ws-cert-sfx
  8496           and CheckSeqNbr   = :ws-seq-no
  8497           and CheckType     = :ws-type
  8498           and CheckSubType  = :ws-check-sub-type
  8499     end-exec
  8500     if sqlcode not = 0
  8501        display "Error: cannot read row "
  8502        display ' sql return code ' sqlcode
  8503        display ' sql err mess    ' sqlerrmc
  8504        go to 4200-exit
  8505     end-if
  8506*    display ' status ' db-app-status
  8507*    display ' by     ' db-app-by
  8508*    display ' date   ' db-app-date
  8509*    display ' batch  ' db-app-batch
  8510*    if nu-app-date = -1
  8511*       display ' approval date is low-values '
  8512*    else
  8513*       display ' approval date is NOT low values '
  8514*    end-if
  8515     .
  8516 4200-exit.
  8517     exit.
  8518 4250-delete-row.
  8519     EXEC SQL
  8520        DELETE
  8521           from ChkApp_Check
  8522        WHERE
  8523           Company           = :ws-compid
  8524           and CertCarrier   = :ws-carrier
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 153
* EL677.cbl
  8525           and CertGroup     = :ws-grouping
  8526           and CertState     = :ws-state
  8527           and CertAccount   = :ws-account
  8528           and CertEffDate   = :ws-eff-date
  8529           and CertNumber    = :ws-certificate
  8530           and CertNumberSuf = :ws-cert-sfx
  8531           and CheckSeqNbr   = :ws-seq-no
  8532           and CheckType     = :ws-type
  8533           and CheckSubType  = :ws-check-sub-type
  8534     END-EXEC
  8535     if sqlcode not = 0
  8536        display "Error: cannot delete row  "
  8537        display ' sql retrun code ' sqlcode
  8538        display ' sql err mess    ' sqlerrmc
  8539        go to 4250-exit
  8540     end-if
  8541     set row-deleted         to true
  8542     EXEC SQL
  8543         commit transaction
  8544     END-EXEC
  8545     if sqlcode not = 0
  8546        display "Error: commit "
  8547        display ' sql return code ' sqlcode
  8548        display ' sql err mess    ' sqlerrmc
  8549        go to 4250-exit
  8550     end-if
  8551     set tbl-commited to true
  8552     .
  8553 4250-exit.
  8554     exit.
  8555 4300-FINISH-UP-DB.
  8556     EXEC SQL
  8557         commit work release
  8558     END-EXEC
  8559     if sqlcode not = 0
  8560        display "Error: commit release "
  8561        display ' sql return code ' sqlcode
  8562        display ' sql err mess    ' sqlerrmc
  8563     end-if
  8564     .
  8565 4300-EXIT.
  8566     EXIT.
  8567 5000-BROWSE-FILE.
  8568
  8569* EXEC CICS HANDLE CONDITION
  8570*        NOTFND   (5560-END-OF-FILE)
  8571*        ENDFILE  (5560-END-OF-FILE)
  8572*    END-EXEC.
  8573*    MOVE '"$I''                  ! . #00007936' TO DFHEIV0
  8574     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8576     MOVE X'2E20233030303037393336' TO DFHEIV0(25:11)
  8577     CALL 'kxdfhei1' USING DFHEIV0
  8578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8579
  8580
  8581     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8582
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 154
* EL677.cbl
  8583     IF SEQI = LOW-VALUES
  8584         MOVE +1                 TO CHEK-RECORD-SEQ.
  8585
  8586     IF EIBAID = DFHPF2
  8587         GO TO 5100-BROWSE-BKWD.
  8588
  8589 5010-READ-LOOP.
  8590     IF EIBAID = DFHPF1
  8591         ADD +1                  TO CHEK-RECORD-SEQ.
  8592
  8593
  8594* EXEC CICS READ
  8595*        DATASET  (ERCHEK-FILE-ID)
  8596*        SET      (ADDRESS OF CHECK-RECORDS)
  8597*        RIDFLD   (ERCHEK-KEY)
  8598*        GTEQ
  8599*    END-EXEC.
  8600*    MOVE '&"S        G          (   #00007953' TO DFHEIV0
  8601     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8602     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8603     MOVE X'2020233030303037393533' TO DFHEIV0(25:11)
  8604     CALL 'kxdfhei1' USING DFHEIV0,
  8605           ERCHEK-FILE-ID,
  8606           DFHEIV20,
  8607           DFHEIV99,
  8608           ERCHEK-KEY,
  8609           DFHEIV99,
  8610           DFHEIV99,
  8611           DFHEIV99
  8612     SET ADDRESS OF CHECK-RECORDS TO
  8613         DFHEIV20
  8614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8615
  8616
  8617     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8618         IF EIBAID = DFHENTER
  8619             GO TO 5550-NO-RECORD
  8620         ELSE
  8621             GO TO 5560-END-OF-FILE.
  8622
  8623        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8624           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8625           PI-CHEK-STATE      = CH-STATE       AND
  8626           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8627           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8628           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8629           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8630              GO TO 5500-FORMAT-SCREEN
  8631            ELSE
  8632              IF EIBAID = DFHPF1
  8633                  GO TO 5560-END-OF-FILE
  8634                ELSE
  8635                  GO TO 5550-NO-RECORD.
  8636
  8637     IF EIBAID = DFHENTER
  8638        IF CHEK-CARRIER    = CH-CARRIER     AND
  8639           CHEK-GROUPING   = CH-GROUPING    AND
  8640           CHEK-STATE      = CH-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 155
* EL677.cbl
  8641           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8642           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8643           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8644           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8645           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8646              GO TO 5500-FORMAT-SCREEN
  8647        ELSE
  8648              GO TO 5550-NO-RECORD.
  8649
  8650     GO TO 5500-FORMAT-SCREEN.
  8651
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 156
* EL677.cbl
  8653
  8654 5100-BROWSE-BKWD.
  8655
  8656* EXEC CICS STARTBR
  8657*        DATASET  (ERCHEK-FILE-ID)
  8658*        RIDFLD   (ERCHEK-KEY)
  8659*    END-EXEC.
  8660     MOVE 0
  8661       TO DFHEIV11
  8662*    MOVE '&,         G          &   #00007998' TO DFHEIV0
  8663     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8665     MOVE X'2020233030303037393938' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0,
  8667           ERCHEK-FILE-ID,
  8668           ERCHEK-KEY,
  8669           DFHEIV99,
  8670           DFHEIV11,
  8671           DFHEIV99
  8672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8673
  8674
  8675
  8676* EXEC CICS READPREV
  8677*        DATASET  (ERCHEK-FILE-ID)
  8678*        SET      (ADDRESS OF CHECK-RECORDS)
  8679*        RIDFLD   (ERCHEK-KEY)
  8680*    END-EXEC.
  8681     MOVE 0
  8682       TO DFHEIV11
  8683*    MOVE '&0S                   )   #00008003' TO DFHEIV0
  8684     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8685     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8686     MOVE X'2020233030303038303033' TO DFHEIV0(25:11)
  8687     CALL 'kxdfhei1' USING DFHEIV0,
  8688           ERCHEK-FILE-ID,
  8689           DFHEIV20,
  8690           DFHEIV99,
  8691           ERCHEK-KEY,
  8692           DFHEIV99,
  8693           DFHEIV11,
  8694           DFHEIV99,
  8695           DFHEIV99
  8696     SET ADDRESS OF CHECK-RECORDS TO
  8697         DFHEIV20
  8698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8699
  8700
  8701 5110-READ-LOOP.
  8702     IF PI-FILE-EOF
  8703         MOVE SPACE              TO PI-EOF-SW
  8704     ELSE
  8705
  8706* EXEC CICS READPREV
  8707*            DATASET  (ERCHEK-FILE-ID)
  8708*            SET      (ADDRESS OF CHECK-RECORDS)
  8709*            RIDFLD   (ERCHEK-KEY)
  8710*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 157
* EL677.cbl
  8711     MOVE 0
  8712       TO DFHEIV11
  8713*    MOVE '&0S                   )   #00008013' TO DFHEIV0
  8714     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8715     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8716     MOVE X'2020233030303038303133' TO DFHEIV0(25:11)
  8717     CALL 'kxdfhei1' USING DFHEIV0,
  8718           ERCHEK-FILE-ID,
  8719           DFHEIV20,
  8720           DFHEIV99,
  8721           ERCHEK-KEY,
  8722           DFHEIV99,
  8723           DFHEIV11,
  8724           DFHEIV99,
  8725           DFHEIV99
  8726     SET ADDRESS OF CHECK-RECORDS TO
  8727         DFHEIV20
  8728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8729
  8730
  8731     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8732         GO TO 5560-END-OF-FILE.
  8733
  8734        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8735           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8736           PI-CHEK-STATE      = CH-STATE       AND
  8737           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8738           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8739           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8740           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8741              GO TO 5500-FORMAT-SCREEN
  8742            ELSE
  8743              GO TO 5560-END-OF-FILE.
  8744
  8745     GO TO 5500-FORMAT-SCREEN.
  8746
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 158
* EL677.cbl
  8748*                          COPY ELCNPD.
  8749*****************************************************************
  8750*                                                               *
  8751*                                                               *
  8752*                            ELCNPD                             *
  8753*                            VMOD=2.001                         *
  8754*****************************************************************
  8755
  8756 5200-MOVE-NAME.
  8757*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8758*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8759*            BLANKS.                                            *
  8760*                                                               *
  8761*                  FIELD               VALUE                    *
  8762*                                                               *
  8763*                LAST NAME (CL15)      SMITH                    *
  8764*                1ST NAME  (CL12)      JOHN                     *
  8765*                MID NAME  (CL1)       A                        *
  8766*                                                               *
  8767*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8768*         *                                                     *
  8769*         *              JOHN A. SMITH                          *
  8770*         *                                                     *
  8771*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8772*         *  STORAGE COPYBOOK:                                  *
  8773*         *                                                     *
  8774*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8775*         *******************************************************.
  8776
  8777     MOVE SPACES                 TO  WS-NAME-WORK
  8778                                     WS-NAME-WORK2.
  8779     MOVE ZERO                   TO  WS-NAME-SW.
  8780     SET NWA-INDEX TO +1.
  8781
  8782     IF WS-INSURED-1ST-NAME = SPACES  AND
  8783        WS-INSURED-MID-INIT = SPACES
  8784         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8785         GO TO 5200-EXIT.
  8786
  8787     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8788     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8789
  8790     SET NWA-INDEX UP BY +1
  8791     IF WS-INSURED-MID-INIT NOT = SPACES
  8792        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8793        SET NWA-INDEX UP BY +1
  8794        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8795        SET NWA-INDEX UP BY +2.
  8796
  8797     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8798     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8799
  8800
  8801 5200-EXIT.
  8802     EXIT.
  8803
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 159
* EL677.cbl
  8805 5300-MOVE-NAME SECTION.
  8806     IF WS-NAME-SW GREATER THAN +1
  8807         GO TO 5390-EXIT.
  8808
  8809     IF WS-NAME-WORK2 = SPACES
  8810         GO TO 5390-EXIT.
  8811
  8812     SET NWA-INDEX2 TO +1.
  8813     SET NWA-INDEX3 TO +2.
  8814
  8815 5310-MOVE-NAME.
  8816     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8817
  8818     IF NWA-INDEX LESS THAN +30
  8819        SET NWA-INDEX UP BY +1
  8820     ELSE
  8821        ADD +2  TO  WS-NAME-SW
  8822        GO TO 5390-EXIT.
  8823
  8824     IF NWA-INDEX2 LESS THAN +20
  8825         SET NWA-INDEX2 UP BY +1
  8826         SET NWA-INDEX3 UP BY +1.
  8827
  8828     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8829        WS-NW2 (NWA-INDEX3) = SPACES
  8830        GO TO 5390-EXIT.
  8831
  8832     GO TO 5310-MOVE-NAME.
  8833
  8834 5390-EXIT.
  8835     EXIT.
  8836
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 160
* EL677.cbl
  8839 5500-FORMAT-SCREEN.
  8840     MOVE LOW-VALUES             TO  EL677AI.
  8841     MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.
  8842     MOVE +1                     TO  MAINTL.
  8843     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8844     MOVE CH-CARRIER             TO  CARRIERO.
  8845     MOVE CH-GROUPING            TO  GROUPO.
  8846     MOVE CH-STATE               TO  STATEO.
  8847     MOVE CH-ACCOUNT             TO  ACCTO.
  8848
  8849     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8850     MOVE SPACE                  TO  DC-OPTION-CODE.
  8851     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8852     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8853
  8854     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8855     MOVE CH-CERT-SFX            TO  SFXO.
  8856     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8857
  8858     MOVE AL-UANON               TO  CARRIERA
  8859                                     GROUPA
  8860                                     STATEA
  8861                                     ACCTA
  8862                                     EFFDTA
  8863                                     CERTNOA
  8864                                     SFXA.
  8865     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8866
  8867     if ch-approval-dt not = low-values
  8868        move ch-approval-dt      to dc-bin-date-1
  8869        move ' '                 to dc-option-code
  8870        perform 8500-date-convert thru 8500-exit
  8871        move dc-greg-date-1-edit to apvdto
  8872     end-if
  8873     evaluate ch-approval-status
  8874        when '2'
  8875           move 'PENDING '       TO APVSTATO
  8876        when 'P'
  8877           move 'PENDING '       TO APVSTATO
  8878        when 'A'
  8879           move 'APPROVED'       to apvstato
  8880        when 'D'
  8881           move 'DENIED'         to apvstato
  8882     end-evaluate
  8883     move ch-approved-by         to apvbyo
  8884*    IF PI-COMPANY-ID = 'TMS'
  8885*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8886*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8887*    ELSE
  8888         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8889         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8890
  8891     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8892     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8893     move ch-payee-city          to payctyo
  8894     move ch-payee-state         to paysto
  8895     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8896
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 161
* EL677.cbl
  8897     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8898         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8899         MOVE AL-UANON           TO  PTOZIPA.
  8900
  8901     MOVE CH-RETURN-TO           TO  RETTOO
  8902*    if ch-check-cashed-dt not = spaces and low-values
  8903*       move ch-check-cashed-dt  to dc-bin-date-1
  8904*       MOVE SPACE               TO  DC-OPTION-CODE
  8905*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8906*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8907*    end-if
  8908     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8909     MOVE SPACE                  TO  DC-OPTION-CODE.
  8910     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8911     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8912
  8913     MOVE CH-RECORDED-BY         TO  CBYO.
  8914
  8915     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8916         NEXT SENTENCE
  8917     ELSE
  8918         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8919         MOVE SPACE                  TO  DC-OPTION-CODE
  8920         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8921         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8922         MOVE CH-VOID-BY             TO  VBYO.
  8923
  8924     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8925         NEXT SENTENCE
  8926     ELSE
  8927         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8928         MOVE SPACE                  TO  DC-OPTION-CODE
  8929         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8930         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8931
  8932     MOVE CH-AMOUNT-PAID         TO  AMOUNTO.
  8933     MOVE AL-SANOF               TO  AMOUNTA.
  8934     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8935     MOVE AL-SANOF               TO  TYPEA.
  8936     MOVE CH-CHECK-NO            TO  CHECKO.
  8937     move ch-deduct-commission   to dedcyno
  8938     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8939     MOVE CH-VOID-REASON         TO  VREASONO.
  8940
  8941     MOVE CH-STUB-LINE-1         TO  STUBO.
  8942     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8943     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8944     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8945     IF CH-LF-REFUND NOT NUMERIC
  8946         MOVE ZEROS              TO CH-LF-REFUND.
  8947     IF CH-AH-REFUND NOT NUMERIC
  8948         MOVE ZEROS              TO CH-AH-REFUND.
  8949     if (ch-check-no not = spaces and low-values)
  8950        and (ch-check-written-dt not = low-values)
  8951        perform 5800-fetch-check-cashed-dt
  8952                                 thru 5800-exit
  8953     end-if
  8954     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 162
* EL677.cbl
  8955        CH-VOID-DT          GREATER LOW-VALUES
  8956        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8957                                     STUBA     TEXT1A   TEXT2A
  8958                                     TEXT3A    PAYTO1A  SFXA
  8959                                     PAYTO2A   PAYAD1A  PAYctyA
  8960                                     paysta    RETTOA   PAYAD2A
  8961                                     PTOZIPA
  8962                                     PRINTEDA
  8963     ELSE
  8964        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8965                                     ACCTA     EFFDTA   CERTNOA
  8966                                     CHECKA    REASONA  VREASONA
  8967                                     STUBA     TEXT1A   TEXT2A
  8968                                     TEXT3A    PAYTO1A  SFXA
  8969                                     PAYTO2A   PAYAD1A  PAYctyA
  8970                                     paysta    RETTOA   PAYAD2A
  8971                                     PRINTEDA.
  8972
  8973     MOVE AL-UNNON               TO SEQA.
  8974     perform 5600-get-erpndb     thru 5600-exit
  8975     perform 5700-get-elcert     thru 5700-exit
  8976*    move pi-prev-paid           to prepdo
  8977     move al-sadof               to drefa
  8978*    if WS-PNDB-FOUND
  8979*       compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8980*    end-if
  8981     if WS-CERT-FOUND
  8982        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8983           cm-lf-alt-premium-amt
  8984        compute ws-tot-iss-prem  =
  8985           cm-ah-premium-amt + ws-tot-lf-prem
  8986        compute ws-tot-iss-comm =
  8987           (ws-tot-lf-prem * cm-life-comm-pct) +
  8988           (cm-ah-premium-amt * cm-ah-comm-pct)
  8989        compute ws-tot-ref-comm =
  8990           (pi-lf-refund * cm-life-comm-pct) +
  8991           (pi-ah-refund * cm-ah-comm-pct)
  8992        move ws-tot-iss-prem     to premo
  8993        move ws-tot-iss-comm     to isscommo
  8994*       move ws-tot-ref-comm     to uecommo
  8995     end-if
  8996     if PI-TO-EL677-FROM-EL1273
  8997        move zeros               to premo
  8998                                    isscommo
  8999                                    uecommo
  9000                                    prepdo
  9001                                    refo
  9002     end-if
  9003     GO TO 8100-SEND-INITIAL-MAP
  9004     .
  9005 5550-NO-RECORD.
  9006     MOVE ER-1162                TO  EMI-ERROR.
  9007     MOVE -1                     TO  CARRIERL.
  9008     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  9009                                     ACCTA     EFFDTA  CERTNOA
  9010                                     SFXA      SEQA.
  9011     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9012
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 163
* EL677.cbl
  9013     IF (NOT PI-TO-EL677-FROM-EL1273)
  9014        and (pi-return-to-program not = 'EL6315')
  9015         GO TO 8200-SEND-DATAONLY.
  9016
  9017     MOVE CHEK-CARRIER           TO  CARRIERO.
  9018     MOVE CHEK-GROUPING          TO  GROUPO.
  9019     MOVE CHEK-STATE             TO  STATEO.
  9020     MOVE CHEK-ACCOUNT           TO  ACCTO.
  9021
  9022     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  9023     MOVE SPACE                  TO  DC-OPTION-CODE.
  9024     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9025     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  9026
  9027     MOVE CHEK-CERT-NO           TO  CERTNOO.
  9028     MOVE CHEK-SUF-NO            TO  SFXO.
  9029     GO TO 8100-SEND-INITIAL-MAP.
  9030
  9031 5560-END-OF-FILE.
  9032     IF EIBAID = DFHPF1
  9033         MOVE 'Y'                TO  PI-EOF-SW
  9034         MOVE ER-2237            TO  EMI-ERROR
  9035     ELSE
  9036     IF EIBAID = DFHENTER
  9037        GO TO 5550-NO-RECORD
  9038     ELSE
  9039*        MOVE SPACES             TO  PI-ERCHEK-KEY
  9040         MOVE ER-2238            TO  EMI-ERROR.
  9041
  9042     MOVE -1                     TO  MAINTL.
  9043     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9044     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 164
* EL677.cbl
  9046 5600-get-erpndb.
  9047     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  9048     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  9049     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  9050     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  9051     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  9052     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  9053     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  9054     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  9055     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  9056     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  9057     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  9058     IF ST-ACCNT-CNTL  OR
  9059        ACCNT-CNTL
  9060          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9061     IF ST-ACCNT-CNTL      OR
  9062        CARR-ST-ACCNT-CNTL OR
  9063        ACCNT-CNTL         OR
  9064        CARR-ACCNT-CNTL
  9065          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9066     IF ACCNT-CNTL OR
  9067        CARR-ACCNT-CNTL
  9068          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9069
  9070* EXEC CICS READ
  9071*         DATASET   (ERPNDB-ALT-FILE-ID)
  9072*         SET       (ADDRESS OF PENDING-BUSINESS)
  9073*         RIDFLD    (ERPNDB-ALT-KEY)
  9074*         resp      (ws-response)
  9075*    END-EXEC
  9076*    MOVE '&"S        E          (  N#00008357' TO DFHEIV0
  9077     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9078     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9079     MOVE X'204E233030303038333537' TO DFHEIV0(25:11)
  9080     CALL 'kxdfhei1' USING DFHEIV0,
  9081           ERPNDB-ALT-FILE-ID,
  9082           DFHEIV20,
  9083           DFHEIV99,
  9084           ERPNDB-ALT-KEY,
  9085           DFHEIV99,
  9086           DFHEIV99,
  9087           DFHEIV99
  9088     SET ADDRESS OF PENDING-BUSINESS TO
  9089         DFHEIV20
  9090     MOVE EIBRESP  TO ws-response
  9091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9092     if resp-normal
  9093        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  9094        compute pi-refund-on-pending-rec =
  9095           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  9096     end-if
  9097     .
  9098 5600-exit.
  9099     exit.
  9100 5700-get-elcert.
  9101     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9102     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9103     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 165
* EL677.cbl
  9104     MOVE PI-STATE               TO  ELCERT-STATE.
  9105     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9106     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9107     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9108     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9109     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9110
  9111* EXEC CICS READ
  9112*         DATASET   (ELCERT-FILE-ID)
  9113*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9114*         RIDFLD    (ELCERT-KEY)
  9115*         resp      (ws-response)
  9116*    END-EXEC
  9117*    MOVE '&"S        E          (  N#00008381' TO DFHEIV0
  9118     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9119     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9120     MOVE X'204E233030303038333831' TO DFHEIV0(25:11)
  9121     CALL 'kxdfhei1' USING DFHEIV0,
  9122           ELCERT-FILE-ID,
  9123           DFHEIV20,
  9124           DFHEIV99,
  9125           ELCERT-KEY,
  9126           DFHEIV99,
  9127           DFHEIV99,
  9128           DFHEIV99
  9129     SET ADDRESS OF CERTIFICATE-MASTER TO
  9130         DFHEIV20
  9131     MOVE EIBRESP  TO ws-response
  9132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9133     if resp-normal
  9134        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  9135     end-if
  9136     .
  9137 5700-exit.
  9138     exit.
  9139 5800-fetch-check-cashed-dt.
  9140     move ' '                    to ws-connect-sw
  9141                                    ws-match-sw
  9142                                    pi-check-cashed
  9143     move 'NTCSO2_PdBnkInfo'     to svr
  9144     move 'sa'                   to usr
  9145     move 'ntcso2'               to pass
  9146     string
  9147         usr delimited space
  9148         "." delimited size
  9149         pass delimited space into usr-pass
  9150     end-string
  9151     EXEC SQL
  9152        CONNECT TO :svr USER :usr-pass
  9153     END-EXEC
  9154     if sqlcode not = 0
  9155        display "Error: cannot connect to pdbnkinfo "
  9156        display sqlcode
  9157        display sqlerrmc
  9158        go to 5800-exit
  9159     end-if
  9160     set connected-to-db to true
  9161     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 166
* EL677.cbl
  9162        move 'CSO - AP%'         to ws-pb-compid
  9163     else
  9164        move 'AHL - AP%'         to ws-pb-compid
  9165     end-if
  9166     move '000'                  to ws-pb-check-no (1:3)
  9167     move ch-check-no            to ws-pb-check-no (4:7)
  9168     move spaces                 to ws-pb-bad-check-no
  9169     perform varying s1 from +1 by +1 until
  9170        (s1 > +10)
  9171        or (ws-pb-check-no (s1:1) not = '0')
  9172     end-perform
  9173     if s1 < +11
  9174        move ws-pb-check-no (s1:11 - s1)
  9175                            to ws-pb-bad-check-no (1: 11 - s1)
  9176     end-if
  9177*    display ' compid **' ws-pb-compid '**'
  9178*    display ' ckno  **' ws-pb-check-no '**'
  9179     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  9180     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  9181     MOVE SPACES              TO pb-paid-date
  9182
  9183     EXEC SQL
  9184        CALL pbi_GetCashDate_by_TransactionNbr
  9185           @compid          = :ws-pb-compid,
  9186           @checkno         = :ws-pb-check-no,
  9187           @badcheckno      = :ws-pb-bad-check-no,
  9188           @checkamount     = :ws-check-amount,
  9189           @checkcasheddate = :pb-paid-date OUT
  9190     END-EXEC
  9191     if sqlcode not = 0
  9192        display "Error: cannot run stor proc  "
  9193        move sqlcode            to ws-sql-code
  9194        move ws-sql-code to ws-dis-sql-code
  9195        display ' dis sql code ' ws-dis-sql-code
  9196        display ' sql return code ' sqlcode
  9197        display ' sql err mess    ' sqlerrmc
  9198        go to 5800-disconnect
  9199     end-if
  9200***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9201***                                                            ***
  9202***  The following code works just as well as the above        ***
  9203***  stored procedure and just as fast.                        ***
  9204***  Originally, I had declared a cursor and fetched through   ***
  9205***  the record set to find the correct check and that REALLY  ***
  9206***  slowed the response down to ~ 3/4 second.                 ***
  9207***                                                            ***
  9208***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9209*     EXEC SQL
  9210*        SELECT
  9211*           PaidDate
  9212*        INTO
  9213*           :pb-paid-date
  9214*        FROM
  9215*           dbo.cso_pbi_TransactionLookup
  9216*        WHERE
  9217*           (BankAcctDescr like :ws-pb-compid)
  9218*           and (Amount = :ws-check-amount)
  9219*           and ((transactionNbr = :ws-pb-check-no)
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 167
* EL677.cbl
  9220*                  or
  9221*               (transactionnbr = :ws-pb-bad-check-no))
  9222**          and (CAST(TransactionNbr AS INT) =
  9223**             :ws-pb-check-no-num)
  9224**          and (right('00000' + rtrim(TransactionNbr),10)
  9225**             = :ws-pb-check-no)
  9226**          and (TransactionNbr  = :ws-pb-check-no)
  9227*     END-EXEC
  9228*    display ' chkno  ' pb-check-no
  9229*    display ' desc   ' pb-bank-acct-desc
  9230*    display ' trn typ' pb-tran-type
  9231*    display ' amt   *' pb-amount '**'
  9232*    display ' pd dte ' pb-paid-date
  9233     string pb-paid-date (1:4)
  9234            pb-paid-date (6:2)
  9235            pb-paid-date (9:2)
  9236        delimited by size into dc-greg-date-cymd-r
  9237     end-string
  9238     move 'L'                    to dc-option-code
  9239     perform 8500-date-convert   thru 8500-exit
  9240     if no-conversion-error
  9241*       move dc-bin-date-1       to ws-bin-cashed-dt
  9242        move dc-greg-date-1-edit to cashedo
  9243        move 'Y' to pi-check-cashed
  9244     else
  9245        display ' error cvtdte cash dt ' pb-paid-date ' '
  9246           dc-error-code
  9247     end-if
  9248     .
  9249 5800-disconnect.
  9250     EXEC SQL
  9251        DISCONNECT ALL
  9252     END-EXEC
  9253     if sqlcode not = 0
  9254        display "Error: cannot disconnect pdbnk "
  9255        display ' sql return code ' sqlcode
  9256        display ' sql err mess    ' sqlerrmc
  9257     end-if
  9258     .
  9259 5800-exit.
  9260     exit.
  9261 6000-VERIFY-COMP-MASTER.
  9262
  9263* EXEC CICS HANDLE CONDITION
  9264*        NOTFND   (6070-NO-COMP-MSTR)
  9265*    END-EXEC.
  9266*    MOVE '"$I                   ! / #00008516' TO DFHEIV0
  9267     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9269     MOVE X'2F20233030303038353136' TO DFHEIV0(25:11)
  9270     CALL 'kxdfhei1' USING DFHEIV0
  9271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9272
  9273
  9274     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  9275
  9276     IF NOT PI-ZERO-CARRIER AND
  9277        NOT PI-ZERO-CAR-GROUP
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 168
* EL677.cbl
  9278         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9279     ELSE
  9280         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9281
  9282     IF NOT PI-ZERO-GROUPING  AND
  9283        NOT PI-ZERO-CAR-GROUP
  9284         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  9285     ELSE
  9286         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9287
  9288     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9289     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9290     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9291
  9292
  9293* EXEC CICS READ
  9294*         DATASET   (ERCOMP-FILE-ID)
  9295*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9296*         RIDFLD    (ERCOMP-KEY)
  9297*     END-EXEC.
  9298*    MOVE '&"S        E          (   #00008538' TO DFHEIV0
  9299     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9301     MOVE X'2020233030303038353338' TO DFHEIV0(25:11)
  9302     CALL 'kxdfhei1' USING DFHEIV0,
  9303           ERCOMP-FILE-ID,
  9304           DFHEIV20,
  9305           DFHEIV99,
  9306           ERCOMP-KEY,
  9307           DFHEIV99,
  9308           DFHEIV99,
  9309           DFHEIV99
  9310     SET ADDRESS OF COMPENSATION-MASTER TO
  9311         DFHEIV20
  9312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9313
  9314
  9315     GO TO 6090-EXIT.
  9316
  9317 6070-NO-COMP-MSTR.
  9318     MOVE -1                     TO  CARRIERL.
  9319     MOVE ER-2230                TO  EMI-ERROR.
  9320     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9321     GO TO 8200-SEND-DATAONLY.
  9322
  9323 6090-EXIT.
  9324      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 169
* EL677.cbl
  9326 6100-VERIFY-CERTIFICATE.
  9327
  9328* EXEC CICS HANDLE CONDITION
  9329*        NOTFND   (6170-NO-CERTIFICATE)
  9330*    END-EXEC.
  9331*    MOVE '"$I                   ! 0 #00008556' TO DFHEIV0
  9332     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9333     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9334     MOVE X'3020233030303038353536' TO DFHEIV0(25:11)
  9335     CALL 'kxdfhei1' USING DFHEIV0
  9336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9337
  9338
  9339     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9340     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9341     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9342     MOVE PI-STATE               TO  ELCERT-STATE.
  9343     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9344     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9345     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9346     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9347
  9348     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9349
  9350     MOVE SPACES                 TO  PI-REFERENCE
  9351*                                    PI-INSURED-NAME.
  9352     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9353*    MOVE ZEROS                  TO  PI-LF-REFUND
  9354*                                    PI-AH-REFUND.
  9355
  9356
  9357* EXEC CICS READ
  9358*         DATASET   (ELCERT-FILE-ID)
  9359*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9360*         RIDFLD    (ELCERT-KEY)
  9361*     END-EXEC.
  9362*    MOVE '&"S        E          (   #00008577' TO DFHEIV0
  9363     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9365     MOVE X'2020233030303038353737' TO DFHEIV0(25:11)
  9366     CALL 'kxdfhei1' USING DFHEIV0,
  9367           ELCERT-FILE-ID,
  9368           DFHEIV20,
  9369           DFHEIV99,
  9370           ELCERT-KEY,
  9371           DFHEIV99,
  9372           DFHEIV99,
  9373           DFHEIV99
  9374     SET ADDRESS OF CERTIFICATE-MASTER TO
  9375         DFHEIV20
  9376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9377
  9378
  9379     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9380
  9381*    MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9382*    MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9383     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 170
* EL677.cbl
  9384         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9385     ELSE
  9386         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9387             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9388*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9389
  9390     GO TO 6190-EXIT.
  9391
  9392 6170-NO-CERTIFICATE.
  9393     MOVE -1                     TO  CARRIERL.
  9394     MOVE ER-2726                TO  EMI-ERROR.
  9395     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9396
  9397 6190-EXIT.
  9398      EXIT.
  9399
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 171
* EL677.cbl
  9401 6200-UPDATE-PENDING-BUS-REC.
  9402     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9403     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9404     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9405     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9406     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9407     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9408     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9409     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9410     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9411     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9412
  9413     IF ST-ACCNT-CNTL  OR
  9414        ACCNT-CNTL
  9415          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9416
  9417     IF ST-ACCNT-CNTL      OR
  9418        CARR-ST-ACCNT-CNTL OR
  9419        ACCNT-CNTL         OR
  9420        CARR-ACCNT-CNTL
  9421          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9422
  9423     IF ACCNT-CNTL OR
  9424        CARR-ACCNT-CNTL
  9425          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9426
  9427
  9428* EXEC CICS READ
  9429*         DATASET   (ERPNDB-ALT-FILE-ID)
  9430*         SET       (ADDRESS OF PENDING-BUSINESS)
  9431*         RIDFLD    (ERPNDB-ALT-KEY)
  9432*         resp      (ws-response)
  9433*     END-EXEC.
  9434*    MOVE '&"S        E          (  N#00008631' TO DFHEIV0
  9435     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9437     MOVE X'204E233030303038363331' TO DFHEIV0(25:11)
  9438     CALL 'kxdfhei1' USING DFHEIV0,
  9439           ERPNDB-ALT-FILE-ID,
  9440           DFHEIV20,
  9441           DFHEIV99,
  9442           ERPNDB-ALT-KEY,
  9443           DFHEIV99,
  9444           DFHEIV99,
  9445           DFHEIV99
  9446     SET ADDRESS OF PENDING-BUSINESS TO
  9447         DFHEIV20
  9448     MOVE EIBRESP  TO ws-response
  9449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9450
  9451
  9452     if not resp-normal
  9453        go to 6200-exit
  9454     end-if
  9455     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9456
  9457
  9458* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 172
* EL677.cbl
  9459*         DATASET   (ERPNDB-FILE-ID)
  9460*         SET       (ADDRESS OF PENDING-BUSINESS)
  9461*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9462*         UPDATE
  9463*         resp      (ws-response)
  9464*     END-EXEC.
  9465*    MOVE '&"S        EU         (  N#00008643' TO DFHEIV0
  9466     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9467     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9468     MOVE X'204E233030303038363433' TO DFHEIV0(25:11)
  9469     CALL 'kxdfhei1' USING DFHEIV0,
  9470           ERPNDB-FILE-ID,
  9471           DFHEIV20,
  9472           DFHEIV99,
  9473           ERPNDB-PRIMARY-KEY,
  9474           DFHEIV99,
  9475           DFHEIV99,
  9476           DFHEIV99
  9477     SET ADDRESS OF PENDING-BUSINESS TO
  9478         DFHEIV20
  9479     MOVE EIBRESP  TO ws-response
  9480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9481
  9482
  9483 6200-EXIT.
  9484      EXIT.
  9485 6210-rewrite-pndb.
  9486
  9487* EXEC CICS REWRITE
  9488*        DATASET  (ERPNDB-FILE-ID)
  9489*        FROM     (PENDING-BUSINESS)
  9490*    END-EXEC
  9491     MOVE LENGTH OF
  9492      PENDING-BUSINESS
  9493       TO DFHEIV11
  9494*    MOVE '&& L                  %   #00008654' TO DFHEIV0
  9495     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9496     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9497     MOVE X'2020233030303038363534' TO DFHEIV0(25:11)
  9498     CALL 'kxdfhei1' USING DFHEIV0,
  9499           ERPNDB-FILE-ID,
  9500           PENDING-BUSINESS,
  9501           DFHEIV11,
  9502           DFHEIV99
  9503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9504     .
  9505 6210-exit.
  9506     exit.
  9507 6300-BUILD-CERT-SCREEN.
  9508*    move 'N'                    to dedcyni
  9509*                                   pi-prev-ded-comm
  9510     MOVE LOW-VALUES             TO  EL677AI.
  9511     perform 6700-build-common   thru 6700-exit
  9512     if ws-refund-amount = zeros
  9513        move pi-company-cd       to pi-chek-comp-cd
  9514        move pi-carrier          to pi-chek-carrier
  9515        move pi-grouping         to pi-chek-grouping
  9516        move pi-state            to pi-chek-state
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 173
* EL677.cbl
  9517        move pi-account          to pi-chek-account
  9518        move pi-cert-eff-dt      to pi-chek-eff-dt
  9519        move pi-cert-prime       to pi-chek-cert-no
  9520        move pi-cert-sfx         to pi-chek-suf-no
  9521        move +1                  to pi-chek-sequence
  9522             MOVE 'S'            TO MAINTI
  9523             MOVE 1              TO MAINTL
  9524             MOVE AL-UABON       TO MAINTA
  9525             MOVE DFHENTER       TO EIBAID
  9526        go to 5000-browse-file
  9527     end-if
  9528     IF WS-CERT-NOT-FOUND
  9529         GO TO 8100-SEND-INITIAL-MAP.
  9530
  9531*    IF WS-PNDB-FOUND
  9532*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9533*                                   PB-C-AH-CANCEL-AMT
  9534*        MOVE 'R'                TO  TYPEO
  9535*        IF PI-AR-PROCESSING
  9536*            MOVE AL-UANON       TO  REFA
  9537*            MOVE PB-C-REFERENCE TO  REFO
  9538*        END-IF
  9539*    ELSE
  9540*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9541*                                   CM-AH-ITD-CANCEL-AMT.
  9542     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9543     MOVE pi-check-type           TO TYPEO
  9544
  9545     IF PI-COMPANY-ID = 'TMS'
  9546         MOVE WS-NAME-WORK         TO PAYTO1I
  9547                                      PI-PAYTO1
  9548         MOVE AL-UANON             TO PAYTO1A
  9549     ELSE
  9550         MOVE WS-NAME-WORK         TO PAYTO1I
  9551                                      PI-PAYTO1
  9552         MOVE AL-UANON             TO PAYTO1A.
  9553
  9554*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9555*    MOVE AL-UANON                 TO PAYTO1AA.
  9556     move 'N'                    to dedcyni
  9557     move al-uanon               to dedcyna
  9558     move 'INS'                  to payeeo
  9559     move al-panon               to payeea
  9560     IF PI-MAIL-YES
  9561         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9562
  9563     GO TO 8100-SEND-INITIAL-MAP.
  9564
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 174
* EL677.cbl
  9566
  9567 6400-MAILING-ADDRESS.
  9568
  9569* EXEC CICS HANDLE CONDITION
  9570*        NOTFND   (6470-NO-ADDRESS)
  9571*    END-EXEC.
  9572*    MOVE '"$I                   ! 1 #00008722' TO DFHEIV0
  9573     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9575     MOVE X'3120233030303038373232' TO DFHEIV0(25:11)
  9576     CALL 'kxdfhei1' USING DFHEIV0
  9577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9578
  9579
  9580
  9581* EXEC CICS READ
  9582*        DATASET   (ERMAIL-FILE-ID)
  9583*        SET       (ADDRESS OF MAILING-DATA)
  9584*        RIDFLD    (ELCERT-KEY)
  9585*    END-EXEC.
  9586*    MOVE '&"S        E          (   #00008726' TO DFHEIV0
  9587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9589     MOVE X'2020233030303038373236' TO DFHEIV0(25:11)
  9590     CALL 'kxdfhei1' USING DFHEIV0,
  9591           ERMAIL-FILE-ID,
  9592           DFHEIV20,
  9593           DFHEIV99,
  9594           ELCERT-KEY,
  9595           DFHEIV99,
  9596           DFHEIV99,
  9597           DFHEIV99
  9598     SET ADDRESS OF MAILING-DATA TO
  9599         DFHEIV20
  9600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9601
  9602
  9603     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9604     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9605     move ma-city                to payctyi
  9606     move ma-addr-state          to paysti
  9607     MOVE MA-ZIP                 TO PTOZIPI.
  9608     MOVE AL-UANON               TO PAYAD1A
  9609                                    PAYAD2A
  9610                                    PAYctyA
  9611                                    paysta
  9612                                    PTOZIPA.
  9613
  9614     GO TO 6490-EXIT.
  9615
  9616 6470-NO-ADDRESS.
  9617     MOVE -1                     TO  PAYAD1L.
  9618     MOVE ER-2394                TO  EMI-ERROR.
  9619     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9620
  9621 6490-EXIT.
  9622      EXIT.
  9623
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 175
* EL677.cbl
  9625
  9626 6500-BUILD-ACCOUNT-SCREEN.
  9627     MOVE LOW-VALUES             TO  EL677AI.
  9628     perform 6700-build-common   thru 6700-exit
  9629     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9630     MOVE PI-AM-NAME             TO PAYTO1I
  9631     MOVE SPACES                 TO PAYTO2I
  9632     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9633     MOVE PI-AM-CITY             TO PAYCTYI
  9634     move pi-am-st               to paysti
  9635     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9636     move 'ACCT'                 to payeeo
  9637     move al-panon               to payeea
  9638     MOVE AL-UANON               TO PAYTO1A
  9639                                    PAYTO2A
  9640                                    PAYAD1A
  9641                                    PAYCTYA
  9642                                    paysta
  9643                                    PTOZIPA
  9644     GO TO 8100-SEND-INITIAL-MAP
  9645     .
  9646 6600-BUILD-BENEFICIARY-SCREEN.
  9647     MOVE LOW-VALUES             TO  EL677AI.
  9648     perform 6700-build-common   thru 6700-exit
  9649     IF WS-CERT-NOT-FOUND
  9650         GO TO 8100-SEND-INITIAL-MAP.
  9651
  9652*    IF WS-PNDB-FOUND
  9653*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9654*                                   PB-C-AH-CANCEL-AMT
  9655*        MOVE 'R'                TO  TYPEO
  9656*        IF PI-AR-PROCESSING
  9657*            MOVE AL-UANON       TO  REFA
  9658*            MOVE PB-C-REFERENCE TO  REFO
  9659*        END-IF
  9660*    ELSE
  9661*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9662*                                   CM-AH-ITD-CANCEL-AMT.
  9663
  9664     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9665     MOVE pi-check-type           TO  TYPEO.
  9666
  9667     IF PI-COMPANY-ID = 'TMS'
  9668         MOVE WS-NAME-WORK         TO PAYTO1I
  9669                                      PI-PAYTO1
  9670         MOVE AL-UANON             TO PAYTO1A
  9671     ELSE
  9672         MOVE WS-NAME-WORK         TO PAYTO1I
  9673                                      PI-PAYTO1
  9674         MOVE AL-UANON             TO PAYTO1A.
  9675
  9676*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9677*    MOVE AL-UANON                 TO PAYTO1AA.
  9678
  9679     move 'N'                    to dedcyni
  9680     move al-uanon               to dedcyna
  9681     move 'BENE'                 to payeeo
  9682     move al-panon               to payeea
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 176
* EL677.cbl
  9683     IF PI-MAIL-YES
  9684         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
  9685
  9686     GO TO 8100-SEND-INITIAL-MAP.
  9687
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 177
* EL677.cbl
  9689
  9690 6620-MAILING-ADDRESS.
  9691
  9692* EXEC CICS HANDLE CONDITION
  9693*        NOTFND   (6670-NO-beneficiary)
  9694*    END-EXEC.
  9695*    MOVE '"$I                   ! 2 #00008820' TO DFHEIV0
  9696     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9698     MOVE X'3220233030303038383230' TO DFHEIV0(25:11)
  9699     CALL 'kxdfhei1' USING DFHEIV0
  9700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9701
  9702
  9703
  9704* EXEC CICS READ
  9705*        DATASET   (ERMAIL-FILE-ID)
  9706*        SET       (ADDRESS OF MAILING-DATA)
  9707*        RIDFLD    (ELCERT-KEY)
  9708*    END-EXEC.
  9709*    MOVE '&"S        E          (   #00008824' TO DFHEIV0
  9710     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9712     MOVE X'2020233030303038383234' TO DFHEIV0(25:11)
  9713     CALL 'kxdfhei1' USING DFHEIV0,
  9714           ERMAIL-FILE-ID,
  9715           DFHEIV20,
  9716           DFHEIV99,
  9717           ELCERT-KEY,
  9718           DFHEIV99,
  9719           DFHEIV99,
  9720           DFHEIV99
  9721     SET ADDRESS OF MAILING-DATA TO
  9722         DFHEIV20
  9723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9724
  9725
  9726     move spaces                 to payto2i
  9727     move ma-cred-bene-name      to payto1i
  9728     MOVE MA-cred-bene-addr      TO PAYad1I.
  9729     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9730     move ma-cred-bene-city      to payctyi
  9731     move ma-cred-bene-state     to paysti
  9732     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9733     MOVE AL-UANON               TO payto1a
  9734                                    PAYTO2A
  9735                                    PAYad1A
  9736                                    payad2a
  9737                                    PAYctyA
  9738                                    paysta
  9739                                    PTOZIPA.
  9740
  9741     GO TO 6690-EXIT.
  9742
  9743 6670-NO-BENEFICIARY.
  9744     MOVE -1                     TO  PAYTO1L.
  9745     MOVE ER-2394                TO  EMI-ERROR.
  9746     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 178
* EL677.cbl
  9747
  9748 6690-EXIT.
  9749      EXIT.
  9750 6700-build-common.
  9751     if not eracct-found
  9752        move pi-company-cd       to eracct-co
  9753        move pi-carrier          to eracct-carrier
  9754        move pi-grouping         to eracct-grouping
  9755        move pi-state            to eracct-state
  9756        move pi-account          to eracct-account
  9757        move pi-cert-eff-dt      to eracct-exp-date
  9758        perform 1420-get-eracct  thru 1490-exit
  9759     end-if
  9760*    if WS-PNDB-NOT-FOUND
  9761*       perform 5600-get-erpndb thru 5600-exit
  9762*    end-if
  9763*    MOVE LOW-VALUES             TO  EL677AI.
  9764     MOVE 'A'                    TO  MAINTI.
  9765     MOVE AL-UANON               TO  MAINTA.
  9766     MOVE +1                     TO  MAINTL.
  9767     MOVE PI-CARRIER             TO  CARRIERO.
  9768     MOVE PI-GROUPING            TO  GROUPO.
  9769     MOVE PI-STATE               TO  STATEO.
  9770     MOVE PI-ACCOUNT             TO  ACCTO.
  9771     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9772     MOVE PI-CERT-SFX            TO  SFXO.
  9773     MOVE PI-AMOUNT              TO  AMOUNTO.
  9774*    MOVE PI-TYPE                TO  TYPEO.
  9775     move pi-check-type          to  typeo
  9776     move pi-return-to           to  rettoo
  9777*    MOVE PI-REFERENCE           TO  REFO.
  9778     MOVE PI-PAYTO1              TO  PAYTO1O.
  9779     MOVE AL-UANON               TO  CARRIERA
  9780                                     GROUPA
  9781                                     STATEA
  9782                                     ACCTA
  9783                                     CERTNOA
  9784                                     SFXA
  9785                                     PAYTO1A
  9786                                     PAYTO2A
  9787*                                    AMOUNTA
  9788*                                    TYPEA
  9789                                     rettoa
  9790                                     payeea.
  9791     move al-panon               to typea
  9792     move al-panon               to amounta
  9793     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9794     MOVE ' '                    TO  DC-OPTION-CODE.
  9795     PERFORM 8500-DATE-CONVERT.
  9796     IF NO-CONVERSION-ERROR
  9797         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9798         MOVE AL-UANON            TO  EFFDTA
  9799         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9800         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9801     ELSE
  9802         GO TO 8200-SEND-DATAONLY.
  9803     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9804         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 179
* EL677.cbl
  9805         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
  9806     ELSE
  9807         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9808         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9809     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9810     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9811     move spaces to pi-insured-name
  9812     string cm-insured-last-name ' '
  9813            cm-insured-first-name delimited by '  '
  9814        into pi-insured-name
  9815     end-string
  9816     move spaces                 to pi-table-name
  9817     string cm-insured-last-name ', '
  9818            cm-insured-first-name ' '
  9819            cm-insured-initial2
  9820        delimited by '  '
  9821        into
  9822           pi-table-name
  9823     end-string
  9824*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9825     if eibaid = dfhpf5
  9826        move 'Y'                 to dedcyni
  9827        move al-uanon            to dedcyna
  9828     end-if
  9829    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9830       cm-lf-alt-premium-amt
  9831    compute ws-tot-iss-prem  =
  9832       cm-ah-premium-amt + ws-tot-lf-prem
  9833    compute ws-tot-iss-comm =
  9834       (ws-tot-lf-prem * cm-life-comm-pct) +
  9835       (cm-ah-premium-amt * cm-ah-comm-pct)
  9836    compute ws-tot-ref-comm =
  9837       (pi-lf-refund * cm-life-comm-pct) +
  9838       (pi-ah-refund * cm-ah-comm-pct)
  9839     move ws-tot-iss-prem        to premo
  9840     move ws-tot-iss-comm        to isscommo
  9841     move al-sadof               to drefa
  9842                                    refa
  9843*    compute refo = pi-lf-refund + pi-ah-refund
  9844     move pi-prev-paid            to prepdo
  9845     move ws-tot-ref-comm         to uecommo
  9846                                     pi-ue-comm
  9847***  compute ws-refund-amount = pi-refund-on-pending-rec -
  9848***     pi-prev-paid
  9849     compute ws-refund-amount =
  9850        pi-refund-on-pending-rec - pi-prev-paid-this-month
  9851     if (pi-refund-on-pending-rec + pi-prev-paid) >
  9852        ws-tot-iss-prem
  9853        move zeros               to ws-refund-amount
  9854     end-if
  9855     if ((dedcyni = 'Y')
  9856        or (pi-prev-ded-comm = 'Y'))
  9857        and (ws-refund-amount >= ws-tot-ref-comm)
  9858        compute ws-refund-amount = ws-refund-amount -
  9859           ws-tot-ref-comm
  9860     end-if
  9861     if pi-check-type = 'C'
  9862*       move pi-endt-prm-diff    to refo
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 180
* EL677.cbl
  9863        move pi-endt-com-diff    to uecommo
  9864                                    pi-ue-comm
  9865        compute ws-refund-amount =
  9866           pi-endt-prm-diff - pi-prev-paid
  9867        if (dedcyni = 'Y')
  9868           or (pi-prev-ded-comm = 'Y')
  9869           compute ws-refund-amount = ws-refund-amount -
  9870              pi-endt-com-diff
  9871        end-if
  9872        if ws-refund-amount <= zeros
  9873           move pi-endt-prm-diff to ws-refund-amount
  9874        end-if
  9875     end-if
  9876     if not WS-CERT-NOT-FOUND
  9877        string
  9878           pi-cert-prime         ' : '
  9879           cm-insured-last-name  ', '
  9880           cm-insured-first-name ' : '
  9881           pi-account            ' : '
  9882           pi-am-csr delimited by '  ' into text1o
  9883        end-string
  9884        move al-uanon            to text1a
  9885        MOVE 'REF'               TO WS-USER-REASON
  9886        if pi-check-type = 'C'
  9887           move 'COR'            to ws-user-reason
  9888        end-if
  9889        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9890        inspect ws-user-cert-no replacing leading zeros
  9891           by spaces
  9892        move pi-insured-name     to ws-user-name
  9893        perform varying s1 from +1 by +1 until
  9894           (s1 > +11)
  9895           or (ws-user-cert-no (s1:1)) <> ' '
  9896        end-perform
  9897        string ws-user-reason  ' ' delimited by size
  9898               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9899                  delimited by size
  9900               cm-insured-last-name ' '
  9901               cm-insured-first-name delimited by '  '
  9902           into stubo
  9903        end-string
  9904        move al-uanon            to stuba
  9905     end-if
  9906     .
  9907 6700-exit.
  9908     exit.
  9909 6800-browse-previous-chek-recs.
  9910***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9911***                                                            ***
  9912**** this should be the first time through, we need to gather  ***
  9913**** all the erchek records for this pending record, add the   ***
  9914**** amounts and make sure this check request will not exceed  ***
  9915**** the collected premium                                     ***
  9916***                                                            ***
  9917***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9918     move zeros                  to pi-prev-paid
  9919                                    pi-prev-paid-this-month
  9920                                    ws-browse-sw
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 181
* EL677.cbl
  9921                                    pi-chek-rec-cnt
  9922     move spaces                 to pi-prev-ded-comm
  9923     move pi-company-cd          to chek-company-cd
  9924     move pi-carrier             to chek-carrier
  9925     move pi-grouping            to chek-grouping
  9926     move pi-state               to chek-state
  9927     move pi-account             to chek-account
  9928     move pi-cert-prime          to chek-cert-no
  9929     move pi-cert-sfx            to chek-suf-no
  9930     move pi-cert-eff-dt         to chek-eff-dt
  9931     move +0                     to chek-record-seq
  9932     move erchek-key             to ws-compare-erchek-key
  9933
  9934* EXEC CICS STARTBR
  9935*       DATASET  (ERCHEK-FILE-ID)
  9936*       RIDFLD   (ERCHEK-KEY)
  9937*       resp     (ws-response)
  9938*    END-EXEC
  9939     MOVE 0
  9940       TO DFHEIV11
  9941*    MOVE '&,         G          &  N#00009037' TO DFHEIV0
  9942     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9943     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9944     MOVE X'204E233030303039303337' TO DFHEIV0(25:11)
  9945     CALL 'kxdfhei1' USING DFHEIV0,
  9946           ERCHEK-FILE-ID,
  9947           ERCHEK-KEY,
  9948           DFHEIV99,
  9949           DFHEIV11,
  9950           DFHEIV99
  9951     MOVE EIBRESP  TO ws-response
  9952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9953     if not resp-normal
  9954        go to 6800-exit
  9955     end-if
  9956     perform until i-say-when
  9957
  9958* EXEC CICS READNEXT
  9959*          DATASET   (ERCHEK-FILE-ID)
  9960*          SET       (ADDRESS OF CHECK-RECORDS)
  9961*          RIDFLD    (ERCHEK-KEY)
  9962*          resp      (ws-response)
  9963*       END-EXEC
  9964     MOVE 0
  9965       TO DFHEIV11
  9966*    MOVE '&.S                   )  N#00009046' TO DFHEIV0
  9967     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9968     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9969     MOVE X'204E233030303039303436' TO DFHEIV0(25:11)
  9970     CALL 'kxdfhei1' USING DFHEIV0,
  9971           ERCHEK-FILE-ID,
  9972           DFHEIV20,
  9973           DFHEIV99,
  9974           ERCHEK-KEY,
  9975           DFHEIV99,
  9976           DFHEIV11,
  9977           DFHEIV99,
  9978           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 182
* EL677.cbl
  9979     SET ADDRESS OF CHECK-RECORDS TO
  9980         DFHEIV20
  9981     MOVE EIBRESP  TO ws-response
  9982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9983        if resp-normal
  9984           and erchek-key (1:33) = ws-compare-erchek-key
  9985           if (ch-void-dt = low-values)
  9986              and (not ch-denied)
  9987              if pi-check-type = 'R'
  9988                 and ch-check-origin-sw = 'C'
  9989                 continue
  9990              else
  9991                 compute pi-prev-paid = pi-prev-paid +
  9992                    ch-amount-paid
  9993                 add +1 to pi-chek-rec-cnt
  9994                 move ch-deduct-commission
  9995                                 to pi-prev-ded-comm
  9996                 if ch-credit-select-dt = pi-cr-month-end-dt
  9997                    compute pi-prev-paid-this-month =
  9998                       pi-prev-paid-this-month + ch-amount-paid
  9999                 end-if
 10000              end-if
 10001           end-if
 10002        else
 10003           set i-say-when to true
 10004        end-if
 10005     end-perform
 10006     .
 10007 6800-exit.
 10008     exit.
 10009 7000-SET-PI-AREA.
 10010     MOVE CARRIERI               TO  PI-CARRIER
 10011                                     PI-CHEK-CARRIER.
 10012     MOVE GROUPI                 TO  PI-GROUPING
 10013                                     PI-CHEK-GROUPING.
 10014     MOVE STATEI                 TO  PI-STATE
 10015                                     PI-CHEK-STATE.
 10016     MOVE ACCTI                  TO  PI-ACCOUNT
 10017                                     PI-CHEK-ACCOUNT.
 10018     MOVE CERTNOI                TO  PI-CERT-PRIME
 10019                                     PI-CHEK-CERT-NO.
 10020     IF SFXI NOT = LOW-VALUES
 10021         MOVE SFXI               TO  PI-CERT-SFX
 10022                                     PI-CHEK-SUF-NO
 10023     ELSE
 10024         MOVE SPACE              TO  PI-CERT-SFX
 10025                                     PI-CHEK-SUF-NO.
 10026
 10027     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
 10028     MOVE '2'                    TO  DC-OPTION-CODE.
 10029     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10030     IF DATE-CONVERSION-ERROR
 10031         MOVE ER-0215            TO  EMI-ERROR
 10032         MOVE -1                 TO  EFFDTL
 10033         MOVE AL-UNBON           TO  EFFDTA
 10034         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10035         GO TO 8200-SEND-DATAONLY
 10036     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 183
* EL677.cbl
 10037         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
 10038                                     PI-CHEK-EFF-DT.
 10039
 10040 7090-EXIT.
 10041      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 184
* EL677.cbl
 10043 7100-CREATE-TEMP-STORAGE.
 10044     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10045
 10046
 10047* EXEC CICS WRITEQ TS
 10048*        QUEUE   (QID)
 10049*        FROM    (PROGRAM-INTERFACE-BLOCK)
 10050*        LENGTH  (PI-COMM-LENGTH)
 10051*    END-EXEC.
 10052*    MOVE '*"     L              ''   #00009115' TO DFHEIV0
 10053     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 10054     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10055     MOVE X'2020233030303039313135' TO DFHEIV0(25:11)
 10056     CALL 'kxdfhei1' USING DFHEIV0,
 10057           QID,
 10058           PROGRAM-INTERFACE-BLOCK,
 10059           PI-COMM-LENGTH,
 10060           DFHEIV99,
 10061           DFHEIV99,
 10062           DFHEIV99
 10063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10064
 10065
 10066 7100-EXIT.
 10067      EXIT.
 10068
 10069 7200-RECOVER-TEMP-STORAGE.
 10070
 10071* EXEC CICS READQ TS
 10072*        QUEUE   (QID)
 10073*        INTO    (PROGRAM-INTERFACE-BLOCK)
 10074*        LENGTH  (PI-COMM-LENGTH)
 10075*    END-EXEC.
 10076*    MOVE '*$I    L              ''   #00009125' TO DFHEIV0
 10077     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
 10078     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10079     MOVE X'2020233030303039313235' TO DFHEIV0(25:11)
 10080     CALL 'kxdfhei1' USING DFHEIV0,
 10081           QID,
 10082           PROGRAM-INTERFACE-BLOCK,
 10083           PI-COMM-LENGTH,
 10084           DFHEIV99,
 10085           DFHEIV99,
 10086           DFHEIV99
 10087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10088
 10089
 10090     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10091
 10092 7200-EXIT.
 10093      EXIT.
 10094
 10095 7300-DELETE-TEMP-STORAGE.
 10096
 10097* EXEC CICS HANDLE CONDITION
 10098*        QIDERR  (7300-EXIT)
 10099*    END-EXEC.
 10100*    MOVE '"$N                   ! 3 #00009137' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 185
* EL677.cbl
 10101     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 10102     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10103     MOVE X'3320233030303039313337' TO DFHEIV0(25:11)
 10104     CALL 'kxdfhei1' USING DFHEIV0
 10105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10106
 10107
 10108
 10109* EXEC CICS DELETEQ TS
 10110*        QUEUE  (QID)
 10111*    END-EXEC.
 10112*    MOVE '*&                    #   #00009141' TO DFHEIV0
 10113     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 10114     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10115     MOVE X'2020233030303039313431' TO DFHEIV0(25:11)
 10116     CALL 'kxdfhei1' USING DFHEIV0,
 10117           QID,
 10118           DFHEIV99
 10119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10120
 10121
 10122 7300-EXIT.
 10123      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 186
* EL677.cbl
 10125 8035-LETR-NOT-OPEN.
 10126
 10127     MOVE ER-0013                TO EMI-ERROR.
 10128*    MOVE -1                     TO LETTER1L
 10129     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10130     GO TO 8200-SEND-DATAONLY.
 10131
 10132 8035-EXIT.
 10133     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 187
* EL677.cbl
 10135 8100-SEND-INITIAL-MAP.
 10136     MOVE SAVE-DATE              TO  DATEO.
 10137     MOVE EIBTIME                TO  TIME-IN.
 10138     MOVE TIME-OUT               TO  TIMEO.
 10139     MOVE -1                     TO  MAINTL
 10140     move al-uanon               to mainta
 10141     move dedcyni                to pi-previous-deduct-comm
 10142     if PI-TO-EL677-FROM-EL1273
 10143        move al-sadof            to pf357a
 10144                                    pf46a
 10145                                    dprema
 10146                                    dcomma
 10147                                    drefa
 10148                                    duecomma
 10149                                    dprepda
 10150                                    prema
 10151                                    isscomma
 10152                                    refa
 10153                                    uecomma
 10154                                    prepda
 10155                                    dmaint2a
 10156        move ', VOID(V)'         to dmaint1o
 10157     end-if
 10158     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10159     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10160
 10161
 10162* EXEC CICS SEND
 10163*        MAP      (EL677A)
 10164*        MAPSET   (MAPSET-NAME)
 10165*        FROM     (EL677AO)
 10166*        ERASE
 10167*        CURSOR
 10168*    END-EXEC.
 10169     MOVE LENGTH OF
 10170      EL677AO
 10171       TO DFHEIV12
 10172     MOVE -1
 10173       TO DFHEIV11
 10174*    MOVE '8$     CT  E    H L F ,   #00009184' TO DFHEIV0
 10175     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10176     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10177     MOVE X'2020233030303039313834' TO DFHEIV0(25:11)
 10178     CALL 'kxdfhei1' USING DFHEIV0,
 10179           EL677A,
 10180           EL677AO,
 10181           DFHEIV12,
 10182           MAPSET-NAME,
 10183           DFHEIV99,
 10184           DFHEIV99,
 10185           DFHEIV99,
 10186           DFHEIV11,
 10187           DFHEIV99,
 10188           DFHEIV99,
 10189           DFHEIV99
 10190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10191
 10192
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 188
* EL677.cbl
 10193     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 189
* EL677.cbl
 10195 8200-SEND-DATAONLY.
 10196     if connected-to-db
 10197        perform 4300-FINISH-UP-DB thru 4300-exit
 10198     end-if
 10199     MOVE SAVE-DATE              TO  DATEO.
 10200     MOVE EIBTIME                TO  TIME-IN.
 10201     MOVE TIME-OUT               TO  TIMEO.
 10202     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10203     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10204
 10205
 10206* EXEC CICS SEND
 10207*        MAP     (EL677A)
 10208*        MAPSET  (MAPSET-NAME)
 10209*        FROM    (EL677AO)
 10210*        DATAONLY
 10211*        CURSOR
 10212*    END-EXEC.
 10213     MOVE LENGTH OF
 10214      EL677AO
 10215       TO DFHEIV12
 10216     MOVE -1
 10217       TO DFHEIV11
 10218*    MOVE '8$D    CT       H L F ,   #00009204' TO DFHEIV0
 10219     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10220     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10221     MOVE X'2020233030303039323034' TO DFHEIV0(25:11)
 10222     CALL 'kxdfhei1' USING DFHEIV0,
 10223           EL677A,
 10224           EL677AO,
 10225           DFHEIV12,
 10226           MAPSET-NAME,
 10227           DFHEIV99,
 10228           DFHEIV99,
 10229           DFHEIV99,
 10230           DFHEIV11,
 10231           DFHEIV99,
 10232           DFHEIV99,
 10233           DFHEIV99
 10234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10235
 10236
 10237     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 190
* EL677.cbl
 10239 8300-SEND-TEXT.
 10240
 10241* EXEC CICS SEND TEXT
 10242*        FROM     (LOGOFF-TEXT)
 10243*        LENGTH   (LOGOFF-LENGTH)
 10244*        ERASE
 10245*        FREEKB
 10246*    END-EXEC.
 10247*    MOVE '8&      T  E F  H   F -   #00009215' TO DFHEIV0
 10248     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10249     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10250     MOVE X'2020233030303039323135' TO DFHEIV0(25:11)
 10251     CALL 'kxdfhei1' USING DFHEIV0,
 10252           LOGOFF-TEXT,
 10253           LOGOFF-LENGTH,
 10254           DFHEIV99,
 10255           DFHEIV99,
 10256           DFHEIV99,
 10257           DFHEIV99,
 10258           DFHEIV99,
 10259           DFHEIV99,
 10260           DFHEIV99,
 10261           DFHEIV99,
 10262           DFHEIV99,
 10263           DFHEIV99
 10264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10265
 10266
 10267
 10268* EXEC CICS RETURN
 10269*    END-EXEC.
 10270*    MOVE '.(                    ''   #00009222' TO DFHEIV0
 10271     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10272     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10273     MOVE X'2020233030303039323232' TO DFHEIV0(25:11)
 10274     CALL 'kxdfhei1' USING DFHEIV0,
 10275           DFHEIV99,
 10276           DFHEIV99,
 10277           DFHEIV99,
 10278           DFHEIV99,
 10279           DFHEIV99,
 10280           DFHEIV99
 10281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10282
 10283
 10284 8500-DATE-CONVERT.
 10285     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10286
 10287
 10288* EXEC CICS LINK
 10289*        PROGRAM    (PGM-NAME)
 10290*        COMMAREA   (DATE-CONVERSION-DATA)
 10291*        LENGTH     (DC-COMM-LENGTH)
 10292*    END-EXEC.
 10293*    MOVE '."C                   (   #00009228' TO DFHEIV0
 10294     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10295     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10296     MOVE X'2020233030303039323238' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 191
* EL677.cbl
 10297     CALL 'kxdfhei1' USING DFHEIV0,
 10298           PGM-NAME,
 10299           DATE-CONVERSION-DATA,
 10300           DC-COMM-LENGTH,
 10301           DFHEIV99,
 10302           DFHEIV99,
 10303           DFHEIV99,
 10304           DFHEIV99
 10305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10306
 10307
 10308 8500-EXIT.
 10309      EXIT.
 10310
 10311 8600-DEEDIT.
 10312
 10313* EXEC CICS BIF DEEDIT
 10314*        FIELD   (WS-DEEDIT-FIELD)
 10315*        LENGTH  (10)
 10316*    END-EXEC.
 10317     MOVE 10
 10318       TO DFHEIV11
 10319*    MOVE '@"L                   #   #00009238' TO DFHEIV0
 10320     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10321     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10322     MOVE X'2020233030303039323338' TO DFHEIV0(25:11)
 10323     CALL 'kxdfhei1' USING DFHEIV0,
 10324           WS-DEEDIT-FIELD,
 10325           DFHEIV11
 10326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10327
 10328
 10329 8600-EXIT.
 10330      EXIT.
 10331
 10332 8700-DEEDIT.
 10333
 10334* EXEC CICS BIF DEEDIT
 10335*        FIELD   (WS-DT-DEEDIT-FIELD)
 10336*        LENGTH  (10)
 10337*    END-EXEC.
 10338     MOVE 10
 10339       TO DFHEIV11
 10340*    MOVE '@"L                   #   #00009247' TO DFHEIV0
 10341     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10342     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10343     MOVE X'2020233030303039323437' TO DFHEIV0(25:11)
 10344     CALL 'kxdfhei1' USING DFHEIV0,
 10345           WS-DT-DEEDIT-FIELD,
 10346           DFHEIV11
 10347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10348
 10349
 10350 8700-EXIT.
 10351      EXIT.
 10352
 10353 8800-UNAUTHORIZED-ACCESS.
 10354     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 192
* EL677.cbl
 10355     GO TO 8300-SEND-TEXT.
 10356
 10357 8810-PF23.
 10358     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10359     MOVE XCTL-005               TO  PGM-NAME.
 10360     GO TO 9300-XCTL.
 10361
 10362
 10363 9100-RETURN-TRAN.
 10364     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10365     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10366
 10367* EXEC CICS RETURN
 10368*        TRANSID  (TRANS-ID)
 10369*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10370*        LENGTH   (PI-COMM-LENGTH)
 10371*    END-EXEC.
 10372*    MOVE '.(CT                  ''   #00009268' TO DFHEIV0
 10373     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10374     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10375     MOVE X'2020233030303039323638' TO DFHEIV0(25:11)
 10376     CALL 'kxdfhei1' USING DFHEIV0,
 10377           TRANS-ID,
 10378           PROGRAM-INTERFACE-BLOCK,
 10379           PI-COMM-LENGTH,
 10380           DFHEIV99,
 10381           DFHEIV99,
 10382           DFHEIV99
 10383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10384
 10385
 10386
 10387* GOBACK.
 10388     MOVE '9%                    "   ' TO DFHEIV0
 10389     MOVE 'EL677' TO DFHEIV1
 10390     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10391     GOBACK.
 10392
 10393 9200-RETURN-MAIN-MENU.
 10394     MOVE XCTL-626               TO  PGM-NAME.
 10395     GO TO 9300-XCTL.
 10396
 10397 9300-XCTL.
 10398
 10399* EXEC CICS XCTL
 10400*        PROGRAM    (PGM-NAME)
 10401*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10402*        LENGTH     (PI-COMM-LENGTH)
 10403*    END-EXEC.
 10404*    MOVE '.$C                   %   #00009281' TO DFHEIV0
 10405     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10406     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10407     MOVE X'2020233030303039323831' TO DFHEIV0(25:11)
 10408     CALL 'kxdfhei1' USING DFHEIV0,
 10409           PGM-NAME,
 10410           PROGRAM-INTERFACE-BLOCK,
 10411           PI-COMM-LENGTH,
 10412           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 193
* EL677.cbl
 10413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10414
 10415
 10416 9400-CLEAR.
 10417     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10418     MOVE SPACES                 TO  PI-PFKEY.
 10419     GO TO 9300-XCTL.
 10420
 10421 9500-PF12.
 10422     MOVE XCTL-010               TO  PGM-NAME.
 10423     GO TO 9300-XCTL.
 10424
 10425 9600-PGMID-ERROR.
 10426
 10427* EXEC CICS HANDLE CONDITION
 10428*        PGMIDERR    (8300-SEND-TEXT)
 10429*    END-EXEC.
 10430*    MOVE '"$L                   ! 4 #00009297' TO DFHEIV0
 10431     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10433     MOVE X'3420233030303039323937' TO DFHEIV0(25:11)
 10434     CALL 'kxdfhei1' USING DFHEIV0
 10435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10436
 10437
 10438     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10439     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10440     MOVE XCTL-005               TO  PGM-NAME.
 10441     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10442     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10443
 10444     GO TO 9300-XCTL.
 10445
 10446 9900-ERROR-FORMAT.
 10447     IF NOT EMI-ERRORS-COMPLETE
 10448         MOVE LINK-001           TO  PGM-NAME
 10449
 10450* EXEC CICS LINK
 10451*            PROGRAM    (PGM-NAME)
 10452*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10453*            LENGTH     (EMI-COMM-LENGTH)
 10454*        END-EXEC.
 10455*    MOVE '."C                   (   #00009312' TO DFHEIV0
 10456     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10458     MOVE X'2020233030303039333132' TO DFHEIV0(25:11)
 10459     CALL 'kxdfhei1' USING DFHEIV0,
 10460           PGM-NAME,
 10461           ERROR-MESSAGE-INTERFACE-BLOCK,
 10462           EMI-COMM-LENGTH,
 10463           DFHEIV99,
 10464           DFHEIV99,
 10465           DFHEIV99,
 10466           DFHEIV99
 10467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10468
 10469
 10470 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 194
* EL677.cbl
 10471      EXIT.
 10472
 10473 9990-ABEND.
 10474     MOVE LINK-004               TO  PGM-NAME.
 10475     MOVE DFHEIBLK               TO  EMI-LINE1.
 10476
 10477* EXEC CICS LINK
 10478*        PROGRAM   (PGM-NAME)
 10479*        COMMAREA  (EMI-LINE1)
 10480*        LENGTH    (72)
 10481*    END-EXEC.
 10482     MOVE 72
 10483       TO DFHEIV11
 10484*    MOVE '."C                   (   #00009324' TO DFHEIV0
 10485     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10487     MOVE X'2020233030303039333234' TO DFHEIV0(25:11)
 10488     CALL 'kxdfhei1' USING DFHEIV0,
 10489           PGM-NAME,
 10490           EMI-LINE1,
 10491           DFHEIV11,
 10492           DFHEIV99,
 10493           DFHEIV99,
 10494           DFHEIV99,
 10495           DFHEIV99
 10496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10497
 10498
 10499     GO TO 8200-SEND-DATAONLY.
 10500
 10501 9995-SECURITY-VIOLATION.
 10502*                            COPY ELCSCTP.
 10503******************************************************************
 10504*                                                                *
 10505*                            ELCSCTP                             *
 10506*                            VMOD=2.001                          *
 10507*                                                                *
 10508*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10509******************************************************************
 10510
 10511
 10512     MOVE EIBDATE          TO SM-JUL-DATE.
 10513     MOVE EIBTRMID         TO SM-TERMID.
 10514     MOVE THIS-PGM         TO SM-PGM.
 10515     MOVE EIBTIME          TO TIME-IN.
 10516     MOVE TIME-OUT         TO SM-TIME.
 10517     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10518
 10519
 10520* EXEC CICS LINK
 10521*         PROGRAM  ('EL003')
 10522*         COMMAREA (SECURITY-MESSAGE)
 10523*         LENGTH   (80)
 10524*    END-EXEC.
 10525     MOVE 'EL003' TO DFHEIV1
 10526     MOVE 80
 10527       TO DFHEIV11
 10528*    MOVE '."C                   (   #00009350' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 195
* EL677.cbl
 10529     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10531     MOVE X'2020233030303039333530' TO DFHEIV0(25:11)
 10532     CALL 'kxdfhei1' USING DFHEIV0,
 10533           DFHEIV1,
 10534           SECURITY-MESSAGE,
 10535           DFHEIV11,
 10536           DFHEIV99,
 10537           DFHEIV99,
 10538           DFHEIV99,
 10539           DFHEIV99
 10540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10541
 10542
 10543******************************************************************
 10544
 10545
 10546 9995-EXIT.
 10547     EXIT.
 10548
 10549
 10550 9999-DFHBACK SECTION.
 10551     MOVE '9%                    "   ' TO DFHEIV0
 10552     MOVE 'EL677' TO DFHEIV1
 10553     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10554     GOBACK.
 10555 9999-DFHEXIT.
 10556     IF DFHEIGDJ EQUAL 0001
 10557         NEXT SENTENCE
 10558     ELSE IF DFHEIGDJ EQUAL 2
 10559         GO TO 9600-PGMID-ERROR,
 10560               9990-ABEND
 10561         DEPENDING ON DFHEIGDI
 10562     ELSE IF DFHEIGDJ EQUAL 3
 10563         GO TO 8100-SEND-INITIAL-MAP
 10564         DEPENDING ON DFHEIGDI
 10565     ELSE IF DFHEIGDJ EQUAL 4
 10566         GO TO 1290-NO-CARRIER
 10567         DEPENDING ON DFHEIGDI
 10568     ELSE IF DFHEIGDJ EQUAL 5
 10569         GO TO 1380-NO-STATE
 10570         DEPENDING ON DFHEIGDI
 10571     ELSE IF DFHEIGDJ EQUAL 6
 10572         GO TO 1480-ACCOUNT-INVALID,
 10573               1480-ACCOUNT-INVALID
 10574         DEPENDING ON DFHEIGDI
 10575     ELSE IF DFHEIGDJ EQUAL 7
 10576         GO TO 1590-EXIT
 10577         DEPENDING ON DFHEIGDI
 10578     ELSE IF DFHEIGDJ EQUAL 8
 10579         GO TO 2200-DUPREC
 10580         DEPENDING ON DFHEIGDI
 10581     ELSE IF DFHEIGDJ EQUAL 9
 10582         GO TO 2577-DUPREC
 10583         DEPENDING ON DFHEIGDI
 10584     ELSE IF DFHEIGDJ EQUAL 10
 10585         GO TO 2600-NO-CO-MASTER
 10586         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 27-Jun-17 08:58 Page 196
* EL677.cbl
 10587     ELSE IF DFHEIGDJ EQUAL 11
 10588         GO TO 3900-RECORD-NOTFND
 10589         DEPENDING ON DFHEIGDI
 10590     ELSE IF DFHEIGDJ EQUAL 12
 10591         GO TO 3287-DUPREC
 10592         DEPENDING ON DFHEIGDI
 10593     ELSE IF DFHEIGDJ EQUAL 13
 10594         GO TO 3390-EXIT,
 10595               3390-EXIT
 10596         DEPENDING ON DFHEIGDI
 10597     ELSE IF DFHEIGDJ EQUAL 14
 10598         GO TO 5560-END-OF-FILE,
 10599               5560-END-OF-FILE
 10600         DEPENDING ON DFHEIGDI
 10601     ELSE IF DFHEIGDJ EQUAL 15
 10602         GO TO 6070-NO-COMP-MSTR
 10603         DEPENDING ON DFHEIGDI
 10604     ELSE IF DFHEIGDJ EQUAL 16
 10605         GO TO 6170-NO-CERTIFICATE
 10606         DEPENDING ON DFHEIGDI
 10607     ELSE IF DFHEIGDJ EQUAL 17
 10608         GO TO 6470-NO-ADDRESS
 10609         DEPENDING ON DFHEIGDI
 10610     ELSE IF DFHEIGDJ EQUAL 18
 10611         GO TO 6670-NO-beneficiary
 10612         DEPENDING ON DFHEIGDI
 10613     ELSE IF DFHEIGDJ EQUAL 19
 10614         GO TO 7300-EXIT
 10615         DEPENDING ON DFHEIGDI
 10616     ELSE IF DFHEIGDJ EQUAL 20
 10617         GO TO 8300-SEND-TEXT
 10618         DEPENDING ON DFHEIGDI.
 10619     MOVE '9%                    "   ' TO DFHEIV0
 10620     MOVE 'EL677' TO DFHEIV1
 10621     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10622     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      142876     Code:       39611
