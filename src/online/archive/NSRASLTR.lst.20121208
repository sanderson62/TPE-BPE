* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* NSRASLTR.cbl
* Options: int("NSRASLTR.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASLTR.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASLTR.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "NSRASLTR.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRASLTR.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM INDEX.HTML
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* NSRASLTR.cbl
    14* 060611    2011022800001  PEMA  NEW PROGRAM
    15* 080612    2011022800001  AJRA  ADD AHL
    16******************************************************************
    17 ENVIRONMENT DIVISION.
    18 DATA DIVISION.
    19 working-storage section.
    20 01  DFH-START PIC X(04).
    21 77  ws-comm-length      pic 9(4) BINARY.
    22 01  P pointer.
    23 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    24 01  WS-KIXHOST                  PIC X(10).
    25 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    26 01  var-ptr pointer.
    27 01  env-var-len                 pic 9(4)  binary.
    28 01  rc                          pic 9(9)  binary.
    29 01  bl-length                   pic s9(5) value +0 comp-3.
    30 01  sl-length                   pic 9(8) binary.
    31 01  WS-KIXSYS.
    32     05  WS-KIX-FIL1             PIC X(10).
    33     05  WS-KIX-APPS             PIC X(10).
    34     05  WS-KIX-ENV              PIC X(10).
    35     05  WS-KIX-MYENV            PIC X(10).
    36     05  WS-KIX-SYS              PIC X(10).
    37************************************************
    38* commarea passed to the business logic
    39************************************************
    40 01 srch-commarea.
    41*                                copy ELCADLTRSPI.
    42******************************************************************
    43*                   C H A N G E   L O G
    44*
    45* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    46*-----------------------------------------------------------------
    47*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    48* EFFECTIVE    NUMBER
    49*-----------------------------------------------------------------
    50* 060611    2011022800001  PEMA  NEW COPYBOOK
    51******************************************************************
    52****************************************
    53*  commarea for NaperSoft On Demand Admin services letters
    54*  (business logic input & output)
    55****************************************
    56     03  BL-INPUT.
    57         05  BL-DATA-SRCE        PIC X.
    58         05  BL-LETTER-ID        PIC XXXX.
    59         05  BL-CARRIER          PIC X.
    60         05  BL-GROUP            PIC X(6).
    61         05  BL-STATE            PIC XX.
    62         05  BL-ACCOUNT          PIC X(10).
    63         05  BL-EFF-DT           PIC X(10).
    64         05  BL-CERT-NO          PIC X(11).
    65         05  BL-BATCH-NO         PIC X(6).
    66         05  BL-BATCH-SEQ        PIC 9(8).
    67         05  BL-RESP-NO          PIC X(10).
    68         05  BL-NO-OF-COPIES     PIC 99.
    69         05  BL-PROC-ID          PIC XXXX.
    70         05  BL-COMP-ID          PIC XXX.
    71         05  BL-PRINT-NOW-SW     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* NSRASLTR.cbl
    72         05  BL-ENC-CD           PIC XXX.
    73         05  BL-RESEND-DT        PIC X(10).
    74         05  BL-FOLLOW-UP-DT     PIC X(10).
    75         05  BL-ARCHIVE-NO       PIC 9(8).
    76         05  BL-FUNC             PIC X(8).
    77         05  BL-COMMENTS         PIC X(70).
    78         05  FILLER REDEFINES BL-COMMENTS.
    79             10  BL-REASON-CODE OCCURS 12 PIC X(4).
    80             10  BL-LETTER-TO-ACCT PIC X.
    81             10  BL-LETTER-TO-BENE PIC X.
    82             10  BL-WRITE-ERARCH   PIC X.
    83                 88  ERARCH-QWS      VALUE 'Q'.
    84                 88  ERARCH-BATCH    VALUE 'B'.
    85                 88  ERARCH-TEMP     VALUE 'T'.
    86             10  BL-PROCESS-TYPE PIC X(07).
    87             10  BL-CERT-FORM-ID PIC X(05).
    88             10  FILLER          PIC X(07).
    89     03  BL-OUTPUT.
    90         05  BL-STATUS                   PIC X.
    91             88  BL-OK                      VALUE "P".
    92             88  BL-FAIL                  VALUE "F".
    93         05  BL-MESSAGE          PIC X(50).
    94     03  BL-RECORD-PASSED-DATA   PIC X(4754).
    95 01  INPUT-FROM-FORM.
    96     05  IFF-DATA-SRCE           PIC X.
    97     05  IFF-LETTER-ID           PIC XXXX.
    98     05  IFF-CARRIER             PIC X.
    99     05  IFF-GROUP               PIC X(6).
   100     05  IFF-STATE               PIC XX.
   101     05  IFF-ACCOUNT             PIC X(10).
   102     05  IFF-EFF-DT              PIC X(10).
   103     05  IFF-CERT-NO             PIC X(11).
   104     05  IFF-BATCH-NO            PIC X(6).
   105     05  IFF-BATCH-SEQ           PIC 9(8).
   106     05  IFF-RESP-NO             PIC X(10).
   107     05  IFF-NO-OF-COPIES        PIC 99.
   108     05  IFF-PROC-ID             PIC XXXX.
   109     05  IFF-COMP-ID             PIC XXX.
   110     05  IFF-PRINT-NOW-SW        PIC X.
   111     05  IFF-ENC-CD              PIC XXX.
   112     05  IFF-RESEND-DT           PIC X(10).
   113     05  IFF-FOLLOW-UP-DT        PIC X(10).
   114     05  IFF-ARCHIVE-NO          PIC 9(08).
   115     05  IFF-FUNC                PIC X(08).
   116     05  IFF-COMMENTS            PIC X(70).
   117************************************
   118* fields used to read web data
   119************************************
   120 01  w-form-name       pic x(80).
   121 01  w-form-value      pic x(80).
   122 01  w-form-name-len   pic s9(8) comp.
   123 01  w-form-value-len  pic s9(8) comp.
   124 01  w-resp            pic s9(8) comp.
   125 01  w-doctoken        pic x(16).
   126* COMP ID TPE REGION   GROUP NAME       HOST          HTTP PORT
   127*
   128*  CID      CID1P      AcctServCID     ntcso3            7001
   129*  CID      MDOFF      AcctServCID     ntnapersofttst    7003
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* NSRASLTR.cbl
   130*  CID      CID1T      AcctServCID     ntnapersofttst    6002
   131*  CID      PAUL       AcctServCID     ntnapersofttst    5002
   132*  CID      TONY       AcctServCID     ntnapersofttst    6003
   133*  DCC      CID1P      AcctServDCC     ntcso3            7001
   134*  DCC      MDOFF      AcctServDCC     ntnapersofttst    7003
   135*  DCC      CID1T      AcctServDCC     ntnapersofttst    6002
   136*  DCC      PAUL       AcctServDCC     ntnapersofttst    5002
   137*  DCC      TONY       AcctServDCC     ntnapersofttst    6003
   138*  AHL      CID1P      AcctServAHL     ntcso3            7001
   139*  AHL      MDOFF      AcctServAHL     ntnapersofttst    7003
   140*  AHL      CID1T      AcctServAHL     ntnapersofttst    6002
   141*  AHL      PAUL       AcctServAHL     ntnapersofttst    5002
   142*  AHL      TONY       AcctServAHL     ntnapersofttst    6003
   143******************************************
   144* symbol list text for ASERR template
   145******************************************
   146 01  WS-ASERR.
   147     05  F                       PIC X(6)  VALUE "PGMDT=".
   148     05  ASERR-DT                PIC X(12) VALUE ' '.
   149     05  F                       PIC X(5)  VALUE '&MSG='.
   150     05  ASERR-MESS              PIC X(50) VALUE ' '.
   151******************************************
   152* symbol list text for ASHDR template
   153******************************************
   154 01  WS-PROD-CID-ASHDR.
   155     05  F                       PIC X(7)  VALUE "SERVER=".
   156     05  F                       PIC X(11) VALUE 'ntcso3:8080'.
   157     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   158     05  F                       PIC X(11) VALUE 'AcctServCID'.
   159     05  F                       PIC X(7)  VALUE '&UNAME='.
   160     05  F                       PIC X(8)  VALUE 'batchjob'.
   161     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   162     05  F                       PIC X(8)  VALUE 'batchjob'.
   163 01  WS-PROD-DCC-ASHDR.
   164     05  F                       PIC X(7)  VALUE "SERVER=".
   165     05  F                       PIC X(11) VALUE 'ntcso3:8080'.
   166     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   167     05  F                       PIC X(11) VALUE 'AcctServDCC'.
   168     05  F                       PIC X(7)  VALUE '&UNAME='.
   169     05  F                       PIC X(8)  VALUE 'batchjob'.
   170     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   171     05  F                       PIC X(8)  VALUE 'batchjob'.
   172 01  WS-PROD-AHL-ASHDR.
   173     05  F                       PIC X(7)  VALUE "SERVER=".
   174     05  F                       PIC X(11) VALUE 'ntcso3:8080'.
   175     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   176     05  F                       PIC X(11) VALUE 'AcctServAHL'.
   177     05  F                       PIC X(7)  VALUE '&UNAME='.
   178     05  F                       PIC X(8)  VALUE 'batchjob'.
   179     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   180     05  F                       PIC X(8)  VALUE 'batchjob'.
   181 01  WS-TEST-CID-ASHDR.
   182     05  F                       PIC X(7)  VALUE "SERVER=".
   183     05  F                       PIC X(19) VALUE
   184                          'ntnapersofttst:8080'.
   185     05  F                       PIC X(11) VALUE '&GROUPNAME='.
   186     05  F                       PIC X(11) VALUE 'AcctServCID'.
   187     05  F                       PIC X(7)  VALUE '&UNAME='.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* NSRASLTR.cbl
   188     05  F                       PIC X(8)  VALUE 'batchjob'.
   189     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   190     05  F                       PIC X(8)  VALUE 'batchjob'.
   191 01  WS-TEST-DCC-ASHDR.
   192     05  F                       PIC X(7)  VALUE "SERVER=".
   193     05  F                       PIC X(19) VALUE
   194                            'ntnapersofttst:8080'.
   195     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   196     05  F                       PIC X(11) VALUE 'AcctServDCC'.
   197     05  F                       PIC X(7)  VALUE '&UNAME='.
   198     05  F                       PIC X(8)  VALUE 'batchjob'.
   199     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   200     05  F                       PIC X(8)  VALUE 'batchjob'.
   201
   202 01  WS-TEST-AHL-ASHDR.
   203     05  F                       PIC X(7)  VALUE "SERVER=".
   204     05  F                       PIC X(19) VALUE
   205                            'ntnapersofttst:8080'.
   206     05  F                       PIC X(11) VALUE "&GROUPNAME=".
   207     05  F                       PIC X(11) VALUE 'AcctServAHL'.
   208     05  F                       PIC X(7)  VALUE '&UNAME='.
   209     05  F                       PIC X(8)  VALUE 'batchjob'.
   210     05  F                       PIC X(11) VALUE '&UPASSWORD='.
   211     05  F                       PIC X(8)  VALUE 'batchjob'.
   212******************************************
   213* symbol list text for ASFTR template
   214******************************************
   215 01  WS-VAR-SLUNIKIX.
   216     05  FILLER                  PIC X(18) VALUE
   217                                 "HOSTINFO=slunikix:".
   218     05  WS-SL-PORT              PIC XXXX  VALUE '7001'.
   219     05  FILLER                  PIC X(11)  VALUE "&URLVARLST=".
   220     05  WS-SL-KEY               PIC X(20)  VALUE SPACES.
   221*    05  FILLER                  PIC X(20) VALUE
   222*                                "&HOSTINFO2=slunikix:".
   223*    05  WS-SL-PORT2             PIC XXXX  VALUE '7001'.
   224*    05  FILLER                  PIC X(12)  VALUE "&URLVARLST2=".
   225*    05  WS-SL-KEY2              PIC X(12)  VALUE SPACES.
   226 01  WS-VAR-LOGICTEST.
   227     05  FILLER                  PIC X(19) VALUE
   228                                 "HOSTINFO=logictest:".
   229     05  WS-LT-PORT              PIC XXXX  VALUE '6002'.
   230     05  FILLER                  PIC X(11)  VALUE "&URLVARLST=".
   231     05  WS-LT-KEY               PIC X(20)  VALUE SPACES.
   232*    05  FILLER                  PIC X(21) VALUE
   233*                                "&HOSTINFO2=logictest:".
   234*    05  WS-LT-PORT2             PIC XXXX  VALUE '6002'.
   235*    05  FILLER                  PIC X(12)  VALUE "&URLVARLST2=".
   236*    05  WS-LT-KEY2              PIC X(12)  VALUE SPACES.
   237 01 WS-ASFTR.
   238    05  OT-COMP-ID           PIC XXX.
   239    05  OT-PRINT-NOW-SW      PIC X.
   240    05  OT-ARCHIVE-NO        PIC 9(08).
   241    05  OT-FUNC              PIC X(08).
   242 01 output-msg.
   243    05 filler              pic x(4) value "MSG=".
   244    05 out-msg-text        pic x(50).
   245 01  MISC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* NSRASLTR.cbl
   246     12  WS-RESPONSE             PIC S9(8)   COMP.
   247         88  RESP-NORMAL                  VALUE +00.
   248         88  RESP-NOTFND                  VALUE +13.
   249         88  RESP-DUPREC                  VALUE +14.
   250         88  RESP-DUPKEY                  VALUE +15.
   251         88  RESP-NOTOPEN                 VALUE +19.
   252         88  RESP-ENDFILE                 VALUE +20.
   253*                                COPY ELCDATE.
   254******************************************************************
   255*                                                                *
   256*                                                                *
   257*                            ELCDATE.                            *
   258*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   259*                            VMOD=2.003
   260*                                                                *
   261*                                                                *
   262*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   263*                 LENGTH = 200                                   *
   264******************************************************************
   265
   266 01  DATE-CONVERSION-DATA.
   267     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   268     12  DC-OPTION-CODE                PIC X.
   269         88  BIN-TO-GREG                VALUE ' '.
   270         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   271         88  EDIT-GREG-TO-BIN           VALUE '2'.
   272         88  YMD-GREG-TO-BIN            VALUE '3'.
   273         88  MDY-GREG-TO-BIN            VALUE '4'.
   274         88  JULIAN-TO-BIN              VALUE '5'.
   275         88  BIN-PLUS-ELAPSED           VALUE '6'.
   276         88  FIND-CENTURY               VALUE '7'.
   277         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   278         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   279         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   280         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   281         88  JULIAN-TO-BIN-3            VALUE 'C'.
   282         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   283         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   284         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   285         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   286         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   287         88  CHECK-LEAP-YEAR            VALUE 'H'.
   288         88  BIN-3-TO-GREG              VALUE 'I'.
   289         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   290         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   291         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   292         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   293         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   294         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   295         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   296         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   297         88  THREE-CHARACTER-BIN
   298                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   299         88  GREGORIAN-TO-BIN
   300                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   301         88  BIN-TO-GREGORIAN
   302                  VALUES ' ' '1' 'I' '8' 'G'.
   303         88  JULIAN-TO-BINARY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* NSRASLTR.cbl
   304                  VALUES '5' 'C' 'E' 'F'.
   305     12  DC-ERROR-CODE                 PIC X.
   306         88  NO-CONVERSION-ERROR        VALUE ' '.
   307         88  DATE-CONVERSION-ERROR
   308                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   309         88  DATE-IS-ZERO               VALUE '1'.
   310         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   311         88  DATE-IS-INVALID            VALUE '3'.
   312         88  DATE1-GREATER-DATE2        VALUE '4'.
   313         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   314         88  DATE-INVALID-OPTION        VALUE '9'.
   315         88  INVALID-CENTURY            VALUE 'A'.
   316         88  ONLY-CENTURY               VALUE 'B'.
   317         88  ONLY-LEAP-YEAR             VALUE 'C'.
   318         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   319     12  DC-END-OF-MONTH               PIC X.
   320         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   321     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   322         88  USE-NORMAL-PROCESS         VALUE ' '.
   323         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   324         88  ADJUST-UP-100-YRS          VALUE '2'.
   325     12  FILLER                        PIC X.
   326     12  DC-CONVERSION-DATES.
   327         16  DC-BIN-DATE-1             PIC XX.
   328         16  DC-BIN-DATE-2             PIC XX.
   329         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   330         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   331                       DC-GREG-DATE-1-EDIT.
   332             20  DC-EDIT1-MONTH        PIC 99.
   333             20  SLASH1-1              PIC X.
   334             20  DC-EDIT1-DAY          PIC 99.
   335             20  SLASH1-2              PIC X.
   336             20  DC-EDIT1-YEAR         PIC 99.
   337         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   338         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   339                     DC-GREG-DATE-2-EDIT.
   340             20  DC-EDIT2-MONTH        PIC 99.
   341             20  SLASH2-1              PIC X.
   342             20  DC-EDIT2-DAY          PIC 99.
   343             20  SLASH2-2              PIC X.
   344             20  DC-EDIT2-YEAR         PIC 99.
   345         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   346         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   347                     DC-GREG-DATE-1-YMD.
   348             20  DC-YMD-YEAR           PIC 99.
   349             20  DC-YMD-MONTH          PIC 99.
   350             20  DC-YMD-DAY            PIC 99.
   351         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   352         16  DC-GREG-DATE-1-MDY-R REDEFINES
   353                      DC-GREG-DATE-1-MDY.
   354             20  DC-MDY-MONTH          PIC 99.
   355             20  DC-MDY-DAY            PIC 99.
   356             20  DC-MDY-YEAR           PIC 99.
   357         16  DC-GREG-DATE-1-ALPHA.
   358             20  DC-ALPHA-MONTH        PIC X(10).
   359             20  DC-ALPHA-DAY          PIC 99.
   360             20  FILLER                PIC XX.
   361             20  DC-ALPHA-CENTURY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* NSRASLTR.cbl
   362                 24 DC-ALPHA-CEN-N     PIC 99.
   363             20  DC-ALPHA-YEAR         PIC 99.
   364         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   365         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   366         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   367         16  DC-JULIAN-DATE            PIC 9(05).
   368         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   369                                       PIC 9(05).
   370         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   371             20  DC-JULIAN-YEAR        PIC 99.
   372             20  DC-JULIAN-DAYS        PIC 999.
   373         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   374         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   375         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   376     12  DATE-CONVERSION-VARIBLES.
   377         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   378         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   379             20  FILLER                PIC 9(3).
   380             20  HOLD-CEN-1-CCYY.
   381                 24  HOLD-CEN-1-CC     PIC 99.
   382                 24  HOLD-CEN-1-YY     PIC 99.
   383             20  HOLD-CEN-1-MO         PIC 99.
   384             20  HOLD-CEN-1-DA         PIC 99.
   385         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   386             20  HOLD-CEN-1-R-MO       PIC 99.
   387             20  HOLD-CEN-1-R-DA       PIC 99.
   388             20  HOLD-CEN-1-R-CCYY.
   389                 24  HOLD-CEN-1-R-CC   PIC 99.
   390                 24  HOLD-CEN-1-R-YY   PIC 99.
   391             20  FILLER                PIC 9(3).
   392         16  HOLD-CENTURY-1-X.
   393             20  FILLER                PIC X(3)  VALUE SPACES.
   394             20  HOLD-CEN-1-X-CCYY.
   395                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   396                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   397             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   398             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   399         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   400             20  HOLD-CEN-1-R-X-MO     PIC XX.
   401             20  HOLD-CEN-1-R-X-DA     PIC XX.
   402             20  HOLD-CEN-1-R-X-CCYY.
   403                 24  HOLD-CEN-1-R-X-CC PIC XX.
   404                 24  HOLD-CEN-1-R-X-YY PIC XX.
   405             20  FILLER                PIC XXX.
   406         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   407         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   408         16  DC-JULIAN-DATE-1          PIC 9(07).
   409         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   410             20  DC-JULIAN-1-CCYY.
   411                 24  DC-JULIAN-1-CC    PIC 99.
   412                 24  DC-JULIAN-1-YR    PIC 99.
   413             20  DC-JULIAN-DA-1        PIC 999.
   414         16  DC-JULIAN-DATE-2          PIC 9(07).
   415         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   416             20  DC-JULIAN-2-CCYY.
   417                 24  DC-JULIAN-2-CC    PIC 99.
   418                 24  DC-JULIAN-2-YR    PIC 99.
   419             20  DC-JULIAN-DA-2        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* NSRASLTR.cbl
   420         16  DC-GREG-DATE-A-EDIT.
   421             20  DC-EDITA-MONTH        PIC 99.
   422             20  SLASHA-1              PIC X VALUE '/'.
   423             20  DC-EDITA-DAY          PIC 99.
   424             20  SLASHA-2              PIC X VALUE '/'.
   425             20  DC-EDITA-CCYY.
   426                 24  DC-EDITA-CENT     PIC 99.
   427                 24  DC-EDITA-YEAR     PIC 99.
   428         16  DC-GREG-DATE-B-EDIT.
   429             20  DC-EDITB-MONTH        PIC 99.
   430             20  SLASHB-1              PIC X VALUE '/'.
   431             20  DC-EDITB-DAY          PIC 99.
   432             20  SLASHB-2              PIC X VALUE '/'.
   433             20  DC-EDITB-CCYY.
   434                 24  DC-EDITB-CENT     PIC 99.
   435                 24  DC-EDITB-YEAR     PIC 99.
   436         16  DC-GREG-DATE-CYMD         PIC 9(08).
   437         16  DC-GREG-DATE-CYMD-R REDEFINES
   438                              DC-GREG-DATE-CYMD.
   439             20  DC-CYMD-CEN           PIC 99.
   440             20  DC-CYMD-YEAR          PIC 99.
   441             20  DC-CYMD-MONTH         PIC 99.
   442             20  DC-CYMD-DAY           PIC 99.
   443         16  DC-GREG-DATE-MDCY         PIC 9(08).
   444         16  DC-GREG-DATE-MDCY-R REDEFINES
   445                              DC-GREG-DATE-MDCY.
   446             20  DC-MDCY-MONTH         PIC 99.
   447             20  DC-MDCY-DAY           PIC 99.
   448             20  DC-MDCY-CEN           PIC 99.
   449             20  DC-MDCY-YEAR          PIC 99.
   450    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   451        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   452    12  DC-EL310-DATE                  PIC X(21).
   453    12  FILLER                         PIC X(28).
   454*****************************************
   455* symbol list for the ASBOD template
   456*****************************************
   457*                                COPY NSCASVARS.
   458******************************************************************
   459*                   C H A N G E   L O G
   460*
   461* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   462*-----------------------------------------------------------------
   463*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   464* EFFECTIVE    NUMBER
   465*-----------------------------------------------------------------
   466* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
   467******************************************************************
   468 01 NAPER-OUTPUT-DATA.
   469    05  F                       PIC X(07) VALUE "LETTER=".
   470    05  OUT-LETTER              PIC X(06) VALUE SPACES.
   471    05  F                       PIC X(08) VALUE "~PROCID=".
   472    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
   473    05  F                       PIC X(10) VALUE "~PROCNAME=".
   474    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
   475    05  F                       PIC X(11) VALUE "~PROCTITLE=".
   476    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
   477    05  F                       PIC X(09) VALUE "~CSRNAME=".
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* NSRASLTR.cbl
   478    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
   479    05  F                       PIC X(10) VALUE "~CSRTITLE=".
   480    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
   481    05  F                       PIC X(06) VALUE "~CARR=".
   482    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
   483    05  F                       PIC X(10) VALUE "~GROUPING=".
   484    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
   485    05  F                       PIC X(08) VALUE "~CERTST=".
   486    05  OUT-STATE               PIC X(02) VALUE SPACES.
   487    05  F                       PIC X(09) VALUE "~ACCOUNT=".
   488    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
   489    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
   490    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
   491    05  F                       PIC X(07) VALUE "~CRTNO=".
   492    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
   493    05  F                       PIC X(08) VALUE "~CRTSUF=".
   494    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
   495    05  F                       PIC X(08) VALUE "~ILNAME=".
   496    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
   497    05  F                       PIC X(08) VALUE "~IFNAME=".
   498    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
   499    05  F                       PIC X(08) VALUE "~IFINIT=".
   500    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
   501    05  F                       PIC X(08) VALUE "~IMINIT=".
   502    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
   503    05  F                       PIC X(09) VALUE "~IISSAGE=".
   504    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
   505    05  F                       PIC X(06) VALUE "~ISEX=".
   506    05  OUT-ISEX                PIC X(01) VALUE SPACES.
   507    05  F                       PIC X(10) VALUE "~INSADDR1=".
   508    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
   509    05  F                       PIC X(10) VALUE "~INSADDR2=".
   510    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
   511    05  F                       PIC X(09) VALUE "~INSCITY=".
   512    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
   513    05  F                       PIC X(10) VALUE "~INSSTATE=".
   514    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
   515    05  F                       PIC X(08) VALUE "~INSZIP=".
   516    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
   517    05  F                       PIC X(05) VALUE "~SSN=".
   518    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
   519    05  F                       PIC X(07) VALUE "~MEMNO=".
   520    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
   521    05  F                       PIC X(08) VALUE "~JLNAME=".
   522    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
   523    05  F                       PIC X(08) VALUE "~JFNAME=".
   524    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
   525    05  F                       PIC X(08) VALUE "~JMINIT=".
   526    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
   527    05  F                       PIC X(08) VALUE "~JNTAGE=".
   528    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
   529    05  F                       PIC X(10) VALUE "~ACCTNAME=".
   530    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
   531    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
   532    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
   533    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
   534    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
   535    05  F                       PIC X(10) VALUE "~ACCTCITY=".
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* NSRASLTR.cbl
   536    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
   537    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
   538    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
   539    05  F                       PIC X(09) VALUE "~ACCTZIP=".
   540    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
   541    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
   542    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
   543    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
   544    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
   545    05  F                       PIC X(09) VALUE "~BUSTYPE=".
   546    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
   547    05  F                       PIC X(10) VALUE "~BENENAME=".
   548    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
   549    05  F                       PIC X(11) VALUE "~BENEADDR1=".
   550    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
   551    05  F                       PIC X(11) VALUE "~BENEADDR2=".
   552    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
   553    05  F                       PIC X(10) VALUE "~BENECITY=".
   554    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
   555    05  F                       PIC X(11) VALUE "~BENESTATE=".
   556    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
   557    05  F                       PIC X(09) VALUE "~BENEZIP=".
   558    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
   559    05  F                       PIC X(10) VALUE "~CARRNAME=".
   560    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
   561    05  F                       PIC X(08) VALUE "~RESPNO=".
   562    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
   563    05  F                       PIC X(12) VALUE "~COACCTNAME=".
   564    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
   565    05  F                       PIC X(12) VALUE "~COMAILNAME=".
   566    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
   567    05  F                       PIC X(11) VALUE "~COMPADDR1=".
   568    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
   569    05  F                       PIC X(11) VALUE "~COMPADDR2=".
   570    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
   571    05  F                       PIC X(10) VALUE "~COMPCITY=".
   572    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
   573    05  F                       PIC X(11) VALUE "~COMPSTATE=".
   574    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
   575    05  F                       PIC X(09) VALUE "~COMPZIP=".
   576    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
   577    05  F                       PIC X(11) VALUE "~COMPPHONE=".
   578    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
   579    05  F                       PIC X(09) VALUE "~COMPFAX=".
   580    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
   581    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
   582    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
   583    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
   584    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
   585    05  F                       PIC X(08) VALUE "~RPTCD1=".
   586    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
   587    05  F                       PIC X(08) VALUE "~RPTCD2=".
   588    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
   589    05  F                       PIC X(09) VALUE "~ENTRYDT=".
   590    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
   591    05  F                       PIC X(07) VALUE "~BATCH=".
   592    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
   593    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* NSRASLTR.cbl
   594    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
   595    05  F                       PIC X(10) VALUE "~1STPMTDT=".
   596    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
   597    05  F                       PIC X(05) VALUE "~APR=".
   598    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
   599    05  F                       PIC X(08) VALUE "~LNTERM=".
   600    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
   601    05  F                       PIC X(11) VALUE "~RATECLASS=".
   602    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
   603    05  F                       PIC X(09) VALUE "~EXTDAYS=".
   604    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
   605    05  F                       PIC X(09) VALUE "~CSRCODE=".
   606    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
   607    05  F                       PIC X(07) VALUE "~UCODE=".
   608    05  OUT-UCODE               PIC X(01) VALUE SPACES.
   609    05  F                       PIC X(10) VALUE "~PREMTYPE=".
   610    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
   611    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
   612    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
   613    05  F                       PIC X(06) VALUE "~SKIP=".
   614    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
   615    05  F                       PIC X(06) VALUE "~MODE=".
   616    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
   617    05  F                       PIC X(09) VALUE "~LOANOFF=".
   618    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
   619    05  F                       PIC X(06) VALUE "~RTBL=".
   620    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
   621    05  F                       PIC X(10) VALUE "~SPECREIN=".
   622    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
   623    05  F                       PIC X(09) VALUE "~LFBENCD=".
   624    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
   625    05  F                       PIC X(08) VALUE "~LFTERM=".
   626    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
   627    05  F                       PIC X(07) VALUE "~LFDEV=".
   628    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
   629    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
   630    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
   631    05  F                       PIC X(07) VALUE "~LFBEN=".
   632    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
   633    05  F                       PIC X(08) VALUE "~LFPREM=".
   634    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
   635    05  F                       PIC X(08) VALUE "~LFABEN=".
   636    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   637    05  F                       PIC X(09) VALUE "~LFAPREM=".
   638    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
   639    05  F                       PIC X(07) VALUE "~LFNSP=".
   640    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
   641    05  F                       PIC X(08) VALUE "~LFRBEN=".
   642    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   643    05  F                       PIC X(07) VALUE "~LFCAN=".
   644    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
   645    05  F                       PIC X(07) VALUE "~LFDTH=".
   646    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
   647    05  F                       PIC X(08) VALUE "~LFRATE=".
   648    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
   649    05  F                       PIC X(09) VALUE "~LFARATE=".
   650    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
   651    05  F                       PIC X(09) VALUE "~LFEXPDT=".
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* NSRASLTR.cbl
   652    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
   653    05  F                       PIC X(08) VALUE "~LFSTAT=".
   654    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
   655    05  F                       PIC X(09) VALUE "~LFCANDT=".
   656    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
   657    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
   658    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
   659    05  F                       PIC X(07) VALUE "~DTHDT=".
   660    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
   661    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
   662    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
   663    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
   664    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
   665    05  F                       PIC X(08) VALUE "~LFCOMM=".
   666    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
   667    05  F                       PIC X(11) VALUE "~LFBENDESC=".
   668    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
   669    05  F                       PIC X(11) VALUE "~LFBENABRV=".
   670    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
   671    05  F                       PIC X(09) VALUE "~AHBENCD=".
   672    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
   673    05  F                       PIC X(08) VALUE "~AHTERM=".
   674    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
   675    05  F                       PIC X(11) VALUE "~AHCRITPER=".
   676    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
   677    05  F                       PIC X(09) VALUE "~AHDEVCD=".
   678    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
   679    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
   680    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
   681    05  F                       PIC X(07) VALUE "~AHBEN=".
   682    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
   683    05  F                       PIC X(08) VALUE "~AHPREM=".
   684    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
   685    05  F                       PIC X(07) VALUE "~AHNSP=".
   686    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
   687    05  F                       PIC X(07) VALUE "~AHCAN=".
   688    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
   689    05  F                       PIC X(10) VALUE "~AHITDPMT=".
   690    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
   691    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
   692    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
   693    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
   694    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
   695    05  F                       PIC X(08) VALUE "~AHRATE=".
   696    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
   697    05  F                       PIC X(09) VALUE "~AHEXPDT=".
   698    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
   699    05  F                       PIC X(08) VALUE "~AHSTAT=".
   700    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
   701    05  F                       PIC X(09) VALUE "~AHCANDT=".
   702    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
   703    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
   704    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
   705    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
   706    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
   707    05  F                       PIC X(08) VALUE "~AHCOMM=".
   708    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
   709    05  F                       PIC X(11) VALUE "~AHBENDESC=".
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* NSRASLTR.cbl
   710    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
   711    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
   712    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
   713    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
   714    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
   715    05  F                       PIC X(08) VALUE "~AHWAIT=".
   716    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
   717    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
   718    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
   719    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
   720                                PIC X(2).
   721    05  F                       PIC X(09) VALUE "~TOTPREM=".
   722    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
   723    05  F                       PIC X(08) VALUE "~TOTREF=".
   724    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
   725    05  F                       PIC X(08) VALUE "~SEXPDT=".
   726    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
   727    05  F                       PIC X(07) VALUE "~STERM=".
   728    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
   729    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
   730    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
   731    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
   732    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
   733    05  F                       PIC X(11) VALUE "~IORIGINIT=".
   734    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
   735    05  F                       PIC X(10) VALUE "~IORIGAGE=".
   736    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
   737    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
   738    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
   739    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
   740    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
   741    05  F                       PIC X(11) VALUE "~JORIGINIT=".
   742    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
   743    05  F                       PIC X(10) VALUE "~JORIGAGE=".
   744    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
   745    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
   746    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
   747    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
   748    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
   749    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
   750    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
   751    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
   752                                PIC X(12).
   753    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
   754    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
   755    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
   756                                PIC X(12).
   757    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
   758    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
   759    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
   760    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
   761    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
   762    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
   763    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
   764    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
   765    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
   766                                PIC X(12).
   767    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* NSRASLTR.cbl
   768    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
   769    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
   770                                PIC X(10).
   771    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
   772    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
   773    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
   774    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
   775    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
   776    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
   777    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
   778    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
   779    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
   780    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
   781    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
   782    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
   783    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
   784                                PIC X(10).
   785    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
   786    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
   787    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
   788                                PIC X(10).
   789    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
   790    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
   791    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
   792    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
   793    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
   794    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
   795    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
   796    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
   797    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
   798    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
   799    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
   800    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
   801    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
   802    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
   803    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
   804    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
   805    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
   806    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
   807    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
   808                                PIC X(2).
   809    05  F                       PIC X(09) VALUE "~OSEXPDT=".
   810    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
   811    05  F                       PIC X(08) VALUE "~OSTERM=".
   812    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
   813    05  F                       PIC X(11) VALUE "~INEWLNAME=".
   814    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
   815    05  F                       PIC X(11) VALUE "~INEWFNAME=".
   816    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
   817    05  F                       PIC X(10) VALUE "~INEWINIT=".
   818    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
   819    05  F                       PIC X(09) VALUE "~INEWAGE=".
   820    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
   821    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
   822                                PIC X(09).
   823    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
   824    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
   825    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* NSRASLTR.cbl
   826    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
   827    05  F                       PIC X(10) VALUE "~JNEWINIT=".
   828    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
   829    05  F                       PIC X(09) VALUE "~JNEWAGE=".
   830    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
   831    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
   832                                PIC X(09).
   833    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
   834    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
   835    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
   836    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
   837    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
   838                                PIC X(09).
   839    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
   840    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
   841    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
   842                                PIC X(12).
   843    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
   844    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
   845    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
   846                                PIC X(10).
   847    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
   848    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
   849    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
   850    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
   851    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
   852                                PIC X(12).
   853    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
   854    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
   855    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
   856                                PIC X(10).
   857    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
   858    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
   859    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
   860    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
   861    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
   862    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
   863    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
   864    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
   865    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
   866                                PIC X(09).
   867    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
   868    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
   869    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
   870                                PIC X(09).
   871    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
   872    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
   873    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
   874                                PIC X(10).
   875    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
   876    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
   877    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
   878                                PIC X(10).
   879    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
   880    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
   881    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
   882    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
   883    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* NSRASLTR.cbl
   884    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
   885    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
   886    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
   887    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
   888    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
   889    05  F                       PIC X(09) VALUE "~NEWWAIT=".
   890    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
   891    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
   892    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
   893    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
   894                                PIC X(09).
   895    05  F                       PIC X(09) VALUE "~NSEXPDT=".
   896    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
   897    05  F                       PIC X(08) VALUE "~NSTERM=".
   898    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
   899    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
   900                                PIC X(09).
   901    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
   902    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
   903    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
   904    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
   905    05  F                       PIC X(11) VALUE "~PAYABLETO=".
   906    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
   907    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
   908    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
   909    05  F                       PIC X(09) VALUE "~BALLOON=".
   910    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
   911    05  F                       PIC X(10) VALUE "~LEASEIND=".
   912    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
   913    05  F                       PIC X(09) VALUE "~RESCIND=".
   914    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
   915    05  F                       PIC X(07) VALUE "~RCD01=".
   916    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
   917    05  F                       PIC X(07) VALUE "~RCD02=".
   918    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
   919    05  F                       PIC X(07) VALUE "~RCD03=".
   920    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
   921    05  F                       PIC X(07) VALUE "~RCD04=".
   922    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
   923    05  F                       PIC X(07) VALUE "~RCD05=".
   924    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
   925    05  F                       PIC X(07) VALUE "~RCD06=".
   926    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
   927    05  F                       PIC X(07) VALUE "~RCD07=".
   928    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
   929    05  F                       PIC X(07) VALUE "~RCD08=".
   930    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
   931    05  F                       PIC X(07) VALUE "~RCD09=".
   932    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
   933    05  F                       PIC X(07) VALUE "~RCD10=".
   934    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
   935    05  F                       PIC X(07) VALUE "~RCD11=".
   936    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
   937    05  F                       PIC X(07) VALUE "~RCD12=".
   938    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
   939    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
   940    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
   941    05  F                       PIC X(08) VALUE "~ARCHNO=".
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* NSRASLTR.cbl
   942    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
   943    05  F                       PIC X(06) VALUE "~FORM=".
   944    05  OUT-FORM                PIC X(03) VALUE SPACES.
   945    05  F                       PIC X(09) VALUE "~ENCLINE=".
   946    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
   947    05  F                       PIC X(08) VALUE "~ATTACH=".
   948    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
   949    05  F                       PIC X(10) VALUE "~OUTSTACK=".
   950    05  OUT-STACK               PIC X(10) VALUE SPACES.
   951    05  F                       PIC X(11) VALUE "~STATENAME=".
   952    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
   953    05  F                       PIC X(08) VALUE "~PRTNOW=".
   954    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
   955    05  F                       PIC X(05) VALUE "~NCB=".
   956    05  OUT-CHGBACK             PIC X     VALUE ' '.
   957    05  F                       PIC X(8) VALUE "~CSOAMT=".
   958    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
   959    05  F                       PIC X(9) VALUE "~ACCTAMT=".
   960    05  OUT-ACT-PORTION         PIC 9(7).99 VALUE ZEROS.
   961    05  F                       PIC X(8) VALUE "~TOPREM=".
   962    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
   963    05  F                       PIC X(7) VALUE "~TOREF=".
   964    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
   965    05  F                       PIC X(7) VALUE "~CANDT=".
   966    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
   967    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
   968    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
   969    05  F                       PIC X(08) VALUE "~UNDWID=".
   970    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
   971    05  F                       PIC X(8) VALUE "~TNPREM=".
   972    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
   973    05  F                       PIC X(7) VALUE "~TNREF=".
   974    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
   975    05  F                       PIC X(11) VALUE 'EndOfString'.
   976    05  f                       pic x(01) value spaces.
   977****************************************************************
   978*
   979* Copyright (c) 2007 by Clerity Solutions, Inc.
   980* All rights reserved.
   981*
   982****************************************************************
   983 01  DFHEIV.
   984   02  DFHEIV0               PIC X(35).
   985   02  DFHEIV1               PIC X(08).
   986   02  DFHEIV2               PIC X(08).
   987   02  DFHEIV3               PIC X(08).
   988   02  DFHEIV4               PIC X(06).
   989   02  DFHEIV5               PIC X(04).
   990   02  DFHEIV6               PIC X(04).
   991   02  DFHEIV7               PIC X(02).
   992   02  DFHEIV8               PIC X(02).
   993   02  DFHEIV9               PIC X(01).
   994   02  DFHEIV10              PIC S9(7) COMP-3.
   995   02  DFHEIV11              PIC S9(4) COMP SYNC.
   996   02  DFHEIV12              PIC S9(4) COMP SYNC.
   997   02  DFHEIV13              PIC S9(4) COMP SYNC.
   998   02  DFHEIV14              PIC S9(4) COMP SYNC.
   999   02  DFHEIV15              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* NSRASLTR.cbl
  1000   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1001   02  DFHEIV17              PIC X(04).
  1002   02  DFHEIV18              PIC X(04).
  1003   02  DFHEIV19              PIC X(04).
  1004   02  DFHEIV20              USAGE IS POINTER.
  1005   02  DFHEIV21              USAGE IS POINTER.
  1006   02  DFHEIV22              USAGE IS POINTER.
  1007   02  DFHEIV23              USAGE IS POINTER.
  1008   02  DFHEIV24              USAGE IS POINTER.
  1009   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1010   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1011   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1012   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1013   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1014   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1015   02  FILLER                PIC X(02).
  1016   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1017   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1018   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1019   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1020   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1021 LINKAGE  SECTION.
  1022*****************************************************************
  1023*                                                               *
  1024* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1025* All rights reserved.                                          *
  1026*                                                               *
  1027*****************************************************************
  1028 01  dfheiblk.
  1029     02  eibtime          pic s9(7) comp-3.
  1030     02  eibdate          pic s9(7) comp-3.
  1031     02  eibtrnid         pic x(4).
  1032     02  eibtaskn         pic s9(7) comp-3.
  1033     02  eibtrmid         pic x(4).
  1034     02  dfheigdi         pic s9(4) comp.
  1035     02  eibcposn         pic s9(4) comp.
  1036     02  eibcalen         pic s9(4) comp.
  1037     02  eibaid           pic x(1).
  1038     02  eibfiller1       pic x(1).
  1039     02  eibfn            pic x(2).
  1040     02  eibfiller2       pic x(2).
  1041     02  eibrcode         pic x(6).
  1042     02  eibfiller3       pic x(2).
  1043     02  eibds            pic x(8).
  1044     02  eibreqid         pic x(8).
  1045     02  eibrsrce         pic x(8).
  1046     02  eibsync          pic x(1).
  1047     02  eibfree          pic x(1).
  1048     02  eibrecv          pic x(1).
  1049     02  eibsend          pic x(1).
  1050     02  eibatt           pic x(1).
  1051     02  eibeoc           pic x(1).
  1052     02  eibfmh           pic x(1).
  1053     02  eibcompl         pic x(1).
  1054     02  eibsig           pic x(1).
  1055     02  eibconf          pic x(1).
  1056     02  eiberr           pic x(1).
  1057     02  eibrldbk         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* NSRASLTR.cbl
  1058     02  eiberrcd         pic x(4).
  1059     02  eibsynrb         pic x(1).
  1060     02  eibnodat         pic x(1).
  1061     02  eibfiller5       pic x(2).
  1062     02  eibresp          pic 9(09) comp.
  1063     02  eibresp2         pic 9(09) comp.
  1064     02  dfheigdj         pic s9(4) comp.
  1065     02  dfheigdk         pic s9(4) comp.
  1066 01  DFHCOMMAREA       PIC X(01).
  1067 01  var  pic x(30).
  1068 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  1069 0000-DFHEXIT SECTION.
  1070     MOVE '9#                    $   ' TO DFHEIV0.
  1071     MOVE 'NSRASLTR' TO DFHEIV1.
  1072     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1073*********************
  1074* Receive web input
  1075*********************
  1076     DISPLAY ' ENTERING NSRASLTR '
  1077     set P to address of KIXSYS
  1078     CALL "getenv" using by value P returning var-ptr
  1079     if var-ptr = null then
  1080        display ' kixsys not set '
  1081     else
  1082        set address of var to var-ptr
  1083        move 0 to env-var-len
  1084        inspect var tallying env-var-len
  1085          for characters before X'00'
  1086        DISPLAY '  KIXSYS = ' var (1:env-var-len)
  1087        unstring var (1:env-var-len) delimited by '/'
  1088           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  1089              WS-KIX-SYS
  1090        end-unstring
  1091*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  1092*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  1093     end-if
  1094     set P to address of KIXHOST
  1095     CALL "getenv" using by value P returning var-ptr
  1096     if var-ptr = null then
  1097        display ' kixhost not set '
  1098     else
  1099        set address of var to var-ptr
  1100        move 0 to env-var-len
  1101        inspect var tallying env-var-len
  1102          for characters before X'00'
  1103        MOVE var(1:env-var-len)  to ws-kixhost
  1104        DISPLAY ' WS KIX HOST ' WS-KIXHOST
  1105     end-if
  1106     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1107     MOVE '5'                    TO DC-OPTION-CODE
  1108     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  1109     MOVE DC-GREG-DATE-A-EDIT    TO ASERR-DT
  1110
  1111* exec cics web
  1112*       startbr formfield resp(w-resp)
  1113*     end-exec.
  1114*    MOVE 'X(f                   %  N#00001106' TO DFHEIV0
  1115     MOVE X'582866202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* NSRASLTR.cbl
  1116     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1117     MOVE X'204E233030303031313036' TO DFHEIV0(25:11)
  1118     CALL 'kxdfhei1' USING DFHEIV0,
  1119           DFHEIV99,
  1120           DFHEIV99,
  1121           DFHEIV99,
  1122           DFHEIV99
  1123     MOVE EIBRESP  TO w-resp
  1124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1125
  1126      perform read-form thru read-form-exit
  1127         until w-resp not = 0 .
  1128*   dfhresp(normal)
  1129
  1130* exec cics web
  1131*       endbr formfield
  1132*     end-exec
  1133*    MOVE 'X,f                   !   #00001111' TO DFHEIV0
  1134     MOVE X'582C66202020202020202020' TO DFHEIV0(1:12)
  1135     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1136     MOVE X'2020233030303031313131' TO DFHEIV0(25:11)
  1137     CALL 'kxdfhei1' USING DFHEIV0
  1138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1139     display ' form input ' INPUT-FROM-FORM
  1140     MOVE SPACES                  TO BL-INPUT
  1141     MOVE IFF-DATA-SRCE           TO BL-DATA-SRCE
  1142     MOVE IFF-CARRIER             TO BL-CARRIER
  1143     MOVE IFF-GROUP               TO BL-GROUP
  1144     MOVE IFF-STATE               TO BL-STATE
  1145     MOVE IFF-ACCOUNT             TO BL-ACCOUNT
  1146     MOVE IFF-EFF-DT              TO BL-EFF-DT
  1147     MOVE IFF-CERT-NO             TO BL-CERT-NO
  1148     MOVE IFF-BATCH-NO            TO BL-BATCH-NO
  1149     MOVE IFF-BATCH-SEQ           TO BL-BATCH-SEQ
  1150     MOVE IFF-RESP-NO             TO BL-RESP-NO
  1151     MOVE IFF-LETTER-ID           TO BL-LETTER-ID
  1152     MOVE IFF-NO-OF-COPIES        TO BL-NO-OF-COPIES
  1153     MOVE IFF-PROC-ID             TO BL-PROC-ID
  1154     MOVE IFF-COMP-ID             TO OT-COMP-ID
  1155                                     BL-COMP-ID
  1156     MOVE IFF-PRINT-NOW-SW        TO OT-PRINT-NOW-SW
  1157                                     BL-PRINT-NOW-SW
  1158     MOVE IFF-ENC-CD              TO BL-ENC-CD
  1159     MOVE IFF-RESEND-DT           TO BL-RESEND-DT
  1160     MOVE IFF-FOLLOW-UP-DT        TO BL-FOLLOW-UP-DT
  1161     MOVE IFF-COMMENTS            TO BL-COMMENTS
  1162     MOVE IFF-ARCHIVE-NO          TO BL-ARCHIVE-NO
  1163     MOVE IFF-FUNC                TO BL-FUNC
  1164                                     OT-FUNC
  1165*****************************************
  1166* Since this program was called from the webservice
  1167* we really don't know if a real letter is being created
  1168* a "T" below will create temporary erarch and nsasextr
  1169* records and "X" we won't create anything
  1170*****************************************
  1171     MOVE 'T'                    TO BL-WRITE-ERARCH
  1172     IF BL-PRINT-NOW-SW = 'P'
  1173        MOVE 'X'                 TO BL-WRITE-ERARCH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* NSRASLTR.cbl
  1174     END-IF
  1175     MOVE 'X'                 TO BL-WRITE-ERARCH
  1176*    DISPLAY ' INPUT FORM ' WS-KEY
  1177*****************************************
  1178* Invoke the LETTER business logic
  1179*****************************************
  1180     DISPLAY ' BL INPUT ' BL-INPUT
  1181     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
  1182     DISPLAY ' BL INPUT ' BL-INPUT
  1183     display ' srch commarea ' srch-commarea
  1184     display ' length ' ws-comm-length
  1185
  1186* exec cics link
  1187*       program('NSRASBL')
  1188*       commarea(srch-commarea)
  1189*       LENGTH  (WS-COMM-LENGTH)
  1190*    end-exec.
  1191     MOVE 'NSRASBL' TO DFHEIV1
  1192*    MOVE '."C                   ''   #00001160' TO DFHEIV0
  1193     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1194     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1195     MOVE X'2020233030303031313630' TO DFHEIV0(25:11)
  1196     CALL 'kxdfhei1' USING DFHEIV0,
  1197           DFHEIV1,
  1198           srch-commarea,
  1199           WS-COMM-LENGTH,
  1200           DFHEIV99,
  1201           DFHEIV99,
  1202           DFHEIV99
  1203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1204
  1205     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-output
  1206     IF BL-OK
  1207        perform varying bl-length from +4700 by -1 until
  1208           (bl-record-passed-data (bl-length:1) not = ' ')
  1209           or (bl-length = +1)
  1210        end-perform
  1211*       DISPLAY ' BL OK ' BL-ARCHIVE-NO
  1212        display ' bl length ' bl-length
  1213        move bl-length to sl-length
  1214        move spaces to naper-output-data
  1215        MOVE BL-RECORD-PASSED-DATA (1:bl-length)
  1216                                 TO NAPER-OUTPUT-DATA
  1217        MOVE BL-ARCHIVE-NO          TO OT-ARCHIVE-NO
  1218     ELSE
  1219        MOVE BL-MESSAGE          TO ASERR-MESS
  1220
  1221* exec cics document create
  1222*          doctoken   (w-doctoken)
  1223*          template   ('ASERR')
  1224*          symbollist (WS-ASERR)
  1225*          resp       (WS-RESPONSE)
  1226*       end-exec
  1227     MOVE LENGTH OF
  1228      WS-ASERR
  1229       TO DFHEIV16
  1230     MOVE 'ASERR'
  1231      TO DFHEIVL0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* NSRASLTR.cbl
  1232*    MOVE '\"D tSL               )  N#00001180' TO DFHEIV0
  1233     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1234     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1235     MOVE X'204E233030303031313830' TO DFHEIV0(25:11)
  1236     CALL 'kxdfhei1' USING DFHEIV0,
  1237           w-doctoken,
  1238           DFHEIV99,
  1239           DFHEIVL0,
  1240           WS-ASERR,
  1241           DFHEIV16,
  1242           DFHEIV99,
  1243           DFHEIV99,
  1244           DFHEIV99
  1245     MOVE EIBRESP  TO WS-RESPONSE
  1246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1247        display ' doc create ' ws-response
  1248
  1249* exec cics web send
  1250*          doctoken(w-doctoken)
  1251*                      resp   (WS-RESPONSE)
  1252*       end-exec
  1253*    MOVE 'X$D                   &  N#00001187' TO DFHEIV0
  1254     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1255     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1256     MOVE X'204E233030303031313837' TO DFHEIV0(25:11)
  1257     CALL 'kxdfhei1' USING DFHEIV0,
  1258           w-doctoken,
  1259           DFHEIV99,
  1260           DFHEIV99,
  1261           DFHEIV99,
  1262           DFHEIV99
  1263     MOVE EIBRESP  TO WS-RESPONSE
  1264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1265        display ' web send ' ws-response
  1266
  1267* exec cics
  1268*          return
  1269*       end-exec
  1270*    MOVE '.(                    &   #00001192' TO DFHEIV0
  1271     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1272     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1273     MOVE X'2020233030303031313932' TO DFHEIV0(25:11)
  1274     CALL 'kxdfhei1' USING DFHEIV0,
  1275           DFHEIV99,
  1276           DFHEIV99,
  1277           DFHEIV99,
  1278           DFHEIV99,
  1279           DFHEIV99
  1280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1281     END-IF
  1282     evaluate ws-kixhost
  1283        when 'slunikix'
  1284           evaluate ws-kix-myenv
  1285              when 'cid1p'
  1286                 move '7001'     to ws-sl-port
  1287*                                   ws-sl-port2
  1288              when 'mdoff'
  1289                 move '7003'     to ws-sl-port
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* NSRASLTR.cbl
  1290*                                   ws-sl-port2
  1291              when 'cid1t'
  1292                 move '7002'     to ws-sl-port
  1293*                                   ws-sl-port2
  1294           end-evaluate
  1295           move ws-asftr         to ws-sl-key
  1296*                                   ws-sl-key2
  1297        when 'logictest'
  1298           evaluate ws-kix-myenv
  1299              when 'cid1t'
  1300                 move '6002'     to ws-lt-port
  1301*                                   ws-lt-port2
  1302              when 'tony'
  1303                 move '6003'     to ws-lt-port
  1304*                                   ws-lt-port2
  1305              when 'paul'
  1306                 move '5002'     to ws-lt-port
  1307*                                   ws-lt-port2
  1308              when 'ahltst'
  1309                 move '6007'     to ws-lt-port
  1310*                                   ws-lt-port2
  1311           end-evaluate
  1312           move ws-asftr         to ws-lt-key
  1313*                                   ws-lt-key2
  1314     end-evaluate
  1315***********************************************************
  1316* Build output document.  There are three templates used
  1317* for this document.  ASHDR and ASFTR are the header
  1318* and footer, respectively.  ASBOD is used for the
  1319* actual data.  For each array entry in the business
  1320* logic output, set the symbol list from the array
  1321* entry and insert into the document using the ASBOD
  1322* template.
  1323***********************************************************
  1324*    move bl-output-message to out-msg-text.
  1325     IF IFF-COMP-ID = 'DCC'
  1326        IF WS-KIX-MYENV = 'cid1p'
  1327
  1328* exec cics document create
  1329*             doctoken   (w-doctoken)
  1330*             template   ('ASHDR')
  1331*             symbollist (WS-PROD-DCC-ASHDR)
  1332*             resp       (WS-RESPONSE)
  1333*          end-exec
  1334     MOVE LENGTH OF
  1335      WS-PROD-DCC-ASHDR
  1336       TO DFHEIV16
  1337     MOVE 'ASHDR'
  1338      TO DFHEIVL0
  1339*    MOVE '\"D tSL               )  N#00001241' TO DFHEIV0
  1340     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1341     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1342     MOVE X'204E233030303031323431' TO DFHEIV0(25:11)
  1343     CALL 'kxdfhei1' USING DFHEIV0,
  1344           w-doctoken,
  1345           DFHEIV99,
  1346           DFHEIVL0,
  1347           WS-PROD-DCC-ASHDR,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* NSRASLTR.cbl
  1348           DFHEIV16,
  1349           DFHEIV99,
  1350           DFHEIV99,
  1351           DFHEIV99
  1352     MOVE EIBRESP  TO WS-RESPONSE
  1353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1354        ELSE
  1355
  1356* exec cics document create
  1357*             doctoken   (w-doctoken)
  1358*             template   ('ASHDR')
  1359*             symbollist (WS-TEST-DCC-ASHDR)
  1360*             resp       (WS-RESPONSE)
  1361*          end-exec
  1362     MOVE LENGTH OF
  1363      WS-TEST-DCC-ASHDR
  1364       TO DFHEIV16
  1365     MOVE 'ASHDR'
  1366      TO DFHEIVL0
  1367*    MOVE '\"D tSL               )  N#00001248' TO DFHEIV0
  1368     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1369     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1370     MOVE X'204E233030303031323438' TO DFHEIV0(25:11)
  1371     CALL 'kxdfhei1' USING DFHEIV0,
  1372           w-doctoken,
  1373           DFHEIV99,
  1374           DFHEIVL0,
  1375           WS-TEST-DCC-ASHDR,
  1376           DFHEIV16,
  1377           DFHEIV99,
  1378           DFHEIV99,
  1379           DFHEIV99
  1380     MOVE EIBRESP  TO WS-RESPONSE
  1381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1382        END-IF
  1383     ELSE
  1384       IF IFF-COMP-ID = 'AHL'
  1385           IF WS-KIX-MYENV = 'cid1p'
  1386
  1387* exec cics document create
  1388*                doctoken   (w-doctoken)
  1389*                template   ('ASHDR')
  1390*                symbollist (WS-PROD-AHL-ASHDR)
  1391*                resp       (WS-RESPONSE)
  1392*             end-exec
  1393     MOVE LENGTH OF
  1394      WS-PROD-AHL-ASHDR
  1395       TO DFHEIV16
  1396     MOVE 'ASHDR'
  1397      TO DFHEIVL0
  1398*    MOVE '\"D tSL               )  N#00001258' TO DFHEIV0
  1399     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1400     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1401     MOVE X'204E233030303031323538' TO DFHEIV0(25:11)
  1402     CALL 'kxdfhei1' USING DFHEIV0,
  1403           w-doctoken,
  1404           DFHEIV99,
  1405           DFHEIVL0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* NSRASLTR.cbl
  1406           WS-PROD-AHL-ASHDR,
  1407           DFHEIV16,
  1408           DFHEIV99,
  1409           DFHEIV99,
  1410           DFHEIV99
  1411     MOVE EIBRESP  TO WS-RESPONSE
  1412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1413           ELSE
  1414
  1415* exec cics document create
  1416*                doctoken   (w-doctoken)
  1417*                template   ('ASHDR')
  1418*                symbollist (WS-TEST-AHL-ASHDR)
  1419*                resp       (WS-RESPONSE)
  1420*             end-exec
  1421     MOVE LENGTH OF
  1422      WS-TEST-AHL-ASHDR
  1423       TO DFHEIV16
  1424     MOVE 'ASHDR'
  1425      TO DFHEIVL0
  1426*    MOVE '\"D tSL               )  N#00001265' TO DFHEIV0
  1427     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1428     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1429     MOVE X'204E233030303031323635' TO DFHEIV0(25:11)
  1430     CALL 'kxdfhei1' USING DFHEIV0,
  1431           w-doctoken,
  1432           DFHEIV99,
  1433           DFHEIVL0,
  1434           WS-TEST-AHL-ASHDR,
  1435           DFHEIV16,
  1436           DFHEIV99,
  1437           DFHEIV99,
  1438           DFHEIV99
  1439     MOVE EIBRESP  TO WS-RESPONSE
  1440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1441           END-IF
  1442       ELSE
  1443         IF WS-KIX-MYENV = 'cid1p'
  1444
  1445* exec cics document create
  1446*             doctoken   (w-doctoken)
  1447*             template   ('ASHDR')
  1448*             symbollist (WS-PROD-CID-ASHDR)
  1449*             resp       (WS-RESPONSE)
  1450*          end-exec
  1451     MOVE LENGTH OF
  1452      WS-PROD-CID-ASHDR
  1453       TO DFHEIV16
  1454     MOVE 'ASHDR'
  1455      TO DFHEIVL0
  1456*    MOVE '\"D tSL               )  N#00001274' TO DFHEIV0
  1457     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1458     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1459     MOVE X'204E233030303031323734' TO DFHEIV0(25:11)
  1460     CALL 'kxdfhei1' USING DFHEIV0,
  1461           w-doctoken,
  1462           DFHEIV99,
  1463           DFHEIVL0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* NSRASLTR.cbl
  1464           WS-PROD-CID-ASHDR,
  1465           DFHEIV16,
  1466           DFHEIV99,
  1467           DFHEIV99,
  1468           DFHEIV99
  1469     MOVE EIBRESP  TO WS-RESPONSE
  1470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1471         ELSE
  1472
  1473* exec cics document create
  1474*             doctoken   (w-doctoken)
  1475*             template   ('ASHDR')
  1476*             symbollist (WS-TEST-CID-ASHDR)
  1477*             resp       (WS-RESPONSE)
  1478*          end-exec
  1479     MOVE LENGTH OF
  1480      WS-TEST-CID-ASHDR
  1481       TO DFHEIV16
  1482     MOVE 'ASHDR'
  1483      TO DFHEIVL0
  1484*    MOVE '\"D tSL               )  N#00001281' TO DFHEIV0
  1485     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  1486     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1487     MOVE X'204E233030303031323831' TO DFHEIV0(25:11)
  1488     CALL 'kxdfhei1' USING DFHEIV0,
  1489           w-doctoken,
  1490           DFHEIV99,
  1491           DFHEIVL0,
  1492           WS-TEST-CID-ASHDR,
  1493           DFHEIV16,
  1494           DFHEIV99,
  1495           DFHEIV99,
  1496           DFHEIV99
  1497     MOVE EIBRESP  TO WS-RESPONSE
  1498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1499         END-IF
  1500       END-IF
  1501     END-IF
  1502*    DISPLAY ' ASHDR DOC CREATE ' WS-RESPONSE
  1503*    move 1 to bl-index.
  1504*
  1505*    perform bl-output-record-count times
  1506*
  1507*        move bl-output-account-number(bl-index)
  1508*          to out-account-number
  1509*        move bl-output-last-name(bl-index)
  1510*          to out-last-name
  1511*        move bl-output-first-name(bl-index)
  1512*          to out-first-name
  1513*        move bl-output-middle-initial(bl-index)
  1514*          to out-middle-initial
  1515*
  1516*    MOVE 'EL01'                 TO OUT-TEMP
  1517*    MOVE 'ALWA'                 TO OUT-PROC-ID
  1518*    MOVE 'EL01'                 TO OUT-LETTER
  1519*    MOVE '9'                    TO OUT-CARRIER
  1520*    MOVE 'MCDANIEL'             TO OUT-ILNAME
  1521*    MOVE 'KATHI'                TO OUT-IFNAME
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* NSRASLTR.cbl
  1522*
  1523*    MOVE '0009235906 '          TO OUT-CERT-NO
  1524*    MOVE '0990000208'           TO OUT-ACCOUNT
  1525
  1526* exec cics document set
  1527*       doctoken(w-doctoken)
  1528*       symbollist(NAPER-OUTPUT-DATA (1:bl-length))
  1529*       delimiter ('?')
  1530*       length(length of NAPER-OUTPUT-DATA)
  1531*       length(sl-length)
  1532*                   resp   (WS-RESPONSE)
  1533*     unescaped
  1534*    end-exec
  1535*    MOVE '\(Ds L                ''  N#00001313' TO DFHEIV0
  1536     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1537     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1538     MOVE X'204E233030303031333133' TO DFHEIV0(25:11)
  1539     CALL 'kxdfhei1' USING DFHEIV0,
  1540           w-doctoken,
  1541           NAPER-OUTPUT-DATA(1 : bl-length),
  1542           DFHEIV99,
  1543           sl-length,
  1544           DFHEIV99,
  1545           DFHEIV99
  1546     MOVE EIBRESP  TO WS-RESPONSE
  1547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1548*    DISPLAY ' DOC SET    ' WS-RESPONSE
  1549
  1550* exec cics document insert
  1551*       doctoken(w-doctoken)
  1552*       template('ASBOD')
  1553*                   resp   (WS-RESPONSE)
  1554*    end-exec
  1555     MOVE 'ASBOD'
  1556      TO DFHEIVL0
  1557*    MOVE '\$Dt                  (  N#00001323' TO DFHEIV0
  1558     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1560     MOVE X'204E233030303031333233' TO DFHEIV0(25:11)
  1561     CALL 'kxdfhei1' USING DFHEIV0,
  1562           w-doctoken,
  1563           DFHEIVL0,
  1564           DFHEIV99,
  1565           DFHEIV99,
  1566           DFHEIV99,
  1567           DFHEIV99,
  1568           DFHEIV99
  1569     MOVE EIBRESP  TO WS-RESPONSE
  1570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1571     IF BL-LETTER-TO-ACCT NOT = SPACES
  1572        MOVE BL-LETTER-TO-ACCT   TO NAPER-OUTPUT-DATA (12:1)
  1573*       MOVE 'EL01T'             TO NAPER-OUTPUT-DATA (8:6)
  1574
  1575* exec cics document set
  1576*          doctoken(w-doctoken)
  1577*          symbollist(NAPER-OUTPUT-DATA (1:bl-length))
  1578*          length(sl-length)
  1579*          resp   (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* NSRASLTR.cbl
  1580*       end-exec
  1581*    MOVE '\(Ds L                ''  N#00001331' TO DFHEIV0
  1582     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1583     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1584     MOVE X'204E233030303031333331' TO DFHEIV0(25:11)
  1585     CALL 'kxdfhei1' USING DFHEIV0,
  1586           w-doctoken,
  1587           NAPER-OUTPUT-DATA(1 : bl-length),
  1588           DFHEIV99,
  1589           sl-length,
  1590           DFHEIV99,
  1591           DFHEIV99
  1592     MOVE EIBRESP  TO WS-RESPONSE
  1593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1594
  1595* exec cics document insert
  1596*          doctoken(w-doctoken)
  1597*          template('ASBOD')
  1598*          resp   (WS-RESPONSE)
  1599*       end-exec
  1600     MOVE 'ASBOD'
  1601      TO DFHEIVL0
  1602*    MOVE '\$Dt                  (  N#00001337' TO DFHEIV0
  1603     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1604     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1605     MOVE X'204E233030303031333337' TO DFHEIV0(25:11)
  1606     CALL 'kxdfhei1' USING DFHEIV0,
  1607           w-doctoken,
  1608           DFHEIVL0,
  1609           DFHEIV99,
  1610           DFHEIV99,
  1611           DFHEIV99,
  1612           DFHEIV99,
  1613           DFHEIV99
  1614     MOVE EIBRESP  TO WS-RESPONSE
  1615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1616     END-IF
  1617     IF BL-LETTER-TO-BENE NOT = SPACES
  1618        MOVE BL-LETTER-TO-BENE   TO NAPER-OUTPUT-DATA (12:1)
  1619*       MOVE 'EL01T'             TO NAPER-OUTPUT-DATA (8:6)
  1620
  1621* exec cics document set
  1622*          doctoken(w-doctoken)
  1623*          symbollist(NAPER-OUTPUT-DATA (1:bl-length))
  1624*          length(sl-length)
  1625*          resp   (WS-RESPONSE)
  1626*       end-exec
  1627*    MOVE '\(Ds L                ''  N#00001346' TO DFHEIV0
  1628     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1629     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1630     MOVE X'204E233030303031333436' TO DFHEIV0(25:11)
  1631     CALL 'kxdfhei1' USING DFHEIV0,
  1632           w-doctoken,
  1633           NAPER-OUTPUT-DATA(1 : bl-length),
  1634           DFHEIV99,
  1635           sl-length,
  1636           DFHEIV99,
  1637           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* NSRASLTR.cbl
  1638     MOVE EIBRESP  TO WS-RESPONSE
  1639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1640
  1641* exec cics document insert
  1642*          doctoken(w-doctoken)
  1643*          template('ASBOD')
  1644*          resp   (WS-RESPONSE)
  1645*       end-exec
  1646     MOVE 'ASBOD'
  1647      TO DFHEIVL0
  1648*    MOVE '\$Dt                  (  N#00001352' TO DFHEIV0
  1649     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1650     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1651     MOVE X'204E233030303031333532' TO DFHEIV0(25:11)
  1652     CALL 'kxdfhei1' USING DFHEIV0,
  1653           w-doctoken,
  1654           DFHEIVL0,
  1655           DFHEIV99,
  1656           DFHEIV99,
  1657           DFHEIV99,
  1658           DFHEIV99,
  1659           DFHEIV99
  1660     MOVE EIBRESP  TO WS-RESPONSE
  1661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1662     END-IF
  1663*    DISPLAY ' ASBOD DOC INSERT ' WS-RESPONSE
  1664*
  1665*        add 1 to bl-index
  1666*
  1667*    end-perform.
  1668*    MOVE BL-CARRIER  TO OT-CARRIER
  1669*    MOVE BL-CLAIM-NO TO OT-CLMNO
  1670*    MOVE BL-CERT-NO  TO OT-CRTNO
  1671*    MOVE BL-ARCHIVE-NO TO OT-ARCHNO
  1672     IF WS-KIXHOST = 'slunikix'
  1673        display ' host slunikix ' ws-kixhost
  1674
  1675* exec cics document set
  1676*          doctoken(w-doctoken)
  1677*          symbollist(WS-VAR-SLUNIKIX)
  1678*          length(length of WS-VAR-SLUNIKIX)
  1679*                      resp   (WS-RESPONSE)
  1680*       end-exec
  1681     MOVE LENGTH OF
  1682      WS-VAR-SLUNIKIX TO DFHEIV16
  1683*    MOVE '\(Ds L                ''  N#00001369' TO DFHEIV0
  1684     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1685     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1686     MOVE X'204E233030303031333639' TO DFHEIV0(25:11)
  1687     CALL 'kxdfhei1' USING DFHEIV0,
  1688           w-doctoken,
  1689           WS-VAR-SLUNIKIX,
  1690           DFHEIV99,
  1691           DFHEIV16,
  1692           DFHEIV99,
  1693           DFHEIV99
  1694     MOVE EIBRESP  TO WS-RESPONSE
  1695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* NSRASLTR.cbl
  1696     else
  1697        display ' host logictest ' ws-kixhost
  1698
  1699* exec cics document set
  1700*          doctoken(w-doctoken)
  1701*          symbollist(WS-VAR-LOGICTEST)
  1702*          length(length of WS-VAR-LOGICTEST)
  1703*                      resp   (WS-RESPONSE)
  1704*       end-exec
  1705     MOVE LENGTH OF
  1706      WS-VAR-LOGICTEST TO DFHEIV16
  1707*    MOVE '\(Ds L                ''  N#00001377' TO DFHEIV0
  1708     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
  1709     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1710     MOVE X'204E233030303031333737' TO DFHEIV0(25:11)
  1711     CALL 'kxdfhei1' USING DFHEIV0,
  1712           w-doctoken,
  1713           WS-VAR-LOGICTEST,
  1714           DFHEIV99,
  1715           DFHEIV16,
  1716           DFHEIV99,
  1717           DFHEIV99
  1718     MOVE EIBRESP  TO WS-RESPONSE
  1719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1720     end-if
  1721*    DISPLAY ' DOC SET ' WS-RESPONSE
  1722
  1723* exec cics document insert
  1724*       doctoken(w-doctoken)
  1725*       template('ASFTR')
  1726*                   resp   (WS-RESPONSE)
  1727*    end-exec
  1728     MOVE 'ASFTR'
  1729      TO DFHEIVL0
  1730*    MOVE '\$Dt                  (  N#00001385' TO DFHEIV0
  1731     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
  1732     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1733     MOVE X'204E233030303031333835' TO DFHEIV0(25:11)
  1734     CALL 'kxdfhei1' USING DFHEIV0,
  1735           w-doctoken,
  1736           DFHEIVL0,
  1737           DFHEIV99,
  1738           DFHEIV99,
  1739           DFHEIV99,
  1740           DFHEIV99,
  1741           DFHEIV99
  1742     MOVE EIBRESP  TO WS-RESPONSE
  1743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1744*    DISPLAY ' ASFTR DOC INSERT ' WS-RESPONSE
  1745*    if bl-fail
  1746*       exec cics syncpoint rollback
  1747*       end-exec
  1748*    end-if.
  1749****************************************
  1750* Send the document and return.
  1751****************************************
  1752
  1753* exec cics web send
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* NSRASLTR.cbl
  1754*       doctoken(w-doctoken)
  1755*                   resp   (WS-RESPONSE)
  1756*    end-exec.
  1757*    MOVE 'X$D                   &  N#00001398' TO DFHEIV0
  1758     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  1759     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1760     MOVE X'204E233030303031333938' TO DFHEIV0(25:11)
  1761     CALL 'kxdfhei1' USING DFHEIV0,
  1762           w-doctoken,
  1763           DFHEIV99,
  1764           DFHEIV99,
  1765           DFHEIV99,
  1766           DFHEIV99
  1767     MOVE EIBRESP  TO WS-RESPONSE
  1768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1769
  1770*    DISPLAY ' WEB SEND  ' WS-RESPONSE
  1771*    DISPLAY ' ABOUT TO RETURN '
  1772
  1773* exec cics
  1774*       return
  1775*    end-exec.
  1776*    MOVE '.(                    &   #00001404' TO DFHEIV0
  1777     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1778     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1779     MOVE X'2020233030303031343034' TO DFHEIV0(25:11)
  1780     CALL 'kxdfhei1' USING DFHEIV0,
  1781           DFHEIV99,
  1782           DFHEIV99,
  1783           DFHEIV99,
  1784           DFHEIV99,
  1785           DFHEIV99
  1786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1787
  1788******************************************************
  1789* Read all fields of the incoming form, moving
  1790* each to the corresponding field of the commarea
  1791* (business logic input fields).
  1792******************************************************
  1793 read-form.
  1794     move spaces to w-form-name.
  1795     move length of w-form-name to w-form-name-len.
  1796           move spaces to w-form-value.
  1797     move length of w-form-value to w-form-value-len.
  1798
  1799* exec cics web readnext
  1800*                  formfield(w-form-name)
  1801*                  namelength(w-form-name-len)
  1802*                  value(w-form-value)
  1803*                  valuelength(w-form-value-len)
  1804*                  resp(w-resp)
  1805*    end-exec.
  1806*    MOVE 'X*FLVL                %  N#00001417' TO DFHEIV0
  1807     MOVE X'582A464C564C202020202020' TO DFHEIV0(1:12)
  1808     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1809     MOVE X'204E233030303031343137' TO DFHEIV0(25:11)
  1810     CALL 'kxdfhei1' USING DFHEIV0,
  1811           w-form-name,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* NSRASLTR.cbl
  1812           w-form-name-len,
  1813           w-form-value,
  1814           w-form-value-len
  1815     MOVE EIBRESP  TO w-resp
  1816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1817
  1818     evaluate w-resp
  1819        when 0
  1820*   dfhresp(normal)
  1821           evaluate w-form-name(1:w-form-name-len)
  1822              when 'data_src'
  1823                 if w-form-value-len not = 0
  1824                    move w-form-value(1:w-form-value-len)
  1825                                 to IFF-DATA-SRCE
  1826                 else
  1827                                move spaces to IFF-DATA-SRCE
  1828                 end-if
  1829              when 'letter_id'
  1830                 if w-form-value-len not = 0
  1831                    move w-form-value(1:w-form-value-len)
  1832                                 to IFF-LETTER-ID
  1833                 else
  1834                                move spaces to IFF-LETTER-ID
  1835                 end-if
  1836              when 'carrier'
  1837                 if w-form-value-len not = 0
  1838                    move w-form-value(1:w-form-value-len)
  1839                             to IFF-CARRIER
  1840                 else
  1841                                move spaces to IFF-CARRIER
  1842                 end-if
  1843              when 'grouping'
  1844                             if w-form-value-len not = 0
  1845                    move w-form-value(1:w-form-value-len)
  1846                                                   to IFF-GROUP
  1847                 else
  1848                                move spaces  to IFF-GROUP
  1849                 end-if
  1850              when 'state_cd'
  1851                             if w-form-value-len not = 0
  1852                    move w-form-value(1:w-form-value-len)
  1853                                 to IFF-STATE
  1854                 else
  1855                                move spaces  to IFF-STATE
  1856                 end-if
  1857              when 'acct_no'
  1858                             if w-form-value-len not = 0
  1859                    move w-form-value(1:w-form-value-len)
  1860                                 to IFF-ACCOUNT
  1861                 else
  1862                    move spaces  to IFF-ACCOUNT
  1863                 end-if
  1864              when 'eff_date'
  1865                             if w-form-value-len not = 0
  1866                    move w-form-value(1:w-form-value-len)
  1867                                 to IFF-EFF-DT
  1868                 else
  1869                                move spaces  to IFF-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* NSRASLTR.cbl
  1870                 end-if
  1871              when 'cert_no'
  1872                             if w-form-value-len not = 0
  1873                    move w-form-value(1:w-form-value-len)
  1874                                 to IFF-CERT-NO
  1875                 else
  1876                                move spaces  to IFF-CERT-NO
  1877                 end-if
  1878              when 'batch_no'
  1879                             if w-form-value-len not = 0
  1880                    move w-form-value(1:w-form-value-len)
  1881                                 to IFF-BATCH-NO
  1882                 else
  1883                                move spaces  to IFF-BATCH-NO
  1884                 end-if
  1885              when 'batch_seq'
  1886                             if w-form-value-len not = 0
  1887                    move w-form-value(1:w-form-value-len)
  1888                                 to IFF-BATCH-SEQ
  1889                 else
  1890                                move zeros   to IFF-BATCH-SEQ
  1891                 end-if
  1892              when 'resp_no'
  1893                             if w-form-value-len not = 0
  1894                    move w-form-value(1:w-form-value-len)
  1895                                 to IFF-RESP-NO
  1896                 else
  1897                                move spaces  to IFF-RESP-NO
  1898                 end-if
  1899              when 'no_copies'
  1900                             if w-form-value-len not = 0
  1901                    move w-form-value(1:w-form-value-len)
  1902                                 to IFF-NO-OF-COPIES
  1903                 else
  1904                    move zeros   to IFF-NO-OF-COPIES
  1905                 end-if
  1906              when 'proc_id'
  1907                             if w-form-value-len not = 0
  1908                    move w-form-value(1:w-form-value-len)
  1909                                 to IFF-PROC-ID
  1910                 else
  1911                    move 'JJVA'  to IFF-PROC-ID
  1912                 end-if
  1913              when 'comp_id'
  1914                             if w-form-value-len not = 0
  1915                    move w-form-value(1:w-form-value-len)
  1916                                 to IFF-COMP-ID
  1917                 else
  1918                    move 'CID'   to IFF-COMP-ID
  1919                 end-if
  1920              when 'prt_now'
  1921                             if w-form-value-len not = 0
  1922                    move w-form-value(1:w-form-value-len)
  1923                                 to IFF-PRINT-NOW-SW
  1924                 else
  1925                    move 'N'     to IFF-PRINT-NOW-SW
  1926                 end-if
  1927              when 'enc_cd'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* NSRASLTR.cbl
  1928                             if w-form-value-len not = 0
  1929                    move w-form-value(1:w-form-value-len)
  1930                                 to IFF-ENC-CD
  1931                 else
  1932                    move '0'     to IFF-ENC-CD
  1933                 end-if
  1934              when 'resend_dt'
  1935                             if w-form-value-len not = 0
  1936                    move w-form-value(1:w-form-value-len)
  1937                                 to IFF-RESEND-DT
  1938                 else
  1939                    move SPACES  to IFF-RESEND-DT
  1940                 end-if
  1941              when 'follow_dt'
  1942                             if w-form-value-len not = 0
  1943                    move w-form-value(1:w-form-value-len)
  1944                                 to IFF-FOLLOW-UP-DT
  1945                 else
  1946                    move SPACES  to IFF-FOLLOW-UP-DT
  1947                 end-if
  1948              when 'arch_no'
  1949                             if w-form-value-len not = 0
  1950                    move w-form-value(1:w-form-value-len)
  1951                                 to IFF-ARCHIVE-NO
  1952                 else
  1953                    move ZEROS   to IFF-ARCHIVE-NO
  1954                 end-if
  1955              when 'pgm_func'
  1956                             if w-form-value-len not = 0
  1957                    move w-form-value(1:w-form-value-len)
  1958                                 to IFF-FUNC
  1959                 else
  1960                    move ZEROS   to IFF-FUNC
  1961                 end-if
  1962              when 'ltr_comments'
  1963                             if w-form-value-len not = 0
  1964                    move w-form-value(1:w-form-value-len)
  1965                                 to IFF-COMMENTS
  1966                 else
  1967                    move SPACES  to IFF-COMMENTS
  1968                 end-if
  1969           end-evaluate
  1970        when other
  1971           continue
  1972     end-evaluate.
  1973 read-form-exit.
  1974 9700-DATE-LINK.
  1975
  1976* EXEC CICS LINK
  1977*        PROGRAM   ('ELDATCV')
  1978*        COMMAREA  (DATE-CONVERSION-DATA)
  1979*        LENGTH    (DC-COMM-LENGTH)
  1980*    END-EXEC.
  1981     MOVE 'ELDATCV' TO DFHEIV1
  1982*    MOVE '."C                   ''   #00001580' TO DFHEIV0
  1983     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1985     MOVE X'2020233030303031353830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* NSRASLTR.cbl
  1986     CALL 'kxdfhei1' USING DFHEIV0,
  1987           DFHEIV1,
  1988           DATE-CONVERSION-DATA,
  1989           DC-COMM-LENGTH,
  1990           DFHEIV99,
  1991           DFHEIV99,
  1992           DFHEIV99
  1993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1994
  1995 9700-EXIT.
  1996      EXIT.
  1997
  1998 9999-DFHBACK SECTION.
  1999     MOVE '9%                    "   ' TO DFHEIV0
  2000     MOVE 'NSRASLTR' TO DFHEIV1
  2001     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2002     GOBACK.
  2003 9999-DFHEXIT.
  2004     IF DFHEIGDJ EQUAL 0001
  2005         NEXT SENTENCE.
  2006     MOVE '9%                    "   ' TO DFHEIV0
  2007     MOVE 'NSRASLTR' TO DFHEIV1
  2008     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2009     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12292     Code:        6418
