* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    65******************************************************************
    66
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page   3
* EL156.cbl
    68 ENVIRONMENT DIVISION.
    69
    70 DATA DIVISION.
    71
    72 WORKING-STORAGE SECTION.
    73 01  DFH-START PIC X(04).
    74
    75 77  FILLER  PIC X(32)  VALUE '********************************'.
    76 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    77 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    78 77  WS-SSN  PIC X(9) VALUE ZEROS.
    79 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    80 77  C0                          PIC S999 COMP-3 VALUE +0.
    81 77  C1                          PIC S999 COMP-3 VALUE +0.
    82 77  C2                          PIC S999 COMP-3 VALUE +0.
    83 77  C3                          PIC S999 COMP-3 VALUE +0.
    84 77  s1                          PIC S999 COMP-3 VALUE +0.
    85 77  s2                          pic s999 comp-3 value +0.
    86 77  P1                          PIC S999 COMP-3 VALUE +0.
    87 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    88 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    89 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    90 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    91 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    92 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    93 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    94 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    95 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    96 77  ws-max-bens                 pic s999 comp-3 value +0.
    97 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    98 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    99 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
   100 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   101 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   102 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   103
   104*    COPY ELCSCTM.
   105******************************************************************
   106*                                                                *
   107*                                                                *
   108*                            ELCSCTM                             *
   109*                            VMOD=2.001                          *
   110*                                                                *
   111*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   112*                                                                *
   113******************************************************************
   114 01  SECURITY-MESSAGE.
   115     12  FILLER                          PIC X(30)
   116            VALUE '** LOGIC SECURITY VIOLATION -'.
   117     12  SM-READ                         PIC X(6).
   118     12  FILLER                          PIC X(5)
   119            VALUE ' PGM='.
   120     12  SM-PGM                          PIC X(6).
   121     12  FILLER                          PIC X(5)
   122            VALUE ' OPR='.
   123     12  SM-PROCESSOR-ID                 PIC X(4).
   124     12  FILLER                          PIC X(6)
   125            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page   4
* EL156.cbl
   126     12  SM-TERMID                       PIC X(4).
   127     12  FILLER                          PIC XX   VALUE SPACE.
   128     12  SM-JUL-DATE                     PIC 9(5).
   129     12  FILLER                          PIC X    VALUE SPACE.
   130     12  SM-TIME                         PIC 99.99.
   131
   132
   133*    COPY ELCSCRTY.
   134******************************************************************
   135*                                                                *
   136*                                                                *
   137*                            ELCSCRTY                            *
   138*                            VMOD=2.001                          *
   139*                                                                *
   140*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   141*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   142*        SAVED IN PI-SECURITY-ADDRESS.                           *
   143*                                                                *
   144******************************************************************
   145 01  SECURITY-CONTROL.
   146     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   147     12  FILLER                       PIC XX    VALUE 'SC'.
   148     12  SC-CREDIT-CODES.
   149         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   150             20  SC-CREDIT-DISPLAY    PIC X.
   151             20  SC-CREDIT-UPDATE     PIC X.
   152     12  SC-CLAIMS-CODES.
   153         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   154             20  SC-CLAIMS-DISPLAY    PIC X.
   155             20  SC-CLAIMS-UPDATE     PIC X.
   156
   157 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   158 01  WS-DATE-AREA.
   159     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   160     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   161     12  SAVE-DATE-CCYYMMDD.
   162         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   163         16  SAVE-DATE-YMD.
   164             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   165             20  FILLER              PIC X(04)   VALUE SPACES.
   166
   167 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   168 01  STANDARD-AREAS.
   169     12  WS-RESPONSE         PIC S9(8)   COMP.
   170         88  WS-RESP-NORMAL              VALUE +00.
   171         88  WS-RESP-ERROR               VALUE +01.
   172         88  WS-RESP-NOTFND              VALUE +13.
   173         88  WS-RESP-DUPREC              VALUE +14.
   174         88  WS-RESP-ENDFILE             VALUE +20.
   175     12  PMT-HEAD-A.
   176         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   177         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   178         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   179-        '     RESERVES  TYPE    AMOUNT'.
   180     12  PMT-HEAD-B.
   181         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   182         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   183         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page   5
* EL156.cbl
   184     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   185     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   186     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   187     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   188     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   189     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   190     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   191     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   192     12  PGM-NAME            PIC X(8).
   193     12  TIME-IN             PIC S9(7).
   194     12  TIME-OUT-R  REDEFINES TIME-IN.
   195         16  FILLER          PIC X.
   196         16  TIME-OUT        PIC 99V99.
   197         16  FILLER          PIC XX.
   198     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   199     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   200     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   201     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   202     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   203     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   204     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   205     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   206     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   207     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   208     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   209     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   210     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   211     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   212     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   213     12  WS-BLANK            PIC X       VALUE ' '.
   214
   215 01  MISC-WORK-AREAS.
   216     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   217     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   218     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   219     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   220     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   221     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   222     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   223     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   224     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   225     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   226     12  W-CALLED-NAME           PIC X(08).
   227     12  W-EOB-CODES.
   228         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   229             20  W-EOB-CODE      PIC XXX.
   230             20  W-EOB-FILLER    PIC X.
   231     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   232     12  W-NAME-LAST             PIC X(15).
   233     12  W-NAME-FIRST            PIC X(15).
   234     12  W-NAME-MIDDLE.
   235         16  FILLER              PIC X.
   236         16  W-NAME-MIDDLE-2     PIC X.
   237         16  FILLER              PIC X(13).
   238     12  W-DMD-CHECK-NO.
   239         16  W-DMD-CHECK-NO-1    PIC X(4).
   240         16  W-DMD-CHECK-NO-2    PIC X.
   241         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page   6
* EL156.cbl
   242
   243     12  WS-COMPUTE-FROM-DT  PIC XX.
   244     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   245     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   246     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   247     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   248     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   249     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   250         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   251         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   252     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   253         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   254     12  WS-UPDATE-SW        PIC X VALUE ' '.
   255     12  WS-GROUPING.
   256         16  WS-GROUP-1      PIC X VALUE SPACES.
   257         16  FILLER          PIC X(05) VALUE SPACES.
   258     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   259     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   260     12  WS-WORK-STATE-ACCT.
   261         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   262         16  FILLER          PIC X       VALUE '/'.
   263         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   264     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   265     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   266     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   267     12  QID.
   268         16  QID-TERM        PIC X(4)    VALUE SPACES.
   269         16  FILLER          PIC X(4)    VALUE '156A'.
   270     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   271     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   272     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   273     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   274     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   275     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   276     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   277     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   278     12  WS-STATUS           PIC X       VALUE SPACES.
   279     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   280     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   281     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   282     12  ws-extended-exp-dt  pic xx      value low-values.
   283     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   284     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   285     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   286     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   287     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   288     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   289     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   290     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   291     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   292     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   293     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   294     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   295     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   296     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   297     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   298     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   299     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page   7
* EL156.cbl
   300     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   301     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   302     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   303     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   304     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   305     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   306     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   307     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   308     12  WORK-DATE-FROM.
   309         16  WDF-MONTH       PIC 99        VALUE ZERO.
   310         16  WDF-DAY         PIC 99        VALUE ZERO.
   311         16  WDF-YEAR        PIC 99        VALUE ZERO.
   312     12  WORK-DATE-THRU.
   313         16  WDT-MONTH       PIC 99        VALUE ZERO.
   314         16  WDT-DAY         PIC 99        VALUE ZERO.
   315         16  WDT-YEAR        PIC 99        VALUE ZERO.
   316     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   317     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   318     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   319     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   320     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   321     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   322     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   323     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   324     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   325     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   326     12  WS-PY-WK REDEFINES WS-PY-WORK.
   327         16  WS-PY-NUM       PIC S9(7)V99.
   328         16  WS-PY-SIGN      PIC X.
   329     12  WS-DY-WORK          PIC S9(5).
   330     12  WS-DY-WK REDEFINES WS-DY-WORK.
   331         16  WS-DY-NUM       PIC S9(4).
   332         16  WS-DY-SIGN      PIC X.
   333     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   334         88  COMP-REC-FOUND              VALUE 'Y'.
   335     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   336         88  BENEFIT-FOUND       VALUE 'Y'.
   337         88  NO-BENEFIT-FOUND    VALUE 'N'.
   338     12  WS-TERMS.
   339         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   340         16  FILLER          PIC X       VALUE '/'.
   341         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   342         16  WST-REM-DAYS-GRP.
   343             20  WST-SLASH   PIC X       VALUE '/'.
   344             20  WST-REM-DAYS
   345                             PIC --9.
   346     12  WS-ACCESS.
   347         16  FILLER          PIC XX      VALUE SPACES.
   348         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   349     12  WS-STATE-ACCESS.
   350         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   351         16  FILLER          PIC XX      VALUE SPACES.
   352     12  WS-CARR-ACCESS.
   353         16  FILLER          PIC X(3)    VALUE SPACES.
   354         16  WS-CARR         PIC X       VALUE SPACES.
   355     12  DATE-WORK.
   356         16  FILLER          PIC XX      VALUE SPACES.
   357         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page   8
* EL156.cbl
   358     12  WS-SAVE-INPUT.
   359         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   360         16  WS-PAYEE        PIC XX      VALUE SPACE.
   361         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   362         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   363         16  WS-OFFLINE      PIC X       VALUE SPACE.
   364         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   365         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   366         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   367         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   368         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   369         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   370         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   371         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   372         16  WS-ETYPE        PIC X       VALUE SPACE.
   373         16  WS-CASH         PIC X       VALUE SPACE.
   374         16  WS-GROUPED      PIC X       VALUE SPACE.
   375         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   376         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   377         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   378         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   379         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   380         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   381         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   382         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   383         16  ws-int-to-rem-borr pic x value spaces.
   384     12  LAST-ERROR-LINE.
   385         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   386         16  FILLER              PIC X(30)
   387             VALUE ' FATAL ERRORS ENCOUNTERED'.
   388         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   389         16  FILLER              PIC X(28)
   390             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   391     12  WS-CHECK-AREA.
   392         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   393         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   394     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   395     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   396         16  FILLER              PIC XX.
   397         16  WS-A-CHECK-NUM-5    PIC 9(5).
   398     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   399         16  FILLER              PIC X.
   400         16  WS-A-CHECK-NUM-6    PIC 9(6).
   401     12  OPTION-1-SAVE-AREA.
   402         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   403         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   404     12  WS-WORK-ZIP.
   405         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   406         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   407     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   408                                 PIC 9(9).
   409     12  WS-FLI-PMTNOTE.
   410         16  WS-PMTOPTION        PIC XX.
   411         16  WS-DOCNAME          PIC X(28).
   412         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   413             20  WS-AMOUNT       PIC X(8).
   414             20  FILLER          PIC X(20).
   415         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page   9
* EL156.cbl
   416             20  WS-NUM-AMT      PIC 9(6)V99.
   417             20  FILLER          PIC X(20).
   418
   419     12  WS-HAN-PMTNOTE.
   420         16  WS-HAN-PMT-CODE     PIC X.
   421         16  WS-HAN-PMT-NOTE     PIC X(39).
   422
   423     12  WS-NCL-PMT-OPTION       PIC XX.
   424         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   425
   426     12  WS-CLAIM-SEQUENCE.
   427         16  FILLER              PIC X VALUE '('.
   428         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   429         16  FILLER              PIC X(04) VALUE ' OF '.
   430         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   431         16  FILLER              PIC X VALUE ')'.
   432
   433     12  WS-REFUND-AMT           PIC Z(7).99.
   434     12  WS-CALC-INT             PIC S9(7)V99.
   435     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   436
   437     12  SUB                     PIC 99 VALUE ZEROS.
   438
   439     12  WS-BOANOTE1.
   440         16  WS-BOANOTE1-DESC    PIC X(11).
   441         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   442         16  FILLER              PIC X(17).
   443     12  WS-BOANOTE2.
   444         16  WS-BOANOTE2-DESC    PIC X(11).
   445         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   446         16  FILLER              PIC X(17).
   447
   448     12  WS-NCLNOTE1.
   449         16  WS-NCLNOTE1-DESC    PIC X(11).
   450         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   451         16  FILLER              PIC X(17).
   452     12  WS-NCLNOTE2.
   453         16  WS-NCLNOTE2-DESC    PIC X(11).
   454         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   455         16  FILLER              PIC X(17).
   456
   457     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   458     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   459     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   460     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   461     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   462     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   463     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   464     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   465     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   466     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   467
   468     12  WS-AIG-WORK-AREAS.
   469         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   470             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   471         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   472             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   473         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  10
* EL156.cbl
   474             20  WS-FROM-MO      PIC 99.
   475             20  WS-FROM-DA      PIC 99.
   476             20  WS-FROM-YR      PIC 99.
   477         16  WS-TEMP-DATE-MDY.
   478             20  WS-TEMP-MO      PIC 99.
   479             20  WS-TEMP-DA      PIC 99.
   480             20  WS-TEMP-YR      PIC 99.
   481         16  WS-BIN-FROM-DT      PIC XX.
   482         16  WS-TEMP-INC-MDY.
   483             20  WS-TEMP-INC-MO  PIC 99.
   484             20  WS-TEMP-INC-DA  PIC 99.
   485             20  WS-TEMP-INC-YR  PIC 99.
   486         16  WS-PMT-DUE-MDY.
   487             20  WS-PMT-DUE-MO   PIC 99.
   488             20  WS-PMT-DUE-DA   PIC 99.
   489             20  WS-PMT-DUE-YR   PIC 99.
   490         16  WS-PMT-DUE-DT       PIC XX.
   491         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   492         16  WS-RETRO-ELIM-DT    PIC XX.
   493         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   494             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   495         16  WS-SAVE-DUE-DA      PIC 99.
   496         16  WS-CDAYS            PIC S9(05).
   497         16  WS-DAYS-OFF         PIC S9(05).
   498         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   499             88  ELIM-SATISFIED            VALUE 'Y'.
   500         16  WS-AIG-CHECKNO.
   501             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   502             20  WS-A-CHECKNO-3-7.
   503                 24  FILLER              PIC X(3)    VALUE SPACES.
   504                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   505                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   506         16  WS-AIG-GROUPING.
   507             20  WS-A-BENE               PIC XXX.
   508             20  FILLER                  PIC XXX.
   509         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   510             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   511             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   512         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   513                 VALUE 'UNEMPLOYMENT PAYMENT'.
   514         16  WS-CHK-THRU-DT              PIC XX.
   515         16  WS-HOLD-BIN-DATE-1          PIC XX.
   516
   517 01  MISC-CSO-AREA.
   518     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   519     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   520     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   521         88  APPROVAL-NEEDED                        VALUE 'Y'.
   522     12  WS-APPROV-NOTE                  PIC X(43)
   523         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   524     12  WS-3550-APPROV-NOTE             PIC X(43)
   525         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   526     12  WS-REAUDIT-NOTE                 PIC X(43)
   527         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   528     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   529     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   530     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   531     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  11
* EL156.cbl
   532     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   533     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   534     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   535         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   536     12  WS-PAYEE-CITY-STATE     PIC X(30).
   537     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   538         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   539     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   540     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   541     12  WS-WORK-NAME            PIC X(30).
   542     12  FILLER  REDEFINES WS-WORK-NAME.
   543         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   544     12  WS-INSURED-NAME         PIC X(30).
   545     12  FILLER  REDEFINES WS-INSURED-NAME.
   546         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   547     12  WS-PAYEE-NAME           PIC X(30).
   548     12  FILLER  REDEFINES WS-PAYEE-NAME.
   549         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   550
   551 01  ERROR-MESSAGES.
   552     12  ER-0000                 PIC X(4)  VALUE '0000'.
   553     12  ER-0004                 PIC X(4)  VALUE '0004'.
   554     12  ER-0008                 PIC X(4)  VALUE '0008'.
   555     12  ER-0019                 PIC X(4)  VALUE '0019'.
   556     12  ER-0029                 PIC X(4)  VALUE '0029'.
   557     12  ER-0042                 PIC X(4)  VALUE '0042'.
   558     12  ER-0070                 PIC X(4)  VALUE '0070'.
   559     12  ER-0130                 PIC X(4)  VALUE '0130'.
   560     12  ER-0149                 PIC X(4)  VALUE '0149'.
   561     12  ER-0154                 PIC X(4)  VALUE '0154'.
   562     12  ER-0168                 PIC X(4)  VALUE '0168'.
   563     12  ER-0169                 PIC X(4)  VALUE '0169'.
   564     12  ER-0172                 PIC X(4)  VALUE '0174'.
   565     12  ER-0198                 PIC X(4)  VALUE '0198'.
   566     12  ER-0204                 PIC X(4)  VALUE '0204'.
   567     12  ER-0206                 PIC X(4)  VALUE '0206'.
   568     12  ER-0252                 PIC X(4)  VALUE '0252'.
   569     12  ER-0254                 PIC X(4)  VALUE '0254'.
   570     12  ER-0282                 PIC X(4)  VALUE '0282'.
   571     12  ER-0283                 PIC X(4)  VALUE '0283'.
   572     12  ER-0294                 PIC X(4)  VALUE '0294'.
   573     12  ER-0338                 PIC X(4)  VALUE '0338'.
   574     12  ER-0419                 PIC X(4)  VALUE '0419'.
   575     12  ER-0420                 PIC X(4)  VALUE '0420'.
   576     12  ER-0421                 PIC X(4)  VALUE '0421'.
   577     12  ER-0422                 PIC X(4)  VALUE '0422'.
   578     12  ER-0433                 PIC X(4)  VALUE '0433'.
   579     12  ER-0436                 PIC X(4)  VALUE '0436'.
   580     12  ER-0437                 PIC X(4)  VALUE '0437'.
   581     12  ER-0438                 PIC X(4)  VALUE '0438'.
   582     12  ER-0439                 PIC X(4)  VALUE '0439'.
   583     12  ER-0440                 PIC X(4)  VALUE '0440'.
   584     12  ER-0441                 PIC X(4)  VALUE '0441'.
   585     12  ER-0442                 PIC X(4)  VALUE '0442'.
   586     12  ER-0443                 PIC X(4)  VALUE '0443'.
   587     12  ER-0444                 PIC X(4)  VALUE '0444'.
   588     12  ER-0445                 PIC X(4)  VALUE '0445'.
   589     12  ER-0446                 PIC X(4)  VALUE '0446'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  12
* EL156.cbl
   590     12  ER-0447                 PIC X(4)  VALUE '0447'.
   591     12  ER-0448                 PIC X(4)  VALUE '0448'.
   592     12  ER-0449                 PIC X(4)  VALUE '0449'.
   593     12  ER-0452                 PIC X(4)  VALUE '0452'.
   594     12  ER-0458                 PIC X(4)  VALUE '0458'.
   595     12  ER-0459                 PIC X(4)  VALUE '0459'.
   596     12  ER-0460                 PIC X(4)  VALUE '0460'.
   597     12  ER-0461                 PIC X(4)  VALUE '0461'.
   598     12  ER-0462                 PIC X(4)  VALUE '0462'.
   599     12  ER-0463                 PIC X(4)  VALUE '0463'.
   600     12  ER-0464                 PIC X(4)  VALUE '0464'.
   601     12  ER-0465                 PIC X(4)  VALUE '0465'.
   602     12  ER-0466                 PIC X(4)  VALUE '0466'.
   603     12  ER-0467                 PIC X(4)  VALUE '0467'.
   604     12  ER-0468                 PIC X(4)  VALUE '0468'.
   605     12  ER-0469                 PIC X(4)  VALUE '0469'.
   606     12  ER-0473                 PIC X(4)  VALUE '0473'.
   607     12  ER-0474                 PIC X(4)  VALUE '0474'.
   608     12  ER-0475                 PIC X(4)  VALUE '0475'.
   609     12  ER-0476                 PIC X(4)  VALUE '0476'.
   610     12  ER-0477                 PIC X(4)  VALUE '0477'.
   611     12  ER-0478                 PIC X(4)  VALUE '0478'.
   612     12  ER-0479                 PIC X(4)  VALUE '0479'.
   613     12  ER-0481                 PIC X(4)  VALUE '0481'.
   614     12  ER-0491                 PIC X(4)  VALUE '0491'.
   615     12  ER-0492                 PIC X(4)  VALUE '0492'.
   616     12  ER-0493                 PIC X(4)  VALUE '0493'.
   617     12  ER-0494                 PIC X(4)  VALUE '0494'.
   618     12  ER-0495                 PIC X(4)  VALUE '0495'.
   619     12  ER-0499                 PIC X(4)  VALUE '0499'.
   620     12  ER-0500                 PIC X(4)  VALUE '0500'.
   621     12  ER-0501                 PIC X(4)  VALUE '0501'.
   622     12  ER-0502                 PIC X(4)  VALUE '0502'.
   623     12  ER-0508                 PIC X(4)  VALUE '0508'.
   624     12  ER-0513                 PIC X(4)  VALUE '0513'.
   625     12  ER-0518                 PIC X(4)  VALUE '0518'.
   626     12  ER-0524                 PIC X(4)  VALUE '0524'.
   627     12  ER-0525                 PIC X(4)  VALUE '0525'.
   628     12  ER-0526                 PIC X(4)  VALUE '0526'.
   629     12  ER-0530                 PIC X(4)  VALUE '0530'.
   630     12  ER-0540                 PIC X(4)  VALUE '0540'.
   631     12  ER-0541                 PIC X(4)  VALUE '0541'.
   632     12  ER-0542                 PIC X(4)  VALUE '0542'.
   633     12  ER-0543                 PIC X(4)  VALUE '0543'.
   634     12  ER-0545                 PIC X(4)  VALUE '0545'.
   635     12  ER-0552                 PIC X(4)  VALUE '0552'.
   636     12  ER-0555                 PIC X(4)  VALUE '0555'.
   637     12  ER-0556                 PIC X(4)  VALUE '0556'.
   638     12  ER-0557                 PIC X(4)  VALUE '0557'.
   639     12  ER-0572                 PIC X(4)  VALUE '0572'.
   640     12  ER-0573                 PIC X(4)  VALUE '0573'.
   641     12  ER-0594                 PIC X(4)  VALUE '0594'.
   642     12  ER-0616                 PIC X(4)  VALUE '0616'.
   643     12  ER-0617                 PIC X(4)  VALUE '0617'.
   644     12  ER-0618                 PIC X(4)  VALUE '0618'.
   645     12  ER-0657                 PIC X(4)  VALUE '0657'.
   646     12  ER-0658                 PIC X(4)  VALUE '0658'.
   647     12  ER-0699                 PIC X(4)  VALUE '0699'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  13
* EL156.cbl
   648     12  ER-0730                 PIC X(4)  VALUE '0730'.
   649     12  ER-0737                 PIC X(4)  VALUE '0737'.
   650     12  ER-0760                 PIC X(4)  VALUE '0760'.
   651     12  ER-0768                 PIC X(4)  VALUE '0768'.
   652     12  ER-0769                 PIC X(4)  VALUE '0769'.
   653     12  ER-0770                 PIC X(4)  VALUE '0770'.
   654     12  ER-0802                 PIC X(4)  VALUE '0802'.
   655     12  ER-0803                 PIC X(4)  VALUE '0803'.
   656     12  ER-0819                 PIC X(4)  VALUE '0819'.
   657     12  ER-0834                 PIC X(4)  VALUE '0834'.
   658     12  ER-0836                 PIC X(4)  VALUE '0836'.
   659     12  ER-0844                 PIC X(4)  VALUE '0844'.
   660     12  ER-0845                 PIC X(4)  VALUE '0845'.
   661     12  ER-0846                 PIC X(4)  VALUE '0846'.
   662     12  ER-0849                 PIC X(4)  VALUE '0849'.
   663     12  ER-0851                 PIC X(4)  VALUE '0851'.
   664     12  ER-0872                 PIC X(4)  VALUE '0872'.
   665     12  ER-0873                 PIC X(4)  VALUE '0873'.
   666     12  ER-0874                 PIC X(4)  VALUE '0874'.
   667     12  ER-0879                 PIC X(4)  VALUE '0879'.
   668     12  ER-0919                 PIC X(4)  VALUE '0919'.
   669     12  ER-0921                 PIC X(4)  VALUE '0921'.
   670     12  ER-0923                 PIC X(4)  VALUE '0923'.
   671     12  ER-0925                 PIC X(4)  VALUE '0925'.
   672     12  ER-0944                 PIC X(4)  VALUE '0944'.
   673     12  ER-0945                 PIC X(4)  VALUE '0945'.
   674     12  ER-0946                 PIC X(4)  VALUE '0946'.
   675     12  ER-0947                 PIC X(4)  VALUE '0947'.
   676     12  ER-0948                 PIC X(4)  VALUE '0948'.
   677     12  ER-0949                 PIC X(4)  VALUE '0949'.
   678     12  ER-0950                 PIC X(4)  VALUE '0950'.
   679     12  ER-0951                 PIC X(4)  VALUE '0951'.
   680     12  ER-0954                 PIC X(4)  VALUE '0954'.
   681     12  ER-0956                 PIC X(4)  VALUE '0956'.
   682     12  ER-0967                 PIC X(4)  VALUE '0967'.
   683     12  ER-0968                 PIC X(4)  VALUE '0968'.
   684     12  ER-0974                 PIC X(4)  VALUE '0974'.
   685     12  ER-0975                 PIC X(4)  VALUE '0975'.
   686     12  ER-1561                 PIC X(4)  VALUE '1561'.
   687     12  ER-1566                 PIC X(4)  VALUE '1566'.
   688     12  ER-1567                 PIC X(4)  VALUE '1567'.
   689     12  ER-1569                 PIC X(4)  VALUE '1569'.
   690     12  er-1582                 pic x(4)  value '1582'.
   691     12  er-1657                 pic x(4)  value '1657'.
   692     12  er-1658                 pic x(4)  value '1658'.
   693     12  er-1667                 pic x(4)  value '1667'.
   694     12  er-1670                 pic x(4)  value '1670'.
   695     12  er-1671                 pic x(4)  value '1671'.
   696     12  er-1672                 pic x(4)  value '1672'.
   697     12  er-1673                 pic x(4)  value '1673'.
   698     12  er-1674                 pic x(4)  value '1674'.
   699     12  er-1677                 pic x(4)  value '1677'.
   700     12  ER-1775                 PIC X(4)  VALUE '1775'.
   701     12  ER-1880                 PIC X(4)  VALUE '1880'.
   702     12  ER-2044                 PIC X(4)  VALUE '2044'.
   703     12  ER-3140                 PIC X(4)  VALUE '3140'.
   704     12  ER-3141                 PIC X(4)  VALUE '3141'.
   705     12  ER-3255                 PIC X(4)  VALUE '3255'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  14
* EL156.cbl
   706     12  ER-3516                 PIC X(4)  VALUE '3516'.
   707     12  ER-3527                 PIC X(4)  VALUE '3527'.
   708     12  ER-3528                 PIC X(4)  VALUE '3528'.
   709     12  ER-3529                 PIC X(4)  VALUE '3529'.
   710     12  ER-3530                 PIC X(4)  VALUE '3530'.
   711     12  ER-3531                 PIC X(4)  VALUE '3531'.
   712     12  ER-3532                 PIC X(4)  VALUE '3532'.
   713     12  ER-3533                 PIC X(4)  VALUE '3533'.
   714     12  ER-3534                 PIC X(4)  VALUE '3534'.
   715     12  ER-3535                 PIC X(4)  VALUE '3535'.
   716     12  ER-3536                 PIC X(4)  VALUE '3536'.
   717     12  ER-3537                 PIC X(4)  VALUE '3537'.
   718     12  ER-3538                 PIC X(4)  VALUE '3538'.
   719     12  ER-3539                 PIC X(4)  VALUE '3539'.
   720     12  ER-3540                 PIC X(4)  VALUE '3540'.
   721     12  ER-3541                 PIC X(4)  VALUE '3541'.
   722     12  ER-3542                 PIC X(4)  VALUE '3542'.
   723     12  ER-3543                 PIC X(4)  VALUE '3543'.
   724     12  ER-3546                 PIC X(4)  VALUE '3546'.
   725     12  ER-3549                 PIC X(4)  VALUE '3549'.
   726     12  ER-3818                 PIC X(4)  VALUE '3818'.
   727     12  ER-7540                 PIC X(4)  VALUE '7540'.
   728     12  ER-7576                 PIC X(4)  VALUE '7576'.
   729     12  ER-7579                 PIC X(4)  VALUE '7579'.
   730     12  ER-7580                 PIC X(4)  VALUE '7580'.
   731     12  ER-7583                 PIC X(4)  VALUE '7583'.
   732     12  ER-7830                 PIC X(4)  VALUE '7830'.
   733     12  ER-7831                 PIC X(4)  VALUE '7831'.
   734     12  ER-7832                 PIC X(4)  VALUE '7832'.
   735     12  ER-7833                 PIC X(4)  VALUE '7833'.
   736     12  ER-7834                 PIC X(4)  VALUE '7834'.
   737     12  ER-7835                 PIC X(4)  VALUE '7835'.
   738     12  ER-7836                 PIC X(4)  VALUE '7836'.
   739     12  ER-7837                 PIC X(4)  VALUE '7837'.
   740     12  ER-7838                 PIC X(4)  VALUE '7838'.
   741     12  ER-7841                 PIC X(4)  VALUE '7841'.
   742     12  ER-7844                 PIC X(4)  VALUE '7844'.
   743     12  ER-7845                 PIC X(4)  VALUE '7845'.
   744     12  ER-8000                 PIC X(4)  VALUE '8000'.
   745     12  ER-8051                 PIC X(4)  VALUE '8051'.
   746     12  ER-8052                 PIC X(4)  VALUE '8052'.
   747     12  ER-8053                 PIC X(4)  VALUE '8053'.
   748     12  ER-8054                 PIC X(4)  VALUE '8054'.
   749     12  ER-8055                 PIC X(4)  VALUE '8055'.
   750     12  ER-8056                 PIC X(4)  VALUE '8056'.
   751     12  ER-8057                 PIC X(4)  VALUE '8057'.
   752     12  ER-8058                 PIC X(4)  VALUE '8058'.
   753     12  ER-8059                 PIC X(4)  VALUE '8059'.
   754     12  ER-8060                 PIC X(4)  VALUE '8060'.
   755     12  ER-8061                 PIC X(4)  VALUE '8061'.
   756     12  ER-8062                 PIC X(4)  VALUE '8062'.
   757     12  ER-8063                 PIC X(4)  VALUE '8063'.
   758     12  ER-8064                 PIC X(4)  VALUE '8064'.
   759     12  ER-8065                 PIC X(4)  VALUE '8065'.
   760     12  ER-8066                 PIC X(4)  VALUE '8066'.
   761     12  ER-8146                 PIC X(4)  VALUE '8146'.
   762     12  ER-8147                 PIC X(4)  VALUE '8147'.
   763     12  ER-8152                 PIC X(4)  VALUE '8152'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  15
* EL156.cbl
   764     12  ER-8153                 PIC X(4)  VALUE '8153'.
   765     12  ER-8154                 PIC X(4)  VALUE '8154'.
   766     12  ER-8155                 PIC X(4)  VALUE '8155'.
   767     12  ER-8310                 PIC X(4)  VALUE '8310'.
   768     12  ER-8311                 PIC X(4)  VALUE '8311'.
   769     12  ER-8312                 PIC X(4)  VALUE '8312'.
   770     12  ER-8313                 PIC X(4)  VALUE '8313'.
   771     12  ER-8314                 PIC X(4)  VALUE '8314'.
   772     12  ER-8315                 PIC X(4)  VALUE '8315'.
   773     12  ER-8316                 PIC X(4)  VALUE '8316'.
   774     12  ER-8317                 PIC X(4)  VALUE '8317'.
   775
   776 01  CSO-WORK-FIELDS.
   777     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   778       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   779
   780     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   781     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   782         88  CERT-NOTE-ADDED           VALUE 'Y'.
   783     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   784         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   785     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   786
   787     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   788
   789 01  SC-NP6-CERT-NOTE.
   790     12  FILLER                  PIC X(12)
   791               VALUE 'REM BENEFIT '.
   792     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   793     12  SC-NP6-COMM             PIC X(8)
   794               VALUE ' + 6 MO '.
   795     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   796     12  FILLER                  PIC X(12)
   797               VALUE ' = AMT PAID '.
   798     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   799
   800 01  SC-NP6-ORIG-NOTE.
   801     12  FILLER                  PIC X(63)  VALUE
   802         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   803 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   804     88  PDEF-FOUND                   VALUE 'Y'.
   805 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   806     88  ACCT-FOUND                   VALUE 'Y'.
   807 01  CTBL-KEY-SAVE               PIC X(5).
   808 01  CTBL-KEY.
   809     05  CTBL-COMPANY-CD         PIC X.
   810     05  CTBL-TABLE              PIC XXX.
   811     05  CTBL-BEN-TYPE           PIC X.
   812     05  CTBL-BEN-CODE           PIC XX.
   813 01  ERPDEF-KEY-SAVE             PIC X(18).
   814 01  ERPDEF-KEY.
   815     12  ERPDEF-COMPANY-CD       PIC X.
   816     12  ERPDEF-STATE            PIC XX.
   817     12  ERPDEF-PROD-CD          PIC XXX.
   818     12  F                       PIC X(7).
   819     12  ERPDEF-BEN-TYPE         PIC X.
   820     12  ERPDEF-BEN-CODE         PIC XX.
   821     12  ERPDEF-EXP-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  16
* EL156.cbl
   822 01  ELCRTT-KEY.
   823     05  CTRLR-COMP-CD       PIC X.
   824     05  CTRLR-CARRIER       PIC X.
   825     05  CTRLR-GROUPING      PIC X(6).
   826     05  CTRLR-STATE         PIC X(2).
   827     05  CTRLR-ACCOUNT       PIC X(10).
   828     05  CTRLR-EFF-DT        PIC XX.
   829     05  CTRLR-CERT-NO       PIC X(11).
   830     05  CTRLR-REC-TYPE      PIC X.
   831 01  ACCESS-KEYS.
   832     12  ELARCH-KEY.
   833         16  ARCH-CO             PIC X.
   834         16  ARCH-NUMBER         PIC S9(08) COMP.
   835         16  ARCH-REC-TYPE       PIC X.
   836         16  ARCH-SEQ            PIC S9(04) COMP.
   837     12  ELMSTR-KEY.
   838         16  MSTR-COMP-CD        PIC X.
   839         16  MSTR-CARRIER        PIC X.
   840         16  MSTR-CLAIM-NO       PIC X(7).
   841         16  MSTR-CERT-NO        PIC X(11).
   842     12  ELCNTL-KEY.
   843         16  CNTL-COMP-ID        PIC X(3).
   844         16  CNTL-REC-TYPE       PIC X.
   845         16  CNTL-ACCESS         PIC X(4).
   846         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   847     12  ELCERT-KEY.
   848         16  CERT-COMP-CD        PIC X.
   849         16  CERT-CARRIER        PIC X.
   850         16  CERT-GROUPING       PIC X(6).
   851         16  CERT-STATE          PIC XX.
   852         16  CERT-ACCOUNT        PIC X(10).
   853         16  CERT-EFF-DT         PIC XX.
   854         16  CERT-CERT-NO        PIC X(11).
   855     12  ELTRLR-KEY.
   856         16  TRLR-COMP-CD        PIC X.
   857         16  TRLR-CARRIER        PIC X.
   858         16  TRLR-CLAIM-NO       PIC X(7).
   859         16  TRLR-CERT-NO        PIC X(11).
   860         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   861     12  ELACTQ-KEY.
   862         16  ACTQ-COMP-CD        PIC X.
   863         16  ACTQ-CARRIER        PIC X.
   864         16  ACTQ-CLAIM-NO       PIC X(7).
   865         16  ACTQ-CERT-NO        PIC X(11).
   866     12  W-NOTE-KEY.
   867         16  W-NOTE-COMP-CD      PIC X.
   868         16  W-NOTE-CERT-KEY.
   869             20  W-NOTE-CARRIER  PIC X.
   870             20  W-NOTE-GROUPING PIC X(6).
   871             20  W-NOTE-STATE    PIC XX.
   872             20  W-NOTE-ACCOUNT  PIC X(10).
   873             20  W-NOTE-EFF-DT   PIC XX.
   874             20  W-NOTE-CERT-NO  PIC X(11).
   875     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   876     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   877     12  ERACCT-KEY.
   878         16  ERACCT-PARTIAL-KEY.
   879             20  ACCT-COMP-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  17
* EL156.cbl
   880             20  ACCT-CARRIER    PIC X.
   881             20  ACCT-GROUPING   PIC X(6).
   882             20  ACCT-STATE      PIC XX.
   883             20  ACCT-ACCOUNT    PIC X(10).
   884         16  ACCT-EXP-DT         PIC XX.
   885         16  FILLER              PIC X(4) VALUE SPACES.
   886     12  ELCHKQ-KEY.
   887         16  CHKQ-COMP-CD        PIC X.
   888         16  CHKQ-CONTROL        PIC S9(8) COMP.
   889         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   890     12  ELBENE-KEY.
   891         16  BENE-COMP-CD         PIC X.
   892         16  BENE-RECORD-TYPE     PIC X.
   893         16  BENE-NUMBER          PIC X(10).
   894     12  ERCOMP-KEY.
   895         16  COMP-COMP-CD        PIC X.
   896         16  COMP-CARRIER        PIC X.
   897         16  COMP-GROUP          PIC X(06).
   898         16  COMP-FIN-RESP       PIC X(10).
   899         16  COMP-ACCOUNT        PIC X(10).
   900         16  COMP-TYPE           PIC X.
   901
   902     12  DLO035-KEY.
   903         16  DL35-PROCESS-TYPE   PIC X.
   904         16  DL35-CREDIT-CARD    PIC X(20).
   905         16  DL35-BEN-TYPE       PIC XX.
   906         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   907         16  DL35-RETURN-CODE    PIC XX.
   908
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  18
* EL156.cbl
   910*    COPY ELCDATE.
   911******************************************************************
   912*                                                                *
   913*                                                                *
   914*                            ELCDATE.                            *
   915*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   916*                            VMOD=2.003
   917*                                                                *
   918*                                                                *
   919*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   920*                 LENGTH = 200                                   *
   921******************************************************************
   922
   923 01  DATE-CONVERSION-DATA.
   924     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   925     12  DC-OPTION-CODE                PIC X.
   926         88  BIN-TO-GREG                VALUE ' '.
   927         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   928         88  EDIT-GREG-TO-BIN           VALUE '2'.
   929         88  YMD-GREG-TO-BIN            VALUE '3'.
   930         88  MDY-GREG-TO-BIN            VALUE '4'.
   931         88  JULIAN-TO-BIN              VALUE '5'.
   932         88  BIN-PLUS-ELAPSED           VALUE '6'.
   933         88  FIND-CENTURY               VALUE '7'.
   934         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   935         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   936         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   937         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   938         88  JULIAN-TO-BIN-3            VALUE 'C'.
   939         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   940         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   941         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   942         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   943         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   944         88  CHECK-LEAP-YEAR            VALUE 'H'.
   945         88  BIN-3-TO-GREG              VALUE 'I'.
   946         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   947         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   948         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   949         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   950         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   951         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   952         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   953         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   954         88  THREE-CHARACTER-BIN
   955                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   956         88  GREGORIAN-TO-BIN
   957                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   958         88  BIN-TO-GREGORIAN
   959                  VALUES ' ' '1' 'I' '8' 'G'.
   960         88  JULIAN-TO-BINARY
   961                  VALUES '5' 'C' 'E' 'F'.
   962     12  DC-ERROR-CODE                 PIC X.
   963         88  NO-CONVERSION-ERROR        VALUE ' '.
   964         88  DATE-CONVERSION-ERROR
   965                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   966         88  DATE-IS-ZERO               VALUE '1'.
   967         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  19
* EL156.cbl
   968         88  DATE-IS-INVALID            VALUE '3'.
   969         88  DATE1-GREATER-DATE2        VALUE '4'.
   970         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   971         88  DATE-INVALID-OPTION        VALUE '9'.
   972         88  INVALID-CENTURY            VALUE 'A'.
   973         88  ONLY-CENTURY               VALUE 'B'.
   974         88  ONLY-LEAP-YEAR             VALUE 'C'.
   975         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   976     12  DC-END-OF-MONTH               PIC X.
   977         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   978     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   979         88  USE-NORMAL-PROCESS         VALUE ' '.
   980         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   981         88  ADJUST-UP-100-YRS          VALUE '2'.
   982     12  FILLER                        PIC X.
   983     12  DC-CONVERSION-DATES.
   984         16  DC-BIN-DATE-1             PIC XX.
   985         16  DC-BIN-DATE-2             PIC XX.
   986         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   987         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   988                       DC-GREG-DATE-1-EDIT.
   989             20  DC-EDIT1-MONTH        PIC 99.
   990             20  SLASH1-1              PIC X.
   991             20  DC-EDIT1-DAY          PIC 99.
   992             20  SLASH1-2              PIC X.
   993             20  DC-EDIT1-YEAR         PIC 99.
   994         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   995         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   996                     DC-GREG-DATE-2-EDIT.
   997             20  DC-EDIT2-MONTH        PIC 99.
   998             20  SLASH2-1              PIC X.
   999             20  DC-EDIT2-DAY          PIC 99.
  1000             20  SLASH2-2              PIC X.
  1001             20  DC-EDIT2-YEAR         PIC 99.
  1002         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1003         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1004                     DC-GREG-DATE-1-YMD.
  1005             20  DC-YMD-YEAR           PIC 99.
  1006             20  DC-YMD-MONTH          PIC 99.
  1007             20  DC-YMD-DAY            PIC 99.
  1008         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1009         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1010                      DC-GREG-DATE-1-MDY.
  1011             20  DC-MDY-MONTH          PIC 99.
  1012             20  DC-MDY-DAY            PIC 99.
  1013             20  DC-MDY-YEAR           PIC 99.
  1014         16  DC-GREG-DATE-1-ALPHA.
  1015             20  DC-ALPHA-MONTH        PIC X(10).
  1016             20  DC-ALPHA-DAY          PIC 99.
  1017             20  FILLER                PIC XX.
  1018             20  DC-ALPHA-CENTURY.
  1019                 24 DC-ALPHA-CEN-N     PIC 99.
  1020             20  DC-ALPHA-YEAR         PIC 99.
  1021         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1022         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1023         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1024         16  DC-JULIAN-DATE            PIC 9(05).
  1025         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  20
* EL156.cbl
  1026                                       PIC 9(05).
  1027         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1028             20  DC-JULIAN-YEAR        PIC 99.
  1029             20  DC-JULIAN-DAYS        PIC 999.
  1030         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1031         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1032         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1033     12  DATE-CONVERSION-VARIBLES.
  1034         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1035         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1036             20  FILLER                PIC 9(3).
  1037             20  HOLD-CEN-1-CCYY.
  1038                 24  HOLD-CEN-1-CC     PIC 99.
  1039                 24  HOLD-CEN-1-YY     PIC 99.
  1040             20  HOLD-CEN-1-MO         PIC 99.
  1041             20  HOLD-CEN-1-DA         PIC 99.
  1042         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1043             20  HOLD-CEN-1-R-MO       PIC 99.
  1044             20  HOLD-CEN-1-R-DA       PIC 99.
  1045             20  HOLD-CEN-1-R-CCYY.
  1046                 24  HOLD-CEN-1-R-CC   PIC 99.
  1047                 24  HOLD-CEN-1-R-YY   PIC 99.
  1048             20  FILLER                PIC 9(3).
  1049         16  HOLD-CENTURY-1-X.
  1050             20  FILLER                PIC X(3)  VALUE SPACES.
  1051             20  HOLD-CEN-1-X-CCYY.
  1052                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1053                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1054             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1055             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1056         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1057             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1058             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1059             20  HOLD-CEN-1-R-X-CCYY.
  1060                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1061                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1062             20  FILLER                PIC XXX.
  1063         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1064         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1065         16  DC-JULIAN-DATE-1          PIC 9(07).
  1066         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1067             20  DC-JULIAN-1-CCYY.
  1068                 24  DC-JULIAN-1-CC    PIC 99.
  1069                 24  DC-JULIAN-1-YR    PIC 99.
  1070             20  DC-JULIAN-DA-1        PIC 999.
  1071         16  DC-JULIAN-DATE-2          PIC 9(07).
  1072         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1073             20  DC-JULIAN-2-CCYY.
  1074                 24  DC-JULIAN-2-CC    PIC 99.
  1075                 24  DC-JULIAN-2-YR    PIC 99.
  1076             20  DC-JULIAN-DA-2        PIC 999.
  1077         16  DC-GREG-DATE-A-EDIT.
  1078             20  DC-EDITA-MONTH        PIC 99.
  1079             20  SLASHA-1              PIC X VALUE '/'.
  1080             20  DC-EDITA-DAY          PIC 99.
  1081             20  SLASHA-2              PIC X VALUE '/'.
  1082             20  DC-EDITA-CCYY.
  1083                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  21
* EL156.cbl
  1084                 24  DC-EDITA-YEAR     PIC 99.
  1085         16  DC-GREG-DATE-B-EDIT.
  1086             20  DC-EDITB-MONTH        PIC 99.
  1087             20  SLASHB-1              PIC X VALUE '/'.
  1088             20  DC-EDITB-DAY          PIC 99.
  1089             20  SLASHB-2              PIC X VALUE '/'.
  1090             20  DC-EDITB-CCYY.
  1091                 24  DC-EDITB-CENT     PIC 99.
  1092                 24  DC-EDITB-YEAR     PIC 99.
  1093         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1094         16  DC-GREG-DATE-CYMD-R REDEFINES
  1095                              DC-GREG-DATE-CYMD.
  1096             20  DC-CYMD-CEN           PIC 99.
  1097             20  DC-CYMD-YEAR          PIC 99.
  1098             20  DC-CYMD-MONTH         PIC 99.
  1099             20  DC-CYMD-DAY           PIC 99.
  1100         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1101         16  DC-GREG-DATE-MDCY-R REDEFINES
  1102                              DC-GREG-DATE-MDCY.
  1103             20  DC-MDCY-MONTH         PIC 99.
  1104             20  DC-MDCY-DAY           PIC 99.
  1105             20  DC-MDCY-CEN           PIC 99.
  1106             20  DC-MDCY-YEAR          PIC 99.
  1107    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1108        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1109    12  DC-EL310-DATE                  PIC X(21).
  1110    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  22
* EL156.cbl
  1112*    COPY ELCLOGOF.
  1113******************************************************************
  1114*                                                                *
  1115*                                                                *
  1116*                            ELCLOGOF.                           *
  1117*                            VMOD=2.001                          *
  1118*                                                                *
  1119*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1120*                                                                *
  1121******************************************************************
  1122 01  CLASIC-LOGOFF.
  1123     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1124     12  LOGOFF-TEXT.
  1125         16  FILLER          PIC X(5)    VALUE SPACES.
  1126         16  LOGOFF-MSG.
  1127             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1128             20  FILLER      PIC X       VALUE SPACES.
  1129             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1130         16  FILLER          PIC X(80)
  1131           VALUE '* YOU ARE NOW LOGGED OFF'.
  1132         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1133         16  FILLER          PIC X       VALUE QUOTE.
  1134         16  LOGOFF-SYS-MSG  PIC X(17)
  1135           VALUE 'S CLAS-IC SYSTEM '.
  1136     12  TEXT-MESSAGES.
  1137         16  UNACCESS-MSG    PIC X(29)
  1138             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1139         16  PGMIDERR-MSG    PIC X(17)
  1140             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  23
* EL156.cbl
  1142*    COPY ELCCALC.
  1143******************************************************************
  1144*                                                                *
  1145*                           ELCCALC.                            *
  1146*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1147*                            VMOD=2.025                          *
  1148*                                                                *
  1149*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1150*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1151*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1152*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1153*                                                                *
  1154*  PASSED TO ELRTRM                                              *
  1155*  -----------------                                             *
  1156*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1157*  ORIGINAL TERM                                                 *
  1158*  BEGINNING DATE                                                *
  1159*  ENDING DATE                                                   *
  1160*  COMPANY I.D.                                                  *
  1161*  ACCOUNT MASTER USER FIELD                                     *
  1162*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1163*  FREE LOOK DAYS                                                *
  1164*                                                                *
  1165*  RETURNED FROM ELRTRM                                          *
  1166*  ---------------------                                         *
  1167*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1168*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1169*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1170*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1171*----------------------------------------------------------------*
  1172*  PASSED TO ELRAMT                                              *
  1173*  ----------------                                              *
  1174*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1175*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1176*  ORIGINAL AMOUNT                                               *
  1177*  ALTERNATE BENEFIT (BALLON)                                    *
  1178*  A.P.R. - NET PAY ONLY                                         *
  1179*  METHOD
  1180*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1181*  COMPANY I.D.                                                  *
  1182*  BENEFIT TYPE                                                  *
  1183*                                                                *
  1184*  RETURNED FROM ELRAMT                                          *
  1185*  --------------------                                          *
  1186*  REMAINING AMOUNT 1 - CURRENT                                  *
  1187*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1188*  REMAINING AMOUNT FACTOR
  1189*----------------------------------------------------------------*
  1190*  PASSED TO ELRESV                                              *
  1191*  -----------------                                             *
  1192*  CERTIFICATE EFFECTIVE DATE                                    *
  1193*  VALUATION DATE                                                *
  1194*  PAID THRU DATE                                                *
  1195*  BENEFIT                                                       *
  1196*  INCURRED DATE                                                 *
  1197*  REPORTED DATE                                                 *
  1198*  ISSUE AGE                                                     *
  1199*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  24
* EL156.cbl
  1200*  CDT PERCENT                                                   *
  1201*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1202* *CLAIM TYPE (LIFE, A/H)                                        *
  1203* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1204* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1205*                                                                *
  1206*  RETURNED FROM ELRESV                                          *
  1207*  --------------------                                          *
  1208*  CDT TABLE USED                                                *
  1209*  CDT FACTOR USED                                               *
  1210*  PAY TO CURRENT RESERVE                                        *
  1211*  I.B.N.R. - A/H ONLY                                           *
  1212*  FUTURE (ACCRUED) AH ONLY                                      *
  1213*----------------------------------------------------------------*
  1214*  PASSED TO ELRATE                                              *
  1215*  ----------------                                              *
  1216*  CERT ISSUE DATE                                               *
  1217*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1218*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1219*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1220*  STATE CODE (CLIENT DEFINED)                                   *
  1221*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1222*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1223*  DEVIATION CODE                                                *
  1224*  ISSUE AGE                                                     *
  1225*  ORIGINAL BENEFIT AMOUNT                                       *
  1226*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1227*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1228*  BENEFIT KIND (LIFE OR A/H)                                    *
  1229*  A.P.R.                                                        *
  1230*  METHOD
  1231*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1232*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1233*  COMPANY I.D. (3 CHARACTER)                                    *
  1234*  BENEFIT CODE                                                  *
  1235*  BENEFIT OVERRIDE CODE                                         *
  1236*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1237*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1238*  JOINT INDICATOR (CSL ONLY)                                    *
  1239*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1240*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1241*                                                                *
  1242*  RETURNED FROM ELRATE                                          *
  1243*  --------------------                                          *
  1244*  CALCULATED PREMIUM                                            *
  1245*  PREMIUM RATE                                                  *
  1246*  MORTALITY CODE                                                *
  1247*  MAX ATTAINED AGE                                              *
  1248*  MAX AGE                                                       *
  1249*  MAX TERM                                                      *
  1250*  MAX MONTHLY BENEFIT                                           *
  1251*  MAX TOTAL BENIFIT                                             *
  1252*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1253*----------------------------------------------------------------*
  1254*  PASSED TO ELRFND                                              *
  1255*  ----------------                                              *
  1256*  CERT ISSUE DATE                                               *
  1257*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  25
* EL156.cbl
  1258*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1259*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1260*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1261*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1262*  STATE CODE (CLIENT DEFINED)                                   *
  1263*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1264*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1265*  DEVIATION CODE                                                *
  1266*  ISSUE AGE                                                     *
  1267*  ORIGINAL BENEFIT AMOUNT                                       *
  1268*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1269*  PROCESS TYPE (CANCEL)                                         *
  1270*  BENEFIT KIND (LIFE OR A/H)                                    *
  1271*  A.P.R.                                                        *
  1272*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1273*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1274*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1275*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1276*  COMPANY I.D. (3 CHARACTER)                                    *
  1277*  BENEFIT CODE                                                  *
  1278*  BENEFIT OVERRIDE CODE                                         *
  1279*                                                                *
  1280*  RETURNED FROM ELRFND                                          *
  1281*  --------------------                                          *
  1282*  CALCULATED REFUND                                             *
  1283*----------------------------------------------------------------*
  1284*  PASSED TO ELEARN                                              *
  1285*  ----------------                                              *
  1286*  CERT ISSUE DATE                                               *
  1287*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1288*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1289*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1290*  STATE CODE (CLIENT DEFINED)                                   *
  1291*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1292*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1293*  DEVIATION CODE                                                *
  1294*  ISSUE AGE                                                     *
  1295*  ORIGINAL BENEFIT AMOUNT                                       *
  1296*  BENEFIT KIND (LIFE OR A/H)                                    *
  1297*  A.P.R.                                                        *
  1298*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1299*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1300*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1301*  COMPANY I.D. (3 CHARACTER)                                    *
  1302*  BENEFIT CODE                                                  *
  1303*  BENEFIT OVERRIDE CODE                                         *
  1304*                                                                *
  1305*  RETURNED FROM ELEARN                                          *
  1306*  --------------------                                          *
  1307*  INDICATED  EARNINGS                                           *
  1308*----------------------------------------------------------------*
  1309*                 LENGTH = 450                                   *
  1310*                                                                *
  1311******************************************************************
  1312******************************************************************
  1313*                   C H A N G E   L O G
  1314*
  1315* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  26
* EL156.cbl
  1316*-----------------------------------------------------------------
  1317*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1318* EFFECTIVE    NUMBER
  1319*-----------------------------------------------------------------
  1320* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1321* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1322* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1323* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1324* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1325* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1326* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1327* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1328* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1329* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1330* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1331******************************************************************
  1332
  1333 01  CALCULATION-PASS-AREA.
  1334     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1335                                     COMP.
  1336
  1337     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1338       88  NO-CP-ERROR                             VALUE ZERO.
  1339       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1340                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1341       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1342       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1343       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1344       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1345       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1346       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1347       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1348       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1349       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1350       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1351       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1352       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1353       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1354       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1355       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1356       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1357       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1358
  1359     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1360       88  NO-CP-ERROR-2                           VALUE ZERO.
  1361***********************  INPUT AREAS ****************************
  1362
  1363     12  CP-CALCULATION-AREA.
  1364         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1365         16  CP-CERT-EFF-DT        PIC XX.
  1366         16  CP-VALUATION-DT       PIC XX.
  1367         16  CP-PAID-THRU-DT       PIC XX.
  1368         16  CP-BENEFIT-TYPE       PIC X.
  1369           88  CP-AH                               VALUE 'A' 'D'
  1370                                                   'I' 'U'.
  1371           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1372           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1373         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  27
* EL156.cbl
  1374         16  CP-REPORTED-DT        PIC XX.
  1375         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1376         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1377         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1378                                     COMP-3.
  1379         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1380                                     COMP-3.
  1381         16  CP-CDT-METHOD         PIC X.
  1382           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1383           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1384           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1385         16  CP-CLAIM-TYPE         PIC X.
  1386           88  CP-AH-CLAIM                         VALUE 'A'.
  1387           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1388         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1389                                     COMP-3.
  1390         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1391                                     COMP-3.
  1392         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1393                                     COMP-3.
  1394         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1395                                     COMP-3.
  1396         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1397                                     COMP-3.
  1398         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1399                                     COMP-3.
  1400         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1401                                     COMP-3.
  1402         16  CP-REM-TERM-METHOD    PIC X.
  1403           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1404           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1405           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1406           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1407           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1408           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1409           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1410         16  CP-EARNING-METHOD     PIC X.
  1411           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1412           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1413           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1414           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1415           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1416           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1417           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1418           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1419           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1420           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1421           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1422           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1423           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1424           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1425         16  CP-PROCESS-TYPE       PIC X.
  1426           88  CP-CLAIM                            VALUE '1'.
  1427           88  CP-CANCEL                           VALUE '2'.
  1428           88  CP-ISSUE                            VALUE '3'.
  1429         16  CP-SPECIAL-CALC-CD    PIC X.
  1430           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1431           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  28
* EL156.cbl
  1432           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1433           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1434           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1435           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1436           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1437           88  CP-FARM-PLAN                    VALUE 'F'.
  1438           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1439           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1440           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1441           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1442           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1443           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1444           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1445           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1446           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1447           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1448                                                     'W' 'X'.
  1449           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1450           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1451           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1452           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1453           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1454           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1455           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1456           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1457           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1458           88  CP-CSL-METH-1                   VALUE '5'.
  1459           88  CP-CSL-METH-2                   VALUE '6'.
  1460           88  CP-CSL-METH-3                   VALUE '7'.
  1461           88  CP-CSL-METH-4                   VALUE '8'.
  1462
  1463         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1464                                     COMP-3.
  1465         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1466         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1467         16  CP-STATE              PIC XX          VALUE SPACE.
  1468         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1469         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1470           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1471               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1472         16  CP-R78-OPTION         PIC X.
  1473           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1474           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1475
  1476         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1477         16  CP-IBNR-RESERVE-SW    PIC X.
  1478         16  CP-CLAIM-STATUS       PIC X.
  1479         16  CP-RATE-FILE          PIC X.
  1480         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1481                                     COMP-3.
  1482
  1483         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1484         16  CP-AH-OVERRIDE-CODE   PIC X.
  1485
  1486         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1487                                     COMP-3.
  1488         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1489                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  29
* EL156.cbl
  1490         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1491                                     COMP-3.
  1492         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1493                                     COMP-3.
  1494         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1495                                     COMP-3.
  1496         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1497                                  PIC S9(7)V99 COMP-3.
  1498
  1499         16  CP-PAID-FROM-DATE     PIC X(02).
  1500         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1501         16  CP-EXT-DAYS-CALC      PIC X.
  1502           88  CP-EXT-NO-CHG                   VALUE ' '.
  1503           88  CP-EXT-CHG-LF                   VALUE '1'.
  1504           88  CP-EXT-CHG-AH                   VALUE '2'.
  1505           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1506         16  CP-DOMICILE-STATE     PIC XX.
  1507         16  CP-CARRIER            PIC X.
  1508         16  CP-REIN-FLAG          PIC X.
  1509         16  CP-REM-TRM-CALC-OPTION PIC X.
  1510           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1511                      '2' '3' '4' '5'.
  1512           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1513           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1514           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1515           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1516           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1517           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1518           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1519           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1520         16  CP-SIG-SWITCH         PIC X.
  1521         16  CP-RATING-METHOD      PIC X.
  1522           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1523           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1524           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1525           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1526           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1527           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1528           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1529           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1530           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1531         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1532                                     COMP-3.
  1533         16  CP-BEN-CATEGORY       PIC X.
  1534         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1535         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1536                                   PIC S99V9(5) COMP-3.
  1537         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1538         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1539                                   PIC S99V9(5) COMP-3.
  1540         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1541         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1542         16  CP-EXPIRE-DT          PIC XX.
  1543         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1544         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1545         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1546         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1547         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  30
* EL156.cbl
  1548             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1549             88  CP-CALC-CLP              VALUE 'C'.
  1550         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1551         16  CP-CANCEL-REASON      PIC X.
  1552         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1553         16  CP-PMT-MODE           PIC X.
  1554         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1555         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1556         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1557         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1558         16  FILLER                PIC X.
  1559
  1560***************    OUTPUT FROM ELRESV   ************************
  1561
  1562         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1563
  1564         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1565                                     COMP-3.
  1566         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1567                                     COMP-3.
  1568         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1569                                     COMP-3.
  1570         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1571                                     COMP-3.
  1572         16  FILLER                PIC X(09).
  1573***************    OUTPUT FROM ELRTRM   *************************
  1574
  1575         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1576                                     COMP-3.
  1577         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1578                                     COMP-3.
  1579         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1580                                     COMP-3.
  1581         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1582                                     COMP-3.
  1583         16  FILLER                PIC X(12).
  1584
  1585***************    OUTPUT FROM ELRAMT   *************************
  1586
  1587         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1588                                     COMP-3.
  1589         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1590                                     COMP-3.
  1591         16  FILLER                PIC X(12).
  1592
  1593***************    OUTPUT FROM ELRATE   *************************
  1594
  1595         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1596                                     COMP-3.
  1597         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1598                                     COMP-3.
  1599         16  CP-MORTALITY-CODE     PIC X(4).
  1600         16  CP-RATE-EDIT-FLAG     PIC X.
  1601             88  CP-RATES-NEED-APR                  VALUE '1'.
  1602         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1603                                     COMP-3.
  1604         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1605         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  31
* EL156.cbl
  1606         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1607                                   PIC S9(7)V99 COMP-3.
  1608         16  FILLER                PIC X(07).
  1609
  1610***************    OUTPUT FROM ELRFND   *************************
  1611
  1612         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1613                                     COMP-3.
  1614         16  CP-REFUND-TYPE-USED   PIC X.
  1615           88  CP-R-AS-R78                         VALUE '1'.
  1616           88  CP-R-AS-PRORATA                     VALUE '2'.
  1617           88  CP-R-AS-CALIF                       VALUE '3'.
  1618           88  CP-R-AS-TEXAS                       VALUE '4'.
  1619           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1620           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1621           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1622           88  CP-R-AS-MEAN                        VALUE '8'.
  1623           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1624           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1625           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1626           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1627           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1628           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1629         16  FILLER                PIC X(12).
  1630
  1631***************    OUTPUT FROM ELEARN   *************************
  1632
  1633         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1634                                     COMP-3.
  1635         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1636                                     COMP-3.
  1637         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1638                                     COMP-3.
  1639         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1640                                     COMP-3.
  1641         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1642                                     COMP-3.
  1643         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1644                                     COMP-3.
  1645         16  CP-EARNING-TYPE-USED  PIC X.
  1646           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1647           88  CP-E-AS-R78                         VALUE '1'.
  1648           88  CP-E-AS-PRORATA                     VALUE '2'.
  1649           88  CP-E-AS-TEXAS                       VALUE '4'.
  1650           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1651           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1652           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1653           88  CP-E-AS-MEAN                        VALUE '8'.
  1654           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1655         16  FILLER                PIC X(12).
  1656
  1657***************    OUTPUT FROM ELPMNT   *************************
  1658
  1659         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1660                                     COMP-3.
  1661         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1662                                     COMP-3.
  1663         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  32
* EL156.cbl
  1664
  1665***************   MISC WORK AREAS    *****************************
  1666         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1667                                     COMP-3.
  1668         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1669                                     COMP-3.
  1670         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1671                                     COMP-3.
  1672         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1673                                     COMP-3.
  1674         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1675                                     COMP-3.
  1676         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1677                                     COMP-3.
  1678         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1679             88  OPEN-RATE-FILE                   VALUE 'O'.
  1680             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1681             88  IO-ERROR                         VALUE 'E'.
  1682
  1683         16  CP-FIRST-PAY-DATE     PIC XX.
  1684
  1685         16  CP-JOINT-INDICATOR    PIC X.
  1686
  1687         16  CP-RESERVE-REMAINING-TERM
  1688                                   PIC S9(4)V9    VALUE ZERO
  1689                                     COMP-3.
  1690
  1691         16  CP-INSURED-BIRTH-DT   PIC XX.
  1692
  1693         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1694                                     COMP-3.
  1695
  1696         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1697                                     COMP-3.
  1698
  1699         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1700                                     COMP-3.
  1701
  1702         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1703                                     COMP-3.
  1704
  1705         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1706                                     COMP-3.
  1707
  1708         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1709                                     COMP-3.
  1710
  1711         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1712                                     COMP-3.
  1713
  1714         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1715             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1716
  1717         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1718                                     COMP-3.
  1719         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1720                                     COMP-3.
  1721         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  33
* EL156.cbl
  1722         16  cp-extra-periods      pic 9 value zeros.
  1723         16  cp-net-only-state     pic x value spaces.
  1724         16  FILLER                PIC X(13).
  1725******************************************************************
  1726*    COPY ELCICALC.
  1727******************************************************************
  1728*                                                                *
  1729*                           ELCCICALC.                           *
  1730*                            VMOD=2.001                          *
  1731*                                                                *
  1732*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1733*                 CALCULATION MODULE                             *
  1734*                                                                *
  1735*  PASSED TO ELCLMI                                              *
  1736*  -----------------                                             *
  1737*  STATE                                                         *
  1738*  PRODUCT                                                       *
  1739*  COVERAGE                                                      *
  1740*  EFFECTIVE DATE                                                *
  1741*  INCURRED DATE                                                 *
  1742*  ESTABLISHED DATE                                              *
  1743*  LAST PAID DATE                                                *
  1744*  REPORTED DATE                                                 *
  1745*  CLAIM PAYMENT AMOUNT                                          *
  1746*                                                                *
  1747*  RETURNED FROM ELRTRM                                          *
  1748*  ---------------------                                         *
  1749*  RETURN CODE                                                   *
  1750*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1751*  CLAIM INTEREST AMOUNT                                         *
  1752*----------------------------------------------------------------*
  1753*----------------------------------------------------------------*
  1754*                 LENGTH = 100                                   *
  1755*                                                                *
  1756******************************************************************
  1757******************************************************************
  1758*                   C H A N G E   L O G
  1759*
  1760* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1761*-----------------------------------------------------------------
  1762*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1763* EFFECTIVE    NUMBER
  1764*-----------------------------------------------------------------
  1765* 120905    2004040700004  PEMA  NEW COPYBOOK
  1766* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1767******************************************************************
  1768
  1769 01  CLAIM-INT-PASS-AREA.
  1770     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1771                                     COMP.
  1772
  1773     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1774       88  NO-CI-ERROR                             VALUE ZERO.
  1775       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1776       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1777       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1778       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1779       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  34
* EL156.cbl
  1780       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1781       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1782       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1783       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1784***********************  INPUT AREAS ****************************
  1785
  1786     12  CP-CALCULATION-AREA.
  1787         16  CP-COMPANY-CD         PIC X.
  1788         16  CP-STATE              PIC XX.
  1789         16  CP-PRODUCT            PIC XX.
  1790         16  CP-COVERAGE           PIC XX.
  1791         16  CP-INC-DT             PIC XX.
  1792         16  CP-EST-DT             PIC XX.
  1793         16  CP-LSTPD-DT           PIC XX.
  1794         16  CP-RPT-DT             PIC XX.
  1795         16  CP-PRF-DT             PIC XX.
  1796         16  CP-EFF-DT             PIC XX.
  1797         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1798         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1799         16  FILLER                PIC X(37).
  1800
  1801***************    OUTPUT FROM ELCLMI   ************************
  1802
  1803         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1804
  1805         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1806         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1807         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1808         16  FILLER                PIC X(19).
  1809******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  35
* EL156.cbl
  1811*    COPY ELCATTR.
  1812******************************************************************
  1813*                                                                *
  1814*                            ELCATTR.                            *
  1815*                            VMOD=2.001                          *
  1816*                                                                *
  1817*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1818*                                                                *
  1819*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1820*                                                                *
  1821*                   POS 1   P=PROTECTED                          *
  1822*                           U=UNPROTECTED                        *
  1823*                           S=ASKIP                              *
  1824*                   POS 2   A=ALPHA/NUMERIC                      *
  1825*                           N=NUMERIC                            *
  1826*                   POS 3   N=NORMAL                             *
  1827*                           B=BRIGHT                             *
  1828*                           D=DARK                               *
  1829*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1830*                           OF=MODIFIED DATA TAG OFF             *
  1831*                                                                *
  1832*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1833******************************************************************
  1834 01  ATTRIBUTE-LIST.
  1835     12  AL-PABOF            PIC X       VALUE 'Y'.
  1836     12  AL-PABON            PIC X       VALUE 'Z'.
  1837     12  AL-PADOF            PIC X       VALUE '%'.
  1838     12  AL-PADON            PIC X       VALUE '_'.
  1839     12  AL-PANOF            PIC X       VALUE '-'.
  1840     12  AL-PANON            PIC X       VALUE '/'.
  1841     12  AL-SABOF            PIC X       VALUE '8'.
  1842     12  AL-SABON            PIC X       VALUE '9'.
  1843     12  AL-SADOF            PIC X       VALUE '@'.
  1844     12  AL-SADON            PIC X       VALUE QUOTE.
  1845     12  AL-SANOF            PIC X       VALUE '0'.
  1846     12  AL-SANON            PIC X       VALUE '1'.
  1847     12  AL-UABOF            PIC X       VALUE 'H'.
  1848     12  AL-UABON            PIC X       VALUE 'I'.
  1849     12  AL-UADOF            PIC X       VALUE '<'.
  1850     12  AL-UADON            PIC X       VALUE '('.
  1851     12  AL-UANOF            PIC X       VALUE ' '.
  1852     12  AL-UANON            PIC X       VALUE 'A'.
  1853     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1854     12  AL-UNBON            PIC X       VALUE 'R'.
  1855     12  AL-UNDOF            PIC X       VALUE '*'.
  1856     12  AL-UNDON            PIC X       VALUE ')'.
  1857     12  AL-UNNOF            PIC X       VALUE '&'.
  1858     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  36
* EL156.cbl
  1860*    COPY ELCEMIB.
  1861******************************************************************
  1862*                                                                *
  1863*                                                                *
  1864*                            ELCEMIB.                            *
  1865*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1866*                            VMOD=2.005                          *
  1867*                                                                *
  1868*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1869*                                                                *
  1870******************************************************************
  1871 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1872     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1873     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1874     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1875     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1876     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1877     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1878     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1879     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1880     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1881         88  EMI-NO-ERRORS                    VALUE '1'.
  1882         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1883         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1884     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1885         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1886     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1887         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1888         88  EMI-AREA1-FULL                   VALUE '2'.
  1889     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1890         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1891         88  EMI-AREA2-FULL                   VALUE '2'.
  1892     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1893         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1894         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1895         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1896         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1897         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1898     12  EMI-ERROR-LINES.
  1899         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1900         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1901         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1902         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1903             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1904                 24  EMI-ERR-NUM         PIC X(4).
  1905                 24  EMI-FILLER          PIC X.
  1906                 24  EMI-SEV             PIC X.
  1907                 24  FILLER              PIC X.
  1908             20  FILLER                  PIC X(02).
  1909     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1910         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1911             20  EMI-ERROR-NUMBER    PIC X(4).
  1912             20  EMI-FILL            PIC X.
  1913             20  EMI-SEVERITY        PIC X.
  1914             20  FILLER              PIC X.
  1915             20  EMI-ERROR-TEXT.
  1916                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1917                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  37
* EL156.cbl
  1918     12  EMI-SEVERITY-SAVE           PIC X.
  1919         88  EMI-NOTE                    VALUE 'N'.
  1920         88  EMI-WARNING                 VALUE 'W'.
  1921         88  EMI-FORCABLE                VALUE 'F'.
  1922         88  EMI-FATAL                   VALUE 'X'.
  1923     12  EMI-MESSAGE-FLAG            PIC X.
  1924         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1925         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1926     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1927     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1928         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1929         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1930         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1931     12  emi-claim-no                pic x(7).
  1932     12  emi-claim-type              pic x(6).
  1933     12  FILLER                      PIC X(124)  VALUE SPACES.
  1934     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1935     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1936     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1937     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  38
* EL156.cbl
  1939*    COPY ELCLNKLT.
  1940******************************************************************
  1941*                                                                *
  1942*                                                                *
  1943*                           ELCLNKLT                             *
  1944*                            VMOD=2.003                          *
  1945*                                                                *
  1946*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1947*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1948*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1949*                                                                *
  1950*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1951*   COMPLETING THE REQUIRED FIELDS.                              *
  1952*                                                                *
  1953*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1954*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1955*                              9999 INDICATES AN UNKNOWN ABEND   *
  1956*                                   WAS DETECTED.                *
  1957*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1958*                              CODES FOUND IN THE ERROR FILE.    *
  1959******************************************************************
  1960 01  W-1523-LINKDATA.
  1961     12  W-1523-COMMON-PI-DATA.
  1962         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1963         16  FILLER              PIC  X(67).
  1964         16  W-1523-COMPANY-CD   PIC  X(01).
  1965         16  FILLER              PIC  X(10).
  1966         16  W-1523-CONTROL-IN-PROGRESS.
  1967             20  W-1523-CARRIER  PIC  X(01).
  1968             20  W-1523-GROUPING PIC  X(06).
  1969             20  W-1523-STATE    PIC  X(02).
  1970             20  W-1523-ACCOUNT  PIC  X(10).
  1971             20  W-1523-CLAIM-CERT-GRP.
  1972                 24  W-1523-CLAIM-NO
  1973                                 PIC  X(07).
  1974                 24  W-1523-CERT-NO.
  1975                     28  W-1523-CERT-PRIME
  1976                                 PIC  X(10).
  1977                     28  W-1523-CERT-SFX
  1978                                 PIC  X(01).
  1979                 24  W-1523-CERT-EFF-DT
  1980                                 PIC  X(02).
  1981         16  FILLER              PIC X(265).
  1982
  1983     12  W-1523-WORK-AREA.
  1984         16  W-1523-FORM-NUMBER  PIC  X(04).
  1985         16  W-1523-NUMBER-COPIES
  1986                                 PIC  9(01).
  1987         16  W-1523-ADDR-TYPE    PIC  X(02).
  1988         16  W-1523-FOLLOW-UP-DATE
  1989                                 PIC  X(02).
  1990         16  W-1523-RESEND-DATE  PIC  X(02).
  1991         16  W-1523-ERROR-CODE   PIC  9(04).
  1992             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1993             88  W-1523-FATAL-ERROR
  1994                                    VALUES  0006 0013 0042
  1995                                            0154 0168 0169
  1996                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  39
* EL156.cbl
  1997                                            0179 0186 0281
  1998                                            0332 2055 3697
  1999                                            3698 3699 3770
  2000                                            3771 3772 7675
  2001                                            9106 9808 9883
  2002                                            9887.
  2003             88  W-1523-STOP-ERRORS
  2004                                    VALUES  0013 0042 0154
  2005                                            0168 0169 0172
  2006                                            0281 0332 2055
  2007                                            3698 3699 7675
  2008                                            9106 9808 9883
  2009                                            9999.
  2010         16  W-1523-REASON       PIC  X(70).
  2011         16  W-1523-ARCHIVE-NUMBER
  2012                                 PIC  9(08).
  2013     12  W-1523-POINTER-AREA.
  2014         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2015         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2016         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2017         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2018         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  40
* EL156.cbl
  2020*    COPY ELCNWA.
  2021*****************************************************************
  2022*                                                               *
  2023*                                                               *
  2024*                            ELCNWA.                            *
  2025*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2026*                            VMOD=2.003                         *
  2027*                                                               *
  2028*            M O V E   N A M E   W O R K   A R E A.             *
  2029*                                                               *
  2030*****************************************************************.
  2031
  2032 01  WS-NAME-WORK-AREA.
  2033     05  WS-INSURED-LAST-NAME        PIC X(15).
  2034     05  WS-INSURED-1ST-NAME         PIC X(12).
  2035     05  WS-INSURED-MID-INIT         PIC X.
  2036
  2037     05  WS-NAME-WORK.
  2038         10  WS-NW                   PIC X
  2039             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2040
  2041     05  WS-NAME-WORK2.
  2042         10  WS-NW2                  PIC X
  2043             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2044                                        NWA-INDEX0.
  2045
  2046     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2047                                     COMP-3.
  2048
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  41
* EL156.cbl
  2050*    COPY ELCDMO.
  2051******************************************************************
  2052*                                                                *
  2053*                                                                *
  2054*                            ELCDMO.                             *
  2055*                            VMOD=2.004                          *
  2056*                                                                *
  2057*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2058*        COMMUNICATION AREA                                      *
  2059*   FILE TYPE = NA                                               *
  2060*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2061*                                                                *
  2062******************************************************************
  2063 01  DMO-COMMUNICATION-AREA.
  2064     12  DM-RECORD-TYPE                  PIC  X(02).
  2065             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2066             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2067             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2068     12  DM-DIST-CODE                    PIC  X(04).
  2069     12  DM-MAIL-CODE                    PIC  X(05).
  2070     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2071     12  DM-INSURED-NAME                 PIC  X(30).
  2072     12  DM-CLAIM-NO                     PIC  X(07).
  2073     12  DM-CLAIM-TYPE                   PIC  X.
  2074
  2075     12  DM-STATUS-DATA-AREA.
  2076         16  DM-CLAIM-STATUS             PIC  X.
  2077             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2078             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2079             88  DM-CLOSED                        VALUE '3'.
  2080             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2081             88  DM-DEFAULT                       VALUE '9'.
  2082         16  DM-STATUS-DATE              PIC  X(08).
  2083******YYYYMMDD
  2084         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2085             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2086             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2087             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2088             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2089             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2090             88  DM-RE-OPENED                     VALUE 'R'.
  2091             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2092             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2093             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2094         16  DM-STAT-CARRIER             PIC X.
  2095
  2096     12  DM-DRAFT-DATA-AREA.
  2097         16  DM-PAYMENT-TYPE             PIC  X.
  2098             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2099         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2100         16  DM-PAYMENT-DATE             PIC  X(08).
  2101******YYYYMMDD
  2102         16  DM-CERT-NO                  PIC  X(11).
  2103         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2104         16  DM-CARRIER                  PIC  X.
  2105
  2106     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  42
* EL156.cbl
  2108*    COPY ELCDMDCD.
  2109******************************************************************
  2110*                                                                *
  2111*                                                                *
  2112*                            ELCDMDCD.                           *
  2113*                            VMOD=2.001                          *
  2114*                                                                *
  2115*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2116*       COMMUNICATIONS AREA                                      *
  2117*                                                                *
  2118******************************************************************
  2119 01  CD-COMMUNICATION-AREA.
  2120     12  CD-SYSTEM-ID            PIC  X(02).
  2121         88 CD-CLAIMS                      VALUE 'CL'.
  2122         88 CD-CREDIT                      VALUE 'CR'.
  2123     12  CD-RECORD-TYPE          PIC  X(02).
  2124         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2125         88 CD-EOB-CODE                    VALUE 'EO'.
  2126         88 CD-ICD9-CODE                   VALUE 'I9'.
  2127         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2128         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2129         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2130         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2131         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2132     12  CD-RECORD-KEY           PIC  X(06).
  2133         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2134     12  CD-RETURN-CODE          PIC  X(02).
  2135     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2136     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2137     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2138     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  43
* EL156.cbl
  2140*    COPY ELCDCTB.
  2141******************************************************************
  2142*                                                                *
  2143*                                                                *
  2144*                            ELCDCTB.                            *
  2145*                            VMOD=2.002                          *
  2146*                                                                *
  2147*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2148*       COMMUNICATIONS AREA                                      *
  2149*                                                                *
  2150******************************************************************
  2151 01  DCT-COMMUNICATION-AREA.
  2152     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2153     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2154     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2155     12  DCT-PRODUCT-CODE         PIC  X(02).
  2156     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2157     12  DCT-RETURN-CODE          PIC  X(02).
  2158     12  DCT-MAIL-CODE            PIC  X(05).
  2159     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2160     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  44
* EL156.cbl
  2162 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2163 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2164 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2165 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  45
* EL156.cbl
  2167*    COPY ELCINTF.
  2168******************************************************************
  2169*                                                                *
  2170*                                                                *
  2171*                            ELCINTF.                            *
  2172*                            VMOD=2.017                          *
  2173*                                                                *
  2174*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2175*                                                                *
  2176*       LENGTH = 1024                                            *
  2177*                                                                *
  2178******************************************************************
  2179*                   C H A N G E   L O G
  2180*
  2181* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2182*-----------------------------------------------------------------
  2183*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2184* EFFECTIVE    NUMBER
  2185*-----------------------------------------------------------------
  2186* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2187******************************************************************
  2188 01  PROGRAM-INTERFACE-BLOCK.
  2189     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2190     12  PI-CALLING-PROGRAM              PIC X(8).
  2191     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2192     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2193     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2194     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2195     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2196     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2197     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2198     12  PI-COMPANY-ID                   PIC XXX.
  2199     12  PI-COMPANY-CD                   PIC X.
  2200
  2201     12  PI-COMPANY-PASSWORD             PIC X(8).
  2202
  2203     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2204
  2205     12  PI-CONTROL-IN-PROGRESS.
  2206         16  PI-CARRIER                  PIC X.
  2207         16  PI-GROUPING                 PIC X(6).
  2208         16  PI-STATE                    PIC XX.
  2209         16  PI-ACCOUNT                  PIC X(10).
  2210         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2211                                         PIC X(10).
  2212         16  PI-CLAIM-CERT-GRP.
  2213             20  PI-CLAIM-NO             PIC X(7).
  2214             20  PI-CERT-NO.
  2215                 25  PI-CERT-PRIME       PIC X(10).
  2216                 25  PI-CERT-SFX         PIC X.
  2217             20  PI-CERT-EFF-DT          PIC XX.
  2218         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2219             20  PI-PLAN-CODE            PIC X(2).
  2220             20  PI-REVISION-NUMBER      PIC X(3).
  2221             20  PI-PLAN-EFF-DT          PIC X(2).
  2222             20  PI-PLAN-EXP-DT          PIC X(2).
  2223             20  FILLER                  PIC X(11).
  2224         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  46
* EL156.cbl
  2225             20  PI-OE-REFERENCE-1.
  2226                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2227                 25  PI-OE-REF-1-SUFF    PIC XX.
  2228
  2229     12  PI-SESSION-IN-PROGRESS          PIC X.
  2230         88  CLAIM-SESSION                   VALUE '1'.
  2231         88  CREDIT-SESSION                  VALUE '2'.
  2232         88  WARRANTY-SESSION                VALUE '3'.
  2233         88  MORTGAGE-SESSION                VALUE '4'.
  2234         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2235
  2236
  2237*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2238
  2239     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2240     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2241
  2242     12  PI-CREDIT-USER                  PIC X.
  2243         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2244         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2245
  2246     12  PI-CLAIM-USER                   PIC X.
  2247         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2248         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2249
  2250     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2251         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2252         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2253         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2254         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2255         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2256
  2257     12  PI-PROCESSOR-ID                 PIC X(4).
  2258
  2259     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2260
  2261     12  PI-MEMBER-CAPTION               PIC X(10).
  2262
  2263     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2264         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2265
  2266     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2267     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2268     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2269     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2270
  2271     12  PI-AH-OVERRIDE-L1               PIC X.
  2272     12  PI-AH-OVERRIDE-L2               PIC XX.
  2273     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2274     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2275
  2276     12  PI-NEW-SYSTEM                   PIC X(2).
  2277
  2278     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2279     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2280         88  PI-USES-PAID-TO                 VALUE '1'.
  2281     12  PI-CRDTCRD-SYSTEM.
  2282         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  47
* EL156.cbl
  2283             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2284             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2285         16  PI-CC-MONTH-END-DT          PIC XX.
  2286     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2287
  2288     12  PI-OE-REFERENCE-2.
  2289         16  PI-OE-REF-2-PRIME           PIC X(10).
  2290         16  PI-OE-REF-2-SUFF            PIC X.
  2291
  2292     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2293
  2294     12  PI-LANGUAGE-TYPE                PIC X.
  2295             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2296             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2297             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2298
  2299     12  PI-POLICY-LINKAGE-IND           PIC X.
  2300         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2301         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2302                                                   LOW-VALUES.
  2303
  2304     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2305     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2306         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2307         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2308
  2309     12  PI-PROCESSOR-CSR-IND            PIC X.
  2310         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2311         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2312
  2313     12  FILLER                          PIC X(3).
  2314
  2315     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2316
  2317     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2318         PI-SYSTEM-LEVEL.
  2319
  2320         16  PI-ENTRY-CODES.
  2321             20  PI-ENTRY-CD-1           PIC X.
  2322             20  PI-ENTRY-CD-2           PIC X.
  2323
  2324         16  PI-RETURN-CODES.
  2325             20  PI-RETURN-CD-1          PIC X.
  2326             20  PI-RETURN-CD-2          PIC X.
  2327
  2328         16  PI-UPDATE-STATUS-SAVE.
  2329             20  PI-UPDATE-BY            PIC X(4).
  2330             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2331
  2332         16  PI-LOWER-CASE-LETTERS       PIC X.
  2333             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2334
  2335*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2336*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2337*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2338
  2339         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2340             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  48
* EL156.cbl
  2341             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2342             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2343             88  ACCNT-CNTL                  VALUE '3'.
  2344             88  CARR-ACCNT-CNTL             VALUE '4'.
  2345
  2346         16  PI-PROCESSOR-CAP-LIST.
  2347             20  PI-SYSTEM-CONTROLS.
  2348                24 PI-SYSTEM-DISPLAY     PIC X.
  2349                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2350                24 PI-SYSTEM-MODIFY      PIC X.
  2351                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2352             20  FILLER                  PIC XX.
  2353             20  PI-DISPLAY-CAP          PIC X.
  2354                 88  DISPLAY-CAP             VALUE 'Y'.
  2355             20  PI-MODIFY-CAP           PIC X.
  2356                 88  MODIFY-CAP              VALUE 'Y'.
  2357             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2358                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2359             20  PI-FORCE-CAP            PIC X.
  2360                 88  FORCE-CAP               VALUE 'Y'.
  2361
  2362         16  PI-PROGRAM-CONTROLS.
  2363             20  PI-PGM-PRINT-OPT        PIC X.
  2364             20  PI-PGM-FORMAT-OPT       PIC X.
  2365             20  PI-PGM-PROCESS-OPT      PIC X.
  2366             20  PI-PGM-TOTALS-OPT       PIC X.
  2367
  2368         16  PI-HELP-INTERFACE.
  2369             20  PI-LAST-ERROR-NO        PIC X(4).
  2370             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2371
  2372         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2373             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2374
  2375         16  PI-CR-CONTROL-IN-PROGRESS.
  2376             20  PI-CR-CARRIER           PIC X.
  2377             20  PI-CR-GROUPING          PIC X(6).
  2378             20  PI-CR-STATE             PIC XX.
  2379             20  PI-CR-ACCOUNT           PIC X(10).
  2380             20  PI-CR-FIN-RESP          PIC X(10).
  2381             20  PI-CR-TYPE              PIC X.
  2382
  2383         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2384
  2385         16  PI-CR-MONTH-END-DT          PIC XX.
  2386
  2387         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2388             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2389             88  PI-ZERO-CARRIER             VALUE '1'.
  2390             88  PI-ZERO-GROUPING            VALUE '2'.
  2391             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2392
  2393         16  PI-CARRIER-SECURITY         PIC X.
  2394             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2395
  2396         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2397             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2398             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  49
* EL156.cbl
  2399
  2400         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2401             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2402                                         INDEXED BY PI-ACCESS-NDX
  2403                                         PIC X.
  2404
  2405         16  PI-GA-BILLING-CONTROL       PIC X.
  2406             88  PI-GA-BILLING               VALUE '1'.
  2407
  2408         16  PI-MAIL-PROCESSING          PIC X.
  2409             88  PI-MAIL-YES                 VALUE 'Y'.
  2410
  2411         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2412
  2413         16  PI-AR-SYSTEM.
  2414             20  PI-AR-PROCESSING-CNTL   PIC X.
  2415                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2416             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2417             20  PI-AR-MONTH-END-DT      PIC XX.
  2418
  2419         16  PI-MP-SYSTEM.
  2420             20  PI-MORTGAGE-USER            PIC X.
  2421                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2422                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2423             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2424                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2425                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2426                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2427                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2428                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2429             20  PI-MP-MONTH-END-DT          PIC XX.
  2430             20  PI-MP-REFERENCE-NO.
  2431                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2432                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2433
  2434         16  PI-LABEL-CONTROL            PIC X(01).
  2435             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2436             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2437
  2438         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2439             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2440
  2441         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2442             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2443             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2444
  2445         16  FILLER                      PIC X(14).
  2446
  2447     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2448******************************************************************
  2449     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2450         16  PI-SAVE-FORM        PIC X(12).
  2451         16  PI-ACCT-KEY         PIC X(26).
  2452         16  PI-PAYEE-NAME       PIC X(30).
  2453         16  PI-DAILY-RATE       PIC S9(3)V99.
  2454         16  PI-MONTH-END-SAVE   PIC XX.
  2455         16  PI-BENEFIT-SAVE.
  2456             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  50
* EL156.cbl
  2457             20  PI-BEN-TYPE     PIC X.
  2458         16  PI-MANUAL-SW        PIC 9.
  2459         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2460         16  PI-PASS-SW          PIC X.
  2461         16  PI-PFKEY-USED       PIC X.
  2462         16  PI-CK-ASSIGN        PIC X.
  2463         16  PI-FATAL-COUNT      PIC 99.
  2464         16  PI-FORCE-COUNT      PIC 99.
  2465         16  PI-SAVE-INPUT.
  2466             20  PI-PMTTYPE      PIC X.
  2467             20  PI-PAYEE.
  2468                 24  PI-PAYEE-TYPE PIC X.
  2469                 24  PI-PAYEE-SEQ  PIC X.
  2470                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2471                   PI-PAYEE-SEQ    PIC S9.
  2472             20  PI-PMTNOTE1     PIC X(60).
  2473             20  PI-PMTNOTE2     PIC X(60).
  2474             20  PI-OFFLINE      PIC X.
  2475             20  PI-ECHECKNO     PIC X(7).
  2476             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2477                 28  PI-ECHECKNO-N     PIC X.
  2478                 28  PI-ECHECKNO-6     PIC X(6).
  2479             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2480                 24  PI-ECHECKNO-CR    PIC XX.
  2481                 24  PI-ECHECKNO-5     PIC X(5).
  2482             20  PI-HOLDTIL      PIC 9(6).
  2483             20  PI-EPYFROM      PIC 9(6).
  2484             20  PI-EPYTHRU      PIC 9(6).
  2485             20  PI-EDAYS        PIC S9(5).
  2486             20  PI-EPYAMT       PIC S9(7)V99.
  2487             20  PI-ERESV        PIC S9(7)V99.
  2488             20  PI-EEXPENS      PIC 9(6)V99.
  2489             20  PI-ETYPE        PIC X.
  2490             20  PI-CASH         PIC X.
  2491             20  PI-GROUPED      PIC X.
  2492             20  PI-INT-RATE     PIC S99V9(5).
  2493             20  PI-AIGFROM      PIC 9(6).
  2494             20  PI-LOAN-NO      PIC X(20).
  2495             20  PI-PROOF-DATE   PIC 9(6).
  2496             20  PI-PRINT-EOB-YN PIC X.
  2497             20  PI-PRINT-CLM-FRM-YN PIC X.
  2498             20  PI-PRINT-SURVEY-YN PIC X.
  2499             20  PI-SPECIAL-RELEASE-YN PIC X.
  2500             20  pi-int-to-rem-borr pic x.
  2501         16  PI-SAVE-COMPUTED.
  2502             20  PI-CCHECKNO     PIC X(7).
  2503             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2504                 28  PI-CCHECKNO-N     PIC X.
  2505                 28  PI-CCHECKNO-6     PIC X(6).
  2506             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2507                 24  PI-CCHECKNO-CR    PIC XX.
  2508                 24  PI-CCHECKNO-5     PIC X(5).
  2509             20  PI-CPYFROM      PIC XX.
  2510             20  PI-CPYTHRU      PIC XX.
  2511             20  PI-CDAYS        PIC S9(5).
  2512             20  PI-CPYAMT       PIC S9(7)V99.
  2513             20  PI-CRESV        PIC 9(6)V99.
  2514             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  51
* EL156.cbl
  2515             20  PI-PMT-APPR-SW  PIC X.
  2516                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2517                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2518                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2519         16  PI-PREV-CLMNO       PIC X(7).
  2520         16  PI-LF-COVERAGE-TYPE PIC X.
  2521         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2522         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2523         16  PI-PROVISIONAL-IND  PIC X.
  2524             88 PI-PROV-PMT      VALUE 'P'.
  2525         16  PI-PREV-TRLR-KEY    PIC X(22).
  2526         16  PI-SPLIT-PMT-SW     PIC X.
  2527         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2528         16  PI-ACTIVITY-CODE    PIC 99.
  2529         16  PI-RESET-SW         PIC X.
  2530         16  PI-SPECIAL-BEN-SW   PIC X.
  2531             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2532         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2533         16  PI-EXP-DT           PIC XX.
  2534         16  PI-LOAN-DUE-DAY     PIC 99.
  2535         16  PI-3RD-PARTY-SW     PIC X.
  2536         16  PI-LOAN-UPDATE-SW   PIC X.
  2537
  2538         16  PI-DMD-DATA.
  2539             20  PI-SV-CERT-KEY       PIC X(21).
  2540             20  PI-SV-CERT-NO        PIC X(11).
  2541             20  PI-SV-BEN            PIC X(10).
  2542             20  PI-SV-CCN            PIC X(16).
  2543             20  PI-INTEREST-PAID-IND PIC X.
  2544                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2545             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2546             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2547             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2548             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2549         16  PI-AT-EOB-CODES.
  2550             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2551         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2552         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2553         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2554         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2555         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2556         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2557         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2558         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2559         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2560         16  PI-LF-BENEFIT-CD         PIC X(2).
  2561         16  PI-EOB-CODES-EXIST PIC X.
  2562         16  PI-SET-NOTE2-MDT   PIC X.
  2563         16  PI-VFY-2ND-BENE          PIC X.
  2564         16  PI-CLM-TYPE              PIC X.
  2565         16  PI-APPROVAL-LEVEL        PIC X.
  2566         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2567         16  PI-REAUDIT-NEEDED        PIC X.
  2568         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2569         16  PI-AH-BENEFIT-CD         PIC XX.
  2570         16  pi-ah-term               pic s999 comp-3.
  2571         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2572         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  52
* EL156.cbl
  2573         16  pi-max-ext-used          pic x.
  2574         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2575         16  PI-JOINT-COV-IND         PIC X.
  2576             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2577             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2578         16  PI-JOINT-INSURED-IND     PIC X.
  2579             88  PI-JOINT-INSURED        VALUE 'Y'.
  2580             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2581         16  pi-int-payees-name       pic x(30).
  2582         16  PI-RB-JOINT-COV-IND      PIC X.
  2583             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2584             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2585         16  pi-ach-payment           pic x.
  2586*00781          16  FILLER                   PIC X(176).
  2587*052506         16  FILLER                   PIC X(161).
  2588*031808         16  FILLER                   PIC X(154).
  2589*091808         16  FILLER                   PIC X(152).
  2590*041710         16  FILLER                   PIC X(94).
  2591         16  FILLER                   PIC X(34).
  2592
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  53
* EL156.cbl
  2594*    COPY ELCJPFX.
  2595******************************************************************
  2596*                                                                *
  2597*                                                                *
  2598*                            ELCJPFX.                            *
  2599*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2600*                            VMOD=2.002                          *
  2601*                                                                *
  2602*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2603*                                                                *
  2604*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2605*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2606*        ELCNTL - CONTROL FILE                                   *
  2607*        ELMSTR - CLAIM MASTERS                                  *
  2608*        ELTRLR - ACTIVITY TRAILERS                              *
  2609*        ELCHKQ - CHECK QUE                                      *
  2610******************************************************************
  2611 01  JOURNAL-RECORD.
  2612     12  jp-date                     pic s9(5) comp-3.
  2613     12  jp-time                     pic s9(7) comp-3.
  2614     12  JP-USER-ID                  PIC X(4).
  2615     12  JP-FILE-ID                  PIC X(8).
  2616     12  JP-PROGRAM-ID               PIC X(8).
  2617     12  JP-RECORD-TYPE              PIC X.
  2618         88 JP-ADD              VALUE 'A'.
  2619         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2620         88 JP-AFTER-CHANGE     VALUE 'C'.
  2621         88 JP-DELETE           VALUE 'D'.
  2622         88 JP-GENERIC-DELETE   VALUE 'G'.
  2623         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2624         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2625     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2626     12  JP-RECORD-AREA
  2627
  2628
  2629                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  54
* EL156.cbl
  2631*    COPY ELCAID.
  2632******************************************************************
  2633*                                                                *
  2634*                            ELCAID.                             *
  2635*                            VMOD=2.001                          *
  2636*                                                                *
  2637*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2638*                                                                *
  2639*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2640*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2641******************************************************************
  2642
  2643 01  DFHAID.
  2644   02  DFHNULL   PIC  X  VALUE  ' '.
  2645   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2646   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2647   02  DFHPEN    PIC  X  VALUE  '='.
  2648   02  DFHOPID   PIC  X  VALUE  'W'.
  2649   02  DFHPA1    PIC  X  VALUE  '%'.
  2650   02  DFHPA2    PIC  X  VALUE  '>'.
  2651   02  DFHPA3    PIC  X  VALUE  ','.
  2652   02  DFHPF1    PIC  X  VALUE  '1'.
  2653   02  DFHPF2    PIC  X  VALUE  '2'.
  2654   02  DFHPF3    PIC  X  VALUE  '3'.
  2655   02  DFHPF4    PIC  X  VALUE  '4'.
  2656   02  DFHPF5    PIC  X  VALUE  '5'.
  2657   02  DFHPF6    PIC  X  VALUE  '6'.
  2658   02  DFHPF7    PIC  X  VALUE  '7'.
  2659   02  DFHPF8    PIC  X  VALUE  '8'.
  2660   02  DFHPF9    PIC  X  VALUE  '9'.
  2661   02  DFHPF10   PIC  X  VALUE  ':'.
  2662   02  DFHPF11   PIC  X  VALUE  '#'.
  2663   02  DFHPF12   PIC  X  VALUE  '@'.
  2664   02  DFHPF13   PIC  X  VALUE  'A'.
  2665   02  DFHPF14   PIC  X  VALUE  'B'.
  2666   02  DFHPF15   PIC  X  VALUE  'C'.
  2667   02  DFHPF16   PIC  X  VALUE  'D'.
  2668   02  DFHPF17   PIC  X  VALUE  'E'.
  2669   02  DFHPF18   PIC  X  VALUE  'F'.
  2670   02  DFHPF19   PIC  X  VALUE  'G'.
  2671   02  DFHPF20   PIC  X  VALUE  'H'.
  2672   02  DFHPF21   PIC  X  VALUE  'I'.
  2673*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2674   02  DFHPF22   PIC  X  VALUE  '['.
  2675   02  DFHPF23   PIC  X  VALUE  '.'.
  2676   02  DFHPF24   PIC  X  VALUE  '<'.
  2677   02  DFHMSRE   PIC  X  VALUE  'X'.
  2678   02  DFHSTRF   PIC  X  VALUE  'h'.
  2679   02  DFHTRIG   PIC  X  VALUE  '"'.
  2680 01  FILLER    REDEFINES DFHAID.
  2681     12  FILLER              PIC X(8).
  2682     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  55
* EL156.cbl
  2684*    COPY EL156S.
  2685 01  EL156AI.
  2686     05  FILLER            PIC  X(0012).
  2687*    -------------------------------
  2688     05  RUNDTEAL PIC S9(0004) COMP.
  2689     05  RUNDTEAF PIC  X(0001).
  2690     05  FILLER REDEFINES RUNDTEAF.
  2691         10  RUNDTEAA PIC  X(0001).
  2692     05  RUNDTEAI PIC  X(0008).
  2693*    -------------------------------
  2694     05  RUNTIMAL PIC S9(0004) COMP.
  2695     05  RUNTIMAF PIC  X(0001).
  2696     05  FILLER REDEFINES RUNTIMAF.
  2697         10  RUNTIMAA PIC  X(0001).
  2698     05  RUNTIMAI PIC  X(0005).
  2699*    -------------------------------
  2700     05  SEQUL PIC S9(0004) COMP.
  2701     05  SEQUF PIC  X(0001).
  2702     05  FILLER REDEFINES SEQUF.
  2703         10  SEQUA PIC  X(0001).
  2704     05  SEQUI PIC  X(0010).
  2705*    -------------------------------
  2706     05  CLMNOL PIC S9(0004) COMP.
  2707     05  CLMNOF PIC  X(0001).
  2708     05  FILLER REDEFINES CLMNOF.
  2709         10  CLMNOA PIC  X(0001).
  2710     05  CLMNOI PIC  X(0007).
  2711*    -------------------------------
  2712     05  CARRL PIC S9(0004) COMP.
  2713     05  CARRF PIC  X(0001).
  2714     05  FILLER REDEFINES CARRF.
  2715         10  CARRA PIC  X(0001).
  2716     05  CARRI PIC  X(0001).
  2717*    -------------------------------
  2718     05  CERTNOL PIC S9(0004) COMP.
  2719     05  CERTNOF PIC  X(0001).
  2720     05  FILLER REDEFINES CERTNOF.
  2721         10  CERTNOA PIC  X(0001).
  2722     05  CERTNOI PIC  X(0010).
  2723*    -------------------------------
  2724     05  SUFXL PIC S9(0004) COMP.
  2725     05  SUFXF PIC  X(0001).
  2726     05  FILLER REDEFINES SUFXF.
  2727         10  SUFXA PIC  X(0001).
  2728     05  SUFXI PIC  X(0001).
  2729*    -------------------------------
  2730     05  CLMTYPL PIC S9(0004) COMP.
  2731     05  CLMTYPF PIC  X(0001).
  2732     05  FILLER REDEFINES CLMTYPF.
  2733         10  CLMTYPA PIC  X(0001).
  2734     05  CLMTYPI PIC  X(0006).
  2735*    -------------------------------
  2736     05  CLMSTATL PIC S9(0004) COMP.
  2737     05  CLMSTATF PIC  X(0001).
  2738     05  FILLER REDEFINES CLMSTATF.
  2739         10  CLMSTATA PIC  X(0001).
  2740     05  CLMSTATI PIC  X(0006).
  2741*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  56
* EL156.cbl
  2742     05  LSTNMEL PIC S9(0004) COMP.
  2743     05  LSTNMEF PIC  X(0001).
  2744     05  FILLER REDEFINES LSTNMEF.
  2745         10  LSTNMEA PIC  X(0001).
  2746     05  LSTNMEI PIC  X(0015).
  2747*    -------------------------------
  2748     05  FSTNMEL PIC S9(0004) COMP.
  2749     05  FSTNMEF PIC  X(0001).
  2750     05  FILLER REDEFINES FSTNMEF.
  2751         10  FSTNMEA PIC  X(0001).
  2752     05  FSTNMEI PIC  X(0012).
  2753*    -------------------------------
  2754     05  MINITL PIC S9(0004) COMP.
  2755     05  MINITF PIC  X(0001).
  2756     05  FILLER REDEFINES MINITF.
  2757         10  MINITA PIC  X(0001).
  2758     05  MINITI PIC  X(0001).
  2759*    -------------------------------
  2760     05  PRIMHDGL PIC S9(0004) COMP.
  2761     05  PRIMHDGF PIC  X(0001).
  2762     05  FILLER REDEFINES PRIMHDGF.
  2763         10  PRIMHDGA PIC  X(0001).
  2764     05  PRIMHDGI PIC  X(0012).
  2765*    -------------------------------
  2766     05  PCERTNOL PIC S9(0004) COMP.
  2767     05  PCERTNOF PIC  X(0001).
  2768     05  FILLER REDEFINES PCERTNOF.
  2769         10  PCERTNOA PIC  X(0001).
  2770     05  PCERTNOI PIC  X(0010).
  2771*    -------------------------------
  2772     05  PSUFXL PIC S9(0004) COMP.
  2773     05  PSUFXF PIC  X(0001).
  2774     05  FILLER REDEFINES PSUFXF.
  2775         10  PSUFXA PIC  X(0001).
  2776     05  PSUFXI PIC  X(0001).
  2777*    -------------------------------
  2778     05  STATUSL PIC S9(0004) COMP.
  2779     05  STATUSF PIC  X(0001).
  2780     05  FILLER REDEFINES STATUSF.
  2781         10  STATUSA PIC  X(0001).
  2782     05  STATUSI PIC  X(0010).
  2783*    -------------------------------
  2784     05  LOANHL PIC S9(0004) COMP.
  2785     05  LOANHF PIC  X(0001).
  2786     05  FILLER REDEFINES LOANHF.
  2787         10  LOANHA PIC  X(0001).
  2788     05  LOANHI PIC  X(0014).
  2789*    -------------------------------
  2790     05  LOANNOL PIC S9(0004) COMP.
  2791     05  LOANNOF PIC  X(0001).
  2792     05  FILLER REDEFINES LOANNOF.
  2793         10  LOANNOA PIC  X(0001).
  2794     05  LOANNOI PIC  X(0025).
  2795*    -------------------------------
  2796     05  DUEDAYHL PIC S9(0004) COMP.
  2797     05  DUEDAYHF PIC  X(0001).
  2798     05  FILLER REDEFINES DUEDAYHF.
  2799         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  57
* EL156.cbl
  2800     05  DUEDAYHI PIC  X(0008).
  2801*    -------------------------------
  2802     05  DUEDAYL PIC S9(0004) COMP.
  2803     05  DUEDAYF PIC  X(0001).
  2804     05  FILLER REDEFINES DUEDAYF.
  2805         10  DUEDAYA PIC  X(0001).
  2806     05  DUEDAYI PIC  X(0002).
  2807*    -------------------------------
  2808     05  ZINTHL PIC S9(0004) COMP.
  2809     05  ZINTHF PIC  X(0001).
  2810     05  FILLER REDEFINES ZINTHF.
  2811         10  ZINTHA PIC  X(0001).
  2812     05  ZINTHI PIC  X(0009).
  2813*    -------------------------------
  2814     05  ZINTL PIC S9(0004) COMP.
  2815     05  ZINTF PIC  X(0001).
  2816     05  FILLER REDEFINES ZINTF.
  2817         10  ZINTA PIC  X(0001).
  2818     05  ZINTI PIC  99V99999.
  2819*    -------------------------------
  2820     05  PTHRHDGL PIC S9(0004) COMP.
  2821     05  PTHRHDGF PIC  X(0001).
  2822     05  FILLER REDEFINES PTHRHDGF.
  2823         10  PTHRHDGA PIC  X(0001).
  2824     05  PTHRHDGI PIC  X(0014).
  2825*    -------------------------------
  2826     05  PDTHRUL PIC S9(0004) COMP.
  2827     05  PDTHRUF PIC  X(0001).
  2828     05  FILLER REDEFINES PDTHRUF.
  2829         10  PDTHRUA PIC  X(0001).
  2830     05  PDTHRUI PIC  X(0008).
  2831*    -------------------------------
  2832     05  TOTPAIDL PIC S9(0004) COMP.
  2833     05  TOTPAIDF PIC  X(0001).
  2834     05  FILLER REDEFINES TOTPAIDF.
  2835         10  TOTPAIDA PIC  X(0001).
  2836     05  TOTPAIDI PIC  X(0010).
  2837*    -------------------------------
  2838     05  COVERL PIC S9(0004) COMP.
  2839     05  COVERF PIC  X(0001).
  2840     05  FILLER REDEFINES COVERF.
  2841         10  COVERA PIC  X(0001).
  2842     05  COVERI PIC  X(0010).
  2843*    -------------------------------
  2844     05  INCURL PIC S9(0004) COMP.
  2845     05  INCURF PIC  X(0001).
  2846     05  FILLER REDEFINES INCURF.
  2847         10  INCURA PIC  X(0001).
  2848     05  INCURI PIC  X(0008).
  2849*    -------------------------------
  2850     05  LSTDTEL PIC S9(0004) COMP.
  2851     05  LSTDTEF PIC  X(0001).
  2852     05  FILLER REDEFINES LSTDTEF.
  2853         10  LSTDTEA PIC  X(0001).
  2854     05  LSTDTEI PIC  X(0008).
  2855*    -------------------------------
  2856     05  CRTSTATL PIC S9(0004) COMP.
  2857     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  58
* EL156.cbl
  2858     05  FILLER REDEFINES CRTSTATF.
  2859         10  CRTSTATA PIC  X(0001).
  2860     05  CRTSTATI PIC  X(0010).
  2861*    -------------------------------
  2862     05  EFFECTL PIC S9(0004) COMP.
  2863     05  EFFECTF PIC  X(0001).
  2864     05  FILLER REDEFINES EFFECTF.
  2865         10  EFFECTA PIC  X(0001).
  2866     05  EFFECTI PIC  X(0008).
  2867*    -------------------------------
  2868     05  TERMSL PIC S9(0004) COMP.
  2869     05  TERMSF PIC  X(0001).
  2870     05  FILLER REDEFINES TERMSF.
  2871         10  TERMSA PIC  X(0001).
  2872     05  TERMSI PIC  X(0011).
  2873*    -------------------------------
  2874     05  STACCTL PIC S9(0004) COMP.
  2875     05  STACCTF PIC  X(0001).
  2876     05  FILLER REDEFINES STACCTF.
  2877         10  STACCTA PIC  X(0001).
  2878     05  STACCTI PIC  X(0013).
  2879*    -------------------------------
  2880     05  EXPDTEHL PIC S9(0004) COMP.
  2881     05  EXPDTEHF PIC  X(0001).
  2882     05  FILLER REDEFINES EXPDTEHF.
  2883         10  EXPDTEHA PIC  X(0001).
  2884     05  EXPDTEHI PIC  X(0014).
  2885*    -------------------------------
  2886     05  EXPDTEL PIC S9(0004) COMP.
  2887     05  EXPDTEF PIC  X(0001).
  2888     05  FILLER REDEFINES EXPDTEF.
  2889         10  EXPDTEA PIC  X(0001).
  2890     05  EXPDTEI PIC  X(0008).
  2891*    -------------------------------
  2892     05  BENECAPL PIC S9(0004) COMP.
  2893     05  BENECAPF PIC  X(0001).
  2894     05  FILLER REDEFINES BENECAPF.
  2895         10  BENECAPA PIC  X(0001).
  2896     05  BENECAPI PIC  X(0013).
  2897*    -------------------------------
  2898     05  BENEL PIC S9(0004) COMP.
  2899     05  BENEF PIC  X(0001).
  2900     05  FILLER REDEFINES BENEF.
  2901         10  BENEA PIC  X(0001).
  2902     05  BENEI PIC  X(0009).
  2903*    -------------------------------
  2904     05  FORMTYPL PIC S9(0004) COMP.
  2905     05  FORMTYPF PIC  X(0001).
  2906     05  FILLER REDEFINES FORMTYPF.
  2907         10  FORMTYPA PIC  X(0001).
  2908     05  FORMTYPI PIC  X(0001).
  2909*    -------------------------------
  2910     05  PMTTYPEL PIC S9(0004) COMP.
  2911     05  PMTTYPEF PIC  X(0001).
  2912     05  FILLER REDEFINES PMTTYPEF.
  2913         10  PMTTYPEA PIC  X(0001).
  2914     05  PMTTYPEI PIC  X(0001).
  2915*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  59
* EL156.cbl
  2916     05  PAYEEL PIC S9(0004) COMP.
  2917     05  PAYEEF PIC  X(0001).
  2918     05  FILLER REDEFINES PAYEEF.
  2919         10  PAYEEA PIC  X(0001).
  2920     05  PAYEEI PIC  X(0002).
  2921*    -------------------------------
  2922     05  CHECKNOL PIC S9(0004) COMP.
  2923     05  CHECKNOF PIC  X(0001).
  2924     05  FILLER REDEFINES CHECKNOF.
  2925         10  CHECKNOA PIC  X(0001).
  2926     05  CHECKNOI PIC  X(0007).
  2927*    -------------------------------
  2928     05  OFFLINEL PIC S9(0004) COMP.
  2929     05  OFFLINEF PIC  X(0001).
  2930     05  FILLER REDEFINES OFFLINEF.
  2931         10  OFFLINEA PIC  X(0001).
  2932     05  OFFLINEI PIC  X(0001).
  2933*    -------------------------------
  2934     05  HOLDTILL PIC S9(0004) COMP.
  2935     05  HOLDTILF PIC  X(0001).
  2936     05  FILLER REDEFINES HOLDTILF.
  2937         10  HOLDTILA PIC  X(0001).
  2938     05  HOLDTILI PIC  X(0008).
  2939*    -------------------------------
  2940     05  NOTE1L PIC S9(0004) COMP.
  2941     05  NOTE1F PIC  X(0001).
  2942     05  FILLER REDEFINES NOTE1F.
  2943         10  NOTE1A PIC  X(0001).
  2944     05  NOTE1I PIC  X(0060).
  2945*    -------------------------------
  2946     05  ITRB1L PIC S9(0004) COMP.
  2947     05  ITRB1F PIC  X(0001).
  2948     05  FILLER REDEFINES ITRB1F.
  2949         10  ITRB1A PIC  X(0001).
  2950     05  ITRB1I PIC  X(0008).
  2951*    -------------------------------
  2952     05  NOTE2L PIC S9(0004) COMP.
  2953     05  NOTE2F PIC  X(0001).
  2954     05  FILLER REDEFINES NOTE2F.
  2955         10  NOTE2A PIC  X(0001).
  2956     05  NOTE2I PIC  X(0060).
  2957*    -------------------------------
  2958     05  ITRB2L PIC S9(0004) COMP.
  2959     05  ITRB2F PIC  X(0001).
  2960     05  FILLER REDEFINES ITRB2F.
  2961         10  ITRB2A PIC  X(0001).
  2962     05  ITRB2I PIC  X(0010).
  2963*    -------------------------------
  2964     05  EOBYNL PIC S9(0004) COMP.
  2965     05  EOBYNF PIC  X(0001).
  2966     05  FILLER REDEFINES EOBYNF.
  2967         10  EOBYNA PIC  X(0001).
  2968     05  EOBYNI PIC  X(0001).
  2969*    -------------------------------
  2970     05  CLMFMYNL PIC S9(0004) COMP.
  2971     05  CLMFMYNF PIC  X(0001).
  2972     05  FILLER REDEFINES CLMFMYNF.
  2973         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  60
* EL156.cbl
  2974     05  CLMFMYNI PIC  X(0001).
  2975*    -------------------------------
  2976     05  SURVYYNL PIC S9(0004) COMP.
  2977     05  SURVYYNF PIC  X(0001).
  2978     05  FILLER REDEFINES SURVYYNF.
  2979         10  SURVYYNA PIC  X(0001).
  2980     05  SURVYYNI PIC  X(0001).
  2981*    -------------------------------
  2982     05  SPRELYNL PIC S9(0004) COMP.
  2983     05  SPRELYNF PIC  X(0001).
  2984     05  FILLER REDEFINES SPRELYNF.
  2985         10  SPRELYNA PIC  X(0001).
  2986     05  SPRELYNI PIC  X(0001).
  2987*    -------------------------------
  2988     05  PINTHL PIC S9(0004) COMP.
  2989     05  PINTHF PIC  X(0001).
  2990     05  FILLER REDEFINES PINTHF.
  2991         10  PINTHA PIC  X(0001).
  2992     05  PINTHI PIC  X(0004).
  2993*    -------------------------------
  2994     05  PINTL PIC S9(0004) COMP.
  2995     05  PINTF PIC  X(0001).
  2996     05  FILLER REDEFINES PINTF.
  2997         10  PINTA PIC  X(0001).
  2998     05  PINTI PIC  X(0008).
  2999*    -------------------------------
  3000     05  ITRBYNL PIC S9(0004) COMP.
  3001     05  ITRBYNF PIC  X(0001).
  3002     05  FILLER REDEFINES ITRBYNF.
  3003         10  ITRBYNA PIC  X(0001).
  3004     05  ITRBYNI PIC  X(0001).
  3005*    -------------------------------
  3006     05  PROOFDTL PIC S9(0004) COMP.
  3007     05  PROOFDTF PIC  X(0001).
  3008     05  FILLER REDEFINES PROOFDTF.
  3009         10  PROOFDTA PIC  X(0001).
  3010     05  PROOFDTI PIC  X(0008).
  3011*    -------------------------------
  3012     05  AIGFRMHL PIC S9(0004) COMP.
  3013     05  AIGFRMHF PIC  X(0001).
  3014     05  FILLER REDEFINES AIGFRMHF.
  3015         10  AIGFRMHA PIC  X(0001).
  3016     05  AIGFRMHI PIC  X(0012).
  3017*    -------------------------------
  3018     05  AIGFROML PIC S9(0004) COMP.
  3019     05  AIGFROMF PIC  X(0001).
  3020     05  FILLER REDEFINES AIGFROMF.
  3021         10  AIGFROMA PIC  X(0001).
  3022     05  AIGFROMI PIC  X(0008).
  3023*    -------------------------------
  3024     05  PMTHDGAL PIC S9(0004) COMP.
  3025     05  PMTHDGAF PIC  X(0001).
  3026     05  FILLER REDEFINES PMTHDGAF.
  3027         10  PMTHDGAA PIC  X(0001).
  3028     05  PMTHDGAI PIC  X(0066).
  3029*    -------------------------------
  3030     05  EPYFROML PIC S9(0004) COMP.
  3031     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  61
* EL156.cbl
  3032     05  FILLER REDEFINES EPYFROMF.
  3033         10  EPYFROMA PIC  X(0001).
  3034     05  EPYFROMI PIC  X(0008).
  3035*    -------------------------------
  3036     05  EPYTHRUL PIC S9(0004) COMP.
  3037     05  EPYTHRUF PIC  X(0001).
  3038     05  FILLER REDEFINES EPYTHRUF.
  3039         10  EPYTHRUA PIC  X(0001).
  3040     05  EPYTHRUI PIC  X(0008).
  3041*    -------------------------------
  3042     05  EDAYSL PIC S9(0004) COMP.
  3043     05  EDAYSF PIC  X(0001).
  3044     05  FILLER REDEFINES EDAYSF.
  3045         10  EDAYSA PIC  X(0001).
  3046     05  EDAYSI PIC  S9(6).
  3047*    -------------------------------
  3048     05  EPYAMTL PIC S9(0004) COMP.
  3049     05  EPYAMTF PIC  X(0001).
  3050     05  FILLER REDEFINES EPYAMTF.
  3051         10  EPYAMTA PIC  X(0001).
  3052     05  EPYAMTI PIC  S9(8)V99.
  3053*    -------------------------------
  3054     05  ERESVL PIC S9(0004) COMP.
  3055     05  ERESVF PIC  X(0001).
  3056     05  FILLER REDEFINES ERESVF.
  3057         10  ERESVA PIC  X(0001).
  3058     05  ERESVI PIC  S9(7)V99.
  3059*    -------------------------------
  3060     05  ETYPEL PIC S9(0004) COMP.
  3061     05  ETYPEF PIC  X(0001).
  3062     05  FILLER REDEFINES ETYPEF.
  3063         10  ETYPEA PIC  X(0001).
  3064     05  ETYPEI PIC  X(0001).
  3065*    -------------------------------
  3066     05  EEXPENSL PIC S9(0004) COMP.
  3067     05  EEXPENSF PIC  X(0001).
  3068     05  FILLER REDEFINES EEXPENSF.
  3069         10  EEXPENSA PIC  X(0001).
  3070     05  EEXPENSI PIC  9(6)V99.
  3071*    -------------------------------
  3072     05  CPYFROML PIC S9(0004) COMP.
  3073     05  CPYFROMF PIC  X(0001).
  3074     05  FILLER REDEFINES CPYFROMF.
  3075         10  CPYFROMA PIC  X(0001).
  3076     05  CPYFROMI PIC  X(0008).
  3077*    -------------------------------
  3078     05  CPYTHRUL PIC S9(0004) COMP.
  3079     05  CPYTHRUF PIC  X(0001).
  3080     05  FILLER REDEFINES CPYTHRUF.
  3081         10  CPYTHRUA PIC  X(0001).
  3082     05  CPYTHRUI PIC  X(0008).
  3083*    -------------------------------
  3084     05  CDAYSL PIC S9(0004) COMP.
  3085     05  CDAYSF PIC  X(0001).
  3086     05  FILLER REDEFINES CDAYSF.
  3087         10  CDAYSA PIC  X(0001).
  3088     05  CDAYSI PIC  9(6).
  3089*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  62
* EL156.cbl
  3090     05  CPYAMTL PIC S9(0004) COMP.
  3091     05  CPYAMTF PIC  X(0001).
  3092     05  FILLER REDEFINES CPYAMTF.
  3093         10  CPYAMTA PIC  X(0001).
  3094     05  CPYAMTI PIC  S9(8)V99.
  3095*    -------------------------------
  3096     05  CRESVL PIC S9(0004) COMP.
  3097     05  CRESVF PIC  X(0001).
  3098     05  FILLER REDEFINES CRESVF.
  3099         10  CRESVA PIC  X(0001).
  3100     05  CRESVI PIC  9(6)V99.
  3101*    -------------------------------
  3102     05  CEXPENSL PIC S9(0004) COMP.
  3103     05  CEXPENSF PIC  X(0001).
  3104     05  FILLER REDEFINES CEXPENSF.
  3105         10  CEXPENSA PIC  X(0001).
  3106     05  CEXPENSI PIC  9(6)V99.
  3107*    -------------------------------
  3108     05  ERRMSG0L PIC S9(0004) COMP.
  3109     05  ERRMSG0F PIC  X(0001).
  3110     05  FILLER REDEFINES ERRMSG0F.
  3111         10  ERRMSG0A PIC  X(0001).
  3112     05  ERRMSG0I PIC  X(0072).
  3113*    -------------------------------
  3114     05  ERRMSG1L PIC S9(0004) COMP.
  3115     05  ERRMSG1F PIC  X(0001).
  3116     05  FILLER REDEFINES ERRMSG1F.
  3117         10  ERRMSG1A PIC  X(0001).
  3118     05  ERRMSG1I PIC  X(0072).
  3119*    -------------------------------
  3120     05  ERRMSG2L PIC S9(0004) COMP.
  3121     05  ERRMSG2F PIC  X(0001).
  3122     05  FILLER REDEFINES ERRMSG2F.
  3123         10  ERRMSG2A PIC  X(0001).
  3124     05  ERRMSG2I PIC  X(0072).
  3125*    -------------------------------
  3126     05  ENTERPFL PIC S9(0004) COMP.
  3127     05  ENTERPFF PIC  X(0001).
  3128     05  FILLER REDEFINES ENTERPFF.
  3129         10  ENTERPFA PIC  X(0001).
  3130     05  ENTERPFI PIC  99.
  3131*    -------------------------------
  3132     05  PF6TITL PIC S9(0004) COMP.
  3133     05  PF6TITF PIC  X(0001).
  3134     05  FILLER REDEFINES PF6TITF.
  3135         10  PF6TITA PIC  X(0001).
  3136     05  PF6TITI PIC  X(0016).
  3137 01  EL156AO REDEFINES EL156AI.
  3138     05  FILLER            PIC  X(0012).
  3139*    -------------------------------
  3140     05  FILLER            PIC  X(0003).
  3141     05  RUNDTEAO PIC  X(0008).
  3142*    -------------------------------
  3143     05  FILLER            PIC  X(0003).
  3144     05  RUNTIMAO PIC  99.99.
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  63
* EL156.cbl
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  CLMNOO PIC  X(0007).
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  CARRO PIC  X(0001).
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  CERTNOO PIC  X(0010).
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  SUFXO PIC  X(0001).
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  CLMTYPO PIC  X(0006).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  CLMSTATO PIC  X(0006).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  LSTNMEO PIC  X(0015).
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  FSTNMEO PIC  X(0012).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  MINITO PIC  X(0001).
  3175*    -------------------------------
  3176     05  FILLER            PIC  X(0003).
  3177     05  PRIMHDGO PIC  X(0012).
  3178*    -------------------------------
  3179     05  FILLER            PIC  X(0003).
  3180     05  PCERTNOO PIC  X(0010).
  3181*    -------------------------------
  3182     05  FILLER            PIC  X(0003).
  3183     05  PSUFXO PIC  X(0001).
  3184*    -------------------------------
  3185     05  FILLER            PIC  X(0003).
  3186     05  STATUSO PIC  X(0010).
  3187*    -------------------------------
  3188     05  FILLER            PIC  X(0003).
  3189     05  LOANHO PIC  X(0014).
  3190*    -------------------------------
  3191     05  FILLER            PIC  X(0003).
  3192     05  LOANNOO PIC  X(0025).
  3193*    -------------------------------
  3194     05  FILLER            PIC  X(0003).
  3195     05  DUEDAYHO PIC  X(0008).
  3196*    -------------------------------
  3197     05  FILLER            PIC  X(0003).
  3198     05  DUEDAYO PIC  X(0002).
  3199*    -------------------------------
  3200     05  FILLER            PIC  X(0003).
  3201     05  ZINTHO PIC  X(0009).
  3202*    -------------------------------
  3203     05  FILLER            PIC  X(0003).
  3204     05  ZINTO PIC  9.99999.
  3205*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  64
* EL156.cbl
  3206     05  FILLER            PIC  X(0003).
  3207     05  PTHRHDGO PIC  X(0014).
  3208*    -------------------------------
  3209     05  FILLER            PIC  X(0003).
  3210     05  PDTHRUO PIC  X(0008).
  3211*    -------------------------------
  3212     05  FILLER            PIC  X(0003).
  3213     05  TOTPAIDO PIC  Z(6).99-.
  3214*    -------------------------------
  3215     05  FILLER            PIC  X(0003).
  3216     05  COVERO PIC  X(0010).
  3217*    -------------------------------
  3218     05  FILLER            PIC  X(0003).
  3219     05  INCURO PIC  X(0008).
  3220*    -------------------------------
  3221     05  FILLER            PIC  X(0003).
  3222     05  LSTDTEO PIC  X(0008).
  3223*    -------------------------------
  3224     05  FILLER            PIC  X(0003).
  3225     05  CRTSTATO PIC  X(0010).
  3226*    -------------------------------
  3227     05  FILLER            PIC  X(0003).
  3228     05  EFFECTO PIC  X(0008).
  3229*    -------------------------------
  3230     05  FILLER            PIC  X(0003).
  3231     05  TERMSO PIC  X(0011).
  3232*    -------------------------------
  3233     05  FILLER            PIC  X(0003).
  3234     05  STACCTO PIC  X(0013).
  3235*    -------------------------------
  3236     05  FILLER            PIC  X(0003).
  3237     05  EXPDTEHO PIC  X(0014).
  3238*    -------------------------------
  3239     05  FILLER            PIC  X(0003).
  3240     05  EXPDTEO PIC  X(0008).
  3241*    -------------------------------
  3242     05  FILLER            PIC  X(0003).
  3243     05  BENECAPO PIC  X(0013).
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  BENEO PIC  Z(6).99.
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  FORMTYPO PIC  X(0001).
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  PMTTYPEO PIC  X(0001).
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  PAYEEO PIC  X(0002).
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  CHECKNOO PIC  X(0007).
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  OFFLINEO PIC  X(0001).
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  65
* EL156.cbl
  3264     05  HOLDTILO PIC  99B99B99.
  3265*    -------------------------------
  3266     05  FILLER            PIC  X(0003).
  3267     05  NOTE1O PIC  X(0060).
  3268*    -------------------------------
  3269     05  FILLER            PIC  X(0003).
  3270     05  ITRB1O PIC  X(0008).
  3271*    -------------------------------
  3272     05  FILLER            PIC  X(0003).
  3273     05  NOTE2O PIC  X(0060).
  3274*    -------------------------------
  3275     05  FILLER            PIC  X(0003).
  3276     05  ITRB2O PIC  X(0010).
  3277*    -------------------------------
  3278     05  FILLER            PIC  X(0003).
  3279     05  EOBYNO PIC  X(0001).
  3280*    -------------------------------
  3281     05  FILLER            PIC  X(0003).
  3282     05  CLMFMYNO PIC  X(0001).
  3283*    -------------------------------
  3284     05  FILLER            PIC  X(0003).
  3285     05  SURVYYNO PIC  X(0001).
  3286*    -------------------------------
  3287     05  FILLER            PIC  X(0003).
  3288     05  SPRELYNO PIC  X(0001).
  3289*    -------------------------------
  3290     05  FILLER            PIC  X(0003).
  3291     05  PINTHO PIC  X(0004).
  3292*    -------------------------------
  3293     05  FILLER            PIC  X(0003).
  3294     05  PINTO PIC  Z,ZZ9.99.
  3295*    -------------------------------
  3296     05  FILLER            PIC  X(0003).
  3297     05  ITRBYNO PIC  X(0001).
  3298*    -------------------------------
  3299     05  FILLER            PIC  X(0003).
  3300     05  PROOFDTO PIC  99B99B99.
  3301*    -------------------------------
  3302     05  FILLER            PIC  X(0003).
  3303     05  AIGFRMHO PIC  X(0012).
  3304*    -------------------------------
  3305     05  FILLER            PIC  X(0003).
  3306     05  AIGFROMO PIC  99B99B99.
  3307*    -------------------------------
  3308     05  FILLER            PIC  X(0003).
  3309     05  PMTHDGAO PIC  X(0066).
  3310*    -------------------------------
  3311     05  FILLER            PIC  X(0003).
  3312     05  EPYFROMO PIC  99B99B99.
  3313*    -------------------------------
  3314     05  FILLER            PIC  X(0003).
  3315     05  EPYTHRUO PIC  99B99B99.
  3316*    -------------------------------
  3317     05  FILLER            PIC  X(0003).
  3318     05  EDAYSO PIC  Z(4)9-.
  3319*    -------------------------------
  3320     05  FILLER            PIC  X(0003).
  3321     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  66
* EL156.cbl
  3322*    -------------------------------
  3323     05  FILLER            PIC  X(0003).
  3324     05  ERESVO PIC  Z(5).99-.
  3325*    -------------------------------
  3326     05  FILLER            PIC  X(0003).
  3327     05  ETYPEO PIC  X(0001).
  3328*    -------------------------------
  3329     05  FILLER            PIC  X(0003).
  3330     05  EEXPENSO PIC  Z(5).99.
  3331*    -------------------------------
  3332     05  FILLER            PIC  X(0003).
  3333     05  CPYFROMO PIC  99B99B99.
  3334*    -------------------------------
  3335     05  FILLER            PIC  X(0003).
  3336     05  CPYTHRUO PIC  99B99B99.
  3337*    -------------------------------
  3338     05  FILLER            PIC  X(0003).
  3339     05  CDAYSO PIC  Z(4)9-.
  3340*    -------------------------------
  3341     05  FILLER            PIC  X(0003).
  3342     05  CPYAMTO PIC  Z(6).99-.
  3343*    -------------------------------
  3344     05  FILLER            PIC  X(0003).
  3345     05  CRESVO PIC  Z(5).99.
  3346*    -------------------------------
  3347     05  FILLER            PIC  X(0003).
  3348     05  CEXPENSO PIC  Z(5).99.
  3349*    -------------------------------
  3350     05  FILLER            PIC  X(0003).
  3351     05  ERRMSG0O PIC  X(0072).
  3352*    -------------------------------
  3353     05  FILLER            PIC  X(0003).
  3354     05  ERRMSG1O PIC  X(0072).
  3355*    -------------------------------
  3356     05  FILLER            PIC  X(0003).
  3357     05  ERRMSG2O PIC  X(0072).
  3358*    -------------------------------
  3359     05  FILLER            PIC  X(0003).
  3360     05  ENTERPFO PIC  X(0002).
  3361*    -------------------------------
  3362     05  FILLER            PIC  X(0003).
  3363     05  PF6TITO PIC  X(0016).
  3364*    -------------------------------
  3365 01  EL156BI REDEFINES EL156AI.
  3366     05  FILLER            PIC  X(0012).
  3367*    -------------------------------
  3368     05  RUNDTEBL PIC S9(0004) COMP.
  3369     05  RUNDTEBF PIC  X(0001).
  3370     05  FILLER REDEFINES RUNDTEBF.
  3371         10  RUNDTEBA PIC  X(0001).
  3372     05  RUNDTEBI PIC  X(0008).
  3373*    -------------------------------
  3374     05  RUNTIMBL PIC S9(0004) COMP.
  3375     05  RUNTIMBF PIC  X(0001).
  3376     05  FILLER REDEFINES RUNTIMBF.
  3377         10  RUNTIMBA PIC  X(0001).
  3378     05  RUNTIMBI PIC  X(0005).
  3379*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  67
* EL156.cbl
  3380     05  PAYDTBL PIC S9(0004) COMP.
  3381     05  PAYDTBF PIC  X(0001).
  3382     05  FILLER REDEFINES PAYDTBF.
  3383         10  PAYDTBA PIC  X(0001).
  3384     05  PAYDTBI PIC  X(0008).
  3385*    -------------------------------
  3386     05  PAYTYPBL PIC S9(0004) COMP.
  3387     05  PAYTYPBF PIC  X(0001).
  3388     05  FILLER REDEFINES PAYTYPBF.
  3389         10  PAYTYPBA PIC  X(0001).
  3390     05  PAYTYPBI PIC  X(0015).
  3391*    -------------------------------
  3392     05  PAYAMTBL PIC S9(0004) COMP.
  3393     05  PAYAMTBF PIC  X(0001).
  3394     05  FILLER REDEFINES PAYAMTBF.
  3395         10  PAYAMTBA PIC  X(0001).
  3396     05  PAYAMTBI PIC  X(0011).
  3397*    -------------------------------
  3398     05  LOANHBL PIC S9(0004) COMP.
  3399     05  LOANHBF PIC  X(0001).
  3400     05  FILLER REDEFINES LOANHBF.
  3401         10  LOANHBA PIC  X(0001).
  3402     05  LOANHBI PIC  X(0012).
  3403*    -------------------------------
  3404     05  LOANNBL PIC S9(0004) COMP.
  3405     05  LOANNBF PIC  X(0001).
  3406     05  FILLER REDEFINES LOANNBF.
  3407         10  LOANNBA PIC  X(0001).
  3408     05  LOANNBI PIC  X(0025).
  3409*    -------------------------------
  3410     05  CKNUMHDL PIC S9(0004) COMP.
  3411     05  CKNUMHDF PIC  X(0001).
  3412     05  FILLER REDEFINES CKNUMHDF.
  3413         10  CKNUMHDA PIC  X(0001).
  3414     05  CKNUMHDI PIC  X(0012).
  3415*    -------------------------------
  3416     05  CKNUMBL PIC S9(0004) COMP.
  3417     05  CKNUMBF PIC  X(0001).
  3418     05  FILLER REDEFINES CKNUMBF.
  3419         10  CKNUMBA PIC  X(0001).
  3420     05  CKNUMBI PIC  X(0007).
  3421*    -------------------------------
  3422     05  AGTHDGL PIC S9(0004) COMP.
  3423     05  AGTHDGF PIC  X(0001).
  3424     05  FILLER REDEFINES AGTHDGF.
  3425         10  AGTHDGA PIC  X(0001).
  3426     05  AGTHDGI PIC  X(0016).
  3427*    -------------------------------
  3428     05  NAMEBL PIC S9(0004) COMP.
  3429     05  NAMEBF PIC  X(0001).
  3430     05  FILLER REDEFINES NAMEBF.
  3431         10  NAMEBA PIC  X(0001).
  3432     05  NAMEBI PIC  X(0030).
  3433*    -------------------------------
  3434     05  NAMEB2L PIC S9(0004) COMP.
  3435     05  NAMEB2F PIC  X(0001).
  3436     05  FILLER REDEFINES NAMEB2F.
  3437         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  68
* EL156.cbl
  3438     05  NAMEB2I PIC  X(0030).
  3439*    -------------------------------
  3440     05  ADDR1BL PIC S9(0004) COMP.
  3441     05  ADDR1BF PIC  X(0001).
  3442     05  FILLER REDEFINES ADDR1BF.
  3443         10  ADDR1BA PIC  X(0001).
  3444     05  ADDR1BI PIC  X(0030).
  3445*    -------------------------------
  3446     05  ADDR1B2L PIC S9(0004) COMP.
  3447     05  ADDR1B2F PIC  X(0001).
  3448     05  FILLER REDEFINES ADDR1B2F.
  3449         10  ADDR1B2A PIC  X(0001).
  3450     05  ADDR1B2I PIC  X(0030).
  3451*    -------------------------------
  3452     05  ADDR2BL PIC S9(0004) COMP.
  3453     05  ADDR2BF PIC  X(0001).
  3454     05  FILLER REDEFINES ADDR2BF.
  3455         10  ADDR2BA PIC  X(0001).
  3456     05  ADDR2BI PIC  X(0030).
  3457*    -------------------------------
  3458     05  ADDR2B2L PIC S9(0004) COMP.
  3459     05  ADDR2B2F PIC  X(0001).
  3460     05  FILLER REDEFINES ADDR2B2F.
  3461         10  ADDR2B2A PIC  X(0001).
  3462     05  ADDR2B2I PIC  X(0030).
  3463*    -------------------------------
  3464     05  CITYSTBL PIC S9(0004) COMP.
  3465     05  CITYSTBF PIC  X(0001).
  3466     05  FILLER REDEFINES CITYSTBF.
  3467         10  CITYSTBA PIC  X(0001).
  3468     05  CITYSTBI PIC  X(0030).
  3469*    -------------------------------
  3470     05  CITYST2L PIC S9(0004) COMP.
  3471     05  CITYST2F PIC  X(0001).
  3472     05  FILLER REDEFINES CITYST2F.
  3473         10  CITYST2A PIC  X(0001).
  3474     05  CITYST2I PIC  X(0030).
  3475*    -------------------------------
  3476     05  ZIPBL PIC S9(0004) COMP.
  3477     05  ZIPBF PIC  X(0001).
  3478     05  FILLER REDEFINES ZIPBF.
  3479         10  ZIPBA PIC  X(0001).
  3480     05  ZIPBI PIC  X(0009).
  3481*    -------------------------------
  3482     05  ZIPB2L PIC S9(0004) COMP.
  3483     05  ZIPB2F PIC  X(0001).
  3484     05  FILLER REDEFINES ZIPB2F.
  3485         10  ZIPB2A PIC  X(0001).
  3486     05  ZIPB2I PIC  X(0009).
  3487*    -------------------------------
  3488     05  INTHDBL PIC S9(0004) COMP.
  3489     05  INTHDBF PIC  X(0001).
  3490     05  FILLER REDEFINES INTHDBF.
  3491         10  INTHDBA PIC  X(0001).
  3492     05  INTHDBI PIC  X(0012).
  3493*    -------------------------------
  3494     05  INTAMTBL PIC S9(0004) COMP.
  3495     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  69
* EL156.cbl
  3496     05  FILLER REDEFINES INTAMTBF.
  3497         10  INTAMTBA PIC  X(0001).
  3498     05  INTAMTBI PIC  X(0011).
  3499*    -------------------------------
  3500     05  PMTHDGBL PIC S9(0004) COMP.
  3501     05  PMTHDGBF PIC  X(0001).
  3502     05  FILLER REDEFINES PMTHDGBF.
  3503         10  PMTHDGBA PIC  X(0001).
  3504     05  PMTHDGBI PIC  X(0034).
  3505*    -------------------------------
  3506     05  CLMNOBL PIC S9(0004) COMP.
  3507     05  CLMNOBF PIC  X(0001).
  3508     05  FILLER REDEFINES CLMNOBF.
  3509         10  CLMNOBA PIC  X(0001).
  3510     05  CLMNOBI PIC  X(0007).
  3511*    -------------------------------
  3512     05  CARRBL PIC S9(0004) COMP.
  3513     05  CARRBF PIC  X(0001).
  3514     05  FILLER REDEFINES CARRBF.
  3515         10  CARRBA PIC  X(0001).
  3516     05  CARRBI PIC  X(0001).
  3517*    -------------------------------
  3518     05  CERTNOBL PIC S9(0004) COMP.
  3519     05  CERTNOBF PIC  X(0001).
  3520     05  FILLER REDEFINES CERTNOBF.
  3521         10  CERTNOBA PIC  X(0001).
  3522     05  CERTNOBI PIC  X(0010).
  3523*    -------------------------------
  3524     05  SUFXBL PIC S9(0004) COMP.
  3525     05  SUFXBF PIC  X(0001).
  3526     05  FILLER REDEFINES SUFXBF.
  3527         10  SUFXBA PIC  X(0001).
  3528     05  SUFXBI PIC  X(0001).
  3529*    -------------------------------
  3530     05  CLMTYPBL PIC S9(0004) COMP.
  3531     05  CLMTYPBF PIC  X(0001).
  3532     05  FILLER REDEFINES CLMTYPBF.
  3533         10  CLMTYPBA PIC  X(0001).
  3534     05  CLMTYPBI PIC  X(0006).
  3535*    -------------------------------
  3536     05  INCURBL PIC S9(0004) COMP.
  3537     05  INCURBF PIC  X(0001).
  3538     05  FILLER REDEFINES INCURBF.
  3539         10  INCURBA PIC  X(0001).
  3540     05  INCURBI PIC  X(0008).
  3541*    -------------------------------
  3542     05  PYFROMBL PIC S9(0004) COMP.
  3543     05  PYFROMBF PIC  X(0001).
  3544     05  FILLER REDEFINES PYFROMBF.
  3545         10  PYFROMBA PIC  X(0001).
  3546     05  PYFROMBI PIC  X(0008).
  3547*    -------------------------------
  3548     05  PYTHRUBL PIC S9(0004) COMP.
  3549     05  PYTHRUBF PIC  X(0001).
  3550     05  FILLER REDEFINES PYTHRUBF.
  3551         10  PYTHRUBA PIC  X(0001).
  3552     05  PYTHRUBI PIC  X(0008).
  3553*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  70
* EL156.cbl
  3554     05  DAYSBL PIC S9(0004) COMP.
  3555     05  DAYSBF PIC  X(0001).
  3556     05  FILLER REDEFINES DAYSBF.
  3557         10  DAYSBA PIC  X(0001).
  3558     05  DAYSBI PIC  X(0005).
  3559*    -------------------------------
  3560     05  BYBL PIC S9(0004) COMP.
  3561     05  BYBF PIC  X(0001).
  3562     05  FILLER REDEFINES BYBF.
  3563         10  BYBA PIC  X(0001).
  3564     05  BYBI PIC  X(0004).
  3565*    -------------------------------
  3566     05  PROOFDBL PIC S9(0004) COMP.
  3567     05  PROOFDBF PIC  X(0001).
  3568     05  FILLER REDEFINES PROOFDBF.
  3569         10  PROOFDBA PIC  X(0001).
  3570     05  PROOFDBI PIC  X(0008).
  3571*    -------------------------------
  3572     05  ACCTBL PIC S9(0004) COMP.
  3573     05  ACCTBF PIC  X(0001).
  3574     05  FILLER REDEFINES ACCTBF.
  3575         10  ACCTBA PIC  X(0001).
  3576     05  ACCTBI PIC  X(0010).
  3577*    -------------------------------
  3578     05  STATEBL PIC S9(0004) COMP.
  3579     05  STATEBF PIC  X(0001).
  3580     05  FILLER REDEFINES STATEBF.
  3581         10  STATEBA PIC  X(0001).
  3582     05  STATEBI PIC  X(0002).
  3583*    -------------------------------
  3584     05  GROUPBL PIC S9(0004) COMP.
  3585     05  GROUPBF PIC  X(0001).
  3586     05  FILLER REDEFINES GROUPBF.
  3587         10  GROUPBA PIC  X(0001).
  3588     05  GROUPBI PIC  X(0006).
  3589*    -------------------------------
  3590     05  ACARRBL PIC S9(0004) COMP.
  3591     05  ACARRBF PIC  X(0001).
  3592     05  FILLER REDEFINES ACARRBF.
  3593         10  ACARRBA PIC  X(0001).
  3594     05  ACARRBI PIC  X(0001).
  3595*    -------------------------------
  3596     05  ACCTNMBL PIC S9(0004) COMP.
  3597     05  ACCTNMBF PIC  X(0001).
  3598     05  FILLER REDEFINES ACCTNMBF.
  3599         10  ACCTNMBA PIC  X(0001).
  3600     05  ACCTNMBI PIC  X(0030).
  3601*    -------------------------------
  3602     05  UNDISBL PIC S9(0004) COMP.
  3603     05  UNDISBF PIC  X(0001).
  3604     05  FILLER REDEFINES UNDISBF.
  3605         10  UNDISBA PIC  X(0001).
  3606     05  UNDISBI PIC  X(0010).
  3607*    -------------------------------
  3608     05  RATEBL PIC S9(0004) COMP.
  3609     05  RATEBF PIC  X(0001).
  3610     05  FILLER REDEFINES RATEBF.
  3611         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  71
* EL156.cbl
  3612     05  RATEBI PIC  X(0006).
  3613*    -------------------------------
  3614     05  ERMSG1BL PIC S9(0004) COMP.
  3615     05  ERMSG1BF PIC  X(0001).
  3616     05  FILLER REDEFINES ERMSG1BF.
  3617         10  ERMSG1BA PIC  X(0001).
  3618     05  ERMSG1BI PIC  X(0072).
  3619*    -------------------------------
  3620     05  ENTPFBL PIC S9(0004) COMP.
  3621     05  ENTPFBF PIC  X(0001).
  3622     05  FILLER REDEFINES ENTPFBF.
  3623         10  ENTPFBA PIC  X(0001).
  3624     05  ENTPFBI PIC  99.
  3625 01  EL156BO REDEFINES EL156AI.
  3626     05  FILLER            PIC  X(0012).
  3627*    -------------------------------
  3628     05  FILLER            PIC  X(0003).
  3629     05  RUNDTEBO PIC  X(0008).
  3630*    -------------------------------
  3631     05  FILLER            PIC  X(0003).
  3632     05  RUNTIMBO PIC  99.99.
  3633*    -------------------------------
  3634     05  FILLER            PIC  X(0003).
  3635     05  PAYDTBO PIC  99B99B99.
  3636*    -------------------------------
  3637     05  FILLER            PIC  X(0003).
  3638     05  PAYTYPBO PIC  X(0015).
  3639*    -------------------------------
  3640     05  FILLER            PIC  X(0003).
  3641     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3642*    -------------------------------
  3643     05  FILLER            PIC  X(0003).
  3644     05  LOANHBO PIC  X(0012).
  3645*    -------------------------------
  3646     05  FILLER            PIC  X(0003).
  3647     05  LOANNBO PIC  X(0025).
  3648*    -------------------------------
  3649     05  FILLER            PIC  X(0003).
  3650     05  CKNUMHDO PIC  X(0012).
  3651*    -------------------------------
  3652     05  FILLER            PIC  X(0003).
  3653     05  CKNUMBO PIC  X(0007).
  3654*    -------------------------------
  3655     05  FILLER            PIC  X(0003).
  3656     05  AGTHDGO PIC  X(0016).
  3657*    -------------------------------
  3658     05  FILLER            PIC  X(0003).
  3659     05  NAMEBO PIC  X(0030).
  3660*    -------------------------------
  3661     05  FILLER            PIC  X(0003).
  3662     05  NAMEB2O PIC  X(0030).
  3663*    -------------------------------
  3664     05  FILLER            PIC  X(0003).
  3665     05  ADDR1BO PIC  X(0030).
  3666*    -------------------------------
  3667     05  FILLER            PIC  X(0003).
  3668     05  ADDR1B2O PIC  X(0030).
  3669*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  72
* EL156.cbl
  3670     05  FILLER            PIC  X(0003).
  3671     05  ADDR2BO PIC  X(0030).
  3672*    -------------------------------
  3673     05  FILLER            PIC  X(0003).
  3674     05  ADDR2B2O PIC  X(0030).
  3675*    -------------------------------
  3676     05  FILLER            PIC  X(0003).
  3677     05  CITYSTBO PIC  X(0030).
  3678*    -------------------------------
  3679     05  FILLER            PIC  X(0003).
  3680     05  CITYST2O PIC  X(0030).
  3681*    -------------------------------
  3682     05  FILLER            PIC  X(0003).
  3683     05  ZIPBO PIC  ZZZZ99999.
  3684*    -------------------------------
  3685     05  FILLER            PIC  X(0003).
  3686     05  ZIPB2O PIC  ZZZZZZZZZ.
  3687*    -------------------------------
  3688     05  FILLER            PIC  X(0003).
  3689     05  INTHDBO PIC  X(0012).
  3690*    -------------------------------
  3691     05  FILLER            PIC  X(0003).
  3692     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3693*    -------------------------------
  3694     05  FILLER            PIC  X(0003).
  3695     05  PMTHDGBO PIC  X(0034).
  3696*    -------------------------------
  3697     05  FILLER            PIC  X(0003).
  3698     05  CLMNOBO PIC  X(0007).
  3699*    -------------------------------
  3700     05  FILLER            PIC  X(0003).
  3701     05  CARRBO PIC  X(0001).
  3702*    -------------------------------
  3703     05  FILLER            PIC  X(0003).
  3704     05  CERTNOBO PIC  X(0010).
  3705*    -------------------------------
  3706     05  FILLER            PIC  X(0003).
  3707     05  SUFXBO PIC  X(0001).
  3708*    -------------------------------
  3709     05  FILLER            PIC  X(0003).
  3710     05  CLMTYPBO PIC  X(0006).
  3711*    -------------------------------
  3712     05  FILLER            PIC  X(0003).
  3713     05  INCURBO PIC  X(0008).
  3714*    -------------------------------
  3715     05  FILLER            PIC  X(0003).
  3716     05  PYFROMBO PIC  99B99B99.
  3717*    -------------------------------
  3718     05  FILLER            PIC  X(0003).
  3719     05  PYTHRUBO PIC  99B99B99.
  3720*    -------------------------------
  3721     05  FILLER            PIC  X(0003).
  3722     05  DAYSBO PIC  X(0005).
  3723*    -------------------------------
  3724     05  FILLER            PIC  X(0003).
  3725     05  BYBO PIC  X(0004).
  3726*    -------------------------------
  3727     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  73
* EL156.cbl
  3728     05  PROOFDBO PIC  99B99B99.
  3729*    -------------------------------
  3730     05  FILLER            PIC  X(0003).
  3731     05  ACCTBO PIC  X(0010).
  3732*    -------------------------------
  3733     05  FILLER            PIC  X(0003).
  3734     05  STATEBO PIC  X(0002).
  3735*    -------------------------------
  3736     05  FILLER            PIC  X(0003).
  3737     05  GROUPBO PIC  X(0006).
  3738*    -------------------------------
  3739     05  FILLER            PIC  X(0003).
  3740     05  ACARRBO PIC  X(0001).
  3741*    -------------------------------
  3742     05  FILLER            PIC  X(0003).
  3743     05  ACCTNMBO PIC  X(0030).
  3744*    -------------------------------
  3745     05  FILLER            PIC  X(0003).
  3746     05  UNDISBO PIC  ZZZ,Z99.99.
  3747*    -------------------------------
  3748     05  FILLER            PIC  X(0003).
  3749     05  RATEBO PIC  ZZZ.99.
  3750*    -------------------------------
  3751     05  FILLER            PIC  X(0003).
  3752     05  ERMSG1BO PIC  X(0072).
  3753*    -------------------------------
  3754     05  FILLER            PIC  X(0003).
  3755     05  ENTPFBO PIC  X(0002).
  3756*    -------------------------------
  3757****************************************************************
  3758*
  3759* Copyright (c) 2007-2013 Dell Inc.
  3760* All rights reserved.
  3761*
  3762****************************************************************
  3763 01  DFHEIV.
  3764   02  DFHEIV0               PIC X(35).
  3765   02  DFHEIV1               PIC X(08).
  3766   02  DFHEIV2               PIC X(08).
  3767   02  DFHEIV3               PIC X(08).
  3768   02  DFHEIV4               PIC X(06).
  3769   02  DFHEIV5               PIC X(04).
  3770   02  DFHEIV6               PIC X(04).
  3771   02  DFHEIV7               PIC X(02).
  3772   02  DFHEIV8               PIC X(02).
  3773   02  DFHEIV9               PIC X(01).
  3774   02  DFHEIV10              PIC S9(7) COMP-3.
  3775   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3776   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3777   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3778   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3779   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3780   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3781   02  DFHEIV17              PIC X(04).
  3782   02  DFHEIV18              PIC X(04).
  3783   02  DFHEIV19              PIC X(04).
  3784   02  DFHEIV20              USAGE IS POINTER.
  3785   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  74
* EL156.cbl
  3786   02  DFHEIV22              USAGE IS POINTER.
  3787   02  DFHEIV23              USAGE IS POINTER.
  3788   02  DFHEIV24              USAGE IS POINTER.
  3789   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3790   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3791   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3792   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3793   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3794   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3795   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3796   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3797   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3798   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3799   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3800   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3801   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3802   02  FILLER                PIC X(02).
  3803   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3804   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3805   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3806   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3807   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3808   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3809   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3810 LINKAGE  SECTION.
  3811*****************************************************************
  3812*                                                               *
  3813* Copyright (c) 2007-2013 Dell Inc.                             *
  3814* All rights reserved.                                          *
  3815*                                                               *
  3816*****************************************************************
  3817 01  dfheiblk.
  3818     02  eibtime          pic s9(7) comp-3.
  3819     02  eibdate          pic s9(7) comp-3.
  3820     02  eibtrnid         pic x(4).
  3821     02  eibtaskn         pic s9(7) comp-3.
  3822     02  eibtrmid         pic x(4).
  3823     02  dfheigdi         pic s9(4) comp.
  3824     02  eibcposn         pic s9(4) comp.
  3825     02  eibcalen         pic s9(4) comp.
  3826     02  eibaid           pic x(1).
  3827     02  eibfiller1       pic x(1).
  3828     02  eibfn            pic x(2).
  3829     02  eibfiller2       pic x(2).
  3830     02  eibrcode         pic x(6).
  3831     02  eibfiller3       pic x(2).
  3832     02  eibds            pic x(8).
  3833     02  eibreqid         pic x(8).
  3834     02  eibrsrce         pic x(8).
  3835     02  eibsync          pic x(1).
  3836     02  eibfree          pic x(1).
  3837     02  eibrecv          pic x(1).
  3838     02  eibsend          pic x(1).
  3839     02  eibatt           pic x(1).
  3840     02  eibeoc           pic x(1).
  3841     02  eibfmh           pic x(1).
  3842     02  eibcompl         pic x(1).
  3843     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  75
* EL156.cbl
  3844     02  eibconf          pic x(1).
  3845     02  eiberr           pic x(1).
  3846     02  eibrldbk         pic x(1).
  3847     02  eiberrcd         pic x(4).
  3848     02  eibsynrb         pic x(1).
  3849     02  eibnodat         pic x(1).
  3850     02  eibfiller5       pic x(2).
  3851     02  eibresp          pic s9(8) comp.
  3852     02  eibresp2         pic s9(8) comp.
  3853     02  dfheigdj         pic s9(4) comp.
  3854     02  dfheigdk         pic s9(4) comp.
  3855 01  DFHCOMMAREA             PIC X(1024).
  3856
  3857*    COPY ELCMSTR.
  3858******************************************************************
  3859*                                                                *
  3860*                            ELCMSTR.                            *
  3861*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3862*                            VMOD=2.012                          *
  3863*                                                                *
  3864*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3865*                                                                *
  3866*   FILE TYPE = VSAM,KSDS                                        *
  3867*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3868*                                                                *
  3869*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3870*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3871*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3872*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3873*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3874*                                                 RKP=75,LEN=21  *
  3875*                                                                *
  3876*   **** NOTE ****                                               *
  3877*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3878*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3879*                                                                *
  3880*   LOG = YES                                                    *
  3881*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3882******************************************************************
  3883*                   C H A N G E   L O G
  3884*
  3885* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3886*-----------------------------------------------------------------
  3887*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3888* EFFECTIVE    NUMBER
  3889*-----------------------------------------------------------------
  3890* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3891* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3892* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3893* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3894* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3895* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3896******************************************************************
  3897 01  CLAIM-MASTER.
  3898     12  CL-RECORD-ID                PIC XX.
  3899         88  VALID-CL-ID         VALUE 'CL'.
  3900
  3901     12  CL-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  76
* EL156.cbl
  3902         16  CL-COMPANY-CD           PIC X.
  3903         16  CL-CARRIER              PIC X.
  3904         16  CL-CLAIM-NO             PIC X(7).
  3905         16  CL-CERT-NO.
  3906             20  CL-CERT-PRIME       PIC X(10).
  3907             20  CL-CERT-SFX         PIC X.
  3908
  3909     12  CL-CONTROL-BY-NAME.
  3910         16  CL-COMPANY-CD-A1        PIC X.
  3911         16  CL-INSURED-LAST-NAME    PIC X(15).
  3912         16  CL-INSURED-NAME.
  3913             20  CL-INSURED-1ST-NAME PIC X(12).
  3914             20  CL-INSURED-MID-INIT PIC X.
  3915
  3916     12  CL-CONTROL-BY-SSN.
  3917         16  CL-COMPANY-CD-A2        PIC X.
  3918         16  CL-SOC-SEC-NO.
  3919             20  CL-SSN-STATE        PIC XX.
  3920             20  CL-SSN-ACCOUNT      PIC X(6).
  3921             20  CL-SSN-LN3          PIC X(3).
  3922
  3923     12  CL-CONTROL-BY-CERT-NO.
  3924         16  CL-COMPANY-CD-A4        PIC X.
  3925         16  CL-CERT-NO-A4.
  3926             20  CL-CERT-A4-PRIME    PIC X(10).
  3927             20  CL-CERT-A4-SFX      PIC X.
  3928
  3929     12  CL-CONTROL-BY-CCN.
  3930         16  CL-COMPANY-CD-A5        PIC X.
  3931         16  CL-CCN-A5.
  3932             20  CL-CCN.
  3933                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3934                 24  CL-CCN-PRIME-A5 PIC X(12).
  3935             20  CL-CCN-FILLER-A5    PIC X(4).
  3936
  3937     12  CL-INSURED-PROFILE-DATA.
  3938         16  CL-INSURED-BIRTH-DT     PIC XX.
  3939         16  CL-INSURED-SEX-CD       PIC X.
  3940             88  INSURED-IS-MALE        VALUE 'M'.
  3941             88  INSURED-IS-FEMALE      VALUE 'F'.
  3942             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3943         16  CL-INSURED-OCC-CD       PIC X(6).
  3944         16  FILLER                  PIC X(5).
  3945
  3946     12  CL-PROCESSING-INFO.
  3947         16  CL-PROCESSOR-ID         PIC X(4).
  3948         16  CL-CLAIM-STATUS         PIC X.
  3949             88  CLAIM-IS-OPEN          VALUE 'O'.
  3950             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3951         16  CL-CLAIM-TYPE           PIC X.
  3952*            88  AH-CLAIM               VALUE 'A'.
  3953*            88  LIFE-CLAIM             VALUE 'L'.
  3954*            88  PROPERTY-CLAIM         VALUE 'P'.
  3955*            88  IUI-CLAIM              VALUE 'I'.
  3956*            88  GAP-CLAIM              VALUE 'G'.
  3957*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3958         16  CL-CLAIM-PREM-TYPE      PIC X.
  3959             88  SINGLE-PREMIUM         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  77
* EL156.cbl
  3960             88  O-B-COVERAGE           VALUE '2'.
  3961             88  OPEN-END-COVERAGE      VALUE '3'.
  3962         16  CL-INCURRED-DT          PIC XX.
  3963         16  CL-REPORTED-DT          PIC XX.
  3964         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3965         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3966         16  CL-LAST-PMT-DT          PIC XX.
  3967         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3968         16  CL-PAID-THRU-DT         PIC XX.
  3969         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3970         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3971         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3972         16  CL-PMT-CALC-METHOD      PIC X.
  3973             88  CL-360-DAY-YR          VALUE '1'.
  3974             88  CL-365-DAY-YR          VALUE '2'.
  3975             88  CL-FULL-MONTHS         VALUE '3'.
  3976         16  CL-CAUSE-CD             PIC X(6).
  3977
  3978         16  CL-PRIME-CERT-NO.
  3979             20  CL-PRIME-CERT-PRIME PIC X(10).
  3980             20  CL-PRIME-CERT-SFX   PIC X.
  3981
  3982         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3983             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3984             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3985
  3986         16  CL-MICROFILM-NO         PIC X(10).
  3987         16  FILLER REDEFINES CL-MICROFILM-NO.
  3988             20  CL-BENEFIT-PERIOD   PIC 99.
  3989             20  FILLER              PIC X(8).
  3990         16  CL-PROG-FORM-TYPE       PIC X.
  3991         16  CL-LAST-ADD-ON-DT       PIC XX.
  3992
  3993         16  CL-LAST-REOPEN-DT       PIC XX.
  3994         16  CL-LAST-CLOSE-DT        PIC XX.
  3995         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3996             88  FINAL-PAID             VALUE '1'.
  3997             88  CLAIM-DENIED           VALUE '2'.
  3998             88  AUTO-CLOSE             VALUE '3'.
  3999             88  MANUAL-CLOSE           VALUE '4'.
  4000             88  BENEFITS-CHANGED       VALUE 'C'.
  4001             88  SETUP-ERRORS           VALUE 'E'.
  4002         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4003         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4004         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4005             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4006         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4007         16  FILLER                  PIC X.
  4008
  4009     12  CL-CERTIFICATE-DATA.
  4010         16  CL-CERT-ORIGIN          PIC X.
  4011             88  CERT-WAS-ONLINE        VALUE '1'.
  4012             88  CERT-WAS-CREATED       VALUE '2'.
  4013             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4014         16  CL-CERT-KEY-DATA.
  4015             20  CL-CERT-CARRIER     PIC X.
  4016             20  CL-CERT-GROUPING    PIC X(6).
  4017             20  CL-CERT-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  78
* EL156.cbl
  4018             20  CL-CERT-ACCOUNT.
  4019                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4020                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4021             20  CL-CERT-EFF-DT      PIC XX.
  4022
  4023     12  CL-STATUS-CONTROLS.
  4024         16  CL-PRIORITY-CD          PIC X.
  4025             88  CONFIDENTIAL-DATA      VALUE '8'.
  4026             88  HIGHEST-PRIORITY       VALUE '9'.
  4027         16  CL-SUPV-ATTN-CD         PIC X.
  4028             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4029             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4030         16  CL-PURGED-DT            PIC XX.
  4031         16  CL-RESTORED-DT          PIC XX.
  4032         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4033         16  CL-NEXT-RESEND-DT       PIC XX.
  4034         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4035         16  CL-CRITICAL-PERIOD      PIC 99.
  4036*        16  FILLER                  PIC XX.
  4037         16  CL-LAST-MAINT-DT        PIC XX.
  4038         16  CL-LAST-MAINT-USER      PIC X(4).
  4039         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4040         16  CL-LAST-MAINT-TYPE      PIC X.
  4041             88  CLAIM-SET-UP           VALUE ' '.
  4042             88  PAYMENT-MADE           VALUE '1'.
  4043             88  LETTER-SENT            VALUE '2'.
  4044             88  MASTER-WAS-ALTERED     VALUE '3'.
  4045             88  MASTER-WAS-RESTORED    VALUE '4'.
  4046             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4047             88  FILE-CONVERTED         VALUE '6'.
  4048             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4049             88  ERROR-CORRECTION       VALUE 'E'.
  4050         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4051         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4052         16  CL-BENEFICIARY          PIC X(10).
  4053         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4054         16  CL-DENIAL-TYPE          PIC X.
  4055             88  CL-TYPE-DENIAL          VALUE '1'.
  4056             88  CL-TYPE-RESCISSION      VALUE '2'.
  4057             88  CL-TYPE-REFORMATION     VALUE '3'.
  4058             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4059             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4060         16  CL-NO-OF-EXTENSIONS     PIC 99.
  4061         16  filler                  pic x(3).
  4062*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4063*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4064*        16  CL-RTW-DT               PIC XX.
  4065
  4066     12  CL-TRAILER-CONTROLS.
  4067         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4068             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4069             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4070             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4071         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4072         16  FILLER                  PIC XX.
  4073         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4074         16  CL-ADDRESS-TRAILER-CNT.
  4075             20  CL-INSURED-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  79
* EL156.cbl
  4076                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4077             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4078                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4079             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4080                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4081             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4082                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4083             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4084                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4085             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4086                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4087             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4088                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4089
  4090     12  CL-CV-REFERENCE-NO.
  4091         16  CL-CV-REFNO-PRIME       PIC X(18).
  4092         16  CL-CV-REFNO-SFX         PIC XX.
  4093
  4094     12  CL-FILE-LOCATION            PIC X(4).
  4095
  4096     12  CL-PROCESS-ERRORS.
  4097         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4098             88  NO-FATAL-ERRORS        VALUE ZERO.
  4099         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4100             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4101
  4102     12  CL-PRODUCT-CD               PIC X.
  4103
  4104     12  CL-CURRENT-KEY-DATA.
  4105         16  CL-CURRENT-CARRIER      PIC X.
  4106         16  CL-CURRENT-GROUPING     PIC X(6).
  4107         16  CL-CURRENT-STATE        PIC XX.
  4108         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4109
  4110     12  CL-ASSOCIATES               PIC X.
  4111         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4112         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4113         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4114         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4115
  4116     12  CL-ACTIVITY-CODE            PIC 99.
  4117     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4118     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4119
  4120     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4121     12  CL-LAG-REPORT-CODE          PIC 9.
  4122     12  CL-LOAN-TYPE                PIC XX.
  4123     12  CL-LEGAL-STATE              PIC XX.
  4124
  4125     12  CL-YESNOSW                  PIC X.
  4126     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4127         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4128         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4129         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4130     12  cl-insured-type             pic x.
  4131         88  cl-claim-on-primary         value 'P'.
  4132         88  cl-claim-on-co-borrower     value 'C'.
  4133     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  80
* EL156.cbl
  4135*    COPY ELCCNTL.
  4136******************************************************************
  4137*                                                                *
  4138*                                                                *
  4139*                            ELCCNTL.                            *
  4140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4141*                            VMOD=2.059                          *
  4142*                                                                *
  4143*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4144*                                                                *
  4145*   FILE TYPE = VSAM,KSDS                                        *
  4146*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4147*                                                                *
  4148*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4149*       ALTERNATE INDEX = NONE                                   *
  4150*                                                                *
  4151*   LOG = YES                                                    *
  4152*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4153******************************************************************
  4154*                   C H A N G E   L O G
  4155*
  4156* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4157*-----------------------------------------------------------------
  4158*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4159* EFFECTIVE    NUMBER
  4160*-----------------------------------------------------------------
  4161* 082503                   PEMA  ADD BENEFIT GROUP
  4162* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4163* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4164* 092705    2005050300006  PEMA  ADD SPP LEASES
  4165* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4166* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4167* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4168* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4169* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4170* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4171* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4172* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4173* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4174* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4175******************************************************************
  4176*
  4177 01  CONTROL-FILE.
  4178     12  CF-RECORD-ID                       PIC XX.
  4179         88  VALID-CF-ID                        VALUE 'CF'.
  4180
  4181     12  CF-CONTROL-PRIMARY.
  4182         16  CF-COMPANY-ID                  PIC XXX.
  4183         16  CF-RECORD-TYPE                 PIC X.
  4184             88  CF-COMPANY-MASTER              VALUE '1'.
  4185             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4186             88  CF-STATE-MASTER                VALUE '3'.
  4187             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4188             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4189             88  CF-CARRIER-MASTER              VALUE '6'.
  4190             88  CF-MORTALITY-MASTER            VALUE '7'.
  4191             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4192             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  81
* EL156.cbl
  4193             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4194             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4195             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4196             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4197             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4198             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4199             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4200             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4201             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4202         16  CF-ACCESS-CD-GENL              PIC X(4).
  4203         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4204             20  CF-PROCESSOR               PIC X(4).
  4205         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4206             20  CF-STATE-CODE              PIC XX.
  4207             20  FILLER                     PIC XX.
  4208         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4209             20  FILLER                     PIC XX.
  4210             20  CF-HI-BEN-IN-REC           PIC XX.
  4211         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4212             20  FILLER                     PIC XXX.
  4213             20  CF-CARRIER-CNTL            PIC X.
  4214         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4215             20  FILLER                     PIC XX.
  4216             20  CF-HI-TYPE-IN-REC          PIC 99.
  4217         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4218             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4219                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4220             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4221             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4222         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4223             20  FILLER                     PIC X.
  4224             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4225         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4226             20  FILLER                     PIC XX.
  4227             20  CF-MORTGAGE-PLAN           PIC XX.
  4228         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4229
  4230     12  CF-LAST-MAINT-DT                   PIC XX.
  4231     12  CF-LAST-MAINT-BY                   PIC X(4).
  4232     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4233
  4234     12  CF-RECORD-BODY                     PIC X(728).
  4235
  4236
  4237****************************************************************
  4238*             COMPANY MASTER RECORD                            *
  4239****************************************************************
  4240
  4241     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4242         16  CF-COMPANY-ADDRESS.
  4243             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4244             20  CF-CL-IN-CARE-OF           PIC X(30).
  4245             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4246             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4247             20  CF-CL-CITY-STATE           PIC X(30).
  4248             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4249             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4250         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  82
* EL156.cbl
  4251         16  CF-COMPANY-PASSWORD            PIC X(8).
  4252         16  CF-SECURITY-OPTION             PIC X.
  4253             88  ALL-SECURITY                   VALUE '1'.
  4254             88  COMPANY-VERIFY                 VALUE '2'.
  4255             88  PROCESSOR-VERIFY               VALUE '3'.
  4256             88  NO-SECURITY                    VALUE '4'.
  4257             88  ALL-BUT-TERM                   VALUE '5'.
  4258         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4259             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4260         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4261             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4262         16  CF-INFORCE-LOCATION            PIC X.
  4263             88  CERTS-ARE-ONLINE               VALUE '1'.
  4264             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4265             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4266         16  CF-LOWER-CASE-LETTERS          PIC X.
  4267         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4268             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4269             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4270             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4271             88  CF-ACCNT-CNTL                  VALUE '3'.
  4272             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4273
  4274         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4275         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4276
  4277         16  CF-LGX-CREDIT-USER             PIC X.
  4278             88  CO-IS-NOT-USER                 VALUE 'N'.
  4279             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4280
  4281         16 CF-CREDIT-CALC-CODES.
  4282             20  CF-CR-REM-TERM-CALC PIC X.
  4283               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4284               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4285               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4286               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4287               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4288               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4289               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4290             20  CF-CR-R78-METHOD           PIC X.
  4291               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4292               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4293
  4294         16  CF-CLAIM-CONTROL-COUNTS.
  4295             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4296                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4297
  4298             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4299                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4300
  4301             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4302                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4303
  4304             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4305                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4306
  4307         16  CF-CURRENT-MONTH-END           PIC XX.
  4308
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  83
* EL156.cbl
  4309         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4310             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4311             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4312             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4313             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4314                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4315                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4316             20  CF-CO-PREM-REJECT-SW       PIC X.
  4317                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4318                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4319             20  CF-CO-REF-REJECT-SW        PIC X.
  4320                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4321                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4322
  4323         16  CF-CO-REPORTING-DT             PIC XX.
  4324         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4325         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4326           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4327           88  CF-CO-MONTH-END                  VALUE '1'.
  4328
  4329         16  CF-LGX-CLAIM-USER              PIC X.
  4330             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4331             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4332
  4333         16  CF-CREDIT-EDIT-CONTROLS.
  4334             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4335             20  CF-MIN-AGE                 PIC 99.
  4336             20  CF-DEFAULT-AGE             PIC 99.
  4337             20  CF-MIN-TERM                PIC S999      COMP-3.
  4338             20  CF-MAX-TERM                PIC S999      COMP-3.
  4339             20  CF-DEFAULT-SEX             PIC X.
  4340             20  CF-JOINT-AGE-INPUT         PIC X.
  4341                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4342             20  CF-BIRTH-DATE-INPUT        PIC X.
  4343                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4344             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4345                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4346                 88  CF-ZERO-CARRIER            VALUE '1'.
  4347                 88  CF-ZERO-GROUPING           VALUE '2'.
  4348                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4349             20  CF-EDIT-SW                 PIC X.
  4350                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4351             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4352             20  CF-CR-PR-METHOD            PIC X.
  4353               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4354               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4355             20  FILLER                     PIC X.
  4356
  4357         16  CF-CREDIT-MISC-CONTROLS.
  4358             20  CF-REIN-TABLE-SW           PIC X.
  4359                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4360             20  CF-COMP-TABLE-SW           PIC X.
  4361                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4362             20  CF-EXPERIENCE-RETENTION-AGE
  4363                                            PIC S9        COMP-3.
  4364             20  CF-CONVERSION-DT           PIC XX.
  4365             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4366             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  84
* EL156.cbl
  4367                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4368                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4369
  4370             20  CF-CR-CHECK-NO-CONTROL.
  4371                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4372                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4373                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4374                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4375                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4376                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4377
  4378                 24  CF-CR-CHECK-COUNT       REDEFINES
  4379                     CF-CR-CHECK-COUNTER      PIC X(4).
  4380
  4381                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4382                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4383
  4384                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4385                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4386                 24  CF-MAIL-PROCESSING       PIC X.
  4387                     88  MAIL-PROCESSING          VALUE 'Y'.
  4388
  4389         16  CF-MISC-SYSTEM-CONTROL.
  4390             20  CF-SYSTEM-C                 PIC X.
  4391                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4392             20  CF-SYSTEM-D                 PIC X.
  4393                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4394             20  CF-SOC-SEC-NO-SW            PIC X.
  4395                 88  SOC-SEC-NO-USED             VALUE '1'.
  4396             20  CF-MEMBER-NO-SW             PIC X.
  4397                 88  MEMBER-NO-USED              VALUE '1'.
  4398             20  CF-TAX-ID-NUMBER            PIC X(11).
  4399             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4400             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4401                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4402                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4403                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4404                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4405             20  CF-SYSTEM-E                 PIC X.
  4406                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4407
  4408         16  CF-LGX-LIFE-USER               PIC X.
  4409             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4410             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4411
  4412         16  CF-CR-MONTH-END-DT             PIC XX.
  4413
  4414         16  CF-FILE-MAINT-DATES.
  4415             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4416                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4417             20  CF-LAST-BATCH       REDEFINES
  4418                 CF-LAST-BATCH-NO               PIC X(4).
  4419             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4420             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4421             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4422             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4423             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4424             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  85
* EL156.cbl
  4425             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4426             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4427             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4428             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4429
  4430         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4431         16  FILLER                         PIC X.
  4432
  4433         16  CF-ALT-MORT-CODE               PIC X(4).
  4434         16  CF-MEMBER-CAPTION              PIC X(10).
  4435
  4436         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4437             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4438             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4439             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4440             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4441             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4442
  4443         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4444
  4445         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4446         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4447         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4448         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4449
  4450         16  CF-AH-OVERRIDE-L1              PIC X.
  4451         16  CF-AH-OVERRIDE-L2              PIC XX.
  4452         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4453         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4454
  4455         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4456         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4457
  4458         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4459         16  CF-AR-LAST-EL860-DT            PIC XX.
  4460         16  CF-MP-MONTH-END-DT             PIC XX.
  4461
  4462         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4463         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4464             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4465
  4466         16  CF-AR-MONTH-END-DT             PIC XX.
  4467
  4468         16  CF-CRDTCRD-USER                PIC X.
  4469             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4470             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4471
  4472         16  CF-CC-MONTH-END-DT             PIC XX.
  4473
  4474         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4475
  4476         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4477             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4478             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4479             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4480         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4481         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4482         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  86
* EL156.cbl
  4483         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4484             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4485             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4486         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4487         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4488         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4489             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4490         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4491
  4492         16  CF-CL-ZIP-CODE.
  4493             20  CF-CL-ZIP-PRIME.
  4494                 24  CF-CL-ZIP-1ST          PIC X.
  4495                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4496                 24  FILLER                 PIC X(4).
  4497             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4498         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4499             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4500             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4501             20  FILLER                     PIC XXX.
  4502
  4503         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4504         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4505         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4506         16  CF-CO-OPTION-START-DATE        PIC XX.
  4507         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4508           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4509                                                      '3' '4'.
  4510           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4511           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4512           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4513           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4514           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4515           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4516
  4517         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4518
  4519         16  CF-PAYMENT-APPROVAL-LEVELS.
  4520             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4521             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4522             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4523             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4524             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4525             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4526
  4527         16  CF-END-USER-REPORTING-USER     PIC X.
  4528             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4529             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4530
  4531         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4532             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4533             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4534
  4535         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4536
  4537         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4538         16  FILLER                         PIC X.
  4539
  4540         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  87
* EL156.cbl
  4541             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4542             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4543             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4544
  4545         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4546
  4547         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4548             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4549             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4550
  4551         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4552             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4553             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4554
  4555         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4556
  4557         16  CF-CO-ACH-ID-CODE              PIC  X.
  4558             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4559             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4560             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4561         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4562         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4563         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4564         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4565         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4566         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4567         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4568         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4569         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4570                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4571         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4572                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4573
  4574         16  CF-CO-OVER-SHORT.
  4575             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4576             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4577
  4578*         16  FILLER                         PIC X(102).
  4579         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4580             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4581             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4582
  4583         16  CF-AH-APPROVAL-DAYS.
  4584             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4585             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4586             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4587             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4588
  4589         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4590
  4591         16  CF-APPROV-LEV-5.
  4592             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4593             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4594             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4595
  4596         16  FILLER                         PIC X(68).
  4597****************************************************************
  4598*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  88
* EL156.cbl
  4599****************************************************************
  4600
  4601     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4602         16  CF-PROCESSOR-NAME              PIC X(30).
  4603         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4604         16  CF-PROCESSOR-TITLE             PIC X(26).
  4605         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4606                 88  MESSAGE-YES                VALUE 'Y'.
  4607                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4608
  4609*****************************************************
  4610****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4611****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4612****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4613****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4614*****************************************************
  4615
  4616         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4617             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4618             20  CF-APPLICATION-FORCE       PIC X.
  4619             20  CF-INDIVIDUAL-APP.
  4620                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4621                     28  CF-BROWSE-APP      PIC X.
  4622                     28  CF-UPDATE-APP      PIC X.
  4623
  4624         16  CF-CURRENT-TERM-ON             PIC X(4).
  4625         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4626             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4627             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4628             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4629             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4630             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4631             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4632             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4633         16  CF-PROCESSOR-CARRIER           PIC X.
  4634             88  NO-CARRIER-SECURITY            VALUE ' '.
  4635         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4636             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4637         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4638             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4639         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4640             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4641
  4642         16  CF-PROC-SYS-ACCESS-SW.
  4643             20  CF-PROC-CREDIT-CLAIMS-SW.
  4644                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4645                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4646                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4647                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4648             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4649                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4650                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4651             20  CF-PROC-LIFE-GNRLDGR-SW.
  4652                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4653                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4654                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4655                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4656             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  89
* EL156.cbl
  4657                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4658                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4659         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4660             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4661             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4662         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4663
  4664         16  CF-APPROVAL-LEVEL                  PIC X.
  4665             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4666             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4667             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4668             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4669             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4670
  4671         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4672
  4673         16  CF-LANGUAGE-TYPE                   PIC X.
  4674             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4675             88  CF-LANG-IS-FR                      VALUE 'F'.
  4676
  4677         16  CF-CSR-IND                         PIC X.
  4678         16  FILLER                             PIC X(239).
  4679
  4680****************************************************************
  4681*             PROCESSOR/REMINDERS RECORD                       *
  4682****************************************************************
  4683
  4684     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4685         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4686             20  CF-START-REMIND-DT         PIC XX.
  4687             20  CF-END-REMIND-DT           PIC XX.
  4688             20  CF-REMINDER-TEXT           PIC X(50).
  4689         16  FILLER                         PIC X(296).
  4690
  4691
  4692****************************************************************
  4693*             STATE MASTER RECORD                              *
  4694****************************************************************
  4695
  4696     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4697         16  CF-STATE-ABBREVIATION          PIC XX.
  4698         16  CF-STATE-NAME                  PIC X(25).
  4699         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4700         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4701             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4702             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4703             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4704             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4705                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4706                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4707             20  CF-ST-PREM-REJECT-SW       PIC X.
  4708                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4709                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4710             20  CF-ST-REF-REJECT-SW        PIC X.
  4711                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4712                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4713         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4714         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  90
* EL156.cbl
  4715         16  CF-ST-REFUND-RULES.
  4716             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4717             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4718             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4719         16  CF-ST-FST-PMT-EXTENSION.
  4720             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4721             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4722                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4723                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4724                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4725                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4726         16  CF-ST-STATE-CALL.
  4727             20  CF-ST-CALL-UNEARNED        PIC X.
  4728             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4729             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4730         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4731             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4732             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4733         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4734         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4735         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4736         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4737         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4738         16  FILLER                         PIC X.
  4739         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4740             20  CF-ST-BENEFIT-CD           PIC XX.
  4741             20  CF-ST-BENEFIT-KIND         PIC X.
  4742                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4743                 88  CF-ST-AH-KIND              VALUE 'A'.
  4744             20  CF-ST-REM-TERM-CALC        PIC X.
  4745                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4746                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4747                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4748                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4749                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4750                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4751                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4752                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4753
  4754             20  CF-ST-REFUND-CALC          PIC X.
  4755                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4756                 88  ST-REFD-BY-R78             VALUE '1'.
  4757                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4758                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4759                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4760                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4761                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4762                 88  ST-REFD-UTAH               VALUE '7'.
  4763                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4764                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4765                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4766
  4767             20  CF-ST-EARNING-CALC         PIC X.
  4768                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4769                 88  ST-EARN-BY-R78             VALUE '1'.
  4770                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4771                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4772                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  91
* EL156.cbl
  4773                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4774                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4775                 88  ST-EARN-MEAN               VALUE '8'.
  4776                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4777
  4778             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4779                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4780                 88  ST-OVRD-BY-R78             VALUE '1'.
  4781                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4782                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4783                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4784                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4785                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4786                 88  ST-OVRD-MEAN               VALUE '8'.
  4787                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4788             20  cf-st-extra-periods        pic 9.
  4789*            20  FILLER                     PIC X.
  4790
  4791         16  CF-ST-COMMISSION-CAPS.
  4792             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4793             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4794             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4795             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4796         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4797                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4798
  4799         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4800
  4801         16  CF-ST-STATUTORY-INTEREST.
  4802             20  CF-ST-STAT-DATE-FROM       PIC X.
  4803                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4804                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4805             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4806             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4807             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4808             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4809             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4810
  4811         16  CF-ST-OVER-SHORT.
  4812             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4813             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4814
  4815         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4816
  4817         16  CF-ST-RT-CALC                  PIC X.
  4818
  4819         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4820         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4821         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4822         16  CF-ST-RF-LR-CALC               PIC X.
  4823         16  CF-ST-RF-LL-CALC               PIC X.
  4824         16  CF-ST-RF-LN-CALC               PIC X.
  4825         16  CF-ST-RF-AH-CALC               PIC X.
  4826         16  CF-ST-RF-CP-CALC               PIC X.
  4827*        16  FILLER                         PIC X(206).
  4828*CIDMOD         16  FILLER                         PIC X(192).
  4829         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4830             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  92
* EL156.cbl
  4831         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4832         16  CF-ST-VFY-2ND-BENE             PIC X.
  4833         16  CF-ST-CAUSAL-STATE             PIC X.
  4834         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4835         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4836         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4837             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4838         16  CF-ST-NET-ONLY-STATE           PIC X.
  4839             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4840         16  FILLER                         PIC X(181).
  4841
  4842****************************************************************
  4843*             BENEFIT MASTER RECORD                            *
  4844****************************************************************
  4845
  4846     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4847         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4848             20  CF-BENEFIT-CODE            PIC XX.
  4849             20  CF-BENEFIT-NUMERIC  REDEFINES
  4850                 CF-BENEFIT-CODE            PIC XX.
  4851             20  CF-BENEFIT-ALPHA           PIC XXX.
  4852             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4853             20  CF-BENEFIT-COMMENT         PIC X(10).
  4854
  4855             20  CF-LF-COVERAGE-TYPE        PIC X.
  4856                 88  CF-REDUCING                VALUE 'R'.
  4857                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4858
  4859             20  CF-SPECIAL-CALC-CD         PIC X.
  4860                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4861                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4862                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4863                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4864                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4865                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4866                 88  CF-FARM-PLAN               VALUE 'F'.
  4867                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4868                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4869                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4870                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4871                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4872                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4873                 88  CF-PRUDENTIAL              VALUE 'P'.
  4874                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4875                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4876                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4877                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4878                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4879                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4880
  4881             20  CF-JOINT-INDICATOR         PIC X.
  4882                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4883
  4884*            20  FILLER                     PIC X(12).
  4885             20  cf-maximum-benefits        pic s999 comp-3.
  4886             20  FILLER                     PIC X(09).
  4887             20  CF-BENEFIT-CATEGORY        PIC X.
  4888             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  93
* EL156.cbl
  4889
  4890             20  CF-CO-REM-TERM-CALC        PIC X.
  4891                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4892                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4893                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4894                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4895                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4896
  4897             20  CF-CO-EARNINGS-CALC        PIC X.
  4898                 88  CO-EARN-BY-R78             VALUE '1'.
  4899                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4900                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4901                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4902                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4903                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4904                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4905                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4906
  4907             20  CF-CO-REFUND-CALC          PIC X.
  4908                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4909                 88  CO-REFD-BY-R78             VALUE '1'.
  4910                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4911                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4912                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4913                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4914                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4915                 88  CO-REFD-MEAN               VALUE '8'.
  4916                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4917                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4918                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4919
  4920             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4921                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4922                 88  CO-OVRD-BY-R78             VALUE '1'.
  4923                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4924                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4925                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4926                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4927                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4928                 88  CO-OVRD-MEAN               VALUE '8'.
  4929                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4930
  4931             20  CF-CO-BEN-I-G-CD           PIC X.
  4932                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4933                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4934                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4935
  4936         16  FILLER                         PIC X(304).
  4937
  4938
  4939****************************************************************
  4940*             CARRIER MASTER RECORD                            *
  4941****************************************************************
  4942
  4943     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4944         16  CF-ADDRESS-DATA.
  4945             20  CF-MAIL-TO-NAME            PIC X(30).
  4946             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  94
* EL156.cbl
  4947             20  CF-ADDRESS-LINE-1          PIC X(30).
  4948             20  CF-ADDRESS-LINE-2          PIC X(30).
  4949             20  CF-CITY-STATE              PIC X(30).
  4950             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4951             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4952
  4953         16  CF-CLAIM-NO-CONTROL.
  4954             20  CF-CLAIM-NO-METHOD         PIC X.
  4955                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4956                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4957                 88  CLAIM-NO-SEQ               VALUE '3'.
  4958                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4959             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4960                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4961                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4962                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4963
  4964         16  CF-CHECK-NO-CONTROL.
  4965             20  CF-CHECK-NO-METHOD         PIC X.
  4966                 88  CHECK-NO-MANUAL            VALUE '1'.
  4967                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4968                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4969                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4970             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4971                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4972
  4973         16  CF-DOMICILE-STATE              PIC XX.
  4974
  4975         16  CF-EXPENSE-CONTROLS.
  4976             20  CF-EXPENSE-METHOD          PIC X.
  4977                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4978                 88  DOLLARS-PER-PMT            VALUE '2'.
  4979                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4980                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4981             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4982             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4983
  4984         16  CF-CORRESPONDENCE-CONTROL.
  4985             20  CF-LETTER-RESEND-OPT       PIC X.
  4986                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4987                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4988             20  FILLER                     PIC X(4).
  4989
  4990         16  CF-RESERVE-CONTROLS.
  4991             20  CF-MANUAL-SW               PIC X.
  4992                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4993             20  CF-FUTURE-SW               PIC X.
  4994                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4995             20  CF-PTC-SW                  PIC X.
  4996                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4997             20  CF-IBNR-SW                 PIC X.
  4998                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4999             20  CF-PTC-LF-SW               PIC X.
  5000                 88  CF-LF-PTC-USED             VALUE '1'.
  5001             20  CF-CDT-ACCESS-METHOD       PIC X.
  5002                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5003                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5004                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  95
* EL156.cbl
  5005             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5006
  5007         16  CF-CLAIM-CALC-METHOD           PIC X.
  5008             88  360-PLUS-MONTHS                VALUE '1'.
  5009             88  365-PLUS-MONTHS                VALUE '2'.
  5010             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5011             88  360-DAILY                      VALUE '4'.
  5012             88  365-DAILY                      VALUE '5'.
  5013
  5014         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5015         16  FILLER                         PIC X(11).
  5016
  5017         16  CF-LIMIT-AMOUNTS.
  5018             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5019             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5020             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5021             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5022             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5023             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5024             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5025             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5026             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5027             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5028
  5029         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5030         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5031         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5032
  5033         16  CF-ZIP-CODE.
  5034             20  CF-ZIP-PRIME.
  5035                 24  CF-ZIP-1ST             PIC X.
  5036                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5037                 24  FILLER                 PIC X(4).
  5038             20  CF-ZIP-PLUS4               PIC X(4).
  5039         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5040             20  CF-CAN-POSTAL-1            PIC XXX.
  5041             20  CF-CAN-POSTAL-2            PIC XXX.
  5042             20  FILLER                     PIC XXX.
  5043
  5044         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5045         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5046         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5047
  5048         16  CF-RATING-SWITCH               PIC X.
  5049             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5050             88  CF-NO-RATING                   VALUE 'N'.
  5051
  5052         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5053
  5054         16  CF-CARRIER-OVER-SHORT.
  5055             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5056             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5057
  5058         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5059         16  CF-SECPAY-SWITCH               PIC X.
  5060             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5061             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5062         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  96
* EL156.cbl
  5063         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5064         16  FILLER                         PIC X(444).
  5065*        16  FILLER                         PIC X(452).
  5066
  5067
  5068****************************************************************
  5069*             MORTALITY MASTER RECORD                          *
  5070****************************************************************
  5071
  5072     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5073         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5074                                INDEXED BY CF-MORT-NDX.
  5075             20  CF-MORT-TABLE              PIC X(5).
  5076             20  CF-MORT-TABLE-TYPE         PIC X.
  5077                 88  CF-MORT-JOINT              VALUE 'J'.
  5078                 88  CF-MORT-SINGLE             VALUE 'S'.
  5079                 88  CF-MORT-COMBINED           VALUE 'C'.
  5080                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5081                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5082             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5083             20  CF-MORT-AGE-METHOD         PIC XX.
  5084                 88  CF-AGE-LAST                VALUE 'AL'.
  5085                 88  CF-AGE-NEAR                VALUE 'AN'.
  5086             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5087             20  CF-MORT-ADJUSTMENT-DIRECTION
  5088                                            PIC X.
  5089                 88  CF-MINUS                   VALUE '-'.
  5090                 88  CF-PLUS                    VALUE '+'.
  5091             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5092             20  CF-MORT-JOINT-CODE         PIC X.
  5093                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5094             20  CF-MORT-PC-Q               PIC X.
  5095                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5096             20  CF-MORT-TABLE-CODE         PIC X(4).
  5097             20  CF-MORT-COMMENTS           PIC X(15).
  5098             20  FILLER                     PIC X(14).
  5099
  5100         16  FILLER                         PIC X(251).
  5101
  5102
  5103****************************************************************
  5104*             BUSSINESS TYPE MASTER RECORD                     *
  5105****************************************************************
  5106
  5107     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5108* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5109* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5110* AND RECORD 05 IS TYPES 81-99
  5111         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5112             20  CF-BUSINESS-TITLE          PIC  X(19).
  5113             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5114                                            PIC S9V9(4) COMP-3.
  5115             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5116             20  FILLER                     PIC  X.
  5117         16  FILLER                         PIC  X(248).
  5118
  5119
  5120****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  97
* EL156.cbl
  5121*             TERMINAL MASTER RECORD                           *
  5122****************************************************************
  5123
  5124     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5125
  5126         16  CF-COMPANY-TERMINALS.
  5127             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5128                                  PIC X(4).
  5129         16  FILLER               PIC X(248).
  5130
  5131
  5132****************************************************************
  5133*             LIFE EDIT MASTER RECORD                          *
  5134****************************************************************
  5135
  5136     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5137         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5138             20  CF-LIFE-CODE-IN            PIC XX.
  5139             20  CF-LIFE-CODE-OUT           PIC XX.
  5140         16  FILLER                         PIC X(248).
  5141
  5142
  5143****************************************************************
  5144*             AH EDIT MASTER RECORD                            *
  5145****************************************************************
  5146
  5147     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5148         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5149             20  CF-AH-CODE-IN              PIC XXX.
  5150             20  CF-AH-CODE-OUT             PIC XX.
  5151         16  FILLER                         PIC X(248).
  5152
  5153
  5154****************************************************************
  5155*             CREDIBILITY TABLES                               *
  5156****************************************************************
  5157
  5158     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5159         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5160                             INDEXED BY CF-CRDB-NDX.
  5161             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5162             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5163             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5164         16  FILLER                         PIC  X(332).
  5165
  5166
  5167****************************************************************
  5168*             REPORT CUSTOMIZATION RECORD                      *
  5169****************************************************************
  5170
  5171     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5172         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5173             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5174             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5175             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5176**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5177****       A T-TRANSFER.                                   ****
  5178             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  98
* EL156.cbl
  5179
  5180         16  FILLER                         PIC XX.
  5181
  5182         16  CF-CARRIER-CNTL-OPT.
  5183             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5184                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5185                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5186             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5187                                            PIC X.
  5188         16  CF-GROUP-CNTL-OPT.
  5189             20  CF-GROUP-OPT-SEQ           PIC 9.
  5190                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5191                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5192             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5193                                            PIC X(6).
  5194         16  CF-STATE-CNTL-OPT.
  5195             20  CF-STATE-OPT-SEQ           PIC 9.
  5196                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5197                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5198             20  CF-STATE-SELECT OCCURS 3 TIMES
  5199                                            PIC XX.
  5200         16  CF-ACCOUNT-CNTL-OPT.
  5201             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5202                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5203                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5204             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5205                                            PIC X(10).
  5206         16  CF-BUS-TYP-CNTL-OPT.
  5207             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5208                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5209                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5210             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5211                                            PIC XX.
  5212         16  CF-LF-TYP-CNTL-OPT.
  5213             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5214                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5215                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5216             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5217                                            PIC XX.
  5218         16  CF-AH-TYP-CNTL-OPT.
  5219             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5220                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5221                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5222             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5223                                            PIC XX.
  5224         16  CF-REPTCD1-CNTL-OPT.
  5225             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5226                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5227                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5228             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5229                                            PIC X(10).
  5230         16  CF-REPTCD2-CNTL-OPT.
  5231             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5232                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5233                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5234             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5235                                            PIC X(10).
  5236         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page  99
* EL156.cbl
  5237             20  CF-USER1-OPT-SEQ           PIC 9.
  5238                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5239                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5240             20  CF-USER1-SELECT OCCURS 3 TIMES
  5241                                            PIC X(10).
  5242         16  CF-USER2-CNTL-OPT.
  5243             20  CF-USER2-OPT-SEQ           PIC 9.
  5244                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5245                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5246             20  CF-USER2-SELECT OCCURS 3 TIMES
  5247                                            PIC X(10).
  5248         16  CF-USER3-CNTL-OPT.
  5249             20  CF-USER3-OPT-SEQ           PIC 9.
  5250                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5251                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5252             20  CF-USER3-SELECT OCCURS 3 TIMES
  5253                                            PIC X(10).
  5254         16  CF-USER4-CNTL-OPT.
  5255             20  CF-USER4-OPT-SEQ           PIC 9.
  5256                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5257                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5258             20  CF-USER4-SELECT OCCURS 3 TIMES
  5259                                            PIC X(10).
  5260         16  CF-USER5-CNTL-OPT.
  5261             20  CF-USER5-OPT-SEQ           PIC 9.
  5262                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5263                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5264             20  CF-USER5-SELECT OCCURS 3 TIMES
  5265                                            PIC X(10).
  5266         16  CF-REINS-CNTL-OPT.
  5267             20  CF-REINS-OPT-SEQ           PIC 9.
  5268                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5269                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5270             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5271                 24  CF-REINS-PRIME         PIC XXX.
  5272                 24  CF-REINS-SUB           PIC XXX.
  5273
  5274         16  CF-AGENT-CNTL-OPT.
  5275             20  CF-AGENT-OPT-SEQ           PIC 9.
  5276                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5277                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5278             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5279                                            PIC X(10).
  5280
  5281         16  FILLER                         PIC X(43).
  5282
  5283         16  CF-LOSS-RATIO-SELECT.
  5284             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5285             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5286         16  CF-ENTRY-DATE-SELECT.
  5287             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5288             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5289         16  CF-EFFECTIVE-DATE-SELECT.
  5290             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5291             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5292
  5293         16  CF-EXCEPTION-LIST-IND          PIC X.
  5294             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 100
* EL156.cbl
  5295
  5296         16  FILLER                         PIC X(318).
  5297
  5298****************************************************************
  5299*                  EXCEPTION REPORTING RECORD                  *
  5300****************************************************************
  5301
  5302     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5303         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5304             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5305
  5306         16  CF-COMBINED-LIFE-AH-OPT.
  5307             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5308             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5309             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5310             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5311
  5312         16  CF-LIFE-OPT.
  5313             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5314             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5315             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5316             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5317             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5318             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5319             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5320             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5321             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5322             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5323
  5324         16  CF-AH-OPT.
  5325             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5326             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5327             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5328             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5329             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5330             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5331             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5332             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5333             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5334             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5335
  5336         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5337             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5338             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5339             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5340
  5341         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5342
  5343         16  FILLER                         PIC X(673).
  5344
  5345
  5346****************************************************************
  5347*             MORTGAGE SYSTEM PLAN RECORD                      *
  5348****************************************************************
  5349
  5350     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5351         16  CF-PLAN-TYPE                   PIC X.
  5352             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 101
* EL156.cbl
  5353             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5354             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5355         16  CF-PLAN-ABBREV                 PIC XXX.
  5356         16  CF-PLAN-DESCRIPT               PIC X(10).
  5357         16  CF-PLAN-NOTES                  PIC X(20).
  5358         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5359         16  CF-PLAN-UNDERWRITING.
  5360             20  CF-PLAN-TERM-DATA.
  5361                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5362                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5363             20  CF-PLAN-AGE-DATA.
  5364                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5365                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5366                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5367             20  CF-PLAN-BENEFIT-DATA.
  5368                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5369                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5370                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5371                                            PIC S9(7)V99  COMP-3.
  5372         16  CF-PLAN-POLICY-FORMS.
  5373             20  CF-POLICY-FORM             PIC X(12).
  5374             20  CF-MASTER-APPLICATION      PIC X(12).
  5375             20  CF-MASTER-POLICY           PIC X(12).
  5376         16  CF-PLAN-RATING.
  5377             20  CF-RATE-CODE               PIC X(5).
  5378             20  CF-SEX-RATING              PIC X.
  5379                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5380                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5381             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5382             20  CF-SUB-STD-TYPE            PIC X.
  5383                 88  CF-PCT-OF-PREM            VALUE '1'.
  5384                 88  CF-PCT-OF-BENE            VALUE '2'.
  5385         16  CF-PLAN-PREM-TOLERANCES.
  5386             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5387             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5388         16  CF-PLAN-PYMT-TOLERANCES.
  5389             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5390             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5391         16  CF-PLAN-MISC-DATA.
  5392             20  FILLER                     PIC X.
  5393             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5394             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5395         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5396         16  CF-PLAN-IND-GRP                PIC X.
  5397             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5398                                                     '1'.
  5399             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5400                                                     '2'.
  5401         16  CF-MIB-SEARCH-SW               PIC X.
  5402             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5403             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5404             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5405             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5406         16  CF-ALPHA-SEARCH-SW             PIC X.
  5407             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5408             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5409             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5410             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 102
* EL156.cbl
  5411             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5412             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5413             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5414             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5415             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5416             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5417                                                     'A' 'B' 'C'
  5418                                                     'X' 'Y' 'Z'.
  5419         16  CF-EFF-DT-RULE-SW              PIC X.
  5420             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5421             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5422             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5423             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5424             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5425         16  FILLER                         PIC X(4).
  5426         16  CF-HEALTH-QUESTIONS            PIC X.
  5427             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5428         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5429         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5430         16  CF-PLAN-SNGL-JNT               PIC X.
  5431             88  CF-COMBINED-PLAN              VALUE 'C'.
  5432             88  CF-JNT-PLAN                   VALUE 'J'.
  5433             88  CF-SNGL-PLAN                  VALUE 'S'.
  5434         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5435         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5436         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5437         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5438         16  CF-RERATE-CNTL                 PIC  X.
  5439             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5440             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5441             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5442             88  CF-AUTO-RECALC                 VALUE '4'.
  5443         16  CF-BENEFIT-TYPE                PIC  X.
  5444             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5445             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5446         16  CF-POLICY-FEE                  PIC S999V99
  5447                                                    COMP-3.
  5448         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5449         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5450         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5451         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5452         16  FILLER                         PIC  X(32).
  5453         16  CF-TERMINATION-FORM            PIC  X(04).
  5454         16  FILLER                         PIC  X(08).
  5455         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5456                                                       COMP-3.
  5457         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5458         16  CF-ISSUE-LETTER                PIC  X(4).
  5459         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5460         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5461             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5462             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5463         16  CF-MP-REFUND-CALC              PIC X.
  5464             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5465             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5466             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5467             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5468             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 103
* EL156.cbl
  5469             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5470             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5471             88  CF-MP-REFD-MEAN                VALUE '8'.
  5472         16  CF-ALT-RATE-CODE               PIC  X(5).
  5473
  5474
  5475         16  FILLER                         PIC X(498).
  5476****************************************************************
  5477*             MORTGAGE COMPANY MASTER RECORD                   *
  5478****************************************************************
  5479
  5480     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5481         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5482         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5483             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5484             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5485             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5486             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5487             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5488
  5489         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5490         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5491         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5492         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5493         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5494
  5495         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5496             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5497         16  CF-MP-RECON-USE-IND            PIC X(1).
  5498             88  CF-MP-USE-RECON             VALUE 'Y'.
  5499         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5500             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5501         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5502             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5503             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5504         16  FILLER                         PIC X(1).
  5505         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5506             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5507         16  CF-MORTG-MIB-VERSION           PIC X.
  5508             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5509             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5510             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5511         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5512             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5513                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5514             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5515                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5516             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5517                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5518             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5519                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5520             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5521                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5522             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5523                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5524         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5525         16  FILLER                         PIC X(7).
  5526         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 104
* EL156.cbl
  5527             20  CF-MORTG-MIB-COMM          PIC X(5).
  5528             20  CF-MORTG-MIB-TERM          PIC X(5).
  5529         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5530             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5531         16  FILLER                         PIC X(03).
  5532         16  CF-MP-CHECK-NO-CONTROL.
  5533             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5534                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5535                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5536                                                ' ' LOW-VALUES.
  5537                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5538                                               VALUE '3'.
  5539         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5540         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5541         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5542             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5543                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5544             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5545                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5546             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5547                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5548             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5549                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5550             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5551                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5552             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5553                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5554         16  CF-MORTG-BILLING-AREA.
  5555             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5556                                            PIC X.
  5557         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5558         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5559         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5560         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5561             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5562             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5563         16  FILLER                         PIC X.
  5564         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5565             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5566             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5567         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5568         16  FILLER                         PIC X(8).
  5569         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5570         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5571         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5572         16  CF-ACH-COMPANY-ID.
  5573             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5574                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5575                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5576                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5577             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5578         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5579             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5580         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5581             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5582             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5583         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5584         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 105
* EL156.cbl
  5585         16  FILLER                         PIC X(536).
  5586
  5587****************************************************************
  5588*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5589****************************************************************
  5590
  5591     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5592         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5593             20  CF-FEMALE-HEIGHT.
  5594                 24  CF-FEMALE-FT           PIC 99.
  5595                 24  CF-FEMALE-IN           PIC 99.
  5596             20  CF-FEMALE-MIN-WT           PIC 999.
  5597             20  CF-FEMALE-MAX-WT           PIC 999.
  5598         16  FILLER                         PIC X(428).
  5599
  5600     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5601         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5602             20  CF-MALE-HEIGHT.
  5603                 24  CF-MALE-FT             PIC 99.
  5604                 24  CF-MALE-IN             PIC 99.
  5605             20  CF-MALE-MIN-WT             PIC 999.
  5606             20  CF-MALE-MAX-WT             PIC 999.
  5607         16  FILLER                         PIC X(428).
  5608******************************************************************
  5609*             AUTOMATIC ACTIVITY RECORD                          *
  5610******************************************************************
  5611     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5612         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5613             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5614             20  CF-SYS-LETTER-ID           PIC X(04).
  5615             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5616             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5617             20  CF-SYS-RESET-SW            PIC X(01).
  5618             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5619             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5620
  5621         16  FILLER                         PIC X(50).
  5622
  5623         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5624             20  CF-USER-ACTIVE-SW          PIC X(01).
  5625             20  CF-USER-LETTER-ID          PIC X(04).
  5626             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5627             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5628             20  CF-USER-RESET-SW           PIC X(01).
  5629             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5630             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5631             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5632
  5633         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 106
* EL156.cbl
  5635*    COPY ELCCERT.
  5636******************************************************************
  5637*                                                                *
  5638*                            ELCCERT.                            *
  5639*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5640*                            VMOD=2.013                          *
  5641*                                                                *
  5642*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5643*                                                                *
  5644*   FILE TYPE = VSAM,KSDS                                        *
  5645*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5646*                                                                *
  5647*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5648*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5649*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5650*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5651*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5652*                                                                *
  5653*   LOG = YES                                                    *
  5654*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5655******************************************************************
  5656*                   C H A N G E   L O G
  5657*
  5658* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5659*-----------------------------------------------------------------
  5660*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5661* EFFECTIVE    NUMBER
  5662*-----------------------------------------------------------------
  5663* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5664* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5665* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5666* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5667* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5668* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5669* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5670* 032612  CR2011110200001  PEMA  AHL CHANGES
  5671* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5672* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5673******************************************************************
  5674
  5675 01  CERTIFICATE-MASTER.
  5676     12  CM-RECORD-ID                      PIC XX.
  5677         88  VALID-CM-ID                      VALUE 'CM'.
  5678
  5679     12  CM-CONTROL-PRIMARY.
  5680         16  CM-COMPANY-CD                 PIC X.
  5681         16  CM-CARRIER                    PIC X.
  5682         16  CM-GROUPING.
  5683             20  CM-GROUPING-PREFIX        PIC X(3).
  5684             20  CM-GROUPING-PRIME         PIC X(3).
  5685         16  CM-STATE                      PIC XX.
  5686         16  CM-ACCOUNT.
  5687             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5688             20  CM-ACCOUNT-PRIME          PIC X(6).
  5689         16  CM-CERT-EFF-DT                PIC XX.
  5690         16  CM-CERT-NO.
  5691             20  CM-CERT-PRIME             PIC X(10).
  5692             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 107
* EL156.cbl
  5693
  5694     12  CM-CONTROL-BY-NAME.
  5695         16  CM-COMPANY-CD-A1              PIC X.
  5696         16  CM-INSURED-LAST-NAME          PIC X(15).
  5697         16  CM-INSURED-INITIALS.
  5698             20  CM-INSURED-INITIAL1       PIC X.
  5699             20  CM-INSURED-INITIAL2       PIC X.
  5700
  5701     12  CM-CONTROL-BY-SSN.
  5702         16  CM-COMPANY-CD-A2              PIC X.
  5703         16  CM-SOC-SEC-NO.
  5704             20  CM-SSN-STATE              PIC XX.
  5705             20  CM-SSN-ACCOUNT            PIC X(6).
  5706             20  CM-SSN-LN3.
  5707                 25  CM-INSURED-INITIALS-A2.
  5708                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5709                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5710                 25 CM-PART-LAST-NAME-A2         PIC X.
  5711
  5712     12  CM-CONTROL-BY-CERT-NO.
  5713         16  CM-COMPANY-CD-A4              PIC X.
  5714         16  CM-CERT-NO-A4                 PIC X(11).
  5715
  5716     12  CM-CONTROL-BY-MEMB.
  5717         16  CM-COMPANY-CD-A5              PIC X.
  5718         16  CM-MEMBER-NO.
  5719             20  CM-MEMB-STATE             PIC XX.
  5720             20  CM-MEMB-ACCOUNT           PIC X(6).
  5721             20  CM-MEMB-LN4.
  5722                 25  CM-INSURED-INITIALS-A5.
  5723                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5724                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5725                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5726
  5727     12  CM-INSURED-PROFILE-DATA.
  5728         16  CM-INSURED-FIRST-NAME.
  5729             20  CM-INSURED-1ST-INIT       PIC X.
  5730             20  FILLER                    PIC X(9).
  5731         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5732         16  CM-INSURED-SEX                PIC X.
  5733             88  CM-SEX-MALE                  VALUE 'M'.
  5734             88  CM-SEX-FEMAL                 VALUE 'F'.
  5735         16  CM-INSURED-JOINT-AGE          PIC 99.
  5736         16  CM-JOINT-INSURED-NAME.
  5737             20  CM-JT-LAST-NAME           PIC X(15).
  5738             20  CM-JT-FIRST-NAME.
  5739                 24  CM-JT-1ST-INIT        PIC X.
  5740                 24  FILLER                PIC X(9).
  5741             20  CM-JT-INITIAL             PIC X.
  5742
  5743     12  CM-LIFE-DATA.
  5744         16  CM-LF-BENEFIT-CD              PIC XX.
  5745         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5746         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5747         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5748         16  CM-LF-DEV-CODE                PIC XXX.
  5749         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5750         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 108
* EL156.cbl
  5751         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5752         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5753         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5754         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5755         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5756         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5757         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5758         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5759         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5760         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5761         16  cm-temp-epiq                  pic xx.
  5762             88  EPIQ-CLASS                  value 'EQ'.
  5763*        16  FILLER                        PIC XX.
  5764
  5765     12  CM-AH-DATA.
  5766         16  CM-AH-BENEFIT-CD              PIC XX.
  5767         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5768         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5769         16  CM-AH-DEV-CODE                PIC XXX.
  5770         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5771         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5772         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5773         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5774         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5775         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5776         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5777         16  CM-AH-PAID-THRU-DT            PIC XX.
  5778             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5779         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5780         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5781         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5782         16  FILLER                        PIC X.
  5783
  5784     12  CM-LOAN-INFORMATION.
  5785         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5786         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5787                                           PIC S9(5)V99  COMP-3.
  5788         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5789         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5790         16  CM-PAY-FREQUENCY              PIC S99.
  5791         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5792         16  CM-RATE-CLASS                 PIC XX.
  5793         16  CM-BENEFICIARY                PIC X(25).
  5794         16  CM-POLICY-FORM-NO             PIC X(12).
  5795         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5796         16  CM-LAST-ADD-ON-DT             PIC XX.
  5797         16  CM-DEDUCTIBLE-AMOUNTS.
  5798             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5799             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5800         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5801             20  CM-RESIDENT-STATE         PIC XX.
  5802             20  CM-RATE-CODE              PIC X(4).
  5803             20  FILLER                    PIC XX.
  5804         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5805             20  CM-LOAN-OFFICER           PIC X(5).
  5806             20  FILLER                    PIC XXX.
  5807         16  CM-CSR-CODE                   PIC XXX.
  5808         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 109
* EL156.cbl
  5809             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5810         16  CM-POST-CARD-IND              PIC X.
  5811         16  CM-NH-INTERFACE-SW            PIC X.
  5812         16  CM-PREMIUM-TYPE               PIC X.
  5813             88  CM-SING-PRM                  VALUE '1'.
  5814             88  CM-O-B-COVERAGE              VALUE '2'.
  5815             88  CM-OPEN-END                  VALUE '3'.
  5816         16  CM-IND-GRP-TYPE               PIC X.
  5817             88  CM-INDIVIDUAL                VALUE 'I'.
  5818             88  CM-GROUP                     VALUE 'G'.
  5819         16  CM-SKIP-CODE                  PIC X.
  5820             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5821             88  SKIP-JULY                    VALUE '1'.
  5822             88  SKIP-AUGUST                  VALUE '2'.
  5823             88  SKIP-SEPTEMBER               VALUE '3'.
  5824             88  SKIP-JULY-AUG                VALUE '4'.
  5825             88  SKIP-AUG-SEPT                VALUE '5'.
  5826             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5827             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5828             88  SKIP-JUNE                    VALUE '8'.
  5829             88  SKIP-JUNE-JULY               VALUE '9'.
  5830             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5831             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5832         16  CM-PAYMENT-MODE               PIC X.
  5833             88  PAY-MONTHLY                  VALUE SPACE.
  5834             88  PAY-WEEKLY                   VALUE '1'.
  5835             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5836             88  PAY-BI-WEEKLY                VALUE '3'.
  5837             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5838         16  CM-LOAN-NUMBER                PIC X(8).
  5839         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5840         16  CM-OLD-LOF                    PIC XXX.
  5841*        16  CM-LOAN-OFFICER               PIC XXX.
  5842         16  CM-REIN-TABLE                 PIC XXX.
  5843         16  CM-SPECIAL-REIN-CODE          PIC X.
  5844         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5845         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5846         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5847
  5848     12  CM-STATUS-DATA.
  5849         16  CM-ENTRY-STATUS               PIC X.
  5850         16  CM-ENTRY-DT                   PIC XX.
  5851
  5852         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5853         16  CM-LF-CANCEL-DT               PIC XX.
  5854         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5855
  5856         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5857         16  CM-LF-DEATH-DT                PIC XX.
  5858         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5859
  5860         16  CM-LF-CURRENT-STATUS          PIC X.
  5861             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5862                                                'M' '4' '5' '9'.
  5863             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5864             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5865             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5866             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 110
* EL156.cbl
  5867             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5868             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5869             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5870             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5871             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5872             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5873             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5874             88  CM-LF-DECLINED               VALUE 'D'.
  5875             88  CM-LF-VOIDED                 VALUE 'V'.
  5876
  5877         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5878         16  CM-AH-CANCEL-DT               PIC XX.
  5879         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5880
  5881         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5882         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5883         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5884
  5885         16  CM-AH-CURRENT-STATUS          PIC X.
  5886             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5887                                                'M' '4' '5' '9'.
  5888             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5889             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5890             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5891             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5892             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5893             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5894             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5895             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5896             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5897             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5898             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5899             88  CM-AH-DECLINED               VALUE 'D'.
  5900             88  CM-AH-VOIDED                 VALUE 'V'.
  5901
  5902         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5903             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5904             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5905             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5906         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5907
  5908         16  CM-ENTRY-BATCH                PIC X(6).
  5909         16  CM-LF-EXIT-BATCH              PIC X(6).
  5910         16  CM-AH-EXIT-BATCH              PIC X(6).
  5911         16  CM-LAST-MONTH-END             PIC XX.
  5912
  5913     12  CM-NOTE-SW                        PIC X.
  5914         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5915         88  CERT-NOTES-PRESENT               VALUE '1'.
  5916         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5917         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5918         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5919         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5920         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5921         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5922     12  CM-COMP-EXCP-SW                   PIC X.
  5923         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5924         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 111
* EL156.cbl
  5925     12  CM-INSURED-ADDRESS-SW             PIC X.
  5926         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5927         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5928
  5929*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5930     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5931     12  FILLER                            PIC X.
  5932
  5933*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5934     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5935     12  FILLER                            PIC X.
  5936*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5937     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5938
  5939     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5940         88  CERT-ADDED-BATCH                 VALUE ' '.
  5941         88  CERT-ADDED-ONLINE                VALUE '1'.
  5942         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5943         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5944         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5945     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5946         88  CERT-AS-LOADED                   VALUE ' '.
  5947         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5948         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5949         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5950         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5951         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5952         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5953         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5954
  5955     12  CM-ACCOUNT-COMM-PCTS.
  5956         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5957         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5958
  5959     12  CM-USER-FIELD                     PIC X.
  5960     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5961     12  CM-CLP-STATE                      PIC XX.
  5962     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5963     12  CM-USER-RESERVED                  PIC XXX.
  5964     12  FILLER REDEFINES CM-USER-RESERVED.
  5965         16  CM-AH-CLASS-CD                PIC XX.
  5966         16  F                             PIC X.
  5967******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 112
* EL156.cbl
  5969*    COPY ELCTRLR.
  5970******************************************************************
  5971*                                                                *
  5972*                            ELCTRLR.                            *
  5973*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5974*                            VMOD=2.014                          *
  5975*                                                                *
  5976*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5977*                                                                *
  5978*   FILE TYPE = VSAM,KSDS                                        *
  5979*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5980*                                                                *
  5981*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5982*       ALTERNATE INDEX = NONE                                   *
  5983*                                                                *
  5984*   LOG = YES                                                    *
  5985*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5986******************************************************************
  5987*                   C H A N G E   L O G
  5988*
  5989* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5990*-----------------------------------------------------------------
  5991*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5992* EFFECTIVE    NUMBER
  5993*-----------------------------------------------------------------
  5994* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5995* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5996* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5997* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5998* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5999* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  6000* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  6001* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  6002* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6003* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6004* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6005* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6006* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6007* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6008* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6009* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6010* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6011* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6012* 040814    2014030500002  AJRA  ADD ICD CODES
  6013* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6014* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6015* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  6016******************************************************************
  6017 01  ACTIVITY-TRAILERS.
  6018     12  AT-RECORD-ID                    PIC XX.
  6019         88  VALID-AT-ID                       VALUE 'AT'.
  6020
  6021     12  AT-CONTROL-PRIMARY.
  6022         16  AT-COMPANY-CD               PIC X.
  6023         16  AT-CARRIER                  PIC X.
  6024         16  AT-CLAIM-NO                 PIC X(7).
  6025         16  AT-CERT-NO.
  6026             20  AT-CERT-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 113
* EL156.cbl
  6027             20  AT-CERT-SFX             PIC X.
  6028         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6029             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6030             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6031             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6032             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6033             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6034             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6035             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6036             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6037             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6038             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6039             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6040             88  AT-BENEFICIARY-TRL           VALUE +91.
  6041             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6042             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6043             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6044             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6045
  6046     12  AT-TRAILER-TYPE                 PIC X.
  6047         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6048         88  PAYMENT-TR                       VALUE '2'.
  6049         88  AUTO-PAY-TR                      VALUE '3'.
  6050         88  CORRESPONDENCE-TR                VALUE '4'.
  6051         88  ADDRESS-TR                       VALUE '5'.
  6052         88  GENERAL-INFO-TR                  VALUE '6'.
  6053         88  AUTO-PROMPT-TR                   VALUE '7'.
  6054         88  DENIAL-TR                        VALUE '8'.
  6055         88  INCURRED-CHG-TR                  VALUE '9'.
  6056         88  FORM-CONTROL-TR                  VALUE 'A'.
  6057
  6058     12  AT-RECORDED-DT                  PIC XX.
  6059     12  AT-RECORDED-BY                  PIC X(4).
  6060     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6061
  6062     12  AT-TRAILER-BODY                 PIC X(165).
  6063
  6064     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6065         16  AT-RESERVE-CONTROLS.
  6066             20  AT-MANUAL-SW            PIC X.
  6067                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6068             20  AT-FUTURE-SW            PIC X.
  6069                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6070             20  AT-PTC-SW               PIC X.
  6071                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6072             20  AT-IBNR-SW              PIC X.
  6073                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6074             20  AT-PTC-LF-SW            PIC X.
  6075                 88  AT-LF-PTC-USED          VALUE '1'.
  6076             20  AT-CDT-ACCESS-METHOD    PIC X.
  6077                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6078                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6079                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6080             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6081         16  AT-LAST-COMPUTED-DT         PIC XX.
  6082         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6083         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6084         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 114
* EL156.cbl
  6085         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6086         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6087         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6088         16  AT-EXPENSE-CONTROLS.
  6089             20  AT-EXPENSE-METHOD       PIC X.
  6090                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6091                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6092                 88  PERCENT-OF-PMT           VALUE '3'.
  6093                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6094             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6095             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6096         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6097         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6098
  6099         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6100         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6101
  6102*        16  FILLER                      PIC X(53).
  6103         16  FILLER                      PIC X(47).
  6104
  6105         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6106         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6107
  6108         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6109             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6110             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6111*                    C = CLOSED
  6112*                    O = OPEN
  6113             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6114*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6115
  6116     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6117         16  AT-PAYMENT-TYPE             PIC X.
  6118             88  PARTIAL-PAYMENT                VALUE '1'.
  6119             88  FINAL-PAYMENT                  VALUE '2'.
  6120             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6121             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6122             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6123             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6124             88  VOIDED-PAYMENT                 VALUE '9'.
  6125             88  TRANSFER                       VALUE 'T'.
  6126             88  LIFE-INTEREST                  VALUE 'I'.
  6127
  6128         16  AT-CLAIM-TYPE               PIC X.
  6129             88  PAID-FOR-AH                    VALUE 'A'.
  6130             88  PAID-FOR-LIFE                  VALUE 'L'.
  6131             88  PAID-FOR-IUI                   VALUE 'I'.
  6132             88  PAID-FOR-GAP                   VALUE 'G'.
  6133             88  PAID-FOR-FAM                   VALUE 'F'.
  6134         16  AT-CLAIM-PREM-TYPE          PIC X.
  6135             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6136             88  AT-O-B-COVERAGE                VALUE '2'.
  6137             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6138         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6139         16  AT-CHECK-NO                 PIC X(7).
  6140         16  AT-PAID-FROM-DT             PIC XX.
  6141         16  AT-PAID-THRU-DT             PIC XX.
  6142         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 115
* EL156.cbl
  6143         16  AT-ACH-PAYMENT              PIC X.
  6144*        16  FILLER                      PIC X.
  6145         16  AT-PAYEES-NAME              PIC X(30).
  6146         16  AT-PAYMENT-ORIGIN           PIC X.
  6147             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6148             88  ONLINE-AUTO-PMT                VALUE '2'.
  6149             88  OFFLINE-PMT                    VALUE '3'.
  6150         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6151         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6152         16  AT-VOID-DATA.
  6153             20  AT-VOID-DT              PIC XX.
  6154*00144       20  AT-VOID-REASON          PIC X(30).
  6155             20  AT-VOID-REASON          PIC X(26).
  6156         16  AT-PMT-APPROVED-BY          PIC X(04).
  6157         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6158         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6159         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6160                                         PIC S99V9(5)  COMP-3.
  6161         16  AT-CREDIT-INTERFACE.
  6162             20  AT-PMT-SELECT-DT        PIC XX.
  6163                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6164             20  AT-PMT-ACCEPT-DT        PIC XX.
  6165                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6166             20  AT-VOID-SELECT-DT       PIC XX.
  6167                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6168             20  AT-VOID-ACCEPT-DT       PIC XX.
  6169                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6170
  6171         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6172                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6173                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6174         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6175
  6176         16  AT-FORCE-CONTROL            PIC X.
  6177             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6178         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6179         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6180         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6181         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6182         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6183         16  AT-BENEFIT-TYPE             PIC X.
  6184
  6185         16  AT-EXPENSE-TYPE             PIC X.
  6186         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6187
  6188         16  AT-PAYEE-TYPE-CD.
  6189             20  AT-PAYEE-TYPE           PIC X.
  6190                 88  INSURED-PAID           VALUE 'I'.
  6191                 88  BENEFICIARY-PAID       VALUE 'B'.
  6192                 88  ACCOUNT-PAID           VALUE 'A'.
  6193                 88  OTHER-1-PAID           VALUE 'O'.
  6194                 88  OTHER-2-PAID           VALUE 'Q'.
  6195                 88  DOCTOR-PAID            VALUE 'P'.
  6196                 88  EMPLOYER-PAID          VALUE 'E'.
  6197             20  AT-PAYEE-SEQ            PIC X.
  6198
  6199         16  AT-CASH-PAYMENT             PIC X.
  6200         16  AT-GROUPED-PAYMENT          PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 116
* EL156.cbl
  6201         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6202         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6203         16  AT-APPROVED-LEVEL           PIC X.
  6204         16  AT-VOID-TYPE                PIC X.
  6205             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6206             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6207         16  AT-AIG-UNEMP-IND            PIC X.
  6208             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6209         16  AT-ASSOCIATES               PIC X.
  6210             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6211             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6212
  6213         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6214         16  AT-CV-PMT-CODE              PIC X.
  6215             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6216             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6217             88  FULL-ADD-PAYMENT           VALUE '3'.
  6218             88  HALF-ADD-PAYMENT           VALUE '4'.
  6219             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6220             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6221             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6222             88  ADDL-PAYMENT               VALUE '8'.
  6223
  6224         16  AT-EOB-CODE1                PIC XXX.
  6225         16  AT-EOB-CODE2                PIC XXX.
  6226         16  AT-EOB-CODE3                PIC XXX.
  6227         16  FILLER REDEFINES AT-EOB-CODE3.
  6228             20  AT-PRINT-CLM-FORM       PIC X.
  6229             20  AT-PRINT-SURVEY         PIC X.
  6230             20  AT-SPECIAL-RELEASE      PIC X.
  6231         16  AT-EOB-CODE4                PIC XXX.
  6232         16  FILLER REDEFINES AT-EOB-CODE4.
  6233             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6234             20  FILLER                  PIC X.
  6235         16  AT-EOB-CODE5                PIC XXX.
  6236         16  FILLER REDEFINES AT-EOB-CODE5.
  6237             20  AT-PMT-PROOF-DT         PIC XX.
  6238             20  FILLER                  PIC X.
  6239
  6240         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6241             88  AT-PRINT-EOB            VALUE 'Y'.
  6242
  6243         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6244         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6245
  6246     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6247         16  AT-SCHEDULE-START-DT        PIC XX.
  6248         16  AT-SCHEDULE-END-DT          PIC XX.
  6249         16  AT-TERMINATED-DT            PIC XX.
  6250         16  AT-LAST-PMT-TYPE            PIC X.
  6251             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6252             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6253         16  AT-FIRST-PMT-DATA.
  6254             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6255             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6256             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6257         16  AT-REGULAR-PMT-DATA.
  6258             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 117
* EL156.cbl
  6259             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6260             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6261         16  AT-AUTO-PAYEE-CD.
  6262             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6263                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6264                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6265                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6266                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6267                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6268             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6269         16  AT-AUTO-PAY-DAY             PIC 99.
  6270         16  AT-AUTO-CASH                PIC X.
  6271             88  AT-CASH                      VALUE 'Y'.
  6272             88  AT-NON-CASH                  VALUE 'N'.
  6273*        16  FILLER                      PIC X(129).
  6274         16  AT-AUTO-END-LETTER          PIC X(4).
  6275         16  FILLER                      PIC X(125).
  6276
  6277         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6278         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6279
  6280     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6281         16  AT-LETTER-SENT-DT           PIC XX.
  6282         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6283         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6284         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6285         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6286         16  AT-LETTER-ORIGIN            PIC X.
  6287             88  ONLINE-CREATION              VALUE '1' '3'.
  6288             88  OFFLINE-CREATION             VALUE '2' '4'.
  6289             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6290             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6291         16  AT-STD-LETTER-FORM          PIC X(4).
  6292         16  AT-REASON-TEXT              PIC X(70).
  6293         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6294         16  AT-ADDRESEE-TYPE            PIC X.
  6295              88  INSURED-ADDRESEE            VALUE 'I'.
  6296              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6297              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6298              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6299              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6300              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6301              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6302         16  AT-ADDRESSEE-NAME           PIC X(30).
  6303         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6304         16  AT-RESEND-PRINT-DATE        PIC XX.
  6305         16  AT-CORR-SOL-UNSOL           PIC X.
  6306         16  AT-LETTER-PURGED-DT         PIC XX.
  6307*
  6308*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6309*
  6310         16  AT-CSO-REDEFINITION.
  6311             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6312             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6313             20  AT-LETTER-TO-BENE       PIC X(1).
  6314             20  AT-STOP-LETTER-DT       PIC X(2).
  6315             20  AT-AUTH-RCVD            PIC X(1).
  6316             20  FILLER                  PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 118
* EL156.cbl
  6317*             20  FILLER                  PIC X(27).
  6318             20  AT-CSO-LETTER-STATUS    PIC X.
  6319                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6320                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6321                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6322             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6323             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6324*
  6325*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6326*
  6327*        16  FILLER                      PIC X(26).
  6328*
  6329*        16  AT-DMD-BSR-CODE             PIC X.
  6330*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6331*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6332*
  6333*        16  AT-DMD-LETTER-STATUS        PIC X.
  6334*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6335*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6336*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6337*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6338*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6339
  6340         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6341         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6342
  6343     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6344         16  AT-ADDRESS-TYPE             PIC X.
  6345             88  INSURED-ADDRESS               VALUE 'I'.
  6346             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6347             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6348             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6349             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6350             88  OTHER-ADDRESS-1               VALUE 'O'.
  6351             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6352         16  AT-MAIL-TO-NAME             PIC X(30).
  6353         16  AT-ADDRESS-LINE-1           PIC X(30).
  6354         16  AT-ADDRESS-LINE-2           PIC X(30).
  6355         16  AT-CITY-STATE.
  6356             20  AT-CITY                 PIC X(28).
  6357             20  AT-STATE                PIC XX.
  6358         16  AT-ZIP.
  6359             20  AT-ZIP-CODE.
  6360                 24  AT-ZIP-1ST          PIC X.
  6361                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6362                 24  FILLER              PIC X(4).
  6363             20  AT-ZIP-PLUS4            PIC X(4).
  6364         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6365             20  AT-CAN-POSTAL-1         PIC XXX.
  6366             20  AT-CAN-POSTAL-2         PIC XXX.
  6367             20  FILLER                  PIC XXX.
  6368         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6369*         16  FILLER                      PIC X(23).
  6370         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6371         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6372         16  FILLER                      PIC X(13).
  6373         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6374         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 119
* EL156.cbl
  6375
  6376     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6377         16  AT-INFO-LINE-1              PIC X(60).
  6378         16  FILLER REDEFINES AT-INFO-LINE-1.
  6379             20  AT-NOTE-ERROR-NO OCCURS 15
  6380                                         PIC X(4).
  6381         16  AT-INFO-LINE-2              PIC X(60).
  6382         16  FILLER REDEFINES AT-INFO-LINE-2.
  6383             20  AT-ICD-CODE-1           PIC X(8).
  6384             20  AT-ICD-CODE-2           PIC X(8).
  6385             20  FILLER                  PIC X(44).
  6386         16  AT-INFO-TRAILER-TYPE        PIC X.
  6387             88  AT-ERRORS-NOTE          VALUE 'E'.
  6388             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6389             88  AT-CALL-NOTE            VALUE 'C'.
  6390             88  AT-MAINT-NOTE           VALUE 'M'.
  6391             88  AT-CERT-CHANGE          VALUE 'X'.
  6392             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6393             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6394             88  AT-CERT-CANCELLED       VALUE 'T'.
  6395         16  AT-CALL-TYPE                PIC X.
  6396             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6397             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6398         16  AT-NOTE-CONTINUATION        PIC X.
  6399             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6400         16  AT-EOB-CODES-EXIST          PIC X.
  6401             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6402         16  FILLER                      PIC X(35).
  6403         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6404         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6405
  6406     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6407         16  AT-PROMPT-LINE-1            PIC X(60).
  6408         16  AT-PROMPT-LINE-2            PIC X(60).
  6409         16  AT-PROMPT-START-DT          PIC XX.
  6410         16  AT-PROMPT-END-DT            PIC XX.
  6411         16  FILLER                      PIC X(35).
  6412         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6413         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6414
  6415     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6416         16  AT-DENIAL-INFO-1            PIC X(60).
  6417         16  AT-DENIAL-INFO-2            PIC X(60).
  6418         16  AT-DENIAL-DT                PIC XX.
  6419         16  AT-RETRACTION-DT            PIC XX.
  6420         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6421*         16  FILLER                      PIC X(31).
  6422         16  AT-DENIAL-PROOF-DT          PIC XX.
  6423         16  FILLER                      PIC X(29).
  6424         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6425         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6426
  6427     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6428         16  AT-OLD-INCURRED-DT          PIC XX.
  6429         16  AT-OLD-REPORTED-DT          PIC XX.
  6430         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6431         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6432         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 120
* EL156.cbl
  6433         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6434         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6435         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6436         16  FILLER                      PIC X(26).
  6437         16  AT-OLD-DIAG-CODE            PIC X(6).
  6438         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6439         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6440         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6441         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6442         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6443         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6444         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6445         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6446         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6447         16  FILLER                      PIC X(9).
  6448         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6449
  6450     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6451         16  AT-FORM-SEND-ON-DT          PIC XX.
  6452         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6453         16  AT-FORM-RE-SEND-DT          PIC XX.
  6454         16  AT-FORM-ANSWERED-DT         PIC XX.
  6455         16  AT-FORM-PRINTED-DT          PIC XX.
  6456         16  AT-FORM-REPRINT-DT          PIC XX.
  6457         16  AT-FORM-TYPE                PIC X.
  6458             88  INITIAL-FORM                  VALUE '1'.
  6459             88  PROGRESS-FORM                 VALUE '2'.
  6460         16  AT-INSTRUCT-LN-1            PIC X(28).
  6461         16  AT-INSTRUCT-LN-2            PIC X(28).
  6462         16  AT-INSTRUCT-LN-3            PIC X(28).
  6463         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6464         16  AT-FORM-ADDRESS             PIC X.
  6465             88  FORM-TO-INSURED              VALUE 'I'.
  6466             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6467             88  FORM-TO-OTHER-1              VALUE 'O'.
  6468             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6469         16  AT-RELATED-1.
  6470             20 AT-REL-CARR-1            PIC X.
  6471             20 AT-REL-CLAIM-1           PIC X(7).
  6472             20 AT-REL-CERT-1            PIC X(11).
  6473         16  AT-RELATED-2.
  6474             20 AT-REL-CARR-2            PIC X.
  6475             20 AT-REL-CLAIM-2           PIC X(7).
  6476             20 AT-REL-CERT-2            PIC X(11).
  6477         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6478         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6479         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6480         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6481         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6482         16  AT-STOP-FORM-DT             PIC X(2).
  6483
  6484         16  FILLER                      PIC X(09).
  6485         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6486         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6487******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 121
* EL156.cbl
  6489*    COPY ELCACTQ.
  6490******************************************************************
  6491*                                                                *
  6492*                            ELCACTQ.                            *
  6493*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6494*                            VMOD=2.004                          *
  6495*                                                                *
  6496*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6497*                                                                *
  6498*   FILE TYPE = VSAM,KSDS                                        *
  6499*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6500*                                                                *
  6501*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6502*       ALTERNATE INDEX = NONE                                   *
  6503*                                                                *
  6504*   LOG = YES                                                    *
  6505*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6506*                                                                *
  6507*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6508******************************************************************
  6509
  6510 01  ACTIVITY-QUE.
  6511     12  AQ-RECORD-ID                PIC XX.
  6512         88  VALID-AQ-ID                VALUE 'AQ'.
  6513
  6514     12  AQ-CONTROL-PRIMARY.
  6515         16  AQ-COMPANY-CD           PIC X.
  6516         16  AQ-CARRIER              PIC X.
  6517         16  AQ-CLAIM-NO             PIC X(7).
  6518         16  AQ-CERT-NO.
  6519             20  AQ-CERT-PRIME       PIC X(10).
  6520             20  AQ-CERT-SFX         PIC X.
  6521
  6522     12  AQ-PENDING-ACTIVITY-FLAGS.
  6523         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6524         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6525             88  PENDING-PAYMENTS       VALUE '1'.
  6526         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6527             88  PENDING-FULL-PRINT     VALUE '1'.
  6528             88  PENDING-PART-PRINT     VALUE '2'.
  6529         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6530             88  PENDING-LETTERS        VALUE '1'.
  6531         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6532             88  PENDING-RESTORE        VALUE 'C'.
  6533             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6534
  6535     12  FILLER                      PIC X(20).
  6536
  6537     12  AQ-RESEND-DATE              PIC XX.
  6538     12  AQ-FOLLOWUP-DATE            PIC XX.
  6539     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6540     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6541     12  AQ-AUTO-LETTER              PIC X(4).
  6542     12  FILLER                      PIC XX.
  6543     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6544*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 122
* EL156.cbl
  6546*    COPY ERCACCT.
  6547******************************************************************
  6548*                                                                *
  6549*                                                                *
  6550*                            ERCACCT                             *
  6551*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6552*                            VMOD=2.031                          *
  6553*                                                                *
  6554*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6555*                                                                *
  6556*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6557*   VSAM ACCOUNT MASTER FILES.                                   *
  6558*                                                                *
  6559*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6560*                                                                *
  6561*   FILE TYPE = VSAM,KSDS                                        *
  6562*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6563*                                                                *
  6564*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6565*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6566*                                                                *
  6567*   LOG = NO                                                     *
  6568*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6569*                                                                *
  6570*                                                                *
  6571******************************************************************
  6572*                   C H A N G E   L O G
  6573*
  6574* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6575*-----------------------------------------------------------------
  6576*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6577* EFFECTIVE    NUMBER
  6578*-----------------------------------------------------------------
  6579* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6580* 092705    2005050300006  PEMA  ADD SPP LEASES
  6581* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6582* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6583* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6584* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6585* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6586* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6587******************************************************************
  6588
  6589 01  ACCOUNT-MASTER.
  6590     12  AM-RECORD-ID                      PIC XX.
  6591         88  VALID-AM-ID                      VALUE 'AM'.
  6592
  6593     12  AM-CONTROL-PRIMARY.
  6594         16  AM-COMPANY-CD                 PIC X.
  6595         16  AM-MSTR-CNTRL.
  6596             20  AM-CONTROL-A.
  6597                 24  AM-CARRIER            PIC X.
  6598                 24  AM-GROUPING.
  6599                     28 AM-GROUPING-PREFIX PIC XXX.
  6600                     28 AM-GROUPING-PRIME  PIC XXX.
  6601                 24  AM-STATE              PIC XX.
  6602                 24  AM-ACCOUNT.
  6603                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 123
* EL156.cbl
  6604                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6605             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6606                                           PIC X(19).
  6607             20  AM-CNTRL-B.
  6608                 24  AM-EXPIRATION-DT      PIC XX.
  6609                 24  FILLER                PIC X(4).
  6610             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6611                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6612
  6613     12  AM-CONTROL-BY-VAR-GRP.
  6614         16  AM-COMPANY-CD-A1              PIC X.
  6615         16  AM-VG-CARRIER                 PIC X.
  6616         16  AM-VG-GROUPING                PIC X(6).
  6617         16  AM-VG-STATE                   PIC XX.
  6618         16  AM-VG-ACCOUNT                 PIC X(10).
  6619         16  AM-VG-DATE.
  6620             20  AM-VG-EXPIRATION-DT       PIC XX.
  6621             20  FILLER                    PIC X(4).
  6622         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6623                                           PIC 9(11)      COMP-3.
  6624     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6625         16  FILLER                        PIC X(10).
  6626         16  AM-VG-KEY3.
  6627             20  AM-VG3-ACCOUNT            PIC X(10).
  6628             20  AM-VG3-EXP-DT             PIC XX.
  6629         16  FILLER                        PIC X(4).
  6630     12  AM-MAINT-INFORMATION.
  6631         16  AM-LAST-MAINT-DT              PIC XX.
  6632         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6633         16  AM-LAST-MAINT-USER            PIC X(4).
  6634         16  FILLER                        PIC XX.
  6635
  6636     12  AM-EFFECTIVE-DT                   PIC XX.
  6637     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6638
  6639     12  AM-PREV-DATES  COMP-3.
  6640         16  AM-PREV-EXP-DT                PIC 9(11).
  6641         16  AM-PREV-EFF-DT                PIC 9(11).
  6642
  6643     12  AM-REPORT-CODE-1                  PIC X(10).
  6644     12  AM-REPORT-CODE-2                  PIC X(10).
  6645
  6646     12  AM-CITY-CODE                      PIC X(4).
  6647     12  AM-COUNTY-PARISH                  PIC X(6).
  6648
  6649     12  AM-NAME                           PIC X(30).
  6650     12  AM-PERSON                         PIC X(30).
  6651     12  AM-ADDRS                          PIC X(30).
  6652     12  AM-CITY.
  6653         16  AM-ADDR-CITY                  PIC X(28).
  6654         16  AM-ADDR-STATE                 PIC XX.
  6655     12  AM-ZIP.
  6656         16  AM-ZIP-PRIME.
  6657             20  AM-ZIP-PRI-1ST            PIC X.
  6658                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6659             20  FILLER                    PIC X(4).
  6660         16  AM-ZIP-PLUS4                  PIC X(4).
  6661     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 124
* EL156.cbl
  6662         16  AM-CAN-POSTAL-1               PIC XXX.
  6663         16  AM-CAN-POSTAL-2               PIC XXX.
  6664         16  FILLER                        PIC XXX.
  6665     12  AM-TEL-NO.
  6666         16  AM-AREA-CODE                  PIC 999.
  6667         16  AM-TEL-PRE                    PIC 999.
  6668         16  AM-TEL-NBR                    PIC 9(4).
  6669     12  AM-TEL-LOC                        PIC X.
  6670         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6671         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6672
  6673     12  AM-COMM-STRUCTURE.
  6674         16  AM-DEFN-1.
  6675             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6676                 24  AM-AGT.
  6677                     28  AM-AGT-PREFIX     PIC X(4).
  6678                     28  AM-AGT-PRIME      PIC X(6).
  6679                 24  AM-COM-TYP            PIC X.
  6680                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6681                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6682                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6683                 24  AM-RECALC-LV-INDIC    PIC X.
  6684                 24  AM-RETRO-LV-INDIC     PIC X.
  6685                 24  AM-GL-CODES           PIC X.
  6686                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6687                 24  FILLER                PIC X(01).
  6688         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6689             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6690                 24  FILLER                PIC X(11).
  6691                 24  AM-L-COMA             PIC XXX.
  6692                 24  AM-J-COMA             PIC XXX.
  6693                 24  AM-A-COMA             PIC XXX.
  6694                 24  FILLER                PIC X(6).
  6695
  6696     12  AM-COMM-CHANGE-STATUS             PIC X.
  6697         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6698
  6699     12  AM-CSR-CODE                       PIC X(4).
  6700
  6701     12  AM-BILLING-STATUS                 PIC X.
  6702         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6703         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6704     12  AM-AUTO-REFUND-SW                 PIC X.
  6705         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6706         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6707     12  AM-GPCD                           PIC 99.
  6708     12  AM-IG                             PIC X.
  6709         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6710         88  AM-HAS-GROUP                     VALUE '2'.
  6711     12  AM-STATUS                         PIC X.
  6712         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6713         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6714         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6715         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6716         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6717         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6718         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6719         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 125
* EL156.cbl
  6720         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6721         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6722     12  AM-REMIT-TO                       PIC 99.
  6723     12  AM-ID-NO                          PIC X(11).
  6724
  6725     12  AM-CAL-TABLE                      PIC XX.
  6726     12  AM-LF-DEVIATION                   PIC XXX.
  6727     12  AM-AH-DEVIATION                   PIC XXX.
  6728     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6729     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6730     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6731     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6732     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6733     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6734
  6735     12  AM-USER-FIELDS.
  6736         16  AM-FLD-1                      PIC XX.
  6737         16  AM-FLD-2                      PIC XX.
  6738         16  AM-FLD-3                      PIC XX.
  6739         16  AM-FLD-4                      PIC XX.
  6740         16  AM-FLD-5                      PIC XX.
  6741
  6742     12  AM-1ST-PROD-DATE.
  6743         16  AM-1ST-PROD-YR                PIC XX.
  6744         16  AM-1ST-PROD-MO                PIC XX.
  6745         16  AM-1ST-PROD-DA                PIC XX.
  6746     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6747     12  AM-CERTS-PURGED-DATE.
  6748         16  AM-PUR-YR                     PIC XX.
  6749         16  AM-PUR-MO                     PIC XX.
  6750         16  AM-PUR-DA                     PIC XX.
  6751     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6752     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6753     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6754     12  AM-INACTIVE-DATE.
  6755         16  AM-INA-MO                     PIC 99.
  6756         16  AM-INA-DA                     PIC 99.
  6757         16  AM-INA-YR                     PIC 99.
  6758     12  AM-AR-HI-CERT-DATE                PIC XX.
  6759
  6760     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6761     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6762
  6763     12  AM-OB-PAYMENT-MODE                PIC X.
  6764         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6765         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6766         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6767         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6768
  6769     12  AM-AH-ONLY-INDICATOR              PIC X.
  6770         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6771         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6772
  6773     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6774
  6775     12  AM-OVER-SHORT.
  6776         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6777         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 126
* EL156.cbl
  6778
  6779     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6780     12  AM-DCC-CLP-STATE                  PIC XX.
  6781
  6782     12  AM-RECALC-COMM                    PIC X.
  6783     12  AM-RECALC-REIN                    PIC X.
  6784
  6785     12  AM-REI-TABLE                      PIC XXX.
  6786     12  AM-REI-ET-LF                      PIC X.
  6787     12  AM-REI-ET-AH                      PIC X.
  6788     12  AM-REI-PE-LF                      PIC X.
  6789     12  AM-REI-PE-AH                      PIC X.
  6790     12  AM-REI-PRT-ST                     PIC X.
  6791     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6792     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6793     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6794     12  AM-REI-GROUP-A                    PIC X(6).
  6795     12  AM-REI-MORT                       PIC X(4).
  6796     12  AM-REI-PRT-OW                     PIC X.
  6797     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6798     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6799     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6800     12  AM-REI-GROUP-B                    PIC X(6).
  6801
  6802     12  AM-TRUST-TYPE                     PIC X(2).
  6803
  6804     12  AM-EMPLOYER-STMT-USED             PIC X.
  6805     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6806
  6807     12  AM-STD-AH-TYPE                    PIC XX.
  6808     12  AM-EARN-METHODS.
  6809         16  AM-EARN-METHOD-R              PIC X.
  6810             88 AM-REF-RL-R78                 VALUE 'R'.
  6811             88 AM-REF-RL-PR                  VALUE 'P'.
  6812             88 AM-REF-RL-MEAN                VALUE 'M'.
  6813             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6814         16  AM-EARN-METHOD-L              PIC X.
  6815             88 AM-REF-LL-R78                 VALUE 'R'.
  6816             88 AM-REF-LL-PR                  VALUE 'P'.
  6817             88 AM-REF-LL-MEAN                VALUE 'M'.
  6818             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6819         16  AM-EARN-METHOD-A              PIC X.
  6820             88 AM-REF-AH-R78                 VALUE 'R'.
  6821             88 AM-REF-AH-PR                  VALUE 'P'.
  6822             88 AM-REF-AH-MEAN                VALUE 'M'.
  6823             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6824             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6825             88 AM-REF-AH-NET                 VALUE 'N'.
  6826
  6827     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6828     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6829     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6830
  6831     12  AM-RET-Y-N                        PIC X.
  6832     12  AM-RET-P-E                        PIC X.
  6833     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6834     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6835     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 127
* EL156.cbl
  6836     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6837         16  AM-POOL-PRIME                 PIC XXX.
  6838         16  AM-POOL-SUB                   PIC XXX.
  6839     12  AM-RETRO-EARNINGS.
  6840         16  AM-RET-EARN-R                 PIC X.
  6841         16  AM-RET-EARN-L                 PIC X.
  6842         16  AM-RET-EARN-A                 PIC X.
  6843     12  AM-RET-ST-TAX-USE                 PIC X.
  6844         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6845         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6846     12  AM-RETRO-BEG-EARNINGS.
  6847         16  AM-RET-BEG-EARN-R             PIC X.
  6848         16  AM-RET-BEG-EARN-L             PIC X.
  6849         16  AM-RET-BEG-EARN-A             PIC X.
  6850     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6851     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6852
  6853     12  AM-USER-SELECT-OPTIONS.
  6854         16  AM-USER-SELECT-1              PIC X(10).
  6855         16  AM-USER-SELECT-2              PIC X(10).
  6856         16  AM-USER-SELECT-3              PIC X(10).
  6857         16  AM-USER-SELECT-4              PIC X(10).
  6858         16  AM-USER-SELECT-5              PIC X(10).
  6859
  6860     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6861
  6862     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6863
  6864     12  AM-RPT045A-SWITCH                 PIC X.
  6865         88  RPT045A-OFF                   VALUE 'N'.
  6866
  6867     12  AM-INSURANCE-LIMITS.
  6868         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6869         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6870
  6871     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6872         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6873
  6874     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6875         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6876         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6877
  6878     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6879
  6880     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6881     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6882     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6883     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6884     12  AM-DCC-UEF-STATE                  PIC XX.
  6885     12  FILLER                            PIC XXX.
  6886     12  AM-REPORT-CODE-3                  PIC X(10).
  6887*    12  FILLER                            PIC X(22).
  6888
  6889     12  AM-RESERVE-DATE.
  6890         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6891         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6892         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6893
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 128
* EL156.cbl
  6894     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6895     12  AM-NOTIFICATION-TYPES.
  6896         16  AM-NOTIF-OF-LETTERS           PIC X.
  6897         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6898         16  AM-NOTIF-OF-REPORTS           PIC X.
  6899         16  AM-NOTIF-OF-STATUS            PIC X.
  6900
  6901     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6902         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6903         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6904         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6905         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6906
  6907     12  AM-BENEFIT-CONTROLS.
  6908         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6909             20  AM-BENEFIT-CODE           PIC XX.
  6910             20  AM-BENEFIT-TYPE           PIC X.
  6911             20  AM-BENEFIT-REVISION       PIC XXX.
  6912             20  AM-BENEFIT-REM-TERM       PIC X.
  6913             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6914             20  FILLER                    PIC XX.
  6915         16  FILLER                        PIC X(80).
  6916
  6917     12  AM-TRANSFER-DATA.
  6918         16  AM-TRANSFERRED-FROM.
  6919             20  AM-TRNFROM-CARRIER        PIC X.
  6920             20  AM-TRNFROM-GROUPING.
  6921                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6922                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6923             20  AM-TRNFROM-STATE          PIC XX.
  6924             20  AM-TRNFROM-ACCOUNT.
  6925                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6926                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6927             20  AM-TRNFROM-DTE            PIC XX.
  6928         16  AM-TRANSFERRED-TO.
  6929             20  AM-TRNTO-CARRIER          PIC X.
  6930             20  AM-TRNTO-GROUPING.
  6931                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6932                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6933             20  AM-TRNTO-STATE            PIC XX.
  6934             20  AM-TRNTO-ACCOUNT.
  6935                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6936                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6937             20  AM-TRNTO-DTE              PIC XX.
  6938         16  FILLER                        PIC X(10).
  6939
  6940     12  AM-SAVED-REMIT-TO                 PIC 99.
  6941
  6942     12  AM-COMM-STRUCTURE-SAVED.
  6943         16  AM-DEFN-1-SAVED.
  6944             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6945                 24  AM-AGT-SV             PIC X(10).
  6946                 24  AM-COM-TYP-SV         PIC X.
  6947                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6948                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6949                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6950                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6951                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 129
* EL156.cbl
  6952                 24  AM-GL-CODES-SV        PIC X.
  6953                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6954                 24  FILLER                PIC X.
  6955         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6956             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6957                 24  FILLER                PIC X(11).
  6958                 24  AM-L-COMA-SV          PIC XXX.
  6959                 24  AM-J-COMA-SV          PIC XXX.
  6960                 24  AM-A-COMA-SV          PIC XXX.
  6961                 24  FILLER                PIC X(6).
  6962
  6963     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6964         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6965            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6966            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6967            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6968
  6969     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6970     12  FILLER                            PIC X(120).
  6971
  6972     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6973         16  AM-CONTROL-NAME               PIC X(30).
  6974         16  AM-EXECUTIVE-ONE.
  6975             20  AM-EXEC1-NAME             PIC X(15).
  6976             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6977                                                          COMP-3.
  6978             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6979                                                          COMP-3.
  6980         16  AM-EXECUTIVE-TWO.
  6981             20  AM-EXEC2-NAME             PIC X(15).
  6982             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6983                                                          COMP-3.
  6984             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6985                                                          COMP-3.
  6986
  6987     12  AM-RETRO-ADDITIONAL-DATA.
  6988         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6989         16  AM-RETRO-PREM-P-E             PIC X.
  6990         16  AM-RETRO-CLMS-P-I             PIC X.
  6991         16  AM-RETRO-RET-BRACKET-LF.
  6992             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6993                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6994                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6995             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6996                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6997                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6998             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6999                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7000                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7001         16  AM-RETRO-RET-BRACKET-AH.
  7002             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7003                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7004                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7005                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7006             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7007                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7008                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7009             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 130
* EL156.cbl
  7010                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7011                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7012
  7013     12  AM-COMMENTS.
  7014         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7015
  7016     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7017         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7018         16  AM-FLI-BILLING-CODE           PIC X.
  7019         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7020         16  AM-FLI-UNITED-IDENT           PIC X.
  7021         16  AM-FLI-INTEREST-LOST-DATA.
  7022             20  AM-FLI-BANK-NO            PIC X(5).
  7023             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7024             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7025             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7026         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7027             20  AM-FLI-AGT                PIC X(9).
  7028             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7029             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7030         16  FILLER                        PIC X(102).
  7031
  7032     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7033         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7034             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7035             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7036             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7037             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7038             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7039         16  FILLER                          PIC X(10).
  7040******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 131
* EL156.cbl
  7042*    COPY ELCCHKQ.
  7043******************************************************************
  7044*                                                                *
  7045*                                                                *
  7046*                            ELCCHKQ.                            *
  7047*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7048*                            VMOD=2.007                          *
  7049*                                                                *
  7050*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7051*                                                                *
  7052*   FILE TYPE = VSAM,KSDS                                        *
  7053*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7054*                                                                *
  7055*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7056*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7057*                                                                *
  7058*   LOG = YES                                                    *
  7059*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7060******************************************************************
  7061 01  CHECK-QUE.
  7062     12  CQ-RECORD-ID                PIC XX.
  7063         88  VALID-CQ-ID         VALUE 'CQ'.
  7064
  7065     12  CQ-CONTROL-PRIMARY.
  7066         16  CQ-COMPANY-CD           PIC X.
  7067         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7068         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7069
  7070     12  CQ-CONTROL-BY-PAYEE.
  7071         16  CQ-CONTROL-BY-NUMBER.
  7072             20  CQ-COMPANY-CD-A1     PIC X.
  7073             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7074         16  CQ-PAYEE-CARRIER        PIC X.
  7075         16  CQ-PAYEE-GROUPING       PIC X(6).
  7076         16  CQ-PAYEE-STATE          PIC XX.
  7077         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7078         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7079
  7080     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7081         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7082         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7083         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7084         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7085         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7086         16  FILLER                  PIC X(3).
  7087
  7088     12  CQ-ENTRY-TYPE               PIC X.
  7089             88  CHECK-ON-QUE           VALUE 'Q'.
  7090             88  ALIGNMENT-CHECK        VALUE 'A'.
  7091             88  SPOILED-CHECK          VALUE 'S'.
  7092             88  PAYMENT-ABORTED        VALUE 'X'.
  7093
  7094     12  CQ-CLAIM-MAST-CNTL.
  7095         16  CQ-CARRIER              PIC X.
  7096         16  CQ-CLAIM-NO             PIC X(7).
  7097         16  CQ-CERT-NO.
  7098             20  CQ-CERT-PRIME       PIC X(10).
  7099             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 132
* EL156.cbl
  7100         16  CQ-CLAIM-TYPE           PIC X.
  7101             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7102             88  CQ-AH-CLAIM            VALUE 'A'.
  7103         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7104             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7105             88  CQ-O-B-COVERAGE        VALUE '2'.
  7106             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7107
  7108     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7109     12  CQ-CHECK-NUMBER             PIC X(7).
  7110     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7111     12  CQ-PAYMENT-TYPE             PIC X.
  7112             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7113             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7114             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7115             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7116             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7117             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7118             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7119             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7120     12  CQ-VOID-INDICATOR           PIC X.
  7121             88  CHECK-IS-STOPPED          VALUE 'S'.
  7122             88  CHECK-IS-VOID             VALUE 'V'.
  7123     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7124     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7125     12  CQ-CHECK-BY-USER            PIC X(4).
  7126     12  CQ-PRE-NUMBERING-SW         PIC X.
  7127       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7128       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7129
  7130     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7131     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7132     12  CQ-LEDGER-FLAG              PIC X(01).
  7133     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7134     12  CQ-LAST-UPDATED-DT          PIC XX.
  7135     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7136     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7137
  7138     12  FILLER                      PIC X(04).
  7139
  7140******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 133
* EL156.cbl
  7142*    COPY ELCBENE.
  7143******************************************************************
  7144*                                                                *
  7145*                            ELCBENE.                            *
  7146*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7147*                            VMOD=2.006                          *
  7148*                                                                *
  7149*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7150*                                                                *
  7151*   FILE TYPE = VSAM,KSDS                                        *
  7152*   RECORD SIZE = 500   RECFORM = FIX                            *
  7153*                                                                *
  7154*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7155*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7156*                                                                *
  7157*   LOG = YES                                                    *
  7158*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7159*                                                                *
  7160*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7161******************************************************************
  7162*                   C H A N G E   L O G
  7163*
  7164* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7165*-----------------------------------------------------------------
  7166*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7167* EFFECTIVE    NUMBER
  7168*-----------------------------------------------------------------
  7169* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7170******************************************************************
  7171
  7172 01  BENEFICIARY-MASTER.
  7173     12  BE-RECORD-ID                PIC XX.
  7174         88  VALID-BE-ID                VALUE 'BE'.
  7175
  7176     12  BE-CONTROL-PRIMARY.
  7177         16  BE-COMPANY-CD           PIC X.
  7178         16  BE-RECORD-TYPE          PIC X.
  7179             88  BENEFICIARY-RECORD  VALUE 'B'.
  7180             88  ADJUSTOR-RECORD     VALUE 'A'.
  7181         16  BE-BENEFICIARY          PIC X(10).
  7182     12  BE-CONTROL-BY-NAME.
  7183         16  BE-COMPANY-CD-A1        PIC X.
  7184         16  BE-RECORD-TYPE-A1       PIC X.
  7185         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7186         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7187
  7188     12  BE-LAST-MAINT-DT            PIC XX.
  7189     12  BE-LAST-MAINT-BY            PIC X(4).
  7190     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7191
  7192     12  BE-ADDRESS-DATA.
  7193         16  BE-MAIL-TO-NAME         PIC X(30).
  7194         16  BE-ADDRESS-LINE-1       PIC X(30).
  7195         16  BE-ADDRESS-LINE-2       PIC X(30).
  7196         16  BE-ADDRESS-LINE-3       PIC X(30).
  7197         16  BE-CITY-STATE.
  7198             20  BE-CITY             PIC X(28).
  7199             20  BE-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 134
* EL156.cbl
  7200         16  BE-ZIP-CODE.
  7201             20  BE-ZIP-PRIME.
  7202                 24  BE-ZIP-1ST      PIC X.
  7203                     88  BE-CANADIAN-POST-CODE
  7204                                         VALUE 'A' THRU 'Z'.
  7205                 24  FILLER          PIC X(4).
  7206             20  BE-ZIP-PLUS4        PIC X(4).
  7207         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7208             20  BE-CAN-POSTAL-1     PIC XXX.
  7209             20  BE-CAN-POSTAL-2     PIC XXX.
  7210             20  FILLER              PIC XXX.
  7211         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7212         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7213
  7214******************************************************************
  7215*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7216*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7217******************************************************************
  7218     12  BE-CARRIER                  PIC X.
  7219
  7220     12  BE-ADDRESS-DATA2.
  7221         16  BE-MAIL-TO-NAME2        PIC X(30).
  7222         16  BE-ADDRESS-LINE-12      PIC X(30).
  7223         16  BE-ADDRESS-LINE-22      PIC X(30).
  7224         16  BE-ADDRESS-LINE-32      PIC X(30).
  7225         16  BE-CITY-STATE2.
  7226             20  BE-CITY2            PIC X(28).
  7227             20  BE-STATE2           PIC XX.
  7228         16  BE-ZIP-CODE2.
  7229             20  BE-ZIP-PRIME2.
  7230                 24  BE-ZIP-1ST2     PIC X.
  7231                     88  BE-CANADIAN-POST-CODE2
  7232                                         VALUE 'A' THRU 'Z'.
  7233                 24  FILLER          PIC X(4).
  7234             20  BE-ZIP-PLUS42       PIC X(4).
  7235         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7236             20  BE-CAN-POSTAL-12    PIC XXX.
  7237             20  BE-CAN-POSTAL-22    PIC XXX.
  7238             20  FILLER              PIC XXX.
  7239         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7240         16  BE-ACH-DATA.
  7241             20  BE-ACH-YES-OR-NO    PIC X.
  7242                 88  BE-ON-ACH       VALUE 'Y'.
  7243                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7244             20  BE-ACH-ABA-ROUTING-NUMBER
  7245                                     PIC X(15).
  7246             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7247                                     PIC X(20).
  7248             20  FILLER              PIC X(25).
  7249         16  BE-BILLING-STMT-DATA.
  7250*            20  BE-BSR              PIC X.
  7251*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7252*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7253*            20  BE-BSR-FROM         PIC X(30).
  7254*            20  BE-BSR-DEPT         PIC X(30).
  7255             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7256             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7257             20  BE-OUTPUT-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 135
* EL156.cbl
  7258                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7259                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7260
  7261     12  FILLER                      PIC X(28).
  7262******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 136
* EL156.cbl
  7264*    COPY ELCARCH.
  7265******************************************************************
  7266*                                                                *
  7267*                            ELCARCH.                            *
  7268*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7269*                            VMOD=2.007                          *
  7270*                                                                *
  7271*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7272*                                                                *
  7273*   FILE TYPE = VSAM,KSDS                                        *
  7274*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7275*                                                                *
  7276*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7277*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7278*                                                                *
  7279*   LOG = NO                                                     *
  7280*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7281*                                                                *
  7282*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7283******************************************************************
  7284 01  LETTER-ARCHIVE.
  7285     12  LA-RECORD-ID                PIC XX.
  7286         88  VALID-LA-ID                VALUE 'LA'.
  7287
  7288     12  LA-CONTROL-PRIMARY.
  7289         16  LA-COMPANY-CD           PIC X.
  7290         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7291         16  LA-RECORD-TYPE          PIC X.
  7292             88  LA-HEADER-DATA         VALUE '1'.
  7293             88  LA-ADDRESS-DATA        VALUE '2'.
  7294             88  LA-TEXT-DATA           VALUE '3'.
  7295             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7296         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7297
  7298     12  LA-CONTROL-BY-TYPE.
  7299         16  LA-COMPANY-CD-A1        PIC X.
  7300         16  LA-RECORD-TYPE-A1       PIC X.
  7301         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7302         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7303
  7304     12  LA-TEXT-RECORD.
  7305         16  LA-SKIP-CONTROL         PIC XX.
  7306             88  NO-LINES-SKIPPED       VALUE SPACES.
  7307             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7308         16  LA-TEXT-LINE            PIC X(70).
  7309
  7310     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7311         16  FILLER                  PIC XX.
  7312         16  LA-ADDRESS-LINE         PIC X(30).
  7313         16  FILLER                  PIC X(40).
  7314
  7315     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7316         16  FILLER                  PIC XX.
  7317         16  LA-CARRIER              PIC X.
  7318         16  LA-CLAIM-NO             PIC X(7).
  7319         16  LA-CERT-NO.
  7320             20  LA-CERT-PRIME       PIC X(10).
  7321             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 137
* EL156.cbl
  7322         16  LA-NO-OF-COPIES         PIC S9.
  7323         16  LA-RESEND-DATE          PIC XX.
  7324         16  LA-PROCESSOR-CD         PIC X(4).
  7325         16  LA-CREATION-DT          PIC XX.
  7326         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7327         16  LA-RESEND-PRINT-DATE    PIC XX.
  7328         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7329         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7330*
  7331* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7332*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7333*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7334*   I        20  LA-DMD-RES-ST           PIC XX.
  7335*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7336*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7337*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7338*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7339*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7340*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7341*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7342*   I        20  LA-DMD-UND-CODE         PIC XX.
  7343*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7344*   V    16  FILLER                  PIC X(15).
  7345* -----
  7346*
  7347* REINSERTED  CSO  MODS
  7348*
  7349         16  FILLER.
  7350             20  FILLER                  PIC X(29).
  7351             20  LA-CSO-LETTER-STATUS    PIC X.
  7352                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7353                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7354                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7355             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7356             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7357*
  7358
  7359     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7360         16  FILLER                  PIC XX.
  7361         16  LA4-CARRIER             PIC X.
  7362         16  LA4-CLAIM-NO            PIC X(7).
  7363         16  LA4-CERT-NO.
  7364             20  LA4-CERT-PRIME      PIC X(10).
  7365             20  LA4-CERT-SFX        PIC X.
  7366         16  LA4-NO-OF-COPIES        PIC S9.
  7367         16  LA4-RESEND-DATE         PIC XX.
  7368         16  LA4-PROCESSOR-CD        PIC X(4).
  7369         16  LA4-CREATION-DT         PIC XX.
  7370         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7371         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7372         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7373         16  LA4-FORM-TYPE           PIC X.
  7374             88  LA4-INITIAL-FORM    VALUE '1'.
  7375             88  LA4-PROGRESS-FORM   VALUE '2'.
  7376         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7377         16  LA4-STATE               PIC X(02).
  7378         16  FILLER                  PIC X(31).
  7379******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 138
* EL156.cbl
  7381*    COPY ELCDAR.
  7382******************************************************************
  7383*                                                                *
  7384*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7385*   FILE TYPE = VSAM,KSDS                                        *
  7386*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7387*   BASE CLUSTER = DLYACTV                                       *
  7388*   LOG = YES                                                    *
  7389*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7390*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7391*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7392*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7393*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7394*               BY PROGRAM "LGINFCE".                            *
  7395*                                                                *
  7396******************************************************************
  7397 01  DAILY-ACTIVITY-RECORD.
  7398     05  DA-KEY.
  7399         10  DA-COMP-CD          PIC X.
  7400         10  DA-CARRIER          PIC X.
  7401         10  DA-CLAIM-NO         PIC X(7).
  7402         10  DA-CERT-NO.
  7403             15  DA-CERT-PRIME   PIC X(10).
  7404             15  DA-CERT-SFX     PIC X.
  7405     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7406     05  DA-RECORD-TYPE          PIC X.
  7407     05  FILLER                  PIC X(2).
  7408******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 139
* EL156.cbl
  7410*    COPY ERCCOMP.
  7411******************************************************************
  7412*                                                                *
  7413*                                                                *
  7414*                            ERCCOMP                             *
  7415*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7416*                            VMOD=2.019                          *
  7417*                                                                *
  7418*   ONLINE CREDIT SYSTEM                                         *
  7419*                                                                *
  7420*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7421*                                                                *
  7422*   FILE TYPE = VSAM,KSDS                                        *
  7423*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7424*                                                                *
  7425*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7426*       ALTERNATE PATH = NONE                                    *
  7427*                                                                *
  7428*   LOG = NO                                                     *
  7429*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7430*                                                                *
  7431******************************************************************
  7432*                   C H A N G E   L O G
  7433*
  7434* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7435*-----------------------------------------------------------------
  7436*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7437* EFFECTIVE    NUMBER
  7438*-----------------------------------------------------------------
  7439* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7440* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7441* 092205    2005050300006  PEMA  ADD LEASE FEE
  7442* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7443* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7444* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7445* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7446* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7447* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7448******************************************************************
  7449
  7450 01  COMPENSATION-MASTER.
  7451     12  CO-RECORD-ID                          PIC XX.
  7452         88  VALID-CO-ID                          VALUE 'CO'.
  7453
  7454     12  CO-CONTROL-PRIMARY.
  7455         16  CO-COMPANY-CD                     PIC X.
  7456         16  CO-CONTROL.
  7457             20  CO-CTL-1.
  7458                 24  CO-CARR-GROUP.
  7459                     28  CO-CARRIER            PIC X.
  7460                     28  CO-GROUPING.
  7461                         32  CO-GROUP-PREFIX   PIC XXX.
  7462                         32  CO-GROUP-PRIME    PIC XXX.
  7463                 24  CO-RESP-NO.
  7464                     28  CO-RESP-PREFIX        PIC X(4).
  7465                     28  CO-RESP-PRIME         PIC X(6).
  7466             20  CO-CTL-2.
  7467                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 140
* EL156.cbl
  7468                     28  CO-ACCT-PREFIX        PIC X(4).
  7469                     28  CO-ACCT-PRIME         PIC X(6).
  7470         16  CO-TYPE                           PIC X.
  7471             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7472             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7473             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7474
  7475     12  CO-MAINT-INFORMATION.
  7476         16  CO-LAST-MAINT-DT                  PIC XX.
  7477         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7478         16  CO-LAST-MAINT-USER                PIC X(4).
  7479     12  FILLER                                PIC XX.
  7480     12  CO-STMT-TYPE                          PIC XXX.
  7481     12  CO-COMP-TYPE                          PIC X.
  7482         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7483     12  CO-STMT-OWNER                         PIC X(4).
  7484     12  CO-BALANCE-CONTROL                    PIC X.
  7485         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7486         88  CO-NO-BALANCE                        VALUE 'N'.
  7487
  7488     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7489         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7490         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7491         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7492
  7493     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7494         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7495         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7496
  7497     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7498     12  CO-GA-DIRECT-DEP                      PIC X.
  7499     12  CO-FUTURE-SPACE                       PIC X.
  7500         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7501
  7502     12  CO-ACCT-NAME                          PIC X(30).
  7503     12  CO-MAIL-NAME                          PIC X(30).
  7504     12  CO-ADDR-1                             PIC X(30).
  7505     12  CO-ADDR-2                             PIC X(30).
  7506     12  CO-ADDR-3.
  7507         16  CO-ADDR-CITY                      PIC X(27).
  7508         16  CO-ADDR-STATE                     PIC XX.
  7509     12  CO-CSO-1099                           PIC X.
  7510     12  CO-ZIP.
  7511         16  CO-ZIP-PRIME.
  7512             20  CO-ZIP-PRI-1ST                PIC X.
  7513                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7514             20  FILLER                        PIC X(4).
  7515         16  CO-ZIP-PLUS4                      PIC X(4).
  7516     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7517         16  CO-CAN-POSTAL-1                   PIC XXX.
  7518         16  CO-CAN-POSTAL-2                   PIC XXX.
  7519         16  FILLER                            PIC XXX.
  7520     12  CO-SOC-SEC                            PIC X(13).
  7521     12  CO-TELEPHONE.
  7522         16  CO-AREA-CODE                      PIC XXX.
  7523         16  CO-PREFIX                         PIC XXX.
  7524         16  CO-PHONE                          PIC X(4).
  7525
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 141
* EL156.cbl
  7526     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7527
  7528     12  CO-AR-BAL-LEVEL                       PIC X.
  7529         88  CO-AR-REF-LVL                        VALUE '1'.
  7530         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7531         88  CO-AR-BILL-LVL                       VALUE '2'.
  7532         88  CO-AR-AGT-LVL                        VALUE '3'.
  7533         88  CO-AR-FR-LVL                         VALUE '4'.
  7534
  7535     12  CO-AR-NORMAL-PRINT                    PIC X.
  7536         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7537         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7538
  7539     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7540
  7541     12  CO-AR-REPORTING                       PIC X.
  7542         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7543         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7544
  7545     12  CO-AR-PULL-CHECK                      PIC X.
  7546         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7547         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7548
  7549     12  CO-AR-BALANCE-PRINT                   PIC X.
  7550         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7551
  7552     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7553         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7554         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7555         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7556
  7557     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7558
  7559     12  CO-USER-CODE                          PIC X.
  7560     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7561
  7562******************************************************************
  7563*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7564*    THE LAST MONTH END RUN.
  7565******************************************************************
  7566
  7567     12  CO-LAST-ACTIVITY-DATE.
  7568         16  CO-ACT-YEAR                       PIC 99.
  7569         16  CO-ACT-MONTH                      PIC 99.
  7570         16  CO-ACT-DAY                        PIC 99.
  7571
  7572     12  CO-LAST-STMT-DT.
  7573         16  CO-LAST-STMT-YEAR                 PIC 99.
  7574         16  CO-LAST-STMT-MONTH                PIC 99.
  7575         16  CO-LAST-STMT-DAY                  PIC 99.
  7576
  7577     12  CO-MO-END-TOTALS.
  7578         16  CO-MONTHLY-TOTALS.
  7579             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7580             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7581             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7582             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7583             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 142
* EL156.cbl
  7584
  7585         16  CO-AGING-TOTALS.
  7586             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7587             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7588             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7589             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7590
  7591         16  CO-YTD-TOTALS.
  7592             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7593             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7594
  7595         16  CO-OVER-UNDER-TOTALS.
  7596             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7597             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7598
  7599     12  CO-MISCELLANEOUS-TOTALS.
  7600         16  CO-FICA-TOTALS.
  7601             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7602             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7603
  7604         16  CO-CLAIM-TOTALS.
  7605             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7606             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7607
  7608******************************************************************
  7609*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7610*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7611******************************************************************
  7612
  7613     12  CO-CURRENT-TOTALS.
  7614         16  CO-CURRENT-LAST-STMT-DT.
  7615             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7616             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7617             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7618
  7619         16  CO-CURRENT-MONTHLY-TOTALS.
  7620             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7621             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7622             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7623             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7624             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7625
  7626         16  CO-CURRENT-AGING-TOTALS.
  7627             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7628             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7629             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7630             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7631
  7632         16  CO-CURRENT-YTD-TOTALS.
  7633             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7634             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7635
  7636     12  CO-PAID-COMM-TOTALS.
  7637         16  CO-YTD-PAID-COMMS.
  7638             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7639             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7640
  7641     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 143
* EL156.cbl
  7642         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7643         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7644
  7645     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7646         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7647         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7648         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7649         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7650         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7651         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7652         88  CO-FINAL-LETTER                  VALUE 'F'.
  7653         88  CO-RECONCILING                   VALUE 'R'.
  7654         88  CO-PHONE-CALL                    VALUE 'P'.
  7655         88  CO-LEGAL                         VALUE 'L'.
  7656         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7657         88  CO-WRITE-OFF                     VALUE 'W'.
  7658         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7659
  7660     12  CO-CSR-CODE                       PIC X(4).
  7661
  7662     12  CO-GA-STATUS-INFO.
  7663         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7664         16  CO-GA-TERMINATION-DT          PIC XX.
  7665         16  CO-GA-STATUS-CODE             PIC X.
  7666             88  CO-GA-ACTIVE                 VALUE 'A'.
  7667             88  CO-GA-INACTIVE               VALUE 'I'.
  7668             88  CO-GA-PENDING                VALUE 'P'.
  7669         16  CO-GA-COMMENTS.
  7670             20  CO-GA-COMMENT-1           PIC X(40).
  7671             20  CO-GA-COMMENT-2           PIC X(40).
  7672             20  CO-GA-COMMENT-3           PIC X(40).
  7673             20  CO-GA-COMMENT-4           PIC X(40).
  7674
  7675     12  CO-RPTCD2                         PIC X(10).
  7676     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7677         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7678         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7679
  7680     12  CO-TYPE-AGENT                     PIC X(01).
  7681         88  CO-CORPORATION                   VALUE 'C'.
  7682         88  CO-PARTNERSHIP                   VALUE 'P'.
  7683         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7684         88  CO-TRUST                         VALUE 'T'.
  7685         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7686
  7687     12  CO-FAXNO.
  7688         16  CO-FAX-AREA-CODE                  PIC XXX.
  7689         16  CO-FAX-PREFIX                     PIC XXX.
  7690         16  CO-FAX-PHONE                      PIC X(4).
  7691
  7692     12  CO-BANK-INFORMATION.
  7693         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7694         16  CO-BANK-TRANSIT-NON REDEFINES
  7695             CO-BANK-TRANSIT-NO                PIC 9(8).
  7696
  7697         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7698     12  CO-MISC-DEDUCT-INFO REDEFINES
  7699                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 144
* EL156.cbl
  7700         16  CO-MD-GL-ACCT                     PIC X(10).
  7701         16  CO-MD-DIV                         PIC XX.
  7702         16  CO-MD-CENTER                      PIC X(4).
  7703         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7704         16  CO-CREATE-AP-CHECK                PIC X.
  7705         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7706         16  FILLER                            PIC XXX.
  7707     12  CO-ACH-STATUS                         PIC X.
  7708         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7709         88  CO-ACH-PENDING                        VALUE 'P'.
  7710
  7711     12  CO-BILL-SW                            PIC X.
  7712     12  CO-CONTROL-NAME                       PIC X(30).
  7713     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7714     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7715     12  CO-CLP-STATE                          PIC XX.
  7716     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7717     12  CO-SPP-REFUND-EDIT                    PIC X.
  7718
  7719******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 145
* EL156.cbl
  7721*    COPY ERCDMDNT.
  7722******************************************************************
  7723*                                                                *
  7724*                            ERCDMDNT                            *
  7725*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7726*                            VMOD=2.005                          *
  7727*                                                                *
  7728*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7729*                                                                *
  7730*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7731*                                                                *
  7732*        FILE TYPE= VSAM,KSDS                                    *
  7733*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7734*                                                                *
  7735*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7736*                                                                *
  7737*        LOG = YES                                               *
  7738*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7739*                                                                *
  7740******************************************************************
  7741
  7742 01  CERTIFICATE-NOTE.
  7743     12  CN-RECORD-ID                     PIC  XX.
  7744         88  VALID-CN-ID                      VALUE 'CN'.
  7745
  7746     12  CN-CONTROL-PRIMARY.
  7747         16  CN-COMPANY-CD                PIC X.
  7748         16  CN-CERT-KEY.
  7749             20  CN-CARRIER               PIC X.
  7750             20  CN-GROUPING.
  7751                 24  CN-GROUPING-PREFIX   PIC XXX.
  7752                 24  CN-GROUPING-PRIME    PIC XXX.
  7753             20  CN-STATE                 PIC XX.
  7754             20  CN-ACCOUNT.
  7755                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7756                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7757             20  CN-CERT-EFF-DT           PIC XX.
  7758             20  CN-CERT-NO.
  7759                 24  CN-CERT-PRIME        PIC X(10).
  7760                 24  CN-CERT-SFX          PIC X.
  7761
  7762     12  CN-BILLING-START-LINE-NO         PIC 99.
  7763     12  CN-BILLING-END-LINE-NO           PIC 99.
  7764
  7765     12  CN-LINES.
  7766         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7767
  7768     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7769         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7770         16  CN-CSI-GENERAL-DATA-AREA.
  7771             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7772
  7773         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7774             CN-CSI-GENERAL-DATA-AREA.
  7775             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7776             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7777             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7778             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 146
* EL156.cbl
  7779             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7780             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7781             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7782             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7783             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7784             20  FILLER                       PIC XX.
  7785             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7786             20  FILLER                       PIC X(38).
  7787
  7788         16  CN-CSI-PRODUCT-DATA-AREA.
  7789             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7790
  7791         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7792             CN-CSI-PRODUCT-DATA-AREA.
  7793             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7794             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7795             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7796             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7797             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7798             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7799             20  FILLER                   PIC XX.
  7800             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7801             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7802             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7803             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7804             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7805             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7806             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7807             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7808             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7809             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7810             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7811             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7812             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7813             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7814             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7815             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7816             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7817             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7818             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7819             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7820             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7821             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7822             20  FILLER                   PIC X(25).
  7823
  7824         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7825             CN-CSI-CREDIT-CARD-DATA.
  7826             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7827             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7828             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7829             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7830             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7831             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7832             20  FILLER                   PIC XX.
  7833             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7834             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7835             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7836             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 147
* EL156.cbl
  7837             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7838             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7839             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7840             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7841             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7842             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7843             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7844             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7845             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7846             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7847             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7848             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7849             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7850             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7851             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7852             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7853             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7854             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7855             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7856             20  FILLER                   PIC X(17).
  7857
  7858         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7859             CN-CSI-FAMILY-LEAVE-DATA.
  7860             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7861             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7862             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7863             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7864             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7865             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7866             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7867             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7868             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7869             20  CN-CSI-SL-INT-ON-PROCEEDS
  7870                                          PIC S9(5)V99  COMP-3.
  7871             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7872             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7873             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7874             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7875             20  CN-CSI-SL-POLICY-BENEFITS
  7876                                          PIC S9(5)V99  COMP-3.
  7877             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7878             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7879             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7880             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7881             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7882             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7883             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7884             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7885             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7886             20  CN-CSI-SL-STATE-NOT      PIC X.
  7887             20  FILLER                   PIC XX.
  7888
  7889         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7890             CN-CSI-SENIOR-LIFE-DATA.
  7891             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7892             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7893             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7894                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 148
* EL156.cbl
  7895             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7896             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7897             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7898             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7899             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7900             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7901             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7902             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7903             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7904             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7905             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7906             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7907             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7908             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7909             20  CN-CSI-PP-REPAIR         PIC X.
  7910             20  CN-CSI-PP-REPLACE        PIC X.
  7911             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7912             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7913             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7914             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7915             20  FILLER                   PIC X(5).
  7916
  7917         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7918             CN-CSI-PURCH-PROP-DATA.
  7919             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7920             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7921             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7922             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7923             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7924             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7925             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7926             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7927             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7928             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7929             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7930             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7931             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7932             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7933             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7934             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7935             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7936             20  CN-CSI-EW-REPLACE        PIC X.
  7937             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7938             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7939             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7940             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7941             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7942             20  FILLER                   PIC X(4).
  7943
  7944     12  CN-LAST-MAINT-DT                 PIC XX.
  7945     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7946     12  CN-LAST-MAINT-USER               PIC X(4).
  7947     12  FILLER                           PIC X(6).
  7948
  7949******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 149
* EL156.cbl
  7951*    COPY ERCCNOT.
  7952******************************************************************
  7953*                                                                *
  7954*                            ERCCNOT                             *
  7955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7956*                            VMOD=2.003                          *
  7957*                                                                *
  7958*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7959*                                                                *
  7960*        FILE TYPE= VSAM,KSDS                                    *
  7961*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7962*                                                                *
  7963*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7964*                                                                *
  7965*        LOG = YES                                               *
  7966*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7967*                                                                *
  7968******************************************************************
  7969*                   C H A N G E   L O G
  7970*
  7971* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7972*-----------------------------------------------------------------
  7973*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7974* EFFECTIVE    NUMBER
  7975*-----------------------------------------------------------------
  7976* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7977******************************************************************
  7978
  7979 01  CERT-NOTE-FILE.
  7980     12  CZ-RECORD-ID                PIC  XX.
  7981         88  VALID-CZ-ID                  VALUE 'CZ'.
  7982
  7983     12  CZ-CONTROL-PRIMARY.
  7984         16  CZ-COMPANY-CD           PIC X.
  7985         16  CZ-CARRIER              PIC X.
  7986         16  CZ-GROUPING.
  7987             20 CZ-GROUPING-PREFIX   PIC XXX.
  7988             20 CZ-GROUPING-PRIME    PIC XXX.
  7989         16  CZ-STATE                PIC XX.
  7990         16  CZ-ACCOUNT.
  7991             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7992             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7993         16  CZ-CERT-EFF-DT          PIC XX.
  7994         16  CZ-CERT-NO.
  7995             20  CZ-CERT-PRIME       PIC X(10).
  7996             20  CZ-CERT-SFX         PIC X.
  7997         16  CZ-RECORD-TYPE          PIC X.
  7998             88  CERT-NOTE           VALUE '1'.
  7999             88  CLAIM-CERT-NOTE     VALUE '2'.
  8000         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  8001
  8002     12  CZ-LAST-MAINT-DT            PIC XX.
  8003     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8004     12  CZ-LAST-MAINT-USER          PIC X(4).
  8005
  8006     12  CZ-NOTE-INFORMATION.
  8007         16  CZ-NOTE                 PIC X(63).
  8008         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 150
* EL156.cbl
  8009******************************************************************
  8010*                            COPY ERCPDEF.
  8011******************************************************************
  8012*                                                                *
  8013*                                                                *
  8014*                            ERCPDEF.                            *
  8015*                                                                *
  8016*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8017*                                                                *
  8018*    FILE TYPE = VSAM,KSDS                                       *
  8019*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8020*                                                                *
  8021*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8022*                                                                *
  8023*    LOG = YES                                                   *
  8024*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8025******************************************************************
  8026*                   C H A N G E   L O G
  8027*
  8028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8029*-----------------------------------------------------------------
  8030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8031* EFFECTIVE    NUMBER
  8032*-----------------------------------------------------------------
  8033* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8034* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8035* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8036******************************************************************
  8037 01  PRODUCT-MASTER.
  8038    12  PD-RECORD-ID                 PIC X(02).
  8039        88  VALID-PD-ID                  VALUE 'PD'.
  8040    12  PD-CONTROL-PRIMARY.
  8041        16  PD-COMPANY-CD            PIC X.
  8042        16  PD-STATE                 PIC XX.
  8043        16  PD-PRODUCT-CD            PIC XXX.
  8044        16  PD-FILLER                PIC X(7).
  8045        16  PD-BEN-TYPE              PIC X.
  8046        16  PD-BEN-CODE              PIC XX.
  8047        16  PD-PROD-EXP-DT           PIC XX.
  8048    12  FILLER                       PIC X(50).
  8049    12  PD-PRODUCT-DATA OCCURS 8.
  8050        16  PD-PROD-CODE             PIC X.
  8051            88  PD-PROD-LIFE           VALUE 'L'.
  8052            88  PD-PROD-PROP           VALUE 'P'.
  8053            88  PD-PROD-AH             VALUE 'A'.
  8054            88  PD-PROD-IU             VALUE 'I'.
  8055            88  PD-PROD-GAP            VALUE 'G'.
  8056            88  PD-PROD-FAML           VALUE 'F'.
  8057        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8058        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8059        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8060        16  PD-MAX-TERM              PIC S999        COMP-3.
  8061        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8062        16  FILLER                   PIC X.
  8063        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8064        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  8065        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8066        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 151
* EL156.cbl
  8067        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8068        16  PD-REC-CRIT-PERIOD       PIC 99.
  8069        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8070            20  PD-RECURRING-YN      PIC X.
  8071            20  FILLER               PIC X.
  8072        16  PD-RTW-MOS               PIC 99.
  8073        16  PD-MAX-EXTENSION         PIC 99.
  8074        16  pd-ben-pct               pic sv999 comp-3.
  8075*       16  FILLER                   PIC XX.
  8076    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8077    12  PD-TERM-LIMITS OCCURS 15.
  8078        16  PD-LOW-TERM              PIC S999        COMP-3.
  8079        16  PD-HI-TERM               PIC S999        COMP-3.
  8080*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8081    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8082        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8083        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8084    12  PD-EARN-FACTORS.
  8085        16  FILLER OCCURS 15.
  8086            20  FILLER OCCURS 15.
  8087                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8088    12  PD-PRODUCT-DESC              PIC X(80).
  8089    12  PD-TRUNCATED                 PIC X.
  8090    12  FILLER                       PIC X(59).
  8091    12  PD-MAINT-INFORMATION.
  8092        16  PD-LAST-MAINT-DT         PIC X(02).
  8093        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8094        16  PD-LAST-MAINT-BY         PIC X(04).
  8095*                            COPY ELCCRTT.
  8096******************************************************************
  8097*                                                                *
  8098*                            ELCCRTT.                            *
  8099*                                                                *
  8100*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8101*                                                                *
  8102*   FILE TYPE = VSAM,KSDS                                        *
  8103*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8104*                                                                *
  8105*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8106*                                                                *
  8107*   LOG = YES                                                    *
  8108*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8109******************************************************************
  8110*                   C H A N G E   L O G
  8111*
  8112* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8113*-----------------------------------------------------------------
  8114*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8115* EFFECTIVE    NUMBER
  8116*-----------------------------------------------------------------
  8117* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8118* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8119* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8120* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8121* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8122* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8123* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8124* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 152
* EL156.cbl
  8125* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8126******************************************************************
  8127
  8128 01  CERTIFICATE-TRAILERS.
  8129     12  CS-RECORD-ID                      PIC XX.
  8130         88  VALID-CS-ID                      VALUE 'CS'.
  8131
  8132     12  CS-CONTROL-PRIMARY.
  8133         16  CS-COMPANY-CD                 PIC X.
  8134         16  CS-CARRIER                    PIC X.
  8135         16  CS-GROUPING                   PIC X(6).
  8136         16  CS-STATE                      PIC XX.
  8137         16  CS-ACCOUNT                    PIC X(10).
  8138         16  CS-CERT-EFF-DT                PIC XX.
  8139         16  CS-CERT-NO.
  8140             20  CS-CERT-PRIME             PIC X(10).
  8141             20  CS-CERT-SFX               PIC X.
  8142         16  CS-TRAILER-TYPE               PIC X.
  8143             88  COMM-TRLR           VALUE 'A'.
  8144             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8145             88  CERT-DATA-TRLR      VALUE 'C'.
  8146
  8147     12  CS-DATA-AREA                      PIC X(516).
  8148
  8149     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8150         16  CS-BANK-COMMISSION-AREA.
  8151             20  CS-BANK-COMMS       OCCURS 10.
  8152                 24  CS-AGT                PIC X(10).
  8153                 24  CS-COM-TYP            PIC X.
  8154                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8155                 24  CS-RECALC-LV-INDIC    PIC X.
  8156                 24  FILLER                PIC X(10).
  8157         16  FILLER                        PIC X(256).
  8158
  8159     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8160****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8161         16  CS-MB-CLAIM-DATA OCCURS 24.
  8162             20  CS-CLAIM-NO               PIC X(7).
  8163             20  CS-CLAIM-TYPE             PIC X.
  8164                 88  CS-AH-CLM               VALUE 'A'.
  8165                 88  CS-IU-CLM               VALUE 'I'.
  8166                 88  CS-GP-CLM               VALUE 'G'.
  8167                 88  CS-LF-CLM               VALUE 'L'.
  8168                 88  CS-PR-CLM               VALUE 'P'.
  8169                 88  CS-FL-CLM               VALUE 'F'.
  8170             20  CS-INSURED-TYPE           PIC X.
  8171                 88  CS-PRIM-INSURED          VALUE 'P'.
  8172                 88  CS-CO-BORROWER           VALUE 'C'.
  8173             20  CS-BENEFIT-PERIOD         PIC 99.
  8174             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8175             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8176             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8177         16  FILLER                        PIC X(12).
  8178     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8179         16  CS-VIN-NUMBER                 PIC X(17).
  8180         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8181         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8182         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 153
* EL156.cbl
  8183         16  cs-agent-name.
  8184             20  cs-agent-fname            pic x(20).
  8185             20  cs-agent-mi               pic x.
  8186             20  cs-agent-lname            pic x(25).
  8187         16  cs-license-no                 pic x(15).
  8188         16  cs-npn-number                 pic x(10).
  8189         16  cs-agent-edit-status          pic x.
  8190             88  cs-ae-refer-to-manager      value 'M'.
  8191             88  cs-ae-cover-sheet           value 'C'.
  8192             88  cs-ae-sig-form              value 'S'.
  8193             88  cs-ae-verified              value 'V'.
  8194             88  cs-unidentified-signature   value 'U'.
  8195             88  cs-cert-returned            value 'R'.
  8196             88  cs-accept-no-commission     value 'N'.
  8197         16  cs-year                       pic 9999.
  8198         16  cs-make                       pic x(20).
  8199         16  cs-model                      pic x(20).
  8200         16  cs-future                     pic x(20).
  8201         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8202         16  FILLER                        PIC X(356). *> was 420
  8203*        16  FILLER                        PIC X(496).
  8204 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8205                          CONTROL-FILE CERTIFICATE-MASTER
  8206                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8207                          ACCOUNT-MASTER CHECK-QUE
  8208                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8209                          DAILY-ACTIVITY-RECORD
  8210                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8211                          CERT-NOTE-FILE PRODUCT-MASTER
  8212                          CERTIFICATE-TRAILERS.
  8213 0000-DFHEXIT SECTION.
  8214     MOVE '9#                    $   ' TO DFHEIV0.
  8215     MOVE 'EL156' TO DFHEIV1.
  8216     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8217
  8218     IF EIBCALEN = 0
  8219         GO TO 8800-UNAUTHORIZED-ACCESS.
  8220
  8221     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8222     MOVE EIBTRMID               TO QID-TERM.
  8223     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8224     MOVE '2'                    TO EMI-SWITCH2.
  8225     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8226     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8227
  8228     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8229     MOVE '5'                    TO DC-OPTION-CODE.
  8230     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8231     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8232                                    SAVE-BIN-DATE.
  8233     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8234     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8235
  8236     IF SAVE-DATE-YY > 70
  8237         MOVE 19                 TO SAVE-DATE-CC
  8238     ELSE
  8239         MOVE 20                 TO SAVE-DATE-CC.
  8240
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 154
* EL156.cbl
  8241     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8242         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8243     END-IF.
  8244
  8245     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8246        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8247     ELSE
  8248        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8249     END-IF
  8250
  8251     IF PI-PRINT-CLM-FRM-YN = 'N'
  8252         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8253     ELSE
  8254         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8255     END-IF
  8256
  8257     IF PI-PRINT-SURVEY-YN = 'N'
  8258         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8259     ELSE
  8260         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8261     END-IF
  8262
  8263     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8264         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8265     ELSE
  8266         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8267     END-IF
  8268
  8269* EXEC CICS HANDLE CONDITION
  8270*        NOTOPEN   (9990-ABEND)
  8271*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8272*        MAPFAIL   (0400-FIRST-TIME)
  8273*        DUPREC    (6180-DUPREC)
  8274*        ERROR     (9990-ABEND)
  8275*    END-EXEC.
  8276*    MOVE '"$JL?%.               ! " #00008264' TO DFHEIV0
  8277     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8279     MOVE X'2220233030303038323634' TO DFHEIV0(25:11)
  8280     CALL 'kxdfhei1' USING DFHEIV0
  8281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8282
  8283
  8284     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8285         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8286
  8287     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8288         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8289             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8290             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8291             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8292             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8293             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8294             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8295             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8296             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8297             MOVE LOW-VALUES           TO EL156AI
  8298             MOVE 'Y'                  TO FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 155
* EL156.cbl
  8299         ELSE
  8300             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8301             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8302             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8303             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8304             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8305             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8306             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8307             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8308
  8309     IF RETURNED-FROM NOT = SPACES
  8310        IF (RETURNED-FROM = 'EL614')
  8311           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8312           IF WS-SAVED-EOB-CODES NOT = SPACES
  8313              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8314           ELSE
  8315              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8316           END-IF
  8317        END-IF
  8318         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8319            MOVE 'Y'             TO FIRST-ENTRY
  8320            IF RETURNED-FROM = 'EL614'
  8321               AND (PI-PASS-SW NOT = 'C')
  8322               IF WS-SAVED-EOB-CODES NOT = SPACES
  8323                  MOVE WS-SAVED-EOB-CODES
  8324                                 TO PI-PMTNOTE2
  8325                                    WS-PMTNOTE2
  8326                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8327               ELSE
  8328                  MOVE SPACES    TO PI-PMTNOTE2
  8329                                    WS-PMTNOTE2
  8330                                    PI-EOB-CODES-EXIST
  8331               END-IF
  8332            END-IF
  8333            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8334            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8335            IF RETURNED-FROM = 'EL614'
  8336               GO TO 1000-EDIT-DATA
  8337            END-IF
  8338            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8339               (PAYEEI   = LOW-VALUES OR SPACES)
  8340               GO TO 8100-SEND-INITIAL-MAP
  8341            ELSE
  8342               GO TO 1000-EDIT-DATA.
  8343
  8344     IF EIBTRNID NOT = TRANS-ID
  8345         GO TO 0400-FIRST-TIME.
  8346
  8347     IF EIBAID = DFHCLEAR
  8348        IF PI-PASS-SW = 'C'
  8349           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8350           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8351           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8352           MOVE 'Y'            TO RETURNED-FROM-B
  8353           GO TO 1000-EDIT-DATA
  8354        ELSE
  8355           GO TO 9400-CLEAR.
  8356
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 156
* EL156.cbl
  8357     IF PI-PASS-SW = 'C'
  8358         MOVE MAP-NAMEB          TO MAP-NAME
  8359         IF EIBAID = DFHPF1 OR DFHPF13
  8360             GO TO 5000-UPDATE
  8361           ELSE
  8362             IF EIBAID NOT = DFHENTER
  8363                 MOVE LOW-VALUES TO EL156BI
  8364                 MOVE MAP-NAMEB  TO MAP-NAME
  8365                 MOVE ER-0029    TO EMI-ERROR
  8366                 MOVE -1         TO  ENTPFBL
  8367                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8368                 GO TO 8200-SEND-DATAONLY.
  8369
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 157
* EL156.cbl
  8371 0200-RECEIVE.
  8372     MOVE LOW-VALUES             TO EL156AI.
  8373     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8374         MOVE ER-0008            TO EMI-ERROR
  8375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8376         IF PI-PASS-SW = 'C'
  8377             MOVE -1             TO ENTPFBL
  8378             GO TO 8200-SEND-DATAONLY
  8379         ELSE
  8380             MOVE -1             TO PMTTYPEL
  8381             GO TO 8200-SEND-DATAONLY.
  8382
  8383     IF PI-COMPANY-ID = 'DMD'
  8384         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8385
  8386     IF PI-PASS-SW = 'C'
  8387         MOVE MAP-NAMEB          TO MAP-NAME.
  8388
  8389
  8390* EXEC CICS RECEIVE
  8391*        MAP   (MAP-NAME)
  8392*        MAPSET(MAPSET-NAME)
  8393*        ASIS
  8394*        INTO  (EL156AI)
  8395*    END-EXEC.
  8396     MOVE LENGTH OF
  8397      EL156AI
  8398       TO DFHEIV11
  8399*    MOVE '8"TAI  L              ''   #00008377' TO DFHEIV0
  8400     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8401     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8402     MOVE X'2020233030303038333737' TO DFHEIV0(25:11)
  8403     CALL 'kxdfhei1' USING DFHEIV0,
  8404           MAP-NAME,
  8405           EL156AI,
  8406           DFHEIV11,
  8407           MAPSET-NAME,
  8408           DFHEIV99,
  8409           DFHEIV99
  8410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8411
  8412
  8413     IF PI-PASS-SW NOT = 'C'
  8414         GO TO 0250-MAPA.
  8415
  8416     IF ENTPFBL NOT > ZERO
  8417         MOVE MAP-NAMEB          TO MAP-NAME
  8418         MOVE ER-0029            TO EMI-ERROR
  8419         MOVE -1                 TO  ENTPFBL
  8420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8421         GO TO 8200-SEND-DATAONLY.
  8422
  8423     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8424         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8425       ELSE
  8426         MOVE MAP-NAMEB           TO MAP-NAME
  8427         MOVE ER-0029             TO EMI-ERROR
  8428         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 158
* EL156.cbl
  8429         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8430         GO TO 8200-SEND-DATAONLY.
  8431
  8432     IF EIBAID = DFHPF1 OR DFHPF13
  8433         IF MODIFY-CAP
  8434            GO TO 5000-UPDATE
  8435          ELSE
  8436            MOVE 'UPDATE'           TO SM-READ
  8437            PERFORM 9995-SECURITY-VIOLATION
  8438            MOVE MAP-NAMEB          TO MAP-NAME
  8439            MOVE ER-0070            TO EMI-ERROR
  8440            MOVE -1                 TO  ENTPFBL
  8441            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8442            GO TO 8200-SEND-DATAONLY.
  8443
  8444 0250-MAPA.
  8445     IF ENTERPFL = 0
  8446         GO TO 0300-CHECK-PFKEYS.
  8447
  8448     IF EIBAID NOT = DFHENTER
  8449         MOVE ER-0004            TO EMI-ERROR
  8450         GO TO 0320-INPUT-ERROR.
  8451
  8452     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8453         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8454     ELSE
  8455         MOVE ER-0029            TO EMI-ERROR
  8456         GO TO 0320-INPUT-ERROR.
  8457
  8458 0300-CHECK-PFKEYS.
  8459     IF EIBAID = DFHPF7 OR DFHPF8
  8460         GO TO 8820-PF7-8.
  8461
  8462     IF EIBAID = DFHPF23
  8463         GO TO 8810-PF23.
  8464
  8465     IF EIBAID = DFHPF24
  8466         GO TO 9200-RETURN-MAIN-MENU.
  8467
  8468     IF EIBAID = DFHPF12
  8469         GO TO 9500-PF12.
  8470
  8471     IF EIBAID = DFHPF1
  8472        IF PI-PASS-SW = 'A' OR 'B'
  8473          GO TO 0330-BROWSE-FORWARD.
  8474
  8475     IF EIBAID = DFHPF2
  8476        IF PI-PASS-SW = 'A' OR 'B'
  8477          GO TO 0350-BROWSE-BACKWARD.
  8478
  8479     IF EIBAID = DFHPF6
  8480        IF PI-EOB-CODES-EXIST = 'Y'
  8481           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8482        ELSE
  8483           MOVE SPACES              TO WS-PMTNOTE2
  8484        END-IF
  8485         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8486         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 159
* EL156.cbl
  8487            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8488         END-IF
  8489         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8490         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  8491             MOVE 'EL614'        TO PGM-NAME
  8492             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8493             GO TO 9300-XCTL
  8494         ELSE
  8495             MOVE XCTL-157       TO PGM-NAME
  8496             GO TO 9300-XCTL.
  8497
  8498     IF EIBAID = DFHPF9
  8499        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8500        MOVE XCTL-141            TO PGM-NAME
  8501        GO TO 9300-XCTL.
  8502
  8503     IF EIBAID = DFHPF10
  8504        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8505        MOVE XCTL-155            TO PGM-NAME
  8506        GO TO 9300-XCTL.
  8507
  8508     MOVE SPACES                 TO ERRMSG0O
  8509                                    ERRMSG1O
  8510                                    ERRMSG2O.
  8511
  8512     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8513         IF PI-PASS-SW NOT = 'B'
  8514             MOVE ER-0422        TO EMI-ERROR
  8515             GO TO 0320-INPUT-ERROR
  8516           ELSE
  8517             GO TO 0700-TEST-FOR-CHANGES.
  8518
  8519     IF EIBAID = DFHPF11
  8520        IF PI-PASS-SW = 'C'
  8521           MOVE ER-0029          TO EMI-ERROR
  8522           GO TO 0320-INPUT-ERROR.
  8523
  8524     IF EIBAID = DFHENTER OR DFHPF11
  8525        NEXT SENTENCE
  8526     ELSE
  8527        MOVE ER-0029             TO EMI-ERROR
  8528        GO TO 0320-INPUT-ERROR.
  8529
  8530     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8531
  8532     if pi-epyfrom not = zeros
  8533        if pi-epyfrom not = ws-epyfrom
  8534           move zeros        to ws-edays
  8535        end-if
  8536     end-if
  8537
  8538     if pi-epythru not = zeros
  8539        if pi-epythru not = ws-epythru
  8540           move zeros        to ws-edays
  8541        end-if
  8542     end-if
  8543
  8544     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 160
* EL156.cbl
  8545         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8546         GO TO 1000-EDIT-DATA
  8547     ELSE
  8548         IF PI-FATAL-COUNT NOT = 0 OR
  8549            PI-FORCE-COUNT NOT = 0
  8550             GO TO 1000-EDIT-DATA
  8551         ELSE
  8552             GO TO 2000-EDIT-DONE.
  8553
  8554 0320-INPUT-ERROR.
  8555     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8556
  8557     IF ENTERPFL = 0
  8558         MOVE -1                 TO PMTTYPEL
  8559     ELSE
  8560         MOVE AL-UNBON           TO ENTERPFA
  8561         MOVE -1                 TO ENTERPFL.
  8562
  8563     GO TO 8200-SEND-DATAONLY.
  8564
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 161
* EL156.cbl
  8566 0330-BROWSE-FORWARD.
  8567
  8568     MOVE CLMNOI            TO PI-CLAIM-NO.
  8569     MOVE CARRI             TO PI-CARRIER.
  8570     MOVE CERTNOI           TO PI-CERT-PRIME.
  8571     MOVE SUFXI             TO PI-CERT-SFX.
  8572
  8573     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8574     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8575     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8576     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8577
  8578     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8579
  8580
  8581* EXEC CICS HANDLE CONDITION
  8582*         NOTFND   (0380-CLAIM-END-FILE)
  8583*         ENDFILE  (0380-CLAIM-END-FILE)
  8584*    END-EXEC.
  8585*    MOVE '"$I''                  ! # #00008551' TO DFHEIV0
  8586     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8587     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8588     MOVE X'2320233030303038353531' TO DFHEIV0(25:11)
  8589     CALL 'kxdfhei1' USING DFHEIV0
  8590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8591
  8592
  8593
  8594* EXEC CICS STARTBR
  8595*         DATASET    ('ELMSTR')
  8596*         RIDFLD     (ELMSTR-KEY)
  8597*         GTEQ
  8598*    END-EXEC.
  8599     MOVE 'ELMSTR' TO DFHEIV1
  8600     MOVE 0
  8601       TO DFHEIV11
  8602*    MOVE '&,         G          &   #00008556' TO DFHEIV0
  8603     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8604     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8605     MOVE X'2020233030303038353536' TO DFHEIV0(25:11)
  8606     CALL 'kxdfhei1' USING DFHEIV0,
  8607           DFHEIV1,
  8608           ELMSTR-KEY,
  8609           DFHEIV99,
  8610           DFHEIV11,
  8611           DFHEIV99
  8612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8613
  8614
  8615     MOVE 'Y' TO WS-BROWSE-START-SW.
  8616
  8617 0335-READNEXT.
  8618
  8619
  8620* EXEC CICS READNEXT
  8621*         DATASET    ('ELMSTR')
  8622*         RIDFLD     (ELMSTR-KEY)
  8623*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 162
* EL156.cbl
  8624*    END-EXEC.
  8625     MOVE 'ELMSTR' TO DFHEIV1
  8626     MOVE 0
  8627       TO DFHEIV11
  8628*    MOVE '&.S                   )   #00008566' TO DFHEIV0
  8629     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8630     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8631     MOVE X'2020233030303038353636' TO DFHEIV0(25:11)
  8632     CALL 'kxdfhei1' USING DFHEIV0,
  8633           DFHEIV1,
  8634           DFHEIV20,
  8635           DFHEIV99,
  8636           ELMSTR-KEY,
  8637           DFHEIV99,
  8638           DFHEIV11,
  8639           DFHEIV99,
  8640           DFHEIV99
  8641     SET ADDRESS OF CLAIM-MASTER TO
  8642         DFHEIV20
  8643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8644
  8645
  8646     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8647        GO TO 0380-CLAIM-END-FILE.
  8648
  8649     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8650        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8651        GO TO 0335-READNEXT.
  8652
  8653     IF PI-COMPANY-ID = 'CRI'
  8654         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8655            GO TO 0380-CLAIM-END-FILE.
  8656
  8657     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8658         GO TO 0335-READNEXT.
  8659
  8660     IF PI-CARRIER-SECURITY > SPACES
  8661         IF CL-CARRIER = PI-CARRIER-SECURITY
  8662             NEXT SENTENCE
  8663         ELSE
  8664             GO TO 0335-READNEXT.
  8665
  8666     IF PI-ACCOUNT-SECURITY > SPACES
  8667         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8668             NEXT SENTENCE
  8669         ELSE
  8670             GO TO 0335-READNEXT.
  8671
  8672     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8673     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8674     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8675
  8676     GO TO 0400-FIRST-TIME.
  8677
  8678 0350-BROWSE-BACKWARD.
  8679
  8680     MOVE CLMNOI            TO PI-CLAIM-NO
  8681                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 163
* EL156.cbl
  8682     MOVE CARRI             TO PI-CARRIER.
  8683     MOVE CERTNOI           TO PI-CERT-PRIME.
  8684     MOVE SUFXI             TO PI-CERT-SFX.
  8685
  8686     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8687
  8688     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8689     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8690     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8691
  8692
  8693* EXEC CICS HANDLE CONDITION
  8694*         NOTFND   (0380-CLAIM-END-FILE)
  8695*         ENDFILE  (0380-CLAIM-END-FILE)
  8696*    END-EXEC.
  8697*    MOVE '"$I''                  ! $ #00008618' TO DFHEIV0
  8698     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8700     MOVE X'2420233030303038363138' TO DFHEIV0(25:11)
  8701     CALL 'kxdfhei1' USING DFHEIV0
  8702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8703
  8704
  8705
  8706* EXEC CICS STARTBR
  8707*         DATASET    ('ELMSTR')
  8708*         RIDFLD     (ELMSTR-KEY)
  8709*         GTEQ
  8710*    END-EXEC.
  8711     MOVE 'ELMSTR' TO DFHEIV1
  8712     MOVE 0
  8713       TO DFHEIV11
  8714*    MOVE '&,         G          &   #00008623' TO DFHEIV0
  8715     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8716     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8717     MOVE X'2020233030303038363233' TO DFHEIV0(25:11)
  8718     CALL 'kxdfhei1' USING DFHEIV0,
  8719           DFHEIV1,
  8720           ELMSTR-KEY,
  8721           DFHEIV99,
  8722           DFHEIV11,
  8723           DFHEIV99
  8724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8725
  8726
  8727     MOVE 'Y' TO WS-BROWSE-START-SW.
  8728
  8729
  8730* EXEC CICS READNEXT
  8731*         DATASET    ('ELMSTR')
  8732*         RIDFLD     (ELMSTR-KEY)
  8733*         SET        (ADDRESS OF CLAIM-MASTER)
  8734*    END-EXEC.
  8735     MOVE 'ELMSTR' TO DFHEIV1
  8736     MOVE 0
  8737       TO DFHEIV11
  8738*    MOVE '&.S                   )   #00008631' TO DFHEIV0
  8739     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 164
* EL156.cbl
  8740     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8741     MOVE X'2020233030303038363331' TO DFHEIV0(25:11)
  8742     CALL 'kxdfhei1' USING DFHEIV0,
  8743           DFHEIV1,
  8744           DFHEIV20,
  8745           DFHEIV99,
  8746           ELMSTR-KEY,
  8747           DFHEIV99,
  8748           DFHEIV11,
  8749           DFHEIV99,
  8750           DFHEIV99
  8751     SET ADDRESS OF CLAIM-MASTER TO
  8752         DFHEIV20
  8753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8754
  8755
  8756
  8757* EXEC CICS READPREV
  8758*         DATASET    ('ELMSTR')
  8759*         RIDFLD     (ELMSTR-KEY)
  8760*         SET        (ADDRESS OF CLAIM-MASTER)
  8761*    END-EXEC.
  8762     MOVE 'ELMSTR' TO DFHEIV1
  8763     MOVE 0
  8764       TO DFHEIV11
  8765*    MOVE '&0S                   )   #00008637' TO DFHEIV0
  8766     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8767     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8768     MOVE X'2020233030303038363337' TO DFHEIV0(25:11)
  8769     CALL 'kxdfhei1' USING DFHEIV0,
  8770           DFHEIV1,
  8771           DFHEIV20,
  8772           DFHEIV99,
  8773           ELMSTR-KEY,
  8774           DFHEIV99,
  8775           DFHEIV11,
  8776           DFHEIV99,
  8777           DFHEIV99
  8778     SET ADDRESS OF CLAIM-MASTER TO
  8779         DFHEIV20
  8780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8781
  8782
  8783 0360-BROWSE-BACKWARD.
  8784
  8785
  8786* EXEC CICS READPREV
  8787*         DATASET    ('ELMSTR')
  8788*         RIDFLD     (ELMSTR-KEY)
  8789*         SET        (ADDRESS OF CLAIM-MASTER)
  8790*    END-EXEC.
  8791     MOVE 'ELMSTR' TO DFHEIV1
  8792     MOVE 0
  8793       TO DFHEIV11
  8794*    MOVE '&0S                   )   #00008645' TO DFHEIV0
  8795     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8796     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8797     MOVE X'2020233030303038363435' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 165
* EL156.cbl
  8798     CALL 'kxdfhei1' USING DFHEIV0,
  8799           DFHEIV1,
  8800           DFHEIV20,
  8801           DFHEIV99,
  8802           ELMSTR-KEY,
  8803           DFHEIV99,
  8804           DFHEIV11,
  8805           DFHEIV99,
  8806           DFHEIV99
  8807     SET ADDRESS OF CLAIM-MASTER TO
  8808         DFHEIV20
  8809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8810
  8811
  8812     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8813        GO TO 0380-CLAIM-END-FILE.
  8814
  8815     IF PI-COMPANY-ID = 'CRI'
  8816         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8817            GO TO 0380-CLAIM-END-FILE.
  8818
  8819     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8820         GO TO 0360-BROWSE-BACKWARD.
  8821
  8822     IF PI-CARRIER-SECURITY > SPACES
  8823         IF CL-CARRIER = PI-CARRIER-SECURITY
  8824             NEXT SENTENCE
  8825         ELSE
  8826             GO TO 0360-BROWSE-BACKWARD.
  8827
  8828     IF PI-ACCOUNT-SECURITY > SPACES
  8829         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8830             NEXT SENTENCE
  8831         ELSE
  8832             GO TO 0360-BROWSE-BACKWARD.
  8833
  8834     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8835     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8836     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8837
  8838     GO TO 0400-FIRST-TIME.
  8839
  8840 0380-CLAIM-END-FILE.
  8841
  8842     MOVE ER-0130     TO EMI-ERROR.
  8843     MOVE -1          TO CLMNOL.
  8844     MOVE AL-UABON    TO CARRA
  8845                         CLMNOA
  8846                         CERTNOA
  8847                         SUFXA.
  8848
  8849     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8850
  8851     GO TO 8200-SEND-DATAONLY.
  8852
  8853 0400-FIRST-TIME.
  8854
  8855     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 166
* EL156.cbl
  8856        MOVE 'N'         TO WS-BROWSE-START-SW
  8857
  8858* EXEC CICS ENDBR
  8859*            DATASET    ('ELMSTR')
  8860*       END-EXEC.
  8861     MOVE 'ELMSTR' TO DFHEIV1
  8862     MOVE 0
  8863       TO DFHEIV11
  8864*    MOVE '&2                    $   #00008696' TO DFHEIV0
  8865     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8866     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8867     MOVE X'2020233030303038363936' TO DFHEIV0(25:11)
  8868     CALL 'kxdfhei1' USING DFHEIV0,
  8869           DFHEIV1,
  8870           DFHEIV11,
  8871           DFHEIV99
  8872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8873
  8874
  8875     IF PI-PROCESSOR-ID = 'LGXX'
  8876         NEXT SENTENCE
  8877     ELSE
  8878
  8879* EXEC CICS READQ TS
  8880*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8881*            INTO    (SECURITY-CONTROL)
  8882*            LENGTH  (SC-COMM-LENGTH)
  8883*            ITEM    (SC-ITEM)
  8884*        END-EXEC
  8885*    MOVE '*$II   L              ''   #00008703' TO DFHEIV0
  8886     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8887     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8888     MOVE X'2020233030303038373033' TO DFHEIV0(25:11)
  8889     CALL 'kxdfhei1' USING DFHEIV0,
  8890           PI-SECURITY-TEMP-STORE-ID,
  8891           SECURITY-CONTROL,
  8892           SC-COMM-LENGTH,
  8893           SC-ITEM,
  8894           DFHEIV99,
  8895           DFHEIV99
  8896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8897         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8898         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8899
  8900     MOVE LOW-VALUES             TO EL156AI.
  8901     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8902     MOVE 'Y'                    TO FIRST-ENTRY.
  8903     GO TO 7000-SHOW-CLAIM.
  8904
  8905 0500-CREATE-TEMP-STORAGE.
  8906     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8907
  8908
  8909* EXEC CICS WRITEQ TS
  8910*        QUEUE (QID)
  8911*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8912*        LENGTH(PI-COMM-LENGTH)
  8913*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 167
* EL156.cbl
  8914*    MOVE '*"     L              ''   #00008720' TO DFHEIV0
  8915     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8916     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8917     MOVE X'2020233030303038373230' TO DFHEIV0(25:11)
  8918     CALL 'kxdfhei1' USING DFHEIV0,
  8919           QID,
  8920           PROGRAM-INTERFACE-BLOCK,
  8921           PI-COMM-LENGTH,
  8922           DFHEIV99,
  8923           DFHEIV99,
  8924           DFHEIV99
  8925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8926
  8927
  8928
  8929* EXEC CICS WRITEQ TS
  8930*        QUEUE (QID)
  8931*        FROM  (EL156AI)
  8932*        LENGTH(MAP-LENGTH)
  8933*    END-EXEC.
  8934*    MOVE '*"     L              ''   #00008726' TO DFHEIV0
  8935     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8936     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8937     MOVE X'2020233030303038373236' TO DFHEIV0(25:11)
  8938     CALL 'kxdfhei1' USING DFHEIV0,
  8939           QID,
  8940           EL156AI,
  8941           MAP-LENGTH,
  8942           DFHEIV99,
  8943           DFHEIV99,
  8944           DFHEIV99
  8945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8946
  8947
  8948 0599-EXIT.
  8949      EXIT.
  8950
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 168
* EL156.cbl
  8952 0600-RECOVER-TEMP-STORAGE.
  8953
  8954* EXEC CICS READQ TS
  8955*        QUEUE (QID)
  8956*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8957*        LENGTH(PI-COMM-LENGTH)
  8958*    END-EXEC.
  8959*    MOVE '*$I    L              ''   #00008737' TO DFHEIV0
  8960     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8961     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8962     MOVE X'2020233030303038373337' TO DFHEIV0(25:11)
  8963     CALL 'kxdfhei1' USING DFHEIV0,
  8964           QID,
  8965           PROGRAM-INTERFACE-BLOCK,
  8966           PI-COMM-LENGTH,
  8967           DFHEIV99,
  8968           DFHEIV99,
  8969           DFHEIV99
  8970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8971
  8972
  8973
  8974* EXEC CICS READQ TS
  8975*        QUEUE (QID)
  8976*        INTO  (EL156AI)
  8977*        LENGTH(MAP-LENGTH)
  8978*    END-EXEC.
  8979*    MOVE '*$I    L              ''   #00008743' TO DFHEIV0
  8980     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8981     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8982     MOVE X'2020233030303038373433' TO DFHEIV0(25:11)
  8983     CALL 'kxdfhei1' USING DFHEIV0,
  8984           QID,
  8985           EL156AI,
  8986           MAP-LENGTH,
  8987           DFHEIV99,
  8988           DFHEIV99,
  8989           DFHEIV99
  8990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8991
  8992
  8993     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8994
  8995     IF PMTTYPEI NOT = LOW-VALUES
  8996         MOVE AL-UANON           TO PMTTYPEA.
  8997
  8998     IF PAYEEI NOT = LOW-VALUES
  8999         MOVE AL-UANON           TO PAYEEA.
  9000
  9001     IF NOTE1I NOT = LOW-VALUES
  9002         MOVE AL-UANON           TO NOTE1A.
  9003
  9004     IF (RETURNED-FROM = 'EL614')
  9005        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9006     END-IF
  9007*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9008*       AND (PI-EOB-CODES-EXIST = 'Y')
  9009*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 169
* EL156.cbl
  9010*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9011     IF PI-SET-NOTE2-MDT = 'Y'
  9012         MOVE AL-SANON           TO NOTE2A
  9013     END-IF
  9014
  9015     IF OFFLINEI NOT = LOW-VALUES
  9016         MOVE AL-UANON           TO OFFLINEA.
  9017
  9018*    IF GROUPEDI NOT = LOW-VALUES
  9019*        MOVE AL-UANON           TO GROUPEDA.
  9020
  9021*    IF CASHI NOT = LOW-VALUES
  9022*        MOVE AL-UANON           TO CASHA.
  9023
  9024     IF CHECKNOI NOT = LOW-VALUES
  9025         MOVE AL-UANON           TO CHECKNOA.
  9026
  9027     IF HOLDTILI NOT = LOW-VALUES
  9028         MOVE AL-UANON           TO HOLDTILA.
  9029
  9030     IF EPYFROMI NOT = LOW-VALUES
  9031         MOVE AL-UANON           TO EPYFROMA.
  9032
  9033     IF AIGFROMI NOT = LOW-VALUES
  9034         MOVE AL-UANON           TO AIGFROMA.
  9035
  9036     IF EPYTHRUI NOT = LOW-VALUES
  9037         MOVE AL-UANON           TO EPYTHRUA.
  9038
  9039     IF EDAYSI NOT = LOW-VALUES
  9040         MOVE AL-UNNON           TO EDAYSA.
  9041
  9042     IF EPYAMTL NOT = +0
  9043         MOVE AL-UNNON           TO EPYAMTA.
  9044
  9045     IF ERESVL NOT = +0
  9046         MOVE AL-UNNON           TO ERESVA.
  9047
  9048     IF EEXPENSL NOT = +0
  9049         MOVE AL-UNNON           TO EEXPENSA.
  9050
  9051     IF ETYPEI NOT = LOW-VALUES
  9052         MOVE AL-UNNON           TO ETYPEA.
  9053
  9054     IF PROOFDTI NOT = 0
  9055         MOVE AL-UNNON           TO PROOFDTA.
  9056
  9057     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9058        MOVE AL-UANON            TO EOBYNA
  9059     END-IF
  9060     IF CLMFMYNI = 'Y' OR 'N'
  9061        MOVE AL-UANON            TO CLMFMYNA
  9062     END-IF
  9063
  9064     IF SURVYYNI = 'Y' OR 'N'
  9065        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9066           MOVE AL-UANON         TO SURVYYNA
  9067        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 170
* EL156.cbl
  9068     END-IF
  9069
  9070     IF SPRELYNI = 'Y' OR 'N'
  9071        MOVE AL-UANON            TO SPRELYNA
  9072     END-IF
  9073
  9074     .
  9075 0699-EXIT.
  9076      EXIT.
  9077
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 171
* EL156.cbl
  9079 0700-TEST-FOR-CHANGES.
  9080     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9081         MOVE ER-0433            TO EMI-ERROR
  9082         GO TO 0750-FUNCTION-ERROR.
  9083
  9084     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9085
  9086     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9087         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9088         MOVE 'A'                TO PI-PASS-SW
  9089         GO TO 1000-EDIT-DATA.
  9090
  9091     IF PI-FATAL-COUNT NOT = 0
  9092         MOVE ER-0499            TO EMI-ERROR
  9093         GO TO 0750-FUNCTION-ERROR.
  9094
  9095     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9096         MOVE ER-0500            TO EMI-ERROR
  9097         GO TO 0750-FUNCTION-ERROR.
  9098
  9099     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9100        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9101           MOVE ER-0542          TO EMI-ERROR
  9102           MOVE -1               TO EPYAMTL
  9103           GO TO 0750-FUNCTION-ERROR.
  9104
  9105     IF PI-OFFLINE = 'Y'  OR
  9106        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9107        MOVE EIBAID              TO PI-PFKEY-USED
  9108        GO TO 5000-UPDATE.
  9109
  9110     GO TO 6000-BUILD-SCREEN-B.
  9111
  9112 0750-FUNCTION-ERROR.
  9113     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9114
  9115     IF ENTERPFL > 0
  9116         MOVE -1                 TO ENTERPFL
  9117         MOVE AL-UNBON           TO ENTERPFA
  9118         GO TO 8200-SEND-DATAONLY
  9119     ELSE
  9120         MOVE -1                 TO ENTERPFL
  9121         MOVE AL-UNNOF           TO ENTERPFA
  9122         GO TO 8200-SEND-DATAONLY.
  9123
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 172
* EL156.cbl
  9125 0800-DELETE-TS.
  9126
  9127* EXEC CICS HANDLE CONDITION
  9128*        QIDERR(0800-EXIT)
  9129*    END-EXEC.
  9130*    MOVE '"$N                   ! % #00008882' TO DFHEIV0
  9131     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9133     MOVE X'2520233030303038383832' TO DFHEIV0(25:11)
  9134     CALL 'kxdfhei1' USING DFHEIV0
  9135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9136
  9137
  9138
  9139* EXEC CICS DELETEQ TS
  9140*        QUEUE(QID)
  9141*    END-EXEC.
  9142*    MOVE '*&                    #   #00008886' TO DFHEIV0
  9143     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9144     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9145     MOVE X'2020233030303038383836' TO DFHEIV0(25:11)
  9146     CALL 'kxdfhei1' USING DFHEIV0,
  9147           QID,
  9148           DFHEIV99
  9149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9150
  9151
  9152 0800-EXIT.
  9153      EXIT.
  9154 0900-GET-DDF-LIMITS.
  9155
  9156     if cm-clp-state = zeros or spaces or low-values
  9157        move cm-state            to cm-clp-state
  9158     end-if
  9159     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9160     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9161     MOVE cm-clp-state           TO ERPDEF-STATE
  9162     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9163     evaluate true
  9164        when (cl-claim-type = 'L' or 'P')
  9165           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9166             and 'CU')
  9167           move 'L'              to erpdef-ben-type
  9168           move pi-lf-benefit-cd to erpdef-ben-code
  9169        when (cl-claim-type not = 'L' and 'P')
  9170           and (pi-ah-benefit-cd not = '00' and '  ')
  9171           move 'A'              to erpdef-ben-type
  9172           move pi-ah-benefit-cd to erpdef-ben-code
  9173        when (cl-claim-type not = 'L' and 'P')
  9174           and (pi-ah-benefit-cd = '00' or '  ')
  9175           move 'L'              to erpdef-ben-type
  9176           move pi-lf-benefit-cd to erpdef-ben-code
  9177        when (cl-claim-type = 'L' or 'P')
  9178           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9179           move 'A'              to erpdef-ben-type
  9180           move pi-ah-benefit-cd to erpdef-ben-code
  9181        when other
  9182           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 173
* EL156.cbl
  9183           move pi-ah-benefit-cd to erpdef-ben-code
  9184     end-evaluate
  9185*    if (cl-claim-type = 'L' or 'P')
  9186*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9187*          and 'CU')
  9188*       move 'L'                 to erpdef-ben-type
  9189*       move pi-lf-benefit-cd    to erpdef-ben-code
  9190*    else
  9191*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9192*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9193*    end-if
  9194     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9195
  9196     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9197
  9198
  9199* EXEC CICS STARTBR
  9200*        DATASET  ('ERPDEF')
  9201*        RIDFLD   (ERPDEF-KEY)
  9202*        GTEQ
  9203*        RESP     (WS-RESPONSE)
  9204*    END-EXEC
  9205     MOVE 'ERPDEF' TO DFHEIV1
  9206     MOVE 0
  9207       TO DFHEIV11
  9208*    MOVE '&,         G          &  N#00008936' TO DFHEIV0
  9209     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9210     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9211     MOVE X'204E233030303038393336' TO DFHEIV0(25:11)
  9212     CALL 'kxdfhei1' USING DFHEIV0,
  9213           DFHEIV1,
  9214           ERPDEF-KEY,
  9215           DFHEIV99,
  9216           DFHEIV11,
  9217           DFHEIV99
  9218     MOVE EIBRESP  TO WS-RESPONSE
  9219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9220
  9221     IF NOT WS-RESP-NORMAL
  9222        GO TO 0900-EXIT
  9223     END-IF
  9224
  9225     .
  9226 0900-READNEXT.
  9227
  9228
  9229* EXEC CICS READNEXT
  9230*       DATASET  ('ERPDEF')
  9231*       SET      (ADDRESS OF PRODUCT-MASTER)
  9232*       RIDFLD   (ERPDEF-KEY)
  9233*       RESP     (WS-RESPONSE)
  9234*    END-EXEC
  9235     MOVE 'ERPDEF' TO DFHEIV1
  9236     MOVE 0
  9237       TO DFHEIV11
  9238*    MOVE '&.S                   )  N#00008950' TO DFHEIV0
  9239     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9240     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 174
* EL156.cbl
  9241     MOVE X'204E233030303038393530' TO DFHEIV0(25:11)
  9242     CALL 'kxdfhei1' USING DFHEIV0,
  9243           DFHEIV1,
  9244           DFHEIV20,
  9245           DFHEIV99,
  9246           ERPDEF-KEY,
  9247           DFHEIV99,
  9248           DFHEIV11,
  9249           DFHEIV99,
  9250           DFHEIV99
  9251     SET ADDRESS OF PRODUCT-MASTER TO
  9252         DFHEIV20
  9253     MOVE EIBRESP  TO WS-RESPONSE
  9254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9255
  9256     IF NOT WS-RESP-NORMAL
  9257        GO TO 0900-ENDBR
  9258     END-IF
  9259
  9260     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9261        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9262           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9263        ELSE
  9264           GO TO 0900-READNEXT
  9265        END-IF
  9266     ELSE
  9267        GO TO 0900-ENDBR
  9268     END-IF
  9269
  9270     IF CM-LOAN-TERM = ZEROS
  9271        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9272     END-IF
  9273
  9274     .
  9275 0900-ENDBR.
  9276
  9277
  9278* EXEC CICS ENDBR
  9279*       DATASET  ('ERPDEF')
  9280*    END-EXEC
  9281     MOVE 'ERPDEF' TO DFHEIV1
  9282     MOVE 0
  9283       TO DFHEIV11
  9284*    MOVE '&2                    $   #00008978' TO DFHEIV0
  9285     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9286     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9287     MOVE X'2020233030303038393738' TO DFHEIV0(25:11)
  9288     CALL 'kxdfhei1' USING DFHEIV0,
  9289           DFHEIV1,
  9290           DFHEIV11,
  9291           DFHEIV99
  9292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9293
  9294     .
  9295 0900-EXIT.
  9296     EXIT.
  9297 1000-EDIT-DATA.
  9298
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 175
* EL156.cbl
  9299     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9300         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9301         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9302
  9303     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9304
  9305     IF NOT MODIFY-CAP
  9306         MOVE ER-0070            TO EMI-ERROR
  9307         MOVE -1                 TO PMTTYPEL
  9308         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9309         GO TO 2000-EDIT-DONE.
  9310
  9311     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9312                         '5' AND '6'
  9313         MOVE ER-0420            TO EMI-ERROR
  9314         MOVE -1                 TO PMTTYPEL
  9315         MOVE AL-UABON           TO PMTTYPEA
  9316         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9317     ELSE
  9318         MOVE AL-UANON           TO PMTTYPEA.
  9319
  9320*    IF PI-OFFLINE = 'Y'
  9321*       IF PI-GROUPED = 'Y'
  9322*          MOVE ER-1880         TO EMI-ERROR
  9323*          MOVE -1              TO GROUPEDL
  9324*          MOVE AL-UABON        TO GROUPEDA
  9325*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9326*
  9327*    IF GROUPEDL > +0
  9328*       IF PI-GROUPED = 'Y' OR 'N'
  9329*          MOVE AL-UANON TO GROUPEDA
  9330*       ELSE
  9331*          MOVE ER-3140            TO EMI-ERROR
  9332*          MOVE -1                 TO GROUPEDL
  9333*          MOVE AL-UABON           TO GROUPEDA
  9334*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9335*
  9336*    IF CASHL > +0
  9337*       IF PI-CASH = 'Y' OR 'N'
  9338*          MOVE AL-UANON           TO CASHA
  9339*       ELSE
  9340*          MOVE ER-3141            TO EMI-ERROR
  9341*          MOVE -1                 TO CASHL
  9342*          MOVE AL-UABON           TO CASHA
  9343*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9344
  9345     IF LOANNOL > +0
  9346         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9347
  9348 1000-EDIT-PAYEE.
  9349
  9350     IF PI-PAYEE-SEQ NOT NUMERIC
  9351         MOVE ER-0294            TO  EMI-ERROR
  9352         MOVE -1                 TO  PAYEEL
  9353         MOVE AL-UABON           TO  PAYEEA
  9354         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9355         GO TO 1000-CONT-EDIT.
  9356
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 176
* EL156.cbl
  9357     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9358                         'E' OR 'O' OR 'Q'
  9359         NEXT SENTENCE
  9360     ELSE
  9361         MOVE ER-0294            TO  EMI-ERROR
  9362         MOVE -1                 TO  PAYEEL
  9363         MOVE AL-UABON           TO  PAYEEA
  9364         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9365         GO TO 1000-CONT-EDIT.
  9366
  9367     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9368        (PI-PAYEE-SEQ NOT < '1' AND
  9369         PI-PAYEE-SEQ NOT > '9'))
  9370      OR
  9371        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9372         (PI-PAYEE-SEQ NOT > '9'))
  9373         MOVE AL-UANON            TO PAYEEA
  9374     ELSE
  9375         MOVE ER-0294            TO EMI-ERROR
  9376         MOVE -1                 TO PAYEEL
  9377         MOVE AL-UABON           TO PAYEEA
  9378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9379
  9380     IF PI-COMPANY-ID = 'DMD'
  9381         IF PI-PAYEE-TYPE = 'B' AND
  9382            PI-PAYEE-SEQ NOT = '0'
  9383               MOVE ER-7841            TO EMI-ERROR
  9384               MOVE -1                 TO PAYEEL
  9385               MOVE AL-UABON           TO PAYEEA
  9386               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9387
  9388     IF PI-COMPANY-ID = 'JHL'
  9389         IF PI-PAYEE = 'B0'
  9390             NEXT SENTENCE
  9391           ELSE
  9392
  9393* EXEC CICS HANDLE CONDITION
  9394*            ENDFILE(1950-NOT-FOUND)
  9395*            NOTFND (1950-NOT-FOUND)
  9396*        END-EXEC
  9397*    MOVE '"$''I                  ! & #00009080' TO DFHEIV0
  9398     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9400     MOVE X'2620233030303039303830' TO DFHEIV0(25:11)
  9401     CALL 'kxdfhei1' USING DFHEIV0
  9402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9403         MOVE 'N'                    TO FOUND-TOL-SW
  9404         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9405         MOVE '2'                    TO CNTL-REC-TYPE
  9406         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9407         MOVE +0                     TO CNTL-SEQ-NO
  9408         MOVE 'PROC'                 TO FILE-SWITCH
  9409         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9410         IF PI-PAYEE = 'I1' AND
  9411            APPROVAL-LEVEL-2
  9412             NEXT SENTENCE
  9413           ELSE
  9414         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 177
* EL156.cbl
  9415             MOVE ER-3546        TO EMI-ERROR
  9416             MOVE -1             TO PAYEEL
  9417             MOVE AL-UABON       TO PAYEEA
  9418             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9419
  9420     IF PI-PAYEE-TYPE = 'E'
  9421        IF PI-PMTTYPE = '5' OR '6'
  9422            NEXT SENTENCE
  9423        ELSE
  9424            MOVE ER-3539            TO EMI-ERROR
  9425            MOVE -1                 TO PAYEEL
  9426            MOVE AL-UABON           TO PAYEEA
  9427            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9428
  9429 1000-CONT-EDIT.
  9430
  9431     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9432        IF PI-EPYAMT NOT NEGATIVE
  9433            MOVE ER-0421         TO EMI-ERROR
  9434            MOVE -1              TO OFFLINEL
  9435            MOVE AL-UABON        TO OFFLINEA
  9436            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9437        ELSE
  9438            MOVE AL-UANON        TO OFFLINEA.
  9439
  9440     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  9441        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9442           CONTINUE
  9443        ELSE
  9444           IF PI-PRINT-EOB-YN = 'S' AND
  9445              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9446                CONTINUE
  9447           ELSE
  9448              MOVE ER-1561       TO EMI-ERROR
  9449              MOVE -1            TO EOBYNL
  9450              MOVE AL-UABON      TO EOBYNA
  9451              PERFORM 9900-ERROR-FORMAT
  9452                                 THRU 9900-EXIT
  9453           END-IF
  9454        END-IF
  9455
  9456        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9457            MOVE ER-1566        TO EMI-ERROR
  9458            MOVE -1             TO CLMFMYNL
  9459            MOVE AL-UABON       TO CLMFMYNA
  9460            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9461        END-IF
  9462
  9463        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9464            MOVE ER-1567        TO EMI-ERROR
  9465            MOVE -1             TO SURVYYNL
  9466            MOVE AL-UABON       TO SURVYYNA
  9467            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9468        END-IF
  9469
  9470        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9471            MOVE ER-1569        TO EMI-ERROR
  9472            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 178
* EL156.cbl
  9473            MOVE AL-UABON       TO SPRELYNA
  9474            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9475        END-IF
  9476
  9477     END-IF
  9478     IF PI-EPYAMT IS NEGATIVE
  9479         IF PI-OFFLINE NOT = 'Y'
  9480             MOVE ER-0836        TO  EMI-ERROR
  9481             MOVE -1             TO  OFFLINEL
  9482             MOVE AL-UABON       TO  OFFLINEA
  9483             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9484
  9485     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9486        MOVE ER-0872             TO EMI-ERROR
  9487        MOVE -1                  TO PROOFDTL
  9488        MOVE AL-UABON            TO PROOFDTA
  9489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9490     ELSE
  9491        MOVE '4'                TO DC-OPTION-CODE
  9492        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9493        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9494        IF DATE-CONVERSION-ERROR
  9495            MOVE ER-0873        TO EMI-ERROR
  9496            MOVE -1                  TO PROOFDTL
  9497            MOVE AL-UABON            TO PROOFDTA
  9498            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9499        ELSE
  9500            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9501            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9502                MOVE ER-0873    TO EMI-ERROR
  9503                MOVE -1                  TO PROOFDTL
  9504                MOVE AL-UABON            TO PROOFDTA
  9505                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9506            END-IF
  9507        END-IF
  9508     END-IF.
  9509
  9510     IF PI-COMPANY-ID = 'DMD'
  9511        IF NOTE1L NOT = ZEROS
  9512            MOVE ER-7844        TO  EMI-ERROR
  9513            MOVE -1             TO  NOTE1L
  9514            MOVE AL-UABON       TO  NOTE1A
  9515            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9516
  9517     IF PI-COMPANY-ID = 'DMD'
  9518        IF NOTE2L NOT = ZEROS
  9519          GO TO 1004-DMD-EOB-CHECKS.
  9520
  9521     IF NOTE1L NOT > +0
  9522         GO TO 1005-CHECK-ERRORS.
  9523
  9524     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9525         GO TO 1005-CHECK-ERRORS.
  9526
  9527     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9528         GO TO 1003-HAN-PMT-NOTES.
  9529
  9530     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 179
* EL156.cbl
  9531
  9532     IF WS-PMTOPTION NUMERIC
  9533        IF WS-PMTOPTION > '00' AND < '17'
  9534           NEXT SENTENCE
  9535        ELSE
  9536           MOVE ER-0618          TO EMI-ERROR
  9537           MOVE -1               TO NOTE1L
  9538           MOVE AL-UABON         TO NOTE1A
  9539           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9540     ELSE
  9541        GO TO 1005-CHECK-ERRORS.
  9542
  9543     IF WS-PMTOPTION = '05' AND
  9544        WS-DOCNAME = SPACES
  9545          MOVE ER-0616             TO EMI-ERROR
  9546          MOVE -1                  TO NOTE1L
  9547          MOVE AL-UABON            TO NOTE1A
  9548          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9549
  9550     IF WS-PMTOPTION = '15' OR '16'
  9551
  9552* EXEC CICS BIF DEEDIT
  9553*            FIELD (WS-AMOUNT)
  9554*            LENGTH(08)
  9555*        END-EXEC
  9556     MOVE 08
  9557       TO DFHEIV11
  9558*    MOVE '@"L                   #   #00009232' TO DFHEIV0
  9559     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9560     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9561     MOVE X'2020233030303039323332' TO DFHEIV0(25:11)
  9562     CALL 'kxdfhei1' USING DFHEIV0,
  9563           WS-AMOUNT,
  9564           DFHEIV11
  9565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9566        IF (WS-NUM-AMT = ZEROS) OR
  9567           (WS-AMOUNT NOT NUMERIC)
  9568           MOVE ER-0617          TO EMI-ERROR
  9569           MOVE -1               TO NOTE1L
  9570           MOVE AL-UABON         TO NOTE1A
  9571           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9572
  9573     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9574
  9575     GO TO 1005-CHECK-ERRORS.
  9576
  9577 1003-HAN-PMT-NOTES.
  9578
  9579     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9580
  9581     IF WS-HAN-PMT-CODE = SPACE
  9582         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9583     ELSE
  9584     IF WS-HAN-PMT-CODE = 'A'
  9585         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9586                                 TO WS-HAN-PMT-NOTE
  9587     ELSE
  9588     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 180
* EL156.cbl
  9589         MOVE ':FINAL PAYMENT / DECEASED'
  9590                                 TO WS-HAN-PMT-NOTE
  9591     ELSE
  9592     IF WS-HAN-PMT-CODE = 'C'
  9593         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9594                                 TO WS-HAN-PMT-NOTE
  9595     ELSE
  9596     IF WS-HAN-PMT-CODE = 'D'
  9597         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9598                                 TO WS-HAN-PMT-NOTE
  9599     ELSE
  9600     IF WS-HAN-PMT-CODE = 'E'
  9601         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9602                                 TO WS-HAN-PMT-NOTE
  9603     ELSE
  9604     IF WS-HAN-PMT-CODE = 'F'
  9605         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9606                                 TO WS-HAN-PMT-NOTE
  9607     ELSE
  9608     IF WS-HAN-PMT-CODE = 'P'
  9609         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9610
  9611     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9612     GO TO 1005-CHECK-ERRORS.
  9613
  9614 1004-DMD-EOB-CHECKS.
  9615
  9616     INITIALIZE PI-AT-EOB-CODES.
  9617
  9618     IF NOTE2I (20:21) > SPACES
  9619         MOVE ER-7845          TO EMI-ERROR
  9620         MOVE -1               TO NOTE2L
  9621         MOVE AL-UABON         TO NOTE2A
  9622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9623         GO TO 1005-CHECK-ERRORS
  9624      ELSE
  9625         MOVE NOTE2I             TO W-EOB-CODES.
  9626
  9627     MOVE +1                     TO W-EOB-NDX.
  9628
  9629 1004-CHECK-EACH-EOB.
  9630
  9631     IF W-EOB-NDX > +5
  9632             OR
  9633        W-EOB-CODE (W-EOB-NDX) = SPACES
  9634         GO TO 1004-CHECK-DUP-EOB.
  9635
  9636     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9637         MOVE ER-0956            TO EMI-ERROR
  9638         MOVE -1                 TO NOTE2L
  9639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9640         GO TO 1005-CHECK-ERRORS.
  9641
  9642     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9643     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9644     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9645     MOVE 'DLO023'               TO PGM-NAME.
  9646
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 181
* EL156.cbl
  9647
  9648* EXEC CICS LINK
  9649*        PROGRAM    (PGM-NAME)
  9650*        COMMAREA   (CD-COMMUNICATION-AREA)
  9651*        LENGTH     (CD-RCRD-LENGTH)
  9652*    END-EXEC.
  9653*    MOVE '."C                   (   #00009317' TO DFHEIV0
  9654     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9656     MOVE X'2020233030303039333137' TO DFHEIV0(25:11)
  9657     CALL 'kxdfhei1' USING DFHEIV0,
  9658           PGM-NAME,
  9659           CD-COMMUNICATION-AREA,
  9660           CD-RCRD-LENGTH,
  9661           DFHEIV99,
  9662           DFHEIV99,
  9663           DFHEIV99,
  9664           DFHEIV99
  9665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9666
  9667
  9668     IF CD-RETURN-CODE = 'OK'
  9669         GO TO 1004-CONT.
  9670
  9671     MOVE -1                     TO NOTE2L.
  9672
  9673     IF CD-RETURN-CODE = '01'
  9674         MOVE ER-8310            TO EMI-ERROR
  9675         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9676         GO TO 1005-CHECK-ERRORS.
  9677
  9678     IF CD-RETURN-CODE = '02'
  9679         MOVE ER-8311            TO EMI-ERROR
  9680         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9681         GO TO 1005-CHECK-ERRORS.
  9682
  9683     IF CD-RETURN-CODE = '03'
  9684         MOVE ER-8312            TO EMI-ERROR
  9685         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9686         GO TO 1005-CHECK-ERRORS.
  9687
  9688     IF CD-RETURN-CODE = '04'
  9689         MOVE ER-8313            TO EMI-ERROR
  9690         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9691         GO TO 1005-CHECK-ERRORS.
  9692
  9693     IF CD-RETURN-CODE = '05'
  9694         MOVE ER-8314            TO EMI-ERROR
  9695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9696         GO TO 1005-CHECK-ERRORS.
  9697
  9698     IF CD-RETURN-CODE = '06'
  9699         MOVE ER-8315            TO EMI-ERROR
  9700         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9701         GO TO 1005-CHECK-ERRORS.
  9702
  9703     IF CD-RETURN-CODE = 'E1'
  9704         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 182
* EL156.cbl
  9705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9706         GO TO 1005-CHECK-ERRORS.
  9707
  9708     IF CD-RETURN-CODE = 'N1'
  9709         MOVE ER-8317            TO EMI-ERROR
  9710         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9711         GO TO 1005-CHECK-ERRORS.
  9712
  9713 1004-CONT.
  9714     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9715
  9716     ADD +1 TO W-EOB-NDX.
  9717     GO TO 1004-CHECK-EACH-EOB.
  9718
  9719 1004-CHECK-DUP-EOB.
  9720     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9721         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9722                               PI-AT-EOB-CODE (3) OR
  9723                               PI-AT-EOB-CODE (4) OR
  9724                               PI-AT-EOB-CODE (5)))
  9725                  OR
  9726        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9727         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9728                               PI-AT-EOB-CODE (4) OR
  9729                               PI-AT-EOB-CODE (5)))
  9730                  OR
  9731        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9732         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9733                               PI-AT-EOB-CODE (5)))
  9734                  OR
  9735        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9736         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9737            MOVE ER-8000            TO EMI-ERROR
  9738            MOVE AL-UABON           TO NOTE2A
  9739            MOVE -1                 TO NOTE2L
  9740            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9741            GO TO 1005-CHECK-ERRORS.
  9742
  9743 1005-CHECK-ERRORS.
  9744*    IF PI-COMPANY-ID NOT = 'DMD'
  9745        GO TO 1006-CHECK-ERRORS.
  9746
  9747*********  DMD CODE START ******************
  9748*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9749*       GO TO 1006-CHECK-ERRORS.
  9750*
  9751*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9752*
  9753*    COMPUTE W-PAYMENT-TOTAL
  9754*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9755*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9756*               AND
  9757*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9758*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9759*          MOVE ER-0967    TO EMI-ERROR
  9760*          MOVE -1         TO PMTTYPEL
  9761*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9762*
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 183
* EL156.cbl
  9763*    GO TO 1006-CHECK-ERRORS.
  9764*********  DMD CODE END ******************
  9765
  9766 1006-CHECK-ERRORS.
  9767     if emi-forcable-ctr = zeros
  9768        and emi-fatal-ctr = zeros
  9769        continue
  9770     else
  9771        IF NOT EMI-NO-ERRORS
  9772           GO TO 2000-EDIT-DONE
  9773        end-if
  9774     end-if
  9775
  9776* EXEC CICS HANDLE CONDITION
  9777*        NOTFND(1950-NOT-FOUND)
  9778*    END-EXEC.
  9779*    MOVE '"$I                   ! '' #00009430' TO DFHEIV0
  9780     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9782     MOVE X'2720233030303039343330' TO DFHEIV0(25:11)
  9783     CALL 'kxdfhei1' USING DFHEIV0
  9784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9785
  9786
  9787     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9788     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9789     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9790     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9791     MOVE 'MSTR'                 TO FILE-SWITCH.
  9792
  9793     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9794
  9795     IF PI-COMPANY-ID = 'DMD'
  9796         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9797
  9798     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9799        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9800           MOVE ER-0873    TO EMI-ERROR
  9801           MOVE -1                  TO PROOFDTL
  9802           MOVE AL-UABON            TO PROOFDTA
  9803           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9804        END-IF
  9805     END-IF
  9806     if cl-benefit-period = zeros
  9807        move er-1667             to emi-error
  9808        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9809     end-if
  9810     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9811     MOVE +95                    TO TRLR-SEQ-NO
  9812
  9813* EXEC CICS READ
  9814*       DATASET  ('ELTRLR')
  9815*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9816*       RIDFLD   (ELTRLR-KEY)
  9817*       RESP     (WS-RESPONSE)
  9818*    END-EXEC
  9819     MOVE 'ELTRLR' TO DFHEIV1
  9820*    MOVE '&"S        E          (  N#00009459' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 184
* EL156.cbl
  9821     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9823     MOVE X'204E233030303039343539' TO DFHEIV0(25:11)
  9824     CALL 'kxdfhei1' USING DFHEIV0,
  9825           DFHEIV1,
  9826           DFHEIV20,
  9827           DFHEIV99,
  9828           ELTRLR-KEY,
  9829           DFHEIV99,
  9830           DFHEIV99,
  9831           DFHEIV99
  9832     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9833         DFHEIV20
  9834     MOVE EIBRESP  TO WS-RESPONSE
  9835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9836
  9837     if ws-resp-normal
  9838        perform varying s1 from +1 by +1 until
  9839           at-note-error-no (s1) = spaces
  9840           if at-note-error-no (s1) = '1662'
  9841              continue
  9842           else
  9843              move at-note-error-no (s1)
  9844                                 to emi-error
  9845              if at-note-error-no (s1) = '1653'
  9846                 evaluate true
  9847                    when cl-claim-type = 'L'
  9848                       move '  LF  '
  9849                                 to emi-claim-type
  9850                    when cl-claim-type = 'I'
  9851                       move '  IU  '
  9852                                 to emi-claim-type
  9853                    when cl-claim-type = 'A'
  9854                       move '  AH  '
  9855                                 to emi-claim-type
  9856                    when other
  9857                       move ' FMLA '
  9858                                 to emi-claim-type
  9859                 end-evaluate
  9860              end-if
  9861              PERFORM 9900-ERROR-FORMAT
  9862                                 THRU 9900-EXIT
  9863           end-if
  9864        end-perform
  9865     end-if
  9866     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9867         IF PI-PMTTYPE = '5' OR '6'
  9868             NEXT SENTENCE
  9869         ELSE
  9870             MOVE ER-0555             TO EMI-ERROR
  9871             MOVE -1                  TO PMTTYPEL
  9872             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9873
  9874     IF CL-LAST-CLOSE-REASON = '2'
  9875         IF CL-CLAIM-STATUS = 'C'
  9876             MOVE ER-0760        TO  EMI-ERROR
  9877             MOVE -1             TO  PMTTYPEL
  9878             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 185
* EL156.cbl
  9879
  9880     IF PI-ACTIVITY-CODE = 9
  9881         MOVE ER-3538            TO  EMI-ERROR
  9882         MOVE -1                 TO  PMTTYPEL
  9883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9884
  9885     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9886         GO TO 1008-READ-CERT.
  9887**********************AIG LOGIC STARTS *********************
  9888     IF CL-CERT-PRIME = 'INCOMPLETE'
  9889         MOVE ER-3540            TO  EMI-ERROR
  9890         MOVE -1                 TO  PMTTYPEL
  9891         MOVE AL-UABON           TO  PMTTYPEA
  9892         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9893         GO TO 2000-EDIT-DONE.
  9894
  9895     IF PI-PMTTYPE = '4'
  9896         IF PI-EPYAMT IS NEGATIVE
  9897             IF PI-ECHECKNO-CR = 'CR'
  9898                 NEXT SENTENCE
  9899             ELSE
  9900                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9901
  9902     IF PI-PMTTYPE = '4'
  9903         IF PI-ECHECKNO-CR = 'CR'
  9904             IF PI-EPYAMT IS NEGATIVE
  9905                 NEXT SENTENCE
  9906             ELSE
  9907                 MOVE ER-0834    TO  EMI-ERROR
  9908                 MOVE -1         TO  EPYAMTL
  9909                 MOVE AL-UNBON   TO  EPYAMTA
  9910                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9911
  9912     IF PI-PMTTYPE = '4'
  9913         IF PI-EPYAMT IS NEGATIVE
  9914             IF PI-OFFLINE = 'Y'
  9915                 NEXT SENTENCE
  9916             ELSE
  9917                 MOVE 'Y'        TO  PI-OFFLINE
  9918                                     WS-OFFLINE
  9919                                     OFFLINEO
  9920                 MOVE AL-UANON   TO  OFFLINEA.
  9921
  9922*    IF PI-PMTTYPE = '4'
  9923*        IF PI-EPYAMT IS NEGATIVE
  9924*            IF PI-CASH = 'Y'
  9925*                NEXT SENTENCE
  9926*            ELSE
  9927*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9928*                MOVE AL-UANON   TO  CASHA
  9929*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9930*
  9931*    IF PI-CASH NOT = 'Y' AND 'N'
  9932*         IF PI-OFFLINE = 'Y'  AND
  9933*            PI-ECHECKNO-CR = 'CR'
  9934*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9935*              MOVE AL-UANON     TO  CASHA
  9936*              GO TO 1007-DEFAULT-AIG-CHECKNO.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 186
* EL156.cbl
  9937*
  9938*    IF PI-CASH NOT = 'Y' AND 'N'
  9939*        IF PI-PMTTYPE = '5' OR '6'
  9940*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9941*            MOVE AL-UANON       TO  CASHA
  9942*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9943*
  9944*    IF PI-CASH NOT = 'Y' AND 'N'
  9945*       IF CL-ASSOCIATES = 'N' OR 'A'
  9946*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9947*           MOVE AL-UANON        TO  CASHA
  9948*       ELSE
  9949*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9950*           MOVE AL-UANON        TO  CASHA.
  9951*
  9952*    IF PI-PMTTYPE = '5' OR '6'
  9953*        IF PI-CASH = 'N'
  9954*            MOVE ER-0819        TO  EMI-ERROR
  9955*            MOVE AL-UANON       TO  CASHA
  9956*            MOVE -1             TO  CASHL
  9957*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9958*
  9959*    IF CL-ASSOCIATES = 'N' OR 'A'
  9960*       IF CASHI = 'N'
  9961*        MOVE ER-3537            TO  EMI-ERROR
  9962*        MOVE AL-UANON           TO  CASHA
  9963*        MOVE -1                 TO  CASHL
  9964*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9965
  9966 1007-DEFAULT-AIG-CHECKNO.
  9967
  9968     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9969         MOVE ER-3532            TO  EMI-ERROR
  9970         MOVE -1                 TO  PMTTYPEL
  9971         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9972**********************AIG LOGIC ENDS ***********************
  9973
  9974 1008-READ-CERT.
  9975
  9976     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9977     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9978     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9979     MOVE CL-CERT-STATE          TO CERT-STATE.
  9980     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9981     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9982     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9983     MOVE 'CERT'                 TO FILE-SWITCH.
  9984
  9985     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9986
  9987     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9988        MOVE CM-LF-LOAN-EXPIRE-DT
  9989                                 TO WS-EXP-DT PI-EXP-DT
  9990                                    ws-extended-exp-dt
  9991     ELSE
  9992        MOVE CM-AH-LOAN-EXPIRE-DT
  9993                                 TO WS-EXP-DT PI-EXP-DT
  9994                                    ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 187
* EL156.cbl
  9995     end-if
  9996     MOVE '6'           TO DC-OPTION-CODE
  9997     if pi-dcc-product-code not = spaces
  9998        move cm-ah-benefit-cd    to pi-ah-benefit-cd
  9999        move cm-lf-benefit-cd    to pi-lf-benefit-cd
 10000        PERFORM 0900-GET-DDF-limits
 10001                                 THRU 0900-EXIT
 10002        IF PDEF-FOUND
 10003         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 10004           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10005              (P1 > +8)
 10006              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10007           END-PERFORM
 10008           IF P1 < +9
 10009              MOVE '6'           TO DC-OPTION-CODE
 10010              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10011              IF CL-NO-OF-EXTENSIONS NUMERIC
 10012               display ' 156 - no of ext ' CL-NO-OF-EXTENSIONS
 10013                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10014                                             PI-MAX-EXT
 10015              ELSE
 10016                 MOVE PD-MAX-EXTENSION (P1)
 10017                                 TO DC-ELAPSED-MONTHS
 10018              END-IF
 10019              PERFORM 9700-LINK-DATE-CONVERT
 10020                                 THRU 9700-EXIT
 10021              if no-conversion-error
 10022                 move dc-bin-date-2 to ws-extended-exp-dt
 10023              end-if
 10024           else
 10025              move er-1674       to emi-error
 10026              PERFORM 9900-ERROR-FORMAT
 10027                                 THRU 9900-EXIT
 10028           end-if
 10029        ELSE
 10030           IF CL-NO-OF-EXTENSIONS NUMERIC
 10031              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10032                                          PI-MAX-EXT
 10033           ELSE
 10034              MOVE ZERO  TO DC-ELAPSED-MONTHS
 10035           END-IF
 10036           MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10037           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10038           if no-conversion-error
 10039              move dc-bin-date-2 to ws-extended-exp-dt
 10040           end-if
 10041        end-if
 10042     ELSE
 10043        IF CL-NO-OF-EXTENSIONS NUMERIC
 10044           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10045                                       PI-MAX-EXT
 10046        ELSE
 10047           MOVE ZERO  TO DC-ELAPSED-MONTHS
 10048        END-IF
 10049        MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10050        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10051        if no-conversion-error
 10052           move dc-bin-date-2 to ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 188
* EL156.cbl
 10053        end-if
 10054     end-if
 10055*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10056*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10057
 10058     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10059         MOVE ER-0458            TO EMI-ERROR
 10060         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10061
 10062     IF (CL-INCURRED-DT > WS-EXP-DT)
 10063        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10064        MOVE ER-1677             TO EMI-ERROR
 10065        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10066     END-IF
 10067     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10068     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10069         MOVE ER-0459            TO EMI-ERROR
 10070         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10071
 10072     IF CL-REPORTED-DT = LOW-VALUES
 10073        MOVE ER-0530             TO EMI-ERROR
 10074        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10075
 10076     IF PI-COMPANY-ID = 'NCL'
 10077        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10078            MOVE ER-0770            TO EMI-ERROR
 10079            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10080
 10081     IF PI-COMPANY-ID = 'NCL'
 10082        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10083            MOVE ER-0737            TO EMI-ERROR
 10084            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10085
 10086     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10087         MOVE ER-0768            TO  EMI-ERROR
 10088         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10089
 10090     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10091         MOVE ER-0769            TO  EMI-ERROR
 10092         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10093
 10094     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10095         GO TO 1020-DO-LIFE-EDITS
 10096     ELSE
 10097         GO TO 1030-DO-AH-EDITS.
 10098
 10099 1010-GENERAL-ERROR.
 10100     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10101
 10102     IF EMI-MESSAGE-FORMATTED
 10103         MOVE -1                 TO PMTTYPEL.
 10104
 10105 1010-EXIT.
 10106     EXIT.
 10107
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 189
* EL156.cbl
 10109 1020-DO-LIFE-EDITS.
 10110     IF CM-LF-BENEFIT-CD = '00'
 10111         IF PI-PMTTYPE = '5' OR '6'
 10112             MOVE ER-0658        TO EMI-ERROR
 10113             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10114         ELSE
 10115            if (pi-company-id = 'DCC' or 'CAP')
 10116               and (pi-dcc-product-code not = spaces)
 10117               continue
 10118            else
 10119               MOVE ER-1775      TO EMI-ERROR
 10120               PERFORM 1040-PMTTYPE-ERROR
 10121                                 THRU 1040-EXIT
 10122            end-if
 10123         end-if
 10124     end-if
 10125
 10126     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10127     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10128         MOVE ER-0460            TO EMI-ERROR
 10129         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10130
 10131     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10132     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10133     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10134     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10135     MOVE '4'                    TO  CNTL-REC-TYPE.
 10136     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10137     MOVE 'BENE'                 TO  FILE-SWITCH.
 10138     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10139     IF NO-BENEFIT-FOUND
 10140         GO TO 1950-NOT-FOUND.
 10141
 10142     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10143
 10144     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10145         IF PI-PMTTYPE = '4'
 10146             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10147                PI-LF-COVERAGE-TYPE = 'P'
 10148                 NEXT SENTENCE
 10149             ELSE
 10150                 MOVE ER-0461        TO EMI-ERROR
 10151                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10152         ELSE
 10153            NEXT SENTENCE
 10154     ELSE
 10155         IF PI-PMTTYPE = '2'
 10156            IF NOT CM-O-B-COVERAGE
 10157              AND CM-LF-CURRENT-STATUS = '7'
 10158                MOVE ER-0462     TO EMI-ERROR
 10159                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10160
 10161     IF PI-PMTTYPE = '2'
 10162         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10163            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10164             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10165             MOVE ER-0730            TO  EMI-ERROR
 10166             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 190
* EL156.cbl
 10167             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10168
 10169     IF PI-PMTTYPE = '2'
 10170         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10171            PI-LF-COVERAGE-TYPE = 'P'
 10172             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10173                 MOVE ER-0462    TO  EMI-ERROR
 10174                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10175
 10176     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10177       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10178         MOVE ER-0466            TO EMI-ERROR
 10179         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10180
 10181     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10182         IF PI-PMTTYPE = '3'
 10183             MOVE 0436           TO EMI-ERROR
 10184             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10185             GO TO 1045-EDIT-PAYEE-ADDR
 10186         ELSE
 10187             GO TO 1045-EDIT-PAYEE-ADDR.
 10188
 10189     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10190        PI-LF-COVERAGE-TYPE = 'P'
 10191         IF PI-PMTTYPE = '3'
 10192             MOVE ER-0436          TO  EMI-ERROR
 10193             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10194         ELSE
 10195             NEXT SENTENCE
 10196     ELSE
 10197         IF PI-PMTTYPE = '1' OR '3'
 10198             MOVE ER-0436            TO EMI-ERROR
 10199             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10200*
 10201     IF PI-COMPANY-ID = 'CID' AND
 10202        CL-CERT-STATE = 'SC'  AND
 10203        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10204           MOVE ER-0879    TO  EMI-ERROR
 10205           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10206           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10207     END-IF.
 10208     IF PI-COMPANY-ID = 'AHL'
 10209        evaluate true
 10210           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10211              MOVE ER-0879       TO  EMI-ERROR
 10212              PERFORM 1040-PMTTYPE-ERROR
 10213                                 THRU 1040-EXIT
 10214              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10215           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10216                 '6D' OR '6H' OR '6R'
 10217              MOVE ER-0879       TO  EMI-ERROR
 10218              PERFORM 1040-PMTTYPE-ERROR
 10219                                 THRU 1040-EXIT
 10220              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10221           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10222              MOVE ER-0879       TO  EMI-ERROR
 10223              PERFORM 1040-PMTTYPE-ERROR
 10224                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 191
* EL156.cbl
 10225              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10226        end-evaluate
 10227     END-IF
 10228     GO TO 1045-EDIT-PAYEE-ADDR.
 10229
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 192
* EL156.cbl
 10231 1030-DO-AH-EDITS.
 10232     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10233     IF CM-AH-BENEFIT-CD = '00'
 10234         IF PI-PMTTYPE = '5' OR '6'
 10235             MOVE ER-0658        TO EMI-ERROR
 10236             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10237         ELSE
 10238             MOVE ER-1775        TO EMI-ERROR
 10239             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10240
 10241     IF CL-TOTAL-PAID-AMT = ZEROS
 10242         IF PI-PMTTYPE = '4'
 10243             MOVE ER-0438        TO EMI-ERROR
 10244             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10245
 10246     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10247         IF PI-PMTTYPE = '3'
 10248             MOVE ER-0463        TO EMI-ERROR
 10249             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10250         ELSE
 10251             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10252              AND CM-LF-CURRENT-STATUS = '7'
 10253                 MOVE ER-0465    TO EMI-ERROR
 10254                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10255
 10256     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10257         IF PI-PMTTYPE = '3'
 10258             MOVE ER-0464        TO EMI-ERROR
 10259             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10260         ELSE
 10261             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10262                 MOVE ER-0469    TO EMI-ERROR
 10263                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10264
 10265     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10266         IF PI-PMTTYPE = '3'
 10267             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10268                 MOVE ER-0467    TO EMI-ERROR
 10269                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10270             ELSE
 10271                 NEXT SENTENCE
 10272         ELSE
 10273             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10274                 MOVE ER-0468    TO EMI-ERROR
 10275                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10276
 10277     GO TO 1045-EDIT-PAYEE-ADDR.
 10278
 10279 1040-PMTTYPE-ERROR.
 10280     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10281
 10282     IF EMI-MESSAGE-FORMATTED
 10283         MOVE -1                 TO PMTTYPEL
 10284         MOVE AL-UABON           TO PMTTYPEA.
 10285
 10286 1040-EXIT.
 10287     EXIT.
 10288
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 193
* EL156.cbl
 10290 1045-EDIT-PAYEE-ADDR.
 10291
 10292     IF PI-OFFLINE = 'N' AND
 10293        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10294           < PI-PAYEE-SEQ-NUM)
 10295        OR
 10296         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10297         (PI-PAYEE-TYPE = 'B')                 AND
 10298         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10299        OR
 10300         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10301           < PI-PAYEE-SEQ-NUM)
 10302        OR
 10303         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10304           < PI-PAYEE-SEQ-NUM)
 10305        OR
 10306         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10307           < PI-PAYEE-SEQ-NUM)
 10308        OR
 10309         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10310           < PI-PAYEE-SEQ-NUM)
 10311        OR
 10312         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10313           < PI-PAYEE-SEQ-NUM))
 10314             MOVE ER-0437        TO EMI-ERROR
 10315             MOVE -1             TO PAYEEL
 10316             MOVE AL-UABON       TO PAYEEA
 10317             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10318
 10319     IF PI-OFFLINE    = 'N' AND
 10320        PI-PAYEE-TYPE = 'B' AND
 10321        PI-PAYEE-SEQ  = '0'
 10322         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10323         IF BENE-FOUND-SW = 'N'
 10324             MOVE ER-0437        TO EMI-ERROR
 10325             MOVE -1             TO PAYEEL
 10326             MOVE AL-UABON       TO PAYEEA
 10327             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10328
 10329     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10330        IF PI-OFFLINE    = 'N'  AND
 10331           PI-PAYEE-TYPE = 'B'  AND
 10332           PI-PAYEE-SEQ  = '9'
 10333             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10334             IF BENE-FOUND-SW = 'N'
 10335                MOVE ER-0437        TO EMI-ERROR
 10336                MOVE -1             TO PAYEEL
 10337                MOVE AL-UABON       TO PAYEEA
 10338                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10339
 10340*    IF PI-COMPANY-ID = 'CRI'
 10341*        IF CL-CLAIM-TYPE = 'L'
 10342*            MOVE 'N'                TO  WS-GROUPED
 10343*                                        PI-GROUPED
 10344*                                        GROUPEDI
 10345*            MOVE AL-UANON           TO  GROUPEDA
 10346*            GO TO 1050-EDIT-CHECK-NO
 10347*        ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 194
* EL156.cbl
 10348*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10349*            IF WS-GROUP-1 = 'C'
 10350*                NEXT SENTENCE
 10351*            ELSE
 10352*                MOVE 'N'            TO  WS-GROUPED
 10353*                                        PI-GROUPED
 10354*                                        GROUPEDI
 10355*                MOVE AL-UANON       TO  GROUPEDA
 10356*                GO TO 1050-EDIT-CHECK-NO.
 10357
 10358*     IF PI-GROUPED = 'Y'
 10359*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10360*           NEXT SENTENCE
 10361*        ELSE
 10362*           MOVE ER-0437        TO EMI-ERROR
 10363*           MOVE -1             TO PAYEEL
 10364**02180            MOVE AL-UABON       TO PAYEEA
 10365*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10366*
 10367*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10368*        (PI-GROUPED    = ' ')
 10369*        NEXT SENTENCE
 10370*     ELSE
 10371*
 10372     GO TO 1050-EDIT-CHECK-NO.
 10373*     IF PI-COMPANY-ID = 'CRI'
 10374*        MOVE 'N'           TO GROUPEDI
 10375*                              PI-GROUPED
 10376*                              WS-GROUPED
 10377*        MOVE AL-UANON      TO GROUPEDA.
 10378*
 10379*     IF PI-COMPANY-ID = 'CRI'
 10380*        IF PI-PAYEE-TYPE = 'B'
 10381*           IF BENE-FOUND-SW = 'Y'
 10382*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10383*                 MOVE 'Y'           TO GROUPEDI
 10384*                                       PI-GROUPED
 10385*                                       WS-GROUPED
 10386*                 MOVE AL-UANON      TO GROUPEDA
 10387*              ELSE
 10388*                 NEXT SENTENCE
 10389*           ELSE
 10390*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10391*              IF BENE-FOUND-SW = 'Y'
 10392*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10393*                    MOVE 'Y'      TO GROUPEDI
 10394*                                     PI-GROUPED
 10395*                                     WS-GROUPED
 10396*                    MOVE AL-UANON TO GROUPEDA.
 10397*
 10398
 10399     IF PI-COMPANY-ID NOT = 'CRI'
 10400        GO TO 1050-EDIT-CHECK-NO.
 10401
 10402*************** CRI CODE START ******************
 10403     IF PI-PAYEE-TYPE NOT = 'A'
 10404        GO TO 1050-EDIT-CHECK-NO.
 10405
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 195
* EL156.cbl
 10406     MOVE LOW-VALUES             TO ERACCT-KEY.
 10407     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10408     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10409     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10410     MOVE PI-STATE               TO ACCT-STATE.
 10411     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10412     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10413     MOVE 'ACCT'                 TO FILE-SWITCH.
 10414
 10415     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10416     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10417
 10418
 10419* EXEC CICS HANDLE CONDITION
 10420*         NOTFND   (1950-NOT-FOUND)
 10421*         ENDFILE  (1950-NOT-FOUND)
 10422*    END-EXEC.
 10423*    MOVE '"$I''                  ! ( #00010047' TO DFHEIV0
 10424     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10426     MOVE X'2820233030303130303437' TO DFHEIV0(25:11)
 10427     CALL 'kxdfhei1' USING DFHEIV0
 10428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10429
 10430
 10431
 10432* EXEC CICS STARTBR
 10433*         DATASET   ('ERACCT')
 10434*         RIDFLD    (ERACCT-KEY)
 10435*         GTEQ
 10436*    END-EXEC.
 10437     MOVE 'ERACCT' TO DFHEIV1
 10438     MOVE 0
 10439       TO DFHEIV11
 10440*    MOVE '&,         G          &   #00010052' TO DFHEIV0
 10441     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10442     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10443     MOVE X'2020233030303130303532' TO DFHEIV0(25:11)
 10444     CALL 'kxdfhei1' USING DFHEIV0,
 10445           DFHEIV1,
 10446           ERACCT-KEY,
 10447           DFHEIV99,
 10448           DFHEIV11,
 10449           DFHEIV99
 10450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10451
 10452
 10453 1046-READNEXT-ERACCT.
 10454
 10455
 10456* EXEC CICS READNEXT
 10457*         DATASET   ('ERACCT')
 10458*         RIDFLD    (ERACCT-KEY)
 10459*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10460*    END-EXEC.
 10461     MOVE 'ERACCT' TO DFHEIV1
 10462     MOVE 0
 10463       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 196
* EL156.cbl
 10464*    MOVE '&.S                   )   #00010060' TO DFHEIV0
 10465     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10466     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10467     MOVE X'2020233030303130303630' TO DFHEIV0(25:11)
 10468     CALL 'kxdfhei1' USING DFHEIV0,
 10469           DFHEIV1,
 10470           DFHEIV20,
 10471           DFHEIV99,
 10472           ERACCT-KEY,
 10473           DFHEIV99,
 10474           DFHEIV11,
 10475           DFHEIV99,
 10476           DFHEIV99
 10477     SET ADDRESS OF ACCOUNT-MASTER TO
 10478         DFHEIV20
 10479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10480
 10481
 10482     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10483        IF WS-ERACCT-HOLD-RECORD = SPACES
 10484           GO TO 1950-NOT-FOUND
 10485        ELSE
 10486           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10487           GO TO 1048-CONTINUE.
 10488
 10489     IF ACCT-EXP-DT = HIGH-VALUES
 10490        NEXT SENTENCE
 10491     ELSE
 10492        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10493        GO TO 1046-READNEXT-ERACCT.
 10494
 10495 1048-CONTINUE.
 10496
 10497*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10498*       MOVE 'Y'                 TO GROUPEDI
 10499*                                   PI-GROUPED
 10500*                                   WS-GROUPED
 10501*       MOVE AL-UANON            TO GROUPEDA.
 10502*************** CRI CODE END ******************
 10503
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 197
* EL156.cbl
 10505 1050-EDIT-CHECK-NO.
 10506
 10507     IF PI-OFFLINE = 'Y'
 10508         IF PI-ECHECKNO = SPACES
 10509              MOVE ER-0439        TO EMI-ERROR
 10510              GO TO 1090-CHECK-NO-ERROR
 10511           ELSE
 10512*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10513*           IF PI-ECHECKNO-N = 'N' AND
 10514*              PI-CASH       = 'Y'
 10515*                MOVE ER-3535        TO EMI-ERROR
 10516*                GO TO 1090-CHECK-NO-ERROR
 10517*             ELSE
 10518*                MOVE AL-UANON    TO CHECKNOA
 10519*                GO TO 1100-EDIT-HOLDTIL
 10520*         ELSE
 10521            MOVE AL-UANON    TO CHECKNOA
 10522            GO TO 1100-EDIT-HOLDTIL.
 10523
 10524     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10525     MOVE '6'                    TO CNTL-REC-TYPE.
 10526
 10527     IF CONTROL-IS-ACTUAL-CARRIER
 10528         MOVE PI-CARRIER         TO WS-CARR
 10529     ELSE
 10530         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10531
 10532     IF PI-COMPANY-ID = 'FIA'
 10533         MOVE PI-CARRIER         TO WS-CARR.
 10534
 10535     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10536     MOVE 0                      TO CNTL-SEQ-NO.
 10537     MOVE 'CARR'                 TO FILE-SWITCH.
 10538
 10539     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10540
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 198
* EL156.cbl
 10542     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10543         GO TO 1051-EDIT-CHECKNO-CONT.
 10544
 10545**********************AIG LOGIC STARTS**********************
 10546     IF PI-ECHECKNO = SPACES
 10547         IF CHECK-NO-MANUAL
 10548             MOVE ER-0441        TO EMI-ERROR
 10549             GO TO 1090-CHECK-NO-ERROR
 10550         ELSE
 10551             MOVE AL-UANOF       TO CHECKNOA
 10552             GO TO 1100-EDIT-HOLDTIL.
 10553
 10554     IF PI-ECHECKNO NOT = SPACES
 10555         IF CHECK-NO-MANUAL
 10556             MOVE AL-UANON       TO CHECKNOA
 10557             GO TO 1100-EDIT-HOLDTIL.
 10558
 10559     IF PI-ECHECKNO-CR = 'CR'
 10560        IF PI-OFFLINE = 'Y'
 10561            MOVE AL-UANON       TO CHECKNOA
 10562            GO TO 1100-EDIT-HOLDTIL
 10563        ELSE
 10564            MOVE ER-3534        TO EMI-ERROR
 10565            GO TO 1090-CHECK-NO-ERROR.
 10566
 10567     IF PI-ECHECKNO-N = 'N'
 10568        IF PI-CASH = 'N'
 10569            MOVE AL-UANON       TO CHECKNOA
 10570            GO TO 1100-EDIT-HOLDTIL
 10571        ELSE
 10572            MOVE ER-3535          TO EMI-ERROR
 10573            GO TO 1090-CHECK-NO-ERROR.
 10574
 10575     MOVE ER-0442        TO EMI-ERROR
 10576     GO TO 1090-CHECK-NO-ERROR.
 10577**********************AIG LOGIC ENDS************************
 10578
 10579 1051-EDIT-CHECKNO-CONT.
 10580
 10581     IF PI-COMPANY-ID = 'DMD'
 10582        IF PI-ECHECKNO NOT = SPACES
 10583           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10584              MOVE ER-0442        TO EMI-ERROR
 10585              GO TO 1090-CHECK-NO-ERROR
 10586            ELSE
 10587              GO TO 1100-EDIT-HOLDTIL
 10588          ELSE
 10589           GO TO 1100-EDIT-HOLDTIL.
 10590
 10591     IF PI-ECHECKNO = SPACES
 10592         IF CHECK-NO-MANUAL
 10593             MOVE ER-0441        TO EMI-ERROR
 10594             GO TO 1090-CHECK-NO-ERROR
 10595         ELSE
 10596             MOVE AL-UANOF       TO CHECKNOA
 10597             GO TO 1100-EDIT-HOLDTIL
 10598     ELSE
 10599         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 199
* EL156.cbl
 10600             MOVE AL-UANON       TO CHECKNOA
 10601             GO TO 1100-EDIT-HOLDTIL
 10602         ELSE
 10603             MOVE ER-0442        TO EMI-ERROR
 10604             GO TO 1090-CHECK-NO-ERROR.
 10605
 10606 1090-CHECK-NO-ERROR.
 10607     MOVE -1                     TO CHECKNOL.
 10608     MOVE AL-UABON               TO CHECKNOA.
 10609     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10610
 10611     GO TO 2000-EDIT-DONE.
 10612
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 200
* EL156.cbl
 10614 1100-EDIT-HOLDTIL.
 10615     MOVE AL-UANON               TO HOLDTILA.
 10616
 10617     IF PI-HOLDTIL = ZEROS
 10618        IF PI-OFFLINE = 'Y'
 10619           MOVE ER-0572          TO EMI-ERROR
 10620           GO TO 1105-HOLDTIL-ERROR
 10621        ELSE
 10622           GO TO 1110-EDIT-PAID-FROM.
 10623
 10624     MOVE '4'                    TO DC-OPTION-CODE.
 10625     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10626     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10627
 10628     IF DATE-CONVERSION-ERROR
 10629         MOVE ER-0446            TO EMI-ERROR
 10630         GO TO 1105-HOLDTIL-ERROR
 10631     END-IF
 10632     IF PI-OFFLINE = 'Y'
 10633        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10634           MOVE ER-0446            TO EMI-ERROR
 10635           GO TO 1105-HOLDTIL-ERROR
 10636        END-IF
 10637     END-IF
 10638
 10639     IF PI-OFFLINE = 'Y'
 10640        GO TO 1110-EDIT-PAID-FROM.
 10641
 10642     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10643     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10644     MOVE '1'                    TO DC-OPTION-CODE.
 10645     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10646
 10647     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10648         MOVE ER-0447            TO EMI-ERROR
 10649         GO TO 1105-HOLDTIL-ERROR.
 10650
 10651     GO TO 1110-EDIT-PAID-FROM.
 10652
 10653 1105-HOLDTIL-ERROR.
 10654     MOVE -1                     TO HOLDTILL.
 10655     MOVE AL-UNBON               TO HOLDTILA.
 10656     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10657
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 201
* EL156.cbl
 10659 1110-EDIT-PAID-FROM.
 10660     MOVE AL-UANON               TO EPYFROMA.
 10661
 10662     IF PI-EPYFROM = ZEROS
 10663         GO TO 1120-CALCULATE-PAID-FROM.
 10664
 10665     IF PI-PMTTYPE = '5' OR '6'
 10666         MOVE ER-0448            TO EMI-ERROR
 10667         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10668         MOVE AL-UNBON           TO EPYFROMA
 10669         MOVE -1                 TO EPYFROML
 10670         GO TO 1150-EDIT-PAID-THRU.
 10671
 10672     MOVE '4'                    TO DC-OPTION-CODE.
 10673     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10674     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10675
 10676     IF DATE-CONVERSION-ERROR
 10677         MOVE ER-0449            TO EMI-ERROR
 10678         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10679         MOVE AL-UNBON           TO EPYFROMA
 10680         MOVE -1                 TO EPYFROML
 10681     ELSE
 10682         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10683
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 202
* EL156.cbl
 10685 1120-CALCULATE-PAID-FROM.
 10686     IF PI-PMTTYPE = '5' OR '6'
 10687         GO TO 1150-EDIT-PAID-THRU.
 10688
 10689*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10690*       IF PI-PMTTYPE = '4'
 10691*         GO TO 1150-EDIT-PAID-THRU.
 10692
 10693     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10694         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10695         MOVE ' '                TO DC-OPTION-CODE
 10696         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10697         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10698         GO TO 1145-TEST-PAID-FROM.
 10699
 10700     IF PI-PMTTYPE = '4'
 10701        GO TO 1150-EDIT-PAID-THRU.
 10702
 10703     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10704     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10705     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10706     MOVE '5'                    TO CNTL-REC-TYPE.
 10707     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10708     MOVE 'BENE'                 TO FILE-SWITCH.
 10709
 10710     IF WS-BEN-CD = ZEROS
 10711         GO TO 1950-NOT-FOUND.
 10712
 10713     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10714
 10715     IF NO-BENEFIT-FOUND
 10716         GO TO 1950-NOT-FOUND.
 10717
 10718     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10719     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10720
 10721     IF PI-BEN-DAYS NOT NUMERIC
 10722        MOVE ZEROS               TO PI-BEN-DAYS.
 10723
 10724     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10725
 10726     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10727        (CL-TOTAL-PAID-AMT > ZEROS)
 10728         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10729         MOVE '6'                 TO DC-OPTION-CODE
 10730         MOVE +0                  TO DC-ELAPSED-MONTHS
 10731         MOVE +1                  TO DC-ELAPSED-DAYS
 10732         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10733         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10734         GO TO 1145-TEST-PAID-FROM.
 10735
 10736******************************************************************
 10737****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10738****** SPECIAL ENTERED DATE.
 10739******************************************************************
 10740
 10741     IF PI-AIGFROM = ZEROS
 10742         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 203
* EL156.cbl
 10743
 10744     MOVE AL-UANON TO AIGFROMA.
 10745
 10746     MOVE '4'                    TO DC-OPTION-CODE.
 10747     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10748     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10749
 10750     IF DATE-CONVERSION-ERROR
 10751         MOVE ER-0449            TO EMI-ERROR
 10752         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10753         MOVE AL-UNBON           TO AIGFROMA
 10754         MOVE -1                 TO AIGFROML
 10755         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10756     ELSE
 10757         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10758         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10759
 10760     GO TO 1140-CONTINUE-PAID-FROM.
 10761
 10762 1130-CONTINUE-PAID-FROM.
 10763
 10764     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10765        (CL-TOTAL-PAID-AMT = ZEROS)
 10766           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10767
 10768 1140-CONTINUE-PAID-FROM.
 10769
 10770     IF PI-BEN-TYPE = 'R'
 10771         IF PI-BEN-DAYS = ZEROS
 10772             NEXT SENTENCE
 10773         ELSE
 10774         IF PI-COMPANY-ID NOT = 'DMD'
 10775             SUBTRACT 1 FROM PI-BEN-DAYS.
 10776
 10777     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10778
 10779     IF PI-COMPANY-ID = 'DMD'
 10780         MOVE -1                 TO DC-ELAPSED-DAYS
 10781         MOVE +0                 TO DC-ELAPSED-MONTHS
 10782         MOVE '6'                TO DC-OPTION-CODE
 10783         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10784         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10785         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10786                               REMAINDER DC-ELAPSED-DAYS
 10787      ELSE
 10788         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10789         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10790
 10791     MOVE '6'                    TO DC-OPTION-CODE.
 10792     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10793     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10794
 10795     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10796
 10797     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10798         MOVE ER-0541            TO EMI-ERROR
 10799         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10800         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 204
* EL156.cbl
 10801         MOVE AL-UNBON           TO EPYFROMA.
 10802
 10803     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10804        (PI-BENEFIT-SAVE = '60E')
 10805        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10806           (CL-TOTAL-PAID-AMT = ZEROS)
 10807             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10808             MOVE 30                  TO DC-ELAPSED-DAYS
 10809             MOVE +0                  TO DC-ELAPSED-MONTHS
 10810             MOVE '6'                 TO DC-OPTION-CODE
 10811             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10812
 10813     IF PI-BEN-TYPE = 'R'
 10814         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10815     ELSE
 10816         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10817         IF WS-SV-EPYFROM = LOW-VALUES
 10818            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10819
 10820     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10821         IF WS-USE-AIG-PAYFROM   OR
 10822            WS-AIG-RECALC-PAYFROM
 10823              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10824                                      DC-BIN-DATE-1
 10825              MOVE ' '            TO  DC-OPTION-CODE
 10826              MOVE +0             TO  DC-ELAPSED-MONTHS
 10827                                      DC-ELAPSED-DAYS
 10828              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10829              IF NO-CONVERSION-ERROR
 10830                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10831
 10832     IF PI-CPYFROM < CL-INCURRED-DT
 10833        MOVE -1                  TO EPYFROML
 10834        MOVE ER-3542             TO EMI-ERROR
 10835        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10836
 10837     IF CM-ENTRY-DT < CL-INCURRED-DT
 10838        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10839        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10840        MOVE +0                     TO DC-ELAPSED-DAYS
 10841        MOVE +0                     TO DC-ELAPSED-MONTHS
 10842        MOVE '1'                    TO DC-OPTION-CODE
 10843        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10844        ELSE
 10845        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10846
 10847     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10848         NEXT SENTENCE
 10849     ELSE
 10850         IF DC-ELAPSED-MONTHS < 2
 10851             MOVE ER-3255        TO EMI-ERROR
 10852             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10853
 10854 1145-TEST-PAID-FROM.
 10855     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10856         GO TO 1150-EDIT-PAID-THRU.
 10857
 10858     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 205
* EL156.cbl
 10859         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10860         MOVE ' '                TO DC-OPTION-CODE
 10861         MOVE +0                 TO DC-ELAPSED-MONTHS
 10862                                    DC-ELAPSED-DAYS
 10863         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10864         IF NO-CONVERSION-ERROR
 10865             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10866         ELSE
 10867             MOVE SPACES             TO EMI-DATE-FIELD.
 10868
 10869     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10870         IF CL-TOTAL-PAID-AMT = ZEROS
 10871             MOVE ER-3543            TO EMI-ERROR
 10872             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10873             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10874             IF EMI-MESSAGE-FORMATTED
 10875                MOVE -1             TO EPYFROML
 10876                MOVE AL-UNBON       TO EPYFROMA
 10877             ELSE
 10878                NEXT SENTENCE
 10879         ELSE
 10880             MOVE ER-0452            TO EMI-ERROR
 10881             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10882             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10883             IF EMI-MESSAGE-FORMATTED
 10884                MOVE -1             TO EPYFROML
 10885                MOVE AL-UNBON       TO EPYFROMA.
 10886
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 206
* EL156.cbl
 10888 1150-EDIT-PAID-THRU.
 10889
 10890     MOVE AL-UANON               TO EPYTHRUA.
 10891
 10892     IF PI-EPYTHRU = ZEROS
 10893*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 10894         IF PI-PMTTYPE = '5' OR '6'
 10895           OR (CL-CLAIM-TYPE NOT = 'L' AND PI-PMTTYPE = '4')
 10896             GO TO 1200-EDIT-FIND-TOLERANCES
 10897         ELSE
 10898            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 10899               (PI-PMTTYPE = '2' AND
 10900                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10901               GO TO 1152-CHECK-TYPE
 10902            ELSE
 10903               MOVE ER-0473      TO EMI-ERROR
 10904               GO TO 1170-PAID-THRU-FATAL-ERROR
 10905     ELSE
 10906         IF PI-PMTTYPE = '5' OR '6'
 10907             MOVE ER-0474        TO EMI-ERROR
 10908             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10909
 10910     MOVE '4'                    TO DC-OPTION-CODE.
 10911     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10912     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10913
 10914     IF DATE-CONVERSION-ERROR
 10915         MOVE ER-0475            TO EMI-ERROR
 10916         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10917
 10918     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10919
 10920     IF PI-COMPANY-ID = 'DMD'
 10921         IF PI-PMTTYPE NOT = '2'
 10922                 AND
 10923            WS-EXP-DT > WS-SV-EPYTHRU
 10924             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10925             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10926             MOVE '1'              TO DC-OPTION-CODE
 10927             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10928             IF DATE-CONVERSION-ERROR
 10929                 MOVE ER-0944      TO EMI-ERROR
 10930                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10931             ELSE
 10932                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10933                    DC-ELAPSED-DAYS   = 1
 10934                     MOVE ER-0945  TO EMI-ERROR
 10935                     MOVE -1       TO EPYTHRUL
 10936                     MOVE AL-UABON TO EPYTHRUA
 10937                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10938
 10939     IF PI-PMTTYPE = '4'
 10940         NEXT SENTENCE
 10941     ELSE
 10942         IF WS-SV-EPYTHRU = WS-EXP-DT
 10943             IF PI-PMTTYPE NOT = '2' AND '3'
 10944                 MOVE ER-3541    TO EMI-ERROR
 10945                 MOVE -1         TO PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 207
* EL156.cbl
 10946                 MOVE AL-UABON   TO PMTTYPEA
 10947                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10948
 10949     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10950         MOVE ER-0501            TO EMI-ERROR
 10951         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10952
 10953     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10954        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10955*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10956*              MOVE ER-0540         TO EMI-ERROR
 10957*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10958*              MOVE -1              TO EPYTHRUL
 10959*              MOVE AL-UNBON        TO EPYTHRUA
 10960*          ELSE
 10961*          IF PI-COMPANY-ID = 'DMD'
 10962*              MOVE ER-7540         TO EMI-ERROR
 10963*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10964*              MOVE -1              TO EPYTHRUL
 10965*              MOVE AL-UNBON        TO EPYTHRUA
 10966*          ELSE
 10967               IF PI-PMTTYPE NOT = '2' AND '3'
 10968                  IF PI-COMPANY-ID = '???'
 10969                      MOVE ER-7540  TO EMI-ERROR
 10970                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10971                      MOVE -1       TO EPYTHRUL
 10972                      MOVE AL-UNBON TO EPYTHRUA
 10973                  ELSE
 10974                      MOVE ER-0540  TO EMI-ERROR
 10975                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10976                      MOVE -1       TO EPYTHRUL
 10977                      MOVE AL-UNBON TO EPYTHRUA.
 10978
 10979     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10980            OR
 10981        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10982         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10983            OR
 10984        (PI-CPYFROM NOT = LOW-VALUES AND
 10985         PI-CPYFROM < CL-PAID-THRU-DT)
 10986        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10987
 10988 1152-CHECK-TYPE.
 10989     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 10990        OR (PI-PMTTYPE = '5' OR '6')
 10991         GO TO 1160-EDIT-PAID-THRU-AH.
 10992
 10993 1155-EDIT-PAID-THRU-LIFE.
 10994     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10995     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10996     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10997     MOVE '4'                    TO CNTL-REC-TYPE.
 10998     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10999     MOVE 'BENE'                 TO FILE-SWITCH.
 11000
 11001     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11002
 11003     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 208
* EL156.cbl
 11004         GO TO 1950-NOT-FOUND.
 11005
 11006     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 11007
 11008     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 11009
 11010     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11011        PI-LF-COVERAGE-TYPE = 'P'
 11012         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 11013         GO TO 1200-EDIT-FIND-TOLERANCES.
 11014
 11015     IF PI-EPYTHRU = ZEROS
 11016        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 11017
 11018     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11019         MOVE ER-0476            TO EMI-ERROR
 11020         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11021
 11022     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 11023*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 11024     move cl-critical-period    to dc-elapsed-months
 11025     MOVE +0                    TO DC-ELAPSED-DAYS.
 11026     MOVE '6'                   TO DC-OPTION-CODE.
 11027     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11028
 11029     IF (NO-CONVERSION-ERROR AND
 11030         WS-SPECIAL-CALC-CD = 'C')
 11031        IF CL-INCURRED-DT > DC-BIN-DATE-2
 11032            MOVE ER-0657 TO EMI-ERROR
 11033            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11034
 11035     IF PI-COMPANY-ID = 'NCL'
 11036         IF WS-SPECIAL-CALC-CD = 'C' AND
 11037            cl-critical-period = zeros
 11038*           CM-LF-CRITICAL-PERIOD = +0
 11039             MOVE ER-0844       TO EMI-ERROR
 11040             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11041
 11042     GO TO 1200-EDIT-FIND-TOLERANCES.
 11043
 11044 1160-EDIT-PAID-THRU-AH.
 11045     IF PI-EPYTHRU = ZEROS
 11046        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11047                                    WS-SV-EPYTHRU
 11048     ELSE
 11049        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11050
 11051     IF WS-SV-EPYTHRU < PI-CPYFROM
 11052         MOVE ER-0508            TO EMI-ERROR
 11053         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11054
 11055     perform 7975-read-acct      thru 7975-exit
 11056     move zeros                  to pi-max-ext
 11057     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11058        PERFORM 0900-GET-DDF-LIMITS
 11059                                 THRU 0900-EXIT
 11060        IF PDEF-FOUND
 11061           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 209
* EL156.cbl
 11062              (P1 > +8)
 11063              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11064           END-PERFORM
 11065           IF P1 < +9
 11066              MOVE PD-MAX-extension (P1)
 11067                                 TO pi-max-ext
 11068           else
 11069              move er-1674       to emi-error
 11070              PERFORM 9900-ERROR-FORMAT
 11071                                 THRU 9900-EXIT
 11072           END-IF
 11073        else
 11074           move er-1672          to emi-error
 11075           PERFORM 9900-ERROR-FORMAT
 11076                                 THRU 9900-EXIT
 11077        END-IF
 11078     end-if
 11079     move spaces                 to pi-max-ext-used
 11080     IF PI-PMTTYPE = '3'
 11081        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11082        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11083           MOVE ER-0477          TO EMI-ERROR
 11084           PERFORM 1165-PAID-THRU-ERROR
 11085                                 THRU 1165-EXIT
 11086        ELSE
 11087           continue
 11088        end-if
 11089     ELSE
 11090        IF WS-SV-EPYTHRU > WS-EXP-DT
 11091         IF PI-DCC-PRODUCT-CODE NOT > SPACES
 11092           move ws-exp-dt        to dc-bin-date-1
 11093           move ws-sv-epythru    to dc-bin-date-2
 11094           MOVE '1'              TO DC-OPTION-CODE
 11095           MOVE +0               TO DC-ELAPSED-DAYS
 11096                                    DC-ELAPSED-MONTHS
 11097           PERFORM 9700-LINK-DATE-CONVERT
 11098                                 THRU 9700-EXIT
 11099           if no-conversion-error
 11100              if dc-elapsed-days > zeros
 11101                 add +1 to dc-elapsed-months
 11102              end-if
 11103              if dc-elapsed-months > pi-max-ext
 11104                 MOVE ER-0557    TO EMI-ERROR
 11105                 PERFORM 1165-PAID-THRU-ERROR
 11106                                 THRU 1165-EXIT
 11107              else
 11108                 move 'Y'        to pi-max-ext-used
 11109                 move er-1670    to emi-error
 11110                 perform 9900-error-format
 11111                                 thru 9900-exit
 11112              end-if
 11113           end-if
 11114         ELSE
 11115            MOVE ER-0557    TO EMI-ERROR
 11116            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 11117         END-IF
 11118        end-if
 11119     end-if
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 210
* EL156.cbl
 11120
 11121     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11122         PI-PMTTYPE NOT = '3'
 11123         MOVE ER-0541        TO EMI-ERROR
 11124         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11125
 11126     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11127        (PI-PMTTYPE NOT = '3')
 11128         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11129             MOVE ER-0478        TO EMI-ERROR
 11130             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11131
 11132     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11133        (PI-PMTTYPE NOT = '4')
 11134         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11135             MOVE ER-0479        TO EMI-ERROR
 11136             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11137
 11138     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11139         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11140             MOVE ER-0545        TO EMI-ERROR
 11141             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11142
 11143     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11144         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11145             MOVE ER-0481        TO EMI-ERROR
 11146             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11147
 11148*    IF PI-COMPANY-ID = 'NCL'
 11149*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11150*           CM-AH-CRITICAL-PERIOD = +0
 11151*            MOVE ER-0844        TO  EMI-ERROR
 11152*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11153
 11154*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11155     if (cl-critical-period = zeros)
 11156        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11157          GO TO 1200-EDIT-FIND-TOLERANCES.
 11158
 11159     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11160     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11161     MOVE '1'        TO DC-OPTION-CODE.
 11162     MOVE +0         TO DC-ELAPSED-DAYS
 11163                        DC-ELAPSED-MONTHS.
 11164     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11165
 11166*    IF NO-CONVERSION-ERROR
 11167*       COMPUTE ws-benefits-paid =
 11168*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11169*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11170*           MOVE ER-0657 TO EMI-ERROR
 11171*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11172
 11173     GO TO 1200-EDIT-FIND-TOLERANCES.
 11174
 11175 1165-PAID-THRU-ERROR.
 11176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11177
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 211
* EL156.cbl
 11178     IF EMI-MESSAGE-FORMATTED
 11179         MOVE -1                 TO EPYTHRUL
 11180         MOVE AL-UNBON           TO EPYTHRUA.
 11181
 11182 1165-EXIT.
 11183     EXIT.
 11184
 11185 1166-CHECK-ALL-TRLRS.
 11186
 11187     IF PI-PMTTYPE = '4'
 11188        GO TO 1166-TRLR-EXIT.
 11189
 11190     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11191
 11192     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11193        WS-SV-EPYFROM = LOW-VALUES
 11194          GO TO 1166-END-CHECK.
 11195
 11196
 11197* EXEC CICS HANDLE CONDITION
 11198*        ENDFILE   (1166-END-CHECK)
 11199*        NOTFND    (1166-END-CHECK)
 11200*    END-EXEC.
 11201*    MOVE '"$''I                  ! ) #00010780' TO DFHEIV0
 11202     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11204     MOVE X'2920233030303130373830' TO DFHEIV0(25:11)
 11205     CALL 'kxdfhei1' USING DFHEIV0
 11206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11207
 11208
 11209     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11210     MOVE +100                   TO TRLR-SEQ-NO.
 11211
 11212
 11213* EXEC CICS STARTBR
 11214*         DATASET    ('ELTRLR')
 11215*         RIDFLD     (ELTRLR-KEY)
 11216*         GTEQ
 11217*    END-EXEC.
 11218     MOVE 'ELTRLR' TO DFHEIV1
 11219     MOVE 0
 11220       TO DFHEIV11
 11221*    MOVE '&,         G          &   #00010788' TO DFHEIV0
 11222     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11223     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11224     MOVE X'2020233030303130373838' TO DFHEIV0(25:11)
 11225     CALL 'kxdfhei1' USING DFHEIV0,
 11226           DFHEIV1,
 11227           ELTRLR-KEY,
 11228           DFHEIV99,
 11229           DFHEIV11,
 11230           DFHEIV99
 11231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11232
 11233
 11234     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11235
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 212
* EL156.cbl
 11236 1166-READ-TRLR-NEXT.
 11237
 11238
 11239* EXEC CICS READNEXT
 11240*         DATASET    ('ELTRLR')
 11241*         RIDFLD     (ELTRLR-KEY)
 11242*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11243*    END-EXEC.
 11244     MOVE 'ELTRLR' TO DFHEIV1
 11245     MOVE 0
 11246       TO DFHEIV11
 11247*    MOVE '&.S                   )   #00010798' TO DFHEIV0
 11248     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11249     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11250     MOVE X'2020233030303130373938' TO DFHEIV0(25:11)
 11251     CALL 'kxdfhei1' USING DFHEIV0,
 11252           DFHEIV1,
 11253           DFHEIV20,
 11254           DFHEIV99,
 11255           ELTRLR-KEY,
 11256           DFHEIV99,
 11257           DFHEIV11,
 11258           DFHEIV99,
 11259           DFHEIV99
 11260     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11261         DFHEIV20
 11262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11263
 11264
 11265     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11266        TRLR-CARRIER  = MSTR-CARRIER  AND
 11267        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11268        TRLR-CERT-NO  = MSTR-CERT-NO
 11269          NEXT SENTENCE
 11270      ELSE
 11271          GO TO 1166-END-CHECK.
 11272
 11273* **  BYPASS ALL NON-PAYMENT TRAILERS
 11274
 11275     IF AT-TRAILER-TYPE = '2'
 11276        NEXT SENTENCE
 11277     ELSE
 11278        GO TO 1166-READ-TRLR-NEXT.
 11279
 11280* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11281
 11282     IF AT-PAYMENT-TYPE = '1' OR '2'
 11283        NEXT SENTENCE
 11284     ELSE
 11285        GO TO 1166-READ-TRLR-NEXT.
 11286
 11287* **  BYPASS ALL VOID PAYMENTS
 11288
 11289     IF AT-VOID-DT NOT = LOW-VALUES
 11290        GO TO 1166-READ-TRLR-NEXT.
 11291
 11292     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11293        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 213
* EL156.cbl
 11294          GO TO 1166-READ-TRLR-NEXT.
 11295
 11296     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11297         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11298            OR
 11299        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11300         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11301        NEXT SENTENCE
 11302     ELSE
 11303         IF CL-TOTAL-PAID-AMT > ZEROS
 11304             MOVE ER-0502            TO EMI-ERROR
 11305             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11306             MOVE -1                 TO EPYTHRUL
 11307             MOVE AL-UNBON           TO EPYTHRUA.
 11308
 11309     GO TO 1166-READ-TRLR-NEXT.
 11310
 11311 1166-END-CHECK.
 11312
 11313     IF WS-BROWSE-TRLR-SW = 'Y'
 11314
 11315* EXEC CICS ENDBR
 11316*            DATASET   ('ELTRLR')
 11317*       END-EXEC.
 11318     MOVE 'ELTRLR' TO DFHEIV1
 11319     MOVE 0
 11320       TO DFHEIV11
 11321*    MOVE '&2                    $   #00010853' TO DFHEIV0
 11322     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11323     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11324     MOVE X'2020233030303130383533' TO DFHEIV0(25:11)
 11325     CALL 'kxdfhei1' USING DFHEIV0,
 11326           DFHEIV1,
 11327           DFHEIV11,
 11328           DFHEIV99
 11329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11330
 11331
 11332     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11333
 11334 1166-TRLR-EXIT.
 11335     EXIT.
 11336
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 214
* EL156.cbl
 11338 1170-PAID-THRU-FATAL-ERROR.
 11339     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11340
 11341     MOVE -1                     TO EPYTHRUL.
 11342     MOVE AL-UNBON               TO EPYTHRUA.
 11343
 11344 1200-EDIT-FIND-TOLERANCES.
 11345
 11346* EXEC CICS HANDLE CONDITION
 11347*        ENDFILE(1950-NOT-FOUND)
 11348*        NOTFND (1950-NOT-FOUND)
 11349*    END-EXEC.
 11350*    MOVE '"$''I                  ! * #00010870' TO DFHEIV0
 11351     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11353     MOVE X'2A20233030303130383730' TO DFHEIV0(25:11)
 11354     CALL 'kxdfhei1' USING DFHEIV0
 11355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11356
 11357
 11358     IF PI-PROCESSOR-ID = 'LGXX'
 11359        GO TO 1240-FIND-ACCT-TOLERANCES.
 11360
 11361     MOVE 'N'                    TO FOUND-TOL-SW.
 11362     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11363     MOVE '2'                    TO CNTL-REC-TYPE.
 11364     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11365     MOVE +0                     TO CNTL-SEQ-NO.
 11366     MOVE 'PROC'                 TO FILE-SWITCH.
 11367
 11368     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11369
 11370     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11371     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11372                                    PI-MAX-PMT-TOL.
 11373     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11374
 11375     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11376         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11377
 11378     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11379     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11380                                    PI-MAX-LF-PMT-TOL.
 11381
 11382     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11383         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11384
 11385     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11386                                    PI-MAX-EXP-PMT.
 11387
 11388 1240-FIND-ACCT-TOLERANCES.
 11389
 11390     IF WS-PMT-TOL NOT = +0
 11391         MOVE 'Y'                TO FOUND-TOL-SW.
 11392
 11393     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11394         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11395         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 215
* EL156.cbl
 11396         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11397         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11398         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11399         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11400     ELSE
 11401         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11402         MOVE PI-CARRIER             TO ACCT-CARRIER
 11403         MOVE PI-GROUPING            TO ACCT-GROUPING
 11404         MOVE PI-STATE               TO ACCT-STATE
 11405         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11406         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11407
 11408     MOVE 'ACCT'                 TO FILE-SWITCH.
 11409
 11410     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11411     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11412
 11413
 11414* EXEC CICS HANDLE CONDITION
 11415*         NOTFND   (1950-NOT-FOUND)
 11416*         ENDFILE  (1950-NOT-FOUND)
 11417*    END-EXEC.
 11418*    MOVE '"$I''                  ! + #00010930' TO DFHEIV0
 11419     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11421     MOVE X'2B20233030303130393330' TO DFHEIV0(25:11)
 11422     CALL 'kxdfhei1' USING DFHEIV0
 11423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11424
 11425
 11426
 11427* EXEC CICS STARTBR
 11428*        DATASET('ERACCT')
 11429*        RIDFLD (ERACCT-KEY)
 11430*        GTEQ
 11431*    END-EXEC.
 11432     MOVE 'ERACCT' TO DFHEIV1
 11433     MOVE 0
 11434       TO DFHEIV11
 11435*    MOVE '&,         G          &   #00010935' TO DFHEIV0
 11436     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11437     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11438     MOVE X'2020233030303130393335' TO DFHEIV0(25:11)
 11439     CALL 'kxdfhei1' USING DFHEIV0,
 11440           DFHEIV1,
 11441           ERACCT-KEY,
 11442           DFHEIV99,
 11443           DFHEIV11,
 11444           DFHEIV99
 11445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11446
 11447
 11448 1245-FIND-ACCT-TOLERANCES-LOOP.
 11449
 11450
 11451* EXEC CICS READNEXT
 11452*        DATASET('ERACCT')
 11453*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 216
* EL156.cbl
 11454*        RIDFLD (ERACCT-KEY)
 11455*    END-EXEC.
 11456     MOVE 'ERACCT' TO DFHEIV1
 11457     MOVE 0
 11458       TO DFHEIV11
 11459*    MOVE '&.S                   )   #00010943' TO DFHEIV0
 11460     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11461     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11462     MOVE X'2020233030303130393433' TO DFHEIV0(25:11)
 11463     CALL 'kxdfhei1' USING DFHEIV0,
 11464           DFHEIV1,
 11465           DFHEIV20,
 11466           DFHEIV99,
 11467           ERACCT-KEY,
 11468           DFHEIV99,
 11469           DFHEIV11,
 11470           DFHEIV99,
 11471           DFHEIV99
 11472     SET ADDRESS OF ACCOUNT-MASTER TO
 11473         DFHEIV20
 11474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11475
 11476
 11477     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11478        IF WS-ERACCT-HOLD-RECORD = SPACES
 11479           GO TO 1950-NOT-FOUND
 11480        ELSE
 11481           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11482           GO TO 1250-CONTINUE.
 11483
 11484     IF ACCT-EXP-DT = HIGH-VALUES
 11485        NEXT SENTENCE
 11486     ELSE
 11487        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11488        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11489
 11490 1250-CONTINUE.
 11491
 11492     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11493
 11494     IF FOUND-TOL-SW = 'N'
 11495         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11496
 11497********* 1260-FIND-STATE-TOLERANCES.
 11498
 11499     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11500     MOVE PI-STATE               TO WS-ST-ACCESS.
 11501     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11502     MOVE '3'                    TO CNTL-REC-TYPE.
 11503     MOVE +0                     TO CNTL-SEQ-NO.
 11504     MOVE 'STAT'                 TO FILE-SWITCH.
 11505
 11506     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11507
 11508     IF WS-PMT-TOL = +0
 11509         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11510
 11511     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 217
* EL156.cbl
 11512     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11513     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11514     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11515     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11516
 11517****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11518****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11519     IF PI-PAYEE-TYPE <> 'B'
 11520           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11521     END-IF.
 11522
 11523     IF PI-PMTTYPE      = '2'  AND
 11524        PI-SPLIT-PMT-SW = 'Y'  AND
 11525        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11526          MOVE ER-3530                TO EMI-ERROR
 11527          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11528
 11529********* 1280-FIND-BENEFIT-TOLERANCES.
 11530
 11531     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11532        OR (PI-PMTTYPE = '5' OR '6')
 11533         GO TO 1300-FIND-CARR-TOLERANCES.
 11534
 11535     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11536     MOVE '4'                    TO CNTL-REC-TYPE.
 11537     MOVE +0                     TO CNTL-SEQ-NO.
 11538     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11539     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11540     MOVE 'BENE'                 TO FILE-SWITCH.
 11541
 11542     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11543
 11544     IF NO-BENEFIT-FOUND
 11545         GO TO 1950-NOT-FOUND.
 11546
 11547     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11548     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11549     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11550
 11551
 11552* EXEC CICS HANDLE CONDITION
 11553*        NOTFND(1950-NOT-FOUND)
 11554*    END-EXEC.
 11555*    MOVE '"$I                   ! , #00011023' TO DFHEIV0
 11556     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11558     MOVE X'2C20233030303131303233' TO DFHEIV0(25:11)
 11559     CALL 'kxdfhei1' USING DFHEIV0
 11560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11561
 11562
 11563 1300-FIND-CARR-TOLERANCES.
 11564     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11565     MOVE '6'                    TO CNTL-REC-TYPE.
 11566
 11567     IF CONTROL-IS-ACTUAL-CARRIER
 11568         MOVE PI-CARRIER               TO WS-CARR
 11569     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 218
* EL156.cbl
 11570         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11571
 11572     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11573     MOVE +0                     TO CNTL-SEQ-NO.
 11574     MOVE 'CARR'                 TO FILE-SWITCH.
 11575
 11576     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11577
 11578     IF WS-DAYS-TOL = +0
 11579         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11580
 11581     IF WS-PMT-TOL = +0
 11582         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11583
 11584     IF WS-MAX-DAYS-TOL = +0
 11585         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11586
 11587     IF WS-MAX-PMT-TOL = +0
 11588         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11589                                    PI-MAX-PMT-TOL.
 11590
 11591     IF WS-MAX-LF-PMT-TOL = +0
 11592        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11593                                    PI-MAX-LF-PMT-TOL.
 11594
 11595     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11596
 11597********* 1320-FIND-COMP-TOLERANCES.
 11598
 11599     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11600     MOVE '1'                    TO CNTL-REC-TYPE.
 11601     MOVE SPACES                 TO CNTL-ACCESS.
 11602     MOVE +0                     TO CNTL-SEQ-NO.
 11603     MOVE 'COMP'                 TO FILE-SWITCH.
 11604
 11605     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11606
 11607     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11608     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11609
 11610     IF WS-PMT-TOL NOT = +0
 11611        IF WS-TOL-SEVERITY NOT = ' '
 11612         GO TO 1360-EDIT-DAYS.
 11613
 11614     IF WS-PMT-TOL = +0
 11615         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11616
 11617     IF WS-TOL-SEVERITY = ' '
 11618         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11619
 11620 1360-EDIT-DAYS.
 11621     IF PI-PMTTYPE NOT = '4'
 11622        IF PI-EDAYS NEGATIVE OR
 11623           PI-EPYAMT NEGATIVE
 11624          MOVE ER-0513             TO EMI-ERROR
 11625          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11626          MOVE -1                  TO PMTTYPEL.
 11627
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 219
* EL156.cbl
 11628     IF PI-PMTTYPE = '5' OR '6'
 11629        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11630
 11631     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11632        IF PI-PMTTYPE = '4'
 11633          MOVE PI-EDAYS          TO PI-CDAYS.
 11634
 11635     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11636         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11637
 11638     IF PI-PMTTYPE = '4'
 11639        MOVE PI-EDAYS            TO PI-CDAYS
 11640        GO TO 1400-EDIT-PAYMENT.
 11641
 11642     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11643        GO TO 1500-EDIT-EXPENSES.
 11644
 11645*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11646*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11647*          CM-AH-BENEFIT-CD = '23'              AND
 11648*          CL-CERT-STATE    = '04'              AND
 11649*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11650*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11651*            GO TO 1362-CHECK-MAX-DAYS.
 11652
 11653     IF PI-EDAYS = ZEROS
 11654*        IF PI-COMPANY-ID = 'DMD'
 11655*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11656*            MOVE -1             TO DC-ELAPSED-DAYS
 11657*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11658*            MOVE '6'            TO DC-OPTION-CODE
 11659*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11660*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11661*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11662*            MOVE '1'            TO DC-OPTION-CODE
 11663*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11664*            IF NO-CONVERSION-ERROR
 11665*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11666*                                 + DC-ODD-DAYS-OVER
 11667*               MOVE 6           TO EDAYSL
 11668*               MOVE AL-UNNON    TO EDAYSA
 11669*            ELSE
 11670*                NEXT SENTENCE
 11671*       ELSE
 11672            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11673            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11674            MOVE '1'             TO DC-OPTION-CODE
 11675            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11676            IF NO-CONVERSION-ERROR
 11677                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11678                ADD 1                 TO PI-EDAYS
 11679                MOVE AL-UNNON         TO EDAYSA.
 11680
 11681*    IF PI-COMPANY-ID = 'DMD'
 11682*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11683*        MOVE -1                 TO DC-ELAPSED-DAYS
 11684*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11685*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 220
* EL156.cbl
 11686*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11687*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11688*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11689*        MOVE '1'                TO DC-OPTION-CODE
 11690*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11691*    ELSE
 11692         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11693         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11694         MOVE '1'                TO DC-OPTION-CODE.
 11695         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11696
 11697     IF NO-CONVERSION-ERROR
 11698        IF PI-COMPANY-ID = 'DMD'
 11699            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11700                             + DC-ODD-DAYS-OVER
 11701        ELSE
 11702            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11703            ADD 1                TO PI-CDAYS.
 11704
 11705     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11706        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11707        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11708
 11709     IF PI-EDAYS NOT NUMERIC
 11710         MOVE ER-0491            TO EMI-ERROR
 11711         GO TO 1370-DAYS-ERROR.
 11712
 11713     IF CL-NO-OF-PMTS-MADE = 0
 11714        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11715        AND CL-CERT-STATE = 'MI'
 11716        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11717            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11718     END-IF.
 11719
 11720 1362-CHECK-MAX-DAYS.
 11721
 11722     IF WS-MAX-DAYS-TOL = +999
 11723         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11724
 11725     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11726         IF PI-EDAYS = ZEROS
 11727             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11728         ELSE
 11729             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11730
 11731     IF WS-MAX-DAYS-TOL NOT = ZERO
 11732        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11733           PI-CDAYS > WS-MAX-DAYS-TOL
 11734             MOVE ER-0492          TO EMI-ERROR
 11735             GO TO 1370-DAYS-ERROR.
 11736
 11737 1365-SKIP-MAX-DAYS-EDIT.
 11738     IF PI-EDAYS = ZEROS
 11739        GO TO 1400-EDIT-PAYMENT.
 11740
 11741     IF WS-DAYS-TOL NOT = ZERO
 11742        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11743           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 221
* EL156.cbl
 11744                MOVE ER-0493     TO EMI-ERROR
 11745                GO TO 1370-DAYS-ERROR.
 11746
 11747     GO TO 1400-EDIT-PAYMENT.
 11748
 11749 1370-DAYS-ERROR.
 11750     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11751
 11752     IF EMI-MESSAGE-FORMATTED
 11753         MOVE -1                 TO EDAYSL
 11754         MOVE AL-UABON           TO EDAYSA.
 11755
 11756     GO TO 1400-EDIT-PAYMENT.
 11757
 11758 1380-EDIT-EXPENSE-PMT-AMT.
 11759     IF PI-PMTTYPE = '5' OR '6'
 11760         NEXT SENTENCE
 11761     ELSE
 11762         GO TO 1400-EDIT-PAYMENT.
 11763
 11764     IF WS-MAX-EXP-PMT NOT = ZEROS
 11765        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11766            MOVE ER-3529            TO EMI-ERROR
 11767            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11768
 11769     GO TO 1500-EDIT-EXPENSES.
 11770
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 222
* EL156.cbl
 11772
 11773 1390-CHECK-PAYMENT-DAYS.
 11774
 11775     IF PI-EDAYS = 0
 11776         MOVE PI-CDAYS TO WS-PD-DAYS
 11777     ELSE
 11778         MOVE PI-EDAYS TO WS-PD-DAYS
 11779     END-IF.
 11780
 11781     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11782         IF WS-PD-DAYS = 14
 11783            GO TO 1390-EXIT
 11784         END-IF
 11785     END-IF.
 11786
 11787     IF PI-COMPANY-ID = 'AHL'  AND
 11788        CM-AH-BENEFIT-CD = '1K'
 11789         IF WS-PD-DAYS = 14
 11790            GO TO 1390-EXIT
 11791         END-IF
 11792     END-IF.
 11793
 11794     IF WS-PD-DAYS < 30
 11795         MOVE ER-3549              TO EMI-ERROR
 11796         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11797     END-IF.
 11798
 11799 1390-EXIT.
 11800      EXIT.
 11801
 11802 1400-EDIT-PAYMENT.
 11803*    IF PI-COMPANY-ID = 'DMD'
 11804*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11805*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11806
 11807     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 11808        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11809        MOVE PI-CARRIER          TO ACCT-CARRIER
 11810        MOVE PI-GROUPING         TO ACCT-GROUPING
 11811        MOVE PI-STATE            TO ACCT-STATE
 11812        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11813        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11814        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11815        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11816
 11817
 11818* EXEC CICS READ
 11819*          DATASET ('ERACCT')
 11820*          RIDFLD  (ERACCT-KEY)
 11821*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11822*          GTEQ
 11823*          resp    (WS-RESPONSE)
 11824*       END-EXEC
 11825     MOVE 'ERACCT' TO DFHEIV1
 11826*    MOVE '&"S        G          (  N#00011281' TO DFHEIV0
 11827     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11828     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11829     MOVE X'204E233030303131323831' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 223
* EL156.cbl
 11830     CALL 'kxdfhei1' USING DFHEIV0,
 11831           DFHEIV1,
 11832           DFHEIV20,
 11833           DFHEIV99,
 11834           ERACCT-KEY,
 11835           DFHEIV99,
 11836           DFHEIV99,
 11837           DFHEIV99
 11838     SET ADDRESS OF ACCOUNT-MASTER TO
 11839         DFHEIV20
 11840     MOVE EIBRESP  TO WS-RESPONSE
 11841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11842        IF WS-RESP-NORMAL
 11843           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11844           and pi-cert-eff-dt < am-expiration-dt
 11845           and pi-cert-eff-dt >= am-effective-dt
 11846           move am-dcc-product-code to pi-dcc-product-code
 11847        else
 11848           move spaces           to pi-dcc-product-code
 11849        end-if
 11850        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11851           PERFORM 0900-GET-DDF-LIMITS
 11852                                 THRU 0900-EXIT
 11853           IF PDEF-FOUND
 11854              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11855                 (P1 > +8)
 11856                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11857              END-PERFORM
 11858              IF P1 < +9
 11859                 if pd-ben-pct (p1) not numeric
 11860                    move zeros   to pd-ben-pct (p1)
 11861                 end-if
 11862                 if pd-ben-pct (p1) = zeros
 11863                    move +1      to ws-work-ben-pct
 11864                 else
 11865                    move pd-ben-pct (p1)
 11866                                 to ws-work-ben-pct
 11867                 end-if
 11868                 compute cm-ah-benefit-amt =
 11869                    cm-ah-benefit-amt * ws-work-ben-pct
 11870                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11871                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11872                 end-if
 11873              else
 11874                 move er-1674    to emi-error
 11875                 PERFORM 9900-ERROR-FORMAT
 11876                                 THRU 9900-EXIT
 11877              END-IF
 11878           else
 11879              move er-1672       to emi-error
 11880              PERFORM 9900-ERROR-FORMAT
 11881                                 THRU 9900-EXIT
 11882           END-IF
 11883        end-if
 11884     END-IF
 11885     IF PI-PMTTYPE NOT = '4'
 11886        GO TO 1405-CALC-PAYMENT.
 11887     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 224
* EL156.cbl
 11888         MOVE PI-EPYAMT           TO PI-CPYAMT
 11889         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11890         GO TO 1430-CHECK-AH-TOLERANCE.
 11891
 11892*    IF PI-COMPANY-ID = 'FIA'
 11893*       IF CERT-ACCOUNT = '0000011043'
 11894*        COMPUTE PI-DAILY-RATE ROUNDED =
 11895*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11896*        COMPUTE PI-CPYAMT ROUNDED =
 11897*                          PI-DAILY-RATE * PI-EDAYS
 11898*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11899*        GO TO 1430-CHECK-AH-TOLERANCE.
 11900
 11901     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11902         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11903         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11904         GO TO 1420-CHECK-AIG-BENEFIT.
 11905
 11906     IF WS-CALC-METHOD = '2' OR  '5'
 11907         COMPUTE PI-DAILY-RATE ROUNDED =
 11908                        (CM-AH-BENEFIT-AMT * 12) / 365
 11909         COMPUTE PI-CPYAMT ROUNDED =
 11910                           PI-DAILY-RATE * PI-EDAYS
 11911        GO TO 1420-CHECK-AIG-BENEFIT.
 11912
 11913     IF WS-CALC-METHOD = '3'
 11914         COMPUTE PI-DAILY-RATE =
 11915                         (CM-AH-BENEFIT-AMT * 12) / 365
 11916         COMPUTE PI-CPYAMT ROUNDED =
 11917                           PI-DAILY-RATE * PI-EDAYS
 11918        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 225
* EL156.cbl
 11920*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11921
 11922****************************************************************
 11923****************************************************************
 11924*                  CALCULATED FROM      PAYMENT      PAYMENT
 11925*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11926* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11927*1-01-83  1-15-83    0    15     15        15           15
 11928*1-01-83  1-30-83    0    30     30        30           30
 11929*1-01-83  1-31-83    1     0     31        30           30
 11930*1-01-83  2-01-83    1     1     32        31           31
 11931*1-01-83  2-15-83    1    15     46        45           45
 11932*1-01-83  2-28-83    2     0     59        60           60
 11933*1-01-83  3-01-83    2     1     60        61           61
 11934*1-01-83  3-31-83    3     0     90        90           90
 11935*1-15-83  1-31-83    0    17     17        17           16
 11936*1-15-83  2-01-83    0    18     18        18           17
 11937*1-15-83  2-28-83    1    14     45        44           46
 11938*1-21-83  3-09-83    1    20     48        50           49
 11939*2-05-83  3-06-83    1     2     30        32           32
 11940*2-05-83  3-23-83    1    19     47        49           49
 11941*2-15-83  2-28-83    0    14     14        14           16
 11942*2-15-83  3-01-83    0    15     15        15           17
 11943*2-21-83  3-19-83    0    27     27        27           29
 11944*2-21-83  3-20-83    1     0     28        30           30
 11945*2-21-83  4-10-83    1    18     49        30           50
 11946*2-21-83  5-19-83    2    27     88        87           89
 11947*2-21-83  5-22-83    3     2     91        92           92
 11948*3-21-83  5-19-83    1    30     60        60           59
 11949****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 226
* EL156.cbl
 11951 1405-CALC-PAYMENT.
 11952     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11953     MOVE ' '                    TO DC-OPTION-CODE.
 11954     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11955     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11956     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11957
 11958     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11959     MOVE ' '                    TO DC-OPTION-CODE.
 11960     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11961     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11962     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11963
 11964     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11965     MOVE -1                     TO DC-ELAPSED-DAYS.
 11966     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11967     MOVE '6'                    TO DC-OPTION-CODE.
 11968     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11969     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11970
 11971     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11972     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11973     MOVE '1'                    TO DC-OPTION-CODE.
 11974     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11975
 11976     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11977     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11978     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11979
 11980******************************************************************
 11981*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11982*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11983*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11984******************************************************************
 11985
 11986     IF WS-CALC-METHOD = '1'           AND
 11987        DC-ELAPSED-MONTHS > ZERO AND
 11988        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11989        WDF-DAY > WDT-DAY
 11990          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11991          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11992          MOVE -1                  TO DC-ELAPSED-MONTHS
 11993          MOVE '6'                 TO DC-OPTION-CODE
 11994          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11995          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11996          COMPUTE WS-SAVE-ODD-DAYS =
 11997          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11998          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11999
 12000     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 12001     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 12002     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 12003
 12004     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 12005     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 12006
 12007*    IF PI-COMPANY-ID = 'FIA'
 12008*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 227
* EL156.cbl
 12009*        COMPUTE PI-DAILY-RATE ROUNDED =
 12010*                          (CM-AH-BENEFIT-AMT * 13) / 365
 12011*        COMPUTE PI-CPYAMT ROUNDED =
 12012*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 12013*        GO TO 1420-CHECK-AIG-BENEFIT.
 12014
 12015*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12016*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 12017*          CM-AH-BENEFIT-CD = '23'               AND
 12018*          CL-CERT-STATE    = '04'               AND
 12019*         (PI-PMTTYPE = '1' OR '2' OR '3')
 12020*            COMPUTE WS-DAILY-RATE ROUNDED =
 12021*                               CM-AH-BENEFIT-AMT / 30
 12022*            COMPUTE PI-CPYAMT ROUNDED =
 12023*                               (WS-DAILY-RATE * PI-CDAYS)
 12024*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12025*            GO TO 1420-CHECK-AIG-BENEFIT.
 12026
 12027     IF WS-CALC-METHOD = '1'
 12028         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12029         COMPUTE PI-CPYAMT ROUNDED =
 12030             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12031             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12032         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 12033         GO TO 1420-CHECK-AIG-BENEFIT.
 12034
 12035     IF WS-CALC-METHOD = '2'
 12036         COMPUTE PI-DAILY-RATE ROUNDED =
 12037                          (CM-AH-BENEFIT-AMT * 12) / 365
 12038         COMPUTE PI-CPYAMT ROUNDED =
 12039             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12040             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12041         GO TO 1420-CHECK-AIG-BENEFIT.
 12042
 12043     IF WS-CALC-METHOD = '4'
 12044         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12045         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12046         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12047         COMPUTE PI-CPYAMT ROUNDED =
 12048                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12049         GO TO 1420-CHECK-AIG-BENEFIT.
 12050
 12051     IF WS-CALC-METHOD = '5'
 12052         COMPUTE PI-DAILY-RATE ROUNDED =
 12053                            (CM-AH-BENEFIT-AMT * 12) / 365
 12054         COMPUTE PI-CPYAMT ROUNDED =
 12055                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12056         GO TO 1420-CHECK-AIG-BENEFIT.
 12057
 12058     IF WS-CALC-METHOD NOT = '3'
 12059        GO TO 1410-CHECK-PAYMENT.
 12060
 12061******   CALCULATION METHOD  3  ROUTINE
 12062     COMPUTE PI-DAILY-RATE =
 12063                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12064
 12065******CHECK TO SEE IF WITHIN SAME MONTH
 12066     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 228
* EL156.cbl
 12067        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12068                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12069         GO TO 1420-CHECK-AIG-BENEFIT.
 12070
 12071******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12072     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12073             SAVE-ODD-DAYS-OVER = ZEROS
 12074      COMPUTE PI-CPYAMT  ROUNDED =
 12075                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12076      GO TO 1420-CHECK-AIG-BENEFIT.
 12077
 12078******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12079******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12080     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12081        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12082        IF WDF-MONTH > 12
 12083           ADD 1                 TO WDF-YEAR
 12084           SUBTRACT 12         FROM WDF-MONTH.
 12085
 12086******CONVERT THE NEW FROM MONTH TO BINARY
 12087     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12088        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12089        MOVE '4'              TO DC-OPTION-CODE
 12090        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12091        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12092
 12093     IF WDF-MONTH = WDT-MONTH AND
 12094        WDF-YEAR  = WDT-YEAR
 12095          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12096                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12097                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12098        ELSE
 12099          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12100          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12101          COMPUTE PI-CPYAMT ROUNDED =
 12102       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12103       +
 12104       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12105       +
 12106       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12107
 12108     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 229
* EL156.cbl
 12110 1410-CHECK-PAYMENT.
 12111******PAYMENT OPTION 6
 12112******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12113     IF SAVE-ELAPSED-MONTHS > ZERO
 12114        IF SAVE-ODD-DAYS-OVER = ZEROS
 12115           GO TO 1412-CHECK-TO-DAY
 12116        ELSE
 12117           IF WDF-DAY > WDT-DAY
 12118              IF WDF-MONTH = 02
 12119                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12120                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12121                  GO TO 1412-CHECK-TO-DAY
 12122              ELSE
 12123                  IF FROM-DAYS-IN-MONTH = 31
 12124                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12125                     GO TO 1412-CHECK-TO-DAY
 12126                  ELSE
 12127                     GO TO 1412-CHECK-TO-DAY
 12128           ELSE
 12129               GO TO 1412-CHECK-TO-DAY.
 12130
 12131     IF WDF-MONTH NOT = WDT-MONTH
 12132        IF WDF-MONTH = 02
 12133           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12134           IF WDF-DAY = 29
 12135              ADD 1              TO SAVE-ODD-DAYS-OVER
 12136           ELSE
 12137              ADD 2              TO SAVE-ODD-DAYS-OVER
 12138        ELSE
 12139           IF FROM-DAYS-IN-MONTH = 31
 12140              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12141
 12142 1412-CHECK-TO-DAY.
 12143        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12144           IF WDT-DAY = 28
 12145              ADD 2              TO SAVE-ODD-DAYS-OVER
 12146           ELSE
 12147              IF WDT-DAY = 29
 12148                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12149              ELSE
 12150                 NEXT SENTENCE
 12151        ELSE
 12152           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12153              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12154
 12155     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12156     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12157     COMPUTE PI-CPYAMT ROUNDED =
 12158         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12159         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12160
 12161     GO TO 1420-CHECK-AIG-BENEFIT.
 12162
 12163 1415-CHECK-LEAP-YEAR.
 12164     IF FROM-DAYS-IN-MONTH = 29
 12165        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12166
 12167 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 230
* EL156.cbl
 12168     EXIT.
 12169
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 231
* EL156.cbl
 12171 1420-CHECK-AIG-BENEFIT.
 12172
 12173     IF WS-SPECIAL-CALC-CD = 'Q'
 12174         GO TO 1425-CHECK-WHOLE-MONTH.
 12175
 12176*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12177*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12178*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12179*       (PI-PMTTYPE = '1' OR '2')
 12180*        NEXT SENTENCE
 12181*    ELSE
 12182         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12183         GO TO 1430-CHECK-AH-TOLERANCE.
 12184
 12185******************AIG LOGIC STARTS**********************
 12186*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12187*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12188*    MOVE ER-3533      TO EMI-ERROR.
 12189*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12190*    GO TO 1430-CHECK-AH-TOLERANCE.
 12191******************AIG LOGIC ENDS************************
 12192
 12193 1425-CHECK-WHOLE-MONTH.
 12194******************************************************************
 12195****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12196****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12197****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12198****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12199****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12200****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12201****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12202****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12203****          PAID * MONTHLY BENEFIT.                         ****
 12204******************************************************************
 12205
 12206     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12207
 12208     IF CL-NO-OF-PMTS-MADE > +0
 12209         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12210
 12211     IF PI-CDAYS < WS-BEN-DAYS
 12212         GO TO 1430-CHECK-AH-TOLERANCE.
 12213
 12214     IF PI-CDAYS = WS-BEN-DAYS
 12215         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12216         GO TO 1430-CHECK-AH-TOLERANCE.
 12217
 12218*    IF PI-COMPANY-ID = 'ACM'
 12219*       NEXT SENTENCE
 12220*    ELSE
 12221        GO TO 1425-NOT-ACM-W15C.
 12222
 12223*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12224*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12225*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12226*    MOVE '6'                    TO  DC-OPTION-CODE.
 12227*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12228*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 232
* EL156.cbl
 12229*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12230*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12231*       MOVE '1'                 TO  DC-OPTION-CODE
 12232*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12233*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12234*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12235*       IF NO-CONVERSION-ERROR
 12236*          IF (DC-ELAPSED-MONTHS > +0) OR
 12237*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12238*             NEXT SENTENCE
 12239*          ELSE
 12240*             MOVE +0            TO  PI-CPYAMT
 12241*             MOVE ER-0846       TO  EMI-ERROR
 12242*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12243*             GO TO 1430-CHECK-AH-TOLERANCE
 12244*       ELSE
 12245*           MOVE ER-0846         TO  EMI-ERROR
 12246*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12247*           GO TO 1430-CHECK-AH-TOLERANCE.
 12248*
 12249*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12250*       ADD +1 TO DC-ELAPSED-MONTHS.
 12251*
 12252*    COMPUTE PI-CPYAMT ROUNDED =
 12253*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12254*
 12255*    GO TO 1430-CHECK-AH-TOLERANCE.
 12256
 12257 1425-NOT-ACM-W15C.
 12258
 12259     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12260     MOVE '6'                        TO  DC-OPTION-CODE.
 12261     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12262     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12263
 12264     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12265     IF NO-CONVERSION-ERROR
 12266         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12267     ELSE
 12268         MOVE ER-0846                TO  EMI-ERROR
 12269         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12270         GO TO 1430-CHECK-AH-TOLERANCE.
 12271
 12272     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12273     MOVE '1'                        TO  DC-OPTION-CODE.
 12274     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12275     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12276     IF NO-CONVERSION-ERROR
 12277         IF DC-ODD-DAYS-OVER = +0
 12278             NEXT SENTENCE
 12279         ELSE
 12280             MOVE ER-0846            TO  EMI-ERROR
 12281             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12282             GO TO 1430-CHECK-AH-TOLERANCE
 12283     ELSE
 12284         MOVE ER-0846                TO  EMI-ERROR
 12285         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12286         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 233
* EL156.cbl
 12287
 12288     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12289         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12290
 12291     GO TO 1430-CHECK-AH-TOLERANCE.
 12292
 12293 1425-CONT-WHOLE-MONTH-PMTS.
 12294******************************************************************
 12295****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12296****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12297****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12298******************************************************************
 12299
 12300     IF PI-COMPANY-ID = 'ACM'
 12301        NEXT SENTENCE
 12302     ELSE
 12303        IF DC-ODD-DAYS-OVER = +0
 12304            NEXT SENTENCE
 12305        ELSE
 12306            MOVE ER-0845            TO  EMI-ERROR
 12307            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12308            GO TO 1430-CHECK-AH-TOLERANCE.
 12309
 12310     COMPUTE PI-CPYAMT ROUNDED =
 12311                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12312
 12313 1430-CHECK-AH-TOLERANCE.
 12314     IF PI-PMT-APPR-SW = 'G'
 12315         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12316
 12317*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12318*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12319*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12320*
 12321*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12322*      IF WDF-MONTH = 02
 12323*        IF SAVE-ELAPSED-MONTHS = 0
 12324*          NEXT SENTENCE
 12325*        ELSE
 12326*          IF SAVE-ODD-DAYS-OVER > 0
 12327*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12328*            COMPUTE WS-PMT-MOS ROUNDED =
 12329*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12330*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12331*                                     WS-PMT-MOS
 12332*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12333*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12334*          ELSE
 12335*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12336*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12337*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12338*                                     WS-PMT-MOS.
 12339
 12340     IF WS-MAX-PMT-TOL NOT = ZERO
 12341        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12342           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12343            MOVE ER-0494         TO  EMI-ERROR
 12344            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 234
* EL156.cbl
 12345            GO TO 1500-EDIT-EXPENSES.
 12346
 12347 1430-CONT-CHECK-AH-TOLERANCE.
 12348
 12349     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12350        GO TO 1500-EDIT-EXPENSES.
 12351
 12352     IF CM-O-B-COVERAGE
 12353        GO TO 1500-EDIT-EXPENSES.
 12354
 12355     IF PI-COMPANY-ID = 'NCL'
 12356       IF FOUND-TOL-SW = 'Y'
 12357         IF WS-PMT-TOL NOT = ZERO
 12358           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12359              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12360                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12361                  IF WS-NCL-PMT-OPTION = SPACES
 12362                      MOVE ER-0699 TO EMI-ERROR
 12363                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12364                  ELSE
 12365                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12366                      NEXT SENTENCE
 12367                  ELSE
 12368                  IF NOT WS-VALID-NCL-OPTION
 12369                      MOVE ER-0699 TO EMI-ERROR
 12370                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12371
 12372     IF WS-PMT-TOL NOT = ZERO
 12373        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12374           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12375           MOVE ER-0495          TO EMI-ERROR
 12376           PERFORM 1490-PAYMENT-ERROR
 12377                                 THRU 1490-EXIT
 12378        end-if
 12379     end-if
 12380
 12381     GO TO 1500-EDIT-EXPENSES.
 12382
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 235
* EL156.cbl
 12384 1440-COMPUTE-LIFE-REMAINING.
 12385
 12386     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12387        IF PI-PMTTYPE = '4'
 12388          MOVE PI-EPYAMT TO PI-CPYAMT
 12389          GO TO 1460-TEST-TYPE.
 12390
 12391     IF WS-LF-COVERAGE-TYPE = 'L'
 12392        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12393                          - CL-TOTAL-PAID-AMT
 12394        GO TO 1450-CHECK-MAX.
 12395
 12396     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12397        PI-LF-COVERAGE-TYPE = 'P'
 12398          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12399                              CM-LF-ITD-DEATH-AMT
 12400          GO TO 1450-CHECK-MAX.
 12401
 12402     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12403     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12404     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12405     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12406     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12407     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12408     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12409     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12410     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12411
 12412     PERFORM 9800-LINK-REM-TERM.
 12413
 12414     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12415     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12416     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12417     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12418     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12419     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12420     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12421     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12422     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12423     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12424     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12425     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12426     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12427     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12428     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12429     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12430     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 12431        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12432        MOVE PI-CARRIER          TO ACCT-CARRIER
 12433        MOVE PI-GROUPING         TO ACCT-GROUPING
 12434        MOVE PI-STATE            TO ACCT-STATE
 12435        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12436        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12437        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12438        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12439
 12440
 12441* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 236
* EL156.cbl
 12442*          DATASET ('ERACCT')
 12443*          RIDFLD  (ERACCT-KEY)
 12444*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12445*          GTEQ
 12446*          resp    (WS-RESPONSE)
 12447*       END-EXEC
 12448     MOVE 'ERACCT' TO DFHEIV1
 12449*    MOVE '&"S        G          (  N#00011886' TO DFHEIV0
 12450     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12451     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12452     MOVE X'204E233030303131383836' TO DFHEIV0(25:11)
 12453     CALL 'kxdfhei1' USING DFHEIV0,
 12454           DFHEIV1,
 12455           DFHEIV20,
 12456           DFHEIV99,
 12457           ERACCT-KEY,
 12458           DFHEIV99,
 12459           DFHEIV99,
 12460           DFHEIV99
 12461     SET ADDRESS OF ACCOUNT-MASTER TO
 12462         DFHEIV20
 12463     MOVE EIBRESP  TO WS-RESPONSE
 12464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12465        IF WS-RESP-NORMAL
 12466           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12467           and (pi-cert-eff-dt < am-expiration-dt)
 12468           and (pi-cert-eff-dt >= am-effective-dt)
 12469           move am-dcc-product-code to pi-dcc-product-code
 12470        else
 12471           move spaces           to pi-dcc-product-code
 12472        end-if
 12473        if pi-dcc-product-code not = spaces
 12474           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12475           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12476           PERFORM 0900-GET-DDF-limits
 12477                                 THRU 0900-EXIT
 12478           IF PDEF-FOUND
 12479              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12480                 (P1 > +8)
 12481                 OR (PD-PROD-CODE (P1) = 'L')
 12482              END-PERFORM
 12483              IF P1 < +9
 12484                 MOVE PD-MAX-AMT (P1)
 12485                                 TO CP-R-MAX-TOT-BEN
 12486              else
 12487                 move er-1674    to emi-error
 12488                 PERFORM 9900-ERROR-FORMAT
 12489                                 THRU 9900-EXIT
 12490              END-IF
 12491           else
 12492              move er-1672       to emi-error
 12493              PERFORM 9900-ERROR-FORMAT
 12494                                 THRU 9900-EXIT
 12495           END-IF
 12496        end-if
 12497     END-IF
 12498
 12499* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 237
* EL156.cbl
 12500*       PROGRAM  (LINK-REMAMT)
 12501*       COMMAREA (CALCULATION-PASS-AREA)
 12502*       LENGTH   (CP-COMM-LENGTH)
 12503*    END-EXEC.
 12504*    MOVE '."C                   (   #00011926' TO DFHEIV0
 12505     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12506     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12507     MOVE X'2020233030303131393236' TO DFHEIV0(25:11)
 12508     CALL 'kxdfhei1' USING DFHEIV0,
 12509           LINK-REMAMT,
 12510           CALCULATION-PASS-AREA,
 12511           CP-COMM-LENGTH,
 12512           DFHEIV99,
 12513           DFHEIV99,
 12514           DFHEIV99,
 12515           DFHEIV99
 12516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12517
 12518
 12519     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12520
 12521     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12522     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12523
 12524     IF PI-COMPANY-ID = 'BOA' AND
 12525        PI-PMTTYPE    = '2'   AND
 12526        PI-OFFLINE    = 'N'
 12527           GO TO 1441-COMPUTE-BOA-INTEREST.
 12528
 12529     IF PI-COMPANY-ID = 'NCL' AND
 12530        PI-PMTTYPE    = '2'   AND
 12531        PI-OFFLINE    = 'N'
 12532          GO TO 1442-COMPUTE-NCL-INTEREST
 12533       ELSE
 12534          GO TO 1445-CONTINUE.
 12535
 12536 1441-COMPUTE-BOA-INTEREST.
 12537     MOVE +0             TO WS-CALC-INT.
 12538
 12539     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12540     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12541     MOVE +0             TO DC-ELAPSED-MONTHS
 12542                            DC-ELAPSED-DAYS.
 12543     MOVE '1'            TO DC-OPTION-CODE.
 12544     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12545     IF NO-CONVERSION-ERROR
 12546         NEXT SENTENCE
 12547     ELSE
 12548         GO TO 1445-CONTINUE.
 12549
 12550     IF (PI-INT-RATE NOT > ZEROS)  AND
 12551        (DC-ELAPSED-DAYS > +30)
 12552         MOVE ER-3531            TO EMI-ERROR
 12553         MOVE -1                 TO PINTL
 12554         MOVE AL-UNBON           TO PINTA
 12555         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12556
 12557     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 238
* EL156.cbl
 12558         GO TO 1445-CONTINUE.
 12559
 12560     IF (PI-INT-RATE NOT > ZEROS)  OR
 12561        (DC-ELAPSED-DAYS NOT > +30)
 12562         MOVE PI-EPYAMT TO PI-CPYAMT
 12563         GO TO 1441-FORMAT-NOTE.
 12564
 12565     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12566                                 *  PI-INT-RATE
 12567                                 *  DC-ELAPSED-DAYS
 12568                                 /  365
 12569                                 /  100.
 12570
 12571     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12572
 12573 1441-FORMAT-NOTE.
 12574
 12575     MOVE SPACES        TO WS-BOANOTE1.
 12576     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12577     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12578     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12579     MOVE AL-UANON      TO NOTE1A.
 12580
 12581     IF WS-CALC-INT > ZEROS
 12582         MOVE SPACES        TO WS-BOANOTE2
 12583         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12584         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12585         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12586         MOVE AL-UANON      TO NOTE2A.
 12587
 12588     GO TO 1445-CONTINUE.
 12589
 12590 1442-COMPUTE-NCL-INTEREST.
 12591     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12592     MOVE PI-STATE               TO WS-ST-ACCESS.
 12593     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12594     MOVE '3'                    TO CNTL-REC-TYPE.
 12595     MOVE +0                     TO CNTL-SEQ-NO.
 12596     MOVE 'STAT'                 TO FILE-SWITCH.
 12597
 12598     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12599
 12600     MOVE +0                 TO WS-CALC-INT.
 12601
 12602     IF ST-STAT-FROM-INCURRED
 12603         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12604       ELSE
 12605     IF ST-STAT-FROM-REPORTED
 12606         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12607       ELSE
 12608         GO TO 1445-CONTINUE.
 12609
 12610     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12611     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12612     MOVE +0                 TO DC-ELAPSED-MONTHS
 12613                                DC-ELAPSED-DAYS.
 12614     MOVE '1'                TO DC-OPTION-CODE.
 12615     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 239
* EL156.cbl
 12616     IF NO-CONVERSION-ERROR
 12617         NEXT SENTENCE
 12618     ELSE
 12619         GO TO 1445-CONTINUE.
 12620
 12621     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12622        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12623         GO TO 1445-CONTINUE.
 12624
 12625     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12626                                 *  CF-ST-STAT-INTEREST.
 12627
 12628     MOVE SPACES              TO WS-NCLNOTE1.
 12629     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12630     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12631     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12632                                 PI-PMTNOTE1
 12633                                 NOTE1I.
 12634     MOVE AL-UANON            TO NOTE1A.
 12635
 12636     IF WS-CALC-INT > ZEROS
 12637         MOVE SPACES          TO WS-NCLNOTE2
 12638         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12639         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12640         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12641                                 PI-PMTNOTE2
 12642                                 NOTE2I
 12643         MOVE AL-UANON        TO NOTE2A.
 12644
 12645     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12646
 12647 1445-CONTINUE.
 12648
 12649     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12650        GO TO 1460-TEST-TYPE.
 12651
 12652     IF CM-O-B-COVERAGE
 12653        GO TO 1460-TEST-TYPE.
 12654
 12655     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12656         GO TO 1450-CHECK-MAX.
 12657
 12658     if (pi-company-id = 'DCC' or 'CAP')
 12659        and (pdef-found)
 12660        if pi-epyamt > pd-max-amt (p1)
 12661           move er-1657          to emi-error
 12662           perform 1490-payment-error
 12663                                 thru 1490-exit
 12664           go to 1460-test-type
 12665        end-if
 12666     else
 12667        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12668           > PI-EPYAMT)
 12669                         OR
 12670           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12671           < PI-EPYAMT)
 12672           MOVE ER-0594          TO EMI-ERROR
 12673           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 240
* EL156.cbl
 12674                                 THRU 1490-EXIT
 12675           GO TO 1460-TEST-TYPE
 12676        end-if
 12677     end-if
 12678     .
 12679 1450-CHECK-MAX.
 12680
 12681     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12682        PI-LF-COVERAGE-TYPE = 'P'
 12683         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12684                                   CM-LF-ITD-DEATH-AMT
 12685     ELSE
 12686         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12687                                   CL-TOTAL-PAID-AMT.
 12688
 12689     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12690          MOVE ER-0543           TO EMI-ERROR
 12691          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12692
 12693 1460-TEST-TYPE.
 12694
 12695     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12696        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12697           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12698                                   CM-LF-ALT-BENEFIT-AMT -
 12699                                   CL-TOTAL-PAID-AMT
 12700           IF PI-EPYAMT > WS-LF-BEN-AMT
 12701               MOVE ER-0543      TO EMI-ERROR
 12702               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12703           END-IF
 12704        END-IF
 12705     END-IF
 12706
 12707     IF PI-PMT-APPR-SW = 'G'
 12708       NEXT SENTENCE
 12709     ELSE
 12710       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12711         IF PI-EPYAMT = ZERO
 12712             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12713                 MOVE ER-0494    TO  EMI-ERROR
 12714                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12715                 GO TO 1500-EDIT-EXPENSES
 12716             ELSE
 12717                 NEXT SENTENCE
 12718         ELSE
 12719             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12720                 MOVE ER-0494    TO  EMI-ERROR
 12721                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12722                 GO TO 1500-EDIT-EXPENSES.
 12723
 12724     IF PI-PMTTYPE NOT = '2' OR
 12725        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12726         GO TO 1500-EDIT-EXPENSES.
 12727
 12728     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12729     MOVE ER-0526                TO EMI-ERROR.
 12730     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12731
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 241
* EL156.cbl
 12732     IF EMI-ERROR-NUMBER (1) = '0526'
 12733        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12734
 12735     IF EMI-ERROR-NUMBER (2) = '0526'
 12736        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12737
 12738     GO TO 1500-EDIT-EXPENSES.
 12739
 12740 1490-PAYMENT-ERROR.
 12741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12742
 12743     IF EMI-MESSAGE-FORMATTED
 12744         MOVE -1                 TO EPYAMTL
 12745         MOVE AL-UNBON           TO EPYAMTA.
 12746
 12747 1490-EXIT.
 12748      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 242
* EL156.cbl
 12750 1500-EDIT-EXPENSES.
 12751     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12752         GO TO 1500-SKIP-ERROR-0556.
 12753
 12754 1500-CONTINUE-ON.
 12755
 12756     IF CM-O-B-COVERAGE
 12757        MOVE ER-0556             TO EMI-ERROR
 12758        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12759
 12760 1500-SKIP-ERROR-0556.
 12761     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12762        IF PI-EEXPENS NOT = ZEROS
 12763           MOVE ER-0524          TO EMI-ERROR
 12764           GO TO 1590-EXPENSE-ERROR
 12765        ELSE
 12766           GO TO 1600-EDIT-RESERVES.
 12767
 12768     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12769     MOVE '6'                    TO CNTL-REC-TYPE.
 12770
 12771     IF CONTROL-IS-ACTUAL-CARRIER
 12772         MOVE PI-CARRIER         TO WS-CARR
 12773     ELSE
 12774         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12775
 12776     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12777     MOVE +0                     TO CNTL-SEQ-NO.
 12778     MOVE 'CARR'                 TO FILE-SWITCH.
 12779
 12780     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12781
 12782     IF EXPENSE-CALC-MANUAL
 12783        GO TO 1600-EDIT-RESERVES.
 12784
 12785     IF DOLLARS-PER-PMT
 12786        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12787        GO TO 1600-EDIT-RESERVES.
 12788
 12789     IF DOLLARS-PER-MONTH AND
 12790        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12791       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12792       GO TO 1600-EDIT-RESERVES.
 12793
 12794     IF PERCENT-OF-PAYMENT
 12795        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12796
 12797     GO TO 1600-EDIT-RESERVES.
 12798
 12799 1590-EXPENSE-ERROR.
 12800     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12801
 12802     IF EMI-MESSAGE-FORMATTED
 12803        MOVE -1                  TO EEXPENSL
 12804        MOVE AL-UNBON            TO EEXPENSA.
 12805
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 243
* EL156.cbl
 12807 1600-EDIT-RESERVES.
 12808     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12809        IF PI-ERESV = ZEROS
 12810           GO TO 1700-EDIT-EXPENSE-TYPE
 12811        ELSE
 12812           MOVE ER-0525          TO EMI-ERROR
 12813           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12814           GO TO 1700-EDIT-EXPENSE-TYPE.
 12815
 12816     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12817     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12818     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12819
 12820     IF NOT AT-MANUAL-RESERVES-USED
 12821        IF PI-ERESV NOT = ZEROS
 12822           MOVE ER-0518          TO EMI-ERROR
 12823           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12824
 12825     IF AT-MANUAL-RESERVES-USED
 12826        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12827        GO TO 1700-EDIT-EXPENSE-TYPE.
 12828
 12829     IF AT-FUTURE-RESERVES-USED
 12830        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12831
 12832     IF AT-FUTURE-RESERVES-USED
 12833        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12834
 12835     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12836        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12837
 12838     IF AT-IBNR-RESERVES-USED
 12839        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12840
 12841     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12842     GO TO 1700-EDIT-EXPENSE-TYPE.
 12843
 12844 1690-RESERVE-ERROR.
 12845     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12846
 12847     IF EMI-MESSAGE-FORMATTED
 12848        MOVE AL-UNBON            TO ERESVA
 12849        MOVE -1                  TO ERESVL.
 12850
 12851 1690-EXIT.
 12852      EXIT.
 12853
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 244
* EL156.cbl
 12855 1700-EDIT-EXPENSE-TYPE.
 12856     IF PI-PMTTYPE NOT = '5' AND '6'
 12857        GO TO 2000-EDIT-DONE.
 12858
 12859     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12860                   '6' OR '7' OR '8' OR '9'
 12861        GO TO 2000-EDIT-DONE.
 12862
 12863 1705-EXPENSE-ERROR.
 12864     MOVE ER-0573                TO EMI-ERROR.
 12865     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12866
 12867     IF EMI-MESSAGE-FORMATTED
 12868        MOVE AL-UABON            TO ETYPEA
 12869        MOVE -1                  TO ETYPEL.
 12870
 12871     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 245
* EL156.cbl
 12873 1950-NOT-FOUND.
 12874     IF FILE-SWITCH = 'MSTR'
 12875        MOVE ER-0204             TO EMI-ERROR.
 12876
 12877     IF FILE-SWITCH = 'CARR'
 12878        MOVE ER-0252             TO EMI-ERROR.
 12879
 12880     IF FILE-SWITCH = 'COMP'
 12881        MOVE ER-0254             TO EMI-ERROR.
 12882
 12883     IF FILE-SWITCH = 'STAT'
 12884        MOVE ER-0149             TO EMI-ERROR.
 12885
 12886     IF FILE-SWITCH = 'PROC'
 12887        MOVE ER-0019             TO EMI-ERROR.
 12888
 12889     IF FILE-SWITCH = 'ACCT'
 12890        MOVE ER-0198             TO EMI-ERROR.
 12891
 12892     IF FILE-SWITCH = 'BENE'
 12893        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12894           MOVE ER-0282          TO EMI-ERROR
 12895        ELSE
 12896           MOVE ER-0283          TO EMI-ERROR.
 12897
 12898     MOVE -1                     TO PMTTYPEL.
 12899     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12900
 12901     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12902                                     WS-FORCE-CTR.
 12903
 12904     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12905                                     WS-FATAL-CTR.
 12906
 12907     GO TO 8200-SEND-DATAONLY.
 12908
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 246
* EL156.cbl
 12910 2000-EDIT-DONE.
 12911     perform 2210-dcc-max-benes thru 2210-exit
 12912     if pi-company-id not = 'DCC' and 'CAP'
 12913        IF (WS-SPECIAL-CALC-CD = 'C')
 12914           and (cl-critical-period > 0)
 12915           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12916              IF PI-EPYAMT > ZEROS
 12917                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12918                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12919              ELSE
 12920                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12921                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12922              END-IF
 12923              if ws-benefits-paid > cl-critical-period
 12924                 MOVE ER-0657          TO EMI-ERROR
 12925                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12926              END-IF
 12927           END-IF
 12928        END-IF
 12929     end-if
 12930     IF PI-HOLDTIL NOT = ZEROS
 12931        MOVE PI-HOLDTIL          TO HOLDTILO
 12932        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12933
 12934     IF PI-EPYFROM NOT = ZEROS
 12935        MOVE PI-EPYFROM          TO EPYFROMO
 12936        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12937
 12938     IF PI-EPYTHRU NOT = ZEROS
 12939        MOVE PI-EPYTHRU            TO EPYTHRUO
 12940        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12941        IF PI-USES-PAID-TO
 12942           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12943           MOVE '4'                TO DC-OPTION-CODE
 12944           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12945           IF NO-CONVERSION-ERROR
 12946              MOVE +1              TO DC-ELAPSED-DAYS
 12947              MOVE +0              TO DC-ELAPSED-MONTHS
 12948              MOVE '6'             TO DC-OPTION-CODE
 12949              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12950              IF NO-CONVERSION-ERROR
 12951                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12952
 12953     MOVE PI-EDAYS               TO EDAYSO.
 12954
 12955     IF PI-AIGFROM NOT = ZEROS
 12956        MOVE PI-AIGFROM          TO AIGFROMO
 12957        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12958
 12959     MOVE PI-EPYAMT              TO EPYAMTO.
 12960     MOVE PI-ERESV               TO ERESVO.
 12961     MOVE PI-EEXPENS             TO EEXPENSO.
 12962
 12963     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12964     MOVE SPACES                 TO DC-OPTION-CODE.
 12965     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12966
 12967     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 247
* EL156.cbl
 12968        MOVE SPACES              TO CPYFROMI
 12969     ELSE
 12970        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12971        IF PI-EPYFROM = ZEROS
 12972           MOVE AL-UANON             TO EPYFROMA
 12973           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12974           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12975
 12976     IF PI-USES-PAID-TO
 12977        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12978        MOVE +1                            TO DC-ELAPSED-DAYS
 12979        MOVE +0                            TO DC-ELAPSED-MONTHS
 12980        MOVE '6'                           TO DC-OPTION-CODE
 12981        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12982        IF NO-CONVERSION-ERROR
 12983           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12984           IF PI-EPYTHRU = ZEROS
 12985              MOVE AL-UANON                TO EPYTHRUA
 12986              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12987              MOVE ' '                     TO DC-OPTION-CODE
 12988              MOVE +0                      TO DC-ELAPSED-DAYS
 12989                                              DC-ELAPSED-MONTHS
 12990              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12991              IF NO-CONVERSION-ERROR
 12992                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12993                  GO TO 2001-CONTINUE
 12994              ELSE
 12995                  GO TO 2001-CONTINUE
 12996           ELSE
 12997              GO TO 2001-CONTINUE.
 12998
 12999     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13000     MOVE SPACES                 TO DC-OPTION-CODE.
 13001     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13002
 13003     IF DATE-CONVERSION-ERROR
 13004        MOVE SPACES              TO CPYTHRUI
 13005     ELSE
 13006        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13007        IF PI-EPYTHRU = ZEROS
 13008           MOVE AL-UANON TO EPYTHRUA
 13009           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 13010           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 13011
 13012 2001-CONTINUE.
 13013
 13014     MOVE PI-CDAYS               TO CDAYSO.
 13015
 13016     IF PI-EDAYS = ZEROS
 13017        MOVE AL-UNNON TO EDAYSA
 13018        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 13019
 13020     MOVE PI-CPYAMT              TO CPYAMTO.
 13021
 13022     IF PI-EPYAMT = ZEROS
 13023        MOVE AL-UNNON            TO EPYAMTA
 13024        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 13025
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 248
* EL156.cbl
 13026     MOVE PI-CRESV               TO CRESVO.
 13027     MOVE PI-CEXPENS             TO CEXPENSO.
 13028
 13029     IF PI-EEXPENS = ZEROS
 13030        MOVE AL-UNNON TO EEXPENSA
 13031        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 13032
 13033     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13034        AND (CL-CLAIM-TYPE = 'L')
 13035        AND (PI-OFFLINE NOT EQUAL 'Y')
 13036        IF PI-PMTTYPE = '2' OR '4'
 13037           PERFORM 2200-CALC-INTEREST
 13038                                 THRU 2200-EXIT
 13039        END-IF
 13040     END-IF
 13041     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13042     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13043     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13044
 13045     IF EMI-FATAL-CTR = ZEROS
 13046        MOVE 'B'                 TO PI-PASS-SW.
 13047
 13048     IF NOT EMI-MESSAGE-FORMATTED
 13049         MOVE -1                 TO EPYFROML
 13050     ELSE
 13051         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13052            EMI-ERROR-NUMBER (2) = SPACES
 13053             MOVE -1             TO EPYFROML.
 13054
 13055     GO TO 8200-SEND-DATAONLY.
 13056
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 249
* EL156.cbl
 13058 2200-CALC-INTEREST.
 13059     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13060        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13061        MOVE '4'                 TO DC-OPTION-CODE
 13062        PERFORM 9700-LINK-DATE-CONVERT
 13063        IF DATE-CONVERSION-ERROR
 13064            MOVE LOW-VALUES      TO CP-PRF-DT
 13065        ELSE
 13066           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13067        END-IF
 13068     END-IF
 13069     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13070        if pi-rb-joint-coverage
 13071           move 'Y'              to pi-int-to-rem-borr
 13072        end-if
 13073     end-if
 13074     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13075        IN CLAIM-INT-PASS-AREA
 13076     MOVE CL-CERT-STATE          TO CP-STATE
 13077        IN CLAIM-INT-PASS-AREA
 13078     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13079     MOVE 'LF'                   TO CP-COVERAGE
 13080     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13081     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13082     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13083     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13084     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13085     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13086
 13087* EXEC CICS LINK
 13088*       PROGRAM   ('ELCLMI')
 13089*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13090*       LENGTH    (CP-CLAIM-LENGTH)
 13091*    END-EXEC
 13092     MOVE 'ELCLMI' TO DFHEIV1
 13093*    MOVE '."C                   (   #00012499' TO DFHEIV0
 13094     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13095     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13096     MOVE X'2020233030303132343939' TO DFHEIV0(25:11)
 13097     CALL 'kxdfhei1' USING DFHEIV0,
 13098           DFHEIV1,
 13099           CLAIM-INT-PASS-AREA,
 13100           CP-CLAIM-LENGTH,
 13101           DFHEIV99,
 13102           DFHEIV99,
 13103           DFHEIV99,
 13104           DFHEIV99
 13105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13106     MOVE AL-PANOF               TO PINTHA
 13107                                    PINTA
 13108     if cp-clm-int-amt = zeros
 13109        move ' ' to pi-int-to-rem-borr
 13110     end-if
 13111     IF NO-CI-ERROR
 13112        MOVE CP-CLM-INT-AMT      TO PINTO
 13113                                    PI-INT-AMT
 13114        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13115        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 250
* EL156.cbl
 13116        MOVE AL-PANOF            TO PINTHA
 13117                                    PINTA
 13118        if pi-rb-joint-coverage
 13119           and pi-int-amt > zeros
 13120           move '  INT TO'       to itrb1o
 13121           move ' REM BORR?'     to itrb2o
 13122           move pi-int-to-rem-borr
 13123                                 to itrbyno
 13124           move al-uanon         to itrbyna
 13125           move +1               to itrbynl
 13126        else
 13127           move ' '              to pi-int-to-rem-borr
 13128        end-if
 13129     ELSE
 13130        IF CI-RETURN-CODE = '8'
 13131           MOVE ER-3818          TO EMI-ERROR
 13132           MOVE -1               TO ZINTL
 13133           PERFORM 9900-ERROR-FORMAT
 13134                                 THRU 9900-EXIT
 13135           GO TO 2200-EXIT
 13136        ELSE
 13137           MOVE ZEROS            TO PINTO
 13138                                    PI-INT-AMT
 13139                                    PI-INT-DAYS
 13140                                    PI-INT-RATE-USED
 13141        END-IF
 13142     END-IF
 13143     IF PI-INT-AMT NOT = ZEROS
 13144        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13145           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13146           CONTINUE
 13147        ELSE
 13148           MOVE CL-SOC-SEC-NO (1:3)
 13149                                 TO WS-SSN (1:3)
 13150           MOVE CL-SOC-SEC-NO (5:2)
 13151                                 TO WS-SSN (4:2)
 13152           MOVE CL-SOC-SEC-NO (8:4)
 13153                                 TO WS-SSN (6:4)
 13154           IF (WS-SSN NUMERIC)
 13155              AND (WS-SSN NOT = ZEROS)
 13156              CONTINUE
 13157           ELSE
 13158              MOVE ER-2044       TO EMI-ERROR
 13159              PERFORM 9900-ERROR-FORMAT
 13160                                 THRU 9900-EXIT
 13161           END-IF
 13162        END-IF
 13163        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13164        if pi-int-to-rem-borr = 'Y'
 13165           move +61              to trlr-seq-no
 13166        else
 13167           MOVE +51              TO TRLR-SEQ-NO
 13168        end-if
 13169
 13170* EXEC CICS READ
 13171*          DATASET  ('ELTRLR')
 13172*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13173*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 251
* EL156.cbl
 13174*          RESP     (WS-RESPONSE)
 13175*       END-EXEC
 13176     MOVE 'ELTRLR' TO DFHEIV1
 13177*    MOVE '&"S        E          (  N#00012567' TO DFHEIV0
 13178     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13179     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13180     MOVE X'204E233030303132353637' TO DFHEIV0(25:11)
 13181     CALL 'kxdfhei1' USING DFHEIV0,
 13182           DFHEIV1,
 13183           DFHEIV20,
 13184           DFHEIV99,
 13185           ELTRLR-KEY,
 13186           DFHEIV99,
 13187           DFHEIV99,
 13188           DFHEIV99
 13189     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13190         DFHEIV20
 13191     MOVE EIBRESP  TO WS-RESPONSE
 13192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13193        IF (NOT WS-RESP-NORMAL)
 13194                    OR
 13195           ((WS-RESP-NORMAL)
 13196           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13197           OR (AT-CITY-STATE = SPACES)))
 13198           MOVE ER-0874          TO EMI-ERROR
 13199           if pi-rb-joint-coverage
 13200              move -1            to itrbynl
 13201           end-if
 13202           PERFORM 9900-ERROR-FORMAT
 13203                                 THRU 9900-EXIT
 13204        else
 13205           move at-mail-to-name  to pi-int-payees-name
 13206        END-IF
 13207     END-IF
 13208     .
 13209 2200-EXIT.
 13210     EXIT.
 13211 2210-dcc-max-benes.
 13212
 13213     move pi-ah-term             to ws-max-bens
 13214     if cl-critical-period not = zeros and spaces
 13215        move cl-critical-period  to ws-max-bens
 13216     end-if
 13217     move cm-ah-benefit-amt      to ws-monthly-benefit
 13218     if pdef-found
 13219        and (pd-max-amt (p1) not = zeros)
 13220        if pd-ben-pct (p1) not numeric
 13221           move zeros            to pd-ben-pct (p1)
 13222        end-if
 13223        if pd-ben-pct (p1) = zeros
 13224           move +1               to ws-work-ben-pct
 13225        else
 13226           move pd-ben-pct (p1)  to ws-work-ben-pct
 13227        end-if
 13228*       compute ws-monthly-benefit =
 13229*          ws-monthly-benefit * ws-work-ben-pct
 13230*       if ws-monthly-benefit > pd-max-amt (p1)
 13231*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 252
* EL156.cbl
 13232*       end-if
 13233     end-if
 13234
 13235     move cl-cert-key-data       to elcrtt-key (2:21)
 13236     move cl-company-cd          to ctrlr-comp-cd
 13237     move cl-cert-no             to ctrlr-cert-no
 13238     move 'B'                    to ctrlr-rec-type
 13239
 13240
 13241* EXEC CICS READ
 13242*       DATASET  ('ELCRTT')
 13243*       set      (address of CERTIFICATE-TRAILERS)
 13244*       RIDFLD   (ELCRTT-KEY)
 13245*       RESP     (WS-RESPONSE)
 13246*    END-EXEC
 13247     MOVE 'ELCRTT' TO DFHEIV1
 13248*    MOVE '&"S        E          (  N#00012620' TO DFHEIV0
 13249     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13250     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13251     MOVE X'204E233030303132363230' TO DFHEIV0(25:11)
 13252     CALL 'kxdfhei1' USING DFHEIV0,
 13253           DFHEIV1,
 13254           DFHEIV20,
 13255           DFHEIV99,
 13256           ELCRTT-KEY,
 13257           DFHEIV99,
 13258           DFHEIV99,
 13259           DFHEIV99
 13260     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13261         DFHEIV20
 13262     MOVE EIBRESP  TO WS-RESPONSE
 13263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13264     IF not WS-RESP-NORMAL
 13265        go to 2210-exit
 13266     end-if
 13267
 13268*    if instypei = 'P'
 13269*       move +1 to s1
 13270*    else
 13271*       MOVE +2 to s1
 13272*    end-if
 13273
 13274*    move +1 to s1
 13275*    evaluate cl-claim-type
 13276*       when 'A'
 13277*          move +1 to s2
 13278*       when 'I'
 13279*          move +2 to s2
 13280*       when 'G'
 13281*          move +3 to s2
 13282*       when 'L'
 13283*          move +4 to s2
 13284*       when 'P'
 13285*          move +5 to s2
 13286*    end-evaluate
 13287
 13288     move zeros                  to ws-prev-days-paid
 13289                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 253
* EL156.cbl
 13290                                    ws-prev-amt-paid
 13291     perform varying s1 from +1 by +1 until
 13292        (s1 > +24)
 13293        or (cs-claim-type (s1) = spaces)
 13294        if pi-company-id not = 'DCC' and 'CAP'
 13295           if cs-claim-type (s1) = cl-claim-type
 13296              compute ws-prev-days-paid =
 13297                 ws-prev-days-paid + cs-days-paid (s1)
 13298              compute ws-prev-amt-paid =
 13299                 ws-prev-amt-paid + cs-total-paid (s1)
 13300           end-if
 13301        else
 13302           if (cs-claim-type (s1) = cl-claim-type)
 13303              and (cs-benefit-period (s1) = cl-benefit-period)
 13304              and (cs-insured-type (s1) = cl-insured-type)
 13305              compute ws-prev-days-paid =
 13306                 ws-prev-days-paid + cs-days-paid (s1)
 13307              compute ws-prev-amt-paid =
 13308                 ws-prev-amt-paid + cs-total-paid (s1)
 13309           end-if
 13310        end-if
 13311     end-perform
 13312     if pi-epyamt > zeros
 13313        compute ws-benefits-paid =
 13314           (ws-prev-amt-paid + pi-epyamt)
 13315           / ws-monthly-benefit
 13316     else
 13317        compute ws-benefits-paid =
 13318           (ws-prev-amt-paid + pi-cpyamt)
 13319           / ws-monthly-benefit
 13320     end-if
 13321*    if pi-company-id = 'DCC'
 13322     if cl-claim-type not = 'L' and 'P'
 13323        if ws-benefits-paid > ws-max-bens
 13324           move er-1658          to emi-error
 13325           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13326        end-if
 13327     end-if
 13328*    end-if
 13329*     if s1 < +25
 13330*        if pi-epyamt > zeros
 13331*           compute ws-benefits-paid =
 13332*              (cs-total-paid (s1) + PI-EPYAMT)
 13333*              / ws-monthly-benefit
 13334*        else
 13335*           compute ws-benefits-paid =
 13336*              (cs-total-paid (s1) + PI-CPYAMT)
 13337*              / ws-monthly-benefit
 13338*        end-if
 13339
 13340*       if ws-benefits-paid > pd-crit-period (p1)
 13341*        if ws-benefits-paid > ws-max-bens
 13342*           move er-1658          to emi-error
 13343*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13344*        end-if
 13345*     end-if
 13346     .
 13347 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 254
* EL156.cbl
 13348     exit.
 13349
 13350 2220-update-elcrtt.
 13351
 13352
 13353* EXEC CICS GETMAIN
 13354*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13355*       LENGTH   (ELCRTT-LENGTH)
 13356*       INITIMG  (GETMAIN-SPACE)
 13357*    END-EXEC
 13358*    MOVE ',"IL                  $   #00012714' TO DFHEIV0
 13359     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13360     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13361     MOVE X'2020233030303132373134' TO DFHEIV0(25:11)
 13362     CALL 'kxdfhei1' USING DFHEIV0,
 13363           DFHEIV20,
 13364           ELCRTT-LENGTH,
 13365           GETMAIN-SPACE
 13366     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13367         DFHEIV20
 13368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13369
 13370     move cl-cert-key-data       to elcrtt-key (2:21)
 13371     move cl-company-cd          to ctrlr-comp-cd
 13372     move cl-cert-no             to ctrlr-cert-no
 13373     move 'B'                    to ctrlr-rec-type
 13374
 13375
 13376* EXEC CICS READ
 13377*       UPDATE
 13378*       DATASET  (ELCRTT-DSID)
 13379*       into     (CERTIFICATE-TRAILERS)
 13380*       RIDFLD   (ELCRTT-KEY)
 13381*       RESP     (WS-RESPONSE)
 13382*    END-EXEC
 13383     MOVE LENGTH OF
 13384      CERTIFICATE-TRAILERS
 13385       TO DFHEIV11
 13386*    MOVE '&"IL       EU         (  N#00012725' TO DFHEIV0
 13387     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13388     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13389     MOVE X'204E233030303132373235' TO DFHEIV0(25:11)
 13390     CALL 'kxdfhei1' USING DFHEIV0,
 13391           ELCRTT-DSID,
 13392           CERTIFICATE-TRAILERS,
 13393           DFHEIV11,
 13394           ELCRTT-KEY,
 13395           DFHEIV99,
 13396           DFHEIV99,
 13397           DFHEIV99
 13398     MOVE EIBRESP  TO WS-RESPONSE
 13399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13400
 13401     IF WS-RESP-NORMAL
 13402        perform 2225-upd-crt-trlr thru 2225-exit
 13403
 13404* EXEC CICS REWRITE
 13405*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 255
* EL156.cbl
 13406*          from     (CERTIFICATE-TRAILERS)
 13407*          RESP     (WS-RESPONSE)
 13408*       END-EXEC
 13409     MOVE LENGTH OF
 13410      CERTIFICATE-TRAILERS
 13411       TO DFHEIV11
 13412*    MOVE '&& L                  %  N#00012735' TO DFHEIV0
 13413     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13414     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13415     MOVE X'204E233030303132373335' TO DFHEIV0(25:11)
 13416     CALL 'kxdfhei1' USING DFHEIV0,
 13417           ELCRTT-DSID,
 13418           CERTIFICATE-TRAILERS,
 13419           DFHEIV11,
 13420           DFHEIV99
 13421     MOVE EIBRESP  TO WS-RESPONSE
 13422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13423     else
 13424        if ws-resp-notfnd
 13425           move 'CS'             to certificate-trailers
 13426           move cl-company-cd    to cs-company-cd
 13427           move cl-cert-key-data to cs-control-primary (2:21)
 13428           move cl-cert-no       to cs-cert-no
 13429           move 'B'              to cs-trailer-type
 13430           perform varying s1 from +1 by +1 until s1 > +24
 13431              move zeros         to cs-benefit-period (s1)
 13432                                    cs-days-paid (s1)
 13433                                    cs-total-paid (s1)
 13434                                    cs-remaining-bens (s1)
 13435           end-perform
 13436           perform 2225-upd-crt-trlr
 13437                                 thru 2225-exit
 13438
 13439* EXEC CICS WRITE
 13440*             DATASET  (ELCRTT-DSID)
 13441*             from     (CERTIFICATE-TRAILERS)
 13442*             RIDFLD   (cs-control-primary)
 13443*             RESP     (WS-RESPONSE)
 13444*          END-EXEC
 13445     MOVE LENGTH OF
 13446      CERTIFICATE-TRAILERS
 13447       TO DFHEIV11
 13448*    MOVE '&$ L                  ''  N#00012755' TO DFHEIV0
 13449     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13450     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13451     MOVE X'204E233030303132373535' TO DFHEIV0(25:11)
 13452     CALL 'kxdfhei1' USING DFHEIV0,
 13453           ELCRTT-DSID,
 13454           CERTIFICATE-TRAILERS,
 13455           DFHEIV11,
 13456           cs-control-primary,
 13457           DFHEIV99,
 13458           DFHEIV99
 13459     MOVE EIBRESP  TO WS-RESPONSE
 13460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13461        end-if
 13462     END-IF
 13463
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 256
* EL156.cbl
 13464     .
 13465 2220-exit.
 13466     exit.
 13467
 13468 2225-upd-crt-trlr.
 13469
 13470*    if instypei = 'P'
 13471*       move +1 to s1
 13472*    else
 13473*       MOVE +2 to s1
 13474*    end-if
 13475
 13476*    move +1 to s1
 13477*    evaluate cl-claim-type
 13478*       when 'A'
 13479*          move +1 to s2
 13480*       when 'I'
 13481*          move +2 to s2
 13482*       when 'G'
 13483*          move +3 to s2
 13484*       when 'L'
 13485*          move +4 to s2
 13486*       when 'P'
 13487*          move +5 to s2
 13488*    end-evaluate
 13489     perform varying s1 from +1 by +1 until
 13490        (s1 > +24)
 13491        or (cl-claim-no = cs-claim-no (s1))
 13492     end-perform
 13493     if s1 < +25
 13494        compute cs-total-paid (s1) =
 13495           cs-total-paid (s1) + at-amount-paid
 13496        compute cs-days-paid (s1) =
 13497           cs-days-paid (s1) +  at-days-in-period
 13498*       compute cs-remaining-bens (s1) =
 13499*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13500        perform 2230-accum-bens-paid thru 2230-exit
 13501     end-if
 13502
 13503     .
 13504 2225-exit.
 13505     exit.
 13506 2230-accum-bens-paid.
 13507     if cl-claim-type not = 'L' and 'P'
 13508        move pi-ah-term          to ws-max-bens
 13509        if cl-critical-period not = zeros and spaces
 13510           move cl-critical-period
 13511                                 to ws-max-bens
 13512        end-if
 13513     else
 13514        move 01                  to ws-max-bens
 13515     end-if
 13516     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13517     perform varying s2 from +1 by +1 until
 13518        (s2 > +24)
 13519        or (cs-claim-no (s2) = spaces)
 13520        if pi-company-id not = 'DCC' and 'CAP'
 13521           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 257
* EL156.cbl
 13522              compute ws-tot-days-paid =
 13523                 ws-tot-days-paid + cs-days-paid (s2)
 13524              compute ws-tot-amt-paid =
 13525                 ws-tot-amt-paid + cs-total-paid (s2)
 13526           end-if
 13527        else
 13528           if (cs-benefit-period (s2) = cl-benefit-period)
 13529              and (cs-claim-type (s2) = cl-claim-type)
 13530              and (cs-insured-type (s2) = cl-insured-type)
 13531              compute ws-tot-days-paid =
 13532                 ws-tot-days-paid + cs-days-paid (s2)
 13533              compute ws-tot-amt-paid =
 13534                 ws-tot-amt-paid + cs-total-paid (s2)
 13535           end-if
 13536        end-if
 13537     end-perform
 13538     if cl-claim-type = 'L' and 'P'
 13539        if ws-tot-amt-paid > zeros
 13540           move zeros            to cs-remaining-bens (s1)
 13541        else
 13542           move 01               to cs-remaining-bens (s1)
 13543        end-if
 13544     else
 13545        compute ws-pd-bens rounded =
 13546           ws-tot-amt-paid / pi-ah-benefit-amt
 13547        compute cs-remaining-bens (s1) =
 13548           ws-max-bens - ws-pd-bens
 13549        if cs-remaining-bens (s1) < zeros
 13550           move zeros            to cs-remaining-bens (s1)
 13551        end-if
 13552     end-if
 13553     .
 13554 2230-exit.
 13555     exit.
 13556 3000-MOVE-INPUT-TO-SAVE-AREA.
 13557     IF PMTTYPEL > 0
 13558         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13559
 13560     if ws-pmttype = '4'
 13561        if pi-rb-joint-coverage
 13562           if payeel = +0
 13563              move +2            to payeel
 13564              move al-uanon      to payeea
 13565              move 'Q1'          to payeeo
 13566           else
 13567              if payeei not = 'Q1' and 'q1'
 13568                 move er-1582    to emi-error
 13569                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13570              end-if
 13571           end-if
 13572        end-if
 13573     end-if
 13574     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13575
 13576     IF WS-PMTTYPE = '9'
 13577         MOVE 'P'                TO PI-PROVISIONAL-IND
 13578         MOVE '1'                TO WS-PMTTYPE.
 13579
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 258
* EL156.cbl
 13580     IF PAYEEL > 0
 13581         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13582         MOVE PAYEEI             TO WS-PAYEE.
 13583
 13584     IF NOTE1L > +0
 13585         MOVE NOTE1I             TO WS-PMTNOTE1
 13586                                    WS-FLI-PMTNOTE
 13587                                    WS-HAN-PMTNOTE.
 13588
 13589     IF NOTE2L > +0
 13590         MOVE NOTE2I             TO WS-PMTNOTE2.
 13591
 13592     IF OFFLINEL > 0
 13593         MOVE OFFLINEI           TO WS-OFFLINE.
 13594
 13595     IF PROOFDTL > 0
 13596         MOVE PROOFDTI            TO DATE-WORK
 13597         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13598         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13599         MOVE '4'                 TO DC-OPTION-CODE
 13600         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13601         IF NO-CONVERSION-ERROR
 13602            MOVE NUM-WORK         TO PROOFDTO
 13603            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13604            MOVE NUM-WORK         TO WS-PROOF-DATE
 13605         ELSE
 13606            MOVE ZEROS            TO WS-PROOF-DATE
 13607         END-IF
 13608     END-IF.
 13609
 13610     IF EOBYNL > +0
 13611         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13612         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13613     END-IF
 13614
 13615     IF CLMFMYNL > +0
 13616         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13617         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13618     END-IF
 13619
 13620     IF SURVYYNL > +0
 13621         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13622         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13623     END-IF
 13624
 13625     IF SPRELYNL > +0
 13626         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13627         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13628     END-IF
 13629     if itrbynl <> +0
 13630        move function upper-case(itrbyni) to itrbyni
 13631        move itrbyni             to ws-int-to-rem-borr
 13632     end-if
 13633*    IF GROUPEDL > +0
 13634*        MOVE GROUPEDI           TO WS-GROUPED.
 13635*
 13636*    IF CASHL > +0
 13637*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 259
* EL156.cbl
 13638     IF LOANNOL > +0
 13639         MOVE LOANNOI            TO WS-LOAN-NO.
 13640
 13641     IF CHECKNOL > 0
 13642         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13643
 13644     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13645         IF WS-AIG-CREDIT-ENTERED
 13646             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13647             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13648             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13649             MOVE AL-UANON         TO CHECKNOA.
 13650
 13651     IF HOLDTILL > 0
 13652         MOVE HOLDTILI           TO DATE-WORK
 13653         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13654         MOVE NUM-WORK           TO WS-HOLDTIL.
 13655
 13656     IF ZINTL > +0
 13657
 13658* EXEC CICS BIF DEEDIT
 13659*           FIELD   (ZINTI)
 13660*           LENGTH  (07)
 13661*       END-EXEC
 13662     MOVE 07
 13663       TO DFHEIV11
 13664*    MOVE '@"L                   #   #00012957' TO DFHEIV0
 13665     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13666     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13667     MOVE X'2020233030303132393537' TO DFHEIV0(25:11)
 13668     CALL 'kxdfhei1' USING DFHEIV0,
 13669           ZINTI,
 13670           DFHEIV11
 13671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13672        IF ZINTI NOT NUMERIC
 13673           MOVE ER-0419          TO EMI-ERROR
 13674           PERFORM 9900-ERROR-FORMAT
 13675           MOVE AL-UABON         TO ZINTA
 13676           MOVE -1               TO ZINTL
 13677        ELSE
 13678           MOVE ZINTI            TO CP-INT-RATE
 13679                                    WS-INT-RATE
 13680           MOVE CP-INT-RATE      TO ZINTO
 13681           MOVE AL-UNNON         TO ZINTA
 13682        END-IF
 13683     ELSE
 13684        MOVE ZEROS               TO CP-INT-RATE
 13685     END-IF
 13686     IF EPYFROML > 0
 13687         MOVE EPYFROMI           TO DATE-WORK
 13688         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13689         MOVE NUM-WORK           TO WS-EPYFROM.
 13690
 13691     IF AIGFROML > 0
 13692         MOVE AIGFROMI           TO DATE-WORK
 13693         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13694         MOVE NUM-WORK           TO WS-AIGFROM
 13695     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 260
* EL156.cbl
 13696         IF (AIGFROMI = LOW-VALUES) AND
 13697            (PI-AIGFROM NOT = ZEROS)
 13698              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13699
 13700     IF EPYTHRUL > +0
 13701        MOVE EPYTHRUI           TO DATE-WORK
 13702        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13703        MOVE NUM-WORK           TO WS-EPYTHRU
 13704        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13705        MOVE '4'                TO DC-OPTION-CODE
 13706        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13707        IF NO-CONVERSION-ERROR
 13708           IF PI-USES-PAID-TO
 13709              MOVE '6'                TO DC-OPTION-CODE
 13710              MOVE -1                 TO DC-ELAPSED-DAYS
 13711              MOVE +0                 TO DC-ELAPSED-MONTHS
 13712              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13713              IF NO-CONVERSION-ERROR
 13714                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13715                 MOVE ' '             TO DC-OPTION-CODE
 13716                 MOVE +0              TO DC-ELAPSED-DAYS
 13717                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13718              IF NO-CONVERSION-ERROR
 13719                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13720
 13721*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13722*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13723     IF EDAYSL > 0
 13724
 13725* EXEC CICS BIF DEEDIT
 13726*            FIELD(EDAYSI)
 13727*            LENGTH(6)
 13728*        END-EXEC
 13729     MOVE 6
 13730       TO DFHEIV11
 13731*    MOVE '@"L                   #   #00013013' TO DFHEIV0
 13732     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13733     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13734     MOVE X'2020233030303133303133' TO DFHEIV0(25:11)
 13735     CALL 'kxdfhei1' USING DFHEIV0,
 13736           EDAYSI,
 13737           DFHEIV11
 13738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13739         MOVE EDAYSI             TO WS-DY-WORK
 13740         IF WS-DY-SIGN = SPACES
 13741            MOVE WS-DY-NUM       TO WS-EDAYS
 13742            ADD 0                TO WS-EDAYS
 13743         ELSE
 13744            MOVE EDAYSI          TO WS-EDAYS
 13745            ADD 0                TO WS-EDAYS.
 13746
 13747*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13748*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13749     IF EPYAMTL > 0
 13750
 13751* EXEC CICS BIF DEEDIT
 13752*            FIELD(EPYAMTI)
 13753*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 261
* EL156.cbl
 13754*        END-EXEC
 13755     MOVE 10
 13756       TO DFHEIV11
 13757*    MOVE '@"L                   #   #00013028' TO DFHEIV0
 13758     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13759     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13760     MOVE X'2020233030303133303238' TO DFHEIV0(25:11)
 13761     CALL 'kxdfhei1' USING DFHEIV0,
 13762           EPYAMTI,
 13763           DFHEIV11
 13764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13765         MOVE EPYAMTI            TO WS-PY-WORK
 13766         IF WS-PY-SIGN = SPACES
 13767            MOVE WS-PY-NUM       TO WS-EPYAMT
 13768            ADD 0                TO WS-EPYAMT
 13769         ELSE
 13770            MOVE EPYAMTI         TO WS-EPYAMT
 13771            ADD 0                TO WS-EPYAMT.
 13772
 13773     IF ERESVL > 0
 13774
 13775* EXEC CICS BIF DEEDIT
 13776*            FIELD(ERESVI)
 13777*            LENGTH(9)
 13778*        END-EXEC
 13779     MOVE 9
 13780       TO DFHEIV11
 13781*    MOVE '@"L                   #   #00013041' TO DFHEIV0
 13782     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13783     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13784     MOVE X'2020233030303133303431' TO DFHEIV0(25:11)
 13785     CALL 'kxdfhei1' USING DFHEIV0,
 13786           ERESVI,
 13787           DFHEIV11
 13788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13789         MOVE ERESVI TO WS-ERESV.
 13790
 13791     IF EEXPENSL > 0
 13792
 13793* EXEC CICS BIF DEEDIT
 13794*            FIELD(EEXPENSI)
 13795*            LENGTH(8)
 13796*        END-EXEC
 13797     MOVE 8
 13798       TO DFHEIV11
 13799*    MOVE '@"L                   #   #00013048' TO DFHEIV0
 13800     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13801     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13802     MOVE X'2020233030303133303438' TO DFHEIV0(25:11)
 13803     CALL 'kxdfhei1' USING DFHEIV0,
 13804           EEXPENSI,
 13805           DFHEIV11
 13806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13807         MOVE EEXPENSI           TO WS-EEXPENS.
 13808
 13809     IF ETYPEL > ZEROS
 13810         MOVE ETYPEI             TO WS-ETYPE.
 13811
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 262
* EL156.cbl
 13812     IF PI-COMPANY-ID = 'BOA'
 13813        IF PINTL > ZEROS
 13814
 13815* EXEC CICS BIF DEEDIT
 13816*            FIELD (PINTI)
 13817*            LENGTH(05)
 13818*          END-EXEC
 13819     MOVE 05
 13820       TO DFHEIV11
 13821*    MOVE '@"L                   #   #00013059' TO DFHEIV0
 13822     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13823     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13824     MOVE X'2020233030303133303539' TO DFHEIV0(25:11)
 13825     CALL 'kxdfhei1' USING DFHEIV0,
 13826           PINTI,
 13827           DFHEIV11
 13828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13829           IF PINTI NUMERIC
 13830               MOVE AL-UNNON     TO PINTA
 13831               MOVE PINTI        TO WS-INT-RATE
 13832               MOVE WS-INT-RATE  TO PINTO.
 13833
 13834 3000-EXIT.
 13835     EXIT.
 13836
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 263
* EL156.cbl
 13838 3050-REBUILD-ENTERED.
 13839
 13840     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13841
 13842     IF PI-PROV-PMT
 13843         MOVE '9'           TO PMTTYPEO
 13844     ELSE
 13845         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13846
 13847     MOVE PI-PAYEE          TO PAYEEO.
 13848     MOVE PI-PMTNOTE1       TO NOTE1O.
 13849     MOVE PI-PMTNOTE2       TO NOTE2O.
 13850     MOVE PI-OFFLINE        TO OFFLINEO.
 13851     IF PI-PROOF-DATE NOT = ZEROS
 13852         MOVE PI-PROOF-DATE TO PROOFDTO
 13853         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13854     END-IF.
 13855*    MOVE PI-GROUPED        TO GROUPEDO.
 13856
 13857*    MOVE PI-CASH           TO CASHO.
 13858
 13859     IF PI-INT-RATE > ZEROS
 13860        MOVE PI-INT-RATE         TO PINTO
 13861     end-if
 13862     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13863        IF PI-INT-AMT > ZEROS
 13864           MOVE PI-INT-AMT       TO PINTO
 13865           MOVE AL-PANOF         TO PINTA
 13866                                    PINTHA
 13867           if pi-rb-joint-coverage
 13868              move '  INT TO'    to itrb1o
 13869              move ' REM BORR?'  to itrb2o
 13870              move 'Y'           to itrbyno
 13871              move al-uanon      to itrbyna
 13872              move +1            to itrbynl
 13873           end-if
 13874        END-IF
 13875     END-IF
 13876     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13877     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13878     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13879     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13880     IF PI-HOLDTIL NOT = ZEROS
 13881        MOVE PI-HOLDTIL          TO HOLDTILO
 13882        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13883
 13884     IF PI-EPYFROM NOT = ZEROS
 13885        MOVE PI-EPYFROM          TO EPYFROMO
 13886        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13887
 13888     IF PI-AIGFROM NOT = ZEROS
 13889        MOVE PI-AIGFROM          TO AIGFROMO
 13890        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13891
 13892     IF PI-EPYTHRU NOT = ZEROS
 13893        MOVE PI-EPYTHRU          TO EPYTHRUO
 13894        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13895        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 264
* EL156.cbl
 13896           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13897           MOVE '4'                TO DC-OPTION-CODE
 13898           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13899           IF NO-CONVERSION-ERROR
 13900              MOVE +1 TO DC-ELAPSED-DAYS
 13901              MOVE +0 TO DC-ELAPSED-MONTHS
 13902              MOVE '6' TO DC-OPTION-CODE
 13903              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13904              IF NO-CONVERSION-ERROR
 13905                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13906
 13907     IF PI-EDAYS NOT = ZEROS
 13908        MOVE PI-EDAYS TO EDAYSO.
 13909
 13910     IF PI-EPYAMT NOT = ZEROS
 13911        MOVE PI-EPYAMT TO EPYAMTO.
 13912
 13913     IF PI-ERESV NOT = ZEROS
 13914        MOVE PI-ERESV TO ERESVO.
 13915
 13916     IF PI-EEXPENS NOT = ZEROS
 13917        MOVE PI-EEXPENS TO EEXPENSO.
 13918
 13919     MOVE PI-ETYPE TO ETYPEO.
 13920
 13921     IF PI-ECHECKNO NOT = SPACES
 13922        MOVE PI-ECHECKNO         TO CHECKNOO
 13923     ELSE
 13924        MOVE PI-CCHECKNO         TO CHECKNOO.
 13925
 13926     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13927     MOVE SPACES                 TO DC-OPTION-CODE.
 13928     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13929
 13930     IF DATE-CONVERSION-ERROR
 13931        MOVE SPACES              TO CPYFROMI
 13932     ELSE
 13933        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13934
 13935     IF PI-USES-PAID-TO
 13936        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13937        MOVE +1                  TO DC-ELAPSED-DAYS
 13938        MOVE +0                  TO DC-ELAPSED-MONTHS
 13939        MOVE '6'                 TO DC-OPTION-CODE
 13940        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13941        IF NO-CONVERSION-ERROR
 13942           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13943           GO TO 3051-CONTINUE.
 13944
 13945     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13946     MOVE SPACES                 TO DC-OPTION-CODE.
 13947     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13948
 13949     IF DATE-CONVERSION-ERROR
 13950        MOVE SPACES              TO CPYTHRUI
 13951     ELSE
 13952        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13953
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 265
* EL156.cbl
 13954 3051-CONTINUE.
 13955
 13956     IF PI-CDAYS NOT = ZEROS
 13957        MOVE PI-CDAYS TO CDAYSO.
 13958
 13959     IF PI-CPYAMT NOT = ZEROS
 13960        MOVE PI-CPYAMT TO CPYAMTO.
 13961
 13962     IF PI-CRESV NOT = ZEROS
 13963        MOVE PI-CRESV TO CRESVO.
 13964
 13965     IF PI-CEXPENS NOT = ZEROS
 13966        MOVE PI-CEXPENS TO CEXPENSO.
 13967
 13968 3059-EXIT.
 13969     EXIT.
 13970
 13971 3100-DEEDIT-DATE.
 13972
 13973* EXEC CICS BIF DEEDIT
 13974*        FIELD(DATE-WORK)
 13975*        LENGTH(8)
 13976*    END-EXEC.
 13977     MOVE 8
 13978       TO DFHEIV11
 13979*    MOVE '@"L                   #   #00013206' TO DFHEIV0
 13980     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13981     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13982     MOVE X'2020233030303133323036' TO DFHEIV0(25:11)
 13983     CALL 'kxdfhei1' USING DFHEIV0,
 13984           DATE-WORK,
 13985           DFHEIV11
 13986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13987
 13988
 13989 3100-EXIT.
 13990     EXIT.
 13991
 13992 3200-CALC-AIG-DAYS.
 13993
 13994     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13995
 13996     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13997     MOVE ' '                    TO DC-OPTION-CODE.
 13998     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13999     IF NO-CONVERSION-ERROR
 14000         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 14001     ELSE
 14002         GO TO 3290-ERROR.
 14003
 14004     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14005         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14006                                WS-BIN-FROM-DT
 14007     ELSE
 14008         IF CL-TOTAL-PAID-AMT > ZEROS
 14009             IF WS-SV-EPYFROM = LOW-VALUES
 14010                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14011                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 266
* EL156.cbl
 14012             ELSE
 14013                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14014                                        WS-BIN-FROM-DT
 14015         ELSE
 14016             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14017                                        WS-BIN-FROM-DT.
 14018
 14019 3210-CONTINUE.
 14020
 14021     MOVE ' '                    TO DC-OPTION-CODE.
 14022     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14023     IF DATE-CONVERSION-ERROR
 14024         GO TO 3290-ERROR.
 14025
 14026     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 14027
 14028     IF PI-LOAN-DUE-DAY = 31
 14029         MOVE 30              TO WS-PMT-DUE-DA
 14030                                 WS-SAVE-DUE-DA
 14031     ELSE
 14032         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 14033                                 WS-SAVE-DUE-DA.
 14034
 14035     IF (PI-LOAN-DUE-DAY > 28) AND
 14036        (WS-PMT-DUE-MO = 2)
 14037         MOVE 'Y'                TO WS-DUE-DAY-SW
 14038         MOVE 28                 TO WS-PMT-DUE-DA.
 14039
 14040     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 14041     MOVE '4'                    TO DC-OPTION-CODE.
 14042     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14043     IF NO-CONVERSION-ERROR
 14044         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14045     ELSE
 14046         GO TO 3290-ERROR.
 14047
 14048*--------------------------------------------------------------*
 14049*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14050*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14051*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14052*                                                              *
 14053*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14054*             INCURRED DATE      - 04/15/91                    *
 14055*             PMT DUE DATE       - 04/03/91                    *
 14056*             PMT DUE DATE       - 05/03/91                    *
 14057*--------------------------------------------------------------*
 14058
 14059     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14060        (WS-SV-AIGFROM = LOW-VALUES)
 14061         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14062            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14063             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14064             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14065             IF NO-CONVERSION-ERROR
 14066                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14067                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14068             ELSE
 14069                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 267
* EL156.cbl
 14070
 14071     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14072        (WS-SV-AIGFROM = LOW-VALUES)
 14073         GO TO 3205-CONT-CALC-PMT.
 14074
 14075     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14076     MOVE ' '                    TO DC-OPTION-CODE.
 14077     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14078     IF NO-CONVERSION-ERROR
 14079         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14080     ELSE
 14081         GO TO 3290-ERROR.
 14082
 14083     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14084        (WS-PMT-DUE-DA < WS-FROM-DA)
 14085          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14086          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14087          IF NO-CONVERSION-ERROR
 14088              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14089              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14090          ELSE
 14091              GO TO 3290-ERROR.
 14092
 14093 3205-CONT-CALC-PMT.
 14094
 14095*--------------------------------------------------------------*
 14096*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14097*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14098*--------------------------------------------------------------*
 14099
 14100     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14101        PI-PMTTYPE = '2'
 14102          NEXT SENTENCE
 14103     ELSE
 14104        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14105           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14106             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14107             MOVE ER-3527            TO EMI-ERROR
 14108             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14109             MOVE -1                 TO EPYTHRUL
 14110             MOVE AL-UNBON           TO EPYTHRUA
 14111                                        EPYFROMA
 14112             GO TO 3299-EXIT.
 14113
 14114*--------------------------------------------------------------*
 14115*    CALCULATE RETRO ELIMINATION DATE                          *
 14116*--------------------------------------------------------------*
 14117
 14118     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14119         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14120     ELSE
 14121         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14122
 14123     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14124     MOVE +0             TO DC-ELAPSED-MONTHS.
 14125     MOVE '6'            TO DC-OPTION-CODE.
 14126     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14127     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 268
* EL156.cbl
 14128         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14129     ELSE
 14130         GO TO 3290-ERROR.
 14131
 14132 3210-CHECK-PMT-DATE.
 14133
 14134*--------------------------------------------------------------*
 14135*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14136*    THE ENTERED PAY FROM DATE                                 *
 14137*--------------------------------------------------------------*
 14138
 14139     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14140         NEXT SENTENCE
 14141     ELSE
 14142         GO TO 3220-COMPUTE-DAYS.
 14143
 14144     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14145     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14146     IF NO-CONVERSION-ERROR
 14147         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14148         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14149         GO TO 3210-CHECK-PMT-DATE
 14150     ELSE
 14151         GO TO 3290-ERROR.
 14152
 14153 3220-COMPUTE-DAYS.
 14154
 14155     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14156     MOVE ZEROS         TO WS-CDAYS.
 14157     MOVE 'N'           TO WS-ELIMINATION-SW.
 14158
 14159*--------------------------------------------------------------*
 14160*    COMPUTE CALIFORNIA DUE DAYS                               *
 14161*--------------------------------------------------------------*
 14162
 14163     IF CL-TOTAL-PAID-AMT > ZEROS
 14164         MOVE 'Y' TO WS-ELIMINATION-SW
 14165         GO TO 3240-FIRST-PMT-DUE
 14166     ELSE
 14167        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14168            NEXT SENTENCE
 14169        ELSE
 14170            GO TO 3240-FIRST-PMT-DUE.
 14171
 14172 3230-NEXT-PMT-DUE.
 14173
 14174     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14175     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14176     IF NO-CONVERSION-ERROR
 14177         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14178         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14179     ELSE
 14180         GO TO 3290-ERROR.
 14181
 14182 3240-FIRST-PMT-DUE.
 14183
 14184     IF CL-TOTAL-PAID-AMT > ZEROS
 14185         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 269
* EL156.cbl
 14186     ELSE
 14187        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14188            GO TO 3230-NEXT-PMT-DUE.
 14189
 14190     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14191         GO TO 3250-VERIFY-ELIMINATION.
 14192
 14193     ADD +30 TO WS-CDAYS.
 14194     MOVE 'Y' TO WS-ELIMINATION-SW.
 14195     GO TO 3230-NEXT-PMT-DUE.
 14196
 14197 3250-VERIFY-ELIMINATION.
 14198
 14199     IF ELIM-SATISFIED
 14200         GO TO 3260-END-CALC.
 14201
 14202     IF PI-PMTTYPE = '1'
 14203         MOVE ZEROS TO WS-CDAYS
 14204         GO TO 3260-END-CALC.
 14205
 14206     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14207         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14208     ELSE
 14209         IF CL-TOTAL-PAID-AMT > ZEROS
 14210             IF WS-SV-EPYFROM = LOW-VALUES
 14211                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14212             ELSE
 14213                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14214         ELSE
 14215             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14216
 14217     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14218     MOVE '1'                    TO DC-OPTION-CODE.
 14219     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14220     IF NO-CONVERSION-ERROR
 14221         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14222     ELSE
 14223         GO TO 3290-ERROR.
 14224
 14225     IF CL-TOTAL-PAID-AMT > ZEROS
 14226         MOVE WS-DAYS-OFF TO WS-CDAYS
 14227     ELSE
 14228         IF PI-BEN-DAYS > WS-DAYS-OFF
 14229             MOVE ZEROS TO WS-CDAYS
 14230         ELSE
 14231             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14232
 14233 3260-END-CALC.
 14234
 14235     MOVE WS-CDAYS TO PI-CDAYS.
 14236
 14237     IF PI-EDAYS = ZEROS
 14238         MOVE PI-CDAYS TO PI-EDAYS
 14239         MOVE AL-UNNON TO EDAYSA.
 14240
 14241     GO TO 3299-EXIT.
 14242
 14243 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 270
* EL156.cbl
 14244
 14245     MOVE ER-3528            TO EMI-ERROR.
 14246     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14247     MOVE -1                 TO CDAYSL.
 14248     MOVE AL-UNBON           TO CDAYSA.
 14249
 14250 3299-EXIT.
 14251     EXIT.
 14252
 14253 3300-BUMP-DATE.
 14254
 14255     IF WS-RESTORE-DUE-DAY
 14256         MOVE 'N'              TO WS-DUE-DAY-SW
 14257         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14258         ADD 1                 TO WS-PMT-DUE-MO
 14259         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14260         MOVE '4'              TO DC-OPTION-CODE
 14261         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14262         IF NO-CONVERSION-ERROR
 14263             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14264             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14265             GO TO 3399-EXIT
 14266         ELSE
 14267             MOVE '9'          TO DC-ERROR-CODE
 14268             GO TO 3399-EXIT.
 14269
 14270     IF (WS-PMT-DUE-MO = 1) AND
 14271        (WS-SAVE-DUE-DA > 28)
 14272           MOVE 'Y' TO WS-DUE-DAY-SW.
 14273
 14274     MOVE +0                 TO DC-ELAPSED-DAYS.
 14275     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14276     MOVE '6'                TO DC-OPTION-CODE.
 14277     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14278
 14279 3399-EXIT.
 14280     EXIT.
 14281
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 271
* EL156.cbl
 14283 3400-COMPUTE-EXPIRY.
 14284
 14285     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14286     MOVE +0                    TO DC-ELAPSED-DAYS
 14287                                   DC-ODD-DAYS-OVER.
 14288     MOVE '1'                   TO DC-END-OF-MONTH.
 14289     MOVE '6'                   TO DC-OPTION-CODE.
 14290
 14291     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14292         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14293     ELSE
 14294         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14295
 14296     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14297     IF NO-CONVERSION-ERROR
 14298         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14299     ELSE
 14300         GO TO 3390-CONTINUE.
 14301
 14302     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14303         GO TO 3390-CONTINUE.
 14304
 14305     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14306     MOVE '4'                    TO CNTL-REC-TYPE.
 14307     MOVE +0                     TO CNTL-SEQ-NO.
 14308     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14309     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14310     MOVE 'BENE'                 TO FILE-SWITCH.
 14311
 14312     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14313
 14314     IF NO-BENEFIT-FOUND
 14315         GO TO 3390-CONTINUE.
 14316
 14317     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 14318        IF (PI-OFFLINE = 'Y') OR
 14319           (PI-PMTTYPE = '7')
 14320           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14321                                     THRU 9870-EXIT
 14322           IF ERROR-ON-OUTPUT
 14323             MOVE -1                 TO ENTERPFL
 14324             MOVE AL-UANON           TO ENTERPFA
 14325             MOVE MAP-NAMEA          TO MAP-NAME
 14326             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14327             GO TO 8200-SEND-DATAONLY.
 14328
 14329     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14330        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14331        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14332          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14333          MOVE +0        TO DC-ELAPSED-DAYS
 14334          MOVE +1        TO DC-ELAPSED-MONTHS
 14335          MOVE 6         TO DC-OPTION-CODE
 14336          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14337          IF NO-CONVERSION-ERROR
 14338              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14339
 14340 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 272
* EL156.cbl
 14341
 14342      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14343         MOVE CM-AH-LOAN-EXPIRE-DT
 14344                                 TO DC-BIN-DATE-1
 14345      ELSE
 14346         MOVE CM-LF-LOAN-EXPIRE-DT
 14347                                 TO DC-BIN-DATE-1
 14348      END-IF
 14349
 14350      MOVE ' '                    TO DC-OPTION-CODE.
 14351      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14352      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14353      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14354
 14355 3499-EXIT.
 14356     EXIT.
 14357
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 273
* EL156.cbl
 14359
 14360 3600-CHECK-VERIFICATION.
 14361
 14362     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14363
 14364     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14365
 14366     IF PI-PAYEE-TYPE = 'I'
 14367        GO TO 3600-READ-TRAILER.
 14368
 14369     IF PI-PAYEE-TYPE = 'B'
 14370        ADD +10                  TO TRLR-SEQ-NO
 14371        GO TO 3600-READ-TRAILER.
 14372
 14373     IF PI-PAYEE-TYPE = 'A'
 14374        ADD +20                  TO TRLR-SEQ-NO
 14375        GO TO 3600-READ-TRAILER.
 14376
 14377     IF PI-PAYEE-TYPE = 'O'
 14378        ADD +50                  TO TRLR-SEQ-NO
 14379        GO TO 3600-READ-TRAILER.
 14380
 14381     IF PI-PAYEE-TYPE = 'Q'
 14382        ADD +60                  TO TRLR-SEQ-NO
 14383        GO TO 3600-READ-TRAILER.
 14384
 14385     IF PI-PAYEE-TYPE = 'P'
 14386        ADD +30                  TO TRLR-SEQ-NO
 14387        GO TO 3600-READ-TRAILER.
 14388
 14389     IF PI-PAYEE-TYPE = 'E'
 14390        ADD +40                  TO TRLR-SEQ-NO.
 14391
 14392 3600-READ-TRAILER.
 14393
 14394
 14395* EXEC CICS HANDLE CONDITION
 14396*         NOTFND(3600-CONTINUE)
 14397*    END-EXEC.
 14398*    MOVE '"$I                   ! - #00013616' TO DFHEIV0
 14399     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14401     MOVE X'2D20233030303133363136' TO DFHEIV0(25:11)
 14402     CALL 'kxdfhei1' USING DFHEIV0
 14403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14404
 14405
 14406     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14407
 14408 3600-CONTINUE.
 14409
 14410     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14411         GO TO 3600-AH-VERIFY
 14412     END-IF.
 14413
 14414     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14415       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14416         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 274
* EL156.cbl
 14417           MOVE ER-7576            TO EMI-ERROR
 14418           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14419           MOVE -1                 TO PAYEEL
 14420           MOVE AL-UABON           TO PAYEEA
 14421           GO TO 3600-EXIT
 14422         END-IF
 14423       END-IF
 14424     END-IF.
 14425
 14426     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14427     MOVE 1 TO WS-SUB2
 14428     MOVE SPACES TO WS-PAYEE-NAME
 14429     PERFORM VARYING WS-SUB FROM 1 BY 1
 14430             UNTIL WS-SUB > 30
 14431         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14432            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14433                 WS-PAYEE-NAME-X (WS-SUB2)
 14434            ADD +1 TO WS-SUB2
 14435         END-IF
 14436     END-PERFORM.
 14437
 14438     STRING CL-INSURED-1ST-NAME
 14439            CL-INSURED-MID-INIT
 14440            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14441     MOVE 1 TO WS-SUB2
 14442     MOVE SPACES TO WS-INSURED-NAME
 14443     PERFORM VARYING WS-SUB FROM 1 BY 1
 14444             UNTIL WS-SUB > 30
 14445         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14446            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14447                 WS-INSURED-NAME-X (WS-SUB2)
 14448            ADD +1 TO WS-SUB2
 14449         END-IF
 14450     END-PERFORM.
 14451
 14452     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14453        MOVE ER-7579            TO EMI-ERROR
 14454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14455        MOVE -1                 TO PAYEEL
 14456        MOVE AL-UABON           TO PAYEEA
 14457     END-IF.
 14458
 14459     IF PI-PMTTYPE = '4'  AND
 14460        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14461        PI-PAYEE-TYPE <> 'I'
 14462          MOVE ER-7580          TO EMI-ERROR
 14463          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14464          MOVE -1               TO PAYEEL
 14465          MOVE AL-UABON         TO PAYEEA
 14466     END-IF.
 14467
 14468     GO TO 3600-EXIT.
 14469
 14470 3600-AH-VERIFY.
 14471
 14472     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14473        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14474           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 275
* EL156.cbl
 14475           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14476           MOVE -1                 TO PAYEEL
 14477           MOVE AL-UABON           TO PAYEEA
 14478        END-IF
 14479     END-IF.
 14480
 14481
 14482 3600-EXIT.
 14483     EXIT.
 14484
 14485 5000-UPDATE.
 14486
 14487     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14488
 14489     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14490
 14491     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14492        PI-OFFLINE = 'Y'
 14493        NEXT SENTENCE
 14494     ELSE
 14495        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14496
 14497*    IF PI-COMPANY-ID = 'CRI'
 14498*       IF PI-PMTTYPE = '1' OR  '2'
 14499*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14500*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14501*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14502
 14503*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14504*       IF PI-PMTTYPE = '1'
 14505*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14506*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14507
 14508     IF PI-PMTTYPE      = '2' AND
 14509        PI-SPLIT-PMT-SW = 'Y' AND
 14510        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14511          MOVE ER-3530                TO EMI-ERROR
 14512          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14513
 14514     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14515        AND (CL-CLAIM-TYPE = 'L')
 14516        IF PI-PMTTYPE = '2' OR '4'
 14517           IF PI-INT-AMT NOT = ZEROS
 14518              PERFORM 7110-BUILD-PMT-TRLR
 14519                                 THRU 7130-EXIT
 14520           ELSE
 14521              IF PI-PMTTYPE = '2'
 14522                 PERFORM 7140-BUILD-NOTE-TRLR
 14523                                 THRU 7170-EXIT
 14524              END-IF
 14525           END-IF
 14526        END-IF
 14527     END-IF
 14528*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14529*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14530*            MOVE 'N'                 TO  WS-LETTER-SW.
 14531
 14532*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 276
* EL156.cbl
 14533*        IF CL-NO-OF-PMTS-MADE = +1
 14534*                OR
 14535*           PI-PMTTYPE = '2'
 14536*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14537
 14538     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14539
 14540*    IF PI-COMPANY-ID = 'DMD'
 14541*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14542*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14543
 14544
 14545* EXEC CICS REWRITE
 14546*         DATASET('ELMSTR')
 14547*         FROM(CLAIM-MASTER)
 14548*     END-EXEC.
 14549     MOVE LENGTH OF
 14550      CLAIM-MASTER
 14551       TO DFHEIV11
 14552     MOVE 'ELMSTR' TO DFHEIV1
 14553*    MOVE '&& L                  %   #00013758' TO DFHEIV0
 14554     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14555     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14556     MOVE X'2020233030303133373538' TO DFHEIV0(25:11)
 14557     CALL 'kxdfhei1' USING DFHEIV0,
 14558           DFHEIV1,
 14559           CLAIM-MASTER,
 14560           DFHEIV11,
 14561           DFHEIV99
 14562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14563
 14564
 14565     IF WS-LETTER-SW = 'N'
 14566         GO TO 5000-END-UPDATE.
 14567
 14568 5000-GENERATE-AUTO-LETTER.
 14569
 14570
 14571* EXEC CICS LINK
 14572*        PROGRAM    (LINK-1523)
 14573*        COMMAREA   (W-1523-LINKDATA)
 14574*        LENGTH     (W-1523-COMM-LENGTH)
 14575*    END-EXEC.
 14576*    MOVE '."C                   (   #00013768' TO DFHEIV0
 14577     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14579     MOVE X'2020233030303133373638' TO DFHEIV0(25:11)
 14580     CALL 'kxdfhei1' USING DFHEIV0,
 14581           LINK-1523,
 14582           W-1523-LINKDATA,
 14583           W-1523-COMM-LENGTH,
 14584           DFHEIV99,
 14585           DFHEIV99,
 14586           DFHEIV99,
 14587           DFHEIV99
 14588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14589
 14590
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 277
* EL156.cbl
 14591     IF W-1523-FATAL-ERROR
 14592         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14593         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14594         MOVE ER-0802                TO  EMI-ERROR
 14595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14596
 14597     IF W-1523-ERROR-CODE = 0191
 14598         MOVE ER-0803                TO  EMI-ERROR
 14599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14600
 14601     IF PI-COMPANY-ID      = 'HAN' AND
 14602        PI-PMTTYPE         = '1'   AND
 14603        PI-3RD-PARTY-SW    = 'Y'   AND
 14604        W-1523-FORM-NUMBER = 'EOB1'
 14605           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14606           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14607           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14608           GO TO 5000-GENERATE-AUTO-LETTER.
 14609
 14610 5000-END-UPDATE.
 14611
 14612     MOVE ER-0000                TO EMI-ERROR.
 14613     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14614     GO TO 7000-SHOW-CLAIM.
 14615
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 278
* EL156.cbl
 14617 5000-MOVE-NAME.
 14618     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14619     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14620     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14621
 14622 5000-EXIT.
 14623     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 279
* EL156.cbl
 14625 5300-CREATE-DMO.
 14626
 14627     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14628     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14629     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14630
 14631
 14632* EXEC CICS HANDLE CONDITION
 14633*         NOTFND   (5300-NOTE-NOT-FOUND)
 14634*    END-EXEC.
 14635*    MOVE '"$I                   ! . #00013814' TO DFHEIV0
 14636     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14638     MOVE X'2E20233030303133383134' TO DFHEIV0(25:11)
 14639     CALL 'kxdfhei1' USING DFHEIV0
 14640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14641
 14642
 14643
 14644* EXEC CICS READ
 14645*         DATASET('ERNOTE')
 14646*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14647*         RIDFLD (W-NOTE-KEY)
 14648*    END-EXEC.
 14649     MOVE 'ERNOTE' TO DFHEIV1
 14650*    MOVE '&"S        E          (   #00013818' TO DFHEIV0
 14651     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14652     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14653     MOVE X'2020233030303133383138' TO DFHEIV0(25:11)
 14654     CALL 'kxdfhei1' USING DFHEIV0,
 14655           DFHEIV1,
 14656           DFHEIV20,
 14657           DFHEIV99,
 14658           W-NOTE-KEY,
 14659           DFHEIV99,
 14660           DFHEIV99,
 14661           DFHEIV99
 14662     SET ADDRESS OF CERTIFICATE-NOTE TO
 14663         DFHEIV20
 14664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14665
 14666
 14667     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14668     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14669     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14670
 14671     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14672         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14673     ELSE
 14674         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14675
 14676     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14677     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14678     MOVE 'DLO006'               TO PGM-NAME.
 14679
 14680
 14681* EXEC CICS LINK
 14682*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 280
* EL156.cbl
 14683*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14684*        LENGTH     (DCT-RCRD-LENGTH)
 14685*    END-EXEC.
 14686*    MOVE '."C                   (   #00013837' TO DFHEIV0
 14687     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14689     MOVE X'2020233030303133383337' TO DFHEIV0(25:11)
 14690     CALL 'kxdfhei1' USING DFHEIV0,
 14691           PGM-NAME,
 14692           DCT-COMMUNICATION-AREA,
 14693           DCT-RCRD-LENGTH,
 14694           DFHEIV99,
 14695           DFHEIV99,
 14696           DFHEIV99,
 14697           DFHEIV99
 14698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14699
 14700
 14701     IF DCT-RETURN-CODE = 'OK'
 14702         GO TO 5300-CONT.
 14703
 14704     IF DCT-RETURN-CODE = '01' OR '02'
 14705         GO TO 5300-EXIT.
 14706
 14707     IF DCT-RETURN-CODE = '03'
 14708         MOVE ER-0951            TO EMI-ERROR
 14709         GO TO 5300-BAD-EXIT.
 14710
 14711     IF DCT-RETURN-CODE = '04'
 14712         MOVE ER-0946            TO EMI-ERROR
 14713         GO TO 5300-BAD-EXIT.
 14714
 14715     IF DCT-RETURN-CODE = '05'
 14716         MOVE ER-0947            TO EMI-ERROR
 14717         GO TO 5300-BAD-EXIT.
 14718
 14719     IF DCT-RETURN-CODE = '06'
 14720         MOVE ER-0921            TO EMI-ERROR
 14721         GO TO 5300-BAD-EXIT.
 14722
 14723     IF DCT-RETURN-CODE = '07'
 14724         MOVE ER-0849            TO EMI-ERROR
 14725         GO TO 5300-BAD-EXIT.
 14726
 14727     IF DCT-RETURN-CODE = '08'
 14728         MOVE ER-0948            TO EMI-ERROR
 14729         GO TO 5300-BAD-EXIT.
 14730
 14731     IF DCT-RETURN-CODE = 'N1'
 14732         MOVE ER-0950            TO EMI-ERROR
 14733         GO TO 5300-BAD-EXIT.
 14734
 14735     IF DCT-RETURN-CODE = 'E1'
 14736         MOVE ER-0974            TO EMI-ERROR
 14737         GO TO 5300-BAD-EXIT.
 14738
 14739     IF DCT-RETURN-CODE = 'E2'
 14740         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 281
* EL156.cbl
 14741         GO TO 5300-BAD-EXIT.
 14742
 14743     IF DCT-RETURN-CODE NOT = 'OK'
 14744         MOVE ER-0949            TO EMI-ERROR
 14745         GO TO 5300-BAD-EXIT.
 14746
 14747 5300-CONT.
 14748
 14749     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14750     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14751     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14752     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14753     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14754     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14755     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14756     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14757
 14758     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14759     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14760     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14761     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14762     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14763
 14764     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14765
 14766     IF PI-PMTTYPE = '2'
 14767         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14768         MOVE '4'                TO DM-CLAIM-STATUS
 14769     ELSE
 14770         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14771         MOVE '2'                TO DM-CLAIM-STATUS.
 14772
 14773     MOVE 'DLO025'               TO PGM-NAME.
 14774
 14775
 14776* EXEC CICS LINK
 14777*        PROGRAM    (PGM-NAME)
 14778*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14779*        LENGTH     (DM-DMO-LENGTH)
 14780*    END-EXEC.
 14781*    MOVE '."C                   (   #00013917' TO DFHEIV0
 14782     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14784     MOVE X'2020233030303133393137' TO DFHEIV0(25:11)
 14785     CALL 'kxdfhei1' USING DFHEIV0,
 14786           PGM-NAME,
 14787           DMO-COMMUNICATION-AREA,
 14788           DM-DMO-LENGTH,
 14789           DFHEIV99,
 14790           DFHEIV99,
 14791           DFHEIV99,
 14792           DFHEIV99
 14793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14794
 14795
 14796     IF DM-RETURN-CODE = 'OK'
 14797         GO TO 5300-EXIT.
 14798
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 282
* EL156.cbl
 14799     IF DM-RETURN-CODE = '01'
 14800         MOVE ER-8051            TO EMI-ERROR
 14801         GO TO 5300-BAD-EXIT.
 14802
 14803     IF DM-RETURN-CODE = '02'
 14804         MOVE ER-8052            TO EMI-ERROR
 14805         GO TO 5300-BAD-EXIT.
 14806
 14807     IF DM-RETURN-CODE = '03'
 14808         MOVE ER-8053            TO EMI-ERROR
 14809         GO TO 5300-BAD-EXIT.
 14810
 14811     IF DM-RETURN-CODE = '04'
 14812         MOVE ER-8054            TO EMI-ERROR
 14813         GO TO 5300-BAD-EXIT.
 14814
 14815     IF DM-RETURN-CODE = '05'
 14816         MOVE ER-8055            TO EMI-ERROR
 14817         GO TO 5300-BAD-EXIT.
 14818
 14819     IF DM-RETURN-CODE = '06'
 14820         MOVE ER-8056            TO EMI-ERROR
 14821         GO TO 5300-BAD-EXIT.
 14822
 14823     IF DM-RETURN-CODE = '07'
 14824         MOVE ER-8057            TO EMI-ERROR
 14825         GO TO 5300-BAD-EXIT.
 14826
 14827     IF DM-RETURN-CODE = '08'
 14828         MOVE ER-8058            TO EMI-ERROR
 14829         GO TO 5300-BAD-EXIT.
 14830
 14831     IF DM-RETURN-CODE = '09'
 14832         MOVE ER-8059            TO EMI-ERROR
 14833         GO TO 5300-BAD-EXIT.
 14834
 14835     IF DM-RETURN-CODE = '10'
 14836         MOVE ER-8060            TO EMI-ERROR
 14837         GO TO 5300-BAD-EXIT.
 14838
 14839     IF DM-RETURN-CODE = '11'
 14840         MOVE ER-8061            TO EMI-ERROR
 14841         GO TO 5300-BAD-EXIT.
 14842
 14843     IF DM-RETURN-CODE = '12'
 14844         MOVE ER-8062            TO EMI-ERROR
 14845         GO TO 5300-BAD-EXIT.
 14846
 14847     IF DM-RETURN-CODE = '13'
 14848         MOVE ER-8063            TO EMI-ERROR
 14849         GO TO 5300-BAD-EXIT.
 14850
 14851     IF DM-RETURN-CODE = '14'
 14852         MOVE ER-8064            TO EMI-ERROR
 14853         GO TO 5300-BAD-EXIT.
 14854
 14855     IF DM-RETURN-CODE = '15'
 14856         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 283
* EL156.cbl
 14857         GO TO 5300-BAD-EXIT.
 14858
 14859     IF DM-RETURN-CODE = '16'
 14860         MOVE ER-8154            TO EMI-ERROR
 14861         GO TO 5300-BAD-EXIT.
 14862
 14863     IF DM-RETURN-CODE = '17'
 14864         MOVE ER-8155            TO EMI-ERROR
 14865         GO TO 5300-BAD-EXIT.
 14866
 14867     IF DM-RETURN-CODE = 'N1'
 14868         MOVE ER-8152            TO EMI-ERROR
 14869         GO TO 5300-BAD-EXIT.
 14870
 14871     IF DM-RETURN-CODE = 'E1'
 14872         MOVE ER-8153            TO EMI-ERROR
 14873         GO TO 5300-BAD-EXIT.
 14874
 14875     MOVE ER-8066            TO EMI-ERROR.
 14876     GO TO 5300-BAD-EXIT.
 14877
 14878 5300-NOTE-NOT-FOUND.
 14879
 14880     MOVE ER-0954                TO EMI-ERROR.
 14881     GO TO 5300-BAD-EXIT.
 14882
 14883 5300-BAD-EXIT.
 14884
 14885* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14886*    MOVE '6"R                   !   #00014011' TO DFHEIV0
 14887     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14889     MOVE X'2020233030303134303131' TO DFHEIV0(25:11)
 14890     CALL 'kxdfhei1' USING DFHEIV0
 14891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14892
 14893     IF MAP-NAME = 'EL156A'
 14894         MOVE -1             TO ENTERPFL
 14895       ELSE
 14896         MOVE LOW-VALUES     TO EL156BI
 14897         MOVE -1             TO ENTPFBL.
 14898
 14899     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14900     GO TO 8200-SEND-DATAONLY.
 14901
 14902 5300-EXIT.
 14903     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 284
* EL156.cbl
 14905 5350-FORMAT-LAST-NAME-1ST.
 14906*****************************************************************
 14907*             M O V E   N A M E   R O U T I N E                 *
 14908*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14909*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14910*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14911*                  FIELD                   VALUE                *
 14912*           W-NAME-LAST    (CL15)      SMITH                    *
 14913*           W-NAME-FIRST   (CL15)      JOHN                     *
 14914*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14915*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14916*     CONTAIN                                                   *
 14917*                SMITH, JOHN ALLEN                              *
 14918*     OR                                                        *
 14919*                SMITH, JOHN A.                                 *
 14920*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14921*     COPYBOOK, ELCNWA.                                         *
 14922*****************************************************************.
 14923
 14924     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14925     MOVE ZERO                   TO  WS-NAME-SW.
 14926     SET NWA-INDEX               TO +1.
 14927
 14928     IF W-NAME-LAST   = SPACES AND
 14929        W-NAME-MIDDLE = SPACES
 14930         MOVE +1                 TO WS-NAME-SW.
 14931
 14932     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14933     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14934
 14935     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14936     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14937
 14938     SET NWA-INDEX UP BY +1.
 14939
 14940     IF W-NAME-MIDDLE NOT = SPACES
 14941         IF W-NAME-MIDDLE-2 = SPACES
 14942             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14943             SET NWA-INDEX UP BY +1
 14944             MOVE '.'            TO WS-NW (NWA-INDEX)
 14945             SET NWA-INDEX UP BY +2
 14946         ELSE
 14947             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14948             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14949
 14950 5350-EXIT.
 14951     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 285
* EL156.cbl
 14953 5360-MOVE-NAME.
 14954
 14955     IF WS-NAME-SW > +1
 14956         GO TO 5360-EXIT.
 14957
 14958     IF WS-NAME-WORK2 = SPACES
 14959         GO TO 5360-EXIT.
 14960
 14961     SET NWA-INDEX2            TO +1.
 14962     SET NWA-INDEX3            TO +2.
 14963
 14964 5360-MOVE-NAME-CYCLE.
 14965
 14966     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14967
 14968     IF NWA-INDEX < +30
 14969         SET NWA-INDEX UP BY +1
 14970     ELSE
 14971         ADD +2                TO  WS-NAME-SW
 14972         GO TO 5360-EXIT.
 14973
 14974     IF NWA-INDEX2 < +20
 14975         SET NWA-INDEX3 UP BY +1
 14976         SET NWA-INDEX2 UP BY +1.
 14977
 14978     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14979        WS-NW2 (NWA-INDEX3) = SPACES
 14980         IF WS-NAME-SW = ZERO
 14981             MOVE ','            TO  WS-NW (NWA-INDEX)
 14982             SET NWA-INDEX UP BY +2
 14983             MOVE +1             TO  WS-NAME-SW
 14984             GO TO 5360-EXIT
 14985         ELSE
 14986             GO TO 5360-EXIT.
 14987
 14988     GO TO 5360-MOVE-NAME-CYCLE.
 14989
 14990 5360-EXIT.
 14991     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 286
* EL156.cbl
 14993 6000-BUILD-SCREEN-B.
 14994     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14995     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14996     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14997     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14998
 14999     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15000
 15001 6050-BUILD-SCREEN.
 15002     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 15003     MOVE LOW-VALUES             TO EL156BI.
 15004     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15005
 15006     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 15007
 15008     IF PI-PAYEE-TYPE = 'I'
 15009        GO TO 6060-READ-TRAILER.
 15010
 15011     IF PI-PAYEE-TYPE = 'B'
 15012        ADD +10                  TO TRLR-SEQ-NO
 15013        GO TO 6060-READ-TRAILER.
 15014
 15015     IF PI-PAYEE-TYPE = 'A'
 15016        ADD +20                  TO TRLR-SEQ-NO
 15017        GO TO 6060-READ-TRAILER.
 15018
 15019     IF PI-PAYEE-TYPE = 'O'
 15020        ADD +50                  TO TRLR-SEQ-NO
 15021        GO TO 6060-READ-TRAILER.
 15022
 15023     IF PI-PAYEE-TYPE = 'Q'
 15024        ADD +60                  TO TRLR-SEQ-NO
 15025        GO TO 6060-READ-TRAILER.
 15026
 15027     IF PI-PAYEE-TYPE = 'P'
 15028        ADD +30                  TO TRLR-SEQ-NO
 15029        GO TO 6060-READ-TRAILER.
 15030
 15031     IF PI-PAYEE-TYPE = 'E'
 15032        ADD +40                  TO TRLR-SEQ-NO.
 15033
 15034 6060-READ-TRAILER.
 15035
 15036     IF PI-PAYEE-TYPE    = 'A' AND
 15037        PI-PAYEE-SEQ-NUM = 0
 15038          GO TO 6061-READ-ACCOUNT.
 15039
 15040     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 15041        (PI-PAYEE-TYPE    = 'B')             AND
 15042        (PI-PAYEE-SEQ-NUM = 9)
 15043          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15044          IF BENE-FOUND-SW = 'N'
 15045            GO TO 6065-NOT-FOUND
 15046          ELSE
 15047            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15048            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15049            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15050*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 287
* EL156.cbl
 15051            STRING BE-CITY ' ' BE-STATE
 15052               DELIMITED BY '  ' INTO CITYSTBO
 15053            END-STRING
 15054            MOVE BE-ZIP-CODE       TO ZIPBO
 15055            GO TO 6061-READ-ACCOUNT.
 15056
 15057     IF PI-PAYEE-TYPE    = 'B' AND
 15058        PI-PAYEE-SEQ-NUM = 0
 15059          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15060          IF BENE-FOUND-SW = 'N'
 15061            GO TO 6065-NOT-FOUND
 15062          ELSE
 15063            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15064            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15065            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15066*           MOVE BE-CITY-STATE     TO CITYSTBO
 15067            STRING BE-CITY ' ' BE-STATE
 15068               DELIMITED BY '  ' INTO CITYSTBO
 15069            END-STRING
 15070            MOVE BE-ZIP-CODE       TO ZIPBO
 15071            if be-ach-yes-or-no = 'Y'
 15072               move 'Y'          to pi-ach-payment
 15073            else
 15074               move 'N'          to pi-ach-payment
 15075            end-if
 15076            GO TO 6061-READ-ACCOUNT.
 15077
 15078
 15079* EXEC CICS HANDLE CONDITION
 15080*         NOTFND(6065-NOT-FOUND)
 15081*     END-EXEC.
 15082*    MOVE '"$I                   ! / #00014197' TO DFHEIV0
 15083     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15084     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15085     MOVE X'2F20233030303134313937' TO DFHEIV0(25:11)
 15086     CALL 'kxdfhei1' USING DFHEIV0
 15087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15088
 15089
 15090     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15091
 15092     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15093     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15094     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15095     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15096*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15097     STRING AT-CITY ' ' AT-STATE
 15098        DELIMITED BY '  ' INTO CITYSTBO
 15099     END-STRING
 15100     MOVE AT-ZIP-CODE            TO ZIPBO.
 15101
 15102 6061-READ-ACCOUNT.
 15103
 15104* EXEC CICS HANDLE CONDITION
 15105*         NOTFND(6068-ACCT-NOT-FND)
 15106*     END-EXEC.
 15107*    MOVE '"$I                   ! 0 #00014214' TO DFHEIV0
 15108     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 288
* EL156.cbl
 15109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15110     MOVE X'3020233030303134323134' TO DFHEIV0(25:11)
 15111     CALL 'kxdfhei1' USING DFHEIV0
 15112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15113
 15114
 15115
 15116* EXEC CICS READ
 15117*         DATASET('ERACCT')
 15118*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15119*         RIDFLD (PI-ACCT-KEY)
 15120*     END-EXEC.
 15121     MOVE 'ERACCT' TO DFHEIV1
 15122*    MOVE '&"S        E          (   #00014218' TO DFHEIV0
 15123     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15125     MOVE X'2020233030303134323138' TO DFHEIV0(25:11)
 15126     CALL 'kxdfhei1' USING DFHEIV0,
 15127           DFHEIV1,
 15128           DFHEIV20,
 15129           DFHEIV99,
 15130           PI-ACCT-KEY,
 15131           DFHEIV99,
 15132           DFHEIV99,
 15133           DFHEIV99
 15134     SET ADDRESS OF ACCOUNT-MASTER TO
 15135         DFHEIV20
 15136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15137
 15138
 15139     MOVE AM-CARRIER             TO ACARRBO.
 15140     MOVE AM-GROUPING            TO GROUPBO.
 15141     MOVE AM-STATE               TO STATEBO.
 15142     MOVE AM-ACCOUNT             TO ACCTBO.
 15143     MOVE AM-NAME                TO ACCTNMBO.
 15144
 15145     IF PI-PAYEE-TYPE = 'A' AND
 15146        PI-PAYEE-SEQ-NUM = 0
 15147          MOVE AM-NAME             TO NAMEBO
 15148                                      PI-PAYEE-NAME
 15149          MOVE AM-ADDRS            TO ADDR1BO
 15150          MOVE SPACES              TO ADDR2BO
 15151*         MOVE AM-CITY             TO CITYSTBO
 15152          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15153             DELIMITED BY '  ' INTO CITYSTBO
 15154          END-STRING
 15155          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15156          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15157          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15158          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15159
 15160***  We don't really need the code below because we don't do the
 15161***  AK thing anymore.  However, we may have a state special
 15162***  of some sort in the future so why not just leave it??
 15163     IF CITYSTBO EQUAL SPACES
 15164         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15165         GO TO 6070-FORMAT-DATA
 15166     END-IF.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 289
* EL156.cbl
 15167
 15168     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15169     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15170     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15171     PERFORM VARYING WS-SUB FROM 30 BY -1
 15172          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15173        IF WS-END-SUB = 0  AND
 15174           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15175              OR LOW-VALUES  OR '.')
 15176            CONTINUE
 15177        ELSE
 15178            IF WS-END-SUB = 0
 15179                MOVE WS-SUB TO WS-END-SUB
 15180            ELSE
 15181                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15182                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15183                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15184                END-IF
 15185            END-IF
 15186        END-IF
 15187        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15188            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15189            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15190        END-IF
 15191     END-PERFORM.
 15192
 15193     IF WS-BEG-SUB > 0
 15194         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15195         IF WS-STATE-LENGTH = 2
 15196             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15197                  TO PI-CHECK-STATE-FOR-AK
 15198         ELSE
 15199             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15200                'ALASKA'
 15201                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15202             ELSE
 15203                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15204             END-IF
 15205         END-IF
 15206     ELSE
 15207         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15208     END-IF.
 15209
 15210     GO TO 6070-FORMAT-DATA.
 15211
 15212 6065-NOT-FOUND.
 15213     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15214     GO TO 6061-READ-ACCOUNT.
 15215
 15216 6068-ACCT-NOT-FND.
 15217     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15218
 15219 6070-FORMAT-DATA.
 15220     IF PI-HOLDTIL = ZEROS
 15221        MOVE SAVE-DATE           TO PAYDTBI
 15222       ELSE
 15223        MOVE PI-HOLDTIL          TO PAYDTBO
 15224        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 290
* EL156.cbl
 15225
 15226     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15227     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15228
 15229     IF EIBAID = DFHPF3 OR DFHPF4
 15230        NEXT SENTENCE
 15231     ELSE
 15232       GO TO 6071-CONTINUE.
 15233
 15234     MOVE PI-EPYFROM          TO PYFROMBO.
 15235     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15236
 15237     IF NOT PI-USES-PAID-TO
 15238        MOVE PI-EPYTHRU          TO PYTHRUBO
 15239        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15240     ELSE
 15241        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15242        MOVE '4'              TO DC-OPTION-CODE
 15243        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15244        IF NO-CONVERSION-ERROR
 15245           MOVE +1            TO DC-ELAPSED-DAYS
 15246           MOVE +0            TO DC-ELAPSED-MONTHS
 15247           MOVE '6'           TO DC-OPTION-CODE
 15248           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15249           IF NO-CONVERSION-ERROR
 15250              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15251
 15252     MOVE PI-EDAYS            TO DAYSBO.
 15253     MOVE PI-EPYAMT           TO PAYAMTBO.
 15254     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15255        IF PI-INT-AMT > ZEROS
 15256           MOVE PI-INT-AMT       TO INTAMTBO
 15257        END-IF
 15258     END-IF
 15259     GO TO 6072-SET-TYPE.
 15260
 15261 6071-CONTINUE.
 15262
 15263     IF PI-CPYFROM NOT = LOW-VALUES
 15264        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15265        MOVE SPACES              TO DC-OPTION-CODE
 15266        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15267        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15268
 15269     IF PI-CPYTHRU NOT = LOW-VALUES
 15270        IF NOT PI-USES-PAID-TO
 15271           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15272           MOVE SPACES             TO DC-OPTION-CODE
 15273           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15274           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15275        ELSE
 15276           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15277           MOVE '6'                TO DC-OPTION-CODE
 15278           MOVE +1                 TO DC-ELAPSED-DAYS
 15279           MOVE +0                 TO DC-ELAPSED-MONTHS
 15280           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15281           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15282
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 291
* EL156.cbl
 15283     MOVE PI-CDAYS               TO DAYSBO.
 15284     MOVE PI-CPYAMT              TO PAYAMTBO.
 15285     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15286        IF PI-INT-AMT > ZEROS
 15287           MOVE PI-INT-AMT       TO INTAMTBO
 15288        END-IF
 15289     END-IF
 15290     .
 15291 6072-SET-TYPE.
 15292     IF PI-PMTTYPE = '1'
 15293        MOVE 'PARTIAL'           TO PAYTYPBO.
 15294
 15295     IF PI-PMTTYPE = '2'
 15296        MOVE 'FINAL'             TO PAYTYPBO.
 15297
 15298     IF PI-PMTTYPE = '3'
 15299        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15300
 15301     IF PI-PMTTYPE = '4'
 15302        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15303
 15304     IF PI-PMTTYPE = '5'
 15305        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15306
 15307     IF PI-PMTTYPE = '6'
 15308        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15309
 15310     IF PI-PROV-PMT
 15311        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15312
 15313     IF PI-ECHECKNO NOT = SPACES
 15314        MOVE PI-ECHECKNO         TO CKNUMBO
 15315     ELSE
 15316        MOVE PI-CCHECKNO         TO CKNUMBO.
 15317
 15318     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 15319        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15320        MOVE +91                 TO  TRLR-SEQ-NO
 15321
 15322* EXEC CICS READ
 15323*           DATASET  ('ELTRLR')
 15324*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15325*           RIDFLD   (ELTRLR-KEY)
 15326*           RESP     (WS-RESPONSE)
 15327*       END-EXEC
 15328     MOVE 'ELTRLR' TO DFHEIV1
 15329*    MOVE '&"S        E          (  N#00014406' TO DFHEIV0
 15330     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15331     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15332     MOVE X'204E233030303134343036' TO DFHEIV0(25:11)
 15333     CALL 'kxdfhei1' USING DFHEIV0,
 15334           DFHEIV1,
 15335           DFHEIV20,
 15336           DFHEIV99,
 15337           ELTRLR-KEY,
 15338           DFHEIV99,
 15339           DFHEIV99,
 15340           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 292
* EL156.cbl
 15341     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15342         DFHEIV20
 15343     MOVE EIBRESP  TO WS-RESPONSE
 15344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15345
 15346        IF WS-RESP-NORMAL
 15347           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15348        ELSE
 15349           MOVE SPACES           TO  LOANNBO
 15350        END-IF
 15351     END-IF
 15352
 15353*       MOVE PI-LOAN-NO          TO LOANNBO
 15354
 15355     IF CKNUMBO = SPACES
 15356         MOVE SPACES             TO CKNUMHDO.
 15357
 15358     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15359     MOVE CL-CARRIER             TO CARRBO.
 15360     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15361     MOVE CL-CERT-SFX            TO SUFXBO.
 15362
 15363     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15364        EVALUATE CL-CLAIM-TYPE
 15365           WHEN 'I'
 15366              MOVE '  IU  '      TO CLMTYPBO
 15367           WHEN 'G'
 15368              MOVE ' GAP  '      TO CLMTYPBO
 15369           WHEN 'F'
 15370              MOVE ' FMLA '      TO CLMTYPBO
 15371           WHEN OTHER
 15372              MOVE PI-AH-OVERRIDE-L6
 15373                                 TO CLMTYPBO
 15374        END-EVALUATE
 15375        MOVE ZEROS               TO UNDISBO
 15376*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15377        IF PI-PMTTYPE = '5' OR '6'
 15378           GO TO 6073-GET-NOTIFY-DATA
 15379        ELSE
 15380           MOVE PI-DAILY-RATE    TO RATEBO
 15381           GO TO 6073-GET-NOTIFY-DATA.
 15382
 15383     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15384
 15385     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15386        MOVE ZEROS               TO UNDISBO
 15387     ELSE
 15388        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15389
 15390 6073-GET-NOTIFY-DATA.
 15391
 15392     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15393
 15394     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15395         MOVE SPACES             TO  NAMEB2O
 15396                                     ADDR1B2O
 15397                                     ADDR2B2O
 15398                                     CITYST2O
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 293
* EL156.cbl
 15399                                     AGTHDGO
 15400         MOVE ZEROS              TO  ZIPB2O
 15401         GO TO 6080-SET-INCURRED.
 15402
 15403     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15404     MOVE +29                    TO  TRLR-SEQ-NO.
 15405
 15406
 15407* EXEC CICS HANDLE CONDITION
 15408*        NOTFND   (6074-GET-COMP-DATA)
 15409*    END-EXEC.
 15410*    MOVE '"$I                   ! 1 #00014473' TO DFHEIV0
 15411     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15413     MOVE X'3120233030303134343733' TO DFHEIV0(25:11)
 15414     CALL 'kxdfhei1' USING DFHEIV0
 15415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15416
 15417
 15418     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15419
 15420     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15421     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15422     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15423*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15424     STRING AT-CITY ' ' AT-STATE
 15425        DELIMITED BY '  ' INTO CITYST2O
 15426     END-STRING
 15427     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15428     GO TO 6080-SET-INCURRED.
 15429
 15430 6074-GET-COMP-DATA.
 15431
 15432     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15433         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15434
 15435     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15436         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15437                                         ADDR1B2O
 15438                                         ADDR2B2O
 15439                                         CITYST2O
 15440         MOVE ZEROS                  TO  ZIPB2O
 15441         GO TO 6080-SET-INCURRED.
 15442
 15443     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15444     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15445     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15446     MOVE AM-GROUPING            TO  COMP-GROUP.
 15447     MOVE 'A'                    TO  COMP-TYPE.
 15448     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15449                                 TO  COMP-FIN-RESP.
 15450
 15451     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15452         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15453                                       'G' OR 'B' or 'S'
 15454             MOVE 'G'            TO  COMP-TYPE
 15455             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15456         ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 294
* EL156.cbl
 15457             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15458                                 TO  COMP-ACCOUNT
 15459     ELSE
 15460         MOVE 'G'                TO  COMP-TYPE
 15461         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15462
 15463     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15464
 15465     IF COMP-REC-FOUND
 15466         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15467         MOVE CO-ADDR-1          TO  ADDR1B2O
 15468         MOVE CO-ADDR-2          TO  ADDR2B2O
 15469*        MOVE CO-ADDR-3          TO  CITYST2O
 15470         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15471            DELIMITED BY '  ' INTO CITYST2O
 15472         END-STRING
 15473         MOVE CO-ZIP             TO  ZIPB2O
 15474     ELSE
 15475         MOVE 'NO COMP ADDRESS AVAILABLE'
 15476                                 TO  NAMEB2O
 15477                                     ADDR1B2O
 15478                                     ADDR2B2O
 15479                                     CITYST2O
 15480         MOVE ZEROS               TO ZIPB2O.
 15481
 15482 6080-SET-INCURRED.
 15483     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15484     MOVE SPACES                 TO DC-OPTION-CODE.
 15485     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15486     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15487     MOVE PI-PROCESSOR-ID        TO BYBO.
 15488     MOVE MAP-NAMEB              TO MAP-NAME.
 15489     MOVE 'C'                    TO PI-PASS-SW.
 15490     MOVE EIBAID                 TO PI-PFKEY-USED.
 15491     MOVE -1                     TO ENTPFBL.
 15492     GO TO 8100-SEND-INITIAL-MAP.
 15493
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 295
* EL156.cbl
 15495 6100-BUILD-PAYMENT-TRAILER.
 15496
 15497     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15498     MOVE '6'                    TO CNTL-REC-TYPE.
 15499
 15500     IF CONTROL-IS-ACTUAL-CARRIER
 15501         MOVE PI-CARRIER         TO WS-CARR
 15502     ELSE
 15503         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15504
 15505     IF PI-COMPANY-ID = 'FIA'
 15506         MOVE PI-CARRIER         TO  WS-CARR.
 15507
 15508     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15509     MOVE 0                      TO CNTL-SEQ-NO.
 15510     MOVE 'CARR'                 TO FILE-SWITCH.
 15511
 15512     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15513
 15514     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15515         IF PI-OFFLINE     = 'Y' AND
 15516            PI-ECHECKNO-CR = 'CR'
 15517              GO TO 6110-READ-CONTROL
 15518         ELSE
 15519            IF PI-CASH = 'N'
 15520                GO TO 6110-READ-CONTROL.
 15521
 15522     IF CHECK-NO-MANUAL    OR
 15523        CHECK-NO-AT-PRINT  OR
 15524        PI-OFFLINE = 'Y'
 15525          GO TO 6130-BUILD-TRAILER.
 15526     IF PI-COMPANY-ID = 'FIA'
 15527         NEXT SENTENCE
 15528     ELSE
 15529         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15530             GO TO 6110-READ-CONTROL.
 15531
 15532     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15533
 15534     IF CHECK-CNT-RESET-VALUE
 15535        MOVE +1                  TO CF-CHECK-COUNTER
 15536     ELSE
 15537        ADD +1                   TO CF-CHECK-COUNTER.
 15538
 15539     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15540
 15541     IF CHECK-NO-CARR-SEQ
 15542        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15543
 15544     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15545
 15546     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15547     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15548        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15549         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15550         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15551            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15552         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 296
* EL156.cbl
 15553                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15554     END-IF.
 15555
 15556     GO TO 6120-REWRITE.
 15557
 15558 6105-STATE-CHECK-NUMBER.
 15559     IF CHECK-NO-MANUAL    OR
 15560        CHECK-NO-AT-PRINT  OR
 15561        PI-OFFLINE = 'Y'
 15562           GO TO 6130-BUILD-TRAILER
 15563     END-IF.
 15564
 15565     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15566     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15567     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15568     MOVE '3'                TO CNTL-REC-TYPE.
 15569     MOVE +0                 TO CNTL-SEQ-NO.
 15570     MOVE 'STAT'             TO FILE-SWITCH.
 15571     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15572
 15573     IF CF-ST-CHECK-CNT-RESET
 15574         MOVE +1             TO CF-ST-CHECK-COUNTER
 15575     ELSE
 15576         ADD +1              TO CF-ST-CHECK-COUNTER
 15577     END-IF.
 15578
 15579     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15580     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15581     GO TO 6120-REWRITE.
 15582
 15583 6110-READ-CONTROL.
 15584     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15585     MOVE '1'                    TO CNTL-REC-TYPE.
 15586     MOVE SPACES                 TO CNTL-ACCESS.
 15587     MOVE 0                      TO CNTL-SEQ-NO.
 15588
 15589     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15590
 15591     IF CO-CHECK-COUNT-RESET
 15592        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15593     ELSE
 15594        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15595
 15596     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15597
 15598     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15599         IF PI-OFFLINE     = 'Y'  AND
 15600            PI-ECHECKNO-CR = 'CR'
 15601              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15602              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15603              MOVE AL-UANON           TO CHECKNOA
 15604              GO TO 6120-REWRITE
 15605         ELSE
 15606         IF PI-CASH = 'N'
 15607             MOVE 'N'                TO PI-ECHECKNO-N
 15608             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15609             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15610             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 297
* EL156.cbl
 15611             GO TO 6120-REWRITE.
 15612
 15613     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15614
 15615 6120-REWRITE.
 15616
 15617* EXEC CICS REWRITE
 15618*         DATASET('ELCNTL')
 15619*         FROM(CONTROL-FILE)
 15620*     END-EXEC.
 15621     MOVE LENGTH OF
 15622      CONTROL-FILE
 15623       TO DFHEIV11
 15624     MOVE 'ELCNTL' TO DFHEIV1
 15625*    MOVE '&& L                  %   #00014675' TO DFHEIV0
 15626     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15627     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15628     MOVE X'2020233030303134363735' TO DFHEIV0(25:11)
 15629     CALL 'kxdfhei1' USING DFHEIV0,
 15630           DFHEIV1,
 15631           CONTROL-FILE,
 15632           DFHEIV11,
 15633           DFHEIV99
 15634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15635
 15636
 15637     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15638
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 298
* EL156.cbl
 15640 6130-BUILD-TRAILER.
 15641
 15642
 15643* EXEC CICS GETMAIN
 15644*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15645*         LENGTH    (200)
 15646*         INITIMG   (GETMAIN-SPACE)
 15647*     END-EXEC.
 15648     MOVE 200
 15649       TO DFHEIV11
 15650*    MOVE ',"IL                  $   #00014685' TO DFHEIV0
 15651     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15652     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15653     MOVE X'2020233030303134363835' TO DFHEIV0(25:11)
 15654     CALL 'kxdfhei1' USING DFHEIV0,
 15655           DFHEIV20,
 15656           DFHEIV11,
 15657           GETMAIN-SPACE
 15658     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15659         DFHEIV20
 15660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15661
 15662
 15663     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15664                                    AT-PREV-PAID-THRU-DT.
 15665     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15666     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15667     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15668     MOVE 'AT'                   TO AT-RECORD-ID.
 15669     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15670
 15671     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15672        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15673           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15674     ELSE
 15675           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15676           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15677
 15678     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15679         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15680             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15681             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15682           ELSE
 15683             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15684             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15685
 15686     MOVE '2'                    TO AT-TRAILER-TYPE.
 15687     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15688                                    AT-PAYMENT-LAST-MAINT-DT.
 15689     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15690                                    AT-PAYMENT-LAST-UPDATED-BY.
 15691     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15692     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15693     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15694     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15695
 15696     IF PI-PMT-APPROVED
 15697        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 299
* EL156.cbl
 15698           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15699
 15700     IF PI-PFKEY-USED = DFHPF5
 15701        GO TO 6140-PF5-ENTERED.
 15702
 15703     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15704     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15705
 15706     IF PI-AIG-SPECIAL-BENEFIT
 15707         IF WS-1ST-SPECIAL-PMT
 15708             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15709             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15710                                        AT-AMOUNT-PAID
 15711         ELSE
 15712             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15713
 15714     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15715
 15716     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15717     MOVE '4'                    TO DC-OPTION-CODE.
 15718     PERFORM 9700-LINK-DATE-CONVERT.
 15719
 15720     IF DATE-CONVERSION-ERROR
 15721        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15722     ELSE
 15723        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15724
 15725     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15726     MOVE '4'                    TO DC-OPTION-CODE.
 15727     PERFORM 9700-LINK-DATE-CONVERT.
 15728
 15729     IF DATE-CONVERSION-ERROR
 15730        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15731     ELSE
 15732        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15733
 15734     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15735     move pi-ach-payment         to at-ach-payment
 15736     GO TO 6150-FINISH-MOVE.
 15737
 15738 6140-PF5-ENTERED.
 15739     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15740     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15741
 15742     IF PI-AIG-SPECIAL-BENEFIT
 15743         IF WS-1ST-SPECIAL-PMT
 15744             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15745             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15746                                        AT-AMOUNT-PAID
 15747         ELSE
 15748             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15749
 15750     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15751     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15752     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15753
 15754 6150-FINISH-MOVE.
 15755
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 300
* EL156.cbl
 15756     IF PI-ECHECKNO = SPACES
 15757         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15758     ELSE
 15759         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15760
 15761     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15762     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15763
 15764*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15765*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15766
 15767     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15768         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15769
 15770     IF PI-OFFLINE = 'N'
 15771        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15772        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15773     ELSE
 15774        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15775        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15776
 15777     move pi-ach-payment         to at-ach-payment
 15778     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15779
 15780     IF WS-2ND-SPECIAL-PMT
 15781         MOVE 'Y'                TO AT-CASH-PAYMENT
 15782         MOVE SPACES             TO AT-CHECK-NO
 15783         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15784         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15785         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15786         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15787
 15788     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15789                                    AT-TO-BE-WRITTEN-DT.
 15790
 15791     IF PI-HOLDTIL NOT = ZEROS
 15792        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15793        MOVE '4'                 TO DC-OPTION-CODE
 15794        PERFORM 9700-LINK-DATE-CONVERT
 15795        IF PI-OFFLINE = 'N'
 15796           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15797        ELSE
 15798           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15799
 15800     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15801     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15802                                    AT-CHECK-QUE-SEQUENCE.
 15803
 15804     IF PI-PFKEY-USED = DFHPF4
 15805        MOVE '1'                 TO AT-FORCE-CONTROL.
 15806
 15807     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15808        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15809        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15810        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15811
 15812     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15813                                    AT-VOID-SELECT-DT
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 301
* EL156.cbl
 15814                                    AT-VOID-ACCEPT-DT
 15815                                    AT-VOID-DT.
 15816     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15817        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15818        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15819        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15820        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15821     ELSE
 15822        MOVE ZEROS               TO AT-DAILY-RATE
 15823                                    AT-ELIMINATION-DAYS
 15824        MOVE SPACES              TO AT-BENEFIT-TYPE
 15825     END-IF
 15826     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15827     MOVE '4'                    TO DC-OPTION-CODE.
 15828     PERFORM 9700-LINK-DATE-CONVERT.
 15829     IF DATE-CONVERSION-ERROR
 15830         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15831     ELSE
 15832         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15833     END-IF.
 15834     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15835     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15836     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15837     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15838     IF (PI-REAUDIT-NEEDED = 'Y')
 15839        or (pi-max-ext-used = 'Y')
 15840        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15841         PERFORM 6155-READ-CONTROL
 15842         PERFORM 6157-SET-APP-LEVEL
 15843         IF AT-APPROVAL-LEVEL-REQD < '4'
 15844            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15845         END-IF
 15846         MOVE 'Y' TO WS-NEED-APPROVAL
 15847         GO TO 6170-WRITE
 15848     END-IF.
 15849*******************************************************
 15850     IF NOT PI-PMT-GRADUATED
 15851         GO TO 6170-WRITE.
 15852     PERFORM 6155-READ-CONTROL.
 15853
 15854     IF PAID-FOR-LIFE
 15855         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15856             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15857                                     WS-PMT-APPROVAL-SW
 15858             GO TO 6170-WRITE.
 15859
 15860*05999      IF PAID-FOR-AH
 15861     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15862         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15863             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15864                                     WS-PMT-APPROVAL-SW
 15865             GO TO 6170-WRITE.
 15866
 15867     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15868
 15869     PERFORM 6157-SET-APP-LEVEL.
 15870
 15871     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 302
* EL156.cbl
 15872
 15873     IF NOT PI-PMT-GRADUATED
 15874         GO TO 6170-WRITE.
 15875
 15876
 15877* EXEC CICS HANDLE CONDITION
 15878*        NOTFND   (6170-WRITE)
 15879*    END-EXEC.
 15880*    MOVE '"$I                   ! 2 #00014904' TO DFHEIV0
 15881     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15883     MOVE X'3220233030303134393034' TO DFHEIV0(25:11)
 15884     CALL 'kxdfhei1' USING DFHEIV0
 15885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15886
 15887
 15888     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15889     MOVE '2'                    TO CNTL-REC-TYPE.
 15890     MOVE +0                     TO CNTL-SEQ-NO.
 15891     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15892
 15893
 15894* EXEC CICS READ
 15895*         DATASET  ('ELCNTL')
 15896*         SET      (ADDRESS OF CONTROL-FILE)
 15897*         RIDFLD   (ELCNTL-KEY)
 15898*    END-EXEC.
 15899     MOVE 'ELCNTL' TO DFHEIV1
 15900*    MOVE '&"S        E          (   #00014913' TO DFHEIV0
 15901     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15902     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15903     MOVE X'2020233030303134393133' TO DFHEIV0(25:11)
 15904     CALL 'kxdfhei1' USING DFHEIV0,
 15905           DFHEIV1,
 15906           DFHEIV20,
 15907           DFHEIV99,
 15908           ELCNTL-KEY,
 15909           DFHEIV99,
 15910           DFHEIV99,
 15911           DFHEIV99
 15912     SET ADDRESS OF CONTROL-FILE TO
 15913         DFHEIV20
 15914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15915
 15916
 15917     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15918
 15919     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15920                         OR '4' OR '5'
 15921         NEXT SENTENCE
 15922     ELSE
 15923         MOVE 'Y' TO WS-NEED-APPROVAL
 15924         GO TO 6170-WRITE.
 15925
 15926     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15927         MOVE 'Y' TO WS-NEED-APPROVAL
 15928         IF WS-APPROVAL-LEVEL = '1'
 15929             MOVE '2'        TO  AT-APPROVED-LEVEL
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 303
* EL156.cbl
 15930                            WS-SAVE-APPROVED-LEVEL
 15931             GO TO 6170-WRITE
 15932         ELSE
 15933             IF WS-APPROVAL-LEVEL = '2'
 15934                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15935                                WS-SAVE-APPROVED-LEVEL
 15936                 GO TO 6170-WRITE
 15937             ELSE IF WS-APPROVAL-LEVEL = '3'
 15938                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15939                                WS-SAVE-APPROVED-LEVEL
 15940                 GO TO 6170-WRITE
 15941             ELSE IF WS-APPROVAL-LEVEL = '4'
 15942                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15943                                WS-SAVE-APPROVED-LEVEL
 15944                 GO TO 6170-WRITE.
 15945
 15946     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15947                             WS-PMT-APPROVAL-SW.
 15948     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15949                             AT-APPROVAL-LEVEL-REQD.
 15950
 15951*******************************************************
 15952 6155-READ-CONTROL.
 15953     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15954     MOVE '1'                    TO CNTL-REC-TYPE.
 15955     MOVE SPACES                 TO CNTL-ACCESS.
 15956     MOVE +0                     TO CNTL-SEQ-NO.
 15957     MOVE 'COMP'                 TO FILE-SWITCH.
 15958
 15959     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15960 6157-SET-APP-LEVEL.
 15961******A&H Limits are set as a monthly payment.  Calculate the mont
 15962******equivalent of the amount paid today
 15963     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15964        PI-SAVE-ODD-DAYS-OVER > 0
 15965           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15966                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15967           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15968                                  WS-CALC-PMT-MONTHS
 15969     ELSE
 15970           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15971     END-IF.
 15972*06007      IF ((PAID-FOR-AH) AND
 15973     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15974*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15975        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15976              OR
 15977        ((PAID-FOR-LIFE) AND
 15978        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15979            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15980       ELSE
 15981*06014      IF ((PAID-FOR-AH)  AND
 15982         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15983*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15984           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15985              OR
 15986        ((PAID-FOR-LIFE) AND
 15987        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 304
* EL156.cbl
 15988            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15989         ELSE
 15990*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15991           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15992               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15993              OR
 15994          ((PAID-FOR-LIFE) AND
 15995          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15996            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15997       ELSE
 15998           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15999               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 16000              OR
 16001          ((PAID-FOR-LIFE) AND
 16002          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 16003            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16004       ELSE
 16005            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16006
 16007     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 16008        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 16009        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 16010            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16011        END-IF
 16012     ELSE
 16013     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 16014        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 16015        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 16016            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16017        END-IF
 16018     ELSE
 16019     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 16020        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 16021        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 16022            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16023        END-IF
 16024     ELSE
 16025     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 16026        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 16027        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 16028            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16029        END-IF
 16030     ELSE
 16031     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 16032            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16033
 16034 6170-WRITE.
 16035
 16036     if pi-company-id = 'DCC' or 'CAP'
 16037        PERFORM 0900-GET-DDF-limits
 16038                                 THRU 0900-EXIT
 16039     end-if
 16040     perform 2220-update-elcrtt  thru 2220-exit
 16041     IF PI-COMPANY-ID = 'DMD'
 16042        IF PI-AT-EOB-CODES NOT = SPACES
 16043           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16044           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16045           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 305
* EL156.cbl
 16046           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16047           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16048
 16049
 16050* EXEC CICS HANDLE CONDITION
 16051*        DUPREC    (6180-DUPREC)
 16052*    END-EXEC.
 16053*    MOVE '"$%                   ! 3 #00015051' TO DFHEIV0
 16054     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16055     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16056     MOVE X'3320233030303135303531' TO DFHEIV0(25:11)
 16057     CALL 'kxdfhei1' USING DFHEIV0
 16058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16059
 16060
 16061
 16062* EXEC CICS WRITE
 16063*         DATASET       ('ELTRLR')
 16064*         FROM          (ACTIVITY-TRAILERS)
 16065*         RIDFLD        (AT-CONTROL-PRIMARY)
 16066*     END-EXEC.
 16067     MOVE LENGTH OF
 16068      ACTIVITY-TRAILERS
 16069       TO DFHEIV11
 16070     MOVE 'ELTRLR' TO DFHEIV1
 16071*    MOVE '&$ L                  ''   #00015055' TO DFHEIV0
 16072     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16073     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16074     MOVE X'2020233030303135303535' TO DFHEIV0(25:11)
 16075     CALL 'kxdfhei1' USING DFHEIV0,
 16076           DFHEIV1,
 16077           ACTIVITY-TRAILERS,
 16078           DFHEIV11,
 16079           AT-CONTROL-PRIMARY,
 16080           DFHEIV99,
 16081           DFHEIV99
 16082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16083
 16084
 16085     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16086        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16087*06088           GO TO 6199-EXIT.
 16088           GO TO 6176-APPROVAL-NOTE.
 16089
 16090
 16091* EXEC CICS GETMAIN
 16092*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16093*         LENGTH    (200)
 16094*         INITIMG   (GETMAIN-SPACE)
 16095*     END-EXEC.
 16096     MOVE 200
 16097       TO DFHEIV11
 16098*    MOVE ',"IL                  $   #00015066' TO DFHEIV0
 16099     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16100     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16101     MOVE X'2020233030303135303636' TO DFHEIV0(25:11)
 16102     CALL 'kxdfhei1' USING DFHEIV0,
 16103           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 306
* EL156.cbl
 16104           DFHEIV11,
 16105           GETMAIN-SPACE
 16106     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16107         DFHEIV20
 16108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16109
 16110
 16111     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16112
 16113     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16114     MOVE 'AT'                   TO AT-RECORD-ID.
 16115     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16116     MOVE '6'                    TO AT-TRAILER-TYPE.
 16117     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16118                                    AT-GEN-INFO-LAST-MAINT-DT
 16119     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16120                                    AT-GEN-INFO-LAST-UPDATED-BY
 16121     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16122
 16123     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16124     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16125     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16126
 16127     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16128
 16129 6175-WRITE.
 16130
 16131
 16132* EXEC CICS HANDLE CONDITION
 16133*        DUPREC    (6190-DUPREC)
 16134*    END-EXEC.
 16135*    MOVE '"$%                   ! 4 #00015092' TO DFHEIV0
 16136     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16137     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16138     MOVE X'3420233030303135303932' TO DFHEIV0(25:11)
 16139     CALL 'kxdfhei1' USING DFHEIV0
 16140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16141
 16142
 16143
 16144* EXEC CICS WRITE
 16145*         DATASET     ('ELTRLR')
 16146*         FROM        (ACTIVITY-TRAILERS)
 16147*         RIDFLD      (AT-CONTROL-PRIMARY)
 16148*     END-EXEC.
 16149     MOVE LENGTH OF
 16150      ACTIVITY-TRAILERS
 16151       TO DFHEIV11
 16152     MOVE 'ELTRLR' TO DFHEIV1
 16153*    MOVE '&$ L                  ''   #00015096' TO DFHEIV0
 16154     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16155     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16156     MOVE X'2020233030303135303936' TO DFHEIV0(25:11)
 16157     CALL 'kxdfhei1' USING DFHEIV0,
 16158           DFHEIV1,
 16159           ACTIVITY-TRAILERS,
 16160           DFHEIV11,
 16161           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 307
* EL156.cbl
 16162           DFHEIV99,
 16163           DFHEIV99
 16164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16165
 16166
 16167 6176-APPROVAL-NOTE.
 16168
 16169     IF NOT APPROVAL-NEEDED
 16170         GO TO 6199-EXIT.
 16171
 16172
 16173* EXEC CICS GETMAIN
 16174*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16175*        LENGTH    (200)
 16176*        INITIMG   (GETMAIN-SPACE)
 16177*    END-EXEC.
 16178     MOVE 200
 16179       TO DFHEIV11
 16180*    MOVE ',"IL                  $   #00015107' TO DFHEIV0
 16181     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16182     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16183     MOVE X'2020233030303135313037' TO DFHEIV0(25:11)
 16184     CALL 'kxdfhei1' USING DFHEIV0,
 16185           DFHEIV20,
 16186           DFHEIV11,
 16187           GETMAIN-SPACE
 16188     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16189         DFHEIV20
 16190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16191
 16192
 16193     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16194
 16195     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16196     MOVE 'AT'               TO AT-RECORD-ID
 16197     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16198     MOVE '6'                TO AT-TRAILER-TYPE
 16199     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16200                                AT-GEN-INFO-LAST-MAINT-DT
 16201     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16202                                AT-GEN-INFO-LAST-UPDATED-BY
 16203     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16204
 16205     IF PI-REAUDIT-NEEDED = 'Y'
 16206         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16207     ELSE
 16208         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16209     END-IF
 16210     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16211         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16212     END-IF
 16213     MOVE SPACES             TO AT-INFO-LINE-2
 16214
 16215     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16216 6177-WRITE.
 16217
 16218
 16219* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 308
* EL156.cbl
 16220*        DUPREC    (6185-DUPREC)
 16221*    END-EXEC.
 16222*    MOVE '"$%                   ! 5 #00015138' TO DFHEIV0
 16223     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16224     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16225     MOVE X'3520233030303135313338' TO DFHEIV0(25:11)
 16226     CALL 'kxdfhei1' USING DFHEIV0
 16227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16228
 16229
 16230
 16231* EXEC CICS WRITE
 16232*         DATASET     ('ELTRLR')
 16233*         FROM        (ACTIVITY-TRAILERS)
 16234*         RIDFLD      (AT-CONTROL-PRIMARY)
 16235*     END-EXEC.
 16236     MOVE LENGTH OF
 16237      ACTIVITY-TRAILERS
 16238       TO DFHEIV11
 16239     MOVE 'ELTRLR' TO DFHEIV1
 16240*    MOVE '&$ L                  ''   #00015142' TO DFHEIV0
 16241     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16242     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16243     MOVE X'2020233030303135313432' TO DFHEIV0(25:11)
 16244     CALL 'kxdfhei1' USING DFHEIV0,
 16245           DFHEIV1,
 16246           ACTIVITY-TRAILERS,
 16247           DFHEIV11,
 16248           AT-CONTROL-PRIMARY,
 16249           DFHEIV99,
 16250           DFHEIV99
 16251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16252
 16253
 16254
 16255     GO TO 6199-EXIT.
 16256
 16257 6180-DUPREC.
 16258
 16259     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16260     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16261     GO TO 6170-WRITE.
 16262
 16263 6185-DUPREC.
 16264     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16265     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16266     GO TO 6177-WRITE.
 16267
 16268 6190-DUPREC.
 16269     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16270     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16271     GO TO 6175-WRITE.
 16272
 16273 6199-EXIT.
 16274      EXIT.
 16275
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 309
* EL156.cbl
 16277 6200-UPDATE-CLAIM-MSTR.
 16278     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16279     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16280     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16281     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16282
 16283     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16284
 16285     MOVE ZEROS                  TO W-INTEREST.
 16286
 16287     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 16288        IF (PI-OFFLINE = 'Y') OR
 16289           (PI-PMTTYPE = '7')
 16290           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16291                                 THRU 9870-EXIT
 16292        END-IF
 16293     END-IF
 16294     IF NOT ERROR-ON-OUTPUT
 16295        CONTINUE
 16296     ELSE
 16297
 16298* EXEC CICS REWRITE
 16299*          DATASET('ELMSTR')
 16300*          FROM(CLAIM-MASTER)
 16301*       END-EXEC
 16302     MOVE LENGTH OF
 16303      CLAIM-MASTER
 16304       TO DFHEIV11
 16305     MOVE 'ELMSTR' TO DFHEIV1
 16306*    MOVE '&& L                  %   #00015191' TO DFHEIV0
 16307     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16308     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16309     MOVE X'2020233030303135313931' TO DFHEIV0(25:11)
 16310     CALL 'kxdfhei1' USING DFHEIV0,
 16311           DFHEIV1,
 16312           CLAIM-MASTER,
 16313           DFHEIV11,
 16314           DFHEIV99
 16315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16316
 16317        MOVE -1                  TO ENTPFBL
 16318        MOVE AL-UANON            TO ENTPFBA
 16319        MOVE MAP-NAMEB           TO MAP-NAME
 16320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16321        GO TO 8200-SEND-DATAONLY
 16322     END-IF
 16323
 16324     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16325
 16326     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16327
 16328     IF PI-AIG-SPECIAL-BENEFIT
 16329         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16330
 16331     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16332
 16333     IF PI-SPECIAL-BEN-SW = 'Y'
 16334         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 310
* EL156.cbl
 16335         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16336
 16337     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16338         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16339     ELSE
 16340         IF PI-PMTTYPE NOT = '4'
 16341            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16342
 16343     IF PI-PMTTYPE = '5' OR '6'
 16344        GO TO  6250-SET-MAINT.
 16345
 16346     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16347                                         CL-LAG-REPORT-CODE.
 16348
 16349     IF CL-ACTIVITY-CODE = 09
 16350         GO TO 6200-CONT-UPDATE.
 16351
 16352     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16353         IF CL-ACTIVITY-CODE = 11
 16354             GO TO 6200-CONT-UPDATE.
 16355
 16356     IF WS-ACT-REC-FOUND-SW = 'N'
 16357         GO TO 6200-CONT-UPDATE.
 16358
 16359     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16360         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16361         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16362         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16363
 16364     IF WS-UPDATE-SW = 'Y'
 16365         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16366                                         CL-NEXT-FOLLOWUP-DT.
 16367
 16368 6200-CONT-UPDATE.
 16369
 16370     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16371       IF CLAIM-IS-CLOSED
 16372         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16373           IF WS-OPEN-CLOSE-SW = '2'
 16374             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16375                                        CL-LAST-CLOSE-DT.
 16376
 16377     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16378        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16379        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16380
 16381     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16382        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16383        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16384        MOVE 'C'                 TO CL-CLAIM-STATUS
 16385        IF PI-PMTTYPE = '2'
 16386           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16387              or 'F')
 16388           CONTINUE
 16389        ELSE
 16390           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16391        END-IF
 16392     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 311
* EL156.cbl
 16393        IF PI-PMTTYPE = '2' OR '3'
 16394           IF PI-PMTTYPE = '2' AND
 16395              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16396                 or 'F')
 16397              CONTINUE
 16398           ELSE
 16399              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16400           END-IF
 16401        END-IF
 16402     END-IF
 16403
 16404     IF PI-PMTTYPE = '4'
 16405        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16406
 16407     IF PI-COMPANY-ID = 'CVL'
 16408         IF PI-LOAN-UPDATE-SW = 'Y'
 16409             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16410             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16411             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16412             MOVE CL-CERT-STATE      TO  CERT-STATE
 16413             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16414             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16415             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16416             MOVE 'CERT'             TO  FILE-SWITCH
 16417             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16418             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16419             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16420
 16421     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16422        GO TO 6220-USE-COMPUTED.
 16423
 16424     IF (PI-PMTTYPE = '4')  AND
 16425        (PI-EPYAMT < ZEROS)
 16426          COMPUTE CL-NO-OF-DAYS-PAID =
 16427                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16428          IF CL-NO-OF-DAYS-PAID < +0
 16429              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16430          ELSE
 16431              NEXT SENTENCE
 16432     ELSE
 16433          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16434
 16435     IF PI-PROCESSOR-ID = 'FIX '
 16436        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16437           NEXT SENTENCE
 16438        ELSE
 16439           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16440     ELSE
 16441        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16442
 16443     IF PI-PMTTYPE = '4'
 16444        GO TO 6250-SET-MAINT.
 16445
 16446     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16447
 16448     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16449     MOVE '4'                    TO DC-OPTION-CODE.
 16450     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 312
* EL156.cbl
 16451     IF DATE-CONVERSION-ERROR
 16452        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16453     ELSE
 16454        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16455           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16456           IF PI-AIG-SPECIAL-BENEFIT
 16457               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16458           ELSE
 16459               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16460
 16461     GO TO 6250-SET-MAINT.
 16462
 16463 6220-USE-COMPUTED.
 16464
 16465     IF (PI-PMTTYPE = '4')  AND
 16466        (PI-CPYAMT < ZEROS)
 16467          COMPUTE CL-NO-OF-DAYS-PAID =
 16468                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16469          IF CL-NO-OF-DAYS-PAID < +0
 16470              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16471          ELSE
 16472              NEXT SENTENCE
 16473     ELSE
 16474          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16475
 16476     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16477
 16478     IF PI-PMTTYPE = '4'
 16479        GO TO 6250-SET-MAINT.
 16480
 16481     IF PI-AIG-SPECIAL-BENEFIT
 16482         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16483     ELSE
 16484         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16485
 16486     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16487
 16488     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16489        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16490
 16491 6250-SET-MAINT.
 16492     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16493
 16494     IF PI-PROCESSOR-ID = 'FIX '
 16495        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16496           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16497        ELSE
 16498           NEXT SENTENCE
 16499     ELSE
 16500        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16501
 16502     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16503     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16504     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16505
 16506 6299-EXIT.
 16507      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 313
* EL156.cbl
 16509 6300-UPDATE-CERT.
 16510
 16511*  ADD CERTNOTE FOR SC NP+6
 16512     IF PI-COMPANY-ID = 'CID' AND
 16513       (PI-PMTTYPE = '2' OR '3') AND
 16514        CL-CERT-STATE = 'SC'  AND
 16515        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16516           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16517     END-IF.
 16518
 16519     IF PI-COMPANY-ID = 'AHL' AND
 16520       (PI-PMTTYPE = '2' OR '3') AND
 16521        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16522           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16523           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16524     END-IF.
 16525
 16526     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16527     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16528     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16529     MOVE CL-CERT-STATE    TO CERT-STATE.
 16530     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16531     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16532     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16533     MOVE 'CERT'           TO FILE-SWITCH.
 16534
 16535     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16536
 16537     IF CERT-NOTE-ADDED
 16538        IF CM-NOTE-SW = ' '
 16539           MOVE '4'             TO CM-NOTE-SW
 16540        ELSE
 16541           IF CM-NOTE-SW = '1'
 16542               MOVE '5'           TO CM-NOTE-SW
 16543           ELSE
 16544              IF CM-NOTE-SW = '2'
 16545                 MOVE '6'         TO CM-NOTE-SW
 16546              ELSE
 16547                 IF CM-NOTE-SW = '3'
 16548                    MOVE '7'      TO CM-NOTE-SW
 16549                 END-IF
 16550              END-IF
 16551           END-IF
 16552        END-IF
 16553     END-IF.
 16554
 16555     IF PI-COMPANY-ID = 'CVL'
 16556         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16557         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16558
 16559     IF PI-PMTTYPE NOT = '4'
 16560        GO TO 6340-UPDATE-CERT.
 16561
 16562     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16563        IF PI-PFKEY-USED = DFHPF5
 16564           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16565        ELSE
 16566           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 314
* EL156.cbl
 16567
 16568*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16569*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16570*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16571*               PI-LF-COVERAGE-TYPE = 'P'
 16572*                GO TO 6350-REWRITE-CERT.
 16573
 16574     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16575       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16576          PI-LF-COVERAGE-TYPE = 'P'
 16577           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16578                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16579                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16580                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16581                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16582                GO TO 6350-REWRITE-CERT
 16583            ELSE
 16584                GO TO 6350-REWRITE-CERT.
 16585
 16586     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16587         GO TO 6350-REWRITE-CERT.
 16588
 16589     IF NOT CM-AH-LUMP-SUM-DISAB
 16590        GO TO 6380-UNLOCK-CERT.
 16591
 16592     IF PI-PFKEY-USED = DFHPF5
 16593        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16594                                    CM-AH-ITD-AH-PMT
 16595        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16596        GO TO 6350-REWRITE-CERT
 16597     ELSE
 16598        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16599                                    CM-AH-ITD-AH-PMT
 16600        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16601        GO TO 6350-REWRITE-CERT.
 16602
 16603 6340-UPDATE-CERT.
 16604
 16605     IF CL-CLAIM-TYPE = 'L'
 16606         IF PI-PFKEY-USED = DFHPF5
 16607             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16608         ELSE
 16609             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16610
 16611     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16612         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16613             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16614                PI-LF-COVERAGE-TYPE = 'P'
 16615                 GO TO 6350-REWRITE-CERT.
 16616
 16617     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16618       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16619          PI-LF-COVERAGE-TYPE = 'P'
 16620           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16621                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16622                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16623                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16624                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 315
* EL156.cbl
 16625                GO TO 6350-REWRITE-CERT.
 16626
 16627     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16628         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16629            PI-LF-COVERAGE-TYPE NOT = 'P'
 16630             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16631             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16632             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16633             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16634             GO TO 6350-REWRITE-CERT.
 16635
 16636     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16637         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16638         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16639         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16640         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16641         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16642         IF PI-PFKEY-USED = DFHPF5
 16643             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16644                                        CM-AH-ITD-AH-PMT
 16645             GO TO 6350-REWRITE-CERT
 16646         ELSE
 16647             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16648                                        CM-AH-ITD-AH-PMT
 16649             GO TO 6350-REWRITE-CERT.
 16650
 16651 6350-REWRITE-CERT.
 16652
 16653
 16654* EXEC CICS REWRITE
 16655*         DATASET  ('ELCERT')
 16656*         FROM(CERTIFICATE-MASTER)
 16657*     END-EXEC.
 16658     MOVE LENGTH OF
 16659      CERTIFICATE-MASTER
 16660       TO DFHEIV11
 16661     MOVE 'ELCERT' TO DFHEIV1
 16662*    MOVE '&& L                  %   #00015532' TO DFHEIV0
 16663     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16664     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16665     MOVE X'2020233030303135353332' TO DFHEIV0(25:11)
 16666     CALL 'kxdfhei1' USING DFHEIV0,
 16667           DFHEIV1,
 16668           CERTIFICATE-MASTER,
 16669           DFHEIV11,
 16670           DFHEIV99
 16671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16672
 16673
 16674     GO TO 6399-EXIT.
 16675
 16676 6380-UNLOCK-CERT.
 16677
 16678* EXEC CICS UNLOCK
 16679*         DATASET  ('ELCERT')
 16680*     END-EXEC.
 16681     MOVE 'ELCERT' TO DFHEIV1
 16682*    MOVE '&*                    #   #00015540' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 316
* EL156.cbl
 16683     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16684     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16685     MOVE X'2020233030303135353430' TO DFHEIV0(25:11)
 16686     CALL 'kxdfhei1' USING DFHEIV0,
 16687           DFHEIV1,
 16688           DFHEIV99
 16689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16690
 16691
 16692 6399-EXIT.
 16693      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 317
* EL156.cbl
 16695 6400-UPDATE-ZERO-TRAILER.
 16696     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16697     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16698
 16699     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16700
 16701     IF PI-EPYAMT NOT = ZEROS
 16702         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16703     ELSE
 16704         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16705
 16706     IF PI-ERESV NOT = ZEROS
 16707        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16708
 16709     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16710        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16711
 16712     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16713        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16714     ELSE
 16715        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16716
 16717     IF PI-PMTTYPE = '5'
 16718        IF PI-EPYAMT = ZEROS
 16719           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16720        ELSE
 16721           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16722
 16723     IF PI-PMTTYPE = '6'
 16724        IF PI-EPYAMT = ZEROS
 16725           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16726        ELSE
 16727           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16728
 16729 6420-CHECK-OPEN-CLOSE.
 16730     IF PI-PMTTYPE = '5' OR '6'
 16731        GO TO 6450-REWRITE.
 16732
 16733     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16734         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16735             IF CLAIM-IS-CLOSED
 16736                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16737                 MOVE 1          TO  SUB-1
 16738                 GO TO 6440-AIG-LOOP.
 16739
 16740     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16741        GO TO 6450-REWRITE.
 16742
 16743     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16744        GO TO 6450-REWRITE.
 16745
 16746     MOVE 1                      TO SUB-1.
 16747
 16748 6430-LOOP.
 16749     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16750        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16751        IF PI-PMTTYPE = '1' OR '4'
 16752           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 318
* EL156.cbl
 16753           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16754           GO TO 6450-REWRITE
 16755        ELSE
 16756           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16757           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16758           GO TO 6450-REWRITE.
 16759
 16760     IF SUB-1 = 6
 16761      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16762      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16763      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16764      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16765      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16766      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16767      GO TO 6430-LOOP.
 16768
 16769     ADD 1                       TO SUB-1.
 16770     GO TO 6430-LOOP.
 16771
 16772
 16773 6440-AIG-LOOP.
 16774
 16775     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16776       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16777       IF WS-OPEN-CLOSE-SW = '1'
 16778         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16779         IF PI-PMTTYPE = '2'
 16780           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16781           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16782         ELSE
 16783           IF PI-PMTTYPE = '3'
 16784             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16785             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16786           ELSE
 16787             IF PI-PMTTYPE = '4'
 16788               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16789               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16790             ELSE
 16791               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16792               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16793       ELSE
 16794         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16795         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16796         GO TO 6450-REWRITE.
 16797
 16798     IF SUB-1 = 6
 16799      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16800      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16801      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16802      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16803      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16804      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16805      GO TO 6440-AIG-LOOP.
 16806
 16807     ADD 1                       TO SUB-1.
 16808     GO TO 6440-AIG-LOOP.
 16809
 16810 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 319
* EL156.cbl
 16811     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16812     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16813     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16814
 16815     IF PI-COMPANY-ID = 'DMD'
 16816         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16817         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16818         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16819         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16820         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16821
 16822
 16823* EXEC CICS REWRITE
 16824*         DATASET  ('ELTRLR')
 16825*         FROM     (ACTIVITY-TRAILERS)
 16826*     END-EXEC.
 16827     MOVE LENGTH OF
 16828      ACTIVITY-TRAILERS
 16829       TO DFHEIV11
 16830     MOVE 'ELTRLR' TO DFHEIV1
 16831*    MOVE '&& L                  %   #00015674' TO DFHEIV0
 16832     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16833     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16834     MOVE X'2020233030303135363734' TO DFHEIV0(25:11)
 16835     CALL 'kxdfhei1' USING DFHEIV0,
 16836           DFHEIV1,
 16837           ACTIVITY-TRAILERS,
 16838           DFHEIV11,
 16839           DFHEIV99
 16840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16841
 16842
 16843 6499-EXIT.
 16844      EXIT.
 16845
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 320
* EL156.cbl
 16847 6500-READ-DLO035.
 16848     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16849     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16850     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16851     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16852
 16853
 16854* EXEC CICS LINK
 16855*        PROGRAM    ('DLO035')
 16856*        COMMAREA   (DLO035-KEY)
 16857*        LENGTH     (DL35-LENGTH)
 16858*    END-EXEC.
 16859     MOVE 'DLO035' TO DFHEIV1
 16860*    MOVE '."C                   (   #00015689' TO DFHEIV0
 16861     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16863     MOVE X'2020233030303135363839' TO DFHEIV0(25:11)
 16864     CALL 'kxdfhei1' USING DFHEIV0,
 16865           DFHEIV1,
 16866           DLO035-KEY,
 16867           DL35-LENGTH,
 16868           DFHEIV99,
 16869           DFHEIV99,
 16870           DFHEIV99,
 16871           DFHEIV99
 16872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16873
 16874
 16875     IF DL35-RETURN-CODE = 'OK'
 16876         GO TO 6500-EXIT.
 16877
 16878     IF DL35-RETURN-CODE = '01'
 16879         MOVE ER-7830            TO EMI-ERROR
 16880         GO TO 6500-BAD-EXIT.
 16881
 16882     IF DL35-RETURN-CODE = '02'
 16883         MOVE ER-7831            TO EMI-ERROR
 16884         GO TO 6500-BAD-EXIT.
 16885
 16886     IF DL35-RETURN-CODE = '03'
 16887         MOVE ER-7832            TO EMI-ERROR
 16888         GO TO 6500-BAD-EXIT.
 16889
 16890     IF DL35-RETURN-CODE = '04'
 16891         MOVE ER-7833            TO EMI-ERROR
 16892         GO TO 6500-BAD-EXIT.
 16893
 16894     IF DL35-RETURN-CODE = '05'
 16895         MOVE ER-7834            TO EMI-ERROR
 16896         GO TO 6500-BAD-EXIT.
 16897
 16898     IF DL35-RETURN-CODE = '06'
 16899         MOVE ER-7835            TO EMI-ERROR
 16900         GO TO 6500-BAD-EXIT.
 16901
 16902     IF DL35-RETURN-CODE = '07'
 16903         MOVE ER-7836            TO EMI-ERROR
 16904         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 321
* EL156.cbl
 16905
 16906     IF DL35-RETURN-CODE = 'E1'
 16907         MOVE ER-7837            TO EMI-ERROR
 16908         GO TO 6500-BAD-EXIT.
 16909
 16910     IF DL35-RETURN-CODE NOT = 'OK'
 16911         MOVE ER-7838            TO EMI-ERROR
 16912         GO TO 6500-BAD-EXIT.
 16913
 16914 6500-EXIT.
 16915      EXIT.
 16916
 16917 6500-BAD-EXIT.
 16918
 16919* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16920*    MOVE '6"R                   !   #00015738' TO DFHEIV0
 16921     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16923     MOVE X'2020233030303135373338' TO DFHEIV0(25:11)
 16924     CALL 'kxdfhei1' USING DFHEIV0
 16925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16926
 16927     MOVE -1                 TO PMTTYPEL.
 16928     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16929     GO TO 8200-SEND-DATAONLY.
 16930
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 322
* EL156.cbl
 16932 6600-UPDATE-DLO035.
 16933     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16934     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16935     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16936     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16937
 16938
 16939* EXEC CICS LINK
 16940*        PROGRAM    ('DLO035')
 16941*        COMMAREA   (DLO035-KEY)
 16942*        LENGTH     (DL35-LENGTH)
 16943*    END-EXEC.
 16944     MOVE 'DLO035' TO DFHEIV1
 16945*    MOVE '."C                   (   #00015750' TO DFHEIV0
 16946     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16948     MOVE X'2020233030303135373530' TO DFHEIV0(25:11)
 16949     CALL 'kxdfhei1' USING DFHEIV0,
 16950           DFHEIV1,
 16951           DLO035-KEY,
 16952           DL35-LENGTH,
 16953           DFHEIV99,
 16954           DFHEIV99,
 16955           DFHEIV99,
 16956           DFHEIV99
 16957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16958
 16959
 16960     IF DL35-RETURN-CODE = 'OK'
 16961         GO TO 6600-EXIT.
 16962
 16963     IF DL35-RETURN-CODE = '01'
 16964         MOVE ER-7830            TO EMI-ERROR
 16965         GO TO 6500-BAD-EXIT.
 16966
 16967     IF DL35-RETURN-CODE = '02'
 16968         MOVE ER-7831            TO EMI-ERROR
 16969         GO TO 6500-BAD-EXIT.
 16970
 16971     IF DL35-RETURN-CODE = '03'
 16972         MOVE ER-7832            TO EMI-ERROR
 16973         GO TO 6500-BAD-EXIT.
 16974
 16975     IF DL35-RETURN-CODE = '04'
 16976         MOVE ER-7833            TO EMI-ERROR
 16977         GO TO 6500-BAD-EXIT.
 16978
 16979     IF DL35-RETURN-CODE = '05'
 16980         MOVE ER-7834            TO EMI-ERROR
 16981         GO TO 6500-BAD-EXIT.
 16982
 16983     IF DL35-RETURN-CODE = '06'
 16984         MOVE ER-7835            TO EMI-ERROR
 16985         GO TO 6500-BAD-EXIT.
 16986
 16987     IF DL35-RETURN-CODE = '07'
 16988         MOVE ER-7836            TO EMI-ERROR
 16989         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 323
* EL156.cbl
 16990
 16991     IF DL35-RETURN-CODE = 'E1'
 16992         MOVE ER-7837            TO EMI-ERROR
 16993         GO TO 6500-BAD-EXIT.
 16994
 16995     IF DL35-RETURN-CODE NOT = 'OK'
 16996         MOVE ER-7838            TO EMI-ERROR
 16997         GO TO 6500-BAD-EXIT.
 16998
 16999 6600-EXIT.
 17000      EXIT.
 17001
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 324
* EL156.cbl
 17003 6700-UPDATE-ACTQ.
 17004***************************************************************
 17005*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 17006*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 17007*    ONE ALREADY THERE.                                       *
 17008***************************************************************
 17009
 17010
 17011* EXEC CICS HANDLE CONDITION
 17012*         NOTFND(6720-BUILD-NEW-RECORD)
 17013*     END-EXEC.
 17014*    MOVE '"$I                   ! 6 #00015806' TO DFHEIV0
 17015     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17016     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17017     MOVE X'3620233030303135383036' TO DFHEIV0(25:11)
 17018     CALL 'kxdfhei1' USING DFHEIV0
 17019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17020
 17021
 17022
 17023* EXEC CICS READ
 17024*         DATASET('ELACTQ')
 17025*         RIDFLD (ELMSTR-KEY)
 17026*         SET    (ADDRESS OF ACTIVITY-QUE)
 17027*         UPDATE
 17028*     END-EXEC.
 17029     MOVE 'ELACTQ' TO DFHEIV1
 17030*    MOVE '&"S        EU         (   #00015810' TO DFHEIV0
 17031     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17032     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17033     MOVE X'2020233030303135383130' TO DFHEIV0(25:11)
 17034     CALL 'kxdfhei1' USING DFHEIV0,
 17035           DFHEIV1,
 17036           DFHEIV20,
 17037           DFHEIV99,
 17038           ELMSTR-KEY,
 17039           DFHEIV99,
 17040           DFHEIV99,
 17041           DFHEIV99
 17042     SET ADDRESS OF ACTIVITY-QUE TO
 17043         DFHEIV20
 17044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17045
 17046
 17047     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17048
 17049     IF PI-AIG-SPECIAL-BENEFIT AND
 17050        PI-CASH = 'Y'
 17051         ADD 2                   TO AQ-PAYMENT-COUNTER
 17052     ELSE
 17053         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17054
 17055     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17056         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17057
 17058     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17059
 17060     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 325
* EL156.cbl
 17061         IF WS-PMT-APPROVAL-SW = 'A'
 17062             NEXT SENTENCE
 17063         ELSE
 17064            IF PI-AIG-SPECIAL-BENEFIT AND
 17065               PI-CASH = 'Y'
 17066                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17067                                     WS-PMT-UNAPPROVED-CNT
 17068            ELSE
 17069                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17070                                     WS-PMT-UNAPPROVED-CNT
 17071     ELSE
 17072         IF PI-PMT-APPR-SW = 'Y'
 17073            IF PI-AIG-SPECIAL-BENEFIT AND
 17074               PI-CASH = 'Y'
 17075                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17076                                     WS-PMT-UNAPPROVED-CNT
 17077            ELSE
 17078                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17079                                     WS-PMT-UNAPPROVED-CNT.
 17080
 17081     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17082         MOVE ER-3536 TO EMI-ERROR
 17083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17084
 17085     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17086
 17087
 17088* EXEC CICS REWRITE
 17089*         DATASET('ELACTQ')
 17090*         FROM   (ACTIVITY-QUE)
 17091*     END-EXEC.
 17092     MOVE LENGTH OF
 17093      ACTIVITY-QUE
 17094       TO DFHEIV11
 17095     MOVE 'ELACTQ' TO DFHEIV1
 17096*    MOVE '&& L                  %   #00015857' TO DFHEIV0
 17097     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17098     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17099     MOVE X'2020233030303135383537' TO DFHEIV0(25:11)
 17100     CALL 'kxdfhei1' USING DFHEIV0,
 17101           DFHEIV1,
 17102           ACTIVITY-QUE,
 17103           DFHEIV11,
 17104           DFHEIV99
 17105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17106
 17107
 17108     GO TO 6799-EXIT.
 17109
 17110 6720-BUILD-NEW-RECORD.
 17111
 17112* EXEC CICS GETMAIN
 17113*         SET    (ADDRESS OF ACTIVITY-QUE)
 17114*         LENGTH (60)
 17115*         INITIMG(GETMAIN-SPACE)
 17116*     END-EXEC.
 17117     MOVE 60
 17118       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 326
* EL156.cbl
 17119*    MOVE ',"IL                  $   #00015865' TO DFHEIV0
 17120     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17121     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17122     MOVE X'2020233030303135383635' TO DFHEIV0(25:11)
 17123     CALL 'kxdfhei1' USING DFHEIV0,
 17124           DFHEIV20,
 17125           DFHEIV11,
 17126           GETMAIN-SPACE
 17127     SET ADDRESS OF ACTIVITY-QUE TO
 17128         DFHEIV20
 17129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17130
 17131
 17132     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17133
 17134     IF PI-AIG-SPECIAL-BENEFIT AND
 17135        PI-CASH = 'Y'
 17136         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17137     ELSE
 17138         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17139
 17140     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17141     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17142     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17143     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17144                                    AQ-FOLLOWUP-DATE.
 17145     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17146     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17147
 17148     IF PI-PMT-GRADUATED
 17149         IF WS-PMT-APPROVAL-SW = 'A'
 17150             NEXT SENTENCE
 17151         ELSE
 17152            IF PI-AIG-SPECIAL-BENEFIT AND
 17153               PI-CASH = 'Y'
 17154                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17155            ELSE
 17156                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17157     ELSE
 17158         IF PI-PMT-APPR-SW = 'Y'
 17159            IF PI-AIG-SPECIAL-BENEFIT AND
 17160               PI-CASH = 'Y'
 17161                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17162            ELSE
 17163                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17164
 17165     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17166         MOVE ER-3536 TO EMI-ERROR
 17167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17168
 17169
 17170* EXEC CICS WRITE
 17171*         DATASET('ELACTQ')
 17172*         RIDFLD (ELMSTR-KEY)
 17173*         FROM   (ACTIVITY-QUE)
 17174*     END-EXEC.
 17175     MOVE LENGTH OF
 17176      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 327
* EL156.cbl
 17177       TO DFHEIV11
 17178     MOVE 'ELACTQ' TO DFHEIV1
 17179*    MOVE '&$ L                  ''   #00015908' TO DFHEIV0
 17180     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17181     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17182     MOVE X'2020233030303135393038' TO DFHEIV0(25:11)
 17183     CALL 'kxdfhei1' USING DFHEIV0,
 17184           DFHEIV1,
 17185           ACTIVITY-QUE,
 17186           DFHEIV11,
 17187           ELMSTR-KEY,
 17188           DFHEIV99,
 17189           DFHEIV99
 17190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17191
 17192
 17193 6799-EXIT.
 17194      EXIT.
 17195
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 328
* EL156.cbl
 17197 6800-BUILD-FORM-TRAILER.
 17198
 17199
 17200* EXEC CICS GETMAIN
 17201*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17202*         LENGTH   (200)
 17203*         INITIMG  (GETMAIN-SPACE)
 17204*    END-EXEC.
 17205     MOVE 200
 17206       TO DFHEIV11
 17207*    MOVE ',"IL                  $   #00015920' TO DFHEIV0
 17208     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17209     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17210     MOVE X'2020233030303135393230' TO DFHEIV0(25:11)
 17211     CALL 'kxdfhei1' USING DFHEIV0,
 17212           DFHEIV20,
 17213           DFHEIV11,
 17214           GETMAIN-SPACE
 17215     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17216         DFHEIV20
 17217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17218
 17219
 17220     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17221
 17222     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17223     MOVE 'AT'                   TO AT-RECORD-ID.
 17224     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17225
 17226     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17227     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17228                                    AT-FORM-LAST-MAINT-DT
 17229                                    AT-FORM-SEND-ON-DT.
 17230     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17231                                    AT-FORM-LAST-UPDATED-BY.
 17232     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17233     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17234     MOVE '6'                    TO DC-OPTION-CODE.
 17235     MOVE +29                    TO DC-ELAPSED-DAYS.
 17236     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17237     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17238     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17239
 17240     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17241         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17242
 17243     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17244                                    AT-FORM-RE-SEND-DT
 17245                                    AT-EMP-FORM-ANSWERED-DT
 17246                                    AT-PHY-FORM-ANSWERED-DT
 17247                                    AT-EMP-FORM-SEND-ON-DT
 17248                                    AT-PHY-FORM-SEND-ON-DT
 17249                                    AT-FORM-PRINTED-DT
 17250                                    AT-FORM-REPRINT-DT.
 17251     MOVE '2'                    TO AT-FORM-TYPE.
 17252
 17253     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17254     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 329
* EL156.cbl
 17255
 17256     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17257         NEXT SENTENCE
 17258     ELSE
 17259         IF CL-PROG-FORM-TYPE NOT = 'S'
 17260            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17261
 17262
 17263* EXEC CICS WRITE
 17264*         DATASET  ('ELTRLR')
 17265*         FROM     (ACTIVITY-TRAILERS)
 17266*         RIDFLD   (AT-CONTROL-PRIMARY)
 17267*     END-EXEC.
 17268     MOVE LENGTH OF
 17269      ACTIVITY-TRAILERS
 17270       TO DFHEIV11
 17271     MOVE 'ELTRLR' TO DFHEIV1
 17272*    MOVE '&$ L                  ''   #00015968' TO DFHEIV0
 17273     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17275     MOVE X'2020233030303135393638' TO DFHEIV0(25:11)
 17276     CALL 'kxdfhei1' USING DFHEIV0,
 17277           DFHEIV1,
 17278           ACTIVITY-TRAILERS,
 17279           DFHEIV11,
 17280           AT-CONTROL-PRIMARY,
 17281           DFHEIV99,
 17282           DFHEIV99
 17283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17284
 17285
 17286 6899-EXIT.
 17287      EXIT.
 17288
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 330
* EL156.cbl
 17290 6900-BUILD-ARCHIVE-HEADER.
 17291
 17292     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17293     MOVE '1'                    TO CNTL-REC-TYPE.
 17294     MOVE +0                     TO CNTL-SEQ-NO.
 17295     MOVE SPACES                 TO CNTL-ACCESS.
 17296
 17297
 17298* EXEC CICS READ
 17299*         DATASET  ('ELCNTL')
 17300*         SET      (ADDRESS OF CONTROL-FILE)
 17301*         RIDFLD   (ELCNTL-KEY)
 17302*         UPDATE
 17303*    END-EXEC.
 17304     MOVE 'ELCNTL' TO DFHEIV1
 17305*    MOVE '&"S        EU         (   #00015985' TO DFHEIV0
 17306     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17307     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17308     MOVE X'2020233030303135393835' TO DFHEIV0(25:11)
 17309     CALL 'kxdfhei1' USING DFHEIV0,
 17310           DFHEIV1,
 17311           DFHEIV20,
 17312           DFHEIV99,
 17313           ELCNTL-KEY,
 17314           DFHEIV99,
 17315           DFHEIV99,
 17316           DFHEIV99
 17317     SET ADDRESS OF CONTROL-FILE TO
 17318         DFHEIV20
 17319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17320
 17321
 17322     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17323     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17324
 17325
 17326* EXEC CICS REWRITE
 17327*         FROM     (CONTROL-FILE)
 17328*         DATASET  ('ELCNTL')
 17329*    END-EXEC.
 17330     MOVE LENGTH OF
 17331      CONTROL-FILE
 17332       TO DFHEIV11
 17333     MOVE 'ELCNTL' TO DFHEIV1
 17334*    MOVE '&& L                  %   #00015995' TO DFHEIV0
 17335     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17336     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17337     MOVE X'2020233030303135393935' TO DFHEIV0(25:11)
 17338     CALL 'kxdfhei1' USING DFHEIV0,
 17339           DFHEIV1,
 17340           CONTROL-FILE,
 17341           DFHEIV11,
 17342           DFHEIV99
 17343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17344
 17345
 17346
 17347* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 331
* EL156.cbl
 17348*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17349*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17350*    END-EXEC.
 17351*    MOVE '"$$%                  ! 7 #00016000' TO DFHEIV0
 17352     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17354     MOVE X'3720233030303136303030' TO DFHEIV0(25:11)
 17355     CALL 'kxdfhei1' USING DFHEIV0
 17356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17357
 17358
 17359
 17360* EXEC CICS GETMAIN
 17361*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17362*         LENGTH  (ELARCH-LENGTH)
 17363*         INITIMG (GETMAIN-SPACE)
 17364*    END-EXEC.
 17365*    MOVE ',"IL                  $   #00016005' TO DFHEIV0
 17366     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17367     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17368     MOVE X'2020233030303136303035' TO DFHEIV0(25:11)
 17369     CALL 'kxdfhei1' USING DFHEIV0,
 17370           DFHEIV20,
 17371           ELARCH-LENGTH,
 17372           GETMAIN-SPACE
 17373     SET ADDRESS OF LETTER-ARCHIVE TO
 17374         DFHEIV20
 17375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17376
 17377
 17378     MOVE 'LA'                   TO LA-RECORD-ID.
 17379     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17380                                    LA-ARCHIVE-NO-A1.
 17381     MOVE '4'                    TO LA-RECORD-TYPE
 17382                                    LA-RECORD-TYPE-A1.
 17383     MOVE +0                     TO LA-LINE-SEQ-NO
 17384                                    LA-LINE-SEQ-NO-A1.
 17385     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17386                                    LA-COMPANY-CD-A1.
 17387     MOVE CL-CARRIER             TO LA4-CARRIER.
 17388     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17389     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17390     MOVE CL-CERT-STATE          TO LA4-STATE.
 17391     MOVE +0                     TO LA4-NO-OF-COPIES.
 17392     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17393     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17394     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17395                                    LA4-INITIAL-PRINT-DATE
 17396                                    LA4-RESEND-PRINT-DATE
 17397                                    LA4-FORM-REM-PRINT-DT.
 17398     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17399     MOVE '2'                    TO LA4-FORM-TYPE.
 17400
 17401
 17402* EXEC CICS WRITE
 17403*         DATASET  ('ELARCH')
 17404*         FROM     (LETTER-ARCHIVE)
 17405*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 332
* EL156.cbl
 17406*    END-EXEC.
 17407     MOVE LENGTH OF
 17408      LETTER-ARCHIVE
 17409       TO DFHEIV11
 17410     MOVE 'ELARCH' TO DFHEIV1
 17411*    MOVE '&$ L                  ''   #00016034' TO DFHEIV0
 17412     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17413     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17414     MOVE X'2020233030303136303334' TO DFHEIV0(25:11)
 17415     CALL 'kxdfhei1' USING DFHEIV0,
 17416           DFHEIV1,
 17417           LETTER-ARCHIVE,
 17418           DFHEIV11,
 17419           LA-CONTROL-PRIMARY,
 17420           DFHEIV99,
 17421           DFHEIV99
 17422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17423
 17424
 17425 6999-EXIT.
 17426      EXIT.
 17427
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 333
* EL156.cbl
 17429 7000-SHOW-CLAIM.
 17430     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17431     MOVE 'A'                    TO PI-PASS-SW.
 17432     MOVE LOW-VALUES             TO PI-CPYFROM
 17433                                    PI-MONTH-END-SAVE
 17434                                    PI-CPYTHRU.
 17435
 17436     MOVE ZEROS                  TO PI-FATAL-COUNT
 17437                                    PI-DAILY-RATE
 17438                                    PI-BEN-DAYS
 17439                                    PI-MANUAL-SW
 17440                                    PI-SAVE-CURSOR
 17441                                    PI-FORCE-COUNT
 17442                                    PI-HOLDTIL
 17443                                    PI-EPYFROM
 17444                                    PI-EPYTHRU
 17445                                    PI-EDAYS
 17446                                    PI-EPYAMT
 17447                                    PI-ERESV
 17448                                    PI-EEXPENS
 17449                                    PI-CDAYS
 17450                                    PI-CPYAMT
 17451                                    PI-CRESV
 17452                                    PI-CEXPENS
 17453                                    PI-INT-RATE
 17454                                    PI-AIGFROM.
 17455     MOVE ZEROS                  TO PI-PROOF-DATE.
 17456     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17457                                    PI-REM-BEN-AMT
 17458                                    PI-MO-BEN-AMT
 17459                                    pi-ah-term.
 17460
 17461     MOVE LOW-VALUES             TO EL156AI.
 17462     MOVE MAP-NAMEA              TO MAP-NAME.
 17463
 17464* EXEC CICS HANDLE CONDITION
 17465*        NOTFND   (7010-BUILD-MAP)
 17466*    END-EXEC.
 17467*    MOVE '"$I                   ! 8 #00016078' TO DFHEIV0
 17468     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17469     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17470     MOVE X'3820233030303136303738' TO DFHEIV0(25:11)
 17471     CALL 'kxdfhei1' USING DFHEIV0
 17472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17473
 17474
 17475     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17476     MOVE '2'                    TO CNTL-REC-TYPE.
 17477     MOVE +0                     TO CNTL-SEQ-NO.
 17478     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17479
 17480
 17481* EXEC CICS READ
 17482*         DATASET  ('ELCNTL')
 17483*         SET      (ADDRESS OF CONTROL-FILE)
 17484*         RIDFLD   (ELCNTL-KEY)
 17485*    END-EXEC.
 17486     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 334
* EL156.cbl
 17487*    MOVE '&"S        E          (   #00016087' TO DFHEIV0
 17488     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17489     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17490     MOVE X'2020233030303136303837' TO DFHEIV0(25:11)
 17491     CALL 'kxdfhei1' USING DFHEIV0,
 17492           DFHEIV1,
 17493           DFHEIV20,
 17494           DFHEIV99,
 17495           ELCNTL-KEY,
 17496           DFHEIV99,
 17497           DFHEIV99,
 17498           DFHEIV99
 17499     SET ADDRESS OF CONTROL-FILE TO
 17500         DFHEIV20
 17501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17502
 17503
 17504     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17505
 17506     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17507         MOVE AL-UANON      TO SURVYYNA
 17508     END-IF.
 17509
 17510
 17511     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17512     MOVE '1'                    TO CNTL-REC-TYPE.
 17513     MOVE SPACES                 TO CNTL-ACCESS.
 17514     MOVE +0                     TO CNTL-SEQ-NO.
 17515
 17516
 17517* EXEC CICS READ
 17518*         DATASET  ('ELCNTL')
 17519*         SET      (ADDRESS OF CONTROL-FILE)
 17520*         RIDFLD   (ELCNTL-KEY)
 17521*    END-EXEC.
 17522     MOVE 'ELCNTL' TO DFHEIV1
 17523*    MOVE '&"S        E          (   #00016105' TO DFHEIV0
 17524     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17526     MOVE X'2020233030303136313035' TO DFHEIV0(25:11)
 17527     CALL 'kxdfhei1' USING DFHEIV0,
 17528           DFHEIV1,
 17529           DFHEIV20,
 17530           DFHEIV99,
 17531           ELCNTL-KEY,
 17532           DFHEIV99,
 17533           DFHEIV99,
 17534           DFHEIV99
 17535     SET ADDRESS OF CONTROL-FILE TO
 17536         DFHEIV20
 17537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17538
 17539
 17540     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17541
 17542 7010-BUILD-MAP.
 17543
 17544
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 335
* EL156.cbl
 17545* EXEC CICS HANDLE CONDITION
 17546*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17547*    END-EXEC.
 17548*    MOVE '"$I                   ! 9 #00016115' TO DFHEIV0
 17549     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17551     MOVE X'3920233030303136313135' TO DFHEIV0(25:11)
 17552     CALL 'kxdfhei1' USING DFHEIV0
 17553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17554
 17555
 17556     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17557     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17558     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17559     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17560     MOVE 'MSTR'                 TO FILE-SWITCH.
 17561
 17562     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17563
 17564     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17565     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17566     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17567     MOVE CL-CCN                 TO PI-SV-CCN.
 17568
 17569     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17570     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17571     MOVE CL-CLAIM-NO            TO CLMNOO.
 17572     MOVE CL-CARRIER             TO CARRO.
 17573     MOVE CL-CERT-PRIME          TO CERTNOO.
 17574     MOVE CL-CERT-SFX            TO SUFXO.
 17575
 17576     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17577        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17578        CONTINUE
 17579     ELSE
 17580        MOVE AL-SADOF            TO ZINTHA
 17581                                    ZINTA
 17582                                    PINTHA
 17583                                    PINTA
 17584     END-IF
 17585     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17586     EVALUATE TRUE
 17587     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17588         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17589     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17590         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17591
 17592     WHEN CL-CLAIM-TYPE = 'I'
 17593         MOVE '  IU  '           TO CLMTYPO
 17594     WHEN CL-CLAIM-TYPE = 'G'
 17595         MOVE ' GAP  '           TO CLMTYPO
 17596     WHEN CL-CLAIM-TYPE = 'F'
 17597         MOVE ' FMLA '           TO CLMTYPO
 17598     END-EVALUATE.
 17599     IF CLAIM-IS-OPEN
 17600         MOVE ' OPEN'            TO CLMSTATO
 17601     ELSE
 17602         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 336
* EL156.cbl
 17603
 17604     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17605
 17606     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17607         MOVE SPACES             TO  PCERTNOO
 17608                                     PSUFXO
 17609                                     PRIMHDGO
 17610                                     SEQUO
 17611         MOVE AL-SADOF           TO  PCERTNOA
 17612                                     PSUFXA
 17613                                     PRIMHDGA
 17614                                     SEQUA
 17615     ELSE
 17616         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17617         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17618         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17619         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17620         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17621         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17622         MOVE AL-SANON               TO  PCERTNOA
 17623                                         PSUFXA
 17624                                         PRIMHDGA
 17625         MOVE AL-SABON               TO  SEQUA.
 17626
 17627     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17628
 17629     IF CL-NO-OF-PMTS-MADE = 0 AND
 17630        CL-TOTAL-PAID-AMT = 0
 17631         NEXT SENTENCE
 17632     ELSE
 17633         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17634             IF NOT PI-USES-PAID-TO
 17635                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17636                 MOVE ' '                 TO DC-OPTION-CODE
 17637                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17638                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17639             ELSE
 17640                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17641                 MOVE '6'                 TO DC-OPTION-CODE
 17642                 MOVE +1                  TO DC-ELAPSED-DAYS
 17643                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17644                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17645                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17646
 17647     IF MAP-NAME = 'EL156A'
 17648        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17649           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17650             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17651           end-if
 17652        end-if
 17653     end-if
 17654     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17655         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17656         MOVE ' '                TO DC-OPTION-CODE
 17657         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17658         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17659
 17660     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 337
* EL156.cbl
 17661         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17662         MOVE ' '                TO DC-OPTION-CODE
 17663         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17664         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17665
 17666     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17667
 17668     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17669         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17670         MOVE ' '                TO DC-OPTION-CODE
 17671         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17672         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17673
 17674     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17675         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17676         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17677     ELSE
 17678         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17679         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17680
 17681     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17682     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17683     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17684     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17685                                    PI-GROUPING.
 17686     MOVE CL-CERT-STATE          TO CERT-STATE
 17687                                    PI-STATE.
 17688     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17689                                    PI-ACCOUNT.
 17690     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17691     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17692     MOVE 'CERT'                 TO FILE-SWITCH.
 17693
 17694     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17695     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17696        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17697        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17698            MOVE 'N' TO PI-JOINT-INSURED-IND
 17699     ELSE
 17700            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17701     END-IF.
 17702
 17703     perform 7975-read-acct      thru 7975-exit
 17704     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17705     MOVE PI-STATE               TO WS-ST-ACCESS.
 17706     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17707     MOVE '3'                    TO CNTL-REC-TYPE.
 17708     MOVE +0                     TO CNTL-SEQ-NO.
 17709     MOVE 'STAT'                 TO FILE-SWITCH.
 17710
 17711     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17712
 17713     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17714     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17715
 17716     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17717        GO TO 7020-BYPASS-BENEFIT.
 17718
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 338
* EL156.cbl
 17719     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17720     MOVE '4'                    TO CNTL-REC-TYPE.
 17721     MOVE +0                     TO CNTL-SEQ-NO.
 17722     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17723     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17724     MOVE 'BENE'                 TO FILE-SWITCH.
 17725
 17726     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17727
 17728     IF NO-BENEFIT-FOUND
 17729        GO TO 7020-BYPASS-BENEFIT.
 17730
 17731     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17732     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17733     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17734
 17735 7020-BYPASS-BENEFIT.
 17736
 17737*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17738*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17739*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17740
 17741     move zeros                  to PI-MAX-BENEFIT-AMT
 17742     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17743     move cm-ah-orig-term        to pi-ah-term
 17744     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17745     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17746          'G' and 'F'
 17747         GO TO 7021-GO-TO-LIFE.
 17748
 17749     IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17750        and (acct-found)
 17751        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17752        PERFORM 0900-GET-DDF-limits
 17753                                 THRU 0900-EXIT
 17754        IF PDEF-FOUND
 17755           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17756              (P1 > +8)
 17757              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17758           END-PERFORM
 17759           IF P1 < +9
 17760              if pd-ben-pct (p1) not numeric
 17761                 move zeros      to pd-ben-pct (p1)
 17762              end-if
 17763              if pd-ben-pct (p1) = zeros
 17764                 move +1         to ws-work-ben-pct
 17765              else
 17766                 move pd-ben-pct (p1)
 17767                                 to ws-work-ben-pct
 17768              end-if
 17769              compute cm-ah-benefit-amt =
 17770                 cm-ah-benefit-amt * ws-work-ben-pct
 17771              move pd-max-amt (p1) to pi-max-benefit-amt
 17772           END-IF
 17773        END-IF
 17774     end-if
 17775     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17776     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 339
* EL156.cbl
 17777     if (pi-max-benefit-amt not = zeros)
 17778        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17779        move pi-max-benefit-amt  to beneo
 17780     else
 17781        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17782     end-if
 17783     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17784     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17785                                    CP-ORIGINAL-TERM.
 17786     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17787
 17788*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17789*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17790*    ELSE
 17791         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17792
 17793     MOVE ' '                    TO DC-OPTION-CODE.
 17794     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17795     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17796
 17797     IF PI-COMPANY-ID = 'DMD'
 17798         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17799         GO TO 7023-BYPASS-REMAINING-TERM.
 17800
 17801     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17802     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17803     GO TO 7022-AROUND-LIFE.
 17804
 17805 7021-GO-TO-LIFE.
 17806
 17807     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17808     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17809     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17810                                    CP-ORIGINAL-TERM.
 17811     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17812     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17813     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17814     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17815
 17816     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17817         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17818     ELSE
 17819         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17820
 17821     MOVE ' '                    TO DC-OPTION-CODE.
 17822     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17823     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17824
 17825 7022-AROUND-LIFE.
 17826
 17827     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17828     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17829     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17830     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17831     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17832     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17833     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17834
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 340
* EL156.cbl
 17835     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17836
 17837     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17838        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17839           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17840
 17841     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17842        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17843           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17844
 17845 7023-BYPASS-REMAINING-TERM.
 17846     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17847       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17848          MOVE ZEROS                  TO BENEO
 17849       ELSE
 17850          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17851          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17852          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17853          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17854          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17855          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17856          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17857          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17858          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17859          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17860          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17861          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17862          IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17863             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17864             PERFORM 0900-GET-DDF-limits
 17865                                 THRU 0900-EXIT
 17866             IF PDEF-FOUND
 17867                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17868                   (P1 > +8)
 17869                   OR (PD-PROD-CODE (P1) = 'L')
 17870                END-PERFORM
 17871                IF P1 < +9
 17872                   MOVE PD-MAX-AMT (P1)
 17873                                 TO CP-R-MAX-TOT-BEN
 17874                END-IF
 17875             END-IF
 17876          END-IF
 17877
 17878* EXEC CICS LINK
 17879*            PROGRAM  (LINK-REMAMT)
 17880*            COMMAREA (CALCULATION-PASS-AREA)
 17881*            LENGTH   (CP-COMM-LENGTH)
 17882*         END-EXEC
 17883*    MOVE '."C                   (   #00016440' TO DFHEIV0
 17884     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17886     MOVE X'2020233030303136343430' TO DFHEIV0(25:11)
 17887     CALL 'kxdfhei1' USING DFHEIV0,
 17888           LINK-REMAMT,
 17889           CALCULATION-PASS-AREA,
 17890           CP-COMM-LENGTH,
 17891           DFHEIV99,
 17892           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 341
* EL156.cbl
 17893           DFHEIV99,
 17894           DFHEIV99
 17895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17896          MOVE CP-REMAINING-AMT       TO BENEO
 17897       end-if
 17898     end-if
 17899     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17900     MOVE +95                    TO TRLR-SEQ-NO
 17901
 17902* EXEC CICS READ
 17903*       DATASET  ('ELTRLR')
 17904*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17905*       RIDFLD   (ELTRLR-KEY)
 17906*       RESP     (WS-RESPONSE)
 17907*    END-EXEC
 17908     MOVE 'ELTRLR' TO DFHEIV1
 17909*    MOVE '&"S        E          (  N#00016450' TO DFHEIV0
 17910     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17911     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17912     MOVE X'204E233030303136343530' TO DFHEIV0(25:11)
 17913     CALL 'kxdfhei1' USING DFHEIV0,
 17914           DFHEIV1,
 17915           DFHEIV20,
 17916           DFHEIV99,
 17917           ELTRLR-KEY,
 17918           DFHEIV99,
 17919           DFHEIV99,
 17920           DFHEIV99
 17921     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17922         DFHEIV20
 17923     MOVE EIBRESP  TO WS-RESPONSE
 17924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17925
 17926     if ws-resp-normal
 17927        perform varying s1 from +1 by +1 until
 17928           at-note-error-no (s1) = spaces
 17929           move at-note-error-no (s1)
 17930                                 to emi-error
 17931           if at-note-error-no (s1) = '1653'
 17932              evaluate true
 17933                 when cl-claim-type = 'L'
 17934                    move '  LF  '
 17935                                 to emi-claim-type
 17936                 when cl-claim-type = 'I'
 17937                    move '  IU  '
 17938                                 to emi-claim-type
 17939                 when cl-claim-type = 'F'
 17940                    move ' FMLA '
 17941                                 to emi-claim-type
 17942                 when other
 17943                    move '  AH  '
 17944                                 to emi-claim-type
 17945              end-evaluate
 17946           end-if
 17947           PERFORM 9900-ERROR-FORMAT
 17948                                 THRU 9900-EXIT
 17949        end-perform
 17950     end-if
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 342
* EL156.cbl
 17951     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17952         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17953            WS-LF-COVERAGE-TYPE = 'P'
 17954             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17955                                        CM-LF-ITD-DEATH-AMT
 17956             MOVE WS-REMAINING-AMT  TO  BENEO.
 17957
 17958     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17959     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17960     MOVE WS-TERMS               TO TERMSO.
 17961
 17962     IF WS-STATUS = '6' OR '7' OR '8'
 17963         MOVE AL-SABOF           TO CRTSTATA.
 17964
 17965     IF WS-STATUS = '1' OR '4'
 17966        IF CP-REMAINING-TERM-3 = ZEROS
 17967           MOVE 'EXPIRED'        TO CRTSTATO
 17968        ELSE
 17969           MOVE 'ACTIVE  '       TO CRTSTATO.
 17970
 17971     IF WS-STATUS = '2'
 17972         MOVE 'PEND    '         TO CRTSTATO.
 17973
 17974     IF WS-STATUS = '3'
 17975         MOVE 'RESTORE '         TO CRTSTATO.
 17976
 17977     IF WS-STATUS = '5'
 17978         MOVE 'REISSUE '         TO CRTSTATO.
 17979
 17980     IF WS-STATUS = '6'
 17981         MOVE 'LMP DIS'          TO CRTSTATO.
 17982
 17983     IF WS-STATUS = '7'
 17984         MOVE 'DEATH'            TO CRTSTATO.
 17985
 17986     IF WS-STATUS = '8'
 17987         MOVE 'CANCEL'           TO CRTSTATO.
 17988
 17989     IF WS-STATUS = '9'
 17990         MOVE 'RE-ONLY '         TO CRTSTATO.
 17991
 17992     IF WS-STATUS = 'V'
 17993         MOVE 'VOID  '           TO CRTSTATO.
 17994
 17995     IF WS-STATUS = 'D'
 17996         MOVE 'DECLINE '         TO CRTSTATO.
 17997
 17998     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17999         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 18000         MOVE '5'                TO CNTL-REC-TYPE
 18001     ELSE
 18002         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 18003         MOVE '4'                TO CNTL-REC-TYPE.
 18004
 18005     MOVE '** NONE **'           TO COVERO.
 18006     MOVE AL-SABON               TO COVERA.
 18007
 18008     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 343
* EL156.cbl
 18009         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 18010             MOVE CM-BENEFICIARY TO LOANNOO
 18011             MOVE AL-UANON       TO LOANNOA.
 18012
 18013     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 18014        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 18015        MOVE +91                 TO  TRLR-SEQ-NO
 18016
 18017* EXEC CICS READ
 18018*           DATASET  ('ELTRLR')
 18019*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18020*           RIDFLD   (ELTRLR-KEY)
 18021*           RESP     (WS-RESPONSE)
 18022*       END-EXEC
 18023     MOVE 'ELTRLR' TO DFHEIV1
 18024*    MOVE '&"S        E          (  N#00016547' TO DFHEIV0
 18025     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18026     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18027     MOVE X'204E233030303136353437' TO DFHEIV0(25:11)
 18028     CALL 'kxdfhei1' USING DFHEIV0,
 18029           DFHEIV1,
 18030           DFHEIV20,
 18031           DFHEIV99,
 18032           ELTRLR-KEY,
 18033           DFHEIV99,
 18034           DFHEIV99,
 18035           DFHEIV99
 18036     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18037         DFHEIV20
 18038     MOVE EIBRESP  TO WS-RESPONSE
 18039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18040
 18041        IF WS-RESP-NORMAL
 18042           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18043        ELSE
 18044           MOVE SPACES           TO  LOANNOO
 18045        END-IF
 18046*052506
 18047*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18048*052506
 18049     END-IF
 18050
 18051     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18052        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18053
 18054     IF WS-BEN-CD = ZEROS
 18055         GO TO 7050-SHOW-CONTINUE.
 18056
 18057     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18058     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18059     MOVE +0                     TO CNTL-SEQ-NO.
 18060     MOVE 'BENE'                 TO FILE-SWITCH.
 18061
 18062     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18063     IF BENEFIT-FOUND
 18064        MOVE CF-JOINT-INDICATOR (SUB-1)
 18065                                 TO PI-JOINT-COV-IND
 18066                                    PI-RB-JOINT-COV-IND
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 344
* EL156.cbl
 18067        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18068                                 TO COVERO
 18069        MOVE AL-SANON            TO COVERA
 18070     END-IF
 18071     if (cntl-rec-type = '4')   *> Life claim
 18072        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18073        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18074        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18075        MOVE '5'              TO CNTL-REC-TYPE
 18076        MOVE WS-ACCESS        TO CNTL-ACCESS
 18077        MOVE +0               TO CNTL-SEQ-NO
 18078        MOVE 'BENE'           TO FILE-SWITCH
 18079        PERFORM 7200-FIND-BENEFIT
 18080                              THRU 7200-EXIT
 18081        IF (BENEFIT-FOUND)
 18082           and (pi-rb-joint-cov-ind) not = 'J'
 18083           MOVE CF-JOINT-INDICATOR (SUB-1)
 18084                              TO PI-rb-JOINT-COV-IND
 18085        end-if
 18086     end-if
 18087     .
 18088 7050-SHOW-CONTINUE.
 18089
 18090     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18091        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18092            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18093     END-IF
 18094
 18095     IF PI-COMPANY-ID = 'DMD'
 18096         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18097
 18098     MOVE -1                     TO PMTTYPEL.
 18099     GO TO 8100-SEND-INITIAL-MAP.
 18100
 18101 7100-SHOW-RECORD-NOT-FOUND.
 18102     IF FILE-SWITCH = 'MSTR'
 18103         MOVE ER-0204            TO EMI-ERROR.
 18104
 18105     IF FILE-SWITCH = 'CERT'
 18106         MOVE ER-0206            TO EMI-ERROR.
 18107
 18108     IF FILE-SWITCH = 'STAT'
 18109         MOVE ER-0149            TO EMI-ERROR.
 18110
 18111     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18112
 18113     MOVE -1                     TO PMTTYPEL.
 18114     GO TO 8100-SEND-INITIAL-MAP
 18115
 18116     .
 18117 7110-BUILD-PMT-TRLR.
 18118     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18119     MOVE +51                    TO TRLR-SEQ-NO
 18120
 18121* EXEC CICS READ
 18122*        DATASET  ('ELTRLR')
 18123*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18124*        RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 345
* EL156.cbl
 18125*        RESP     (WS-RESPONSE)
 18126*    END-EXEC
 18127     MOVE 'ELTRLR' TO DFHEIV1
 18128*    MOVE '&"S        E          (  N#00016633' TO DFHEIV0
 18129     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18130     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18131     MOVE X'204E233030303136363333' TO DFHEIV0(25:11)
 18132     CALL 'kxdfhei1' USING DFHEIV0,
 18133           DFHEIV1,
 18134           DFHEIV20,
 18135           DFHEIV99,
 18136           ELTRLR-KEY,
 18137           DFHEIV99,
 18138           DFHEIV99,
 18139           DFHEIV99
 18140     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18141         DFHEIV20
 18142     MOVE EIBRESP  TO WS-RESPONSE
 18143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18144     IF WS-RESP-NORMAL
 18145        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18146     END-IF
 18147     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18148
 18149* EXEC CICS GETMAIN
 18150*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18151*         LENGTH    (200)
 18152*         INITIMG   (GETMAIN-SPACE)
 18153*     END-EXEC
 18154     MOVE 200
 18155       TO DFHEIV11
 18156*    MOVE ',"IL                  $   #00016643' TO DFHEIV0
 18157     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18158     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18159     MOVE X'2020233030303136363433' TO DFHEIV0(25:11)
 18160     CALL 'kxdfhei1' USING DFHEIV0,
 18161           DFHEIV20,
 18162           DFHEIV11,
 18163           GETMAIN-SPACE
 18164     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18165         DFHEIV20
 18166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18167     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18168                                    AT-PREV-PAID-THRU-DT
 18169     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18170     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18171     MOVE 'AT'                   TO AT-RECORD-ID
 18172     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18173     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18174     MOVE '2'                    TO AT-TRAILER-TYPE
 18175     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18176                                    AT-PAYMENT-LAST-MAINT-DT
 18177     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18178                                    AT-PAYMENT-LAST-UPDATED-BY
 18179     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18180     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18181     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18182     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 346
* EL156.cbl
 18183     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18184     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18185     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18186     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18187     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18188     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18189     if pi-int-to-rem-borr = 'Y'
 18190        move 'Q1'                to at-payee-type-cd
 18191     else
 18192        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18193     end-if
 18194     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18195     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18196     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18197     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18198     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18199                                    AT-TO-BE-WRITTEN-DT
 18200     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18201                                    AT-CHECK-QUE-SEQUENCE
 18202                                    AT-ADDL-RESERVE
 18203     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18204                                    AT-VOID-SELECT-DT
 18205                                    AT-VOID-ACCEPT-DT
 18206                                    AT-VOID-DT
 18207                                    AT-PMT-PROOF-DT
 18208                                    AT-INT-PMT-SELECT-DT
 18209     MOVE ZEROS                  TO AT-DAILY-RATE
 18210                                    AT-ELIMINATION-DAYS
 18211     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18212*    EXEC CICS HANDLE CONDITION
 18213*        DUPREC    (7120-DUPREC)
 18214*    END-EXEC
 18215     .
 18216 7115-WRITE-INT-TRLR.
 18217
 18218* EXEC CICS WRITE
 18219*         DATASET       ('ELTRLR')
 18220*         FROM          (ACTIVITY-TRAILERS)
 18221*         RIDFLD        (AT-CONTROL-PRIMARY)
 18222*         RESP          (WS-RESPONSE)
 18223*     END-EXEC
 18224     MOVE LENGTH OF
 18225      ACTIVITY-TRAILERS
 18226       TO DFHEIV11
 18227     MOVE 'ELTRLR' TO DFHEIV1
 18228*    MOVE '&$ L                  ''  N#00016698' TO DFHEIV0
 18229     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18230     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18231     MOVE X'204E233030303136363938' TO DFHEIV0(25:11)
 18232     CALL 'kxdfhei1' USING DFHEIV0,
 18233           DFHEIV1,
 18234           ACTIVITY-TRAILERS,
 18235           DFHEIV11,
 18236           AT-CONTROL-PRIMARY,
 18237           DFHEIV99,
 18238           DFHEIV99
 18239     MOVE EIBRESP  TO WS-RESPONSE
 18240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 347
* EL156.cbl
 18241      IF WS-RESP-DUPREC
 18242         GO TO 7120-DUPREC
 18243      END-IF
 18244     GO TO 7130-EXIT
 18245     .
 18246 7120-DUPREC.
 18247     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18248     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18249     GO TO 7115-WRITE-INT-TRLR
 18250     .
 18251 7130-EXIT.
 18252      EXIT.
 18253 7140-BUILD-NOTE-TRLR.
 18254
 18255
 18256* EXEC CICS GETMAIN
 18257*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18258*         LENGTH    (200)
 18259*         INITIMG   (GETMAIN-SPACE)
 18260*     END-EXEC
 18261     MOVE 200
 18262       TO DFHEIV11
 18263*    MOVE ',"IL                  $   #00016718' TO DFHEIV0
 18264     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18265     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18266     MOVE X'2020233030303136373138' TO DFHEIV0(25:11)
 18267     CALL 'kxdfhei1' USING DFHEIV0,
 18268           DFHEIV20,
 18269           DFHEIV11,
 18270           GETMAIN-SPACE
 18271     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18272         DFHEIV20
 18273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18274     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18275     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18276     MOVE 'AT'                   TO AT-RECORD-ID
 18277     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18278     MOVE '6'                    TO AT-TRAILER-TYPE
 18279     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18280                                    AT-GEN-INFO-LAST-MAINT-DT
 18281     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18282                                    AT-GEN-INFO-LAST-UPDATED-BY
 18283     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18284     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18285     .
 18286 7150-WRITE.
 18287
 18288* EXEC CICS HANDLE CONDITION
 18289*        DUPREC    (7160-DUPREC)
 18290*    END-EXEC
 18291*    MOVE '"$%                   ! : #00016736' TO DFHEIV0
 18292     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18294     MOVE X'3A20233030303136373336' TO DFHEIV0(25:11)
 18295     CALL 'kxdfhei1' USING DFHEIV0
 18296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18297
 18298* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 348
* EL156.cbl
 18299*         DATASET     ('ELTRLR')
 18300*         FROM        (ACTIVITY-TRAILERS)
 18301*         RIDFLD      (AT-CONTROL-PRIMARY)
 18302*         RESP        (WS-RESPONSE)
 18303*     END-EXEC
 18304     MOVE LENGTH OF
 18305      ACTIVITY-TRAILERS
 18306       TO DFHEIV11
 18307     MOVE 'ELTRLR' TO DFHEIV1
 18308*    MOVE '&$ L                  ''  N#00016739' TO DFHEIV0
 18309     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18310     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18311     MOVE X'204E233030303136373339' TO DFHEIV0(25:11)
 18312     CALL 'kxdfhei1' USING DFHEIV0,
 18313           DFHEIV1,
 18314           ACTIVITY-TRAILERS,
 18315           DFHEIV11,
 18316           AT-CONTROL-PRIMARY,
 18317           DFHEIV99,
 18318           DFHEIV99
 18319     MOVE EIBRESP  TO WS-RESPONSE
 18320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18321      IF WS-RESP-DUPREC
 18322         GO TO 7160-DUPREC
 18323      END-IF
 18324     GO TO 7170-EXIT
 18325     .
 18326 7160-DUPREC.
 18327     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18328     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18329     GO TO 7150-WRITE
 18330     .
 18331 7170-EXIT.
 18332      EXIT.
 18333
 18334 7180-ADD-CERT-NOTE.
 18335*ADD CERT NOTE FOR SC NP+6
 18336
 18337
 18338* EXEC CICS GETMAIN
 18339*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18340*         LENGTH    (150)
 18341*         INITIMG   (GETMAIN-SPACE)
 18342*     END-EXEC.
 18343     MOVE 150
 18344       TO DFHEIV11
 18345*    MOVE ',"IL                  $   #00016761' TO DFHEIV0
 18346     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18347     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18348     MOVE X'2020233030303136373631' TO DFHEIV0(25:11)
 18349     CALL 'kxdfhei1' USING DFHEIV0,
 18350           DFHEIV20,
 18351           DFHEIV11,
 18352           GETMAIN-SPACE
 18353     SET ADDRESS OF CERT-NOTE-FILE TO
 18354         DFHEIV20
 18355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18356
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 349
* EL156.cbl
 18357
 18358     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18359     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18360     MOVE +1                     TO WRK-NOTE-SEQ.
 18361     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18362     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18363     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18364     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18365     MOVE CL-CERT-STATE          TO CZ-STATE.
 18366     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18367     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18368     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18369     MOVE '2'                    TO CZ-RECORD-TYPE.
 18370     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18371     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18372     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18373     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18374     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18375     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18376     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18377     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18378     IF PI-COMPANY-ID = 'AHL'
 18379        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18380           CONTINUE
 18381        ELSE
 18382           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18383              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18384           ELSE
 18385              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18386           END-IF
 18387        END-IF
 18388     END-IF
 18389     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18390     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18391
 18392 7181-WRITE.
 18393
 18394
 18395* EXEC CICS WRITE
 18396*         DATASET     ('ERCNOT')
 18397*         FROM        (CERT-NOTE-FILE)
 18398*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18399*         RESP        (WS-RESPONSE)
 18400*    END-EXEC.
 18401     MOVE LENGTH OF
 18402      CERT-NOTE-FILE
 18403       TO DFHEIV11
 18404     MOVE 'ERCNOT' TO DFHEIV1
 18405*    MOVE '&$ L                  ''  N#00016803' TO DFHEIV0
 18406     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18407     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18408     MOVE X'204E233030303136383033' TO DFHEIV0(25:11)
 18409     CALL 'kxdfhei1' USING DFHEIV0,
 18410           DFHEIV1,
 18411           CERT-NOTE-FILE,
 18412           DFHEIV11,
 18413           CZ-CONTROL-PRIMARY,
 18414           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 350
* EL156.cbl
 18415           DFHEIV99
 18416     MOVE EIBRESP  TO WS-RESPONSE
 18417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18418
 18419
 18420     IF WS-RESP-DUPREC
 18421         GO TO 7182-DUPREC
 18422     END-IF.
 18423
 18424     SET CERT-NOTE-ADDED TO TRUE.
 18425
 18426     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18427         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18428     END-IF.
 18429
 18430     GO TO 7189-EXIT.
 18431
 18432 7182-DUPREC.
 18433
 18434     ADD +1                      TO  WRK-NOTE-SEQ.
 18435     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18436     GO TO 7181-WRITE.
 18437
 18438 7189-EXIT.
 18439      EXIT.
 18440
 18441 7190-ADD-ORIG-NOTE.
 18442
 18443
 18444* EXEC CICS GETMAIN
 18445*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18446*         LENGTH    (150)
 18447*         INITIMG   (GETMAIN-SPACE)
 18448*     END-EXEC.
 18449     MOVE 150
 18450       TO DFHEIV11
 18451*    MOVE ',"IL                  $   #00016833' TO DFHEIV0
 18452     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18453     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18454     MOVE X'2020233030303136383333' TO DFHEIV0(25:11)
 18455     CALL 'kxdfhei1' USING DFHEIV0,
 18456           DFHEIV20,
 18457           DFHEIV11,
 18458           GETMAIN-SPACE
 18459     SET ADDRESS OF CERT-NOTE-FILE TO
 18460         DFHEIV20
 18461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18462
 18463
 18464     ADD +1                      TO WRK-NOTE-SEQ.
 18465     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18466     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18467     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18468     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18469     MOVE CL-CERT-STATE          TO CZ-STATE.
 18470     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18471     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18472     MOVE CL-CERT-NO             TO CZ-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 351
* EL156.cbl
 18473     MOVE '2'                    TO CZ-RECORD-TYPE.
 18474     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18475     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18476     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18477     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18478     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18479     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18480
 18481 7191-WRITE.
 18482
 18483
 18484* EXEC CICS WRITE
 18485*         DATASET     ('ERCNOT')
 18486*         FROM        (CERT-NOTE-FILE)
 18487*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18488*         RESP        (WS-RESPONSE)
 18489*    END-EXEC.
 18490     MOVE LENGTH OF
 18491      CERT-NOTE-FILE
 18492       TO DFHEIV11
 18493     MOVE 'ERCNOT' TO DFHEIV1
 18494*    MOVE '&$ L                  ''  N#00016858' TO DFHEIV0
 18495     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18496     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18497     MOVE X'204E233030303136383538' TO DFHEIV0(25:11)
 18498     CALL 'kxdfhei1' USING DFHEIV0,
 18499           DFHEIV1,
 18500           CERT-NOTE-FILE,
 18501           DFHEIV11,
 18502           CZ-CONTROL-PRIMARY,
 18503           DFHEIV99,
 18504           DFHEIV99
 18505     MOVE EIBRESP  TO WS-RESPONSE
 18506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18507
 18508
 18509     IF WS-RESP-DUPREC
 18510         GO TO 7192-DUPREC
 18511     END-IF.
 18512
 18513     GO TO 7199-EXIT.
 18514
 18515 7192-DUPREC.
 18516
 18517     ADD +1                      TO  WRK-NOTE-SEQ.
 18518     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18519     GO TO 7191-WRITE.
 18520
 18521 7199-EXIT.
 18522      EXIT.
 18523 7200-FIND-BENEFIT.
 18524     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18525
 18526
 18527* EXEC CICS HANDLE CONDITION
 18528*        ENDFILE(7200-EXIT)
 18529*        NOTFND(7200-EXIT)
 18530*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 352
* EL156.cbl
 18531*    MOVE '"$''I                  ! ; #00016882' TO DFHEIV0
 18532     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18534     MOVE X'3B20233030303136383832' TO DFHEIV0(25:11)
 18535     CALL 'kxdfhei1' USING DFHEIV0
 18536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18537
 18538
 18539
 18540* EXEC CICS READ
 18541*        DATASET('ELCNTL')
 18542*        SET(ADDRESS OF CONTROL-FILE)
 18543*        RIDFLD(ELCNTL-KEY)
 18544*        GTEQ
 18545*    END-EXEC.
 18546     MOVE 'ELCNTL' TO DFHEIV1
 18547*    MOVE '&"S        G          (   #00016887' TO DFHEIV0
 18548     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18549     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18550     MOVE X'2020233030303136383837' TO DFHEIV0(25:11)
 18551     CALL 'kxdfhei1' USING DFHEIV0,
 18552           DFHEIV1,
 18553           DFHEIV20,
 18554           DFHEIV99,
 18555           ELCNTL-KEY,
 18556           DFHEIV99,
 18557           DFHEIV99,
 18558           DFHEIV99
 18559     SET ADDRESS OF CONTROL-FILE TO
 18560         DFHEIV20
 18561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18562
 18563
 18564     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18565        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18566           GO TO 7200-EXIT.
 18567
 18568     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18569         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18570            ((SUB-1 > 8) OR
 18571            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18572
 18573     IF SUB-1 NOT = 9
 18574         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18575
 18576     GO TO 7200-EXIT.
 18577
 18578 7200-BENEFIT-DUMMY.
 18579
 18580 7200-DUMMY-EXIT.
 18581     EXIT.
 18582
 18583 7200-EXIT.
 18584     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 353
* EL156.cbl
 18586*052506
 18587*052506 7250-FIND-LETTER-TRLR.
 18588*052506     EXEC CICS HANDLE CONDITION
 18589*052506         ENDFILE  (7250-END)
 18590*052506         NOTFND   (7250-END)
 18591*052506     END-EXEC.
 18592*052506
 18593*052506     EXEC CICS STARTBR
 18594*052506         DATASET   ('ELTRLR')
 18595*052506         RIDFLD    (ELTRLR-KEY)
 18596*052506         GTEQ
 18597*052506     END-EXEC.
 18598*052506
 18599*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18600*052506
 18601*052506 7250-FIND-LOOP.
 18602*052506     EXEC CICS READNEXT
 18603*052506         DATASET   ('ELTRLR')
 18604*052506         RIDFLD    (ELTRLR-KEY)
 18605*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18606*052506     END-EXEC.
 18607*052506
 18608*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18609*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18610*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18611*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18612*052506        GO TO 7250-END
 18613*052506     END-IF.
 18614*052506
 18615*052506     IF AT-TRAILER-TYPE NOT = '4'
 18616*052506         GO TO 7250-FIND-LOOP
 18617*052506     END-IF.
 18618*052506
 18619*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18620*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18621*052506     END-IF.
 18622*052506
 18623*052506     GO TO 7250-FIND-LOOP.
 18624*052506
 18625*052506 7250-END.
 18626*052506
 18627*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18628*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18629*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18630*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18631*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18632*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18633*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18634*052506     END-IF.
 18635*052506
 18636*052506     EXEC CICS ENDBR
 18637*052506          DATASET    ('ELTRLR')
 18638*052506     END-EXEC.
 18639*052506
 18640*052506 7250-EXIT.
 18641*052506     EXIT.
 18642*052506     EJECT
 18643*052506
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 354
* EL156.cbl
 18644 7300-CHECK-AUTO-ACTIVITY.
 18645
 18646     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18647         NEXT SENTENCE
 18648     ELSE
 18649         GO TO 7399-EXIT.
 18650
 18651     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18652
 18653     IF WS-ACT-REC-FOUND-SW = 'N'
 18654         GO TO 7399-EXIT.
 18655
 18656     IF PI-ACTIVITY-CODE = 09
 18657         GO TO 7300-CONT-AUTO-ACTIVITY.
 18658
 18659     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18660        (PI-ACTIVITY-CODE = 11)
 18661         GO TO 7300-CONT-AUTO-ACTIVITY.
 18662
 18663     IF PI-PROVISIONAL-IND = 'P'
 18664         IF PI-PMTTYPE = '1'
 18665             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18666                 MOVE 'N'    TO  PI-RESET-SW
 18667                 GO TO 7399-EXIT.
 18668
 18669     IF PI-PMTTYPE = '1'
 18670         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18671             MOVE 'N'        TO  PI-RESET-SW
 18672             GO TO 7399-EXIT.
 18673
 18674     IF PI-PMTTYPE = '2' OR '3'
 18675         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18676             MOVE 'N'        TO  PI-RESET-SW
 18677             GO TO 7399-EXIT.
 18678
 18679     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18680         IF PI-PROVISIONAL-IND = 'P'
 18681             NEXT SENTENCE
 18682         ELSE
 18683             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18684
 18685 7300-CONT-AUTO-ACTIVITY.
 18686
 18687     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18688         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18689         MOVE '4'            TO DC-OPTION-CODE
 18690         MOVE +0             TO DC-ELAPSED-DAYS
 18691                                DC-ELAPSED-MONTHS
 18692         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18693         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18694         IF PI-USES-PAID-TO
 18695             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18696             IF NO-CONVERSION-ERROR
 18697                 MOVE +1     TO DC-ELAPSED-DAYS
 18698                 MOVE +0     TO DC-ELAPSED-MONTHS
 18699                 MOVE '6'    TO DC-OPTION-CODE
 18700                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18701                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 355
* EL156.cbl
 18702                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18703
 18704     IF PI-PFKEY-USED = DFHPF5
 18705         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18706         IF PI-USES-PAID-TO
 18707             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18708             MOVE +1                  TO DC-ELAPSED-DAYS
 18709             MOVE +0                  TO DC-ELAPSED-MONTHS
 18710             MOVE '6'                 TO DC-OPTION-CODE
 18711             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18712             IF NO-CONVERSION-ERROR
 18713                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18714
 18715     IF WS-CHK-THRU-DT < PI-EXP-DT
 18716         NEXT SENTENCE
 18717     ELSE
 18718         MOVE 03                     TO  WS-ACTIVITY-CODE
 18719         GO TO 7390-PROCESS-ACTIVITY.
 18720
 18721     IF PI-PROV-PMT
 18722         MOVE 09                     TO  WS-ACTIVITY-CODE
 18723     ELSE
 18724        IF PI-PMTTYPE = '1'
 18725            MOVE 02                  TO  WS-ACTIVITY-CODE
 18726        ELSE
 18727        IF PI-PMTTYPE = '2' OR '3'
 18728            MOVE 07                  TO  WS-ACTIVITY-CODE
 18729        ELSE
 18730        IF PI-PMTTYPE = '4'
 18731            MOVE 00                  TO  WS-ACTIVITY-CODE
 18732        ELSE
 18733            MOVE 'N'                 TO  PI-RESET-SW
 18734            GO TO 7399-EXIT.
 18735
 18736 7390-PROCESS-ACTIVITY.
 18737
 18738     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18739
 18740 7399-EXIT.
 18741     EXIT.
 18742
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 356
* EL156.cbl
 18744 7400-CHECK-AUTO-ACTIVITY.
 18745
 18746
 18747* EXEC CICS HANDLE CONDITION
 18748*        NOTFND   (7400-NOT-FOUND)
 18749*    END-EXEC.
 18750*    MOVE '"$I                   ! < #00017076' TO DFHEIV0
 18751     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18752     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18753     MOVE X'3C20233030303137303736' TO DFHEIV0(25:11)
 18754     CALL 'kxdfhei1' USING DFHEIV0
 18755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18756
 18757
 18758     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18759     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18760     MOVE SPACES                 TO  CNTL-ACCESS.
 18761     MOVE +0                     TO  CNTL-SEQ-NO.
 18762
 18763
 18764* EXEC CICS READ
 18765*        DATASET   ('ELCNTL')
 18766*        RIDFLD    (ELCNTL-KEY)
 18767*        SET       (ADDRESS OF CONTROL-FILE)
 18768*    END-EXEC.
 18769     MOVE 'ELCNTL' TO DFHEIV1
 18770*    MOVE '&"S        E          (   #00017085' TO DFHEIV0
 18771     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18773     MOVE X'2020233030303137303835' TO DFHEIV0(25:11)
 18774     CALL 'kxdfhei1' USING DFHEIV0,
 18775           DFHEIV1,
 18776           DFHEIV20,
 18777           DFHEIV99,
 18778           ELCNTL-KEY,
 18779           DFHEIV99,
 18780           DFHEIV99,
 18781           DFHEIV99
 18782     SET ADDRESS OF CONTROL-FILE TO
 18783         DFHEIV20
 18784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18785
 18786
 18787     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18788     GO TO 7400-EXIT.
 18789
 18790 7400-NOT-FOUND.
 18791     MOVE 'N'                        TO  PI-RESET-SW
 18792                                         WS-LETTER-SW
 18793                                         WS-ACT-REC-FOUND-SW.
 18794
 18795     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18796
 18797 7400-EXIT.
 18798     EXIT.
 18799
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 357
* EL156.cbl
 18801 7450-FORMAT-AUTO-LETTER.
 18802
 18803     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18804         MOVE 'Y'                    TO PI-RESET-SW
 18805         GO TO 7450-CONTINUE-PROCESS.
 18806
 18807     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18808
 18809     IF SUB > 9
 18810         SUBTRACT 9 FROM SUB
 18811         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18812     ELSE
 18813         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18814
 18815 7450-CONTINUE-PROCESS.
 18816
 18817     IF WS-ACTIVITY-CODE = ZEROS
 18818         MOVE 'N'                    TO  WS-LETTER-SW
 18819         GO TO 7450-EXIT.
 18820
 18821     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18822
 18823     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18824         MOVE 'N'                    TO  PI-RESET-SW
 18825                                         WS-LETTER-SW
 18826         GO TO 7450-EXIT.
 18827
 18828     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18829         MOVE 'N'                    TO  WS-LETTER-SW
 18830         GO TO 7450-EXIT.
 18831
 18832     MOVE 'Y'                        TO  WS-LETTER-SW.
 18833     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18834     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18835
 18836     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18837
 18838     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18839         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18840         MOVE '6'                    TO  DC-OPTION-CODE
 18841         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18842         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18843         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18844         IF NO-CONVERSION-ERROR
 18845             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18846         ELSE
 18847              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18848
 18849     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18850         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18851         MOVE '6'                    TO  DC-OPTION-CODE
 18852         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18853         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18854         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18855         IF NO-CONVERSION-ERROR
 18856             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18857         ELSE
 18858             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 358
* EL156.cbl
 18859
 18860 7450-EXIT.
 18861     EXIT.
 18862
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 359
* EL156.cbl
 18864 7500-RESET-AUTO-ACTIVITY.
 18865
 18866     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18867     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18868     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18869     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18870     MOVE +100                   TO  TRLR-SEQ-NO.
 18871
 18872 7500-STARTBR-TRLR.
 18873
 18874
 18875* EXEC CICS HANDLE CONDITION
 18876*        ENDFILE  (7590-END)
 18877*        NOTFND   (7590-END)
 18878*    END-EXEC.
 18879*    MOVE '"$''I                  ! = #00017178' TO DFHEIV0
 18880     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18882     MOVE X'3D20233030303137313738' TO DFHEIV0(25:11)
 18883     CALL 'kxdfhei1' USING DFHEIV0
 18884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18885
 18886
 18887
 18888* EXEC CICS STARTBR
 18889*        DATASET   ('ELTRLR')
 18890*        RIDFLD    (ELTRLR-KEY)
 18891*        GTEQ
 18892*    END-EXEC.
 18893     MOVE 'ELTRLR' TO DFHEIV1
 18894     MOVE 0
 18895       TO DFHEIV11
 18896*    MOVE '&,         G          &   #00017183' TO DFHEIV0
 18897     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18898     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18899     MOVE X'2020233030303137313833' TO DFHEIV0(25:11)
 18900     CALL 'kxdfhei1' USING DFHEIV0,
 18901           DFHEIV1,
 18902           ELTRLR-KEY,
 18903           DFHEIV99,
 18904           DFHEIV11,
 18905           DFHEIV99
 18906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18907
 18908
 18909     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18910
 18911 7500-READ-NEXT.
 18912
 18913
 18914* EXEC CICS READNEXT
 18915*        DATASET   ('ELTRLR')
 18916*        RIDFLD    (ELTRLR-KEY)
 18917*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18918*    END-EXEC.
 18919     MOVE 'ELTRLR' TO DFHEIV1
 18920     MOVE 0
 18921       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 360
* EL156.cbl
 18922*    MOVE '&.S                   )   #00017193' TO DFHEIV0
 18923     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18924     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18925     MOVE X'2020233030303137313933' TO DFHEIV0(25:11)
 18926     CALL 'kxdfhei1' USING DFHEIV0,
 18927           DFHEIV1,
 18928           DFHEIV20,
 18929           DFHEIV99,
 18930           ELTRLR-KEY,
 18931           DFHEIV99,
 18932           DFHEIV11,
 18933           DFHEIV99,
 18934           DFHEIV99
 18935     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18936         DFHEIV20
 18937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18938
 18939
 18940     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18941        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18942        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18943        PI-CERT-NO    NOT = TRLR-CERT-NO
 18944         GO TO 7590-END.
 18945
 18946     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18947         GO TO 7500-READ-NEXT.
 18948
 18949     IF AT-TRAILER-TYPE NOT = '4'
 18950         GO TO 7500-READ-NEXT.
 18951
 18952     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18953         GO TO 7500-READ-NEXT.
 18954
 18955     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18956        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18957         GO TO 7500-READ-NEXT.
 18958
 18959     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18960        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18961        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18962         GO TO 7500-READ-NEXT.
 18963
 18964     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18965                         AND
 18966        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18967                         AND
 18968        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18969            GO TO 7500-READ-NEXT.
 18970
 18971     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18972
 18973
 18974* EXEC CICS ENDBR
 18975*        DATASET   ('ELTRLR')
 18976*    END-EXEC.
 18977     MOVE 'ELTRLR' TO DFHEIV1
 18978     MOVE 0
 18979       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 361
* EL156.cbl
 18980*    MOVE '&2                    $   #00017232' TO DFHEIV0
 18981     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18982     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18983     MOVE X'2020233030303137323332' TO DFHEIV0(25:11)
 18984     CALL 'kxdfhei1' USING DFHEIV0,
 18985           DFHEIV1,
 18986           DFHEIV11,
 18987           DFHEIV99
 18988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18989
 18990
 18991     MOVE 'N'                        TO  WS-BROWSE-SW.
 18992
 18993
 18994* EXEC CICS READ
 18995*        DATASET   ('ELTRLR')
 18996*        RIDFLD    (ELTRLR-KEY)
 18997*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18998*        UPDATE
 18999*    END-EXEC.
 19000     MOVE 'ELTRLR' TO DFHEIV1
 19001*    MOVE '&"S        EU         (   #00017238' TO DFHEIV0
 19002     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19003     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19004     MOVE X'2020233030303137323338' TO DFHEIV0(25:11)
 19005     CALL 'kxdfhei1' USING DFHEIV0,
 19006           DFHEIV1,
 19007           DFHEIV20,
 19008           DFHEIV99,
 19009           ELTRLR-KEY,
 19010           DFHEIV99,
 19011           DFHEIV99,
 19012           DFHEIV99
 19013     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19014         DFHEIV20
 19015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19016
 19017
 19018     MOVE 'Y'                        TO  WS-UPDATE-SW.
 19019
 19020     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 19021         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 19022     ELSE
 19023         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 19024             NEXT SENTENCE
 19025         ELSE
 19026             GO TO 7500-REWRITE-TRLR.
 19027
 19028     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 19029
 19030     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 19031     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 19032     MOVE '1'                        TO  ARCH-REC-TYPE.
 19033     MOVE +0                         TO  ARCH-SEQ.
 19034
 19035     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 19036
 19037 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 362
* EL156.cbl
 19038
 19039
 19040* EXEC CICS REWRITE
 19041*        DATASET   ('ELTRLR')
 19042*        FROM      (ACTIVITY-TRAILERS)
 19043*    END-EXEC.
 19044     MOVE LENGTH OF
 19045      ACTIVITY-TRAILERS
 19046       TO DFHEIV11
 19047     MOVE 'ELTRLR' TO DFHEIV1
 19048*    MOVE '&& L                  %   #00017266' TO DFHEIV0
 19049     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19050     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19051     MOVE X'2020233030303137323636' TO DFHEIV0(25:11)
 19052     CALL 'kxdfhei1' USING DFHEIV0,
 19053           DFHEIV1,
 19054           ACTIVITY-TRAILERS,
 19055           DFHEIV11,
 19056           DFHEIV99
 19057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19058
 19059
 19060     GO TO 7500-STARTBR-TRLR.
 19061
 19062 7590-END.
 19063
 19064     IF WS-BROWSE-SW = 'Y'
 19065         MOVE 'N'                    TO  WS-BROWSE-SW
 19066
 19067* EXEC CICS ENDBR
 19068*            DATASET   ('ELTRLR')
 19069*        END-EXEC.
 19070     MOVE 'ELTRLR' TO DFHEIV1
 19071     MOVE 0
 19072       TO DFHEIV11
 19073*    MOVE '&2                    $   #00017277' TO DFHEIV0
 19074     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19075     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19076     MOVE X'2020233030303137323737' TO DFHEIV0(25:11)
 19077     CALL 'kxdfhei1' USING DFHEIV0,
 19078           DFHEIV1,
 19079           DFHEIV11,
 19080           DFHEIV99
 19081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19082
 19083
 19084 7599-EXIT.
 19085     EXIT.
 19086
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 363
* EL156.cbl
 19088 7600-READ-ARCH-UPDATE.
 19089
 19090
 19091* EXEC CICS HANDLE CONDITION
 19092*        NOTFND   (7699-EXIT)
 19093*    END-EXEC.
 19094*    MOVE '"$I                   ! > #00017287' TO DFHEIV0
 19095     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19097     MOVE X'3E20233030303137323837' TO DFHEIV0(25:11)
 19098     CALL 'kxdfhei1' USING DFHEIV0
 19099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19100
 19101
 19102
 19103* EXEC CICS READ
 19104*        DATASET   ('ELARCH')
 19105*        RIDFLD    (ELARCH-KEY)
 19106*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19107*        UPDATE
 19108*    END-EXEC.
 19109     MOVE 'ELARCH' TO DFHEIV1
 19110*    MOVE '&"S        EU         (   #00017291' TO DFHEIV0
 19111     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19112     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19113     MOVE X'2020233030303137323931' TO DFHEIV0(25:11)
 19114     CALL 'kxdfhei1' USING DFHEIV0,
 19115           DFHEIV1,
 19116           DFHEIV20,
 19117           DFHEIV99,
 19118           ELARCH-KEY,
 19119           DFHEIV99,
 19120           DFHEIV99,
 19121           DFHEIV99
 19122     SET ADDRESS OF LETTER-ARCHIVE TO
 19123         DFHEIV20
 19124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19125
 19126
 19127     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19128
 19129
 19130* EXEC CICS REWRITE
 19131*        DATASET   ('ELARCH')
 19132*        FROM      (LETTER-ARCHIVE)
 19133*    END-EXEC.
 19134     MOVE LENGTH OF
 19135      LETTER-ARCHIVE
 19136       TO DFHEIV11
 19137     MOVE 'ELARCH' TO DFHEIV1
 19138*    MOVE '&& L                  %   #00017300' TO DFHEIV0
 19139     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19140     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19141     MOVE X'2020233030303137333030' TO DFHEIV0(25:11)
 19142     CALL 'kxdfhei1' USING DFHEIV0,
 19143           DFHEIV1,
 19144           LETTER-ARCHIVE,
 19145           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 364
* EL156.cbl
 19146           DFHEIV99
 19147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19148
 19149
 19150 7699-EXIT.
 19151     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 365
* EL156.cbl
 19153 7700-GET-DCT.
 19154
 19155     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19156     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19157     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19158     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19159                                    PI-MAX-BENEFIT-AMT
 19160                                    PI-MAX-BENEFIT-PYMT
 19161                                    PI-MIN-PAYMENT-AMT
 19162                                    PI-TIME-OF-LOSS-BAL.
 19163
 19164
 19165* EXEC CICS HANDLE CONDITION
 19166*         NOTFND (5300-NOTE-NOT-FOUND)
 19167*     END-EXEC.
 19168*    MOVE '"$I                   ! ? #00017319' TO DFHEIV0
 19169     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19171     MOVE X'3F20233030303137333139' TO DFHEIV0(25:11)
 19172     CALL 'kxdfhei1' USING DFHEIV0
 19173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19174
 19175
 19176
 19177* EXEC CICS READ
 19178*         DATASET('ERNOTE')
 19179*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19180*         RIDFLD (W-NOTE-KEY)
 19181*     END-EXEC.
 19182     MOVE 'ERNOTE' TO DFHEIV1
 19183*    MOVE '&"S        E          (   #00017323' TO DFHEIV0
 19184     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19186     MOVE X'2020233030303137333233' TO DFHEIV0(25:11)
 19187     CALL 'kxdfhei1' USING DFHEIV0,
 19188           DFHEIV1,
 19189           DFHEIV20,
 19190           DFHEIV99,
 19191           W-NOTE-KEY,
 19192           DFHEIV99,
 19193           DFHEIV99,
 19194           DFHEIV99
 19195     SET ADDRESS OF CERTIFICATE-NOTE TO
 19196         DFHEIV20
 19197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19198
 19199
 19200     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19201     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19202     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19203     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19204     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19205
 19206     IF PI-PAYEE-TYPE NOT = 'B'
 19207         GO TO 7700-EXIT.
 19208
 19209     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19210     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 366
* EL156.cbl
 19211     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19212
 19213     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19214         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19215     ELSE
 19216         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19217
 19218     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19219     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19220     MOVE 'DLO006'               TO PGM-NAME.
 19221
 19222
 19223* EXEC CICS LINK
 19224*        PROGRAM    (PGM-NAME)
 19225*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19226*        LENGTH     (DCT-RCRD-LENGTH)
 19227*    END-EXEC.
 19228*    MOVE '."C                   (   #00017351' TO DFHEIV0
 19229     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19230     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19231     MOVE X'2020233030303137333531' TO DFHEIV0(25:11)
 19232     CALL 'kxdfhei1' USING DFHEIV0,
 19233           PGM-NAME,
 19234           DCT-COMMUNICATION-AREA,
 19235           DCT-RCRD-LENGTH,
 19236           DFHEIV99,
 19237           DFHEIV99,
 19238           DFHEIV99,
 19239           DFHEIV99
 19240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19241
 19242
 19243     IF DCT-RETURN-CODE = 'OK'
 19244         GO TO 7700-CONT.
 19245
 19246     IF DCT-RETURN-CODE = '01' OR '02'
 19247         GO TO 7700-SET-TO-YES.
 19248
 19249     IF DCT-RETURN-CODE = '03'
 19250
 19251* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19252*    MOVE '6"R                   !   #00017364' TO DFHEIV0
 19253     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19254     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19255     MOVE X'2020233030303137333634' TO DFHEIV0(25:11)
 19256     CALL 'kxdfhei1' USING DFHEIV0
 19257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19258         MOVE ER-0951            TO EMI-ERROR
 19259         MOVE -1                 TO PMTTYPEL
 19260         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19261         GO TO 8200-SEND-DATAONLY.
 19262
 19263     IF DCT-RETURN-CODE = '04'
 19264
 19265* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19266*    MOVE '6"R                   !   #00017371' TO DFHEIV0
 19267     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 367
* EL156.cbl
 19269     MOVE X'2020233030303137333731' TO DFHEIV0(25:11)
 19270     CALL 'kxdfhei1' USING DFHEIV0
 19271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19272         MOVE ER-0946            TO EMI-ERROR
 19273         MOVE -1                 TO PMTTYPEL
 19274         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19275         GO TO 8200-SEND-DATAONLY.
 19276
 19277     IF DCT-RETURN-CODE = '05'
 19278
 19279* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19280*    MOVE '6"R                   !   #00017378' TO DFHEIV0
 19281     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19283     MOVE X'2020233030303137333738' TO DFHEIV0(25:11)
 19284     CALL 'kxdfhei1' USING DFHEIV0
 19285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19286         MOVE ER-0947            TO EMI-ERROR
 19287         MOVE -1                 TO PMTTYPEL
 19288         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19289         GO TO 8200-SEND-DATAONLY.
 19290
 19291     IF DCT-RETURN-CODE = '06'
 19292
 19293* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19294*    MOVE '6"R                   !   #00017385' TO DFHEIV0
 19295     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19297     MOVE X'2020233030303137333835' TO DFHEIV0(25:11)
 19298     CALL 'kxdfhei1' USING DFHEIV0
 19299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19300         MOVE ER-0921            TO EMI-ERROR
 19301         MOVE -1                 TO PMTTYPEL
 19302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19303         GO TO 8200-SEND-DATAONLY.
 19304
 19305     IF DCT-RETURN-CODE = '07'
 19306
 19307* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19308*    MOVE '6"R                   !   #00017392' TO DFHEIV0
 19309     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19311     MOVE X'2020233030303137333932' TO DFHEIV0(25:11)
 19312     CALL 'kxdfhei1' USING DFHEIV0
 19313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19314         MOVE ER-0919            TO EMI-ERROR
 19315         MOVE -1                 TO PMTTYPEL
 19316         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19317         GO TO 8200-SEND-DATAONLY.
 19318
 19319     IF DCT-RETURN-CODE = '08'
 19320
 19321* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19322*    MOVE '6"R                   !   #00017399' TO DFHEIV0
 19323     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19325     MOVE X'2020233030303137333939' TO DFHEIV0(25:11)
 19326     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 368
* EL156.cbl
 19327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19328         MOVE ER-0948            TO EMI-ERROR
 19329         MOVE -1                 TO PMTTYPEL
 19330         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19331         GO TO 8200-SEND-DATAONLY.
 19332
 19333     IF DCT-RETURN-CODE = 'N1'
 19334
 19335* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19336*    MOVE '6"R                   !   #00017406' TO DFHEIV0
 19337     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19339     MOVE X'2020233030303137343036' TO DFHEIV0(25:11)
 19340     CALL 'kxdfhei1' USING DFHEIV0
 19341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19342         MOVE ER-0950            TO EMI-ERROR
 19343         MOVE -1                 TO PMTTYPEL
 19344         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19345         GO TO 8200-SEND-DATAONLY.
 19346
 19347     IF DCT-RETURN-CODE = 'E1'
 19348
 19349* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19350*    MOVE '6"R                   !   #00017413' TO DFHEIV0
 19351     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19353     MOVE X'2020233030303137343133' TO DFHEIV0(25:11)
 19354     CALL 'kxdfhei1' USING DFHEIV0
 19355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19356         MOVE ER-0974            TO EMI-ERROR
 19357         MOVE -1                 TO PMTTYPEL
 19358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19359         GO TO 8200-SEND-DATAONLY.
 19360
 19361     IF DCT-RETURN-CODE = 'E2'
 19362
 19363* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19364*    MOVE '6"R                   !   #00017420' TO DFHEIV0
 19365     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19367     MOVE X'2020233030303137343230' TO DFHEIV0(25:11)
 19368     CALL 'kxdfhei1' USING DFHEIV0
 19369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19370         MOVE ER-0975            TO EMI-ERROR
 19371         MOVE -1                 TO PMTTYPEL
 19372         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19373         GO TO 8200-SEND-DATAONLY.
 19374
 19375     IF DCT-RETURN-CODE NOT = 'OK'
 19376
 19377* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19378*    MOVE '6"R                   !   #00017427' TO DFHEIV0
 19379     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19381     MOVE X'2020233030303137343237' TO DFHEIV0(25:11)
 19382     CALL 'kxdfhei1' USING DFHEIV0
 19383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19384         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 369
* EL156.cbl
 19385         MOVE -1                 TO PMTTYPEL
 19386         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19387         GO TO 8200-SEND-DATAONLY.
 19388
 19389 7700-CONT.
 19390
 19391*    MOVE 'N'                    TO CASHO.
 19392*    MOVE +1                     TO CASHL.
 19393*    MOVE AL-UANON               TO CASHA.
 19394
 19395     IF PI-OFFLINE = 'Y'
 19396         GO TO 7700-EXIT.
 19397
 19398     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19399     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19400     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19401     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19402     MOVE +7                     TO CHECKNOL.
 19403     MOVE AL-UANON               TO CHECKNOA.
 19404     GO TO 7700-EXIT.
 19405
 19406 7700-SET-TO-YES.
 19407
 19408*    MOVE 'Y'                    TO CASHO.
 19409*    MOVE +1                     TO CASHL.
 19410*    MOVE AL-UANON               TO CASHA.
 19411
 19412 7700-EXIT.
 19413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 370
* EL156.cbl
 19415 7800-READ-COMP-MSTR.
 19416
 19417
 19418* EXEC CICS HANDLE CONDITION
 19419*        NOTFND   (7800-COMP-NOTFND)
 19420*    END-EXEC.
 19421*    MOVE '"$I                   ! @ #00017461' TO DFHEIV0
 19422     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19424     MOVE X'4020233030303137343631' TO DFHEIV0(25:11)
 19425     CALL 'kxdfhei1' USING DFHEIV0
 19426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19427
 19428
 19429
 19430* EXEC CICS READ
 19431*        DATASET   ('ERCOMP')
 19432*        RIDFLD    (ERCOMP-KEY)
 19433*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19434*    END-EXEC.
 19435     MOVE 'ERCOMP' TO DFHEIV1
 19436*    MOVE '&"S        E          (   #00017465' TO DFHEIV0
 19437     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19439     MOVE X'2020233030303137343635' TO DFHEIV0(25:11)
 19440     CALL 'kxdfhei1' USING DFHEIV0,
 19441           DFHEIV1,
 19442           DFHEIV20,
 19443           DFHEIV99,
 19444           ERCOMP-KEY,
 19445           DFHEIV99,
 19446           DFHEIV99,
 19447           DFHEIV99
 19448     SET ADDRESS OF COMPENSATION-MASTER TO
 19449         DFHEIV20
 19450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19451
 19452
 19453     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19454     GO TO 7800-COMP-EXIT.
 19455
 19456 7800-COMP-NOTFND.
 19457     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19458
 19459 7800-COMP-EXIT.
 19460     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 371
* EL156.cbl
 19462 7900-READ-CLAIM.
 19463
 19464* EXEC CICS READ
 19465*        DATASET  ('ELMSTR')
 19466*        SET      (ADDRESS OF CLAIM-MASTER)
 19467*        RIDFLD   (ELMSTR-KEY)
 19468*    END-EXEC.
 19469     MOVE 'ELMSTR' TO DFHEIV1
 19470*    MOVE '&"S        E          (   #00017481' TO DFHEIV0
 19471     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19472     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19473     MOVE X'2020233030303137343831' TO DFHEIV0(25:11)
 19474     CALL 'kxdfhei1' USING DFHEIV0,
 19475           DFHEIV1,
 19476           DFHEIV20,
 19477           DFHEIV99,
 19478           ELMSTR-KEY,
 19479           DFHEIV99,
 19480           DFHEIV99,
 19481           DFHEIV99
 19482     SET ADDRESS OF CLAIM-MASTER TO
 19483         DFHEIV20
 19484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19485
 19486
 19487 7900-EXIT.
 19488      EXIT.
 19489
 19490 7910-READ-CLAIM-UPDATE.
 19491
 19492* EXEC CICS READ
 19493*        DATASET  ('ELMSTR')
 19494*        SET      (ADDRESS OF CLAIM-MASTER)
 19495*        RIDFLD   (ELMSTR-KEY)
 19496*        UPDATE
 19497*    END-EXEC.
 19498     MOVE 'ELMSTR' TO DFHEIV1
 19499*    MOVE '&"S        EU         (   #00017491' TO DFHEIV0
 19500     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19501     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19502     MOVE X'2020233030303137343931' TO DFHEIV0(25:11)
 19503     CALL 'kxdfhei1' USING DFHEIV0,
 19504           DFHEIV1,
 19505           DFHEIV20,
 19506           DFHEIV99,
 19507           ELMSTR-KEY,
 19508           DFHEIV99,
 19509           DFHEIV99,
 19510           DFHEIV99
 19511     SET ADDRESS OF CLAIM-MASTER TO
 19512         DFHEIV20
 19513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19514
 19515
 19516 7910-EXIT.
 19517      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 372
* EL156.cbl
 19519 7920-READ-BENE.
 19520     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19521     MOVE 'B'                TO BENE-RECORD-TYPE.
 19522     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19523
 19524     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19525        IF PI-PAYEE-TYPE    = 'B' AND
 19526           PI-PAYEE-SEQ-NUM = 9
 19527             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19528             MOVE WS-A-BENE           TO BENE-NUMBER.
 19529
 19530
 19531* EXEC CICS HANDLE CONDITION
 19532*        NOTFND   (7920-NOT-FOUND)
 19533*    END-EXEC.
 19534*    MOVE '"$I                   ! A #00017512' TO DFHEIV0
 19535     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19537     MOVE X'4120233030303137353132' TO DFHEIV0(25:11)
 19538     CALL 'kxdfhei1' USING DFHEIV0
 19539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19540
 19541
 19542
 19543* EXEC CICS READ
 19544*        DATASET  ('ELBENE')
 19545*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19546*        RIDFLD   (ELBENE-KEY)
 19547*    END-EXEC.
 19548     MOVE 'ELBENE' TO DFHEIV1
 19549*    MOVE '&"S        E          (   #00017516' TO DFHEIV0
 19550     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19552     MOVE X'2020233030303137353136' TO DFHEIV0(25:11)
 19553     CALL 'kxdfhei1' USING DFHEIV0,
 19554           DFHEIV1,
 19555           DFHEIV20,
 19556           DFHEIV99,
 19557           ELBENE-KEY,
 19558           DFHEIV99,
 19559           DFHEIV99,
 19560           DFHEIV99
 19561     SET ADDRESS OF BENEFICIARY-MASTER TO
 19562         DFHEIV20
 19563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19564
 19565
 19566     MOVE 'Y' TO BENE-FOUND-SW.
 19567     GO TO 7920-EXIT.
 19568
 19569 7920-NOT-FOUND.
 19570     MOVE 'N'                    TO BENE-FOUND-SW.
 19571
 19572 7920-EXIT.
 19573      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 373
* EL156.cbl
 19575 7930-READ-CONTROL.
 19576
 19577* EXEC CICS READ
 19578*        DATASET  ('ELCNTL')
 19579*        SET      (ADDRESS OF CONTROL-FILE)
 19580*        RIDFLD   (ELCNTL-KEY)
 19581*    END-EXEC.
 19582     MOVE 'ELCNTL' TO DFHEIV1
 19583*    MOVE '&"S        E          (   #00017532' TO DFHEIV0
 19584     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19585     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19586     MOVE X'2020233030303137353332' TO DFHEIV0(25:11)
 19587     CALL 'kxdfhei1' USING DFHEIV0,
 19588           DFHEIV1,
 19589           DFHEIV20,
 19590           DFHEIV99,
 19591           ELCNTL-KEY,
 19592           DFHEIV99,
 19593           DFHEIV99,
 19594           DFHEIV99
 19595     SET ADDRESS OF CONTROL-FILE TO
 19596         DFHEIV20
 19597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19598
 19599
 19600 7930-EXIT.
 19601      EXIT.
 19602
 19603 7940-READ-CONTROL-UPDATE.
 19604
 19605* EXEC CICS READ
 19606*        DATASET  ('ELCNTL')
 19607*        SET      (ADDRESS OF CONTROL-FILE)
 19608*        RIDFLD   (ELCNTL-KEY)
 19609*        UPDATE
 19610*    END-EXEC.
 19611     MOVE 'ELCNTL' TO DFHEIV1
 19612*    MOVE '&"S        EU         (   #00017542' TO DFHEIV0
 19613     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19614     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19615     MOVE X'2020233030303137353432' TO DFHEIV0(25:11)
 19616     CALL 'kxdfhei1' USING DFHEIV0,
 19617           DFHEIV1,
 19618           DFHEIV20,
 19619           DFHEIV99,
 19620           ELCNTL-KEY,
 19621           DFHEIV99,
 19622           DFHEIV99,
 19623           DFHEIV99
 19624     SET ADDRESS OF CONTROL-FILE TO
 19625         DFHEIV20
 19626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19627
 19628
 19629 7940-EXIT.
 19630      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 374
* EL156.cbl
 19632 7950-READ-TRAILER.
 19633
 19634* EXEC CICS READ
 19635*        DATASET  ('ELTRLR')
 19636*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19637*        RIDFLD   (ELTRLR-KEY)
 19638*    END-EXEC.
 19639     MOVE 'ELTRLR' TO DFHEIV1
 19640*    MOVE '&"S        E          (   #00017553' TO DFHEIV0
 19641     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19643     MOVE X'2020233030303137353533' TO DFHEIV0(25:11)
 19644     CALL 'kxdfhei1' USING DFHEIV0,
 19645           DFHEIV1,
 19646           DFHEIV20,
 19647           DFHEIV99,
 19648           ELTRLR-KEY,
 19649           DFHEIV99,
 19650           DFHEIV99,
 19651           DFHEIV99
 19652     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19653         DFHEIV20
 19654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19655
 19656
 19657 7950-EXIT.
 19658      EXIT.
 19659
 19660 7960-READ-TRAILER-UPDATE.
 19661
 19662* EXEC CICS READ
 19663*        DATASET  ('ELTRLR')
 19664*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19665*        RIDFLD   (ELTRLR-KEY)
 19666*        UPDATE
 19667*    END-EXEC.
 19668     MOVE 'ELTRLR' TO DFHEIV1
 19669*    MOVE '&"S        EU         (   #00017563' TO DFHEIV0
 19670     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19671     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19672     MOVE X'2020233030303137353633' TO DFHEIV0(25:11)
 19673     CALL 'kxdfhei1' USING DFHEIV0,
 19674           DFHEIV1,
 19675           DFHEIV20,
 19676           DFHEIV99,
 19677           ELTRLR-KEY,
 19678           DFHEIV99,
 19679           DFHEIV99,
 19680           DFHEIV99
 19681     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19682         DFHEIV20
 19683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19684
 19685
 19686 7960-EXIT.
 19687      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 375
* EL156.cbl
 19689 7970-READ-CERT.
 19690
 19691* EXEC CICS READ
 19692*        DATASET  ('ELCERT')
 19693*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19694*        RIDFLD   (ELCERT-KEY)
 19695*    END-EXEC.
 19696     MOVE 'ELCERT' TO DFHEIV1
 19697*    MOVE '&"S        E          (   #00017574' TO DFHEIV0
 19698     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19699     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19700     MOVE X'2020233030303137353734' TO DFHEIV0(25:11)
 19701     CALL 'kxdfhei1' USING DFHEIV0,
 19702           DFHEIV1,
 19703           DFHEIV20,
 19704           DFHEIV99,
 19705           ELCERT-KEY,
 19706           DFHEIV99,
 19707           DFHEIV99,
 19708           DFHEIV99
 19709     SET ADDRESS OF CERTIFICATE-MASTER TO
 19710         DFHEIV20
 19711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19712
 19713
 19714 7970-EXIT.
 19715      EXIT.
 19716 7975-read-acct.
 19717
 19718     move spaces              to WS-ACCT-RECORD-SW
 19719                                 pi-dcc-product-code
 19720
 19721     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19722     MOVE PI-CARRIER          TO ACCT-CARRIER
 19723     MOVE PI-GROUPING         TO ACCT-GROUPING
 19724     MOVE PI-STATE            TO ACCT-STATE
 19725     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19726     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19727     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19728     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19729
 19730
 19731* EXEC CICS READ
 19732*       DATASET ('ERACCT')
 19733*       RIDFLD  (ERACCT-KEY)
 19734*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19735*       GTEQ
 19736*       resp    (WS-RESPONSE)
 19737*    END-EXEC
 19738     MOVE 'ERACCT' TO DFHEIV1
 19739*    MOVE '&"S        G          (  N#00017596' TO DFHEIV0
 19740     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19741     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19742     MOVE X'204E233030303137353936' TO DFHEIV0(25:11)
 19743     CALL 'kxdfhei1' USING DFHEIV0,
 19744           DFHEIV1,
 19745           DFHEIV20,
 19746           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 376
* EL156.cbl
 19747           ERACCT-KEY,
 19748           DFHEIV99,
 19749           DFHEIV99,
 19750           DFHEIV99
 19751     SET ADDRESS OF ACCOUNT-MASTER TO
 19752         DFHEIV20
 19753     MOVE EIBRESP  TO WS-RESPONSE
 19754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19755     IF WS-RESP-NORMAL
 19756        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19757        and pi-cert-eff-dt < am-expiration-dt
 19758        and pi-cert-eff-dt >= am-effective-dt
 19759        move am-dcc-product-code to pi-dcc-product-code
 19760        set acct-found to true
 19761     end-if
 19762
 19763     .
 19764 7975-exit.
 19765     exit.
 19766 7980-READ-CERT-UPDATE.
 19767
 19768* EXEC CICS READ
 19769*        DATASET  ('ELCERT')
 19770*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19771*        RIDFLD   (ELCERT-KEY)
 19772*        UPDATE
 19773*    END-EXEC.
 19774     MOVE 'ELCERT' TO DFHEIV1
 19775*    MOVE '&"S        EU         (   #00017615' TO DFHEIV0
 19776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19777     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19778     MOVE X'2020233030303137363135' TO DFHEIV0(25:11)
 19779     CALL 'kxdfhei1' USING DFHEIV0,
 19780           DFHEIV1,
 19781           DFHEIV20,
 19782           DFHEIV99,
 19783           ELCERT-KEY,
 19784           DFHEIV99,
 19785           DFHEIV99,
 19786           DFHEIV99
 19787     SET ADDRESS OF CERTIFICATE-MASTER TO
 19788         DFHEIV20
 19789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19790
 19791
 19792 7980-EXIT.
 19793      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 377
* EL156.cbl
 19795 8000-LOAD-ERROR-MESSAGES.
 19796     IF PI-PASS-SW = 'C'
 19797        MOVE EMI-LINE1           TO ERMSG1BO
 19798     ELSE
 19799        MOVE EMI-LINE1           TO ERRMSG1O
 19800        MOVE EMI-LINE2           TO ERRMSG2O.
 19801
 19802 8000-EXIT.
 19803     EXIT.
 19804
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 378
* EL156.cbl
 19806
 19807 8010-DMD-ERROR-CHECKS.
 19808     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19809
 19810     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19811         GO TO 8051-ISSUE-ERROR.
 19812
 19813     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19814     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19815     MOVE '3'                    TO DC-OPTION-CODE.
 19816     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19817     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19818         GO TO 8051-ISSUE-ERROR.
 19819
 19820     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19821       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19822                           OR
 19823          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19824           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19825             MOVE ER-0851         TO EMI-ERROR
 19826             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19827       END-IF
 19828       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19829             MOVE ER-8147         TO EMI-ERROR
 19830             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19831
 19832     GO TO 8090-EXIT.
 19833
 19834 8051-ISSUE-ERROR.
 19835     MOVE ER-8146            TO EMI-ERROR.
 19836     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19837     GO TO 8090-EXIT.
 19838
 19839 8090-EXIT.
 19840      EXIT.
 19841
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 379
* EL156.cbl
 19843 8100-SEND-INITIAL-MAP.
 19844
 19845     MOVE SAVE-DATE              TO RUNDTEAO.
 19846     MOVE EIBTIME                TO TIME-IN.
 19847     MOVE TIME-OUT               TO RUNTIMAO.
 19848     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19849
 19850     IF MAP-NAME = 'EL156A'
 19851        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19852           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19853        END-IF
 19854        IF PI-COMPANY-ID = 'DCC' or 'CAP'
 19855           MOVE 'N'     TO SURVYYNO
 19856        END-IF
 19857     END-IF
 19858*    IF MAP-NAME = 'EL156A'
 19859*       IF PI-COMPANY-ID = 'CRI'
 19860*          NEXT SENTENCE
 19861*       ELSE
 19862*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19863
 19864     IF MAP-NAME = 'EL156A'
 19865        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19866           NEXT SENTENCE
 19867        ELSE
 19868           MOVE AL-SADOF TO  PINTA    PINTHA.
 19869
 19870     IF MAP-NAME = 'EL156A'
 19871        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19872            NEXT SENTENCE
 19873        ELSE
 19874           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19875
 19876*    IF MAP-NAME = 'EL156A'
 19877*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19878*          NEXT SENTENCE
 19879*       ELSE
 19880*          MOVE AL-SADOF TO CASHHA CASHA.
 19881
 19882     IF MAP-NAME = 'EL156A'
 19883        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19884                        or 'CAP'
 19885           NEXT SENTENCE
 19886        ELSE
 19887           MOVE AL-SADOF        TO  LOANHA
 19888                                    LOANNOA.
 19889
 19890     IF MAP-NAME = 'EL156A'
 19891        MOVE -1                 TO  ENTERPFL
 19892        IF PI-USES-PAID-TO
 19893           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19894           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19895           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19896        ELSE
 19897           NEXT SENTENCE
 19898     ELSE
 19899        IF MAP-NAME = 'EL156B'
 19900           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 380
* EL156.cbl
 19901              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19902              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19903
 19904
 19905* EXEC CICS SEND
 19906*        MAP   (MAP-NAME)
 19907*        MAPSET(MAPSET-NAME)
 19908*        FROM  (EL156AI)
 19909*        ERASE
 19910*        CURSOR
 19911*    END-EXEC.
 19912     MOVE LENGTH OF
 19913      EL156AI
 19914       TO DFHEIV12
 19915     MOVE -1
 19916       TO DFHEIV11
 19917*    MOVE '8$     CT  E    H L F ,   #00017734' TO DFHEIV0
 19918     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19919     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19920     MOVE X'2020233030303137373334' TO DFHEIV0(25:11)
 19921     CALL 'kxdfhei1' USING DFHEIV0,
 19922           MAP-NAME,
 19923           EL156AI,
 19924           DFHEIV12,
 19925           MAPSET-NAME,
 19926           DFHEIV99,
 19927           DFHEIV99,
 19928           DFHEIV99,
 19929           DFHEIV11,
 19930           DFHEIV99,
 19931           DFHEIV99,
 19932           DFHEIV99
 19933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19934
 19935
 19936     GO TO 9100-RETURN-TRAN.
 19937
 19938 8200-SEND-DATAONLY.
 19939
 19940     IF FIRST-ENTRY = 'Y'
 19941         GO TO 8100-SEND-INITIAL-MAP.
 19942
 19943     IF RETURNED-FROM-B = 'Y'
 19944         GO TO 8100-SEND-INITIAL-MAP.
 19945
 19946     MOVE SAVE-DATE              TO RUNDTEAO.
 19947     MOVE EIBTIME                TO TIME-IN.
 19948     MOVE TIME-OUT               TO RUNTIMAO.
 19949
 19950     IF EIBAID = DFHPF11
 19951        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19952        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19953        MOVE 'EL001   '          TO RETURNED-FROM
 19954        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19955        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19956        GO TO 8100-SEND-INITIAL-MAP.
 19957
 19958     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 381
* EL156.cbl
 19959
 19960     IF MAP-NAME =  'EL156A'
 19961        MOVE -1                 TO  ENTERPFL
 19962        IF PI-USES-PAID-TO
 19963           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19964           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19965           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19966        ELSE
 19967           NEXT SENTENCE
 19968     ELSE
 19969        IF MAP-NAME = 'EL156B'
 19970           IF PI-USES-PAID-TO
 19971              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19972              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19973
 19974     IF MAP-NAME =  'EL156A'
 19975        IF PI-COMPANY-ID = 'BOA'
 19976            IF PI-INT-RATE NUMERIC
 19977                MOVE PI-INT-RATE TO PINTO.
 19978     IF MAP-NAME = 'EL156A'
 19979        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19980           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19981*          MOVE 'Y'              TO EOBYNO
 19982        END-IF
 19983     END-IF
 19984
 19985
 19986* EXEC CICS SEND
 19987*        MAP   (MAP-NAME)
 19988*        MAPSET(MAPSET-NAME)
 19989*        FROM  (EL156AI)
 19990*        DATAONLY
 19991*        CURSOR
 19992*    END-EXEC.
 19993     MOVE LENGTH OF
 19994      EL156AI
 19995       TO DFHEIV12
 19996     MOVE -1
 19997       TO DFHEIV11
 19998*    MOVE '8$D    CT       H L F ,   #00017791' TO DFHEIV0
 19999     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20000     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20001     MOVE X'2020233030303137373931' TO DFHEIV0(25:11)
 20002     CALL 'kxdfhei1' USING DFHEIV0,
 20003           MAP-NAME,
 20004           EL156AI,
 20005           DFHEIV12,
 20006           MAPSET-NAME,
 20007           DFHEIV99,
 20008           DFHEIV99,
 20009           DFHEIV99,
 20010           DFHEIV11,
 20011           DFHEIV99,
 20012           DFHEIV99,
 20013           DFHEIV99
 20014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20015
 20016
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 382
* EL156.cbl
 20017     GO TO 9100-RETURN-TRAN.
 20018
 20019 8300-SEND-TEXT.
 20020
 20021* EXEC CICS SEND TEXT
 20022*        FROM(LOGOFF-TEXT)
 20023*        LENGTH(LOGOFF-LENGTH)
 20024*        ERASE
 20025*        FREEKB
 20026*    END-EXEC.
 20027*    MOVE '8&      T  E F  H   F -   #00017802' TO DFHEIV0
 20028     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20029     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20030     MOVE X'2020233030303137383032' TO DFHEIV0(25:11)
 20031     CALL 'kxdfhei1' USING DFHEIV0,
 20032           LOGOFF-TEXT,
 20033           LOGOFF-LENGTH,
 20034           DFHEIV99,
 20035           DFHEIV99,
 20036           DFHEIV99,
 20037           DFHEIV99,
 20038           DFHEIV99,
 20039           DFHEIV99,
 20040           DFHEIV99,
 20041           DFHEIV99,
 20042           DFHEIV99,
 20043           DFHEIV99
 20044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20045
 20046
 20047
 20048* EXEC CICS RETURN
 20049*    END-EXEC.
 20050*    MOVE '.(                    ''   #00017809' TO DFHEIV0
 20051     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20052     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20053     MOVE X'2020233030303137383039' TO DFHEIV0(25:11)
 20054     CALL 'kxdfhei1' USING DFHEIV0,
 20055           DFHEIV99,
 20056           DFHEIV99,
 20057           DFHEIV99,
 20058           DFHEIV99,
 20059           DFHEIV99,
 20060           DFHEIV99
 20061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20062
 20063
 20064 8500-FILE-NOTOPEN.
 20065     IF FILE-SWITCH = 'MSTR'
 20066         MOVE ER-0154            TO EMI-ERROR.
 20067     IF FILE-SWITCH = 'TRLR'
 20068         MOVE ER-0172            TO EMI-ERROR.
 20069     IF FILE-SWITCH = 'CERT'
 20070         MOVE ER-0169            TO EMI-ERROR.
 20071     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20072                      'PROC' OR 'STAT'
 20073         MOVE ER-0042            TO EMI-ERROR.
 20074     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 383
* EL156.cbl
 20075         MOVE ER-0338            TO EMI-ERROR.
 20076     IF FILE-SWITCH = 'ACCT'
 20077         MOVE ER-0168            TO EMI-ERROR.
 20078
 20079     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20080     MOVE -1                     TO PMTTYPEL.
 20081
 20082     IF FIRST-ENTRY = 'Y'
 20083         GO TO 8100-SEND-INITIAL-MAP.
 20084
 20085     GO TO 8200-SEND-DATAONLY.
 20086
 20087 8600-PGRM-NOT-FOUND.
 20088
 20089     MOVE ER-0923                TO EMI-ERROR.
 20090     MOVE -1                     TO ENTPFBL.
 20091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20092
 20093     IF FIRST-ENTRY = 'Y'
 20094         GO TO 8100-SEND-INITIAL-MAP
 20095     ELSE
 20096         GO TO 8200-SEND-DATAONLY.
 20097
 20098 8800-UNAUTHORIZED-ACCESS.
 20099     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20100     GO TO 8300-SEND-TEXT.
 20101
 20102 8810-PF23.
 20103     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20104     MOVE XCTL-005               TO PGM-NAME.
 20105     GO TO 9300-XCTL.
 20106
 20107 8820-PF7-8.
 20108     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20109     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20110                                    PI-SAVED-PROGRAM-2
 20111                                    PI-SAVED-PROGRAM-3
 20112                                    PI-SAVED-PROGRAM-4
 20113                                    PI-SAVED-PROGRAM-5
 20114                                    PI-SAVED-PROGRAM-6
 20115                                    PI-RETURN-TO-PROGRAM.
 20116     IF EIBAID = DFHPF8
 20117        MOVE XCTL-132            TO PGM-NAME
 20118     ELSE
 20119        MOVE XCTL-130            TO PGM-NAME.
 20120
 20121     GO TO 9300-XCTL.
 20122
 20123 9100-RETURN-TRAN.
 20124     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20125     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20126
 20127
 20128* EXEC CICS RETURN
 20129*        TRANSID(TRANS-ID)
 20130*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20131*        LENGTH(PI-COMM-LENGTH)
 20132*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 384
* EL156.cbl
 20133*    MOVE '.(CT                  ''   #00017875' TO DFHEIV0
 20134     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20135     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20136     MOVE X'2020233030303137383735' TO DFHEIV0(25:11)
 20137     CALL 'kxdfhei1' USING DFHEIV0,
 20138           TRANS-ID,
 20139           PROGRAM-INTERFACE-BLOCK,
 20140           PI-COMM-LENGTH,
 20141           DFHEIV99,
 20142           DFHEIV99,
 20143           DFHEIV99
 20144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20145
 20146
 20147 9200-RETURN-MAIN-MENU.
 20148     MOVE XCTL-126               TO PGM-NAME.
 20149     GO TO 9300-XCTL.
 20150
 20151 9300-XCTL.
 20152
 20153* EXEC CICS XCTL
 20154*        PROGRAM(PGM-NAME)
 20155*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20156*        LENGTH(PI-COMM-LENGTH)
 20157*    END-EXEC.
 20158*    MOVE '.$C                   %   #00017886' TO DFHEIV0
 20159     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20160     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20161     MOVE X'2020233030303137383836' TO DFHEIV0(25:11)
 20162     CALL 'kxdfhei1' USING DFHEIV0,
 20163           PGM-NAME,
 20164           PROGRAM-INTERFACE-BLOCK,
 20165           PI-COMM-LENGTH,
 20166           DFHEIV99
 20167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20168
 20169
 20170 9400-CLEAR.
 20171     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20172     GO TO 9300-XCTL.
 20173
 20174 9500-PF12.
 20175     MOVE XCTL-010               TO PGM-NAME.
 20176     GO TO 9300-XCTL.
 20177
 20178 9700-LINK-DATE-CONVERT.
 20179     MOVE LINK-ELDATCV           TO PGM-NAME.
 20180
 20181* EXEC CICS LINK
 20182*        PROGRAM   (PGM-NAME)
 20183*        COMMAREA  (DATE-CONVERSION-DATA)
 20184*        LENGTH    (DC-COMM-LENGTH)
 20185*    END-EXEC.
 20186*    MOVE '."C                   (   #00017902' TO DFHEIV0
 20187     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20188     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20189     MOVE X'2020233030303137393032' TO DFHEIV0(25:11)
 20190     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 385
* EL156.cbl
 20191           PGM-NAME,
 20192           DATE-CONVERSION-DATA,
 20193           DC-COMM-LENGTH,
 20194           DFHEIV99,
 20195           DFHEIV99,
 20196           DFHEIV99,
 20197           DFHEIV99
 20198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20199
 20200
 20201 9700-EXIT.
 20202     EXIT.
 20203
 20204 9800-LINK-REM-TERM.
 20205     MOVE LINK-REMTERM TO PGM-NAME.
 20206
 20207
 20208* EXEC CICS LINK
 20209*        PROGRAM   (PGM-NAME)
 20210*        COMMAREA  (CALCULATION-PASS-AREA)
 20211*        LENGTH    (CP-COMM-LENGTH)
 20212*    END-EXEC.
 20213*    MOVE '."C                   (   #00017914' TO DFHEIV0
 20214     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20215     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20216     MOVE X'2020233030303137393134' TO DFHEIV0(25:11)
 20217     CALL 'kxdfhei1' USING DFHEIV0,
 20218           PGM-NAME,
 20219           CALCULATION-PASS-AREA,
 20220           CP-COMM-LENGTH,
 20221           DFHEIV99,
 20222           DFHEIV99,
 20223           DFHEIV99,
 20224           DFHEIV99
 20225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20226
 20227
 20228 9800-EXIT.
 20229     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 386
* EL156.cbl
 20231 9830-DMD-REMAINING-TERM.
 20232
 20233     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20234         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20235
 20236     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20237                              CM-PMT-EXTENSION-DAYS.
 20238
 20239     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20240                                  CL-NO-OF-DAYS-PAID.
 20241
 20242     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20243         GIVING W-REM REMAINDER W-REM-DAYS.
 20244
 20245     MOVE W-REM                  TO WST-REM.
 20246
 20247     IF W-REM-DAYS > ZEROS
 20248         MOVE '/'                TO WST-SLASH
 20249         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20250     ELSE
 20251         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20252
 20253 9830-EXIT.
 20254     EXIT.
 20255
 20256 9870-OUTPUT-ACTIVITY-RECORD.
 20257
 20258
 20259* EXEC CICS GETMAIN
 20260*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20261*         LENGTH(25)
 20262*         INITIMG(WS-BLANK)
 20263*    END-EXEC.
 20264     MOVE 25
 20265       TO DFHEIV11
 20266*    MOVE ',"IL                  $   #00017950' TO DFHEIV0
 20267     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20268     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20269     MOVE X'2020233030303137393530' TO DFHEIV0(25:11)
 20270     CALL 'kxdfhei1' USING DFHEIV0,
 20271           DFHEIV20,
 20272           DFHEIV11,
 20273           WS-BLANK
 20274     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20275         DFHEIV20
 20276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20277
 20278
 20279     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20280     MOVE ELMSTR-KEY             TO DA-KEY.
 20281     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20282
 20283     IF PI-PMTTYPE EQUAL '7'
 20284         MOVE 'V'                TO DA-RECORD-TYPE
 20285     ELSE
 20286         MOVE 'P'                TO DA-RECORD-TYPE.
 20287
 20288
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 387
* EL156.cbl
 20289* EXEC CICS HANDLE CONDITION
 20290*         NOTOPEN(9870-NOTOPEN)
 20291*         DUPREC(9870-EXIT)
 20292*    END-EXEC.
 20293*    MOVE '"$J%                  ! B #00017965' TO DFHEIV0
 20294     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20295     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20296     MOVE X'4220233030303137393635' TO DFHEIV0(25:11)
 20297     CALL 'kxdfhei1' USING DFHEIV0
 20298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20299
 20300
 20301
 20302* EXEC CICS WRITE
 20303*         DATASET('DLYACTV')
 20304*         RIDFLD(DA-KEY)
 20305*         FROM(DAILY-ACTIVITY-RECORD)
 20306*         LENGTH(25)
 20307*    END-EXEC.
 20308     MOVE 'DLYACTV' TO DFHEIV1
 20309     MOVE 25
 20310       TO DFHEIV11
 20311*    MOVE '&$ L                  ''   #00017970' TO DFHEIV0
 20312     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20313     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20314     MOVE X'2020233030303137393730' TO DFHEIV0(25:11)
 20315     CALL 'kxdfhei1' USING DFHEIV0,
 20316           DFHEIV1,
 20317           DAILY-ACTIVITY-RECORD,
 20318           DFHEIV11,
 20319           DA-KEY,
 20320           DFHEIV99,
 20321           DFHEIV99
 20322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20323
 20324     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20325     GO TO 9870-EXIT.
 20326
 20327 9870-NOTOPEN.
 20328
 20329     MOVE '2955'                 TO EMI-ERROR.
 20330     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20331
 20332 9870-EXIT.
 20333     EXIT.
 20334
 20335 9900-ERROR-FORMAT.
 20336
 20337     IF EMI-ERROR = ER-0923
 20338         MOVE PGM-NAME           TO W-CALLED-NAME.
 20339
 20340     MOVE LINK-001      TO PGM-NAME.
 20341     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20342
 20343
 20344* EXEC CICS LINK
 20345*        PROGRAM (PGM-NAME)
 20346*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 388
* EL156.cbl
 20347*        LENGTH  (EMI-COMM-LENGTH)
 20348*    END-EXEC.
 20349*    MOVE '."C                   (   #00017995' TO DFHEIV0
 20350     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20351     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20352     MOVE X'2020233030303137393935' TO DFHEIV0(25:11)
 20353     CALL 'kxdfhei1' USING DFHEIV0,
 20354           PGM-NAME,
 20355           ERROR-MESSAGE-INTERFACE-BLOCK,
 20356           EMI-COMM-LENGTH,
 20357           DFHEIV99,
 20358           DFHEIV99,
 20359           DFHEIV99,
 20360           DFHEIV99
 20361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20362
 20363
 20364     IF EMI-ERROR = ER-0923
 20365         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20366
 20367 9900-EXIT.
 20368     EXIT.
 20369
 20370 9990-ABEND.
 20371     MOVE LINK-004               TO PGM-NAME.
 20372     MOVE DFHEIBLK               TO EMI-LINE1.
 20373
 20374* EXEC CICS LINK
 20375*        PROGRAM   (PGM-NAME)
 20376*        COMMAREA  (EMI-LINE1)
 20377*        LENGTH    (64)
 20378*    END-EXEC.
 20379     MOVE 64
 20380       TO DFHEIV11
 20381*    MOVE '."C                   (   #00018010' TO DFHEIV0
 20382     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20384     MOVE X'2020233030303138303130' TO DFHEIV0(25:11)
 20385     CALL 'kxdfhei1' USING DFHEIV0,
 20386           PGM-NAME,
 20387           EMI-LINE1,
 20388           DFHEIV11,
 20389           DFHEIV99,
 20390           DFHEIV99,
 20391           DFHEIV99,
 20392           DFHEIV99
 20393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20394
 20395
 20396     MOVE 'EL156A'               TO  MAP-NAME.
 20397     MOVE LOW-VALUES             TO  EL156AO.
 20398     GO TO 8100-SEND-INITIAL-MAP.
 20399
 20400 9995-SECURITY-VIOLATION.
 20401*    COPY ELCSCTP.
 20402******************************************************************
 20403*                                                                *
 20404*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 389
* EL156.cbl
 20405*                            VMOD=2.001                          *
 20406*                                                                *
 20407*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20408******************************************************************
 20409
 20410
 20411     MOVE EIBDATE          TO SM-JUL-DATE.
 20412     MOVE EIBTRMID         TO SM-TERMID.
 20413     MOVE THIS-PGM         TO SM-PGM.
 20414     MOVE EIBTIME          TO TIME-IN.
 20415     MOVE TIME-OUT         TO SM-TIME.
 20416     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20417
 20418
 20419* EXEC CICS LINK
 20420*         PROGRAM  ('EL003')
 20421*         COMMAREA (SECURITY-MESSAGE)
 20422*         LENGTH   (80)
 20423*    END-EXEC.
 20424     MOVE 'EL003' TO DFHEIV1
 20425     MOVE 80
 20426       TO DFHEIV11
 20427*    MOVE '."C                   (   #00018038' TO DFHEIV0
 20428     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20430     MOVE X'2020233030303138303338' TO DFHEIV0(25:11)
 20431     CALL 'kxdfhei1' USING DFHEIV0,
 20432           DFHEIV1,
 20433           SECURITY-MESSAGE,
 20434           DFHEIV11,
 20435           DFHEIV99,
 20436           DFHEIV99,
 20437           DFHEIV99,
 20438           DFHEIV99
 20439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20440
 20441
 20442******************************************************************
 20443
 20444
 20445
 20446 9999-DFHBACK SECTION.
 20447     MOVE '9%                    "   ' TO DFHEIV0
 20448     MOVE 'EL156' TO DFHEIV1
 20449     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20450     GOBACK.
 20451 9999-DFHEXIT.
 20452     IF DFHEIGDJ EQUAL 0001
 20453         NEXT SENTENCE
 20454     ELSE IF DFHEIGDJ EQUAL 2
 20455         GO TO 9990-ABEND,
 20456               8600-PGRM-NOT-FOUND,
 20457               0400-FIRST-TIME,
 20458               6180-DUPREC,
 20459               9990-ABEND
 20460         DEPENDING ON DFHEIGDI
 20461     ELSE IF DFHEIGDJ EQUAL 3
 20462         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 390
* EL156.cbl
 20463               0380-CLAIM-END-FILE
 20464         DEPENDING ON DFHEIGDI
 20465     ELSE IF DFHEIGDJ EQUAL 4
 20466         GO TO 0380-CLAIM-END-FILE,
 20467               0380-CLAIM-END-FILE
 20468         DEPENDING ON DFHEIGDI
 20469     ELSE IF DFHEIGDJ EQUAL 5
 20470         GO TO 0800-EXIT
 20471         DEPENDING ON DFHEIGDI
 20472     ELSE IF DFHEIGDJ EQUAL 6
 20473         GO TO 1950-NOT-FOUND,
 20474               1950-NOT-FOUND
 20475         DEPENDING ON DFHEIGDI
 20476     ELSE IF DFHEIGDJ EQUAL 7
 20477         GO TO 1950-NOT-FOUND
 20478         DEPENDING ON DFHEIGDI
 20479     ELSE IF DFHEIGDJ EQUAL 8
 20480         GO TO 1950-NOT-FOUND,
 20481               1950-NOT-FOUND
 20482         DEPENDING ON DFHEIGDI
 20483     ELSE IF DFHEIGDJ EQUAL 9
 20484         GO TO 1166-END-CHECK,
 20485               1166-END-CHECK
 20486         DEPENDING ON DFHEIGDI
 20487     ELSE IF DFHEIGDJ EQUAL 10
 20488         GO TO 1950-NOT-FOUND,
 20489               1950-NOT-FOUND
 20490         DEPENDING ON DFHEIGDI
 20491     ELSE IF DFHEIGDJ EQUAL 11
 20492         GO TO 1950-NOT-FOUND,
 20493               1950-NOT-FOUND
 20494         DEPENDING ON DFHEIGDI
 20495     ELSE IF DFHEIGDJ EQUAL 12
 20496         GO TO 1950-NOT-FOUND
 20497         DEPENDING ON DFHEIGDI
 20498     ELSE IF DFHEIGDJ EQUAL 13
 20499         GO TO 3600-CONTINUE
 20500         DEPENDING ON DFHEIGDI
 20501     ELSE IF DFHEIGDJ EQUAL 14
 20502         GO TO 5300-NOTE-NOT-FOUND
 20503         DEPENDING ON DFHEIGDI
 20504     ELSE IF DFHEIGDJ EQUAL 15
 20505         GO TO 6065-NOT-FOUND
 20506         DEPENDING ON DFHEIGDI
 20507     ELSE IF DFHEIGDJ EQUAL 16
 20508         GO TO 6068-ACCT-NOT-FND
 20509         DEPENDING ON DFHEIGDI
 20510     ELSE IF DFHEIGDJ EQUAL 17
 20511         GO TO 6074-GET-COMP-DATA
 20512         DEPENDING ON DFHEIGDI
 20513     ELSE IF DFHEIGDJ EQUAL 18
 20514         GO TO 6170-WRITE
 20515         DEPENDING ON DFHEIGDI
 20516     ELSE IF DFHEIGDJ EQUAL 19
 20517         GO TO 6180-DUPREC
 20518         DEPENDING ON DFHEIGDI
 20519     ELSE IF DFHEIGDJ EQUAL 20
 20520         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 18-Aug-17 10:18 Page 391
* EL156.cbl
 20521         DEPENDING ON DFHEIGDI
 20522     ELSE IF DFHEIGDJ EQUAL 21
 20523         GO TO 6185-DUPREC
 20524         DEPENDING ON DFHEIGDI
 20525     ELSE IF DFHEIGDJ EQUAL 22
 20526         GO TO 6720-BUILD-NEW-RECORD
 20527         DEPENDING ON DFHEIGDI
 20528     ELSE IF DFHEIGDJ EQUAL 23
 20529         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20530               6900-BUILD-ARCHIVE-HEADER
 20531         DEPENDING ON DFHEIGDI
 20532     ELSE IF DFHEIGDJ EQUAL 24
 20533         GO TO 7010-BUILD-MAP
 20534         DEPENDING ON DFHEIGDI
 20535     ELSE IF DFHEIGDJ EQUAL 25
 20536         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20537         DEPENDING ON DFHEIGDI
 20538     ELSE IF DFHEIGDJ EQUAL 26
 20539         GO TO 7160-DUPREC
 20540         DEPENDING ON DFHEIGDI
 20541     ELSE IF DFHEIGDJ EQUAL 27
 20542         GO TO 7200-EXIT,
 20543               7200-EXIT
 20544         DEPENDING ON DFHEIGDI
 20545     ELSE IF DFHEIGDJ EQUAL 28
 20546         GO TO 7400-NOT-FOUND
 20547         DEPENDING ON DFHEIGDI
 20548     ELSE IF DFHEIGDJ EQUAL 29
 20549         GO TO 7590-END,
 20550               7590-END
 20551         DEPENDING ON DFHEIGDI
 20552     ELSE IF DFHEIGDJ EQUAL 30
 20553         GO TO 7699-EXIT
 20554         DEPENDING ON DFHEIGDI
 20555     ELSE IF DFHEIGDJ EQUAL 31
 20556         GO TO 5300-NOTE-NOT-FOUND
 20557         DEPENDING ON DFHEIGDI
 20558     ELSE IF DFHEIGDJ EQUAL 32
 20559         GO TO 7800-COMP-NOTFND
 20560         DEPENDING ON DFHEIGDI
 20561     ELSE IF DFHEIGDJ EQUAL 33
 20562         GO TO 7920-NOT-FOUND
 20563         DEPENDING ON DFHEIGDI
 20564     ELSE IF DFHEIGDJ EQUAL 34
 20565         GO TO 9870-NOTOPEN,
 20566               9870-EXIT
 20567         DEPENDING ON DFHEIGDI.
 20568     MOVE '9%                    "   ' TO DFHEIV0
 20569     MOVE 'EL156' TO DFHEIV1
 20570     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20571     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12764     Code:       76504
