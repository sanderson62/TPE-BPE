* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   1
* ELRATE.cbl
* Options: int("ELRATE.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRATE.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATE.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   2
* ELRATE.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   193******************************************************************
   194
   195 01  NET-PAY-WORK-AREA.
   196     12  OPTION-SW               PIC X   VALUE 'X'.
   197        88  NPO-STD         VALUE SPACE.
   198        88  NPO-ALT         VALUE 'A'.
   199        88  NPO-SIMPLE      VALUE 'S'.
   200        88  NPO-2MO         VALUE 'I'.
   201        88  NPO-3MO         VALUE 'J'.
   202        88  NPO-4MO         VALUE 'K'.
   203        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   204        88  NPO-TRUNC-0     VALUE 'T'.
   205        88  NPO-TRUNC-1     VALUE 'U'.
   206        88  NPO-TRUNC-2     VALUE 'V'.
   207        88  NPO-TRUNC-3     VALUE 'W'.
   208        88  NPO-TRUNC-4     VALUE 'X'.
   209        88  NPO-REFUND      VALUE 'R'.
   210        88  NPO-PRUDENTIAL  VALUE 'P'.
   211
   212     12  TYPE-SW             PIC X   VALUE 'N'.
   213        88  NET-STD             VALUE 'N'.
   214        88  NET-SMP             VALUE 'S'.
   215
   216     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   217        88  NP-RATING           VALUE '1'.
   218        88  NP-REFUND           VALUE '2'.
   219        88  NP-REMAIN-AMT       VALUE '3'.
   220
   221     12  COMP-3-WORK-AREA         COMP-3.
   222         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   223         16  V               PIC SV9(13)       VALUE +.0.
   224         16  J               PIC SV9(9)        VALUE +0.
   225         16  K               PIC SV9(9)        VALUE +0.
   226         16  I               PIC SV9(10)       VALUE +.0.
   227         16  D               PIC S9(5)         VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   6
* ELRATE.cbl
   228         16  APR100          PIC SV9(9)        VALUE +.0.
   229         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   230         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   232         16  pema            pic s9(2)v9(15)   value +0.
   233         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   234         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   235         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   236         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   237         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   238         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   239         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   240         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   241         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   242         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   243         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   244         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   246         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   247         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   248         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   251         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   252         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.
   253         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   254         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.
   255         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.
   256         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   257         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   258         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.
   259         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   260         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.
   261         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   262         16  K1              PIC S999          VALUE +1.
   263         16  K12             PIC S999          VALUE +12.
   264         16  K100            PIC S999          VALUE +100.
   265         16  K1000           PIC S9(7)         VALUE +1000.
   266         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   267         16  Y REDEFINES NC-LR
   268                             PIC S99V9(5).
   269         16  TI              PIC S999V9(5)     VALUE +0.
   270         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   271         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   272         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   273         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   274         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   275         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   276         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   277         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   278
   279         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   280         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   281         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   282         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   283         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   284         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   285         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   7
* ELRATE.cbl
   286         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   287         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   288         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   289         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   290         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   291         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   292
   293         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   294
   295         16  ORIGINAL-TERM   PIC S999.
   296         16  M              REDEFINES ORIGINAL-TERM
   297                             PIC S999.
   298
   299         16  REMAINING-TERM  PIC S999.
   300         16  R              REDEFINES REMAINING-TERM
   301                             PIC S999.
   302
   303         16  LOAN-TERM       PIC S999.
   304         16  N              REDEFINES LOAN-TERM
   305                             PIC S999.
   306
   307         16  EXPIRED-TERM    PIC S999.
   308         16  E              REDEFINES EXPIRED-TERM
   309                             PIC S999.
   310
   311         16  PRUDENTIAL-WORK-AMT
   312                             PIC S9(7)V9(8).
   313         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   314                             PIC S9(7)V9(8).
   315
   316         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   317         16  VX              PIC S9V9(13)      VALUE +0.0.
   318         16  SV              PIC S9V9(13)      VALUE +0.0.
   319         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   320         16  SX              PIC S9V9(13)      VALUE +0.0.
   321         16  SE              PIC S9V9(10)      VALUE +0.0.
   322         16  N2              PIC S9(7)         VALUE +0.
   323         16  N3              PIC S9(7)         VALUE +0.
   324         16  K-I             PIC S9V9(8)       VALUE +0.0.
   325
   326     12  BINARY-WORK-AREA        COMP.
   327         16  X1              PIC S999        VALUE +0.
   328         16  X2              PIC S999        VALUE +0.
   329         16  MAX-X           PIC S9(5)       VALUE +0.
   330         16  B1              PIC S9(5)       VALUE +1.
   331         16  LINDX           PIC S999        VALUE ZEROS.
   332         16  AHNDX           PIC S999        VALUE ZEROS.
   333
   334     12  CSO-RATE-WORK-AREAS.
   335         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   336         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   337         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   338     12  WS-WORK-MISC.
   339         16  ws-extra-pmts       pic s999         comp-3.
   340         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   341         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   342*        16  WS-AGE              PIC 99           VALUE ZEROS.
   343         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   8
* ELRATE.cbl
   344         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   345         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   346         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   347         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   348         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   349         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   350         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   351         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   352         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   353         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   354         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   355******************************************************************
   356
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page   9
* ELRATE.cbl
   358*                            COPY ELCDATE.
   359******************************************************************
   360*                                                                *
   361*                                                                *
   362*                            ELCDATE.                            *
   363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   364*                            VMOD=2.003
   365*                                                                *
   366*                                                                *
   367*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   368*                 LENGTH = 200                                   *
   369******************************************************************
   370
   371 01  DATE-CONVERSION-DATA.
   372     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   373     12  DC-OPTION-CODE                PIC X.
   374         88  BIN-TO-GREG                VALUE ' '.
   375         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   376         88  EDIT-GREG-TO-BIN           VALUE '2'.
   377         88  YMD-GREG-TO-BIN            VALUE '3'.
   378         88  MDY-GREG-TO-BIN            VALUE '4'.
   379         88  JULIAN-TO-BIN              VALUE '5'.
   380         88  BIN-PLUS-ELAPSED           VALUE '6'.
   381         88  FIND-CENTURY               VALUE '7'.
   382         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   383         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   384         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   385         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   386         88  JULIAN-TO-BIN-3            VALUE 'C'.
   387         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   388         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   389         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   390         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   391         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   392         88  CHECK-LEAP-YEAR            VALUE 'H'.
   393         88  BIN-3-TO-GREG              VALUE 'I'.
   394         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   395         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   396         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   397         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   398         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   399         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   400         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   401         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   402         88  THREE-CHARACTER-BIN
   403                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   404         88  GREGORIAN-TO-BIN
   405                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   406         88  BIN-TO-GREGORIAN
   407                  VALUES ' ' '1' 'I' '8' 'G'.
   408         88  JULIAN-TO-BINARY
   409                  VALUES '5' 'C' 'E' 'F'.
   410     12  DC-ERROR-CODE                 PIC X.
   411         88  NO-CONVERSION-ERROR        VALUE ' '.
   412         88  DATE-CONVERSION-ERROR
   413                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   414         88  DATE-IS-ZERO               VALUE '1'.
   415         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  10
* ELRATE.cbl
   416         88  DATE-IS-INVALID            VALUE '3'.
   417         88  DATE1-GREATER-DATE2        VALUE '4'.
   418         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   419         88  DATE-INVALID-OPTION        VALUE '9'.
   420         88  INVALID-CENTURY            VALUE 'A'.
   421         88  ONLY-CENTURY               VALUE 'B'.
   422         88  ONLY-LEAP-YEAR             VALUE 'C'.
   423         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   424     12  DC-END-OF-MONTH               PIC X.
   425         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   426     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   427         88  USE-NORMAL-PROCESS         VALUE ' '.
   428         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   429         88  ADJUST-UP-100-YRS          VALUE '2'.
   430     12  FILLER                        PIC X.
   431     12  DC-CONVERSION-DATES.
   432         16  DC-BIN-DATE-1             PIC XX.
   433         16  DC-BIN-DATE-2             PIC XX.
   434         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   435         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   436                       DC-GREG-DATE-1-EDIT.
   437             20  DC-EDIT1-MONTH        PIC 99.
   438             20  SLASH1-1              PIC X.
   439             20  DC-EDIT1-DAY          PIC 99.
   440             20  SLASH1-2              PIC X.
   441             20  DC-EDIT1-YEAR         PIC 99.
   442         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   443         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   444                     DC-GREG-DATE-2-EDIT.
   445             20  DC-EDIT2-MONTH        PIC 99.
   446             20  SLASH2-1              PIC X.
   447             20  DC-EDIT2-DAY          PIC 99.
   448             20  SLASH2-2              PIC X.
   449             20  DC-EDIT2-YEAR         PIC 99.
   450         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   451         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   452                     DC-GREG-DATE-1-YMD.
   453             20  DC-YMD-YEAR           PIC 99.
   454             20  DC-YMD-MONTH          PIC 99.
   455             20  DC-YMD-DAY            PIC 99.
   456         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   457         16  DC-GREG-DATE-1-MDY-R REDEFINES
   458                      DC-GREG-DATE-1-MDY.
   459             20  DC-MDY-MONTH          PIC 99.
   460             20  DC-MDY-DAY            PIC 99.
   461             20  DC-MDY-YEAR           PIC 99.
   462         16  DC-GREG-DATE-1-ALPHA.
   463             20  DC-ALPHA-MONTH        PIC X(10).
   464             20  DC-ALPHA-DAY          PIC 99.
   465             20  FILLER                PIC XX.
   466             20  DC-ALPHA-CENTURY.
   467                 24 DC-ALPHA-CEN-N     PIC 99.
   468             20  DC-ALPHA-YEAR         PIC 99.
   469         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   470         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   471         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   472         16  DC-JULIAN-DATE            PIC 9(05).
   473         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  11
* ELRATE.cbl
   474                                       PIC 9(05).
   475         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   476             20  DC-JULIAN-YEAR        PIC 99.
   477             20  DC-JULIAN-DAYS        PIC 999.
   478         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   479         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   480         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   481     12  DATE-CONVERSION-VARIBLES.
   482         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   483         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   484             20  FILLER                PIC 9(3).
   485             20  HOLD-CEN-1-CCYY.
   486                 24  HOLD-CEN-1-CC     PIC 99.
   487                 24  HOLD-CEN-1-YY     PIC 99.
   488             20  HOLD-CEN-1-MO         PIC 99.
   489             20  HOLD-CEN-1-DA         PIC 99.
   490         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   491             20  HOLD-CEN-1-R-MO       PIC 99.
   492             20  HOLD-CEN-1-R-DA       PIC 99.
   493             20  HOLD-CEN-1-R-CCYY.
   494                 24  HOLD-CEN-1-R-CC   PIC 99.
   495                 24  HOLD-CEN-1-R-YY   PIC 99.
   496             20  FILLER                PIC 9(3).
   497         16  HOLD-CENTURY-1-X.
   498             20  FILLER                PIC X(3)  VALUE SPACES.
   499             20  HOLD-CEN-1-X-CCYY.
   500                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   501                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   502             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   503             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   504         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   505             20  HOLD-CEN-1-R-X-MO     PIC XX.
   506             20  HOLD-CEN-1-R-X-DA     PIC XX.
   507             20  HOLD-CEN-1-R-X-CCYY.
   508                 24  HOLD-CEN-1-R-X-CC PIC XX.
   509                 24  HOLD-CEN-1-R-X-YY PIC XX.
   510             20  FILLER                PIC XXX.
   511         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   512         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   513         16  DC-JULIAN-DATE-1          PIC 9(07).
   514         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   515             20  DC-JULIAN-1-CCYY.
   516                 24  DC-JULIAN-1-CC    PIC 99.
   517                 24  DC-JULIAN-1-YR    PIC 99.
   518             20  DC-JULIAN-DA-1        PIC 999.
   519         16  DC-JULIAN-DATE-2          PIC 9(07).
   520         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   521             20  DC-JULIAN-2-CCYY.
   522                 24  DC-JULIAN-2-CC    PIC 99.
   523                 24  DC-JULIAN-2-YR    PIC 99.
   524             20  DC-JULIAN-DA-2        PIC 999.
   525         16  DC-GREG-DATE-A-EDIT.
   526             20  DC-EDITA-MONTH        PIC 99.
   527             20  SLASHA-1              PIC X VALUE '/'.
   528             20  DC-EDITA-DAY          PIC 99.
   529             20  SLASHA-2              PIC X VALUE '/'.
   530             20  DC-EDITA-CCYY.
   531                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  12
* ELRATE.cbl
   532                 24  DC-EDITA-YEAR     PIC 99.
   533         16  DC-GREG-DATE-B-EDIT.
   534             20  DC-EDITB-MONTH        PIC 99.
   535             20  SLASHB-1              PIC X VALUE '/'.
   536             20  DC-EDITB-DAY          PIC 99.
   537             20  SLASHB-2              PIC X VALUE '/'.
   538             20  DC-EDITB-CCYY.
   539                 24  DC-EDITB-CENT     PIC 99.
   540                 24  DC-EDITB-YEAR     PIC 99.
   541         16  DC-GREG-DATE-CYMD         PIC 9(08).
   542         16  DC-GREG-DATE-CYMD-R REDEFINES
   543                              DC-GREG-DATE-CYMD.
   544             20  DC-CYMD-CEN           PIC 99.
   545             20  DC-CYMD-YEAR          PIC 99.
   546             20  DC-CYMD-MONTH         PIC 99.
   547             20  DC-CYMD-DAY           PIC 99.
   548         16  DC-GREG-DATE-MDCY         PIC 9(08).
   549         16  DC-GREG-DATE-MDCY-R REDEFINES
   550                              DC-GREG-DATE-MDCY.
   551             20  DC-MDCY-MONTH         PIC 99.
   552             20  DC-MDCY-DAY           PIC 99.
   553             20  DC-MDCY-CEN           PIC 99.
   554             20  DC-MDCY-YEAR          PIC 99.
   555    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   556        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   557    12  DC-EL310-DATE                  PIC X(21).
   558    12  FILLER                         PIC X(28).
   559
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  13
* ELRATE.cbl
   561*                            COPY ELCCALC.
   562******************************************************************
   563*                                                                *
   564*                           ELCCALC.                            *
   565*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   566*                            VMOD=2.025                          *
   567*                                                                *
   568*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   569*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   570*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   571*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   572*                                                                *
   573*  PASSED TO ELRTRM                                              *
   574*  -----------------                                             *
   575*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   576*  ORIGINAL TERM                                                 *
   577*  BEGINNING DATE                                                *
   578*  ENDING DATE                                                   *
   579*  COMPANY I.D.                                                  *
   580*  ACCOUNT MASTER USER FIELD                                     *
   581*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   582*  FREE LOOK DAYS                                                *
   583*                                                                *
   584*  RETURNED FROM ELRTRM                                          *
   585*  ---------------------                                         *
   586*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   587*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   588*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   589*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   590*----------------------------------------------------------------*
   591*  PASSED TO ELRAMT                                              *
   592*  ----------------                                              *
   593*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   594*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   595*  ORIGINAL AMOUNT                                               *
   596*  ALTERNATE BENEFIT (BALLON)                                    *
   597*  A.P.R. - NET PAY ONLY                                         *
   598*  METHOD
   599*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   600*  COMPANY I.D.                                                  *
   601*  BENEFIT TYPE                                                  *
   602*                                                                *
   603*  RETURNED FROM ELRAMT                                          *
   604*  --------------------                                          *
   605*  REMAINING AMOUNT 1 - CURRENT                                  *
   606*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   607*  REMAINING AMOUNT FACTOR
   608*----------------------------------------------------------------*
   609*  PASSED TO ELRESV                                              *
   610*  -----------------                                             *
   611*  CERTIFICATE EFFECTIVE DATE                                    *
   612*  VALUATION DATE                                                *
   613*  PAID THRU DATE                                                *
   614*  BENEFIT                                                       *
   615*  INCURRED DATE                                                 *
   616*  REPORTED DATE                                                 *
   617*  ISSUE AGE                                                     *
   618*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  14
* ELRATE.cbl
   619*  CDT PERCENT                                                   *
   620*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   621* *CLAIM TYPE (LIFE, A/H)                                        *
   622* *REMAINING BENEFIT (FROM ELRAMT)                               *
   623* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   624*                                                                *
   625*  RETURNED FROM ELRESV                                          *
   626*  --------------------                                          *
   627*  CDT TABLE USED                                                *
   628*  CDT FACTOR USED                                               *
   629*  PAY TO CURRENT RESERVE                                        *
   630*  I.B.N.R. - A/H ONLY                                           *
   631*  FUTURE (ACCRUED) AH ONLY                                      *
   632*----------------------------------------------------------------*
   633*  PASSED TO ELRATE                                              *
   634*  ----------------                                              *
   635*  CERT ISSUE DATE                                               *
   636*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   637*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   638*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   639*  STATE CODE (CLIENT DEFINED)                                   *
   640*  STATE CODE (STANDARD P.O. ABBRV)                              *
   641*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   642*  DEVIATION CODE                                                *
   643*  ISSUE AGE                                                     *
   644*  ORIGINAL BENEFIT AMOUNT                                       *
   645*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   646*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   647*  BENEFIT KIND (LIFE OR A/H)                                    *
   648*  A.P.R.                                                        *
   649*  METHOD
   650*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   651*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   652*  COMPANY I.D. (3 CHARACTER)                                    *
   653*  BENEFIT CODE                                                  *
   654*  BENEFIT OVERRIDE CODE                                         *
   655*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   656*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   657*  JOINT INDICATOR (CSL ONLY)                                    *
   658*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   659*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   660*                                                                *
   661*  RETURNED FROM ELRATE                                          *
   662*  --------------------                                          *
   663*  CALCULATED PREMIUM                                            *
   664*  PREMIUM RATE                                                  *
   665*  MORTALITY CODE                                                *
   666*  MAX ATTAINED AGE                                              *
   667*  MAX AGE                                                       *
   668*  MAX TERM                                                      *
   669*  MAX MONTHLY BENEFIT                                           *
   670*  MAX TOTAL BENIFIT                                             *
   671*  COMPOSITE RATE (OPEN-END ONLY)                                *
   672*----------------------------------------------------------------*
   673*  PASSED TO ELRFND                                              *
   674*  ----------------                                              *
   675*  CERT ISSUE DATE                                               *
   676*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  15
* ELRATE.cbl
   677*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   678*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   679*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   680*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   681*  STATE CODE (CLIENT DEFINED)                                   *
   682*  STATE CODE (STANDARD P.O. ABBRV)                              *
   683*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   684*  DEVIATION CODE                                                *
   685*  ISSUE AGE                                                     *
   686*  ORIGINAL BENEFIT AMOUNT                                       *
   687*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   688*  PROCESS TYPE (CANCEL)                                         *
   689*  BENEFIT KIND (LIFE OR A/H)                                    *
   690*  A.P.R.                                                        *
   691*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   692*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   693*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   694*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   695*  COMPANY I.D. (3 CHARACTER)                                    *
   696*  BENEFIT CODE                                                  *
   697*  BENEFIT OVERRIDE CODE                                         *
   698*                                                                *
   699*  RETURNED FROM ELRFND                                          *
   700*  --------------------                                          *
   701*  CALCULATED REFUND                                             *
   702*----------------------------------------------------------------*
   703*  PASSED TO ELEARN                                              *
   704*  ----------------                                              *
   705*  CERT ISSUE DATE                                               *
   706*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   707*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   708*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   709*  STATE CODE (CLIENT DEFINED)                                   *
   710*  STATE CODE (STANDARD P.O. ABBRV)                              *
   711*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   712*  DEVIATION CODE                                                *
   713*  ISSUE AGE                                                     *
   714*  ORIGINAL BENEFIT AMOUNT                                       *
   715*  BENEFIT KIND (LIFE OR A/H)                                    *
   716*  A.P.R.                                                        *
   717*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   718*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   719*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   720*  COMPANY I.D. (3 CHARACTER)                                    *
   721*  BENEFIT CODE                                                  *
   722*  BENEFIT OVERRIDE CODE                                         *
   723*                                                                *
   724*  RETURNED FROM ELEARN                                          *
   725*  --------------------                                          *
   726*  INDICATED  EARNINGS                                           *
   727*----------------------------------------------------------------*
   728*                 LENGTH = 450                                   *
   729*                                                                *
   730******************************************************************
   731******************************************************************
   732*                   C H A N G E   L O G
   733*
   734* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  16
* ELRATE.cbl
   735*-----------------------------------------------------------------
   736*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   737* EFFECTIVE    NUMBER
   738*-----------------------------------------------------------------
   739* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   740* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   741* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   742* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   743* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   744* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   745* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   746* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   747* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   748* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   749* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   750******************************************************************
   751
   752 01  CALCULATION-PASS-AREA.
   753     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   754                                     COMP.
   755
   756     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   757       88  NO-CP-ERROR                             VALUE ZERO.
   758       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   759                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   760       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   761       88  CP-ERROR-IN-DATES                       VALUE '2'.
   762       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   763       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   764       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   765       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   766       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   767       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   768       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   769       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   770       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   771       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   772       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   773       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   774       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   775       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   776       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   777
   778     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   779       88  NO-CP-ERROR-2                           VALUE ZERO.
   780***********************  INPUT AREAS ****************************
   781
   782     12  CP-CALCULATION-AREA.
   783         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   784         16  CP-CERT-EFF-DT        PIC XX.
   785         16  CP-VALUATION-DT       PIC XX.
   786         16  CP-PAID-THRU-DT       PIC XX.
   787         16  CP-BENEFIT-TYPE       PIC X.
   788           88  CP-AH                               VALUE 'A' 'D'
   789                                                   'I' 'U'.
   790           88  CP-REDUCING-LIFE                    VALUE 'R'.
   791           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   792         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  17
* ELRATE.cbl
   793         16  CP-REPORTED-DT        PIC XX.
   794         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   795         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   796         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   797                                     COMP-3.
   798         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   799                                     COMP-3.
   800         16  CP-CDT-METHOD         PIC X.
   801           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   802           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   803           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   804         16  CP-CLAIM-TYPE         PIC X.
   805           88  CP-AH-CLAIM                         VALUE 'A'.
   806           88  CP-LIFE-CLAIM                       VALUE 'L'.
   807         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   808                                     COMP-3.
   809         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   810                                     COMP-3.
   811         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   812                                     COMP-3.
   813         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   814                                     COMP-3.
   815         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   816                                     COMP-3.
   817         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   818                                     COMP-3.
   819         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   820                                     COMP-3.
   821         16  CP-REM-TERM-METHOD    PIC X.
   822           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   823           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   824           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   825           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   826           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   827           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   828           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   829         16  CP-EARNING-METHOD     PIC X.
   830           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   831           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   832           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   833           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   834           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   835           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   836           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   837           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   838           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   839           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   840           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   841           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   842           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   843           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   844         16  CP-PROCESS-TYPE       PIC X.
   845           88  CP-CLAIM                            VALUE '1'.
   846           88  CP-CANCEL                           VALUE '2'.
   847           88  CP-ISSUE                            VALUE '3'.
   848         16  CP-SPECIAL-CALC-CD    PIC X.
   849           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   850           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  18
* ELRATE.cbl
   851           88  CP-0-MTH-INTEREST               VALUE 'A'.
   852           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   853           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   854           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   855           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   856           88  CP-FARM-PLAN                    VALUE 'F'.
   857           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   858           88  CP-2-MTH-INTEREST               VALUE 'I'.
   859           88  CP-3-MTH-INTEREST               VALUE 'J'.
   860           88  CP-4-MTH-INTEREST               VALUE 'K'.
   861           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   862           88  CP-MORTGAGE-REC                 VALUE 'M'.
   863           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   864           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   865           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   866           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   867                                                     'W' 'X'.
   868           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   869           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   870           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   871           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   872           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   873           88  CP-SUMMARY-REC                  VALUE 'Z'.
   874           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   875           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   876           88  CP-AD-D-BENEFIT                 VALUE '4'.
   877           88  CP-CSL-METH-1                   VALUE '5'.
   878           88  CP-CSL-METH-2                   VALUE '6'.
   879           88  CP-CSL-METH-3                   VALUE '7'.
   880           88  CP-CSL-METH-4                   VALUE '8'.
   881
   882         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   883                                     COMP-3.
   884         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   885         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   886         16  CP-STATE              PIC XX          VALUE SPACE.
   887         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   888         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   889           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   890               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   891         16  CP-R78-OPTION         PIC X.
   892           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   893           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   894
   895         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   896         16  CP-IBNR-RESERVE-SW    PIC X.
   897         16  CP-CLAIM-STATUS       PIC X.
   898         16  CP-RATE-FILE          PIC X.
   899         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   900                                     COMP-3.
   901
   902         16  CP-LIFE-OVERRIDE-CODE PIC X.
   903         16  CP-AH-OVERRIDE-CODE   PIC X.
   904
   905         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   906                                     COMP-3.
   907         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   908                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  19
* ELRATE.cbl
   909         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   910                                     COMP-3.
   911         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   912                                     COMP-3.
   913         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   914                                     COMP-3.
   915         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   916                                  PIC S9(7)V99 COMP-3.
   917
   918         16  CP-PAID-FROM-DATE     PIC X(02).
   919         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   920         16  CP-EXT-DAYS-CALC      PIC X.
   921           88  CP-EXT-NO-CHG                   VALUE ' '.
   922           88  CP-EXT-CHG-LF                   VALUE '1'.
   923           88  CP-EXT-CHG-AH                   VALUE '2'.
   924           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   925         16  CP-DOMICILE-STATE     PIC XX.
   926         16  CP-CARRIER            PIC X.
   927         16  CP-REIN-FLAG          PIC X.
   928         16  CP-REM-TRM-CALC-OPTION PIC X.
   929           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   930                      '2' '3' '4' '5'.
   931           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   932           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   933           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   934           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   935           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   936           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   937           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   938           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   939         16  CP-SIG-SWITCH         PIC X.
   940         16  CP-RATING-METHOD      PIC X.
   941           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   942           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   943           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   944           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   945           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   946           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   947           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   948           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   949           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   950         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   951                                     COMP-3.
   952         16  CP-BEN-CATEGORY       PIC X.
   953         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   954         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   955                                   PIC S99V9(5) COMP-3.
   956         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   957         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   958                                   PIC S99V9(5) COMP-3.
   959         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   960         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   961         16  CP-EXPIRE-DT          PIC XX.
   962         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   963         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   964         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   965         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   966         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  20
* ELRATE.cbl
   967             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   968             88  CP-CALC-CLP              VALUE 'C'.
   969         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   970         16  CP-CANCEL-REASON      PIC X.
   971         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   972         16  CP-PMT-MODE           PIC X.
   973         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   974         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   975         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   976         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   977         16  FILLER                PIC X.
   978
   979***************    OUTPUT FROM ELRESV   ************************
   980
   981         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   982
   983         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   984                                     COMP-3.
   985         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   986                                     COMP-3.
   987         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   988                                     COMP-3.
   989         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   990                                     COMP-3.
   991         16  FILLER                PIC X(09).
   992***************    OUTPUT FROM ELRTRM   *************************
   993
   994         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   995                                     COMP-3.
   996         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   997                                     COMP-3.
   998         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   999                                     COMP-3.
  1000         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1001                                     COMP-3.
  1002         16  FILLER                PIC X(12).
  1003
  1004***************    OUTPUT FROM ELRAMT   *************************
  1005
  1006         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1007                                     COMP-3.
  1008         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1009                                     COMP-3.
  1010         16  FILLER                PIC X(12).
  1011
  1012***************    OUTPUT FROM ELRATE   *************************
  1013
  1014         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1015                                     COMP-3.
  1016         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1017                                     COMP-3.
  1018         16  CP-MORTALITY-CODE     PIC X(4).
  1019         16  CP-RATE-EDIT-FLAG     PIC X.
  1020             88  CP-RATES-NEED-APR                  VALUE '1'.
  1021         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1022                                     COMP-3.
  1023         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1024         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  21
* ELRATE.cbl
  1025         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1026                                   PIC S9(7)V99 COMP-3.
  1027         16  FILLER                PIC X(07).
  1028
  1029***************    OUTPUT FROM ELRFND   *************************
  1030
  1031         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1032                                     COMP-3.
  1033         16  CP-REFUND-TYPE-USED   PIC X.
  1034           88  CP-R-AS-R78                         VALUE '1'.
  1035           88  CP-R-AS-PRORATA                     VALUE '2'.
  1036           88  CP-R-AS-CALIF                       VALUE '3'.
  1037           88  CP-R-AS-TEXAS                       VALUE '4'.
  1038           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1039           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1040           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1041           88  CP-R-AS-MEAN                        VALUE '8'.
  1042           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1043           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1044           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1045           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1046           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1047           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1048         16  FILLER                PIC X(12).
  1049
  1050***************    OUTPUT FROM ELEARN   *************************
  1051
  1052         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1053                                     COMP-3.
  1054         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1055                                     COMP-3.
  1056         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1057                                     COMP-3.
  1058         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1059                                     COMP-3.
  1060         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1061                                     COMP-3.
  1062         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1063                                     COMP-3.
  1064         16  CP-EARNING-TYPE-USED  PIC X.
  1065           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1066           88  CP-E-AS-R78                         VALUE '1'.
  1067           88  CP-E-AS-PRORATA                     VALUE '2'.
  1068           88  CP-E-AS-TEXAS                       VALUE '4'.
  1069           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1070           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1071           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1072           88  CP-E-AS-MEAN                        VALUE '8'.
  1073           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1074         16  FILLER                PIC X(12).
  1075
  1076***************    OUTPUT FROM ELPMNT   *************************
  1077
  1078         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1079                                     COMP-3.
  1080         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1081                                     COMP-3.
  1082         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  22
* ELRATE.cbl
  1083
  1084***************   MISC WORK AREAS    *****************************
  1085         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1086                                     COMP-3.
  1087         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1088                                     COMP-3.
  1089         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1090                                     COMP-3.
  1091         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1092                                     COMP-3.
  1093         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1094                                     COMP-3.
  1095         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1096                                     COMP-3.
  1097         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1098             88  OPEN-RATE-FILE                   VALUE 'O'.
  1099             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1100             88  IO-ERROR                         VALUE 'E'.
  1101
  1102         16  CP-FIRST-PAY-DATE     PIC XX.
  1103
  1104         16  CP-JOINT-INDICATOR    PIC X.
  1105
  1106         16  CP-RESERVE-REMAINING-TERM
  1107                                   PIC S9(4)V9    VALUE ZERO
  1108                                     COMP-3.
  1109
  1110         16  CP-INSURED-BIRTH-DT   PIC XX.
  1111
  1112         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1113                                     COMP-3.
  1114
  1115         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1116                                     COMP-3.
  1117
  1118         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1119                                     COMP-3.
  1120
  1121         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1122                                     COMP-3.
  1123
  1124         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1125                                     COMP-3.
  1126
  1127         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1128                                     COMP-3.
  1129
  1130         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1131                                     COMP-3.
  1132
  1133         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1134             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1135
  1136         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1137                                     COMP-3.
  1138         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1139                                     COMP-3.
  1140         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  23
* ELRATE.cbl
  1141         16  cp-extra-periods      pic 9 value zeros.
  1142         16  cp-net-only-state     pic x value spaces.
  1143         16  FILLER                PIC X(13).
  1144******************************************************************
  1145
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  24
* ELRATE.cbl
  1147****************************************************************
  1148*
  1149* Copyright (c) 2007-2013 Dell Inc.
  1150* All rights reserved.
  1151*
  1152****************************************************************
  1153 01  DFHEIV.
  1154   02  DFHEIV0               PIC X(35).
  1155   02  DFHEIV1               PIC X(08).
  1156   02  DFHEIV2               PIC X(08).
  1157   02  DFHEIV3               PIC X(08).
  1158   02  DFHEIV4               PIC X(06).
  1159   02  DFHEIV5               PIC X(04).
  1160   02  DFHEIV6               PIC X(04).
  1161   02  DFHEIV7               PIC X(02).
  1162   02  DFHEIV8               PIC X(02).
  1163   02  DFHEIV9               PIC X(01).
  1164   02  DFHEIV10              PIC S9(7) COMP-3.
  1165   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1166   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1167   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1168   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1169   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1170   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1171   02  DFHEIV17              PIC X(04).
  1172   02  DFHEIV18              PIC X(04).
  1173   02  DFHEIV19              PIC X(04).
  1174   02  DFHEIV20              USAGE IS POINTER.
  1175   02  DFHEIV21              USAGE IS POINTER.
  1176   02  DFHEIV22              USAGE IS POINTER.
  1177   02  DFHEIV23              USAGE IS POINTER.
  1178   02  DFHEIV24              USAGE IS POINTER.
  1179   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1180   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1181   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1182   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1183   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1184   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1185   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1186   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1187   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1188   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1189   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1190   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1191   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1192   02  FILLER                PIC X(02).
  1193   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1194   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1195   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1196   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1197   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1198   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1199   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1200 LINKAGE  SECTION.
  1201*****************************************************************
  1202*                                                               *
  1203* Copyright (c) 2007-2013 Dell Inc.                             *
  1204* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  25
* ELRATE.cbl
  1205*                                                               *
  1206*****************************************************************
  1207 01  dfheiblk.
  1208     02  eibtime          pic s9(7) comp-3.
  1209     02  eibdate          pic s9(7) comp-3.
  1210     02  eibtrnid         pic x(4).
  1211     02  eibtaskn         pic s9(7) comp-3.
  1212     02  eibtrmid         pic x(4).
  1213     02  dfheigdi         pic s9(4) comp.
  1214     02  eibcposn         pic s9(4) comp.
  1215     02  eibcalen         pic s9(4) comp.
  1216     02  eibaid           pic x(1).
  1217     02  eibfiller1       pic x(1).
  1218     02  eibfn            pic x(2).
  1219     02  eibfiller2       pic x(2).
  1220     02  eibrcode         pic x(6).
  1221     02  eibfiller3       pic x(2).
  1222     02  eibds            pic x(8).
  1223     02  eibreqid         pic x(8).
  1224     02  eibrsrce         pic x(8).
  1225     02  eibsync          pic x(1).
  1226     02  eibfree          pic x(1).
  1227     02  eibrecv          pic x(1).
  1228     02  eibsend          pic x(1).
  1229     02  eibatt           pic x(1).
  1230     02  eibeoc           pic x(1).
  1231     02  eibfmh           pic x(1).
  1232     02  eibcompl         pic x(1).
  1233     02  eibsig           pic x(1).
  1234     02  eibconf          pic x(1).
  1235     02  eiberr           pic x(1).
  1236     02  eibrldbk         pic x(1).
  1237     02  eiberrcd         pic x(4).
  1238     02  eibsynrb         pic x(1).
  1239     02  eibnodat         pic x(1).
  1240     02  eibfiller5       pic x(2).
  1241     02  eibresp          pic s9(8) comp.
  1242     02  eibresp2         pic s9(8) comp.
  1243     02  dfheigdj         pic s9(4) comp.
  1244     02  dfheigdk         pic s9(4) comp.
  1245 01  DFHCOMMAREA             PIC X(450).
  1246
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  26
* ELRATE.cbl
  1248*01 PARMLIST              COMP.
  1249*    02  FILLER              PIC S9(8).
  1250*    02  ERRATE-POINTER      PIC S9(8).
  1251
  1252*                                COPY ERCRATE.
  1253******************************************************************
  1254*                                                                *
  1255*                                                                *
  1256*                            ERCRATE                             *
  1257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1258*                            VMOD=2.008                          *
  1259*                                                                *
  1260*   ONLINE CREDIT SYSTEM                                         *
  1261*                                                                *
  1262*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1263*                                                                *
  1264*   FILE TYPE = VSAM,KSDS                                        *
  1265*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1266*                                                                *
  1267*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1268*       ALTERNATE PATH = NONE                                    *
  1269*                                                                *
  1270*   LOG = NO                                                     *
  1271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1272*                                                                *
  1273******************************************************************
  1274******************************************************************
  1275*                   C H A N G E   L O G
  1276*
  1277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1278*-----------------------------------------------------------------
  1279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1280* EFFECTIVE    NUMBER
  1281*-----------------------------------------------------------------
  1282* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1283******************************************************************
  1284
  1285 01  RATE-RECORD.
  1286     12  RT-RECORD-ID                      PIC XX.
  1287         88  VALID-RT-ID                      VALUE 'RT'.
  1288
  1289     12  RT-CONTROL-PRIMARY.
  1290         16  RT-COMPANY-CD                 PIC X.
  1291         16  RT-STATE-CODE.
  1292             20  RT-ST-CODE                PIC XX.
  1293             20  RT-ST-CLASS               PIC XX.
  1294             20  RT-ST-DEV                 PIC XXX.
  1295         16  RT-L-AH-CODE.
  1296             20  RT-L-AH                   PIC X.
  1297             20  RT-LAH-NUM                PIC XX.
  1298         16  RT-LIMITS.
  1299             20  RT-HIGH-AGE               PIC 99.
  1300             20  RT-HIGH-AMT               PIC 9(6).
  1301             20  RT-FUTURE                 PIC XX.
  1302             20  RT-SEX                    PIC X.
  1303         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1304
  1305     12  RT-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  27
* ELRATE.cbl
  1306         16  RT-LAST-MAINT-DT              PIC XX.
  1307         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1308         16  RT-LAST-MAINT-USER            PIC X(4).
  1309         16  FILLER                        PIC X(10).
  1310
  1311     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1312     12  RT-RATE-COMMENT                   PIC X(50).
  1313
  1314     12  CSL-RESERVED                      PIC X(10).
  1315     12  FILLER                            PIC X(12).
  1316
  1317     12  RT-MAX-AGE                        PIC 99.
  1318
  1319     12  RT-LIFE-LIMS-FLDS.
  1320         16  RT-LIFE-MORT-CODE             PIC X(4).
  1321         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1322             20  RT-L-EX-AGE               PIC 99.
  1323             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1324             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1325         16  FILLER                        PIC X(20).
  1326
  1327     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1328         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1329             20  RT-AH-AGE                 PIC 99.
  1330             20  RT-AH-TERM                PIC S999       COMP-3.
  1331             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1332             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1333
  1334     12  RT-LIFE-RATES.
  1335         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1336
  1337     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1338         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1339
  1340     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1341
  1342     12  RT-DISCOUNT-OPTION                PIC X.
  1343         88  RT-DO-NOT-USE                     VALUE ' '.
  1344         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1345         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1346
  1347     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1348     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1349
  1350     12  RT-COMPOSITE-OPTION               PIC X.
  1351         88  RT-NO-COMPOSITE                   VALUE ' '.
  1352         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1353
  1354     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1355
  1356     12  RT-CANCEL-FEE                     PIC S9(3)V99   COMP-3.
  1357     12  FILLER                            PIC X(13).
  1358
  1359     12  RT-TYPE-RATE                      PIC X.
  1360         88  RT-IS-STND                        VALUE ' ' 'S'.
  1361         88  RT-IS-OB                          VALUE 'O'.
  1362
  1363     12  RT-SRT-ALPHA                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  28
* ELRATE.cbl
  1364
  1365     12  RT-CONTROL-2.
  1366         16  RTC-1                         PIC X(7).
  1367         16  RTC-3                         PIC X(11).
  1368         16  RTC-4                         PIC 9(11) COMP-3.
  1369         16  RTC-2                         PIC X(3).
  1370******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  29
* ELRATE.cbl
  1372 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1373 0000-DFHEXIT SECTION.
  1374     MOVE '9#                    $   ' TO DFHEIV0.
  1375     MOVE 'ELRATE' TO DFHEIV1.
  1376     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1377
  1378     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1379
  1380 000-START-PREMIUM-CALC.
  1381     MOVE ZERO                   TO CP-RETURN-CODE
  1382                                    CP-CALC-PREMIUM
  1383                                    CP-PREMIUM-RATE
  1384                                    CP-cancel-FEE.
  1385
  1386     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1387     MOVE ALL '9'                TO ERRATE-KEY.
  1388
  1389*    IF CP-RATE-FILE = 'O'
  1390*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1391
  1392     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1393     MOVE CP-STATE               TO RATE-ST-CODE.
  1394     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1395     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1396     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1397
  1398     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1399        CP-RATING-BENEFIT-AMT = ZEROS
  1400         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1401     ELSE
  1402         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1403
  1404     IF CP-AH
  1405         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1406     ELSE
  1407         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1408
  1409     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1410     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1411     MOVE SPACE                  TO DC-OPTION-CODE.
  1412
  1413     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1414
  1415*** Y2K, PROJ 7744
  1416     IF NO-CONVERSION-ERROR
  1417         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1418                                       WS-HOLD-RATE-EXP-DT
  1419         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1420         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1421         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1422     ELSE
  1423         MOVE '2'                   TO CP-RETURN-CODE
  1424         GO TO 9999-CALC-RATE-PREM-X
  1425     END-IF.
  1426*** Y2K, PROJ 7744
  1427
  1428
  1429* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  30
* ELRATE.cbl
  1430*        NOTFND   (9999-RATE-NOTFND)
  1431*        NOTOPEN  (9999-RATE-NOTOPEN)
  1432*        ENDFILE  (9999-RATE-NOTFND)
  1433*    END-EXEC.
  1434*    MOVE '"$IJ''                 ! " #00001424' TO DFHEIV0
  1435     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1437     MOVE X'2220233030303031343234' TO DFHEIV0(25:11)
  1438     CALL 'kxdfhei1' USING DFHEIV0
  1439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1440
  1441
  1442 0050-RATE-START-BROWSE.
  1443
  1444* EXEC CICS STARTBR
  1445*        DATASET  (ERRATE-FILE-ID)
  1446*        RIDFLD   (ERRATE-KEY)
  1447*        GTEQ
  1448*    END-EXEC.
  1449     MOVE 0
  1450       TO DFHEIV11
  1451*    MOVE '&,         G          &   #00001431' TO DFHEIV0
  1452     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1454     MOVE X'2020233030303031343331' TO DFHEIV0(25:11)
  1455     CALL 'kxdfhei1' USING DFHEIV0,
  1456           ERRATE-FILE-ID,
  1457           ERRATE-KEY,
  1458           DFHEIV99,
  1459           DFHEIV11,
  1460           DFHEIV99
  1461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1462
  1463
  1464     MOVE 'Y'                  TO WS-BROWSE-SW.
  1465
  1466 0100-READ-RATE-LOOP.
  1467
  1468* EXEC CICS READNEXT
  1469*        DATASET  (ERRATE-FILE-ID)
  1470*        SET      (ADDRESS OF RATE-RECORD)
  1471*        RIDFLD   (ERRATE-KEY)
  1472*    END-EXEC.
  1473     MOVE 0
  1474       TO DFHEIV11
  1475*    MOVE '&.S                   )   #00001440' TO DFHEIV0
  1476     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1477     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1478     MOVE X'2020233030303031343430' TO DFHEIV0(25:11)
  1479     CALL 'kxdfhei1' USING DFHEIV0,
  1480           ERRATE-FILE-ID,
  1481           DFHEIV20,
  1482           DFHEIV99,
  1483           ERRATE-KEY,
  1484           DFHEIV99,
  1485           DFHEIV11,
  1486           DFHEIV99,
  1487           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  31
* ELRATE.cbl
  1488     SET ADDRESS OF RATE-RECORD TO
  1489         DFHEIV20
  1490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1491
  1492
  1493 0110-CHECK-KEYS.
  1494*                            COPY ELCRATPD.
  1495******************************************************************
  1496*                                                                *
  1497*                                                                *
  1498*                            ELCRATPD                            *
  1499*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1500*                            VMOD=2.061                          *
  1501*                                                                *
  1502******************************************************************
  1503******************************************************************
  1504*                   C H A N G E   L O G
  1505*
  1506* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1507*-----------------------------------------------------------------
  1508*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1509* EFFECTIVE    NUMBER
  1510*-----------------------------------------------------------------
  1511* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1512* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1513* 032603                   PEMA  ADD SPECIAL AZ CALC
  1514* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1515* 120403                   PEMA  ADD SPECIAL TX CALC
  1516* 092205                   PEMA  FIX CRIT PER FOR DCC
  1517* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1518* 021207                   PEMA  ADD PA NP
  1519* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1520* 032807                   PEMA  ADD VT NP PLUS 2
  1521* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1522* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1523* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1524* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1525* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1526* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1527* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1528* 071211    2010012700001  PEMA  ADD SPPDD
  1529* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1530* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1531* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1532* 032612  CR2011110200001  PEMA  AHL CHANGES
  1533* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  1534* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  1535* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  1536* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1537* 021519  CR2019021100001  PEMA  non-monthly al calcs
  1538* 072419  IR2019072400001  PEMA  Initialize pmt mode(AL)
  1539******************************************************************
  1540
  1541 0110-CHECK-KEY.
  1542     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1543        SVRT-ST-CODE    = RT-ST-CODE     AND
  1544        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1545        SVRT-ST-DEV     = RT-ST-DEV      AND
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  32
* ELRATE.cbl
  1546        SVRT-L-AH       = RT-L-AH        AND
  1547        SVRT-LAH-NUM    = RT-LAH-NUM
  1548         NEXT SENTENCE
  1549     ELSE
  1550         GO TO 9999-RATE-NOTFND.
  1551
  1552     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1553         GO TO 9999-RATE-NOTFND.
  1554
  1555     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1556        GO TO 0100-READ-RATE-LOOP.
  1557
  1558     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1559         GO TO 0100-READ-RATE-LOOP.
  1560
  1561     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1562         GO TO 0100-READ-RATE-LOOP.
  1563
  1564     IF RT-MAX-AGE = ZEROS
  1565         NEXT SENTENCE
  1566     ELSE
  1567         COMPUTE WS-AGE =
  1568             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1569         IF WS-AGE >= RT-MAX-AGE
  1570             MOVE 'B'               TO CP-RETURN-CODE.
  1571
  1572     IF CP-LOAN-TERM NOT NUMERIC
  1573         MOVE +0                    TO CP-LOAN-TERM.
  1574
  1575     IF CP-LOAN-TERM = ZERO
  1576         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1577
  1578     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1579         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1580
  1581     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1582     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1583
  1584     IF CP-AH
  1585         GO TO 2000-TYPE-IS-AH.
  1586
  1587*    display ' ben type           ' cp-benefit-type
  1588*    display ' earn meth          ' cp-earning-method
  1589*    display ' process type       ' cp-process-type
  1590*    display ' special            ' cp-special-calc-cd
  1591*    display ' ben code           ' cp-benefit-cd
  1592*    display ' ext days calc      ' cp-ext-days-calc
  1593*    display ' rating meth        ' cp-rating-method
  1594*    display ' orig ben           ' cp-original-benefit
  1595     evaluate true
  1596        when (rt-is-ob)
  1597           and (cp-company-id not = 'CID')
  1598              move cp-loan-term  to ws-rate-term
  1599        when (cp-company-id = 'DCC' OR 'VPP')
  1600           and (cp-benefit-cd (1:1) = 'P')
  1601           move cp-loan-term     to ws-rate-term
  1602        when other
  1603           move cp-original-term to ws-rate-term
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  33
* ELRATE.cbl
  1604     end-evaluate
  1605
  1606*    IF ((RT-IS-OB)
  1607*       AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1608*                     OR
  1609*       ((CP-COMPANY-ID = 'DCC')
  1610*       AND (CP-BENEFIT-CD (1:1) = 'P'))
  1611*       MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1612*    ELSE
  1613*       MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1614*    END-IF
  1615
  1616     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1617     MOVE SPACE                     TO DC-OPTION-CODE.
  1618
  1619     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1620
  1621 1000-TYPE-IS-LIFE.
  1622     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1623
  1624     MOVE ZERO                      TO CP-R-MAX-AGE
  1625                                       CP-R-MAX-TERM
  1626                                       CP-R-MAX-MON-BEN
  1627                                       CP-R-MAX-TOT-BEN.
  1628
  1629     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1630
  1631     IF RT-CANCEL-FEE NUMERIC
  1632        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  1633
  1634     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1635
  1636     if rt-discount-ob-rate not numeric
  1637        move zeros               to rt-discount-ob-rate
  1638     end-if
  1639     IF (RT-DISCOUNT-OPTION EQUAL
  1640                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1641        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1642        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1643         NEXT SENTENCE
  1644     ELSE
  1645         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1646            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1647             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1648                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1649                 GO TO 1050-REGULAR-RATES
  1650             ELSE
  1651                 GO TO 1050-REGULAR-RATES
  1652         ELSE
  1653             GO TO 1050-REGULAR-RATES.
  1654
  1655*    display ' discount option ' rt-discount-option
  1656     IF RT-DISCOUNT-RATE NOT NUMERIC
  1657        MOVE +0                  TO RT-DISCOUNT-RATE.
  1658
  1659     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1660        NEXT SENTENCE
  1661     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  34
* ELRATE.cbl
  1662        MOVE +0                  TO CP-PREMIUM-RATE
  1663                                    CP-COMPOSITE-RATE
  1664                                    CP-CALC-PREMIUM
  1665         MOVE '4'                TO CP-RETURN-CODE
  1666         GO TO 9999-CALC-RATE-PREM-X.
  1667
  1668     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1669        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1670     ELSE
  1671        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1672
  1673*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1674*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1675*       GO TO 1075-BYPASS-REGULAR-RATE.
  1676
  1677     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1678        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1679        COMPUTE WS-WORK-DIS-RATE EQUAL
  1680                WS-WORK-DIS-RATE / +100
  1681        GO TO 1075-BYPASS-REGULAR-RATE.
  1682
  1683     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1684        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1685        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1686        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1687        GO TO 1075-BYPASS-REGULAR-RATE.
  1688
  1689     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1690        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1691        (CP-TRUNCATED-LIFE)
  1692        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1693        GO TO 1075-BYPASS-REGULAR-RATE.
  1694
  1695     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1696        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1697        (CP-EARN-AS-NET-PAY)
  1698*       (CP-TRUNCATED-LIFE)
  1699        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1700        GO TO 1075-BYPASS-REGULAR-RATE.
  1701
  1702     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1703        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1704                   AND
  1705        ((CP-EARN-AS-NET-PAY)
  1706               OR
  1707        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1708        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1709        GO TO 1075-BYPASS-REGULAR-RATE.
  1710
  1711     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1712        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1713        (CP-EARN-AS-NET-PAY) AND
  1714        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1715        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1716        GO TO 1075-BYPASS-REGULAR-RATE.
  1717
  1718     if (cp-company-id = 'CID')
  1719        and (cp-state-std-abbrv = 'WA' or 'AL')
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  35
* ELRATE.cbl
  1720        and (rt-discount-option = '1')
  1721        and (cp-earn-as-farm-plan)
  1722        move rt-discount-ob-rate to cp-premium-rate
  1723        go to 1075-bypass-regular-rate
  1724     end-if
  1725     IF (CP-COMPANY-ID = 'CID')
  1726        AND (CP-STATE-STD-ABBRV = 'MN')
  1727        AND (RT-DISCOUNT-OPTION = '1')
  1728        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1729                     OR
  1730            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
  1731            AND (CP-CERT-EFF-DT > X'A4FF'))
  1732        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1733*       display ' made it to MN 1 ' cp-premium-rate
  1734        GO TO 1075-BYPASS-REGULAR-RATE
  1735     END-IF
  1736     if (cp-company-id = 'CID')
  1737        and (cp-earn-as-reg-balloon)
  1738        and (cp-ben-category = 'P' or 'I')
  1739        and (rt-discount-ob-rate not = zeros)
  1740        go to 1075-bypass-regular-rate
  1741     end-if
  1742     IF (CP-COMPANY-ID EQUAL 'CID')
  1743        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1744                      OR
  1745            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1746        AND (CP-EARN-AS-NET-PAY)
  1747        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1748        GO TO 1075-BYPASS-REGULAR-RATE
  1749     END-IF
  1750     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1751        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1752        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1753         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1754         GO TO 1075-BYPASS-REGULAR-RATE.
  1755
  1756     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1757        CONTINUE
  1758     ELSE
  1759        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1760           (CP-EARN-AS-NET-PAY ) AND
  1761           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1762            GO TO 1075-BYPASS-REGULAR-RATE
  1763        END-IF
  1764     END-IF
  1765     IF (CP-COMPANY-ID = 'CID') AND
  1766        (CP-EARN-AS-NET-PAY) AND
  1767        (CP-LEVEL-LIFE) AND
  1768        (CP-STATE-STD-ABBRV = 'CA') AND
  1769        (CP-STATE-STD-ABBRV = CP-STATE)
  1770        COMPUTE WS-WORK-DIS-RATE =
  1771             RT-DISCOUNT-RATE / +100
  1772        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1773        GO TO 1075-BYPASS-REGULAR-RATE
  1774     END-IF
  1775
  1776     IF (CP-COMPANY-ID = 'CID')
  1777        AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  36
* ELRATE.cbl
  1778        AND (CP-STATE-STD-ABBRV = 'ME')
  1779        COMPUTE WS-WORK-DIS-RATE =
  1780             RT-DISCOUNT-RATE / +100
  1781        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1782        GO TO 1075-BYPASS-REGULAR-RATE
  1783     END-IF
  1784     IF (CP-COMPANY-ID = 'CID')
  1785        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1786           OR 'IN' OR 'AZ')
  1787        AND (CP-FARM-PLAN)
  1788        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1789        GO TO 1075-BYPASS-REGULAR-RATE
  1790     END-IF
  1791     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  1792        AND (CP-BEN-CATEGORY = 'D')
  1793        AND (CP-EARN-AS-NET-PAY)
  1794        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1795        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1796           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1797*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1798*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1799*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1800*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1801        GO TO 1075-BYPASS-REGULAR-RATE
  1802     END-IF
  1803     IF (CP-COMPANY-ID = 'CID') AND
  1804        (CP-EARN-AS-NET-PAY) AND
  1805        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1806                            OR 'VT')
  1807                   OR
  1808        ((CP-STATE-STD-ABBRV = 'IN') AND
  1809        (CP-CERT-EFF-DT > X'9A7F'))
  1810                   OR
  1811        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1812        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1813        (CP-STATE-STD-ABBRV = CP-STATE)
  1814        COMPUTE WS-WORK-DIS-RATE =
  1815             RT-DISCOUNT-RATE / +100
  1816        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1817        GO TO 1075-BYPASS-REGULAR-RATE
  1818     END-IF
  1819
  1820     IF (CP-COMPANY-ID = 'CID') AND
  1821        (CP-EARN-AS-NET-PAY) AND
  1822        (CP-STATE-STD-ABBRV = 'TX') AND
  1823        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1824        (WS-DISCOUNT-OPTION NOT = ' ')
  1825        COMPUTE WS-WORK-DIS-RATE =
  1826             RT-DISCOUNT-RATE / +100
  1827        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1828        GO TO 1075-BYPASS-REGULAR-RATE
  1829     END-IF
  1830
  1831     IF (CP-COMPANY-ID = 'CID') AND
  1832        (CP-EARN-AS-NET-PAY) AND
  1833        (CP-TRUNCATED-LIFE) AND
  1834        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1835        (CP-STATE-STD-ABBRV = CP-STATE) AND
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  37
* ELRATE.cbl
  1836        (WS-DISCOUNT-OPTION NOT = ' ')
  1837        COMPUTE WS-WORK-DIS-RATE =
  1838             RT-DISCOUNT-RATE / +100
  1839        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1840        GO TO 1075-BYPASS-REGULAR-RATE
  1841     END-IF
  1842
  1843     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1844        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1845           COMPUTE WS-WORK-DIS-RATE EQUAL
  1846                   WS-WORK-DIS-RATE / +100.
  1847
  1848     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1849        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1850           IF CP-MONTHLY-PAYMENT EQUAL +0
  1851            IF CP-LOAN-APR GREATER THAN +2
  1852              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1853              CP-ORIGINAL-BENEFIT /
  1854               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1855               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1856            ELSE
  1857             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1858               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1859
  1860     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1861        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1862          IF WS-WORK-DIS-RATE GREATER THAN +0
  1863           COMPUTE WK1 ROUNDED EQUAL
  1864           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1865                              (WS-RATE-TERM - +1)) /
  1866                        (WS-WORK-DIS-RATE / +12)
  1867           COMPUTE WK2 ROUNDED EQUAL
  1868           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1869                              (WS-RATE-TERM)) /
  1870                        (WS-WORK-DIS-RATE / +12)
  1871           COMPUTE WK3 EQUAL
  1872                RT-DISCOUNT-OB-RATE *
  1873                (1 + WS-WORK-DIS-RATE / +12)
  1874                MOVE WK3 TO CP-PREMIUM-RATE
  1875                COMPUTE WK5 EQUAL WK3 / +1000
  1876           GO TO 1075-BYPASS-REGULAR-RATE.
  1877*               (RT-DISCOUNT-OB-RATE / +1000) *
  1878*               (1 + WS-WORK-DIS-RATE / +12)
  1879*          GO TO 1075-BYPASS-REGULAR-RATE.
  1880
  1881     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1882        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1883           COMPUTE WK3 EQUAL
  1884           RT-DISCOUNT-OB-RATE *
  1885           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1886           MOVE WK3 TO CP-PREMIUM-RATE
  1887           COMPUTE WK5 EQUAL WK3 / +1000
  1888           GO TO 1075-BYPASS-REGULAR-RATE.
  1889
  1890     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1891        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1892        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1893        GO TO 1075-BYPASS-REGULAR-RATE.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  38
* ELRATE.cbl
  1894
  1895     COMPUTE WS-SIN-PREM-RATE =
  1896             (RT-DISCOUNT-OB-RATE / +1000) *
  1897             ((WS-RATE-TERM + +1) / +2).
  1898
  1899     COMPUTE CP-PREMIUM-RATE =
  1900             WS-SIN-PREM-RATE /
  1901             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1902             WS-RATE-TERM) / +24)).
  1903
  1904     IF CP-PREMIUM-RATE NOT = +0
  1905        MULTIPLY +100 BY CP-PREMIUM-RATE
  1906        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1907        GO TO 1075-BYPASS-REGULAR-RATE.
  1908
  1909 1050-REGULAR-RATES.
  1910
  1911     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1912        COMPUTE WK5 EQUAL
  1913        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1914        (6 * (WS-RATE-TERM + 1))
  1915        MOVE WK5 TO CP-PREMIUM-RATE
  1916        GO TO 1075-BYPASS-REGULAR-RATE.
  1917
  1918     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1919        (CP-CSL-VALID-NP-BENEFIT-CD)
  1920        IF CP-JOINT-INDICATOR EQUAL 'J'
  1921           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1922           GO TO 1075-BYPASS-REGULAR-RATE
  1923        ELSE
  1924           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1925           GO TO 1075-BYPASS-REGULAR-RATE.
  1926
  1927     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1928        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1929        (CP-EARN-AS-NET-PAY )
  1930        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1931        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1932        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1933        MOVE '1'                 TO DC-OPTION-CODE
  1934        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1935        IF DATE-CONVERSION-ERROR
  1936            MOVE '2'                TO CP-RETURN-CODE
  1937            GO TO 9999-CALC-RATE-PREM-X
  1938        ELSE
  1939            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1940                                         DC-ODD-DAYS-OVER
  1941            GO TO 1075-BYPASS-REGULAR-RATE.
  1942
  1943     IF RT-COMPOSITE-RATE NOT NUMERIC
  1944         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1945
  1946*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1947     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1948         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1949                                              WS-PREMIUM-RATE
  1950         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1951     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  39
* ELRATE.cbl
  1952         MOVE +0                           TO CP-PREMIUM-RATE
  1953                                              CP-COMPOSITE-RATE
  1954                                              CP-CALC-PREMIUM
  1955         GO TO 9999-CALC-RATE-PREM-X.
  1956     IF (CP-COMPANY-ID EQUAL 'CID')
  1957        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1958        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1959        AND (CP-EARN-AS-NET-PAY)
  1960        GO TO 1075-BYPASS-REGULAR-RATE
  1961     END-IF
  1962******************************************************
  1963*    IF CP-COMPANY-ID NOT = 'LBL'
  1964     IF (CP-COMPANY-ID NOT = 'LBL' AND 'CID')
  1965                   or
  1966        ((cp-company-id = 'CID')
  1967        and (cp-earn-as-reg-balloon)
  1968        and (cp-ben-category = 'P' or 'I'))
  1969         GO TO 1075-BYPASS-REGULAR-RATE.
  1970
  1971     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1972     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1973     MOVE '1'                    TO DC-OPTION-CODE.
  1974     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1975     IF DATE-CONVERSION-ERROR
  1976         MOVE '2'                TO CP-RETURN-CODE
  1977         GO TO 9999-CALC-RATE-PREM-X
  1978       ELSE
  1979         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1980         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1981
  1982     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1983        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1984        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1985
  1986     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1987        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1988           NEXT SENTENCE
  1989         ELSE
  1990           GO TO 1075-BYPASS-REGULAR-RATE
  1991       ELSE
  1992        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1993           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1994           NEXT SENTENCE
  1995         ELSE
  1996           GO TO 1075-BYPASS-REGULAR-RATE.
  1997
  1998     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1999        COMPUTE CP-PREMIUM-RATE =
  2000        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  2001         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  2002         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2003
  2004     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  2005        COMPUTE CP-PREMIUM-RATE =
  2006        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2007        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  2008        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2009        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  40
* ELRATE.cbl
  2010         * (CP-ORIGINAL-TERM - 1)).
  2011******************************************************
  2012
  2013 1075-BYPASS-REGULAR-RATE.
  2014
  2015     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  2016
  2017     MOVE +1 TO LINDX.
  2018
  2019     IF CP-COMPANY-ID EQUAL 'CRI'
  2020        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2021           MOVE +5               TO LINDX
  2022           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  2023              MOVE 'F'           TO CP-RETURN-CODE
  2024              GO TO 1200-CALCULATE-PREMIUMS.
  2025
  2026     IF RT-L-EX-AGE (LINDX) = ZERO
  2027          GO TO 1200-CALCULATE-PREMIUMS.
  2028
  2029 1100-SEARCH-LIFE-LIMITS.
  2030
  2031     IF CP-COMPANY-ID EQUAL 'CRI'
  2032        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2033           IF LINDX GREATER THAN +4
  2034              MOVE 'A'           TO CP-RETURN-CODE
  2035              GO TO 1200-CALCULATE-PREMIUMS.
  2036
  2037     IF LINDX GREATER +8
  2038         MOVE 'A'                TO CP-RETURN-CODE
  2039         GO TO 1200-CALCULATE-PREMIUMS.
  2040
  2041     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  2042         IF RT-L-EX-AGE (LINDX) = ZEROS
  2043             ADD +1              TO LINDX
  2044             GO TO 1100-SEARCH-LIFE-LIMITS
  2045         ELSE
  2046             MOVE RT-L-EX-AGE (LINDX)
  2047                                 TO CP-R-MAX-AGE
  2048             MOVE RT-L-EX-TERM (LINDX)
  2049                                 TO CP-R-MAX-TERM
  2050             MOVE RT-L-EX-FACE (LINDX)
  2051                                 TO CP-R-MAX-TOT-BEN
  2052             ADD +1              TO LINDX
  2053             GO TO 1100-SEARCH-LIFE-LIMITS
  2054     ELSE
  2055         MOVE RT-L-EX-AGE (LINDX)
  2056                                 TO CP-R-MAX-AGE
  2057         MOVE RT-L-EX-TERM (LINDX)
  2058                                 TO CP-R-MAX-TERM
  2059         MOVE RT-L-EX-FACE (LINDX)
  2060                                 TO CP-R-MAX-TOT-BEN.
  2061
  2062     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  2063         MOVE '9'                TO CP-RETURN-CODE.
  2064
  2065     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  2066         MOVE '8'                TO CP-RETURN-CODE.
  2067
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  41
* ELRATE.cbl
  2068 1200-CALCULATE-PREMIUMS.
  2069
  2070     IF CP-COMPANY-ID = 'CSL'
  2071        IF CP-CSL-VALID-NP-BENEFIT-CD
  2072           GO TO 1240-NET-PAY-CONT
  2073        ELSE
  2074           GO TO 1250-CSL-CALC.
  2075
  2076     IF CP-COMPANY-ID = 'WDS'
  2077        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  2078           IF CP-EARN-AS-REG-BALLOON
  2079              GO TO 1240-NET-PAY-CONT.
  2080
  2081     IF (CP-COMPANY-ID = 'CID')
  2082        AND (CP-STATE-STD-ABBRV = 'MN')
  2083        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  2084        AND (CP-CERT-EFF-DT > X'A4FF')
  2085        GO TO 1240-NET-PAY-CONT
  2086     END-IF
  2087     IF (CP-COMPANY-ID = 'CID')
  2088        AND (CP-STATE-STD-ABBRV = 'WA' or 'AL')
  2089        AND (CP-FARM-PLAN)
  2090        GO TO 1240-NET-PAY-CONT
  2091     END-IF
  2092     if (cp-company-id = 'CID')
  2093        and (cp-earn-as-reg-balloon)
  2094        and (cp-ben-category = 'P' or 'I')
  2095        display ' found balloon p or i ' rt-discount-ob-rate
  2096        evaluate true
  2097           when (cp-net-only-state = 'Y')
  2098              and (rt-discount-ob-rate > zeros)
  2099              compute cp-premium-rate = rt-discount-ob-rate / 10
  2100           when (cp-net-only-state = 'Y')
  2101              and (rt-discount-ob-rate = zeros)
  2102              display ' not ob rate     ' cp-premium-rate
  2103              compute cp-premium-rate =
  2104                 cp-premium-rate / cp-original-term * 12
  2105              display ' new rate ' cp-premium-rate
  2106              display ' net only state ' cp-premium-rate
  2107              compute cp-premium-rate rounded =
  2108                (cp-premium-rate *
  2109                   (cp-original-term + 1) / 12) /
  2110                ((cp-original-term + 2) / 2)
  2111              display ' new OB rate ' cp-premium-rate
  2112           when (cp-net-only-state <> 'Y')
  2113              and (rt-discount-ob-rate = zeros)
  2114              display ' not net only st ' cp-premium-rate
  2115              compute cp-premium-rate =
  2116                 cp-premium-rate / cp-original-term * 12
  2117              display ' new rate ' cp-premium-rate
  2118        end-evaluate
  2119        go to 1240-net-pay-cont
  2120     end-if
  2121     IF (CP-COMPANY-ID = 'CID')
  2122        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2123           OR 'IN' OR 'AZ')
  2124        AND (CP-FARM-PLAN)
  2125***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  42
* ELRATE.cbl
  2126***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2127        MOVE +1.0                TO CP-LOAN-APR
  2128        GO TO 1240-NET-PAY-CONT
  2129     END-IF
  2130     IF CP-RATE-AS-STANDARD
  2131         GO TO 1210-REGULAR-RATE.
  2132
  2133     IF CP-CRITICAL-PERIOD
  2134         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2135
  2136     IF CP-EARN-AS-TEXAS
  2137         GO TO 1230-TEXAS-CONT.
  2138
  2139     IF CP-EARN-AS-NET-PAY
  2140        IF CP-STATE-STD-ABBRV = 'MD'
  2141          IF CP-COMPANY-ID = 'MON'
  2142            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2143                               '14' OR '26' OR '47'
  2144              GO TO 1210-REGULAR-RATE.
  2145
  2146     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2147        IF CP-MONTHLY-PAYMENT EQUAL +0
  2148           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2149                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2150
  2151     IF CP-COMPANY-ID EQUAL 'GTL'
  2152        NEXT SENTENCE
  2153     ELSE
  2154     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2155        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2156           COMPUTE WK3 ROUNDED EQUAL
  2157           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2158           CP-MONTHLY-PAYMENT
  2159           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2160           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2161           CP-ALTERNATE-BENEFIT)
  2162           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2163           WK3 * WK5
  2164           GO TO 9999-CALC-RATE-PREM-X
  2165        ELSE
  2166           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2167           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2168           (WS-WORK-DIS-RATE / +12)
  2169           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2170           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2171                               WK5
  2172           GO TO 9999-CALC-RATE-PREM-X.
  2173
  2174     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2175        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2176        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2177        CP-ORIGINAL-TERM LESS THAN +61
  2178        COMPUTE CP-CALC-PREMIUM EQUAL
  2179                        (CP-ORIGINAL-BENEFIT *
  2180           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2181           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2182        COMPUTE CP-CALC-PREMIUM EQUAL
  2183                CP-CALC-PREMIUM +
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  43
* ELRATE.cbl
  2184              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2185        (CP-ORIGINAL-TERM + 1)) /
  2186        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2187        GO TO 9999-CALC-RATE-PREM-X.
  2188
  2189     IF CP-COMPANY-ID = 'GTL'     AND
  2190        CP-STATE-STD-ABBRV = 'PA' AND
  2191        CP-SPECIAL-CALC-CD = 'H'
  2192         GO TO 1260-GTL-PA-LEASE.
  2193
  2194     IF (CP-EARN-AS-NET-PAY)
  2195*       AND (CP-LOAN-APR > ZEROS)
  2196        GO TO 1240-NET-PAY-CONT
  2197     END-IF
  2198
  2199     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2200         GO TO 1210-REGULAR-RATE.
  2201
  2202**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2203**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2204****
  2205     IF CP-DEVIATION-CODE = 'LEV' AND
  2206        CP-LOAN-APR = ZEROS
  2207         GO TO 1210-REGULAR-RATE.
  2208
  2209     IF (CP-STATE-STD-ABBRV = 'OH')
  2210        AND (CP-CLASS-CODE NOT = 'L ')
  2211        AND (CP-ORIGINAL-TERM > 60)
  2212        AND (DC-GREG-DATE-CYMD > 19831031)
  2213        AND (CP-LOAN-APR > ZEROS)
  2214        GO TO 1240-NET-PAY-CONT
  2215     END-IF
  2216
  2217     IF (CP-STATE-STD-ABBRV = 'UT')
  2218        AND (CP-ORIGINAL-TERM > 62)
  2219        AND (DC-GREG-DATE-CYMD > 19810831)
  2220        AND (DC-GREG-DATE-CYMD < 19830901)
  2221        AND (CP-LOAN-APR > ZEROS)
  2222        GO TO 1240-NET-PAY-CONT
  2223     END-IF
  2224
  2225     IF (CP-STATE-STD-ABBRV = 'RI')
  2226        AND (CP-ORIGINAL-TERM > 60)
  2227        AND (DC-GREG-DATE-CYMD > 19831231)
  2228        AND (CP-LOAN-APR > ZEROS)
  2229        GO TO 1240-NET-PAY-CONT
  2230     END-IF
  2231     .
  2232 1210-REGULAR-RATE.
  2233
  2234     IF (CP-COMPANY-ID = 'CID')
  2235        AND (CP-EARN-AS-NET-PAY)
  2236        AND (CP-LOAN-APR = 0)
  2237        IF RT-L-RATE (WS-RATE-TERM) = 0
  2238           COMPUTE WS-SIN-PREM-RATE =
  2239              (RT-DISCOUNT-OB-RATE / +1000) *
  2240              ((WS-RATE-TERM + +1) / +2)
  2241           COMPUTE CP-PREMIUM-RATE =
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  44
* ELRATE.cbl
  2242              WS-SIN-PREM-RATE /
  2243              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2244              WS-RATE-TERM) / +24))
  2245        ELSE
  2246           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2247        END-IF
  2248     END-IF
  2249*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2250*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2251*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2252*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2253*
  2254*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2255*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2256*          COMPUTE WK3 ROUNDED EQUAL
  2257*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2258*          CP-MONTHLY-PAYMENT
  2259*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2260*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2261*          CP-ALTERNATE-BENEFIT)
  2262*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2263*          WK3 * WK5
  2264*          GO TO 9999-CALC-RATE-PREM-X
  2265*       ELSE
  2266*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2267*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2268*          (WS-WORK-DIS-RATE / +12)
  2269*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2270*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2271*                              WK5
  2272*          GO TO 9999-CALC-RATE-PREM-X.
  2273
  2274     IF CP-TERM-IS-DAYS
  2275         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2276             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2277         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2278             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2279                          * CP-TERM-OR-EXT-DAYS
  2280           GO TO 9999-CALC-RATE-PREM-X.
  2281
  2282     if (cp-company-id = 'AHL')
  2283        and (cp-loan-term > cp-original-term)
  2284        continue
  2285     else
  2286        IF NOT CP-TRUNCATED-LIFE
  2287           GO TO 1212-GROSS-NOT-TRUNCATED
  2288        end-if
  2289     end-if
  2290
  2291****  GROSS TRUNCATED CALCULATION
  2292
  2293     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2294         MOVE 'H'                TO  CP-RETURN-CODE
  2295         GO TO 9999-CALC-RATE-PREM-X.
  2296     if cp-company-id = 'AHL'
  2297        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2298           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2299           compute cp-calc-premium rounded = (1 - (cp-loan-term -
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  45
* ELRATE.cbl
  2300           cp-original-term) * (cp-loan-term - cp-original-term
  2301            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2302            cp-premium-rate / 100 * cp-original-term /
  2303            cp-loan-term * cp-original-benefit
  2304        else
  2305           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2306           cp-original-term) * (cp-loan-term - cp-original-term
  2307            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2308            cp-premium-rate * cp-original-benefit / 100
  2309        end-if
  2310        go to 9999-calc-rate-prem-x
  2311     end-if
  2312
  2313     IF CP-COMPANY-ID = 'NCL'
  2314         COMPUTE WK-MONTHLY-RATE =
  2315               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2316                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2317                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2318                                 /
  2319                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2320                                 *
  2321                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2322         COMPUTE CP-CALC-PREMIUM =
  2323                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2324     ELSE
  2325         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2326                                 CP-ORIGINAL-TERM
  2327         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2328                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2329                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2330                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2331     END-IF
  2332     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2333        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2334           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2335           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2336     END-IF
  2337     GO TO 9999-CALC-RATE-PREM-X
  2338     .
  2339 1212-GROSS-NOT-TRUNCATED.
  2340*    display ' premium rate ' cp-premium-rate
  2341
  2342     IF (CP-COMPANY-ID = 'CID')
  2343        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2344           OR 'IN')
  2345        AND (CP-BENEFIT-CD = '55' OR '56')
  2346        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2347          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2348          (CP-ORIGINAL-TERM) *
  2349          ((CP-ORIGINAL-TERM) / 12) *
  2350          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2351          GO TO 9999-CALC-RATE-PREM-X
  2352     END-IF
  2353     IF (CP-COMPANY-ID = 'CID')
  2354        AND (CP-STATE-STD-ABBRV = 'GA')
  2355        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2356        COMPUTE WK3 ROUNDED =
  2357          CP-ORIGINAL-BENEFIT *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  46
* ELRATE.cbl
  2358          ((CP-ORIGINAL-TERM + 1) / 2) *
  2359          (RT-DISCOUNT-OB-RATE / 1000)
  2360          MOVE WK3 TO CP-CALC-PREMIUM
  2361          GO TO 9999-CALC-RATE-PREM-X
  2362     END-IF
  2363     IF (CP-COMPANY-ID EQUAL 'CID')
  2364        AND (CP-STATE-STD-ABBRV = 'MN')
  2365        AND (CP-LEVEL-LIFE)
  2366        AND (CP-CERT-EFF-DT > X'A4FF')
  2367        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2368        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2369        MOVE '1'                 TO DC-OPTION-CODE
  2370        PERFORM 9100-CONVERT-DATE
  2371                                 THRU 9100-EXIT
  2372        IF DATE-CONVERSION-ERROR
  2373           MOVE '2'              TO CP-RETURN-CODE
  2374           MOVE ZEROS            TO FACTOR
  2375                                 CP-CALC-PREMIUM
  2376           GO TO 9999-CALC-RATE-PREM-X
  2377        END-IF
  2378        MOVE DC-ELAPSED-DAYS     TO D
  2379        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2380           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2381           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2382        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2383           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2384        GO TO 9999-CALC-RATE-PREM-X
  2385     END-IF
  2386     IF (CP-COMPANY-ID = 'CID')
  2387        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2388        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2389           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2390     ELSE
  2391        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2392                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2393     END-IF
  2394*    display ' calc premium ' cp-calc-premium
  2395
  2396*    IF CP-COMPANY-ID = 'LBL'
  2397     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2398        AND (NOT CP-EARN-AS-NET-PAY)
  2399        GO TO 9999-CALC-RATE-PREM-X
  2400     END-IF
  2401
  2402     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2403         GO TO 9999-CALC-RATE-PREM-X.
  2404
  2405     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2406         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2407            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2408               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2409
  2410     GO TO 9999-CALC-RATE-PREM-X.
  2411
  2412 1220-CRITICAL-PERIOD-LF-CONT.
  2413     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2414               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2415
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  47
* ELRATE.cbl
  2416     GO TO 9999-CALC-RATE-PREM-X.
  2417
  2418 1230-TEXAS-CONT.
  2419     IF CP-FARM-PLAN
  2420         GO TO 1235-TEXAS-FARM-CONT.
  2421
  2422     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2423               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2424
  2425     COMPUTE TEX-FACT-9 =
  2426                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2427                 (CP-ORIGINAL-TERM + 1).
  2428
  2429     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2430                 CP-CALC-PREMIUM * TEX-FACT-9.
  2431
  2432     GO TO 9999-CALC-RATE-PREM-X.
  2433
  2434 1235-TEXAS-FARM-CONT.
  2435     COMPUTE WS-FARM-TERM =
  2436               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2437
  2438     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2439     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2440
  2441
  2442     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2443              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2444
  2445     GO TO 9999-CALC-RATE-PREM-X.
  2446
  2447 1240-NET-PAY-CONT.
  2448
  2449     MOVE CP-LOAN-APR             TO N-P-APR.
  2450     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2451                                     N-P-REM
  2452                                     N-P-LOAN.
  2453
  2454     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2455
  2456     IF CP-TRUNCATED-LIFE
  2457         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2458
  2459     IF CP-COMPANY-ID EQUAL 'NCL'
  2460        NEXT SENTENCE
  2461     ELSE
  2462        GO TO 1241-NET-PAY-CONT.
  2463
  2464     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2465     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2466     MOVE '1'                    TO DC-OPTION-CODE
  2467     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2468     IF DATE-CONVERSION-ERROR
  2469         MOVE '2'                TO CP-RETURN-CODE
  2470         GO TO 9999-CALC-RATE-PREM-X
  2471     ELSE
  2472        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2473        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  48
* ELRATE.cbl
  2474
  2475     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2476        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2477        NEXT SENTENCE
  2478     ELSE
  2479        MOVE +1                  TO ODF
  2480        GO TO 1241-NET-PAY-CONT.
  2481
  2482     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2483        COMPUTE CP-PREMIUM-RATE EQUAL
  2484        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2485        CP-PREMIUM-RATE) *
  2486        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2487
  2488     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2489        COMPUTE CP-PREMIUM-RATE EQUAL
  2490        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2491        N-P-LOAN * (N-P-LOAN - 1))) *
  2492        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2493        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2494
  2495     COMPUTE ODF EQUAL
  2496     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2497     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2498
  2499 1241-NET-PAY-CONT.
  2500
  2501     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2502
  2503*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2504     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2505        NEXT SENTENCE
  2506     ELSE
  2507        GO TO 9999-CALC-RATE-PREM-X.
  2508
  2509     IF RT-DISCOUNT-OPTION EQUAL '6'
  2510         GO TO 9999-CALC-RATE-PREM-X.
  2511
  2512     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2513        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2514        GO TO 9999-CALC-RATE-PREM-X.
  2515
  2516     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2517
  2518     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2519        GO TO 9999-CALC-RATE-PREM-X.
  2520
  2521     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2522        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2523        (CP-TRUNCATED-LIFE)
  2524        GO TO 9999-CALC-RATE-PREM-X.
  2525
  2526     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2527        (CP-CSL-VALID-NP-BENEFIT-CD)
  2528        GO TO 9999-CALC-RATE-PREM-X.
  2529
  2530     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2531        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  49
* ELRATE.cbl
  2532        (CP-EARN-AS-NET-PAY)
  2533        GO TO 9999-CALC-RATE-PREM-X.
  2534
  2535*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2536*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2537*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2538*       GO TO 9999-CALC-RATE-PREM-X.
  2539
  2540     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2541        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2542        (CP-EARN-AS-NET-PAY)
  2543        GO TO 9999-CALC-RATE-PREM-X.
  2544
  2545     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2546        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2547        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2548        GO TO 9999-CALC-RATE-PREM-X.
  2549
  2550     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2551        (CP-EARN-AS-NET-PAY)
  2552        GO TO 9999-CALC-RATE-PREM-X.
  2553
  2554     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2555        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2556        (CP-TRUNCATED-LIFE)
  2557        GO TO 9999-CALC-RATE-PREM-X.
  2558
  2559     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2560        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2561        (CP-EARN-AS-NET-PAY)
  2562*       (CP-TRUNCATED-LIFE)
  2563        GO TO 9999-CALC-RATE-PREM-X.
  2564
  2565     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2566        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2567                   AND
  2568        ((CP-EARN-AS-NET-PAY)
  2569               OR
  2570        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2571        GO TO 9999-CALC-RATE-PREM-X.
  2572
  2573     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2574        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2575        (CP-EARN-AS-NET-PAY) AND
  2576        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2577        GO TO 9999-CALC-RATE-PREM-X.
  2578
  2579     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2580        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2581        (CP-EARN-AS-NET-PAY)
  2582        GO TO 9999-CALC-RATE-PREM-X.
  2583
  2584     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2585        CONTINUE
  2586     ELSE
  2587        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2588           (CP-EARN-AS-NET-PAY) AND
  2589           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  50
* ELRATE.cbl
  2590           GO TO 9999-CALC-RATE-PREM-X
  2591        END-IF
  2592     END-IF
  2593
  2594     IF (CP-COMPANY-ID = 'CID')
  2595        AND (CP-EARN-AS-NET-PAY)
  2596        AND (CP-STATE-STD-ABBRV = 'ME')
  2597        GO TO 9999-CALC-RATE-PREM-X
  2598     END-IF
  2599     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2600        AND (CP-BEN-CATEGORY = 'D')
  2601        AND (CP-EARN-AS-NET-PAY)
  2602        GO TO 9999-CALC-RATE-PREM-X
  2603     END-IF
  2604     IF (CP-COMPANY-ID = 'CID')
  2605        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2606           OR 'IN' OR 'AZ')
  2607        AND (CP-FARM-PLAN)
  2608        GO TO 9999-CALC-RATE-PREM-X
  2609     END-IF
  2610     IF (CP-COMPANY-ID = 'CID') AND
  2611        (CP-EARN-AS-NET-PAY) AND
  2612        (CP-LEVEL-LIFE) AND
  2613        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2614        (CP-STATE-STD-ABBRV = CP-STATE)
  2615        GO TO 9999-CALC-RATE-PREM-X
  2616     END-IF
  2617
  2618     IF (CP-COMPANY-ID = 'CID') AND
  2619        (CP-EARN-AS-NET-PAY) AND
  2620        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2621                            OR 'VT')
  2622                   OR
  2623        ((CP-STATE-STD-ABBRV = 'IN') AND
  2624        (CP-CERT-EFF-DT > X'9A7F'))
  2625                   OR
  2626        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2627        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2628        (CP-STATE-STD-ABBRV = CP-STATE)
  2629        GO TO 9999-CALC-RATE-PREM-X
  2630     END-IF
  2631
  2632     IF (CP-COMPANY-ID = 'CID') AND
  2633        (CP-EARN-AS-NET-PAY) AND
  2634        (CP-STATE-STD-ABBRV = 'TX') AND
  2635        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2636        (WS-DISCOUNT-OPTION NOT = ' ')
  2637        GO TO 9999-CALC-RATE-PREM-X
  2638     END-IF
  2639
  2640     if (cp-company-id = 'CID')
  2641        and (cp-state-std-abbrv = 'WA' or 'AL')
  2642        and (rt-discount-option = '1')
  2643        and (cp-earn-as-farm-plan)
  2644        go to 9999-calc-rate-prem-x
  2645     end-if
  2646     if (cp-company-id = 'CID')
  2647        and (cp-earn-as-reg-balloon)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  51
* ELRATE.cbl
  2648        and (cp-ben-category = 'P' or 'I')
  2649        GO TO 9999-CALC-RATE-PREM-X
  2650     end-if
  2651     IF (CP-COMPANY-ID = 'CID')
  2652        AND (CP-STATE-STD-ABBRV = 'MN')
  2653        AND (RT-DISCOUNT-OPTION = '1')
  2654        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2655           CP-EARN-AS-FARM-PLAN)
  2656        GO TO 9999-CALC-RATE-PREM-X
  2657     END-IF
  2658     IF (CP-COMPANY-ID = 'CID')
  2659        AND (CP-EARN-AS-NET-PAY)
  2660        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2661                      OR
  2662            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2663        GO TO 9999-CALC-RATE-PREM-X
  2664     END-IF
  2665     IF (CP-COMPANY-ID = 'CID')
  2666        AND (CP-EARN-AS-NET-PAY)
  2667        AND (CP-STATE-STD-ABBRV = 'SC')
  2668        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2669        GO TO 9999-CALC-RATE-PREM-X
  2670     END-IF
  2671     IF (CP-COMPANY-ID = 'CID') AND
  2672        (CP-EARN-AS-NET-PAY) AND
  2673        (CP-TRUNCATED-LIFE) AND
  2674        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2675        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2676        (WS-DISCOUNT-OPTION NOT = ' ')
  2677        GO TO 9999-CALC-RATE-PREM-X
  2678     END-IF
  2679
  2680     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP') AND
  2681        (CP-EARN-AS-NET-PAY)
  2682        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2683        GO TO 9999-CALC-RATE-PREM-X
  2684     END-IF
  2685
  2686     IF (CP-COMPANY-ID EQUAL 'CID')
  2687        AND (CP-EARN-AS-NET-PAY)
  2688        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2689        GO TO 9999-CALC-RATE-PREM-X
  2690     END-IF
  2691
  2692     IF (RT-IS-OB) AND
  2693        (CP-COMPANY-ID NOT EQUAL 'CID')
  2694        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2695               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2696      ELSE
  2697         IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2698            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2699            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2700*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2701             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2702               CP-ORIGINAL-TERM
  2703             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2704             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2705        ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  52
* ELRATE.cbl
  2706           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2707               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2708        END-IF
  2709     END-IF
  2710
  2711     IF CP-ROA-PREM-AT-REFUND
  2712         COMPUTE NET-BEN ROUNDED =
  2713             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2714     ELSE
  2715         COMPUTE NET-BEN ROUNDED =
  2716              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2717
  2718     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2719        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2720          COMPUTE NET-BEN ROUNDED =
  2721              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2722                         (CP-TERM-OR-EXT-DAYS / 30)).
  2723
  2724     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2725*       OR 'DCC'
  2726*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2727     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2728       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2729       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2730                        * CP-ORIGINAL-TERM / 1200))
  2731     ELSE
  2732     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2733       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2734       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2735
  2736****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2737****** INTEREST IS CHARGED ON PREMIUM.
  2738
  2739*    IF CP-STATE-STD-ABBRV = 'MI'
  2740*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2741*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2742
  2743     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2744
  2745     GO TO 9999-CALC-RATE-PREM-X.
  2746
  2747******
  2748****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2749******
  2750
  2751 1250-CSL-CALC.
  2752     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2753     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2754     MOVE '1' TO DC-OPTION-CODE.
  2755     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2756
  2757     IF DATE-CONVERSION-ERROR
  2758         MOVE '2' TO CP-RETURN-CODE
  2759         GO TO 9999-CALC-RATE-PREM-X.
  2760
  2761     IF CP-JOINT-INDICATOR = 'J'
  2762         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2763     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  53
* ELRATE.cbl
  2764         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2765
  2766     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2767     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2768
  2769     IF CP-PAY-FREQUENCY = 12
  2770         MOVE 01               TO WS-PAY-SCH.
  2771     IF CP-PAY-FREQUENCY = 04
  2772         MOVE 03               TO WS-PAY-SCH.
  2773     IF CP-PAY-FREQUENCY = 02
  2774         MOVE 06               TO WS-PAY-SCH.
  2775     IF CP-PAY-FREQUENCY = 01
  2776         MOVE 12               TO WS-PAY-SCH.
  2777
  2778     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2779     IF CP-PAY-FREQUENCY NOT = 12
  2780         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2781                                WS-NUM-PAYMTS.
  2782
  2783     IF CP-STATE = 'SC'  AND
  2784       (CP-BENEFIT-CD = '07'  OR  '08')
  2785         GO TO 1250-CSL-CALC-LIFE-6.
  2786
  2787     IF CP-CSL-METH-1
  2788         GO TO 1250-CSL-CALC-LIFE-1.
  2789
  2790     IF CP-CSL-METH-2
  2791         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2792                          WS-MAX-TOT-BEN
  2793             GO TO 1250-CSL-CALC-LIFE-2
  2794         ELSE
  2795             GO TO 1250-CSL-CALC-LIFE-1.
  2796
  2797     IF CP-CSL-METH-3
  2798         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2799             GO TO 1250-CSL-CALC-LIFE-2
  2800         ELSE
  2801             GO TO 1250-CSL-CALC-LIFE-3.
  2802
  2803     IF CP-CSL-METH-4
  2804         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2805                          WS-MAX-TOT-BEN
  2806             GO TO 1250-CSL-CALC-LIFE-5
  2807         ELSE
  2808             GO TO 1250-CSL-CALC-LIFE-4.
  2809
  2810 1250-CSL-CALC-LIFE-1.
  2811     IF CP-JOINT-INDICATOR = 'J'
  2812         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2813     ELSE
  2814         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2815
  2816     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2817                    365) - 1) * 365 / 12.
  2818     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2819                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2820                    4380.
  2821     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  54
* ELRATE.cbl
  2822                    WS-NUM-PAYMTS * WK-S.
  2823
  2824     GO TO 9999-CALC-RATE-PREM-X.
  2825
  2826 1250-CSL-CALC-LIFE-2.
  2827     IF CP-JOINT-INDICATOR = 'J'
  2828         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2829     ELSE
  2830         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2831
  2832     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2833     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2834     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2835                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2836                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2837     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2838                    WK-S) + WK-D.
  2839
  2840     GO TO 9999-CALC-RATE-PREM-X.
  2841
  2842 1250-CSL-CALC-LIFE-3.
  2843     IF CP-JOINT-INDICATOR = 'J'
  2844         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2845     ELSE
  2846         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2847
  2848     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2849     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2850     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2851                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2852                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2853     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2854                    WK-S) + WK-D.
  2855
  2856     GO TO 9999-CALC-RATE-PREM-X.
  2857
  2858 1250-CSL-CALC-LIFE-4.
  2859     IF CP-JOINT-INDICATOR = 'J'
  2860         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2861     ELSE
  2862         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2863
  2864     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2865     COMPUTE WK-S ROUNDED =
  2866                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2867                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2868                    CP-PAY-FREQUENCY.
  2869     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2870                    WS-NUM-PAYMTS * WK-S.
  2871
  2872     GO TO 9999-CALC-RATE-PREM-X.
  2873
  2874 1250-CSL-CALC-LIFE-5.
  2875     IF CP-JOINT-INDICATOR = 'J'
  2876         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2877     ELSE
  2878         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2879
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  55
* ELRATE.cbl
  2880     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2881     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2882                    CP-PAY-FREQUENCY.
  2883     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2884                    - 1) + WS-NUM-PAYMTS) * 12) /
  2885                    CP-PAY-FREQUENCY.
  2886     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2887     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2888                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2889
  2890     GO TO 9999-CALC-RATE-PREM-X.
  2891
  2892 1250-CSL-CALC-LIFE-6.
  2893
  2894     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2895                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2896
  2897     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2898                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2899
  2900     GO TO 9999-CALC-RATE-PREM-X.
  2901
  2902******
  2903****** END OF PREMIUM CALCULATIONS FOR CSL
  2904******
  2905
  2906 1260-GTL-PA-LEASE.
  2907
  2908     IF CP-REDUCING-LIFE
  2909         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2910                                 TO  CP-PREMIUM-RATE
  2911         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2912                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2913     ELSE
  2914         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2915                                 TO  CP-PREMIUM-RATE
  2916         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2917                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2918                 (+1 + CP-SALES-TAX) / +100.
  2919
  2920     GO TO 9999-CALC-RATE-PREM-X.
  2921
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  56
* ELRATE.cbl
  2923******************************************************************
  2924 2000-TYPE-IS-AH.
  2925     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2926
  2927     MOVE ZERO                      TO CP-R-MAX-AGE
  2928                                       CP-R-MAX-TERM
  2929                                       CP-R-MAX-MON-BEN
  2930                                       CP-R-MAX-TOT-BEN.
  2931
  2932     IF RT-CANCEL-FEE NUMERIC
  2933        MOVE RT-CANCEL-FEE          TO CP-CANCEL-FEE.
  2934
  2935     IF RT-COMPOSITE-RATE NOT NUMERIC
  2936        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2937
  2938     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2939        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2940                                 TO CP-PREMIUM-RATE
  2941                                    WS-PREMIUM-RATE
  2942        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2943     ELSE
  2944         MOVE +0                 TO CP-PREMIUM-RATE
  2945                                    CP-CALC-PREMIUM
  2946         GO TO 9999-CALC-RATE-PREM-X
  2947     END-IF
  2948
  2949     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  2950        AND (CP-DDF-SPEC-CALC = 'T')
  2951        AND (CP-LOAN-TERM > ZERO AND < 361)
  2952        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2953                                 TO CP-PREMIUM-RATE
  2954                                    WS-PREMIUM-RATE
  2955     END-IF
  2956*    IF (CP-COMPANY-ID = 'DCC')
  2957*       AND ((CP-BENEFIT-CD (1:1) = 'P')
  2958*       OR (CP-DDF-SPEC-CALC = 'T'))
  2959*       AND (CP-LOAN-TERM > ZERO AND < 361)
  2960*       MOVE RT-AH-RATE (CP-LOAN-TERM)
  2961*                                TO CP-PREMIUM-RATE
  2962*                                   WS-PREMIUM-RATE
  2963*    END-IF
  2964     MOVE +1 TO AHNDX.
  2965
  2966     IF CP-COMPANY-ID EQUAL 'CRI'
  2967        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2968           MOVE +5               TO AHNDX
  2969           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2970              MOVE 'F'           TO CP-RETURN-CODE
  2971              GO TO 2200-CALCULATE-PREMIUMS.
  2972
  2973     IF RT-AH-AGE (AHNDX) = ZERO
  2974          GO TO 2200-CALCULATE-PREMIUMS.
  2975
  2976 2100-SEARCH-AH-LIMITS.
  2977
  2978     IF CP-COMPANY-ID EQUAL 'CRI'
  2979        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2980           IF AHNDX GREATER THAN +4
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  57
* ELRATE.cbl
  2981              MOVE 'A'             TO CP-RETURN-CODE
  2982              GO TO 2200-CALCULATE-PREMIUMS.
  2983
  2984     IF AHNDX GREATER +8
  2985         MOVE 'A'                TO CP-RETURN-CODE
  2986         GO TO 2200-CALCULATE-PREMIUMS.
  2987
  2988     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2989         IF RT-AH-AGE (AHNDX) = ZEROS
  2990             ADD +1               TO AHNDX
  2991             GO TO 2100-SEARCH-AH-LIMITS
  2992         ELSE
  2993             MOVE RT-AH-AGE (AHNDX)
  2994                                 TO CP-R-MAX-AGE
  2995             MOVE RT-AH-TERM (AHNDX)
  2996                                 TO CP-R-MAX-TERM
  2997             MOVE RT-AH-BEN-M (AHNDX)
  2998                                 TO CP-R-MAX-MON-BEN
  2999             ADD +1               TO AHNDX
  3000             GO TO 2100-SEARCH-AH-LIMITS
  3001     ELSE
  3002         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  3003         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  3004         MOVE RT-AH-BEN-M (AHNDX)
  3005                                 TO CP-R-MAX-MON-BEN.
  3006
  3007     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  3008         MOVE '9'                 TO CP-RETURN-CODE.
  3009
  3010     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  3011         MOVE '8'                 TO CP-RETURN-CODE.
  3012
  3013     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  3014         GIVING WS-AH-FACE-BENEFIT.
  3015
  3016     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  3017         MOVE 'C'                 TO CP-RETURN-CODE.
  3018
  3019 2200-CALCULATE-PREMIUMS.
  3020
  3021     IF CP-COMPANY-ID = 'CSL'
  3022         GO TO 2250-CSL-CALC.
  3023
  3024*    IF CP-CRITICAL-PERIOD
  3025*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  3026
  3027     IF CP-CRITICAL-PERIOD
  3028        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3029           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  3030               OR 'S' OR 'P')
  3031                          OR
  3032                (CP-BEN-CATEGORY = 'G' OR 'L'))
  3033           CONTINUE
  3034        ELSE
  3035           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  3036        END-IF
  3037     END-IF
  3038
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  58
* ELRATE.cbl
  3039     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3040        AND (CP-BEN-CATEGORY = 'D')
  3041        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  3042           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  3043     END-IF
  3044     IF (CP-COMPANY-ID = 'CID')
  3045        AND (CP-STATE-STD-ABBRV = 'AL')
  3046        and (cp-pmt-mode <> spaces and low-values)
  3047        continue
  3048     else
  3049        go to 2200-continue
  3050     end-if
  3051
  3052     evaluate true
  3053        when cp-pmt-mode = 'B' *> Bi-Weekly
  3054           move 26               to c-pmts-per-year
  3055           move 14               to c-days-in-pmt-per
  3056        when cp-pmt-mode = 'W' *> Weekly
  3057           move 52               to c-pmts-per-year
  3058           move 07               to c-days-in-pmt-per
  3059        when cp-pmt-mode = 'S' *> Semi-Monthly
  3060           move 24               to c-pmts-per-year
  3061           move 15               to c-days-in-pmt-per
  3062        when cp-pmt-mode = 'A' *> Annual
  3063           move 1                to c-pmts-per-year
  3064           move 360              to c-days-in-pmt-per
  3065        when cp-pmt-mode = 'T' *> Semi-Annual
  3066           move 2                to c-pmts-per-year
  3067           move 180              to c-days-in-pmt-per
  3068        when cp-pmt-mode = 'Q' *> Quarterly
  3069           move 4                to c-pmts-per-year
  3070           move 90               to c-days-in-pmt-per
  3071        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  3072           move 6                to c-pmts-per-year
  3073           move 60               to c-days-in-pmt-per
  3074        when other             *> Assume Monthly
  3075           move 12               to c-pmts-per-year
  3076           move 30               to c-days-in-pmt-per
  3077     end-evaluate
  3078
  3079     compute c-tot-pmts =
  3080        cp-original-term / 12 * c-pmts-per-year
  3081
  3082     compute wk7 rounded =    *> tv3
  3083        (cp-original-benefit * +12) / c-pmts-per-year
  3084
  3085     compute wk6 rounded =
  3086        (wk7 * c-tot-pmts / 100) * cp-premium-rate
  3087
  3088     move wk6                    to cp-calc-premium
  3089
  3090     GO TO 9999-CALC-RATE-PREM-X
  3091
  3092     .
  3093 2200-continue.
  3094     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  3095        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  3096        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  59
* ELRATE.cbl
  3097                                     CP-PREMIUM-RATE
  3098        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  3099        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  3100        CP-PREMIUM-RATE) / +100
  3101     ELSE
  3102        IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3103           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  3104           MOVE CP-PREMIUM-RATE  TO WK-S
  3105*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  3106           IF CP-RATE-DEV-PCT NOT = ZEROS
  3107              COMPUTE WK-S ROUNDED =
  3108                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  3109           END-IF
  3110           IF CP-BENEFIT-CD (1:1) = 'M'
  3111              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3112              CP-ORIGINAL-BENEFIT * WK-S / 100
  3113           ELSE
  3114              IF CP-BENEFIT-CD (1:1) = 'H'
  3115                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3116                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3117                    WK-S) / 1000
  3118              ELSE
  3119                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  3120                    GO TO 2300-CALC-DCC-MOB-NET-AH
  3121                 ELSE
  3122                    IF CP-BEN-CATEGORY = 'D'
  3123                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3124                        CP-ORIGINAL-BENEFIT *
  3125                        CP-ORIGINAL-TERM * WK-S / 100
  3126                    ELSE
  3127                      IF CP-BENEFIT-CD (1:1) = 'P'
  3128                         GO TO 2300-CALC-DCC-BEN-P-AH
  3129                      ELSE
  3130                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3131                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3132                        WK-S) / 100
  3133                      END-IF
  3134                    END-IF
  3135                 END-IF
  3136              END-IF
  3137           END-IF
  3138           MOVE ZEROS            TO CP-RATE-DEV-PCT
  3139        ELSE
  3140           IF CP-BENEFIT-CD (1:1) = 'M'
  3141              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3142                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  3143           ELSE
  3144              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  3145                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3146                    (CP-NET-BENEFIT-AMT *
  3147                    CP-PREMIUM-RATE) / 1000
  3148              ELSE
  3149                 IF CP-AH-BALLOON-SW = 'Y'
  3150                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  3151                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  3152                      CP-PREMIUM-RATE) / 100
  3153                 ELSE
  3154                   COMPUTE CP-CALC-PREMIUM ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  60
* ELRATE.cbl
  3155                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  3156                    CP-PREMIUM-RATE) / 100
  3157                 END-IF
  3158              END-IF
  3159           END-IF
  3160        END-IF
  3161     END-IF
  3162
  3163     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3164        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  3165        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  3166     END-IF
  3167     IF CP-TERM-OR-EXT-DAYS = ZEROS
  3168         GO TO 9999-CALC-RATE-PREM-X.
  3169
  3170     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  3171         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3172             CP-CALC-PREMIUM +
  3173                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  3174                                       * CP-TERM-OR-EXT-DAYS).
  3175
  3176     GO TO 9999-CALC-RATE-PREM-X.
  3177
  3178 2200-CRITICAL-PERIOD-AH-CONT.
  3179
  3180     IF CP-COMPANY-ID = 'WDS'
  3181         IF CP-ORIGINAL-TERM GREATER THAN 60
  3182             MOVE 60              TO CP-LOAN-TERM.
  3183
  3184     IF CP-COMPANY-ID EQUAL 'CVL'
  3185         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3186           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3187                                       * CP-PREMIUM-RATE
  3188         GO TO 9999-CALC-RATE-PREM-X.
  3189
  3190     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3191           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3192                                       * CP-PREMIUM-RATE.
  3193
  3194     GO TO 9999-CALC-RATE-PREM-X.
  3195
  3196 2250-CSL-CALC.
  3197
  3198     IF RT-DAILY-RATE NOT NUMERIC OR
  3199        RT-DAILY-RATE = ZEROS
  3200            MOVE ZEROS TO CP-CALC-PREMIUM
  3201            MOVE '7' TO CP-RETURN-CODE
  3202            GO TO 9999-CALC-RATE-PREM-X.
  3203
  3204     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  3205     COMPUTE WK-MONTHLY-RATE =
  3206          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3207
  3208     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3209     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3210     MOVE '1' TO DC-OPTION-CODE.
  3211     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3212     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  61
* ELRATE.cbl
  3213         MOVE '2' TO CP-RETURN-CODE
  3214         GO TO 9999-CALC-RATE-PREM-X.
  3215
  3216     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3217     IF CP-CSL-METH-1
  3218         GO TO 2250-CSL-CALC-AH-1.
  3219     IF CP-CSL-METH-2
  3220         GO TO 2250-CSL-CALC-AH-2.
  3221     IF CP-CSL-METH-3
  3222         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3223             GO TO 2250-CSL-CALC-AH-4
  3224         ELSE
  3225             GO TO 2250-CSL-CALC-AH-3.
  3226
  3227 2250-CSL-CALC-AH-1.
  3228
  3229     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3230     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3231                    + WK-MONTHLY-RATE.
  3232     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3233                    CP-ORIGINAL-TERM * WK-D.
  3234
  3235     GO TO 9999-CALC-RATE-PREM-X.
  3236
  3237
  3238 2250-CSL-CALC-AH-2.
  3239     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3240     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3241                    + WK-MONTHLY-RATE.
  3242     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3243                    CP-ORIGINAL-TERM * WK-D.
  3244
  3245     GO TO 9999-CALC-RATE-PREM-X.
  3246
  3247 2250-CSL-CALC-AH-3.
  3248
  3249     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3250     COMPUTE WK-T = WK-K + 1.
  3251     COMPUTE WK-MONTHLY-RATE-T =
  3252          RT-AH-RATE (WK-T) / 100.
  3253     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3254
  3255     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3256     IF WK-T1 EQUAL ZEROS
  3257         MOVE ZEROS TO CP-CALC-PREMIUM
  3258         MOVE 'G' TO CP-RETURN-CODE
  3259         GO TO 9999-CALC-RATE-PREM-X.
  3260
  3261     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3262                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3263                    - WK-T)).
  3264     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3265     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3266                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3267                       WS-MAX-TOT-BEN).
  3268     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3269                    WK-MONTHLY-RATE-T) + WK-PREM.
  3270
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  62
* ELRATE.cbl
  3271     GO TO 9999-CALC-RATE-PREM-X.
  3272
  3273 2250-CSL-CALC-AH-4.
  3274     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3275     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3276     COMPUTE WK-MONTHLY-RATE-J =
  3277          RT-AH-RATE (WK-J) / 100.
  3278     COMPUTE WK-T = WK-J + 1.
  3279     COMPUTE WK-MONTHLY-RATE-T =
  3280          RT-AH-RATE (WK-T) / 100.
  3281     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3282     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3283                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3284                    (CP-ORIGINAL-TERM - WK-T)).
  3285     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3286     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3287                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3288                       WS-MAX-TOT-BEN).
  3289     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3290                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3291
  3292     GO TO 9999-CALC-RATE-PREM-X.
  3293
  3294 2300-CALC-DCC-BEN-P-AH.
  3295     IF CP-NO-OF-PMTS NOT NUMERIC
  3296        MOVE +0                  TO CP-NO-OF-PMTS
  3297     END-IF
  3298     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3299        AND ' ' AND 'M'
  3300        MOVE ' '                 TO CP-PMT-MODE
  3301     END-IF
  3302******************************************************************
  3303***   Default is monthly, use loan term for rate and amort     ***
  3304******************************************************************
  3305     move cp-loan-term         to c-tot-pmts
  3306     MOVE +30                  TO C-DAYS-IN-PMT-PER
  3307     MOVE +12                  TO C-PMTS-PER-YEAR
  3308******************************************************************
  3309
  3310     evaluate true
  3311        when cp-pmt-mode = 'W'
  3312           MOVE +52              TO C-PMTS-PER-YEAR
  3313           compute c-tot-pmts = cp-loan-term /
  3314              12 * c-pmts-per-year
  3315           MOVE +7               TO C-DAYS-IN-PMT-PER
  3316        when cp-pmt-mode = 'B'
  3317           MOVE +26              TO C-PMTS-PER-YEAR
  3318           compute c-tot-pmts = cp-loan-term /
  3319              12 * c-pmts-per-year
  3320           MOVE +14              TO C-DAYS-IN-PMT-PER
  3321     end-evaluate
  3322     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3323     if i = zeros
  3324        move .0000000001         to i
  3325     end-if
  3326     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3327        C-DAYS-IN-PMT-PER)) / (1 + I)
  3328     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  63
* ELRATE.cbl
  3329     COMPUTE ANGLEN-1 = ANGLEN / Y
  3330     COMPUTE WK3 = (CP-NET-BENEFIT-AMT - CP-ORIGINAL-PREMIUM)
  3331        / ANGLEN-1
  3332     if cp-net-benefit-amt = zeros
  3333        compute wk3 = cp-original-benefit - cp-original-premium
  3334     end-if
  3335     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3336     GO TO 9999-CALC-RATE-PREM-X
  3337     .
  3338 2300-CALC-DCC-MOB-NET-AH.
  3339     IF CP-ALTERNATE-BENEFIT = ZEROS
  3340        CONTINUE
  3341     ELSE
  3342        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3343     END-IF
  3344     MOVE CP-ORIGINAL-TERM       TO M
  3345     MOVE CP-LOAN-TERM           TO N
  3346     IF N = ZEROS
  3347        MOVE M                   TO N
  3348     END-IF
  3349     COMPUTE I = CP-LOAN-APR / +1200
  3350     if i = zeros
  3351        move .0000000001         to i
  3352     end-if
  3353     IF CP-BENEFIT-CD (1:1) = 'S'
  3354        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3355        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3356        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3357          (WK-S / 1000)
  3358          * 1
  3359        MOVE WK3                 TO CP-CALC-PREMIUM
  3360        GO TO 9999-CALC-RATE-PREM-X
  3361     END-IF
  3362     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3363        / (1 + I)
  3364     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3365          ** ((N - M) * -1))) / I)
  3366     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3367     COMPUTE J = I + (WK-S / +1000)
  3368     COMPUTE WK2 = (1 + J) ** (M * -1)
  3369     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3370     COMPUTE ANGLEM = ((1 - ((1 + J)
  3371          ** (M * -1))) / J) / OD
  3372     IF CP-NET-BENEFIT-AMT = ZEROS
  3373        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3374           * ANGLEM
  3375     END-IF
  3376     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3377     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3378          ** ((N - M) * -1))) / I)
  3379     MOVE +0                     TO WK3
  3380     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3381        (WS-COUNTER > M)
  3382        COMPUTE ANGLEM = (1 - ((1 + J)
  3383          ** ((M - WS-COUNTER + 1) * -1))) / J
  3384        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3385        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3386        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  64
* ELRATE.cbl
  3387     END-PERFORM
  3388     MOVE WK3                    TO CP-CALC-PREMIUM
  3389     GO TO 9999-CALC-RATE-PREM-X
  3390     .
  3391 2300-CALC-DCC-MOB-BAL-AH.
  3392     IF CP-BENEFIT-CD (1:1) = 'S'
  3393        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3394     END-IF
  3395     MOVE CP-ORIGINAL-TERM       TO M
  3396     MOVE CP-LOAN-TERM           TO N
  3397     IF N = ZEROS
  3398        MOVE M                   TO N
  3399     END-IF
  3400     COMPUTE I = CP-LOAN-APR / +1200
  3401     if i = zeros
  3402        move .0000000001         to i
  3403     end-if
  3404     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3405        / (1 + I)
  3406     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3407     COMPUTE J = I + (WK-S / +1000)
  3408     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3409     MOVE I TO K
  3410     COMPUTE WK2 = (1 + J) ** (M * -1)
  3411     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3412     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3413          ** ((M - 1) * -1))) / J)
  3414     COMPUTE ANGLEM = ((1 - ((1 + J)
  3415          ** (M * -1))) / J) / OD
  3416     IF CP-NET-BENEFIT-AMT = ZEROS
  3417        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3418           * ANGLEM
  3419     END-IF
  3420     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3421        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3422        / ANGLEM-1
  3423     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3424          ** ((N - M) * -1))) / I)
  3425     MOVE +0                     TO WK3
  3426     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3427        (WS-COUNTER > M)
  3428        COMPUTE ANGLEM = (1 - ((1 + J)
  3429          ** ((M - WS-COUNTER) * -1))) / J
  3430        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3431        COMPUTE WK5-CSL = (RA * ANGLEM)
  3432        + (CP-ALTERNATE-BENEFIT * WK2)
  3433        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3434          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3435          (WK-S / 1000)
  3436     END-PERFORM
  3437     MOVE WK3                    TO CP-CALC-PREMIUM
  3438     GO TO 9999-CALC-RATE-PREM-X
  3439     .
  3440 2300-CALC-DCC-MOB-BAL-AHSUM.
  3441     MOVE CP-ORIGINAL-TERM       TO M
  3442     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3443        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3444        * WK-S / 1000
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  65
* ELRATE.cbl
  3445*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3446*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3447*       * WK-S / 1000
  3448     MOVE WK3                    TO CP-CALC-PREMIUM
  3449     GO TO 9999-CALC-RATE-PREM-X
  3450     .
  3451 9999-RATE-NOTFND.
  3452     MOVE '6'                    TO CP-RETURN-CODE.
  3453     GO TO 9999-CALC-RATE-PREM-X.
  3454
  3455 9999-RATE-NOTOPEN.
  3456     MOVE 'D'                    TO CP-RETURN-CODE.
  3457     GO TO 9999-CALC-RATE-PREM-X.
  3458
  3459 9999-CALC-RATE-PREM-X.
  3460     IF (CP-COMPANY-ID = 'DCC' OR 'VPP')
  3461        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3462        CONTINUE
  3463     ELSE
  3464        IF CP-RATE-DEV-PCT NOT = ZERO
  3465           COMPUTE CP-CALC-PREMIUM =
  3466              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3467
  3468
  3469     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3470
  3471     IF WS-BROWSE-STARTED
  3472
  3473* EXEC CICS ENDBR
  3474*            DATASET  (ERRATE-FILE-ID)
  3475*       END-EXEC.
  3476     MOVE 0
  3477       TO DFHEIV11
  3478*    MOVE '&2                    $   #00003431' TO DFHEIV0
  3479     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3480     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3481     MOVE X'2020233030303033343331' TO DFHEIV0(25:11)
  3482     CALL 'kxdfhei1' USING DFHEIV0,
  3483           ERRATE-FILE-ID,
  3484           DFHEIV11,
  3485           DFHEIV99
  3486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3487
  3488
  3489
  3490* EXEC CICS RETURN
  3491*    END-EXEC.
  3492*    MOVE '.(                    ''   #00003435' TO DFHEIV0
  3493     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3494     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3495     MOVE X'2020233030303033343335' TO DFHEIV0(25:11)
  3496     CALL 'kxdfhei1' USING DFHEIV0,
  3497           DFHEIV99,
  3498           DFHEIV99,
  3499           DFHEIV99,
  3500           DFHEIV99,
  3501           DFHEIV99,
  3502           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  66
* ELRATE.cbl
  3503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3504
  3505
  3506 9100-CONVERT-DATE.
  3507
  3508* EXEC CICS LINK
  3509*        PROGRAM  ('ELDATCV')
  3510*        COMMAREA (DATE-CONVERSION-DATA)
  3511*        LENGTH   (DC-COMM-LENGTH)
  3512*    END-EXEC.
  3513     MOVE 'ELDATCV' TO DFHEIV1
  3514*    MOVE '."C                   (   #00003439' TO DFHEIV0
  3515     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3517     MOVE X'2020233030303033343339' TO DFHEIV0(25:11)
  3518     CALL 'kxdfhei1' USING DFHEIV0,
  3519           DFHEIV1,
  3520           DATE-CONVERSION-DATA,
  3521           DC-COMM-LENGTH,
  3522           DFHEIV99,
  3523           DFHEIV99,
  3524           DFHEIV99,
  3525           DFHEIV99
  3526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3527
  3528
  3529 9100-EXIT.
  3530     EXIT.
  3531
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  67
* ELRATE.cbl
  3533 10000-NET-TERM SECTION.
  3534*                         COPY ERCNETP.
  3535*****************************************************************
  3536*                                                               *
  3537*                            ERCNETP                            *
  3538*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3539*                            VMOD=2.029                         *
  3540*                                                               *
  3541*****************************************************************.
  3542*
  3543*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3544*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3545*                                   ORIGINAL TERM (S999)
  3546*                                   REMAINING TERM (S999)
  3547*                                   NET PAY OPTION (X)
  3548*                                   LOAN TERM (S999)
  3549*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3550*
  3551*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3552*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3553*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3554*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3555*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3556*    CHARGED.
  3557*
  3558*    OPTIONS - S = NET SIMPLE
  3559*          SPACE = NET PAY  (1 MO. INTEREST)
  3560*              A = NET PAY  (0 MO. INTEREST)
  3561*              I = NET PAY  (2 MO. INTEREST)
  3562*              J = NET PAY  (3 MO. INTEREST)
  3563*              K = NET PAY  (4 MO. INTEREST)
  3564*              T = TRUNCATED  (0 MO. INTEREST)
  3565*              U = TRUNCATED  (1 MO. INTEREST)
  3566*              V = TRUNCATED  (2 MO. INTEREST)
  3567*              W = TRUNCATED  (3 MO. INTEREST)
  3568*              X = TRUNCATED  (4 MO. INTEREST)
  3569*              R = REFUNDS (REGULAR OR TRUNCATED)
  3570******************************************************************
  3571*                   C H A N G E   L O G
  3572*
  3573* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3574*-----------------------------------------------------------------
  3575*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3576* EFFECTIVE    NUMBER
  3577*-----------------------------------------------------------------
  3578* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3579* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3580* 120403                   PEMA  ADD SPECIAL TX CALC
  3581* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3582* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3583* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3584* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3585* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3586* 021207                   PEMA  ADD PA NP
  3587* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3588* 032807                   PEMA  ADD VT NP PLUS 2
  3589* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3590* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  68
* ELRATE.cbl
  3591* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3592* 110207      TO 'AL' NET PAY CALC
  3593* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3594* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3595* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3596* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3597* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3598* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3599* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3600* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3601* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3602* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3603* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3604* 032612  CR2011110200001  PEMA  AHL CHANGES
  3605* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3606* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  3607* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  3608* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  3609* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOON
  3610* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3611* 021519  CR2019021100001  PEMA  non-monthly AL calcs
  3612* 012820  CR2020010600001  PEMA  MOD TX NP FORMULA TO HANDLE TRUNC
  3613* 012820    CONTINUED   AND TO ADJ AF FOR EXTRA DAYS.
  3614******************************************************************
  3615
  3616     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3617     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3618     MOVE N-P-LOAN    TO LOAN-TERM.
  3619     MOVE N-P-REM     TO REMAINING-TERM.
  3620     MOVE N-P-OPT     TO OPTION-SW.
  3621
  3622     MOVE +0 TO FACTOR.
  3623     if cp-company-id = 'CID'
  3624        if annual-int-rate = +99.9999
  3625           go to 99000-error
  3626        end-if
  3627     else
  3628        if annual-int-rate = zero
  3629           go to 99000-error
  3630        end-if
  3631     end-if
  3632     IF ORIGINAL-TERM = ZERO
  3633         GO TO 99999-RETURN.
  3634     IF REMAINING-TERM = ZERO
  3635         GO TO 99999-RETURN.
  3636     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3637         GO TO 99000-ERROR.
  3638     IF LOAN-TERM = ZERO
  3639         GO TO 99999-RETURN.
  3640     IF LOAN-TERM LESS ORIGINAL-TERM
  3641         GO TO 99000-ERROR.
  3642
  3643*    IF ANNUAL-INT-RATE LESS +2
  3644*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3645*    IF ANNUAL-INT-RATE LESS +2
  3646*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3647*    IF ANNUAL-INT-RATE LESS +2
  3648*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  69
* ELRATE.cbl
  3649
  3650     IF NPO-REFUND
  3651         MOVE '2' TO NP-PROCESS-SW
  3652       ELSE
  3653         IF ORIGINAL-TERM = REMAINING-TERM
  3654            MOVE '1'   TO NP-PROCESS-SW
  3655           ELSE
  3656            MOVE '3'   TO NP-PROCESS-SW.
  3657
  3658     IF NPO-SIMPLE
  3659         MOVE 'S' TO TYPE-SW
  3660     ELSE
  3661         MOVE 'N' TO TYPE-SW.
  3662
  3663     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3664     if i = zeros
  3665        move .0000000001         to i
  3666     end-if
  3667
  3668     COMPUTE V ROUNDED = K1 / (K1 + I).
  3669
  3670     MOVE V     TO VX
  3671                   SV.
  3672
  3673     MOVE +1    TO X1
  3674                   SX.
  3675
  3676     MOVE LOAN-TERM TO MAX-X.
  3677
  3678     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3679
  3680     IF MAX-X = +1
  3681        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3682
  3683     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3684
  3685     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3686         OR 'DCC' or 'VPP' OR 'NCL') AND
  3687        (NOT NP-REFUND)
  3688        NEXT SENTENCE
  3689     ELSE
  3690     IF LOAN-TERM NOT = ORIGINAL-TERM
  3691        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3692
  3693     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3694
  3695 10500-VX-LOOP.
  3696
  3697***  VX = AMORT. LOAN TERM.
  3698***  SV = AMORT. INSURANCE TERM.
  3699***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3700***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3701***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3702
  3703     IF X2 = 1
  3704        MOVE V         TO SX
  3705     END-IF
  3706     COMPUTE VX ROUNDED = VX * V.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  70
* ELRATE.cbl
  3707
  3708     ADD B1 TO X1.
  3709
  3710     IF X1 = REMAINING-TERM
  3711          MOVE VX    TO SV.
  3712
  3713     IF X1 EQUAL SV-MINUS-ONE
  3714        MOVE VX      TO SV-MINUS-ONE.
  3715
  3716     IF X1 = X2
  3717          MOVE VX    TO SX.
  3718
  3719     IF X1 NOT = MAX-X
  3720          GO TO 10500-VX-LOOP.
  3721
  3722 10700-COMPUTE-REMAINING-FACTOR.
  3723*****  WK1 = LOAN TERM AMORT
  3724     COMPUTE WK1 = K1 - VX.
  3725*****  WK2 = INS TERM AMORT
  3726     COMPUTE WK2 = K1 - SV.
  3727*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3728     COMPUTE WK5 = K1 - SX.
  3729*****  WK6 = INS TERM - 1
  3730     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3731
  3732     IF NP-RATING
  3733         GO TO 12000-PREMIUM-RATE.
  3734
  3735     IF NP-REFUND
  3736         GO TO 11000-REFUND-CALC.
  3737
  3738     IF NET-STD
  3739         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3740
  3741     IF NET-SMP
  3742         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3743         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3744         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3745         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3746
  3747     IF REMAINING-TERM LESS THAN X2
  3748         MOVE +0 TO WK3.
  3749
  3750     MOVE WK3 TO FACTOR.
  3751
  3752     GO TO 99999-RETURN.
  3753
  3754 11000-REFUND-CALC.
  3755     IF REMAINING-TERM NOT LESS MAX-X
  3756        MOVE +1 TO FACTOR
  3757        GO TO 99999-RETURN.
  3758
  3759     IF REMAINING-TERM LESS +1
  3760        MOVE 0 TO FACTOR
  3761        GO TO 99999-RETURN.
  3762
  3763     COMPUTE WK2 ROUNDED = WK2 / I.
  3764     COMPUTE WK5 ROUNDED = WK5 / I.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  71
* ELRATE.cbl
  3765     COMPUTE WK1 ROUNDED = WK1 / I.
  3766
  3767     IF (CP-COMPANY-ID EQUAL 'CID')
  3768        AND (CP-STATE-STD-ABBRV = 'MN')
  3769        AND (CP-CERT-EFF-DT > X'A4FF')
  3770        AND (CP-RATE-AS-REG-BALLOON)
  3771        AND (CP-EARN-AS-NET-PAY)
  3772        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3773        CONTINUE
  3774     ELSE
  3775        GO TO 11000-CHECK-MN-LEV-BALLOON
  3776     END-IF
  3777
  3778     COMPUTE R = M - E
  3779     COMPUTE FACTOR = (R - WK2 + WK5) /
  3780        (M - WK1 + WK5)
  3781
  3782     GO TO 99999-RETURN
  3783
  3784      .
  3785 11000-CHECK-MN-LEV-BALLOON.
  3786
  3787     IF (CP-COMPANY-ID EQUAL 'CID')
  3788        AND (CP-STATE-STD-ABBRV = 'MN')
  3789        AND (CP-CERT-EFF-DT > X'A4FF')
  3790        AND (CP-RATE-AS-REG-BALLOON)
  3791        AND (CP-EARN-AS-NET-PAY)
  3792        AND (CP-DEVIATION-CODE = 'LEV')
  3793        CONTINUE
  3794     ELSE
  3795        GO TO 11000-CONTINUE-REFUND
  3796     END-IF
  3797
  3798     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3799     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3800        ** (M - E)) / I
  3801
  3802     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3803
  3804     GO TO 99999-RETURN
  3805
  3806     .
  3807 11000-CONTINUE-REFUND.
  3808*    IF CP-GAP-ACTUARIAL
  3809*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3810*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3811*       COMPUTE WK3 = WK2 / ANGLEN
  3812*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3813     IF CP-GAP-ACTUARIAL
  3814        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3815           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3816        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3817     ELSE
  3818        COMPUTE WK3 ROUNDED =
  3819          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3820     END-IF
  3821
  3822     MOVE WK3  TO FACTOR.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  72
* ELRATE.cbl
  3823
  3824     GO TO 99999-RETURN.
  3825
  3826 12000-PREMIUM-RATE.
  3827*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3828*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3829*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3830*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3831*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3832*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3833
  3834     COMPUTE K-I = K1 + I.
  3835     MOVE K-I TO ONE-PLUS-I.
  3836
  3837     IF NPO-ALT OR NPO-TRUNC-0
  3838         MOVE K1 TO K-I.
  3839
  3840     IF NPO-2MO OR NPO-TRUNC-2
  3841         COMPUTE K-I = K1 + (2 * I).
  3842
  3843     IF NPO-3MO OR NPO-TRUNC-3
  3844         COMPUTE K-I = K1 + (3 * I).
  3845
  3846     IF NPO-4MO OR NPO-TRUNC-4
  3847         COMPUTE K-I = K1 + (4 * I).
  3848
  3849     COMPUTE RA ROUNDED = 1 -
  3850             ((X2 * (X2 + 1)) /
  3851              (N *  (N  + 1))).
  3852
  3853     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3854        (CP-CSL-VALID-NP-BENEFIT-CD)
  3855        NEXT SENTENCE
  3856     ELSE
  3857        GO TO XXXX-CHECK-DISCOUNT-5.
  3858
  3859     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3860     MOVE ' ' TO DC-OPTION-CODE.
  3861     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3862
  3863     IF DATE-CONVERSION-ERROR
  3864        MOVE '2'                 TO CP-RETURN-CODE
  3865        MOVE ZEROS               TO FACTOR
  3866                                    CP-CALC-PREMIUM
  3867         GO TO 99999-RETURN.
  3868
  3869     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3870     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3871     MOVE ' ' TO DC-OPTION-CODE
  3872     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3873
  3874     IF DATE-CONVERSION-ERROR
  3875        MOVE '2'                 TO CP-RETURN-CODE
  3876        MOVE ZEROS               TO FACTOR
  3877                                    CP-CALC-PREMIUM
  3878         GO TO 99999-RETURN.
  3879
  3880     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  73
* ELRATE.cbl
  3881
  3882     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  3883
  3884     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3885        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3886        CP-PAY-FREQUENCY / 365) * I
  3887     ELSE
  3888        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3889        CP-PAY-FREQUENCY / 365) * I.
  3890
  3891     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3892     13).
  3893
  3894     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3895     (N - ( ANGLEN-1 / WK3)).
  3896
  3897     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3898
  3899     COMPUTE WS-CALC-FREQ-RATE EQUAL
  3900       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3901
  3902     COMPUTE WS-Y-X-FACTOR EQUAL
  3903       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3904       WS-CALC-FREQ-RATE).
  3905
  3906     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3907       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3908
  3909     COMPUTE WS-X-Y-FACTOR EQUAL
  3910       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3911
  3912     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3913       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3914       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3915
  3916     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3917
  3918     GO TO 99999-RETURN.
  3919
  3920 XXXX-CHECK-DISCOUNT-5.
  3921
  3922     IF WS-DISCOUNT-OPTION EQUAL '5'
  3923        NEXT SENTENCE
  3924     ELSE
  3925        GO TO 12000-CHECK-CLIENT.
  3926
  3927      COMPUTE ANGLEN EQUAL WK1 / I.
  3928
  3929      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3930
  3931      COMPUTE WK3 EQUAL
  3932        (12 *
  3933        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3934        CP-ORIGINAL-BENEFIT)) /
  3935        APR100.
  3936
  3937     COMPUTE WK3 EQUAL
  3938        (WK3 * CP-PREMIUM-RATE) / +1000.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  74
* ELRATE.cbl
  3939
  3940     COMPUTE WK3 EQUAL
  3941        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3942
  3943      MOVE WK3 TO CP-CALC-PREMIUM.
  3944
  3945     GO TO 99999-RETURN.
  3946
  3947 12000-CHECK-CLIENT.
  3948
  3949     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3950        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3951        (CP-TRUNCATED-LIFE)
  3952        NEXT SENTENCE
  3953     ELSE
  3954        GO TO 12000-CHECK-NEXT.
  3955
  3956     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3957
  3958     COMPUTE ANGLEN EQUAL WK1 / I.
  3959     COMPUTE ANGLEM EQUAL WK2 / I.
  3960
  3961     COMPUTE FM EQUAL
  3962                    (((ONE-PLUS-I ** M) * I * M) /
  3963                    ((ONE-PLUS-I ** M) - 1))
  3964                    - 1.
  3965
  3966     COMPUTE FN EQUAL
  3967                    (((ONE-PLUS-I ** N) * I * N) /
  3968                    ((ONE-PLUS-I ** N) - 1))
  3969                    - 1.
  3970
  3971     COMPUTE FNM EQUAL
  3972                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3973                    ((ONE-PLUS-I ** (N - M)) - 1))
  3974                    - 1.
  3975
  3976     COMPUTE GR EQUAL
  3977                    (WS-WORK-RATE * ANGLEM * I) /
  3978                    (M - ANGLEM).
  3979
  3980     COMPUTE ODF EQUAL
  3981                     (1 +
  3982                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3983                     360)) /
  3984                     ONE-PLUS-I.
  3985
  3986     COMPUTE OD EQUAL
  3987                    (1 + (ODF * (FN / I - 1))) +
  3988                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3989
  3990     COMPUTE WK3 EQUAL
  3991*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3992                    ((1 + FN) * ODF *
  3993                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3994                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3995                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3996
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  75
* ELRATE.cbl
  3997     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3998     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  3999
  4000     COMPUTE WK3 EQUAL
  4001                    (WK3 / (ODF * (1 + FN))) -
  4002*                   CP-ORIGINAL-BENEFIT.
  4003                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  4004
  4005      MOVE WK3 TO CP-CALC-PREMIUM.
  4006
  4007     GO TO 99999-RETURN.
  4008
  4009 12000-CHECK-NEXT.
  4010
  4011     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  4012        NEXT SENTENCE
  4013     ELSE
  4014        GO TO 12000-CHECK-PA-TRUNC.
  4015
  4016      IF WS-WORK-DIS-RATE EQUAL +0
  4017         MOVE '7'                TO CP-RETURN-CODE
  4018         MOVE ZEROS              TO FACTOR
  4019                                    CP-CALC-PREMIUM
  4020         GO TO 99999-RETURN.
  4021
  4022      COMPUTE ANGLEN EQUAL WK1 / I.
  4023
  4024      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  4025
  4026      IF WS-WORK-DIS-RATE EQUAL APR100
  4027         ADD .00001 TO APR100.
  4028
  4029      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  4030      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  4031
  4032     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4033        / (1 + I)
  4034     COMPUTE ANGLEN-1 = ANGLEN / Y
  4035      IF CP-COMPANY-ID EQUAL 'CDL'
  4036         COMPUTE WK3 EQUAL
  4037
  4038          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  4039          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  4040
  4041          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  4042
  4043          ((WK8 ** N) /
  4044          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  4045
  4046          ((WK9 ** N) /
  4047          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  4048
  4049      ELSE
  4050         COMPUTE WK3 EQUAL
  4051
  4052          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  4053          (12 + WS-WORK-DIS-RATE) * 12) *
  4054
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  76
* ELRATE.cbl
  4055          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  4056
  4057          ((WK8 ** N) /
  4058          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  4059
  4060          ((WK9 ** N) /
  4061          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  4062
  4063      COMPUTE WK3 EQUAL
  4064          (WK3 * CP-PREMIUM-RATE) / +1000.
  4065
  4066      MOVE WK3 TO CP-CALC-PREMIUM.
  4067
  4068     GO TO 99999-RETURN.
  4069
  4070 12000-CHECK-PA-TRUNC.
  4071
  4072     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4073        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  4074        (CP-EARN-AS-NET-PAY) AND
  4075        (CP-TRUNCATED-LIFE)
  4076        NEXT SENTENCE
  4077     ELSE
  4078        GO TO 12000-CHECK-MD-TRUNC.
  4079
  4080     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4081
  4082     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4083     COMPUTE ANGLEN EQUAL WK1 / I.
  4084
  4085     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4086
  4087     COMPUTE WK3 EQUAL
  4088        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  4089        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  4090
  4091     MOVE WK3 TO CP-CALC-PREMIUM.
  4092
  4093     GO TO 99999-RETURN.
  4094
  4095 12000-CHECK-MD-TRUNC.
  4096
  4097     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4098        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4099        (CP-EARN-AS-NET-PAY) AND
  4100        (CP-TRUNCATED-LIFE)
  4101        NEXT SENTENCE
  4102     ELSE
  4103        GO TO 12000-CHECK-MD.
  4104
  4105     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4106
  4107     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4108     COMPUTE ANGLEM EQUAL WK2 / I.
  4109     COMPUTE ANGLEN EQUAL WK1 / I.
  4110
  4111     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4112
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  77
* ELRATE.cbl
  4113     COMPUTE WK3 EQUAL
  4114        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4115        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  4116        (ANGLEN-1 * (M - ANGLEM))).
  4117
  4118     MOVE WK3 TO CP-CALC-PREMIUM.
  4119
  4120     GO TO 99999-RETURN.
  4121
  4122 12000-CHECK-MD.
  4123
  4124     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4125        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4126        (CP-EARN-AS-NET-PAY)
  4127        NEXT SENTENCE
  4128     ELSE
  4129        GO TO 12000-CHECK-ME-TRUNC.
  4130
  4131     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4132
  4133     COMPUTE WK3 EQUAL
  4134        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  4135
  4136     MOVE WK3 TO CP-CALC-PREMIUM.
  4137
  4138     GO TO 99999-RETURN.
  4139
  4140 12000-CHECK-ME-TRUNC.
  4141
  4142     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  4143        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4144        AND (CP-EARN-AS-NET-PAY)
  4145        AND (CP-TRUNCATED-LIFE)
  4146        CONTINUE
  4147     ELSE
  4148        GO TO 12000-CHECK-CID-WA-FARMPLAN
  4149     END-IF
  4150
  4151     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4152     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4153     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4154     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4155     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4156     COMPUTE ANGLEN-1 = ANGLEN / Y
  4157     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4158     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4159     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  4160     COMPUTE WK3
  4161        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  4162        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  4163            * (1 / (1.0635 ** (M / 12))))
  4164*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  4165*    COMPUTE WK9 EQUAL
  4166*       1 / (1 + (.045 * (N - M) / 24))
  4167*    COMPUTE WK7 EQUAL
  4168*       WS-WORK-RATE * 20 / (M + 1).
  4169*    COMPUTE WK3 EQUAL
  4170*       ((( N - ANGLEN) * WK7 * WK8) /
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  78
* ELRATE.cbl
  4171*       (10 * ANGLEN-1 * I)) -
  4172*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  4173*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  4174*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4175*
  4176     MOVE WK3 TO CP-CALC-PREMIUM.
  4177
  4178     GO TO 99999-RETURN
  4179      .
  4180 12000-CHECK-CID-WA-FARMPLAN.
  4181
  4182     IF (CP-COMPANY-ID EQUAL 'CID')
  4183        AND (CP-STATE-STD-ABBRV = 'WA')
  4184        AND (CP-FARM-PLAN)
  4185        CONTINUE
  4186     ELSE
  4187        GO TO 12000-CHECK-CID-FARMPLAN
  4188     END-IF
  4189**  This was removed due to IR 2015022300001
  4190    GO TO 12000-CHECK-CID-FARMPLAN
  4191
  4192     move cp-original-term       to n
  4193     move cp-no-of-pmts          TO C-TOT-PMTS
  4194     compute c-pmts-per-year = 12 / cp-pay-frequency
  4195     move cp-pay-frequency       to m
  4196     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  4197     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4198     if i = zeros
  4199        move .0000000001         to i
  4200     end-if
  4201     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4202
  4203     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4204        (m * 30))) / (1 + I)
  4205     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4206        ** CP-PAY-FREQUENCY) - 1
  4207     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  4208     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4209        ** TI) / WS-WORK-DIS-RATE
  4210     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  4211     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  4212     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4213        ** m) / WS-WORK-DIS-RATE
  4214     COMPUTE WK2 = WK2 * (1 + J)
  4215     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4216     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4217     COMPUTE WK3 = WK3 * (1 + J)
  4218     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  4219        ** (c-tot-pmts - 1))) / J
  4220     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4221        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4222        (CP-PREMIUM-RATE / 1000)
  4223     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4224     COMPUTE WK6 = (WK7 * GR)
  4225
  4226     MOVE WK6 TO CP-CALC-PREMIUM
  4227
  4228     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  79
* ELRATE.cbl
  4229
  4230     .
  4231 12000-CHECK-CID-FARMPLAN.
  4232     IF (CP-COMPANY-ID EQUAL 'CID')
  4233        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4234           OR 'IN' OR 'AZ')
  4235        AND (CP-FARM-PLAN)
  4236        CONTINUE
  4237     ELSE
  4238        GO TO 12000-CHECK-CID-AL-FARMPLAN
  4239     END-IF
  4240     COMPUTE N = M / CP-PAY-FREQUENCY
  4241     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4242     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4243        ** CP-PAY-FREQUENCY) - 1
  4244     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4245     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4246        ** TI) / WS-WORK-DIS-RATE
  4247     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4248     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4249     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4250        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  4251     COMPUTE WK2 = WK2 * (1 + J)
  4252     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4253     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4254     COMPUTE WK3 = WK3 * (1 + J)
  4255     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4256        ** (N - 1))) / J
  4257     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4258        ((N * WK2) - WK5)) + (N * WK1)) *
  4259        (CP-PREMIUM-RATE / 1000)
  4260     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4261     COMPUTE WK6 = (WK7 * GR)
  4262     MOVE WK6 TO CP-CALC-PREMIUM
  4263     GO TO 99999-RETURN
  4264     .
  4265 12000-CHECK-CID-AL-FARMPLAN.
  4266
  4267     IF (CP-COMPANY-ID EQUAL 'CID')
  4268        AND (CP-STATE-STD-ABBRV = 'AL')
  4269        AND (CP-FARM-PLAN)
  4270        CONTINUE
  4271     ELSE
  4272        GO TO 12000-CHECK-SC-CID
  4273     END-IF
  4274
  4275     display ' made AL Farm Plan calc '
  4276
  4277     evaluate true
  4278        when cp-pmt-mode = 'B'
  4279           move 26               to c-pmts-per-year
  4280           move 14               to c-days-in-pmt-per
  4281        when cp-pmt-mode = 'W'
  4282           move 52               to c-pmts-per-year
  4283           move 07               to c-days-in-pmt-per
  4284        when cp-pmt-mode = 'S'
  4285           move 24               to c-pmts-per-year
  4286           move 15               to c-days-in-pmt-per
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  80
* ELRATE.cbl
  4287        when cp-pmt-mode = 'A'
  4288           move 1                to c-pmts-per-year
  4289           move 360              to c-days-in-pmt-per
  4290        when cp-pmt-mode = 'T'
  4291           move 2                to c-pmts-per-year
  4292           move 180              to c-days-in-pmt-per
  4293        when cp-pmt-mode = 'Q'
  4294           move 4                to c-pmts-per-year
  4295           move 90               to c-days-in-pmt-per
  4296        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  4297           move 6                to c-pmts-per-year
  4298           move 60               to c-days-in-pmt-per
  4299        when other
  4300           move 12               to c-pmts-per-year
  4301           move 30               to c-days-in-pmt-per
  4302     end-evaluate
  4303
  4304     compute c-tot-pmts = n / 12 * c-pmts-per-year
  4305     compute i = cp-loan-apr / c-pmts-per-year / 100
  4306     if i = zeros
  4307        move .0000000001         to i
  4308     end-if
  4309     compute anglen  =
  4310        (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4311
  4312     compute y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4313        c-days-in-pmt-per)) / (1 + I)
  4314
  4315     compute angleny = anglen / y
  4316
  4317     compute wk3 rounded =   *> tv1
  4318        ((c-tot-pmts - anglen + (i * c-tot-pmts))) / i
  4319
  4320     compute wk6 =           *> tv2
  4321        cp-premium-rate / 10 * 12 / c-pmts-per-year / 100
  4322
  4323     compute wk7 =    *> tv3
  4324        (cp-original-benefit / anglen)
  4325
  4326     compute wk5 rounded = wk7 *wk3 * wk6
  4327
  4328     move wk5                    to cp-calc-premium
  4329     GO TO 99999-RETURN
  4330     .
  4331 12000-CHECK-SC-CID.
  4332     IF (CP-COMPANY-ID = 'CID')
  4333        AND (CP-STATE-STD-ABBRV = 'SC')
  4334        AND (CP-EARN-AS-NET-PAY)
  4335        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4336        move 6                   to ws-extra-pmts
  4337     ELSE
  4338        GO TO 12000-CHECK-AL-CID
  4339     END-IF
  4340     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4341     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4342     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4343        / 12)) / ((M + 1) / 2)
  4344
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  81
* ELRATE.cbl
  4345     if i = .0000000001
  4346        compute wk4 = cp-original-benefit / n
  4347        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  4348            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  4349        display ' hit sc wo apr - wk2 ' wk2
  4350     else
  4351        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  4352        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4353        COMPUTE ANGLEN-1 = ANGLEN / Y
  4354        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4355        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4356           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4357     end-if
  4358*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4359*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4360*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4361*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4362*    COMPUTE ANGLEN-1 = ANGLEN / Y
  4363*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4364*       / 12)) / ((M + 1) / 2)
  4365*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4366*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4367*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4368     MOVE WK3 TO CP-CALC-PREMIUM
  4369     GO TO 99999-RETURN
  4370     .
  4371 12000-CHECK-AL-CID.
  4372     IF (CP-COMPANY-ID EQUAL 'CID')
  4373        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4374        AND (CP-EARN-AS-NET-PAY)
  4375        CONTINUE
  4376     ELSE
  4377        GO TO 12000-CHECK-NH-CID
  4378     END-IF
  4379     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4380     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4381     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4382     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4383                   / (1 + I)
  4384     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4385     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4386     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4387        (CP-PREMIUM-RATE / 1000)
  4388     MOVE WK3 TO CP-CALC-PREMIUM
  4389     GO TO 99999-RETURN
  4390     .
  4391 12000-CHECK-NH-CID.
  4392     IF (CP-COMPANY-ID EQUAL 'CID')
  4393        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4394        AND (CP-EARN-AS-NET-PAY)
  4395        CONTINUE
  4396     ELSE
  4397        GO TO 12000-CHECK-PA-CID
  4398     END-IF
  4399     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4400     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4401     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4402                   / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  82
* ELRATE.cbl
  4403     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4404     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4405     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4406        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4407     MOVE WK3 TO CP-CALC-PREMIUM
  4408     GO TO 99999-RETURN
  4409     .
  4410 12000-CHECK-PA-CID.
  4411     IF (CP-COMPANY-ID EQUAL 'CID')
  4412        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4413        AND (CP-EARN-AS-NET-PAY)
  4414        CONTINUE
  4415     ELSE
  4416        GO TO 12000-CHECK-ME-CID
  4417     END-IF
  4418
  4419     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4420     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4421     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4422     COMPUTE ANGLEN-1 = ANGLEN / Y
  4423     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4424     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4425     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4426     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4427        * WK5
  4428     MOVE WK3 TO CP-CALC-PREMIUM
  4429     GO TO 99999-RETURN
  4430     .
  4431 12000-CHECK-ME-CID.
  4432     IF (CP-COMPANY-ID EQUAL 'CID')
  4433        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4434        AND (CP-EARN-AS-NET-PAY)
  4435        CONTINUE
  4436     ELSE
  4437        GO TO 12000-CHECK-VT-TRUNC
  4438     END-IF
  4439     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4440     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4441     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4442     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4443     COMPUTE ANGLEN-1 = ANGLEN / Y
  4444     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4445     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4446     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4447        * WK5
  4448     MOVE WK3 TO CP-CALC-PREMIUM
  4449     GO TO 99999-RETURN
  4450     .
  4451 12000-CHECK-VT-TRUNC.
  4452
  4453     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4454        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4455        (CP-EARN-AS-NET-PAY) AND
  4456        (CP-TRUNCATED-LIFE)
  4457        NEXT SENTENCE
  4458     ELSE
  4459        GO TO 12000-CHECK-VT.
  4460
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  83
* ELRATE.cbl
  4461      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4462
  4463      COMPUTE ANGLEN EQUAL WK1 / I.
  4464
  4465      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4466
  4467      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4468      COMPUTE WK9 EQUAL
  4469        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4470        ((.0054 - I) / (1 + I)).
  4471      COMPUTE WK7 EQUAL
  4472        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4473      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4474        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4475
  4476      MOVE WK3 TO CP-CALC-PREMIUM.
  4477
  4478     GO TO 99999-RETURN.
  4479
  4480 12000-CHECK-VT.
  4481
  4482     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4483        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4484        (CP-EARN-AS-NET-PAY)
  4485        NEXT SENTENCE
  4486     ELSE
  4487        GO TO 12000-CHECK-MINN-WDS.
  4488
  4489      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4490
  4491      COMPUTE ANGLEN EQUAL WK1 / I.
  4492
  4493      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4494
  4495      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4496                        (ANGLEN-1 * I)) *
  4497
  4498                        (((1.0054 ** N - 1) /
  4499                        (1.0054 ** (N - 1) * .0054)) -
  4500
  4501                        ((V * (1 - 1.0054 ** N * VX)) /
  4502                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4503
  4504      MOVE WK3 TO CP-CALC-PREMIUM.
  4505
  4506     GO TO 99999-RETURN.
  4507
  4508 12000-CHECK-MINN-WDS.
  4509
  4510     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4511        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4512        (CP-EARN-AS-NET-PAY)
  4513        NEXT SENTENCE
  4514     ELSE
  4515        GO TO 12000-CHECK-MINN-BALL-LEV.
  4516
  4517     COMPUTE ANGLEN EQUAL WK1 / I.
  4518     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  84
* ELRATE.cbl
  4519              (N / +12) * (2 / (N + 1)).
  4520     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  4521         WK3 * ((N - ANGLEN) / I).
  4522
  4523      MOVE WK3 TO CP-CALC-PREMIUM.
  4524
  4525     GO TO 99999-RETURN.
  4526
  4527 12000-CHECK-MINN-BALL-LEV.
  4528
  4529     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4530        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4531        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4532        (CP-EARN-AS-REG-BALLOON)
  4533        NEXT SENTENCE
  4534     ELSE
  4535        GO TO 12000-CHECK-MINN-BALL.
  4536
  4537     COMPUTE ANGLEN EQUAL WK1 / I.
  4538
  4539     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4540
  4541     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4542        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4543
  4544     MOVE WK3 TO CP-CALC-PREMIUM.
  4545
  4546     GO TO 99999-RETURN.
  4547
  4548 12000-CHECK-MINN-BALL.
  4549
  4550     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4551        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4552        (CP-EARN-AS-REG-BALLOON)
  4553        NEXT SENTENCE
  4554     ELSE
  4555        GO TO 12000-CHECK-CID-MN-BALL.
  4556
  4557     COMPUTE ANGLEN EQUAL WK1 / I.
  4558     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4559
  4560     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4561     / +100 * (N - 1) / 12 * 2 / N *
  4562     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4563
  4564      MOVE WK3 TO CP-CALC-PREMIUM.
  4565
  4566     GO TO 99999-RETURN.
  4567
  4568 12000-CHECK-CID-MN-BALL.
  4569     IF (CP-COMPANY-ID EQUAL 'CID')
  4570        AND (CP-STATE-STD-ABBRV = 'MN')
  4571        AND (CP-CERT-EFF-DT > X'A4FF')
  4572        AND (CP-EARN-AS-REG-BALLOON)
  4573        CONTINUE
  4574     ELSE
  4575        GO TO 12000-CHECK-CID-MN-FARM
  4576     END-IF
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  85
* ELRATE.cbl
  4577     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4578     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4579     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4580     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4581     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4582     COMPUTE V = 1 / (1 + I)
  4583     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4584     COMPUTE Y = (1 + (D * I) / +30)
  4585        / (1 + I)
  4586     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4587        * CP-PREMIUM-RATE / 1000
  4588*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4589*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4590*    ELSE
  4591*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4592*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4593*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4594*       DISPLAY ' BALLOON TOP ' WK6
  4595*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4596*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4597*          / 100
  4598*       DISPLAY ' BALLOON BOTTOM ' WK7
  4599*       COMPUTE GR = WK6 / WK7
  4600*       DISPLAY ' BALLOON PAYMENT ' GR
  4601*    END-IF
  4602     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4603     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4604        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4605     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4606     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4607        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4608           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4609           * CP-PREMIUM-RATE / 1000
  4610     MOVE WK3                    TO CP-CALC-PREMIUM
  4611     GO TO 99999-RETURN.
  4612     .
  4613 12000-CHECK-CID-MN-FARM.
  4614
  4615     IF (CP-COMPANY-ID EQUAL 'CID')
  4616        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  4617        AND (CP-CERT-EFF-DT > X'A4FF')
  4618        AND (CP-EARN-AS-FARM-PLAN)
  4619        CONTINUE
  4620     ELSE
  4621        GO TO 12000-CHECK-CID-NET-BALLoons
  4622     END-IF
  4623
  4624     EVALUATE CP-PMT-MODE
  4625        WHEN 'B'
  4626           MOVE +14              TO C-DAYS-IN-PMT-PER
  4627           MOVE +26              TO C-PMTS-PER-YEAR
  4628           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4629        WHEN 'S'
  4630           MOVE +15              TO C-DAYS-IN-PMT-PER
  4631           MOVE +24              TO C-PMTS-PER-YEAR
  4632           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4633        WHEN 'T'
  4634           MOVE +360             TO C-DAYS-IN-PMT-PER
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  86
* ELRATE.cbl
  4635           MOVE +1               TO C-PMTS-PER-YEAR
  4636           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4637        WHEN 'W'
  4638           MOVE +7               TO C-DAYS-IN-PMT-PER
  4639           MOVE +52              TO C-PMTS-PER-YEAR
  4640           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4641        WHEN OTHER
  4642           move cp-no-of-pmts    to c-tot-pmts
  4643           if cp-pay-frequency > zeros
  4644              compute c-pmts-per-year =
  4645                 12 / cp-pay-frequency
  4646              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  4647           else
  4648              MOVE +30           TO C-DAYS-IN-PMT-PER
  4649              MOVE +12           TO C-PMTS-PER-YEAR
  4650              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4651           end-if
  4652     END-EVALUATE
  4653
  4654     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4655     if i = zeros
  4656        move .0000000001         to i
  4657     end-if
  4658
  4659     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4660        C-DAYS-IN-PMT-PER)) / (1 + I)
  4661
  4662     compute cp-premium-rate =
  4663        cp-premium-rate * 12 / c-pmts-per-year / 10
  4664     move c-tot-pmts to n m
  4665     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4666     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4667     COMPUTE ANGLEN-1 = ANGLEN / Y
  4668     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4669
  4670     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4671        (cp-premium-rate / 100)
  4672
  4673
  4674     MOVE WK3                    TO CP-CALC-PREMIUM
  4675
  4676     GO TO 99999-RETURN.
  4677
  4678     .
  4679 12000-check-cid-net-balloons.
  4680     IF (CP-COMPANY-ID EQUAL 'CID')
  4681        AND (CP-EARN-AS-REG-BALLOON)
  4682        and (CP-NET-ONLY-STATE not = 'Y')
  4683        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4684        CONTINUE
  4685     ELSE
  4686        GO TO 12000-check-cid-net-only-balls
  4687     END-IF
  4688     display ' *** NOT NET ONLY STATE BALLOONS *** '
  4689     COMPUTE Y =
  4690        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4691     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4692     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  87
* ELRATE.cbl
  4693     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4694     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4695     COMPUTE ANGLEMY = ANGLEM / Y
  4696     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4697     COMPUTE ANGLENY = ANGLEN / Y
  4698     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4699     compute cp-original-benefit =
  4700        cp-original-benefit + cp-alternate-benefit
  4701     COMPUTE PVBALLOON rounded =
  4702        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4703     compute wk4 rounded =
  4704        cp-original-benefit - pvballoon
  4705     compute wk6 rounded =
  4706        (cp-original-benefit - cp-alternate-benefit)
  4707***  compute ra = wk4 / anglem-1y
  4708     compute ra = wk4 / anglemy
  4709     compute wk6 rounded = wk6 / anglemy
  4710     display ' rate before ' cp-premium-rate
  4711     compute cp-premium-rate =
  4712        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  4713            / 30) / 12))     /
  4714           ((m + 1) / 2)
  4715     display '************************************'
  4716     display ' orign ben    ' cp-original-benefit
  4717     display ' balloon      ' cp-alternate-benefit
  4718     display ' ra           ' ra
  4719     display ' wk6          ' wk6
  4720     display ' m            ' m
  4721     display ' anglemy      ' anglemy
  4722     display ' anglem-1     ' anglem-1y
  4723     display ' i            ' i
  4724     display ' extra per    ' cp-extra-periods
  4725     display ' prem rate    ' cp-premium-rate
  4726***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4727***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4728     compute wk3 = wk6 * (m - anglem) / i * (1 +
  4729        (cp-extra-periods * i)) * cp-premium-rate / 100
  4730     move wk3                    to cp-calc-premium
  4731     display ' wk3          ' wk3
  4732     display '************************************'
  4733*    compute wk3 rounded =
  4734*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4735*    move wk3                    to cp-lf-balloon-prem
  4736     GO TO 99999-RETURN.
  4737     .
  4738 12000-check-cid-net-only-balls.
  4739     IF (CP-COMPANY-ID EQUAL 'CID')
  4740        AND (CP-EARN-AS-REG-BALLOON)
  4741        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4742        CONTINUE
  4743     ELSE
  4744        GO TO 12000-CHECK-NC-WDS
  4745     END-IF
  4746     display ' *** NET ONLY STATE BALLOONS *** '
  4747     COMPUTE Y =
  4748        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4749     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4750     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  88
* ELRATE.cbl
  4751     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4752     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4753     COMPUTE ANGLEMY = ANGLEM / Y
  4754     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4755     COMPUTE ANGLENY = ANGLEN / Y
  4756     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4757     COMPUTE PVBALLOON rounded =
  4758        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4759     compute wk4 rounded =
  4760        cp-original-benefit - pvballoon
  4761*    compute cp-premium-rate =
  4762*       (cp-premium-rate * (m + 1) / 12)  /
  4763*          ((m + 2) / 2)
  4764***  compute ra = wk4 / anglem-1y
  4765     compute ra = (cp-original-benefit + cp-alternate-benefit -
  4766        pvballoon) / anglemy
  4767     display '************************************'
  4768     display ' ra           ' ra
  4769     display ' m            ' m
  4770     display ' anglemy      ' anglemy
  4771     display ' anglem-1     ' anglem-1y
  4772     display ' i            ' i
  4773     display ' extra per    ' cp-extra-periods
  4774     display ' prem rate    ' cp-premium-rate
  4775     display '************************************'
  4776***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4777***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4778     compute wk3 = ra * (m - anglemy) / i * (1 +
  4779        (cp-extra-periods * i)) * cp-premium-rate / 100
  4780     move wk3                    to cp-calc-premium
  4781     compute wk3 rounded =
  4782        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4783     move wk3                    to cp-lf-balloon-prem
  4784     GO TO 99999-RETURN.
  4785     .
  4786 12000-CHECK-NC-WDS.
  4787
  4788     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4789        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4790        (CP-EARN-AS-NET-PAY)
  4791        NEXT SENTENCE
  4792     ELSE
  4793        GO TO 12000-CHECK-NC-BALL-LEV.
  4794
  4795     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4796     COMPUTE ANGLEN EQUAL WK1 / I.
  4797     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4798              CP-PREMIUM-RATE / +100 *
  4799              N / +12 * 2 / (N + 1) *
  4800              (WK4 - ANGLEN) / (I * ANGLEN).
  4801
  4802      MOVE WK3 TO CP-CALC-PREMIUM.
  4803
  4804     GO TO 99999-RETURN.
  4805
  4806 12000-CHECK-NC-BALL-LEV.
  4807
  4808     IF (CP-COMPANY-ID EQUAL 'WDS') AND
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  89
* ELRATE.cbl
  4809        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4810        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4811        (CP-EARN-AS-REG-BALLOON)
  4812        NEXT SENTENCE
  4813     ELSE
  4814        GO TO 12000-CHECK-NC-BALL.
  4815
  4816     COMPUTE ANGLEN EQUAL WK1 / I.
  4817
  4818**** VX = 1 / (1 + I)**N.
  4819
  4820     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4821        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4822
  4823     MOVE WK3 TO CP-CALC-PREMIUM.
  4824
  4825     GO TO 99999-RETURN.
  4826
  4827 12000-CHECK-NC-BALL.
  4828
  4829     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4830        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4831        (CP-EARN-AS-REG-BALLOON)
  4832        NEXT SENTENCE
  4833     ELSE
  4834        GO TO 12000-CHECK-MINN-TRUNC.
  4835
  4836     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4837     COMPUTE ANGLEN EQUAL WK1 / I.
  4838     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4839**** VX = 1 / (1 + I)**N.
  4840
  4841     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4842     / +100 * (N - 1) / 12 * 2 / N *
  4843     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4844
  4845      MOVE WK3 TO CP-CALC-PREMIUM.
  4846
  4847     GO TO 99999-RETURN.
  4848
  4849 12000-CHECK-MINN-TRUNC.
  4850
  4851     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4852        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4853        (M GREATER THAN +63) AND
  4854        (CP-EARN-AS-NET-PAY) AND
  4855        (CP-TRUNCATED-LIFE)
  4856        NEXT SENTENCE
  4857     ELSE
  4858        GO TO 12000-CHECK-MINN.
  4859
  4860      COMPUTE ANGLEN EQUAL WK1 / I.
  4861      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4862
  4863      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4864
  4865      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4866       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  90
* ELRATE.cbl
  4867       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4868
  4869      MOVE WK3 TO CP-CALC-PREMIUM.
  4870
  4871     GO TO 99999-RETURN.
  4872
  4873 12000-CHECK-MINN.
  4874
  4875     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4876        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4877        (M GREATER THAN +63) AND
  4878        (CP-EARN-AS-NET-PAY)
  4879        NEXT SENTENCE
  4880     ELSE
  4881        GO TO 12000-CHECK-MONTANA-TRUNC.
  4882
  4883      COMPUTE ANGLEN EQUAL WK1 / I.
  4884
  4885      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4886
  4887      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4888       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4889       (((N - ANGLEN) / I) + (2 * N)).
  4890
  4891      MOVE WK3 TO CP-CALC-PREMIUM.
  4892
  4893     GO TO 99999-RETURN.
  4894
  4895 12000-CHECK-MONTANA-TRUNC.
  4896
  4897     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4898        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4899        (M GREATER THAN +63) AND
  4900        (CP-EARN-AS-NET-PAY) AND
  4901        (CP-TRUNCATED-LIFE)
  4902        NEXT SENTENCE
  4903     ELSE
  4904        GO TO 12000-CHECK-MONTANA.
  4905
  4906      COMPUTE ANGLEN EQUAL WK1 / I.
  4907      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4908
  4909      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4910
  4911      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4912      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4913       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4914
  4915      MOVE WK3 TO CP-CALC-PREMIUM.
  4916
  4917     GO TO 99999-RETURN.
  4918
  4919 12000-CHECK-MONTANA.
  4920
  4921     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4922        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4923        (M GREATER THAN +63) AND
  4924        (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  91
* ELRATE.cbl
  4925        NEXT SENTENCE
  4926     ELSE
  4927        GO TO 12001-CONTINUE-NCL-TRUNC.
  4928
  4929      COMPUTE ANGLEN EQUAL WK1 / I.
  4930
  4931      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4932
  4933      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4934       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4935       (((N - ANGLEN) / I) + (4 * N)).
  4936
  4937      MOVE WK3 TO CP-CALC-PREMIUM.
  4938
  4939     GO TO 99999-RETURN.
  4940
  4941 12001-CONTINUE-NCL-TRUNC.
  4942
  4943     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4944        (CP-EARN-AS-NET-PAY) AND
  4945        (CP-TRUNCATED-LIFE)
  4946        NEXT SENTENCE
  4947     ELSE
  4948        GO TO 12001-CONTINUE-NCL.
  4949
  4950      COMPUTE ANGLEN EQUAL WK1 / I.
  4951      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4952
  4953      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4954
  4955      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4956      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4957      (ANGLEN-1 * (N + 1) * I).
  4958
  4959      MOVE WK3 TO CP-CALC-PREMIUM.
  4960
  4961     GO TO 99999-RETURN.
  4962
  4963 12001-CONTINUE-NCL.
  4964
  4965     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4966        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4967        (CP-EARN-AS-NET-PAY)
  4968        GO TO 12001-CHECK-NC-NET-PLUS3.
  4969
  4970     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4971        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4972        (CP-EARN-AS-NET-PAY)
  4973        GO TO 12001-CHECK-CA.
  4974
  4975     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4976        (CP-EARN-AS-NET-PAY)
  4977        NEXT SENTENCE
  4978     ELSE
  4979        GO TO 12000-CONTINUE-NET.
  4980
  4981      COMPUTE ANGLEN EQUAL WK1 / I.
  4982      MOVE ANGLEN                TO ANGLEN-1.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  92
* ELRATE.cbl
  4983
  4984      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4985
  4986      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4987       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4988       ((N - ANGLEN) / I).
  4989
  4990      MOVE WK3 TO CP-CALC-PREMIUM.
  4991
  4992     GO TO 99999-RETURN.
  4993
  4994 12000-CONTINUE-NET.
  4995
  4996     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4997        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4998        (CP-EARN-AS-NET-PAY)
  4999        NEXT SENTENCE
  5000     ELSE
  5001        GO TO 12001-CONTINUE-MINN.
  5002
  5003      COMPUTE ANGLEN EQUAL WK6 / I.
  5004      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  5005
  5006      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  5007      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  5008      COMPUTE WK3 EQUAL (WK3 / I) *
  5009       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  5010
  5011      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  5012         MOVE +0 TO CP-R-MAX-TOT-BEN.
  5013
  5014      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  5015
  5016      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  5017         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  5018         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  5019
  5020      MOVE WK3 TO CP-CALC-PREMIUM.
  5021
  5022     GO TO 99999-RETURN.
  5023
  5024 12001-CONTINUE-MINN.
  5025
  5026     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5027        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  5028        (CP-TRUNCATED-LIFE)
  5029        NEXT SENTENCE
  5030     ELSE
  5031        GO TO 12001-CHECK-RI-GTL.
  5032
  5033      COMPUTE ANGLEN EQUAL WK1 / I.
  5034      COMPUTE ANGLEM EQUAL WK2 / I.
  5035
  5036      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  5037       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  5038       * M / 2400) * 1000 + .5) / 1000000.
  5039
  5040      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  93
* ELRATE.cbl
  5041       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  5042
  5043     GO TO 99999-RETURN.
  5044
  5045 12001-CHECK-RI-GTL.
  5046
  5047     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5048        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  5049        (CP-EARN-AS-NET-PAY)
  5050        NEXT SENTENCE
  5051     ELSE
  5052        GO TO 12001-CHECK-RI-LEASE-GTL.
  5053
  5054      COMPUTE ANGLEN EQUAL WK1 / I.
  5055*     COMPUTE ANGLEM EQUAL WK2 / I.
  5056
  5057      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  5058               (1 + WS-WORK-DIS-RATE * N).
  5059      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  5060         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  5061
  5062
  5063     GO TO 99999-RETURN.
  5064
  5065 12001-CHECK-RI-LEASE-GTL.
  5066
  5067     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5068        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  5069        (CP-SPECIAL-CALC-CD EQUAL 'H')
  5070        NEXT SENTENCE
  5071     ELSE
  5072        GO TO 12001-CHECK-OR-GTL.
  5073
  5074     COMPUTE ANGLEN EQUAL WK1 / I.
  5075
  5076     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  5077        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  5078                        /
  5079        (1000 * I * (1 + .0021 * N)).
  5080     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  5081       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  5082                            /
  5083       (1000 * (1 + .0027 * (N + 1))).
  5084
  5085     GO TO 99999-RETURN.
  5086
  5087 12001-CHECK-OR-GTL.
  5088
  5089     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  5090        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  5091        (CP-EARN-AS-NET-PAY)
  5092        NEXT SENTENCE
  5093     ELSE
  5094        GO TO 12001-CHECK-GA-GTL.
  5095
  5096     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5097     COMPUTE ANGLEN EQUAL WK1 / I.
  5098
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  94
* ELRATE.cbl
  5099     IF M LESS THAN +64
  5100        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  5101         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  5102                   /
  5103         (I * ANGLEN * (N - (N - M) + 1) * 600)
  5104        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  5105     ELSE
  5106        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  5107        CP-PREMIUM-RATE * (1 + I))
  5108                  /
  5109        (+1000 * I * ANGLEN)
  5110        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  5111*    MOVE WK3 TO CP-CALC-PREMIUM.
  5112     GO TO 99999-RETURN.
  5113
  5114 12001-CHECK-GA-GTL.
  5115
  5116     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5117        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  5118        (CP-EARN-AS-NET-PAY)
  5119*       (CP-TRUNCATED-LIFE)
  5120        NEXT SENTENCE
  5121     ELSE
  5122        GO TO 12001-CHECK-MA-GTL.
  5123
  5124     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5125     COMPUTE ANGLEN EQUAL WK1 / I.
  5126
  5127     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  5128     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  5129      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  5130     MOVE WK3 TO CP-CALC-PREMIUM.
  5131
  5132     GO TO 99999-RETURN.
  5133
  5134 12001-CHECK-MA-GTL.
  5135
  5136     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  5137        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  5138        (CP-EARN-AS-NET-PAY) AND
  5139        (CP-SPECIAL-CALC-CD EQUAL 'H')
  5140        NEXT SENTENCE
  5141     ELSE
  5142        GO TO 12001-CHECK-NV-NET.
  5143
  5144     COMPUTE ANGLEN EQUAL WK1 / I.
  5145
  5146     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  5147      CP-ALTERNATE-BENEFIT * N.
  5148
  5149     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  5150     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  5151
  5152     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  5153     WK7 * (N - ANGLEN) / I.
  5154     MOVE WK3 TO CP-CALC-PREMIUM.
  5155
  5156     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  95
* ELRATE.cbl
  5157
  5158 12001-CHECK-NV-NET.
  5159     IF (CP-COMPANY-ID EQUAL 'CID')
  5160        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  5161        AND (CP-EARN-AS-NET-PAY)
  5162        CONTINUE
  5163     ELSE
  5164        GO TO 12001-CHECK-MN-NET
  5165     END-IF
  5166     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5167     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5168     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5169                   / (1 + I)
  5170     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5171     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5172     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5173        (CP-PREMIUM-RATE * K-I / 1000)
  5174     MOVE WK3                    TO CP-CALC-PREMIUM
  5175     GO TO 99999-RETURN
  5176      .
  5177 12001-CHECK-MN-NET.
  5178     IF (CP-COMPANY-ID EQUAL 'CID')
  5179        AND (CP-STATE-STD-ABBRV = 'MN')
  5180        AND (CP-EARN-AS-NET-PAY)
  5181        AND (NOT CP-LEVEL-LIFE)
  5182        AND (WS-DISCOUNT-OPTION = '1')
  5183        CONTINUE
  5184     ELSE
  5185        GO TO 12001-CHECK-NC-NET
  5186     END-IF
  5187     if i = .0000000001
  5188        compute wk4 = cp-original-benefit / n
  5189        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  5190           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  5191        move wk3 to cp-calc-premium
  5192        go to 99999-return
  5193     end-if
  5194     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5195     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5196     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5197                   / (1 + I)
  5198     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5199     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5200     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5201        (CP-PREMIUM-RATE / 1000) * (1 + I)
  5202     MOVE WK3                    TO CP-CALC-PREMIUM
  5203     GO TO 99999-RETURN
  5204      .
  5205 12001-CHECK-NC-NET.
  5206
  5207     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  5208        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5209        (CP-EARN-AS-NET-PAY)
  5210        NEXT SENTENCE
  5211     ELSE
  5212        GO TO 12001-CHECK-NC-NET-PLUS3.
  5213
  5214      COMPUTE ANGLEN EQUAL WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  96
* ELRATE.cbl
  5215      COMPUTE ANGLEN-M EQUAL WK5 / I.
  5216
  5217      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  5218          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  5219          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  5220          N * (CP-PREMIUM-RATE / 1000)).
  5221
  5222      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  5223          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  5224
  5225      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  5226          ((N - ANGLEN) / I + 3) / ANGLEN) /
  5227          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  5228          (ANGLEN * 2))
  5229
  5230      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  5231
  5232      IF ANGLEN IS NOT LESS THAN WK7
  5233          COMPUTE CP-PREMIUM-RATE ROUNDED =
  5234              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  5235          COMPUTE WK3 ROUNDED =
  5236              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  5237
  5238     MOVE WK3 TO CP-CALC-PREMIUM.
  5239
  5240     GO TO 99999-RETURN.
  5241
  5242 12001-CHECK-NC-NET-PLUS3.
  5243
  5244     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5245        (CP-EARN-AS-NET-PAY) AND
  5246        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL' AND 'VPP')
  5247        NEXT SENTENCE
  5248     ELSE
  5249        GO TO 12001-CHECK-CA.
  5250
  5251     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  5252     MOVE ' ' TO DC-OPTION-CODE.
  5253     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  5254
  5255     IF DATE-CONVERSION-ERROR
  5256        MOVE '2'                 TO CP-RETURN-CODE
  5257        MOVE ZEROS               TO FACTOR
  5258                                    CP-CALC-PREMIUM
  5259         GO TO 99999-RETURN.
  5260
  5261     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  5262        NEXT SENTENCE
  5263     ELSE
  5264        GO TO 12001-CONTINUE-NET.
  5265
  5266     COMPUTE ANGLEN EQUAL WK1 / I.
  5267     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5268
  5269     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  5270
  5271     COMPUTE NC-R = 20 *
  5272                    ((NC-LR * ORIGINAL-TERM) / 12)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  97
* ELRATE.cbl
  5273                          / (ORIGINAL-TERM + 1).
  5274
  5275     COMPUTE NC-OB = NC-R / 1000.
  5276
  5277     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  5278                    (NC-OB * ORIGINAL-TERM * 3).
  5279
  5280     IF CP-EXT-CHG-LF
  5281         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  5282     ELSE
  5283         MOVE 30                 TO  NC-BIG-D.
  5284
  5285     COMPUTE NC-LITTLE-D = (1 + I) /
  5286             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  5287
  5288     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  5289             (ANGLEN * NC-LITTLE-D ).
  5290
  5291     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  5292
  5293     GO TO 99999-RETURN.
  5294
  5295 12001-CHECK-CA.
  5296
  5297     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5298        (WS-DISCOUNT-OPTION = '6')
  5299        NEXT SENTENCE
  5300     ELSE
  5301        GO TO 12001-CHECK-GTL-IA.
  5302
  5303     COMPUTE CA-J = CA-DISCOUNT / 12.
  5304     COMPUTE ANGLEN EQUAL WK1 / I.
  5305     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  5306     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  5307     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  5308     COMPUTE CA-VI = (1 + I)** -1.
  5309     COMPUTE CP-CALC-PREMIUM =
  5310         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  5311         ((1 + CA-J) / I) *
  5312         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  5313         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  5314         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  5315
  5316     GO TO 99999-RETURN.
  5317
  5318 12001-CHECK-GTL-IA.
  5319
  5320     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  5321        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  5322        (CP-EARN-AS-NET-PAY)
  5323        NEXT SENTENCE
  5324     ELSE
  5325        GO TO 12001-CHECK-CID-TRN-VA.
  5326
  5327***************************************************************
  5328
  5329     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  5330
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  98
* ELRATE.cbl
  5331     IF GTL-IA-ODD-DAYS = ZEROS
  5332         MOVE ZERO               TO  GTL-IA-SGN
  5333     ELSE
  5334         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  5335             MOVE +1             TO  GTL-IA-SGN
  5336         ELSE
  5337             MOVE -1             TO  GTL-IA-SGN.
  5338
  5339     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  5340     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  5341
  5342     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  5343                          GTL-IA-SGN.
  5344
  5345     COMPUTE ANGLEN EQUAL WK1 / I.
  5346     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5347
  5348     IF GTL-IA-ODF NOT = ZERO
  5349         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  5350         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  5351
  5352     COMPUTE GTL-IA-DIVIDEND =
  5353           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  5354                             (ANGLEN - ANGLEN-M))) *
  5355           ((K1 + I) * CP-PREMIUM-RATE *
  5356                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  5357
  5358     COMPUTE GTL-IA-DIVISOR =
  5359      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  5360
  5361     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  5362
  5363     COMPUTE CP-CALC-PREMIUM =
  5364                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  5365     GO TO 99999-RETURN.
  5366
  5367
  5368 12001-CHECK-CID-TRN-VA.
  5369
  5370     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5371        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  5372        (CP-EARN-AS-NET-PAY) AND
  5373        (CP-TRUNCATED-LIFE) AND
  5374        (CP-STATE-STD-ABBRV = CP-STATE)
  5375        CONTINUE
  5376     ELSE
  5377        GO TO 12001-CHECK-CID-TX
  5378     END-IF
  5379
  5380     COMPUTE ANGLEN EQUAL WK1 / I
  5381     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5382     IF WS-WORK-DIS-RATE = ZEROS
  5383        CONTINUE
  5384     ELSE
  5385        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5386        COMPUTE WK7 = (1 / I) *
  5387              (((WK4 ** M - 1) / (WK4 - 1)) -
  5388              ((WK4 ** M * SX - VX) /
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page  99
* ELRATE.cbl
  5389              (WK4 * (1 + I) - 1))) *
  5390              (CP-PREMIUM-RATE / 1000)
  5391        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5392        COMPUTE WK8 = WK7 * 100 / ANGLEN
  5393        COMPUTE CP-CALC-PREMIUM =
  5394           WK8 *  ((WK4 * ANGLEN) / 100)
  5395     END-IF
  5396
  5397     GO TO 99999-RETURN
  5398
  5399     .
  5400
  5401 12001-CHECK-CID-TX.
  5402     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5403        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  5404        (CP-EARN-AS-NET-PAY) AND
  5405        (WS-WORK-DIS-RATE > ZEROS) AND
  5406        (CP-STATE-STD-ABBRV = CP-STATE)
  5407        CONTINUE
  5408     ELSE
  5409        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5410     END-IF
  5411* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5412     COMPUTE K-I = 1 + (1 * I)
  5413     COMPUTE ANGLEm EQUAL WK1 / I   *>   Loan term
  5414     COMPUTE ANGLEn EQUAL WK2 / I   *>   Ins  term
  5415     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  5416
  5417     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  5418     COMPUTE ANGLEmy = ANGLEm / Y
  5419     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5420     IF WS-WORK-DIS-RATE = ZEROS
  5421        CONTINUE
  5422     ELSE
  5423        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5424        COMPUTE WK7 = (K-I / I) *
  5425              (((WK4 ** M - 1) / (WK4 - 1)) -
  5426*             ((WK4 ** M * SX - VX) /
  5427              ((WK4 ** M * SX) - VX) /
  5428*             (WK4 * (1 + I) - 1))) *
  5429              (WK4 * (1 + I) - 1)) *
  5430              (CP-PREMIUM-RATE / 1000)
  5431        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEmy
  5432        COMPUTE WK8 = (WK7 * 100) / (ANGLEmy * K-I)
  5433        COMPUTE CP-CALC-PREMIUM =
  5434           WK8 *  ((WK4 * ANGLEmy * K-I) / 100)
  5435     END-IF
  5436
  5437     GO TO 99999-RETURN
  5438     .
  5439 12001-CHECK-CID-LEV-MN-NEW.
  5440*    IF (CP-COMPANY-ID EQUAL 'CID')
  5441*       AND (CP-STATE-STD-ABBRV = 'MN')
  5442*       AND (CP-EARN-AS-NET-PAY)
  5443*       AND (CP-LEVEL-LIFE)
  5444*       AND (CP-CERT-EFF-DT > X'A4FF')
  5445*       CONTINUE
  5446*    ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 100
* ELRATE.cbl
  5447*       GO TO 12001-CHECK-CID-LEV-MN
  5448*    END-IF
  5449*
  5450*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5451*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5452*    MOVE '1'                    TO DC-OPTION-CODE
  5453*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5454*
  5455*    IF DATE-CONVERSION-ERROR
  5456*       MOVE '2'                 TO CP-RETURN-CODE
  5457*       MOVE ZEROS               TO FACTOR
  5458*                                   CP-CALC-PREMIUM
  5459*       GO TO 99999-RETURN
  5460*    END-IF
  5461*
  5462*    COMPUTE I = CP-LOAN-APR / 100
  5463*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5464*
  5465*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5466*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5467*      * 12 / 360 * D)
  5468*
  5469*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5470*       * 12 / 360 * D
  5471*
  5472*    GO TO 99999-RETURN
  5473      .
  5474 12001-CHECK-CID-LEV-MN.
  5475
  5476     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5477        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  5478        (CP-EARN-AS-NET-PAY) AND
  5479        (CP-LEVEL-LIFE) AND
  5480        (CP-STATE-STD-ABBRV = CP-STATE)
  5481        CONTINUE
  5482     ELSE
  5483        GO TO 12001-CHECK-CID-LEV-CA
  5484     END-IF
  5485
  5486     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5487         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5488         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5489
  5490     GO TO 99999-RETURN
  5491
  5492      .
  5493 12001-CHECK-CID-LEV-CA.
  5494
  5495     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5496        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5497        (CP-EARN-AS-NET-PAY) AND
  5498        (CP-LEVEL-LIFE) AND
  5499        (CP-STATE-STD-ABBRV = CP-STATE)
  5500        CONTINUE
  5501     ELSE
  5502        GO TO 12001-CHECK-CID-TRN-CA
  5503     END-IF
  5504
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 101
* ELRATE.cbl
  5505     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5506     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5507     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5508     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5509     COMPUTE CP-CALC-PREMIUM =
  5510          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  5511          (CP-PREMIUM-RATE / 1000)) /
  5512          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5513
  5514     GO TO 99999-RETURN
  5515
  5516      .
  5517 12001-CHECK-CID-TRN-CA.
  5518
  5519     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5520        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5521        (CP-EARN-AS-NET-PAY) AND
  5522        (CP-TRUNCATED-LIFE) AND
  5523        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5524        (WS-DISCOUNT-OPTION NOT = ' ')
  5525        CONTINUE
  5526     ELSE
  5527        GO TO 12001-CHECK-CID-TRN-MT
  5528     END-IF
  5529
  5530     COMPUTE ANGLEN EQUAL WK1 / I
  5531     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5532     IF WS-WORK-DIS-RATE = ZEROS
  5533        CONTINUE
  5534     ELSE
  5535        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5536        COMPUTE WK7 = (1 / I) *
  5537              (((WK4 ** M - 1) / (WK4 - 1)) -
  5538              ((WK4 ** M * SX - VX) /
  5539              (WK4 * (1 + I) - 1))) *
  5540              (CP-PREMIUM-RATE / 1000)
  5541        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5542        COMPUTE CP-CALC-PREMIUM =
  5543           WK4 *  WK7
  5544     END-IF
  5545
  5546     GO TO 99999-RETURN
  5547
  5548      .
  5549 12001-CHECK-CID-TRN-MT.
  5550
  5551     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5552        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5553                   OR
  5554        ((CP-STATE-STD-ABBRV = 'IN') AND
  5555        (CP-CERT-EFF-DT > X'9A7F'))
  5556                   OR
  5557        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5558        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5559        (CP-EARN-AS-NET-PAY) AND
  5560        (CP-TRUNCATED-LIFE) AND
  5561        (CP-STATE-STD-ABBRV = CP-STATE)
  5562        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 102
* ELRATE.cbl
  5563     ELSE
  5564        GO TO 12001-CHECK-CID-MT
  5565     END-IF
  5566
  5567* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5568     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5569        MOVE 0                   TO K-I
  5570     ELSE
  5571        MOVE 2                   TO K-I
  5572     END-IF
  5573     COMPUTE CP-TERM-OR-EXT-DAYS =
  5574           CP-TERM-OR-EXT-DAYS + 30
  5575
  5576     COMPUTE ANGLEN EQUAL WK1 / I
  5577     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5578     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5579                   / (1 + I)
  5580     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5581     IF WS-WORK-DIS-RATE = ZEROS
  5582        CONTINUE
  5583     ELSE
  5584        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5585*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5586        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5587              (((WK4 ** M - 1) / (WK4 - 1)) -
  5588              ((WK4 ** M * SX - VX) /
  5589              (WK4 * (1 + I) - 1))) *
  5590              (CP-PREMIUM-RATE / 1000)
  5591        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5592*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5593        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5594        COMPUTE CP-CALC-PREMIUM =
  5595           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5596*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5597     END-IF
  5598
  5599     GO TO 99999-RETURN
  5600
  5601     .
  5602 12001-CHECK-CID-MT.
  5603
  5604     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5605        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5606                                OR 'VT')
  5607                   OR
  5608        ((CP-STATE-STD-ABBRV = 'IN') AND
  5609        (CP-CERT-EFF-DT > X'9A7F'))
  5610                   OR
  5611        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5612        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5613        (CP-EARN-AS-NET-PAY) AND
  5614        (CP-STATE-STD-ABBRV = CP-STATE)
  5615        CONTINUE
  5616     ELSE
  5617        GO TO 12001-CHECK-DCC-DD
  5618     END-IF
  5619
  5620     COMPUTE CP-TERM-OR-EXT-DAYS =
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 103
* ELRATE.cbl
  5621           CP-TERM-OR-EXT-DAYS + 30
  5622
  5623* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5624     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5625        MOVE 0                   TO K-I
  5626     ELSE
  5627        IF CP-STATE-STD-ABBRV = 'NJ'
  5628           MOVE 1                TO K-I
  5629        ELSE
  5630           MOVE 2                TO K-I
  5631        END-IF
  5632     END-IF
  5633     COMPUTE ANGLEN EQUAL WK1 / I
  5634     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5635     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5636                   / (1 + I)
  5637     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5638     IF WS-WORK-DIS-RATE = ZEROS
  5639        CONTINUE
  5640     ELSE
  5641        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5642*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5643        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5644              (((WK4 ** N - 1) / (WK4 - 1)) -
  5645              ((WK4 ** N - SV) /
  5646              (WK4 * (1 + I) - 1))) *
  5647              (CP-PREMIUM-RATE / 1000)
  5648        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5649*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5650        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5651        COMPUTE CP-CALC-PREMIUM =
  5652           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5653*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5654     END-IF
  5655
  5656     GO TO 99999-RETURN
  5657
  5658     .
  5659 12001-CHECK-DCC-DD.
  5660     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5661        AND (CP-EARN-AS-NET-PAY)
  5662        AND (CP-BEN-CATEGORY = 'D')
  5663        CONTINUE
  5664     ELSE
  5665        GO TO 12001-CHECK-DCC-NET
  5666     END-IF
  5667
  5668     COMPUTE CP-TERM-OR-EXT-DAYS =
  5669           CP-TERM-OR-EXT-DAYS + 30
  5670
  5671     COMPUTE ANGLEN EQUAL WK1 / I.
  5672     COMPUTE ANGLEM EQUAL WK2 / I.
  5673     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5674
  5675     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5676           / (1 + I)
  5677     COMPUTE GR     = ANGLEN / ODF
  5678*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 104
* ELRATE.cbl
  5679*      CP-RATE-DEV-PCT
  5680     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5681     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5682       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5683     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5684     MOVE WK3                    TO CP-CALC-PREMIUM
  5685
  5686     GO TO 99999-RETURN
  5687
  5688     .
  5689 12001-CHECK-DCC-NET.
  5690
  5691     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5692        AND (CP-EARN-AS-NET-PAY)
  5693        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5694             AND 'H' AND 'S' AND 'P')
  5695        CONTINUE
  5696     ELSE
  5697        GO TO 12001-CHECK-DCC-PNET
  5698     END-IF
  5699
  5700     COMPUTE CP-TERM-OR-EXT-DAYS =
  5701           CP-TERM-OR-EXT-DAYS + 30
  5702
  5703     COMPUTE ANGLEN EQUAL WK1 / I.
  5704     COMPUTE ANGLEM EQUAL WK2 / I.
  5705     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5706
  5707     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5708           / (1 + I)
  5709     COMPUTE GR     = ANGLEN / ODF
  5710     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5711     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5712       CP-RATE-DEV-PCT
  5713     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5714*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5715
  5716     COMPUTE WK8 = CP-PREMIUM-RATE *
  5717        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5718     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5719     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5720     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5721       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5722     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5723     MOVE WK3                    TO CP-CALC-PREMIUM
  5724
  5725     GO TO 99999-RETURN
  5726
  5727     .
  5728 12001-CHECK-DCC-PNET.
  5729     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5730        AND (CP-EARN-AS-NET-PAY)
  5731        AND (CP-BENEFIT-CD (1:1) = 'P')
  5732        CONTINUE
  5733     ELSE
  5734        GO TO 12001-CHECK-DCC-MNET
  5735     END-IF
  5736     IF CP-NO-OF-PMTS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 105
* ELRATE.cbl
  5737        MOVE +0                  TO CP-NO-OF-PMTS
  5738     END-IF
  5739     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5740        AND ' ' AND 'M'
  5741        MOVE ' '                 TO CP-PMT-MODE
  5742     END-IF
  5743******************************************************************
  5744***   Default is monthly, use loan term for rate and amort     ***
  5745******************************************************************
  5746     move cp-loan-term         to c-tot-pmts
  5747     MOVE +30                  TO C-DAYS-IN-PMT-PER
  5748     MOVE +12                  TO C-PMTS-PER-YEAR
  5749******************************************************************
  5750
  5751     evaluate true
  5752        when cp-pmt-mode = 'W'
  5753           MOVE +52              TO C-PMTS-PER-YEAR
  5754           compute c-tot-pmts = cp-loan-term /
  5755              12 * c-pmts-per-year
  5756           MOVE +7               TO C-DAYS-IN-PMT-PER
  5757        when cp-pmt-mode = 'B'
  5758           MOVE +26              TO C-PMTS-PER-YEAR
  5759           compute c-tot-pmts = cp-loan-term /
  5760              12 * c-pmts-per-year
  5761           MOVE +14              TO C-DAYS-IN-PMT-PER
  5762     end-evaluate
  5763     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5764     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5765        C-DAYS-IN-PMT-PER)) / (1 + I)
  5766     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  5767*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5768     COMPUTE ANGLEN-1 = ANGLEN / Y
  5769     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5770     IF CP-RATE-DEV-PCT NOT = ZEROS
  5771        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5772           CP-PREMIUM-RATE
  5773     END-IF
  5774     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5775     GO TO 99999-RETURN
  5776     .
  5777 12001-CHECK-DCC-MNET.
  5778
  5779     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5780        AND (CP-EARN-AS-NET-PAY)
  5781        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5782        CONTINUE
  5783     ELSE
  5784        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5785     END-IF
  5786
  5787*    COMPUTE ANGLEN EQUAL WK1 / I.
  5788*    COMPUTE ANGLEM EQUAL WK2 / I.
  5789*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5790
  5791     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5792     MOVE WK3                    TO CP-CALC-PREMIUM
  5793
  5794     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 106
* ELRATE.cbl
  5795
  5796     .
  5797 12001-CHECK-DCC-MNET-LF-BAL.
  5798
  5799     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5800        AND (CP-EARN-AS-NET-PAY)
  5801        AND (CP-BENEFIT-CD (1:1) = 'N')
  5802        AND (CP-BEN-CATEGORY NOT = 'N')
  5803        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5804        CONTINUE
  5805     ELSE
  5806        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5807     END-IF
  5808
  5809     IF CP-RATE-DEV-PCT NOT = ZEROS
  5810        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5811           CP-PREMIUM-RATE
  5812     END-IF
  5813*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5814     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5815        / (1 + I)
  5816     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5817     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5818     COMPUTE WK2 = (1 + J) ** (M * -1)
  5819     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5820     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5821          ** ((M - 1) * -1))) / J)
  5822     COMPUTE ANGLEM = ((1 - ((1 + J)
  5823          ** (M * -1))) / J) / OD
  5824     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5825        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5826        / ANGLEM-1
  5827     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5828          ** ((N - M) * -1))) / I)
  5829     MOVE +0                     TO WK3
  5830     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5831        (WS-COUNTER > M)
  5832        COMPUTE ANGLEM = (1 - ((1 + J)
  5833          ** ((M - WS-COUNTER) * -1))) / J
  5834        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5835        COMPUTE WK5-CSL = (RA * ANGLEM)
  5836        + (CP-ALTERNATE-BENEFIT * WK2)
  5837        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5838     END-PERFORM
  5839     MOVE WK3                    TO CP-CALC-PREMIUM
  5840
  5841     GO TO 99999-RETURN
  5842
  5843     .
  5844 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5845
  5846     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5847        AND (CP-EARN-AS-NET-PAY)
  5848        AND (CP-BENEFIT-CD (1:1) = 'S')
  5849        AND (CP-BEN-CATEGORY NOT = 'N')
  5850        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5851        CONTINUE
  5852     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 107
* ELRATE.cbl
  5853        GO TO 12001-CHECK-DCC-MNET-LF
  5854     END-IF
  5855
  5856     IF CP-RATE-DEV-PCT NOT = ZEROS
  5857        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5858           CP-PREMIUM-RATE
  5859     END-IF
  5860     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5861     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5862          ** ((M - 1) * -1))) / K)
  5863     COMPUTE ANGLEM = ((1 - ((1 + K)
  5864          ** (M * -1))) / K)
  5865     MOVE CP-MONTHLY-PAYMENT     TO RA
  5866     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5867        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5868        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5869        CP-PREMIUM-RATE / 1000
  5870     MOVE WK3                    TO CP-CALC-PREMIUM
  5871
  5872     GO TO 99999-RETURN
  5873
  5874     .
  5875 12001-CHECK-DCC-MNET-LF.
  5876
  5877     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5878        AND (CP-EARN-AS-NET-PAY)
  5879        AND (CP-BENEFIT-CD (1:1) = 'N')
  5880        AND (CP-BEN-CATEGORY NOT = 'N')
  5881        CONTINUE
  5882     ELSE
  5883        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5884     END-IF
  5885
  5886     IF CP-RATE-DEV-PCT NOT = ZEROS
  5887        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5888           CP-PREMIUM-RATE
  5889     END-IF
  5890*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5891     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5892        / (1 + I)
  5893     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5894     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5895     COMPUTE WK2 = (1 + J) ** (M * -1)
  5896     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5897     COMPUTE ANGLEM = ((1 - ((1 + J)
  5898          ** (M * -1))) / J) / OD
  5899     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5900     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5901          ** ((N - M) * -1))) / I)
  5902     MOVE +0                     TO WK3
  5903     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5904        (WS-COUNTER > M)
  5905        COMPUTE ANGLEM = (1 - ((1 + J)
  5906          ** ((M - WS-COUNTER + 1) * -1))) / J
  5907        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5908        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5909        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5910     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 108
* ELRATE.cbl
  5911     MOVE WK3                    TO CP-CALC-PREMIUM
  5912
  5913     GO TO 99999-RETURN
  5914
  5915     .
  5916 12001-CHECK-DCC-MNET-SUMLF.
  5917
  5918     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5919        AND (CP-EARN-AS-NET-PAY)
  5920        AND (CP-BENEFIT-CD (1:1) = 'S')
  5921        AND (CP-BEN-CATEGORY NOT = 'N')
  5922        CONTINUE
  5923     ELSE
  5924        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5925     END-IF
  5926
  5927     IF CP-RATE-DEV-PCT NOT = ZEROS
  5928        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5929           CP-PREMIUM-RATE
  5930     END-IF
  5931     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5932     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5933        / (1 + K)
  5934     COMPUTE ANGLEN-M = (WK5 / I)
  5935     COMPUTE WK2 = (1 + K) ** (M * -1)
  5936     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5937     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5938     COMPUTE ANGLEM = ((1 - ((1 + K)
  5939          ** (M * -1))) / K) / Y
  5940     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5941     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5942        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5943        - 1)) / K) * RA
  5944     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5945        + (CP-DAYS-TO-1ST-PMT - +30)
  5946        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5947        +0 / 1000 * 12 / 12)
  5948     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5949        * (12 / 12)
  5950     MOVE WK3                    TO CP-CALC-PREMIUM
  5951
  5952     GO TO 99999-RETURN
  5953
  5954     .
  5955 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5956
  5957     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5958        AND (CP-EARN-AS-NET-PAY)
  5959        AND (CP-BENEFIT-CD (1:1) = 'N')
  5960        AND (CP-BEN-CATEGORY = 'N')
  5961        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5962        CONTINUE
  5963     ELSE
  5964        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5965     END-IF
  5966
  5967*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5968     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 109
* ELRATE.cbl
  5969        / (1 + I)
  5970     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5971     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5972     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5973     COMPUTE WK2 = (1 + J) ** (M * -1)
  5974     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5975     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5976          ** ((M - 1) * -1))) / J)
  5977     COMPUTE ANGLEM = ((1 - ((1 + J)
  5978          ** (M * -1))) / J) / OD
  5979     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5980        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5981        / ANGLEM-1
  5982     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5983          ** ((N - M) * -1))) / I)
  5984     MOVE +0                     TO WK3
  5985     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5986        (WS-COUNTER > M)
  5987        COMPUTE ANGLEM = (1 - ((1 + J)
  5988          ** ((M - WS-COUNTER) * -1))) / J
  5989        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5990        COMPUTE WK5-CSL = (RA * ANGLEM)
  5991        + (CP-ALTERNATE-BENEFIT * WK2)
  5992        COMPUTE WK3 = WK3 +
  5993         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5994        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5995          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5996          (CP-DCC-AH-RATE / 1000)
  5997     END-PERFORM
  5998     MOVE WK3                    TO CP-CALC-PREMIUM
  5999
  6000     GO TO 99999-RETURN
  6001
  6002     .
  6003 12001-CHECK-DCC-MNET-TOT-BAL-S.
  6004
  6005     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6006        AND (CP-EARN-AS-NET-PAY)
  6007        AND (CP-BENEFIT-CD (1:1) = 'S')
  6008        AND (CP-BEN-CATEGORY = 'N')
  6009        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  6010        CONTINUE
  6011     ELSE
  6012        GO TO 12001-CHECK-DCC-MNET-TOT-N
  6013     END-IF
  6014
  6015     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6016     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  6017          ** ((M - 1) * -1))) / K)
  6018     COMPUTE ANGLEM = ((1 - ((1 + K)
  6019          ** (M * -1))) / K)
  6020     MOVE CP-MONTHLY-PAYMENT     TO RA
  6021     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  6022        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  6023        * CP-DCC-AH-RATE / 1000))
  6024        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  6025        CP-DCC-LF-RATE / 1000
  6026     MOVE WK3                    TO CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 110
* ELRATE.cbl
  6027     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  6028        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  6029        * CP-DCC-AH-RATE / 1000
  6030     COMPUTE WK3 = WK3 + WK5-CSL
  6031     MOVE WK3                    TO CP-CALC-PREMIUM
  6032
  6033     GO TO 99999-RETURN
  6034      .
  6035 12001-CHECK-DCC-MNET-TOT-N.
  6036
  6037     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  6038        AND (CP-EARN-AS-NET-PAY)
  6039        AND (CP-BENEFIT-CD (1:1) = 'N')
  6040        AND (CP-BEN-CATEGORY = 'N')
  6041        CONTINUE
  6042     ELSE
  6043        GO TO 12001-CHECK-DCC-MNET-TOT-S
  6044     END-IF
  6045
  6046*    I = APR/1200
  6047*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  6048*    RA = PAYMENT AMOUNT
  6049*    WK5-CSL = THE BALANCE (PAY OFF )
  6050*    WK3 = THE ACCUMULATED PREMIUM
  6051*    WK2 = (1 + I) ^ (m * -1)
  6052*    OD  = GAMMA
  6053*
  6054*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  6055     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  6056        / (1 + I)
  6057     COMPUTE ANGLEN-M = (WK5 / I) / OD
  6058     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  6059        (CP-DCC-AH-RATE / +1000)
  6060     COMPUTE WK2 = (1 + J) ** (M * -1)
  6061     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6062     COMPUTE ANGLEM = ((1 - ((1 + J)
  6063          ** (M * -1))) / J) / OD
  6064     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6065     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6066          ** ((N - M) * -1))) / I)
  6067     MOVE +0                     TO WK3
  6068     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  6069        (WS-COUNTER > M)
  6070        COMPUTE ANGLEM = (1 - ((1 + J)
  6071          ** ((M - WS-COUNTER + 1) * -1))) / J
  6072        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  6073        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  6074        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  6075           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  6076     END-PERFORM
  6077     MOVE WK3                    TO CP-CALC-PREMIUM
  6078
  6079     GO TO 99999-RETURN
  6080
  6081     .
  6082 12001-CHECK-DCC-MNET-TOT-S.
  6083
  6084     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 111
* ELRATE.cbl
  6085        AND (CP-EARN-AS-NET-PAY)
  6086        AND (CP-BENEFIT-CD (1:1) = 'S')
  6087        AND (CP-BEN-CATEGORY = 'N')
  6088        CONTINUE
  6089     ELSE
  6090        GO TO 12001-CONTINUE-NET
  6091     END-IF
  6092
  6093*    I = APR/1200
  6094*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  6095*    RA = PAYMENT AMOUNT
  6096*    WK5-CSL = THE BALANCE (PAY OFF )
  6097*    WK3 = THE ACCUMULATED PREMIUM
  6098*    WK2 = (1 + I) ^ (m * -1)
  6099*    OD  = GAMMA
  6100*
  6101     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  6102     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  6103        / (1 + J)
  6104     COMPUTE ANGLEM = ((1 - ((1 + J)
  6105          ** (M * -1))) / J) / OD
  6106     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6107          ** ((N - M) * -1))) / I)
  6108          * (1 + J) ** (-1 * M)
  6109     COMPUTE ANGLEN-M = ANGLEN-M / OD
  6110     MOVE CP-MONTHLY-PAYMENT     TO RA
  6111     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  6112        / +30)
  6113     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  6114        ** (WK1) - 1)) / J) * RA
  6115     COMPUTE WK5 = (((((M * (M + 1) / 2)
  6116        + (CP-DAYS-TO-1ST-PMT - +30)
  6117        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  6118        CP-DCC-AH-RATE / +1000 * 12 / 12)
  6119     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  6120        (12 / 12)
  6121     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  6122        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  6123        (CP-DCC-AH-RATE / +1000) * 12 / 12
  6124     COMPUTE WK3 = WK3 + WK5-CSL
  6125     MOVE WK3                    TO CP-CALC-PREMIUM
  6126     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  6127     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  6128        / (1 + K)
  6129     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  6130          ** ((N - M) * -1))) / I)
  6131     COMPUTE WK2 = (1 + K) ** (M * -1)
  6132     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  6133     COMPUTE ANGLEN-M = ANGLEN-M / Y
  6134     COMPUTE ANGLEM = ((1 - ((1 + K)
  6135          ** (M * -1))) / K) / Y
  6136*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  6137     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  6138        ((1 + K) ** (M + 1 / Y
  6139        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  6140        - 1)) / K) * RA
  6141     COMPUTE WK7 = (((((M * (M + 1) / 2)
  6142        + (CP-DAYS-TO-1ST-PMT - +30)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 112
* ELRATE.cbl
  6143        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  6144        CP-DCC-AH-RATE / 1000 * 12 / 12)
  6145     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  6146        * (12 / 12)
  6147     MOVE WK3                    TO CP-LF-PREM
  6148
  6149     GO TO 99999-RETURN
  6150
  6151     .
  6152 12001-CONTINUE-NET.
  6153
  6154     IF NET-STD
  6155        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  6156*          OR 'DCC'
  6157         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6158         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6159         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6160         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  6161                               * ((1 + N) / (1 + M))
  6162         if (i = .0000000001)
  6163            and (wk3 = zeros)
  6164            move 1               to wk3
  6165         end-if
  6166        ELSE
  6167         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6168         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6169         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6170         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  6171
  6172     IF NET-SMP
  6173         COMPUTE N2 = N * N
  6174         COMPUTE N3 = N2 * N
  6175         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  6176         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  6177         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  6178         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  6179         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  6180
  6181     IF NPO-PRUDENTIAL
  6182       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  6183           VARYING WS-COUNTER FROM 1 BY 1
  6184               UNTIL WS-COUNTER = N
  6185       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  6186       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  6187
  6188     MOVE WK3 TO FACTOR.
  6189
  6190     GO TO 99999-RETURN.
  6191
  6192 12100-PRU-CALC.
  6193     IF WS-COUNTER = 1
  6194         COMPUTE PWK = (I + 1)
  6195     ELSE
  6196         COMPUTE PWK = PWK * (I + 1).
  6197
  6198 12199-EXIT.
  6199      EXIT.
  6200
* Micro Focus Server Express         V5.1 revision 000 17-Feb-20 10:05 Page 113
* ELRATE.cbl
  6201 99000-ERROR.
  6202     MOVE +9999.999999999 TO N-P-FACTOR.
  6203     MOVE '4'             TO CP-RETURN-CODE.
  6204
  6205     GO TO 99999-EXIT.
  6206
  6207 99999-RETURN.
  6208     MOVE FACTOR          TO N-P-FACTOR.
  6209
  6210 99999-EXIT.
  6211      EXIT.
  6212 99999-DUMMY-STOP-RUN.
  6213
  6214* GOBACK.
  6215     MOVE '9%                    "   ' TO DFHEIV0
  6216     MOVE 'ELRATE' TO DFHEIV1
  6217     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6218     GOBACK.
  6219
  6220
  6221 9999-DFHBACK SECTION.
  6222     MOVE '9%                    "   ' TO DFHEIV0
  6223     MOVE 'ELRATE' TO DFHEIV1
  6224     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6225     GOBACK.
  6226 9999-DFHEXIT.
  6227     IF DFHEIGDJ EQUAL 0001
  6228         NEXT SENTENCE
  6229     ELSE IF DFHEIGDJ EQUAL 2
  6230         GO TO 9999-RATE-NOTFND,
  6231               9999-RATE-NOTOPEN,
  6232               9999-RATE-NOTFND
  6233         DEPENDING ON DFHEIGDI.
  6234     MOVE '9%                    "   ' TO DFHEIV0
  6235     MOVE 'ELRATE' TO DFHEIV1
  6236     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6237     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3152     Code:       57412
