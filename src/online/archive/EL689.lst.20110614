* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page   1
* EL689.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL689.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL689 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:10:07.
     7*                            VMOD=2.037
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11*DATE-COMPILED.
    12*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
    13*
    14******************************************************************
    15
    16* W-FILE-USED REFERENCE LIST:
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page   2
* EL689.cbl
    17* (1)  ELCNTL - COMPANY
    18* (2)  ELCNTL - LIFE BENEFIT
    19* (3)  ELCNTL - A&H BENEFIT
    20* (4)  ELCNTL - CARRIER
    21* (5)  MAIL
    22* (6)  ERACCT
    23* (7)  USED FOR SYSTEM VARIABLES ?
    24* (8)  ELCERT
    25* (9)  PENDING BUSINESS
    26* (10) COMPENSATION
    27* (11) ELCNTL - PROCESSOR DATA ?
    28* (12) ERCHEK
    29* (13) ERPYAJ
    30* (14) NOT USED
    31* (15) NOT USED
    32* (16) NOT USED
    33* (17) NOT USED
    34* (18) NOT USED
    35* (19) NOT USED
    36* (20) NOT USED
    37*
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 101501    2001100100006  SMVA  ADD USERID to screen header
    47*                                ADJUSTED REDEFINES EL689AI FILLER
    48* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    49* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    50* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    51* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    52* 092908    2008013100006  PEMA  MOVE VAR 154
    53* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    54* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    55* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    56* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    57* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    58******************************************************************
    59
    60 DATA DIVISION.
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    64 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    65                                   USAGE POINTER.
    66 77  FILLER  PIC X(32) VALUE '********************************'.
    67 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    68 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page   3
* EL689.cbl
    70
    71 01  W-WORK-AREAS.
    72     12  FILLER                  PIC  X(18)
    73                                      VALUE 'PROGRAM WORK AREA:'.
    74
    75     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
    76     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
    77     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
    78     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
    79     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
    80     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
    81     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
    82     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
    83     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
    84     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
    85
    86     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
    87     12  W-DIFFERENCE            PIC S9(07)V9(02)
    88                                            VALUE +0   COMP-3.
    89     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
    90     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
    91     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
    92     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
    93     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
    94     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
    95     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
    96     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
    97     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
    98     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
    99     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   100     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   101     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   102     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   103     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   104     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   105     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   106     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   107     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   108     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   109     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   110     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   111     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   112     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   113     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   114                                            VALUE +0   COMP-3.
   115
   116     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   117     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   118         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   119     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   120     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   121     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   122     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   123     12  W-SAVE-REVISION         PIC  9(03) value 0.
   124     12  W-DISPLAY-3             PIC  9(03) value 0.
   125     12  W-DISPLAY-8             PIC  9(08) value 0.
   126     12  W-DISPLAY-7             PIC  9(07) value 0.
   127     12  W-EDIT-2-5-S            PIC  Z9.9(05).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page   4
* EL689.cbl
   128     12  W-EDIT-3-0              PIC  ZZ9.
   129     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   130     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   131     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   132     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   133
   134     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   135         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   136
   137     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   138     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   139                                 PIC  X(08).
   140     12  W-COMP-WORK-AREA.
   141         16  W-CWA-CHAR OCCURS 10 TIMES
   142                                 PIC  X(01).
   143     12  W-INCOMING-ARCHIVE      PIC  X(08).
   144     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   145                                 PIC  9(08).
   146
   147     12  W-BATCH-BREAKDOWN.
   148         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   149         16  W-BATCH-SEQ         PIC S9(04) COMP.
   150     12  W-BEN-HOLD              PIC  X(02).
   151     12  W-BENEFIT-WORK          PIC  X(03).
   152     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   153         16  W-ELIM-DAYS         PIC  X(02).
   154         16  FILLER              PIC  X(01).
   155     12  W-CALL-PGM              PIC  X(08).
   156     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   157
   158     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   159     12  W-LINE-CONTROL-RECORD.
   160         16  W-LC-LINE-WIDTH     PIC  9(02).
   161         16  FILLER              PIC  X(01).
   162         16  W-LC-PARAGRAPH-INDENT
   163                                 PIC  9(02).
   164         16  FILLER              PIC  X(01).
   165         16  W-LC-MAX-LINES-PER-PAGE
   166                                 PIC  9(02).
   167         16  FILLER              PIC  X(01).
   168         16  W-LC-LINE-ADJUST    PIC  9(02).
   169         16  FILLER              PIC  X(01).
   170         16  W-LC-LINE-INDENT-1  PIC  9(02).
   171         16  FILLER              PIC  X(01).
   172         16  W-LC-LINE-INDENT-2  PIC  9(02).
   173         16  FILLER              PIC  X(01).
   174         16  W-LC-LINE-INDENT-3  PIC  9(02).
   175         16  FILLER              PIC  X(01).
   176         16  W-LC-LINE-INDENT-4  PIC  9(02).
   177         16  FILLER              PIC  X(01).
   178         16  W-LC-LINE-INDENT-5  PIC  9(02).
   179         16  FILLER              PIC  X(01).
   180         16  W-LC-TOP-MARGIN     PIC  9(02).
   181         16  FILLER              PIC  X(01).
   182         16  W-LC-CASE-IND       PIC  X(01).
   183             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   184         16  FILLER              PIC  X(01).
   185         16  W-LC-PAGE-IND       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page   5
* EL689.cbl
   186             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   187     12  W-DATE-WORK             PIC  9(07).
   188     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   189         16  FILLER              PIC  X(02).
   190         16  W-DT-WORK           PIC  9(05).
   191
   192     12  W-DEEDIT-FIELD          PIC  X(15).
   193     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   194
   195     12  W-EDIT-DATE-1.
   196         16  W-ED1-MM            PIC  X(02).
   197         16  FILLER              PIC  X(01) VALUE '/'.
   198         16  W-ED1-DD            PIC  X(02).
   199         16  FILLER              PIC  X(01) VALUE '/'.
   200         16  W-ED1-YY            PIC  X(02).
   201
   202     12  W-EDIT-DATE-2.
   203         16  W-ED2-DD            PIC  X(02).
   204         16  FILLER              PIC  X(01) VALUE '/'.
   205         16  W-ED2-MM            PIC  X(02).
   206         16  FILLER              PIC  X(01) VALUE '/'.
   207         16  W-ED2-YY            PIC  X(02).
   208
   209     12  W-LABEL-HOLD-AREA.
   210         16  W-LABEL-LINES OCCURS 6 TIMES.
   211             20  W-LABEL-ZIP.
   212                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   213                 24  W-LABEL-DASH     PIC  X(01).
   214                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   215             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   216                 24  W-LAB-CAN-POSTAL-CD-1
   217                                      PIC  X(03).
   218                 24  W-LAB-CAN-DASH   PIC  X(01).
   219                 24  W-LAB-CAN-POSTAL-CD-2
   220                                      PIC  X(03).
   221                 24  W-LAB-CAN-FILLER PIC  X(03).
   222             20  FILLER               PIC  X(10).
   223             20  W-LAST-ZIP.
   224                 24  W-LAST-1ST-ZIP   PIC  X(05).
   225                 24  W-LABEL-DASH-LAST
   226                                      PIC  X(01).
   227                 24  W-LAST-2ND-ZIP   PIC  X(04).
   228             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   229                 24  W-LAST-CAN-POSTAL-CD-1
   230                                      PIC  X(03).
   231                 24  W-LAST-CAN-DASH  PIC  X(01).
   232                 24  W-LAST-CAN-POSTAL-CD-2
   233                                      PIC  X(03).
   234                 24  W-LAST-CAN-FILLER
   235                                      PIC  X(03).
   236
   237     12  W-LAST-CHAR             PIC  X(01).
   238         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   239     12  W-LAST-SQ-CHAR          PIC  X(01).
   240
   241     12  W-LINE-NUM.
   242         16  W-LINE1             PIC  X(01).
   243         16  W-LINE23            PIC  9(02).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page   6
* EL689.cbl
   244     12  W-LIN-NUM REDEFINES W-LINE-NUM
   245                                 PIC  9(03).
   246
   247     12  W-NAME-LAST             PIC  X(15).
   248     12  W-NAME-FIRST.
   249         16  W-NAME-FIRST-INIT   PIC  X(01).
   250         16  W-NAME-FIRST-REMAIN PIC  X(14).
   251     12  W-NAME-MIDDLE.
   252         16  FILLER              PIC  X(01).
   253         16  W-NAME-MIDDLE-2     PIC  X(01).
   254         16  FILLER              PIC  X(13).
   255
   256     12  W-PAGE-PRT.
   257         16  FILLER              PIC  X(34) VALUE SPACES.
   258         16  W-PAGE-NUMBER       PIC  Z9.
   259         16  FILLER              PIC  X(01) VALUE '.'.
   260         16  FILLER              PIC  X(33) VALUE SPACES.
   261
   262     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   263     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   264         16  FILLER              PIC  9(01).
   265         16  W-PHI-AREA          PIC  9(03).
   266         16  W-PHI-PFX           PIC  9(03).
   267         16  W-PHI-SFX           PIC  9(04).
   268     12  W-PHONE-OUT.
   269         16  W-PO-AREA           PIC  X(03).
   270         16  FILLER              PIC  X(01) VALUE '-'.
   271         16  W-PO-PFX            PIC  X(03).
   272         16  FILLER              PIC  X(01) VALUE '-'.
   273         16  W-PO-SFX            PIC  X(04).
   274
   275     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   276     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   277     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   278
   279     12  W-SINGLE-LINE           PIC  X(70).
   280     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   281         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   282                                 PIC  X(01).
   283
   284     12  W-SQUEEZED-LINE.
   285         16  W-SQ-CHAR OCCURS 70 TIMES
   286                       INDEXED BY W-SQ-NDX
   287                                 PIC  X(01).
   288
   289     12  W-TIME-IN               PIC S9(07).
   290     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   291         16  FILLER              PIC  X(01).
   292         16  W-TIME-OUT          PIC  99V9(02).
   293         16  FILLER              PIC  X(02).
   294
   295     12  W-TS-NAME-TEXT.
   296         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   297         16  W-TS-ID-TIME
   298             REDEFINES W-TS-ID-TEXT
   299                                 PIC S9(07) COMP-3.
   300         16  W-TS-TERM-TEXT.
   301             20 W-TS-TERM-PREFIX PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page   7
* EL689.cbl
   302             20 FILLER           PIC  X(02).
   303     12  W-TS-NAME-SCREEN.
   304         16  FILLER              PIC  X(04) VALUE '689X'.
   305         16  W-TS-TERM-SCREEN    PIC  X(04).
   306
   307     12  W-WORK-LINE.
   308         16  W-WORK-CHAR OCCURS 70 TIMES
   309                       INDEXED BY W-WC-NDX
   310                                  W-WC-NDX2
   311                                  W-WC-NDX3
   312                                 PIC  X(01).
   313
   314     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   315     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   316         16  W-WORK-ZIP5         PIC  X(05).
   317         16  W-WORK-ZIP4         PIC  X(04).
   318     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   319         16  W-CAN-POSTAL-CD-1.
   320             20  FILLER          PIC  X(01).
   321                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   322             20  FILLER          PIC  X(02).
   323         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   324         16  W-FILLER            PIC  X(03).
   325
   326     12  W-Z-CONTROL-DATA.
   327         16  W-NUMBER-OF-COPIES  PIC  9.
   328         16  FILLER              PIC  X.
   329         16  W-DAYS-TO-FOLLOW-UP PIC  999.
   330         16  FILLER              PIC  X.
   331         16  W-DAYS-TO-RESEND    PIC  999.
   332         16  FILLER              PIC  X.
   333         16  W-FORM-TO-RESEND    PIC  X(4).
   334         16  FILLER              PIC  X.
   335         16  W-PROMPT-LETTER     PIC  X.
   336         16  FILLER              PIC  X.
   337         16  W-ENCLOSURE-CODE    PIC  XXX.
   338         16  F                   PIC  X.
   339         16  W-AUTO-CLOSE-IND    PIC  X.
   340         16  F                   PIC  X.
   341         16  W-LETTER-TO-BENE    PIC  X.
   342*        16  W-PRINT-RESTRICTED-IND
   343*                                PIC  X(01).
   344*            88  W-PRINT-RESTRICTED-TO-CNTL VALUE 'C'.
   345*            88  W-PRINT-RESTRICTED-TO-FORM VALUE 'F'.
   346*            88  W-PRINT-RESTRICTED-TO-PROC VALUE 'P'.
   347*            88  W-PRINT-RESTRICTED         VALUE 'C' 'F' 'P'.
   348*        16  FILLER              PIC X.
   349*        16  W-RESEND-LETR-1     PIC X(4).
   350*        16  FILLER              PIC X.
   351*        16  W-RESEND-LETR-2     PIC X(4).
   352*        16  FILLER              PIC X.
   353*        16  W-RESEND-LETR-3     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page   8
* EL689.cbl
   355 01  W-SWITCH-INDICATORS-AREA.
   356     12  FILLER                  PIC  X(16)
   357                                      VALUE 'PROGRAM SWITCHS:'.
   358     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   359         88  W-ADDRESS-ONLY      VALUE 'Y'.
   360         88  W-FULL-DATA         VALUE ' '.
   361     12  W-ACCT-BROWSE-STARTED-SW
   362                                 PIC  X(01) VALUE 'N'.
   363         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   364     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   365     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   366         88  W-CERT-FOUND                   VALUE 'Y'.
   367     12  W-CHARACTER-TYPE        PIC  X(01).
   368         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   369         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   370         88  W-SPACE             VALUE ' '.
   371     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   372         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   373     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   374         88  W-DATA-SHRINKING    VALUE 'Y'.
   375     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   376         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   377     12  W-FIRST-BAD-VARIABLE-IND
   378                                 PIC  X(01) VALUE SPACES.
   379         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   380     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   381         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   382         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   383     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   384         88  W-FORM-CHANGED                 VALUE 'Y'.
   385     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   386         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   387         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   388     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   389         88  W-HOLD-ON                      VALUE 'Y'.
   390         88  W-HOLD-OFF                     VALUE ' '.
   391     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   392         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   393         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   394     12  W-KEY-FIELDS-CHANGED-IND
   395                                 PIC  X(01) VALUE ' '.
   396         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   397         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   398     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   399         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   400     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   401         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   402                                                   'T' 'U'.
   403         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   404                                                   'G' 'H'.
   405         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   406         88  W-DO-NOT-ADJUST                VALUE 'N'.
   407         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   408         88  W-AS-IS                        VALUE 'A' 'N'.
   409         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   410                                                   '4' '5'.
   411
   412     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page   9
* EL689.cbl
   413         88  W-PNDB-FOUND                   VALUE 'Y'.
   414     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   415         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   416     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   417         88  W-REVERSE-DATE                 VALUE 'Y'.
   418     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   419         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   420         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  10
* EL689.cbl
   422 01  WS-SAVE-AREA.
   423     12  WS-SAV-AM-DEFN-1.
   424         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   425             20  WS-SAV-AM-AGT             PIC  X(10).
   426             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   427             20  FILLER                    PIC  X(15).
   428     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   429     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   430     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   431     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   432     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   433     12  WS-SAV-AM-NAME                    PIC  X(30).
   434     12  WS-SAV-AM-PERSON                  PIC  X(30).
   435     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   436     12  WS-SAV-AM-CITY                    PIC  X(30).
   437     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   438     12  WS-SAV-AM-ZIP.
   439         16  WS-SAV-AM-ZIP-PRIME.
   440             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   441                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   442                     'A' THRU 'Z'.
   443             20  FILLER                    PIC  X(04).
   444         16  FILLER                        PIC  X(04).
   445     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   446                        WS-SAV-AM-ZIP      PIC  X(09).
   447     12  WS-SAV-AM-TEL-NO.
   448         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   449         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   450         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   451 01  W-KEY-AREAS.
   452     12  FILLER                    PIC  X(13)
   453                                      VALUE 'PROGRAM KEYS:'.
   454
   455     12  W-ACCT-SAVE-KEY           PIC  X(20).
   456     12  W-ACCT-KEY.
   457         16  W-ACCT-PARTIAL-KEY.
   458             20  W-ACCT-COMPANY-CD PIC  X(01).
   459             20  W-ACCT-CARRIER    PIC  X(01).
   460             20  W-ACCT-GROUPING   PIC  X(06).
   461             20  W-ACCT-STATE      PIC  X(02).
   462             20  W-ACCT-ACCOUNT    PIC  X(10).
   463         16  W-ACCT-EXP-DT         PIC  X(02).
   464
   465     12  W-ARCH-SAVE-KEY         PIC  X(05).
   466     12  W-ARCH-KEY.
   467         16  W-ARCH-PARTIAL-KEY.
   468             20  W-ARCH-COMPANY-CD
   469                                 PIC  X(01).
   470             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   471         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   472
   473     12  W-ARCT-KEY.
   474         16  W-ARCT-PARTIAL-KEY.
   475             20  W-ARCT-COMPANY-CD
   476                                 PIC  X(01).
   477             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   478         16  W-ARCT-REC-TYPE     PIC  X(01).
   479         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  11
* EL689.cbl
   480
   481     12  W-CERT-KEY.
   482         16  W-CERT-COMPANY-CD   PIC  X(01).
   483         16  W-CERT-CARRIER      PIC  X(01).
   484         16  W-CERT-GROUPING     PIC  X(06).
   485         16  W-CERT-STATE        PIC  X(02).
   486         16  W-CERT-ACCOUNT      PIC  X(10).
   487         16  W-CERT-EFF-DT       PIC  X(02).
   488         16  W-CERT-CERT-NO.
   489             20  W-CERT-CERT-PRIME
   490                                 PIC  X(10).
   491             20  W-CERT-CERT-SFX PIC  X(01).
   492
   493     12  W-CHEK-KEY.
   494         16  W-CHEK-COMPANY-CD   PIC  X(01).
   495         16  W-CHEK-CARRIER      PIC  X(01).
   496         16  W-CHEK-GROUPING     PIC  X(06).
   497         16  W-CHEK-STATE        PIC  X(02).
   498         16  W-CHEK-ACCOUNT      PIC  X(10).
   499         16  W-CHEK-EFF-DT       PIC  X(02).
   500         16  W-CHEK-CERT-NO.
   501             20  W-CHEK-CERT-PRIME
   502                                 PIC  X(10).
   503             20  W-CHEK-CERT-SFX PIC  X(01).
   504         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   505
   506     12  W-CNTL-KEY.
   507         16  W-CNTL-COMPANY-ID   PIC  X(03).
   508         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   509         16  W-CNTL-GENL.
   510             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   511             20  W-CNTL-GEN2.
   512                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   513                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   514         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   515
   516     12  W-COMP-SAVE-KEY         PIC  X(29).
   517     12  W-COMP-KEY.
   518         16  W-COMP-COMPANY-CD   PIC  X(01).
   519         16  W-COMP-CARRIER      PIC  X(01).
   520         16  W-COMP-GROUPING     PIC  X(06).
   521         16  W-COMP-RESP-PERSON.
   522             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   523                                INDEXED BY W-COMP-NDX
   524                                 PIC  X(01).
   525         16  W-COMP-ACCOUNT      PIC  X(10).
   526         16  W-COMP-TYPE         PIC  X(01).
   527
   528     12  W-DELETE-KEY.
   529         16  W-DELETE-PARTIAL-KEY.
   530             20  W-DELETE-COMPANY-CD
   531                                 PIC  X(01).
   532             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   533         16  W-DELETE-RECORD-TYPE
   534                                 PIC  X(01).
   535         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   536
   537     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  12
* EL689.cbl
   538         16  W-MAIL-COMPANY-CD   PIC  X(01).
   539         16  W-MAIL-CARRIER      PIC  X(01).
   540         16  W-MAIL-GROUPING     PIC  X(06).
   541         16  W-MAIL-STATE        PIC  X(02).
   542         16  W-MAIL-ACCOUNT      PIC  X(10).
   543         16  W-MAIL-EFF-DT       PIC  X(02).
   544         16  W-MAIL-CERT-NO.
   545             20  W-MAIL-CERT-PRIME
   546                                 PIC  X(10).
   547             20  W-MAIL-CERT-SFX PIC  X(01).
   548
   549     12  W-PNDB-KEY.
   550         16  W-PNDB-COMPANY-CD   PIC  X(01).
   551         16  W-PNDB-ENTRY        PIC  X(06).
   552         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   553         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   554
   555     12  W-PNDB2-KEY.
   556         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   557         16  W-PNDB2-CARRIER     PIC  X(01).
   558         16  W-PNDB2-GROUPING    PIC  X(06).
   559         16  W-PNDB2-STATE       PIC  X(02).
   560         16  W-PNDB2-ACCOUNT     PIC  X(10).
   561         16  W-PNDB2-EFF-DT      PIC  X(02).
   562         16  W-PNDB2-CERT-NO.
   563             20  W-PNDB2-CERT-PRIME
   564                                 PIC  X(10).
   565             20  W-PNDB2-CERT-SFX
   566                                 PIC  X(01).
   567         16  W-PNDB2-ALT-CHG-SEQ-NO
   568                                 PIC S9(04)  COMP.
   569         16  W-PNDB2-TYPE        PIC  X(01).
   570
   571     12  W-PYAJ-KEY.
   572         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   573         16  W-PYAJ-CARRIER      PIC  X(01).
   574         16  W-PYAJ-GROUPING     PIC  X(06).
   575         16  W-PYAJ-FIN-RESP     PIC  X(10).
   576         16  W-PYAJ-ACCOUNT      PIC  X(10).
   577         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   578         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   579
   580     12  W-SC-QUID-KEY.
   581         16  W-SC-QUID-TERMINAL  PIC  X(04).
   582         16  W-SC-QUID-SYSTEM    PIC  X(04).
   583
   584     12  W-TEXT-SAVE-KEY         PIC  X(05).
   585     12  W-TEXT-KEY.
   586         16  W-TEXT-PARTIAL-KEY.
   587             20  W-TEXT-COMPANY-CD
   588                                 PIC  X(01).
   589             20  W-TEXT-LETTER   PIC  X(04).
   590         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   591         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   592
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  13
* EL689.cbl
   594 01  FILLER                      PIC  X(22)
   595                                 VALUE 'INTERFACE AREA STARTS:'.
   596*    COPY ELCINTF.
   597******************************************************************
   598*                                                                *
   599*                                                                *
   600*                            ELCINTF.                            *
   601*                            VMOD=2.017                          *
   602*                                                                *
   603*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   604*                                                                *
   605*       LENGTH = 1024                                            *
   606*                                                                *
   607******************************************************************
   608 01  PROGRAM-INTERFACE-BLOCK.
   609     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   610     12  PI-CALLING-PROGRAM              PIC X(8).
   611     12  PI-SAVED-PROGRAM-1              PIC X(8).
   612     12  PI-SAVED-PROGRAM-2              PIC X(8).
   613     12  PI-SAVED-PROGRAM-3              PIC X(8).
   614     12  PI-SAVED-PROGRAM-4              PIC X(8).
   615     12  PI-SAVED-PROGRAM-5              PIC X(8).
   616     12  PI-SAVED-PROGRAM-6              PIC X(8).
   617     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   618     12  PI-COMPANY-ID                   PIC XXX.
   619     12  PI-COMPANY-CD                   PIC X.
   620
   621     12  PI-COMPANY-PASSWORD             PIC X(8).
   622
   623     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   624
   625     12  PI-CONTROL-IN-PROGRESS.
   626         16  PI-CARRIER                  PIC X.
   627         16  PI-GROUPING                 PIC X(6).
   628         16  PI-STATE                    PIC XX.
   629         16  PI-ACCOUNT                  PIC X(10).
   630         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   631                                         PIC X(10).
   632         16  PI-CLAIM-CERT-GRP.
   633             20  PI-CLAIM-NO             PIC X(7).
   634             20  PI-CERT-NO.
   635                 25  PI-CERT-PRIME       PIC X(10).
   636                 25  PI-CERT-SFX         PIC X.
   637             20  PI-CERT-EFF-DT          PIC XX.
   638         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   639             20  PI-PLAN-CODE            PIC X(2).
   640             20  PI-REVISION-NUMBER      PIC X(3).
   641             20  PI-PLAN-EFF-DT          PIC X(2).
   642             20  PI-PLAN-EXP-DT          PIC X(2).
   643             20  FILLER                  PIC X(11).
   644         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   645             20  PI-OE-REFERENCE-1.
   646                 25  PI-OE-REF-1-PRIME   PIC X(18).
   647                 25  PI-OE-REF-1-SUFF    PIC XX.
   648
   649     12  PI-SESSION-IN-PROGRESS          PIC X.
   650         88  CLAIM-SESSION                   VALUE '1'.
   651         88  CREDIT-SESSION                  VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  14
* EL689.cbl
   652         88  WARRANTY-SESSION                VALUE '3'.
   653         88  MORTGAGE-SESSION                VALUE '4'.
   654         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   655
   656
   657*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   658
   659     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   660     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   661
   662     12  PI-CREDIT-USER                  PIC X.
   663         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   664         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   665
   666     12  PI-CLAIM-USER                   PIC X.
   667         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   668         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   669
   670     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   671         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   672         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   673         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   674         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   675         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   676
   677     12  PI-PROCESSOR-ID                 PIC X(4).
   678
   679     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   680
   681     12  PI-MEMBER-CAPTION               PIC X(10).
   682
   683     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   684         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   685
   686     12  PI-LIFE-OVERRIDE-L1             PIC X.
   687     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   688     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   689     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   690
   691     12  PI-AH-OVERRIDE-L1               PIC X.
   692     12  PI-AH-OVERRIDE-L2               PIC XX.
   693     12  PI-AH-OVERRIDE-L6               PIC X(6).
   694     12  PI-AH-OVERRIDE-L12              PIC X(12).
   695
   696     12  PI-NEW-SYSTEM                   PIC X(2).
   697
   698     12  PI-PRIMARY-CERT-NO              PIC X(11).
   699     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   700         88  PI-USES-PAID-TO                 VALUE '1'.
   701     12  PI-CRDTCRD-SYSTEM.
   702         16  PI-CRDTCRD-USER             PIC X.
   703             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   704             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   705         16  PI-CC-MONTH-END-DT          PIC XX.
   706     12  PI-PROCESSOR-PRINTER            PIC X(4).
   707
   708     12  PI-OE-REFERENCE-2.
   709         16  PI-OE-REF-2-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  15
* EL689.cbl
   710         16  PI-OE-REF-2-SUFF            PIC X.
   711
   712     12  PI-REM-TRM-CALC-OPTION          PIC X.
   713
   714     12  PI-LANGUAGE-TYPE                PIC X.
   715             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   716             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   717             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   718
   719     12  PI-POLICY-LINKAGE-IND           PIC X.
   720         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   721         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   722                                                   LOW-VALUES.
   723
   724     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   725     12  PI-CLAIM-PW-SESSION             PIC X(1).
   726         88  PI-CLAIM-CREDIT                 VALUE '1'.
   727         88  PI-CLAIM-CONVEN                 VALUE '2'.
   728     12  FILLER                          PIC X(4).
   729
   730     12  PI-SYSTEM-LEVEL                 PIC X(145).
   731
   732     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   733         PI-SYSTEM-LEVEL.
   734
   735         16  PI-ENTRY-CODES.
   736             20  PI-ENTRY-CD-1           PIC X.
   737             20  PI-ENTRY-CD-2           PIC X.
   738
   739         16  PI-RETURN-CODES.
   740             20  PI-RETURN-CD-1          PIC X.
   741             20  PI-RETURN-CD-2          PIC X.
   742
   743         16  PI-UPDATE-STATUS-SAVE.
   744             20  PI-UPDATE-BY            PIC X(4).
   745             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   746
   747         16  PI-LOWER-CASE-LETTERS       PIC X.
   748             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   749
   750*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   751*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   752*            88  CARRIER-CLM-CNTL            VALUE '2'.
   753
   754         16  PI-CERT-ACCESS-CONTROL      PIC X.
   755             88  ST-ACCNT-CNTL               VALUE ' '.
   756             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   757             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   758             88  ACCNT-CNTL                  VALUE '3'.
   759             88  CARR-ACCNT-CNTL             VALUE '4'.
   760
   761         16  PI-PROCESSOR-CAP-LIST.
   762             20  PI-SYSTEM-CONTROLS.
   763                24 PI-SYSTEM-DISPLAY     PIC X.
   764                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   765                24 PI-SYSTEM-MODIFY      PIC X.
   766                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   767             20  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  16
* EL689.cbl
   768             20  PI-DISPLAY-CAP          PIC X.
   769                 88  DISPLAY-CAP             VALUE 'Y'.
   770             20  PI-MODIFY-CAP           PIC X.
   771                 88  MODIFY-CAP              VALUE 'Y'.
   772             20  PI-MSG-AT-LOGON-CAP     PIC X.
   773                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   774             20  PI-FORCE-CAP            PIC X.
   775                 88  FORCE-CAP               VALUE 'Y'.
   776
   777         16  PI-PROGRAM-CONTROLS.
   778             20  PI-PGM-PRINT-OPT        PIC X.
   779             20  PI-PGM-FORMAT-OPT       PIC X.
   780             20  PI-PGM-PROCESS-OPT      PIC X.
   781             20  PI-PGM-TOTALS-OPT       PIC X.
   782
   783         16  PI-HELP-INTERFACE.
   784             20  PI-LAST-ERROR-NO        PIC X(4).
   785             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   786
   787         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   788             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   789
   790         16  PI-CR-CONTROL-IN-PROGRESS.
   791             20  PI-CR-CARRIER           PIC X.
   792             20  PI-CR-GROUPING          PIC X(6).
   793             20  PI-CR-STATE             PIC XX.
   794             20  PI-CR-ACCOUNT           PIC X(10).
   795             20  PI-CR-FIN-RESP          PIC X(10).
   796             20  PI-CR-TYPE              PIC X.
   797
   798         16  PI-CR-BATCH-NUMBER          PIC X(6).
   799
   800         16  PI-CR-MONTH-END-DT          PIC XX.
   801
   802         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   803             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   804             88  PI-ZERO-CARRIER             VALUE '1'.
   805             88  PI-ZERO-GROUPING            VALUE '2'.
   806             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   807
   808         16  PI-CARRIER-SECURITY         PIC X.
   809             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   810
   811         16  PI-ACCOUNT-SECURITY         PIC X(10).
   812             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   813             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   814
   815         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   816             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   817                                         INDEXED BY PI-ACCESS-NDX
   818                                         PIC X.
   819
   820         16  PI-GA-BILLING-CONTROL       PIC X.
   821             88  PI-GA-BILLING               VALUE '1'.
   822
   823         16  PI-MAIL-PROCESSING          PIC X.
   824             88  PI-MAIL-YES                 VALUE 'Y'.
   825
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  17
* EL689.cbl
   826         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   827
   828         16  PI-AR-SYSTEM.
   829             20  PI-AR-PROCESSING-CNTL   PIC X.
   830                 88  PI-AR-PROCESSING        VALUE 'Y'.
   831             20  PI-AR-SUMMARY-CODE      PIC X(6).
   832             20  PI-AR-MONTH-END-DT      PIC XX.
   833
   834         16  PI-MP-SYSTEM.
   835             20  PI-MORTGAGE-USER            PIC X.
   836                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   837                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   838             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   839                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   840                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   841                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   842                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   843                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   844             20  PI-MP-MONTH-END-DT          PIC XX.
   845             20  PI-MP-REFERENCE-NO.
   846                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   847                 24  PI-MP-REFERENCE-SFX     PIC XX.
   848
   849         16  PI-LABEL-CONTROL            PIC X(01).
   850             88  PI-CREATE-LABELS                    VALUE 'Y'.
   851             88  PI-BYPASS-LABELS                    VALUE 'N'.
   852
   853         16  PI-BILL-GROUPING-CODE       PIC X(01).
   854             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   855
   856         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   857             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   858             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   859
   860         16  FILLER                      PIC X(14).
   861
   862     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   863******************************************************************
   864     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   865*    COPY ELC1042.
   866******************************************************************
   867*                                                                *
   868*                                                                *
   869*                           ELC1042                              *
   870*                            VMOD=2.002                          *
   871*                                                                *
   872*    NOTE                                                        *
   873*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   874*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   875*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   876*        TO THESE PROGRAMS.                                      *
   877*                                                                *
   878*    NOTE                                                        *
   879*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   880*        USE ONLY!                                               *
   881*                                                                *
   882******************************************************************
   883
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  18
* EL689.cbl
   884         16  PI-1042-WA.
   885             20  PI-ACTION       PIC  X(01).
   886                 88 PI-SHOW-MODE           VALUE '1'.
   887                 88 PI-CLEAR-MODE          VALUE '2'.
   888                 88 PI-CREATE-MODE         VALUE '3'.
   889             20  PI-COMM-CONTROL PIC  X(12).
   890             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   891             20  PI-EOF-SW       PIC  X(01).
   892                 88  PI-FILE-EOF           VALUE 'Y'.
   893             20  PI-FILETYP      PIC  X(01).
   894             20  PI-FORM-SQUEEZE-CONTROL
   895                                 PIC  X(01).
   896                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   897                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   898             20  PI-LAST-CONTROL PIC  X(12).
   899             20  PI-TEMP-STOR-ITEMS
   900                                 PIC S9(04) COMP.
   901             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   902             20  PI-UPDATE-SW    PIC  9(01).
   903                 88 ANY-UPDATES            VALUE 1.
   904             20  PI-104-SCREEN-SENT-IND
   905                                 PIC  X(01).
   906                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   907                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   908             20  PI-1042-SCREEN-SENT-IND
   909                                 PIC  X(01).
   910                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   911                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   912             20  PI-1042-ARCHIVE-IND
   913                                 PIC  X(01).
   914                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   915             20  FILLER          PIC  X(29).
   916*    COPY ELC689PI.
   917******************************************************************
   918*                                                                *
   919*                            ELC689PI                            *
   920*                            VMOD=2.003                          *
   921*                                                                *
   922*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   923*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
   924*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   925*                                                                *
   926*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   927*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   928*    BETWEEN PROGRAMS.                                           *
   929*                                                                *
   930*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   931*                                                                *
   932*               EL631 - EL689  - EL6891 - EL6892                 *
   933*                                                                *
   934******************************************************************
   935*                   C H A N G E   L O G
   936*
   937* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   938*-----------------------------------------------------------------
   939*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   940* EFFECTIVE    NUMBER
   941*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  19
* EL689.cbl
   942* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
   943* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
   944* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   945******************************************************************
   946
   947
   948         16  PI-689-WORK-AREA.
   949             20  PI-689-ALT-PRINTER-ID
   950                                 PIC  X(04).
   951             20  PI-689-ARCHIVE-NUMBER
   952                                 PIC  9(08).
   953             20  PI-689-ARCHIVE-SW
   954                                 PIC  X(01).
   955                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
   956             20  PI-689-DATA-SOURCE
   957                                 PIC  X(01).
   958                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
   959                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
   960                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
   961                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
   962                 88  PI-689-SRC-CHECKS         VALUE '5'.
   963             20  PI-689-ERROR-IND
   964                                 PIC  X(01).
   965                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
   966             20  PI-689-ERROR    PIC  9(04).
   967                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
   968                 88  PI-689-FATAL-ERROR
   969                     VALUES 0004 0006 0008 0013 0023 0029 0033
   970                            0042 0047 0051 0066 0067 0070
   971                            0168 0169 0174 0175 0176 0177 0179
   972                            0180 0181 0182 0184 0185 0189 0190
   973                            0191
   974                            0215 0279 0280
   975                            0412 0413 0454
   976                            0533 0537
   977                            2055 2114 2208 2209 2216 2232 2369
   978                            2398 2433 2908 2999
   979                            3000 3770 3771 3775
   980                            7250 7365 7367 7368 7369 7370 7371
   981                            7272 7373 7374 7376 7377 7378 7379
   982                            7381 7388 7390 7393 7395 7396 7398
   983                            9095 9096 9281 9298 9299 9320 9327
   984                            9426 9427.
   985                 88  PI-689-STOP-ERROR
   986                     VALUES 0004 0008 0013 0023 0029 0033
   987                            0042 0047 0066 0067 0070
   988                            0168 0169 0174 0175 0176 0177
   989                            0181 0182 0184 0185 0189 0190
   990                            0279 0280
   991                            0412 0413 0454
   992                            2055 2208 2209 2216 2232
   993                            2398 2999
   994                            3000 3770 3771 3775
   995                            7250 7365 7369 7370 7371
   996                            7272 7373 7374 7376 7377 7378 7379
   997                            7381 7388 7390 7393 7396 7398
   998                            9095 9096 9299 9320 9426.
   999             20  PI-689-FOLLOW-UP-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  20
* EL689.cbl
  1000                                 PIC  X(02).
  1001             20  PI-689-FORM-NUMBER
  1002                                 PIC  X(04).
  1003             20  PI-689-LABEL-SOURCE
  1004                                 PIC X(01).
  1005                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1006                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1007                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1008                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1009                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1010                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1011                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1012             20  PI-689-NUMBER-COPIES
  1013                                 PIC  9(01).
  1014             20  PI-689-NUMBER-LABEL-LINES
  1015                                 PIC  9(01).
  1016             20  PI-689-NUMBER-TEXT-RECORDS
  1017                                 PIC  9(03).
  1018             20  PI-689-PRINT-ORDER-SW
  1019                                 PIC  X(01).
  1020                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1021                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1022                 88  PI-689-PRINT-LATER     VALUE '3'.
  1023                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1024             20  PI-689-PRINT-RESTRICTION
  1025                                 PIC  X(01).
  1026                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1027                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1028                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1029             20  PI-689-PRINT-SW PIC  X(01).
  1030                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1031             20  PI-689-RESEND-DATE-1
  1032                                 PIC  X(02).
  1033             20  PI-689-RESEND-LETR-1
  1034                                 PIC X(4).
  1035             20  PI-689-TEMP-STOR-ID
  1036                                 PIC  X(08).
  1037             20  PI-689-USE-SCREEN-IND
  1038                                 PIC  X(01).
  1039                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1040             20  PI-689-ARCH-POINTER
  1041                                 PIC S9(08) COMP.
  1042                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1043             20  PI-689-ARCT-POINTER
  1044                                 PIC S9(08) COMP.
  1045                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1046             20  PI-689-VARIABLE-DATA-GRP.
  1047                 24  PI-689-VARIABLE-DATA-1
  1048                                 PIC  X(30).
  1049                 24  PI-689-VARIABLE-DATA-2
  1050                                 PIC  X(30).
  1051                 24  PI-689-VARIABLE-DATA-3
  1052                                 PIC  X(30).
  1053                 24  PI-689-VARIABLE-DATA-4
  1054                                 PIC  X(30).
  1055
  1056         16  PI-689-KEY-DATA-FIELDS.
  1057             20  PI-689-ACCOUNT  PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  21
* EL689.cbl
  1058             20  PI-689-CARRIER  PIC  X(01).
  1059             20  PI-689-CERT-NO.
  1060                 24  PI-689-CERT-PRIME
  1061                                 PIC  X(10).
  1062                 24  PI-689-CERT-SFX
  1063                                 PIC  X(01).
  1064             20  PI-689-CHG-SEQ-NO
  1065                                 PIC S9(04)    COMP.
  1066             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1067                                 PIC  X(02).
  1068             20  PI-689-ENTRY-BATCH
  1069                                 PIC  X(06).
  1070             20  PI-689-EFF-DATE PIC  X(02).
  1071             20  PI-689-EXP-DATE PIC  X(02).
  1072             20  PI-689-GROUPING PIC  X(06).
  1073             20  PI-689-RESP-PERSON
  1074                                 PIC  X(10).
  1075             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1076             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1077                                 PIC  X(04).
  1078             20  PI-689-STATE    PIC  X(02).
  1079             20  PI-689-TYPE     PIC  X(01).
  1080             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1081             20  PI-689-ALT-SEQ-NO
  1082                                 PIC S9(04)    COMP.
  1083         16  PI-689-DATE-EDIT    PIC  X(08).
  1084         16  PI-689-FOLLOW-UP-EDIT
  1085                                 PIC  X(08).
  1086         16  PI-689-RESEND1-EDIT PIC  X(08).
  1087         16  PI-689-SEQ-EDIT     PIC  X(08).
  1088         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1089         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1090             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1091         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1092         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1093         16  FILLER              PIC X(264).
  1094*        16  FILLER                        PIC X(276).
  1095*        16  FILLER                        PIC X(280).
  1096
  1097 01  FILLER                      PIC  X(20)
  1098                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  22
* EL689.cbl
  1100 01  FILLER                      PIC  X(16)
  1101                        VALUE 'MAP AREA STARTS:'.
  1102*    COPY EL689S.
  1103 01  EL689AI.
  1104     05  FILLER            PIC  X(0012).
  1105*    -------------------------------
  1106     05  RUNDTEL PIC S9(0004) COMP.
  1107     05  RUNDTEF PIC  X(0001).
  1108     05  FILLER REDEFINES RUNDTEF.
  1109         10  RUNDTEA PIC  X(0001).
  1110     05  RUNDTEI PIC  X(0008).
  1111*    -------------------------------
  1112     05  RUNTIMEL PIC S9(0004) COMP.
  1113     05  RUNTIMEF PIC  X(0001).
  1114     05  FILLER REDEFINES RUNTIMEF.
  1115         10  RUNTIMEA PIC  X(0001).
  1116     05  RUNTIMEI PIC  X(0005).
  1117*    -------------------------------
  1118     05  COMPANYL PIC S9(0004) COMP.
  1119     05  COMPANYF PIC  X(0001).
  1120     05  FILLER REDEFINES COMPANYF.
  1121         10  COMPANYA PIC  X(0001).
  1122     05  COMPANYI PIC  X(0003).
  1123*    -------------------------------
  1124     05  USERIDL PIC S9(0004) COMP.
  1125     05  USERIDF PIC  X(0001).
  1126     05  FILLER REDEFINES USERIDF.
  1127         10  USERIDA PIC  X(0001).
  1128     05  USERIDI PIC  X(0004).
  1129*    -------------------------------
  1130     05  MAINTL PIC S9(0004) COMP.
  1131     05  MAINTF PIC  X(0001).
  1132     05  FILLER REDEFINES MAINTF.
  1133         10  MAINTA PIC  X(0001).
  1134     05  MAINTI PIC  X(0001).
  1135*    -------------------------------
  1136     05  FORML PIC S9(0004) COMP.
  1137     05  FORMF PIC  X(0001).
  1138     05  FILLER REDEFINES FORMF.
  1139         10  FORMA PIC  X(0001).
  1140     05  FORMI PIC  X(0004).
  1141*    -------------------------------
  1142     05  ARCHNUML PIC S9(0004) COMP.
  1143     05  ARCHNUMF PIC  X(0001).
  1144     05  FILLER REDEFINES ARCHNUMF.
  1145         10  ARCHNUMA PIC  X(0001).
  1146     05  ARCHNUMI PIC  99999999.
  1147*    -------------------------------
  1148     05  PRTRESTL PIC S9(0004) COMP.
  1149     05  PRTRESTF PIC  X(0001).
  1150     05  FILLER REDEFINES PRTRESTF.
  1151         10  PRTRESTA PIC  X(0001).
  1152     05  PRTRESTI PIC  X(0001).
  1153*    -------------------------------
  1154     05  FOLLOWL PIC S9(0004) COMP.
  1155     05  FOLLOWF PIC  X(0001).
  1156     05  FILLER REDEFINES FOLLOWF.
  1157         10  FOLLOWA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  23
* EL689.cbl
  1158     05  FOLLOWI PIC  X(0008).
  1159*    -------------------------------
  1160     05  RESEND1L PIC S9(0004) COMP.
  1161     05  RESEND1F PIC  X(0001).
  1162     05  FILLER REDEFINES RESEND1F.
  1163         10  RESEND1A PIC  X(0001).
  1164     05  RESEND1I PIC  X(0008).
  1165*    -------------------------------
  1166     05  ADDRSL PIC S9(0004) COMP.
  1167     05  ADDRSF PIC  X(0001).
  1168     05  FILLER REDEFINES ADDRSF.
  1169         10  ADDRSA PIC  X(0001).
  1170     05  ADDRSI PIC  X(0001).
  1171*    -------------------------------
  1172     05  PRINTERL PIC S9(0004) COMP.
  1173     05  PRINTERF PIC  X(0001).
  1174     05  FILLER REDEFINES PRINTERF.
  1175         10  PRINTERA PIC  X(0001).
  1176     05  PRINTERI PIC  X(0004).
  1177*    -------------------------------
  1178     05  COPIESL PIC S9(0004) COMP.
  1179     05  COPIESF PIC  X(0001).
  1180     05  FILLER REDEFINES COPIESF.
  1181         10  COPIESA PIC  X(0001).
  1182     05  COPIESI PIC  X(0001).
  1183*    -------------------------------
  1184     05  DATASORL PIC S9(0004) COMP.
  1185     05  DATASORF PIC  X(0001).
  1186     05  FILLER REDEFINES DATASORF.
  1187         10  DATASORA PIC  X(0001).
  1188     05  DATASORI PIC  X(0001).
  1189*    -------------------------------
  1190     05  ADDRLBLL PIC S9(0004) COMP.
  1191     05  ADDRLBLF PIC  X(0001).
  1192     05  FILLER REDEFINES ADDRLBLF.
  1193         10  ADDRLBLA PIC  X(0001).
  1194     05  ADDRLBLI PIC  X(0001).
  1195*    -------------------------------
  1196     05  CARRIERL PIC S9(0004) COMP.
  1197     05  CARRIERF PIC  X(0001).
  1198     05  FILLER REDEFINES CARRIERF.
  1199         10  CARRIERA PIC  X(0001).
  1200     05  CARRIERI PIC  X(0001).
  1201*    -------------------------------
  1202     05  GROUPL PIC S9(0004) COMP.
  1203     05  GROUPF PIC  X(0001).
  1204     05  FILLER REDEFINES GROUPF.
  1205         10  GROUPA PIC  X(0001).
  1206     05  GROUPI PIC  X(0006).
  1207*    -------------------------------
  1208     05  STATEL PIC S9(0004) COMP.
  1209     05  STATEF PIC  X(0001).
  1210     05  FILLER REDEFINES STATEF.
  1211         10  STATEA PIC  X(0001).
  1212     05  STATEI PIC  X(0002).
  1213*    -------------------------------
  1214     05  ACCTL PIC S9(0004) COMP.
  1215     05  ACCTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  24
* EL689.cbl
  1216     05  FILLER REDEFINES ACCTF.
  1217         10  ACCTA PIC  X(0001).
  1218     05  ACCTI PIC  X(0010).
  1219*    -------------------------------
  1220     05  CERTL PIC S9(0004) COMP.
  1221     05  CERTF PIC  X(0001).
  1222     05  FILLER REDEFINES CERTF.
  1223         10  CERTA PIC  X(0001).
  1224     05  CERTI PIC  X(0010).
  1225*    -------------------------------
  1226     05  SFXL PIC S9(0004) COMP.
  1227     05  SFXF PIC  X(0001).
  1228     05  FILLER REDEFINES SFXF.
  1229         10  SFXA PIC  X(0001).
  1230     05  SFXI PIC  X(0001).
  1231*    -------------------------------
  1232     05  TYPEL PIC S9(0004) COMP.
  1233     05  TYPEF PIC  X(0001).
  1234     05  FILLER REDEFINES TYPEF.
  1235         10  TYPEA PIC  X(0001).
  1236     05  TYPEI PIC  X(0001).
  1237*    -------------------------------
  1238     05  DATEL PIC S9(0004) COMP.
  1239     05  DATEF PIC  X(0001).
  1240     05  FILLER REDEFINES DATEF.
  1241         10  DATEA PIC  X(0001).
  1242     05  DATEI PIC  X(0008).
  1243*    -------------------------------
  1244     05  RPERSONL PIC S9(0004) COMP.
  1245     05  RPERSONF PIC  X(0001).
  1246     05  FILLER REDEFINES RPERSONF.
  1247         10  RPERSONA PIC  X(0001).
  1248     05  RPERSONI PIC  X(0010).
  1249*    -------------------------------
  1250     05  BENTRYL PIC S9(0004) COMP.
  1251     05  BENTRYF PIC  X(0001).
  1252     05  FILLER REDEFINES BENTRYF.
  1253         10  BENTRYA PIC  X(0001).
  1254     05  BENTRYI PIC  X(0006).
  1255*    -------------------------------
  1256     05  SEQL PIC S9(0004) COMP.
  1257     05  SEQF PIC  X(0001).
  1258     05  FILLER REDEFINES SEQF.
  1259         10  SEQA PIC  X(0001).
  1260     05  SEQI PIC  X(0008).
  1261*    -------------------------------
  1262     05  BCSEQL PIC S9(0004) COMP.
  1263     05  BCSEQF PIC  X(0001).
  1264     05  FILLER REDEFINES BCSEQF.
  1265         10  BCSEQA PIC  X(0001).
  1266     05  BCSEQI PIC  X(0004).
  1267*    -------------------------------
  1268     05  L1L PIC S9(0004) COMP.
  1269     05  L1F PIC  X(0001).
  1270     05  FILLER REDEFINES L1F.
  1271         10  L1A PIC  X(0001).
  1272     05  L1I PIC  X(0003).
  1273*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  25
* EL689.cbl
  1274     05  TEXT1L PIC S9(0004) COMP.
  1275     05  TEXT1F PIC  X(0001).
  1276     05  FILLER REDEFINES TEXT1F.
  1277         10  TEXT1A PIC  X(0001).
  1278     05  TEXT1I PIC  X(0070).
  1279*    -------------------------------
  1280     05  L2L PIC S9(0004) COMP.
  1281     05  L2F PIC  X(0001).
  1282     05  FILLER REDEFINES L2F.
  1283         10  L2A PIC  X(0001).
  1284     05  L2I PIC  X(0003).
  1285*    -------------------------------
  1286     05  TEXT2L PIC S9(0004) COMP.
  1287     05  TEXT2F PIC  X(0001).
  1288     05  FILLER REDEFINES TEXT2F.
  1289         10  TEXT2A PIC  X(0001).
  1290     05  TEXT2I PIC  X(0070).
  1291*    -------------------------------
  1292     05  L3L PIC S9(0004) COMP.
  1293     05  L3F PIC  X(0001).
  1294     05  FILLER REDEFINES L3F.
  1295         10  L3A PIC  X(0001).
  1296     05  L3I PIC  X(0003).
  1297*    -------------------------------
  1298     05  TEXT3L PIC S9(0004) COMP.
  1299     05  TEXT3F PIC  X(0001).
  1300     05  FILLER REDEFINES TEXT3F.
  1301         10  TEXT3A PIC  X(0001).
  1302     05  TEXT3I PIC  X(0070).
  1303*    -------------------------------
  1304     05  L4L PIC S9(0004) COMP.
  1305     05  L4F PIC  X(0001).
  1306     05  FILLER REDEFINES L4F.
  1307         10  L4A PIC  X(0001).
  1308     05  L4I PIC  X(0003).
  1309*    -------------------------------
  1310     05  TEXT4L PIC S9(0004) COMP.
  1311     05  TEXT4F PIC  X(0001).
  1312     05  FILLER REDEFINES TEXT4F.
  1313         10  TEXT4A PIC  X(0001).
  1314     05  TEXT4I PIC  X(0070).
  1315*    -------------------------------
  1316     05  L5L PIC S9(0004) COMP.
  1317     05  L5F PIC  X(0001).
  1318     05  FILLER REDEFINES L5F.
  1319         10  L5A PIC  X(0001).
  1320     05  L5I PIC  X(0003).
  1321*    -------------------------------
  1322     05  TEXT5L PIC S9(0004) COMP.
  1323     05  TEXT5F PIC  X(0001).
  1324     05  FILLER REDEFINES TEXT5F.
  1325         10  TEXT5A PIC  X(0001).
  1326     05  TEXT5I PIC  X(0070).
  1327*    -------------------------------
  1328     05  L6L PIC S9(0004) COMP.
  1329     05  L6F PIC  X(0001).
  1330     05  FILLER REDEFINES L6F.
  1331         10  L6A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  26
* EL689.cbl
  1332     05  L6I PIC  X(0003).
  1333*    -------------------------------
  1334     05  TEXT6L PIC S9(0004) COMP.
  1335     05  TEXT6F PIC  X(0001).
  1336     05  FILLER REDEFINES TEXT6F.
  1337         10  TEXT6A PIC  X(0001).
  1338     05  TEXT6I PIC  X(0070).
  1339*    -------------------------------
  1340     05  L7L PIC S9(0004) COMP.
  1341     05  L7F PIC  X(0001).
  1342     05  FILLER REDEFINES L7F.
  1343         10  L7A PIC  X(0001).
  1344     05  L7I PIC  X(0003).
  1345*    -------------------------------
  1346     05  TEXT7L PIC S9(0004) COMP.
  1347     05  TEXT7F PIC  X(0001).
  1348     05  FILLER REDEFINES TEXT7F.
  1349         10  TEXT7A PIC  X(0001).
  1350     05  TEXT7I PIC  X(0070).
  1351*    -------------------------------
  1352     05  L8L PIC S9(0004) COMP.
  1353     05  L8F PIC  X(0001).
  1354     05  FILLER REDEFINES L8F.
  1355         10  L8A PIC  X(0001).
  1356     05  L8I PIC  X(0003).
  1357*    -------------------------------
  1358     05  TEXT8L PIC S9(0004) COMP.
  1359     05  TEXT8F PIC  X(0001).
  1360     05  FILLER REDEFINES TEXT8F.
  1361         10  TEXT8A PIC  X(0001).
  1362     05  TEXT8I PIC  X(0070).
  1363*    -------------------------------
  1364     05  L9L PIC S9(0004) COMP.
  1365     05  L9F PIC  X(0001).
  1366     05  FILLER REDEFINES L9F.
  1367         10  L9A PIC  X(0001).
  1368     05  L9I PIC  X(0003).
  1369*    -------------------------------
  1370     05  TEXT9L PIC S9(0004) COMP.
  1371     05  TEXT9F PIC  X(0001).
  1372     05  FILLER REDEFINES TEXT9F.
  1373         10  TEXT9A PIC  X(0001).
  1374     05  TEXT9I PIC  X(0070).
  1375*    -------------------------------
  1376     05  L10L PIC S9(0004) COMP.
  1377     05  L10F PIC  X(0001).
  1378     05  FILLER REDEFINES L10F.
  1379         10  L10A PIC  X(0001).
  1380     05  L10I PIC  X(0003).
  1381*    -------------------------------
  1382     05  TEXT10L PIC S9(0004) COMP.
  1383     05  TEXT10F PIC  X(0001).
  1384     05  FILLER REDEFINES TEXT10F.
  1385         10  TEXT10A PIC  X(0001).
  1386     05  TEXT10I PIC  X(0070).
  1387*    -------------------------------
  1388     05  L11L PIC S9(0004) COMP.
  1389     05  L11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  27
* EL689.cbl
  1390     05  FILLER REDEFINES L11F.
  1391         10  L11A PIC  X(0001).
  1392     05  L11I PIC  X(0003).
  1393*    -------------------------------
  1394     05  TEXT11L PIC S9(0004) COMP.
  1395     05  TEXT11F PIC  X(0001).
  1396     05  FILLER REDEFINES TEXT11F.
  1397         10  TEXT11A PIC  X(0001).
  1398     05  TEXT11I PIC  X(0070).
  1399*    -------------------------------
  1400     05  L12L PIC S9(0004) COMP.
  1401     05  L12F PIC  X(0001).
  1402     05  FILLER REDEFINES L12F.
  1403         10  L12A PIC  X(0001).
  1404     05  L12I PIC  X(0003).
  1405*    -------------------------------
  1406     05  TEXT12L PIC S9(0004) COMP.
  1407     05  TEXT12F PIC  X(0001).
  1408     05  FILLER REDEFINES TEXT12F.
  1409         10  TEXT12A PIC  X(0001).
  1410     05  TEXT12I PIC  X(0070).
  1411*    -------------------------------
  1412     05  ERRMSGL PIC S9(0004) COMP.
  1413     05  ERRMSGF PIC  X(0001).
  1414     05  FILLER REDEFINES ERRMSGF.
  1415         10  ERRMSGA PIC  X(0001).
  1416     05  ERRMSGI PIC  X(0079).
  1417*    -------------------------------
  1418     05  ENTERPFL PIC S9(0004) COMP.
  1419     05  ENTERPFF PIC  X(0001).
  1420     05  FILLER REDEFINES ENTERPFF.
  1421         10  ENTERPFA PIC  X(0001).
  1422     05  ENTERPFI PIC  99.
  1423 01  EL689AO REDEFINES EL689AI.
  1424     05  FILLER            PIC  X(0012).
  1425*    -------------------------------
  1426     05  FILLER            PIC  X(0003).
  1427     05  RUNDTEO PIC  X(0008).
  1428*    -------------------------------
  1429     05  FILLER            PIC  X(0003).
  1430     05  RUNTIMEO PIC  99.99.
  1431*    -------------------------------
  1432     05  FILLER            PIC  X(0003).
  1433     05  COMPANYO PIC  X(0003).
  1434*    -------------------------------
  1435     05  FILLER            PIC  X(0003).
  1436     05  USERIDO PIC  X(0004).
  1437*    -------------------------------
  1438     05  FILLER            PIC  X(0003).
  1439     05  MAINTO PIC  X(0001).
  1440*    -------------------------------
  1441     05  FILLER            PIC  X(0003).
  1442     05  FORMO PIC  X(0004).
  1443*    -------------------------------
  1444     05  FILLER            PIC  X(0003).
  1445     05  ARCHNUMO PIC  ZZZZZZZ9.
  1446*    -------------------------------
  1447     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  28
* EL689.cbl
  1448     05  PRTRESTO PIC  X(0001).
  1449*    -------------------------------
  1450     05  FILLER            PIC  X(0003).
  1451     05  FOLLOWO PIC  X(0008).
  1452*    -------------------------------
  1453     05  FILLER            PIC  X(0003).
  1454     05  RESEND1O PIC  X(0008).
  1455*    -------------------------------
  1456     05  FILLER            PIC  X(0003).
  1457     05  ADDRSO PIC  X(0001).
  1458*    -------------------------------
  1459     05  FILLER            PIC  X(0003).
  1460     05  PRINTERO PIC  X(0004).
  1461*    -------------------------------
  1462     05  FILLER            PIC  X(0003).
  1463     05  COPIESO PIC  X(0001).
  1464*    -------------------------------
  1465     05  FILLER            PIC  X(0003).
  1466     05  DATASORO PIC  X(0001).
  1467*    -------------------------------
  1468     05  FILLER            PIC  X(0003).
  1469     05  ADDRLBLO PIC  X(0001).
  1470*    -------------------------------
  1471     05  FILLER            PIC  X(0003).
  1472     05  CARRIERO PIC  X(0001).
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(0003).
  1475     05  GROUPO PIC  X(0006).
  1476*    -------------------------------
  1477     05  FILLER            PIC  X(0003).
  1478     05  STATEO PIC  X(0002).
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(0003).
  1481     05  ACCTO PIC  X(0010).
  1482*    -------------------------------
  1483     05  FILLER            PIC  X(0003).
  1484     05  CERTO PIC  X(0010).
  1485*    -------------------------------
  1486     05  FILLER            PIC  X(0003).
  1487     05  SFXO PIC  X(0001).
  1488*    -------------------------------
  1489     05  FILLER            PIC  X(0003).
  1490     05  TYPEO PIC  X(0001).
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  DATEO PIC  X(0008).
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  RPERSONO PIC  X(0010).
  1497*    -------------------------------
  1498     05  FILLER            PIC  X(0003).
  1499     05  BENTRYO PIC  X(0006).
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  SEQO PIC  X(0008).
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
  1505     05  BCSEQO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  29
* EL689.cbl
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  L1O PIC  X(0003).
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
  1511     05  TEXT1O PIC  X(0070).
  1512*    -------------------------------
  1513     05  FILLER            PIC  X(0003).
  1514     05  L2O PIC  X(0003).
  1515*    -------------------------------
  1516     05  FILLER            PIC  X(0003).
  1517     05  TEXT2O PIC  X(0070).
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  L3O PIC  X(0003).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
  1523     05  TEXT3O PIC  X(0070).
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  L4O PIC  X(0003).
  1527*    -------------------------------
  1528     05  FILLER            PIC  X(0003).
  1529     05  TEXT4O PIC  X(0070).
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  L5O PIC  X(0003).
  1533*    -------------------------------
  1534     05  FILLER            PIC  X(0003).
  1535     05  TEXT5O PIC  X(0070).
  1536*    -------------------------------
  1537     05  FILLER            PIC  X(0003).
  1538     05  L6O PIC  X(0003).
  1539*    -------------------------------
  1540     05  FILLER            PIC  X(0003).
  1541     05  TEXT6O PIC  X(0070).
  1542*    -------------------------------
  1543     05  FILLER            PIC  X(0003).
  1544     05  L7O PIC  X(0003).
  1545*    -------------------------------
  1546     05  FILLER            PIC  X(0003).
  1547     05  TEXT7O PIC  X(0070).
  1548*    -------------------------------
  1549     05  FILLER            PIC  X(0003).
  1550     05  L8O PIC  X(0003).
  1551*    -------------------------------
  1552     05  FILLER            PIC  X(0003).
  1553     05  TEXT8O PIC  X(0070).
  1554*    -------------------------------
  1555     05  FILLER            PIC  X(0003).
  1556     05  L9O PIC  X(0003).
  1557*    -------------------------------
  1558     05  FILLER            PIC  X(0003).
  1559     05  TEXT9O PIC  X(0070).
  1560*    -------------------------------
  1561     05  FILLER            PIC  X(0003).
  1562     05  L10O PIC  X(0003).
  1563*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  30
* EL689.cbl
  1564     05  FILLER            PIC  X(0003).
  1565     05  TEXT10O PIC  X(0070).
  1566*    -------------------------------
  1567     05  FILLER            PIC  X(0003).
  1568     05  L11O PIC  X(0003).
  1569*    -------------------------------
  1570     05  FILLER            PIC  X(0003).
  1571     05  TEXT11O PIC  X(0070).
  1572*    -------------------------------
  1573     05  FILLER            PIC  X(0003).
  1574     05  L12O PIC  X(0003).
  1575*    -------------------------------
  1576     05  FILLER            PIC  X(0003).
  1577     05  TEXT12O PIC  X(0070).
  1578*    -------------------------------
  1579     05  FILLER            PIC  X(0003).
  1580     05  ERRMSGO PIC  X(0079).
  1581*    -------------------------------
  1582     05  FILLER            PIC  X(0003).
  1583     05  ENTERPFO PIC  X(0002).
  1584*    -------------------------------
  1585 01  W-MAP-REDEF REDEFINES EL689AI.
  1586     12  FILLER                  PIC X(218).
  1587*    12  FILLER                  PIC X(240).
  1588     12  EL689RI.
  1589         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1590             20  W-SC-LINEL      PIC S9(04) COMP.
  1591             20  W-SC-LINEA      PIC  X(01).
  1592             20  W-SC-LINE       PIC  X(03).
  1593             20  W-SC-TEXTL      PIC S9(04) COMP.
  1594             20  W-SC-TEXTA      PIC  X(01).
  1595             20  W-SC-TEXT       PIC  X(70).
  1596     12  FILLER                  PIC  X(87).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  31
* EL689.cbl
  1598 01  W-CONSTANT-AREA.
  1599     12  FILLER                  PIC  X(18)
  1600                                 VALUE 'PROGRAM CONSTANTS:'.
  1601     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1602     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1603     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1604     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1605     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1606     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1607     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1608     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1609     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1610
  1611     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  1612     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  1613     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  1614     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  1615     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  1616     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  1617     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  1618     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  1619     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  1620     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  1621     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  1622     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  1623     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  1624     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  1625     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  1626     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  1627     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  1628     12  W-LOWER-CASE            PIC  X(26)
  1629         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  1630     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  1631     12  W-MAP.
  1632         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  1633         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  1634         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  1635     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  1636     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  1637     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  1638     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  1639     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  1640     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  1641     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  1642
  1643     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  1644     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  1645     12  W-TOP-FORM              PIC  X(70)
  1646                              VALUE '*****TOP OF FORM *****'.
  1647     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  1648     12  W-UPPER-CASE            PIC  X(26)
  1649         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  1650     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  1651     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  1652     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  32
* EL689.cbl
  1654 01  W-VARIABLE-PROCESS-CNTLS.
  1655     12  FILLER                  PIC  X(26)
  1656                        VALUE 'VARIABLE WORK AREA STARTS:'.
  1657     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  1658     12  W-VAR-HOLD.
  1659         16  W-V1                PIC  X(01).
  1660         16  W-V2                PIC  X(01).
  1661         16  W-V3                PIC  X(01).
  1662     12  FILLER REDEFINES W-VAR-HOLD.
  1663         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  1664     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  1665         88  W-SQUEEZE-FIELD          VALUE '#'.
  1666
  1667 01  W-SUPPORTED-VARIABLES.
  1668
  1669*****************COMPANY VARIABLES - ELCNTL ********************
  1670*****COMPANY NAME
  1671     12  FILLER                  PIC  X(03) VALUE '001'.
  1672     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1673     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1674     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1675     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1676
  1677*****FULL COMPANY ADDRESS
  1678     12  FILLER                  PIC  X(03) VALUE '002'.
  1679     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1680     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1681     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1682     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1683
  1684     12  FILLER                  PIC  X(03) VALUE '003'.
  1685     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1686     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1687     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1688     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1689
  1690     12  FILLER                  PIC  X(03) VALUE '004'.
  1691     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1692     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1693     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1694     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1695
  1696     12  FILLER                  PIC  X(03) VALUE '005'.
  1697     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1698     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1699     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1700     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1701
  1702     12  FILLER                  PIC  X(03) VALUE '006'.
  1703     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1704     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1705     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1706     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1707
  1708*****REMAINING 4 ARE NOT CURRENTLY USED
  1709     12  FILLER                  PIC  X(03) VALUE '007'.
  1710     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1711     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  33
* EL689.cbl
  1712     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1713     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1714
  1715     12  FILLER                  PIC  X(03) VALUE '008'.
  1716     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1717     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1718     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1719     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1720
  1721     12  FILLER                  PIC  X(03) VALUE '009'.
  1722     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1723     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1724     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1725     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1726
  1727     12  FILLER                  PIC  X(03) VALUE '010'.
  1728     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1729     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1730     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1731     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1732
  1733************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  1734*****LIFE BENEFIT DESCRIPTION
  1735     12  FILLER                  PIC  X(03) VALUE '011'.
  1736     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1737     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1738     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1739     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1740
  1741*****REMAINING 3 ARE NOT CURRENTLY USED
  1742     12  FILLER                  PIC  X(03) VALUE '012'.
  1743     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1744     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1745     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1746     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1747
  1748     12  FILLER                  PIC  X(03) VALUE '013'.
  1749     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1750     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1751     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1752     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1753
  1754     12  FILLER                  PIC  X(03) VALUE '014'.
  1755     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1756     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1757     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1758     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1759
  1760************* A&H BENEFIT VARIABLES - ELCNTL *******************
  1761*****AH BENEFIT DESCRIPTION
  1762     12  FILLER                  PIC  X(03) VALUE '015'.
  1763     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1764     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1765     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1766     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1767
  1768*****ELIMINATION PERIOD
  1769     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  34
* EL689.cbl
  1770     12  FILLER                  PIC S9(04) COMP VALUE +2.
  1771     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1772     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1773     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1774
  1775*****REMAINING 3 ARE NOT CURRENTLY USED
  1776     12  FILLER                  PIC  X(03) VALUE '017'.
  1777     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1778     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1779     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1780     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1781
  1782     12  FILLER                  PIC  X(03) VALUE '018'.
  1783     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1784     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1785     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1786     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1787
  1788     12  FILLER                  PIC  X(03) VALUE '019'.
  1789     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1790     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1791     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1792     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1793
  1794*****************CARRIER VARIABLES - ELCNTL ********************
  1795*****CARRIER NAME
  1796     12  FILLER                  PIC  X(03) VALUE '020'.
  1797     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1798     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1799     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1800     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1801
  1802*****FULL CARRIER ADDRESS
  1803     12  FILLER                  PIC  X(03) VALUE '021'.
  1804     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1805     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1806     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1807     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1808
  1809     12  FILLER                  PIC  X(03) VALUE '022'.
  1810     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1811     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1812     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1813     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1814
  1815     12  FILLER                  PIC  X(03) VALUE '023'.
  1816     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1817     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1818     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1819     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1820
  1821     12  FILLER                  PIC  X(03) VALUE '024'.
  1822     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1823     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1824     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1825     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1826
  1827     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  35
* EL689.cbl
  1828     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1829     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1830     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1831     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1832
  1833*****CARRIER PHONE NUMBER
  1834     12  FILLER                  PIC  X(03) VALUE '026'.
  1835     12  FILLER                  PIC S9(04) COMP VALUE +12.
  1836     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1837     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1838     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1839
  1840*****REMAINING 4 ARE NOT CURRENTLY USED
  1841     12  FILLER                  PIC  X(03) VALUE '027'.
  1842     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1843     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1844     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1845     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1846
  1847     12  FILLER                  PIC  X(03) VALUE '028'.
  1848     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1849     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1850     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1851     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1852
  1853     12  FILLER                  PIC  X(03) VALUE '029'.
  1854     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1855     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1856     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1857     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1858
  1859     12  FILLER                  PIC  X(03) VALUE '030'.
  1860     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1861     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1862     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1863     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1864
  1865***************** MAIL VARIABLES - ELMAIL **********************
  1866*****FULL MAIL ADDRESS
  1867     12  FILLER                  PIC  X(03) VALUE '031'.
  1868     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1869     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1870     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1871     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1872
  1873     12  FILLER                  PIC  X(03) VALUE '032'.
  1874     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1875     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1876     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1877     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1878
  1879     12  FILLER                  PIC  X(03) VALUE '033'.
  1880     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1881     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1882     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1883     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1884
  1885     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  36
* EL689.cbl
  1886     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1887     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1888     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1889     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1890
  1891     12  FILLER                  PIC  X(03) VALUE '035'.
  1892     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1893     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1894     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1895     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1896
  1897     12  FILLER                  PIC  X(03) VALUE '036'.
  1898     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1899     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1900     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1901     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1902**** CRED BENE NAME FROM ERMAIL
  1903     12  FILLER                  PIC  X(03) VALUE '037'.
  1904     12  FILLER                  PIC S9(04) COMP VALUE +25.
  1905     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1906     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1907     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1908*****REMAINING 2 ARE NOT CURRENTLY USED
  1909     12  FILLER                  PIC  X(03) VALUE '038'.
  1910     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1911     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1912     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1913     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1914
  1915     12  FILLER                  PIC  X(03) VALUE '039'.
  1916     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1917     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1918     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1919     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1920
  1921*************** ACCOUNT VARIABLES - ERACCT *********************
  1922*****ACCOUNT NAME
  1923     12  FILLER                  PIC  X(03) VALUE '040'.
  1924     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1925     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1926     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1927     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1928
  1929*****FULL ACCOUNT ADDRESS
  1930     12  FILLER                  PIC  X(03) VALUE '041'.
  1931     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1932     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1933     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1934     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1935
  1936     12  FILLER                  PIC  X(03) VALUE '042'.
  1937     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1938     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1939     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1940     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1941
  1942     12  FILLER                  PIC  X(03) VALUE '043'.
  1943     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  37
* EL689.cbl
  1944     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1945     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1946     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1947
  1948     12  FILLER                  PIC  X(03) VALUE '044'.
  1949     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1950     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1951     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1952     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1953
  1954     12  FILLER                  PIC  X(03) VALUE '045'.
  1955     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1956     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1957     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1958     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1959
  1960*****ACCOUNT PHONE NUMBER
  1961     12  FILLER                  PIC  X(03) VALUE '046'.
  1962     12  FILLER                  PIC S9(04) COMP VALUE +12.
  1963     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1964     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1965     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1966
  1967*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  1968     12  FILLER                  PIC  X(03) VALUE '047'.
  1969     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1970     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1971     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1972     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1973
  1974****ACCOUNT CSR CODE
  1975     12  FILLER                  PIC  X(03) VALUE '048'.
  1976     12  FILLER                  PIC S9(04) COMP VALUE +4..
  1977     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1978     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1979     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1980****ACCOUNT ACCOUNT NUMBER
  1981     12  FILLER                  PIC  X(03) VALUE '049'.
  1982     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1983     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1984     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1985     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1986
  1987**** CRED BENE ADDRESS LINE 1 ERMAIL
  1988     12  FILLER                  PIC  X(03) VALUE '050'.
  1989     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1990     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1991     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1992     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1993
  1994**** CRED BENE ADDRESS LINE 2 ERMAIL
  1995     12  FILLER                  PIC  X(03) VALUE '051'.
  1996     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1997     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1998     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1999     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2000
  2001**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  38
* EL689.cbl
  2002     12  FILLER                  PIC  X(03) VALUE '052'.
  2003     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2004     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2005     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2006     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2007
  2008**** CRED BENE ZIP  1 ERMAIL
  2009     12  FILLER                  PIC  X(03) VALUE '053'.
  2010     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2011     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2012     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2013     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2014
  2015*****REMAINING 6 ARE NOT CURRENTLY USED
  2016     12  FILLER                  PIC  X(03) VALUE '054'.
  2017     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2018     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2019     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2020     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2021
  2022     12  FILLER                  PIC  X(03) VALUE '055'.
  2023     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2024     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2025     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2026     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2027
  2028     12  FILLER                  PIC  X(03) VALUE '056'.
  2029     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2030     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2031     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2032     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2033
  2034     12  FILLER                  PIC  X(03) VALUE '057'.
  2035     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2036     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2037     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2038     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2039
  2040     12  FILLER                  PIC  X(03) VALUE '058'.
  2041     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2042     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2043     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2044     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2045
  2046     12  FILLER                  PIC  X(03) VALUE '059'.
  2047     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2048     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2049     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2050     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2051
  2052*************** NON FILE VARIABLES *****************************
  2053*****CURRENT DATE
  2054     12  FILLER                  PIC  X(03) VALUE '060'.
  2055     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2056     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2057     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2058     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2059
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  39
* EL689.cbl
  2060*****FULL CURRENT DATE
  2061     12  FILLER                  PIC  X(03) VALUE '061'.
  2062     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2063     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2064     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2065     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2066
  2067*****FORM
  2068     12  FILLER                  PIC  X(03) VALUE '062'.
  2069     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2070     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2071     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2072     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2073
  2074*****VARIABLE 1
  2075     12  FILLER                  PIC  X(03) VALUE '063'.
  2076     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2077     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2078     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2079     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2080
  2081*****VARIABLE 2
  2082     12  FILLER                  PIC  X(03) VALUE '064'.
  2083     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2084     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2085     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2086     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2087
  2088*****VARIABLE 3
  2089     12  FILLER                  PIC  X(03) VALUE '065'.
  2090     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2091     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2092     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2093     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2094
  2095*****VARIABLE 4
  2096     12  FILLER                  PIC  X(03) VALUE '066'.
  2097     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2098     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2099     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2100     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2101
  2102*****REMAINING 3 ARE NOT CURRENTLY USED
  2103     12  FILLER                  PIC  X(03) VALUE '067'.
  2104     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2105     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2106     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2107     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2108
  2109     12  FILLER                  PIC  X(03) VALUE '068'.
  2110     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2111     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2112     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2113     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2114
  2115     12  FILLER                  PIC  X(03) VALUE '069'.
  2116     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2117     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  40
* EL689.cbl
  2118     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2119     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2120
  2121************** CERTIFICATE VARIABLES - ELCERT *****************
  2122*****CARRIER CODE IN CERT
  2123     12  FILLER                  PIC  X(03) VALUE '070'.
  2124     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2125     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2126     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2127     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2128
  2129*****GROUPING CODE IN CERT
  2130     12  FILLER                  PIC  X(03) VALUE '071'.
  2131     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2132     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2133     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2134     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2135
  2136*****ACCOUNT NUMBER IN CERT
  2137     12  FILLER                  PIC  X(03) VALUE '072'.
  2138     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2139     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2140     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2141     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2142
  2143*****CERTIFICATE NUMBER
  2144     12  FILLER                  PIC  X(03) VALUE '073'.
  2145     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2146     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2147     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2148     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2149
  2150*****CERT EFFECTIVE DATE
  2151     12  FILLER                  PIC  X(03) VALUE '074'.
  2152     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2153     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2154     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2155     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2156
  2157*****CERT EXPIRATION DATE (LIFE)
  2158     12  FILLER                  PIC  X(03) VALUE '075'.
  2159     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2160     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2161     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2162     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2163
  2164*****CERT EXPIRATION DATE (AH)
  2165     12  FILLER                  PIC  X(03) VALUE '076'.
  2166     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2167     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2168     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2169     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2170
  2171*****LIFE TERM
  2172     12  FILLER                  PIC  X(03) VALUE '077'.
  2173     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2174     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2175     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  41
* EL689.cbl
  2176     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2177
  2178*****AH  TERM
  2179     12  FILLER                  PIC  X(03) VALUE '078'.
  2180     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2181     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2182     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2183     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2184
  2185*****LIFE COVERAGE AMOUNT
  2186     12  FILLER                  PIC  X(03) VALUE '079'.
  2187     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2188     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2189     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2190     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2191
  2192*****AH MONTHLY BENEFIT
  2193     12  FILLER                  PIC  X(03) VALUE '080'.
  2194     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2195     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2196     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2197     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2198
  2199*****LIFE CANCEL DATE
  2200     12  FILLER                  PIC  X(03) VALUE '081'.
  2201     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2202     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2203     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2204     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2205
  2206*****AH CANCEL DATE
  2207     12  FILLER                  PIC  X(03) VALUE '082'.
  2208     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2209     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2210     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2211     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2212
  2213*****LIFE COVERAGE FORM NUMBER
  2214     12  FILLER                  PIC  X(03) VALUE '083'.
  2215     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2216     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2217     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2218     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2219
  2220*****UNUSED
  2221     12  FILLER                  PIC  X(03) VALUE '084'.
  2222     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2223     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2224     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2225     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2226
  2227*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2228     12  FILLER                  PIC  X(03) VALUE '085'.
  2229     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2230     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2231     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2232     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2233
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  42
* EL689.cbl
  2234*****LOAN NUMBER
  2235     12  FILLER                  PIC  X(03) VALUE '086'.
  2236     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2237     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2238     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2239     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2240
  2241*****LOAN BALANCE
  2242     12  FILLER                  PIC  X(03) VALUE '087'.
  2243     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2244     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2245     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2246     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2247
  2248*****MEMBER NUMBER
  2249     12  FILLER                  PIC  X(03) VALUE '088'.
  2250     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2251     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2252     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2253     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2254
  2255*****INSURED SOC SEC NUMBER
  2256     12  FILLER                  PIC  X(03) VALUE '089'.
  2257     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2258     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2259     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2260     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2261
  2262*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2263     12  FILLER                  PIC  X(03) VALUE '090'.
  2264     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2265     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2266     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2267     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2268
  2269*****INSURED FIRST NAME (CERTIFICATE)
  2270     12  FILLER                  PIC  X(03) VALUE '091'.
  2271     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2272     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2273     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2274     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2275
  2276*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2277     12  FILLER                  PIC  X(03) VALUE '092'.
  2278     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2279     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2280     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2281     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2282
  2283*****ORIG TERM * MON BEN
  2284     12  FILLER                  PIC  X(03) VALUE '093'.
  2285     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2286     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2287     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2288     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2289
  2290*****INSURED'S NAME (LAST, FIRST, INIT)
  2291     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  43
* EL689.cbl
  2292     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2293     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2294     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2295     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2296
  2297*****INSURED'S NAME (FIRST, INIT, LAST)
  2298     12  FILLER                  PIC  X(03) VALUE  '095'.
  2299     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2300     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2301     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2302     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2303
  2304*****TITLE (MR/MS)
  2305     12  FILLER                  PIC  X(03) VALUE '096'.
  2306     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2307     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2308     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2309     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2310
  2311*****LIFE PREMIUM (CERTIFICATE)
  2312     12  FILLER                  PIC  X(03) VALUE '097'.
  2313     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2314     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2315     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2316     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2317
  2318*****A/H PREMIUM (CERTIFICATE)
  2319     12  FILLER                  PIC  X(03) VALUE '098'.
  2320     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2321     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2322     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2323     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2324
  2325*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2326     12  FILLER                  PIC  X(03) VALUE '099'.
  2327     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2328     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2329     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2330     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2331
  2332*****JOINT'S FIRST NAME (CERTIFICATE)
  2333     12  FILLER                  PIC  X(03) VALUE '100'.
  2334     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2335     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2336     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2337     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2338
  2339*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2340     12  FILLER                  PIC  X(03) VALUE '101'.
  2341     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2342     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2343     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2344     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2345
  2346*****JOINT'S NAME (LAST, FIRST, INIT)
  2347     12  FILLER                  PIC  X(03) VALUE '102'.
  2348     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2349     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  44
* EL689.cbl
  2350     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2351     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2352
  2353*****JOINT'S NAME (FIRST, INIT, LAST)
  2354     12  FILLER                  PIC  X(03) VALUE '103'.
  2355     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2356     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2357     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2358     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2359
  2360*****INSURED'S FIRST AND LAST NAME
  2361     12  FILLER                  PIC  X(03) VALUE '104'.
  2362     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2363     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2364     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2365     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2366
  2367*****JOINT'S FIRST AND LAST NAME
  2368     12  FILLER                  PIC  X(03) VALUE '105'.
  2369     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2370     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2371     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2372     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2373
  2374*****ENTERED LIFE REFUND (CERT)
  2375     12  FILLER                  PIC  X(03) VALUE '106'.
  2376     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2377     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2378     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2379     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2380
  2381*****ENTERED A/H REFUND (CERT)
  2382     12  FILLER                  PIC  X(03) VALUE '107'.
  2383     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2384     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2385     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2386     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2387
  2388*****INSURED'S LAST NAME
  2389     12  FILLER                  PIC  X(03) VALUE '108'.
  2390     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2391     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2392     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2393     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2394
  2395*****BENEFICIARY
  2396     12  FILLER                  PIC  X(03) VALUE  '109'.
  2397     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2398     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2399     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2400     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2401
  2402************** PENDING VARIABLES - ERPNDB *********************
  2403*****INSURED DATE OF BIRTH
  2404     12  FILLER                  PIC  X(03) VALUE '110'.
  2405     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2406     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2407     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  45
* EL689.cbl
  2408     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2409
  2410*****ENTERED LIFE PREMIUM (PENDING)
  2411     12  FILLER                  PIC  X(03) VALUE '111'.
  2412     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2413     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2414     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2415     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2416
  2417*****ENTERED A/H PREMIUM (PENDING)
  2418     12  FILLER                  PIC  X(03) VALUE '112'.
  2419     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2420     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2421     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2422     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2423
  2424*****CALCULATED LIFE PREMIUM (PENDING)
  2425     12  FILLER                  PIC  X(03) VALUE '113'.
  2426     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2427     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2428     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2429     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2430
  2431*****CALCULATED A/H PREMIUM (PENDING)
  2432     12  FILLER                  PIC  X(03) VALUE '114'.
  2433     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2434     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2435     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2436     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2437
  2438*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2439     12  FILLER                  PIC  X(03) VALUE '115'.
  2440     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2441     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2442     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2443     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2444
  2445*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2446     12  FILLER                  PIC  X(03) VALUE '116'.
  2447     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2448     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2449     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2450     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2451
  2452*****PRIOR CANCEL DATE
  2453     12  FILLER                  PIC  X(03) VALUE '117'.
  2454     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2455     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2456     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2457     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2458
  2459*****ENTERED LIFE REFUND (PENDING)
  2460     12  FILLER                  PIC  X(03) VALUE '118'.
  2461     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2462     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2463     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2464     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2465
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  46
* EL689.cbl
  2466*****ENTERED A/H REFUND (PENDING)
  2467     12  FILLER                  PIC  X(03) VALUE '119'.
  2468     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2469     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2470     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2471     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2472
  2473*****CALCULATED LIFE REFUND (PENDING)
  2474     12  FILLER                  PIC  X(03) VALUE '120'.
  2475     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2476     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2477     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2478     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2479
  2480*****CALCULATED A/H REFUND (PENDING)
  2481     12  FILLER                  PIC  X(03) VALUE '121'.
  2482     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2483     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2484     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2485     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2486
  2487*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2488     12  FILLER                  PIC  X(03) VALUE '122'.
  2489     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2490     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2491     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2492     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2493
  2494*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2495     12  FILLER                  PIC  X(03) VALUE '123'.
  2496     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2497     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2498     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2499     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2500
  2501*****INSUREDS AGE
  2502     12  FILLER                  PIC  X(03) VALUE '124'.
  2503     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2504     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2505     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2506     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2507
  2508*****LIFE BENEFIT (PENDING)
  2509     12  FILLER                  PIC  X(03) VALUE '125'.
  2510     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2511     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2512     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2513     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2514
  2515*****A/H BENEFIT (PENDING)
  2516     12  FILLER                  PIC  X(03) VALUE '126'.
  2517     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2518     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2519     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2520     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2521
  2522*****LIFE RATE
  2523     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  47
* EL689.cbl
  2524     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2525     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2526     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2527     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2528
  2529*****A/H RATE
  2530     12  FILLER                  PIC  X(03) VALUE '128'.
  2531     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2532     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2533     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2534     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2535
  2536*****TERM (PENDING)
  2537     12  FILLER                  PIC  X(03) VALUE '129'.
  2538     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2539     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2540     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2541     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2542
  2543*****BATCH NUMBER
  2544     12  FILLER                  PIC  X(03) VALUE '130'.
  2545     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2546     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2547     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2548     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2549
  2550*****TOTAL OF LIFE AND A&H REFUND
  2551     12  FILLER                  PIC  X(03) VALUE '131'.
  2552     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2553     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2554     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2555     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2556
  2557*****NH INTEREST ON REFUNDS
  2558     12  FILLER                  PIC  X(03) VALUE '132'.
  2559     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2560     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2561     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2562     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2563*****GREATER OF THE LIFE AND AH CANCEL DATE
  2564     12  FILLER                  PIC  X(03) VALUE '133'.
  2565     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2566     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2567     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2568     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2569
  2570*****THE NEXT 6 NOT CURRENTLY USED
  2571     12  FILLER                  PIC  X(03) VALUE '134'.
  2572     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2573     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2574     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2575     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2576
  2577     12  FILLER                  PIC  X(03) VALUE '135'.
  2578     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2579     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2580     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2581     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  48
* EL689.cbl
  2582
  2583     12  FILLER                  PIC  X(03) VALUE '136'.
  2584     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2585     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2586     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2587     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2588
  2589     12  FILLER                  PIC  X(03) VALUE '137'.
  2590     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2591     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2592     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2593     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2594
  2595     12  FILLER                  PIC  X(03) VALUE '138'.
  2596     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2597     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2598     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2599     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2600
  2601     12  FILLER                  PIC  X(03) VALUE '139'.
  2602     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2603     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2604     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2605     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2606
  2607************** COMPENSATION VARIABLES - ERCOMP ****************
  2608*****COMPENSATION ACCT NAME
  2609     12  FILLER                  PIC  X(03) VALUE '140'.
  2610     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2611     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2612     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2613     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2614
  2615*****FULL COMPENSATION ADDRESS TYPE 'A'
  2616     12  FILLER                  PIC  X(03) VALUE '141'.
  2617     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2618     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2619     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2620     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2621
  2622     12  FILLER                  PIC  X(03) VALUE '142'.
  2623     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2624     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2625     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2626     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2627
  2628     12  FILLER                  PIC  X(03) VALUE '143'.
  2629     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2630     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2631     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2632     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2633
  2634     12  FILLER                  PIC  X(03) VALUE '144'.
  2635     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2636     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2637     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2638     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2639
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  49
* EL689.cbl
  2640     12  FILLER                  PIC  X(03) VALUE '145'.
  2641     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2642     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2643     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2644     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2645
  2646     12  FILLER                  PIC  X(03) VALUE '146'.
  2647     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2648     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2649     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2650     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2651
  2652*****COMPENSATION PHONE NUMBER
  2653     12  FILLER                  PIC  X(03) VALUE '147'.
  2654     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2655     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2656     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2657     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2658
  2659*****COMPENSATION CSR NAME
  2660     12  FILLER                  PIC  X(03) VALUE '148'.
  2661     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2662     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2663     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2664     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2665
  2666*****COMPENSATION LAST STATEMENT DATE
  2667     12  FILLER                  PIC  X(03) VALUE '149'.
  2668     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2669     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2670     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2671     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2672
  2673*****COMPENSATION ENDING BALANCE
  2674     12  FILLER                  PIC  X(03) VALUE '150'.
  2675     12  FILLER                  PIC S9(04) COMP VALUE +14.
  2676     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2677     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2678     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2679
  2680******************  PROCESSOR DATA - ELCNTL (2) ****************
  2681*****EXECUTING PROCESSOR NAME
  2682     12  FILLER                  PIC  X(03) VALUE '151'.
  2683     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2684     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2685     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2686     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2687
  2688*****PROCESSOR TITLE
  2689     12  FILLER                  PIC  X(03) VALUE '152'.
  2690     12  FILLER                  PIC S9(04) COMP VALUE +26.
  2691     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2692     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2693     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2694
  2695*****PROCESSOR
  2696     12  FILLER                  PIC  X(03) VALUE '153'.
  2697     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  50
* EL689.cbl
  2698     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2699     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2700     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2701
  2702*****CSR TITLE
  2703     12  FILLER                  PIC  X(03) VALUE '154'.
  2704     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2705     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2706     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2707     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2708*****REMAINING 2 ARE NOT CURRENTLY USED
  2709     12  FILLER                  PIC  X(03) VALUE '155'.
  2710     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2711     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2712     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2713     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2714
  2715     12  FILLER                  PIC  X(03) VALUE '156'.
  2716     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2717     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2718     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2719     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2720
  2721******************  CHECK DATA - ERCHEK    *********************
  2722*****CHECK AMOUNT
  2723     12  FILLER                  PIC  X(03) VALUE '157'.
  2724     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2725     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2726     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2727     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2728
  2729*****CHECK NUMBER
  2730     12  FILLER                  PIC  X(03) VALUE '158'.
  2731     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2732     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2733     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2734     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2735
  2736*****PAYEE 1 NAME
  2737     12  FILLER                  PIC  X(03) VALUE '159'.
  2738     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2739     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2740     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2741     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2742
  2743*****PAYEE 2 NAME
  2744     12  FILLER                  PIC  X(03) VALUE '160'.
  2745     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2746     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2747     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2748     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2749
  2750*****ADDRSS 1
  2751     12  FILLER                  PIC  X(03) VALUE '161'.
  2752     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2753     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2754     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2755     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  51
* EL689.cbl
  2756
  2757*****ADDRESS 2
  2758     12  FILLER                  PIC  X(03) VALUE '162'.
  2759     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2760     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2761     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2762     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2763
  2764*****PAYEE CITY STATE
  2765     12  FILLER                  PIC  X(03) VALUE '163'.
  2766     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2767     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2768     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2769     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2770
  2771*****ZIP CODE
  2772     12  FILLER                  PIC  X(03) VALUE '164'.
  2773     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2774     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2775     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2776     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2777
  2778*****CHECK CONTROL
  2779     12  FILLER                  PIC  X(03) VALUE '165'.
  2780     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2781     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2782     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2783     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2784
  2785*****REASON FOR CHECK
  2786     12  FILLER                  PIC  X(03) VALUE '166'.
  2787     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2788     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2789     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2790     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2791
  2792*****REMAINING 3 ARE NOT CURRENTLY USED
  2793     12  FILLER                  PIC  X(03) VALUE '167'.
  2794     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2795     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2796     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2797     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2798
  2799     12  FILLER                  PIC  X(03) VALUE '168'.
  2800     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2801     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2802     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2803     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2804
  2805     12  FILLER                  PIC  X(03) VALUE '169'.
  2806     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2807     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2808     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2809     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2810
  2811
  2812*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  2813*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  52
* EL689.cbl
  2814     12  FILLER                  PIC  X(03) VALUE '170'.
  2815     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2816     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2817     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2818     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2819
  2820*****CHECK NUMBER - PYAJ
  2821     12  FILLER                  PIC  X(03) VALUE '171'.
  2822     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2823     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2824     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2825     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2826
  2827*****CHECK CONTROL - PYAJ
  2828     12  FILLER                  PIC  X(03) VALUE '172'.
  2829     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2830     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2831     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2832     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2833
  2834***** COMMENT - PYAJ
  2835     12  FILLER                  PIC  X(03) VALUE '173'.
  2836     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2837     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2838     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2839     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2840
  2841*****NEW FIELDS.
  2842*****COMPENSATION FULL ADDRESS TYPE 'G'
  2843     12  FILLER                  PIC  X(03) VALUE '174'.
  2844     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2845     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2846     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2847     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2848
  2849     12  FILLER                  PIC  X(03) VALUE '175'.
  2850     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2851     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2852     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2853     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2854
  2855     12  FILLER                  PIC  X(03) VALUE '176'.
  2856     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2857     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2858     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2859     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2860
  2861     12  FILLER                  PIC  X(03) VALUE '177'.
  2862     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2863     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2864     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2865     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2866
  2867     12  FILLER                  PIC  X(03) VALUE '178'.
  2868     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2869     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2870     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2871     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  53
* EL689.cbl
  2872
  2873     12  FILLER                  PIC  X(03) VALUE '179'.
  2874     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2875     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2876     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2877     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2878
  2879*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  2880     12  FILLER                  PIC  X(03) VALUE '180'.
  2881     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2882     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2883     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2884     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2885**** COMPENSATION BILLING SWITCH
  2886     12  FILLER                  PIC XXX    VALUE '181'.
  2887     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  2888     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  2889     12  FILLER                  PIC X      VALUE ALL 'N'.
  2890     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  2891*****COMPENSATION FAX NUMBER
  2892     12  FILLER                  PIC  X(03) VALUE '182'.
  2893     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2894     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2895     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2896     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2897**** COMPENSATION STATUS
  2898     12  FILLER                  PIC XXX    VALUE '183'.
  2899     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  2900     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  2901     12  FILLER                  PIC X      VALUE ALL 'N'.
  2902     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  2903***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  2904*****COMPENSATION FULL ADDRESS TYPE 'B'
  2905     12  FILLER                  PIC  X(03) VALUE '184'.
  2906     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2907     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2908     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2909     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2910
  2911     12  FILLER                  PIC  X(03) VALUE '185'.
  2912     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2913     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2914     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2915     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2916
  2917     12  FILLER                  PIC  X(03) VALUE '186'.
  2918     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2919     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2920     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2921     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2922
  2923     12  FILLER                  PIC  X(03) VALUE '187'.
  2924     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2925     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2926     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2927     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2928
  2929     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  54
* EL689.cbl
  2930     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2931     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2932     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2933     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2934
  2935     12  FILLER                  PIC  X(03) VALUE '189'.
  2936     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2937     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2938     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2939     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2940
  2941
  2942 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  2943*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  2944     12  W-VARIABLE-GRP OCCURS 189 TIMES
  2945                        INDEXED BY W-VG-NDX.
  2946         16  W-VARIABLE-ID         PIC  X(03).
  2947         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  2948         16  W-VG-TEXT.
  2949             20  W-VAR-CHAR
  2950                        OCCURS 30 TIMES
  2951                        INDEXED BY W-VC-NDX
  2952                                   PIC  X(01).
  2953         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  2954             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  2955
  2956         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  2957
  2958 01  W-VAR-END                   PIC  X(23)
  2959                        VALUE ':VARIABLE WORK AREA END'.
  2960
  2961 01  W-PROGRAM-TABLE-AREA.
  2962     12  FILLER                  PIC  X(15)
  2963                                 VALUE 'PROGRAM TABLES:'.
  2964
  2965     12  W-RECORD-TABLE              VALUE SPACES.
  2966         16  W-RC-GRP OCCURS 500 TIMES
  2967                       INDEXED BY W-RG-NDX
  2968                                  W-RG-NDX1.
  2969             20  W-RC-TEXT.
  2970                 24  W-RC-CHAR OCCURS 70 TIMES
  2971                                INDEXED BY W-RC-NDX
  2972                                           W-RC-NDX1
  2973                                 PIC  X(01).
  2974             20  W-RC-PC         PIC  9(02).
  2975             20  W-RC-SC         PIC  X(01).
  2976
  2977     12  FILLER REDEFINES W-RECORD-TABLE.
  2978         16  W-REC-CHAR OCCURS 36500 TIMES
  2979                        INDEXED BY W-RVS-NDX
  2980                                   W-RVS-NDX2
  2981                                 PIC  X(01).
  2982     12  FILLER REDEFINES W-RECORD-TABLE.
  2983         16  W-TS-GROUP OCCURS 10 TIMES
  2984                        INDEXED BY W-TS-NDX
  2985                                 PIC X(3650).
  2986
  2987     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  55
* EL689.cbl
  2988                                 VALUE 'TEXT TABLE:'.
  2989     12  W-TX-TABLE                  VALUE SPACES.
  2990         16  W-TX-GRP OCCURS 500 TIMES
  2991                       INDEXED BY W-TG-NDX
  2992                                  W-TG-NDX2.
  2993             20  W-TX-TEXT.
  2994                 24  W-TX-CHAR OCCURS 70 TIMES
  2995                                    INDEXED BY W-TX-NDX
  2996                                               W-TX-NDX1
  2997                                               W-TX-NDX2
  2998                                 PIC  X(01).
  2999             20  W-TX-PC         PIC  9(02).
  3000             20  W-TX-SC         PIC  X(01).
  3001
  3002     12  FILLER                  PIC  X(11)
  3003                                 VALUE 'FILE TABLE:'.
  3004     12  W-FILE-TABLE                VALUE SPACES.
  3005         16  W-FILE-USE-IND OCCURS 20 TIMES
  3006                       INDEXED BY W-FILE-NDX
  3007                                 PIC  X(01).
  3008             88  W-FILE-NOT-USED     VALUE SPACE.
  3009             88  W-FILE-USED         VALUE 'Y'.
  3010
  3011     12  FILLER                  PIC  X(14)
  3012                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  56
* EL689.cbl
  3014 01  ERROR-MESSAGES.
  3015     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3016     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3017     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3018     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3019     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3020     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3021     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3022     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3023     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3024     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3025     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3026     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3027     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3028     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3029     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3030     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3031     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3032     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3033     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3034     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3035     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3036     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3037     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3038     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3039     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3040     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3041     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3042     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3043     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3044     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3045     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3046     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3047     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3048     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3049     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3050     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3051     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3052     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3053     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3054     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3055     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3056     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3057     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3058     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3059     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3060     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3061     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3062     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3063     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3064     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3065     12  ER-3000                 PIC  X(04) VALUE '3000'.
  3066     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3067     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3068     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3069     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3070     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3071     12  ER-7245                 PIC  X(04) VALUE '7245'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  57
* EL689.cbl
  3072     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3073     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3074     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3075     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3076     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3077     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3078     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3079     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3080     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3081     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3082     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3083     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3084     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3085     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3086     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3087     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3088     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3089     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3090     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3091     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3092     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3093     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3094     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3095     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3096     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3097     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3098     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3099     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3100     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3101     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3102     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3103     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3104     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3105     12  ER-9427                 PIC  X(04) VALUE '9427'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  58
* EL689.cbl
  3107*    COPY ELCAID.
  3108******************************************************************
  3109*                                                                *
  3110*                            ELCAID.                             *
  3111*                            VMOD=2.001                          *
  3112*                                                                *
  3113*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3114*                                                                *
  3115*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3116*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3117******************************************************************
  3118
  3119 01  DFHAID.
  3120   02  DFHNULL   PIC  X  VALUE  ' '.
  3121   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3122   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3123   02  DFHPEN    PIC  X  VALUE  '='.
  3124   02  DFHOPID   PIC  X  VALUE  'W'.
  3125   02  DFHPA1    PIC  X  VALUE  '%'.
  3126   02  DFHPA2    PIC  X  VALUE  '>'.
  3127   02  DFHPA3    PIC  X  VALUE  ','.
  3128   02  DFHPF1    PIC  X  VALUE  '1'.
  3129   02  DFHPF2    PIC  X  VALUE  '2'.
  3130   02  DFHPF3    PIC  X  VALUE  '3'.
  3131   02  DFHPF4    PIC  X  VALUE  '4'.
  3132   02  DFHPF5    PIC  X  VALUE  '5'.
  3133   02  DFHPF6    PIC  X  VALUE  '6'.
  3134   02  DFHPF7    PIC  X  VALUE  '7'.
  3135   02  DFHPF8    PIC  X  VALUE  '8'.
  3136   02  DFHPF9    PIC  X  VALUE  '9'.
  3137   02  DFHPF10   PIC  X  VALUE  ':'.
  3138   02  DFHPF11   PIC  X  VALUE  '#'.
  3139   02  DFHPF12   PIC  X  VALUE  '@'.
  3140   02  DFHPF13   PIC  X  VALUE  'A'.
  3141   02  DFHPF14   PIC  X  VALUE  'B'.
  3142   02  DFHPF15   PIC  X  VALUE  'C'.
  3143   02  DFHPF16   PIC  X  VALUE  'D'.
  3144   02  DFHPF17   PIC  X  VALUE  'E'.
  3145   02  DFHPF18   PIC  X  VALUE  'F'.
  3146   02  DFHPF19   PIC  X  VALUE  'G'.
  3147   02  DFHPF20   PIC  X  VALUE  'H'.
  3148   02  DFHPF21   PIC  X  VALUE  'I'.
  3149*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3150   02  DFHPF22   PIC  X  VALUE  '['.
  3151   02  DFHPF23   PIC  X  VALUE  '.'.
  3152   02  DFHPF24   PIC  X  VALUE  '<'.
  3153   02  DFHMSRE   PIC  X  VALUE  'X'.
  3154   02  DFHSTRF   PIC  X  VALUE  'h'.
  3155   02  DFHTRIG   PIC  X  VALUE  '"'.
  3156 01  FILLER    REDEFINES DFHAID.
  3157     12  FILLER                  PIC  X(08).
  3158     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  59
* EL689.cbl
  3160*    COPY ELCATTR.
  3161******************************************************************
  3162*                                                                *
  3163*                            ELCATTR.                            *
  3164*                            VMOD=2.001                          *
  3165*                                                                *
  3166*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3167*                                                                *
  3168*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3169*                                                                *
  3170*                   POS 1   P=PROTECTED                          *
  3171*                           U=UNPROTECTED                        *
  3172*                           S=ASKIP                              *
  3173*                   POS 2   A=ALPHA/NUMERIC                      *
  3174*                           N=NUMERIC                            *
  3175*                   POS 3   N=NORMAL                             *
  3176*                           B=BRIGHT                             *
  3177*                           D=DARK                               *
  3178*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3179*                           OF=MODIFIED DATA TAG OFF             *
  3180*                                                                *
  3181*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3182******************************************************************
  3183 01  ATTRIBUTE-LIST.
  3184     12  AL-PABOF            PIC X       VALUE 'Y'.
  3185     12  AL-PABON            PIC X       VALUE 'Z'.
  3186     12  AL-PADOF            PIC X       VALUE '%'.
  3187     12  AL-PADON            PIC X       VALUE '_'.
  3188     12  AL-PANOF            PIC X       VALUE '-'.
  3189     12  AL-PANON            PIC X       VALUE '/'.
  3190     12  AL-SABOF            PIC X       VALUE '8'.
  3191     12  AL-SABON            PIC X       VALUE '9'.
  3192     12  AL-SADOF            PIC X       VALUE '@'.
  3193     12  AL-SADON            PIC X       VALUE QUOTE.
  3194     12  AL-SANOF            PIC X       VALUE '0'.
  3195     12  AL-SANON            PIC X       VALUE '1'.
  3196     12  AL-UABOF            PIC X       VALUE 'H'.
  3197     12  AL-UABON            PIC X       VALUE 'I'.
  3198     12  AL-UADOF            PIC X       VALUE '<'.
  3199     12  AL-UADON            PIC X       VALUE '('.
  3200     12  AL-UANOF            PIC X       VALUE ' '.
  3201     12  AL-UANON            PIC X       VALUE 'A'.
  3202     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3203     12  AL-UNBON            PIC X       VALUE 'R'.
  3204     12  AL-UNDOF            PIC X       VALUE '*'.
  3205     12  AL-UNDON            PIC X       VALUE ')'.
  3206     12  AL-UNNOF            PIC X       VALUE '&'.
  3207     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  60
* EL689.cbl
  3209*    COPY ELCDATE.
  3210******************************************************************
  3211*                                                                *
  3212*                                                                *
  3213*                            ELCDATE.                            *
  3214*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3215*                            VMOD=2.003
  3216*                                                                *
  3217*                                                                *
  3218*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3219*                 LENGTH = 200                                   *
  3220******************************************************************
  3221
  3222 01  DATE-CONVERSION-DATA.
  3223     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3224     12  DC-OPTION-CODE                PIC X.
  3225         88  BIN-TO-GREG                VALUE ' '.
  3226         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3227         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3228         88  YMD-GREG-TO-BIN            VALUE '3'.
  3229         88  MDY-GREG-TO-BIN            VALUE '4'.
  3230         88  JULIAN-TO-BIN              VALUE '5'.
  3231         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3232         88  FIND-CENTURY               VALUE '7'.
  3233         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3234         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3235         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3236         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3237         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3238         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3239         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3240         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3241         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3242         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3243         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3244         88  BIN-3-TO-GREG              VALUE 'I'.
  3245         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3246         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3247         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3248         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3249         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3250         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3251         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3252         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3253         88  THREE-CHARACTER-BIN
  3254                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3255         88  GREGORIAN-TO-BIN
  3256                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3257         88  BIN-TO-GREGORIAN
  3258                  VALUES ' ' '1' 'I' '8' 'G'.
  3259         88  JULIAN-TO-BINARY
  3260                  VALUES '5' 'C' 'E' 'F'.
  3261     12  DC-ERROR-CODE                 PIC X.
  3262         88  NO-CONVERSION-ERROR        VALUE ' '.
  3263         88  DATE-CONVERSION-ERROR
  3264                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3265         88  DATE-IS-ZERO               VALUE '1'.
  3266         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  61
* EL689.cbl
  3267         88  DATE-IS-INVALID            VALUE '3'.
  3268         88  DATE1-GREATER-DATE2        VALUE '4'.
  3269         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3270         88  DATE-INVALID-OPTION        VALUE '9'.
  3271         88  INVALID-CENTURY            VALUE 'A'.
  3272         88  ONLY-CENTURY               VALUE 'B'.
  3273         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3274         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3275     12  DC-END-OF-MONTH               PIC X.
  3276         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3277     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3278         88  USE-NORMAL-PROCESS         VALUE ' '.
  3279         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3280         88  ADJUST-UP-100-YRS          VALUE '2'.
  3281     12  FILLER                        PIC X.
  3282     12  DC-CONVERSION-DATES.
  3283         16  DC-BIN-DATE-1             PIC XX.
  3284         16  DC-BIN-DATE-2             PIC XX.
  3285         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3286         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3287                       DC-GREG-DATE-1-EDIT.
  3288             20  DC-EDIT1-MONTH        PIC 99.
  3289             20  SLASH1-1              PIC X.
  3290             20  DC-EDIT1-DAY          PIC 99.
  3291             20  SLASH1-2              PIC X.
  3292             20  DC-EDIT1-YEAR         PIC 99.
  3293         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3294         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3295                     DC-GREG-DATE-2-EDIT.
  3296             20  DC-EDIT2-MONTH        PIC 99.
  3297             20  SLASH2-1              PIC X.
  3298             20  DC-EDIT2-DAY          PIC 99.
  3299             20  SLASH2-2              PIC X.
  3300             20  DC-EDIT2-YEAR         PIC 99.
  3301         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3302         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3303                     DC-GREG-DATE-1-YMD.
  3304             20  DC-YMD-YEAR           PIC 99.
  3305             20  DC-YMD-MONTH          PIC 99.
  3306             20  DC-YMD-DAY            PIC 99.
  3307         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3308         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3309                      DC-GREG-DATE-1-MDY.
  3310             20  DC-MDY-MONTH          PIC 99.
  3311             20  DC-MDY-DAY            PIC 99.
  3312             20  DC-MDY-YEAR           PIC 99.
  3313         16  DC-GREG-DATE-1-ALPHA.
  3314             20  DC-ALPHA-MONTH        PIC X(10).
  3315             20  DC-ALPHA-DAY          PIC 99.
  3316             20  FILLER                PIC XX.
  3317             20  DC-ALPHA-CENTURY.
  3318                 24 DC-ALPHA-CEN-N     PIC 99.
  3319             20  DC-ALPHA-YEAR         PIC 99.
  3320         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3321         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3322         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3323         16  DC-JULIAN-DATE            PIC 9(05).
  3324         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  62
* EL689.cbl
  3325                                       PIC 9(05).
  3326         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3327             20  DC-JULIAN-YEAR        PIC 99.
  3328             20  DC-JULIAN-DAYS        PIC 999.
  3329         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3330         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3331         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3332     12  DATE-CONVERSION-VARIBLES.
  3333         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3334         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3335             20  FILLER                PIC 9(3).
  3336             20  HOLD-CEN-1-CCYY.
  3337                 24  HOLD-CEN-1-CC     PIC 99.
  3338                 24  HOLD-CEN-1-YY     PIC 99.
  3339             20  HOLD-CEN-1-MO         PIC 99.
  3340             20  HOLD-CEN-1-DA         PIC 99.
  3341         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3342             20  HOLD-CEN-1-R-MO       PIC 99.
  3343             20  HOLD-CEN-1-R-DA       PIC 99.
  3344             20  HOLD-CEN-1-R-CCYY.
  3345                 24  HOLD-CEN-1-R-CC   PIC 99.
  3346                 24  HOLD-CEN-1-R-YY   PIC 99.
  3347             20  FILLER                PIC 9(3).
  3348         16  HOLD-CENTURY-1-X.
  3349             20  FILLER                PIC X(3)  VALUE SPACES.
  3350             20  HOLD-CEN-1-X-CCYY.
  3351                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3352                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3353             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3354             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3355         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3356             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3357             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3358             20  HOLD-CEN-1-R-X-CCYY.
  3359                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3360                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3361             20  FILLER                PIC XXX.
  3362         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3363         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3364         16  DC-JULIAN-DATE-1          PIC 9(07).
  3365         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3366             20  DC-JULIAN-1-CCYY.
  3367                 24  DC-JULIAN-1-CC    PIC 99.
  3368                 24  DC-JULIAN-1-YR    PIC 99.
  3369             20  DC-JULIAN-DA-1        PIC 999.
  3370         16  DC-JULIAN-DATE-2          PIC 9(07).
  3371         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3372             20  DC-JULIAN-2-CCYY.
  3373                 24  DC-JULIAN-2-CC    PIC 99.
  3374                 24  DC-JULIAN-2-YR    PIC 99.
  3375             20  DC-JULIAN-DA-2        PIC 999.
  3376         16  DC-GREG-DATE-A-EDIT.
  3377             20  DC-EDITA-MONTH        PIC 99.
  3378             20  SLASHA-1              PIC X VALUE '/'.
  3379             20  DC-EDITA-DAY          PIC 99.
  3380             20  SLASHA-2              PIC X VALUE '/'.
  3381             20  DC-EDITA-CCYY.
  3382                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  63
* EL689.cbl
  3383                 24  DC-EDITA-YEAR     PIC 99.
  3384         16  DC-GREG-DATE-B-EDIT.
  3385             20  DC-EDITB-MONTH        PIC 99.
  3386             20  SLASHB-1              PIC X VALUE '/'.
  3387             20  DC-EDITB-DAY          PIC 99.
  3388             20  SLASHB-2              PIC X VALUE '/'.
  3389             20  DC-EDITB-CCYY.
  3390                 24  DC-EDITB-CENT     PIC 99.
  3391                 24  DC-EDITB-YEAR     PIC 99.
  3392         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3393         16  DC-GREG-DATE-CYMD-R REDEFINES
  3394                              DC-GREG-DATE-CYMD.
  3395             20  DC-CYMD-CEN           PIC 99.
  3396             20  DC-CYMD-YEAR          PIC 99.
  3397             20  DC-CYMD-MONTH         PIC 99.
  3398             20  DC-CYMD-DAY           PIC 99.
  3399         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3400         16  DC-GREG-DATE-MDCY-R REDEFINES
  3401                              DC-GREG-DATE-MDCY.
  3402             20  DC-MDCY-MONTH         PIC 99.
  3403             20  DC-MDCY-DAY           PIC 99.
  3404             20  DC-MDCY-CEN           PIC 99.
  3405             20  DC-MDCY-YEAR          PIC 99.
  3406    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3407        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3408    12  DC-EL310-DATE                  PIC X(21).
  3409    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  64
* EL689.cbl
  3411*    COPY ELCNWA.
  3412*****************************************************************
  3413*                                                               *
  3414*                                                               *
  3415*                            ELCNWA.                            *
  3416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3417*                            VMOD=2.003                         *
  3418*                                                               *
  3419*            M O V E   N A M E   W O R K   A R E A.             *
  3420*                                                               *
  3421*****************************************************************.
  3422
  3423 01  WS-NAME-WORK-AREA.
  3424     05  WS-INSURED-LAST-NAME        PIC X(15).
  3425     05  WS-INSURED-1ST-NAME         PIC X(12).
  3426     05  WS-INSURED-MID-INIT         PIC X.
  3427
  3428     05  WS-NAME-WORK.
  3429         10  WS-NW                   PIC X
  3430             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3431
  3432     05  WS-NAME-WORK2.
  3433         10  WS-NW2                  PIC X
  3434             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3435                                        NWA-INDEX0.
  3436
  3437     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3438                                     COMP-3.
  3439
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  65
* EL689.cbl
  3441*    COPY ELCEMIB.
  3442******************************************************************
  3443*                                                                *
  3444*                                                                *
  3445*                            ELCEMIB.                            *
  3446*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3447*                            VMOD=2.005                          *
  3448*                                                                *
  3449*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3450*                                                                *
  3451******************************************************************
  3452 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3453     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3454     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3455     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3456     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3457     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3458     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3459     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3460     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3461     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3462         88  EMI-NO-ERRORS                    VALUE '1'.
  3463         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3464         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3465     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3466         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3467     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3468         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3469         88  EMI-AREA1-FULL                   VALUE '2'.
  3470     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3471         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3472         88  EMI-AREA2-FULL                   VALUE '2'.
  3473     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3474         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3475         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3476         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3477         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3478         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3479     12  EMI-ERROR-LINES.
  3480         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3481         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3482         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3483         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3484             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3485                 24  EMI-ERR-NUM         PIC X(4).
  3486                 24  EMI-FILLER          PIC X.
  3487                 24  EMI-SEV             PIC X.
  3488                 24  FILLER              PIC X.
  3489             20  FILLER                  PIC X(02).
  3490     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3491         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3492             20  EMI-ERROR-NUMBER    PIC X(4).
  3493             20  EMI-FILL            PIC X.
  3494             20  EMI-SEVERITY        PIC X.
  3495             20  FILLER              PIC X.
  3496             20  EMI-ERROR-TEXT.
  3497                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3498                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  66
* EL689.cbl
  3499     12  EMI-SEVERITY-SAVE           PIC X.
  3500         88  EMI-NOTE                    VALUE 'N'.
  3501         88  EMI-WARNING                 VALUE 'W'.
  3502         88  EMI-FORCABLE                VALUE 'F'.
  3503         88  EMI-FATAL                   VALUE 'X'.
  3504     12  EMI-MESSAGE-FLAG            PIC X.
  3505         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3506         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3507     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3508     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3509         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3510         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3511         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3512     12  FILLER                      PIC X(137)  VALUE SPACES.
  3513     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3514     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3515     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3516     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3517 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  67
* EL689.cbl
  3519*    COPY ELCLOGOF.
  3520******************************************************************
  3521*                                                                *
  3522*                                                                *
  3523*                            ELCLOGOF.                           *
  3524*                            VMOD=2.001                          *
  3525*                                                                *
  3526*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3527*                                                                *
  3528******************************************************************
  3529 01  CLASIC-LOGOFF.
  3530     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3531     12  LOGOFF-TEXT.
  3532         16  FILLER          PIC X(5)    VALUE SPACES.
  3533         16  LOGOFF-MSG.
  3534             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3535             20  FILLER      PIC X       VALUE SPACES.
  3536             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3537         16  FILLER          PIC X(80)
  3538           VALUE '* YOU ARE NOW LOGGED OFF'.
  3539         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3540         16  FILLER          PIC X       VALUE QUOTE.
  3541         16  LOGOFF-SYS-MSG  PIC X(17)
  3542           VALUE 'S CLAS-IC SYSTEM '.
  3543     12  TEXT-MESSAGES.
  3544         16  UNACCESS-MSG    PIC X(29)
  3545             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3546         16  PGMIDERR-MSG    PIC X(17)
  3547             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  68
* EL689.cbl
  3549*    COPY ELCSCTM.
  3550******************************************************************
  3551*                                                                *
  3552*                                                                *
  3553*                            ELCSCTM                             *
  3554*                            VMOD=2.001                          *
  3555*                                                                *
  3556*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3557*                                                                *
  3558******************************************************************
  3559 01  SECURITY-MESSAGE.
  3560     12  FILLER                          PIC X(30)
  3561            VALUE '** LOGIC SECURITY VIOLATION -'.
  3562     12  SM-READ                         PIC X(6).
  3563     12  FILLER                          PIC X(5)
  3564            VALUE ' PGM='.
  3565     12  SM-PGM                          PIC X(6).
  3566     12  FILLER                          PIC X(5)
  3567            VALUE ' OPR='.
  3568     12  SM-PROCESSOR-ID                 PIC X(4).
  3569     12  FILLER                          PIC X(6)
  3570            VALUE ' TERM='.
  3571     12  SM-TERMID                       PIC X(4).
  3572     12  FILLER                          PIC XX   VALUE SPACE.
  3573     12  SM-JUL-DATE                     PIC 9(5).
  3574     12  FILLER                          PIC X    VALUE SPACE.
  3575     12  SM-TIME                         PIC 99.99.
  3576
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  69
* EL689.cbl
  3578*    COPY ELCSCRTY.
  3579******************************************************************
  3580*                                                                *
  3581*                                                                *
  3582*                            ELCSCRTY                            *
  3583*                            VMOD=2.001                          *
  3584*                                                                *
  3585*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3586*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3587*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3588*                                                                *
  3589******************************************************************
  3590 01  SECURITY-CONTROL.
  3591     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3592     12  FILLER                       PIC XX    VALUE 'SC'.
  3593     12  SC-CREDIT-CODES.
  3594         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3595             20  SC-CREDIT-DISPLAY    PIC X.
  3596             20  SC-CREDIT-UPDATE     PIC X.
  3597     12  SC-CLAIMS-CODES.
  3598         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  3599             20  SC-CLAIMS-DISPLAY    PIC X.
  3600             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  70
* EL689.cbl
  3602
  3603 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  71
* EL689.cbl
  3605****************************************************************
  3606*
  3607* Copyright (c) 2007 by Clerity Solutions, Inc.
  3608* All rights reserved.
  3609*
  3610****************************************************************
  3611 01  DFHEIV.
  3612   02  DFHEIV0               PIC X(35).
  3613   02  DFHEIV1               PIC X(08).
  3614   02  DFHEIV2               PIC X(08).
  3615   02  DFHEIV3               PIC X(08).
  3616   02  DFHEIV4               PIC X(06).
  3617   02  DFHEIV5               PIC X(04).
  3618   02  DFHEIV6               PIC X(04).
  3619   02  DFHEIV7               PIC X(02).
  3620   02  DFHEIV8               PIC X(02).
  3621   02  DFHEIV9               PIC X(01).
  3622   02  DFHEIV10              PIC S9(7) COMP-3.
  3623   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3624   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3625   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3626   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3627   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3628   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3629   02  DFHEIV17              PIC X(04).
  3630   02  DFHEIV18              PIC X(04).
  3631   02  DFHEIV19              PIC X(04).
  3632   02  DFHEIV20              USAGE IS POINTER.
  3633   02  DFHEIV21              USAGE IS POINTER.
  3634   02  DFHEIV22              USAGE IS POINTER.
  3635   02  DFHEIV23              USAGE IS POINTER.
  3636   02  DFHEIV24              USAGE IS POINTER.
  3637   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3638   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3639   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3640   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3641   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3642   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3643   02  FILLER                PIC X(02).
  3644   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3645   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3646   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3647   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3648   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3649 LINKAGE  SECTION.
  3650*****************************************************************
  3651*                                                               *
  3652* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3653* All rights reserved.                                          *
  3654*                                                               *
  3655*****************************************************************
  3656 01  dfheiblk.
  3657     02  eibtime          pic s9(7) comp-3.
  3658     02  eibdate          pic s9(7) comp-3.
  3659     02  eibtrnid         pic x(4).
  3660     02  eibtaskn         pic s9(7) comp-3.
  3661     02  eibtrmid         pic x(4).
  3662     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  72
* EL689.cbl
  3663     02  eibcposn         pic s9(4) comp.
  3664     02  eibcalen         pic s9(4) comp.
  3665     02  eibaid           pic x(1).
  3666     02  eibfiller1       pic x(1).
  3667     02  eibfn            pic x(2).
  3668     02  eibfiller2       pic x(2).
  3669     02  eibrcode         pic x(6).
  3670     02  eibfiller3       pic x(2).
  3671     02  eibds            pic x(8).
  3672     02  eibreqid         pic x(8).
  3673     02  eibrsrce         pic x(8).
  3674     02  eibsync          pic x(1).
  3675     02  eibfree          pic x(1).
  3676     02  eibrecv          pic x(1).
  3677     02  eibsend          pic x(1).
  3678     02  eibatt           pic x(1).
  3679     02  eibeoc           pic x(1).
  3680     02  eibfmh           pic x(1).
  3681     02  eibcompl         pic x(1).
  3682     02  eibsig           pic x(1).
  3683     02  eibconf          pic x(1).
  3684     02  eiberr           pic x(1).
  3685     02  eibrldbk         pic x(1).
  3686     02  eiberrcd         pic x(4).
  3687     02  eibsynrb         pic x(1).
  3688     02  eibnodat         pic x(1).
  3689     02  eibfiller5       pic x(2).
  3690     02  eibresp          pic 9(09) comp.
  3691     02  eibresp2         pic 9(09) comp.
  3692     02  dfheigdj         pic s9(4) comp.
  3693     02  dfheigdk         pic s9(4) comp.
  3694 01  DFHCOMMAREA                 PIC X(1024).
  3695
  3696*    COPY ERCACCT.
  3697******************************************************************
  3698*                                                                *
  3699*                                                                *
  3700*                            ERCACCT                             *
  3701*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3702*                            VMOD=2.031                          *
  3703*                                                                *
  3704*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3705*                                                                *
  3706*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3707*   VSAM ACCOUNT MASTER FILES.                                   *
  3708*                                                                *
  3709*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3710*                                                                *
  3711*   FILE TYPE = VSAM,KSDS                                        *
  3712*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3713*                                                                *
  3714*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3715*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3716*                                                                *
  3717*   LOG = NO                                                     *
  3718*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3719*                                                                *
  3720*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  73
* EL689.cbl
  3721******************************************************************
  3722*                   C H A N G E   L O G
  3723*
  3724* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3725*-----------------------------------------------------------------
  3726*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3727* EFFECTIVE    NUMBER
  3728*-----------------------------------------------------------------
  3729* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3730* 092705    2005050300006  PEMA  ADD SPP LEASES
  3731* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3732* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3733* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3734******************************************************************
  3735
  3736 01  ACCOUNT-MASTER.
  3737     12  AM-RECORD-ID                      PIC XX.
  3738         88  VALID-AM-ID                      VALUE 'AM'.
  3739
  3740     12  AM-CONTROL-PRIMARY.
  3741         16  AM-COMPANY-CD                 PIC X.
  3742         16  AM-MSTR-CNTRL.
  3743             20  AM-CONTROL-A.
  3744                 24  AM-CARRIER            PIC X.
  3745                 24  AM-GROUPING.
  3746                     28 AM-GROUPING-PREFIX PIC XXX.
  3747                     28 AM-GROUPING-PRIME  PIC XXX.
  3748                 24  AM-STATE              PIC XX.
  3749                 24  AM-ACCOUNT.
  3750                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3751                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3752             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3753                                           PIC X(19).
  3754             20  AM-CNTRL-B.
  3755                 24  AM-EXPIRATION-DT      PIC XX.
  3756                 24  FILLER                PIC X(4).
  3757             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3758                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3759
  3760     12  AM-CONTROL-BY-VAR-GRP.
  3761         16  AM-COMPANY-CD-A1              PIC X.
  3762         16  AM-VG-CARRIER                 PIC X.
  3763         16  AM-VG-GROUPING                PIC X(6).
  3764         16  AM-VG-STATE                   PIC XX.
  3765         16  AM-VG-ACCOUNT                 PIC X(10).
  3766         16  AM-VG-DATE.
  3767             20  AM-VG-EXPIRATION-DT       PIC XX.
  3768             20  FILLER                    PIC X(4).
  3769         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3770                                           PIC 9(11)      COMP-3.
  3771     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3772         16  FILLER                        PIC X(10).
  3773         16  AM-VG-KEY3.
  3774             20  AM-VG3-ACCOUNT            PIC X(10).
  3775             20  AM-VG3-EXP-DT             PIC XX.
  3776         16  FILLER                        PIC X(4).
  3777     12  AM-MAINT-INFORMATION.
  3778         16  AM-LAST-MAINT-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  74
* EL689.cbl
  3779         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3780         16  AM-LAST-MAINT-USER            PIC X(4).
  3781         16  FILLER                        PIC XX.
  3782
  3783     12  AM-EFFECTIVE-DT                   PIC XX.
  3784     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3785
  3786     12  AM-PREV-DATES  COMP-3.
  3787         16  AM-PREV-EXP-DT                PIC 9(11).
  3788         16  AM-PREV-EFF-DT                PIC 9(11).
  3789
  3790     12  AM-REPORT-CODE-1                  PIC X(10).
  3791     12  AM-REPORT-CODE-2                  PIC X(10).
  3792
  3793     12  AM-CITY-CODE                      PIC X(4).
  3794     12  AM-COUNTY-PARISH                  PIC X(6).
  3795
  3796     12  AM-NAME                           PIC X(30).
  3797     12  AM-PERSON                         PIC X(30).
  3798     12  AM-ADDRS                          PIC X(30).
  3799     12  AM-CITY.
  3800         16  AM-ADDR-CITY                  PIC X(28).
  3801         16  AM-ADDR-STATE                 PIC XX.
  3802     12  AM-ZIP.
  3803         16  AM-ZIP-PRIME.
  3804             20  AM-ZIP-PRI-1ST            PIC X.
  3805                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3806             20  FILLER                    PIC X(4).
  3807         16  AM-ZIP-PLUS4                  PIC X(4).
  3808     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3809         16  AM-CAN-POSTAL-1               PIC XXX.
  3810         16  AM-CAN-POSTAL-2               PIC XXX.
  3811         16  FILLER                        PIC XXX.
  3812     12  AM-TEL-NO.
  3813         16  AM-AREA-CODE                  PIC 999.
  3814         16  AM-TEL-PRE                    PIC 999.
  3815         16  AM-TEL-NBR                    PIC 9(4).
  3816     12  AM-TEL-LOC                        PIC X.
  3817         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3818         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3819
  3820     12  AM-COMM-STRUCTURE.
  3821         16  AM-DEFN-1.
  3822             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3823                 24  AM-AGT.
  3824                     28  AM-AGT-PREFIX     PIC X(4).
  3825                     28  AM-AGT-PRIME      PIC X(6).
  3826                 24  AM-COM-TYP            PIC X.
  3827                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3828                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3829                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3830                 24  AM-RECALC-LV-INDIC    PIC X.
  3831                 24  AM-RETRO-LV-INDIC     PIC X.
  3832                 24  AM-GL-CODES           PIC X.
  3833                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3834                 24  FILLER                PIC X(01).
  3835         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3836             20  AM-COM-TBLS        OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  75
* EL689.cbl
  3837                 24  FILLER                PIC X(11).
  3838                 24  AM-L-COMA             PIC XXX.
  3839                 24  AM-J-COMA             PIC XXX.
  3840                 24  AM-A-COMA             PIC XXX.
  3841                 24  FILLER                PIC X(6).
  3842
  3843     12  AM-COMM-CHANGE-STATUS             PIC X.
  3844         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3845
  3846     12  AM-CSR-CODE                       PIC X(4).
  3847
  3848     12  AM-BILLING-STATUS                 PIC X.
  3849         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3850         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3851     12  AM-AUTO-REFUND-SW                 PIC X.
  3852         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3853         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3854     12  AM-GPCD                           PIC 99.
  3855     12  AM-IG                             PIC X.
  3856         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3857         88  AM-HAS-GROUP                     VALUE '2'.
  3858     12  AM-STATUS                         PIC X.
  3859         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3860         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3861         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3862         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3863         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3864     12  AM-REMIT-TO                       PIC 99.
  3865     12  AM-ID-NO                          PIC X(11).
  3866
  3867     12  AM-CAL-TABLE                      PIC XX.
  3868     12  AM-LF-DEVIATION                   PIC XXX.
  3869     12  AM-AH-DEVIATION                   PIC XXX.
  3870     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3871     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3872     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3873     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3874     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3875     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3876
  3877     12  AM-USER-FIELDS.
  3878         16  AM-FLD-1                      PIC XX.
  3879         16  AM-FLD-2                      PIC XX.
  3880         16  AM-FLD-3                      PIC XX.
  3881         16  AM-FLD-4                      PIC XX.
  3882         16  AM-FLD-5                      PIC XX.
  3883
  3884     12  AM-1ST-PROD-DATE.
  3885         16  AM-1ST-PROD-YR                PIC XX.
  3886         16  AM-1ST-PROD-MO                PIC XX.
  3887         16  AM-1ST-PROD-DA                PIC XX.
  3888     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3889     12  AM-CERTS-PURGED-DATE.
  3890         16  AM-PUR-YR                     PIC XX.
  3891         16  AM-PUR-MO                     PIC XX.
  3892         16  AM-PUR-DA                     PIC XX.
  3893     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3894     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  76
* EL689.cbl
  3895     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3896     12  AM-INACTIVE-DATE.
  3897         16  AM-INA-MO                     PIC 99.
  3898         16  AM-INA-DA                     PIC 99.
  3899         16  AM-INA-YR                     PIC 99.
  3900     12  AM-AR-HI-CERT-DATE                PIC XX.
  3901
  3902     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3903     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3904
  3905     12  AM-OB-PAYMENT-MODE                PIC X.
  3906         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3907         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3908         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3909         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3910
  3911     12  AM-AH-ONLY-INDICATOR              PIC X.
  3912         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3913         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3914
  3915     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3916
  3917     12  AM-OVER-SHORT.
  3918         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3919         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3920
  3921     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3922     12  AM-DCC-CLP-STATE                  PIC XX.
  3923
  3924     12  AM-RECALC-COMM                    PIC X.
  3925     12  AM-RECALC-REIN                    PIC X.
  3926
  3927     12  AM-REI-TABLE                      PIC XXX.
  3928     12  AM-REI-ET-LF                      PIC X.
  3929     12  AM-REI-ET-AH                      PIC X.
  3930     12  AM-REI-PE-LF                      PIC X.
  3931     12  AM-REI-PE-AH                      PIC X.
  3932     12  AM-REI-PRT-ST                     PIC X.
  3933     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3934     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3935     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3936     12  AM-REI-GROUP-A                    PIC X(6).
  3937     12  AM-REI-MORT                       PIC X(4).
  3938     12  AM-REI-PRT-OW                     PIC X.
  3939     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3940     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3941     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3942     12  AM-REI-GROUP-B                    PIC X(6).
  3943
  3944     12  AM-TRUST-TYPE                     PIC X(2).
  3945
  3946     12  AM-EMPLOYER-STMT-USED             PIC X.
  3947     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3948
  3949     12  AM-STD-AH-TYPE                    PIC XX.
  3950     12  AM-EARN-METHODS.
  3951         16  AM-EARN-METHOD-R              PIC X.
  3952             88 AM-REF-RL-R78                 VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  77
* EL689.cbl
  3953             88 AM-REF-RL-PR                  VALUE 'P'.
  3954             88 AM-REF-RL-MEAN                VALUE 'M'.
  3955             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3956         16  AM-EARN-METHOD-L              PIC X.
  3957             88 AM-REF-LL-R78                 VALUE 'R'.
  3958             88 AM-REF-LL-PR                  VALUE 'P'.
  3959             88 AM-REF-LL-MEAN                VALUE 'M'.
  3960             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3961         16  AM-EARN-METHOD-A              PIC X.
  3962             88 AM-REF-AH-R78                 VALUE 'R'.
  3963             88 AM-REF-AH-PR                  VALUE 'P'.
  3964             88 AM-REF-AH-MEAN                VALUE 'M'.
  3965             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3966             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3967             88 AM-REF-AH-NET                 VALUE 'N'.
  3968
  3969     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3970     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3971     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3972
  3973     12  AM-RET-Y-N                        PIC X.
  3974     12  AM-RET-P-E                        PIC X.
  3975     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3976     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3977     12  AM-RET-GRP                        PIC X(6).
  3978     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3979         16  AM-POOL-PRIME                 PIC XXX.
  3980         16  AM-POOL-SUB                   PIC XXX.
  3981     12  AM-RETRO-EARNINGS.
  3982         16  AM-RET-EARN-R                 PIC X.
  3983         16  AM-RET-EARN-L                 PIC X.
  3984         16  AM-RET-EARN-A                 PIC X.
  3985     12  AM-RET-ST-TAX-USE                 PIC X.
  3986         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3987         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3988     12  AM-RETRO-BEG-EARNINGS.
  3989         16  AM-RET-BEG-EARN-R             PIC X.
  3990         16  AM-RET-BEG-EARN-L             PIC X.
  3991         16  AM-RET-BEG-EARN-A             PIC X.
  3992     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3993     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3994
  3995     12  AM-USER-SELECT-OPTIONS.
  3996         16  AM-USER-SELECT-1              PIC X(10).
  3997         16  AM-USER-SELECT-2              PIC X(10).
  3998         16  AM-USER-SELECT-3              PIC X(10).
  3999         16  AM-USER-SELECT-4              PIC X(10).
  4000         16  AM-USER-SELECT-5              PIC X(10).
  4001
  4002     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4003
  4004     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4005
  4006     12  AM-RPT045A-SWITCH                 PIC X.
  4007         88  RPT045A-OFF                   VALUE 'N'.
  4008
  4009     12  AM-INSURANCE-LIMITS.
  4010         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  78
* EL689.cbl
  4011         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4012
  4013     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4014         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4015
  4016     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4017         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4018         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4019
  4020     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4021
  4022     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4023     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4024     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4025     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4026     12  FILLER                            PIC X(5).
  4027     12  AM-REPORT-CODE-3                  PIC X(10).
  4028*    12  FILLER                            PIC X(22).
  4029
  4030     12  AM-RESERVE-DATE.
  4031         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4032         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4033         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4034
  4035     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4036     12  AM-NOTIFICATION-TYPES.
  4037         16  AM-NOTIF-OF-LETTERS           PIC X.
  4038         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4039         16  AM-NOTIF-OF-REPORTS           PIC X.
  4040         16  AM-NOTIF-OF-STATUS            PIC X.
  4041
  4042     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4043         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4044         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4045         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4046         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4047
  4048     12  AM-BENEFIT-CONTROLS.
  4049         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4050             20  AM-BENEFIT-CODE           PIC XX.
  4051             20  AM-BENEFIT-TYPE           PIC X.
  4052             20  AM-BENEFIT-REVISION       PIC XXX.
  4053             20  AM-BENEFIT-REM-TERM       PIC X.
  4054             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4055             20  FILLER                    PIC XX.
  4056         16  FILLER                        PIC X(80).
  4057
  4058     12  AM-TRANSFER-DATA.
  4059         16  AM-TRANSFERRED-FROM.
  4060             20  AM-TRNFROM-CARRIER        PIC X.
  4061             20  AM-TRNFROM-GROUPING.
  4062                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4063                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4064             20  AM-TRNFROM-STATE          PIC XX.
  4065             20  AM-TRNFROM-ACCOUNT.
  4066                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4067                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4068             20  AM-TRNFROM-DTE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  79
* EL689.cbl
  4069         16  AM-TRANSFERRED-TO.
  4070             20  AM-TRNTO-CARRIER          PIC X.
  4071             20  AM-TRNTO-GROUPING.
  4072                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4073                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4074             20  AM-TRNTO-STATE            PIC XX.
  4075             20  AM-TRNTO-ACCOUNT.
  4076                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4077                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4078             20  AM-TRNTO-DTE              PIC XX.
  4079         16  FILLER                        PIC X(10).
  4080
  4081     12  AM-SAVED-REMIT-TO                 PIC 99.
  4082
  4083     12  AM-COMM-STRUCTURE-SAVED.
  4084         16  AM-DEFN-1-SAVED.
  4085             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4086                 24  AM-AGT-SV             PIC X(10).
  4087                 24  AM-COM-TYP-SV         PIC X.
  4088                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4089                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4090                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4091                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4092                 24  FILLER                PIC X.
  4093                 24  AM-GL-CODES-SV        PIC X.
  4094                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4095                 24  FILLER                PIC X.
  4096         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4097             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4098                 24  FILLER                PIC X(11).
  4099                 24  AM-L-COMA-SV          PIC XXX.
  4100                 24  AM-J-COMA-SV          PIC XXX.
  4101                 24  AM-A-COMA-SV          PIC XXX.
  4102                 24  FILLER                PIC X(6).
  4103
  4104     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4105         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4106            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4107            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4108            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4109
  4110     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4111     12  FILLER                            PIC X(120).
  4112
  4113     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4114         16  AM-CONTROL-NAME               PIC X(30).
  4115         16  AM-EXECUTIVE-ONE.
  4116             20  AM-EXEC1-NAME             PIC X(15).
  4117             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4118                                                          COMP-3.
  4119             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4120                                                          COMP-3.
  4121         16  AM-EXECUTIVE-TWO.
  4122             20  AM-EXEC2-NAME             PIC X(15).
  4123             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4124                                                          COMP-3.
  4125             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4126                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  80
* EL689.cbl
  4127
  4128     12  AM-RETRO-ADDITIONAL-DATA.
  4129         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4130         16  AM-RETRO-PREM-P-E             PIC X.
  4131         16  AM-RETRO-CLMS-P-I             PIC X.
  4132         16  AM-RETRO-RET-BRACKET-LF.
  4133             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4134                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4135                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4136             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4137                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4138                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4139             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4140                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4141                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4142         16  AM-RETRO-RET-BRACKET-AH.
  4143             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4144                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4145                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4146                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4147             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4148                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4149                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4150             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4151                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4152                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4153
  4154     12  AM-COMMENTS.
  4155         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4156
  4157     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4158         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4159         16  AM-FLI-BILLING-CODE           PIC X.
  4160         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4161         16  AM-FLI-UNITED-IDENT           PIC X.
  4162         16  AM-FLI-INTEREST-LOST-DATA.
  4163             20  AM-FLI-BANK-NO            PIC X(5).
  4164             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4165             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4166             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4167         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4168             20  AM-FLI-AGT                PIC X(9).
  4169             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4170             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4171         16  FILLER                        PIC X(102).
  4172
  4173     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4174         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4175             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4176             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4177             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4178             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4179             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4180         16  FILLER                          PIC X(10).
  4181******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  81
* EL689.cbl
  4183*    COPY ERCARCH.
  4184******************************************************************
  4185*                                                                *
  4186*                            ERCARCH.                            *
  4187*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4188*                            VMOD=2.002                          *
  4189*                                                                *
  4190*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4191*                                                                *
  4192*   FILE TYPE = VSAM,KSDS                                        *
  4193*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4194*                                                                *
  4195*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4196*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4197*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4198*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4199*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4200*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4201*                                                                *
  4202*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4203******************************************************************
  4204*                   C H A N G E   L O G
  4205*
  4206* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4207*-----------------------------------------------------------------
  4208*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4209* EFFECTIVE    NUMBER
  4210*-----------------------------------------------------------------
  4211* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4212******************************************************************
  4213 01  LETTER-ARCHIVE.
  4214     12  LA-RECORD-ID                PIC  X(02).
  4215         88  LA-VALID-ID                VALUE 'LA'.
  4216
  4217     12  LA-CONTROL-PRIMARY.
  4218         16  LA-COMPANY-CD           PIC  X(01).
  4219         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4220
  4221     12  LA-CONTROL-BY-CERT-RESP.
  4222         16  LA-COMPANY-CD-A2        PIC  X(01).
  4223         16  LA-CERT-NO-A2.
  4224             20  LA-CERT-PRIME-A2    PIC  X(10).
  4225             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4226         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4227             20  LA-RESP-PERSON-A2   PIC  X(10).
  4228             20  LA-TYPE-A2          PIC  X(01).
  4229         16  LA-CARRIER-A2           PIC  X(01).
  4230         16  LA-GROUPING-A2          PIC  X(06).
  4231         16  LA-STATE-A2             PIC  X(02).
  4232         16  LA-ACCOUNT-A2           PIC  X(10).
  4233         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4234         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4235
  4236     12  LA-CONTROL-BY-FORM.
  4237         16  LA-COMPANY-CD-A3        PIC  X(01).
  4238         16  LA-FORM-A3              PIC  X(04).
  4239         16  LA-CARRIER-A3           PIC  X(01).
  4240         16  LA-GROUPING-A3          PIC  X(06).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  82
* EL689.cbl
  4241         16  LA-STATE-A3             PIC  X(02).
  4242         16  LA-ACCOUNT-A3           PIC  X(10).
  4243         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4244
  4245     12  LA-CONTROL-BY-PROCESSOR.
  4246         16  LA-COMPANY-CD-A4        PIC  X(01).
  4247         16  LA-PROCESSOR-CD         PIC  X(04).
  4248         16  LA-CARRIER-A4           PIC  X(01).
  4249         16  LA-GROUPING-A4          PIC  X(06).
  4250         16  LA-STATE-A4             PIC  X(02).
  4251         16  LA-ACCOUNT-A4           PIC  X(10).
  4252         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4253
  4254     12  LA-CONTROL-BY-KEY-FIELDS.
  4255         16  LA-COMPANY-CD-A5        PIC  X(01).
  4256         16  LA-CARRIER-A5           PIC  X(01).
  4257         16  LA-GROUPING-A5          PIC  X(06).
  4258         16  LA-STATE-A5             PIC  X(02).
  4259         16  LA-ACCOUNT-A5           PIC  X(10).
  4260         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4261
  4262     12  LA-CONTROL-BY-GROUP-CODE.
  4263         16  LA-COMPANY-CD-A6        PIC  X(01).
  4264         16  LA-ENTRY-A6.
  4265             20  LA-FILLER           PIC  X(02).
  4266             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4267         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4268
  4269     12  FILLER                      PIC  X(09).
  4270
  4271     12  LA-HEADER-RECORD.
  4272         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4273         16  LA-CREATION-DATE        PIC  X(02).
  4274         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4275         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4276         16  LA-NO-OF-COPIES         PIC S9(01).
  4277         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4278         16  LA-REPLY-DATE           PIC  X(02).
  4279         16  LA-RESEND-DATES.
  4280             20  LA-RESEND-DATE      PIC  X(02).
  4281             20  LA-SENT-DATE        PIC  X(02).
  4282             20  FILLER              PIC  X(08).
  4283         16  LA-SOURCE-INFORMATION.
  4284             20  LA-DATA-SOURCE      PIC  X(01).
  4285             20  LA-ADDR-SOURCE      PIC  X(01).
  4286         16  LA-STATUS               PIC  X(01).
  4287             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4288             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4289             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4290             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4291             88  LA-STATUS-PURGED         VALUE 'P'.
  4292             88  LA-STATUS-VOIDED         VALUE 'V'.
  4293         16  LA-LAST-RESENT-PRINT-DATE
  4294                                     PIC  X(02).
  4295         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4296             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4297                                          VALUE 'C'.
  4298             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  83
* EL689.cbl
  4299                                          VALUE 'F'.
  4300             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4301                                          VALUE 'P'.
  4302         16  LA-PURGED-DATE          PIC  X(02).
  4303         16  LA-VOIDED-DATE          PIC  X(02).
  4304         16  LA-RESEND-LETR          PIC  X(4).
  4305         16  FILLER                  PIC  X(08).
  4306*        16  LA-RESEND-LETR-2        PIC  X(4).
  4307*        16  LA-RESEND-LETR-3        PIC  X(4).
  4308         16  FILLER                  PIC  X(59).
  4309*        16  FILLER                  PIC  X(71).
  4310
  4311******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  84
* EL689.cbl
  4313*    COPY ERCARCT.
  4314******************************************************************
  4315*                                                                *
  4316*                            ERCARCT.                            *
  4317*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4318*                            VMOD=2.002                          *
  4319*                                                                *
  4320*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4321*                                                                *
  4322*   FILE TYPE = VSAM,KSDS                                        *
  4323*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4324*                                                                *
  4325*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4326*                                                                *
  4327*   LOG = NO                                                     *
  4328*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4329******************************************************************
  4330 01  LETTER-ARCHIVE-TEXT.
  4331     12  LT-RECORD-ID                PIC  X(02).
  4332         88  LT-VALID-ID                VALUE 'LA'.
  4333
  4334     12  LT-CONTROL-PRIMARY.
  4335         16  LT-COMPANY-CD           PIC  X(01).
  4336         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4337         16  LT-RECORD-TYPE          PIC  X(01).
  4338             88  LT-ADDRESS-DATA        VALUE '1'.
  4339             88  LT-TEXT-DATA           VALUE '2'.
  4340         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4341
  4342     12  FILLER                      PIC  X(28).
  4343     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4344
  4345     12  LT-TEXT-RECORD.
  4346         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4347                            INDEXED BY LT-NDX.
  4348             20  LT-TEXT-LINE        PIC  X(70).
  4349             20  LT-SKIP-CONTROL     PIC  X(02).
  4350                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4351                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4352             20  FILLER              PIC  X(08).
  4353
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  85
* EL689.cbl
  4355*    COPY ELCCERT.
  4356******************************************************************
  4357*                                                                *
  4358*                            ELCCERT.                            *
  4359*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4360*                            VMOD=2.013                          *
  4361*                                                                *
  4362*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4363*                                                                *
  4364*   FILE TYPE = VSAM,KSDS                                        *
  4365*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4366*                                                                *
  4367*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4368*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4369*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4370*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4371*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4372*                                                                *
  4373*   LOG = YES                                                    *
  4374*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4375******************************************************************
  4376*                   C H A N G E   L O G
  4377*
  4378* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4379*-----------------------------------------------------------------
  4380*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4381* EFFECTIVE    NUMBER
  4382*-----------------------------------------------------------------
  4383* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4384* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4385* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4386* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4387* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4388* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4389* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4390******************************************************************
  4391
  4392 01  CERTIFICATE-MASTER.
  4393     12  CM-RECORD-ID                      PIC XX.
  4394         88  VALID-CM-ID                      VALUE 'CM'.
  4395
  4396     12  CM-CONTROL-PRIMARY.
  4397         16  CM-COMPANY-CD                 PIC X.
  4398         16  CM-CARRIER                    PIC X.
  4399         16  CM-GROUPING.
  4400             20  CM-GROUPING-PREFIX        PIC X(3).
  4401             20  CM-GROUPING-PRIME         PIC X(3).
  4402         16  CM-STATE                      PIC XX.
  4403         16  CM-ACCOUNT.
  4404             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4405             20  CM-ACCOUNT-PRIME          PIC X(6).
  4406         16  CM-CERT-EFF-DT                PIC XX.
  4407         16  CM-CERT-NO.
  4408             20  CM-CERT-PRIME             PIC X(10).
  4409             20  CM-CERT-SFX               PIC X.
  4410
  4411     12  CM-CONTROL-BY-NAME.
  4412         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  86
* EL689.cbl
  4413         16  CM-INSURED-LAST-NAME          PIC X(15).
  4414         16  CM-INSURED-INITIALS.
  4415             20  CM-INSURED-INITIAL1       PIC X.
  4416             20  CM-INSURED-INITIAL2       PIC X.
  4417
  4418     12  CM-CONTROL-BY-SSN.
  4419         16  CM-COMPANY-CD-A2              PIC X.
  4420         16  CM-SOC-SEC-NO.
  4421             20  CM-SSN-STATE              PIC XX.
  4422             20  CM-SSN-ACCOUNT            PIC X(6).
  4423             20  CM-SSN-LN3.
  4424                 25  CM-INSURED-INITIALS-A2.
  4425                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4426                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4427                 25 CM-PART-LAST-NAME-A2         PIC X.
  4428
  4429     12  CM-CONTROL-BY-CERT-NO.
  4430         16  CM-COMPANY-CD-A4              PIC X.
  4431         16  CM-CERT-NO-A4                 PIC X(11).
  4432
  4433     12  CM-CONTROL-BY-MEMB.
  4434         16  CM-COMPANY-CD-A5              PIC X.
  4435         16  CM-MEMBER-NO.
  4436             20  CM-MEMB-STATE             PIC XX.
  4437             20  CM-MEMB-ACCOUNT           PIC X(6).
  4438             20  CM-MEMB-LN4.
  4439                 25  CM-INSURED-INITIALS-A5.
  4440                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4441                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4442                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4443
  4444     12  CM-INSURED-PROFILE-DATA.
  4445         16  CM-INSURED-FIRST-NAME.
  4446             20  CM-INSURED-1ST-INIT       PIC X.
  4447             20  FILLER                    PIC X(9).
  4448         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4449         16  CM-INSURED-SEX                PIC X.
  4450             88  CM-SEX-MALE                  VALUE 'M'.
  4451             88  CM-SEX-FEMAL                 VALUE 'F'.
  4452         16  CM-INSURED-JOINT-AGE          PIC 99.
  4453         16  CM-JOINT-INSURED-NAME.
  4454             20  CM-JT-LAST-NAME           PIC X(15).
  4455             20  CM-JT-FIRST-NAME.
  4456                 24  CM-JT-1ST-INIT        PIC X.
  4457                 24  FILLER                PIC X(9).
  4458             20  CM-JT-INITIAL             PIC X.
  4459
  4460     12  CM-LIFE-DATA.
  4461         16  CM-LF-BENEFIT-CD              PIC XX.
  4462         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4463         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4464         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4465         16  CM-LF-DEV-CODE                PIC XXX.
  4466         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4467         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4468         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4469         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4470         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  87
* EL689.cbl
  4471         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4472         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4473         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4474         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4475         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4476         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4477         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4478         16  FILLER                        PIC XX.
  4479
  4480     12  CM-AH-DATA.
  4481         16  CM-AH-BENEFIT-CD              PIC XX.
  4482         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4483         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4484         16  CM-AH-DEV-CODE                PIC XXX.
  4485         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4486         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4487         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4488         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4489         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4490         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4491         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4492         16  CM-AH-PAID-THRU-DT            PIC XX.
  4493             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4494         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4495         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4496         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4497         16  FILLER                        PIC X.
  4498
  4499     12  CM-LOAN-INFORMATION.
  4500         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4501         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4502         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4503         16  CM-PAY-FREQUENCY              PIC S99.
  4504         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4505         16  CM-RATE-CLASS                 PIC XX.
  4506         16  CM-BENEFICIARY                PIC X(25).
  4507         16  CM-POLICY-FORM-NO             PIC X(12).
  4508         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4509         16  CM-LAST-ADD-ON-DT             PIC XX.
  4510         16  CM-DEDUCTIBLE-AMOUNTS.
  4511             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4512             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4513         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4514             20  CM-RESIDENT-STATE         PIC XX.
  4515             20  CM-RATE-CODE              PIC X(4).
  4516             20  FILLER                    PIC XX.
  4517         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4518             20  CM-LOAN-OFFICER           PIC X(5).
  4519             20  FILLER                    PIC XXX.
  4520         16  CM-CSR-CODE                   PIC XXX.
  4521         16  CM-UNDERWRITING-CODE          PIC X.
  4522             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4523         16  CM-POST-CARD-IND              PIC X.
  4524         16  CM-NH-INTERFACE-SW            PIC X.
  4525         16  CM-PREMIUM-TYPE               PIC X.
  4526             88  CM-SING-PRM                  VALUE '1'.
  4527             88  CM-O-B-COVERAGE              VALUE '2'.
  4528             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  88
* EL689.cbl
  4529         16  CM-IND-GRP-TYPE               PIC X.
  4530             88  CM-INDIVIDUAL                VALUE 'I'.
  4531             88  CM-GROUP                     VALUE 'G'.
  4532         16  CM-SKIP-CODE                  PIC X.
  4533             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4534             88  SKIP-JULY                    VALUE '1'.
  4535             88  SKIP-AUGUST                  VALUE '2'.
  4536             88  SKIP-SEPTEMBER               VALUE '3'.
  4537             88  SKIP-JULY-AUG                VALUE '4'.
  4538             88  SKIP-AUG-SEPT                VALUE '5'.
  4539             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4540             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4541             88  SKIP-JUNE                    VALUE '8'.
  4542             88  SKIP-JUNE-JULY               VALUE '9'.
  4543             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4544             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4545         16  CM-PAYMENT-MODE               PIC X.
  4546             88  PAY-MONTHLY                  VALUE SPACE.
  4547             88  PAY-WEEKLY                   VALUE '1'.
  4548             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4549             88  PAY-BI-WEEKLY                VALUE '3'.
  4550             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4551         16  CM-LOAN-NUMBER                PIC X(8).
  4552         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4553         16  CM-OLD-LOF                    PIC XXX.
  4554*        16  CM-LOAN-OFFICER               PIC XXX.
  4555         16  CM-REIN-TABLE                 PIC XXX.
  4556         16  CM-SPECIAL-REIN-CODE          PIC X.
  4557         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4558         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4559         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4560
  4561     12  CM-STATUS-DATA.
  4562         16  CM-ENTRY-STATUS               PIC X.
  4563         16  CM-ENTRY-DT                   PIC XX.
  4564
  4565         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4566         16  CM-LF-CANCEL-DT               PIC XX.
  4567         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4568
  4569         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4570         16  CM-LF-DEATH-DT                PIC XX.
  4571         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4572
  4573         16  CM-LF-CURRENT-STATUS          PIC X.
  4574             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4575                                                'M' '4' '5' '9'.
  4576             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4577             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4578             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4579             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4580             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4581             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4582             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4583             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4584             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4585             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4586             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  89
* EL689.cbl
  4587             88  CM-LF-VOIDED                 VALUE 'V'.
  4588
  4589         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4590         16  CM-AH-CANCEL-DT               PIC XX.
  4591         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4592
  4593         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4594         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4595         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4596
  4597         16  CM-AH-CURRENT-STATUS          PIC X.
  4598             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4599                                                'M' '4' '5' '9'.
  4600             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4601             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4602             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4603             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4604             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4605             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4606             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4607             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4608             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4609             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4610             88  CM-AH-DECLINED               VALUE 'D'.
  4611             88  CM-AH-VOIDED                 VALUE 'V'.
  4612
  4613         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4614             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4615             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4616             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4617         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4618
  4619         16  CM-ENTRY-BATCH                PIC X(6).
  4620         16  CM-LF-EXIT-BATCH              PIC X(6).
  4621         16  CM-AH-EXIT-BATCH              PIC X(6).
  4622         16  CM-LAST-MONTH-END             PIC XX.
  4623
  4624     12  CM-NOTE-SW                        PIC X.
  4625         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4626         88  CERT-NOTES-PRESENT               VALUE '1'.
  4627         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4628         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4629         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4630         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4631         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4632         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4633     12  CM-COMP-EXCP-SW                   PIC X.
  4634         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4635         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4636     12  CM-INSURED-ADDRESS-SW             PIC X.
  4637         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4638         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4639
  4640*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4641     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4642     12  FILLER                            PIC X.
  4643
  4644*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  90
* EL689.cbl
  4645     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4646     12  FILLER                            PIC X.
  4647*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4648     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4649
  4650     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4651         88  CERT-ADDED-BATCH                 VALUE ' '.
  4652         88  CERT-ADDED-ONLINE                VALUE '1'.
  4653         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4654         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4655         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4656     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4657         88  CERT-AS-LOADED                   VALUE ' '.
  4658         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4659         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4660         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4661         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4662         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4663         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4664         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4665
  4666     12  CM-ACCOUNT-COMM-PCTS.
  4667         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4668         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4669
  4670     12  CM-USER-FIELD                     PIC X.
  4671     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4672     12  CM-CLP-STATE                      PIC XX.
  4673     12  CM-USER-RESERVED                  PIC XXX.
  4674******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  91
* EL689.cbl
  4676*    COPY ERCCHEK.
  4677******************************************************************
  4678*                                                                *
  4679*                                                                *
  4680*                            ERCCHEK                             *
  4681*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4682*                            VMOD=2.008                          *
  4683*                                                                *
  4684*   FILE DESCRIPTION = CHECK RECORDS                             *
  4685*                                                                *
  4686*   FILE TYPE = VSAM,KSDS                                        *
  4687*   RECORD SIZE = 600    RECFORM = FIXED                         *
  4688*                                                                *
  4689*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  4690*       ALTERNATE INDEX = NONE                                   *
  4691*                                                                *
  4692*   LOG = YES                                                    *
  4693*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4694******************************************************************
  4695 01  CHECK-RECORDS.
  4696     12  CH-RECORD-ID                      PIC XX.
  4697         88  VALID-CH-ID                      VALUE 'CH'.
  4698
  4699     12  CH-CONTROL-PRIMARY.
  4700         16  CH-COMPANY-CD                 PIC X.
  4701         16  CH-CARRIER                    PIC X.
  4702         16  CH-GROUPING                   PIC X(6).
  4703         16  CH-STATE                      PIC XX.
  4704         16  CH-ACCOUNT                    PIC X(10).
  4705         16  CH-CERT-EFF-DT                PIC XX.
  4706         16  CH-CERT-NO.
  4707             20  CH-CERT-PRIME             PIC X(10).
  4708             20  CH-CERT-SFX               PIC X.
  4709         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  4710
  4711     12  CH-RECORDED-DT                    PIC XX.
  4712     12  CH-RECORDED-BY                    PIC X(4).
  4713     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  4714
  4715     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  4716     12  CH-CHECK-NO                       PIC X(7).
  4717     12  CH-REASON-FOR-CHECK               PIC X(25).
  4718     12  CH-CHECK-WRITTEN-DT               PIC XX.
  4719     12  CH-OFFLINE-CHECK-IND              PIC X.
  4720         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  4721
  4722     12  CH-PAYEE-INFO.
  4723         16  CH-PAYEE-NAME-1               PIC X(30).
  4724         16  CH-PAYEE-NAME-2               PIC X(30).
  4725         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  4726         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  4727         16  CH-PAYEE-CITY-ST              PIC X(30).
  4728         16  CH-PAYEE-ZIP-CODE.
  4729             20  CH-PAYEE-ZIP.
  4730                 24  CH-ZIP-PRI-1ST        PIC X.
  4731                     88  CH-CANADIAN-POST-CODE
  4732                                           VALUES 'A' THRU 'Z'.
  4733                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  92
* EL689.cbl
  4734             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  4735         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  4736             20  CH-CAN-POSTAL-1           PIC XXX.
  4737             20  CH-CAN-POSTAL-2           PIC XXX.
  4738             20  FILLER                    PIC XXX.
  4739
  4740     12  CH-CHECK-STUB-TEXT.
  4741         16  CH-STUB-LINE-1                PIC X(50).
  4742         16  CH-STUB-LINE-2                PIC X(50).
  4743         16  CH-STUB-LINE-3                PIC X(50).
  4744         16  FILLER.
  4745           18  CH-STUB-LINE-4              PIC X(20).
  4746           18  CH-LIENHOLDER-NAME          PIC X(30).
  4747
  4748     12  CH-COMPENSATION-CONTROL.
  4749         16  CH-COMP-CARRIER               PIC X.
  4750         16  CH-COMP-GROUPING              PIC X(6).
  4751         16  CH-COMP-FIN-RESP              PIC X(10).
  4752         16  CH-COMP-ACCOUNT               PIC X(10).
  4753
  4754     12  CH-CREDIT-SELECT-DT               PIC XX.
  4755     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  4756     12  CH-PAYEE-CODE                     PIC X(6).
  4757
  4758     12  CH-VOID-DATA.
  4759         20  CH-VOID-DT                    PIC XX.
  4760         20  CH-VOID-BY                    PIC X(4).
  4761         20  CH-VOID-REASON                PIC X(25).
  4762
  4763     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  4764             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4765     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  4766
  4767     12  CH-CHECK-REFERENCE                PIC X(12).
  4768     12  CH-CHECK-ORIGIN-SW                PIC X.
  4769             88  CH-REFUND-CHECK              VALUE 'R'.
  4770             88  CH-MAINT-CHECK               VALUE 'M'.
  4771
  4772     12  CH-CANC-DT                        PIC XX.
  4773     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  4774     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  4775
  4776     12  CH-INSURED-NAME                   PIC X(28).
  4777
  4778     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  4779     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  4780
  4781     12  CH-LETTER-TABLE.
  4782         16  CH-LETTERS OCCURS 3 TIMES
  4783                        INDEXED BY CH-LT-NDX
  4784                                           PIC X(04).
  4785
  4786     12  FILLER                            PIC X(07).
  4787
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  93
* EL689.cbl
  4789*    COPY ELCCNTL.
  4790******************************************************************
  4791*                                                                *
  4792*                                                                *
  4793*                            ELCCNTL.                            *
  4794*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4795*                            VMOD=2.059                          *
  4796*                                                                *
  4797*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4798*                                                                *
  4799*   FILE TYPE = VSAM,KSDS                                        *
  4800*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4801*                                                                *
  4802*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4803*       ALTERNATE INDEX = NONE                                   *
  4804*                                                                *
  4805*   LOG = YES                                                    *
  4806*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4807******************************************************************
  4808*                   C H A N G E   L O G
  4809*
  4810* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4811*-----------------------------------------------------------------
  4812*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4813* EFFECTIVE    NUMBER
  4814*-----------------------------------------------------------------
  4815* 082503                   PEMA  ADD BENEFIT GROUP
  4816* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4817* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4818* 092705    2005050300006  PEMA  ADD SPP LEASES
  4819* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4820* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4821* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4822* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4823******************************************************************
  4824*
  4825 01  CONTROL-FILE.
  4826     12  CF-RECORD-ID                       PIC XX.
  4827         88  VALID-CF-ID                        VALUE 'CF'.
  4828
  4829     12  CF-CONTROL-PRIMARY.
  4830         16  CF-COMPANY-ID                  PIC XXX.
  4831         16  CF-RECORD-TYPE                 PIC X.
  4832             88  CF-COMPANY-MASTER              VALUE '1'.
  4833             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4834             88  CF-STATE-MASTER                VALUE '3'.
  4835             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4836             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4837             88  CF-CARRIER-MASTER              VALUE '6'.
  4838             88  CF-MORTALITY-MASTER            VALUE '7'.
  4839             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4840             88  CF-TERMINAL-MASTER             VALUE '9'.
  4841             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4842             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4843             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4844             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4845             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4846             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  94
* EL689.cbl
  4847             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4848             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4849             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4850         16  CF-ACCESS-CD-GENL              PIC X(4).
  4851         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4852             20  CF-PROCESSOR               PIC X(4).
  4853         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4854             20  CF-STATE-CODE              PIC XX.
  4855             20  FILLER                     PIC XX.
  4856         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4857             20  FILLER                     PIC XX.
  4858             20  CF-HI-BEN-IN-REC           PIC XX.
  4859         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4860             20  FILLER                     PIC XXX.
  4861             20  CF-CARRIER-CNTL            PIC X.
  4862         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4863             20  FILLER                     PIC XX.
  4864             20  CF-HI-TYPE-IN-REC          PIC 99.
  4865         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4866             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4867                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4868             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4869             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4870         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4871             20  FILLER                     PIC X.
  4872             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4873         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4874             20  FILLER                     PIC XX.
  4875             20  CF-MORTGAGE-PLAN           PIC XX.
  4876         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4877
  4878     12  CF-LAST-MAINT-DT                   PIC XX.
  4879     12  CF-LAST-MAINT-BY                   PIC X(4).
  4880     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4881
  4882     12  CF-RECORD-BODY                     PIC X(728).
  4883
  4884
  4885****************************************************************
  4886*             COMPANY MASTER RECORD                            *
  4887****************************************************************
  4888
  4889     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4890         16  CF-COMPANY-ADDRESS.
  4891             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4892             20  CF-CL-IN-CARE-OF           PIC X(30).
  4893             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4894             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4895             20  CF-CL-CITY-STATE           PIC X(30).
  4896             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4897             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4898         16  CF-COMPANY-CD                  PIC X.
  4899         16  CF-COMPANY-PASSWORD            PIC X(8).
  4900         16  CF-SECURITY-OPTION             PIC X.
  4901             88  ALL-SECURITY                   VALUE '1'.
  4902             88  COMPANY-VERIFY                 VALUE '2'.
  4903             88  PROCESSOR-VERIFY               VALUE '3'.
  4904             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  95
* EL689.cbl
  4905             88  ALL-BUT-TERM                   VALUE '5'.
  4906         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4907             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4908         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4909             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4910         16  CF-INFORCE-LOCATION            PIC X.
  4911             88  CERTS-ARE-ONLINE               VALUE '1'.
  4912             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4913             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4914         16  CF-LOWER-CASE-LETTERS          PIC X.
  4915         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4916             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4917             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4918             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4919             88  CF-ACCNT-CNTL                  VALUE '3'.
  4920             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4921
  4922         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4923         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4924
  4925         16  CF-LGX-CREDIT-USER             PIC X.
  4926             88  CO-IS-NOT-USER                 VALUE 'N'.
  4927             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4928
  4929         16 CF-CREDIT-CALC-CODES.
  4930             20  CF-CR-REM-TERM-CALC PIC X.
  4931               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4932               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4933               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4934               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4935               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4936               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4937               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4938             20  CF-CR-R78-METHOD           PIC X.
  4939               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4940               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4941
  4942         16  CF-CLAIM-CONTROL-COUNTS.
  4943             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4944                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4945
  4946             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4947                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4948
  4949             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4950                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4951
  4952             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4953                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4954
  4955         16  CF-CURRENT-MONTH-END           PIC XX.
  4956
  4957         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4958             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4959             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4960             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4961             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4962                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  96
* EL689.cbl
  4963                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4964             20  CF-CO-PREM-REJECT-SW       PIC X.
  4965                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4966                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4967             20  CF-CO-REF-REJECT-SW        PIC X.
  4968                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4969                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4970
  4971         16  CF-CO-REPORTING-DT             PIC XX.
  4972         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4973         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4974           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4975           88  CF-CO-MONTH-END                  VALUE '1'.
  4976
  4977         16  CF-LGX-CLAIM-USER              PIC X.
  4978             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4979             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4980
  4981         16  CF-CREDIT-EDIT-CONTROLS.
  4982             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4983             20  CF-MIN-AGE                 PIC 99.
  4984             20  CF-DEFAULT-AGE             PIC 99.
  4985             20  CF-MIN-TERM                PIC S999      COMP-3.
  4986             20  CF-MAX-TERM                PIC S999      COMP-3.
  4987             20  CF-DEFAULT-SEX             PIC X.
  4988             20  CF-JOINT-AGE-INPUT         PIC X.
  4989                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4990             20  CF-BIRTH-DATE-INPUT        PIC X.
  4991                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4992             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4993                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4994                 88  CF-ZERO-CARRIER            VALUE '1'.
  4995                 88  CF-ZERO-GROUPING           VALUE '2'.
  4996                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4997             20  CF-EDIT-SW                 PIC X.
  4998                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4999             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5000             20  CF-CR-PR-METHOD            PIC X.
  5001               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5002               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5003             20  FILLER                     PIC X.
  5004
  5005         16  CF-CREDIT-MISC-CONTROLS.
  5006             20  CF-REIN-TABLE-SW           PIC X.
  5007                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5008             20  CF-COMP-TABLE-SW           PIC X.
  5009                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5010             20  CF-EXPERIENCE-RETENTION-AGE
  5011                                            PIC S9        COMP-3.
  5012             20  CF-CONVERSION-DT           PIC XX.
  5013             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5014             20  CF-RUN-FREQUENCY-SW        PIC X.
  5015                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5016                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5017
  5018             20  CF-CR-CHECK-NO-CONTROL.
  5019                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5020                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  97
* EL689.cbl
  5021                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5022                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5023                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5024                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5025
  5026                 24  CF-CR-CHECK-COUNT       REDEFINES
  5027                     CF-CR-CHECK-COUNTER      PIC X(4).
  5028
  5029                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5030                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5031
  5032                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5033                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5034                 24  CF-MAIL-PROCESSING       PIC X.
  5035                     88  MAIL-PROCESSING          VALUE 'Y'.
  5036
  5037         16  CF-MISC-SYSTEM-CONTROL.
  5038             20  CF-SYSTEM-C                 PIC X.
  5039                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5040             20  CF-SYSTEM-D                 PIC X.
  5041                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5042             20  CF-SOC-SEC-NO-SW            PIC X.
  5043                 88  SOC-SEC-NO-USED             VALUE '1'.
  5044             20  CF-MEMBER-NO-SW             PIC X.
  5045                 88  MEMBER-NO-USED              VALUE '1'.
  5046             20  CF-TAX-ID-NUMBER            PIC X(11).
  5047             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5048             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5049                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5050                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5051                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5052                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5053             20  CF-SYSTEM-E                 PIC X.
  5054                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5055
  5056         16  CF-LGX-LIFE-USER               PIC X.
  5057             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5058             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5059
  5060         16  CF-CR-MONTH-END-DT             PIC XX.
  5061
  5062         16  CF-FILE-MAINT-DATES.
  5063             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5064                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5065             20  CF-LAST-BATCH       REDEFINES
  5066                 CF-LAST-BATCH-NO               PIC X(4).
  5067             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5068             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5069             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5070             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5071             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5072             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5073             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5074             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5075             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5076             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5077
  5078         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  98
* EL689.cbl
  5079         16  FILLER                         PIC X.
  5080
  5081         16  CF-ALT-MORT-CODE               PIC X(4).
  5082         16  CF-MEMBER-CAPTION              PIC X(10).
  5083
  5084         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5085             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5086             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5087             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5088             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5089             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5090
  5091         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5092
  5093         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5094         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5095         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5096         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5097
  5098         16  CF-AH-OVERRIDE-L1              PIC X.
  5099         16  CF-AH-OVERRIDE-L2              PIC XX.
  5100         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5101         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5102
  5103         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5104         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5105
  5106         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5107         16  CF-AR-LAST-EL860-DT            PIC XX.
  5108         16  CF-MP-MONTH-END-DT             PIC XX.
  5109
  5110         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5111         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5112             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5113
  5114         16  CF-AR-MONTH-END-DT             PIC XX.
  5115
  5116         16  CF-CRDTCRD-USER                PIC X.
  5117             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5118             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5119
  5120         16  CF-CC-MONTH-END-DT             PIC XX.
  5121
  5122         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5123
  5124         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5125             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5126             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5127             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5128         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5129         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5130         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5131         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5132             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5133             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5134         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5135         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5136         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page  99
* EL689.cbl
  5137             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5138         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5139
  5140         16  CF-CL-ZIP-CODE.
  5141             20  CF-CL-ZIP-PRIME.
  5142                 24  CF-CL-ZIP-1ST          PIC X.
  5143                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5144                 24  FILLER                 PIC X(4).
  5145             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5146         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5147             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5148             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5149             20  FILLER                     PIC XXX.
  5150
  5151         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5152         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5153         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5154         16  CF-CO-OPTION-START-DATE        PIC XX.
  5155         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5156           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5157                                                      '3' '4'.
  5158           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5159           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5160           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5161           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5162           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5163           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5164
  5165         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5166
  5167         16  CF-PAYMENT-APPROVAL-LEVELS.
  5168             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5169             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5170             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5171             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5172             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5173             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5174
  5175         16  CF-END-USER-REPORTING-USER     PIC X.
  5176             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5177             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5178
  5179         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5180             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5181             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5182
  5183         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5184
  5185         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5186         16  FILLER                         PIC X.
  5187
  5188         16  CF-CREDIT-ARCHIVE-CNTL.
  5189             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5190             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5191             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5192
  5193         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5194
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 100
* EL689.cbl
  5195         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5196             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5197             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5198
  5199         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5200             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5201             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5202
  5203         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5204
  5205         16  CF-CO-ACH-ID-CODE              PIC  X.
  5206             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5207             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5208             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5209         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5210         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5211         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5212         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5213         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5214         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5215         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5216         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5217         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5218                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5219         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5220                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5221
  5222         16  CF-CO-OVER-SHORT.
  5223             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5224             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5225
  5226*         16  FILLER                         PIC X(102).
  5227         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5228             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5229             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5230
  5231         16  CF-AH-APPROVAL-DAYS.
  5232             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5233             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5234             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5235             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5236
  5237         16  FILLER                         PIC X(82).
  5238****************************************************************
  5239*             PROCESSOR/USER RECORD                            *
  5240****************************************************************
  5241
  5242     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5243         16  CF-PROCESSOR-NAME              PIC X(30).
  5244         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5245         16  CF-PROCESSOR-TITLE             PIC X(26).
  5246         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5247                 88  MESSAGE-YES                VALUE 'Y'.
  5248                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5249
  5250*****************************************************
  5251****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5252****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 101
* EL689.cbl
  5253****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5254****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5255*****************************************************
  5256
  5257         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5258             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5259             20  CF-APPLICATION-FORCE       PIC X.
  5260             20  CF-INDIVIDUAL-APP.
  5261                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5262                     28  CF-BROWSE-APP      PIC X.
  5263                     28  CF-UPDATE-APP      PIC X.
  5264
  5265         16  CF-CURRENT-TERM-ON             PIC X(4).
  5266         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5267             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5268             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5269             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5270             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5271             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5272             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5273             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5274         16  CF-PROCESSOR-CARRIER           PIC X.
  5275             88  NO-CARRIER-SECURITY            VALUE ' '.
  5276         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5277             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5278         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5279             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5280         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5281             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5282
  5283         16  CF-PROC-SYS-ACCESS-SW.
  5284             20  CF-PROC-CREDIT-CLAIMS-SW.
  5285                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5286                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5287                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5288                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5289             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5290                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5291                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5292             20  CF-PROC-LIFE-GNRLDGR-SW.
  5293                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5294                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5295                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5296                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5297             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5298                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5299                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5300         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5301             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5302             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5303         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5304
  5305         16  CF-APPROVAL-LEVEL                  PIC X.
  5306             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5307             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5308             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5309             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5310
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 102
* EL689.cbl
  5311         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5312
  5313         16  CF-LANGUAGE-TYPE                   PIC X.
  5314             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5315             88  CF-LANG-IS-FR                      VALUE 'F'.
  5316         16  FILLER                             PIC  X(240).
  5317
  5318****************************************************************
  5319*             PROCESSOR/REMINDERS RECORD                       *
  5320****************************************************************
  5321
  5322     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5323         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5324             20  CF-START-REMIND-DT         PIC XX.
  5325             20  CF-END-REMIND-DT           PIC XX.
  5326             20  CF-REMINDER-TEXT           PIC X(50).
  5327         16  FILLER                         PIC X(296).
  5328
  5329
  5330****************************************************************
  5331*             STATE MASTER RECORD                              *
  5332****************************************************************
  5333
  5334     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5335         16  CF-STATE-ABBREVIATION          PIC XX.
  5336         16  CF-STATE-NAME                  PIC X(25).
  5337         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5338         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5339             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5340             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5341             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5342             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5343                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5344                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5345             20  CF-ST-PREM-REJECT-SW       PIC X.
  5346                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5347                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5348             20  CF-ST-REF-REJECT-SW        PIC X.
  5349                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5350                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5351         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5352         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5353         16  CF-ST-REFUND-RULES.
  5354             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5355             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5356             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5357         16  CF-ST-FST-PMT-EXTENSION.
  5358             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5359             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5360                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5361                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5362                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5363                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5364         16  CF-ST-STATE-CALL.
  5365             20  CF-ST-CALL-UNEARNED        PIC X.
  5366             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5367             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5368         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 103
* EL689.cbl
  5369             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5370             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5371         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5372         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5373         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5374         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5375         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5376         16  FILLER                         PIC X.
  5377         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5378             20  CF-ST-BENEFIT-CD           PIC XX.
  5379             20  CF-ST-BENEFIT-KIND         PIC X.
  5380                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5381                 88  CF-ST-AH-KIND              VALUE 'A'.
  5382             20  CF-ST-REM-TERM-CALC        PIC X.
  5383                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5384                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5385                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5386                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5387                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5388                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5389                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5390                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5391
  5392             20  CF-ST-REFUND-CALC          PIC X.
  5393                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5394                 88  ST-REFD-BY-R78             VALUE '1'.
  5395                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5396                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5397                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5398                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5399                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5400                 88  ST-REFD-UTAH               VALUE '7'.
  5401                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5402                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5403                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5404
  5405             20  CF-ST-EARNING-CALC         PIC X.
  5406                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5407                 88  ST-EARN-BY-R78             VALUE '1'.
  5408                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5409                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5410                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5411                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5412                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5413                 88  ST-EARN-MEAN               VALUE '8'.
  5414                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5415
  5416             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5417                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5418                 88  ST-OVRD-BY-R78             VALUE '1'.
  5419                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5420                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5421                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5422                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5423                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5424                 88  ST-OVRD-MEAN               VALUE '8'.
  5425                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5426             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 104
* EL689.cbl
  5427
  5428         16  CF-ST-COMMISSION-CAPS.
  5429             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5430             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5431             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5432             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5433         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5434                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5435
  5436         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5437
  5438         16  CF-ST-STATUTORY-INTEREST.
  5439             20  CF-ST-STAT-DATE-FROM       PIC X.
  5440                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5441                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5442             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5443             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5444             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5445             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5446             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5447
  5448         16  CF-ST-OVER-SHORT.
  5449             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5450             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5451
  5452         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5453
  5454         16  CF-ST-RT-CALC                  PIC X.
  5455
  5456         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5457         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5458         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5459         16  CF-ST-RF-LR-CALC               PIC X.
  5460         16  CF-ST-RF-LL-CALC               PIC X.
  5461         16  CF-ST-RF-LN-CALC               PIC X.
  5462         16  CF-ST-RF-AH-CALC               PIC X.
  5463         16  CF-ST-RF-CP-CALC               PIC X.
  5464*        16  FILLER                         PIC X(206).
  5465*CIDMOD         16  FILLER                         PIC X(192).
  5466         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5467             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5468         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5469         16  FILLER                         PIC X(187).
  5470
  5471****************************************************************
  5472*             BENEFIT MASTER RECORD                            *
  5473****************************************************************
  5474
  5475     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5476         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5477             20  CF-BENEFIT-CODE            PIC XX.
  5478             20  CF-BENEFIT-NUMERIC  REDEFINES
  5479                 CF-BENEFIT-CODE            PIC XX.
  5480             20  CF-BENEFIT-ALPHA           PIC XXX.
  5481             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5482             20  CF-BENEFIT-COMMENT         PIC X(10).
  5483
  5484             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 105
* EL689.cbl
  5485                 88  CF-REDUCING                VALUE 'R'.
  5486                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5487
  5488             20  CF-SPECIAL-CALC-CD         PIC X.
  5489                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5490                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5491                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5492                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5493                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5494                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5495                 88  CF-FARM-PLAN               VALUE 'F'.
  5496                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5497                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5498                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5499                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5500                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5501                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5502                 88  CF-PRUDENTIAL              VALUE 'P'.
  5503                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5504                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5505                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5506                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5507                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5508                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5509
  5510             20  CF-JOINT-INDICATOR         PIC X.
  5511                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5512
  5513*            20  FILLER                     PIC X(12).
  5514             20  FILLER                     PIC X(11).
  5515             20  CF-BENEFIT-CATEGORY        PIC X.
  5516             20  CF-LOAN-TYPE               PIC X(8).
  5517
  5518             20  CF-CO-REM-TERM-CALC        PIC X.
  5519                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5520                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5521                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5522                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5523                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5524
  5525             20  CF-CO-EARNINGS-CALC        PIC X.
  5526                 88  CO-EARN-BY-R78             VALUE '1'.
  5527                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5528                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5529                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5530                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5531                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5532                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5533                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5534
  5535             20  CF-CO-REFUND-CALC          PIC X.
  5536                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5537                 88  CO-REFD-BY-R78             VALUE '1'.
  5538                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5539                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5540                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5541                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5542                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 106
* EL689.cbl
  5543                 88  CO-REFD-MEAN               VALUE '8'.
  5544                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5545                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5546                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5547
  5548             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5549                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5550                 88  CO-OVRD-BY-R78             VALUE '1'.
  5551                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5552                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5553                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5554                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5555                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5556                 88  CO-OVRD-MEAN               VALUE '8'.
  5557                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5558
  5559             20  CF-CO-BEN-I-G-CD           PIC X.
  5560                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5561                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5562                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5563
  5564         16  FILLER                         PIC X(304).
  5565
  5566
  5567****************************************************************
  5568*             CARRIER MASTER RECORD                            *
  5569****************************************************************
  5570
  5571     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5572         16  CF-ADDRESS-DATA.
  5573             20  CF-MAIL-TO-NAME            PIC X(30).
  5574             20  CF-IN-CARE-OF              PIC X(30).
  5575             20  CF-ADDRESS-LINE-1          PIC X(30).
  5576             20  CF-ADDRESS-LINE-2          PIC X(30).
  5577             20  CF-CITY-STATE              PIC X(30).
  5578             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5579             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5580
  5581         16  CF-CLAIM-NO-CONTROL.
  5582             20  CF-CLAIM-NO-METHOD         PIC X.
  5583                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5584                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5585                 88  CLAIM-NO-SEQ               VALUE '3'.
  5586                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5587             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5588                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5589                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5590                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5591
  5592         16  CF-CHECK-NO-CONTROL.
  5593             20  CF-CHECK-NO-METHOD         PIC X.
  5594                 88  CHECK-NO-MANUAL            VALUE '1'.
  5595                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5596                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5597                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5598             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5599                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5600
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 107
* EL689.cbl
  5601         16  CF-DOMICILE-STATE              PIC XX.
  5602
  5603         16  CF-EXPENSE-CONTROLS.
  5604             20  CF-EXPENSE-METHOD          PIC X.
  5605                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5606                 88  DOLLARS-PER-PMT            VALUE '2'.
  5607                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5608                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5609             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5610             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5611
  5612         16  CF-CORRESPONDENCE-CONTROL.
  5613             20  CF-LETTER-RESEND-OPT       PIC X.
  5614                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5615                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5616             20  FILLER                     PIC X(4).
  5617
  5618         16  CF-RESERVE-CONTROLS.
  5619             20  CF-MANUAL-SW               PIC X.
  5620                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5621             20  CF-FUTURE-SW               PIC X.
  5622                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5623             20  CF-PTC-SW                  PIC X.
  5624                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5625             20  CF-IBNR-SW                 PIC X.
  5626                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5627             20  CF-PTC-LF-SW               PIC X.
  5628                 88  CF-LF-PTC-USED             VALUE '1'.
  5629             20  CF-CDT-ACCESS-METHOD       PIC X.
  5630                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5631                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5632                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5633             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5634
  5635         16  CF-CLAIM-CALC-METHOD           PIC X.
  5636             88  360-PLUS-MONTHS                VALUE '1'.
  5637             88  365-PLUS-MONTHS                VALUE '2'.
  5638             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5639             88  360-DAILY                      VALUE '4'.
  5640             88  365-DAILY                      VALUE '5'.
  5641
  5642         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5643         16  FILLER                         PIC X(11).
  5644
  5645         16  CF-LIMIT-AMOUNTS.
  5646             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5647             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5648             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5649             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5650             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5651             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5652             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5653             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5654             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5655             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5656
  5657         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5658         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 108
* EL689.cbl
  5659         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5660
  5661         16  CF-ZIP-CODE.
  5662             20  CF-ZIP-PRIME.
  5663                 24  CF-ZIP-1ST             PIC X.
  5664                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5665                 24  FILLER                 PIC X(4).
  5666             20  CF-ZIP-PLUS4               PIC X(4).
  5667         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5668             20  CF-CAN-POSTAL-1            PIC XXX.
  5669             20  CF-CAN-POSTAL-2            PIC XXX.
  5670             20  FILLER                     PIC XXX.
  5671
  5672         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5673         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5674         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5675
  5676         16  CF-RATING-SWITCH               PIC X.
  5677             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5678             88  CF-NO-RATING                   VALUE 'N'.
  5679
  5680         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5681
  5682         16  CF-CARRIER-OVER-SHORT.
  5683             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5684             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5685
  5686         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5687         16  CF-SECPAY-SWITCH               PIC X.
  5688             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5689             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5690         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5691         16  FILLER                         PIC X(448).
  5692*        16  FILLER                         PIC X(452).
  5693
  5694
  5695****************************************************************
  5696*             MORTALITY MASTER RECORD                          *
  5697****************************************************************
  5698
  5699     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5700         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5701                                INDEXED BY CF-MORT-NDX.
  5702             20  CF-MORT-TABLE              PIC X(5).
  5703             20  CF-MORT-TABLE-TYPE         PIC X.
  5704                 88  CF-MORT-JOINT              VALUE 'J'.
  5705                 88  CF-MORT-SINGLE             VALUE 'S'.
  5706                 88  CF-MORT-COMBINED           VALUE 'C'.
  5707                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5708                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5709             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5710             20  CF-MORT-AGE-METHOD         PIC XX.
  5711                 88  CF-AGE-LAST                VALUE 'AL'.
  5712                 88  CF-AGE-NEAR                VALUE 'AN'.
  5713             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5714             20  CF-MORT-ADJUSTMENT-DIRECTION
  5715                                            PIC X.
  5716                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 109
* EL689.cbl
  5717                 88  CF-PLUS                    VALUE '+'.
  5718             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5719             20  CF-MORT-JOINT-CODE         PIC X.
  5720                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5721             20  CF-MORT-PC-Q               PIC X.
  5722                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5723             20  CF-MORT-TABLE-CODE         PIC X(4).
  5724             20  CF-MORT-COMMENTS           PIC X(15).
  5725             20  FILLER                     PIC X(14).
  5726
  5727         16  FILLER                         PIC X(251).
  5728
  5729
  5730****************************************************************
  5731*             BUSSINESS TYPE MASTER RECORD                     *
  5732****************************************************************
  5733
  5734     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5735* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5736* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5737* AND RECORD 05 IS TYPES 81-99
  5738         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5739             20  CF-BUSINESS-TITLE          PIC  X(19).
  5740             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5741                                            PIC S9V9(4) COMP-3.
  5742             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5743             20  FILLER                     PIC  X.
  5744         16  FILLER                         PIC  X(248).
  5745
  5746
  5747****************************************************************
  5748*             TERMINAL MASTER RECORD                           *
  5749****************************************************************
  5750
  5751     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5752
  5753         16  CF-COMPANY-TERMINALS.
  5754             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5755                                  PIC X(4).
  5756         16  FILLER               PIC X(248).
  5757
  5758
  5759****************************************************************
  5760*             LIFE EDIT MASTER RECORD                          *
  5761****************************************************************
  5762
  5763     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5764         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5765             20  CF-LIFE-CODE-IN            PIC XX.
  5766             20  CF-LIFE-CODE-OUT           PIC XX.
  5767         16  FILLER                         PIC X(248).
  5768
  5769
  5770****************************************************************
  5771*             AH EDIT MASTER RECORD                            *
  5772****************************************************************
  5773
  5774     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 110
* EL689.cbl
  5775         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5776             20  CF-AH-CODE-IN              PIC XXX.
  5777             20  CF-AH-CODE-OUT             PIC XX.
  5778         16  FILLER                         PIC X(248).
  5779
  5780
  5781****************************************************************
  5782*             CREDIBILITY TABLES                               *
  5783****************************************************************
  5784
  5785     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5786         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5787                             INDEXED BY CF-CRDB-NDX.
  5788             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5789             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5790             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5791         16  FILLER                         PIC  X(332).
  5792
  5793
  5794****************************************************************
  5795*             REPORT CUSTOMIZATION RECORD                      *
  5796****************************************************************
  5797
  5798     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5799         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5800             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5801             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5802             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5803**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5804****       A T-TRANSFER.                                   ****
  5805             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5806
  5807         16  FILLER                         PIC XX.
  5808
  5809         16  CF-CARRIER-CNTL-OPT.
  5810             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5811                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5812                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5813             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5814                                            PIC X.
  5815         16  CF-GROUP-CNTL-OPT.
  5816             20  CF-GROUP-OPT-SEQ           PIC 9.
  5817                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5818                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5819             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5820                                            PIC X(6).
  5821         16  CF-STATE-CNTL-OPT.
  5822             20  CF-STATE-OPT-SEQ           PIC 9.
  5823                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5824                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5825             20  CF-STATE-SELECT OCCURS 3 TIMES
  5826                                            PIC XX.
  5827         16  CF-ACCOUNT-CNTL-OPT.
  5828             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5829                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5830                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5831             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5832                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 111
* EL689.cbl
  5833         16  CF-BUS-TYP-CNTL-OPT.
  5834             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5835                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5836                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5837             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5838                                            PIC XX.
  5839         16  CF-LF-TYP-CNTL-OPT.
  5840             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5841                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5842                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5843             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5844                                            PIC XX.
  5845         16  CF-AH-TYP-CNTL-OPT.
  5846             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5847                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5848                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5849             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5850                                            PIC XX.
  5851         16  CF-REPTCD1-CNTL-OPT.
  5852             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5853                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5854                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5855             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5856                                            PIC X(10).
  5857         16  CF-REPTCD2-CNTL-OPT.
  5858             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5859                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5860                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5861             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5862                                            PIC X(10).
  5863         16  CF-USER1-CNTL-OPT.
  5864             20  CF-USER1-OPT-SEQ           PIC 9.
  5865                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5866                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5867             20  CF-USER1-SELECT OCCURS 3 TIMES
  5868                                            PIC X(10).
  5869         16  CF-USER2-CNTL-OPT.
  5870             20  CF-USER2-OPT-SEQ           PIC 9.
  5871                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5872                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5873             20  CF-USER2-SELECT OCCURS 3 TIMES
  5874                                            PIC X(10).
  5875         16  CF-USER3-CNTL-OPT.
  5876             20  CF-USER3-OPT-SEQ           PIC 9.
  5877                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5878                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5879             20  CF-USER3-SELECT OCCURS 3 TIMES
  5880                                            PIC X(10).
  5881         16  CF-USER4-CNTL-OPT.
  5882             20  CF-USER4-OPT-SEQ           PIC 9.
  5883                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5884                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5885             20  CF-USER4-SELECT OCCURS 3 TIMES
  5886                                            PIC X(10).
  5887         16  CF-USER5-CNTL-OPT.
  5888             20  CF-USER5-OPT-SEQ           PIC 9.
  5889                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5890                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 112
* EL689.cbl
  5891             20  CF-USER5-SELECT OCCURS 3 TIMES
  5892                                            PIC X(10).
  5893         16  CF-REINS-CNTL-OPT.
  5894             20  CF-REINS-OPT-SEQ           PIC 9.
  5895                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5896                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5897             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5898                 24  CF-REINS-PRIME         PIC XXX.
  5899                 24  CF-REINS-SUB           PIC XXX.
  5900
  5901         16  CF-AGENT-CNTL-OPT.
  5902             20  CF-AGENT-OPT-SEQ           PIC 9.
  5903                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5904                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5905             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5906                                            PIC X(10).
  5907
  5908         16  FILLER                         PIC X(43).
  5909
  5910         16  CF-LOSS-RATIO-SELECT.
  5911             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5912             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5913         16  CF-ENTRY-DATE-SELECT.
  5914             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5915             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5916         16  CF-EFFECTIVE-DATE-SELECT.
  5917             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5918             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5919
  5920         16  CF-EXCEPTION-LIST-IND          PIC X.
  5921             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5922
  5923         16  FILLER                         PIC X(318).
  5924
  5925****************************************************************
  5926*                  EXCEPTION REPORTING RECORD                  *
  5927****************************************************************
  5928
  5929     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5930         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5931             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5932
  5933         16  CF-COMBINED-LIFE-AH-OPT.
  5934             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5935             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5936             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5937             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5938
  5939         16  CF-LIFE-OPT.
  5940             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5941             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5942             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5943             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5944             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5945             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5946             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5947             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5948             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 113
* EL689.cbl
  5949             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5950
  5951         16  CF-AH-OPT.
  5952             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5953             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5954             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5955             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5956             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5957             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5958             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5959             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5960             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5961             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5962
  5963         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5964             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5965             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5966             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5967
  5968         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5969
  5970         16  FILLER                         PIC X(673).
  5971
  5972
  5973****************************************************************
  5974*             MORTGAGE SYSTEM PLAN RECORD                      *
  5975****************************************************************
  5976
  5977     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5978         16  CF-PLAN-TYPE                   PIC X.
  5979             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5980             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5981             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5982         16  CF-PLAN-ABBREV                 PIC XXX.
  5983         16  CF-PLAN-DESCRIPT               PIC X(10).
  5984         16  CF-PLAN-NOTES                  PIC X(20).
  5985         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5986         16  CF-PLAN-UNDERWRITING.
  5987             20  CF-PLAN-TERM-DATA.
  5988                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5989                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5990             20  CF-PLAN-AGE-DATA.
  5991                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5992                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5993                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5994             20  CF-PLAN-BENEFIT-DATA.
  5995                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5996                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5997                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5998                                            PIC S9(7)V99  COMP-3.
  5999         16  CF-PLAN-POLICY-FORMS.
  6000             20  CF-POLICY-FORM             PIC X(12).
  6001             20  CF-MASTER-APPLICATION      PIC X(12).
  6002             20  CF-MASTER-POLICY           PIC X(12).
  6003         16  CF-PLAN-RATING.
  6004             20  CF-RATE-CODE               PIC X(5).
  6005             20  CF-SEX-RATING              PIC X.
  6006                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 114
* EL689.cbl
  6007                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6008             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6009             20  CF-SUB-STD-TYPE            PIC X.
  6010                 88  CF-PCT-OF-PREM            VALUE '1'.
  6011                 88  CF-PCT-OF-BENE            VALUE '2'.
  6012         16  CF-PLAN-PREM-TOLERANCES.
  6013             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6014             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6015         16  CF-PLAN-PYMT-TOLERANCES.
  6016             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6017             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6018         16  CF-PLAN-MISC-DATA.
  6019             20  FILLER                     PIC X.
  6020             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6021             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6022         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6023         16  CF-PLAN-IND-GRP                PIC X.
  6024             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6025                                                     '1'.
  6026             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6027                                                     '2'.
  6028         16  CF-MIB-SEARCH-SW               PIC X.
  6029             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6030             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6031             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6032             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6033         16  CF-ALPHA-SEARCH-SW             PIC X.
  6034             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6035             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6036             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6037             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6038             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6039             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6040             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6041             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6042             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6043             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6044                                                     'A' 'B' 'C'
  6045                                                     'X' 'Y' 'Z'.
  6046         16  CF-EFF-DT-RULE-SW              PIC X.
  6047             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6048             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6049             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6050             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6051             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6052         16  FILLER                         PIC X(4).
  6053         16  CF-HEALTH-QUESTIONS            PIC X.
  6054             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6055         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6056         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6057         16  CF-PLAN-SNGL-JNT               PIC X.
  6058             88  CF-COMBINED-PLAN              VALUE 'C'.
  6059             88  CF-JNT-PLAN                   VALUE 'J'.
  6060             88  CF-SNGL-PLAN                  VALUE 'S'.
  6061         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6062         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6063         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6064         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 115
* EL689.cbl
  6065         16  CF-RERATE-CNTL                 PIC  X.
  6066             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6067             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6068             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6069             88  CF-AUTO-RECALC                 VALUE '4'.
  6070         16  CF-BENEFIT-TYPE                PIC  X.
  6071             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6072             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6073         16  CF-POLICY-FEE                  PIC S999V99
  6074                                                    COMP-3.
  6075         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6076         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6077         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6078         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6079         16  FILLER                         PIC  X(32).
  6080         16  CF-TERMINATION-FORM            PIC  X(04).
  6081         16  FILLER                         PIC  X(08).
  6082         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6083                                                       COMP-3.
  6084         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6085         16  CF-ISSUE-LETTER                PIC  X(4).
  6086         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6087         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6088             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6089             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6090         16  CF-MP-REFUND-CALC              PIC X.
  6091             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6092             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6093             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6094             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6095             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6096             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6097             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6098             88  CF-MP-REFD-MEAN                VALUE '8'.
  6099         16  CF-ALT-RATE-CODE               PIC  X(5).
  6100
  6101
  6102         16  FILLER                         PIC X(498).
  6103****************************************************************
  6104*             MORTGAGE COMPANY MASTER RECORD                   *
  6105****************************************************************
  6106
  6107     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6108         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6109         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6110             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6111             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6112             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6113             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6114             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6115
  6116         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6117         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6118         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6119         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6120         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6121
  6122         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 116
* EL689.cbl
  6123             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6124         16  CF-MP-RECON-USE-IND            PIC X(1).
  6125             88  CF-MP-USE-RECON             VALUE 'Y'.
  6126         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6127             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6128         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6129             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6130             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6131         16  FILLER                         PIC X(1).
  6132         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6133             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6134         16  CF-MORTG-MIB-VERSION           PIC X.
  6135             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6136             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6137             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6138         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6139             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6140                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6141             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6142                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6143             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6144                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6145             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6146                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6147             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6148                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6149             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6150                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6151         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6152         16  FILLER                         PIC X(7).
  6153         16  CF-MORTG-DESTINATION-SYMBOL.
  6154             20  CF-MORTG-MIB-COMM          PIC X(5).
  6155             20  CF-MORTG-MIB-TERM          PIC X(5).
  6156         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6157             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6158         16  FILLER                         PIC X(03).
  6159         16  CF-MP-CHECK-NO-CONTROL.
  6160             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6161                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6162                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6163                                                ' ' LOW-VALUES.
  6164                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6165                                               VALUE '3'.
  6166         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6167         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6168         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6169             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6170                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6171             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6172                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6173             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6174                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6175             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6176                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6177             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6178                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6179             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6180                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 117
* EL689.cbl
  6181         16  CF-MORTG-BILLING-AREA.
  6182             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6183                                            PIC X.
  6184         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6185         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6186         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6187         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6188             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6189             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6190         16  FILLER                         PIC X.
  6191         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6192             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6193             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6194         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6195         16  FILLER                         PIC X(8).
  6196         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6197         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6198         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6199         16  CF-ACH-COMPANY-ID.
  6200             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6201                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6202                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6203                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6204             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6205         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6206             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6207         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6208             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6209             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6210         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6211         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6212         16  FILLER                         PIC X(536).
  6213
  6214****************************************************************
  6215*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6216****************************************************************
  6217
  6218     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6219         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6220             20  CF-FEMALE-HEIGHT.
  6221                 24  CF-FEMALE-FT           PIC 99.
  6222                 24  CF-FEMALE-IN           PIC 99.
  6223             20  CF-FEMALE-MIN-WT           PIC 999.
  6224             20  CF-FEMALE-MAX-WT           PIC 999.
  6225         16  FILLER                         PIC X(428).
  6226
  6227     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6228         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6229             20  CF-MALE-HEIGHT.
  6230                 24  CF-MALE-FT             PIC 99.
  6231                 24  CF-MALE-IN             PIC 99.
  6232             20  CF-MALE-MIN-WT             PIC 999.
  6233             20  CF-MALE-MAX-WT             PIC 999.
  6234         16  FILLER                         PIC X(428).
  6235******************************************************************
  6236*             AUTOMATIC ACTIVITY RECORD                          *
  6237******************************************************************
  6238     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 118
* EL689.cbl
  6239         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6240             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6241             20  CF-SYS-LETTER-ID           PIC X(04).
  6242             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6243             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6244             20  CF-SYS-RESET-SW            PIC X(01).
  6245             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6246             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6247
  6248         16  FILLER                         PIC X(50).
  6249
  6250         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6251             20  CF-USER-ACTIVE-SW          PIC X(01).
  6252             20  CF-USER-LETTER-ID          PIC X(04).
  6253             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6254             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6255             20  CF-USER-RESET-SW           PIC X(01).
  6256             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6257             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6258             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6259
  6260         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 119
* EL689.cbl
  6262*    COPY ERCCOMP.
  6263******************************************************************
  6264*                                                                *
  6265*                                                                *
  6266*                            ERCCOMP                             *
  6267*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6268*                            VMOD=2.019                          *
  6269*                                                                *
  6270*   ONLINE CREDIT SYSTEM                                         *
  6271*                                                                *
  6272*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6273*                                                                *
  6274*   FILE TYPE = VSAM,KSDS                                        *
  6275*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6276*                                                                *
  6277*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6278*       ALTERNATE PATH = NONE                                    *
  6279*                                                                *
  6280*   LOG = NO                                                     *
  6281*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6282*                                                                *
  6283******************************************************************
  6284*                   C H A N G E   L O G
  6285*
  6286* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6287*-----------------------------------------------------------------
  6288*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6289* EFFECTIVE    NUMBER
  6290*-----------------------------------------------------------------
  6291* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6292* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6293* 092205    2005050300006  PEMA  ADD LEASE FEE
  6294* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6295* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6296* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6297* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6298* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6299******************************************************************
  6300
  6301 01  COMPENSATION-MASTER.
  6302     12  CO-RECORD-ID                          PIC XX.
  6303         88  VALID-CO-ID                          VALUE 'CO'.
  6304
  6305     12  CO-CONTROL-PRIMARY.
  6306         16  CO-COMPANY-CD                     PIC X.
  6307         16  CO-CONTROL.
  6308             20  CO-CTL-1.
  6309                 24  CO-CARR-GROUP.
  6310                     28  CO-CARRIER            PIC X.
  6311                     28  CO-GROUPING.
  6312                         32  CO-GROUP-PREFIX   PIC XXX.
  6313                         32  CO-GROUP-PRIME    PIC XXX.
  6314                 24  CO-RESP-NO.
  6315                     28  CO-RESP-PREFIX        PIC X(4).
  6316                     28  CO-RESP-PRIME         PIC X(6).
  6317             20  CO-CTL-2.
  6318                 24  CO-ACCOUNT.
  6319                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 120
* EL689.cbl
  6320                     28  CO-ACCT-PRIME         PIC X(6).
  6321         16  CO-TYPE                           PIC X.
  6322             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6323             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6324             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6325
  6326     12  CO-MAINT-INFORMATION.
  6327         16  CO-LAST-MAINT-DT                  PIC XX.
  6328         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6329         16  CO-LAST-MAINT-USER                PIC X(4).
  6330     12  FILLER                                PIC XX.
  6331     12  CO-STMT-TYPE                          PIC XXX.
  6332     12  CO-COMP-TYPE                          PIC X.
  6333         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6334     12  CO-STMT-OWNER                         PIC X(4).
  6335     12  CO-BALANCE-CONTROL                    PIC X.
  6336         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6337         88  CO-NO-BALANCE                        VALUE 'N'.
  6338
  6339     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6340         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6341         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6342         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6343
  6344     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6345         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6346         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6347
  6348     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6349     12  CO-GA-DIRECT-DEP                      PIC X.
  6350     12  CO-FUTURE-SPACE                       PIC X.
  6351         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6352
  6353     12  CO-ACCT-NAME                          PIC X(30).
  6354     12  CO-MAIL-NAME                          PIC X(30).
  6355     12  CO-ADDR-1                             PIC X(30).
  6356     12  CO-ADDR-2                             PIC X(30).
  6357     12  CO-ADDR-3.
  6358         16  CO-ADDR-CITY                      PIC X(27).
  6359         16  CO-ADDR-STATE                     PIC XX.
  6360     12  CO-CSO-1099                           PIC X.
  6361     12  CO-ZIP.
  6362         16  CO-ZIP-PRIME.
  6363             20  CO-ZIP-PRI-1ST                PIC X.
  6364                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6365             20  FILLER                        PIC X(4).
  6366         16  CO-ZIP-PLUS4                      PIC X(4).
  6367     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6368         16  CO-CAN-POSTAL-1                   PIC XXX.
  6369         16  CO-CAN-POSTAL-2                   PIC XXX.
  6370         16  FILLER                            PIC XXX.
  6371     12  CO-SOC-SEC                            PIC X(13).
  6372     12  CO-TELEPHONE.
  6373         16  CO-AREA-CODE                      PIC XXX.
  6374         16  CO-PREFIX                         PIC XXX.
  6375         16  CO-PHONE                          PIC X(4).
  6376
  6377     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 121
* EL689.cbl
  6378
  6379     12  CO-AR-BAL-LEVEL                       PIC X.
  6380         88  CO-AR-REF-LVL                        VALUE '1'.
  6381         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6382         88  CO-AR-BILL-LVL                       VALUE '2'.
  6383         88  CO-AR-AGT-LVL                        VALUE '3'.
  6384         88  CO-AR-FR-LVL                         VALUE '4'.
  6385
  6386     12  CO-AR-NORMAL-PRINT                    PIC X.
  6387         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6388         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6389
  6390     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6391
  6392     12  CO-AR-REPORTING                       PIC X.
  6393         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6394         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6395
  6396     12  CO-AR-PULL-CHECK                      PIC X.
  6397         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6398         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6399
  6400     12  CO-AR-BALANCE-PRINT                   PIC X.
  6401         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6402
  6403     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6404         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6405         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6406         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6407
  6408     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6409
  6410     12  CO-USER-CODE                          PIC X.
  6411     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6412
  6413******************************************************************
  6414*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6415*    THE LAST MONTH END RUN.
  6416******************************************************************
  6417
  6418     12  CO-LAST-ACTIVITY-DATE.
  6419         16  CO-ACT-YEAR                       PIC 99.
  6420         16  CO-ACT-MONTH                      PIC 99.
  6421         16  CO-ACT-DAY                        PIC 99.
  6422
  6423     12  CO-LAST-STMT-DT.
  6424         16  CO-LAST-STMT-YEAR                 PIC 99.
  6425         16  CO-LAST-STMT-MONTH                PIC 99.
  6426         16  CO-LAST-STMT-DAY                  PIC 99.
  6427
  6428     12  CO-MO-END-TOTALS.
  6429         16  CO-MONTHLY-TOTALS.
  6430             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6431             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6432             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6433             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6434             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  6435
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 122
* EL689.cbl
  6436         16  CO-AGING-TOTALS.
  6437             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6438             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6439             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6440             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6441
  6442         16  CO-YTD-TOTALS.
  6443             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6444             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6445
  6446         16  CO-OVER-UNDER-TOTALS.
  6447             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6448             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6449
  6450     12  CO-MISCELLANEOUS-TOTALS.
  6451         16  CO-FICA-TOTALS.
  6452             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6453             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6454
  6455         16  CO-CLAIM-TOTALS.
  6456             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6457             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6458
  6459******************************************************************
  6460*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6461*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6462******************************************************************
  6463
  6464     12  CO-CURRENT-TOTALS.
  6465         16  CO-CURRENT-LAST-STMT-DT.
  6466             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6467             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6468             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6469
  6470         16  CO-CURRENT-MONTHLY-TOTALS.
  6471             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6472             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6473             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6474             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6475             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6476
  6477         16  CO-CURRENT-AGING-TOTALS.
  6478             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6479             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6480             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6481             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6482
  6483         16  CO-CURRENT-YTD-TOTALS.
  6484             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6485             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6486
  6487     12  CO-PAID-COMM-TOTALS.
  6488         16  CO-YTD-PAID-COMMS.
  6489             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6490             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6491
  6492     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  6493         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 123
* EL689.cbl
  6494         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6495
  6496     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6497         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6498         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6499         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6500         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6501         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6502         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6503         88  CO-FINAL-LETTER                  VALUE 'F'.
  6504         88  CO-RECONCILING                   VALUE 'R'.
  6505         88  CO-PHONE-CALL                    VALUE 'P'.
  6506         88  CO-LEGAL                         VALUE 'L'.
  6507         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6508         88  CO-WRITE-OFF                     VALUE 'W'.
  6509         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6510
  6511     12  CO-CSR-CODE                       PIC X(4).
  6512
  6513     12  CO-GA-STATUS-INFO.
  6514         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6515         16  CO-GA-TERMINATION-DT          PIC XX.
  6516         16  CO-GA-STATUS-CODE             PIC X.
  6517             88  CO-GA-ACTIVE                 VALUE 'A'.
  6518             88  CO-GA-INACTIVE               VALUE 'I'.
  6519             88  CO-GA-PENDING                VALUE 'P'.
  6520         16  CO-GA-COMMENTS.
  6521             20  CO-GA-COMMENT-1           PIC X(40).
  6522             20  CO-GA-COMMENT-2           PIC X(40).
  6523             20  CO-GA-COMMENT-3           PIC X(40).
  6524             20  CO-GA-COMMENT-4           PIC X(40).
  6525
  6526     12  CO-RPTCD2                         PIC X(10).
  6527
  6528     12  CO-TYPE-AGENT                     PIC X(01).
  6529         88  CO-CORPORATION                   VALUE 'C'.
  6530         88  CO-PARTNERSHIP                   VALUE 'P'.
  6531         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6532         88  CO-TRUST                         VALUE 'T'.
  6533         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6534
  6535     12  CO-FAXNO.
  6536         16  CO-FAX-AREA-CODE                  PIC XXX.
  6537         16  CO-FAX-PREFIX                     PIC XXX.
  6538         16  CO-FAX-PHONE                      PIC X(4).
  6539
  6540     12  CO-BANK-INFORMATION.
  6541         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6542         16  CO-BANK-TRANSIT-NON REDEFINES
  6543             CO-BANK-TRANSIT-NO                PIC 9(8).
  6544
  6545         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6546     12  CO-MISC-DEDUCT-INFO REDEFINES
  6547                  CO-BANK-INFORMATION.
  6548         16  CO-MD-GL-ACCT                     PIC X(10).
  6549         16  CO-MD-DIV                         PIC XX.
  6550         16  CO-MD-CENTER                      PIC X(4).
  6551         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 124
* EL689.cbl
  6552         16  CO-CREATE-AP-CHECK                PIC X.
  6553         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6554         16  FILLER                            PIC XXX.
  6555     12  CO-ACH-STATUS                         PIC X.
  6556         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6557         88  CO-ACH-PENDING                        VALUE 'P'.
  6558
  6559     12  CO-BILL-SW                            PIC X.
  6560     12  CO-CONTROL-NAME                       PIC X(30).
  6561     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6562     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6563     12  CO-CLP-STATE                          PIC XX.
  6564     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6565     12  CO-SPP-REFUND-EDIT                    PIC X.
  6566
  6567******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 125
* EL689.cbl
  6569*    COPY ERCMAIL.
  6570******************************************************************
  6571*                                                                *
  6572*                                                                *
  6573*                            ERCMAIL                             *
  6574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6575*                            VMOD=2.003                          *
  6576*                                                                *
  6577*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6578*                                                                *
  6579*   FILE TYPE = VSAM,KSDS                                        *
  6580*   RECORD SIZE = 374   RECFORM = FIX                            *
  6581*                                                                *
  6582*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6583*   ALTERNATE PATH    = NOT USED                                 *
  6584*                                                                *
  6585*   LOG = YES                                                    *
  6586*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6587******************************************************************
  6588*                   C H A N G E   L O G
  6589*
  6590* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6591*-----------------------------------------------------------------
  6592*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6593* EFFECTIVE    NUMBER
  6594*-----------------------------------------------------------------
  6595* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6596* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6597* 111108                   PEMA  ADD CRED BENE ADDR2
  6598******************************************************************
  6599
  6600 01  MAILING-DATA.
  6601     12  MA-RECORD-ID                      PIC XX.
  6602         88  VALID-MA-ID                       VALUE 'MA'.
  6603
  6604     12  MA-CONTROL-PRIMARY.
  6605         16  MA-COMPANY-CD                 PIC X.
  6606         16  MA-CARRIER                    PIC X.
  6607         16  MA-GROUPING.
  6608             20  MA-GROUPING-PREFIX        PIC XXX.
  6609             20  MA-GROUPING-PRIME         PIC XXX.
  6610         16  MA-STATE                      PIC XX.
  6611         16  MA-ACCOUNT.
  6612             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6613             20  MA-ACCOUNT-PRIME          PIC X(6).
  6614         16  MA-CERT-EFF-DT                PIC XX.
  6615         16  MA-CERT-NO.
  6616             20  MA-CERT-PRIME             PIC X(10).
  6617             20  MA-CERT-SFX               PIC X.
  6618
  6619     12  FILLER                            PIC XX.
  6620
  6621     12  MA-ACCESS-CONTROL.
  6622         16  MA-SOURCE-SYSTEM              PIC XX.
  6623             88  MA-FROM-CREDIT                VALUE 'CR'.
  6624             88  MA-FROM-VSI                   VALUE 'VS'.
  6625             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6626             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 126
* EL689.cbl
  6627         16  MA-RECORD-ADD-DT              PIC XX.
  6628         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6629         16  MA-LAST-MAINT-DT              PIC XX.
  6630         16  MA-LAST-MAINT-BY              PIC XXXX.
  6631         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6632
  6633     12  MA-PROFILE-INFO.
  6634         16  MA-QUALIFY-CODE-1             PIC XX.
  6635         16  MA-QUALIFY-CODE-2             PIC XX.
  6636         16  MA-QUALIFY-CODE-3             PIC XX.
  6637         16  MA-QUALIFY-CODE-4             PIC XX.
  6638         16  MA-QUALIFY-CODE-5             PIC XX.
  6639
  6640         16  MA-INSURED-LAST-NAME          PIC X(15).
  6641         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6642         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6643         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6644         16  MA-INSURED-BIRTH-DT           PIC XX.
  6645         16  MA-INSURED-SEX                PIC X.
  6646             88  MA-SEX-MALE                   VALUE 'M'.
  6647             88  MA-SEX-FEMALE                 VALUE 'F'.
  6648         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6649
  6650         16  MA-ADDRESS-CORRECTED          PIC X.
  6651         16  MA-JOINT-BIRTH-DT             PIC XX.
  6652*        16  FILLER                        PIC X(12).
  6653
  6654         16  MA-ADDRESS-LINE-1             PIC X(30).
  6655         16  MA-ADDRESS-LINE-2             PIC X(30).
  6656         16  MA-CITY-STATE.
  6657             20  MA-CITY                   PIC X(28).
  6658             20  MA-ADDR-STATE             PIC XX.
  6659         16  MA-ZIP.
  6660             20  MA-ZIP-CODE.
  6661                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6662                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6663                 24  FILLER                PIC X(4).
  6664             20  MA-ZIP-PLUS4              PIC X(4).
  6665         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6666             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6667             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6668             20  FILLER                    PIC X(3).
  6669
  6670         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6671
  6672         16  FILLER                        PIC XXX.
  6673*        16  FILLER                        PIC X(10).
  6674
  6675     12  MA-CRED-BENE-INFO.
  6676         16  MA-CRED-BENE-NAME                 PIC X(25).
  6677         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6678         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6679         16  MA-CRED-BENE-CTYST.
  6680             20  MA-CRED-BENE-CITY             PIC X(28).
  6681             20  MA-CRED-BENE-STATE            PIC XX.
  6682         16  MA-CRED-BENE-ZIP.
  6683             20  MA-CB-ZIP-CODE.
  6684                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 127
* EL689.cbl
  6685                     88  MA-CB-CANADIAN-POST-CODE
  6686                                           VALUE 'A' THRU 'Z'.
  6687                 24  FILLER                    PIC X(4).
  6688             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6689         16  MA-CB-CANADIAN-POSTAL-CODE
  6690                            REDEFINES MA-CRED-BENE-ZIP.
  6691             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6692             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6693             20  FILLER                        PIC X(3).
  6694     12  MA-POST-CARD-MAIL-DATA.
  6695         16  MA-MAIL-DATA OCCURS 7.
  6696             20  MA-MAIL-TYPE              PIC X.
  6697                 88  MA-12MO-MAILING           VALUE '1'.
  6698                 88  MA-EXP-MAILING            VALUE '2'.
  6699             20  MA-MAIL-STATUS            PIC X.
  6700                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6701                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6702                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6703             20  MA-MAIL-DATE              PIC XX.
  6704     12  FILLER                            PIC XX.
  6705     12  FILLER                            PIC XX.
  6706*    12  FILLER                            PIC X(30).
  6707******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 128
* EL689.cbl
  6709*    COPY ERCPNDB.
  6710******************************************************************
  6711*                                                                *
  6712*                                                                *
  6713*                            ERCPNDB.                            *
  6714*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6715*                            VMOD=2.025                          *
  6716*                                                                *
  6717*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  6718*                                                                *
  6719******************************************************************
  6720*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  6721*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  6722******************************************************************
  6723*                                                                *
  6724*                                                                *
  6725*   FILE TYPE = VSAM,KSDS                                        *
  6726*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6727*                                                                *
  6728*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6729*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6730*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6731*                                                 RKP=13,LEN=36  *
  6732*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6733*                                      AND CHG-SEQ.)             *
  6734*                                                RKP=49,LEN=11   *
  6735*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6736*                                      AND CHG-SEQ.)             *
  6737*                                                RKP=60,LEN=15   *
  6738*                                                                *
  6739*   LOG = NO                                                     *
  6740*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6741******************************************************************
  6742******************************************************************
  6743*                   C H A N G E   L O G
  6744*
  6745* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6746*-----------------------------------------------------------------
  6747*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6748* EFFECTIVE    NUMBER
  6749*-----------------------------------------------------------------
  6750* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6751* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6752* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6753* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6754* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6755* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6756* 032306                   PEMA  ADD BOW LOAN NUMBER
  6757* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6758* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6759* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6760* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6761* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6762* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6763* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6764******************************************************************
  6765
  6766 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 129
* EL689.cbl
  6767     12  PB-RECORD-ID                     PIC XX.
  6768         88  VALID-PB-ID                        VALUE 'PB'.
  6769
  6770     12  PB-CONTROL-PRIMARY.
  6771         16  PB-COMPANY-CD                PIC X.
  6772         16  PB-ENTRY-BATCH               PIC X(6).
  6773         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6774         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6775
  6776     12  PB-CONTROL-BY-ACCOUNT.
  6777         16  PB-COMPANY-CD-A1             PIC X.
  6778         16  PB-CARRIER                   PIC X.
  6779         16  PB-GROUPING.
  6780             20  PB-GROUPING-PREFIX       PIC XXX.
  6781             20  PB-GROUPING-PRIME        PIC XXX.
  6782         16  PB-STATE                     PIC XX.
  6783         16  PB-ACCOUNT.
  6784             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6785             20  PB-ACCOUNT-PRIME         PIC X(6).
  6786         16  PB-CERT-EFF-DT               PIC XX.
  6787         16  PB-CERT-NO.
  6788             20  PB-CERT-PRIME            PIC X(10).
  6789             20  PB-CERT-SFX              PIC X.
  6790         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6791
  6792         16  PB-RECORD-TYPE               PIC X.
  6793             88  PB-MAILING-DATA                VALUE '0'.
  6794             88  PB-ISSUE                       VALUE '1'.
  6795             88  PB-CANCELLATION                VALUE '2'.
  6796             88  PB-BATCH-TRAILER               VALUE '9'.
  6797
  6798     12  PB-CONTROL-BY-ORIG-BATCH.
  6799         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6800         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6801         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6802         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6803
  6804     12  PB-CONTROL-BY-CSR.
  6805         16  PB-CSR-COMPANY-CD            PIC X.
  6806         16  PB-CSR-ID                    PIC X(4).
  6807         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6808         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6809         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6810******************************************************************
  6811*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6812******************************************************************
  6813
  6814     12  PB-LAST-MAINT-DT                 PIC XX.
  6815     12  PB-LAST-MAINT-BY                 PIC X(4).
  6816     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6817
  6818     12  PB-RECORD-BODY                   PIC X(375).
  6819
  6820     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6821         16  PB-CERT-ORIGIN               PIC X.
  6822             88  CLASIC-CREATED-CERT         VALUE '1'.
  6823         16  PB-I-NAME.
  6824             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 130
* EL689.cbl
  6825             20  PB-I-INSURED-FIRST-NAME.
  6826                 24  PB-I-INSURED-1ST-INIT PIC X.
  6827                 24  FILLER                PIC X(9).
  6828             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6829         16  PB-I-AGE                     PIC S99   COMP-3.
  6830         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6831         16  PB-I-BIRTHDAY                PIC XX.
  6832         16  PB-I-INSURED-SEX             PIC X.
  6833             88  PB-SEX-MALE     VALUE 'M'.
  6834             88  PB-SEX-FEMALE   VALUE 'F'.
  6835
  6836         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6837         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6838         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6839         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6840         16  PB-I-SKIP-CODE               PIC X.
  6841             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6842             88  PB-SKIP-JULY              VALUE '1'.
  6843             88  PB-SKIP-AUGUST            VALUE '2'.
  6844             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6845             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6846             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6847             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6848             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6849             88  PB-SKIP-JUNE              VALUE '8'.
  6850             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6851             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6852             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6853         16  PB-I-TERM-TYPE               PIC X.
  6854             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6855             88  PB-PAID-WEEKLY            VALUE 'W'.
  6856             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6857             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6858             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6859         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6860         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6861         16  PB-I-DATA-ENTRY-SW           PIC X.
  6862             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6863             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6864             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6865             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6866         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6867         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6868*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6869         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6870         16  FILLER                       PIC X.
  6871
  6872         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6873             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6874             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6875                                                   '90' THRU '99'.
  6876         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6877                                          PIC XX.
  6878         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6879         16  PB-I-AMOUNT-FINANCED REDEFINES
  6880                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6881         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6882         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 131
* EL689.cbl
  6883                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6884         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6885         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6886         16  PB-I-CLP-AMOUNT REDEFINES
  6887                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6888         16  PB-I-LF-CALC-FLAG            PIC X.
  6889             88 PB-COMP-LF-PREM               VALUE '?'.
  6890         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6891         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6892         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6893         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6894         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6895         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6896         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6897         16  PB-I-LF-ABBR                 PIC XXX.
  6898         16  PB-I-LF-INPUT-CD             PIC XX.
  6899
  6900         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6901             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6902             88  PB-INVALID-AH               VALUE '  ' '00'
  6903                                                   '90' THRU '99'.
  6904         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6905         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6906         16  PB-I-AH-CALC-FLAG            PIC X.
  6907             88 PB-COMP-AH-PREM                  VALUE '?'.
  6908         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6909         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6910         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6911         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6912         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6913         16  PB-I-AH-ABBR                 PIC XXX.
  6914         16  PB-I-AH-INPUT-CD             PIC XXX.
  6915
  6916         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6917         16  PB-I-REIN-TABLE              PIC XXX.
  6918         16  PB-I-BUSINESS-TYPE           PIC 99.
  6919         16  PB-I-INDV-GRP-CD             PIC X.
  6920         16  PB-I-MORT-CODE.
  6921             20  PB-I-TABLE               PIC X.
  6922             20  PB-I-INTEREST            PIC XX.
  6923             20  PB-I-MORT-TYP            PIC X.
  6924         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6925         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6926         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6927         16  PB-I-INDV-GRP-OVRD           PIC X.
  6928         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6929         16  PB-I-SIG-SW                  PIC X.
  6930             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6931         16  PB-I-RATE-CLASS              PIC XX.
  6932         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6933         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6934         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6935         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6936         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6937         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6938         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6939         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6940         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 132
* EL689.cbl
  6941             88  PB-I-OB                      VALUE 'B'.
  6942             88  PB-I-SUMMARY                 VALUE 'Z'.
  6943         16  PB-I-ENTRY-STATUS            PIC X.
  6944             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6945                                              'M' '5' '9' '2'.
  6946             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6947             88  PB-I-POLICY-PENDING          VALUE '2'.
  6948             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6949             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6950             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6951             88  PB-I-REIN-ONLY               VALUE '9'.
  6952             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6953             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6954             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6955             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6956         16  PB-I-INT-CODE                PIC X.
  6957             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6958             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6959         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6960         16  PB-I-SOC-SEC-NO              PIC X(11).
  6961         16  PB-I-MEMBER-NO               PIC X(12).
  6962         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6963*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6964         16  PB-I-OLD-LOF                 PIC XXX.
  6965         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6966         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6967         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6968         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6969         16  PB-I-LIFE-INDICATOR          PIC X.
  6970             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6971         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6972         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6973             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6974             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6975         16  PB-I-1ST-PMT-DT              PIC XX.
  6976         16  PB-I-JOINT-INSURED.
  6977             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6978             20 PB-I-JOINT-FIRST-NAME.
  6979                24  PB-I-JOINT-FIRST-INIT PIC X.
  6980                24  FILLER                PIC X(9).
  6981             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6982*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6983         16  PB-I-BENEFICIARY-NAME.
  6984             20  PB-I-BANK-NUMBER         PIC X(10).
  6985             20  FILLER                   PIC X(15).
  6986         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6987         16  PB-I-REFERENCE               PIC X(12).
  6988         16  FILLER REDEFINES PB-I-REFERENCE.
  6989             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6990             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6991             20  PB-I-CLP-STATE           PIC XX.
  6992         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6993             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6994             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6995             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6996         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6997         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6998         16  PB-I-RESIDENT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 133
* EL689.cbl
  6999         16  PB-I-RATE-CODE               PIC X(4).
  7000         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7001         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7002         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7003         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7004         16  PB-I-BANK-NOCHRGB            PIC 99.
  7005         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7006         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7007
  7008     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7009         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7010             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7011         16  PB-C-CANCEL-ORIGIN           PIC X.
  7012             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7013         16  PB-C-LF-CANCEL-DT            PIC XX.
  7014         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7015         16  PB-C-LF-CALC-REQ             PIC X.
  7016             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7017         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7018         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7019         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7020             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7021         16  PB-C-AH-CANCEL-DT            PIC XX.
  7022         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7023         16  PB-C-AH-CALC-REQ             PIC X.
  7024             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7025         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7026         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7027         16  PB-C-LAST-NAME               PIC X(15).
  7028         16  PB-C-REFUND-SW               PIC X.
  7029             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7030             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7031         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7032         16  PB-C-PAYEE-CODE              PIC X(6).
  7033         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7034         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7035         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7036         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7037         16  PB-C-REFERENCE               PIC X(12).
  7038         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7039         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7040         16  PB-C-POST-CARD-IND           PIC X.
  7041         16  PB-C-CANCEL-REASON           PIC X.
  7042         16  PB-C-REF-INTERFACE-SW        PIC X.
  7043         16  FILLER                       PIC X(09).
  7044*        16  FILLER                       PIC X(18).
  7045         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7046*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7047         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  7048         16  PB-CANCELED-CERT-DATA.
  7049             20  PB-CI-INSURED-NAME.
  7050                 24  PB-CI-LAST-NAME      PIC X(15).
  7051                 24  PB-CI-INITIALS       PIC XX.
  7052             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7053             20  PB-CI-INSURED-SEX        PIC X.
  7054             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7055             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7056             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 134
* EL689.cbl
  7057             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7058             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7059             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7060             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7061             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7062             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7063             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7064             20  PB-CI-RATE-CLASS         PIC XX.
  7065             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7066             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7067             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7068             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7069             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7070             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7071             20  PB-CI-LF-ABBR            PIC X(3).
  7072             20  PB-CI-AH-ABBR            PIC X(3).
  7073             20  PB-CI-OB-FLAG            PIC X.
  7074                 88  PB-CI-OB                VALUE 'B'.
  7075             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7076                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7077                                           'M' '4' '5' '9' '2'.
  7078                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7079                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7080                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7081                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7082                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7083                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7084                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7085                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7086                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7087                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7088                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7089                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7090             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7091                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7092                                           'M' '4' '5' '9' '2'.
  7093                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7094                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7095                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7096                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7097                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7098                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7099                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7100                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7101                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7102                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7103                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7104                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7105             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7106             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7107             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7108             20  PB-CI-MEMBER-NO          PIC X(12).
  7109             20  PB-CI-INT-CODE           PIC X.
  7110                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7111                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7112             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7113             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7114             20  PB-CI-COMP-EXCP-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 135
* EL689.cbl
  7115                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7116                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7117             20  PB-CI-ENTRY-STATUS       PIC X.
  7118             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7119             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7120             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7121             20  PB-CI-DEATH-DT           PIC XX.
  7122             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7123             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7124             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7125             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7126             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7127             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7128             20  PB-CI-ENTRY-DT              PIC XX.
  7129             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7130             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7131             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7132             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7133             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7134             20  PB-CI-OLD-LOF               PIC XXX.
  7135*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7136             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7137             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7138             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7139             20  PB-CI-INDV-GRP-CD           PIC X.
  7140             20  PB-CI-BENEFICIARY-NAME.
  7141                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7142                 24  FILLER                  PIC X(15).
  7143             20  PB-CI-NOTE-SW               PIC X.
  7144             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7145             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7146             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7147             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7148             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7149             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7150             20  PB-CI-FIRST-NAME            PIC X(10).
  7151
  7152         16  FILLER                       PIC X(17).
  7153*032306  16  FILLER                       PIC X(27).
  7154*        16  FILLER                       PIC X(46).
  7155
  7156     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7157         16  FILLER                       PIC X(10).
  7158         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7159         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7160         16  PB-M-INSURED-MID-INIT        PIC X.
  7161         16  PB-M-INSURED-AGE             PIC 99.
  7162         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7163         16  PB-M-INSURED-SEX             PIC X.
  7164         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7165         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7166         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  7167         16  PB-M-INSURED-CITY-STATE.
  7168             20  PB-M-INSURED-CITY        PIC X(28).
  7169             20  PB-M-INSURED-STATE       PIC XX.
  7170         16  PB-M-INSURED-ZIP-CODE.
  7171             20  PB-M-INSURED-ZIP-PRIME.
  7172                 24  PB-M-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 136
* EL689.cbl
  7173                     88  PB-M-CANADIAN-POST-CODE
  7174                                             VALUE 'A' THRU 'Z'.
  7175                 24  FILLER               PIC X(4).
  7176             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7177         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7178                                        PB-M-INSURED-ZIP-CODE.
  7179             20  PM-M-INS-CAN-POST1       PIC XXX.
  7180             20  PM-M-INS-CAN-POST2       PIC XXX.
  7181             20  FILLER                   PIC XXX.
  7182         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7183         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7184         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7185         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7186         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7187         16  PB-M-CRED-BENE-CITYST.
  7188             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7189             20  PB-M-CRED-BENE-STATE     PIC XX.
  7190         16  FILLER                       PIC X(92).
  7191
  7192     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7193         16  FILLER                       PIC X(10).
  7194         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7195         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7196         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7197         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7198         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7199         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7200         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7201         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7202         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7203         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7204         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7205         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7206         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7207         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7208         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7209         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7210         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7211         16  PB-ACCOUNT-NAME              PIC X(30).
  7212         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7213         16  PB-REFERENCE                 PIC X(12).
  7214         16  PB-B-RECEIVED-DT             PIC XX.
  7215         16  FILLER                       PIC X(234).
  7216
  7217     12  PB-RECORD-STATUS.
  7218         16  PB-CREDIT-SELECT-DT          PIC XX.
  7219         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7220         16  PB-BILLED-DT                 PIC XX.
  7221         16  PB-BILLING-STATUS            PIC X.
  7222             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7223             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7224             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  7225         16  PB-RECORD-BILL               PIC X.
  7226             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7227             88  PB-RECORD-RETURNED           VALUE 'R'.
  7228             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7229             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7230             88  PB-OVERRIDE-AH               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 137
* EL689.cbl
  7231             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7232         16  PB-BATCH-ENTRY               PIC X.
  7233             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7234             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7235             88  PB-REISSUED-CERT             VALUE 'E'.
  7236             88  PB-MONTHLY-CERT              VALUE 'M'.
  7237             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7238             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7239             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7240         16  PB-FORCE-CODE                PIC X.
  7241             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7242             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7243             88  PB-CANCEL-FORCE              VALUE '8'.
  7244             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7245             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7246             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7247             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7248             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7249             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7250             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7251         16  PB-FATAL-FLAG                PIC X.
  7252             88  PB-FATAL-ERRORS              VALUE 'X'.
  7253         16  PB-FORCE-ER-CD               PIC X.
  7254             88  PB-FORCE-ERRORS              VALUE 'F'.
  7255             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7256         16  PB-WARN-ER-CD                PIC X.
  7257             88  PB-WARNING-ERRORS            VALUE 'W'.
  7258         16  FILLER                       PIC X.
  7259         16  PB-OUT-BAL-CD                PIC X.
  7260             88  PB-OUT-OF-BAL                VALUE 'O'.
  7261         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7262         16  PB-AH-OVERRIDE-L1            PIC X.
  7263         16  PB-INPUT-DT                  PIC XX.
  7264         16  PB-INPUT-BY                  PIC X(4).
  7265         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7266         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7267         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7268         16  PB-LF-EARNING-METHOD         PIC X.
  7269         16  PB-AH-EARNING-METHOD         PIC X.
  7270         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7271         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7272         16  PB-REIN-CD                   PIC XXX.
  7273         16  PB-LF-REFUND-TYPE            PIC X.
  7274         16  PB-AH-REFUND-TYPE            PIC X.
  7275         16  PB-ACCT-EFF-DT               PIC XX.
  7276         16  PB-ACCT-EXP-DT               PIC XX.
  7277         16  PB-COMPANY-ID                PIC X(3).
  7278         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7279         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7280         16  PB-SV-CARRIER                PIC X.
  7281         16  PB-SV-GROUPING               PIC X(6).
  7282         16  PB-SV-STATE                  PIC XX.
  7283         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7284         16  PB-GA-BILLING-INFO.
  7285             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7286                                          PIC XX.
  7287         16  PB-SV-REMIT-TO  REDEFINES
  7288             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 138
* EL689.cbl
  7289         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7290         16  PB-I-LOAN-OFFICER            PIC X(5).
  7291         16  PB-I-VIN                     PIC X(17).
  7292
  7293         16  FILLER                       PIC X(04).
  7294         16  IMNET-BYPASS-SW              PIC X.
  7295
  7296******************************************************************
  7297*                COMMON EDIT ERRORS                              *
  7298******************************************************************
  7299
  7300     12  PB-COMMON-ERRORS.
  7301         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7302                                           PIC S9(4)     COMP.
  7303
  7304******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 139
* EL689.cbl
  7306*    COPY ERCPYAJ.
  7307******************************************************************
  7308*                                                                *
  7309*                            ERCPYAJ                             *
  7310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7311*                            VMOD=2.015                          *
  7312*                                                                *
  7313*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7314*                                                                *
  7315*                                                                *
  7316*   FILE TYPE = VSAM,KSDS                                        *
  7317*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7318*                                                                *
  7319*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7320*       ALTERNATE PATHS = NONE                                   *
  7321*                                                                *
  7322*   LOG = YES                                                    *
  7323*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7324******************************************************************
  7325******************************************************************
  7326*                   C H A N G E   L O G
  7327*
  7328* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7329*-----------------------------------------------------------------
  7330*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7331* EFFECTIVE    NUMBER
  7332*-----------------------------------------------------------------
  7333* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7334* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7335******************************************************************
  7336
  7337 01  PENDING-PAY-ADJ.
  7338     12  PY-RECORD-ID                     PIC XX.
  7339         88  VALID-PY-ID                        VALUE 'PY'.
  7340
  7341     12  PY-CONTROL-PRIMARY.
  7342         16  PY-COMPANY-CD                PIC X.
  7343         16  PY-CARRIER                   PIC X.
  7344         16  PY-GROUPING                  PIC X(6).
  7345         16  PY-FIN-RESP                  PIC X(10).
  7346         16  PY-ACCOUNT                   PIC X(10).
  7347         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7348                                          PIC X(10).
  7349         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7350         16  PY-RECORD-TYPE               PIC X.
  7351             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7352             88  PY-DEPOSIT                   VALUE 'D'.
  7353             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7354             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7355             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7356             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7357             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7358             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7359             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7360             88  PY-FICA-ENTRY                VALUE 'F'.
  7361             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7362             88  PY-POLICY-FEE                VALUE 'W'.
  7363             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 140
* EL689.cbl
  7364
  7365     12  PY-PYMT-TYPE                     PIC X.
  7366             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7367             88  PY-REINS-PYMT                VALUE 'R'.
  7368             88  PY-EXP-PYMT                  VALUE 'E'.
  7369
  7370     12  PY-BIL-INV                       PIC X(6).
  7371     12  PY-REF-NO                        PIC X(12).
  7372
  7373     12  PY-LAST-MAINT-DT                 PIC XX.
  7374     12  PY-LAST-MAINT-BY                 PIC X(4).
  7375     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7376
  7377     12  PY-PYADJ-RECORD.
  7378         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7379         16  PY-ENTRY-COMMENT             PIC X(30).
  7380         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7381             20  PY-GL-ACCOUNT            PIC X(10).
  7382             20  PY-GL-STATE              PIC X(02).
  7383             20  PY-GL-CANC-SW            PIC X(01).
  7384                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7385                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7386             20  PY-GL-COMMENT            PIC X(10).
  7387             20  FILLER      REDEFINES PY-GL-COMMENT.
  7388                 24  PY-GL-CHECK-NO       PIC 9(06).
  7389                 24  FILLER               PIC X(04).
  7390             20  FILLER                   PIC X(07).
  7391         16  PY-SAVE-ACCOUNT              PIC X(10).
  7392         16  PY-SAVE-TYPE                 PIC X(01).
  7393
  7394         16  PY-LETTERS.
  7395             20  PY-LETTER OCCURS 3 TIMES
  7396                           INDEXED BY PY-LET-NDX
  7397                                          PIC X(04).
  7398
  7399         16  PY-ERCOMP-TYPE               PIC X.
  7400             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7401             88  PY-GA-TYPE                   VALUE 'G'.
  7402             88  PY-BANK-TYPE                 VALUE 'B'.
  7403         16  FILLER                       PIC X(05).
  7404
  7405     12  PY-RECORD-STATUS.
  7406         16  PY-CREDIT-SELECT-DT          PIC XX.
  7407         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7408         16  PY-BILLED-DATE               PIC XX.
  7409         16  PY-REPORTED-DT               PIC XX.
  7410         16  PY-PMT-APPLIED               PIC X.
  7411             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7412             88  PY-GA-PMT                    VALUE 'G'.
  7413             88  PY-OVWRITE-PMT               VALUE 'O'.
  7414             88  PY-NON-AR-PMT                VALUE 'N'.
  7415         16  FILLER                       PIC X(5).
  7416         16  PY-INPUT-DT                  PIC XX.
  7417         16  PY-CHECK-NUMBER              PIC X(6).
  7418         16  PY-VOID-SW                   PIC X.
  7419             88  PY-CHECK-VOIDED              VALUE 'V'.
  7420         16  PY-CHECK-ORIGIN-SW           PIC X.
  7421             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 141
* EL689.cbl
  7422             88  PY-REFUND-CHECK              VALUE 'R'.
  7423             88  PY-GA-CHECK                  VALUE 'G'.
  7424             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7425             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7426         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7427         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7428         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7429         16  PY-BILL-FLAG                 PIC X.
  7430             88  PY-BILLED                    VALUE 'B'.
  7431         16  PY-AR-FLAG                   PIC X.
  7432             88  PY-AR-CYCLE                  VALUE 'C'.
  7433             88  PY-AR-MONTH-END              VALUE 'M'.
  7434         16  PY-AR-DATE                   PIC XX.
  7435
  7436     12  PY-GL-CODES.
  7437         16  PY-GL-DB                     PIC X(14).
  7438         16  PY-GL-CR                     PIC X(14).
  7439         16  PY-GL-FLAG                   PIC X.
  7440         16  PY-GL-DATE                   PIC XX.
  7441
  7442     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7443     12  FILLER                           PIC X(3).
  7444******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 142
* EL689.cbl
  7446*    COPY ELCTEXT.
  7447******************************************************************
  7448*                                                                *
  7449*                                                                *
  7450*                            ELCTEXT.                            *
  7451*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7452*                            VMOD=2.008                          *
  7453*                                                                *
  7454*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7455*                                     FORM LETTERS,              *
  7456*                                     CERT FORM DISPLAY.
  7457*                                                                *
  7458*   FILE TYPE = VSAM,KSDS                                        *
  7459*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7460*                                                                *
  7461*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  7462*       ALTERNATE INDEX = NONE                                   *
  7463*                                                                *
  7464*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  7465*       ALTERNATE INDEX = NONE                                   *
  7466*                                                                *
  7467*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  7468*       ALTERNATE INDEX = NONE                                   *
  7469*                                                                *
  7470*   LOG = NO                                                     *
  7471*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7472******************************************************************
  7473 01  TEXT-FILES.
  7474     12  TEXT-FILE-ID                PIC XX.
  7475         88  FORMS-FILE-TEXT            VALUE 'TF'.
  7476         88  LETTER-FILE-TEXT           VALUE 'TL'.
  7477         88  HELP-FILE-TEXT             VALUE 'TH'.
  7478
  7479     12  TX-CONTROL-PRIMARY.
  7480         16  TX-COMPANY-CD           PIC X.
  7481             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  7482         16  TX-ACCESS-CD-GENL       PIC X(12).
  7483
  7484         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7485             20  TX-LETTER-NO        PIC X(4).
  7486             20  FILLER              PIC X(8).
  7487
  7488         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7489             20  TX-FORM-NO          PIC X(12).
  7490
  7491         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7492             20  TX-HELP-TYPE        PIC X.
  7493                 88  HELP-FOR-GENERAL   VALUE ' '.
  7494                 88  HELP-BY-SCREEN     VALUE 'S'.
  7495                 88  HELP-BY-ERROR      VALUE 'E'.
  7496             20  TX-SCREEN-OR-ERROR  PIC X(4).
  7497                 88  GENERAL-INFO-HELP  VALUE '0000'.
  7498             20  TX-HELP-FOR-COMPANY  PIC XXX.
  7499                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  7500             20  FILLER              PIC X(4).
  7501
  7502         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  7503
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 143
* EL689.cbl
  7504     12  TX-PROCESS-CONTROL          PIC XX.
  7505         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  7506
  7507     12  TX-TEXT-LINE                PIC X(70).
  7508
  7509     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  7510         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  7511         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  7512         88  TX-VALID-FORM-SQUEEZE-VALUE
  7513                                        VALUE 'Y' ' '.
  7514
  7515     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  7516         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  7517         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  7518         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  7519         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  7520         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  7521         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  7522         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  7523                                              'K' 'N' ' '
  7524                                              'Z'.
  7525
  7526     12  TX-ARCHIVE-SW               PIC X.
  7527         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  7528         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  7529         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  7530
  7531     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  7532     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  7533
  7534     12  TX-BSR-CODE                 PIC X.
  7535         88  TX-BSR-LETTER              VALUE 'B'.
  7536         88  TX-NON-BSR-LETTER          VALUE ' '.
  7537
  7538     12  FILLER                      PIC X.
  7539*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 144
* EL689.cbl
  7541 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  7542                          LETTER-ARCHIVE LETTER-ARCHIVE-TEXT
  7543                          CERTIFICATE-MASTER CHECK-RECORDS
  7544                          CONTROL-FILE COMPENSATION-MASTER
  7545                          MAILING-DATA PENDING-BUSINESS
  7546                          PENDING-PAY-ADJ TEXT-FILES.
  7547 0000-DFHEXIT SECTION.
  7548     MOVE '9#                    $   ' TO DFHEIV0.
  7549     MOVE 'EL689' TO DFHEIV1.
  7550     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7551     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7552
  7553     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7554     MOVE '5'                    TO DC-OPTION-CODE.
  7555     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  7556     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  7557     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  7558                                    W-CURRENT-SAVE.
  7559
  7560     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7561     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  7562                                 TO EMI-SAVE-AREA.
  7563
  7564     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  7565                                    W-TS-TERM-SCREEN.
  7566
  7567     IF  EIBCALEN EQUAL 0
  7568         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  7569         GO TO 8300-SEND-TEXT
  7570     END-IF.
  7571
  7572     IF  PI-689-CREATE-NO-SCREENS
  7573         GO TO 0600-BYPASS-SCREEN-CNTL
  7574     END-IF.
  7575
  7576     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  7577         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  7578             MOVE PI-SAVED-PROGRAM-5
  7579                                 TO PI-SAVED-PROGRAM-6
  7580             MOVE PI-SAVED-PROGRAM-4
  7581                                 TO PI-SAVED-PROGRAM-5
  7582             MOVE PI-SAVED-PROGRAM-3
  7583                                 TO PI-SAVED-PROGRAM-4
  7584             MOVE PI-SAVED-PROGRAM-2
  7585                                 TO PI-SAVED-PROGRAM-3
  7586             MOVE PI-SAVED-PROGRAM-1
  7587                                 TO PI-SAVED-PROGRAM-2
  7588             MOVE PI-RETURN-TO-PROGRAM
  7589                                 TO PI-SAVED-PROGRAM-1
  7590             MOVE PI-CALLING-PROGRAM
  7591                                 TO PI-RETURN-TO-PROGRAM
  7592             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  7593             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  7594             MOVE LOW-VALUES     TO EL689AO
  7595             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  7596             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  7597                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  7598             END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 145
* EL689.cbl
  7599             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  7600                     AND
  7601                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  7602                 GO TO 0400-EL6311-INCOMING
  7603             ELSE
  7604                 MOVE PI-689-ARCHIVE-NUMBER
  7605                                 TO W-INCOMING-ARCHIVE
  7606                 MOVE LOW-VALUES TO PI-1042-WA
  7607                                    PI-689-WORK-AREA
  7608                 MOVE ZEROS      TO PI-CURRENT-LINE
  7609                                    PI-TEMP-STOR-ITEMS
  7610                                    PI-TOTAL-LINES
  7611                                    PI-UPDATE-SW
  7612                                    PI-689-NUMBER-LABEL-LINES
  7613                                    PI-689-NUMBER-TEXT-RECORDS
  7614                                    PI-689-ERROR
  7615                 MOVE SPACES     TO PI-689-PRINT-SW
  7616                                    PI-689-ALT-PRINTER-ID
  7617                                    PI-689-LBL-OVERRIDE
  7618                                    PI-COMM-CONTROL
  7619                                    PI-689-FORM-NUMBER
  7620                                    PI-689-TEMP-STOR-ID
  7621                                    PI-689-LABEL-SOURCE
  7622                                    PI-689-USE-SCREEN-IND
  7623                 MOVE '2'        TO PI-ACTION
  7624                 MOVE -1         TO MAINTL
  7625                 MOVE PI-LOWER-CASE-LETTERS
  7626                                 TO W-LC-CASE-IND
  7627                 IF  W-INCOMING-ARCHIVE NUMERIC
  7628                         AND
  7629                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  7630                     MOVE 'S'    TO MAINTI
  7631                     MOVE +1     TO MAINTL
  7632                     MOVE AL-UANON
  7633                                 TO MAINTA
  7634                     MOVE W-INCOMING-ARCH-NO
  7635                                 TO ARCHNUMI
  7636                     MOVE +8     TO ARCHNUML
  7637                     MOVE AL-UNNON
  7638                                 TO ARCHNUMA
  7639                     GO TO 1000-SHOW
  7640                 ELSE
  7641                     GO TO 0450-SPECIAL-INPUT-PROCESS
  7642                 END-IF
  7643             END-IF
  7644         ELSE
  7645             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  7646             MOVE PI-RETURN-TO-PROGRAM
  7647                                     TO PI-CALLING-PROGRAM
  7648             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  7649             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  7650             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  7651             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  7652             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  7653             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  7654             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  7655             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  7656             MOVE LOW-VALUES         TO EL689AO
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 146
* EL689.cbl
  7657             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  7658             SET W-RG-NDX            TO PI-CURRENT-LINE
  7659             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  7660                 VARYING
  7661                     W-SC-NDX FROM 1 BY 1
  7662                 UNTIL
  7663                     W-SC-NDX GREATER THAN
  7664                     W-NUM-LINES-PER-SCREEN
  7665             MOVE PI-689-ALT-PRINTER-ID
  7666                                     TO PRINTERO
  7667             MOVE AL-UANON           TO PRINTERA
  7668             MOVE -1                 TO PRINTERL
  7669             GO TO 8100-SEND-INITIAL-MAP
  7670         END-IF
  7671     END-IF.
  7672
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 147
* EL689.cbl
  7674 0200-RECEIVE.
  7675
  7676     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  7677     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  7678     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  7679             OR
  7680         EMI-FORCABLE-CTR GREATER THAN ZEROS
  7681         MOVE 'Y'                TO W-HOLD-IND.
  7682
  7683     MOVE W-TRANSACTION          TO EIBTRNID.
  7684     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  7685     MOVE ZEROS                  TO W-LAST-ERROR.
  7686     MOVE LOW-VALUES             TO EL689AI.
  7687     MOVE '104A'                 TO W-TS-ID-TEXT.
  7688     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  7689                                    W-TS-TERM-SCREEN.
  7690
  7691
  7692* EXEC CICS HANDLE AID
  7693*        CLEAR    (9300-DFHCLEAR)
  7694*        PA1      (9200-PA)
  7695*        PA2      (9200-PA)
  7696*        PA3      (9200-PA)
  7697*    END-EXEC.
  7698*    MOVE '"&=!"#               V! " #00007687' TO DFHEIV0
  7699     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  7700     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  7701     MOVE X'2220233030303037363837' TO DFHEIV0(25:11)
  7702     CALL 'kxdfhei1' USING DFHEIV0
  7703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7704
  7705
  7706
  7707* EXEC CICS HANDLE CONDITION
  7708*        PGMIDERR (9700-PGMID-ERROR)
  7709*        ERROR    (9800-ABEND)
  7710*        MAPFAIL  (0325-MAPFAIL)
  7711*    END-EXEC.
  7712*    MOVE '"$L.?                 ! # #00007694' TO DFHEIV0
  7713     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  7714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7715     MOVE X'2320233030303037363934' TO DFHEIV0(25:11)
  7716     CALL 'kxdfhei1' USING DFHEIV0
  7717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7718
  7719
  7720
  7721* EXEC CICS SYNCPOINT
  7722*    END-EXEC.
  7723*    MOVE '6"                    !   #00007700' TO DFHEIV0
  7724     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7725     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7726     MOVE X'2020233030303037373030' TO DFHEIV0(25:11)
  7727     CALL 'kxdfhei1' USING DFHEIV0
  7728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7729
  7730
  7731     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 148
* EL689.cbl
  7732*    IF  W-LC-USE-BOTH-CASES
  7733
  7734* EXEC CICS RECEIVE
  7735*            MAP      (W-MAP)
  7736*            MAPSET   (W-MAPSET)
  7737*            INTO     (EL689AI)
  7738*            ASIS
  7739*        END-EXEC
  7740     MOVE LENGTH OF
  7741      EL689AI
  7742       TO DFHEIV11
  7743*    MOVE '8"TAI  L              ''   #00007705' TO DFHEIV0
  7744     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7745     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7746     MOVE X'2020233030303037373035' TO DFHEIV0(25:11)
  7747     CALL 'kxdfhei1' USING DFHEIV0,
  7748           W-MAP,
  7749           EL689AI,
  7750           DFHEIV11,
  7751           W-MAPSET,
  7752           DFHEIV99,
  7753           DFHEIV99
  7754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7755     ELSE
  7756
  7757* EXEC CICS RECEIVE
  7758*            MAP      (W-MAP)
  7759*            MAPSET   (W-MAPSET)
  7760*            INTO     (EL689AI)
  7761*        END-EXEC.
  7762     MOVE LENGTH OF
  7763      EL689AI
  7764       TO DFHEIV11
  7765*    MOVE '8"T I  L              ''   #00007712' TO DFHEIV0
  7766     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7767     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7768     MOVE X'2020233030303037373132' TO DFHEIV0(25:11)
  7769     CALL 'kxdfhei1' USING DFHEIV0,
  7770           W-MAP,
  7771           EL689AI,
  7772           DFHEIV11,
  7773           W-MAPSET,
  7774           DFHEIV99,
  7775           DFHEIV99
  7776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7777
  7778
  7779     IF  NOT DISPLAY-CAP
  7780         MOVE 'READ'             TO SM-READ
  7781         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  7782         MOVE ER-9097            TO EMI-ERROR
  7783         MOVE -1                 TO MAINTL
  7784         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7785         GO TO 8100-SEND-INITIAL-MAP.
  7786
  7787     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  7788
  7789     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 149
* EL689.cbl
  7790         GO TO 0300-CHECK-PFKEYS.
  7791
  7792     IF  EIBAID NOT EQUAL DFHENTER
  7793         MOVE ER-0004            TO EMI-ERROR
  7794         GO TO 0320-INPUT-ERROR.
  7795
  7796     IF  ENTERPFI NUMERIC
  7797             AND
  7798         ENTERPFI GREATER THAN 0
  7799             AND
  7800         ENTERPFI LESS THAN 25
  7801         MOVE PF-VALUES (ENTERPFI)
  7802                                 TO EIBAID
  7803     ELSE
  7804         MOVE ER-0029            TO EMI-ERROR
  7805         GO TO 0320-INPUT-ERROR.
  7806
  7807 0300-CHECK-PFKEYS.
  7808
  7809     IF  EIBAID EQUAL DFHPF23
  7810         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  7811         MOVE ZEROS              TO PI-TOTAL-LINES
  7812                                    PI-CURRENT-LINE
  7813         MOVE EIBAID             TO PI-ENTRY-CD-1
  7814         MOVE W-XCTL-005         TO W-CALL-PGM
  7815         GO TO 9400-XCTL.
  7816
  7817     IF  EIBAID EQUAL DFHPF24
  7818         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  7819         MOVE ZEROS              TO PI-TOTAL-LINES
  7820                                    PI-CURRENT-LINE
  7821         MOVE W-XCTL-626         TO W-CALL-PGM
  7822         GO TO 9400-XCTL.
  7823
  7824     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  7825                                    W-FORM-CHANGED-IND.
  7826
  7827     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  7828             OR
  7829         PI-SHOW-MODE
  7830         NEXT SENTENCE
  7831     ELSE
  7832         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  7833                 AND
  7834             FORML NOT EQUAL ZEROS
  7835                 AND
  7836             PI-689-FORM-NUMBER NOT EQUAL FORMI
  7837             MOVE FORMI          TO PI-689-FORM-NUMBER
  7838             MOVE LOW-VALUES     TO EL689AI
  7839                                    PI-1042-WA
  7840                                    PI-689-FOLLOW-UP-DATE
  7841                                    PI-689-PRINT-RESTRICTION
  7842                                    PI-689-RESEND-DATE-1
  7843                                    PI-689-RESEND1-EDIT
  7844                                    PI-689-FOLLOW-UP-DATE
  7845                                    PI-689-FOLLOW-UP-EDIT
  7846                                    PI-689-ERROR-IND
  7847             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 150
* EL689.cbl
  7848                                    PI-689-NUMBER-COPIES
  7849                                    PI-689-NUMBER-LABEL-LINES
  7850                                    PI-689-NUMBER-TEXT-RECORDS
  7851                                    PI-CURRENT-LINE
  7852                                    PI-TEMP-STOR-ITEMS
  7853                                    PI-TOTAL-LINES
  7854                                    PI-UPDATE-SW
  7855             MOVE SPACES         TO PI-689-PRINT-SW
  7856                                    PI-689-ALT-PRINTER-ID
  7857                                    PI-COMM-CONTROL
  7858                                    PI-689-TEMP-STOR-ID
  7859                                    PI-689-USE-SCREEN-IND
  7860                                    PI-689-RESEND-LETR-1
  7861             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  7862             MOVE DFHENTER       TO EIBAID
  7863             MOVE 'Y'            TO W-FORM-CHANGED-IND
  7864             GO TO 0330-FUNCTION-CHECK
  7865         ELSE
  7866             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  7867                     OR
  7868                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  7869                         AND
  7870                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  7871                             OR
  7872                         ADDRSI NOT EQUAL LOW-VALUES))
  7873                     OR
  7874                 PI-689-CARRIER NOT EQUAL CARRIERI
  7875                     OR
  7876                 PI-689-GROUPING NOT EQUAL GROUPI
  7877                     OR
  7878                 PI-689-STATE NOT EQUAL STATEI
  7879                     OR
  7880                 PI-689-ACCOUNT NOT EQUAL ACCTI
  7881                     OR
  7882                 PI-689-CERT-PRIME NOT EQUAL CERTI
  7883                     OR
  7884                 PI-689-CERT-SFX NOT EQUAL SFXI
  7885                     OR
  7886                 PI-689-TYPE NOT EQUAL TYPEI
  7887                     OR
  7888                 PI-689-DATE-EDIT NOT EQUAL DATEI
  7889                     OR
  7890                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  7891                     OR
  7892                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  7893                     OR
  7894                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  7895                     OR
  7896                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  7897                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  7898                 MOVE DFHENTER   TO EIBAID
  7899                 GO TO 0330-FUNCTION-CHECK.
  7900
  7901     IF  EIBAID EQUAL DFHPF1
  7902         MOVE +7                 TO W-ROLL-COUNTER
  7903         GO TO 4000-ROLL-PAGE.
  7904
  7905     IF  EIBAID EQUAL DFHPF2
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 151
* EL689.cbl
  7906         MOVE -7                 TO W-ROLL-COUNTER
  7907         GO TO 4000-ROLL-PAGE.
  7908
  7909     IF  EIBAID EQUAL DFHPF3
  7910         IF  W-HOLD-ON
  7911             MOVE ER-7245        TO EMI-ERROR
  7912             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7913             MOVE -1             TO MAINTL
  7914             MOVE AL-UABON       TO MAINTA
  7915             GO TO 8200-SEND-DATAONLY
  7916         ELSE
  7917             GO TO 0330-FUNCTION-CHECK.
  7918
  7919     IF EIBAID = DFHPF4 OR DFHPF8
  7920         IF  W-HOLD-ON
  7921             MOVE ER-7245        TO EMI-ERROR
  7922             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7923             MOVE -1             TO MAINTL
  7924             MOVE AL-UABON       TO MAINTA
  7925             GO TO 8200-SEND-DATAONLY
  7926         ELSE
  7927             GO TO 0330-FUNCTION-CHECK.
  7928
  7929     IF  EIBAID = DFHPF5
  7930         COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  7931         GO TO 4000-ROLL-PAGE.
  7932
  7933     IF  EIBAID = DFHPF6
  7934         MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  7935         GO TO 4000-ROLL-PAGE.
  7936
  7937     IF  EIBAID EQUAL DFHPF7
  7938         IF  W-HOLD-ON
  7939             MOVE ER-7245        TO EMI-ERROR
  7940             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7941             MOVE -1             TO MAINTL
  7942             MOVE AL-UABON       TO MAINTA
  7943             GO TO 8200-SEND-DATAONLY
  7944         ELSE
  7945             GO TO 0330-FUNCTION-CHECK.
  7946
  7947     IF  EIBAID EQUAL DFHENTER
  7948         GO TO 0330-FUNCTION-CHECK.
  7949
  7950     MOVE ER-0029                TO EMI-ERROR.
  7951
  7952 0320-INPUT-ERROR.
  7953
  7954     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7955
  7956     IF  ENTERPFL EQUAL 0
  7957         MOVE -1                 TO MAINTL
  7958         MOVE AL-UABON           TO MAINTA
  7959     ELSE
  7960         MOVE AL-UNBON           TO ENTERPFA
  7961         MOVE -1                 TO ENTERPFL.
  7962
  7963     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 152
* EL689.cbl
  7964
  7965 0325-MAPFAIL.
  7966***********************************************************
  7967*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  7968*      LETTERS ON A 3275 PRINTER.                         *
  7969***********************************************************
  7970
  7971     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  7972
  7973     SET W-RG-NDX                TO PI-CURRENT-LINE.
  7974     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  7975             VARYING
  7976         W-SC-NDX FROM 1 BY 1
  7977             UNTIL
  7978         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  7979
  7980     MOVE -1                     TO MAINTL.
  7981     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 153
* EL689.cbl
  7983 0330-FUNCTION-CHECK.
  7984
  7985     IF  MAINTI EQUAL 'S'
  7986         IF EIBAID = DFHPF4 OR DFHPF8
  7987             GO TO 7900-PRINT-LETTER-NOW
  7988         ELSE
  7989             GO TO 1000-SHOW.
  7990
  7991     IF  NOT MODIFY-CAP
  7992         MOVE 'UPDATE'           TO SM-READ
  7993         PERFORM 9995-SECURITY-VIOLATION
  7994         MOVE ER-0070            TO EMI-ERROR
  7995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7996         MOVE -1                 TO MAINTL
  7997         GO TO 8100-SEND-INITIAL-MAP.
  7998
  7999     IF  W-FORM-CHANGED
  8000             OR
  8001         W-KEY-FIELDS-CHANGED
  8002         GO TO 0330-EDIT.
  8003
  8004     IF  EIBAID EQUAL DFHPF3
  8005         IF  PI-NO-CARRIER-SECURITY
  8006                 AND
  8007             PI-NO-ACCOUNT-SECURITY
  8008             GO TO 5000-EDIT-MODE.
  8009
  8010     IF  EIBAID EQUAL DFHPF7
  8011         IF  PI-NO-CARRIER-SECURITY
  8012                 AND
  8013             PI-NO-ACCOUNT-SECURITY
  8014             GO TO 5400-LETTER-RELEASE
  8015         ELSE
  8016             IF  PI-689-PRINT-PERFORMED
  8017                 GO TO 5400-LETTER-RELEASE
  8018             ELSE
  8019                 MOVE AL-UNBON TO ENTERPFA
  8020                 MOVE -1       TO ENTERPFL
  8021                 MOVE ER-2398  TO EMI-ERROR
  8022                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8023                 GO TO 8200-SEND-DATAONLY.
  8024
  8025     IF  EIBAID = DFHPF4 OR DFHPF8
  8026         GO TO 7900-PRINT-LETTER-NOW.
  8027
  8028 0330-EDIT.
  8029
  8030     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  8031             OR
  8032         W-SC-TEXTL (2) NOT EQUAL ZEROS
  8033             OR
  8034         W-SC-TEXTL (3) NOT EQUAL ZEROS
  8035             OR
  8036         W-SC-TEXTL (4) NOT EQUAL ZEROS
  8037             OR
  8038         W-SC-TEXTL (5) NOT EQUAL ZEROS
  8039             OR
  8040         W-SC-TEXTL (6) NOT EQUAL ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 154
* EL689.cbl
  8041             OR
  8042         W-SC-TEXTL (7) NOT EQUAL ZEROS
  8043             OR
  8044         W-SC-TEXTL (8) NOT EQUAL ZEROS
  8045             OR
  8046         W-SC-TEXTL (9) NOT EQUAL ZEROS
  8047             OR
  8048         W-SC-TEXTL (10) NOT EQUAL ZEROS
  8049             OR
  8050         W-SC-TEXTL (11) NOT EQUAL ZEROS
  8051         IF  W-KEY-FIELDS-CHANGED
  8052                 OR
  8053             W-FORM-CHANGED
  8054             MOVE ER-7250        TO EMI-ERROR
  8055             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8056             MOVE -1             TO MAINTL
  8057             MOVE AL-UABON       TO MAINTA
  8058         ELSE
  8059             PERFORM 4100-SET-NDX THRU 4100-EXIT
  8060             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  8061                     VARYING
  8062                 W-SC-NDX FROM 1 BY 1
  8063                     UNTIL
  8064                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  8065             MOVE ER-7398        TO EMI-ERROR
  8066             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8067             MOVE -1             TO MAINTL
  8068             MOVE AL-UABON       TO MAINTA
  8069             GO TO 8200-SEND-DATAONLY.
  8070
  8071     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8072
  8073     IF  W-KEY-FIELDS-CHANGED
  8074             OR
  8075         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8076         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8077         IF  MAINTI EQUAL 'C'
  8078             GO TO 2000-CREATE
  8079         ELSE
  8080             NEXT SENTENCE
  8081     ELSE
  8082         IF  W-FORM-CHANGED
  8083             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8084             IF  MAINTI EQUAL 'C'
  8085                 GO TO 2000-CREATE
  8086             ELSE
  8087                 NEXT SENTENCE
  8088         ELSE
  8089             MOVE -1             TO MAINTL
  8090             GO TO 8200-SEND-DATAONLY.
  8091
  8092     MOVE ER-0023                TO EMI-ERROR.
  8093     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8094     MOVE -1                     TO MAINTL.
  8095     MOVE AL-UABON               TO MAINTA.
  8096     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 155
* EL689.cbl
  8098 0350-EDIT-ROUTINE.
  8099
  8100     IF  MAINTI EQUAL 'C'
  8101             AND
  8102         FORML EQUAL ZEROS
  8103         MOVE -1                 TO FORML
  8104         MOVE ER-0177            TO EMI-ERROR
  8105         MOVE AL-UABON           TO FORMA
  8106         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8107
  8108     IF  PRTRESTL NOT EQUAL ZEROS
  8109         PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  8110
  8111     IF  FOLLOWL NOT EQUAL ZEROS
  8112         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  8113         PERFORM 8600-DEEDIT
  8114         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8115         MOVE '4'                TO DC-OPTION-CODE
  8116         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8117         IF  DATE-CONVERSION-ERROR
  8118             MOVE ER-0182        TO EMI-ERROR
  8119             MOVE -1             TO FOLLOWL
  8120             MOVE AL-UABON       TO FOLLOWA
  8121             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8122         ELSE
  8123             MOVE DC-GREG-DATE-1-EDIT
  8124                                 TO FOLLOWO
  8125                                    PI-689-FOLLOW-UP-EDIT
  8126             MOVE AL-UANON       TO FOLLOWA
  8127             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  8128     ELSE
  8129         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  8130
  8131     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  8132         IF  PI-689-FOLLOW-UP-DATE NOT GREATER THAN
  8133                 W-SAVE-BIN-DATE
  8134             MOVE ER-0533        TO EMI-ERROR
  8135             MOVE AL-UABON       TO FOLLOWA
  8136             MOVE -1             TO FOLLOWL
  8137             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8138
  8139     IF  RESEND1L NOT EQUAL ZEROS
  8140         MOVE RESEND1I           TO W-DEEDIT-FIELD
  8141         PERFORM 8600-DEEDIT
  8142         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8143         MOVE '4'                TO DC-OPTION-CODE
  8144         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8145         IF  DATE-CONVERSION-ERROR
  8146             MOVE ER-0185        TO EMI-ERROR
  8147             MOVE -1             TO RESEND1L
  8148             MOVE AL-UABON       TO RESEND1A
  8149             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8150         ELSE
  8151             MOVE DC-GREG-DATE-1-EDIT
  8152                                 TO RESEND1O
  8153                                    PI-689-RESEND1-EDIT
  8154             MOVE AL-UANON       TO RESEND1A
  8155             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 156
* EL689.cbl
  8156     ELSE
  8157         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  8158
  8159     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  8160         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  8161                 W-SAVE-BIN-DATE
  8162             MOVE ER-0537        TO EMI-ERROR
  8163             MOVE AL-UABON       TO RESEND1A
  8164             MOVE -1             TO RESEND1L
  8165             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8166
  8167     IF NOT PI-CREATE-LABELS
  8168         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  8169         MOVE AL-PANON           TO ADDRLBLA
  8170         GO TO 0350-BYPASS-OVERRIDE.
  8171
  8172     IF  ADDRLBLL GREATER THAN ZEROS
  8173          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8174          IF ADDRLBLI = 'N' OR 'Y'
  8175              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  8176              MOVE AL-UANON      TO ADDRLBLA
  8177          ELSE
  8178             MOVE ER-3783        TO EMI-ERROR
  8179             MOVE -1             TO ADDRLBLL
  8180             MOVE AL-UABON       TO ADDRLBLA
  8181             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8182
  8183 0350-BYPASS-OVERRIDE.
  8184
  8185     IF  PI-BYPASS-LABELS
  8186             OR
  8187         FORMI EQUAL '9999'
  8188             OR
  8189         PI-689-LABELS-OVERRIDEN
  8190         MOVE SPACES             TO PI-689-LABEL-SOURCE
  8191         MOVE LOW-VALUES         TO ADDRSI
  8192         MOVE AL-UANOF           TO ADDRSA
  8193         MOVE ZEROS              TO ADDRSL
  8194     ELSE
  8195         IF  ADDRSL GREATER THAN ZEROS
  8196             MOVE ADDRSI         TO W-LABEL-SOURCE
  8197             IF  W-LABEL-SOURCE-VALID
  8198                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  8199             ELSE
  8200                 MOVE -1         TO ADDRSL
  8201                 MOVE ER-0176    TO EMI-ERROR
  8202                 MOVE AL-UABON   TO ADDRSA
  8203                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8204         ELSE
  8205             IF  MAINTI EQUAL 'C'
  8206                 MOVE -1         TO ADDRSL
  8207                 MOVE ER-0176    TO EMI-ERROR
  8208                 MOVE AL-UABON   TO ADDRSA
  8209                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8210
  8211     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  8212     IF  PRINTERL GREATER ZERO
  8213         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 157
* EL689.cbl
  8214         MOVE AL-UANON           TO PRINTERA
  8215         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  8216                                    PI-ALT-DMD-PRT-ID
  8217     ELSE
  8218         IF  PI-NO-CARRIER-SECURITY
  8219                 AND
  8220             PI-NO-ACCOUNT-SECURITY
  8221             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  8222                 MOVE PI-PROCESSOR-PRINTER
  8223                                 TO PI-689-ALT-PRINTER-ID
  8224                                    PRINTERI
  8225                 MOVE AL-UABON   TO PRINTERA
  8226             ELSE
  8227                 MOVE PI-COMPANY-ID
  8228                                 TO W-CNTL-COMPANY-ID
  8229                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  8230                 MOVE SPACES     TO W-CNTL-GENL
  8231                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  8232
  8233* EXEC CICS HANDLE CONDITION
  8234*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  8235*                     NOTFND     (7945-NOT-FOUND)
  8236*                END-EXEC
  8237*    MOVE '"$JI                  ! $ #00008171' TO DFHEIV0
  8238     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8239     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8240     MOVE X'2420233030303038313731' TO DFHEIV0(25:11)
  8241     CALL 'kxdfhei1' USING DFHEIV0
  8242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8243
  8244* EXEC CICS READ
  8245*                     DATASET    (W-CNTL-FILE-ID)
  8246*                     SET        (ADDRESS OF CONTROL-FILE)
  8247*                     RIDFLD     (W-CNTL-KEY)
  8248*                END-EXEC
  8249*    MOVE '&"S        E          (   #00008175' TO DFHEIV0
  8250     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8252     MOVE X'2020233030303038313735' TO DFHEIV0(25:11)
  8253     CALL 'kxdfhei1' USING DFHEIV0,
  8254           W-CNTL-FILE-ID,
  8255           DFHEIV20,
  8256           DFHEIV99,
  8257           W-CNTL-KEY,
  8258           DFHEIV99,
  8259           DFHEIV99,
  8260           DFHEIV99
  8261     SET ADDRESS OF CONTROL-FILE TO
  8262         DFHEIV20
  8263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8264                 MOVE CF-FORMS-PRINTER-ID
  8265                                 TO PI-689-ALT-PRINTER-ID
  8266                                    PRINTERI
  8267                                    W-TS-TERM-TEXT
  8268                 MOVE AL-UABON   TO PRINTERA
  8269         ELSE
  8270             MOVE AL-UABON       TO PRINTERA
  8271             MOVE -1             TO PRINTERL
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 158
* EL689.cbl
  8272             MOVE ER-9283        TO EMI-ERROR
  8273             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8274
  8275     IF  COPIESL NOT EQUAL ZEROS
  8276         IF  COPIESI NOT NUMERIC
  8277                 OR
  8278             COPIESI EQUAL '0'
  8279             MOVE ER-0184        TO EMI-ERROR
  8280             MOVE -1             TO COPIESL
  8281             MOVE AL-UABON       TO COPIESA
  8282             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8283         ELSE
  8284             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  8285             MOVE AL-UANON       TO COPIESA
  8286     ELSE
  8287         IF FORMI EQUAL '9999'
  8288             MOVE 1              TO PI-689-NUMBER-COPIES
  8289                                    COPIESL
  8290                                    COPIESO.
  8291
  8292     IF  FORML NOT EQUAL ZEROS
  8293         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8294         MOVE FORMI              TO PI-689-FORM-NUMBER.
  8295
  8296     MOVE SPACES                 TO W-HOLD-IND.
  8297
  8298     IF  NOT EMI-NO-ERRORS
  8299         IF  EMI-ERROR EQUAL ER-7250
  8300             GO TO 0350-EXIT
  8301         ELSE
  8302            MOVE -1             TO MAINTL
  8303            GO TO 8200-SEND-DATAONLY.
  8304
  8305 0350-EXIT.
  8306      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 159
* EL689.cbl
  8308 0360-EDIT-PRINT-RESTRICTIONS.
  8309
  8310     INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  8311                                 TO W-UPPER-CASE.
  8312
  8313     IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  8314                                      OR 'P' OR LOW-VALUES)
  8315             AND
  8316         PRTRESTI EQUAL 'C'
  8317             AND
  8318         PI-689-CONTROL NOT GREATER THAN ZEROS
  8319         MOVE ER-7243            TO EMI-ERROR
  8320         MOVE -1                 TO PRTRESTL
  8321         MOVE AL-UABON           TO PRTRESTA
  8322         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8323         GO TO 0360-EXIT.
  8324
  8325     IF  PRTRESTL NOT EQUAL ZEROS
  8326         IF PRTRESTI = 'C' OR 'F' OR 'P'
  8327             MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  8328             MOVE AL-UANON       TO PRTRESTA
  8329         ELSE
  8330             IF  PRTRESTI EQUAL ' '
  8331                 MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  8332                 MOVE AL-UANON   TO PRTRESTA
  8333             ELSE
  8334                 MOVE ER-7393    TO EMI-ERROR
  8335                 MOVE -1         TO PRTRESTL
  8336                 MOVE AL-UABON   TO PRTRESTA
  8337                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8338
  8339     IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  8340             AND
  8341         W-HOLD-ON
  8342             AND
  8343         PI-689-CONTROL NOT GREATER THAN ZEROS
  8344         MOVE ER-7243            TO EMI-ERROR
  8345         MOVE -1                 TO PRTRESTL
  8346         MOVE AL-UABON           TO PRTRESTA
  8347         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8348
  8349 0360-EXIT.
  8350      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 160
* EL689.cbl
  8352 0400-EL6311-INCOMING.
  8353
  8354     MOVE ZEROS                  TO PI-CURRENT-LINE
  8355                                    PI-TEMP-STOR-ITEMS
  8356                                    PI-TOTAL-LINES
  8357                                    PI-UPDATE-SW
  8358                                    PI-689-NUMBER-LABEL-LINES
  8359                                    PI-689-ERROR
  8360                                    PI-689-NUMBER-TEXT-RECORDS.
  8361     MOVE SPACES                 TO PI-689-PRINT-SW
  8362                                    PI-689-ALT-PRINTER-ID
  8363                                    PI-COMM-CONTROL
  8364                                    PI-689-FORM-NUMBER
  8365                                    PI-689-TEMP-STOR-ID
  8366                                    PI-689-LABEL-SOURCE
  8367                                    PI-689-USE-SCREEN-IND.
  8368
  8369     IF PI-CREATE-LABELS
  8370         MOVE  AL-UANON          TO ADDRLBLA
  8371         MOVE  +1                TO ADDRLBLL.
  8372
  8373     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  8374                                    PI-689-LBL-OVERRIDE.
  8375
  8376     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  8377     MOVE '2'                    TO PI-ACTION.
  8378     MOVE -1                     TO MAINTL.
  8379
  8380     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  8381         MOVE AL-UANON           TO CARRIERA
  8382         MOVE +1                 TO CARRIERL
  8383         MOVE PI-689-CARRIER     TO CARRIERI.
  8384
  8385     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  8386         MOVE +6                 TO GROUPL
  8387         MOVE AL-UANON           TO GROUPA
  8388         MOVE PI-689-GROUPING    TO GROUPI.
  8389
  8390     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  8391         MOVE +2                 TO STATEL
  8392         MOVE AL-UANON           TO STATEA
  8393         MOVE PI-689-STATE       TO STATEI.
  8394
  8395     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  8396         MOVE +10                TO ACCTL
  8397         MOVE AL-UANON           TO ACCTA
  8398         MOVE PI-689-ACCOUNT     TO ACCTI.
  8399
  8400     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  8401         MOVE +10                TO CERTL
  8402         MOVE AL-UANON           TO CERTA
  8403         MOVE PI-689-CERT-PRIME  TO CERTI.
  8404
  8405     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  8406         MOVE +1                 TO SFXL
  8407         MOVE AL-UANON           TO SFXA
  8408         MOVE PI-689-CERT-SFX    TO SFXI.
  8409
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 161
* EL689.cbl
  8410     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  8411         MOVE +6                 TO BENTRYL
  8412         MOVE AL-UANON           TO BENTRYA
  8413         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  8414
  8415     MOVE +4                     TO BCSEQL.
  8416     MOVE AL-UANON               TO BCSEQA.
  8417     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  8418
  8419     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  8420         MOVE +8                 TO SEQL
  8421         MOVE AL-UANON           TO SEQA
  8422         MOVE PI-689-SEQ-NO      TO SEQI.
  8423
  8424     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  8425         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  8426         MOVE ' '                TO DC-OPTION-CODE
  8427         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8428         MOVE +8                 TO DATEL
  8429         MOVE DC-GREG-DATE-1-EDIT
  8430                                 TO DATEI
  8431         MOVE AL-UANON           TO DATEA.
  8432
  8433     MOVE -1                     TO MAINTL.
  8434     MOVE '4'                    TO DATASORI
  8435                                    PI-689-DATA-SOURCE.
  8436     MOVE +1                     TO DATASORL.
  8437     MOVE AL-UANON               TO DATASORA.
  8438
  8439     GO TO 8100-SEND-INITIAL-MAP.
  8440
  8441 0400-EXIT.
  8442      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 162
* EL689.cbl
  8444 0450-SPECIAL-INPUT-PROCESS.
  8445
  8446     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  8447             AND
  8448         PI-CARRIER GREATER THAN LOW-VALUES
  8449         MOVE '1'                TO DATASORI
  8450                                    PI-689-DATA-SOURCE
  8451         MOVE PI-CARRIER         TO CARRIERI
  8452         MOVE PI-GROUPING        TO GROUPI
  8453         MOVE PI-STATE           TO STATEI
  8454         MOVE PI-ACCOUNT         TO ACCTI
  8455         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  8456         MOVE ' '                TO DC-OPTION-CODE
  8457         PERFORM 9500-LINK-DATE-CONVERT
  8458             THRU 9500-EXIT
  8459         MOVE DC-GREG-DATE-1-EDIT
  8460                                 TO DATEI
  8461         MOVE AL-UANON           TO ACCTA
  8462                                    CARRIERA
  8463                                    DATEA
  8464                                    DATASORA
  8465                                    GROUPA
  8466                                    STATEA
  8467         MOVE +1                 TO CARRIERL
  8468                                    DATASORL
  8469         MOVE -1                 TO MAINTL
  8470         MOVE +6                 TO GROUPL
  8471         MOVE +2                 TO STATEL
  8472         MOVE +8                 TO DATEL
  8473         MOVE +10                TO ACCTL
  8474     ELSE
  8475         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  8476                 AND
  8477             PI-CARRIER GREATER THAN LOW-VALUES
  8478             MOVE '3'            TO DATASORI
  8479                                    PI-689-DATA-SOURCE
  8480             MOVE PI-CR-CARRIER  TO CARRIERI
  8481             MOVE PI-CR-GROUPING TO GROUPI
  8482             MOVE PI-CR-ACCOUNT  TO ACCTI
  8483             MOVE PI-CR-FIN-RESP TO RPERSONI
  8484             MOVE PI-CR-TYPE     TO TYPEI
  8485             MOVE AL-UANON       TO CARRIERA
  8486                                    GROUPA
  8487                                    ACCTA
  8488                                    DATASORA
  8489                                    RPERSONA
  8490                                    TYPEA
  8491             MOVE +1             TO CARRIERL
  8492                                    DATASORL
  8493                                    TYPEL
  8494             MOVE -1             TO MAINTL
  8495             MOVE +6             TO GROUPL
  8496             MOVE +10            TO ACCTL
  8497                                    RPERSONL
  8498         ELSE
  8499             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  8500                     AND
  8501                 PI-CARRIER GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 163
* EL689.cbl
  8502                 MOVE '2'        TO DATASORI
  8503                                    PI-689-DATA-SOURCE
  8504                 MOVE PI-CARRIER TO CARRIERI
  8505                 MOVE PI-GROUPING
  8506                                 TO GROUPI
  8507                 MOVE PI-STATE   TO STATEI
  8508                 MOVE PI-ACCOUNT TO ACCTI
  8509                 MOVE PI-CERT-PRIME
  8510                                 TO CERTI
  8511                 MOVE PI-CERT-SFX
  8512                                 TO SFXI
  8513                 MOVE PI-CERT-EFF-DT
  8514                                 TO DC-BIN-DATE-1
  8515                 MOVE ' '        TO DC-OPTION-CODE
  8516                 PERFORM 9500-LINK-DATE-CONVERT
  8517                     THRU 9500-EXIT
  8518                 MOVE DC-GREG-DATE-1-EDIT
  8519                                 TO DATEI
  8520                 MOVE AL-UANON   TO CARRIERA
  8521                                    GROUPA
  8522                                    STATEA
  8523                                    ACCTA
  8524                                    CERTA
  8525                                    SFXA
  8526                                    DATEA
  8527                                    ADDRSA
  8528                                    DATASORA
  8529                 MOVE +1         TO CARRIERL
  8530                                    SFXL
  8531                                    DATASORL
  8532                                    ADDRSL
  8533                 MOVE -1         TO MAINTL
  8534                 MOVE +6         TO GROUPL
  8535                 MOVE +2         TO STATEL
  8536                 MOVE +8         TO DATEL
  8537                 MOVE +10        TO ACCTL
  8538                                    CERTL.
  8539
  8540     IF PI-CREATE-LABELS
  8541         MOVE  AL-UANON          TO ADDRLBLA
  8542         MOVE  +1                TO ADDRLBLL.
  8543
  8544     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  8545                                    PI-689-LBL-OVERRIDE.
  8546
  8547     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
  8548     GO TO 8100-SEND-INITIAL-MAP.
  8549
  8550 0450-EXIT.
  8551      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 164
* EL689.cbl
  8553 0600-BYPASS-SCREEN-CNTL.
  8554***************************************************************
  8555*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  8556*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  8557*     PERFORMING ANY SCREEN IO.                               *
  8558***************************************************************
  8559
  8560
  8561* EXEC CICS HANDLE CONDITION
  8562*        PGMIDERR (9700-PGMID-ERROR)
  8563*        MAPFAIL  (0325-MAPFAIL)
  8564*        ERROR    (9800-ABEND)
  8565*    END-EXEC.
  8566*    MOVE '"$L?.                 ! % #00008476' TO DFHEIV0
  8567     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  8568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8569     MOVE X'2520233030303038343736' TO DFHEIV0(25:11)
  8570     CALL 'kxdfhei1' USING DFHEIV0
  8571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8572
  8573
  8574     MOVE LOW-VALUES             TO EL689AI.
  8575
  8576     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  8577
  8578     MOVE PI-689-FORM-NUMBER     TO FORMI.
  8579     MOVE +4                     TO FORML.
  8580
  8581     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  8582         MOVE PI-689-NUMBER-COPIES
  8583                                 TO COPIESI
  8584         MOVE +1                 TO COPIESL.
  8585
  8586     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  8587     MOVE +1                     TO ADDRSL.
  8588     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  8589     MOVE +1                     TO DATASORL.
  8590
  8591     IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  8592         MOVE PI-689-PRINT-RESTRICTION
  8593                                 TO PRTRESTI
  8594         MOVE +1                 TO PRTRESTL.
  8595
  8596     MOVE SPACES                 TO PI-689-PRINT-SW
  8597                                    PI-689-LBL-OVERRIDE.
  8598     MOVE ZEROS                  TO PI-TOTAL-LINES
  8599                                    PI-CURRENT-LINE
  8600                                    PI-TEMP-STOR-ITEMS
  8601                                    PI-UPDATE-SW
  8602                                    PI-689-ERROR
  8603                                    PI-689-NUMBER-LABEL-LINES
  8604                                    PI-689-NUMBER-TEXT-RECORDS.
  8605
  8606     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  8607         MOVE +4                 TO PRINTERL
  8608         MOVE PI-689-ALT-PRINTER-ID
  8609                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  8610
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 165
* EL689.cbl
  8611     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  8612
  8613     IF  PI-689-SOURCE-VARIABLE
  8614         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  8615
  8616     MOVE SPACES                 TO W-CNTL-KEY
  8617     MOVE LOW-VALUES             TO W-ACCT-KEY
  8618                                    W-CERT-KEY
  8619                                    W-CHEK-KEY
  8620                                    W-COMP-KEY
  8621                                    W-MAIL-KEY
  8622                                    W-PNDB-KEY
  8623                                    W-PNDB2-KEY
  8624                                    W-PYAJ-KEY.
  8625
  8626     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  8627     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  8628                                    W-CERT-COMPANY-CD
  8629                                    W-CHEK-COMPANY-CD
  8630                                    W-COMP-COMPANY-CD
  8631                                    W-MAIL-COMPANY-CD
  8632                                    W-PNDB-COMPANY-CD
  8633                                    W-PNDB2-COMPANY-CD
  8634                                    W-PYAJ-COMPANY-CD.
  8635
  8636     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  8637         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  8638                                    W-CERT-CARRIER
  8639                                    W-MAIL-CARRIER
  8640                                    W-CERT-CARRIER
  8641                                    W-COMP-CARRIER
  8642                                    W-CHEK-CARRIER
  8643                                    W-PNDB2-CARRIER
  8644                                    W-PYAJ-CARRIER.
  8645
  8646     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  8647         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  8648                                    W-CERT-GROUPING
  8649                                    W-CHEK-GROUPING
  8650                                    W-COMP-GROUPING
  8651                                    W-MAIL-GROUPING
  8652                                    W-PNDB2-GROUPING
  8653                                    W-PYAJ-GROUPING.
  8654
  8655     IF  PI-689-STATE GREATER THAN LOW-VALUES
  8656         MOVE PI-689-STATE       TO W-ACCT-STATE
  8657                                    W-CERT-STATE
  8658                                    W-CHEK-STATE
  8659                                    W-MAIL-STATE
  8660                                    W-PNDB2-STATE.
  8661
  8662     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  8663         IF PI-689-DATA-SOURCE = '3' OR '6'
  8664             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  8665                                    W-PYAJ-ACCOUNT
  8666         ELSE
  8667             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  8668                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 166
* EL689.cbl
  8669                                    W-CHEK-ACCOUNT
  8670                                    W-MAIL-ACCOUNT
  8671                                    W-PNDB2-ACCOUNT.
  8672
  8673     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  8674         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  8675                                    W-CHEK-EFF-DT
  8676                                    W-MAIL-EFF-DT
  8677                                    W-PNDB2-EFF-DT.
  8678
  8679     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  8680         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  8681                                    W-CHEK-CERT-PRIME
  8682                                    W-MAIL-CERT-PRIME
  8683                                    W-PNDB2-CERT-PRIME
  8684
  8685         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  8686             MOVE PI-689-CERT-SFX
  8687                                 TO W-CERT-CERT-SFX
  8688                                    W-CHEK-CERT-SFX
  8689                                    W-MAIL-CERT-SFX
  8690                                    W-PNDB2-CERT-SFX
  8691         ELSE
  8692             MOVE SPACES         TO W-CERT-CERT-SFX
  8693                                    W-CHEK-CERT-SFX
  8694                                    W-MAIL-CERT-SFX
  8695                                    W-PNDB2-CERT-SFX.
  8696
  8697     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  8698         IF PI-689-DATA-SOURCE = '3' OR '6'
  8699             MOVE PI-689-RESP-PERSON
  8700                                 TO W-COMP-RESP-PERSON
  8701                                    W-PYAJ-FIN-RESP.
  8702
  8703     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  8704         IF PI-689-DATA-SOURCE = '3' OR '6'
  8705             MOVE PI-689-TYPE    TO W-COMP-TYPE
  8706                                    W-PYAJ-RECORD-TYPE
  8707         ELSE
  8708             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  8709
  8710     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  8711         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  8712                                    W-PYAJ-FILE-SEQ-NO
  8713                                    W-CHEK-SEQ-NO.
  8714
  8715     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  8716         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  8717                                    W-PNDB2-ALT-CHG-SEQ-NO.
  8718
  8719     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  8720         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  8721
  8722     IF  PI-689-NO-ERRORS-DETECTED
  8723         PERFORM 2000-CREATE THRU 2000-EXIT
  8724         IF  NOT PI-689-FATAL-ERROR
  8725                 AND
  8726             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 167
* EL689.cbl
  8727             IF  PI-689-PRINT-ONLY
  8728                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  8729             ELSE
  8730                 IF  PI-689-PRINT-FIRST
  8731                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  8732                     IF  NOT PI-689-FATAL-ERROR
  8733                         IF  PI-689-ARCHIVE-LETTER
  8734                             PERFORM 5400-LETTER-RELEASE
  8735                                 THRU 5400-EXIT
  8736                         ELSE
  8737                             MOVE ER-7390
  8738                                 TO PI-689-ERROR
  8739                     ELSE
  8740                         NEXT SENTENCE
  8741                 ELSE
  8742                     IF  NOT PI-689-ARCHIVE-LETTER
  8743                         MOVE ER-7390
  8744                                 TO PI-689-ERROR
  8745                     ELSE
  8746                         PERFORM 5400-LETTER-RELEASE
  8747                             THRU 5400-EXIT
  8748                         IF  NOT PI-689-FATAL-ERROR
  8749                             IF  PI-689-PRINT-SECOND
  8750                                 PERFORM 7900-PRINT-LETTER-NOW
  8751                                     THRU 7900-EXIT.
  8752
  8753 0600-EXIT.
  8754     EXIT.
  8755
  8756 0620-RETURN-TO-CALLER.
  8757
  8758     MOVE PROGRAM-INTERFACE-BLOCK
  8759                                 TO DFHCOMMAREA.
  8760
  8761* EXEC CICS RETURN
  8762*    END-EXEC.
  8763*    MOVE '.(                    &   #00008668' TO DFHEIV0
  8764     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8765     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8766     MOVE X'2020233030303038363638' TO DFHEIV0(25:11)
  8767     CALL 'kxdfhei1' USING DFHEIV0,
  8768           DFHEIV99,
  8769           DFHEIV99,
  8770           DFHEIV99,
  8771           DFHEIV99,
  8772           DFHEIV99
  8773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8774
  8775
  8776 0700-GET-VARIABLE-LABEL.
  8777
  8778     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  8779         MOVE '(VARIABLE NOT PROVIDED)'
  8780                                 TO W-RC-TEXT (1)
  8781                                    W-VG-TEXT (48)
  8782         GO TO 0700-EXIT.
  8783
  8784     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 168
* EL689.cbl
  8785                                    W-VG-TEXT (48).
  8786     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  8787                                    W-VG-TEXT (49).
  8788     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  8789                                    W-VG-TEXT (50).
  8790     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  8791                                    W-VG-TEXT (51).
  8792     SET W-RG-NDX                TO +5.
  8793
  8794 0700-EXIT.
  8795     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 169
* EL689.cbl
  8797 0800-EDIT-KEY-FIELDS.
  8798***************************************************************
  8799*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
  8800*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
  8801*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
  8802*     PROCESSING.                                             *
  8803***************************************************************
  8804     MOVE SPACES                 TO W-CNTL-KEY
  8805     MOVE LOW-VALUES             TO W-ACCT-KEY
  8806                                    W-CERT-KEY
  8807                                    W-CHEK-KEY
  8808                                    W-COMP-KEY
  8809                                    W-MAIL-KEY
  8810                                    W-PNDB-KEY
  8811                                    W-PNDB2-KEY
  8812                                    W-PYAJ-KEY.
  8813
  8814     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  8815     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  8816                                    W-CERT-COMPANY-CD
  8817                                    W-CHEK-COMPANY-CD
  8818                                    W-COMP-COMPANY-CD
  8819                                    W-MAIL-COMPANY-CD
  8820                                    W-PNDB-COMPANY-CD
  8821                                    W-PNDB2-COMPANY-CD
  8822                                    W-PYAJ-COMPANY-CD.
  8823
  8824     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
  8825     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
  8826     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
  8827     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
  8828     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
  8829     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
  8830     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
  8831     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
  8832     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
  8833     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
  8834     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
  8835     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
  8836     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
  8837     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
  8838
  8839     IF  DATASORI NUMERIC
  8840         MOVE DATASORI           TO W-DATA-SOURCE
  8841                                    PI-689-DATA-SOURCE
  8842         GO TO 0800-SOURCE-ACCOUNT
  8843               0800-SOURCE-CERTIFICATE
  8844               0800-SOURCE-COMPENSATION
  8845               0800-SOURCE-PENDING
  8846               0800-SOURCE-CHEK
  8847               0800-SOURCE-PAYMENTS-ADJS
  8848                                 DEPENDING ON W-DATA-SOURCE.
  8849
  8850     IF  FORMI NOT EQUAL '9999'
  8851         MOVE ER-7365            TO EMI-ERROR
  8852         MOVE -1                 TO MAINTL
  8853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8854         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 170
* EL689.cbl
  8855
  8856     ELSE
  8857         GO TO 0800-EXIT.
  8858
  8859 0800-SOURCE-ACCOUNT.
  8860
  8861     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
  8862             OR
  8863         W-ACCT-CARRIER EQUAL LOW-VALUES
  8864             OR
  8865         W-ACCT-GROUPING EQUAL LOW-VALUES
  8866             OR
  8867         W-ACCT-STATE EQUAL LOW-VALUES
  8868             OR
  8869         W-ACCT-ACCOUNT EQUAL LOW-VALUES
  8870             OR
  8871         W-ACCT-EXP-DT EQUAL LOW-VALUES
  8872         MOVE ER-7376            TO EMI-ERROR
  8873         MOVE -1                 TO MAINTL
  8874         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8875
  8876     GO TO 0800-ERROR-TEST.
  8877
  8878 0800-SOURCE-CERTIFICATE.
  8879
  8880     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
  8881             OR
  8882         W-CERT-CARRIER EQUAL LOW-VALUES
  8883             OR
  8884         W-CERT-GROUPING EQUAL LOW-VALUES
  8885             OR
  8886         W-CERT-STATE EQUAL LOW-VALUES
  8887             OR
  8888         W-CERT-ACCOUNT EQUAL LOW-VALUES
  8889             OR
  8890         W-CERT-EFF-DT EQUAL LOW-VALUES
  8891             OR
  8892         W-CERT-CERT-NO EQUAL LOW-VALUES
  8893         MOVE ER-7377            TO EMI-ERROR
  8894         MOVE -1                 TO MAINTL
  8895         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8896
  8897     GO TO 0800-ERROR-TEST.
  8898
  8899 0800-SOURCE-COMPENSATION.
  8900
  8901     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
  8902             OR
  8903         W-COMP-CARRIER EQUAL LOW-VALUES
  8904             OR
  8905         W-COMP-GROUPING EQUAL LOW-VALUES
  8906             OR
  8907         W-COMP-RESP-PERSON EQUAL LOW-VALUES
  8908             OR
  8909         W-COMP-TYPE EQUAL LOW-VALUES
  8910             OR
  8911         (W-COMP-TYPE EQUAL 'A'
  8912                 AND
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 171
* EL689.cbl
  8913             W-COMP-ACCOUNT EQUAL LOW-VALUES)
  8914         MOVE ER-7378            TO EMI-ERROR
  8915         MOVE -1                 TO MAINTL
  8916         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8917
  8918     GO TO 0800-ERROR-TEST.
  8919
  8920 0800-SOURCE-PENDING.
  8921
  8922     IF  BENTRYL EQUAL ZEROS
  8923         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
  8924                 OR
  8925             W-PNDB2-CARRIER EQUAL LOW-VALUES
  8926                 OR
  8927             W-PNDB2-GROUPING EQUAL LOW-VALUES
  8928                 OR
  8929             W-PNDB2-STATE EQUAL LOW-VALUES
  8930                 OR
  8931             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
  8932                 OR
  8933             W-PNDB2-EFF-DT EQUAL LOW-VALUES
  8934                 OR
  8935             W-PNDB2-CERT-NO EQUAL LOW-VALUES
  8936                 OR
  8937             W-PNDB2-TYPE EQUAL LOW-VALUES
  8938                 OR
  8939             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
  8940             MOVE ER-7379        TO EMI-ERROR
  8941             MOVE -1             TO MAINTL
  8942             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8943         ELSE
  8944             NEXT SENTENCE
  8945     ELSE
  8946         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
  8947                 OR
  8948             W-PNDB-ENTRY EQUAL LOW-VALUES
  8949                 OR
  8950             W-PNDB-SEQ-NO EQUAL ZEROS
  8951             MOVE ER-7379        TO EMI-ERROR
  8952             MOVE -1             TO MAINTL
  8953             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8954
  8955     GO TO 0800-ERROR-TEST.
  8956
  8957 0800-SOURCE-CHEK.
  8958
  8959     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
  8960             OR
  8961         W-CHEK-CARRIER EQUAL LOW-VALUES
  8962             OR
  8963         W-CHEK-GROUPING EQUAL LOW-VALUES
  8964             OR
  8965         W-CHEK-STATE EQUAL LOW-VALUES
  8966             OR
  8967         W-CHEK-ACCOUNT EQUAL LOW-VALUES
  8968             OR
  8969         W-CHEK-EFF-DT EQUAL LOW-VALUES
  8970             OR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 172
* EL689.cbl
  8971         W-CHEK-CERT-NO EQUAL LOW-VALUES
  8972         MOVE ER-7381            TO EMI-ERROR
  8973         MOVE -1                 TO MAINTL
  8974         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8975
  8976     GO TO 0800-ERROR-TEST.
  8977
  8978 0800-SOURCE-PAYMENTS-ADJS.
  8979
  8980     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
  8981             OR
  8982         W-PYAJ-CARRIER EQUAL LOW-VALUES
  8983             OR
  8984         W-PYAJ-GROUPING EQUAL LOW-VALUES
  8985             OR
  8986         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
  8987             OR
  8988         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
  8989             OR
  8990         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
  8991         MOVE ER-7396            TO EMI-ERROR
  8992         MOVE -1                 TO MAINTL
  8993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8994
  8995     GO TO 0800-ERROR-TEST.
  8996
  8997 0800-ERROR-TEST.
  8998
  8999     IF  NOT EMI-NO-ERRORS
  9000         IF  EMI-ERROR EQUAL ER-7250
  9001             GO TO 0800-EXIT
  9002         ELSE
  9003             GO TO 8200-SEND-DATAONLY.
  9004
  9005 0800-EXIT.
  9006     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 173
* EL689.cbl
  9008 0900-EDIT-CARRIER.
  9009
  9010     IF  CARRIERL EQUAL ZEROES
  9011         MOVE LOW-VALUES         TO PI-689-CARRIER
  9012                                    W-ACCT-CARRIER
  9013                                    W-CERT-CARRIER
  9014                                    W-COMP-CARRIER
  9015                                    W-CHEK-CARRIER
  9016                                    W-MAIL-CARRIER
  9017                                    W-PNDB2-CARRIER
  9018                                    W-PYAJ-CARRIER
  9019     ELSE
  9020         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
  9021
  9022 0900-EXIT.
  9023     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 174
* EL689.cbl
  9025 0905-EDIT-GROUPING.
  9026
  9027     IF  GROUPL EQUAL ZEROES
  9028         MOVE LOW-VALUES         TO PI-689-GROUPING
  9029                                    W-ACCT-GROUPING
  9030                                    W-CERT-GROUPING
  9031                                    W-CHEK-GROUPING
  9032                                    W-COMP-GROUPING
  9033                                    W-MAIL-GROUPING
  9034                                    W-PNDB2-GROUPING
  9035                                    W-PYAJ-GROUPING
  9036     ELSE
  9037         MOVE AL-UANON           TO GROUPA
  9038         MOVE GROUPI             TO PI-689-GROUPING
  9039                                    W-ACCT-GROUPING
  9040                                    W-CERT-GROUPING
  9041                                    W-CHEK-GROUPING
  9042                                    W-COMP-GROUPING
  9043                                    W-MAIL-GROUPING
  9044                                    W-PNDB2-GROUPING
  9045                                    W-PYAJ-GROUPING.
  9046
  9047 0905-EXIT.
  9048     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 175
* EL689.cbl
  9050 0910-EDIT-STATE.
  9051
  9052     IF  STATEL EQUAL ZEROES
  9053         MOVE LOW-VALUES         TO PI-689-STATE
  9054                                    W-ACCT-STATE
  9055                                    W-CERT-STATE
  9056                                    W-CHEK-STATE
  9057                                    W-MAIL-STATE
  9058                                    W-PNDB2-STATE
  9059     ELSE
  9060         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
  9061
  9062 0910-EXIT.
  9063     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 176
* EL689.cbl
  9065 0915-EDIT-ACCOUNT.
  9066
  9067     IF  ACCTL EQUAL ZEROES
  9068         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9069                                    W-ACCT-ACCOUNT
  9070                                    W-CERT-ACCOUNT
  9071                                    W-CHEK-ACCOUNT
  9072                                    W-COMP-ACCOUNT
  9073                                    W-MAIL-ACCOUNT
  9074                                    W-PNDB2-ACCOUNT
  9075                                    W-PYAJ-ACCOUNT
  9076     ELSE
  9077         MOVE AL-UANON           TO ACCTA
  9078         MOVE ACCTI              TO PI-689-ACCOUNT
  9079                                    W-ACCT-ACCOUNT
  9080                                    W-CERT-ACCOUNT
  9081                                    W-CHEK-ACCOUNT
  9082                                    W-COMP-ACCOUNT
  9083                                    W-MAIL-ACCOUNT
  9084                                    W-PYAJ-ACCOUNT
  9085                                    W-PNDB2-ACCOUNT.
  9086
  9087 0915-EXIT.
  9088     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 177
* EL689.cbl
  9090 0920-EDIT-EXP-DATE.
  9091
  9092     IF  DATEL NOT EQUAL ZEROS
  9093         IF  DATEI EQUAL '99/99/99' OR '999999'
  9094             MOVE '99/99/99'     TO DATEO
  9095                                    PI-689-DATE-EDIT
  9096             MOVE AL-UANON       TO DATEA
  9097             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
  9098                                    W-ACCT-EXP-DT
  9099         ELSE
  9100             MOVE DATEI          TO W-DEEDIT-FIELD
  9101             PERFORM 8600-DEEDIT
  9102             MOVE W-DEEDIT-FIELD-V0
  9103                                 TO DC-GREG-DATE-1-MDY
  9104             MOVE '4'            TO DC-OPTION-CODE
  9105             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9106             IF  DATE-CONVERSION-ERROR
  9107                 MOVE ER-0454    TO EMI-ERROR
  9108                 MOVE -1         TO DATEL
  9109                 MOVE AL-UABON   TO DATEA
  9110                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9111             ELSE
  9112                 MOVE DC-GREG-DATE-1-EDIT
  9113                                 TO DATEO
  9114                                    PI-689-DATE-EDIT
  9115                 MOVE AL-UANON   TO DATEA
  9116                 MOVE DC-BIN-DATE-1
  9117                                 TO PI-689-EXP-DATE
  9118                                    W-ACCT-EXP-DT
  9119     ELSE
  9120         MOVE LOW-VALUES         TO PI-689-EXP-DATE
  9121                                    W-ACCT-EXP-DT
  9122                                    PI-689-DATE-EDIT.
  9123
  9124 0920-EXIT.
  9125     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 178
* EL689.cbl
  9127 0925-EDIT-EFF-DATE.
  9128
  9129     IF  CERTL EQUAL ZERO
  9130             AND
  9131         DATASORI NOT EQUAL '2'
  9132         GO TO 0925-EXIT.
  9133
  9134     IF  DATEL NOT EQUAL ZEROS
  9135         MOVE DATEI              TO W-DEEDIT-FIELD
  9136         PERFORM 8600-DEEDIT
  9137         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9138         MOVE '4'                TO DC-OPTION-CODE
  9139         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9140
  9141         IF  DATE-CONVERSION-ERROR
  9142             MOVE ER-0215        TO EMI-ERROR
  9143             MOVE -1             TO DATEL
  9144             MOVE AL-UABON       TO DATEA
  9145             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9146         ELSE
  9147             MOVE DC-GREG-DATE-1-EDIT
  9148                                 TO DATEO
  9149                                    PI-689-DATE-EDIT
  9150             MOVE AL-UANON       TO DATEA
  9151             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
  9152                                    W-CERT-EFF-DT
  9153                                    W-CHEK-EFF-DT
  9154                                    W-MAIL-EFF-DT
  9155                                    W-PNDB2-EFF-DT
  9156     ELSE
  9157         MOVE LOW-VALUES         TO PI-689-EFF-DATE
  9158                                    W-PNDB2-EFF-DT
  9159                                    W-CHEK-EFF-DT
  9160                                    W-MAIL-EFF-DT
  9161                                    W-CERT-EFF-DT
  9162                                    PI-689-DATE-EDIT.
  9163
  9164 0925-EXIT.
  9165     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 179
* EL689.cbl
  9167 0930-EDIT-CERTIFICATE.
  9168
  9169     IF  CERTL EQUAL ZEROES
  9170         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
  9171                                    W-CERT-CERT-PRIME
  9172                                    W-CHEK-CERT-PRIME
  9173                                    W-MAIL-CERT-PRIME
  9174                                    W-PNDB2-CERT-PRIME
  9175                                    PI-689-CERT-SFX
  9176                                    W-CERT-CERT-SFX
  9177                                    W-CHEK-CERT-SFX
  9178                                    W-MAIL-CERT-SFX
  9179                                    W-PNDB2-CERT-SFX
  9180     ELSE
  9181         MOVE AL-UANON           TO CERTA
  9182         MOVE CERTI              TO PI-689-CERT-PRIME
  9183                                    W-CERT-CERT-PRIME
  9184                                    W-CHEK-CERT-PRIME
  9185                                    W-MAIL-CERT-PRIME
  9186                                    W-PNDB2-CERT-PRIME
  9187         IF  SFXL EQUAL ZEROES
  9188                 OR
  9189             SFXI EQUAL LOW-VALUES
  9190             MOVE SPACES         TO PI-689-CERT-SFX
  9191                                    W-CERT-CERT-SFX
  9192                                    W-CHEK-CERT-SFX
  9193                                    W-MAIL-CERT-SFX
  9194                                    W-PNDB2-CERT-SFX
  9195         ELSE
  9196             MOVE AL-UANON       TO SFXA
  9197             MOVE SFXI           TO PI-689-CERT-SFX
  9198                                    W-CERT-CERT-SFX
  9199                                    W-CHEK-CERT-SFX
  9200                                    W-MAIL-CERT-SFX
  9201                                    W-PNDB2-CERT-SFX.
  9202
  9203 0930-EXIT.
  9204     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 180
* EL689.cbl
  9206 0935-EDIT-RESP-PERSON.
  9207
  9208     IF  RPERSONL EQUAL ZEROES
  9209         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
  9210                                    W-COMP-RESP-PERSON
  9211                                    W-PYAJ-FIN-RESP
  9212     ELSE
  9213         MOVE AL-UANON           TO RPERSONA
  9214         MOVE RPERSONI           TO PI-689-RESP-PERSON
  9215                                    W-PYAJ-FIN-RESP
  9216                                    W-COMP-RESP-PERSON.
  9217
  9218 0935-EXIT.
  9219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 181
* EL689.cbl
  9221 0940-EDIT-ACCOUNT.
  9222
  9223     IF  ACCTL EQUAL ZEROES
  9224         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9225                                    W-COMP-ACCOUNT
  9226                                    W-PYAJ-ACCOUNT
  9227     ELSE
  9228         MOVE AL-UANON           TO ACCTA
  9229         MOVE ACCTI              TO PI-689-ACCOUNT
  9230                                    W-PYAJ-ACCOUNT
  9231                                    W-COMP-ACCOUNT.
  9232
  9233 0940-EXIT.
  9234     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 182
* EL689.cbl
  9236 0945-EDIT-TYPE.
  9237
  9238     IF  TYPEL EQUAL ZEROES
  9239         MOVE LOW-VALUES         TO PI-689-TYPE
  9240                                    W-COMP-TYPE
  9241                                    W-PYAJ-RECORD-TYPE
  9242     ELSE
  9243         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9244         IF TYPEI = 'C' OR 'G' OR 'A'
  9245             MOVE AL-UANON       TO TYPEA
  9246             MOVE TYPEI          TO PI-689-TYPE
  9247                                    W-COMP-TYPE
  9248                                    W-PYAJ-RECORD-TYPE
  9249         ELSE
  9250             MOVE ER-7368        TO EMI-ERROR
  9251             MOVE -1             TO TYPEL
  9252             MOVE AL-UABON       TO TYPEA
  9253             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9254
  9255 0945-EXIT.
  9256     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 183
* EL689.cbl
  9258 0950-EDIT-ENTRY.
  9259
  9260     IF  BENTRYL EQUAL ZEROES
  9261         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
  9262                                    W-PNDB-ENTRY
  9263     ELSE
  9264         MOVE AL-UANON           TO BENTRYA
  9265         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
  9266                                    W-PNDB-ENTRY.
  9267
  9268 0950-EXIT.
  9269     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 184
* EL689.cbl
  9271 0955-EDIT-SEQUENCE.
  9272
  9273     IF  SEQL NOT EQUAL ZEROS
  9274         IF  SEQI NOT NUMERIC
  9275                 OR
  9276             SEQI EQUAL '0'
  9277             MOVE ER-7367        TO EMI-ERROR
  9278             MOVE -1             TO SEQL
  9279             MOVE AL-UABON       TO SEQA
  9280             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9281         ELSE
  9282             MOVE AL-UANON       TO SEQA
  9283             MOVE SEQI           TO PI-689-SEQ-NO
  9284                                    W-CHEK-SEQ-NO
  9285                                    W-PYAJ-FILE-SEQ-NO
  9286                                    W-PNDB-SEQ-NO
  9287                                    PI-689-SEQ-EDIT
  9288     ELSE
  9289         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
  9290
  9291 0955-EXIT.
  9292     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 185
* EL689.cbl
  9294 0960-EDIT-BATCH-SEQ.
  9295
  9296     IF  BCSEQL NOT EQUAL ZEROS
  9297         IF  BCSEQI NOT NUMERIC
  9298             MOVE ER-7368        TO EMI-ERROR
  9299             MOVE -1             TO BCSEQL
  9300             MOVE AL-UABON       TO BCSEQA
  9301             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9302         ELSE
  9303             MOVE AL-UANON       TO BCSEQA
  9304             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
  9305                                    W-PNDB-CHG-SEQ-NO
  9306                                    W-PNDB2-ALT-CHG-SEQ-NO
  9307                                    PI-689-BCSEQ-EDIT
  9308     ELSE
  9309         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
  9310
  9311 0960-EXIT.
  9312     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 186
* EL689.cbl
  9314 0965-EDIT-TYPE.
  9315
  9316     IF  TYPEL EQUAL ZEROES
  9317         MOVE LOW-VALUES         TO PI-689-TYPE
  9318                                    W-PNDB2-TYPE
  9319     ELSE
  9320         IF  DATASORI NOT EQUAL '4'
  9321             GO TO 0965-EXIT
  9322         ELSE
  9323             IF TYPEI = '0' OR '1' OR '2' OR '3'
  9324                 MOVE AL-UANON   TO TYPEA
  9325                 MOVE TYPEI      TO PI-689-TYPE
  9326                                    W-PNDB2-TYPE
  9327             ELSE
  9328                 MOVE ER-7370    TO EMI-ERROR
  9329                 MOVE -1         TO TYPEL
  9330                 MOVE AL-UABON   TO TYPEA
  9331                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9332
  9333 0965-EXIT.
  9334     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 187
* EL689.cbl
  9336 0990-CARRIER-VALIDITY-CHECK.
  9337
  9338     IF  CARRIERI EQUAL SPACES
  9339         GO TO 0990-EXIT.
  9340
  9341     MOVE SPACES                 TO W-CNTL-KEY.
  9342     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9343     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
  9344     MOVE CARRIERI               TO W-CNTL-GEN4.
  9345     MOVE +0                     TO W-CNTL-SEQ-NO.
  9346
  9347
  9348* EXEC CICS HANDLE CONDITION
  9349*        NOTFND  (0990-CARRIER-NOT-FOUND)
  9350*        NOTOPEN (8040-CNTL-NOT-OPEN)
  9351*    END-EXEC.
  9352*    MOVE '"$IJ                  ! & #00009242' TO DFHEIV0
  9353     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9355     MOVE X'2620233030303039323432' TO DFHEIV0(25:11)
  9356     CALL 'kxdfhei1' USING DFHEIV0
  9357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9358
  9359
  9360
  9361* EXEC CICS READ
  9362*        DATASET (W-CNTL-FILE-ID)
  9363*        SET     (ADDRESS OF CONTROL-FILE)
  9364*        RIDFLD  (W-CNTL-KEY)
  9365*    END-EXEC.
  9366*    MOVE '&"S        E          (   #00009247' TO DFHEIV0
  9367     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9369     MOVE X'2020233030303039323437' TO DFHEIV0(25:11)
  9370     CALL 'kxdfhei1' USING DFHEIV0,
  9371           W-CNTL-FILE-ID,
  9372           DFHEIV20,
  9373           DFHEIV99,
  9374           W-CNTL-KEY,
  9375           DFHEIV99,
  9376           DFHEIV99,
  9377           DFHEIV99
  9378     SET ADDRESS OF CONTROL-FILE TO
  9379         DFHEIV20
  9380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9381
  9382
  9383     IF  PI-NO-CARRIER-SECURITY
  9384             OR
  9385         PI-CARRIER-SECURITY EQUAL CARRIERI
  9386         MOVE AL-UANON           TO CARRIERA
  9387         MOVE CARRIERI           TO PI-689-CARRIER
  9388                                    W-ACCT-CARRIER
  9389                                    W-CERT-CARRIER
  9390                                    W-CHEK-CARRIER
  9391                                    W-COMP-CARRIER
  9392                                    W-MAIL-CARRIER
  9393                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 188
* EL689.cbl
  9394                                    W-PYAJ-CARRIER
  9395     ELSE
  9396         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  9397         MOVE ER-9095            TO EMI-ERROR
  9398         MOVE -1                 TO MAINTL
  9399         MOVE AL-UANON           TO MAINTA
  9400         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9401
  9402     GO TO 0990-EXIT.
  9403
  9404 0990-CARRIER-NOT-FOUND.
  9405
  9406     MOVE -1                     TO CARRIERL.
  9407     MOVE AL-UABON               TO CARRIERA.
  9408     MOVE ER-2208                TO EMI-ERROR.
  9409     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9410
  9411 0990-EXIT.
  9412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 189
* EL689.cbl
  9414 0994-STATE-VALIDITY-CHECK.
  9415
  9416     IF  STATEI EQUAL SPACES
  9417         GO TO 0994-EXIT.
  9418
  9419     MOVE SPACES                 TO W-CNTL-KEY.
  9420     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9421     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
  9422     MOVE STATEI                 TO W-CNTL-GEN1.
  9423     MOVE +0                     TO W-CNTL-SEQ-NO.
  9424
  9425
  9426* EXEC CICS HANDLE CONDITION
  9427*        NOTFND  (0994-STATE-NOT-FOUND)
  9428*        NOTOPEN (8040-CNTL-NOT-OPEN)
  9429*    END-EXEC.
  9430*    MOVE '"$IJ                  ! '' #00009295' TO DFHEIV0
  9431     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9433     MOVE X'2720233030303039323935' TO DFHEIV0(25:11)
  9434     CALL 'kxdfhei1' USING DFHEIV0
  9435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9436
  9437
  9438
  9439* EXEC CICS READ
  9440*        DATASET (W-CNTL-FILE-ID)
  9441*        SET     (ADDRESS OF CONTROL-FILE)
  9442*        RIDFLD  (W-CNTL-KEY)
  9443*    END-EXEC.
  9444*    MOVE '&"S        E          (   #00009300' TO DFHEIV0
  9445     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9446     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9447     MOVE X'2020233030303039333030' TO DFHEIV0(25:11)
  9448     CALL 'kxdfhei1' USING DFHEIV0,
  9449           W-CNTL-FILE-ID,
  9450           DFHEIV20,
  9451           DFHEIV99,
  9452           W-CNTL-KEY,
  9453           DFHEIV99,
  9454           DFHEIV99,
  9455           DFHEIV99
  9456     SET ADDRESS OF CONTROL-FILE TO
  9457         DFHEIV20
  9458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9459
  9460
  9461     MOVE AL-UANON               TO STATEA.
  9462     MOVE STATEI                 TO PI-689-STATE
  9463                                    W-ACCT-STATE
  9464                                    W-CERT-STATE
  9465                                    W-CHEK-STATE
  9466                                    W-MAIL-STATE
  9467                                    W-PNDB2-STATE.
  9468
  9469     GO TO 0994-EXIT.
  9470
  9471 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 190
* EL689.cbl
  9472
  9473     MOVE -1                     TO STATEL.
  9474     MOVE AL-UABON               TO STATEA.
  9475     MOVE ER-2209                TO EMI-ERROR.
  9476     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9477
  9478 0994-EXIT.
  9479     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 191
* EL689.cbl
  9481 1000-SHOW.
  9482***************************************************************
  9483*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
  9484*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
  9485*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
  9486*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
  9487***************************************************************
  9488
  9489     MOVE SPACES                 TO W-RECORD-TABLE.
  9490
  9491     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
  9492          MOVE PI-689-LBL-OVERRIDE
  9493                                 TO ADDRLBLI
  9494          MOVE +1                TO ADDRLBLL
  9495          MOVE AL-UANON          TO ADDRLBLA
  9496     ELSE
  9497          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
  9498          MOVE +1                TO ADDRLBLL
  9499          MOVE AL-UANON          TO ADDRLBLA.
  9500
  9501     IF  ARCHNUML EQUAL ZEROS
  9502         MOVE -1                 TO ARCHNUML
  9503         MOVE AL-UNBON           TO ARCHNUMA
  9504         MOVE ER-0174            TO EMI-ERROR
  9505         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9506         GO TO 8200-SEND-DATAONLY.
  9507
  9508     IF  ARCHNUMI NOT NUMERIC
  9509         MOVE -1                 TO ARCHNUML
  9510         MOVE AL-UNBON           TO ARCHNUMA
  9511         MOVE ER-0175            TO EMI-ERROR
  9512         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9513         GO TO 8200-SEND-DATAONLY.
  9514
  9515     IF  PI-SHOW-MODE
  9516
  9517         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
  9518             MOVE -1             TO MAINTL
  9519             GO TO 8200-SEND-DATAONLY
  9520         ELSE
  9521             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
  9522
  9523     MOVE +0                     TO W-ARCH-SEQ-NO
  9524                                    W-ARCT-SEQ-NO.
  9525     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
  9526                                    W-ARCT-COMPANY-CD.
  9527     MOVE ARCHNUMI               TO W-ARCH-NUMBER
  9528                                    W-ARCT-NUMBER
  9529                                    PI-689-ARCHIVE-NUMBER.
  9530     MOVE ' '                    TO W-ARCT-REC-TYPE.
  9531     MOVE '1'                    TO PI-ACTION.
  9532     MOVE SPACES                 TO PI-689-PRINT-SW
  9533                                    PI-689-FORM-NUMBER
  9534                                    W-DELETE-KEY.
  9535     SET W-RG-NDX                TO W-ZEROS.
  9536
  9537
  9538* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 192
* EL689.cbl
  9539*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  9540*         NOTFND     (1070-ARCH-NOT-FOUND)
  9541*         ENDFILE    (1070-ARCH-NOT-FOUND)
  9542*    END-EXEC.
  9543*    MOVE '"$JI''                 ! ( #00009382' TO DFHEIV0
  9544     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  9545     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9546     MOVE X'2820233030303039333832' TO DFHEIV0(25:11)
  9547     CALL 'kxdfhei1' USING DFHEIV0
  9548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9549
  9550
  9551
  9552* EXEC CICS READ
  9553*        DATASET (W-ARCH-FILE-ID)
  9554*        SET     (ADDRESS OF LETTER-ARCHIVE)
  9555*        RIDFLD  (W-ARCH-KEY)
  9556*    END-EXEC.
  9557*    MOVE '&"S        E          (   #00009388' TO DFHEIV0
  9558     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9560     MOVE X'2020233030303039333838' TO DFHEIV0(25:11)
  9561     CALL 'kxdfhei1' USING DFHEIV0,
  9562           W-ARCH-FILE-ID,
  9563           DFHEIV20,
  9564           DFHEIV99,
  9565           W-ARCH-KEY,
  9566           DFHEIV99,
  9567           DFHEIV99,
  9568           DFHEIV99
  9569     SET ADDRESS OF LETTER-ARCHIVE TO
  9570         DFHEIV20
  9571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9572
  9573
  9574     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
  9575
  9576
  9577* EXEC CICS HANDLE CONDITION
  9578*         NOTOPEN    (8015-ARCT-NOT-OPEN)
  9579*         NOTFND     (1020-ARCT-ENDBR)
  9580*         ENDFILE    (1020-ARCT-ENDBR)
  9581*    END-EXEC.
  9582*    MOVE '"$JI''                 ! ) #00009396' TO DFHEIV0
  9583     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  9584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9585     MOVE X'2920233030303039333936' TO DFHEIV0(25:11)
  9586     CALL 'kxdfhei1' USING DFHEIV0
  9587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9588
  9589
  9590 1005-START-BROWSE.
  9591
  9592
  9593* EXEC CICS STARTBR
  9594*         DATASET    (W-ARCT-FILE-ID)
  9595*         RIDFLD     (W-ARCT-KEY)
  9596*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 193
* EL689.cbl
  9597*    END-EXEC.
  9598     MOVE 0
  9599       TO DFHEIV11
  9600*    MOVE '&,         G          &   #00009404' TO DFHEIV0
  9601     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9602     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9603     MOVE X'2020233030303039343034' TO DFHEIV0(25:11)
  9604     CALL 'kxdfhei1' USING DFHEIV0,
  9605           W-ARCT-FILE-ID,
  9606           W-ARCT-KEY,
  9607           DFHEIV99,
  9608           DFHEIV11,
  9609           DFHEIV99
  9610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9611
  9612
  9613     MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
  9614
  9615 1010-READ-NEXT.
  9616
  9617
  9618* EXEC CICS READNEXT
  9619*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
  9620*         DATASET   (W-ARCT-FILE-ID)
  9621*         RIDFLD    (W-ARCT-KEY)
  9622*    END-EXEC.
  9623     MOVE 0
  9624       TO DFHEIV11
  9625*    MOVE '&.S                   )   #00009414' TO DFHEIV0
  9626     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9627     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9628     MOVE X'2020233030303039343134' TO DFHEIV0(25:11)
  9629     CALL 'kxdfhei1' USING DFHEIV0,
  9630           W-ARCT-FILE-ID,
  9631           DFHEIV20,
  9632           DFHEIV99,
  9633           W-ARCT-KEY,
  9634           DFHEIV99,
  9635           DFHEIV11,
  9636           DFHEIV99,
  9637           DFHEIV99
  9638     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  9639         DFHEIV20
  9640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9641
  9642
  9643     IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
  9644         IF  LT-ADDRESS-DATA
  9645             IF  PI-CREATE-LABELS  AND
  9646                 NOT PI-689-LABELS-OVERRIDEN
  9647                 PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
  9648                         VARYING
  9649                     LT-NDX FROM 1 BY 1
  9650                         UNTIL
  9651                     LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
  9652                 GO TO 1010-READ-NEXT
  9653             ELSE
  9654                 MOVE LT-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 194
* EL689.cbl
  9655                                 TO W-DELETE-KEY
  9656                 GO TO 1010-READ-NEXT
  9657         ELSE
  9658             PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
  9659                     VARYING
  9660                 LT-NDX FROM 1 BY 1
  9661                     UNTIL
  9662                 LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
  9663                     OR
  9664                 LT-NDX GREATER THAN +20
  9665             GO TO 1010-READ-NEXT.
  9666
  9667 1020-ARCT-ENDBR.
  9668
  9669     IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
  9670
  9671* EXEC CICS ENDBR
  9672*             DATASET   (W-ARCT-FILE-ID)
  9673*        END-EXEC.
  9674     MOVE 0
  9675       TO DFHEIV11
  9676*    MOVE '&2                    $   #00009447' TO DFHEIV0
  9677     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9678     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9679     MOVE X'2020233030303039343437' TO DFHEIV0(25:11)
  9680     CALL 'kxdfhei1' USING DFHEIV0,
  9681           W-ARCT-FILE-ID,
  9682           DFHEIV11,
  9683           DFHEIV99
  9684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9685
  9686
  9687     IF  W-RG-NDX EQUAL ZEROS
  9688         GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
  9689
  9690     IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
  9691             AND
  9692         PI-BYPASS-LABELS
  9693         MOVE W-DELETE-KEY       TO W-ARCT-KEY
  9694         PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
  9695         MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
  9696
  9697     SET PI-TOTAL-LINES          TO W-RG-NDX.
  9698     MOVE 1                      TO PI-CURRENT-LINE.
  9699     SET W-RG-NDX                TO +1.
  9700
  9701     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  9702             VARYING
  9703         W-SC-NDX FROM 1 BY 1
  9704             UNTIL
  9705         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  9706
  9707     MOVE -1                     TO MAINTL.
  9708     GO TO 8100-SEND-INITIAL-MAP.
  9709
  9710 1020-EXIT.
  9711     EXIT.
  9712
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 195
* EL689.cbl
  9713 1030-TEXT-BUILD.
  9714
  9715     SET W-RG-NDX UP BY 1.
  9716     MOVE LT-SKIP-CONTROL (LT-NDX)
  9717                                 TO W-PRINT-CONTROL.
  9718
  9719     IF  W-PRINT-CONTROL EQUAL 99
  9720         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
  9721         SET W-RG-NDX UP BY 1
  9722     ELSE
  9723         SET W-RG-NDX UP BY W-PRINT-CONTROL.
  9724
  9725     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
  9726     MOVE LT-SKIP-CONTROL (LT-NDX)
  9727                                 TO W-RC-PC (W-RG-NDX).
  9728     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
  9729
  9730 1030-EXIT.
  9731     EXIT.
  9732
  9733 1040-FORMAT-HEADER-DATA.
  9734
  9735     MOVE LA-ACCOUNT-A2          TO ACCTO.
  9736     MOVE LA-ADDR-SOURCE         TO ADDRSO.
  9737     MOVE LA-CARRIER-A2          TO CARRIERO.
  9738     MOVE LA-CERT-NO-A2          TO CERTO.
  9739     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
  9740     MOVE LA-DATA-SOURCE         TO DATASORO.
  9741
  9742     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
  9743         MOVE ZEROES             TO DATEO
  9744
  9745     ELSE
  9746         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
  9747         MOVE ' '                TO DC-OPTION-CODE
  9748         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9749         MOVE DC-GREG-DATE-1-EDIT
  9750                                 TO DATEO.
  9751
  9752     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
  9753         MOVE ZEROES             TO FOLLOWO
  9754     ELSE
  9755         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
  9756         MOVE ' '                TO DC-OPTION-CODE
  9757         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9758         MOVE DC-GREG-DATE-1-EDIT
  9759                                 TO FOLLOWO.
  9760
  9761     MOVE LA-FORM-A3             TO FORMO.
  9762     MOVE LA-GROUPING-A2         TO GROUPO.
  9763     MOVE LA-NO-OF-COPIES        TO COPIESO
  9764                                    PI-689-NUMBER-COPIES.
  9765
  9766     IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9767         MOVE LA-PRINT-RESTRICTION
  9768                                 TO PRTRESTO
  9769     ELSE
  9770         MOVE SPACES             TO PRTRESTO.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 196
* EL689.cbl
  9771
  9772     IF  LA-RESEND-DATE = LOW-VALUES
  9773         MOVE ZEROES             TO RESEND1O
  9774     ELSE
  9775         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
  9776         MOVE ' '                TO DC-OPTION-CODE
  9777         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9778         MOVE DC-GREG-DATE-1-EDIT
  9779                                 TO RESEND1O.
  9780
  9781     MOVE LA-STATE-A2            TO STATEO.
  9782
  9783     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
  9784
  9785 1040-EXIT.
  9786     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 197
* EL689.cbl
  9788 1050-MOVE-LABELS.
  9789
  9790     SET W-RG-NDX                TO LT-NDX.
  9791     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
  9792     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
  9793     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
  9794
  9795 1050-EXIT.
  9796     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 198
* EL689.cbl
  9798 1060-DELETE-ADDRESS-RECORD.
  9799
  9800
  9801* EXEC CICS DELETE
  9802*        DATASET (W-ARCT-FILE-ID)
  9803*        RIDFLD  (W-DELETE-KEY)
  9804*    END-EXEC.
  9805*    MOVE '&(  R                 &   #00009564' TO DFHEIV0
  9806     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  9807     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9808     MOVE X'2020233030303039353634' TO DFHEIV0(25:11)
  9809     CALL 'kxdfhei1' USING DFHEIV0,
  9810           W-ARCT-FILE-ID,
  9811           W-DELETE-KEY,
  9812           DFHEIV99,
  9813           DFHEIV99,
  9814           DFHEIV99
  9815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9816
  9817
  9818
  9819* EXEC CICS READ
  9820*        DATASET (W-ARCH-FILE-ID)
  9821*        SET     (ADDRESS OF LETTER-ARCHIVE)
  9822*        RIDFLD  (W-ARCH-KEY)
  9823*        UPDATE
  9824*    END-EXEC.
  9825*    MOVE '&"S        EU         (   #00009569' TO DFHEIV0
  9826     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9827     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9828     MOVE X'2020233030303039353639' TO DFHEIV0(25:11)
  9829     CALL 'kxdfhei1' USING DFHEIV0,
  9830           W-ARCH-FILE-ID,
  9831           DFHEIV20,
  9832           DFHEIV99,
  9833           W-ARCH-KEY,
  9834           DFHEIV99,
  9835           DFHEIV99,
  9836           DFHEIV99
  9837     SET ADDRESS OF LETTER-ARCHIVE TO
  9838         DFHEIV20
  9839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9840
  9841
  9842     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
  9843
  9844
  9845* EXEC CICS REWRITE
  9846*         FROM      (LETTER-ARCHIVE)
  9847*         DATASET   (W-ARCH-FILE-ID)
  9848*    END-EXEC.
  9849     MOVE LENGTH OF
  9850      LETTER-ARCHIVE
  9851       TO DFHEIV11
  9852*    MOVE '&& L                  %   #00009578' TO DFHEIV0
  9853     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9854     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9855     MOVE X'2020233030303039353738' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 199
* EL689.cbl
  9856     CALL 'kxdfhei1' USING DFHEIV0,
  9857           W-ARCH-FILE-ID,
  9858           LETTER-ARCHIVE,
  9859           DFHEIV11,
  9860           DFHEIV99
  9861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9862
  9863
  9864 1060-EXIT.
  9865     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 200
* EL689.cbl
  9867 1070-ARCH-NOT-FOUND.
  9868
  9869     MOVE ER-7371                TO EMI-ERROR.
  9870     MOVE -1                     TO ARCHNUML.
  9871     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9872     GO TO 8100-SEND-INITIAL-MAP.
  9873
  9874 1080-ARCHIVE-TEXT-NOT-FOUND.
  9875
  9876     MOVE ER-7372                TO EMI-ERROR.
  9877     MOVE -1                     TO ARCHNUML.
  9878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9879     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 201
* EL689.cbl
  9881 2000-CREATE.
  9882***************************************************************
  9883*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
  9884*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
  9885*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
  9886*    WILL BE DISPLAYED ON THE SCREEN.                         *
  9887*                                                             *
  9888***************************************************************
  9889
  9890***************************************************************
  9891*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
  9892*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
  9893*    THEN FORCE AN ERROR.                                     *
  9894***************************************************************
  9895
  9896     IF  PI-689-CREATE-NO-SCREENS
  9897         GO TO 2000-GET-TEXT.
  9898
  9899     IF  PI-CREATE-MODE
  9900         IF  PI-689-PRINT-PERFORMED
  9901                 AND
  9902             FORMI NOT EQUAL 9999
  9903             MOVE ER-0279    TO EMI-ERROR
  9904             MOVE -1         TO MAINTL
  9905             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9906             GO TO 8200-SEND-DATAONLY.
  9907
  9908     IF  ARCHNUML GREATER THAN ZEROS
  9909         MOVE ER-9320            TO EMI-ERROR
  9910         MOVE -1                 TO ARCHNUML
  9911         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9912         GO TO 8200-SEND-DATAONLY.
  9913
  9914***************************************************************
  9915*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
  9916*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
  9917***************************************************************
  9918
  9919     IF  FORMI EQUAL '9999'
  9920         MOVE 16                 TO PI-TOTAL-LINES
  9921         MOVE 1                  TO PI-CURRENT-LINE
  9922         MOVE SPACES             TO W-FILE-TABLE
  9923                                    W-LINE-CONTROL-RECORD
  9924                                    W-RECORD-TABLE
  9925                                    W-SINGLE-LINE
  9926                                    W-SQUEEZED-LINE
  9927                                    W-TS-WORK-AREA
  9928                                    W-TX-TABLE
  9929         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
  9930         MOVE '3'                TO PI-ACTION
  9931         MOVE FORMI              TO PI-689-FORM-NUMBER
  9932                                    PI-COMM-CONTROL
  9933         MOVE ZEROS              TO PI-UPDATE-SW
  9934         MOVE W-PGM-EL1042       TO W-CALL-PGM
  9935         GO TO 9400-XCTL.
  9936
  9937 2000-GET-TEXT.
  9938
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 202
* EL689.cbl
  9939     MOVE SPACES                 TO W-FILE-TABLE
  9940                                    W-LINE-CONTROL-RECORD
  9941                                    W-RECORD-TABLE
  9942                                    W-SINGLE-LINE
  9943                                    W-SQUEEZED-LINE
  9944                                    W-TS-WORK-AREA
  9945                                    W-TX-TABLE.
  9946     SET W-TG-NDX                TO +1
  9947     MOVE ZEROS                  TO W-INITIAL-COLUMN
  9948                                    W-LINE-COUNT
  9949                                    W-LINE-INDENT-1
  9950                                    W-LINE-INDENT-2
  9951                                    W-LINE-INDENT-3
  9952                                    W-LINE-INDENT-4
  9953                                    W-LINE-INDENT-5
  9954                                    W-PAGE
  9955                                    W-PARAGRAPH-INDENT
  9956                                    W-TOP-MARGIN
  9957                                    W-WORK-INDENT.
  9958     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9959     MOVE +70                    TO W-LAST-COLUMN.
  9960     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
  9961     MOVE +1                     TO W-START-COLUMN.
  9962     MOVE +71                    TO W-TOO-FAR.
  9963
  9964     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
  9965     MOVE FORMI                  TO W-TEXT-LETTER.
  9966     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
  9967     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
  9968
  9969
  9970* EXEC CICS HANDLE CONDITION
  9971*         NOTFND     (2001-NOT-FOUND)
  9972*         ENDFILE    (2001-NOT-FOUND)
  9973*         NOTOPEN    (8050-TEXT-NOT-OPEN)
  9974*    END-EXEC.
  9975*    MOVE '"$I''J                 ! * #00009688' TO DFHEIV0
  9976     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  9977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9978     MOVE X'2A20233030303039363838' TO DFHEIV0(25:11)
  9979     CALL 'kxdfhei1' USING DFHEIV0
  9980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9981
  9982
  9983
  9984* EXEC CICS STARTBR
  9985*         DATASET    (W-TEXT-FILE-ID)
  9986*         RIDFLD     (W-TEXT-KEY)
  9987*         GTEQ
  9988*    END-EXEC.
  9989     MOVE 0
  9990       TO DFHEIV11
  9991*    MOVE '&,         G          &   #00009694' TO DFHEIV0
  9992     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9993     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9994     MOVE X'2020233030303039363934' TO DFHEIV0(25:11)
  9995     CALL 'kxdfhei1' USING DFHEIV0,
  9996           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 203
* EL689.cbl
  9997           W-TEXT-KEY,
  9998           DFHEIV99,
  9999           DFHEIV11,
 10000           DFHEIV99
 10001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10002
 10003
 10004
 10005* EXEC CICS HANDLE CONDITION
 10006*         ENDFILE    (2000-ENDBR)
 10007*    END-EXEC.
 10008*    MOVE '"$''                   ! + #00009700' TO DFHEIV0
 10009     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 10010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10011     MOVE X'2B20233030303039373030' TO DFHEIV0(25:11)
 10012     CALL 'kxdfhei1' USING DFHEIV0
 10013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10014
 10015
 10016 2000-READ-NEXT.
 10017
 10018     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 10019         MOVE ER-0051            TO EMI-ERROR
 10020         MOVE -1                 TO MAINTL
 10021         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10022         GO TO 2000-ENDBR.
 10023
 10024
 10025* EXEC CICS READNEXT
 10026*         DATASET    (W-TEXT-FILE-ID)
 10027*         SET        (ADDRESS OF TEXT-FILES)
 10028*         RIDFLD     (W-TEXT-KEY)
 10029*    END-EXEC.
 10030     MOVE 0
 10031       TO DFHEIV11
 10032*    MOVE '&.S                   )   #00009712' TO DFHEIV0
 10033     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10034     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10035     MOVE X'2020233030303039373132' TO DFHEIV0(25:11)
 10036     CALL 'kxdfhei1' USING DFHEIV0,
 10037           W-TEXT-FILE-ID,
 10038           DFHEIV20,
 10039           DFHEIV99,
 10040           W-TEXT-KEY,
 10041           DFHEIV99,
 10042           DFHEIV11,
 10043           DFHEIV99,
 10044           DFHEIV99
 10045     SET ADDRESS OF TEXT-FILES TO
 10046         DFHEIV20
 10047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10048
 10049
 10050     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 10051         GO TO 2000-ENDBR.
 10052
 10053     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 10054
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 204
* EL689.cbl
 10055     MOVE TX-FORM-SQUEEZE-CONTROL
 10056                                 TO W-FORM-SQUEEZE-IND.
 10057
 10058     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 10059         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 10060
 10061     IF  TX-FORM-CONTROL-LINE
 10062         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 10063         GO TO 2000-READ-NEXT.
 10064
 10065     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 10066         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 10067         GO TO 2000-READ-NEXT.
 10068
 10069     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 10070     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 10071     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 10072     MOVE TX-LINE-SQUEEZE-CONTROL
 10073                                 TO W-TX-SC (W-TG-NDX).
 10074
 10075     SET W-TG-NDX UP BY 1.
 10076     GO TO 2000-READ-NEXT.
 10077
 10078 2000-ENDBR.
 10079
 10080
 10081* EXEC CICS ENDBR
 10082*        DATASET     (W-TEXT-FILE-ID)
 10083*    END-EXEC.
 10084     MOVE 0
 10085       TO DFHEIV11
 10086*    MOVE '&2                    $   #00009748' TO DFHEIV0
 10087     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10088     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10089     MOVE X'2020233030303039373438' TO DFHEIV0(25:11)
 10090     CALL 'kxdfhei1' USING DFHEIV0,
 10091           W-TEXT-FILE-ID,
 10092           DFHEIV11,
 10093           DFHEIV99
 10094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10095
 10096
 10097     IF  W-TEXT-BROWSE-NOT-STARTED
 10098         MOVE ER-0006            TO EMI-ERROR
 10099         MOVE -1                 TO FORML
 10100         MOVE AL-UABON           TO FORMA
 10101         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10102         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10103
 10104     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 10105     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 10106     MOVE 1                      TO PI-CURRENT-LINE.
 10107
 10108     IF  COPIESL NOT GREATER THAN ZEROS
 10109         MOVE +1                 TO COPIESI
 10110                                    PI-689-NUMBER-COPIES
 10111         MOVE +1                 TO COPIESL
 10112         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 205
* EL689.cbl
 10113
 10114***************************************************************
 10115*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 10116*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 10117***************************************************************
 10118
 10119     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 10120
 10121     IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 10122         IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 10123             MOVE ER-7243        TO EMI-ERROR
 10124             MOVE -1             TO PRTRESTL
 10125             MOVE AL-UABON       TO PRTRESTA
 10126             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10127
 10128     IF  PI-CREATE-LABELS AND
 10129         NOT  PI-689-LABELS-OVERRIDEN
 10130         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 10131         SET W-RG-NDX UP BY +1
 10132     ELSE
 10133         SET W-RG-NDX            TO +1.
 10134
 10135     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 10136     SET W-RG-NDX UP BY W-TOP-MARGIN.
 10137
 10138     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 10139
 10140     SET PI-TOTAL-LINES          TO W-RG-NDX.
 10141
 10142     IF  W-FIRST-BAD-VARIABLE-FOUND
 10143         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 10144         MOVE W-FIRST-BAD-VARIABLE
 10145                                 TO PI-CURRENT-LINE
 10146     ELSE
 10147         SET W-RG-NDX            TO 1.
 10148
 10149     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10150             VARYING
 10151         W-SC-NDX FROM 1 BY 1
 10152             UNTIL
 10153         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 10154     IF  PI-689-CREATE-NO-SCREENS
 10155         GO TO 2000-EXIT
 10156     ELSE
 10157         IF  W-FORM-CHANGED
 10158             MOVE '3'            TO PI-ACTION
 10159             MOVE -1             TO MAINTL
 10160             GO TO 8100-SEND-INITIAL-MAP
 10161         ELSE
 10162             MOVE '3'            TO PI-ACTION
 10163             MOVE -1             TO MAINTL
 10164             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10165
 10166 2000-EXIT.
 10167     EXIT.
 10168
 10169 2001-NOT-FOUND.
 10170
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 206
* EL689.cbl
 10171     MOVE ER-0006                TO EMI-ERROR.
 10172     MOVE -1                     TO FORML.
 10173     MOVE AL-UABON               TO FORMA.
 10174     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10175     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 207
* EL689.cbl
 10177 2100-PROCESS-FORM-CONTROL-LINE.
 10178
 10179     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 10180
 10181     IF  W-LC-LINE-WIDTH NUMERIC
 10182             AND
 10183         W-LC-LINE-WIDTH GREATER THAN ZEROS
 10184         COMPUTE W-INITIAL-COLUMN
 10185             = (70 - W-LC-LINE-WIDTH) / 2
 10186         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 10187         COMPUTE W-LAST-COLUMN ROUNDED
 10188             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 10189         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 10190     ELSE
 10191         MOVE 70                 TO W-LC-LINE-WIDTH.
 10192
 10193     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 10194             AND
 10195         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 10196         MOVE W-LC-PARAGRAPH-INDENT
 10197                                 TO W-PARAGRAPH-INDENT.
 10198
 10199     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 10200             AND
 10201         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 10202         MOVE W-LC-MAX-LINES-PER-PAGE
 10203                                 TO W-MAX-LINES-PER-PAGE.
 10204
 10205     IF  W-LC-LINE-ADJUST NUMERIC
 10206             AND
 10207         W-LC-LINE-ADJUST GREATER THAN ZEROS
 10208         COMPUTE W-TOTAL-LINE-LENGTH
 10209             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 10210         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 10211             ADD W-LC-LINE-ADJUST
 10212                                 TO W-INITIAL-COLUMN
 10213                                    W-LAST-COLUMN
 10214                                    W-START-COLUMN
 10215                                    W-TOO-FAR.
 10216
 10217     IF  W-LC-LINE-INDENT-1 NUMERIC
 10218             AND
 10219         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 10220         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 10221     ELSE
 10222         MOVE +0                 TO W-LINE-INDENT-1.
 10223
 10224     IF  W-LC-LINE-INDENT-2 NUMERIC
 10225             AND
 10226         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 10227         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 10228     ELSE
 10229         MOVE +0                 TO W-LINE-INDENT-2.
 10230
 10231     IF  W-LC-LINE-INDENT-3 NUMERIC
 10232             AND
 10233         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 10234         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 208
* EL689.cbl
 10235     ELSE
 10236         MOVE +0                 TO W-LINE-INDENT-3.
 10237
 10238     IF  W-LC-LINE-INDENT-4 NUMERIC
 10239             AND
 10240         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 10241         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 10242     ELSE
 10243         MOVE +0                 TO W-LINE-INDENT-4.
 10244
 10245     IF  W-LC-LINE-INDENT-5 NUMERIC
 10246             AND
 10247         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 10248         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 10249
 10250     ELSE
 10251         MOVE +0                 TO W-LINE-INDENT-5.
 10252
 10253     IF  W-LC-TOP-MARGIN NUMERIC
 10254         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 10255     ELSE
 10256         MOVE +0                 TO W-TOP-MARGIN.
 10257
 10258     IF W-LC-CASE-IND = 'Y' OR 'N'
 10259         NEXT SENTENCE
 10260     ELSE
 10261         MOVE PI-LOWER-CASE-LETTERS
 10262                                 TO W-LC-CASE-IND.
 10263
 10264 2100-EXIT.
 10265     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 209
* EL689.cbl
 10267 2150-PROCESS-Z-CONTROLS.
 10268
 10269     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 10270
 10271     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 10272        IF W-DAYS-TO-RESEND NUMERIC
 10273           IF W-DAYS-TO-RESEND > ZEROS
 10274              MOVE '6'           TO DC-OPTION-CODE
 10275              MOVE W-SAVE-BIN-DATE
 10276                                 TO DC-BIN-DATE-1
 10277              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 10278              MOVE W-DAYS-TO-RESEND
 10279                                 TO DC-ELAPSED-DAYS
 10280              PERFORM 9500-LINK-DATE-CONVERT
 10281                                 THRU 9500-EXIT
 10282              IF NO-CONVERSION-ERROR
 10283                 MOVE DC-BIN-DATE-2
 10284                                 TO PI-689-RESEND-DATE-1
 10285                 MOVE DC-GREG-DATE-1-EDIT
 10286                                 TO RESEND1O
 10287                                    PI-689-RESEND1-EDIT
 10288                 MOVE AL-UANON
 10289                                 TO RESEND1A
 10290                 MOVE +8         TO RESEND1L
 10291              ELSE
 10292                 MOVE ER-3770
 10293                                 TO EMI-ERROR
 10294                 MOVE -1         TO MAINTL
 10295                 PERFORM 9900-ERROR-FORMAT
 10296                                 THRU 9900-EXIT
 10297                 GO TO 8200-SEND-DATAONLY
 10298              END-IF
 10299           END-IF
 10300        END-IF
 10301     END-IF
 10302     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 10303        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 10304     END-IF
 10305     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10306         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 10307             IF  W-DAYS-TO-FOLLOW-UP GREATER THAN ZEROS
 10308                 MOVE '6'        TO DC-OPTION-CODE
 10309                 MOVE W-SAVE-BIN-DATE
 10310                                 TO DC-BIN-DATE-1
 10311                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 10312                 MOVE W-DAYS-TO-FOLLOW-UP
 10313                                 TO DC-ELAPSED-DAYS
 10314                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10315                 IF  NO-CONVERSION-ERROR
 10316                     MOVE DC-BIN-DATE-2
 10317                                 TO PI-689-FOLLOW-UP-DATE
 10318                     MOVE DC-GREG-DATE-1-EDIT
 10319                                 TO FOLLOWO
 10320                     MOVE AL-UANON
 10321                                 TO FOLLOWA
 10322                     MOVE +8     TO FOLLOWL
 10323                 ELSE
 10324                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 210
* EL689.cbl
 10325                                 TO EMI-ERROR
 10326                     MOVE -1     TO MAINTL
 10327                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10328                     GO TO 8200-SEND-DATAONLY.
 10329
 10330     IF  COPIESI NOT NUMERIC
 10331             OR
 10332         COPIESI NOT GREATER THAN ZEROS
 10333         IF  W-NUMBER-OF-COPIES NUMERIC
 10334             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 10335                 MOVE W-NUMBER-OF-COPIES
 10336                                 TO COPIESI
 10337                                    PI-689-NUMBER-COPIES
 10338                 MOVE AL-UNNON   TO COPIESA
 10339                 MOVE +1         TO COPIESL
 10340             ELSE
 10341                 MOVE +1         TO COPIESI
 10342                                    PI-689-NUMBER-COPIES
 10343                 MOVE AL-UNNON   TO COPIESA
 10344                 MOVE +1         TO COPIESL
 10345         ELSE
 10346             MOVE +1             TO COPIESI
 10347                                    PI-689-NUMBER-COPIES
 10348             MOVE AL-UNNON       TO COPIESA
 10349             MOVE +1             TO COPIESL.
 10350
 10351*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 10352*                                       SPACES
 10353*        IF  W-PRINT-RESTRICTED
 10354*            MOVE W-PRINT-RESTRICTED-IND
 10355*                                TO PRTRESTI
 10356*                                   PI-689-PRINT-RESTRICTION
 10357*            MOVE AL-UANON       TO PRTRESTA
 10358*            MOVE +1             TO PRTRESTL.
 10359     .
 10360 2150-EXIT.
 10361     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 211
* EL689.cbl
 10363 2200-CHECK-FOR-VARIABLE.
 10364
 10365     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 10366         GO TO 2200-EXIT.
 10367
 10368     SET W-TX-NDX                TO +1.
 10369
 10370 2200-CONTINUE.
 10371
 10372     SEARCH W-TX-CHAR
 10373         VARYING
 10374             W-TX-NDX
 10375         AT END
 10376             GO TO 2200-EXIT
 10377         WHEN
 10378             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 10379             NEXT SENTENCE.
 10380
 10381     SET W-TX-NDX UP BY +1.
 10382
 10383     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 10384         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 10385         GO TO 2200-CONTINUE.
 10386
 10387 2200-EXIT.
 10388     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 212
* EL689.cbl
 10390 2220-BUILD-VARIABLE-NUMBER.
 10391
 10392     SET W-TX-NDX UP BY +1.
 10393     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 10394     SET W-TX-NDX UP BY +1.
 10395     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 10396     SET W-TX-NDX UP BY +1.
 10397     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 10398
 10399     IF  W-VAR-RELATIVE-NUM NUMERIC
 10400         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 10401         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 10402
 10403 2220-EXIT.
 10404     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 213
* EL689.cbl
 10406 4000-ROLL-PAGE.
 10407
 10408     IF  ENTERPFL NOT EQUAL ZEROS
 10409         MOVE -1                 TO ENTERPFL
 10410     ELSE
 10411         MOVE -1                 TO MAINTL.
 10412
 10413     IF  PI-TOTAL-LINES EQUAL 0
 10414         MOVE ER-0047            TO EMI-ERROR
 10415         MOVE -1                 TO MAINTL
 10416         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10417         GO TO 8200-SEND-DATAONLY.
 10418
 10419     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 10420         PI-CURRENT-LINE + W-ROLL-COUNTER.
 10421
 10422     IF  W-TEMP-CURRENT-LINE NEGATIVE
 10423             OR
 10424         W-TEMP-CURRENT-LINE EQUAL ZEROS
 10425         MOVE ER-0067            TO EMI-ERROR
 10426         MOVE -1                 TO MAINTL
 10427         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10428         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 10429
 10430     IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 10431             AND
 10432         (EIBAID EQUAL DFHPF1 OR DFHPF6)
 10433         MOVE ER-0066            TO EMI-ERROR
 10434         MOVE -1                 TO MAINTL
 10435         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10436         COMPUTE W-TEMP-CURRENT-LINE
 10437             = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 10438         IF  W-TEMP-CURRENT-LINE NEGATIVE
 10439                 OR
 10440             W-TEMP-CURRENT-LINE = ZEROS
 10441             MOVE 1 TO W-TEMP-CURRENT-LINE.
 10442
 10443     IF  EMI-ERROR NOT EQUAL ER-0191
 10444             AND
 10445         MAINTI NOT EQUAL 'S'
 10446         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 10447         PERFORM 4100-SET-NDX THRU 4100-EXIT
 10448         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10449                 VARYING
 10450             W-SC-NDX FROM 1 BY 1
 10451                 UNTIL
 10452             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10453
 10454     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 10455                         ER-0191
 10456         NEXT SENTENCE
 10457     ELSE
 10458         GO TO 8200-SEND-DATAONLY.
 10459
 10460     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 10461     SET W-RG-NDX                TO PI-CURRENT-LINE
 10462     MOVE LOW-VALUES             TO EL689RI
 10463*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 214
* EL689.cbl
 10464     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 10465     SET W-RG-NDX                TO PI-CURRENT-LINE
 10466     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10467             VARYING
 10468         W-SC-NDX FROM 1 BY 1
 10469             UNTIL
 10470         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 10471
 10472     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 215
* EL689.cbl
 10474 4100-SET-NDX.
 10475
 10476     IF  PI-CURRENT-LINE EQUAL 0
 10477         SET W-RG-NDX            TO 1
 10478     ELSE
 10479         SET W-RG-NDX            TO PI-CURRENT-LINE.
 10480
 10481 4100-EXIT.
 10482      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 216
* EL689.cbl
 10484 4200-UPDATE-TABLE-FROM-SCREEN.
 10485
 10486     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 10487         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 10488         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 10489             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 10490                 MOVE ER-0051    TO EMI-ERROR
 10491                 MOVE -1         TO MAINTL
 10492                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10493                 GO TO 8200-SEND-DATAONLY
 10494             ELSE
 10495                 MOVE W-SC-TEXT (W-SC-NDX)
 10496                                 TO W-RC-TEXT (W-RG-NDX)
 10497                 ADD 1           TO PI-TOTAL-LINES
 10498         ELSE
 10499             MOVE W-SC-TEXT (W-SC-NDX)
 10500                                 TO W-RC-TEXT (W-RG-NDX).
 10501
 10502     SET W-RG-NDX UP BY 1.
 10503
 10504 4200-EXIT.
 10505      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 217
* EL689.cbl
 10507 5000-EDIT-MODE.
 10508***************************************************************
 10509*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 10510*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 10511*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 10512***************************************************************
 10513
 10514     IF  PI-SHOW-MODE
 10515         MOVE ER-0188            TO EMI-ERROR
 10516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10517         MOVE -1                 TO MAINTL
 10518         MOVE AL-UABON           TO MAINTA
 10519         GO TO 8200-SEND-DATAONLY.
 10520
 10521     IF  PI-CURRENT-LINE EQUAL ZEROS
 10522         MOVE ER-0187            TO EMI-ERROR
 10523         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10524         MOVE -1                 TO MAINTL
 10525         GO TO 8200-SEND-DATAONLY.
 10526
 10527     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 10528     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 10529     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10530             VARYING
 10531         W-SC-NDX FROM 1 BY 1
 10532             UNTIL
 10533         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10534
 10535     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 10536
 10537     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 10538     MOVE ZEROS                  TO PI-UPDATE-SW.
 10539     MOVE '1'                    TO PI-ENTRY-CD-1.
 10540     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 10541     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 218
* EL689.cbl
 10543 5400-LETTER-RELEASE.
 10544***************************************************************
 10545*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 10546*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 10547*    THE ARCHIVE FILE.                                        *
 10548*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 10549*        1. CHECK SECURITY.                                   *
 10550*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 10551*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 10552*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 10553*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 10554*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 10555***************************************************************
 10556
 10557     IF  NOT MODIFY-CAP
 10558         MOVE ER-0070            TO EMI-ERROR
 10559         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10560         MOVE -1                 TO MAINTL
 10561         GO TO 8200-SEND-DATAONLY.
 10562
 10563     IF  PI-SHOW-MODE
 10564         MOVE ER-0188            TO EMI-ERROR
 10565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10566         MOVE -1                 TO MAINTL
 10567         MOVE AL-UABON           TO MAINTA
 10568         GO TO 8200-SEND-DATAONLY.
 10569
 10570     IF  ARCHNUML GREATER THAN ZEROS
 10571         MOVE ER-9320            TO EMI-ERROR
 10572         MOVE -1                 TO ARCHNUML
 10573         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10574         GO TO 8200-SEND-DATAONLY.
 10575
 10576     IF  PI-CURRENT-LINE EQUAL ZEROS
 10577         MOVE ER-0187            TO EMI-ERROR
 10578         MOVE -1                 TO MAINTL
 10579         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10580         GO TO 8200-SEND-DATAONLY.
 10581
 10582     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 10583     IF  NOT PI-689-CREATE-NO-SCREENS
 10584         PERFORM 4100-SET-NDX THRU 4100-EXIT
 10585         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10586                 VARYING
 10587             W-SC-NDX FROM 1 BY 1
 10588                 UNTIL
 10589             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 10590         IF  EMI-FATAL-CTR GREATER THAN ZEROS
 10591                 OR
 10592             PI-689-FATAL-ERROR
 10593             GO TO 8200-SEND-DATAONLY.
 10594
 10595     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 10596     PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 10597             VARYING
 10598         W-RVS-NDX FROM +1 BY +1
 10599             UNTIL
 10600         W-RVS-NDX > +36500
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 219
* EL689.cbl
 10601             OR
 10602         W-REMAINING-VAR-FOUND.
 10603
 10604     IF  NOT PI-689-CREATE-NO-SCREENS
 10605         IF  W-REMAINING-VAR-FOUND
 10606             GO TO 4000-ROLL-PAGE.
 10607
 10608     MOVE SPACES                 TO W-CNTL-KEY.
 10609     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10610     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 10611     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 10612
 10613
 10614* EXEC CICS HANDLE CONDITION
 10615*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 10616*         NOTFND     (5470-CNTL-NOT-FOUND)
 10617*    END-EXEC.
 10618*    MOVE '"$JI                  ! , #00010268' TO DFHEIV0
 10619     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10621     MOVE X'2C20233030303130323638' TO DFHEIV0(25:11)
 10622     CALL 'kxdfhei1' USING DFHEIV0
 10623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10624
 10625
 10626
 10627* EXEC CICS READ
 10628*         DATASET    (W-CNTL-FILE-ID)
 10629*         SET        (ADDRESS OF CONTROL-FILE)
 10630*         RIDFLD     (W-CNTL-KEY)
 10631*         UPDATE
 10632*    END-EXEC.
 10633*    MOVE '&"S        EU         (   #00010273' TO DFHEIV0
 10634     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10635     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10636     MOVE X'2020233030303130323733' TO DFHEIV0(25:11)
 10637     CALL 'kxdfhei1' USING DFHEIV0,
 10638           W-CNTL-FILE-ID,
 10639           DFHEIV20,
 10640           DFHEIV99,
 10641           W-CNTL-KEY,
 10642           DFHEIV99,
 10643           DFHEIV99,
 10644           DFHEIV99
 10645     SET ADDRESS OF CONTROL-FILE TO
 10646         DFHEIV20
 10647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10648
 10649
 10650     IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 10651         MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 10652                                    CF-CREDIT-START-ARCH-NUM.
 10653
 10654     ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 10655     MOVE CF-CREDIT-LAST-ARCH-NUM
 10656                                 TO W-ARCH-NUMBER
 10657                                    W-ARCT-NUMBER.
 10658
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 220
* EL689.cbl
 10659
 10660* EXEC CICS REWRITE
 10661*         FROM      (CONTROL-FILE)
 10662*         DATASET   (W-CNTL-FILE-ID)
 10663*    END-EXEC
 10664     MOVE LENGTH OF
 10665      CONTROL-FILE
 10666       TO DFHEIV11
 10667*    MOVE '&& L                  %   #00010289' TO DFHEIV0
 10668     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10669     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10670     MOVE X'2020233030303130323839' TO DFHEIV0(25:11)
 10671     CALL 'kxdfhei1' USING DFHEIV0,
 10672           W-CNTL-FILE-ID,
 10673           CONTROL-FILE,
 10674           DFHEIV11,
 10675           DFHEIV99
 10676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10677
 10678
 10679* EXEC CICS HANDLE CONDITION
 10680*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 10681*    END-EXEC.
 10682*    MOVE '"$J                   ! - #00010294' TO DFHEIV0
 10683     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
 10684     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10685     MOVE X'2D20233030303130323934' TO DFHEIV0(25:11)
 10686     CALL 'kxdfhei1' USING DFHEIV0
 10687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10688
 10689
 10690     IF  PI-689-CREATE-NO-SCREENS
 10691         IF  PI-689-GET-ARCH-MAIN
 10692
 10693* EXEC CICS GETMAIN
 10694*                 SET      (ADDRESS OF LETTER-ARCHIVE)
 10695*                 LENGTH   (W-ARCH-LENGTH)
 10696*            END-EXEC
 10697*    MOVE '," L                  $   #00010300' TO DFHEIV0
 10698     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10699     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10700     MOVE X'2020233030303130333030' TO DFHEIV0(25:11)
 10701     CALL 'kxdfhei1' USING DFHEIV0,
 10702           DFHEIV20,
 10703           W-ARCH-LENGTH,
 10704           DFHEIV99
 10705     SET ADDRESS OF LETTER-ARCHIVE TO
 10706         DFHEIV20
 10707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10708             SET LCP-WS-ADDR-PNTR TO ADDRESS OF LETTER-ARCHIVE
 10709             MOVE LCP-WS-ADDR-COMP TO PI-689-ARCH-POINTER
 10710         ELSE
 10711             MOVE PI-689-ARCH-POINTER
 10712                                 TO LCP-WS-ADDR-COMP
 10713             SET ADDRESS OF LETTER-ARCHIVE TO LCP-WS-ADDR-PNTR
 10714     ELSE
 10715
 10716* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 221
* EL689.cbl
 10717*             SET      (ADDRESS OF LETTER-ARCHIVE)
 10718*             LENGTH   (W-ARCH-LENGTH)
 10719*        END-EXEC.
 10720*    MOVE '," L                  $   #00010311' TO DFHEIV0
 10721     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10722     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10723     MOVE X'2020233030303130333131' TO DFHEIV0(25:11)
 10724     CALL 'kxdfhei1' USING DFHEIV0,
 10725           DFHEIV20,
 10726           W-ARCH-LENGTH,
 10727           DFHEIV99
 10728     SET ADDRESS OF LETTER-ARCHIVE TO
 10729         DFHEIV20
 10730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10731
 10732
 10733     MOVE SPACES                 TO LETTER-ARCHIVE.
 10734     MOVE 'LA'                   TO LA-RECORD-ID.
 10735     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 10736                                    LA-ARCHIVE-NO-A2
 10737                                    LA-ARCHIVE-NO-A3
 10738                                    LA-ARCHIVE-NO-A4
 10739                                    LA-ARCHIVE-NO-A5
 10740                                    LA-ARCHIVE-NO-A6
 10741                                    PI-689-ARCHIVE-NUMBER.
 10742     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 10743                                    LA-COMPANY-CD-A2
 10744                                    LA-COMPANY-CD-A3
 10745                                    LA-COMPANY-CD-A4
 10746                                    LA-COMPANY-CD-A5
 10747                                    LA-COMPANY-CD-A6.
 10748     MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 10749                                    LA-CARRIER-A3
 10750                                    LA-CARRIER-A4
 10751                                    LA-CARRIER-A5.
 10752     MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 10753     MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 10754                                    LA-GROUPING-A3
 10755                                    LA-GROUPING-A4
 10756                                    LA-GROUPING-A5.
 10757     MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 10758                                    LA-ACCOUNT-A3
 10759                                    LA-ACCOUNT-A4
 10760                                    LA-ACCOUNT-A5.
 10761     MOVE PI-689-STATE           TO LA-STATE-A2
 10762                                    LA-STATE-A3
 10763                                    LA-STATE-A4
 10764                                    LA-STATE-A5.
 10765
 10766     IF  PI-689-DATA-SOURCE EQUAL '3'
 10767             AND
 10768         PI-689-RESP-PERSON GREATER THAN SPACES
 10769         MOVE PI-689-RESP-PERSON
 10770                                 TO LA-RESP-PERSON-A2
 10771         MOVE PI-689-TYPE        TO LA-TYPE-A2
 10772     ELSE
 10773         IF  PI-689-CERT-PRIME GREATER THAN SPACES
 10774             MOVE PI-689-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 222
* EL689.cbl
 10775                                 TO LA-CERT-PRIME-A2
 10776             MOVE PI-689-CERT-SFX
 10777                                 TO LA-CERT-SUFFIX-A2
 10778         ELSE
 10779             MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 10780                                    LA-TYPE-A2.
 10781
 10782     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 10783         MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 10784         IF  PI-689-CONTROL GREATER THAN ZEROS
 10785                 AND
 10786             PI-689-PRINT-RESTRICTION EQUAL 'C'
 10787             MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 10788             MOVE 'CK'           TO LA-FILLER
 10789         ELSE
 10790             NEXT SENTENCE
 10791     ELSE
 10792         IF  PI-689-CONTROL GREATER THAN ZEROS
 10793             MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 10794             MOVE 'CK'           TO LA-FILLER
 10795         ELSE
 10796             MOVE LOW-VALUES     TO LA-ENTRY-A6.
 10797
 10798     MOVE ZEROS                  TO W-SEQ-CTR.
 10799
 10800     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
 10801
 10802     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 10803                                    LA-INITIAL-PRINT-DATE
 10804                                    LA-SENT-DATE
 10805                                    LA-REPLY-DATE.
 10806     MOVE 'A'                    TO LA-STATUS.
 10807
 10808     IF  PI-689-NUMBER-COPIES NOT NUMERIC
 10809             OR
 10810         PI-689-NUMBER-COPIES EQUAL ZEROS
 10811         MOVE  1                 TO LA-NO-OF-COPIES
 10812     ELSE
 10813         MOVE PI-689-NUMBER-COPIES
 10814                                 TO LA-NO-OF-COPIES.
 10815
 10816     MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 10817     MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 10818     MOVE PI-689-PRINT-RESTRICTION
 10819                                 TO LA-PRINT-RESTRICTION
 10820     MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 10821     MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 10822     MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 10823     MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 10824     MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 10825
 10826     IF  PI-689-PRINT-PERFORMED
 10827         MOVE SPACES             TO PI-689-PRINT-SW
 10828         MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 10829         IF  LA-RESEND-DATE = LOW-VALUES
 10830             MOVE 'C'            TO LA-STATUS.
 10831
 10832     MOVE PI-689-NUMBER-LABEL-LINES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 223
* EL689.cbl
 10833                                 TO LA-NUMBER-LABEL-LINES.
 10834     MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 10835
 10836     PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 10837
 10838     MOVE PI-689-NUMBER-TEXT-RECORDS
 10839                                 TO LA-NO-OF-TEXT-RECORDS.
 10840
 10841
 10842* EXEC CICS HANDLE CONDITION
 10843*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 10844*    END-EXEC.
 10845*    MOVE '"$%                   ! . #00010424' TO DFHEIV0
 10846     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10848     MOVE X'2E20233030303130343234' TO DFHEIV0(25:11)
 10849     CALL 'kxdfhei1' USING DFHEIV0
 10850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10851
 10852
 10853     PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 10854
 10855     IF  PI-689-CREATE-NO-SCREENS
 10856         GO TO 5400-END.
 10857
 10858     MOVE ER-0280                TO EMI-ERROR.
 10859     MOVE -1                     TO MAINTL.
 10860     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10861     MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 10862     MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 10863
 10864 5400-END.
 10865
 10866     MOVE '2'                    TO PI-ACTION.
 10867     MOVE ZEROS                  TO PI-TOTAL-LINES
 10868                                    PI-CURRENT-LINE.
 10869     MOVE SPACES                 TO PI-689-PRINT-SW
 10870                                    PI-689-FORM-NUMBER.
 10871
 10872     IF  PI-689-CREATE-NO-SCREENS
 10873         GO TO 5400-EXIT
 10874     ELSE
 10875         MOVE LOW-VALUES         TO EL689AI
 10876         MOVE -1                 TO MAINTL
 10877         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10878
 10879 5400-EXIT.
 10880     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 224
* EL689.cbl
 10882 5410-CREATE-TEXT-RECORDS.
 10883
 10884
 10885* EXEC CICS HANDLE CONDITION
 10886*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 10887*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 10888*    END-EXEC.
 10889*    MOVE '"$J%                  ! / #00010459' TO DFHEIV0
 10890     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 10891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10892     MOVE X'2F20233030303130343539' TO DFHEIV0(25:11)
 10893     CALL 'kxdfhei1' USING DFHEIV0
 10894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10895
 10896
 10897     IF  PI-689-CREATE-NO-SCREENS
 10898         IF  PI-689-GET-ARCT-MAIN
 10899
 10900* EXEC CICS GETMAIN
 10901*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10902*                 LENGTH   (W-ARCT-LENGTH)
 10903*            END-EXEC
 10904*    MOVE '," L                  $   #00010466' TO DFHEIV0
 10905     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10906     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10907     MOVE X'2020233030303130343636' TO DFHEIV0(25:11)
 10908     CALL 'kxdfhei1' USING DFHEIV0,
 10909           DFHEIV20,
 10910           W-ARCT-LENGTH,
 10911           DFHEIV99
 10912     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
 10913         DFHEIV20
 10914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10915             SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 10916                                     LETTER-ARCHIVE-TEXT
 10917             MOVE LCP-WS-ADDR-COMP
 10918                                 TO PI-689-ARCT-POINTER
 10919         ELSE
 10920             MOVE PI-689-ARCT-POINTER
 10921                                 TO LCP-WS-ADDR-COMP
 10922             SET ADDRESS OF LETTER-ARCHIVE-TEXT
 10923                                 TO LCP-WS-ADDR-PNTR
 10924     ELSE
 10925
 10926* EXEC CICS GETMAIN
 10927*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10928*             LENGTH   (W-ARCT-LENGTH)
 10929*        END-EXEC.
 10930*    MOVE '," L                  $   #00010480' TO DFHEIV0
 10931     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10932     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10933     MOVE X'2020233030303130343830' TO DFHEIV0(25:11)
 10934     CALL 'kxdfhei1' USING DFHEIV0,
 10935           DFHEIV20,
 10936           W-ARCT-LENGTH,
 10937           DFHEIV99
 10938     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
 10939         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 225
* EL689.cbl
 10940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10941
 10942
 10943     PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 10944
 10945     MOVE ZEROS                  TO W-SEQ-CTR
 10946
 10947     IF  PI-CREATE-LABELS AND
 10948         NOT PI-689-LABELS-OVERRIDEN
 10949         MOVE '1'                TO LT-RECORD-TYPE
 10950         MOVE +0                 TO LT-LINE-SEQ-NO
 10951         PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 10952                 VARYING
 10953             W-RG-NDX FROM 1 BY 1
 10954                 UNTIL
 10955             W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10956         PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 10957         PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 10958     ELSE
 10959         SET W-RG-NDX            TO +1.
 10960
 10961     SET LT-NDX                  TO W-ZEROS.
 10962
 10963     PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 10964             VARYING
 10965         W-RG-NDX FROM W-RG-NDX BY +1
 10966             UNTIL
 10967         W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 10968
 10969 5410-EXIT.
 10970     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 226
* EL689.cbl
 10972 5415-INITIALIZE-TEXT.
 10973
 10974     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 10975     MOVE 'LT'                   TO LT-RECORD-ID.
 10976
 10977     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 10978     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 10979
 10980     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 10981                                    LT-NUM-LINES-ON-RECORD.
 10982
 10983 5415-EXIT.
 10984     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 227
* EL689.cbl
 10986 5460-DUPLICATE-ARCHIVE-RCD.
 10987
 10988     IF  NOT PI-689-CREATE-NO-SCREENS
 10989
 10990* EXEC CICS SYNCPOINT ROLLBACK
 10991*        END-EXEC.
 10992*    MOVE '6"R                   !   #00010531' TO DFHEIV0
 10993     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10995     MOVE X'2020233030303130353331' TO DFHEIV0(25:11)
 10996     CALL 'kxdfhei1' USING DFHEIV0
 10997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10998
 10999
 11000     MOVE ER-9426                TO EMI-ERROR.
 11001     MOVE -1                     TO MAINTL.
 11002     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11003     GO TO 8200-SEND-DATAONLY.
 11004
 11005 5465-DUPLICATE-ARCH-TEXT.
 11006
 11007     IF  NOT PI-689-CREATE-NO-SCREENS
 11008
 11009* EXEC CICS SYNCPOINT ROLLBACK
 11010*        END-EXEC.
 11011*    MOVE '6"R                   !   #00010542' TO DFHEIV0
 11012     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11014     MOVE X'2020233030303130353432' TO DFHEIV0(25:11)
 11015     CALL 'kxdfhei1' USING DFHEIV0
 11016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11017
 11018
 11019     MOVE ER-7369                TO EMI-ERROR.
 11020     MOVE -1                     TO MAINTL.
 11021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11022     GO TO 8200-SEND-DATAONLY.
 11023
 11024 5470-CNTL-NOT-FOUND.
 11025
 11026     MOVE ER-9299                TO EMI-ERROR.
 11027     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11028     MOVE -1                     TO MAINTL.
 11029     MOVE AL-UANON               TO MAINTA.
 11030     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 228
* EL689.cbl
 11032 5500-FORMAT-TEXT.
 11033
 11034     SET LT-NDX UP BY +1.
 11035
 11036     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 11037         SET W-RG-NDX UP BY 1
 11038         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 11039         MOVE W-RC-TEXT (W-RG-NDX)
 11040                                 TO LT-TEXT-LINE (LT-NDX)
 11041     ELSE
 11042         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 11043             MOVE ZEROS          TO W-PRINT-CONTROL
 11044             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 11045                     VARYING
 11046                 W-RG-NDX FROM W-RG-NDX BY 1
 11047                     UNTIL
 11048                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11049                     OR
 11050                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 11051             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11052                 GO TO 5500-WRITE-TEST
 11053             ELSE
 11054                 MOVE W-PRINT-CONTROL
 11055                                 TO LT-SKIP-CONTROL (LT-NDX)
 11056                 MOVE W-RC-TEXT (W-RG-NDX)
 11057                                 TO LT-TEXT-LINE (LT-NDX)
 11058         ELSE
 11059             MOVE W-RC-TEXT (W-RG-NDX)
 11060                                 TO LT-TEXT-LINE (LT-NDX)
 11061             MOVE ZEROS          TO W-PRINT-CONTROL.
 11062
 11063     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 11064
 11065 5500-WRITE-TEST.
 11066
 11067     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 11068         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 11069             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11070             MOVE '2'            TO LT-RECORD-TYPE
 11071             ADD +1              TO W-SEQ-CTR
 11072             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11073             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11074         ELSE
 11075             NEXT SENTENCE
 11076     ELSE
 11077         IF  LT-NDX EQUAL +20
 11078             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11079             MOVE '2'            TO LT-RECORD-TYPE
 11080             ADD +1              TO W-SEQ-CTR
 11081             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11082             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11083             SET LT-NDX          TO W-ZEROS
 11084             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 11085
 11086 5500-EXIT.
 11087      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 229
* EL689.cbl
 11089 5505-FIND-USED-LINE.
 11090
 11091     ADD +1                      TO W-PRINT-CONTROL.
 11092
 11093 5505-EXIT.
 11094      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 230
* EL689.cbl
 11096 5600-FORMAT-ADDRESS-LINE.
 11097
 11098     SET LT-NDX                  TO W-RG-NDX.
 11099     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 11100
 11101 5600-EXIT.
 11102     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 231
* EL689.cbl
 11104 5650-WRITE-ARCHIVE.
 11105
 11106
 11107* EXEC CICS WRITE
 11108*         DATASET   (W-ARCH-FILE-ID)
 11109*         FROM      (LETTER-ARCHIVE)
 11110*         RIDFLD    (LA-CONTROL-PRIMARY)
 11111*    END-EXEC.
 11112     MOVE LENGTH OF
 11113      LETTER-ARCHIVE
 11114       TO DFHEIV11
 11115*    MOVE '&$ L                  ''   #00010632' TO DFHEIV0
 11116     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11117     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11118     MOVE X'2020233030303130363332' TO DFHEIV0(25:11)
 11119     CALL 'kxdfhei1' USING DFHEIV0,
 11120           W-ARCH-FILE-ID,
 11121           LETTER-ARCHIVE,
 11122           DFHEIV11,
 11123           LA-CONTROL-PRIMARY,
 11124           DFHEIV99,
 11125           DFHEIV99
 11126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11127
 11128
 11129 5650-EXIT.
 11130     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 232
* EL689.cbl
 11132 5655-WRITE-ARCHIVE-TEXT.
 11133
 11134
 11135* EXEC CICS WRITE
 11136*         DATASET   (W-ARCT-FILE-ID)
 11137*         FROM      (LETTER-ARCHIVE-TEXT)
 11138*         RIDFLD    (LT-CONTROL-PRIMARY)
 11139*    END-EXEC.
 11140     MOVE LENGTH OF
 11141      LETTER-ARCHIVE-TEXT
 11142       TO DFHEIV11
 11143*    MOVE '&$ L                  ''   #00010643' TO DFHEIV0
 11144     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11145     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11146     MOVE X'2020233030303130363433' TO DFHEIV0(25:11)
 11147     CALL 'kxdfhei1' USING DFHEIV0,
 11148           W-ARCT-FILE-ID,
 11149           LETTER-ARCHIVE-TEXT,
 11150           DFHEIV11,
 11151           LT-CONTROL-PRIMARY,
 11152           DFHEIV99,
 11153           DFHEIV99
 11154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11155
 11156
 11157 5655-EXIT.
 11158     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 233
* EL689.cbl
 11160 6000-RESOLVE-VARIABLES.
 11161***************************************************************
 11162*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 11163*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 11164*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 11165*    RESOLVE ALL OF THE SYMBOLS.                              *
 11166*                                                             *
 11167***************************************************************
 11168
 11169     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 11170     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 11171     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 11172     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 11173     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 11174*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 11175     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 11176     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 11177     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 11178     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 11179     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 11180     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 11181     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 11182     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 11183
 11184     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 11185
 11186 6000-EXIT.
 11187     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 234
* EL689.cbl
 11189 6200-GET-COMPANY-DATA.
 11190
 11191     IF  ADDRSI EQUAL '3'
 11192             AND
 11193         PI-CREATE-LABELS
 11194             AND
 11195         NOT PI-689-LABELS-OVERRIDEN
 11196         NEXT SENTENCE
 11197     ELSE
 11198         IF  W-FILE-NOT-USED (1)
 11199             GO TO 6200-EXIT.
 11200
 11201     MOVE SPACES                 TO W-CNTL-KEY.
 11202     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11203     MOVE +0                     TO W-CNTL-SEQ-NO.
 11204     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11205
 11206
 11207* EXEC CICS HANDLE CONDITION
 11208*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 11209*         NOTFND    (6200-CNTL1-NOT-FOUND)
 11210*    END-EXEC.
 11211*    MOVE '"$JI                  ! 0 #00010698' TO DFHEIV0
 11212     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11213     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11214     MOVE X'3020233030303130363938' TO DFHEIV0(25:11)
 11215     CALL 'kxdfhei1' USING DFHEIV0
 11216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11217
 11218
 11219
 11220* EXEC CICS READ
 11221*         DATASET   (W-CNTL-FILE-ID)
 11222*         SET       (ADDRESS OF CONTROL-FILE)
 11223*         RIDFLD    (W-CNTL-KEY)
 11224*    END-EXEC.
 11225*    MOVE '&"S        E          (   #00010703' TO DFHEIV0
 11226     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11227     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11228     MOVE X'2020233030303130373033' TO DFHEIV0(25:11)
 11229     CALL 'kxdfhei1' USING DFHEIV0,
 11230           W-CNTL-FILE-ID,
 11231           DFHEIV20,
 11232           DFHEIV99,
 11233           W-CNTL-KEY,
 11234           DFHEIV99,
 11235           DFHEIV99,
 11236           DFHEIV99
 11237     SET ADDRESS OF CONTROL-FILE TO
 11238         DFHEIV20
 11239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11240
 11241
 11242     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 11243     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 11244                                    W-VG-TEXT (25).
 11245     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 11246     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 235
* EL689.cbl
 11247     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 11248     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 11249
 11250     IF  CF-CL-CAN-POST-CODE
 11251         MOVE CF-CL-CANADIAN-POSTAL-CODE
 11252                                 TO W-CANADIAN-POSTAL-CODES
 11253         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 11254         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 11255         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 11256                                    W-LAB-CAN-FILLER (6)
 11257         GO TO 6200-CONTINUE.
 11258
 11259     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 11260         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 11261         MOVE SPACES             TO W-LABEL-ZIP (6)
 11262         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 11263
 11264         IF  W-WORK-ZIP4 GREATER THAN '0000'
 11265             MOVE '-'            TO W-LABEL-DASH (6)
 11266             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 11267             GO TO 6200-CONTINUE
 11268         ELSE
 11269             MOVE SPACES         TO W-LABEL-DASH (6)
 11270                                    W-LABEL-2ND-ZIP (6)
 11271             GO TO 6200-CONTINUE.
 11272
 11273     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11274         GO TO 6200-CONTINUE.
 11275
 11276     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 11277
 11278     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 11279         COMPUTE W-WORK-ZIP-NUMERIC
 11280             = W-WORK-ZIP-NUMERIC * 10000.
 11281
 11282     MOVE SPACES                 TO W-LABEL-ZIP (6).
 11283     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 11284
 11285     IF  W-WORK-ZIP4 GREATER THAN '0000'
 11286         MOVE '-'                TO W-LABEL-DASH (6)
 11287         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 11288         GO TO 6200-CONTINUE
 11289     ELSE
 11290         MOVE SPACES             TO W-LABEL-DASH (6)
 11291                                    W-LABEL-2ND-ZIP (6)
 11292         GO TO 6200-CONTINUE.
 11293
 11294 6200-CONTINUE.
 11295
 11296     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 11297
 11298     IF  ADDRSI EQUAL '3'
 11299             AND
 11300         PI-CREATE-LABELS
 11301             AND
 11302         NOT PI-689-LABELS-OVERRIDEN
 11303         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 11304         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 236
* EL689.cbl
 11305         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 11306         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 11307         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 11308         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 11309         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 11310         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11311         SET W-RG-NDX UP BY +1
 11312     ELSE
 11313         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 11314         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 11315         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 11316         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 11317         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 11318         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 11319
 11320     GO TO 6200-EXIT.
 11321
 11322 6200-CNTL1-NOT-FOUND.
 11323
 11324     MOVE ER-9299                TO EMI-ERROR.
 11325     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11326     MOVE -1                     TO ADDRSL.
 11327     MOVE AL-UANON               TO ADDRSA.
 11328     GO TO 8200-SEND-DATAONLY.
 11329
 11330 6200-EXIT.
 11331     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 237
* EL689.cbl
 11333 6250-GET-CNTL2-DATA.
 11334
 11335     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 11336         GO TO 6250-EXIT.
 11337
 11338     IF  W-FILE-NOT-USED (11)
 11339         GO TO 6250-EXIT.
 11340
 11341     MOVE SPACES                 TO W-CNTL-KEY.
 11342     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11343     MOVE +0                     TO W-CNTL-SEQ-NO.
 11344     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 11345     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 11346
 11347
 11348* EXEC CICS HANDLE CONDITION
 11349*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11350*         NOTFND     (6250-CNTL2-NOT-FOUND)
 11351*    END-EXEC.
 11352*    MOVE '"$JI                  ! 1 #00010814' TO DFHEIV0
 11353     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11355     MOVE X'3120233030303130383134' TO DFHEIV0(25:11)
 11356     CALL 'kxdfhei1' USING DFHEIV0
 11357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11358
 11359
 11360
 11361* EXEC CICS READ
 11362*         DATASET    (W-CNTL-FILE-ID)
 11363*         SET        (ADDRESS OF CONTROL-FILE)
 11364*         RIDFLD     (W-CNTL-KEY)
 11365*    END-EXEC.
 11366*    MOVE '&"S        E          (   #00010819' TO DFHEIV0
 11367     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11369     MOVE X'2020233030303130383139' TO DFHEIV0(25:11)
 11370     CALL 'kxdfhei1' USING DFHEIV0,
 11371           W-CNTL-FILE-ID,
 11372           DFHEIV20,
 11373           DFHEIV99,
 11374           W-CNTL-KEY,
 11375           DFHEIV99,
 11376           DFHEIV99,
 11377           DFHEIV99
 11378     SET ADDRESS OF CONTROL-FILE TO
 11379         DFHEIV20
 11380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11381
 11382
 11383     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 11384     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 11385     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 11386     GO TO 6250-EXIT.
 11387
 11388 6250-CNTL2-NOT-FOUND.
 11389
 11390     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 238
* EL689.cbl
 11391     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11392     MOVE -1                     TO MAINTL.
 11393     MOVE AL-UANON               TO MAINTA.
 11394     GO TO 8200-SEND-DATAONLY.
 11395
 11396 6250-EXIT.
 11397     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 239
* EL689.cbl
 11399 6300-GET-CARRIER-DATA.
 11400
 11401     IF  ADDRSI EQUAL '2'
 11402             AND
 11403         PI-CREATE-LABELS
 11404             AND
 11405         NOT PI-689-LABELS-OVERRIDEN
 11406         NEXT SENTENCE
 11407     ELSE
 11408         IF  W-FILE-NOT-USED (4)
 11409             GO TO 6300-EXIT.
 11410
 11411     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 11412         MOVE SPACES             TO W-CNTL-KEY
 11413         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 11414         MOVE +0                 TO W-CNTL-SEQ-NO
 11415         MOVE '6'                TO W-CNTL-RECORD-TYPE
 11416         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 11417     ELSE
 11418         MOVE ER-9327            TO EMI-ERROR
 11419         MOVE -1                 TO CARRIERL
 11420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11421         GO TO 6300-EXIT.
 11422
 11423
 11424* EXEC CICS HANDLE CONDITION
 11425*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11426*         NOTFND     (6300-CNTL6-NOT-FOUND)
 11427*    END-EXEC.
 11428*    MOVE '"$JI                  ! 2 #00010865' TO DFHEIV0
 11429     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11431     MOVE X'3220233030303130383635' TO DFHEIV0(25:11)
 11432     CALL 'kxdfhei1' USING DFHEIV0
 11433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11434
 11435
 11436
 11437* EXEC CICS READ
 11438*         DATASET    (W-CNTL-FILE-ID)
 11439*         SET        (ADDRESS OF CONTROL-FILE)
 11440*         RIDFLD     (W-CNTL-KEY)
 11441*    END-EXEC.
 11442*    MOVE '&"S        E          (   #00010870' TO DFHEIV0
 11443     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11444     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11445     MOVE X'2020233030303130383730' TO DFHEIV0(25:11)
 11446     CALL 'kxdfhei1' USING DFHEIV0,
 11447           W-CNTL-FILE-ID,
 11448           DFHEIV20,
 11449           DFHEIV99,
 11450           W-CNTL-KEY,
 11451           DFHEIV99,
 11452           DFHEIV99,
 11453           DFHEIV99
 11454     SET ADDRESS OF CONTROL-FILE TO
 11455         DFHEIV20
 11456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 240
* EL689.cbl
 11457
 11458
 11459     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 11460     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 11461     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 11462     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 11463     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 11464     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 11465
 11466     IF  CF-CANADIAN-POST-CODE
 11467         MOVE CF-CANADIAN-POSTAL-CODE
 11468                                 TO W-CANADIAN-POSTAL-CODES
 11469         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 11470         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 11471         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 11472                                    W-LAB-CAN-FILLER (6)
 11473         GO TO 6300-CONTINUE.
 11474
 11475     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 11476         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 11477         MOVE SPACES             TO W-LABEL-ZIP (6)
 11478         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 11479         IF  W-WORK-ZIP4 GREATER THAN '0000'
 11480             MOVE '-'            TO W-LABEL-DASH (6)
 11481             MOVE W-WORK-ZIP4
 11482                                 TO W-LABEL-2ND-ZIP (6)
 11483             GO TO 6300-CONTINUE
 11484         ELSE
 11485             MOVE SPACES         TO W-LABEL-DASH (6)
 11486                                    W-LABEL-2ND-ZIP (6)
 11487             GO TO 6300-CONTINUE.
 11488
 11489     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 11490         GO TO 6300-CONTINUE.
 11491
 11492     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 11493
 11494     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 11495         COMPUTE W-WORK-ZIP-NUMERIC
 11496             = W-WORK-ZIP-NUMERIC * 10000.
 11497
 11498     MOVE SPACES                 TO W-LABEL-ZIP (6).
 11499     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 11500
 11501     IF  W-WORK-ZIP4 GREATER THAN '0000'
 11502         MOVE '-'                TO W-LABEL-DASH (6)
 11503         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 11504         GO TO 6300-CONTINUE
 11505     ELSE
 11506         MOVE SPACES             TO W-LABEL-DASH (6)
 11507                                    W-LABEL-2ND-ZIP (6)
 11508         GO TO 6300-CONTINUE.
 11509
 11510 6300-CONTINUE.
 11511
 11512     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 11513
 11514     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 241
* EL689.cbl
 11515             AND
 11516         PI-CREATE-LABELS
 11517             AND
 11518         NOT PI-689-LABELS-OVERRIDEN
 11519         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 11520         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 11521         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 11522         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 11523         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 11524         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 11525         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 11526         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11527         SET W-RG-NDX UP BY +1
 11528     ELSE
 11529         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 11530         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 11531         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 11532         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 11533         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 11534         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 11535
 11536     IF  W-FULL-DATA
 11537         MOVE ZEROS              TO W-PHONE-IN
 11538         MOVE CF-PHONE-NO        TO W-PHONE-IN
 11539         MOVE W-PHI-AREA         TO W-PO-AREA
 11540         MOVE W-PHI-PFX          TO W-PO-PFX
 11541         MOVE W-PHI-SFX          TO W-PO-SFX
 11542         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 11543
 11544     GO TO 6300-EXIT.
 11545
 11546 6300-CNTL6-NOT-FOUND.
 11547
 11548     MOVE ER-9298                TO EMI-ERROR.
 11549     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11550     MOVE -1                     TO ADDRSL.
 11551     MOVE AL-UANON               TO ADDRSA.
 11552     GO TO 8200-SEND-DATAONLY.
 11553
 11554 6300-EXIT.
 11555     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 242
* EL689.cbl
 11557 6350-GET-CSR-DATA.
 11558     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 11559        GO TO 6350-EXIT
 11560     END-IF
 11561*    IF W-FILE-NOT-USED (11)
 11562*       GO TO 6350-EXIT
 11563*    END-IF
 11564     MOVE SPACES                 TO W-CNTL-KEY
 11565     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 11566     MOVE +0                     TO W-CNTL-SEQ-NO
 11567     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 11568     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 11569
 11570* EXEC CICS HANDLE CONDITION
 11571*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11572*         NOTFND     (6350-CNTL2-NOT-FOUND)
 11573*    END-EXEC
 11574*    MOVE '"$JI                  ! 3 #00010986' TO DFHEIV0
 11575     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11577     MOVE X'3320233030303130393836' TO DFHEIV0(25:11)
 11578     CALL 'kxdfhei1' USING DFHEIV0
 11579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11580
 11581* EXEC CICS READ
 11582*         DATASET    (W-CNTL-FILE-ID)
 11583*         SET        (ADDRESS OF CONTROL-FILE)
 11584*         RIDFLD     (W-CNTL-KEY)
 11585*    END-EXEC
 11586*    MOVE '&"S        E          (   #00010990' TO DFHEIV0
 11587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11589     MOVE X'2020233030303130393930' TO DFHEIV0(25:11)
 11590     CALL 'kxdfhei1' USING DFHEIV0,
 11591           W-CNTL-FILE-ID,
 11592           DFHEIV20,
 11593           DFHEIV99,
 11594           W-CNTL-KEY,
 11595           DFHEIV99,
 11596           DFHEIV99,
 11597           DFHEIV99
 11598     SET ADDRESS OF CONTROL-FILE TO
 11599         DFHEIV20
 11600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11601     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 11602     GO TO 6350-EXIT
 11603     .
 11604 6350-CNTL2-NOT-FOUND.
 11605     MOVE ER-9299                TO EMI-ERROR.
 11606     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11607     MOVE -1                     TO MAINTL.
 11608     MOVE AL-UANON               TO MAINTA.
 11609     GO TO 8200-SEND-DATAONLY.
 11610 6350-EXIT.
 11611     EXIT.
 11612 6400-GET-PENDING-DATA.
 11613
 11614     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 243
* EL689.cbl
 11615        AND (PI-CREATE-LABELS)
 11616        AND (NOT PI-689-LABELS-OVERRIDEN)
 11617        CONTINUE
 11618     ELSE
 11619        IF PI-689-DATA-SOURCE = '4'
 11620           CONTINUE
 11621        ELSE
 11622           IF W-FILE-NOT-USED (9)
 11623              GO TO 6400-EXIT
 11624           END-IF
 11625        END-IF
 11626     END-IF
 11627     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 11628         MOVE ER-9327            TO EMI-ERROR
 11629         MOVE -1                 TO MAINTL
 11630         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11631         GO TO 6400-EXIT.
 11632
 11633 6400-READ-PNDB-ONLY.
 11634
 11635
 11636* EXEC CICS HANDLE CONDITION
 11637*         NOTOPEN (8060-PNDB-NOT-OPEN)
 11638*         NOTFND  (8070-PNDB-NOT-FOUND)
 11639*    END-EXEC.
 11640*    MOVE '"$JI                  ! 4 #00011029' TO DFHEIV0
 11641     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11643     MOVE X'3420233030303131303239' TO DFHEIV0(25:11)
 11644     CALL 'kxdfhei1' USING DFHEIV0
 11645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11646
 11647
 11648
 11649* EXEC CICS READ
 11650*         DATASET (W-PNDB-FILE-ID)
 11651*         SET     (ADDRESS OF PENDING-BUSINESS)
 11652*         RIDFLD  (W-PNDB-KEY)
 11653*    END-EXEC.
 11654*    MOVE '&"S        E          (   #00011034' TO DFHEIV0
 11655     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11657     MOVE X'2020233030303131303334' TO DFHEIV0(25:11)
 11658     CALL 'kxdfhei1' USING DFHEIV0,
 11659           W-PNDB-FILE-ID,
 11660           DFHEIV20,
 11661           DFHEIV99,
 11662           W-PNDB-KEY,
 11663           DFHEIV99,
 11664           DFHEIV99,
 11665           DFHEIV99
 11666     SET ADDRESS OF PENDING-BUSINESS TO
 11667         DFHEIV20
 11668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11669
 11670
 11671     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 11672
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 244
* EL689.cbl
 11673     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 11674         MOVE PB-SV-CARRIER      TO PB-CARRIER
 11675                                    PI-689-CARRIER
 11676         MOVE PB-SV-GROUPING     TO PB-GROUPING
 11677                                    PI-689-GROUPING
 11678         MOVE PB-SV-STATE        TO PB-STATE
 11679                                    PI-689-STATE
 11680         MOVE PB-CONTROL-BY-ACCOUNT
 11681                                 TO W-CERT-KEY
 11682                                    W-MAIL-KEY
 11683                                    W-ACCT-KEY
 11684         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 11685         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 11686         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 11687
 11688 6400-ONLY-STOP.
 11689
 11690     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 11691
 11692     IF  NOT PB-ISSUE
 11693         GO TO 6400-CANCEL.
 11694
 11695     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 11696     MOVE SPACES                 TO DC-OPTION-CODE.
 11697     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11698
 11699     IF  NO-CONVERSION-ERROR
 11700         MOVE DC-GREG-DATE-1-EDIT
 11701                                 TO W-VG-TEXT (110).
 11702
 11703     MOVE PB-I-AGE               TO W-EDIT-3-0.
 11704     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 11705     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 11706     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 11707     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 11708     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 11709     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 11710     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 11711     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 11712     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 11713     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 11714     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 11715     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 11716     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 11717     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 11718     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 11719     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 11720     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 11721     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 11722     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 11723
 11724     COMPUTE W-DIFFERENCE
 11725         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 11726
 11727     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11728     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 11729
 11730     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 245
* EL689.cbl
 11731         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 11732
 11733     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11734     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 11735
 11736 6400-CANCEL.
 11737
 11738     IF  NOT PB-CANCELLATION
 11739         GO TO 6400-EXIT.
 11740
 11741     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 11742                                 TO DC-BIN-DATE-1.
 11743     MOVE SPACES                 TO DC-OPTION-CODE.
 11744     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11745
 11746     IF  NO-CONVERSION-ERROR
 11747         MOVE DC-GREG-DATE-1-EDIT
 11748                                 TO W-VG-TEXT (117).
 11749
 11750     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 11751     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 11752     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 11753     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 11754     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 11755     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 11756     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 11757     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 11758     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 11759     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 11760
 11761     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 11762        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 11763     END-IF
 11764     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 11765     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 11766     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 11767     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 11768        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 11769     END-IF
 11770     MOVE SPACES                 TO DC-OPTION-CODE
 11771     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11772
 11773     IF NO-CONVERSION-ERROR
 11774        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 11775     END-IF
 11776
 11777     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 11778                           - PB-C-LF-CANCEL-AMT.
 11779
 11780     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11781     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 11782
 11783     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 11784                           - PB-C-AH-CANCEL-AMT.
 11785
 11786     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11787     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 11788
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 246
* EL689.cbl
 11789 6400-EXIT.
 11790     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 247
* EL689.cbl
 11792 6450-GET-CERT-DATA.
 11793     IF  W-FILE-NOT-USED (8)
 11794         GO TO 6450-EXIT.
 11795
 11796     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 11797         MOVE ER-9327            TO EMI-ERROR
 11798         MOVE -1                 TO MAINTL
 11799         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11800         GO TO 6450-EXIT.
 11801
 11802 6450-READ-CERT-ONLY.
 11803
 11804
 11805* EXEC CICS HANDLE CONDITION
 11806*         NOTOPEN (8030-CERT-NOT-OPEN)
 11807*         NOTFND  (8035-CERT-NOT-FOUND)
 11808*    END-EXEC.
 11809*    MOVE '"$JI                  ! 5 #00011173' TO DFHEIV0
 11810     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11811     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11812     MOVE X'3520233030303131313733' TO DFHEIV0(25:11)
 11813     CALL 'kxdfhei1' USING DFHEIV0
 11814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11815
 11816
 11817
 11818* EXEC CICS READ
 11819*         DATASET (W-CERT-FILE-ID)
 11820*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 11821*         RIDFLD  (W-CERT-KEY)
 11822*    END-EXEC.
 11823*    MOVE '&"S        E          (   #00011178' TO DFHEIV0
 11824     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11825     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11826     MOVE X'2020233030303131313738' TO DFHEIV0(25:11)
 11827     CALL 'kxdfhei1' USING DFHEIV0,
 11828           W-CERT-FILE-ID,
 11829           DFHEIV20,
 11830           DFHEIV99,
 11831           W-CERT-KEY,
 11832           DFHEIV99,
 11833           DFHEIV99,
 11834           DFHEIV99
 11835     SET ADDRESS OF CERTIFICATE-MASTER TO
 11836         DFHEIV20
 11837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11838
 11839
 11840     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 11841
 11842 6450-ONLY-STOP.
 11843
 11844     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 11845
 11846     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 11847
 11848     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11849     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 248
* EL689.cbl
 11850     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 11851     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11852     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 11853
 11854     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11855     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 11856     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 11857     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 11858     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 11859
 11860     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11861     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 11862     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 11863     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 11864     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11865     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 11866
 11867     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11868     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 11869     MOVE SPACES                 TO W-NAME-MIDDLE.
 11870     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11871     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 11872
 11873     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 11874     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 11875
 11876     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11877     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11878     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 11879     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11880     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 11881                                    W-LABEL-JOINT-NAME.
 11882
 11883     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11884     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11885     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 11886     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 11887     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 11888
 11889     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11890     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11891     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 11892     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 11893     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11894     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 11895
 11896     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11897     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11898     MOVE SPACES                 TO W-NAME-MIDDLE.
 11899     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11900     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 11901
 11902     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 11903     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 11904
 11905     COMPUTE W-WORK-AMOUNT
 11906         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 11907     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 249
* EL689.cbl
 11908     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 11909     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 11910     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 11911
 11912     IF  CM-SEX-FEMAL
 11913         MOVE 'MS.'              TO W-VG-TEXT (96)
 11914
 11915     ELSE
 11916         MOVE 'MR.'              TO W-VG-TEXT (96).
 11917
 11918     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 11919                                 TO W-VG-TEXT (70).
 11920     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 11921     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 11922     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 11923     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 11924     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 11925     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 11926     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 11927     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 11928     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 11929     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 11930     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 11931     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 11932     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 11933     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 11934     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 11935     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 11936     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 11937     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 11938     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 11939     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 11940     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 11941     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 11942     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 11943     IF PI-689-DATA-SOURCE NOT = '4'
 11944     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 11945        + CM-AH-ITD-CANCEL-AMT
 11946     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 11947     IF CM-NH-INT-ON-REFS NOT NUMERIC
 11948        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 11949     END-IF
 11950     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 11951     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 11952     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 11953     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 11954        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 11955     END-IF
 11956     MOVE SPACES                 TO DC-OPTION-CODE
 11957     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11958
 11959     IF NO-CONVERSION-ERROR
 11960        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 11961     END-IF
 11962     END-IF
 11963     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 11964     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 11965     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 250
* EL689.cbl
 11966
 11967     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 11968     MOVE SPACES                 TO DC-OPTION-CODE.
 11969     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11970
 11971     IF  NO-CONVERSION-ERROR
 11972         MOVE DC-GREG-DATE-1-EDIT
 11973                                 TO W-VG-TEXT (81).
 11974
 11975     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 11976     MOVE SPACES                 TO DC-OPTION-CODE.
 11977     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11978
 11979     IF  NO-CONVERSION-ERROR
 11980         MOVE DC-GREG-DATE-1-EDIT
 11981                                 TO W-VG-TEXT (82).
 11982
 11983     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11984     MOVE SPACES                 TO DC-OPTION-CODE.
 11985     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11986
 11987     IF  NO-CONVERSION-ERROR
 11988         MOVE DC-GREG-DATE-1-EDIT
 11989                                 TO W-VG-TEXT (74).
 11990
 11991     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 11992
 11993     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 11994         MOVE CM-PMT-EXTENSION-DAYS
 11995                                 TO DC-ELAPSED-DAYS
 11996     ELSE
 11997         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 11998
 11999     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12000     MOVE '6'                    TO DC-OPTION-CODE.
 12001     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12002
 12003     IF  NO-CONVERSION-ERROR
 12004         MOVE DC-GREG-DATE-1-EDIT
 12005                                 TO W-VG-TEXT (75).
 12006
 12007     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 12008     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12009     MOVE '6'                    TO DC-OPTION-CODE.
 12010     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12011
 12012     IF  NO-CONVERSION-ERROR
 12013         MOVE DC-GREG-DATE-1-EDIT
 12014                                 TO W-VG-TEXT (76).
 12015
 12016 6450-EXIT.
 12017     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 251
* EL689.cbl
 12019 6500-GET-ACCOUNT-DATA.
 12020
 12021     IF  ADDRSI EQUAL '1'
 12022             AND
 12023         PI-CREATE-LABELS
 12024             AND
 12025         NOT PI-689-LABELS-OVERRIDEN
 12026         NEXT SENTENCE
 12027     ELSE
 12028         IF  W-FILE-NOT-USED (6)
 12029             GO TO 6500-EXIT
 12030         END-IF
 12031     END-IF.
 12032
 12033 6500-READ-ACCT-ONLY.
 12034
 12035     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 12036         MOVE ER-9327            TO EMI-ERROR
 12037         MOVE -1                 TO MAINTL
 12038         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12039         GO TO 6500-EXIT.
 12040
 12041
 12042* EXEC CICS HANDLE CONDITION
 12043*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 12044*         NOTFND     (6500-ACCT-NOT-FOUND)
 12045*         ENDFILE    (6500-ONLY-STOP)
 12046*    END-EXEC.
 12047*    MOVE '"$JI''                 ! 6 #00011385' TO DFHEIV0
 12048     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 12049     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12050     MOVE X'3620233030303131333835' TO DFHEIV0(25:11)
 12051     CALL 'kxdfhei1' USING DFHEIV0
 12052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12053
 12054
 12055
 12056* EXEC CICS STARTBR
 12057*         RIDFLD     (W-ACCT-KEY)
 12058*         DATASET    (W-ACCT-FILE-ID)
 12059*         KEYLENGTH  (20)
 12060*         GENERIC
 12061*    END-EXEC.
 12062     MOVE 20
 12063       TO DFHEIV11
 12064     MOVE 0
 12065       TO DFHEIV12
 12066*    MOVE '&,   KG    G          &   #00011391' TO DFHEIV0
 12067     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 12068     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12069     MOVE X'2020233030303131333931' TO DFHEIV0(25:11)
 12070     CALL 'kxdfhei1' USING DFHEIV0,
 12071           W-ACCT-FILE-ID,
 12072           W-ACCT-KEY,
 12073           DFHEIV11,
 12074           DFHEIV12,
 12075           DFHEIV99
 12076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 252
* EL689.cbl
 12077
 12078
 12079     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 12080     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 12081
 12082 6500-READNEXT.
 12083
 12084
 12085* EXEC CICS READNEXT
 12086*         DATASET    (W-ACCT-FILE-ID)
 12087*         SET        (ADDRESS OF ACCOUNT-MASTER)
 12088*         RIDFLD     (W-ACCT-KEY)
 12089*    END-EXEC.
 12090     MOVE 0
 12091       TO DFHEIV11
 12092*    MOVE '&.S                   )   #00011403' TO DFHEIV0
 12093     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12094     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12095     MOVE X'2020233030303131343033' TO DFHEIV0(25:11)
 12096     CALL 'kxdfhei1' USING DFHEIV0,
 12097           W-ACCT-FILE-ID,
 12098           DFHEIV20,
 12099           DFHEIV99,
 12100           W-ACCT-KEY,
 12101           DFHEIV99,
 12102           DFHEIV11,
 12103           DFHEIV99,
 12104           DFHEIV99
 12105     SET ADDRESS OF ACCOUNT-MASTER TO
 12106         DFHEIV20
 12107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12108
 12109
 12110     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 12111         IF  PRIOR-MATCH-ACCT-PKEY
 12112             CONTINUE
 12113*            GO TO 6500-ONLY-STOP
 12114         ELSE
 12115             IF  W-FILE-NOT-USED (6)
 12116                 PERFORM 6500-ENDBR
 12117                 GO TO 6500-EXIT
 12118             ELSE
 12119                 GO TO 6500-ACCT-NOT-FOUND
 12120             END-IF
 12121         END-IF
 12122     ELSE
 12123         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 12124         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 12125         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 12126         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 12127         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 12128         MOVE AM-NAME              TO WS-SAV-AM-NAME
 12129         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 12130         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 12131         MOVE SPACES               TO WS-SAV-AM-CITY
 12132*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 12133         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 12134            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 253
* EL689.cbl
 12135         END-STRING
 12136         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 12137         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 12138         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 12139         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 12140         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 12141         GO TO 6500-READNEXT
 12142     END-IF
 12143     .
 12144 6500-ONLY-STOP.
 12145
 12146     IF  NOT PI-NO-CARRIER-SECURITY
 12147             AND
 12148         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 12149         MOVE -1                 TO CARRIERL
 12150         MOVE AL-UANON           TO CARRIERA
 12151         MOVE ER-9095            TO EMI-ERROR
 12152         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12153         PERFORM 6500-ENDBR
 12154         GO TO 8200-SEND-DATAONLY.
 12155
 12156     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12157     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 12158     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 12159     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 12160     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 12161
 12162     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 12163     MOVE SPACES                 TO W-LABEL-ZIP (5).
 12164
 12165     IF  SAVE-AM-CANADIAN-POST-CODE
 12166         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 12167                                 TO W-CANADIAN-POSTAL-CODES
 12168         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 12169         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 12170         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 12171                                    W-LAB-CAN-FILLER (5)
 12172     ELSE
 12173         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 12174
 12175         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12176             MOVE '-'            TO W-LABEL-DASH (5)
 12177             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 12178         ELSE
 12179             MOVE SPACES         TO W-LABEL-DASH (5)
 12180                                    W-LABEL-2ND-ZIP (5).
 12181
 12182     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12183
 12184     IF  ADDRSI EQUAL '1'
 12185             AND
 12186         PI-CREATE-LABELS
 12187             AND
 12188         NOT PI-689-LABELS-OVERRIDEN
 12189         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12190                                    W-VG-TEXT (40)
 12191         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12192                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 254
* EL689.cbl
 12193         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12194                                    W-VG-TEXT (42)
 12195         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12196                                    W-VG-TEXT (43)
 12197         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12198                                    W-VG-TEXT (44)
 12199         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12200                                    W-VG-TEXT (45)
 12201         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12202         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12203         SET W-RG-NDX UP BY +1
 12204     ELSE
 12205         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 12206         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 12207         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 12208         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 12209         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 12210         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 12211
 12212     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 12213             OR
 12214         WS-SAV-AM-TEL-NO EQUAL ZEROS
 12215         MOVE SPACES             TO W-VG-TEXT (46)
 12216     ELSE
 12217         MOVE ZEROS                  TO W-PHONE-IN
 12218         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 12219         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 12220         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 12221         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 12222
 12223     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 12224        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 12225     ELSE
 12226        MOVE SPACES                   TO W-VG-TEXT (47)
 12227     END-IF.
 12228     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 12229     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 12230                                 TO W-VG-TEXT (49)
 12231
 12232     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 12233     PERFORM 6500-ENDBR.
 12234
 12235     GO TO 6500-EXIT.
 12236
 12237 6500-ENDBR.
 12238
 12239     IF  W-ACCT-BROWSE-STARTED
 12240         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 12241
 12242* EXEC CICS ENDBR
 12243*            DATASET (W-ACCT-FILE-ID)
 12244*        END-EXEC
 12245     MOVE 0
 12246       TO DFHEIV11
 12247*    MOVE '&2                    $   #00011540' TO DFHEIV0
 12248     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12249     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12250     MOVE X'2020233030303131353430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 255
* EL689.cbl
 12251     CALL 'kxdfhei1' USING DFHEIV0,
 12252           W-ACCT-FILE-ID,
 12253           DFHEIV11,
 12254           DFHEIV99
 12255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12256     END-IF.
 12257
 12258 6500-ACCT-NOT-FOUND.
 12259
 12260     PERFORM 6500-ENDBR.
 12261
 12262     IF  DATASORI NOT EQUAL '1'
 12263         MOVE ER-0179            TO EMI-ERROR
 12264         GO TO 6500-EXIT.
 12265
 12266     MOVE ER-0179                TO EMI-ERROR.
 12267     MOVE -1                     TO MAINTL.
 12268     MOVE AL-UNBON               TO MAINTA.
 12269     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12270     GO TO 8200-SEND-DATAONLY.
 12271
 12272 6500-EXIT.
 12273     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 256
* EL689.cbl
 12275 6600-GET-COMPENSATION-DATA.
 12276
 12277     IF  ADDRSI EQUAL '4'
 12278             AND
 12279         PI-CREATE-LABELS
 12280             AND
 12281         NOT PI-689-LABELS-OVERRIDEN
 12282         NEXT SENTENCE
 12283     ELSE
 12284         IF  W-FILE-NOT-USED (10)
 12285             GO TO 6600-EXIT.
 12286
 12287     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 12288         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 12289         GO TO 6600-START.
 12290
 12291     IF  PI-ZERO-CARRIER
 12292             OR
 12293         PI-ZERO-CAR-GROUP
 12294         MOVE ZEROS              TO W-COMP-CARRIER.
 12295
 12296     IF  PI-ZERO-GROUPING
 12297             OR
 12298         PI-ZERO-CAR-GROUP
 12299         MOVE ZEROS              TO W-COMP-GROUPING.
 12300
 12301     IF  W-FILE-NOT-USED (6)
 12302         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 12303         IF  EMI-ERROR EQUAL ER-0179
 12304             MOVE ER-9327        TO EMI-ERROR
 12305             MOVE -1             TO MAINTL
 12306             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12307             GO TO 6600-EXIT.
 12308
 12309     MOVE  'A'                   TO W-COMP-TYPE.
 12310
 12311     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 12312         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 12313                                 TO W-COMP-RESP-PERSON
 12314     ELSE
 12315         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12316
 12317     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 12318        (W-NDX > +10)
 12319            OR
 12320         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F')
 12321     END-PERFORM
 12322
 12323     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F'
 12324         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 12325     ELSE
 12326         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12327
 12328     PERFORM 6500-ENDBR.
 12329     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 12330
 12331     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 12332         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 257
* EL689.cbl
 12333         MOVE -1                 TO MAINTL
 12334         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12335         GO TO 6600-EXIT.
 12336
 12337 6600-START.
 12338
 12339
 12340* EXEC CICS HANDLE CONDITION
 12341*         NOTOPEN (8080-COMP-NOT-OPEN)
 12342*         NOTFND  (6600-COMP-NOT-FOUND)
 12343*    END-EXEC.
 12344*    MOVE '"$JI                  ! 7 #00011626' TO DFHEIV0
 12345     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12346     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12347     MOVE X'3720233030303131363236' TO DFHEIV0(25:11)
 12348     CALL 'kxdfhei1' USING DFHEIV0
 12349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12350
 12351
 12352
 12353* EXEC CICS STARTBR
 12354*         RIDFLD  (W-COMP-KEY)
 12355*         DATASET (W-COMP-FILE-ID)
 12356*    END-EXEC.
 12357     MOVE 0
 12358       TO DFHEIV11
 12359*    MOVE '&,         G          &   #00011631' TO DFHEIV0
 12360     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12361     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12362     MOVE X'2020233030303131363331' TO DFHEIV0(25:11)
 12363     CALL 'kxdfhei1' USING DFHEIV0,
 12364           W-COMP-FILE-ID,
 12365           W-COMP-KEY,
 12366           DFHEIV99,
 12367           DFHEIV11,
 12368           DFHEIV99
 12369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12370
 12371
 12372     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 12373
 12374 6600-READNEXT.
 12375
 12376
 12377* EXEC CICS READNEXT
 12378*         DATASET (W-COMP-FILE-ID)
 12379*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12380*         RIDFLD  (W-COMP-KEY)
 12381*    END-EXEC.
 12382     MOVE 0
 12383       TO DFHEIV11
 12384*    MOVE '&.S                   )   #00011640' TO DFHEIV0
 12385     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12386     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12387     MOVE X'2020233030303131363430' TO DFHEIV0(25:11)
 12388     CALL 'kxdfhei1' USING DFHEIV0,
 12389           W-COMP-FILE-ID,
 12390           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 258
* EL689.cbl
 12391           DFHEIV99,
 12392           W-COMP-KEY,
 12393           DFHEIV99,
 12394           DFHEIV11,
 12395           DFHEIV99,
 12396           DFHEIV99
 12397     SET ADDRESS OF COMPENSATION-MASTER TO
 12398         DFHEIV20
 12399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12400
 12401
 12402     IF CO-CONTROL-PRIMARY
 12403           NOT = W-COMP-SAVE-KEY
 12404        GO TO 6600-COMP-NOT-FOUND.
 12405
 12406     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12407     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 12408                                    W-VG-TEXT (140).
 12409     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12410     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12411     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12412*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12413     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12414        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12415     END-STRING
 12416
 12417     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12418
 12419     IF  CO-CANADIAN-POST-CODE
 12420         MOVE CO-CANADIAN-POSTAL-CODE
 12421                                 TO W-CANADIAN-POSTAL-CODES
 12422         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12423         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12424         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12425                                    W-LAB-CAN-FILLER (6)
 12426     ELSE
 12427         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12428
 12429         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12430             MOVE '-'            TO W-LABEL-DASH (6)
 12431             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12432         ELSE
 12433             MOVE SPACES         TO W-LABEL-DASH (6)
 12434                                    W-LABEL-2ND-ZIP (6).
 12435
 12436     IF  CO-TELEPHONE NOT NUMERIC
 12437             OR
 12438         CO-TELEPHONE = ZEROS
 12439         MOVE SPACES             TO W-VG-TEXT (147)
 12440     ELSE
 12441         MOVE ZEROS              TO W-PHONE-IN
 12442         MOVE CO-AREA-CODE       TO W-PO-AREA
 12443         MOVE CO-PREFIX          TO W-PO-PFX
 12444         MOVE CO-PHONE           TO W-PO-SFX
 12445         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 12446
 12447     IF (CO-FAXNO NOT NUMERIC)
 12448        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 259
* EL689.cbl
 12449        MOVE SPACES              TO W-VG-TEXT (182)
 12450     ELSE
 12451        MOVE ZEROS               TO W-PHONE-IN
 12452        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 12453        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 12454        MOVE CO-FAX-PHONE        TO W-PO-SFX
 12455        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 12456     END-IF
 12457     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 12458        MOVE SPACES              TO W-VG-TEXT (183)
 12459     ELSE
 12460        EVALUATE CO-GA-STATUS-CODE
 12461           WHEN 'A'
 12462              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 12463           WHEN 'I'
 12464              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 12465           WHEN 'P'
 12466              MOVE 'PENDING'     TO W-VG-TEXT (183)
 12467        END-EVALUATE
 12468     END-IF
 12469     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 12470        MOVE SPACES              TO W-VG-TEXT (181)
 12471     ELSE
 12472        EVALUATE CO-BILL-SW
 12473           WHEN 'B'
 12474              MOVE 'BILLED'      TO W-VG-TEXT (181)
 12475           WHEN 'R'
 12476              MOVE 'REMIT'       TO W-VG-TEXT (181)
 12477           WHEN 'T'
 12478              MOVE 'T'           TO W-VG-TEXT (181)
 12479           WHEN 'S'
 12480              MOVE 'S'           TO W-VG-TEXT (181)
 12481        END-EVALUATE
 12482     END-IF
 12483     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12484
 12485     IF  ADDRSI EQUAL '4'
 12486             AND
 12487         PI-CREATE-LABELS
 12488             AND
 12489         NOT PI-689-LABELS-OVERRIDEN
 12490         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12491                                    W-VG-TEXT (141)
 12492         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12493                                    W-VG-TEXT (142)
 12494         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12495                                    W-VG-TEXT (143)
 12496         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12497                                    W-VG-TEXT (144)
 12498         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12499                                    W-VG-TEXT (145)
 12500         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12501                                    W-VG-TEXT (146)
 12502         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12503         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12504         SET W-RG-NDX UP BY +1
 12505     ELSE
 12506         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 260
* EL689.cbl
 12507         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 12508         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 12509         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 12510         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 12511         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 12512
 12513     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 12514
 12515     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 12516     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 12517     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 12518
 12519     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 12520     MOVE '3'                    TO DC-OPTION-CODE.
 12521     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12522
 12523     IF  NO-CONVERSION-ERROR
 12524         MOVE DC-GREG-DATE-1-ALPHA
 12525                                 TO W-VG-TEXT (149).
 12526
 12527     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 12528     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 12529
 12530     PERFORM 6600-ENDBR.
 12531     GO TO 6600-EXIT.
 12532
 12533 6600-ENDBR.
 12534
 12535     IF  W-COMP-BROWSE-STARTED
 12536         MOVE 'N'                      TO W-COMP-BROWSE-SW
 12537
 12538* EXEC CICS ENDBR
 12539*             DATASET(W-COMP-FILE-ID)
 12540*        END-EXEC.
 12541     MOVE 0
 12542       TO DFHEIV11
 12543*    MOVE '&2                    $   #00011781' TO DFHEIV0
 12544     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12545     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12546     MOVE X'2020233030303131373831' TO DFHEIV0(25:11)
 12547     CALL 'kxdfhei1' USING DFHEIV0,
 12548           W-COMP-FILE-ID,
 12549           DFHEIV11,
 12550           DFHEIV99
 12551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12552
 12553
 12554 6600-COMP-NOT-FOUND.
 12555
 12556     PERFORM 6600-ENDBR.
 12557
 12558     IF ADDRSL GREATER ZERO
 12559         IF ADDRSI = '4'
 12560            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 12561                MOVE ER-7378                TO EMI-ERROR
 12562                MOVE -1                     TO TYPEL
 12563                MOVE AL-UNBON               TO TYPEA
 12564                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 261
* EL689.cbl
 12565                GO TO 8200-SEND-DATAONLY
 12566            ELSE
 12567                MOVE ER-2114                TO EMI-ERROR
 12568                MOVE -1                     TO ADDRSL
 12569                MOVE AL-UNBON               TO ADDRSA
 12570                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12571                GO TO 8200-SEND-DATAONLY.
 12572
 12573 6600-EXIT.
 12574     EXIT.
 12575 6620-GET-G-DATA.
 12576
 12577     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 12578
 12579     IF  CO-RPTCD2 GREATER THAN SPACES
 12580         MOVE SPACES             TO W-COMP-RESP-PERSON
 12581         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 12582         MOVE +10                TO W-CWA-NDX
 12583         PERFORM 6622-FIND-LAST-NON-SPACE
 12584         SET W-COMP-NDX          TO +10
 12585         PERFORM 6625-FILL-IN-RESP-PERSON.
 12586         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 12587
 12588     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 12589     MOVE 'G'                    TO W-COMP-TYPE.
 12590     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 12591
 12592
 12593* EXEC CICS RESETBR
 12594*         RIDFLD  (W-COMP-KEY)
 12595*         DATASET (W-COMP-FILE-ID)
 12596*    END-EXEC.
 12597     MOVE 0
 12598       TO DFHEIV11
 12599*    MOVE '&4         G          &   #00011823' TO DFHEIV0
 12600     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 12601     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12602     MOVE X'2020233030303131383233' TO DFHEIV0(25:11)
 12603     CALL 'kxdfhei1' USING DFHEIV0,
 12604           W-COMP-FILE-ID,
 12605           W-COMP-KEY,
 12606           DFHEIV99,
 12607           DFHEIV11,
 12608           DFHEIV99
 12609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12610
 12611
 12612
 12613* EXEC CICS READNEXT
 12614*         DATASET (W-COMP-FILE-ID)
 12615*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12616*         RIDFLD  (W-COMP-KEY)
 12617*    END-EXEC.
 12618     MOVE 0
 12619       TO DFHEIV11
 12620*    MOVE '&.S                   )   #00011828' TO DFHEIV0
 12621     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12622     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 262
* EL689.cbl
 12623     MOVE X'2020233030303131383238' TO DFHEIV0(25:11)
 12624     CALL 'kxdfhei1' USING DFHEIV0,
 12625           W-COMP-FILE-ID,
 12626           DFHEIV20,
 12627           DFHEIV99,
 12628           W-COMP-KEY,
 12629           DFHEIV99,
 12630           DFHEIV11,
 12631           DFHEIV99,
 12632           DFHEIV99
 12633     SET ADDRESS OF COMPENSATION-MASTER TO
 12634         DFHEIV20
 12635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12636
 12637
 12638     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 12639         GO TO 6620-EXIT.
 12640
 12641     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12642     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 12643     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12644     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12645     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12646*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12647     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12648        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12649     END-STRING
 12650
 12651     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12652
 12653     IF  CO-CANADIAN-POST-CODE
 12654         MOVE CO-CANADIAN-POSTAL-CODE
 12655                                 TO W-CANADIAN-POSTAL-CODES
 12656         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12657         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12658         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12659                                    W-LAB-CAN-FILLER (6)
 12660     ELSE
 12661         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12662         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12663             MOVE '-'            TO W-LABEL-DASH (6)
 12664             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12665         ELSE
 12666             MOVE SPACES         TO W-LABEL-DASH (6)
 12667                                    W-LABEL-2ND-ZIP (6).
 12668
 12669     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12670
 12671     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 12672     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 12673     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 12674     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 12675     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 12676     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 12677
 12678 6620-EXIT.
 12679     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 263
* EL689.cbl
 12681 6622-FIND-LAST-NON-SPACE.
 12682
 12683     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 12684         SUBTRACT +1 FROM W-CWA-NDX
 12685         GO TO 6622-FIND-LAST-NON-SPACE.
 12686
 12687 6622-EXIT.
 12688     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 264
* EL689.cbl
 12690 6625-FILL-IN-RESP-PERSON.
 12691
 12692     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 12693     SET W-COMP-NDX DOWN BY +1.
 12694     SUBTRACT +1 FROM W-CWA-NDX.
 12695
 12696     IF  W-CWA-NDX GREATER THAN ZEROS
 12697         GO TO 6625-FILL-IN-RESP-PERSON.
 12698
 12699 6625-EXIT.
 12700     EXIT.
 12701 6626-GET-B-DATA.
 12702     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 12703     IF W-FILE-USED (8)
 12704        PERFORM 6450-READ-CERT-ONLY
 12705        IF W-CERT-FOUND
 12706           MOVE CM-BENEFICIARY (1:10)
 12707                                 TO W-COMP-RESP-PERSON
 12708        ELSE
 12709           MOVE SPACES           TO W-COMP-RESP-PERSON
 12710           GO TO 6626-EXIT
 12711        END-IF
 12712     ELSE
 12713        MOVE CM-BENEFICIARY (1:10)
 12714                                 TO W-COMP-RESP-PERSON
 12715     END-IF
 12716     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 12717     MOVE 'B'                    TO W-COMP-TYPE
 12718     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 12719
 12720
 12721* EXEC CICS RESETBR
 12722*         RIDFLD  (W-COMP-KEY)
 12723*         DATASET (W-COMP-FILE-ID)
 12724*    END-EXEC.
 12725     MOVE 0
 12726       TO DFHEIV11
 12727*    MOVE '&4         G          &   #00011916' TO DFHEIV0
 12728     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 12729     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12730     MOVE X'2020233030303131393136' TO DFHEIV0(25:11)
 12731     CALL 'kxdfhei1' USING DFHEIV0,
 12732           W-COMP-FILE-ID,
 12733           W-COMP-KEY,
 12734           DFHEIV99,
 12735           DFHEIV11,
 12736           DFHEIV99
 12737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12738
 12739
 12740
 12741* EXEC CICS READNEXT
 12742*         DATASET (W-COMP-FILE-ID)
 12743*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12744*         RIDFLD  (W-COMP-KEY)
 12745*    END-EXEC.
 12746     MOVE 0
 12747       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 265
* EL689.cbl
 12748*    MOVE '&.S                   )   #00011921' TO DFHEIV0
 12749     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12750     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12751     MOVE X'2020233030303131393231' TO DFHEIV0(25:11)
 12752     CALL 'kxdfhei1' USING DFHEIV0,
 12753           W-COMP-FILE-ID,
 12754           DFHEIV20,
 12755           DFHEIV99,
 12756           W-COMP-KEY,
 12757           DFHEIV99,
 12758           DFHEIV11,
 12759           DFHEIV99,
 12760           DFHEIV99
 12761     SET ADDRESS OF COMPENSATION-MASTER TO
 12762         DFHEIV20
 12763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12764
 12765
 12766     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 12767         GO TO 6626-EXIT.
 12768
 12769     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12770     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 12771     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12772     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12773     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12774*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12775     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12776        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12777     END-STRING
 12778
 12779     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12780
 12781     IF  CO-CANADIAN-POST-CODE
 12782         MOVE CO-CANADIAN-POSTAL-CODE
 12783                                 TO W-CANADIAN-POSTAL-CODES
 12784         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12785         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12786         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12787                                    W-LAB-CAN-FILLER (6)
 12788     ELSE
 12789         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12790         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12791             MOVE '-'            TO W-LABEL-DASH (6)
 12792             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12793         ELSE
 12794             MOVE SPACES         TO W-LABEL-DASH (6)
 12795                                    W-LABEL-2ND-ZIP (6).
 12796
 12797     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12798
 12799     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 12800     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 12801     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 12802     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 12803     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 12804     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 12805
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 266
* EL689.cbl
 12806 6626-EXIT.
 12807     EXIT.
 12808 6630-GET-CSR-NAME.
 12809
 12810     MOVE SPACES                 TO W-CNTL-KEY.
 12811     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12812     MOVE +0                     TO W-CNTL-SEQ-NO.
 12813     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 12814     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 12815
 12816
 12817* EXEC CICS HANDLE CONDITION
 12818*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12819*         NOTFND     (6630-CNTL2-NOT-FOUND)
 12820*    END-EXEC.
 12821*    MOVE '"$JI                  ! 8 #00011977' TO DFHEIV0
 12822     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12824     MOVE X'3820233030303131393737' TO DFHEIV0(25:11)
 12825     CALL 'kxdfhei1' USING DFHEIV0
 12826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12827
 12828
 12829
 12830* EXEC CICS READ
 12831*         DATASET    (W-CNTL-FILE-ID)
 12832*         SET        (ADDRESS OF CONTROL-FILE)
 12833*         RIDFLD     (W-CNTL-KEY)
 12834*    END-EXEC.
 12835*    MOVE '&"S        E          (   #00011982' TO DFHEIV0
 12836     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12837     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12838     MOVE X'2020233030303131393832' TO DFHEIV0(25:11)
 12839     CALL 'kxdfhei1' USING DFHEIV0,
 12840           W-CNTL-FILE-ID,
 12841           DFHEIV20,
 12842           DFHEIV99,
 12843           W-CNTL-KEY,
 12844           DFHEIV99,
 12845           DFHEIV99,
 12846           DFHEIV99
 12847     SET ADDRESS OF CONTROL-FILE TO
 12848         DFHEIV20
 12849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12850
 12851
 12852     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 12853     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 12854     GO TO 6630-EXIT.
 12855
 12856 6630-CNTL2-NOT-FOUND.
 12857
 12858*    MOVE ER-8965                TO EMI-ERROR.
 12859*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12860*    MOVE -1                     TO MAINTL.
 12861*    MOVE AL-UANON               TO MAINTA.
 12862*    GO TO 8200-SEND-DATAONLY
 12863     .
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 267
* EL689.cbl
 12864 6630-EXIT.
 12865     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 268
* EL689.cbl
 12867 6700-GET-MAIL-DATA.
 12868
 12869     IF  ADDRSI EQUAL '5'
 12870             AND
 12871         PI-CREATE-LABELS
 12872             AND
 12873         NOT PI-689-LABELS-OVERRIDEN
 12874         NEXT SENTENCE
 12875     ELSE
 12876         IF  W-FILE-NOT-USED (5)
 12877             GO TO 6700-EXIT.
 12878
 12879     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 12880         MOVE ER-9327            TO EMI-ERROR
 12881         MOVE -1                 TO MAINTL
 12882         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12883         GO TO 6700-EXIT.
 12884
 12885
 12886* EXEC CICS HANDLE CONDITION
 12887*         NOTOPEN (8090-MAIL-NOT-OPEN)
 12888*         NOTFND  (6700-MAIL-NOT-FOUND)
 12889*    END-EXEC.
 12890*    MOVE '"$JI                  ! 9 #00012021' TO DFHEIV0
 12891     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12893     MOVE X'3920233030303132303231' TO DFHEIV0(25:11)
 12894     CALL 'kxdfhei1' USING DFHEIV0
 12895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12896
 12897
 12898
 12899* EXEC CICS READ
 12900*         DATASET(W-MAIL-FILE-ID)
 12901*         SET    (ADDRESS OF MAILING-DATA)
 12902*         RIDFLD (W-MAIL-KEY)
 12903*    END-EXEC.
 12904*    MOVE '&"S        E          (   #00012026' TO DFHEIV0
 12905     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12906     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12907     MOVE X'2020233030303132303236' TO DFHEIV0(25:11)
 12908     CALL 'kxdfhei1' USING DFHEIV0,
 12909           W-MAIL-FILE-ID,
 12910           DFHEIV20,
 12911           DFHEIV99,
 12912           W-MAIL-KEY,
 12913           DFHEIV99,
 12914           DFHEIV99,
 12915           DFHEIV99
 12916     SET ADDRESS OF MAILING-DATA TO
 12917         DFHEIV20
 12918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12919
 12920
 12921     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 12922     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12923     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 12924     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 269
* EL689.cbl
 12925
 12926     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12927     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 12928     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 12929     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 12930     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 12931*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 12932     STRING MA-CITY ' ' MA-ADDR-STATE
 12933        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12934     END-STRING
 12935
 12936     MOVE MA-ZIP                 TO W-WORK-ZIP.
 12937     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12938
 12939     IF  MA-CANADIAN-POST-CODE
 12940         MOVE MA-CANADIAN-POSTAL-CODE
 12941                                 TO W-CANADIAN-POSTAL-CODES
 12942         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12943         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12944         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12945                                    W-LAB-CAN-FILLER (6)
 12946     ELSE
 12947         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12948         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12949             MOVE '-'            TO W-LABEL-DASH (6)
 12950             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12951         ELSE
 12952             MOVE SPACES         TO W-LABEL-DASH (6)
 12953                                    W-LABEL-2ND-ZIP (6).
 12954
 12955     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12956
 12957     IF  ADDRSI EQUAL '5'
 12958             AND
 12959         PI-CREATE-LABELS
 12960             AND
 12961         NOT PI-689-LABELS-OVERRIDEN
 12962         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12963                                    W-VG-TEXT (31)
 12964         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12965                                    W-VG-TEXT (32)
 12966         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12967                                    W-VG-TEXT (33)
 12968         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12969                                    W-VG-TEXT (34)
 12970         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12971                                    W-VG-TEXT (35)
 12972         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12973                                    W-VG-TEXT (36)
 12974         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12975         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12976         SET W-RG-NDX UP BY +1
 12977     ELSE
 12978         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 12979         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 12980         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 12981         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 12982         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 270
* EL689.cbl
 12983         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 12984     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 12985     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 12986     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 12987     MOVE MA-CRED-BENE-CTYST     TO W-LABEL-LINES (4)
 12988     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 12989     MOVE SPACES                 TO W-LABEL-ZIP (6)
 12990     IF  MA-CB-CANADIAN-POST-CODE
 12991         MOVE MA-CB-CANADIAN-POSTAL-CODE
 12992                                 TO W-CANADIAN-POSTAL-CODES
 12993         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12994         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12995         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12996                                    W-LAB-CAN-FILLER (6)
 12997     ELSE
 12998         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12999         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13000             MOVE '-'            TO W-LABEL-DASH (6)
 13001             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13002         ELSE
 13003             MOVE SPACES         TO W-LABEL-DASH (6)
 13004                                    W-LABEL-2ND-ZIP (6)
 13005         END-IF
 13006     END-IF
 13007     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 13008     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 13009     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 13010     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 13011     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 13012     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 13013     GO TO 6700-EXIT.
 13014
 13015 6700-MAIL-NOT-FOUND.
 13016
 13017     IF  ADDRSL GREATER ZERO
 13018         IF ADDRSI = '5'
 13019            MOVE ER-3000         TO EMI-ERROR
 13020            MOVE -1              TO ADDRSL
 13021            MOVE AL-UNBON        TO ADDRSA
 13022            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13023            GO TO 8200-SEND-DATAONLY.
 13024
 13025 6700-EXIT.
 13026     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 271
* EL689.cbl
 13028 6750-GET-LIFE-BENEFIT-DATA.
 13029
 13030     IF  W-FILE-NOT-USED (2)
 13031         GO TO 6750-EXIT.
 13032
 13033     MOVE SPACES                 TO W-CNTL-GEN2.
 13034
 13035     IF  DATASORI EQUAL '2'
 13036         IF  W-FILE-NOT-USED (8)
 13037             PERFORM 6450-READ-CERT-ONLY
 13038             IF  W-CERT-FOUND
 13039                 MOVE CM-LF-BENEFIT-CD
 13040                                 TO W-BEN-HOLD
 13041                                    W-CNTL-GEN2
 13042             ELSE
 13043                 NEXT SENTENCE
 13044         ELSE
 13045             MOVE CM-LF-BENEFIT-CD
 13046                                 TO W-BEN-HOLD
 13047                                    W-CNTL-GEN2
 13048     ELSE
 13049         IF  DATASORI EQUAL '4'
 13050             IF  W-FILE-NOT-USED (9)
 13051                 PERFORM 6400-READ-PNDB-ONLY
 13052                 IF  W-PNDB-FOUND
 13053                     IF  PI-689-TYPE = '1'
 13054                         MOVE PB-I-LF-BENEFIT-CD
 13055                                 TO W-BEN-HOLD
 13056                                    W-CNTL-GEN2
 13057                     ELSE
 13058                         MOVE PB-CI-LF-BENEFIT-CD
 13059                                 TO W-BEN-HOLD
 13060                                    W-CNTL-GEN2
 13061             ELSE
 13062                 NEXT SENTENCE
 13063         ELSE
 13064             IF  W-FILE-USED (8)
 13065                 MOVE CM-LF-BENEFIT-CD
 13066                                 TO W-BEN-HOLD
 13067                                    W-CNTL-GEN2
 13068             ELSE
 13069                 IF  W-FILE-USED (9)
 13070                     IF  PI-689-TYPE = '1'
 13071                         MOVE PB-I-LF-BENEFIT-CD
 13072                                 TO W-BEN-HOLD
 13073                                    W-CNTL-GEN2
 13074                     ELSE
 13075                         MOVE PB-CI-LF-BENEFIT-CD
 13076                                 TO W-BEN-HOLD
 13077                                    W-CNTL-GEN2.
 13078
 13079     IF  W-CNTL-GEN2 EQUAL SPACES
 13080         MOVE ER-9327            TO EMI-ERROR
 13081         MOVE -1                 TO MAINTL
 13082         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13083         GO TO 6750-EXIT.
 13084
 13085     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 272
* EL689.cbl
 13086     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 13087     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13088
 13089
 13090* EXEC CICS HANDLE CONDITION
 13091*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13092*         NOTFND  (6750-EXIT)
 13093*    END-EXEC.
 13094*    MOVE '"$JI                  ! : #00012200' TO DFHEIV0
 13095     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13097     MOVE X'3A20233030303132323030' TO DFHEIV0(25:11)
 13098     CALL 'kxdfhei1' USING DFHEIV0
 13099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13100
 13101
 13102
 13103* EXEC CICS READ
 13104*         DATASET (W-CNTL-FILE-ID)
 13105*         SET     (ADDRESS OF CONTROL-FILE)
 13106*         GTEQ
 13107*         RIDFLD  (W-CNTL-KEY)
 13108*    END-EXEC.
 13109*    MOVE '&"S        G          (   #00012205' TO DFHEIV0
 13110     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13111     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13112     MOVE X'2020233030303132323035' TO DFHEIV0(25:11)
 13113     CALL 'kxdfhei1' USING DFHEIV0,
 13114           W-CNTL-FILE-ID,
 13115           DFHEIV20,
 13116           DFHEIV99,
 13117           W-CNTL-KEY,
 13118           DFHEIV99,
 13119           DFHEIV99,
 13120           DFHEIV99
 13121     SET ADDRESS OF CONTROL-FILE TO
 13122         DFHEIV20
 13123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13124
 13125
 13126     MOVE 1                      TO W-NDX.
 13127
 13128 6750-LOOP.
 13129
 13130     IF  W-NDX = 9
 13131         GO TO 6750-EXIT.
 13132
 13133     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13134         ADD 1                   TO W-NDX
 13135         GO TO 6750-LOOP.
 13136
 13137     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13138         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13139                                 TO W-VG-TEXT (11).
 13140
 13141 6750-EXIT.
 13142     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 273
* EL689.cbl
 13144 6800-GET-A-H-BENEFIT-DATA.
 13145
 13146     IF  W-FILE-NOT-USED (3)
 13147         GO TO 6800-EXIT.
 13148
 13149     MOVE SPACES                 TO W-CNTL-GEN2.
 13150
 13151     IF  DATASORI EQUAL '2'
 13152         IF  W-FILE-NOT-USED (8)
 13153             PERFORM 6450-READ-CERT-ONLY
 13154             IF  W-CERT-FOUND
 13155                 MOVE CM-AH-BENEFIT-CD
 13156                                 TO W-BEN-HOLD
 13157                                    W-CNTL-GEN2
 13158             ELSE
 13159                 NEXT SENTENCE
 13160         ELSE
 13161             MOVE CM-AH-BENEFIT-CD
 13162                                 TO W-BEN-HOLD
 13163                                    W-CNTL-GEN2
 13164     ELSE
 13165         IF  DATASORI EQUAL '4'
 13166             IF  W-FILE-NOT-USED (9)
 13167                 PERFORM 6400-READ-PNDB-ONLY
 13168                 IF  W-PNDB-FOUND
 13169                     IF  PI-689-TYPE = '1'
 13170                         MOVE PB-I-AH-BENEFIT-CD
 13171                                 TO W-BEN-HOLD
 13172                                    W-CNTL-GEN2
 13173                     ELSE
 13174                         MOVE PB-CI-AH-BENEFIT-CD
 13175                                 TO W-BEN-HOLD
 13176                                    W-CNTL-GEN2
 13177             ELSE
 13178                 NEXT SENTENCE
 13179         ELSE
 13180             IF  W-FILE-USED (8)
 13181                 MOVE CM-AH-BENEFIT-CD
 13182                                 TO W-BEN-HOLD
 13183                                    W-CNTL-GEN2
 13184             ELSE
 13185                 IF  W-FILE-USED (9)
 13186                     IF  PI-689-TYPE = '1'
 13187                         MOVE PB-I-AH-BENEFIT-CD
 13188                                 TO W-BEN-HOLD
 13189                                    W-CNTL-GEN2
 13190                     ELSE
 13191                         MOVE PB-CI-AH-BENEFIT-CD
 13192                                 TO W-BEN-HOLD
 13193                                    W-CNTL-GEN2.
 13194
 13195     IF  W-CNTL-GEN2 EQUAL SPACES
 13196         MOVE ER-9327            TO EMI-ERROR
 13197         MOVE -1                 TO MAINTL
 13198         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13199         GO TO 6800-EXIT.
 13200
 13201     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 274
* EL689.cbl
 13202     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 13203     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13204
 13205
 13206* EXEC CICS HANDLE CONDITION
 13207*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13208*         NOTFND  (6800-EXIT)
 13209*    END-EXEC.
 13210*    MOVE '"$JI                  ! ; #00012291' TO DFHEIV0
 13211     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13213     MOVE X'3B20233030303132323931' TO DFHEIV0(25:11)
 13214     CALL 'kxdfhei1' USING DFHEIV0
 13215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13216
 13217
 13218
 13219* EXEC CICS READ
 13220*         DATASET (W-CNTL-FILE-ID)
 13221*         SET     (ADDRESS OF CONTROL-FILE)
 13222*         RIDFLD  (W-CNTL-KEY)
 13223*         GTEQ
 13224*    END-EXEC.
 13225*    MOVE '&"S        G          (   #00012296' TO DFHEIV0
 13226     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13227     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13228     MOVE X'2020233030303132323936' TO DFHEIV0(25:11)
 13229     CALL 'kxdfhei1' USING DFHEIV0,
 13230           W-CNTL-FILE-ID,
 13231           DFHEIV20,
 13232           DFHEIV99,
 13233           W-CNTL-KEY,
 13234           DFHEIV99,
 13235           DFHEIV99,
 13236           DFHEIV99
 13237     SET ADDRESS OF CONTROL-FILE TO
 13238         DFHEIV20
 13239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13240
 13241
 13242     MOVE 1                      TO W-NDX.
 13243
 13244 6800-LOOP-AH.
 13245
 13246     IF  W-NDX = 9
 13247         GO TO 6800-EXIT.
 13248
 13249     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13250         ADD 1                   TO W-NDX
 13251         GO TO 6800-LOOP-AH.
 13252
 13253     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13254         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13255                                 TO W-VG-TEXT (15)
 13256         MOVE CF-BENEFIT-ALPHA (W-NDX)
 13257                                 TO W-BENEFIT-WORK
 13258         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 13259
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 275
* EL689.cbl
 13260 6800-EXIT.
 13261     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 276
* EL689.cbl
 13263 6850-GET-CHECK-DATA.
 13264
 13265     IF  ADDRSI EQUAL '6'
 13266             AND
 13267         PI-CREATE-LABELS
 13268             AND
 13269         NOT PI-689-LABELS-OVERRIDEN
 13270         NEXT SENTENCE
 13271     ELSE
 13272         IF  W-FILE-NOT-USED (12)
 13273             GO TO 6850-EXIT.
 13274
 13275     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 13276         MOVE ER-9327            TO EMI-ERROR
 13277         MOVE -1                 TO MAINTL
 13278         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13279         GO TO 6850-EXIT.
 13280
 13281
 13282* EXEC CICS HANDLE CONDITION
 13283*         NOTOPEN (8045-CHEK-NOT-OPEN)
 13284*         NOTFND  (6850-CHEK-NOT-FOUND)
 13285*    END-EXEC.
 13286*    MOVE '"$JI                  ! < #00012342' TO DFHEIV0
 13287     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13289     MOVE X'3C20233030303132333432' TO DFHEIV0(25:11)
 13290     CALL 'kxdfhei1' USING DFHEIV0
 13291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13292
 13293
 13294
 13295* EXEC CICS READ
 13296*         DATASET (W-CHEK-FILE-ID)
 13297*         SET     (ADDRESS OF CHECK-RECORDS)
 13298*         RIDFLD  (W-CHEK-KEY)
 13299*    END-EXEC.
 13300*    MOVE '&"S        E          (   #00012347' TO DFHEIV0
 13301     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13302     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13303     MOVE X'2020233030303132333437' TO DFHEIV0(25:11)
 13304     CALL 'kxdfhei1' USING DFHEIV0,
 13305           W-CHEK-FILE-ID,
 13306           DFHEIV20,
 13307           DFHEIV99,
 13308           W-CHEK-KEY,
 13309           DFHEIV99,
 13310           DFHEIV99,
 13311           DFHEIV99
 13312     SET ADDRESS OF CHECK-RECORDS TO
 13313         DFHEIV20
 13314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13315
 13316
 13317     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 13318     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 13319     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 13320     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 277
* EL689.cbl
 13321                                    PI-689-CONTROL.
 13322     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 13323     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 13324
 13325     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13326     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 13327     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 13328     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 13329     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 13330     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 13331
 13332     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 13333     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13334
 13335     IF  CH-CANADIAN-POST-CODE
 13336         MOVE CH-CANADIAN-POSTAL-CODE
 13337                                 TO W-CANADIAN-POSTAL-CODES
 13338         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13339         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13340         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13341                                    W-LAB-CAN-FILLER (6)
 13342     ELSE
 13343         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13344         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13345             MOVE '-'            TO W-LABEL-DASH (6)
 13346             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13347         ELSE
 13348             MOVE SPACES         TO W-LABEL-DASH (6)
 13349                                    W-LABEL-2ND-ZIP (6).
 13350
 13351     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13352
 13353     IF  ADDRSI EQUAL '6'
 13354             AND
 13355         PI-CREATE-LABELS
 13356             AND
 13357         NOT PI-689-LABELS-OVERRIDEN
 13358         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13359                                    W-VG-TEXT (159)
 13360         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13361                                    W-VG-TEXT (160)
 13362         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13363                                    W-VG-TEXT (161)
 13364         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13365                                    W-VG-TEXT (162)
 13366         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13367                                    W-VG-TEXT (163)
 13368         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13369                                    W-VG-TEXT (164)
 13370         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13371         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13372         SET W-RG-NDX UP BY +1
 13373     ELSE
 13374         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 13375         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 13376         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 13377         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 13378         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 278
* EL689.cbl
 13379         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 13380
 13381     GO TO 6850-EXIT.
 13382
 13383 6850-CHEK-NOT-FOUND.
 13384
 13385     IF  ADDRSL GREATER ZERO
 13386         IF ADDRSI = '6'
 13387            MOVE ER-2908         TO EMI-ERROR
 13388            MOVE -1              TO ADDRSL
 13389            MOVE AL-UNBON        TO ADDRSA
 13390            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13391            GO TO 8200-SEND-DATAONLY.
 13392
 13393 6850-EXIT.
 13394     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 279
* EL689.cbl
 13396 6900-GET-PYAJ-DATA.
 13397
 13398     IF  W-FILE-NOT-USED (13)
 13399         GO TO 6900-EXIT.
 13400
 13401     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 13402         MOVE ER-9327            TO EMI-ERROR
 13403         MOVE -1                 TO MAINTL
 13404         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13405         GO TO 6900-EXIT.
 13406
 13407
 13408* EXEC CICS HANDLE CONDITION
 13409*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 13410*         NOTFND  (6900-PYAJ-NOT-FOUND)
 13411*    END-EXEC.
 13412*    MOVE '"$JI                  ! = #00012443' TO DFHEIV0
 13413     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13414     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13415     MOVE X'3D20233030303132343433' TO DFHEIV0(25:11)
 13416     CALL 'kxdfhei1' USING DFHEIV0
 13417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13418
 13419
 13420 6900-READ-NEXT.
 13421
 13422
 13423* EXEC CICS READ
 13424*         DATASET (W-PYAJ-FILE-ID)
 13425*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 13426*         RIDFLD  (W-PYAJ-KEY)
 13427*         GTEQ
 13428*    END-EXEC.
 13429*    MOVE '&"S        G          (   #00012450' TO DFHEIV0
 13430     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13432     MOVE X'2020233030303132343530' TO DFHEIV0(25:11)
 13433     CALL 'kxdfhei1' USING DFHEIV0,
 13434           W-PYAJ-FILE-ID,
 13435           DFHEIV20,
 13436           DFHEIV99,
 13437           W-PYAJ-KEY,
 13438           DFHEIV99,
 13439           DFHEIV99,
 13440           DFHEIV99
 13441     SET ADDRESS OF PENDING-PAY-ADJ TO
 13442         DFHEIV20
 13443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13444
 13445
 13446     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 13447             OR
 13448         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 13449             OR
 13450         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 13451             OR
 13452         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 13453             OR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 280
* EL689.cbl
 13454         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 13455         GO TO 6900-PYAJ-NOT-FOUND.
 13456
 13457     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 13458             AND
 13459         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 13460         GO TO 6900-PYAJ-NOT-FOUND.
 13461
 13462     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 13463         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 13464         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 13465         GO TO 6900-READ-NEXT.
 13466
 13467     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 13468     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 13469
 13470     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 13471     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 13472
 13473     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 13474                                    PI-689-CONTROL.
 13475     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 13476     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 13477
 13478     GO TO 6900-EXIT.
 13479
 13480 6900-PYAJ-NOT-FOUND.
 13481
 13482     MOVE ER-7395                TO EMI-ERROR
 13483     MOVE -1                     TO DATASORL
 13484     MOVE AL-UNBON               TO DATASORA
 13485     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13486     GO TO 8200-SEND-DATAONLY.
 13487
 13488 6900-EXIT.
 13489     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 281
* EL689.cbl
 13491 6950-MOVE-SYSTEM-DATA.
 13492
 13493     IF  W-FILE-NOT-USED (7)
 13494         GO TO 6950-EXIT.
 13495
 13496     MOVE EIBDATE                TO W-DATE-WORK.
 13497     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 13498     MOVE '5'                    TO DC-OPTION-CODE.
 13499     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13500     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 13501     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 13502
 13503     MOVE FORMI                  TO W-VG-TEXT (62).
 13504
 13505     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 13506         MOVE PI-689-VARIABLE-DATA-1
 13507                                 TO W-VG-TEXT (63)
 13508         MOVE PI-689-VARIABLE-DATA-2
 13509                                 TO W-VG-TEXT (64)
 13510         MOVE PI-689-VARIABLE-DATA-3
 13511                                 TO W-VG-TEXT (65)
 13512         MOVE PI-689-VARIABLE-DATA-4
 13513                                 TO W-VG-TEXT (66)
 13514     ELSE
 13515         MOVE '(VARIABLE NOT PROVIDED)'
 13516                                 TO W-VG-TEXT (63).
 13517
 13518 6950-EXIT.
 13519     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 282
* EL689.cbl
 13521 7000-FORMAT-SCREEN.
 13522
 13523     IF  MAINTI EQUAL 'S'
 13524             OR
 13525         PI-SHOW-MODE
 13526         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 13527     ELSE
 13528         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 13529
 13530     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 13531         SET W-LINE23            TO W-RG-NDX
 13532         MOVE 'A'                TO W-LINE1
 13533     ELSE
 13534         SET W-LIN-NUM           TO W-RG-NDX
 13535         COMPUTE W-LIN-NUM
 13536             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 13537
 13538     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 13539     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 13540     SET W-RG-NDX UP BY 1.
 13541
 13542 7000-EXIT.
 13543      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 283
* EL689.cbl
 13545 7100-FORMAT-LAST-NAME-1ST.
 13546*****************************************************************
 13547*             M O V E   N A M E   R O U T I N E                 *
 13548*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13549*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13550*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13551*                  FIELD                   VALUE                *
 13552*           W-NAME-LAST    (CL15)      SMITH                    *
 13553*           W-NAME-FIRST   (CL15)      JOHN                     *
 13554*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 13555*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13556*     CONTAIN                                                   *
 13557*                SMITH, JOHN ALLEN                              *
 13558*     OR                                                        *
 13559*                SMITH, JOHN A.                                 *
 13560*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13561*     COPYBOOK, ELCNWA.                                         *
 13562*****************************************************************.
 13563
 13564     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 13565     MOVE ZERO                   TO WS-NAME-SW.
 13566     SET NWA-INDEX               TO +1.
 13567
 13568     IF  W-NAME-LAST EQUAL SPACES
 13569             AND
 13570         W-NAME-MIDDLE EQUAL SPACES
 13571         MOVE +1                 TO WS-NAME-SW.
 13572
 13573     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13574     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13575
 13576     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13577     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13578
 13579     SET NWA-INDEX UP BY +1.
 13580
 13581     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 13582         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 13583             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13584             SET NWA-INDEX UP BY +1
 13585             MOVE '.'            TO WS-NW (NWA-INDEX)
 13586             SET NWA-INDEX UP BY +2
 13587         ELSE
 13588             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13589             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13590
 13591 7100-EXIT.
 13592     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 284
* EL689.cbl
 13594 7110-MOVE-NAME.
 13595
 13596     IF  WS-NAME-SW GREATER THAN +1
 13597         GO TO 7110-EXIT.
 13598
 13599     IF  WS-NAME-WORK2 = SPACES
 13600         GO TO 7110-EXIT.
 13601
 13602     SET NWA-INDEX2            TO +1.
 13603     SET NWA-INDEX3            TO +2.
 13604
 13605 7110-MOVE-NAME-CYCLE.
 13606
 13607     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 13608
 13609     IF  NWA-INDEX LESS THAN +30
 13610         SET NWA-INDEX UP BY +1
 13611     ELSE
 13612         ADD +2                TO WS-NAME-SW
 13613         GO TO 7110-EXIT.
 13614
 13615     IF  NWA-INDEX2 LESS THAN +20
 13616         SET NWA-INDEX3 UP BY +1
 13617         SET NWA-INDEX2 UP BY +1.
 13618
 13619     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 13620             AND
 13621         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 13622         IF  WS-NAME-SW EQUAL ZERO
 13623             MOVE ','            TO WS-NW (NWA-INDEX)
 13624             SET NWA-INDEX UP BY +2
 13625             MOVE +1             TO WS-NAME-SW
 13626             GO TO 7110-EXIT
 13627         ELSE
 13628             GO TO 7110-EXIT.
 13629
 13630     GO TO 7110-MOVE-NAME-CYCLE.
 13631
 13632 7110-EXIT.
 13633     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 285
* EL689.cbl
 13635 7200-FORMAT-NAME-STRAIGHT.
 13636*****************************************************************
 13637*           M O V E   N A M E   R O U T I N E                   *
 13638*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13639*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13640*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13641*                  FIELD                   VALUE                *
 13642*           W-NAME-LAST    (CL15)      SMITH                    *
 13643*           W-NAME-FIRST   (CL15)      JOHN                     *
 13644*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 13645*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13646*     CONTAIN                                                   *
 13647*              JOHN A. SMITH                                    *
 13648*     OR                                                        *
 13649*              JOHN ALLEN SMITH                                 *
 13650*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13651*     COPYBOOK, ELCNWA.                                         *
 13652*****************************************************************
 13653
 13654     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 13655     MOVE ZERO                   TO WS-NAME-SW.
 13656     SET NWA-INDEX               TO +1.
 13657
 13658     IF  W-NAME-FIRST EQUAL SPACES
 13659             AND
 13660         W-NAME-MIDDLE EQUAL SPACES
 13661         MOVE W-NAME-LAST        TO WS-NAME-WORK
 13662         GO TO 7200-EXIT.
 13663
 13664     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13665     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13666
 13667     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 13668         SET NWA-INDEX UP BY +1
 13669
 13670         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 13671             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13672             SET NWA-INDEX UP BY +1
 13673             MOVE '.'            TO WS-NW (NWA-INDEX)
 13674             SET NWA-INDEX UP BY +1
 13675
 13676         ELSE
 13677             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13678             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13679
 13680     SET NWA-INDEX UP BY +1
 13681     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13682     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13683
 13684 7200-EXIT.
 13685     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 286
* EL689.cbl
 13687 7290-MOVE-NAME.
 13688
 13689     IF  WS-NAME-SW GREATER THAN +1
 13690         GO TO 7290-EXIT.
 13691
 13692     IF  WS-NAME-WORK2 EQUAL SPACES
 13693         GO TO 7290-EXIT.
 13694
 13695     SET NWA-INDEX2            TO +1.
 13696     SET NWA-INDEX3            TO +2.
 13697
 13698 7290-MOVE-NAME-CYCLE.
 13699
 13700     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 13701
 13702     IF  NWA-INDEX LESS THAN +30
 13703         SET NWA-INDEX UP BY +1
 13704     ELSE
 13705         ADD +2                TO WS-NAME-SW
 13706         GO TO 7290-EXIT.
 13707
 13708     IF  NWA-INDEX2 LESS THAN +20
 13709         SET NWA-INDEX2 UP BY +1
 13710         SET NWA-INDEX3 UP BY +1.
 13711
 13712     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 13713             AND
 13714         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 13715         GO TO 7290-EXIT.
 13716
 13717     GO TO 7290-MOVE-NAME-CYCLE.
 13718
 13719 7290-EXIT.
 13720     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 287
* EL689.cbl
 13722 7300-LABEL-MOVE.
 13723
 13724     IF  W-LABEL-HOLD-AREA = SPACES
 13725         MOVE +0                 TO W-NUMB-LABEL-LINES
 13726         GO TO 7300-EXIT.
 13727
 13728     IF  W-LABEL-LINES (1) = SPACES
 13729         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 13730         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 13731         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 13732         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13733         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13734         MOVE SPACES             TO W-LABEL-LINES (6)
 13735         GO TO 7300-LABEL-MOVE.
 13736
 13737     IF  W-LABEL-LINES (2) = SPACES
 13738             AND
 13739         W-LABEL-LINES (3) = SPACES
 13740             AND
 13741         W-LABEL-LINES (4) = SPACES
 13742             AND
 13743         W-LABEL-LINES (5) = SPACES
 13744             AND
 13745         W-LABEL-LINES (6) = SPACES
 13746         MOVE 1                  TO W-NDX
 13747                                    W-NUMB-LABEL-LINES
 13748         GO TO 7300-EXIT.
 13749
 13750 7300-TRY-2.
 13751
 13752     IF  W-LABEL-LINES (2) = SPACES
 13753         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 13754         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 13755         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13756         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13757         MOVE SPACES             TO W-LABEL-LINES (6)
 13758         GO TO 7300-TRY-2.
 13759
 13760     IF  W-LABEL-LINES (3) = SPACES
 13761             AND
 13762         W-LABEL-LINES (4) = SPACES
 13763             AND
 13764         W-LABEL-LINES (5) = SPACES
 13765             AND
 13766         W-LABEL-LINES (6) = SPACES
 13767         MOVE 2                  TO W-NDX
 13768         GO TO 7300-MOVE-ZIP.
 13769
 13770 7300-TRY-3.
 13771
 13772     IF  W-LABEL-LINES (3) = SPACES
 13773         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 13774         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13775         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13776         MOVE SPACES             TO W-LABEL-LINES (6)
 13777         GO TO 7300-TRY-3.
 13778
 13779     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 288
* EL689.cbl
 13780             AND
 13781         W-LABEL-LINES (5) = SPACES
 13782             AND
 13783         W-LABEL-LINES (6) = SPACES
 13784         MOVE 3                   TO W-NDX
 13785         GO TO 7300-MOVE-ZIP.
 13786
 13787 7300-TRY-4.
 13788
 13789     IF  W-LABEL-LINES (4) = SPACES
 13790         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13791         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13792         MOVE SPACES             TO W-LABEL-LINES (6)
 13793         GO TO 7300-TRY-4.
 13794
 13795     IF  W-LABEL-LINES (5) = SPACES
 13796             AND
 13797         W-LABEL-LINES (6) = SPACES
 13798         MOVE 4                  TO W-NDX
 13799         GO TO 7300-MOVE-ZIP.
 13800
 13801 7300-TRY-5.
 13802
 13803     IF  W-LABEL-LINES (5) = SPACES
 13804         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13805         MOVE SPACES             TO W-LABEL-LINES (6)
 13806         GO TO 7300-TRY-5
 13807     ELSE
 13808         IF  W-LABEL-LINES (6) = SPACES
 13809             MOVE 5              TO W-NDX
 13810             GO TO 7300-MOVE-ZIP
 13811         ELSE
 13812             MOVE 6              TO W-NDX.
 13813
 13814 7300-MOVE-ZIP.
 13815
 13816     COMPUTE W-NDX2 = W-NDX - 1.
 13817
 13818     IF  W-LAST-ZIP (W-NDX2) = SPACES
 13819*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 13820
 13821         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 13822                 MOVE W-LABEL-ZIP (W-NDX)
 13823                                 TO W-LAST-ZIP (W-NDX2)
 13824                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 13825                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 13826                 GO TO 7300-EXIT.
 13827
 13828     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 13829
 13830 7300-EXIT.
 13831     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 289
* EL689.cbl
 13833 7400-CREATE-LETTER.
 13834****************************************************************
 13835*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 13836*    RECORDS.                                                  *
 13837****************************************************************
 13838
 13839     SET W-SQ-NDX                TO W-START-COLUMN.
 13840     MOVE SPACES                 TO W-SQUEEZED-LINE
 13841                                    W-WORK-LINE.
 13842     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 13843     MOVE +1                     TO W-LAST-WC-SPACE.
 13844     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 13845
 13846     SET W-TG-NDX                TO +1.
 13847
 13848     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 13849            VARYING
 13850         W-TG-NDX FROM W-TG-NDX BY +1
 13851            UNTIL
 13852         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 13853
 13854     IF  W-FORM-SQUEEZE-ON
 13855             AND
 13856         W-SQUEEZED-LINE GREATER THAN SPACES
 13857         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 13858
 13859     PERFORM 7640-PAGING THRU 7640-EXIT.
 13860
 13861 7400-EXIT.
 13862     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 290
* EL689.cbl
 13864 7410-TEXT-LINE-PROCESS.
 13865***************************************************************
 13866*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 13867*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 13868*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 13869*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 13870*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 13871*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 13872***************************************************************
 13873
 13874
 13875     SET W-WC-NDX                TO W-ZEROS.
 13876     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 13877
 13878     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 13879
 13880     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 13881             VARYING
 13882         W-TX-NDX FROM +1 BY +1
 13883             UNTIL
 13884         W-TX-NDX GREATER THAN +70.
 13885
 13886****************************************************************
 13887*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 13888*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 13889*    LINE SQUEEZE CONTROL.                                     *
 13890****************************************************************
 13891     IF  W-FORM-SQUEEZE-ON
 13892
 13893         IF  W-WORK-LINE GREATER THAN SPACES
 13894                 OR
 13895             W-AS-IS
 13896             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 13897
 13898         ELSE
 13899             NEXT SENTENCE
 13900****************************************************************
 13901*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 13902*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 13903****************************************************************
 13904     ELSE
 13905         IF  W-WORK-LINE GREATER THAN SPACES
 13906             MOVE W-TX-PC (W-TG-NDX)
 13907                                 TO W-PRINT-CONTROL
 13908             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 13909             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 13910             MOVE SPACES         TO W-WORK-LINE.
 13911
 13912 7410-EXIT.
 13913     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 291
* EL689.cbl
 13915 7420-TEXT-CHAR-PROCESS.
 13916****************************************************************
 13917*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 13918*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 13919*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 13920*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 13921****************************************************************
 13922
 13923     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 13924             AND
 13925         W-LAST-CHAR EQUAL '@'
 13926         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 13927
 13928     SET W-WC-NDX UP BY +1.
 13929
 13930     IF  W-WC-NDX GREATER THAN +70
 13931         IF  W-FORM-SQUEEZE-ON
 13932                 AND
 13933             NOT W-AS-IS
 13934             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 13935                     VARYING
 13936                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 13937                     UNTIL
 13938                 W-WC-NDX EQUAL +71
 13939             SET W-TX-NDX        TO W-LAST-TX-SPACE
 13940
 13941             IF  W-WORK-LINE GREATER THAN SPACES
 13942                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 13943                 MOVE SPACES     TO W-WORK-LINE
 13944                                    W-LINE-SQUEEZE-IND
 13945                 SET W-WC-NDX    TO +1
 13946             ELSE
 13947                 SET W-WC-NDX    TO +1
 13948         ELSE
 13949             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 13950
 13951     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 13952                                 TO W-CHARACTER-TYPE.
 13953
 13954     SET W-WC-NDX2               TO W-WC-NDX.
 13955     SET W-WC-NDX2 DOWN BY +1.
 13956
 13957     IF  W-PUNCTUATION
 13958             AND
 13959         W-WC-NDX2 GREATER THAN W-ZEROS
 13960             AND
 13961         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 13962         SET W-WC-NDX DOWN BY +1.
 13963
 13964     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 13965                                 TO W-LAST-CHAR
 13966                                    W-WORK-CHAR (W-WC-NDX).
 13967
 13968     IF  W-LAST-CHAR EQUAL SPACES
 13969         SET W-LAST-WC-SPACE     TO W-WC-NDX
 13970         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 13971
 13972 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 292
* EL689.cbl
 13973     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 293
* EL689.cbl
 13975 7430-PROCESS-VARIABLE.
 13976******************************************************************
 13977*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 13978*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 13979*    ITS CORRESPONDING VALUES.                                   *
 13980******************************************************************
 13981
 13982     SET W-TX-NDX UP BY +1.
 13983
 13984     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 13985         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 13986                                 TO W-V1
 13987         SET W-TX-NDX UP BY +1
 13988
 13989         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 13990             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 13991                                 TO W-V2
 13992             SET W-TX-NDX UP BY +1
 13993             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 13994                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 13995                                 TO W-V3
 13996                 SET W-TX-NDX UP BY +1
 13997                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 13998                                 TO W-FIELD-SQUEEZE-IND
 13999                 GO TO 7430-CONTINUE
 14000             ELSE
 14001                 SET W-TX-NDX DOWN BY +3
 14002                 MOVE ER-0180    TO EMI-ERROR
 14003                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14004                 MOVE -1         TO MAINTL
 14005                 MOVE HIGH-VALUES
 14006                                 TO W-LAST-CHAR
 14007         ELSE
 14008             SET W-TX-NDX DOWN BY +2
 14009             MOVE ER-0180        TO EMI-ERROR
 14010             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14011             MOVE -1             TO MAINTL
 14012             MOVE HIGH-VALUES    TO W-LAST-CHAR
 14013     ELSE
 14014         SET W-TX-NDX DOWN BY +1
 14015         MOVE ER-7246            TO EMI-ERROR
 14016         MOVE -1                 TO MAINTL
 14017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14018         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 14019
 14020****************************************************************
 14021*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 14022*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 14023*    ACTION.                                                   *
 14024****************************************************************
 14025
 14026     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14027         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14028         GO TO 7430-EXIT
 14029     ELSE
 14030         GO TO 7430-EXIT.
 14031
 14032 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 294
* EL689.cbl
 14033
 14034     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 14035             OR
 14036         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 14037         SET W-TX-NDX DOWN BY +4
 14038         MOVE ER-0180            TO EMI-ERROR
 14039         MOVE -1                 TO MAINTL
 14040         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14041         MOVE HIGH-VALUES        TO W-LAST-CHAR
 14042         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14043             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14044             GO TO 7430-EXIT
 14045         ELSE
 14046             GO TO 7430-EXIT.
 14047
 14048     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 14049
 14050     SET W-WC-NDX DOWN BY +1.
 14051
 14052     IF  (W-FORM-SQUEEZE-OFF
 14053                 AND
 14054             NOT W-SQUEEZE-FIELD)
 14055             OR
 14056         (W-FORM-SQUEEZE-ON
 14057                 AND
 14058             W-AS-IS)
 14059         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 14060                 VARYING
 14061             W-VC-NDX FROM +1 BY +1
 14062                 UNTIL
 14063             W-VC-NDX GREATER THAN
 14064                 W-VARIABLE-SIZE (W-VG-NDX)
 14065
 14066         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 14067             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14068             SET W-TX-NDX DOWN BY +5
 14069             IF  W-TX-NDX GREATER THAN +70
 14070                 SET W-TX-NDX    TO +70
 14071                 GO TO 7430-EXIT
 14072             ELSE
 14073                 GO TO 7430-EXIT
 14074         ELSE
 14075             COMPUTE W-ADJUST-SHORT
 14076                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 14077             SET W-WC-NDX UP BY W-ADJUST-SHORT
 14078             GO TO 7430-EXIT.
 14079
 14080     IF  W-SQUEEZE-FIELD
 14081         SET W-TX-NDX UP BY +1.
 14082
 14083     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 14084
 14085     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 14086             VARYING
 14087         W-VC-NDX FROM +1 BY +1
 14088             UNTIL
 14089         W-VC-NDX GREATER THAN
 14090             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 295
* EL689.cbl
 14091
 14092     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 14093
 14094     IF  W-FORM-SQUEEZE-ON
 14095         GO TO 7430-EXIT.
 14096
 14097     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 14098         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14099         SET W-TX-NDX DOWN BY +6
 14100         IF  W-TX-NDX GREATER THAN +70
 14101             SET W-TX-NDX        TO +70.
 14102
 14103     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 14104         SET W-WC-NDX DOWN BY +1.
 14105
 14106 7430-EXIT.
 14107     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 296
* EL689.cbl
 14109 7435-MOVE-VARIABLE-DIRECT.
 14110
 14111     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14112             AND
 14113         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14114             AND
 14115         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14116             AND
 14117         (W-VC-NDX GREATER THAN +1
 14118                 AND
 14119             W-LAST-CHAR NOT EQUAL SPACE
 14120                 AND
 14121             NOT W-LAST-CHAR-PUNC)
 14122         IF  W-LC-USE-BOTH-CASES
 14123             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14124                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 14125         ELSE
 14126             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14127                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 14128
 14129     SET W-WC-NDX UP BY +1.
 14130     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14131                                 TO W-WORK-CHAR (W-WC-NDX)
 14132                                    W-LAST-CHAR.
 14133
 14134 7435-EXIT.
 14135     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 297
* EL689.cbl
 14137 7437-FIND-NEXT-CHARACTER.
 14138*DELIBERATELY LEFT BLANK.
 14139 7437-EXIT.
 14140     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 298
* EL689.cbl
 14142 7440-BACK-TO-NEAREST-WORD.
 14143
 14144     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 14145
 14146 7440-EXIT.
 14147     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 299
* EL689.cbl
 14149 7450-SQUEEZING.
 14150
 14151     IF  W-NEW-PARAGRAPH
 14152         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 14153         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 14154         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14155             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14156             MOVE W-TX-PC (W-TG-NDX)
 14157                                 TO W-PRINT-CONTROL
 14158             MOVE SPACES         TO W-SQUEEZED-LINE
 14159             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14160             SET W-SQ-NDX UP BY W-WORK-INDENT
 14161         ELSE
 14162             MOVE W-TX-PC (W-TG-NDX)
 14163                                 TO W-PRINT-CONTROL
 14164             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14165             SET W-SQ-NDX UP BY W-WORK-INDENT
 14166     ELSE
 14167         IF  W-DO-NOT-ADJUST
 14168             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 14169             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14170                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14171                 MOVE W-WORK-LINE
 14172                                 TO W-SQUEEZED-LINE
 14173                 MOVE W-TX-PC (W-TG-NDX)
 14174                                 TO W-PRINT-CONTROL
 14175                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14176                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14177                 MOVE SPACES     TO W-SQUEEZED-LINE
 14178                 GO TO 7450-EXIT
 14179             ELSE
 14180                 MOVE W-WORK-LINE
 14181                                 TO W-SQUEEZED-LINE
 14182                 MOVE W-TX-PC (W-TG-NDX)
 14183                                 TO W-PRINT-CONTROL
 14184                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14185                 MOVE SPACES     TO W-SQUEEZED-LINE
 14186                                    W-WORK-LINE
 14187                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14188                 GO TO 7450-EXIT
 14189         ELSE
 14190             IF  W-ADJUST-TO-LINE-LENGTH
 14191                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 14192
 14193                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14194                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14195                     SET W-SQ-NDX
 14196                                 TO W-INITIAL-COLUMN
 14197                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14198                             VARYING
 14199                         W-WC-NDX FROM 1 BY 1
 14200                             UNTIL
 14201                         W-SQ-NDX EQUAL W-TOO-FAR
 14202                     MOVE W-TX-PC (W-TG-NDX)
 14203                                 TO W-PRINT-CONTROL
 14204                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14205                     SET W-SQ-NDX
 14206                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 300
* EL689.cbl
 14207                     MOVE SPACES TO W-SQUEEZED-LINE
 14208                                    W-WORK-LINE
 14209                     GO TO 7450-EXIT
 14210                 ELSE
 14211                     SET W-SQ-NDX
 14212                                 TO W-INITIAL-COLUMN
 14213                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14214                             VARYING
 14215                         W-WC-NDX FROM 1 BY 1
 14216                             UNTIL
 14217                         W-SQ-NDX EQUAL W-TOO-FAR
 14218                     MOVE W-TX-PC (W-TG-NDX)
 14219                                 TO W-PRINT-CONTROL
 14220                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14221                     MOVE SPACES TO W-SQUEEZED-LINE
 14222                                    W-WORK-LINE
 14223                     SET W-SQ-NDX
 14224                                 TO W-INITIAL-COLUMN
 14225                     GO TO 7450-EXIT
 14226             ELSE
 14227                 IF  W-CONTINUE-PARAGRAPH
 14228                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14229                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14230                         PERFORM 7610-SET-CONP-INDENT
 14231                             THRU 7610-EXIT
 14232                         MOVE SPACES
 14233                                 TO W-LINE-SQUEEZE-IND
 14234                         MOVE W-TX-PC (W-TG-NDX)
 14235                                 TO W-PRINT-CONTROL
 14236                         MOVE SPACES
 14237                                 TO W-SQUEEZED-LINE
 14238                         SET W-SQ-NDX
 14239                                 TO W-INITIAL-COLUMN
 14240                         SET W-SQ-NDX UP BY W-WORK-INDENT
 14241                     ELSE
 14242                         PERFORM 7610-SET-CONP-INDENT
 14243                             THRU 7610-EXIT
 14244                         MOVE SPACES
 14245                                 TO W-LINE-SQUEEZE-IND
 14246                         MOVE W-TX-PC (W-TG-NDX)
 14247                                 TO W-PRINT-CONTROL
 14248                         MOVE SPACES
 14249                                 TO W-SQUEEZED-LINE
 14250                         SET W-SQ-NDX
 14251                                 TO W-INITIAL-COLUMN
 14252                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 14253
 14254
 14255     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 14256             VARYING
 14257         W-WC-NDX FROM +1 BY +1
 14258             UNTIL
 14259         W-WC-NDX GREATER THAN +70.
 14260
 14261 7450-EXIT.
 14262     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 301
* EL689.cbl
 14264 7460-REMAIN-CHAR-CHECK.
 14265
 14266     IF  W-TX-NDX EQUAL W-WC-NDX
 14267         MOVE W-TX-PC (W-TG-NDX)
 14268                                 TO W-PRINT-CONTROL
 14269         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 14270         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14271         MOVE SPACES             TO W-WORK-LINE
 14272         SET W-WC-NDX            TO +1
 14273     ELSE
 14274         SET W-TX-NDX1           TO W-TX-NDX
 14275         SEARCH W-TX-CHAR
 14276             VARYING W-TX-NDX1
 14277             AT END
 14278                 MOVE W-TX-PC (W-TG-NDX)
 14279                                 TO W-PRINT-CONTROL
 14280                 MOVE W-WORK-LINE
 14281                                 TO W-SQUEEZED-LINE
 14282                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14283                 MOVE SPACES     TO W-WORK-LINE
 14284                 SET W-WC-NDX    TO +1
 14285                 SET W-TX-NDX    TO +1
 14286                 SET W-TG-NDX UP BY +1
 14287             WHEN
 14288                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 14289                 MOVE ER-9427    TO EMI-ERROR
 14290                 MOVE -1         TO MAINTL
 14291                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14292                 MOVE W-TX-PC (W-TG-NDX)
 14293                                 TO W-PRINT-CONTROL
 14294                 MOVE W-WORK-LINE
 14295                                 TO W-SQUEEZED-LINE
 14296                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14297                 MOVE SPACES     TO W-WORK-LINE
 14298                 SET W-WC-NDX    TO +1.
 14299
 14300 7460-EXIT.
 14301     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 302
* EL689.cbl
 14303 7470-MOVE-CHAR.
 14304
 14305     IF  W-FIRST-CHAR-NOT-FOUND
 14306             AND
 14307         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14308         MOVE SPACES             TO W-LAST-CHAR
 14309         GO TO 7470-EXIT.
 14310
 14311     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 14312
 14313     IF  W-SQUEEZE-FIELD
 14314             AND
 14315         W-LAST-CHAR EQUAL SPACES
 14316             AND
 14317         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14318         GO TO 7470-EXIT.
 14319
 14320     SET W-WC-NDX UP BY +1.
 14321
 14322     IF  W-WC-NDX GREATER THAN +70
 14323         IF  W-FORM-SQUEEZE-ON
 14324             GO TO 7470-EXIT
 14325         ELSE
 14326             MOVE ER-9427        TO EMI-ERROR
 14327             MOVE -1             TO MAINTL
 14328             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14329             GO TO 7470-EXIT.
 14330
 14331     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14332             AND
 14333         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14334             AND
 14335         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14336             AND
 14337         (W-VC-NDX GREATER THAN +1
 14338                 AND
 14339             W-LAST-CHAR NOT EQUAL SPACE
 14340                 AND
 14341             NOT W-LAST-CHAR-PUNC)
 14342         IF  W-LC-USE-BOTH-CASES
 14343             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14344                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 14345         ELSE
 14346             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14347                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 14348
 14349     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14350                                 TO W-WORK-CHAR (W-WC-NDX)
 14351                                    W-LAST-CHAR.
 14352
 14353     IF  W-LAST-CHAR EQUAL SPACES
 14354         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 14355
 14356 7470-EXIT.
 14357     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 303
* EL689.cbl
 14359 7480-UPDATE-SQUEEZED-LINE.
 14360****************************************************************
 14361*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 14362*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 14363*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 14364*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 14365*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 14366*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 14367****************************************************************
 14368
 14369     SET W-SQ-NDX UP BY +1.
 14370
 14371     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 14372         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 14373                                 TO W-CHARACTER-TYPE
 14374         IF  W-PUNCTUATION
 14375                 OR
 14376             W-SPACE
 14377             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 14378             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14379             MOVE SPACES         TO W-SQUEEZED-LINE
 14380             SET W-SQ-NDX        TO W-START-COLUMN
 14381             SET W-SQ-NDX UP BY W-NEXT-INDENT
 14382             SET W-LAST-SQUEEZED-SPACE
 14383                                 TO W-SQ-NDX
 14384         ELSE
 14385             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 14386             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14387             MOVE SPACES         TO W-SQUEEZED-LINE
 14388             SET W-SQ-NDX        TO W-START-COLUMN
 14389             SET W-SQ-NDX UP BY W-NEXT-INDENT
 14390             SET W-LAST-SQUEEZED-SPACE
 14391                                 TO W-SQ-NDX.
 14392
 14393     IF  W-WC-NDX GREATER THAN +70
 14394         GO TO 7480-EXIT.
 14395
 14396     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 14397
 14398     IF  W-END-OF-SENTENCE
 14399         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 14400         SET W-WORK-NDX          TO W-SQ-NDX
 14401         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 14402         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 14403             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 14404         ELSE
 14405             NEXT SENTENCE
 14406     ELSE
 14407         IF  W-PUNCTUATION
 14408                 AND
 14409             W-LAST-SQ-CHAR EQUAL SPACES
 14410             SET W-SQ-NDX DOWN BY +1
 14411             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 14412         ELSE
 14413             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 14414                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 14415                     IF  W-END-OF-SENTENCE-WORKING
 14416                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 304
* EL689.cbl
 14417                                 TO W-END-OF-SENTENCE-IND
 14418                         SET W-LAST-SQUEEZED-SPACE
 14419                                 TO W-SQ-NDX
 14420                     ELSE
 14421                         SET W-SQ-NDX DOWN BY +1
 14422                         GO TO 7480-EXIT
 14423                 ELSE
 14424                     SET W-LAST-SQUEEZED-SPACE
 14425                                 TO W-SQ-NDX
 14426             ELSE
 14427                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 14428
 14429     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 14430                                    W-LAST-SQ-CHAR.
 14431
 14432     IF  W-WC-NDX EQUAL +70
 14433             AND
 14434         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 14435             AND
 14436         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 14437         SET W-SQ-NDX UP BY +1
 14438         SET W-LAST-SQUEEZED-SPACE
 14439                                 TO W-SQ-NDX
 14440         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 14441                                    W-LAST-SQ-CHAR.
 14442
 14443 7480-EXIT.
 14444     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 305
* EL689.cbl
 14446 7485-FIND-NEXT-CHARACTER.
 14447
 14448     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 14449
 14450     IF  W-PUNCTUATION
 14451         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 14452     ELSE
 14453         SET W-WC-NDX            TO W-WC-NDX
 14454         SEARCH W-WORK-CHAR
 14455             VARYING W-WC-NDX
 14456             AT END
 14457                 GO TO 7485-EXIT
 14458             WHEN
 14459                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 14460                 GO TO 7485-EXIT.
 14461
 14462 7485-EXIT.
 14463     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 306
* EL689.cbl
 14465 7490-REMOVE-LAST-WORD.
 14466
 14467*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 14468     IF  W-WC-NDX EQUAL +1
 14469         GO TO 7490-EXIT.
 14470
 14471     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 14472
 14473     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 14474             VARYING
 14475         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 14476             UNTIL
 14477         W-SQ-NDX EQUAL W-TOO-FAR.
 14478
 14479     SET W-WORK-NDX              TO W-WC-NDX.
 14480     COMPUTE W-LAST-WC-SPACE
 14481         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 14482     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 14483
 14484 7490-EXIT.
 14485     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 307
* EL689.cbl
 14487 7500-CLEAR-SQUEEZED-EXCESS.
 14488
 14489     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 14490
 14491 7500-EXIT.
 14492     EXIT.
 14493
 14494 7505-MOVE-STRAIGHT.
 14495
 14496     SET W-SQ-NDX UP BY +1.
 14497
 14498     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 14499
 14500 7505-EXIT.
 14501     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 308
* EL689.cbl
 14503 7510-MOVE-TO-TABLE.
 14504
 14505     IF  W-PRINT-CONTROL NOT NUMERIC
 14506         MOVE 00                 TO W-PRINT-CONTROL
 14507         ADD +1                  TO W-LINE-COUNT
 14508     ELSE
 14509         IF  W-PRINT-CONTROL EQUAL 99
 14510             PERFORM 7640-PAGING THRU 7640-EXIT
 14511             MOVE 00             TO W-PRINT-CONTROL
 14512             SET W-RG-NDX UP BY +1
 14513             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 14514             MOVE +1             TO W-LINE-COUNT
 14515             SET W-RG-NDX UP BY W-TOP-MARGIN
 14516         ELSE
 14517             COMPUTE W-LINE-COUNT
 14518                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 14519
 14520     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 14521         PERFORM 7640-PAGING THRU 7640-EXIT
 14522         MOVE 00                 TO W-PRINT-CONTROL
 14523         SET W-RG-NDX UP BY +1
 14524         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 14525         SET W-RG-NDX UP BY W-TOP-MARGIN
 14526         MOVE +1                 TO W-LINE-COUNT.
 14527
 14528     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 14529     SET W-RG-NDX UP BY +1.
 14530     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 14531     MOVE 00                     TO W-PRINT-CONTROL.
 14532
 14533     IF  W-FIRST-BAD-VARIABLE-FOUND
 14534             AND
 14535         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14536         SET W-FIRST-BAD-VARIABLE
 14537                                 TO W-RG-NDX.
 14538
 14539 7510-EXIT.
 14540     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 309
* EL689.cbl
 14542 7600-SET-PARA-INDENT.
 14543
 14544     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 14545         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 14546     ELSE
 14547     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 14548         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 14549         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14550     ELSE
 14551     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 14552         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 14553         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14554     ELSE
 14555     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 14556         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 14557         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14558     ELSE
 14559     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 14560         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 14561         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14562     ELSE
 14563     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 14564         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 14565         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 14566
 14567     SET W-TG-NDX2               TO W-TG-NDX.
 14568     SET W-TG-NDX2 UP BY +1.
 14569
 14570     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 14571         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14572     ELSE
 14573         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 14574
 14575 7600-EXIT.
 14576     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 310
* EL689.cbl
 14578 7610-SET-CONP-INDENT.
 14579
 14580     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 14581         MOVE +0                 TO W-WORK-INDENT
 14582     ELSE
 14583     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 14584         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 14585     ELSE
 14586     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 14587         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 14588     ELSE
 14589     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 14590         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 14591     ELSE
 14592     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 14593         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 14594     ELSE
 14595     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 14596         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 14597
 14598     SET W-TG-NDX2               TO W-TG-NDX.
 14599     SET W-TG-NDX2 UP BY +1.
 14600
 14601     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 14602         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14603     ELSE
 14604         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 14605
 14606 7610-EXIT.
 14607     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 311
* EL689.cbl
 14609 7630-NEXT-LINE.
 14610
 14611     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 14612         MOVE ZEROS              TO W-NEXT-INDENT
 14613     ELSE
 14614     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 14615         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 14616     ELSE
 14617     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 14618         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 14619     ELSE
 14620     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 14621         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 14622     ELSE
 14623     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 14624         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 14625     ELSE
 14626     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 14627         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 14628     ELSE
 14629         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14630         SUBTRACT W-PARAGRAPH-INDENT
 14631                                  FROM W-NEXT-INDENT.
 14632
 14633 7630-EXIT.
 14634     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 312
* EL689.cbl
 14636 7640-PAGING.
 14637
 14638     IF  NOT W-LC-CREATE-PAGES
 14639         GO TO 7640-EXIT.
 14640
 14641     IF  W-LINE-COUNT GREATER ZEROS
 14642             AND
 14643         W-RG-NDX GREATER THAN +1
 14644         ADD +1                  TO W-PAGE
 14645         MOVE W-PAGE             TO W-PAGE-NUMBER
 14646         COMPUTE W-PAGE-LINE
 14647             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 14648         IF  W-PAGE-LINE GREATER THAN +2
 14649             SET W-RG-NDX UP BY W-PAGE-LINE
 14650             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 14651         ELSE
 14652             SET W-RG-NDX UP BY +2
 14653             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 14654
 14655 7640-EXIT.
 14656     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 313
* EL689.cbl
 14658 7700-READ-TEXT-TS.
 14659**************************************************************
 14660*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 14661*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 14662*  AND EL1042.                                               *
 14663**************************************************************
 14664
 14665
 14666* EXEC CICS HANDLE CONDITION
 14667*         QIDERR     (7700-TS-ERROR)
 14668*         ITEMERR    (7700-TS-ERROR)
 14669*    END-EXEC.
 14670*    MOVE '"$N<                  ! > #00013676' TO DFHEIV0
 14671     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 14672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14673     MOVE X'3E20233030303133363736' TO DFHEIV0(25:11)
 14674     CALL 'kxdfhei1' USING DFHEIV0
 14675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14676
 14677
 14678     SET W-TS-NDX                TO 1.
 14679     MOVE 1                      TO W-TS-ITEM.
 14680
 14681 7700-LOOP.
 14682
 14683     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 14684         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 14685             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 14686             GO TO 7700-EXIT
 14687         ELSE
 14688             GO TO 7700-EXIT.
 14689
 14690
 14691* EXEC CICS READQ TS
 14692*         INTO     (W-TS-WORK-AREA)
 14693*         QUEUE    (W-TS-NAME-TEXT)
 14694*         LENGTH   (W-TS-LENGTH)
 14695*         ITEM     (W-TS-ITEM)
 14696*    END-EXEC.
 14697*    MOVE '*$II   L              ''   #00013693' TO DFHEIV0
 14698     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 14699     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14700     MOVE X'2020233030303133363933' TO DFHEIV0(25:11)
 14701     CALL 'kxdfhei1' USING DFHEIV0,
 14702           W-TS-NAME-TEXT,
 14703           W-TS-WORK-AREA,
 14704           W-TS-LENGTH,
 14705           W-TS-ITEM,
 14706           DFHEIV99,
 14707           DFHEIV99
 14708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14709
 14710
 14711     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 14712     SET W-TS-NDX UP BY 1.
 14713     ADD 1                       TO W-TS-ITEM.
 14714     GO TO 7700-LOOP.
 14715
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 314
* EL689.cbl
 14716 7700-TS-ERROR.
 14717
 14718     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 14719         MOVE ER-0033            TO EMI-ERROR
 14720         MOVE -1                 TO MAINTL
 14721         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14722         GO TO 8200-SEND-DATAONLY.
 14723
 14724 7700-EXIT.
 14725      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 315
* EL689.cbl
 14727 7740-RESTORE-SCREEN.
 14728
 14729     MOVE 'C'                    TO MAINTI.
 14730     MOVE +1                     TO MAINTL.
 14731     MOVE AL-UANON               TO MAINTA.
 14732
 14733     MOVE PI-689-FORM-NUMBER     TO FORMI.
 14734     MOVE +4                     TO FORML.
 14735     MOVE AL-UANON               TO FORMA.
 14736
 14737     IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 14738         MOVE PI-689-PRINT-RESTRICTION
 14739                                 TO PRTRESTL
 14740         MOVE +1                 TO PRTRESTL
 14741         MOVE AL-UANON           TO PRTRESTA.
 14742
 14743     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 14744         MOVE PI-689-FOLLOW-UP-EDIT
 14745                                 TO FOLLOWI
 14746         MOVE +8                 TO FOLLOWL
 14747         MOVE AL-UANON           TO FOLLOWA.
 14748
 14749     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 14750         MOVE PI-689-RESEND1-EDIT
 14751                                 TO RESEND1I
 14752         MOVE +8                 TO RESEND1L
 14753         MOVE AL-UANON           TO RESEND1A.
 14754     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 14755         MOVE PI-689-ALT-PRINTER-ID
 14756                                 TO PRINTERI
 14757         MOVE +1                 TO PRINTERL
 14758         MOVE AL-UANON           TO PRINTERA.
 14759
 14760     IF  PI-BYPASS-LABELS
 14761          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 14762          MOVE +1                TO ADDRLBLL
 14763          MOVE AL-UANON          TO ADDRLBLA
 14764     ELSE
 14765          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 14766               MOVE PI-689-LBL-OVERRIDE
 14767                                 TO ADDRLBLI
 14768               MOVE +1           TO ADDRLBLL
 14769               MOVE AL-UANON     TO ADDRLBLA.
 14770
 14771     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 14772         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 14773         MOVE +1                     TO COPIESL
 14774         MOVE AL-UNNON               TO COPIESA.
 14775
 14776     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 14777         MOVE PI-689-LABEL-SOURCE
 14778                                 TO ADDRSI
 14779         MOVE +1                 TO ADDRSL
 14780         MOVE AL-UANON           TO ADDRSA.
 14781
 14782     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 14783     MOVE +1                     TO DATASORL.
 14784     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 316
* EL689.cbl
 14785
 14786     IF  PI-689-CARRIER GREATER THAN SPACES
 14787         MOVE PI-689-CARRIER     TO CARRIERI
 14788         MOVE +1                 TO CARRIERL
 14789         MOVE AL-UANON           TO CARRIERA.
 14790
 14791     IF  PI-689-GROUPING GREATER THAN SPACES
 14792         MOVE PI-689-GROUPING    TO GROUPI
 14793         MOVE +6                 TO GROUPL
 14794         MOVE AL-UANON           TO GROUPA.
 14795
 14796     IF  PI-689-STATE GREATER THAN SPACES
 14797         MOVE PI-689-STATE       TO STATEI
 14798         MOVE +2                 TO STATEL
 14799         MOVE AL-UANON           TO STATEA.
 14800
 14801     IF  PI-689-ACCOUNT GREATER THAN SPACES
 14802         MOVE PI-689-ACCOUNT     TO ACCTI
 14803         MOVE +10                TO ACCTL
 14804         MOVE AL-UANON           TO ACCTA.
 14805
 14806     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 14807         MOVE PI-689-CERT-PRIME  TO CERTI
 14808         MOVE +10                TO CERTL
 14809         MOVE AL-UANON           TO CERTA.
 14810
 14811     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 14812         MOVE PI-689-CERT-SFX    TO SFXI
 14813         MOVE +1                 TO SFXL
 14814         MOVE AL-UANON           TO SFXA.
 14815
 14816     IF  PI-689-TYPE GREATER THAN SPACES
 14817         MOVE PI-689-TYPE        TO TYPEI
 14818         MOVE +1                 TO TYPEL
 14819         MOVE AL-UANON           TO TYPEA.
 14820
 14821     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 14822         MOVE PI-689-RESP-PERSON TO RPERSONI
 14823         MOVE +10                TO RPERSONL
 14824         MOVE AL-UANON           TO RPERSONA.
 14825
 14826     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 14827         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 14828         MOVE +6                 TO BENTRYL
 14829         MOVE AL-UANON           TO BENTRYA.
 14830
 14831     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 14832         MOVE PI-689-SEQ-EDIT    TO SEQI
 14833         MOVE +8                 TO SEQL
 14834         MOVE AL-UNNON           TO SEQA.
 14835
 14836     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 14837         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 14838         MOVE +4                 TO BCSEQL
 14839         MOVE AL-UNNON           TO BCSEQA.
 14840
 14841     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 14842         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 317
* EL689.cbl
 14843         MOVE +8                 TO DATEL
 14844         MOVE AL-UNNON           TO DATEA.
 14845
 14846 7749-EXIT.
 14847     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 318
* EL689.cbl
 14849 7760-PUT-TEMP-STORAGE.
 14850**************************************************************
 14851*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 14852*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 14853*  EL1042 AND EL6892.                                        *
 14854**************************************************************
 14855
 14856     SET W-TS-NDX                TO 1.
 14857     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 14858
 14859     MOVE -1                     TO MAINTL.
 14860     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 14861             VARYING
 14862         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 14863             UNTIL
 14864         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 14865
 14866 7760-EXIT.
 14867      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 319
* EL689.cbl
 14869 7780-DELETE-TEMP-STOR-TEXT.
 14870
 14871
 14872* EXEC CICS HANDLE CONDITION
 14873*         QIDERR      (7780-EXIT)
 14874*    END-EXEC.
 14875*    MOVE '"$N                   ! ? #00013860' TO DFHEIV0
 14876     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 14877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14878     MOVE X'3F20233030303133383630' TO DFHEIV0(25:11)
 14879     CALL 'kxdfhei1' USING DFHEIV0
 14880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14881
 14882
 14883
 14884* EXEC CICS DELETEQ TS
 14885*         QUEUE       (W-TS-NAME-TEXT)
 14886*    END-EXEC.
 14887*    MOVE '*&                    #   #00013864' TO DFHEIV0
 14888     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 14889     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14890     MOVE X'2020233030303133383634' TO DFHEIV0(25:11)
 14891     CALL 'kxdfhei1' USING DFHEIV0,
 14892           W-TS-NAME-TEXT,
 14893           DFHEIV99
 14894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14895
 14896
 14897 7780-EXIT.
 14898     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 320
* EL689.cbl
 14900 7840-WRITE-TS.
 14901
 14902     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 14903     SET W-TS-NDX UP BY 1.
 14904     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 14905
 14906
 14907* EXEC CICS WRITEQ TS
 14908*         FROM    (W-TS-WORK-AREA)
 14909*         QUEUE   (W-TS-NAME-TEXT)
 14910*         LENGTH  (W-TS-LENGTH)
 14911*         ITEM    (PI-TEMP-STOR-ITEMS)
 14912*    END-EXEC.
 14913*    MOVE '*" I                  ''   #00013877' TO DFHEIV0
 14914     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 14915     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14916     MOVE X'2020233030303133383737' TO DFHEIV0(25:11)
 14917     CALL 'kxdfhei1' USING DFHEIV0,
 14918           W-TS-NAME-TEXT,
 14919           W-TS-WORK-AREA,
 14920           W-TS-LENGTH,
 14921           PI-TEMP-STOR-ITEMS,
 14922           DFHEIV99,
 14923           DFHEIV99
 14924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14925
 14926
 14927 7840-EXIT.
 14928     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 321
* EL689.cbl
 14930 7900-PRINT-LETTER-NOW.
 14931***************************************************************
 14932*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 14933*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 14934*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 14935*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 14936*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 14937*     ISSUED FOR THE PRINT TRANSACTION.                       *
 14938***************************************************************
 14939
 14940     IF (EIBAID = DFHPF4 OR DFHPF8)
 14941             AND
 14942         PI-SHOW-MODE
 14943         IF  PRINTERL GREATER ZERO
 14944             INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 14945                                                     W-UPPER-CASE
 14946             MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 14947                                    PI-ALT-DMD-PRT-ID.
 14948
 14949     IF  EIBAID EQUAL DFHPF8
 14950             AND
 14951         PI-SHOW-MODE
 14952             AND
 14953         LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 14954         MOVE ER-7247            TO EMI-ERROR
 14955         MOVE -1                 TO MAINTL
 14956         MOVE AL-UABON           TO MAINTA
 14957         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14958         GO TO 8200-SEND-DATAONLY.
 14959
 14960     IF  PI-TOTAL-LINES EQUAL 0
 14961         MOVE ER-0187            TO EMI-ERROR
 14962         MOVE -1                 TO MAINTL
 14963         MOVE AL-UABON           TO MAINTA
 14964         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14965         GO TO 8200-SEND-DATAONLY.
 14966
 14967     IF  EMI-ERROR NOT EQUAL ER-0191
 14968         IF  PI-689-CREATE-NO-SCREENS
 14969                 OR
 14970             (EIBAID = DFHPF4 OR DFHPF8)
 14971             SET W-RG-NDX        TO +1
 14972         ELSE
 14973             PERFORM 4100-SET-NDX THRU 4100-EXIT
 14974             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 14975                     VARYING
 14976                 W-SC-NDX FROM 1 BY 1
 14977                     UNTIL
 14978                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 14979
 14980     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 14981
 14982     IF EIBAID NOT = DFHPF4 AND DFHPF8
 14983         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 14984                 VARYING
 14985             W-RVS-NDX FROM +1 BY +1
 14986                 UNTIL
 14987             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 322
* EL689.cbl
 14988                 OR
 14989             W-REMAINING-VAR-FOUND
 14990         IF  W-REMAINING-VAR-FOUND
 14991             GO TO 4000-ROLL-PAGE.
 14992
 14993     IF EIBAID = DFHPF4 OR DFHPF8
 14994        PERFORM 7700-READ-TEXT-TS
 14995                                 THRU 7700-EXIT
 14996         PERFORM 4100-SET-NDX THRU 4100-EXIT
 14997         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 14998                 VARYING
 14999             W-SC-NDX FROM 1 BY 1
 15000                 UNTIL
 15001             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 15002        PERFORM 7760-PUT-TEMP-STORAGE
 15003                                 THRU 7760-EXIT
 15004     END-IF
 15005     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 15006         MOVE PI-689-ALT-PRINTER-ID
 15007                                 TO W-TS-TERM-TEXT
 15008     ELSE
 15009         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 15010             MOVE PI-PROCESSOR-PRINTER
 15011                                 TO W-TS-TERM-TEXT
 15012         ELSE
 15013             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 15014             MOVE '1'            TO W-CNTL-RECORD-TYPE
 15015             MOVE SPACES         TO W-CNTL-GENL
 15016             MOVE ZEROS          TO W-CNTL-SEQ-NO
 15017
 15018* EXEC CICS HANDLE CONDITION
 15019*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 15020*                 NOTFND     (7945-NOT-FOUND)
 15021*            END-EXEC
 15022*    MOVE '"$JI                  ! @ #00013974' TO DFHEIV0
 15023     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 15024     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15025     MOVE X'4020233030303133393734' TO DFHEIV0(25:11)
 15026     CALL 'kxdfhei1' USING DFHEIV0
 15027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15028
 15029* EXEC CICS READ
 15030*                 DATASET    (W-CNTL-FILE-ID)
 15031*                 SET        (ADDRESS OF CONTROL-FILE)
 15032*                 RIDFLD     (W-CNTL-KEY)
 15033*            END-EXEC
 15034*    MOVE '&"S        E          (   #00013978' TO DFHEIV0
 15035     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15036     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15037     MOVE X'2020233030303133393738' TO DFHEIV0(25:11)
 15038     CALL 'kxdfhei1' USING DFHEIV0,
 15039           W-CNTL-FILE-ID,
 15040           DFHEIV20,
 15041           DFHEIV99,
 15042           W-CNTL-KEY,
 15043           DFHEIV99,
 15044           DFHEIV99,
 15045           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 323
* EL689.cbl
 15046     SET ADDRESS OF CONTROL-FILE TO
 15047         DFHEIV20
 15048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15049             MOVE CF-FORMS-PRINTER-ID
 15050                                 TO W-TS-TERM-TEXT.
 15051
 15052***********************************************************
 15053*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 15054*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 15055***********************************************************
 15056
 15057     SET W-TS-NDX                TO 1.
 15058     MOVE EIBTIME                TO W-TS-ID-TIME.
 15059     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 15060     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 15061
 15062     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 15063             VARYING
 15064         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 15065             UNTIL
 15066         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 15067
 15068     IF  EIBAID EQUAL DFHPF8
 15069         MOVE '1'                TO PI-689-PRINT-SW
 15070     ELSE
 15071         MOVE SPACES             TO PI-689-PRINT-SW.
 15072
 15073
 15074* EXEC CICS HANDLE CONDITION
 15075*         TERMIDERR  (7935-TERM-ERROR)
 15076*         TRANSIDERR (7940-TRAN-ERROR)
 15077*    END-EXEC.
 15078*    MOVE '"$[\                  ! A #00014007' TO DFHEIV0
 15079     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 15080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15081     MOVE X'4120233030303134303037' TO DFHEIV0(25:11)
 15082     CALL 'kxdfhei1' USING DFHEIV0
 15083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15084
 15085
 15086
 15087* EXEC CICS START
 15088*             INTERVAL    (0)
 15089*             TRANSID     (W-PRINT-TRANS)
 15090*             FROM        (PROGRAM-INTERFACE-BLOCK)
 15091*             LENGTH      (PI-COMM-LENGTH)
 15092*             TERMID      (W-TS-TERM-TEXT)
 15093*    END-EXEC.
 15094     MOVE 0 TO DFHEIV10
 15095*    MOVE '0(ILFT                0   #00014012' TO DFHEIV0
 15096     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 15097     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
 15098     MOVE X'2020233030303134303132' TO DFHEIV0(25:11)
 15099     CALL 'kxdfhei1' USING DFHEIV0,
 15100           DFHEIV10,
 15101           W-PRINT-TRANS,
 15102           DFHEIV99,
 15103           PROGRAM-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 324
* EL689.cbl
 15104           PI-COMM-LENGTH,
 15105           W-TS-TERM-TEXT,
 15106           DFHEIV99,
 15107           DFHEIV99,
 15108           DFHEIV99,
 15109           DFHEIV99,
 15110           DFHEIV99,
 15111           DFHEIV99,
 15112           DFHEIV99,
 15113           DFHEIV99,
 15114           DFHEIV99
 15115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15116
 15117
 15118
 15119* EXEC CICS SYNCPOINT
 15120*    END-EXEC.
 15121*    MOVE '6"                    !   #00014020' TO DFHEIV0
 15122     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 15123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15124     MOVE X'2020233030303134303230' TO DFHEIV0(25:11)
 15125     CALL 'kxdfhei1' USING DFHEIV0
 15126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15127
 15128
 15129     IF  PI-689-CREATE-NO-SCREENS
 15130         GO TO 7900-EXIT.
 15131
 15132     IF  EIBAID EQUAL DFHPF8
 15133             AND
 15134         PI-SHOW-MODE
 15135             AND
 15136         LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 15137         PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 15138
 15139     MOVE ER-0189                TO EMI-ERROR.
 15140     MOVE -1                     TO MAINTL.
 15141
 15142     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 15143     MOVE -1                     TO MAINTL
 15144     MOVE AL-UABON               TO MAINTA
 15145     MOVE '104A'                 TO W-TS-ID-TEXT
 15146     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 15147                                    W-TS-TERM-SCREEN
 15148     GO TO 8200-SEND-DATAONLY.
 15149
 15150 7900-EXIT.
 15151     EXIT.
 15152
 15153 7915-SEARCH-REMAINING-VARS.
 15154
 15155     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 15156         SET W-RVS-NDX2          TO W-RVS-NDX
 15157         SET W-RVS-NDX2 UP BY +1
 15158         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
 15159             SET W-RVS-NDX2 UP BY +1
 15160             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 15161                 SET PI-CURRENT-LINE  TO W-RVS-NDX
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 325
* EL689.cbl
 15162                 COMPUTE PI-CURRENT-LINE
 15163                     = PI-CURRENT-LINE / 73
 15164                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 15165                 MOVE +0         TO W-ROLL-COUNTER
 15166                 MOVE ER-0191    TO EMI-ERROR
 15167                 MOVE -1         TO MAINTL
 15168                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15169
 15170 7915-EXIT.
 15171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 326
* EL689.cbl
 15173 7920-UPDATE-INITIAL-PRINT.
 15174
 15175
 15176* EXEC CICS HANDLE CONDITION
 15177*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 15178*         NOTFND     (1070-ARCH-NOT-FOUND)
 15179*         ENDFILE    (1070-ARCH-NOT-FOUND)
 15180*    END-EXEC.
 15181*    MOVE '"$JI''                 ! B #00014069' TO DFHEIV0
 15182     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 15183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15184     MOVE X'4220233030303134303639' TO DFHEIV0(25:11)
 15185     CALL 'kxdfhei1' USING DFHEIV0
 15186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15187
 15188     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 15189     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 15190
 15191* EXEC CICS READ
 15192*        DATASET (W-ARCH-FILE-ID)
 15193*        SET     (ADDRESS OF LETTER-ARCHIVE)
 15194*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 15195*        UPDATE
 15196*    END-EXEC.
 15197*    MOVE '&"S        EU         (   #00014076' TO DFHEIV0
 15198     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15199     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15200     MOVE X'2020233030303134303736' TO DFHEIV0(25:11)
 15201     CALL 'kxdfhei1' USING DFHEIV0,
 15202           W-ARCH-FILE-ID,
 15203           DFHEIV20,
 15204           DFHEIV99,
 15205           W-ARCH-PARTIAL-KEY,
 15206           DFHEIV99,
 15207           DFHEIV99,
 15208           DFHEIV99
 15209     SET ADDRESS OF LETTER-ARCHIVE TO
 15210         DFHEIV20
 15211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15212
 15213
 15214     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 15215
 15216     IF  LA-RESEND-DATE = LOW-VALUES
 15217         MOVE 'C'                TO LA-STATUS.
 15218
 15219
 15220* EXEC CICS REWRITE
 15221*         FROM      (LETTER-ARCHIVE)
 15222*         DATASET   (W-ARCH-FILE-ID)
 15223*    END-EXEC.
 15224     MOVE LENGTH OF
 15225      LETTER-ARCHIVE
 15226       TO DFHEIV11
 15227*    MOVE '&& L                  %   #00014088' TO DFHEIV0
 15228     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15229     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15230     MOVE X'2020233030303134303838' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 327
* EL689.cbl
 15231     CALL 'kxdfhei1' USING DFHEIV0,
 15232           W-ARCH-FILE-ID,
 15233           LETTER-ARCHIVE,
 15234           DFHEIV11,
 15235           DFHEIV99
 15236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15237
 15238
 15239 7920-EXIT.
 15240     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 328
* EL689.cbl
 15242 7935-TERM-ERROR.
 15243
 15244     MOVE ER-0412                TO EMI-ERROR.
 15245     MOVE SPACES                 TO PI-689-PRINT-SW.
 15246     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15247     MOVE -1                     TO MAINTL.
 15248     GO TO 8200-SEND-DATAONLY.
 15249
 15250 7940-TRAN-ERROR.
 15251
 15252     MOVE ER-0413                TO EMI-ERROR.
 15253     MOVE SPACES                 TO PI-689-PRINT-SW.
 15254     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15255     MOVE -1                     TO MAINTL.
 15256     GO TO 8200-SEND-DATAONLY.
 15257
 15258 7945-NOT-FOUND.
 15259
 15260     MOVE ER-0190                TO EMI-ERROR.
 15261     MOVE -1                     TO MAINTL.
 15262     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15263     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 329
* EL689.cbl
 15265 8010-ARCH-NOT-OPEN.
 15266
 15267     MOVE ER-7388                TO EMI-ERROR.
 15268     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15269     MOVE -1                     TO MAINTL.
 15270     GO TO 8200-SEND-DATAONLY.
 15271
 15272 8015-ARCT-NOT-OPEN.
 15273
 15274     MOVE ER-7373                TO EMI-ERROR.
 15275     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15276     MOVE -1                     TO MAINTL.
 15277     GO TO 8200-SEND-DATAONLY.
 15278
 15279 8020-ACCT-NOT-OPEN.
 15280
 15281     MOVE ER-0168 TO EMI-ERROR
 15282     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15283     MOVE -1                     TO MAINTL.
 15284     GO TO 8200-SEND-DATAONLY.
 15285
 15286 8030-CERT-NOT-OPEN.
 15287
 15288     MOVE ER-0169 TO EMI-ERROR.
 15289     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15290     MOVE -1                     TO MAINTL.
 15291     GO TO 8200-SEND-DATAONLY.
 15292
 15293 8035-CERT-NOT-FOUND.
 15294
 15295     MOVE ER-2369 TO EMI-ERROR.
 15296     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15297     MOVE -1                     TO MAINTL.
 15298     GO TO 8200-SEND-DATAONLY.
 15299
 15300 8040-CNTL-NOT-OPEN.
 15301
 15302     MOVE ER-0042                TO EMI-ERROR.
 15303     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15304     MOVE -1                     TO MAINTL.
 15305     GO TO 8200-SEND-DATAONLY.
 15306
 15307 8045-CHEK-NOT-OPEN.
 15308
 15309     MOVE ER-3775                TO EMI-ERROR.
 15310     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15311     MOVE -1                     TO MAINTL.
 15312     GO TO 8200-SEND-DATAONLY.
 15313
 15314 8050-TEXT-NOT-OPEN.
 15315
 15316     MOVE ER-0013                TO EMI-ERROR.
 15317     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15318     MOVE -1                     TO MAINTL.
 15319     GO TO 8200-SEND-DATAONLY.
 15320
 15321 8060-PNDB-NOT-OPEN.
 15322
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 330
* EL689.cbl
 15323     MOVE ER-2216 TO EMI-ERROR.
 15324     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15325     MOVE -1                     TO MAINTL.
 15326     GO TO 8200-SEND-DATAONLY.
 15327
 15328 8070-PNDB-NOT-FOUND.
 15329
 15330     MOVE ER-7374 TO EMI-ERROR.
 15331     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15332     MOVE -1                     TO MAINTL.
 15333     GO TO 8200-SEND-DATAONLY.
 15334
 15335 8080-COMP-NOT-OPEN.
 15336
 15337     MOVE ER-2055 TO EMI-ERROR
 15338     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15339     MOVE -1                     TO MAINTL.
 15340     GO TO 8200-SEND-DATAONLY.
 15341
 15342 8085-PYAJ-NOT-OPEN.
 15343
 15344     MOVE ER-2232 TO EMI-ERROR
 15345     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15346     MOVE -1                     TO MAINTL.
 15347     GO TO 8200-SEND-DATAONLY.
 15348
 15349 8090-MAIL-NOT-OPEN.
 15350
 15351     MOVE ER-2999                TO EMI-ERROR.
 15352     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15353     MOVE -1                     TO MAINTL.
 15354     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 331
* EL689.cbl
 15356 8100-SEND-INITIAL-MAP.
 15357
 15358     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 15359     IF  PI-689-CREATE-NO-SCREENS
 15360         MOVE '9999'             TO PI-689-ERROR
 15361         GO TO 0620-RETURN-TO-CALLER.
 15362
 15363     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15364
 15365     IF  NOT EMI-NO-ERRORS
 15366         MOVE EMI-MESSAGE-AREA (1)
 15367                                 TO ERRMSGO
 15368     ELSE
 15369         MOVE SPACES             TO ERRMSGO.
 15370
 15371     IF NOT PI-CREATE-LABELS
 15372         MOVE AL-PANON           TO ADDRLBLA.
 15373
 15374
 15375* EXEC CICS SEND
 15376*        MAP    (W-MAP)
 15377*        MAPSET (W-MAPSET)
 15378*        FROM   (EL689AO)
 15379*        ERASE
 15380*        CURSOR
 15381*    END-EXEC.
 15382     MOVE LENGTH OF
 15383      EL689AO
 15384       TO DFHEIV12
 15385     MOVE -1
 15386       TO DFHEIV11
 15387*    MOVE '8$     CT  E    H L F ,   #00014228' TO DFHEIV0
 15388     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15389     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15390     MOVE X'2020233030303134323238' TO DFHEIV0(25:11)
 15391     CALL 'kxdfhei1' USING DFHEIV0,
 15392           W-MAP,
 15393           EL689AO,
 15394           DFHEIV12,
 15395           W-MAPSET,
 15396           DFHEIV99,
 15397           DFHEIV99,
 15398           DFHEIV99,
 15399           DFHEIV11,
 15400           DFHEIV99,
 15401           DFHEIV99,
 15402           DFHEIV99
 15403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15404
 15405
 15406     GO TO 9000-RETURN-TRANS.
 15407
 15408 8100-EXIT.
 15409     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 332
* EL689.cbl
 15411 8200-SEND-DATAONLY.
 15412
 15413     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 15414     IF  PI-689-CREATE-NO-SCREENS
 15415         MOVE '9999'             TO PI-689-ERROR
 15416         GO TO 0620-RETURN-TO-CALLER.
 15417
 15418     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15419
 15420     IF  NOT EMI-NO-ERRORS
 15421         MOVE EMI-MESSAGE-AREA (1)
 15422                                 TO ERRMSGO
 15423     ELSE
 15424         MOVE SPACES             TO ERRMSGO.
 15425
 15426
 15427* EXEC CICS SEND
 15428*        MAP    (W-MAP)
 15429*        MAPSET (W-MAPSET)
 15430*        FROM   (EL689AO)
 15431*        DATAONLY
 15432*        CURSOR
 15433*    END-EXEC.
 15434     MOVE LENGTH OF
 15435      EL689AO
 15436       TO DFHEIV12
 15437     MOVE -1
 15438       TO DFHEIV11
 15439*    MOVE '8$D    CT       H L F ,   #00014256' TO DFHEIV0
 15440     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15441     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15442     MOVE X'2020233030303134323536' TO DFHEIV0(25:11)
 15443     CALL 'kxdfhei1' USING DFHEIV0,
 15444           W-MAP,
 15445           EL689AO,
 15446           DFHEIV12,
 15447           W-MAPSET,
 15448           DFHEIV99,
 15449           DFHEIV99,
 15450           DFHEIV99,
 15451           DFHEIV11,
 15452           DFHEIV99,
 15453           DFHEIV99,
 15454           DFHEIV99
 15455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15456
 15457
 15458     GO TO 9000-RETURN-TRANS.
 15459
 15460 8200-EXIT.
 15461     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 333
* EL689.cbl
 15463 8300-SEND-TEXT.
 15464
 15465     IF  PI-689-CREATE-NO-SCREENS
 15466         MOVE '9999'             TO PI-689-ERROR
 15467         GO TO 0620-RETURN-TO-CALLER.
 15468
 15469
 15470* EXEC CICS SEND TEXT
 15471*        FROM    (LOGOFF-TEXT)
 15472*        LENGTH  (LOGOFF-LENGTH)
 15473*        ERASE
 15474*        FREEKB
 15475*    END-EXEC.
 15476*    MOVE '8&      T  E F  H   F -   #00014275' TO DFHEIV0
 15477     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15478     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15479     MOVE X'2020233030303134323735' TO DFHEIV0(25:11)
 15480     CALL 'kxdfhei1' USING DFHEIV0,
 15481           LOGOFF-TEXT,
 15482           LOGOFF-LENGTH,
 15483           DFHEIV99,
 15484           DFHEIV99,
 15485           DFHEIV99,
 15486           DFHEIV99,
 15487           DFHEIV99,
 15488           DFHEIV99,
 15489           DFHEIV99,
 15490           DFHEIV99,
 15491           DFHEIV99,
 15492           DFHEIV99
 15493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15494
 15495
 15496     GO TO 9000-RETURN-TRANS.
 15497
 15498 8300-EXIT.
 15499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 334
* EL689.cbl
 15501 8350-SEND-DATAONLY-ERASEAUP.
 15502
 15503     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 15504     PERFORM 7760-PUT-TEMP-STORAGE
 15505                                 THRU 7760-EXIT
 15506     IF  PI-689-CREATE-NO-SCREENS
 15507         MOVE '9999'             TO PI-689-ERROR
 15508         GO TO 0620-RETURN-TO-CALLER.
 15509
 15510     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15511
 15512     IF  NOT EMI-NO-ERRORS
 15513         MOVE EMI-MESSAGE-AREA (1)
 15514                                 TO ERRMSGO
 15515     ELSE
 15516         MOVE SPACES             TO ERRMSGO.
 15517
 15518
 15519* EXEC CICS SEND
 15520*        MAP      (W-MAP)
 15521*        MAPSET   (W-MAPSET)
 15522*        FROM     (EL689AO)
 15523*        DATAONLY
 15524*        ERASEAUP
 15525*        CURSOR
 15526*    END-EXEC.
 15527     MOVE LENGTH OF
 15528      EL689AO
 15529       TO DFHEIV12
 15530     MOVE -1
 15531       TO DFHEIV11
 15532*    MOVE '8$D    CT  A    H L F ,   #00014304' TO DFHEIV0
 15533     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 15534     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15535     MOVE X'2020233030303134333034' TO DFHEIV0(25:11)
 15536     CALL 'kxdfhei1' USING DFHEIV0,
 15537           W-MAP,
 15538           EL689AO,
 15539           DFHEIV12,
 15540           W-MAPSET,
 15541           DFHEIV99,
 15542           DFHEIV99,
 15543           DFHEIV99,
 15544           DFHEIV11,
 15545           DFHEIV99,
 15546           DFHEIV99,
 15547           DFHEIV99
 15548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15549
 15550
 15551     GO TO 9000-RETURN-TRANS.
 15552
 15553 8350-EXIT.
 15554     EXIT.
 15555
 15556 8600-DEEDIT.
 15557
 15558
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 335
* EL689.cbl
 15559* EXEC CICS BIF DEEDIT
 15560*         FIELD    (W-DEEDIT-FIELD)
 15561*         LENGTH   (15)
 15562*    END-EXEC.
 15563     MOVE 15
 15564       TO DFHEIV11
 15565*    MOVE '@"L                   #   #00014320' TO DFHEIV0
 15566     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 15567     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15568     MOVE X'2020233030303134333230' TO DFHEIV0(25:11)
 15569     CALL 'kxdfhei1' USING DFHEIV0,
 15570           W-DEEDIT-FIELD,
 15571           DFHEIV11
 15572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15573
 15574
 15575 8600-EXIT.
 15576     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 336
* EL689.cbl
 15578 9000-RETURN-TRANS.
 15579
 15580     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 15581     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 15582     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 15583     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 15584
 15585* EXEC CICS RETURN
 15586*        TRANSID    (W-TRANSACTION)
 15587*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 15588*        LENGTH     (PI-COMM-LENGTH)
 15589*    END-EXEC.
 15590*    MOVE '.(CT                  &   #00014334' TO DFHEIV0
 15591     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15592     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15593     MOVE X'2020233030303134333334' TO DFHEIV0(25:11)
 15594     CALL 'kxdfhei1' USING DFHEIV0,
 15595           W-TRANSACTION,
 15596           PROGRAM-INTERFACE-BLOCK,
 15597           PI-COMM-LENGTH,
 15598           DFHEIV99,
 15599           DFHEIV99
 15600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15601
 15602*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 15603*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15604*    GO TO 0200-RECEIVE.
 15605
 15606 9000-EXIT.
 15607     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 337
* EL689.cbl
 15609 9200-PA.
 15610
 15611     MOVE ER-0008                TO EMI-ERROR.
 15612     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15613     MOVE -1                     TO MAINTL.
 15614     GO TO 8200-SEND-DATAONLY.
 15615
 15616 9200-EXIT.
 15617     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 338
* EL689.cbl
 15619 9300-DFHCLEAR.
 15620
 15621     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 15622         MOVE '2'                TO PI-ACTION.
 15623
 15624     IF  PI-CLEAR-MODE
 15625         MOVE PI-RETURN-TO-PROGRAM
 15626                                 TO W-CALL-PGM
 15627         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15628         GO TO 9400-XCTL
 15629     ELSE
 15630         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15631         MOVE LOW-VALUES         TO EL689AO
 15632                                    PI-1042-WA
 15633                                    PI-689-WORK-AREA
 15634         MOVE ZEROS              TO PI-CURRENT-LINE
 15635                                    PI-TEMP-STOR-ITEMS
 15636                                    PI-TOTAL-LINES
 15637                                    PI-UPDATE-SW
 15638                                    PI-689-NUMBER-LABEL-LINES
 15639         MOVE SPACES             TO PI-689-PRINT-SW
 15640                                    PI-689-ALT-PRINTER-ID
 15641                                    PI-COMM-CONTROL
 15642                                    PI-689-FORM-NUMBER
 15643                                    PI-689-TEMP-STOR-ID
 15644                                    PI-689-LABEL-SOURCE
 15645                                    PI-689-USE-SCREEN-IND
 15646         MOVE '2'                TO PI-ACTION
 15647         MOVE -1                 TO MAINTL
 15648         GO TO 8100-SEND-INITIAL-MAP.
 15649
 15650 9300-EXIT.
 15651     EXIT.
 15652
 15653 9400-XCTL.
 15654
 15655
 15656* EXEC CICS XCTL
 15657*        PROGRAM  (W-CALL-PGM)
 15658*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 15659*        LENGTH   (PI-COMM-LENGTH)
 15660*    END-EXEC.
 15661*    MOVE '.$C                   $   #00014392' TO DFHEIV0
 15662     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15663     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15664     MOVE X'2020233030303134333932' TO DFHEIV0(25:11)
 15665     CALL 'kxdfhei1' USING DFHEIV0,
 15666           W-CALL-PGM,
 15667           PROGRAM-INTERFACE-BLOCK,
 15668           PI-COMM-LENGTH
 15669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15670
 15671
 15672 9400-EXIT.
 15673     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 339
* EL689.cbl
 15675 9500-LINK-DATE-CONVERT.
 15676
 15677     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 15678             AND
 15679         DC-OPTION-CODE EQUAL ' '
 15680         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 15681         GO TO 9500-EXIT.
 15682
 15683
 15684* EXEC CICS LINK
 15685*        PROGRAM    ('ELDATCV')
 15686*        COMMAREA   (DATE-CONVERSION-DATA)
 15687*        LENGTH     (DC-COMM-LENGTH)
 15688*    END-EXEC.
 15689     MOVE 'ELDATCV' TO DFHEIV1
 15690*    MOVE '."C                   ''   #00014409' TO DFHEIV0
 15691     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15692     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15693     MOVE X'2020233030303134343039' TO DFHEIV0(25:11)
 15694     CALL 'kxdfhei1' USING DFHEIV0,
 15695           DFHEIV1,
 15696           DATE-CONVERSION-DATA,
 15697           DC-COMM-LENGTH,
 15698           DFHEIV99,
 15699           DFHEIV99,
 15700           DFHEIV99
 15701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15702
 15703
 15704     IF  NO-CONVERSION-ERROR
 15705             AND
 15706         PI-COMPANY-ID EQUAL 'AUK'
 15707             AND
 15708         W-REVERSE-DATE
 15709         MOVE DC-GREG-DATE-1-EDIT
 15710                                 TO W-EDIT-DATE-1
 15711         MOVE W-ED1-MM           TO W-ED2-MM
 15712         MOVE W-ED1-DD           TO W-ED2-DD
 15713         MOVE W-ED1-YY           TO W-ED2-YY
 15714         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 15715
 15716 9500-EXIT.
 15717     EXIT.
 15718
 15719 9600-FORMAT-DATE-TIME.
 15720
 15721     MOVE W-SAVE-DATE            TO RUNDTEO.
 15722     MOVE EIBTIME                TO W-TIME-IN.
 15723     MOVE W-TIME-OUT             TO RUNTIMEO.
 15724     MOVE PI-COMPANY-ID          TO COMPANYO.
 15725     MOVE PI-PROCESSOR-ID        TO USERIDO.
 15726     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 15727
 15728 9600-EXIT.
 15729     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 340
* EL689.cbl
 15731 9700-PGMID-ERROR.
 15732
 15733     IF  PI-689-CREATE-NO-SCREENS
 15734         MOVE '9999'             TO PI-689-ERROR
 15735         GO TO 0620-RETURN-TO-CALLER.
 15736
 15737
 15738* EXEC CICS  HANDLE CONDITION
 15739*        PGMIDERR  (8300-SEND-TEXT)
 15740*    END-EXEC.
 15741*    MOVE '"$L                   ! C #00014448' TO DFHEIV0
 15742     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15743     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15744     MOVE X'4320233030303134343438' TO DFHEIV0(25:11)
 15745     CALL 'kxdfhei1' USING DFHEIV0
 15746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15747
 15748
 15749     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 15750     MOVE ' '                    TO PI-ENTRY-CD-1.
 15751     MOVE W-XCTL-005             TO W-CALL-PGM
 15752                                    LOGOFF-PGM.
 15753     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 15754
 15755     PERFORM 9400-XCTL THRU 9400-EXIT.
 15756
 15757 9700-EXIT.
 15758     EXIT.
 15759
 15760 9800-ABEND.
 15761
 15762     IF  PI-689-CREATE-NO-SCREENS
 15763         MOVE '9999'             TO PI-689-ERROR
 15764         GO TO 0620-RETURN-TO-CALLER.
 15765
 15766     MOVE W-LINK-004             TO W-CALL-PGM.
 15767     MOVE DFHEIBLK               TO EMI-LINE1
 15768
 15769
 15770* EXEC CICS  LINK
 15771*        PROGRAM   (W-CALL-PGM)
 15772*        COMMAREA  (EMI-LINE1)
 15773*        LENGTH    (72)
 15774*    END-EXEC.
 15775     MOVE 72
 15776       TO DFHEIV11
 15777*    MOVE '."C                   ''   #00014472' TO DFHEIV0
 15778     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15779     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15780     MOVE X'2020233030303134343732' TO DFHEIV0(25:11)
 15781     CALL 'kxdfhei1' USING DFHEIV0,
 15782           W-CALL-PGM,
 15783           EMI-LINE1,
 15784           DFHEIV11,
 15785           DFHEIV99,
 15786           DFHEIV99,
 15787           DFHEIV99
 15788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 341
* EL689.cbl
 15789
 15790
 15791     GO TO 8200-SEND-DATAONLY.
 15792
 15793 9800-EXIT.
 15794     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 342
* EL689.cbl
 15796 9900-ERROR-FORMAT.
 15797
 15798     IF  PI-689-CREATE-NO-SCREENS
 15799         MOVE EMI-ERROR          TO PI-689-ERROR
 15800         IF  PI-689-FATAL-ERROR
 15801             GO TO 0620-RETURN-TO-CALLER
 15802         ELSE
 15803             GO TO 9900-EXIT.
 15804
 15805     IF  EMI-ERROR EQUAL ER-9097
 15806         NEXT SENTENCE
 15807     ELSE
 15808         IF  EMI-ERRORS-COMPLETE
 15809                 OR
 15810             EMI-ERROR EQUAL W-LAST-ERROR
 15811             GO TO 9900-EXIT.
 15812
 15813     MOVE W-LINK-001             TO W-CALL-PGM.
 15814
 15815
 15816* EXEC CICS LINK
 15817*        PROGRAM    (W-CALL-PGM)
 15818*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 15819*        LENGTH     (EMI-COMM-LENGTH)
 15820*    END-EXEC.
 15821*    MOVE '."C                   ''   #00014502' TO DFHEIV0
 15822     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15823     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15824     MOVE X'2020233030303134353032' TO DFHEIV0(25:11)
 15825     CALL 'kxdfhei1' USING DFHEIV0,
 15826           W-CALL-PGM,
 15827           ERROR-MESSAGE-INTERFACE-BLOCK,
 15828           EMI-COMM-LENGTH,
 15829           DFHEIV99,
 15830           DFHEIV99,
 15831           DFHEIV99
 15832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15833
 15834
 15835     IF  EMI-SEVERITY (2) EQUAL 'X'
 15836             AND
 15837         EMI-SEVERITY (1) NOT EQUAL 'X'
 15838         MOVE EMI-MESSAGE-AREA (2)
 15839                                 TO EMI-MESSAGE-AREA (1).
 15840
 15841     MOVE EMI-ERROR              TO W-LAST-ERROR.
 15842
 15843 9900-EXIT.
 15844     EXIT.
 15845
 15846 9905-INITIALIZE-SECURITY.
 15847******************************************************************
 15848*                                                                *
 15849*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 15850*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 15851*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 15852*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
 15853*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 343
* EL689.cbl
 15854*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 15855*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 15856*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 15857*                                                                *
 15858*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 15859*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 15860*                                                                *
 15861******************************************************************
 15862
 15863     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 15864         MOVE 'Y'                TO PI-DISPLAY-CAP
 15865                                    PI-MODIFY-CAP
 15866     ELSE
 15867
 15868* EXEC CICS READQ TS
 15869*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 15870*            INTO   (SECURITY-CONTROL)
 15871*            LENGTH (SC-COMM-LENGTH)
 15872*            ITEM   (1)
 15873*        END-EXEC
 15874     MOVE 1
 15875       TO DFHEIV11
 15876*    MOVE '*$II   L              ''   #00014540' TO DFHEIV0
 15877     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 15878     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15879     MOVE X'2020233030303134353430' TO DFHEIV0(25:11)
 15880     CALL 'kxdfhei1' USING DFHEIV0,
 15881           PI-SECURITY-TEMP-STORE-ID,
 15882           SECURITY-CONTROL,
 15883           SC-COMM-LENGTH,
 15884           DFHEIV11,
 15885           DFHEIV99,
 15886           DFHEIV99
 15887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15888         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 15889                                 TO PI-DISPLAY-CAP
 15890         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 15891                                 TO PI-MODIFY-CAP.
 15892
 15893 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 344
* EL689.cbl
 15895 9995-SECURITY-VIOLATION.
 15896
 15897     MOVE EIBDATE                TO SM-JUL-DATE.
 15898     MOVE EIBTRMID               TO SM-TERMID.
 15899     MOVE W-THIS-PGM             TO SM-PGM.
 15900     MOVE EIBTIME                TO W-TIME-IN.
 15901     MOVE W-TIME-OUT             TO SM-TIME.
 15902     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 15903
 15904
 15905* EXEC CICS LINK
 15906*         PROGRAM  ('EL003')
 15907*         COMMAREA (SECURITY-MESSAGE)
 15908*         LENGTH   (80)
 15909*    END-EXEC.
 15910     MOVE 'EL003' TO DFHEIV1
 15911     MOVE 80
 15912       TO DFHEIV11
 15913*    MOVE '."C                   ''   #00014562' TO DFHEIV0
 15914     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15915     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15916     MOVE X'2020233030303134353632' TO DFHEIV0(25:11)
 15917     CALL 'kxdfhei1' USING DFHEIV0,
 15918           DFHEIV1,
 15919           SECURITY-MESSAGE,
 15920           DFHEIV11,
 15921           DFHEIV99,
 15922           DFHEIV99,
 15923           DFHEIV99
 15924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15925
 15926
 15927 9995-EXIT.
 15928     EXIT.
 15929
 15930 9999-GOBACK.
 15931
 15932
 15933* GOBACK.
 15934     MOVE '9%                    "   ' TO DFHEIV0
 15935     MOVE 'EL689' TO DFHEIV1
 15936     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15937     GOBACK.
 15938
 15939 9999-EXIT.
 15940     EXIT.
 15941
 15942 9999-DFHBACK SECTION.
 15943     MOVE '9%                    "   ' TO DFHEIV0
 15944     MOVE 'EL689' TO DFHEIV1
 15945     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15946     GOBACK.
 15947 9999-DFHEXIT.
 15948     IF DFHEIGDJ EQUAL 0001
 15949         NEXT SENTENCE
 15950     ELSE IF DFHEIGDJ EQUAL 2
 15951         GO TO 9300-DFHCLEAR,
 15952               9200-PA,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 345
* EL689.cbl
 15953               9200-PA,
 15954               9200-PA
 15955         DEPENDING ON DFHEIGDI
 15956     ELSE IF DFHEIGDJ EQUAL 3
 15957         GO TO 9700-PGMID-ERROR,
 15958               9800-ABEND,
 15959               0325-MAPFAIL
 15960         DEPENDING ON DFHEIGDI
 15961     ELSE IF DFHEIGDJ EQUAL 4
 15962         GO TO 8040-CNTL-NOT-OPEN,
 15963               7945-NOT-FOUND
 15964         DEPENDING ON DFHEIGDI
 15965     ELSE IF DFHEIGDJ EQUAL 5
 15966         GO TO 9700-PGMID-ERROR,
 15967               0325-MAPFAIL,
 15968               9800-ABEND
 15969         DEPENDING ON DFHEIGDI
 15970     ELSE IF DFHEIGDJ EQUAL 6
 15971         GO TO 0990-CARRIER-NOT-FOUND,
 15972               8040-CNTL-NOT-OPEN
 15973         DEPENDING ON DFHEIGDI
 15974     ELSE IF DFHEIGDJ EQUAL 7
 15975         GO TO 0994-STATE-NOT-FOUND,
 15976               8040-CNTL-NOT-OPEN
 15977         DEPENDING ON DFHEIGDI
 15978     ELSE IF DFHEIGDJ EQUAL 8
 15979         GO TO 8010-ARCH-NOT-OPEN,
 15980               1070-ARCH-NOT-FOUND,
 15981               1070-ARCH-NOT-FOUND
 15982         DEPENDING ON DFHEIGDI
 15983     ELSE IF DFHEIGDJ EQUAL 9
 15984         GO TO 8015-ARCT-NOT-OPEN,
 15985               1020-ARCT-ENDBR,
 15986               1020-ARCT-ENDBR
 15987         DEPENDING ON DFHEIGDI
 15988     ELSE IF DFHEIGDJ EQUAL 10
 15989         GO TO 2001-NOT-FOUND,
 15990               2001-NOT-FOUND,
 15991               8050-TEXT-NOT-OPEN
 15992         DEPENDING ON DFHEIGDI
 15993     ELSE IF DFHEIGDJ EQUAL 11
 15994         GO TO 2000-ENDBR
 15995         DEPENDING ON DFHEIGDI
 15996     ELSE IF DFHEIGDJ EQUAL 12
 15997         GO TO 8040-CNTL-NOT-OPEN,
 15998               5470-CNTL-NOT-FOUND
 15999         DEPENDING ON DFHEIGDI
 16000     ELSE IF DFHEIGDJ EQUAL 13
 16001         GO TO 8010-ARCH-NOT-OPEN
 16002         DEPENDING ON DFHEIGDI
 16003     ELSE IF DFHEIGDJ EQUAL 14
 16004         GO TO 5460-DUPLICATE-ARCHIVE-RCD
 16005         DEPENDING ON DFHEIGDI
 16006     ELSE IF DFHEIGDJ EQUAL 15
 16007         GO TO 8015-ARCT-NOT-OPEN,
 16008               5465-DUPLICATE-ARCH-TEXT
 16009         DEPENDING ON DFHEIGDI
 16010     ELSE IF DFHEIGDJ EQUAL 16
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 346
* EL689.cbl
 16011         GO TO 8040-CNTL-NOT-OPEN,
 16012               6200-CNTL1-NOT-FOUND
 16013         DEPENDING ON DFHEIGDI
 16014     ELSE IF DFHEIGDJ EQUAL 17
 16015         GO TO 8040-CNTL-NOT-OPEN,
 16016               6250-CNTL2-NOT-FOUND
 16017         DEPENDING ON DFHEIGDI
 16018     ELSE IF DFHEIGDJ EQUAL 18
 16019         GO TO 8040-CNTL-NOT-OPEN,
 16020               6300-CNTL6-NOT-FOUND
 16021         DEPENDING ON DFHEIGDI
 16022     ELSE IF DFHEIGDJ EQUAL 19
 16023         GO TO 8040-CNTL-NOT-OPEN,
 16024               6350-CNTL2-NOT-FOUND
 16025         DEPENDING ON DFHEIGDI
 16026     ELSE IF DFHEIGDJ EQUAL 20
 16027         GO TO 8060-PNDB-NOT-OPEN,
 16028               8070-PNDB-NOT-FOUND
 16029         DEPENDING ON DFHEIGDI
 16030     ELSE IF DFHEIGDJ EQUAL 21
 16031         GO TO 8030-CERT-NOT-OPEN,
 16032               8035-CERT-NOT-FOUND
 16033         DEPENDING ON DFHEIGDI
 16034     ELSE IF DFHEIGDJ EQUAL 22
 16035         GO TO 8020-ACCT-NOT-OPEN,
 16036               6500-ACCT-NOT-FOUND,
 16037               6500-ONLY-STOP
 16038         DEPENDING ON DFHEIGDI
 16039     ELSE IF DFHEIGDJ EQUAL 23
 16040         GO TO 8080-COMP-NOT-OPEN,
 16041               6600-COMP-NOT-FOUND
 16042         DEPENDING ON DFHEIGDI
 16043     ELSE IF DFHEIGDJ EQUAL 24
 16044         GO TO 8040-CNTL-NOT-OPEN,
 16045               6630-CNTL2-NOT-FOUND
 16046         DEPENDING ON DFHEIGDI
 16047     ELSE IF DFHEIGDJ EQUAL 25
 16048         GO TO 8090-MAIL-NOT-OPEN,
 16049               6700-MAIL-NOT-FOUND
 16050         DEPENDING ON DFHEIGDI
 16051     ELSE IF DFHEIGDJ EQUAL 26
 16052         GO TO 8040-CNTL-NOT-OPEN,
 16053               6750-EXIT
 16054         DEPENDING ON DFHEIGDI
 16055     ELSE IF DFHEIGDJ EQUAL 27
 16056         GO TO 8040-CNTL-NOT-OPEN,
 16057               6800-EXIT
 16058         DEPENDING ON DFHEIGDI
 16059     ELSE IF DFHEIGDJ EQUAL 28
 16060         GO TO 8045-CHEK-NOT-OPEN,
 16061               6850-CHEK-NOT-FOUND
 16062         DEPENDING ON DFHEIGDI
 16063     ELSE IF DFHEIGDJ EQUAL 29
 16064         GO TO 8085-PYAJ-NOT-OPEN,
 16065               6900-PYAJ-NOT-FOUND
 16066         DEPENDING ON DFHEIGDI
 16067     ELSE IF DFHEIGDJ EQUAL 30
 16068         GO TO 7700-TS-ERROR,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-11 11:38 Page 347
* EL689.cbl
 16069               7700-TS-ERROR
 16070         DEPENDING ON DFHEIGDI
 16071     ELSE IF DFHEIGDJ EQUAL 31
 16072         GO TO 7780-EXIT
 16073         DEPENDING ON DFHEIGDI
 16074     ELSE IF DFHEIGDJ EQUAL 32
 16075         GO TO 8040-CNTL-NOT-OPEN,
 16076               7945-NOT-FOUND
 16077         DEPENDING ON DFHEIGDI
 16078     ELSE IF DFHEIGDJ EQUAL 33
 16079         GO TO 7935-TERM-ERROR,
 16080               7940-TRAN-ERROR
 16081         DEPENDING ON DFHEIGDI
 16082     ELSE IF DFHEIGDJ EQUAL 34
 16083         GO TO 8010-ARCH-NOT-OPEN,
 16084               1070-ARCH-NOT-FOUND,
 16085               1070-ARCH-NOT-FOUND
 16086         DEPENDING ON DFHEIGDI
 16087     ELSE IF DFHEIGDJ EQUAL 35
 16088         GO TO 8300-SEND-TEXT
 16089         DEPENDING ON DFHEIGDI.
 16090     MOVE '9%                    "   ' TO DFHEIV0
 16091     MOVE 'EL689' TO DFHEIV1
 16092     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16093     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       91932     Code:       60115
