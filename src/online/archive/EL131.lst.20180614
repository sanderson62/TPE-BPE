* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 040617  CR2017022200003  TANA  INCREASE CHG INC DT TO 180 DAYS
    45* 062217  CR2017050300002  TANA  ADD AUTH RCVD FIELD
    46* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    47* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    48* 021418  CR2017110200001  TANA  EDIT NAME CHANGE AGST INSRD TYPE
    49* 052918  CR2018031500002  TANA  Add Message for filing time limit
    50******************************************************************
    51
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page   3
* EL131.cbl
    53 ENVIRONMENT DIVISION.
    54
    55 DATA DIVISION.
    56
    57 WORKING-STORAGE SECTION.
    58 01  DFH-START PIC X(04).
    59
    60 77  FILLER  PIC X(32)  VALUE '********************************'.
    61 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    62 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    63 77  s1                          pic s999 comp-3 value+0.
    64 77  s2                          pic s999 comp-3 value+0.
    65 77  a1                          pic s999 comp-3 value+0.
    66 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    67 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    68 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    69 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    70 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    71 77  ws-max-extension            pic s999 comp-3 value +0.
    72 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    73 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    74 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    75     88  ERPDEF-FOUND                 VALUE 'Y'.
    76 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    77     88  TRLR-FILE-EOF                VALUE 'Y'.
    78 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    79     88  PAYMENT-PENDING              VALUE 'Y'.
    80 77  WS-AUTH-RCVD                PIC X     VALUE ' '.
    81     88  AUTH-RCVD                    VALUE 'Y'.
    82     88  NO-AUTH-RCVD                 VALUE 'N'.
    83 77  ws-eracct-sw                pic x  value ' '.
    84     88  acct-found                value 'Y'.
    85 77  ws-benper-sw                pic x   value ' '.
    86     88  good-benper               value 'Y'.
    87 77  ws-claim-type               pic x value ' '.
    88 77  ws-ben-per                  pic 99 value 00.
    89 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    90 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    91 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    92 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    93
    94 01  LCP-TIME-OF-DAY-XX.
    95     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    96     05  FILLER                    PIC 99.
    97 01  LCP-CICS-TIME                 PIC 9(15).
    98*                            COPY ELCSCTM.
    99******************************************************************
   100*                                                                *
   101*                                                                *
   102*                            ELCSCTM                             *
   103*                            VMOD=2.001                          *
   104*                                                                *
   105*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   106*                                                                *
   107******************************************************************
   108 01  SECURITY-MESSAGE.
   109     12  FILLER                          PIC X(30)
   110            VALUE '** LOGIC SECURITY VIOLATION -'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page   4
* EL131.cbl
   111     12  SM-READ                         PIC X(6).
   112     12  FILLER                          PIC X(5)
   113            VALUE ' PGM='.
   114     12  SM-PGM                          PIC X(6).
   115     12  FILLER                          PIC X(5)
   116            VALUE ' OPR='.
   117     12  SM-PROCESSOR-ID                 PIC X(4).
   118     12  FILLER                          PIC X(6)
   119            VALUE ' TERM='.
   120     12  SM-TERMID                       PIC X(4).
   121     12  FILLER                          PIC XX   VALUE SPACE.
   122     12  SM-JUL-DATE                     PIC 9(5).
   123     12  FILLER                          PIC X    VALUE SPACE.
   124     12  SM-TIME                         PIC 99.99.
   125
   126
   127*                            COPY ELCSCRTY.
   128******************************************************************
   129*                                                                *
   130*                                                                *
   131*                            ELCSCRTY                            *
   132*                            VMOD=2.001                          *
   133*                                                                *
   134*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   135*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   136*        SAVED IN PI-SECURITY-ADDRESS.                           *
   137*                                                                *
   138******************************************************************
   139 01  SECURITY-CONTROL.
   140     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   141     12  FILLER                       PIC XX    VALUE 'SC'.
   142     12  SC-CREDIT-CODES.
   143         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   144             20  SC-CREDIT-DISPLAY    PIC X.
   145             20  SC-CREDIT-UPDATE     PIC X.
   146     12  SC-CLAIMS-CODES.
   147         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   148             20  SC-CLAIMS-DISPLAY    PIC X.
   149             20  SC-CLAIMS-UPDATE     PIC X.
   150
   151*                            COPY ELCNWA.
   152*****************************************************************
   153*                                                               *
   154*                                                               *
   155*                            ELCNWA.                            *
   156*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   157*                            VMOD=2.003                         *
   158*                                                               *
   159*            M O V E   N A M E   W O R K   A R E A.             *
   160*                                                               *
   161*****************************************************************.
   162
   163 01  WS-NAME-WORK-AREA.
   164     05  WS-INSURED-LAST-NAME        PIC X(15).
   165     05  WS-INSURED-1ST-NAME         PIC X(12).
   166     05  WS-INSURED-MID-INIT         PIC X.
   167
   168     05  WS-NAME-WORK.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page   5
* EL131.cbl
   169         10  WS-NW                   PIC X
   170             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   171
   172     05  WS-NAME-WORK2.
   173         10  WS-NW2                  PIC X
   174             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   175                                        NWA-INDEX0.
   176
   177     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   178                                     COMP-3.
   179
   180
   181 01  ws-dcc-error-line.
   182     05  filler occurs 15.
   183         10  ws-error-no        pic x(4).
   184 01  WS-DATE-AREA.
   185     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   186     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   187     12  SAVE-DATE-CCYYMMDD.
   188         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   189         16  SAVE-DATE-YMD.
   190             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   191             20  FILLER         PIC X(4)    VALUE SPACES.
   192
   193 01  WS-BLANK                   PIC X       VALUE ' '.
   194
   195 01  CSO-WORK-FIELDS.
   196     05  WS-HOLD-CLAIM-STATUS    PIC X.
   197     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   198     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   199         10  WS-RECURRENT-YN     PIC X.
   200         10  FILLER              PIC X.
   201
   202 01  LITERALS-NUMBERS.
   203     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   204     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   205     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   206     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   207     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   208     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   209     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   210     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   211
   212     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   213     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   214     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   215     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   216     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   217     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   218     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   219     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   220     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   221     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   222
   223     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   224
   225     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   226
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page   6
* EL131.cbl
   227     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   228     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   229     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   230     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   231     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   232     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   233     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   234     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   235     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   236     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   237     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   238     12  WS-CONTEST-NOTE      PIC X(44)
   239         VALUE 'CONTRACT NOW CONTESTABLE - INC/RPT DT CHGD'.
   240     12  WS-FILE-LIM-NOTE     PIC X(44)
   241         VALUE 'FILING TIME LIMIT OK - INCRD DT CHGD'.
   242
   243     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   244     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   245     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   246     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   247         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   248     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   249     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   250     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   251     12  WS-ICD-CODE-1           PIC X(8).
   252     12  WS-ICD-CODE-2           PIC X(8).
   253     12  WS-CLAIM-SEQU.
   254         16  FILLER              PIC X VALUE '('.
   255         16  WS-CURRENT-SEQU     PIC Z9.
   256         16  FILLER              PIC X(04) VALUE ' OF '.
   257         16  WS-OF-SEQU          PIC Z9.
   258         16  FILLER              PIC X VALUE ')'.
   259     12  WS-EDIT-BEN-CODE        PIC XX.
   260         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   261                                          '90' THRU '99'.
   262
   263     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   264     12  WS-EDIT-NUMBER          PIC ZZZ9.
   265
   266     12  WS-RESPONSE             PIC S9(8)   COMP.
   267         88  WS-RESP-NORMAL              VALUE +00.
   268         88  WS-RESP-ERROR               VALUE +01.
   269         88  WS-RESP-NOTFND              VALUE +13.
   270         88  WS-RESP-DUPKEY              VALUE +15.
   271         88  WS-RESP-NOTOPEN             VALUE +19.
   272         88  WS-RESP-ENDFILE             VALUE +20.
   273
   274     12  WS-MOS-PAID             PIC 999.
   275     12  WS-ODD-DAYS             PIC 99.
   276     12  WS-REM-MOS              PIC 999.
   277     12  WS-REM-DAYS             PIC 99.
   278     12  WS-TERM-IN-DAYS         PIC 9(4).
   279     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   280
   281     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   282     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   283     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   284     12  WS-RESET-SW             PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page   7
* EL131.cbl
   285     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   286     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   287     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   288
   289 01  DMD-DATE-YYYYMMDD.
   290     12  DMD-DECADE          PIC XX      VALUE SPACES.
   291     12  DMD-YYMMDD.
   292         16  DMD-YY          PIC XX      VALUE SPACES.
   293         16  DMD-MM          PIC XX      VALUE SPACES.
   294         16  DMD-DD          PIC XX      VALUE SPACES.
   295
   296 01  DMD-DATE-MMDDYYYY.
   297     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   298     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   299     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   300     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   301     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   302     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   303
   304 01  WS-MAIL-CODE.
   305     12  FILLER              PIC X.
   306     12  DMD-MAIL-CODE.
   307         16  WS-MAIL-4       PIC X(4).
   308         16  WS-MAIL-5       PIC X.
   309     12  FILLER              PIC X(4).
   310
   311     12  W-NAME-LAST             PIC  X(15).
   312     12  W-NAME-FIRST            PIC  X(15).
   313     12  W-NAME-MIDDLE.
   314         16  FILLER              PIC  X.
   315         16  W-NAME-MIDDLE-2     PIC  X.
   316         16  FILLER              PIC  X(13).
   317
   318*    COPY ELCDCTB.
   319******************************************************************
   320*                                                                *
   321*                                                                *
   322*                            ELCDCTB.                            *
   323*                            VMOD=2.002                          *
   324*                                                                *
   325*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   326*       COMMUNICATIONS AREA                                      *
   327*                                                                *
   328******************************************************************
   329 01  DCT-COMMUNICATION-AREA.
   330     12  DCT-BILLING-BANK-ID      PIC  X(05).
   331     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   332     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   333     12  DCT-PRODUCT-CODE         PIC  X(02).
   334     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   335     12  DCT-RETURN-CODE          PIC  X(02).
   336     12  DCT-MAIL-CODE            PIC  X(05).
   337     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   338     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page   8
* EL131.cbl
   340 01  ERROR-SWITCHES.
   341     12  ERROR-SWITCH            PIC X.
   342         88  SCREEN-ERROR                    VALUE 'X'.
   343     12  MSTR-KEY-SWITCH         PIC X.
   344         88  MSTR-KEY-CHANGED                VALUE 'X'.
   345     12  CERT-KEY-SWITCH         PIC X.
   346*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   347         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   348*********SET TO Y IF PRIMARY KEY WILL CHANGE
   349         88  CERT-KEY-CHANGED                VALUE 'Y'.
   350     12  MSTR-SWITCH             PIC X.
   351         88  MSTR-UPDATES                    VALUE 'X'.
   352     12  crtt-switch             pic x value spaces.
   353         88  crtt-update             value 'X'.
   354     12  CERT-SWITCH             PIC X.
   355         88  CERT-UPDATES                    VALUE 'X'.
   356     12  UPDATE-SWITCH           PIC X.
   357         88  UPDATES-PRESENT                 VALUE 'X'.
   358     12  TRLR-SWITCH             PIC X.
   359         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   360         88  UPDATE-MADE                     VALUE 'Y'.
   361     12  NINETY-TRLR-SWITCH      PIC X.
   362         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   363     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   364         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   365     12  EARNINGS-CALC-SWITCH    PIC X.
   366         88  TEX-REG                         VALUE '4'.
   367         88  NET-PAY                         VALUE '5'.
   368     12  DLYACTV-SW              PIC X       VALUE 'N'.
   369         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page   9
* EL131.cbl
   371 01  EDIT-WORK-AREA.
   372     12  COUNT-2                 PIC 9.
   373     12  CALL-PGM                PIC X(8).
   374     12  TRANS-ID                PIC X(4).
   375     12  CHECK-PFKEYS            PIC 99.
   376     12  CHECK-MAINT             PIC X.
   377         88  ADD-ALPHA-RECORD                VALUE 'A'.
   378         88  CHANGE-CLAIM                    VALUE 'C'.
   379         88  DELETE-CLAIM                    VALUE 'D'.
   380         88  CHANGE-NAME                     VALUE 'N'.
   381         88  VALID-OPTIONS                   VALUE 'A' 'C'
   382                                                   'D' 'N'.
   383
   384     12  HOLD-BENEFIT            PIC XX.
   385     12  HOLD-FREQ               PIC XX.
   386     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   387     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   388     12  HOLD-PDTHRU             PIC XX.
   389     12  HOLD-ADDON              PIC XX.
   390     12  HOLD-NODAYS             PIC 9(4).
   391     12  HOLD-NOPMTS             PIC 9(3).
   392     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   393     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   394     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   395     12  HOLD-BIRTH              PIC XX.
   396     12  HOLD-END                PIC XX.
   397     12  HOLD-EFF                PIC XX.
   398     12  HOLD-ENTRY              PIC XX.
   399     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   400     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   401     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   402     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   403     12  HOLD-LF-CV-CAN          PIC XX.
   404     12  HOLD-AH-CV-CAN          PIC XX.
   405     12  DIVIDE-QUOT             PIC 9(3).
   406     12  DIVIDE-REM              PIC 9(3).
   407
   408     12  WS-ALPHA-DATE.
   409         16  WS-ALPHA-YEAR.
   410             20  WS-ALPHA-YY-1   PIC 99.
   411             20  WS-ALPHA-YY-2   PIC 99.
   412         16  WS-ALPHA-MM         PIC 99.
   413         16  WS-ALPHA-DD         PIC 99.
   414
   415     12  BUILD-VALID-DATE.
   416         16  BUILD-MONTH         PIC 99.
   417         16  BUILD-DAY           PIC 99.
   418         16  BUILD-YEAR          PIC 99.
   419     12  DEEDIT-MMYY-INPUT.
   420         16  FILLER              PIC X.
   421         16  DEEDIT-MONTH        PIC XX.
   422         16  DEEDIT-YEAR         PIC XX.
   423     12  DEEDIT-BEN              PIC 9(9)V99.
   424     12  DEEDIT-DATE-INPUT.
   425         16  FILLER              PIC XX.
   426         16  DEEDIT-DATE         PIC X(6).
   427     12  WORK-DATE-MDY.
   428         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  10
* EL131.cbl
   429         16  FILLER              PIC X(4).
   430         16  YEAR-WORK           PIC XX.
   431     12  WORK-DATE-MY.
   432         16  WORK-MONTH          PIC XX.
   433         16  WORK-SLASH          PIC X       VALUE '/'.
   434         16  WORK-YEAR           PIC XX.
   435     12  HOLD-DATE.
   436         16  HOLD-MONTH          PIC 99.
   437         16  FILLER              PIC X(4).
   438         16  HOLD-YEAR           PIC 99.
   439     12  SPLIT-INFO-LINE-1.
   440         16  SPLIT-INFO-DESC     PIC X(15).
   441         16  FILLER              PIC X(5)    VALUE ' OLD='.
   442         16  SPLIT-INFO-OLD      PIC X(40).
   443     12  EFF-TERM-MO             PIC 9(4).
   444     12  CURR-MO                 PIC 9(4).
   445     12  WS-BIN-CURRENT-DT       PIC XX.
   446     12  WS-CALC-METHOD          PIC X.
   447     12  WS-INITIALS.
   448         16  WS-INIT-1           PIC X.
   449         16  WS-INIT-2           PIC X.
   450     12  WS-REIN-TABLE.
   451         16  WS-REIN-1           PIC X.
   452         16  WS-REIN-2           PIC X.
   453         16  WS-REIN-3           PIC X.
   454     12  PI-KEY.
   455         16  PI-TERM             PIC X(4).
   456         16  PI-QUAL             PIC X(4).
   457     12  CHECK-KEY               PIC X(20).
   458     12  SAVE-ACCT-KEY           PIC X(20).
   459     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   460     12  WS-SOC-SEC-NUMBER.
   461         16  WS-SOC-SEC-NO       PIC 9(9).
   462         16  WS-SOC-SEC-BLANK    PIC X(2).
   463     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   464         16  WS-SSN-1-3          PIC 9(3).
   465         16  WS-SSN-DASH1        PIC X(1).
   466         16  WS-SSN-4-5          PIC 9(2).
   467         16  WS-SSN-DASH2        PIC X(1).
   468         16  WS-SSN-6-9          PIC 9(4).
   469     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   470     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   471
   472 01  WS-SAVE-FIELDS.
   473     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   474     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   475     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   476     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   477     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   478     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   479     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   480     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   481     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   482     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   483     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   484     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   485     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   486     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  11
* EL131.cbl
   487     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   488     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   489     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   490     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   491     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   492     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   493     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   494     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   495     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   496     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   497     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   498     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   499     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   500     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   501     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   502     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   503     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   504     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   505     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   506     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   507     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   508     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   509     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   510     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   511     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   512     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   513     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   514     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   515     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   516     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   517     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   518     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   519     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   520     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   521     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   522     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   523     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   524     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   525     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   526     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   527     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   528
   529 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   530     12  M                   PIC S9(7)V99           VALUE ZEROS.
   531     12  L                   PIC S9(7)V99           VALUE ZEROS.
   532     12  N                   PIC S9(3)              VALUE ZEROS.
   533     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   534     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   535     12  I                   PIC S99V9(5)           VALUE ZEROS.
   536     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   537     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   538     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   539     12  R                   PIC S9(3)              VALUE ZEROS.
   540     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   541     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   542     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   543     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   544     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  12
* EL131.cbl
   545     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   546     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   547     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   548     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   549
   550 01  TERM-CALC-WORK-AREA.
   551     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   552     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   553     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   554     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   555     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   556     12  V-EXPONENTS.
   557        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   558     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   559
   560 01  TIME-IN.
   561     12  UN-HOURS                PIC XX.
   562     12  UN-MINUTES              PIC XX.
   563     12  FILLER                  PIC XX.
   564
   565 01  TIME-OUT.
   566     12  FOR-HOURS               PIC XX.
   567     12  FILLER                  PIC X       VALUE '.'.
   568     12  FOR-MINUTES             PIC XX.
   569
   570 01  ERROR-NUMBERS.
   571     12  ER-0000                 PIC X(4)    VALUE '0000'.
   572     12  ER-0004                 PIC X(4)    VALUE '0004'.
   573     12  ER-0008                 PIC X(4)    VALUE '0008'.
   574     12  ER-0023                 PIC X(4)    VALUE '0023'.
   575     12  ER-0029                 PIC X(4)    VALUE '0029'.
   576     12  ER-0068                 PIC X(4)    VALUE '0068'.
   577     12  ER-0070                 PIC X(4)    VALUE '0070'.
   578     12  ER-0149                 PIC X(4)    VALUE '0149'.
   579     12  ER-0154                 PIC X(4)    VALUE '0154'.
   580     12  ER-0169                 PIC X(4)    VALUE '0169'.
   581     12  ER-0192                 PIC X(4)    VALUE '0192'.
   582     12  ER-0199                 PIC X(4)    VALUE '0199'.
   583     12  ER-0203                 PIC X(4)    VALUE '0203'.
   584     12  ER-0204                 PIC X(4)    VALUE '0204'.
   585     12  ER-0205                 PIC X(4)    VALUE '0205'.
   586     12  ER-0206                 PIC X(4)    VALUE '0206'.
   587     12  ER-0208                 PIC X(4)    VALUE '0208'.
   588     12  ER-0210                 PIC X(4)    VALUE '0210'.
   589     12  ER-0215                 PIC X(4)    VALUE '0215'.
   590     12  ER-0219                 PIC X(4)    VALUE '0219'.
   591     12  ER-0220                 PIC X(4)    VALUE '0220'.
   592     12  ER-0222                 PIC X(4)    VALUE '0222'.
   593     12  ER-0223                 PIC X(4)    VALUE '0223'.
   594     12  ER-0224                 PIC X(4)    VALUE '0224'.
   595     12  ER-0227                 PIC X(4)    VALUE '0227'.
   596     12  ER-0230                 PIC X(4)    VALUE '0230'.
   597     12  ER-0232                 PIC X(4)    VALUE '0232'.
   598     12  ER-0233                 PIC X(4)    VALUE '0233'.
   599     12  ER-0236                 PIC X(4)    VALUE '0236'.
   600     12  ER-0237                 PIC X(4)    VALUE '0237'.
   601     12  ER-0238                 PIC X(4)    VALUE '0238'.
   602     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  13
* EL131.cbl
   603     12  ER-0241                 PIC X(4)    VALUE '0241'.
   604     12  ER-0243                 PIC X(4)    VALUE '0243'.
   605     12  ER-0244                 PIC X(4)    VALUE '0244'.
   606     12  ER-0246                 PIC X(4)    VALUE '0246'.
   607     12  ER-0247                 PIC X(4)    VALUE '0247'.
   608     12  ER-0248                 PIC X(4)    VALUE '0248'.
   609     12  ER-0250                 PIC X(4)    VALUE '0250'.
   610     12  ER-0251                 PIC X(4)    VALUE '0251'.
   611     12  ER-0253                 PIC X(4)    VALUE '0253'.
   612     12  ER-0256                 PIC X(4)    VALUE '0256'.
   613     12  ER-0257                 PIC X(4)    VALUE '0257'.
   614     12  ER-0258                 PIC X(4)    VALUE '0258'.
   615     12  ER-0259                 PIC X(4)    VALUE '0259'.
   616     12  ER-0260                 PIC X(4)    VALUE '0260'.
   617     12  ER-0261                 PIC X(4)    VALUE '0261'.
   618     12  ER-0262                 PIC X(4)    VALUE '0262'.
   619     12  ER-0263                 PIC X(4)    VALUE '0263'.
   620     12  ER-0273                 PIC X(4)    VALUE '0273'.
   621     12  ER-0274                 PIC X(4)    VALUE '0274'.
   622     12  ER-0276                 PIC X(4)    VALUE '0276'.
   623     12  ER-0282                 PIC X(4)    VALUE '0282'.
   624     12  ER-0283                 PIC X(4)    VALUE '0283'.
   625     12  ER-0309                 PIC X(4)    VALUE '0309'.
   626     12  ER-0310                 PIC X(4)    VALUE '0310'.
   627     12  ER-0311                 PIC X(4)    VALUE '0311'.
   628     12  ER-0333                 PIC X(4)    VALUE '0333'.
   629     12  ER-0360                 PIC X(4)    VALUE '0360'.
   630     12  ER-0377                 PIC X(4)    VALUE '0377'.
   631     12  ER-0402                 PIC X(4)    VALUE '0402'.
   632     12  ER-0416                 PIC X(4)    VALUE '0416'.
   633     12  ER-0426                 PIC X(4)    VALUE '0426'.
   634     12  ER-0427                 PIC X(4)    VALUE '0427'.
   635     12  ER-0428                 PIC X(4)    VALUE '0428'.
   636     12  ER-0429                 PIC X(4)    VALUE '0429'.
   637     12  ER-0430                 PIC X(4)    VALUE '0430'.
   638     12  ER-0458                 PIC X(4)    VALUE '0458'.
   639     12  ER-0475                 PIC X(4)    VALUE '0475'.
   640     12  ER-0491                 PIC X(4)    VALUE '0491'.
   641     12  ER-0509                 PIC X(4)    VALUE '0509'.
   642     12  ER-0510                 PIC X(4)    VALUE '0510'.
   643     12  ER-0511                 PIC X(4)    VALUE '0511'.
   644     12  ER-0512                 PIC X(4)    VALUE '0512'.
   645     12  ER-0519                 PIC X(4)    VALUE '0519'.
   646     12  ER-0520                 PIC X(4)    VALUE '0520'.
   647     12  ER-0521                 PIC X(4)    VALUE '0521'.
   648     12  ER-0547                 PIC X(4)    VALUE '0547'.
   649     12  ER-0548                 PIC X(4)    VALUE '0548'.
   650     12  ER-0549                 PIC X(4)    VALUE '0549'.
   651     12  ER-0565                 PIC X(4)    VALUE '0565'.
   652     12  ER-0598                 PIC X(4)    VALUE '0598'.
   653     12  ER-0639                 PIC X(4)    VALUE '0639'.
   654     12  ER-0797                 PIC X(4)    VALUE '0797'.
   655     12  ER-0802                 PIC X(4)    VALUE '0802'.
   656     12  ER-0803                 PIC X(4)    VALUE '0803'.
   657     12  ER-0849                 PIC X(4)    VALUE '0849'.
   658     12  ER-0885                 PIC X(4)    VALUE '0885'.
   659     12  ER-0887                 PIC X(4)    VALUE '0887'.
   660     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  14
* EL131.cbl
   661     12  ER-0921                 PIC X(4)    VALUE '0921'.
   662     12  ER-0938                 PIC X(4)    VALUE '0938'.
   663     12  ER-0946                 PIC X(4)    VALUE '0946'.
   664     12  ER-0947                 PIC X(4)    VALUE '0947'.
   665     12  ER-0948                 PIC X(4)    VALUE '0948'.
   666     12  ER-0949                 PIC X(4)    VALUE '0949'.
   667     12  ER-0950                 PIC X(4)    VALUE '0950'.
   668     12  ER-0951                 PIC X(4)    VALUE '0951'.
   669     12  ER-0954                 PIC X(4)    VALUE '0954'.
   670     12  ER-0974                 PIC X(4)    VALUE '0974'.
   671     12  ER-0975                 PIC X(4)    VALUE '0975'.
   672     12  ER-0992                 PIC X(4)    VALUE '0992'.
   673     12  er-1581                 pic x(4)    value '1581'.
   674     12  ER-1651                 PIC X(4)    VALUE '1651'.
   675     12  ER-1652                 PIC X(4)    VALUE '1652'.
   676     12  ER-1653                 PIC X(4)    VALUE '1653'.
   677     12  ER-1654                 PIC X(4)    VALUE '1654'.
   678     12  ER-1655                 PIC X(4)    VALUE '1655'.
   679     12  er-1656                 pic x(4)    value '1656'.
   680     12  ER-1661                 PIC X(4)    VALUE '1661'.
   681     12  ER-1662                 PIC X(4)    VALUE '1662'.
   682     12  ER-1663                 PIC X(4)    VALUE '1663'.
   683     12  er-1664                 pic x(4)    value '1664'.
   684     12  er-1665                 pic x(4)    value '1665'.
   685     12  er-1666                 pic x(4)    value '1666'.
   686     12  er-1668                 pic x(4)    value '1668'.
   687     12  er-1669                 pic x(4)    value '1669'.
   688     12  er-1675                 pic x(4)    value '1675'.
   689     12  er-1676                 pic x(4)    value '1676'.
   690     12  ER-1678                 PIC X(4)    VALUE '1678'.
   691     12  ER-1679                 PIC X(4)    VALUE '1679'.
   692     12  ER-1772                 PIC X(4)    VALUE '1772'.
   693     12  ER-1773                 PIC X(4)    VALUE '1773'.
   694     12  ER-1778                 PIC X(4)    VALUE '1778'.
   695     12  ER-2280                 PIC X(4)    VALUE '2280'.
   696     12  ER-2878                 PIC X(4)    VALUE '2878'.
   697     12  ER-7572                 PIC X(4)    VALUE '7572'.
   698     12  ER-7641                 PIC X(4)    VALUE '7641'.
   699     12  ER-7642                 PIC X(4)    VALUE '7642'.
   700     12  ER-7650                 PIC X(4)    VALUE '7650'.
   701     12  ER-7651                 PIC X(4)    VALUE '7651'.
   702     12  ER-7687                 PIC X(4)    VALUE '7687'.
   703     12  ER-7689                 PIC X(4)    VALUE '7689'.
   704     12  ER-7690                 PIC X(4)    VALUE '7690'.
   705     12  ER-7691                 PIC X(4)    VALUE '7691'.
   706     12  ER-8003                 PIC X(4)    VALUE '8003'.
   707     12  ER-8051                 PIC X(4)    VALUE '8051'.
   708     12  ER-8052                 PIC X(4)    VALUE '8052'.
   709     12  ER-8053                 PIC X(4)    VALUE '8053'.
   710     12  ER-8054                 PIC X(4)    VALUE '8054'.
   711     12  ER-8055                 PIC X(4)    VALUE '8055'.
   712     12  ER-8056                 PIC X(4)    VALUE '8056'.
   713     12  ER-8057                 PIC X(4)    VALUE '8057'.
   714     12  ER-8058                 PIC X(4)    VALUE '8058'.
   715     12  ER-8059                 PIC X(4)    VALUE '8059'.
   716     12  ER-8060                 PIC X(4)    VALUE '8060'.
   717     12  ER-8061                 PIC X(4)    VALUE '8061'.
   718     12  ER-8062                 PIC X(4)    VALUE '8062'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  15
* EL131.cbl
   719     12  ER-8063                 PIC X(4)    VALUE '8063'.
   720     12  ER-8064                 PIC X(4)    VALUE '8064'.
   721     12  ER-8065                 PIC X(4)    VALUE '8065'.
   722     12  ER-8066                 PIC X(4)    VALUE '8066'.
   723     12  ER-8152                 PIC X(4)    VALUE '8152'.
   724     12  ER-8153                 PIC X(4)    VALUE '8153'.
   725     12  ER-8154                 PIC X(4)    VALUE '8154'.
   726     12  ER-8155                 PIC X(4)    VALUE '8155'.
   727 01  ERPDEF-KEY-SAVE             PIC X(18).
   728 01  ERPDEF-KEY.
   729     12  ERPDEF-COMPANY-CD       PIC X.
   730     12  ERPDEF-STATE            PIC XX.
   731     12  ERPDEF-PROD-CD          PIC XXX.
   732     12  F                       PIC X(7).
   733     12  ERPDEF-BEN-TYPE         PIC X.
   734     12  ERPDEF-BEN-CODE         PIC XX.
   735     12  ERPDEF-EXP-DT           PIC XX.
   736 01  MSTR-KEY.
   737     12  COMPANY-CODE            PIC X.
   738     12  CARRIER-CODE            PIC X.
   739     12  CLAIM-NO                PIC X(7).
   740     12  CERT-NO.
   741         16  CERT-NO-PRIME       PIC X(10).
   742         16  CERT-NO-SUFX        PIC X.
   743
   744 01  WS-SAVE-CLAIM-KEY.
   745     12  WS-SAVE-COMPANY-CD      PIC X.
   746     12  WS-SAVE-CARRIER         PIC X.
   747     12  WS-SAVE-CLAIM-NO        PIC X(7).
   748     12  WS-SAVE-CERT-NO.
   749         16  WS-CERT-NO-PRIME    PIC X(10).
   750         16  WS-CERT-NO-SUFX     PIC X.
   751
   752 01  CERT-KEY.
   753     12  CERT-COMPANY-CODE       PIC X.
   754     12  CERT-CARRIER            PIC X.
   755     12  CERT-GROUP              PIC X(6).
   756     12  CERT-STATE              PIC XX.
   757     12  CERT-ACCOUNT            PIC X(10).
   758     12  CERT-DATE               PIC XX.
   759     12  CERT-CERT.
   760         16  CERT-CERT-PRIME     PIC X(10).
   761         16  CERT-CERT-SUFX      PIC X.
   762
   763 01  ELCRTT-KEY.
   764     05  CTRLR-COMP-CD       PIC X.
   765     05  CTRLR-CARRIER       PIC X.
   766     05  CTRLR-GROUPING      PIC X(6).
   767     05  CTRLR-STATE         PIC X(2).
   768     05  CTRLR-ACCOUNT       PIC X(10).
   769     05  CTRLR-EFF-DT        PIC XX.
   770     05  CTRLR-CERT-NO       PIC X(11).
   771     05  CTRLR-REC-TYPE      PIC X.
   772 01  NOTE-KEY.
   773     12  NOTE-COMP-CD            PIC X.
   774     12  NOTE-CERT-KEY.
   775         16  NOTE-CARRIER        PIC X.
   776         16  NOTE-GROUP          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  16
* EL131.cbl
   777         16  NOTE-STATE          PIC XX.
   778         16  NOTE-ACCOUNT        PIC X(10).
   779         16  NOTE-DATE           PIC XX.
   780         16  NOTE-CERT-NO        PIC X(11).
   781
   782 01  TRLR-KEY.
   783     12  TRLR-MAIN-KEY.
   784         16  TRLR-COMPANY-CD     PIC X.
   785         16  TRLR-CARRIER        PIC X.
   786         16  TRLR-CLAIM-NO       PIC X(07).
   787         16  TRLR-CERT-NO        PIC X(11).
   788     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   789
   790 01  BENEFIT-KEY.
   791     12  BEN-CO-ID               PIC X(3).
   792     12  BEN-REC-TYPE            PIC X.
   793     12  FILLER                  PIC XX.
   794     12  BEN-ACC-CD              PIC XX.
   795     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   796
   797 01  CNTL-KEY.
   798     12  CNTL-CO-ID              PIC X(3).
   799     12  CNTL-REC-TYPE           PIC X.
   800     12  CNTL-PROC-ID            PIC X(4).
   801     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   802         16  CNTL-STATE-NUMBER   PIC XX.
   803         16  FILLER              PIC XX.
   804     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   805         16  FILLER              PIC X(3).
   806         16  CNTL-CARRIER        PIC X.
   807     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   808
   809 01  ACTQ-KEY                    PIC X(20).
   810
   811 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   812
   813 01  CHKQ-KEY.
   814     12  CHKQ-COMPANY-CODE       PIC X.
   815     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   816     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   817
   818 01  ARCH-KEY.
   819     12  ARCH-COMPANY-CODE       PIC X.
   820     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   821     12  ARCH-RECORD-TYPE        PIC X.
   822     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   823
   824 01  ACCT-KEY.
   825     05  ACCT-PARTIAL-KEY.
   826         12  ACCT-COMPANY-CODE   PIC X.
   827         12  ACCT-CARRIER        PIC X.
   828         12  ACCT-GROUP          PIC X(6).
   829         12  ACCT-STATE          PIC XX.
   830         12  ACCT-ACCOUNT        PIC X(10).
   831     05  ACCT-DATE               PIC XX.
   832
   833 01  WS-ELBENE-KEY.
   834     12  WS-ELBENE-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  17
* EL131.cbl
   835     12  WS-ELBENE-RECORD-TYPE   PIC X.
   836     12  WS-ELBENE-ID            PIC X(10).
   837
   838 01  ELALPH-KEY.
   839     12  ELALPH-COMPANY-CD       PIC X.
   840     12  ELALPH-SOURCE           PIC X.
   841     12  ELALPH-NAME.
   842         16  ELALPH-LAST-NAME    PIC X(15).
   843         16  ELALPH-FIRST-NAME.
   844             20  ELALPH-FIRST-INIT   PIC X.
   845             20  FILLER              PIC X(11).
   846         16  ELALPH-MIDDLE-INIT  PIC X.
   847     12  ELALPH-DATE             PIC X(08).
   848     12  ELALPH-TIME             PIC S9(04)    COMP.
   849
   850 01  COMP-LENGTHS.
   851     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   852     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   853     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   854     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   855     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   856     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   857     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   858     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   859     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   860     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   861     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   862     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   863     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   864     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  18
* EL131.cbl
   866*                                COPY ELCLNKLT.
   867******************************************************************
   868*                                                                *
   869*                                                                *
   870*                           ELCLNKLT                             *
   871*                            VMOD=2.003                          *
   872*                                                                *
   873*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   874*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   875*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   876*                                                                *
   877*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   878*   COMPLETING THE REQUIRED FIELDS.                              *
   879*                                                                *
   880*   THE CALLING PROGRAM SHOULD CHECK:                            *
   881*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   882*                              9999 INDICATES AN UNKNOWN ABEND   *
   883*                                   WAS DETECTED.                *
   884*                              ALL OTHER VALUES ARE NORMAL ERROR *
   885*                              CODES FOUND IN THE ERROR FILE.    *
   886******************************************************************
   887 01  W-1523-LINKDATA.
   888     12  W-1523-COMMON-PI-DATA.
   889         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   890         16  FILLER              PIC  X(67).
   891         16  W-1523-COMPANY-CD   PIC  X(01).
   892         16  FILLER              PIC  X(10).
   893         16  W-1523-CONTROL-IN-PROGRESS.
   894             20  W-1523-CARRIER  PIC  X(01).
   895             20  W-1523-GROUPING PIC  X(06).
   896             20  W-1523-STATE    PIC  X(02).
   897             20  W-1523-ACCOUNT  PIC  X(10).
   898             20  W-1523-CLAIM-CERT-GRP.
   899                 24  W-1523-CLAIM-NO
   900                                 PIC  X(07).
   901                 24  W-1523-CERT-NO.
   902                     28  W-1523-CERT-PRIME
   903                                 PIC  X(10).
   904                     28  W-1523-CERT-SFX
   905                                 PIC  X(01).
   906                 24  W-1523-CERT-EFF-DT
   907                                 PIC  X(02).
   908         16  FILLER              PIC X(265).
   909
   910     12  W-1523-WORK-AREA.
   911         16  W-1523-FORM-NUMBER  PIC  X(04).
   912         16  W-1523-NUMBER-COPIES
   913                                 PIC  9(01).
   914         16  W-1523-ADDR-TYPE    PIC  X(02).
   915         16  W-1523-FOLLOW-UP-DATE
   916                                 PIC  X(02).
   917         16  W-1523-RESEND-DATE  PIC  X(02).
   918         16  W-1523-ERROR-CODE   PIC  9(04).
   919             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   920             88  W-1523-FATAL-ERROR
   921                                    VALUES  0006 0013 0042
   922                                            0154 0168 0169
   923                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  19
* EL131.cbl
   924                                            0179 0186 0281
   925                                            0332 2055 3697
   926                                            3698 3699 3770
   927                                            3771 3772 7675
   928                                            9106 9808 9883
   929                                            9887.
   930             88  W-1523-STOP-ERRORS
   931                                    VALUES  0013 0042 0154
   932                                            0168 0169 0172
   933                                            0281 0332 2055
   934                                            3698 3699 7675
   935                                            9106 9808 9883
   936                                            9999.
   937         16  W-1523-REASON       PIC  X(70).
   938         16  W-1523-ARCHIVE-NUMBER
   939                                 PIC  9(08).
   940     12  W-1523-POINTER-AREA.
   941         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   942         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   943         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   944         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   945         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  20
* EL131.cbl
   947*                                COPY ELCINTF.
   948******************************************************************
   949*                                                                *
   950*                                                                *
   951*                            ELCINTF.                            *
   952*                            VMOD=2.017                          *
   953*                                                                *
   954*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   955*                                                                *
   956*       LENGTH = 1024                                            *
   957*                                                                *
   958******************************************************************
   959*                   C H A N G E   L O G
   960*
   961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   962*-----------------------------------------------------------------
   963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   964* EFFECTIVE    NUMBER
   965*-----------------------------------------------------------------
   966* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   967******************************************************************
   968 01  PROGRAM-INTERFACE-BLOCK.
   969     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   970     12  PI-CALLING-PROGRAM              PIC X(8).
   971     12  PI-SAVED-PROGRAM-1              PIC X(8).
   972     12  PI-SAVED-PROGRAM-2              PIC X(8).
   973     12  PI-SAVED-PROGRAM-3              PIC X(8).
   974     12  PI-SAVED-PROGRAM-4              PIC X(8).
   975     12  PI-SAVED-PROGRAM-5              PIC X(8).
   976     12  PI-SAVED-PROGRAM-6              PIC X(8).
   977     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   978     12  PI-COMPANY-ID                   PIC XXX.
   979     12  PI-COMPANY-CD                   PIC X.
   980
   981     12  PI-COMPANY-PASSWORD             PIC X(8).
   982
   983     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   984
   985     12  PI-CONTROL-IN-PROGRESS.
   986         16  PI-CARRIER                  PIC X.
   987         16  PI-GROUPING                 PIC X(6).
   988         16  PI-STATE                    PIC XX.
   989         16  PI-ACCOUNT                  PIC X(10).
   990         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   991                                         PIC X(10).
   992         16  PI-CLAIM-CERT-GRP.
   993             20  PI-CLAIM-NO             PIC X(7).
   994             20  PI-CERT-NO.
   995                 25  PI-CERT-PRIME       PIC X(10).
   996                 25  PI-CERT-SFX         PIC X.
   997             20  PI-CERT-EFF-DT          PIC XX.
   998         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   999             20  PI-PLAN-CODE            PIC X(2).
  1000             20  PI-REVISION-NUMBER      PIC X(3).
  1001             20  PI-PLAN-EFF-DT          PIC X(2).
  1002             20  PI-PLAN-EXP-DT          PIC X(2).
  1003             20  FILLER                  PIC X(11).
  1004         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  21
* EL131.cbl
  1005             20  PI-OE-REFERENCE-1.
  1006                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1007                 25  PI-OE-REF-1-SUFF    PIC XX.
  1008
  1009     12  PI-SESSION-IN-PROGRESS          PIC X.
  1010         88  CLAIM-SESSION                   VALUE '1'.
  1011         88  CREDIT-SESSION                  VALUE '2'.
  1012         88  WARRANTY-SESSION                VALUE '3'.
  1013         88  MORTGAGE-SESSION                VALUE '4'.
  1014         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1015
  1016
  1017*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1018
  1019     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1020     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1021
  1022     12  PI-CREDIT-USER                  PIC X.
  1023         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1024         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1025
  1026     12  PI-CLAIM-USER                   PIC X.
  1027         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1028         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1029
  1030     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1031         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1032         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1033         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1034         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1035         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1036
  1037     12  PI-PROCESSOR-ID                 PIC X(4).
  1038
  1039     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1040
  1041     12  PI-MEMBER-CAPTION               PIC X(10).
  1042
  1043     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1044         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1045
  1046     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1047     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1048     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1049     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1050
  1051     12  PI-AH-OVERRIDE-L1               PIC X.
  1052     12  PI-AH-OVERRIDE-L2               PIC XX.
  1053     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1054     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1055
  1056     12  PI-NEW-SYSTEM                   PIC X(2).
  1057
  1058     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1059     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1060         88  PI-USES-PAID-TO                 VALUE '1'.
  1061     12  PI-CRDTCRD-SYSTEM.
  1062         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  22
* EL131.cbl
  1063             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1064             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1065         16  PI-CC-MONTH-END-DT          PIC XX.
  1066     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1067
  1068     12  PI-OE-REFERENCE-2.
  1069         16  PI-OE-REF-2-PRIME           PIC X(10).
  1070         16  PI-OE-REF-2-SUFF            PIC X.
  1071
  1072     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1073
  1074     12  PI-LANGUAGE-TYPE                PIC X.
  1075             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1076             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1077             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1078
  1079     12  PI-POLICY-LINKAGE-IND           PIC X.
  1080         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1081         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1082                                                   LOW-VALUES.
  1083
  1084     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1085     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1086         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1087         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1088
  1089     12  PI-PROCESSOR-CSR-IND            PIC X.
  1090         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1091         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1092
  1093     12  FILLER                          PIC X(3).
  1094
  1095     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1096
  1097     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1098         PI-SYSTEM-LEVEL.
  1099
  1100         16  PI-ENTRY-CODES.
  1101             20  PI-ENTRY-CD-1           PIC X.
  1102             20  PI-ENTRY-CD-2           PIC X.
  1103
  1104         16  PI-RETURN-CODES.
  1105             20  PI-RETURN-CD-1          PIC X.
  1106             20  PI-RETURN-CD-2          PIC X.
  1107
  1108         16  PI-UPDATE-STATUS-SAVE.
  1109             20  PI-UPDATE-BY            PIC X(4).
  1110             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1111
  1112         16  PI-LOWER-CASE-LETTERS       PIC X.
  1113             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1114
  1115*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1116*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1117*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1118
  1119         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1120             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  23
* EL131.cbl
  1121             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1122             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1123             88  ACCNT-CNTL                  VALUE '3'.
  1124             88  CARR-ACCNT-CNTL             VALUE '4'.
  1125
  1126         16  PI-PROCESSOR-CAP-LIST.
  1127             20  PI-SYSTEM-CONTROLS.
  1128                24 PI-SYSTEM-DISPLAY     PIC X.
  1129                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1130                24 PI-SYSTEM-MODIFY      PIC X.
  1131                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1132             20  FILLER                  PIC XX.
  1133             20  PI-DISPLAY-CAP          PIC X.
  1134                 88  DISPLAY-CAP             VALUE 'Y'.
  1135             20  PI-MODIFY-CAP           PIC X.
  1136                 88  MODIFY-CAP              VALUE 'Y'.
  1137             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1138                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1139             20  PI-FORCE-CAP            PIC X.
  1140                 88  FORCE-CAP               VALUE 'Y'.
  1141
  1142         16  PI-PROGRAM-CONTROLS.
  1143             20  PI-PGM-PRINT-OPT        PIC X.
  1144             20  PI-PGM-FORMAT-OPT       PIC X.
  1145             20  PI-PGM-PROCESS-OPT      PIC X.
  1146             20  PI-PGM-TOTALS-OPT       PIC X.
  1147
  1148         16  PI-HELP-INTERFACE.
  1149             20  PI-LAST-ERROR-NO        PIC X(4).
  1150             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1151
  1152         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1153             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1154
  1155         16  PI-CR-CONTROL-IN-PROGRESS.
  1156             20  PI-CR-CARRIER           PIC X.
  1157             20  PI-CR-GROUPING          PIC X(6).
  1158             20  PI-CR-STATE             PIC XX.
  1159             20  PI-CR-ACCOUNT           PIC X(10).
  1160             20  PI-CR-FIN-RESP          PIC X(10).
  1161             20  PI-CR-TYPE              PIC X.
  1162
  1163         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1164
  1165         16  PI-CR-MONTH-END-DT          PIC XX.
  1166
  1167         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1168             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1169             88  PI-ZERO-CARRIER             VALUE '1'.
  1170             88  PI-ZERO-GROUPING            VALUE '2'.
  1171             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1172
  1173         16  PI-CARRIER-SECURITY         PIC X.
  1174             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1175
  1176         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1177             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1178             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  24
* EL131.cbl
  1179
  1180         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1181             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1182                                         INDEXED BY PI-ACCESS-NDX
  1183                                         PIC X.
  1184
  1185         16  PI-GA-BILLING-CONTROL       PIC X.
  1186             88  PI-GA-BILLING               VALUE '1'.
  1187
  1188         16  PI-MAIL-PROCESSING          PIC X.
  1189             88  PI-MAIL-YES                 VALUE 'Y'.
  1190
  1191         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1192
  1193         16  PI-AR-SYSTEM.
  1194             20  PI-AR-PROCESSING-CNTL   PIC X.
  1195                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1196             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1197             20  PI-AR-MONTH-END-DT      PIC XX.
  1198
  1199         16  PI-MP-SYSTEM.
  1200             20  PI-MORTGAGE-USER            PIC X.
  1201                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1202                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1203             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1204                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1205                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1206                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1207                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1208                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1209             20  PI-MP-MONTH-END-DT          PIC XX.
  1210             20  PI-MP-REFERENCE-NO.
  1211                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1212                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1213
  1214         16  PI-LABEL-CONTROL            PIC X(01).
  1215             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1216             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1217
  1218         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1219             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1220
  1221         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1222             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1223             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1224
  1225         16  FILLER                      PIC X(14).
  1226
  1227     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1228******************************************************************
  1229     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1230         16  PI-NO-PMTS                    PIC 9(4).
  1231         16  PI-CERT-SWITCH                PIC X.
  1232             88  CREATED-CERT              VALUE '2'.
  1233         16  PI-PREM-TYPE                  PIC X.
  1234         16  PI-SAVE-CERT-NO.
  1235             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1236             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  25
* EL131.cbl
  1237         16  FILLER                        PIC X(46).
  1238         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1239         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1240         16  PI-REC-FOUND-SW               PIC X.
  1241         16  PI-LETTER-SW                  PIC X.
  1242         16  PI-PREV-TRLR-KEY              PIC X(22).
  1243         16  pi-claim-type                 pic x.
  1244         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1245         16  pi-approval-level             pic x.
  1246         16  FILLER                        PIC X(543).
  1247
  1248 01  SAVE-RECORD                 PIC X(450).
  1249
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  26
* EL131.cbl
  1251*                                COPY ELCLOGOF SUPPRESS.
  1252******************************************************************
  1253*                                                                *
  1254*                                                                *
  1255*                            ELCLOGOF.                           *
  1256*                            VMOD=2.001                          *
  1257*                                                                *
  1258*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1259*                                                                *
  1260******************************************************************
  1261 01  CLASIC-LOGOFF.
  1262     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1263     12  LOGOFF-TEXT.
  1264         16  FILLER          PIC X(5)    VALUE SPACES.
  1265         16  LOGOFF-MSG.
  1266             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1267             20  FILLER      PIC X       VALUE SPACES.
  1268             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1269         16  FILLER          PIC X(80)
  1270           VALUE '* YOU ARE NOW LOGGED OFF'.
  1271         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1272         16  FILLER          PIC X       VALUE QUOTE.
  1273         16  LOGOFF-SYS-MSG  PIC X(17)
  1274           VALUE 'S CLAS-IC SYSTEM '.
  1275     12  TEXT-MESSAGES.
  1276         16  UNACCESS-MSG    PIC X(29)
  1277             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1278         16  PGMIDERR-MSG    PIC X(17)
  1279             VALUE 'PROGRAM NOT FOUND'.
  1280
  1281*                                COPY ELCATTR SUPPRESS.
  1282******************************************************************
  1283*                                                                *
  1284*                            ELCATTR.                            *
  1285*                            VMOD=2.001                          *
  1286*                                                                *
  1287*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1288*                                                                *
  1289*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1290*                                                                *
  1291*                   POS 1   P=PROTECTED                          *
  1292*                           U=UNPROTECTED                        *
  1293*                           S=ASKIP                              *
  1294*                   POS 2   A=ALPHA/NUMERIC                      *
  1295*                           N=NUMERIC                            *
  1296*                   POS 3   N=NORMAL                             *
  1297*                           B=BRIGHT                             *
  1298*                           D=DARK                               *
  1299*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1300*                           OF=MODIFIED DATA TAG OFF             *
  1301*                                                                *
  1302*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1303******************************************************************
  1304 01  ATTRIBUTE-LIST.
  1305     12  AL-PABOF            PIC X       VALUE 'Y'.
  1306     12  AL-PABON            PIC X       VALUE 'Z'.
  1307     12  AL-PADOF            PIC X       VALUE '%'.
  1308     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  27
* EL131.cbl
  1309     12  AL-PANOF            PIC X       VALUE '-'.
  1310     12  AL-PANON            PIC X       VALUE '/'.
  1311     12  AL-SABOF            PIC X       VALUE '8'.
  1312     12  AL-SABON            PIC X       VALUE '9'.
  1313     12  AL-SADOF            PIC X       VALUE '@'.
  1314     12  AL-SADON            PIC X       VALUE QUOTE.
  1315     12  AL-SANOF            PIC X       VALUE '0'.
  1316     12  AL-SANON            PIC X       VALUE '1'.
  1317     12  AL-UABOF            PIC X       VALUE 'H'.
  1318     12  AL-UABON            PIC X       VALUE 'I'.
  1319     12  AL-UADOF            PIC X       VALUE '<'.
  1320     12  AL-UADON            PIC X       VALUE '('.
  1321     12  AL-UANOF            PIC X       VALUE ' '.
  1322     12  AL-UANON            PIC X       VALUE 'A'.
  1323     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1324     12  AL-UNBON            PIC X       VALUE 'R'.
  1325     12  AL-UNDOF            PIC X       VALUE '*'.
  1326     12  AL-UNDON            PIC X       VALUE ')'.
  1327     12  AL-UNNOF            PIC X       VALUE '&'.
  1328     12  AL-UNNON            PIC X       VALUE 'J'.
  1329
  1330*                                COPY ELCAID SUPPRESS.
  1331******************************************************************
  1332*                                                                *
  1333*                            ELCAID.                             *
  1334*                            VMOD=2.001                          *
  1335*                                                                *
  1336*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1337*                                                                *
  1338*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1339*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1340******************************************************************
  1341
  1342 01  DFHAID.
  1343   02  DFHNULL   PIC  X  VALUE  ' '.
  1344   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1345   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1346   02  DFHPEN    PIC  X  VALUE  '='.
  1347   02  DFHOPID   PIC  X  VALUE  'W'.
  1348   02  DFHPA1    PIC  X  VALUE  '%'.
  1349   02  DFHPA2    PIC  X  VALUE  '>'.
  1350   02  DFHPA3    PIC  X  VALUE  ','.
  1351   02  DFHPF1    PIC  X  VALUE  '1'.
  1352   02  DFHPF2    PIC  X  VALUE  '2'.
  1353   02  DFHPF3    PIC  X  VALUE  '3'.
  1354   02  DFHPF4    PIC  X  VALUE  '4'.
  1355   02  DFHPF5    PIC  X  VALUE  '5'.
  1356   02  DFHPF6    PIC  X  VALUE  '6'.
  1357   02  DFHPF7    PIC  X  VALUE  '7'.
  1358   02  DFHPF8    PIC  X  VALUE  '8'.
  1359   02  DFHPF9    PIC  X  VALUE  '9'.
  1360   02  DFHPF10   PIC  X  VALUE  ':'.
  1361   02  DFHPF11   PIC  X  VALUE  '#'.
  1362   02  DFHPF12   PIC  X  VALUE  '@'.
  1363   02  DFHPF13   PIC  X  VALUE  'A'.
  1364   02  DFHPF14   PIC  X  VALUE  'B'.
  1365   02  DFHPF15   PIC  X  VALUE  'C'.
  1366   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  28
* EL131.cbl
  1367   02  DFHPF17   PIC  X  VALUE  'E'.
  1368   02  DFHPF18   PIC  X  VALUE  'F'.
  1369   02  DFHPF19   PIC  X  VALUE  'G'.
  1370   02  DFHPF20   PIC  X  VALUE  'H'.
  1371   02  DFHPF21   PIC  X  VALUE  'I'.
  1372*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1373   02  DFHPF22   PIC  X  VALUE  '['.
  1374   02  DFHPF23   PIC  X  VALUE  '.'.
  1375   02  DFHPF24   PIC  X  VALUE  '<'.
  1376   02  DFHMSRE   PIC  X  VALUE  'X'.
  1377   02  DFHSTRF   PIC  X  VALUE  'h'.
  1378   02  DFHTRIG   PIC  X  VALUE  '"'.
  1379 01  FILLER REDEFINES DFHAID.
  1380     12  FILLER                  PIC X(8).
  1381     12  AID-KEYS OCCURS 24 TIMES.
  1382         16  FILLER              PIC X.
  1383
  1384*                                COPY EL131S.
  1385 01  EL131AI.
  1386     05  FILLER            PIC  X(0012).
  1387*    -------------------------------
  1388     05  DATEL PIC S9(0004) COMP.
  1389     05  DATEF PIC  X(0001).
  1390     05  FILLER REDEFINES DATEF.
  1391         10  DATEA PIC  X(0001).
  1392     05  DATEI PIC  X(0008).
  1393*    -------------------------------
  1394     05  TIMEL PIC S9(0004) COMP.
  1395     05  TIMEF PIC  X(0001).
  1396     05  FILLER REDEFINES TIMEF.
  1397         10  TIMEA PIC  X(0001).
  1398     05  TIMEI PIC  X(0005).
  1399*    -------------------------------
  1400     05  SEQUL PIC S9(0004) COMP.
  1401     05  SEQUF PIC  X(0001).
  1402     05  FILLER REDEFINES SEQUF.
  1403         10  SEQUA PIC  X(0001).
  1404     05  SEQUI PIC  X(0010).
  1405*    -------------------------------
  1406     05  COMPL PIC S9(0004) COMP.
  1407     05  COMPF PIC  X(0001).
  1408     05  FILLER REDEFINES COMPF.
  1409         10  COMPA PIC  X(0001).
  1410     05  COMPI PIC  X(0003).
  1411*    -------------------------------
  1412     05  USERIDL PIC S9(0004) COMP.
  1413     05  USERIDF PIC  X(0001).
  1414     05  FILLER REDEFINES USERIDF.
  1415         10  USERIDA PIC  X(0001).
  1416     05  USERIDI PIC  X(0004).
  1417*    -------------------------------
  1418     05  LABEL1L PIC S9(0004) COMP.
  1419     05  LABEL1F PIC  X(0001).
  1420     05  FILLER REDEFINES LABEL1F.
  1421         10  LABEL1A PIC  X(0001).
  1422     05  LABEL1I PIC  X(0011).
  1423*    -------------------------------
  1424     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  29
* EL131.cbl
  1425     05  PCERTNOF PIC  X(0001).
  1426     05  FILLER REDEFINES PCERTNOF.
  1427         10  PCERTNOA PIC  X(0001).
  1428     05  PCERTNOI PIC  X(0010).
  1429*    -------------------------------
  1430     05  PSUFXL PIC S9(0004) COMP.
  1431     05  PSUFXF PIC  X(0001).
  1432     05  FILLER REDEFINES PSUFXF.
  1433         10  PSUFXA PIC  X(0001).
  1434     05  PSUFXI PIC  X(0001).
  1435*    -------------------------------
  1436     05  CCNOL PIC S9(0004) COMP.
  1437     05  CCNOF PIC  X(0001).
  1438     05  FILLER REDEFINES CCNOF.
  1439         10  CCNOA PIC  X(0001).
  1440     05  CCNOI PIC  X(0016).
  1441*    -------------------------------
  1442     05  MAINTL PIC S9(0004) COMP.
  1443     05  MAINTF PIC  X(0001).
  1444     05  FILLER REDEFINES MAINTF.
  1445         10  MAINTA PIC  X(0001).
  1446     05  MAINTI PIC  X(0001).
  1447*    -------------------------------
  1448     05  CLAIML PIC S9(0004) COMP.
  1449     05  CLAIMF PIC  X(0001).
  1450     05  FILLER REDEFINES CLAIMF.
  1451         10  CLAIMA PIC  X(0001).
  1452     05  CLAIMI PIC  X(0007).
  1453*    -------------------------------
  1454     05  CARRL PIC S9(0004) COMP.
  1455     05  CARRF PIC  X(0001).
  1456     05  FILLER REDEFINES CARRF.
  1457         10  CARRA PIC  X(0001).
  1458     05  CARRI PIC  X(0001).
  1459*    -------------------------------
  1460     05  CERTL PIC S9(0004) COMP.
  1461     05  CERTF PIC  X(0001).
  1462     05  FILLER REDEFINES CERTF.
  1463         10  CERTA PIC  X(0001).
  1464     05  CERTI PIC  X(0010).
  1465*    -------------------------------
  1466     05  SUFXL PIC S9(0004) COMP.
  1467     05  SUFXF PIC  X(0001).
  1468     05  FILLER REDEFINES SUFXF.
  1469         10  SUFXA PIC  X(0001).
  1470     05  SUFXI PIC  X(0001).
  1471*    -------------------------------
  1472     05  TYPEL PIC S9(0004) COMP.
  1473     05  TYPEF PIC  X(0001).
  1474     05  FILLER REDEFINES TYPEF.
  1475         10  TYPEA PIC  X(0001).
  1476     05  TYPEI PIC  X(0001).
  1477*    -------------------------------
  1478     05  BENPERL PIC S9(0004) COMP.
  1479     05  BENPERF PIC  X(0001).
  1480     05  FILLER REDEFINES BENPERF.
  1481         10  BENPERA PIC  X(0001).
  1482     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  30
* EL131.cbl
  1483*    -------------------------------
  1484     05  INSTYPEL PIC S9(0004) COMP.
  1485     05  INSTYPEF PIC  X(0001).
  1486     05  FILLER REDEFINES INSTYPEF.
  1487         10  INSTYPEA PIC  X(0001).
  1488     05  INSTYPEI PIC  X(0001).
  1489*    -------------------------------
  1490     05  STATUSL PIC S9(0004) COMP.
  1491     05  STATUSF PIC  X(0001).
  1492     05  FILLER REDEFINES STATUSF.
  1493         10  STATUSA PIC  X(0001).
  1494     05  STATUSI PIC  X(0006).
  1495*    -------------------------------
  1496     05  INCL PIC S9(0004) COMP.
  1497     05  INCF PIC  X(0001).
  1498     05  FILLER REDEFINES INCF.
  1499         10  INCA PIC  X(0001).
  1500     05  INCI PIC  X(0008).
  1501*    -------------------------------
  1502     05  REPL PIC S9(0004) COMP.
  1503     05  REPF PIC  X(0001).
  1504     05  FILLER REDEFINES REPF.
  1505         10  REPA PIC  X(0001).
  1506     05  REPI PIC  X(0008).
  1507*    -------------------------------
  1508     05  ICD1L PIC S9(0004) COMP.
  1509     05  ICD1F PIC  X(0001).
  1510     05  FILLER REDEFINES ICD1F.
  1511         10  ICD1A PIC  X(0001).
  1512     05  ICD1I PIC  X(0008).
  1513*    -------------------------------
  1514     05  ICD2L PIC S9(0004) COMP.
  1515     05  ICD2F PIC  X(0001).
  1516     05  FILLER REDEFINES ICD2F.
  1517         10  ICD2A PIC  X(0001).
  1518     05  ICD2I PIC  X(0008).
  1519*    -------------------------------
  1520     05  DIAGL PIC S9(0004) COMP.
  1521     05  DIAGF PIC  X(0001).
  1522     05  FILLER REDEFINES DIAGF.
  1523         10  DIAGA PIC  X(0001).
  1524     05  DIAGI PIC  X(0060).
  1525*    -------------------------------
  1526     05  ACCSWL PIC S9(0004) COMP.
  1527     05  ACCSWF PIC  X(0001).
  1528     05  FILLER REDEFINES ACCSWF.
  1529         10  ACCSWA PIC  X(0001).
  1530     05  ACCSWI PIC  X(0001).
  1531*    -------------------------------
  1532     05  BENEL PIC S9(0004) COMP.
  1533     05  BENEF PIC  X(0001).
  1534     05  FILLER REDEFINES BENEF.
  1535         10  BENEA PIC  X(0001).
  1536     05  BENEI PIC  X(0010).
  1537*    -------------------------------
  1538     05  BIRTHL PIC S9(0004) COMP.
  1539     05  BIRTHF PIC  X(0001).
  1540     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  31
* EL131.cbl
  1541         10  BIRTHA PIC  X(0001).
  1542     05  BIRTHI PIC  X(0008).
  1543*    -------------------------------
  1544     05  SOCIALL PIC S9(0004) COMP.
  1545     05  SOCIALF PIC  X(0001).
  1546     05  FILLER REDEFINES SOCIALF.
  1547         10  SOCIALA PIC  X(0001).
  1548     05  SOCIALI PIC  X(0011).
  1549*    -------------------------------
  1550     05  SEXL PIC S9(0004) COMP.
  1551     05  SEXF PIC  X(0001).
  1552     05  FILLER REDEFINES SEXF.
  1553         10  SEXA PIC  X(0001).
  1554     05  SEXI PIC  X(0001).
  1555*    -------------------------------
  1556     05  MLNAMEL PIC S9(0004) COMP.
  1557     05  MLNAMEF PIC  X(0001).
  1558     05  FILLER REDEFINES MLNAMEF.
  1559         10  MLNAMEA PIC  X(0001).
  1560     05  MLNAMEI PIC  X(0015).
  1561*    -------------------------------
  1562     05  MFNAMEL PIC S9(0004) COMP.
  1563     05  MFNAMEF PIC  X(0001).
  1564     05  FILLER REDEFINES MFNAMEF.
  1565         10  MFNAMEA PIC  X(0001).
  1566     05  MFNAMEI PIC  X(0012).
  1567*    -------------------------------
  1568     05  MMINITL PIC S9(0004) COMP.
  1569     05  MMINITF PIC  X(0001).
  1570     05  FILLER REDEFINES MMINITF.
  1571         10  MMINITA PIC  X(0001).
  1572     05  MMINITI PIC  X(0001).
  1573*    -------------------------------
  1574     05  AUTHRCVL PIC S9(0004) COMP.
  1575     05  AUTHRCVF PIC  X(0001).
  1576     05  FILLER REDEFINES AUTHRCVF.
  1577         10  AUTHRCVA PIC  X(0001).
  1578     05  AUTHRCVI PIC  X(0001).
  1579*    -------------------------------
  1580     05  CRTLNMEL PIC S9(0004) COMP.
  1581     05  CRTLNMEF PIC  X(0001).
  1582     05  FILLER REDEFINES CRTLNMEF.
  1583         10  CRTLNMEA PIC  X(0001).
  1584     05  CRTLNMEI PIC  X(0015).
  1585*    -------------------------------
  1586     05  CRTFNMEL PIC S9(0004) COMP.
  1587     05  CRTFNMEF PIC  X(0001).
  1588     05  FILLER REDEFINES CRTFNMEF.
  1589         10  CRTFNMEA PIC  X(0001).
  1590     05  CRTFNMEI PIC  X(0012).
  1591*    -------------------------------
  1592     05  CRTINITL PIC S9(0004) COMP.
  1593     05  CRTINITF PIC  X(0001).
  1594     05  FILLER REDEFINES CRTINITF.
  1595         10  CRTINITA PIC  X(0001).
  1596     05  CRTINITI PIC  X(0001).
  1597*    -------------------------------
  1598     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  32
* EL131.cbl
  1599     05  LOANBALF PIC  X(0001).
  1600     05  FILLER REDEFINES LOANBALF.
  1601         10  LOANBALA PIC  X(0001).
  1602     05  LOANBALI PIC  9(7)V99.
  1603*    -------------------------------
  1604     05  PROCL PIC S9(0004) COMP.
  1605     05  PROCF PIC  X(0001).
  1606     05  FILLER REDEFINES PROCF.
  1607         10  PROCA PIC  X(0001).
  1608     05  PROCI PIC  X(0004).
  1609*    -------------------------------
  1610     05  SUPVL PIC S9(0004) COMP.
  1611     05  SUPVF PIC  X(0001).
  1612     05  FILLER REDEFINES SUPVF.
  1613         10  SUPVA PIC  X(0001).
  1614     05  SUPVI PIC  X(0001).
  1615*    -------------------------------
  1616     05  PRICDL PIC S9(0004) COMP.
  1617     05  PRICDF PIC  X(0001).
  1618     05  FILLER REDEFINES PRICDF.
  1619         10  PRICDA PIC  X(0001).
  1620     05  PRICDI PIC  X(0001).
  1621*    -------------------------------
  1622     05  CRITPL PIC S9(0004) COMP.
  1623     05  CRITPF PIC  X(0001).
  1624     05  FILLER REDEFINES CRITPF.
  1625         10  CRITPA PIC  X(0001).
  1626     05  CRITPI PIC  X(0002).
  1627*    -------------------------------
  1628     05  EXTENSL PIC S9(0004) COMP.
  1629     05  EXTENSF PIC  X(0001).
  1630     05  FILLER REDEFINES EXTENSF.
  1631         10  EXTENSA PIC  X(0001).
  1632     05  EXTENSI PIC  99.
  1633*    -------------------------------
  1634     05  FILETOL PIC S9(0004) COMP.
  1635     05  FILETOF PIC  X(0001).
  1636     05  FILLER REDEFINES FILETOF.
  1637         10  FILETOA PIC  X(0001).
  1638     05  FILETOI PIC  X(0004).
  1639*    -------------------------------
  1640     05  PTHRHDGL PIC S9(0004) COMP.
  1641     05  PTHRHDGF PIC  X(0001).
  1642     05  FILLER REDEFINES PTHRHDGF.
  1643         10  PTHRHDGA PIC  X(0001).
  1644     05  PTHRHDGI PIC  X(0010).
  1645*    -------------------------------
  1646     05  PDTHRUL PIC S9(0004) COMP.
  1647     05  PDTHRUF PIC  X(0001).
  1648     05  FILLER REDEFINES PDTHRUF.
  1649         10  PDTHRUA PIC  X(0001).
  1650     05  PDTHRUI PIC  X(0008).
  1651*    -------------------------------
  1652     05  PDAMTL PIC S9(0004) COMP.
  1653     05  PDAMTF PIC  X(0001).
  1654     05  FILLER REDEFINES PDAMTF.
  1655         10  PDAMTA PIC  X(0001).
  1656     05  PDAMTI PIC  9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  33
* EL131.cbl
  1657*    -------------------------------
  1658     05  NODAYSL PIC S9(0004) COMP.
  1659     05  NODAYSF PIC  X(0001).
  1660     05  FILLER REDEFINES NODAYSF.
  1661         10  NODAYSA PIC  X(0001).
  1662     05  NODAYSI PIC  9(5).
  1663*    -------------------------------
  1664     05  NOPMTSL PIC S9(0004) COMP.
  1665     05  NOPMTSF PIC  X(0001).
  1666     05  FILLER REDEFINES NOPMTSF.
  1667         10  NOPMTSA PIC  X(0001).
  1668     05  NOPMTSI PIC  9(4).
  1669*    -------------------------------
  1670     05  FORMTYPL PIC S9(0004) COMP.
  1671     05  FORMTYPF PIC  X(0001).
  1672     05  FILLER REDEFINES FORMTYPF.
  1673         10  FORMTYPA PIC  X(0001).
  1674     05  FORMTYPI PIC  X(0001).
  1675*    -------------------------------
  1676     05  ESTL PIC S9(0004) COMP.
  1677     05  ESTF PIC  X(0001).
  1678     05  FILLER REDEFINES ESTF.
  1679         10  ESTA PIC  X(0001).
  1680     05  ESTI PIC  X(0008).
  1681*    -------------------------------
  1682     05  AUIDL PIC S9(0004) COMP.
  1683     05  AUIDF PIC  X(0001).
  1684     05  FILLER REDEFINES AUIDF.
  1685         10  AUIDA PIC  X(0001).
  1686     05  AUIDI PIC  X(0004).
  1687*    -------------------------------
  1688     05  OCCL PIC S9(0004) COMP.
  1689     05  OCCF PIC  X(0001).
  1690     05  FILLER REDEFINES OCCF.
  1691         10  OCCA PIC  X(0001).
  1692     05  OCCI PIC  X(0006).
  1693*    -------------------------------
  1694     05  MNTDTL PIC S9(0004) COMP.
  1695     05  MNTDTF PIC  X(0001).
  1696     05  FILLER REDEFINES MNTDTF.
  1697         10  MNTDTA PIC  X(0001).
  1698     05  MNTDTI PIC  X(0008).
  1699*    -------------------------------
  1700     05  MNTTYPEL PIC S9(0004) COMP.
  1701     05  MNTTYPEF PIC  X(0001).
  1702     05  FILLER REDEFINES MNTTYPEF.
  1703         10  MNTTYPEA PIC  X(0001).
  1704     05  MNTTYPEI PIC  X(0006).
  1705*    -------------------------------
  1706     05  CERTCARL PIC S9(0004) COMP.
  1707     05  CERTCARF PIC  X(0001).
  1708     05  FILLER REDEFINES CERTCARF.
  1709         10  CERTCARA PIC  X(0001).
  1710     05  CERTCARI PIC  X(0001).
  1711*    -------------------------------
  1712     05  CERTGRPL PIC S9(0004) COMP.
  1713     05  CERTGRPF PIC  X(0001).
  1714     05  FILLER REDEFINES CERTGRPF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  34
* EL131.cbl
  1715         10  CERTGRPA PIC  X(0001).
  1716     05  CERTGRPI PIC  X(0006).
  1717*    -------------------------------
  1718     05  CERTSTL PIC S9(0004) COMP.
  1719     05  CERTSTF PIC  X(0001).
  1720     05  FILLER REDEFINES CERTSTF.
  1721         10  CERTSTA PIC  X(0001).
  1722     05  CERTSTI PIC  X(0002).
  1723*    -------------------------------
  1724     05  CERTACTL PIC S9(0004) COMP.
  1725     05  CERTACTF PIC  X(0001).
  1726     05  FILLER REDEFINES CERTACTF.
  1727         10  CERTACTA PIC  X(0001).
  1728     05  CERTACTI PIC  X(0010).
  1729*    -------------------------------
  1730     05  CERTEFFL PIC S9(0004) COMP.
  1731     05  CERTEFFF PIC  X(0001).
  1732     05  FILLER REDEFINES CERTEFFF.
  1733         10  CERTEFFA PIC  X(0001).
  1734     05  CERTEFFI PIC  X(0008).
  1735*    -------------------------------
  1736     05  ISSAGEL PIC S9(0004) COMP.
  1737     05  ISSAGEF PIC  X(0001).
  1738     05  FILLER REDEFINES ISSAGEF.
  1739         10  ISSAGEA PIC  X(0001).
  1740     05  ISSAGEI PIC  X(0002).
  1741*    -------------------------------
  1742     05  APRL PIC S9(0004) COMP.
  1743     05  APRF PIC  X(0001).
  1744     05  FILLER REDEFINES APRF.
  1745         10  APRA PIC  X(0001).
  1746     05  APRI PIC  9(4)V9(4).
  1747*    -------------------------------
  1748     05  PMTFREQL PIC S9(0004) COMP.
  1749     05  PMTFREQF PIC  X(0001).
  1750     05  FILLER REDEFINES PMTFREQF.
  1751         10  PMTFREQA PIC  X(0001).
  1752     05  PMTFREQI PIC  99.
  1753*    -------------------------------
  1754     05  INDGRPL PIC S9(0004) COMP.
  1755     05  INDGRPF PIC  X(0001).
  1756     05  FILLER REDEFINES INDGRPF.
  1757         10  INDGRPA PIC  X(0001).
  1758     05  INDGRPI PIC  X(0001).
  1759*    -------------------------------
  1760     05  PREMTYPL PIC S9(0004) COMP.
  1761     05  PREMTYPF PIC  X(0001).
  1762     05  FILLER REDEFINES PREMTYPF.
  1763         10  PREMTYPA PIC  X(0001).
  1764     05  PREMTYPI PIC  X(0001).
  1765*    -------------------------------
  1766     05  REINCDL PIC S9(0004) COMP.
  1767     05  REINCDF PIC  X(0001).
  1768     05  FILLER REDEFINES REINCDF.
  1769         10  REINCDA PIC  X(0001).
  1770     05  REINCDI PIC  X(0001).
  1771*    -------------------------------
  1772     05  JNTLNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  35
* EL131.cbl
  1773     05  JNTLNMEF PIC  X(0001).
  1774     05  FILLER REDEFINES JNTLNMEF.
  1775         10  JNTLNMEA PIC  X(0001).
  1776     05  JNTLNMEI PIC  X(0015).
  1777*    -------------------------------
  1778     05  JNTFNMEL PIC S9(0004) COMP.
  1779     05  JNTFNMEF PIC  X(0001).
  1780     05  FILLER REDEFINES JNTFNMEF.
  1781         10  JNTFNMEA PIC  X(0001).
  1782     05  JNTFNMEI PIC  X(0012).
  1783*    -------------------------------
  1784     05  JNTINITL PIC S9(0004) COMP.
  1785     05  JNTINITF PIC  X(0001).
  1786     05  FILLER REDEFINES JNTINITF.
  1787         10  JNTINITA PIC  X(0001).
  1788     05  JNTINITI PIC  X(0001).
  1789*    -------------------------------
  1790     05  JNTAGEL PIC S9(0004) COMP.
  1791     05  JNTAGEF PIC  X(0001).
  1792     05  FILLER REDEFINES JNTAGEF.
  1793         10  JNTAGEA PIC  X(0001).
  1794     05  JNTAGEI PIC  X(0002).
  1795*    -------------------------------
  1796     05  ADDONDTL PIC S9(0004) COMP.
  1797     05  ADDONDTF PIC  X(0001).
  1798     05  FILLER REDEFINES ADDONDTF.
  1799         10  ADDONDTA PIC  X(0001).
  1800     05  ADDONDTI PIC  X(0008).
  1801*    -------------------------------
  1802     05  LCVDSCRL PIC S9(0004) COMP.
  1803     05  LCVDSCRF PIC  X(0001).
  1804     05  FILLER REDEFINES LCVDSCRF.
  1805         10  LCVDSCRA PIC  X(0001).
  1806     05  LCVDSCRI PIC  X(0006).
  1807*    -------------------------------
  1808     05  LCVKINDL PIC S9(0004) COMP.
  1809     05  LCVKINDF PIC  X(0001).
  1810     05  FILLER REDEFINES LCVKINDF.
  1811         10  LCVKINDA PIC  X(0001).
  1812     05  LCVKINDI PIC  X(0003).
  1813*    -------------------------------
  1814     05  LCVCDL PIC S9(0004) COMP.
  1815     05  LCVCDF PIC  X(0001).
  1816     05  FILLER REDEFINES LCVCDF.
  1817         10  LCVCDA PIC  X(0001).
  1818     05  LCVCDI PIC  X(0002).
  1819*    -------------------------------
  1820     05  LCVOTRML PIC S9(0004) COMP.
  1821     05  LCVOTRMF PIC  X(0001).
  1822     05  FILLER REDEFINES LCVOTRMF.
  1823         10  LCVOTRMA PIC  X(0001).
  1824     05  LCVOTRMI PIC  999.
  1825*    -------------------------------
  1826     05  LCVRTRML PIC S9(0004) COMP.
  1827     05  LCVRTRMF PIC  X(0001).
  1828     05  FILLER REDEFINES LCVRTRMF.
  1829         10  LCVRTRMA PIC  X(0001).
  1830     05  LCVRTRMI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  36
* EL131.cbl
  1831*    -------------------------------
  1832     05  LCVRATEL PIC S9(0004) COMP.
  1833     05  LCVRATEF PIC  X(0001).
  1834     05  FILLER REDEFINES LCVRATEF.
  1835         10  LCVRATEA PIC  X(0001).
  1836     05  LCVRATEI PIC  9999V99.
  1837*    -------------------------------
  1838     05  LCVBENEL PIC S9(0004) COMP.
  1839     05  LCVBENEF PIC  X(0001).
  1840     05  FILLER REDEFINES LCVBENEF.
  1841         10  LCVBENEA PIC  X(0001).
  1842     05  LCVBENEI PIC  9(9)V99.
  1843*    -------------------------------
  1844     05  LCVFORML PIC S9(0004) COMP.
  1845     05  LCVFORMF PIC  X(0001).
  1846     05  FILLER REDEFINES LCVFORMF.
  1847         10  LCVFORMA PIC  X(0001).
  1848     05  LCVFORMI PIC  X(0012).
  1849*    -------------------------------
  1850     05  LCVCNDTL PIC S9(0004) COMP.
  1851     05  LCVCNDTF PIC  X(0001).
  1852     05  FILLER REDEFINES LCVCNDTF.
  1853         10  LCVCNDTA PIC  X(0001).
  1854     05  LCVCNDTI PIC  X(0008).
  1855*    -------------------------------
  1856     05  LCVEXITL PIC S9(0004) COMP.
  1857     05  LCVEXITF PIC  X(0001).
  1858     05  FILLER REDEFINES LCVEXITF.
  1859         10  LCVEXITA PIC  X(0001).
  1860     05  LCVEXITI PIC  X(0008).
  1861*    -------------------------------
  1862     05  LCVSTATL PIC S9(0004) COMP.
  1863     05  LCVSTATF PIC  X(0001).
  1864     05  FILLER REDEFINES LCVSTATF.
  1865         10  LCVSTATA PIC  X(0001).
  1866     05  LCVSTATI PIC  X(0006).
  1867*    -------------------------------
  1868     05  ACVDSCRL PIC S9(0004) COMP.
  1869     05  ACVDSCRF PIC  X(0001).
  1870     05  FILLER REDEFINES ACVDSCRF.
  1871         10  ACVDSCRA PIC  X(0001).
  1872     05  ACVDSCRI PIC  X(0006).
  1873*    -------------------------------
  1874     05  ACVKINDL PIC S9(0004) COMP.
  1875     05  ACVKINDF PIC  X(0001).
  1876     05  FILLER REDEFINES ACVKINDF.
  1877         10  ACVKINDA PIC  X(0001).
  1878     05  ACVKINDI PIC  X(0003).
  1879*    -------------------------------
  1880     05  ACVCDL PIC S9(0004) COMP.
  1881     05  ACVCDF PIC  X(0001).
  1882     05  FILLER REDEFINES ACVCDF.
  1883         10  ACVCDA PIC  X(0001).
  1884     05  ACVCDI PIC  X(0002).
  1885*    -------------------------------
  1886     05  ACVOTRML PIC S9(0004) COMP.
  1887     05  ACVOTRMF PIC  X(0001).
  1888     05  FILLER REDEFINES ACVOTRMF.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  37
* EL131.cbl
  1889         10  ACVOTRMA PIC  X(0001).
  1890     05  ACVOTRMI PIC  999.
  1891*    -------------------------------
  1892     05  ACVRTRML PIC S9(0004) COMP.
  1893     05  ACVRTRMF PIC  X(0001).
  1894     05  FILLER REDEFINES ACVRTRMF.
  1895         10  ACVRTRMA PIC  X(0001).
  1896     05  ACVRTRMI PIC  X(0003).
  1897*    -------------------------------
  1898     05  ACVRATEL PIC S9(0004) COMP.
  1899     05  ACVRATEF PIC  X(0001).
  1900     05  FILLER REDEFINES ACVRATEF.
  1901         10  ACVRATEA PIC  X(0001).
  1902     05  ACVRATEI PIC  9999V99.
  1903*    -------------------------------
  1904     05  ACVBENEL PIC S9(0004) COMP.
  1905     05  ACVBENEF PIC  X(0001).
  1906     05  FILLER REDEFINES ACVBENEF.
  1907         10  ACVBENEA PIC  X(0001).
  1908     05  ACVBENEI PIC  9(9)V99.
  1909*    -------------------------------
  1910     05  ACVFORML PIC S9(0004) COMP.
  1911     05  ACVFORMF PIC  X(0001).
  1912     05  FILLER REDEFINES ACVFORMF.
  1913         10  ACVFORMA PIC  X(0001).
  1914     05  ACVFORMI PIC  X(0012).
  1915*    -------------------------------
  1916     05  ACVCNDTL PIC S9(0004) COMP.
  1917     05  ACVCNDTF PIC  X(0001).
  1918     05  FILLER REDEFINES ACVCNDTF.
  1919         10  ACVCNDTA PIC  X(0001).
  1920     05  ACVCNDTI PIC  X(0008).
  1921*    -------------------------------
  1922     05  ACVEXITL PIC S9(0004) COMP.
  1923     05  ACVEXITF PIC  X(0001).
  1924     05  FILLER REDEFINES ACVEXITF.
  1925         10  ACVEXITA PIC  X(0001).
  1926     05  ACVEXITI PIC  X(0008).
  1927*    -------------------------------
  1928     05  ACVSTATL PIC S9(0004) COMP.
  1929     05  ACVSTATF PIC  X(0001).
  1930     05  FILLER REDEFINES ACVSTATF.
  1931         10  ACVSTATA PIC  X(0001).
  1932     05  ACVSTATI PIC  X(0006).
  1933*    -------------------------------
  1934     05  LABEL2L PIC S9(0004) COMP.
  1935     05  LABEL2F PIC  X(0001).
  1936     05  FILLER REDEFINES LABEL2F.
  1937         10  LABEL2A PIC  X(0001).
  1938     05  LABEL2I PIC  X(0014).
  1939*    -------------------------------
  1940     05  BCERT1L PIC S9(0004) COMP.
  1941     05  BCERT1F PIC  X(0001).
  1942     05  FILLER REDEFINES BCERT1F.
  1943         10  BCERT1A PIC  X(0001).
  1944     05  BCERT1I PIC  X(0010).
  1945*    -------------------------------
  1946     05  BSUFX1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  38
* EL131.cbl
  1947     05  BSUFX1F PIC  X(0001).
  1948     05  FILLER REDEFINES BSUFX1F.
  1949         10  BSUFX1A PIC  X(0001).
  1950     05  BSUFX1I PIC  X(0001).
  1951*    -------------------------------
  1952     05  BCERT2L PIC S9(0004) COMP.
  1953     05  BCERT2F PIC  X(0001).
  1954     05  FILLER REDEFINES BCERT2F.
  1955         10  BCERT2A PIC  X(0001).
  1956     05  BCERT2I PIC  X(0010).
  1957*    -------------------------------
  1958     05  BSUFX2L PIC S9(0004) COMP.
  1959     05  BSUFX2F PIC  X(0001).
  1960     05  FILLER REDEFINES BSUFX2F.
  1961         10  BSUFX2A PIC  X(0001).
  1962     05  BSUFX2I PIC  X(0001).
  1963*    -------------------------------
  1964     05  BCERT3L PIC S9(0004) COMP.
  1965     05  BCERT3F PIC  X(0001).
  1966     05  FILLER REDEFINES BCERT3F.
  1967         10  BCERT3A PIC  X(0001).
  1968     05  BCERT3I PIC  X(0010).
  1969*    -------------------------------
  1970     05  BSUFX3L PIC S9(0004) COMP.
  1971     05  BSUFX3F PIC  X(0001).
  1972     05  FILLER REDEFINES BSUFX3F.
  1973         10  BSUFX3A PIC  X(0001).
  1974     05  BSUFX3I PIC  X(0001).
  1975*    -------------------------------
  1976     05  BCERT4L PIC S9(0004) COMP.
  1977     05  BCERT4F PIC  X(0001).
  1978     05  FILLER REDEFINES BCERT4F.
  1979         10  BCERT4A PIC  X(0001).
  1980     05  BCERT4I PIC  X(0010).
  1981*    -------------------------------
  1982     05  BSUFX4L PIC S9(0004) COMP.
  1983     05  BSUFX4F PIC  X(0001).
  1984     05  FILLER REDEFINES BSUFX4F.
  1985         10  BSUFX4A PIC  X(0001).
  1986     05  BSUFX4I PIC  X(0001).
  1987*    -------------------------------
  1988     05  BCERT5L PIC S9(0004) COMP.
  1989     05  BCERT5F PIC  X(0001).
  1990     05  FILLER REDEFINES BCERT5F.
  1991         10  BCERT5A PIC  X(0001).
  1992     05  BCERT5I PIC  X(0010).
  1993*    -------------------------------
  1994     05  BSUFX5L PIC S9(0004) COMP.
  1995     05  BSUFX5F PIC  X(0001).
  1996     05  FILLER REDEFINES BSUFX5F.
  1997         10  BSUFX5A PIC  X(0001).
  1998     05  BSUFX5I PIC  X(0001).
  1999*    -------------------------------
  2000     05  MSG1L PIC S9(0004) COMP.
  2001     05  MSG1F PIC  X(0001).
  2002     05  FILLER REDEFINES MSG1F.
  2003         10  MSG1A PIC  X(0001).
  2004     05  MSG1I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  39
* EL131.cbl
  2005*    -------------------------------
  2006     05  MSG2L PIC S9(0004) COMP.
  2007     05  MSG2F PIC  X(0001).
  2008     05  FILLER REDEFINES MSG2F.
  2009         10  MSG2A PIC  X(0001).
  2010     05  MSG2I PIC  X(0072).
  2011*    -------------------------------
  2012     05  PFKEYL PIC S9(0004) COMP.
  2013     05  PFKEYF PIC  X(0001).
  2014     05  FILLER REDEFINES PFKEYF.
  2015         10  PFKEYA PIC  X(0001).
  2016     05  PFKEYI PIC  99.
  2017*    -------------------------------
  2018     05  PFKEY6L PIC S9(0004) COMP.
  2019     05  PFKEY6F PIC  X(0001).
  2020     05  FILLER REDEFINES PFKEY6F.
  2021         10  PFKEY6A PIC  X(0001).
  2022     05  PFKEY6I PIC  X(0016).
  2023 01  EL131AO REDEFINES EL131AI.
  2024     05  FILLER            PIC  X(0012).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  DATEO PIC  X(0008).
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  TIMEO PIC  99.99.
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  SEQUO PIC  X(0010).
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  COMPO PIC  X(0003).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  USERIDO PIC  X(0004).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  LABEL1O PIC  X(0011).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  PCERTNOO PIC  X(0010).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  PSUFXO PIC  X(0001).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  CCNOO PIC  X(0016).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  MAINTO PIC  X(0001).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  CLAIMO PIC  X(0007).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  CARRO PIC  X(0001).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  40
* EL131.cbl
  2063     05  CERTO PIC  X(0010).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  SUFXO PIC  X(0001).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  TYPEO PIC  X(0001).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  BENPERO PIC  X(0002).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  INSTYPEO PIC  X(0001).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  STATUSO PIC  X(0006).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  INCO PIC  X(0008).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  REPO PIC  X(0008).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  ICD1O PIC  X(0008).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  ICD2O PIC  X(0008).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  DIAGO PIC  X(0060).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  ACCSWO PIC  X(0001).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  BENEO PIC  X(0010).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  BIRTHO PIC  X(0008).
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  SOCIALO PIC  X(0011).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  SEXO PIC  X(0001).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  MLNAMEO PIC  X(0015).
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  MFNAMEO PIC  X(0012).
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  MMINITO PIC  X(0001).
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  AUTHRCVO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  41
* EL131.cbl
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  CRTLNMEO PIC  X(0015).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  CRTFNMEO PIC  X(0012).
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  CRTINITO PIC  X(0001).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  LOANBALO PIC  ZZZZZ9.99.
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  PROCO PIC  X(0004).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  SUPVO PIC  X(0001).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  PRICDO PIC  X(0001).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  CRITPO PIC  X(0002).
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  EXTENSO PIC  X(0002).
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  FILETOO PIC  X(0004).
  2151*    -------------------------------
  2152     05  FILLER            PIC  X(0003).
  2153     05  PTHRHDGO PIC  X(0010).
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  PDTHRUO PIC  X(0008).
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  PDAMTO PIC  Z(06).99.
  2160*    -------------------------------
  2161     05  FILLER            PIC  X(0003).
  2162     05  NODAYSO PIC  ZZZ99.
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  NOPMTSO PIC  ZZ99.
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  FORMTYPO PIC  X(0001).
  2169*    -------------------------------
  2170     05  FILLER            PIC  X(0003).
  2171     05  ESTO PIC  X(0008).
  2172*    -------------------------------
  2173     05  FILLER            PIC  X(0003).
  2174     05  AUIDO PIC  X(0004).
  2175*    -------------------------------
  2176     05  FILLER            PIC  X(0003).
  2177     05  OCCO PIC  X(0006).
  2178*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  42
* EL131.cbl
  2179     05  FILLER            PIC  X(0003).
  2180     05  MNTDTO PIC  X(0008).
  2181*    -------------------------------
  2182     05  FILLER            PIC  X(0003).
  2183     05  MNTTYPEO PIC  X(0006).
  2184*    -------------------------------
  2185     05  FILLER            PIC  X(0003).
  2186     05  CERTCARO PIC  X(0001).
  2187*    -------------------------------
  2188     05  FILLER            PIC  X(0003).
  2189     05  CERTGRPO PIC  X(0006).
  2190*    -------------------------------
  2191     05  FILLER            PIC  X(0003).
  2192     05  CERTSTO PIC  X(0002).
  2193*    -------------------------------
  2194     05  FILLER            PIC  X(0003).
  2195     05  CERTACTO PIC  X(0010).
  2196*    -------------------------------
  2197     05  FILLER            PIC  X(0003).
  2198     05  CERTEFFO PIC  X(0008).
  2199*    -------------------------------
  2200     05  FILLER            PIC  X(0003).
  2201     05  ISSAGEO PIC  X(0002).
  2202*    -------------------------------
  2203     05  FILLER            PIC  X(0003).
  2204     05  APRO PIC  9(3).9(4).
  2205*    -------------------------------
  2206     05  FILLER            PIC  X(0003).
  2207     05  PMTFREQO PIC  99.
  2208*    -------------------------------
  2209     05  FILLER            PIC  X(0003).
  2210     05  INDGRPO PIC  X(0001).
  2211*    -------------------------------
  2212     05  FILLER            PIC  X(0003).
  2213     05  PREMTYPO PIC  X(0001).
  2214*    -------------------------------
  2215     05  FILLER            PIC  X(0003).
  2216     05  REINCDO PIC  X(0001).
  2217*    -------------------------------
  2218     05  FILLER            PIC  X(0003).
  2219     05  JNTLNMEO PIC  X(0015).
  2220*    -------------------------------
  2221     05  FILLER            PIC  X(0003).
  2222     05  JNTFNMEO PIC  X(0012).
  2223*    -------------------------------
  2224     05  FILLER            PIC  X(0003).
  2225     05  JNTINITO PIC  X(0001).
  2226*    -------------------------------
  2227     05  FILLER            PIC  X(0003).
  2228     05  JNTAGEO PIC  X(0002).
  2229*    -------------------------------
  2230     05  FILLER            PIC  X(0003).
  2231     05  ADDONDTO PIC  X(0008).
  2232*    -------------------------------
  2233     05  FILLER            PIC  X(0003).
  2234     05  LCVDSCRO PIC  X(0006).
  2235*    -------------------------------
  2236     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  43
* EL131.cbl
  2237     05  LCVKINDO PIC  X(0003).
  2238*    -------------------------------
  2239     05  FILLER            PIC  X(0003).
  2240     05  LCVCDO PIC  X(0002).
  2241*    -------------------------------
  2242     05  FILLER            PIC  X(0003).
  2243     05  LCVOTRMO PIC  999.
  2244*    -------------------------------
  2245     05  FILLER            PIC  X(0003).
  2246     05  LCVRTRMO PIC  999.
  2247*    -------------------------------
  2248     05  FILLER            PIC  X(0003).
  2249     05  LCVRATEO PIC  ZZZ.ZZ.
  2250*    -------------------------------
  2251     05  FILLER            PIC  X(0003).
  2252     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2253*    -------------------------------
  2254     05  FILLER            PIC  X(0003).
  2255     05  LCVFORMO PIC  X(0012).
  2256*    -------------------------------
  2257     05  FILLER            PIC  X(0003).
  2258     05  LCVCNDTO PIC  X(0008).
  2259*    -------------------------------
  2260     05  FILLER            PIC  X(0003).
  2261     05  LCVEXITO PIC  X(0008).
  2262*    -------------------------------
  2263     05  FILLER            PIC  X(0003).
  2264     05  LCVSTATO PIC  X(0006).
  2265*    -------------------------------
  2266     05  FILLER            PIC  X(0003).
  2267     05  ACVDSCRO PIC  X(0006).
  2268*    -------------------------------
  2269     05  FILLER            PIC  X(0003).
  2270     05  ACVKINDO PIC  X(0003).
  2271*    -------------------------------
  2272     05  FILLER            PIC  X(0003).
  2273     05  ACVCDO PIC  X(0002).
  2274*    -------------------------------
  2275     05  FILLER            PIC  X(0003).
  2276     05  ACVOTRMO PIC  999.
  2277*    -------------------------------
  2278     05  FILLER            PIC  X(0003).
  2279     05  ACVRTRMO PIC  999.
  2280*    -------------------------------
  2281     05  FILLER            PIC  X(0003).
  2282     05  ACVRATEO PIC  ZZZ.ZZ.
  2283*    -------------------------------
  2284     05  FILLER            PIC  X(0003).
  2285     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2286*    -------------------------------
  2287     05  FILLER            PIC  X(0003).
  2288     05  ACVFORMO PIC  X(0012).
  2289*    -------------------------------
  2290     05  FILLER            PIC  X(0003).
  2291     05  ACVCNDTO PIC  X(0008).
  2292*    -------------------------------
  2293     05  FILLER            PIC  X(0003).
  2294     05  ACVEXITO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  44
* EL131.cbl
  2295*    -------------------------------
  2296     05  FILLER            PIC  X(0003).
  2297     05  ACVSTATO PIC  X(0006).
  2298*    -------------------------------
  2299     05  FILLER            PIC  X(0003).
  2300     05  LABEL2O PIC  X(0014).
  2301*    -------------------------------
  2302     05  FILLER            PIC  X(0003).
  2303     05  BCERT1O PIC  X(0010).
  2304*    -------------------------------
  2305     05  FILLER            PIC  X(0003).
  2306     05  BSUFX1O PIC  X(0001).
  2307*    -------------------------------
  2308     05  FILLER            PIC  X(0003).
  2309     05  BCERT2O PIC  X(0010).
  2310*    -------------------------------
  2311     05  FILLER            PIC  X(0003).
  2312     05  BSUFX2O PIC  X(0001).
  2313*    -------------------------------
  2314     05  FILLER            PIC  X(0003).
  2315     05  BCERT3O PIC  X(0010).
  2316*    -------------------------------
  2317     05  FILLER            PIC  X(0003).
  2318     05  BSUFX3O PIC  X(0001).
  2319*    -------------------------------
  2320     05  FILLER            PIC  X(0003).
  2321     05  BCERT4O PIC  X(0010).
  2322*    -------------------------------
  2323     05  FILLER            PIC  X(0003).
  2324     05  BSUFX4O PIC  X(0001).
  2325*    -------------------------------
  2326     05  FILLER            PIC  X(0003).
  2327     05  BCERT5O PIC  X(0010).
  2328*    -------------------------------
  2329     05  FILLER            PIC  X(0003).
  2330     05  BSUFX5O PIC  X(0001).
  2331*    -------------------------------
  2332     05  FILLER            PIC  X(0003).
  2333     05  MSG1O PIC  X(0072).
  2334*    -------------------------------
  2335     05  FILLER            PIC  X(0003).
  2336     05  MSG2O PIC  X(0072).
  2337*    -------------------------------
  2338     05  FILLER            PIC  X(0003).
  2339     05  PFKEYO PIC  X(0002).
  2340*    -------------------------------
  2341     05  FILLER            PIC  X(0003).
  2342     05  PFKEY6O PIC  X(0016).
  2343*    -------------------------------
  2344
  2345*                                COPY ELCEMIB SUPPRESS.
  2346******************************************************************
  2347*                                                                *
  2348*                                                                *
  2349*                            ELCEMIB.                            *
  2350*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2351*                            VMOD=2.005                          *
  2352*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  45
* EL131.cbl
  2353*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2354*                                                                *
  2355******************************************************************
  2356 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2357     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2358     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2359     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2360     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2361     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2362     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2363     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2364     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2365     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2366         88  EMI-NO-ERRORS                    VALUE '1'.
  2367         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2368         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2369     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2370         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2371     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2372         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2373         88  EMI-AREA1-FULL                   VALUE '2'.
  2374     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2375         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2376         88  EMI-AREA2-FULL                   VALUE '2'.
  2377     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2378         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2379         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2380         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2381         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2382         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2383     12  EMI-ERROR-LINES.
  2384         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2385         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2386         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2387         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2388             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2389                 24  EMI-ERR-NUM         PIC X(4).
  2390                 24  EMI-FILLER          PIC X.
  2391                 24  EMI-SEV             PIC X.
  2392                 24  FILLER              PIC X.
  2393             20  FILLER                  PIC X(02).
  2394     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2395         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2396             20  EMI-ERROR-NUMBER    PIC X(4).
  2397             20  EMI-FILL            PIC X.
  2398             20  EMI-SEVERITY        PIC X.
  2399             20  FILLER              PIC X.
  2400             20  EMI-ERROR-TEXT.
  2401                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2402                 24  FILLER          PIC X(55).
  2403     12  EMI-SEVERITY-SAVE           PIC X.
  2404         88  EMI-NOTE                    VALUE 'N'.
  2405         88  EMI-WARNING                 VALUE 'W'.
  2406         88  EMI-FORCABLE                VALUE 'F'.
  2407         88  EMI-FATAL                   VALUE 'X'.
  2408     12  EMI-MESSAGE-FLAG            PIC X.
  2409         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2410         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  46
* EL131.cbl
  2411     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2412     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2413         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2414         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2415         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2416     12  emi-claim-no                pic x(7).
  2417     12  emi-claim-type              pic x(6).
  2418     12  FILLER                      PIC X(124)  VALUE SPACES.
  2419     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2420     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2421     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2422     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2423
  2424*                                COPY ELCJPFX SUPPRESS.
  2425******************************************************************
  2426*                                                                *
  2427*                                                                *
  2428*                            ELCJPFX.                            *
  2429*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2430*                            VMOD=2.002                          *
  2431*                                                                *
  2432*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2433*                                                                *
  2434*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2435*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2436*        ELCNTL - CONTROL FILE                                   *
  2437*        ELMSTR - CLAIM MASTERS                                  *
  2438*        ELTRLR - ACTIVITY TRAILERS                              *
  2439*        ELCHKQ - CHECK QUE                                      *
  2440******************************************************************
  2441 01  JOURNAL-RECORD.
  2442     12  jp-date                     pic s9(5) comp-3.
  2443     12  jp-time                     pic s9(7) comp-3.
  2444     12  JP-USER-ID                  PIC X(4).
  2445     12  JP-FILE-ID                  PIC X(8).
  2446     12  JP-PROGRAM-ID               PIC X(8).
  2447     12  JP-RECORD-TYPE              PIC X.
  2448         88 JP-ADD              VALUE 'A'.
  2449         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2450         88 JP-AFTER-CHANGE     VALUE 'C'.
  2451         88 JP-DELETE           VALUE 'D'.
  2452         88 JP-GENERIC-DELETE   VALUE 'G'.
  2453         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2454         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2455     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2456     12  JP-RECORD-AREA
  2457
  2458
  2459                                 PIC X(750).
  2460
  2461*                                COPY ELCCALC.
  2462******************************************************************
  2463*                                                                *
  2464*                           ELCCALC.                            *
  2465*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2466*                            VMOD=2.025                          *
  2467*                                                                *
  2468*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  47
* EL131.cbl
  2469*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2470*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2471*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2472*                                                                *
  2473*  PASSED TO ELRTRM                                              *
  2474*  -----------------                                             *
  2475*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2476*  ORIGINAL TERM                                                 *
  2477*  BEGINNING DATE                                                *
  2478*  ENDING DATE                                                   *
  2479*  COMPANY I.D.                                                  *
  2480*  ACCOUNT MASTER USER FIELD                                     *
  2481*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2482*  FREE LOOK DAYS                                                *
  2483*                                                                *
  2484*  RETURNED FROM ELRTRM                                          *
  2485*  ---------------------                                         *
  2486*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2487*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2488*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2489*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2490*----------------------------------------------------------------*
  2491*  PASSED TO ELRAMT                                              *
  2492*  ----------------                                              *
  2493*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2494*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2495*  ORIGINAL AMOUNT                                               *
  2496*  ALTERNATE BENEFIT (BALLON)                                    *
  2497*  A.P.R. - NET PAY ONLY                                         *
  2498*  METHOD
  2499*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2500*  COMPANY I.D.                                                  *
  2501*  BENEFIT TYPE                                                  *
  2502*                                                                *
  2503*  RETURNED FROM ELRAMT                                          *
  2504*  --------------------                                          *
  2505*  REMAINING AMOUNT 1 - CURRENT                                  *
  2506*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2507*  REMAINING AMOUNT FACTOR
  2508*----------------------------------------------------------------*
  2509*  PASSED TO ELRESV                                              *
  2510*  -----------------                                             *
  2511*  CERTIFICATE EFFECTIVE DATE                                    *
  2512*  VALUATION DATE                                                *
  2513*  PAID THRU DATE                                                *
  2514*  BENEFIT                                                       *
  2515*  INCURRED DATE                                                 *
  2516*  REPORTED DATE                                                 *
  2517*  ISSUE AGE                                                     *
  2518*  TERM                                                          *
  2519*  CDT PERCENT                                                   *
  2520*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2521* *CLAIM TYPE (LIFE, A/H)                                        *
  2522* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2523* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2524*                                                                *
  2525*  RETURNED FROM ELRESV                                          *
  2526*  --------------------                                          *
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  48
* EL131.cbl
  2527*  CDT TABLE USED                                                *
  2528*  CDT FACTOR USED                                               *
  2529*  PAY TO CURRENT RESERVE                                        *
  2530*  I.B.N.R. - A/H ONLY                                           *
  2531*  FUTURE (ACCRUED) AH ONLY                                      *
  2532*----------------------------------------------------------------*
  2533*  PASSED TO ELRATE                                              *
  2534*  ----------------                                              *
  2535*  CERT ISSUE DATE                                               *
  2536*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2537*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2538*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2539*  STATE CODE (CLIENT DEFINED)                                   *
  2540*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2541*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2542*  DEVIATION CODE                                                *
  2543*  ISSUE AGE                                                     *
  2544*  ORIGINAL BENEFIT AMOUNT                                       *
  2545*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2546*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2547*  BENEFIT KIND (LIFE OR A/H)                                    *
  2548*  A.P.R.                                                        *
  2549*  METHOD
  2550*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2551*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2552*  COMPANY I.D. (3 CHARACTER)                                    *
  2553*  BENEFIT CODE                                                  *
  2554*  BENEFIT OVERRIDE CODE                                         *
  2555*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2556*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2557*  JOINT INDICATOR (CSL ONLY)                                    *
  2558*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2559*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2560*                                                                *
  2561*  RETURNED FROM ELRATE                                          *
  2562*  --------------------                                          *
  2563*  CALCULATED PREMIUM                                            *
  2564*  PREMIUM RATE                                                  *
  2565*  MORTALITY CODE                                                *
  2566*  MAX ATTAINED AGE                                              *
  2567*  MAX AGE                                                       *
  2568*  MAX TERM                                                      *
  2569*  MAX MONTHLY BENEFIT                                           *
  2570*  MAX TOTAL BENIFIT                                             *
  2571*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2572*----------------------------------------------------------------*
  2573*  PASSED TO ELRFND                                              *
  2574*  ----------------                                              *
  2575*  CERT ISSUE DATE                                               *
  2576*  REFUND DATE                                                   *
  2577*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2578*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2579*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2580*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2581*  STATE CODE (CLIENT DEFINED)                                   *
  2582*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2583*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2584*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  49
* EL131.cbl
  2585*  ISSUE AGE                                                     *
  2586*  ORIGINAL BENEFIT AMOUNT                                       *
  2587*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2588*  PROCESS TYPE (CANCEL)                                         *
  2589*  BENEFIT KIND (LIFE OR A/H)                                    *
  2590*  A.P.R.                                                        *
  2591*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2592*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2593*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2594*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2595*  COMPANY I.D. (3 CHARACTER)                                    *
  2596*  BENEFIT CODE                                                  *
  2597*  BENEFIT OVERRIDE CODE                                         *
  2598*                                                                *
  2599*  RETURNED FROM ELRFND                                          *
  2600*  --------------------                                          *
  2601*  CALCULATED REFUND                                             *
  2602*----------------------------------------------------------------*
  2603*  PASSED TO ELEARN                                              *
  2604*  ----------------                                              *
  2605*  CERT ISSUE DATE                                               *
  2606*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2607*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2608*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2609*  STATE CODE (CLIENT DEFINED)                                   *
  2610*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2611*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2612*  DEVIATION CODE                                                *
  2613*  ISSUE AGE                                                     *
  2614*  ORIGINAL BENEFIT AMOUNT                                       *
  2615*  BENEFIT KIND (LIFE OR A/H)                                    *
  2616*  A.P.R.                                                        *
  2617*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2618*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2619*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2620*  COMPANY I.D. (3 CHARACTER)                                    *
  2621*  BENEFIT CODE                                                  *
  2622*  BENEFIT OVERRIDE CODE                                         *
  2623*                                                                *
  2624*  RETURNED FROM ELEARN                                          *
  2625*  --------------------                                          *
  2626*  INDICATED  EARNINGS                                           *
  2627*----------------------------------------------------------------*
  2628*                 LENGTH = 450                                   *
  2629*                                                                *
  2630******************************************************************
  2631******************************************************************
  2632*                   C H A N G E   L O G
  2633*
  2634* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2635*-----------------------------------------------------------------
  2636*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2637* EFFECTIVE    NUMBER
  2638*-----------------------------------------------------------------
  2639* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2640* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2641* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2642* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  50
* EL131.cbl
  2643* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2644* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2645* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2646* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2647* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2648* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2649* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2650******************************************************************
  2651
  2652 01  CALCULATION-PASS-AREA.
  2653     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2654                                     COMP.
  2655
  2656     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2657       88  NO-CP-ERROR                             VALUE ZERO.
  2658       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2659                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2660       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2661       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2662       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2663       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2664       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2665       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2666       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2667       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2668       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2669       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2670       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2671       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2672       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2673       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2674       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2675       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2676       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2677
  2678     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2679       88  NO-CP-ERROR-2                           VALUE ZERO.
  2680***********************  INPUT AREAS ****************************
  2681
  2682     12  CP-CALCULATION-AREA.
  2683         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2684         16  CP-CERT-EFF-DT        PIC XX.
  2685         16  CP-VALUATION-DT       PIC XX.
  2686         16  CP-PAID-THRU-DT       PIC XX.
  2687         16  CP-BENEFIT-TYPE       PIC X.
  2688           88  CP-AH                               VALUE 'A' 'D'
  2689                                                   'I' 'U'.
  2690           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2691           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2692         16  CP-INCURRED-DT        PIC XX.
  2693         16  CP-REPORTED-DT        PIC XX.
  2694         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2695         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2696         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2697                                     COMP-3.
  2698         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2699                                     COMP-3.
  2700         16  CP-CDT-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  51
* EL131.cbl
  2701           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2702           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2703           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2704         16  CP-CLAIM-TYPE         PIC X.
  2705           88  CP-AH-CLAIM                         VALUE 'A'.
  2706           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2707         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2708                                     COMP-3.
  2709         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2710                                     COMP-3.
  2711         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2712                                     COMP-3.
  2713         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2714                                     COMP-3.
  2715         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2716                                     COMP-3.
  2717         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2718                                     COMP-3.
  2719         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2720                                     COMP-3.
  2721         16  CP-REM-TERM-METHOD    PIC X.
  2722           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2723           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2724           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2725           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2726           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2727           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2728           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2729         16  CP-EARNING-METHOD     PIC X.
  2730           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2731           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2732           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2733           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2734           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2735           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2736           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2737           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2738           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2739           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2740           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2741           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2742           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2743           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2744         16  CP-PROCESS-TYPE       PIC X.
  2745           88  CP-CLAIM                            VALUE '1'.
  2746           88  CP-CANCEL                           VALUE '2'.
  2747           88  CP-ISSUE                            VALUE '3'.
  2748         16  CP-SPECIAL-CALC-CD    PIC X.
  2749           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2750           88  CP-1-MTH-INTEREST               VALUE ' '.
  2751           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2752           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2753           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2754           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2755           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2756           88  CP-FARM-PLAN                    VALUE 'F'.
  2757           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2758           88  CP-2-MTH-INTEREST               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  52
* EL131.cbl
  2759           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2760           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2761           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2762           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2763           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2764           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2765           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2766           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2767                                                     'W' 'X'.
  2768           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2769           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2770           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2771           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2772           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2773           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2774           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2775           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2776           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2777           88  CP-CSL-METH-1                   VALUE '5'.
  2778           88  CP-CSL-METH-2                   VALUE '6'.
  2779           88  CP-CSL-METH-3                   VALUE '7'.
  2780           88  CP-CSL-METH-4                   VALUE '8'.
  2781
  2782         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2783                                     COMP-3.
  2784         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2785         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2786         16  CP-STATE              PIC XX          VALUE SPACE.
  2787         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2788         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2789           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2790               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2791         16  CP-R78-OPTION         PIC X.
  2792           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2793           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2794
  2795         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2796         16  CP-IBNR-RESERVE-SW    PIC X.
  2797         16  CP-CLAIM-STATUS       PIC X.
  2798         16  CP-RATE-FILE          PIC X.
  2799         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2800                                     COMP-3.
  2801
  2802         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2803         16  CP-AH-OVERRIDE-CODE   PIC X.
  2804
  2805         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2806                                     COMP-3.
  2807         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2808                                   PIC S9(5)V99 COMP-3.
  2809         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2810                                     COMP-3.
  2811         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2812                                     COMP-3.
  2813         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2814                                     COMP-3.
  2815         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2816                                  PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  53
* EL131.cbl
  2817
  2818         16  CP-PAID-FROM-DATE     PIC X(02).
  2819         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2820         16  CP-EXT-DAYS-CALC      PIC X.
  2821           88  CP-EXT-NO-CHG                   VALUE ' '.
  2822           88  CP-EXT-CHG-LF                   VALUE '1'.
  2823           88  CP-EXT-CHG-AH                   VALUE '2'.
  2824           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2825         16  CP-DOMICILE-STATE     PIC XX.
  2826         16  CP-CARRIER            PIC X.
  2827         16  CP-REIN-FLAG          PIC X.
  2828         16  CP-REM-TRM-CALC-OPTION PIC X.
  2829           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2830                      '2' '3' '4' '5'.
  2831           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2832           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2833           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2834           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2835           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2836           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2837           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2838           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2839         16  CP-SIG-SWITCH         PIC X.
  2840         16  CP-RATING-METHOD      PIC X.
  2841           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2842           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2843           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2844           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2845           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2846           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2847           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2848           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2849           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2850         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2851                                     COMP-3.
  2852         16  CP-BEN-CATEGORY       PIC X.
  2853         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2854         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2855                                   PIC S99V9(5) COMP-3.
  2856         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2857         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2858                                   PIC S99V9(5) COMP-3.
  2859         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2860         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2861         16  CP-EXPIRE-DT          PIC XX.
  2862         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2863         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2864         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2865         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2866         16  CP-DDF-SPEC-CALC      PIC X.
  2867             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2868             88  CP-CALC-CLP              VALUE 'C'.
  2869         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2870         16  CP-CANCEL-REASON      PIC X.
  2871         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2872         16  CP-PMT-MODE           PIC X.
  2873         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2874         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  54
* EL131.cbl
  2875         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2876         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2877         16  FILLER                PIC X.
  2878
  2879***************    OUTPUT FROM ELRESV   ************************
  2880
  2881         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2882
  2883         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2884                                     COMP-3.
  2885         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2886                                     COMP-3.
  2887         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2888                                     COMP-3.
  2889         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2890                                     COMP-3.
  2891         16  FILLER                PIC X(09).
  2892***************    OUTPUT FROM ELRTRM   *************************
  2893
  2894         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2895                                     COMP-3.
  2896         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2897                                     COMP-3.
  2898         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2899                                     COMP-3.
  2900         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2901                                     COMP-3.
  2902         16  FILLER                PIC X(12).
  2903
  2904***************    OUTPUT FROM ELRAMT   *************************
  2905
  2906         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2907                                     COMP-3.
  2908         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2909                                     COMP-3.
  2910         16  FILLER                PIC X(12).
  2911
  2912***************    OUTPUT FROM ELRATE   *************************
  2913
  2914         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2915                                     COMP-3.
  2916         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2917                                     COMP-3.
  2918         16  CP-MORTALITY-CODE     PIC X(4).
  2919         16  CP-RATE-EDIT-FLAG     PIC X.
  2920             88  CP-RATES-NEED-APR                  VALUE '1'.
  2921         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2922                                     COMP-3.
  2923         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2924         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2925         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2926                                   PIC S9(7)V99 COMP-3.
  2927         16  FILLER                PIC X(07).
  2928
  2929***************    OUTPUT FROM ELRFND   *************************
  2930
  2931         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2932                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  55
* EL131.cbl
  2933         16  CP-REFUND-TYPE-USED   PIC X.
  2934           88  CP-R-AS-R78                         VALUE '1'.
  2935           88  CP-R-AS-PRORATA                     VALUE '2'.
  2936           88  CP-R-AS-CALIF                       VALUE '3'.
  2937           88  CP-R-AS-TEXAS                       VALUE '4'.
  2938           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2939           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2940           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2941           88  CP-R-AS-MEAN                        VALUE '8'.
  2942           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2943           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2944           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2945           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2946           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2947           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2948         16  FILLER                PIC X(12).
  2949
  2950***************    OUTPUT FROM ELEARN   *************************
  2951
  2952         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2953                                     COMP-3.
  2954         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2955                                     COMP-3.
  2956         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2957                                     COMP-3.
  2958         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2959                                     COMP-3.
  2960         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2961                                     COMP-3.
  2962         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2963                                     COMP-3.
  2964         16  CP-EARNING-TYPE-USED  PIC X.
  2965           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2966           88  CP-E-AS-R78                         VALUE '1'.
  2967           88  CP-E-AS-PRORATA                     VALUE '2'.
  2968           88  CP-E-AS-TEXAS                       VALUE '4'.
  2969           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2970           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2971           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2972           88  CP-E-AS-MEAN                        VALUE '8'.
  2973           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2974         16  FILLER                PIC X(12).
  2975
  2976***************    OUTPUT FROM ELPMNT   *************************
  2977
  2978         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2979                                     COMP-3.
  2980         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2981                                     COMP-3.
  2982         16  FILLER                PIC X(12).
  2983
  2984***************   MISC WORK AREAS    *****************************
  2985         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2986                                     COMP-3.
  2987         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2988                                     COMP-3.
  2989         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2990                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  56
* EL131.cbl
  2991         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2992                                     COMP-3.
  2993         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2994                                     COMP-3.
  2995         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2996                                     COMP-3.
  2997         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2998             88  OPEN-RATE-FILE                   VALUE 'O'.
  2999             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3000             88  IO-ERROR                         VALUE 'E'.
  3001
  3002         16  CP-FIRST-PAY-DATE     PIC XX.
  3003
  3004         16  CP-JOINT-INDICATOR    PIC X.
  3005
  3006         16  CP-RESERVE-REMAINING-TERM
  3007                                   PIC S9(4)V9    VALUE ZERO
  3008                                     COMP-3.
  3009
  3010         16  CP-INSURED-BIRTH-DT   PIC XX.
  3011
  3012         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3013                                     COMP-3.
  3014
  3015         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3016                                     COMP-3.
  3017
  3018         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3019                                     COMP-3.
  3020
  3021         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3022                                     COMP-3.
  3023
  3024         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3025                                     COMP-3.
  3026
  3027         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3028                                     COMP-3.
  3029
  3030         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3031                                     COMP-3.
  3032
  3033         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3034             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3035
  3036         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3037                                     COMP-3.
  3038         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3039                                     COMP-3.
  3040         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3041         16  cp-extra-periods      pic 9 value zeros.
  3042         16  cp-net-only-state     pic x value spaces.
  3043         16  FILLER                PIC X(13).
  3044******************************************************************
  3045
  3046*                                COPY ELCDATE.
  3047******************************************************************
  3048*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  57
* EL131.cbl
  3049*                                                                *
  3050*                            ELCDATE.                            *
  3051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3052*                            VMOD=2.003
  3053*                                                                *
  3054*                                                                *
  3055*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3056*                 LENGTH = 200                                   *
  3057******************************************************************
  3058
  3059 01  DATE-CONVERSION-DATA.
  3060     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3061     12  DC-OPTION-CODE                PIC X.
  3062         88  BIN-TO-GREG                VALUE ' '.
  3063         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3064         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3065         88  YMD-GREG-TO-BIN            VALUE '3'.
  3066         88  MDY-GREG-TO-BIN            VALUE '4'.
  3067         88  JULIAN-TO-BIN              VALUE '5'.
  3068         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3069         88  FIND-CENTURY               VALUE '7'.
  3070         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3071         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3072         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3073         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3074         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3075         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3076         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3077         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3078         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3079         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3080         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3081         88  BIN-3-TO-GREG              VALUE 'I'.
  3082         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3083         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3084         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3085         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3086         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3087         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3088         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3089         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3090         88  THREE-CHARACTER-BIN
  3091                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3092         88  GREGORIAN-TO-BIN
  3093                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3094         88  BIN-TO-GREGORIAN
  3095                  VALUES ' ' '1' 'I' '8' 'G'.
  3096         88  JULIAN-TO-BINARY
  3097                  VALUES '5' 'C' 'E' 'F'.
  3098     12  DC-ERROR-CODE                 PIC X.
  3099         88  NO-CONVERSION-ERROR        VALUE ' '.
  3100         88  DATE-CONVERSION-ERROR
  3101                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3102         88  DATE-IS-ZERO               VALUE '1'.
  3103         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3104         88  DATE-IS-INVALID            VALUE '3'.
  3105         88  DATE1-GREATER-DATE2        VALUE '4'.
  3106         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  58
* EL131.cbl
  3107         88  DATE-INVALID-OPTION        VALUE '9'.
  3108         88  INVALID-CENTURY            VALUE 'A'.
  3109         88  ONLY-CENTURY               VALUE 'B'.
  3110         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3111         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3112     12  DC-END-OF-MONTH               PIC X.
  3113         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3114     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3115         88  USE-NORMAL-PROCESS         VALUE ' '.
  3116         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3117         88  ADJUST-UP-100-YRS          VALUE '2'.
  3118     12  FILLER                        PIC X.
  3119     12  DC-CONVERSION-DATES.
  3120         16  DC-BIN-DATE-1             PIC XX.
  3121         16  DC-BIN-DATE-2             PIC XX.
  3122         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3123         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3124                       DC-GREG-DATE-1-EDIT.
  3125             20  DC-EDIT1-MONTH        PIC 99.
  3126             20  SLASH1-1              PIC X.
  3127             20  DC-EDIT1-DAY          PIC 99.
  3128             20  SLASH1-2              PIC X.
  3129             20  DC-EDIT1-YEAR         PIC 99.
  3130         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3131         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3132                     DC-GREG-DATE-2-EDIT.
  3133             20  DC-EDIT2-MONTH        PIC 99.
  3134             20  SLASH2-1              PIC X.
  3135             20  DC-EDIT2-DAY          PIC 99.
  3136             20  SLASH2-2              PIC X.
  3137             20  DC-EDIT2-YEAR         PIC 99.
  3138         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3139         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3140                     DC-GREG-DATE-1-YMD.
  3141             20  DC-YMD-YEAR           PIC 99.
  3142             20  DC-YMD-MONTH          PIC 99.
  3143             20  DC-YMD-DAY            PIC 99.
  3144         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3145         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3146                      DC-GREG-DATE-1-MDY.
  3147             20  DC-MDY-MONTH          PIC 99.
  3148             20  DC-MDY-DAY            PIC 99.
  3149             20  DC-MDY-YEAR           PIC 99.
  3150         16  DC-GREG-DATE-1-ALPHA.
  3151             20  DC-ALPHA-MONTH        PIC X(10).
  3152             20  DC-ALPHA-DAY          PIC 99.
  3153             20  FILLER                PIC XX.
  3154             20  DC-ALPHA-CENTURY.
  3155                 24 DC-ALPHA-CEN-N     PIC 99.
  3156             20  DC-ALPHA-YEAR         PIC 99.
  3157         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3158         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3159         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3160         16  DC-JULIAN-DATE            PIC 9(05).
  3161         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3162                                       PIC 9(05).
  3163         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3164             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  59
* EL131.cbl
  3165             20  DC-JULIAN-DAYS        PIC 999.
  3166         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3167         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3168         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3169     12  DATE-CONVERSION-VARIBLES.
  3170         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3171         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3172             20  FILLER                PIC 9(3).
  3173             20  HOLD-CEN-1-CCYY.
  3174                 24  HOLD-CEN-1-CC     PIC 99.
  3175                 24  HOLD-CEN-1-YY     PIC 99.
  3176             20  HOLD-CEN-1-MO         PIC 99.
  3177             20  HOLD-CEN-1-DA         PIC 99.
  3178         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3179             20  HOLD-CEN-1-R-MO       PIC 99.
  3180             20  HOLD-CEN-1-R-DA       PIC 99.
  3181             20  HOLD-CEN-1-R-CCYY.
  3182                 24  HOLD-CEN-1-R-CC   PIC 99.
  3183                 24  HOLD-CEN-1-R-YY   PIC 99.
  3184             20  FILLER                PIC 9(3).
  3185         16  HOLD-CENTURY-1-X.
  3186             20  FILLER                PIC X(3)  VALUE SPACES.
  3187             20  HOLD-CEN-1-X-CCYY.
  3188                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3189                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3190             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3191             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3192         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3193             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3194             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3195             20  HOLD-CEN-1-R-X-CCYY.
  3196                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3197                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3198             20  FILLER                PIC XXX.
  3199         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3200         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3201         16  DC-JULIAN-DATE-1          PIC 9(07).
  3202         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3203             20  DC-JULIAN-1-CCYY.
  3204                 24  DC-JULIAN-1-CC    PIC 99.
  3205                 24  DC-JULIAN-1-YR    PIC 99.
  3206             20  DC-JULIAN-DA-1        PIC 999.
  3207         16  DC-JULIAN-DATE-2          PIC 9(07).
  3208         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3209             20  DC-JULIAN-2-CCYY.
  3210                 24  DC-JULIAN-2-CC    PIC 99.
  3211                 24  DC-JULIAN-2-YR    PIC 99.
  3212             20  DC-JULIAN-DA-2        PIC 999.
  3213         16  DC-GREG-DATE-A-EDIT.
  3214             20  DC-EDITA-MONTH        PIC 99.
  3215             20  SLASHA-1              PIC X VALUE '/'.
  3216             20  DC-EDITA-DAY          PIC 99.
  3217             20  SLASHA-2              PIC X VALUE '/'.
  3218             20  DC-EDITA-CCYY.
  3219                 24  DC-EDITA-CENT     PIC 99.
  3220                 24  DC-EDITA-YEAR     PIC 99.
  3221         16  DC-GREG-DATE-B-EDIT.
  3222             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  60
* EL131.cbl
  3223             20  SLASHB-1              PIC X VALUE '/'.
  3224             20  DC-EDITB-DAY          PIC 99.
  3225             20  SLASHB-2              PIC X VALUE '/'.
  3226             20  DC-EDITB-CCYY.
  3227                 24  DC-EDITB-CENT     PIC 99.
  3228                 24  DC-EDITB-YEAR     PIC 99.
  3229         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3230         16  DC-GREG-DATE-CYMD-R REDEFINES
  3231                              DC-GREG-DATE-CYMD.
  3232             20  DC-CYMD-CEN           PIC 99.
  3233             20  DC-CYMD-YEAR          PIC 99.
  3234             20  DC-CYMD-MONTH         PIC 99.
  3235             20  DC-CYMD-DAY           PIC 99.
  3236         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3237         16  DC-GREG-DATE-MDCY-R REDEFINES
  3238                              DC-GREG-DATE-MDCY.
  3239             20  DC-MDCY-MONTH         PIC 99.
  3240             20  DC-MDCY-DAY           PIC 99.
  3241             20  DC-MDCY-CEN           PIC 99.
  3242             20  DC-MDCY-YEAR          PIC 99.
  3243    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3244        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3245    12  DC-EL310-DATE                  PIC X(21).
  3246    12  FILLER                         PIC X(28).
  3247
  3248*                                COPY ELCDMO.
  3249******************************************************************
  3250*                                                                *
  3251*                                                                *
  3252*                            ELCDMO.                             *
  3253*                            VMOD=2.004                          *
  3254*                                                                *
  3255*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3256*        COMMUNICATION AREA                                      *
  3257*   FILE TYPE = NA                                               *
  3258*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3259*                                                                *
  3260******************************************************************
  3261 01  DMO-COMMUNICATION-AREA.
  3262     12  DM-RECORD-TYPE                  PIC  X(02).
  3263             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3264             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3265             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3266     12  DM-DIST-CODE                    PIC  X(04).
  3267     12  DM-MAIL-CODE                    PIC  X(05).
  3268     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3269     12  DM-INSURED-NAME                 PIC  X(30).
  3270     12  DM-CLAIM-NO                     PIC  X(07).
  3271     12  DM-CLAIM-TYPE                   PIC  X.
  3272
  3273     12  DM-STATUS-DATA-AREA.
  3274         16  DM-CLAIM-STATUS             PIC  X.
  3275             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3276             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3277             88  DM-CLOSED                        VALUE '3'.
  3278             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3279             88  DM-DEFAULT                       VALUE '9'.
  3280         16  DM-STATUS-DATE              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  61
* EL131.cbl
  3281******YYYYMMDD
  3282         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3283             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3284             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3285             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3286             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3287             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3288             88  DM-RE-OPENED                     VALUE 'R'.
  3289             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3290             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3291             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3292         16  DM-STAT-CARRIER             PIC X.
  3293
  3294     12  DM-DRAFT-DATA-AREA.
  3295         16  DM-PAYMENT-TYPE             PIC  X.
  3296             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3297         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3298         16  DM-PAYMENT-DATE             PIC  X(08).
  3299******YYYYMMDD
  3300         16  DM-CERT-NO                  PIC  X(11).
  3301         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3302         16  DM-CARRIER                  PIC  X.
  3303
  3304     12  DM-RETURN-CODE                  PIC  XX.
  3305*                                COPY ERCPDEF.
  3306******************************************************************
  3307*                                                                *
  3308*                                                                *
  3309*                            ERCPDEF.                            *
  3310*                                                                *
  3311*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3312*                                                                *
  3313*    FILE TYPE = VSAM,KSDS                                       *
  3314*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3315*                                                                *
  3316*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3317*                                                                *
  3318*    LOG = YES                                                   *
  3319*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3320******************************************************************
  3321*                   C H A N G E   L O G
  3322*
  3323* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3324*-----------------------------------------------------------------
  3325*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3326* EFFECTIVE    NUMBER
  3327*-----------------------------------------------------------------
  3328* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3329* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3330* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3331******************************************************************
  3332 01  PRODUCT-MASTER.
  3333    12  PD-RECORD-ID                 PIC X(02).
  3334        88  VALID-PD-ID                  VALUE 'PD'.
  3335    12  PD-CONTROL-PRIMARY.
  3336        16  PD-COMPANY-CD            PIC X.
  3337        16  PD-STATE                 PIC XX.
  3338        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  62
* EL131.cbl
  3339        16  PD-FILLER                PIC X(7).
  3340        16  PD-BEN-TYPE              PIC X.
  3341        16  PD-BEN-CODE              PIC XX.
  3342        16  PD-PROD-EXP-DT           PIC XX.
  3343    12  FILLER                       PIC X(50).
  3344    12  PD-PRODUCT-DATA OCCURS 8.
  3345        16  PD-PROD-CODE             PIC X.
  3346            88  PD-PROD-LIFE           VALUE 'L'.
  3347            88  PD-PROD-PROP           VALUE 'P'.
  3348            88  PD-PROD-AH             VALUE 'A'.
  3349            88  PD-PROD-IU             VALUE 'I'.
  3350            88  PD-PROD-GAP            VALUE 'G'.
  3351            88  PD-PROD-FAML           VALUE 'F'.
  3352        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3353        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3354        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3355        16  PD-MAX-TERM              PIC S999        COMP-3.
  3356        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3357        16  FILLER                   PIC X.
  3358        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3359        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3360        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3361        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3362        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3363        16  PD-REC-CRIT-PERIOD       PIC 99.
  3364        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3365            20  PD-RECURRING-YN      PIC X.
  3366            20  FILLER               PIC X.
  3367        16  PD-RTW-MOS               PIC 99.
  3368        16  PD-MAX-EXTENSION         PIC 99.
  3369        16  pd-ben-pct               pic sv999 comp-3.
  3370*       16  FILLER                   PIC XX.
  3371    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3372    12  PD-TERM-LIMITS OCCURS 15.
  3373        16  PD-LOW-TERM              PIC S999        COMP-3.
  3374        16  PD-HI-TERM               PIC S999        COMP-3.
  3375*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3376    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3377        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3378        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3379    12  PD-EARN-FACTORS.
  3380        16  FILLER OCCURS 15.
  3381            20  FILLER OCCURS 15.
  3382                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3383    12  PD-PRODUCT-DESC              PIC X(80).
  3384    12  PD-TRUNCATED                 PIC X.
  3385    12  FILLER                       PIC X(59).
  3386    12  PD-MAINT-INFORMATION.
  3387        16  PD-LAST-MAINT-DT         PIC X(02).
  3388        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3389        16  PD-LAST-MAINT-BY         PIC X(04).
  3390*                                COPY ELCCRTT.
  3391******************************************************************
  3392*                                                                *
  3393*                            ELCCRTT.                            *
  3394*                                                                *
  3395*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3396*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  63
* EL131.cbl
  3397*   FILE TYPE = VSAM,KSDS                                        *
  3398*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3399*                                                                *
  3400*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3401*                                                                *
  3402*   LOG = YES                                                    *
  3403*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3404******************************************************************
  3405*                   C H A N G E   L O G
  3406*
  3407* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3408*-----------------------------------------------------------------
  3409*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3410* EFFECTIVE    NUMBER
  3411*-----------------------------------------------------------------
  3412* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3413* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3414* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3415* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3416* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3417* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3418* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3419* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3420* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3421******************************************************************
  3422
  3423 01  CERTIFICATE-TRAILERS.
  3424     12  CS-RECORD-ID                      PIC XX.
  3425         88  VALID-CS-ID                      VALUE 'CS'.
  3426
  3427     12  CS-CONTROL-PRIMARY.
  3428         16  CS-COMPANY-CD                 PIC X.
  3429         16  CS-CARRIER                    PIC X.
  3430         16  CS-GROUPING                   PIC X(6).
  3431         16  CS-STATE                      PIC XX.
  3432         16  CS-ACCOUNT                    PIC X(10).
  3433         16  CS-CERT-EFF-DT                PIC XX.
  3434         16  CS-CERT-NO.
  3435             20  CS-CERT-PRIME             PIC X(10).
  3436             20  CS-CERT-SFX               PIC X.
  3437         16  CS-TRAILER-TYPE               PIC X.
  3438             88  COMM-TRLR           VALUE 'A'.
  3439             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3440             88  CERT-DATA-TRLR      VALUE 'C'.
  3441
  3442     12  CS-DATA-AREA                      PIC X(516).
  3443
  3444     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3445         16  CS-BANK-COMMISSION-AREA.
  3446             20  CS-BANK-COMMS       OCCURS 10.
  3447                 24  CS-AGT                PIC X(10).
  3448                 24  CS-COM-TYP            PIC X.
  3449                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3450                 24  CS-RECALC-LV-INDIC    PIC X.
  3451                 24  FILLER                PIC X(10).
  3452         16  FILLER                        PIC X(256).
  3453
  3454     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  64
* EL131.cbl
  3455****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3456         16  CS-MB-CLAIM-DATA OCCURS 24.
  3457             20  CS-CLAIM-NO               PIC X(7).
  3458             20  CS-CLAIM-TYPE             PIC X.
  3459                 88  CS-AH-CLM               VALUE 'A'.
  3460                 88  CS-IU-CLM               VALUE 'I'.
  3461                 88  CS-GP-CLM               VALUE 'G'.
  3462                 88  CS-LF-CLM               VALUE 'L'.
  3463                 88  CS-PR-CLM               VALUE 'P'.
  3464                 88  CS-FL-CLM               VALUE 'F'.
  3465             20  CS-INSURED-TYPE           PIC X.
  3466                 88  CS-PRIM-INSURED          VALUE 'P'.
  3467                 88  CS-CO-BORROWER           VALUE 'C'.
  3468             20  CS-BENEFIT-PERIOD         PIC 99.
  3469             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3470             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3471             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3472         16  FILLER                        PIC X(12).
  3473     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3474         16  CS-VIN-NUMBER                 PIC X(17).
  3475         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3476         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3477         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3478         16  cs-agent-name.
  3479             20  cs-agent-fname            pic x(20).
  3480             20  cs-agent-mi               pic x.
  3481             20  cs-agent-lname            pic x(25).
  3482         16  cs-license-no                 pic x(15).
  3483         16  cs-npn-number                 pic x(10).
  3484         16  cs-agent-edit-status          pic x.
  3485             88  cs-ae-refer-to-manager      value 'M'.
  3486             88  cs-ae-cover-sheet           value 'C'.
  3487             88  cs-ae-sig-form              value 'S'.
  3488             88  cs-ae-verified              value 'V'.
  3489             88  cs-unidentified-signature   value 'U'.
  3490             88  cs-cert-returned            value 'R'.
  3491             88  cs-accept-no-commission     value 'N'.
  3492         16  cs-year                       pic 9999.
  3493         16  cs-make                       pic x(20).
  3494         16  cs-model                      pic x(20).
  3495         16  cs-future                     pic x(20).
  3496         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3497         16  FILLER                        PIC X(356). *> was 420
  3498*        16  FILLER                        PIC X(496).
  3499
  3500****************************************************************
  3501*
  3502* Copyright (c) 2007-2013 Dell Inc.
  3503* All rights reserved.
  3504*
  3505****************************************************************
  3506 01  DFHEIV.
  3507   02  DFHEIV0               PIC X(35).
  3508   02  DFHEIV1               PIC X(08).
  3509   02  DFHEIV2               PIC X(08).
  3510   02  DFHEIV3               PIC X(08).
  3511   02  DFHEIV4               PIC X(06).
  3512   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  65
* EL131.cbl
  3513   02  DFHEIV6               PIC X(04).
  3514   02  DFHEIV7               PIC X(02).
  3515   02  DFHEIV8               PIC X(02).
  3516   02  DFHEIV9               PIC X(01).
  3517   02  DFHEIV10              PIC S9(7) COMP-3.
  3518   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3519   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3520   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3521   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3522   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3523   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3524   02  DFHEIV17              PIC X(04).
  3525   02  DFHEIV18              PIC X(04).
  3526   02  DFHEIV19              PIC X(04).
  3527   02  DFHEIV20              USAGE IS POINTER.
  3528   02  DFHEIV21              USAGE IS POINTER.
  3529   02  DFHEIV22              USAGE IS POINTER.
  3530   02  DFHEIV23              USAGE IS POINTER.
  3531   02  DFHEIV24              USAGE IS POINTER.
  3532   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3533   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3534   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3535   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3536   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3537   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3538   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3539   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3540   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3541   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3542   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3543   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3544   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3545   02  FILLER                PIC X(02).
  3546   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3547   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3548   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3549   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3550   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3551   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3552   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3553 LINKAGE  SECTION.
  3554*****************************************************************
  3555*                                                               *
  3556* Copyright (c) 2007-2013 Dell Inc.                             *
  3557* All rights reserved.                                          *
  3558*                                                               *
  3559*****************************************************************
  3560 01  dfheiblk.
  3561     02  eibtime          pic s9(7) comp-3.
  3562     02  eibdate          pic s9(7) comp-3.
  3563     02  eibtrnid         pic x(4).
  3564     02  eibtaskn         pic s9(7) comp-3.
  3565     02  eibtrmid         pic x(4).
  3566     02  dfheigdi         pic s9(4) comp.
  3567     02  eibcposn         pic s9(4) comp.
  3568     02  eibcalen         pic s9(4) comp.
  3569     02  eibaid           pic x(1).
  3570     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  66
* EL131.cbl
  3571     02  eibfn            pic x(2).
  3572     02  eibfiller2       pic x(2).
  3573     02  eibrcode         pic x(6).
  3574     02  eibfiller3       pic x(2).
  3575     02  eibds            pic x(8).
  3576     02  eibreqid         pic x(8).
  3577     02  eibrsrce         pic x(8).
  3578     02  eibsync          pic x(1).
  3579     02  eibfree          pic x(1).
  3580     02  eibrecv          pic x(1).
  3581     02  eibsend          pic x(1).
  3582     02  eibatt           pic x(1).
  3583     02  eibeoc           pic x(1).
  3584     02  eibfmh           pic x(1).
  3585     02  eibcompl         pic x(1).
  3586     02  eibsig           pic x(1).
  3587     02  eibconf          pic x(1).
  3588     02  eiberr           pic x(1).
  3589     02  eibrldbk         pic x(1).
  3590     02  eiberrcd         pic x(4).
  3591     02  eibsynrb         pic x(1).
  3592     02  eibnodat         pic x(1).
  3593     02  eibfiller5       pic x(2).
  3594     02  eibresp          pic s9(8) comp.
  3595     02  eibresp2         pic s9(8) comp.
  3596     02  dfheigdj         pic s9(4) comp.
  3597     02  dfheigdk         pic s9(4) comp.
  3598 01  DFHCOMMAREA                 PIC X(1024).
  3599
  3600*                                COPY ELCMSTR.
  3601******************************************************************
  3602*                                                                *
  3603*                            ELCMSTR.                            *
  3604*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3605*                            VMOD=2.012                          *
  3606*                                                                *
  3607*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3608*                                                                *
  3609*   FILE TYPE = VSAM,KSDS                                        *
  3610*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3611*                                                                *
  3612*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3613*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3614*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3615*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3616*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3617*                                                 RKP=75,LEN=21  *
  3618*                                                                *
  3619*   **** NOTE ****                                               *
  3620*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3621*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3622*                                                                *
  3623*   LOG = YES                                                    *
  3624*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3625******************************************************************
  3626*                   C H A N G E   L O G
  3627*
  3628* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  67
* EL131.cbl
  3629*-----------------------------------------------------------------
  3630*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3631* EFFECTIVE    NUMBER
  3632*-----------------------------------------------------------------
  3633* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3634* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3635* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3636* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3637* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3638* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3639******************************************************************
  3640 01  CLAIM-MASTER.
  3641     12  CL-RECORD-ID                PIC XX.
  3642         88  VALID-CL-ID         VALUE 'CL'.
  3643
  3644     12  CL-CONTROL-PRIMARY.
  3645         16  CL-COMPANY-CD           PIC X.
  3646         16  CL-CARRIER              PIC X.
  3647         16  CL-CLAIM-NO             PIC X(7).
  3648         16  CL-CERT-NO.
  3649             20  CL-CERT-PRIME       PIC X(10).
  3650             20  CL-CERT-SFX         PIC X.
  3651
  3652     12  CL-CONTROL-BY-NAME.
  3653         16  CL-COMPANY-CD-A1        PIC X.
  3654         16  CL-INSURED-LAST-NAME    PIC X(15).
  3655         16  CL-INSURED-NAME.
  3656             20  CL-INSURED-1ST-NAME PIC X(12).
  3657             20  CL-INSURED-MID-INIT PIC X.
  3658
  3659     12  CL-CONTROL-BY-SSN.
  3660         16  CL-COMPANY-CD-A2        PIC X.
  3661         16  CL-SOC-SEC-NO.
  3662             20  CL-SSN-STATE        PIC XX.
  3663             20  CL-SSN-ACCOUNT      PIC X(6).
  3664             20  CL-SSN-LN3          PIC X(3).
  3665
  3666     12  CL-CONTROL-BY-CERT-NO.
  3667         16  CL-COMPANY-CD-A4        PIC X.
  3668         16  CL-CERT-NO-A4.
  3669             20  CL-CERT-A4-PRIME    PIC X(10).
  3670             20  CL-CERT-A4-SFX      PIC X.
  3671
  3672     12  CL-CONTROL-BY-CCN.
  3673         16  CL-COMPANY-CD-A5        PIC X.
  3674         16  CL-CCN-A5.
  3675             20  CL-CCN.
  3676                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3677                 24  CL-CCN-PRIME-A5 PIC X(12).
  3678             20  CL-CCN-FILLER-A5    PIC X(4).
  3679
  3680     12  CL-INSURED-PROFILE-DATA.
  3681         16  CL-INSURED-BIRTH-DT     PIC XX.
  3682         16  CL-INSURED-SEX-CD       PIC X.
  3683             88  INSURED-IS-MALE        VALUE 'M'.
  3684             88  INSURED-IS-FEMALE      VALUE 'F'.
  3685             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3686         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  68
* EL131.cbl
  3687         16  FILLER                  PIC X(5).
  3688
  3689     12  CL-PROCESSING-INFO.
  3690         16  CL-PROCESSOR-ID         PIC X(4).
  3691         16  CL-CLAIM-STATUS         PIC X.
  3692             88  CLAIM-IS-OPEN          VALUE 'O'.
  3693             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3694         16  CL-CLAIM-TYPE           PIC X.
  3695*            88  AH-CLAIM               VALUE 'A'.
  3696*            88  LIFE-CLAIM             VALUE 'L'.
  3697*            88  PROPERTY-CLAIM         VALUE 'P'.
  3698*            88  IUI-CLAIM              VALUE 'I'.
  3699*            88  GAP-CLAIM              VALUE 'G'.
  3700*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3701         16  CL-CLAIM-PREM-TYPE      PIC X.
  3702             88  SINGLE-PREMIUM         VALUE '1'.
  3703             88  O-B-COVERAGE           VALUE '2'.
  3704             88  OPEN-END-COVERAGE      VALUE '3'.
  3705         16  CL-INCURRED-DT          PIC XX.
  3706         16  CL-REPORTED-DT          PIC XX.
  3707         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3708         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3709         16  CL-LAST-PMT-DT          PIC XX.
  3710         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3711         16  CL-PAID-THRU-DT         PIC XX.
  3712         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3713         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3714         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3715         16  CL-PMT-CALC-METHOD      PIC X.
  3716             88  CL-360-DAY-YR          VALUE '1'.
  3717             88  CL-365-DAY-YR          VALUE '2'.
  3718             88  CL-FULL-MONTHS         VALUE '3'.
  3719         16  CL-CAUSE-CD             PIC X(6).
  3720
  3721         16  CL-PRIME-CERT-NO.
  3722             20  CL-PRIME-CERT-PRIME PIC X(10).
  3723             20  CL-PRIME-CERT-SFX   PIC X.
  3724
  3725         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3726             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3727             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3728
  3729         16  CL-MICROFILM-NO         PIC X(10).
  3730         16  FILLER REDEFINES CL-MICROFILM-NO.
  3731             20  CL-BENEFIT-PERIOD   PIC 99.
  3732             20  FILLER              PIC X(8).
  3733         16  CL-PROG-FORM-TYPE       PIC X.
  3734         16  CL-LAST-ADD-ON-DT       PIC XX.
  3735
  3736         16  CL-LAST-REOPEN-DT       PIC XX.
  3737         16  CL-LAST-CLOSE-DT        PIC XX.
  3738         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3739             88  FINAL-PAID             VALUE '1'.
  3740             88  CLAIM-DENIED           VALUE '2'.
  3741             88  AUTO-CLOSE             VALUE '3'.
  3742             88  MANUAL-CLOSE           VALUE '4'.
  3743             88  BENEFITS-CHANGED       VALUE 'C'.
  3744             88  SETUP-ERRORS           VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  69
* EL131.cbl
  3745         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3746         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3747         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3748             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3749         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3750         16  FILLER                  PIC X.
  3751
  3752     12  CL-CERTIFICATE-DATA.
  3753         16  CL-CERT-ORIGIN          PIC X.
  3754             88  CERT-WAS-ONLINE        VALUE '1'.
  3755             88  CERT-WAS-CREATED       VALUE '2'.
  3756             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3757         16  CL-CERT-KEY-DATA.
  3758             20  CL-CERT-CARRIER     PIC X.
  3759             20  CL-CERT-GROUPING    PIC X(6).
  3760             20  CL-CERT-STATE       PIC XX.
  3761             20  CL-CERT-ACCOUNT.
  3762                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3763                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3764             20  CL-CERT-EFF-DT      PIC XX.
  3765
  3766     12  CL-STATUS-CONTROLS.
  3767         16  CL-PRIORITY-CD          PIC X.
  3768             88  CONFIDENTIAL-DATA      VALUE '8'.
  3769             88  HIGHEST-PRIORITY       VALUE '9'.
  3770         16  CL-SUPV-ATTN-CD         PIC X.
  3771             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3772             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3773         16  CL-PURGED-DT            PIC XX.
  3774         16  CL-RESTORED-DT          PIC XX.
  3775         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3776         16  CL-NEXT-RESEND-DT       PIC XX.
  3777         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3778         16  CL-CRITICAL-PERIOD      PIC 99.
  3779*        16  FILLER                  PIC XX.
  3780         16  CL-LAST-MAINT-DT        PIC XX.
  3781         16  CL-LAST-MAINT-USER      PIC X(4).
  3782         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3783         16  CL-LAST-MAINT-TYPE      PIC X.
  3784             88  CLAIM-SET-UP           VALUE ' '.
  3785             88  PAYMENT-MADE           VALUE '1'.
  3786             88  LETTER-SENT            VALUE '2'.
  3787             88  MASTER-WAS-ALTERED     VALUE '3'.
  3788             88  MASTER-WAS-RESTORED    VALUE '4'.
  3789             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3790             88  FILE-CONVERTED         VALUE '6'.
  3791             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3792             88  ERROR-CORRECTION       VALUE 'E'.
  3793         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3794         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3795         16  CL-BENEFICIARY          PIC X(10).
  3796         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3797         16  CL-DENIAL-TYPE          PIC X.
  3798             88  CL-TYPE-DENIAL          VALUE '1'.
  3799             88  CL-TYPE-RESCISSION      VALUE '2'.
  3800             88  CL-TYPE-REFORMATION     VALUE '3'.
  3801             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3802             88  CL-TYPE-RECONSIDERED    VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  70
* EL131.cbl
  3803         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3804         16  filler                  pic x(3).
  3805*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3806*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3807*        16  CL-RTW-DT               PIC XX.
  3808
  3809     12  CL-TRAILER-CONTROLS.
  3810         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3811             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3812             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3813             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3814         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3815         16  FILLER                  PIC XX.
  3816         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3817         16  CL-ADDRESS-TRAILER-CNT.
  3818             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3819                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3820             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3821                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3822             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3823                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3824             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3825                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3826             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3827                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3828             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3829                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3830             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3831                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3832
  3833     12  CL-CV-REFERENCE-NO.
  3834         16  CL-CV-REFNO-PRIME       PIC X(18).
  3835         16  CL-CV-REFNO-SFX         PIC XX.
  3836
  3837     12  CL-FILE-LOCATION            PIC X(4).
  3838
  3839     12  CL-PROCESS-ERRORS.
  3840         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3841             88  NO-FATAL-ERRORS        VALUE ZERO.
  3842         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3843             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3844
  3845     12  CL-PRODUCT-CD               PIC X.
  3846
  3847     12  CL-CURRENT-KEY-DATA.
  3848         16  CL-CURRENT-CARRIER      PIC X.
  3849         16  CL-CURRENT-GROUPING     PIC X(6).
  3850         16  CL-CURRENT-STATE        PIC XX.
  3851         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3852
  3853     12  CL-ASSOCIATES               PIC X.
  3854         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3855         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3856         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3857         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3858
  3859     12  CL-ACTIVITY-CODE            PIC 99.
  3860     12  CL-ACTIVITY-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  71
* EL131.cbl
  3861     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3862
  3863     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3864     12  CL-LAG-REPORT-CODE          PIC 9.
  3865     12  CL-LOAN-TYPE                PIC XX.
  3866     12  CL-LEGAL-STATE              PIC XX.
  3867
  3868     12  CL-YESNOSW                  PIC X.
  3869     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3870         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3871         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3872         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3873     12  cl-insured-type             pic x.
  3874         88  cl-claim-on-primary         value 'P'.
  3875         88  cl-claim-on-co-borrower     value 'C'.
  3876     12  cl-benefit-expiration-dt    PIC XX.
  3877
  3878*                                COPY ELCCERT.
  3879******************************************************************
  3880*                                                                *
  3881*                            ELCCERT.                            *
  3882*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3883*                            VMOD=2.013                          *
  3884*                                                                *
  3885*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3886*                                                                *
  3887*   FILE TYPE = VSAM,KSDS                                        *
  3888*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3889*                                                                *
  3890*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3891*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3892*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3893*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3894*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3895*                                                                *
  3896*   LOG = YES                                                    *
  3897*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3898******************************************************************
  3899*                   C H A N G E   L O G
  3900*
  3901* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3902*-----------------------------------------------------------------
  3903*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3904* EFFECTIVE    NUMBER
  3905*-----------------------------------------------------------------
  3906* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3907* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3908* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3909* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3910* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3911* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3912* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3913* 032612  CR2011110200001  PEMA  AHL CHANGES
  3914* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3915* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3916* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  3917******************************************************************
  3918
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  72
* EL131.cbl
  3919 01  CERTIFICATE-MASTER.
  3920     12  CM-RECORD-ID                      PIC XX.
  3921         88  VALID-CM-ID                      VALUE 'CM'.
  3922
  3923     12  CM-CONTROL-PRIMARY.
  3924         16  CM-COMPANY-CD                 PIC X.
  3925         16  CM-CARRIER                    PIC X.
  3926         16  CM-GROUPING.
  3927             20  CM-GROUPING-PREFIX        PIC X(3).
  3928             20  CM-GROUPING-PRIME         PIC X(3).
  3929         16  CM-STATE                      PIC XX.
  3930         16  CM-ACCOUNT.
  3931             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3932             20  CM-ACCOUNT-PRIME          PIC X(6).
  3933         16  CM-CERT-EFF-DT                PIC XX.
  3934         16  CM-CERT-NO.
  3935             20  CM-CERT-PRIME             PIC X(10).
  3936             20  CM-CERT-SFX               PIC X.
  3937
  3938     12  CM-CONTROL-BY-NAME.
  3939         16  CM-COMPANY-CD-A1              PIC X.
  3940         16  CM-INSURED-LAST-NAME          PIC X(15).
  3941         16  CM-INSURED-INITIALS.
  3942             20  CM-INSURED-INITIAL1       PIC X.
  3943             20  CM-INSURED-INITIAL2       PIC X.
  3944
  3945     12  CM-CONTROL-BY-SSN.
  3946         16  CM-COMPANY-CD-A2              PIC X.
  3947         16  CM-SOC-SEC-NO.
  3948             20  CM-SSN-STATE              PIC XX.
  3949             20  CM-SSN-ACCOUNT            PIC X(6).
  3950             20  CM-SSN-LN3.
  3951                 25  CM-INSURED-INITIALS-A2.
  3952                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3953                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3954                 25 CM-PART-LAST-NAME-A2         PIC X.
  3955
  3956     12  CM-CONTROL-BY-CERT-NO.
  3957         16  CM-COMPANY-CD-A4              PIC X.
  3958         16  CM-CERT-NO-A4                 PIC X(11).
  3959
  3960     12  CM-CONTROL-BY-MEMB.
  3961         16  CM-COMPANY-CD-A5              PIC X.
  3962         16  CM-MEMBER-NO.
  3963             20  CM-MEMB-STATE             PIC XX.
  3964             20  CM-MEMB-ACCOUNT           PIC X(6).
  3965             20  CM-MEMB-LN4.
  3966                 25  CM-INSURED-INITIALS-A5.
  3967                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3968                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3969                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3970
  3971     12  CM-INSURED-PROFILE-DATA.
  3972         16  CM-INSURED-FIRST-NAME.
  3973             20  CM-INSURED-1ST-INIT       PIC X.
  3974             20  FILLER                    PIC X(9).
  3975         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3976         16  CM-INSURED-SEX                PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  73
* EL131.cbl
  3977             88  CM-SEX-MALE                  VALUE 'M'.
  3978             88  CM-SEX-FEMAL                 VALUE 'F'.
  3979         16  CM-INSURED-JOINT-AGE          PIC 99.
  3980         16  CM-JOINT-INSURED-NAME.
  3981             20  CM-JT-LAST-NAME           PIC X(15).
  3982             20  CM-JT-FIRST-NAME.
  3983                 24  CM-JT-1ST-INIT        PIC X.
  3984                 24  FILLER                PIC X(9).
  3985             20  CM-JT-INITIAL             PIC X.
  3986
  3987     12  CM-LIFE-DATA.
  3988         16  CM-LF-BENEFIT-CD              PIC XX.
  3989         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3990         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3991         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3992         16  CM-LF-DEV-CODE                PIC XXX.
  3993         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3994         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3995         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3996         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3997         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3998         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3999         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4000         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4001         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4002         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4003         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4004         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4005         16  cm-temp-epiq                  pic xx.
  4006             88  EPIQ-CLASS                  value 'EQ'.
  4007*        16  FILLER                        PIC XX.
  4008
  4009     12  CM-AH-DATA.
  4010         16  CM-AH-BENEFIT-CD              PIC XX.
  4011         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4012         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4013         16  CM-AH-DEV-CODE                PIC XXX.
  4014         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4015         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4016         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4017         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4018         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4019         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4020         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4021         16  CM-AH-PAID-THRU-DT            PIC XX.
  4022             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4023         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4024         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4025         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4026         16  FILLER                        PIC X.
  4027
  4028     12  CM-LOAN-INFORMATION.
  4029         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4030         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4031                                           PIC S9(5)V99  COMP-3.
  4032         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4033         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4034         16  CM-PAY-FREQUENCY              PIC S99.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  74
* EL131.cbl
  4035         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4036         16  CM-RATE-CLASS                 PIC XX.
  4037         16  CM-BENEFICIARY                PIC X(25).
  4038         16  CM-POLICY-FORM-NO             PIC X(12).
  4039         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4040         16  CM-LAST-ADD-ON-DT             PIC XX.
  4041         16  CM-DEDUCTIBLE-AMOUNTS.
  4042             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4043             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4044         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4045             20  CM-RESIDENT-STATE         PIC XX.
  4046             20  CM-RATE-CODE              PIC X(4).
  4047             20  FILLER                    PIC XX.
  4048         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4049             20  CM-LOAN-OFFICER           PIC X(5).
  4050             20  FILLER                    PIC XXX.
  4051         16  CM-CSR-CODE                   PIC XXX.
  4052         16  CM-UNDERWRITING-CODE          PIC X.
  4053             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4054         16  CM-POST-CARD-IND              PIC X.
  4055         16  CM-REF-INTERFACE-SW           PIC X.
  4056         16  CM-PREMIUM-TYPE               PIC X.
  4057             88  CM-SING-PRM                  VALUE '1'.
  4058             88  CM-O-B-COVERAGE              VALUE '2'.
  4059             88  CM-OPEN-END                  VALUE '3'.
  4060         16  CM-IND-GRP-TYPE               PIC X.
  4061             88  CM-INDIVIDUAL                VALUE 'I'.
  4062             88  CM-GROUP                     VALUE 'G'.
  4063         16  CM-SKIP-CODE                  PIC X.
  4064             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4065             88  SKIP-JULY                    VALUE '1'.
  4066             88  SKIP-AUGUST                  VALUE '2'.
  4067             88  SKIP-SEPTEMBER               VALUE '3'.
  4068             88  SKIP-JULY-AUG                VALUE '4'.
  4069             88  SKIP-AUG-SEPT                VALUE '5'.
  4070             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4071             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4072             88  SKIP-JUNE                    VALUE '8'.
  4073             88  SKIP-JUNE-JULY               VALUE '9'.
  4074             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4075             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4076         16  CM-PAYMENT-MODE               PIC X.
  4077             88  PAY-MONTHLY                  VALUE SPACE.
  4078             88  PAY-WEEKLY                   VALUE '1'.
  4079             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4080             88  PAY-BI-WEEKLY                VALUE '3'.
  4081             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4082         16  CM-LOAN-NUMBER                PIC X(8).
  4083         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4084         16  CM-OLD-LOF                    PIC XXX.
  4085*        16  CM-LOAN-OFFICER               PIC XXX.
  4086         16  CM-REIN-TABLE                 PIC XXX.
  4087         16  CM-SPECIAL-REIN-CODE          PIC X.
  4088         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4089         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4090         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4091
  4092     12  CM-STATUS-DATA.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  75
* EL131.cbl
  4093         16  CM-ENTRY-STATUS               PIC X.
  4094         16  CM-ENTRY-DT                   PIC XX.
  4095
  4096         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4097         16  CM-LF-CANCEL-DT               PIC XX.
  4098         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4099
  4100         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4101         16  CM-LF-DEATH-DT                PIC XX.
  4102         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4103
  4104         16  CM-LF-CURRENT-STATUS          PIC X.
  4105             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4106                                                'M' '4' '5' '9'.
  4107             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4108             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4109             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4110             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4111             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4112             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4113             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4114             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4115             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4116             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4117             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4118             88  CM-LF-DECLINED               VALUE 'D'.
  4119             88  CM-LF-VOIDED                 VALUE 'V'.
  4120
  4121         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4122         16  CM-AH-CANCEL-DT               PIC XX.
  4123         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4124
  4125         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4126         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4127         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4128
  4129         16  CM-AH-CURRENT-STATUS          PIC X.
  4130             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4131                                                'M' '4' '5' '9'.
  4132             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4133             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4134             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4135             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4136             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4137             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4138             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4139             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4140             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4141             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4142             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4143             88  CM-AH-DECLINED               VALUE 'D'.
  4144             88  CM-AH-VOIDED                 VALUE 'V'.
  4145
  4146         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4147             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4148             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4149             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4150         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  76
* EL131.cbl
  4151
  4152         16  CM-ENTRY-BATCH                PIC X(6).
  4153         16  CM-LF-EXIT-BATCH              PIC X(6).
  4154         16  CM-AH-EXIT-BATCH              PIC X(6).
  4155         16  CM-LAST-MONTH-END             PIC XX.
  4156
  4157     12  CM-NOTE-SW                        PIC X.
  4158         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4159         88  CERT-NOTES-PRESENT               VALUE '1'.
  4160         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4161         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4162         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4163         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4164         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4165         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4166     12  CM-COMP-EXCP-SW                   PIC X.
  4167         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4168         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4169     12  CM-INSURED-ADDRESS-SW             PIC X.
  4170         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4171         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4172
  4173*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4174     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4175     12  FILLER                            PIC X.
  4176
  4177*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4178     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4179     12  FILLER                            PIC X.
  4180*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4181     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4182
  4183     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4184         88  CERT-ADDED-BATCH                 VALUE ' '.
  4185         88  CERT-ADDED-ONLINE                VALUE '1'.
  4186         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4187         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4188         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4189     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4190         88  CERT-AS-LOADED                   VALUE ' '.
  4191         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4192         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4193         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4194         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4195         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4196         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4197         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4198
  4199     12  CM-ACCOUNT-COMM-PCTS.
  4200         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4201         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4202
  4203     12  CM-USER-FIELD                     PIC X.
  4204     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4205     12  CM-CLP-STATE                      PIC XX.
  4206     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4207     12  CM-USER-RESERVED                  PIC XXX.
  4208     12  FILLER REDEFINES CM-USER-RESERVED.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  77
* EL131.cbl
  4209         16  CM-AH-CLASS-CD                PIC XX.
  4210         16  F                             PIC X.
  4211******************************************************************
  4212
  4213*                                COPY ELCTRLR.
  4214******************************************************************
  4215*                                                                *
  4216*                            ELCTRLR.                            *
  4217*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4218*                            VMOD=2.014                          *
  4219*                                                                *
  4220*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4221*                                                                *
  4222*   FILE TYPE = VSAM,KSDS                                        *
  4223*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4224*                                                                *
  4225*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4226*       ALTERNATE INDEX = NONE                                   *
  4227*                                                                *
  4228*   LOG = YES                                                    *
  4229*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4230******************************************************************
  4231*                   C H A N G E   L O G
  4232*
  4233* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4234*-----------------------------------------------------------------
  4235*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4236* EFFECTIVE    NUMBER
  4237*-----------------------------------------------------------------
  4238* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4239* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4240* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4241* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4242* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4243* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4244* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4245* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4246* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4247* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4248* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4249* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4250* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4251* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4252* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4253* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4254* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4255* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4256* 040814    2014030500002  AJRA  ADD ICD CODES
  4257* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4258* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4259* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  4260******************************************************************
  4261 01  ACTIVITY-TRAILERS.
  4262     12  AT-RECORD-ID                    PIC XX.
  4263         88  VALID-AT-ID                       VALUE 'AT'.
  4264
  4265     12  AT-CONTROL-PRIMARY.
  4266         16  AT-COMPANY-CD               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  78
* EL131.cbl
  4267         16  AT-CARRIER                  PIC X.
  4268         16  AT-CLAIM-NO                 PIC X(7).
  4269         16  AT-CERT-NO.
  4270             20  AT-CERT-PRIME           PIC X(10).
  4271             20  AT-CERT-SFX             PIC X.
  4272         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4273             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4274             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4275             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4276             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4277             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4278             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4279             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4280             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4281             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4282             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4283             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4284             88  AT-BENEFICIARY-TRL           VALUE +91.
  4285             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4286             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4287             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4288             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4289
  4290     12  AT-TRAILER-TYPE                 PIC X.
  4291         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4292         88  PAYMENT-TR                       VALUE '2'.
  4293         88  AUTO-PAY-TR                      VALUE '3'.
  4294         88  CORRESPONDENCE-TR                VALUE '4'.
  4295         88  ADDRESS-TR                       VALUE '5'.
  4296         88  GENERAL-INFO-TR                  VALUE '6'.
  4297         88  AUTO-PROMPT-TR                   VALUE '7'.
  4298         88  DENIAL-TR                        VALUE '8'.
  4299         88  INCURRED-CHG-TR                  VALUE '9'.
  4300         88  FORM-CONTROL-TR                  VALUE 'A'.
  4301
  4302     12  AT-RECORDED-DT                  PIC XX.
  4303     12  AT-RECORDED-BY                  PIC X(4).
  4304     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4305
  4306     12  AT-TRAILER-BODY                 PIC X(165).
  4307
  4308     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4309         16  AT-RESERVE-CONTROLS.
  4310             20  AT-MANUAL-SW            PIC X.
  4311                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4312             20  AT-FUTURE-SW            PIC X.
  4313                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4314             20  AT-PTC-SW               PIC X.
  4315                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4316             20  AT-IBNR-SW              PIC X.
  4317                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4318             20  AT-PTC-LF-SW            PIC X.
  4319                 88  AT-LF-PTC-USED          VALUE '1'.
  4320             20  AT-CDT-ACCESS-METHOD    PIC X.
  4321                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4322                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4323                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4324             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  79
* EL131.cbl
  4325         16  AT-LAST-COMPUTED-DT         PIC XX.
  4326         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4327         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4328         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4329         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4330         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4331         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4332         16  AT-EXPENSE-CONTROLS.
  4333             20  AT-EXPENSE-METHOD       PIC X.
  4334                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4335                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4336                 88  PERCENT-OF-PMT           VALUE '3'.
  4337                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4338             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4339             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4340         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4341         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4342
  4343         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4344         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4345
  4346*        16  FILLER                      PIC X(53).
  4347         16  FILLER                      PIC X(47).
  4348
  4349         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4350         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4351
  4352         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4353             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4354             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4355*                    C = CLOSED
  4356*                    O = OPEN
  4357             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4358*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4359
  4360     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4361         16  AT-PAYMENT-TYPE             PIC X.
  4362             88  PARTIAL-PAYMENT                VALUE '1'.
  4363             88  FINAL-PAYMENT                  VALUE '2'.
  4364             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4365             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4366             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4367             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4368             88  VOIDED-PAYMENT                 VALUE '9'.
  4369             88  TRANSFER                       VALUE 'T'.
  4370             88  LIFE-INTEREST                  VALUE 'I'.
  4371
  4372         16  AT-CLAIM-TYPE               PIC X.
  4373             88  PAID-FOR-AH                    VALUE 'A'.
  4374             88  PAID-FOR-LIFE                  VALUE 'L'.
  4375             88  PAID-FOR-IUI                   VALUE 'I'.
  4376             88  PAID-FOR-GAP                   VALUE 'G'.
  4377             88  PAID-FOR-FAM                   VALUE 'F'.
  4378         16  AT-CLAIM-PREM-TYPE          PIC X.
  4379             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4380             88  AT-O-B-COVERAGE                VALUE '2'.
  4381             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4382         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  80
* EL131.cbl
  4383         16  AT-CHECK-NO                 PIC X(7).
  4384         16  AT-PAID-FROM-DT             PIC XX.
  4385         16  AT-PAID-THRU-DT             PIC XX.
  4386         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4387         16  AT-ACH-PAYMENT              PIC X.
  4388*        16  FILLER                      PIC X.
  4389         16  AT-PAYEES-NAME              PIC X(30).
  4390         16  AT-PAYMENT-ORIGIN           PIC X.
  4391             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4392             88  ONLINE-AUTO-PMT                VALUE '2'.
  4393             88  OFFLINE-PMT                    VALUE '3'.
  4394         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4395         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4396         16  AT-VOID-DATA.
  4397             20  AT-VOID-DT              PIC XX.
  4398*00144       20  AT-VOID-REASON          PIC X(30).
  4399             20  AT-VOID-REASON          PIC X(26).
  4400         16  AT-PMT-APPROVED-BY          PIC X(04).
  4401         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4402         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4403         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4404                                         PIC S99V9(5)  COMP-3.
  4405         16  AT-CREDIT-INTERFACE.
  4406             20  AT-PMT-SELECT-DT        PIC XX.
  4407                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4408             20  AT-PMT-ACCEPT-DT        PIC XX.
  4409                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4410             20  AT-VOID-SELECT-DT       PIC XX.
  4411                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4412             20  AT-VOID-ACCEPT-DT       PIC XX.
  4413                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4414
  4415         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4416                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4417                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4418         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4419
  4420         16  AT-FORCE-CONTROL            PIC X.
  4421             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4422         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4423         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4424         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4425         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4426         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4427         16  AT-BENEFIT-TYPE             PIC X.
  4428
  4429         16  AT-EXPENSE-TYPE             PIC X.
  4430         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4431
  4432         16  AT-PAYEE-TYPE-CD.
  4433             20  AT-PAYEE-TYPE           PIC X.
  4434                 88  INSURED-PAID           VALUE 'I'.
  4435                 88  BENEFICIARY-PAID       VALUE 'B'.
  4436                 88  ACCOUNT-PAID           VALUE 'A'.
  4437                 88  OTHER-1-PAID           VALUE 'O'.
  4438                 88  OTHER-2-PAID           VALUE 'Q'.
  4439                 88  DOCTOR-PAID            VALUE 'P'.
  4440                 88  EMPLOYER-PAID          VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  81
* EL131.cbl
  4441             20  AT-PAYEE-SEQ            PIC X.
  4442
  4443         16  AT-CASH-PAYMENT             PIC X.
  4444         16  AT-GROUPED-PAYMENT          PIC X.
  4445         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4446         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4447         16  AT-APPROVED-LEVEL           PIC X.
  4448         16  AT-VOID-TYPE                PIC X.
  4449             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4450             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4451         16  AT-AIG-UNEMP-IND            PIC X.
  4452             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4453         16  AT-ASSOCIATES               PIC X.
  4454             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4455             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4456
  4457         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4458         16  AT-CV-PMT-CODE              PIC X.
  4459             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4460             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4461             88  FULL-ADD-PAYMENT           VALUE '3'.
  4462             88  HALF-ADD-PAYMENT           VALUE '4'.
  4463             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4464             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4465             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4466             88  ADDL-PAYMENT               VALUE '8'.
  4467
  4468         16  AT-EOB-CODE1                PIC XXX.
  4469         16  AT-EOB-CODE2                PIC XXX.
  4470         16  AT-EOB-CODE3                PIC XXX.
  4471         16  FILLER REDEFINES AT-EOB-CODE3.
  4472             20  AT-PRINT-CLM-FORM       PIC X.
  4473             20  AT-PRINT-SURVEY         PIC X.
  4474             20  AT-SPECIAL-RELEASE      PIC X.
  4475         16  AT-EOB-CODE4                PIC XXX.
  4476         16  FILLER REDEFINES AT-EOB-CODE4.
  4477             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4478             20  FILLER                  PIC X.
  4479         16  AT-EOB-CODE5                PIC XXX.
  4480         16  FILLER REDEFINES AT-EOB-CODE5.
  4481             20  AT-PMT-PROOF-DT         PIC XX.
  4482             20  FILLER                  PIC X.
  4483
  4484         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4485             88  AT-PRINT-EOB            VALUE 'Y'.
  4486
  4487         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4488         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4489
  4490     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4491         16  AT-SCHEDULE-START-DT        PIC XX.
  4492         16  AT-SCHEDULE-END-DT          PIC XX.
  4493         16  AT-TERMINATED-DT            PIC XX.
  4494         16  AT-LAST-PMT-TYPE            PIC X.
  4495             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4496             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4497         16  AT-FIRST-PMT-DATA.
  4498             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  82
* EL131.cbl
  4499             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4500             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4501         16  AT-REGULAR-PMT-DATA.
  4502             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4503             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4504             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4505         16  AT-AUTO-PAYEE-CD.
  4506             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4507                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4508                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4509                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4510                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4511                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4512             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4513         16  AT-AUTO-PAY-DAY             PIC 99.
  4514         16  AT-AUTO-CASH                PIC X.
  4515             88  AT-CASH                      VALUE 'Y'.
  4516             88  AT-NON-CASH                  VALUE 'N'.
  4517*        16  FILLER                      PIC X(129).
  4518         16  AT-AUTO-END-LETTER          PIC X(4).
  4519         16  FILLER                      PIC X(125).
  4520
  4521         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4522         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4523
  4524     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4525         16  AT-LETTER-SENT-DT           PIC XX.
  4526         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4527         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4528         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4529         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4530         16  AT-LETTER-ORIGIN            PIC X.
  4531             88  ONLINE-CREATION              VALUE '1' '3'.
  4532             88  OFFLINE-CREATION             VALUE '2' '4'.
  4533             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4534             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4535         16  AT-STD-LETTER-FORM          PIC X(4).
  4536         16  AT-REASON-TEXT              PIC X(70).
  4537         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4538         16  AT-ADDRESEE-TYPE            PIC X.
  4539              88  INSURED-ADDRESEE            VALUE 'I'.
  4540              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4541              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4542              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4543              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4544              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4545              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4546         16  AT-ADDRESSEE-NAME           PIC X(30).
  4547         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4548         16  AT-RESEND-PRINT-DATE        PIC XX.
  4549         16  AT-CORR-SOL-UNSOL           PIC X.
  4550         16  AT-LETTER-PURGED-DT         PIC XX.
  4551*
  4552*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4553*
  4554         16  AT-CSO-REDEFINITION.
  4555             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4556             20  AT-AUTO-CLOSE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  83
* EL131.cbl
  4557             20  AT-LETTER-TO-BENE       PIC X(1).
  4558             20  AT-STOP-LETTER-DT       PIC X(2).
  4559             20  AT-AUTH-RCVD            PIC X(1).
  4560             20  FILLER                  PIC X(18).
  4561*             20  FILLER                  PIC X(27).
  4562             20  AT-CSO-LETTER-STATUS    PIC X.
  4563                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4564                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4565                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4566             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4567             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4568*
  4569*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4570*
  4571*        16  FILLER                      PIC X(26).
  4572*
  4573*        16  AT-DMD-BSR-CODE             PIC X.
  4574*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4575*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4576*
  4577*        16  AT-DMD-LETTER-STATUS        PIC X.
  4578*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4579*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4580*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4581*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4582*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4583
  4584         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4585         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4586
  4587     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4588         16  AT-ADDRESS-TYPE             PIC X.
  4589             88  INSURED-ADDRESS               VALUE 'I'.
  4590             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4591             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4592             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4593             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4594             88  OTHER-ADDRESS-1               VALUE 'O'.
  4595             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4596         16  AT-MAIL-TO-NAME             PIC X(30).
  4597         16  AT-ADDRESS-LINE-1           PIC X(30).
  4598         16  AT-ADDRESS-LINE-2           PIC X(30).
  4599         16  AT-CITY-STATE.
  4600             20  AT-CITY                 PIC X(28).
  4601             20  AT-STATE                PIC XX.
  4602         16  AT-ZIP.
  4603             20  AT-ZIP-CODE.
  4604                 24  AT-ZIP-1ST          PIC X.
  4605                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4606                 24  FILLER              PIC X(4).
  4607             20  AT-ZIP-PLUS4            PIC X(4).
  4608         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4609             20  AT-CAN-POSTAL-1         PIC XXX.
  4610             20  AT-CAN-POSTAL-2         PIC XXX.
  4611             20  FILLER                  PIC XXX.
  4612         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4613*         16  FILLER                      PIC X(23).
  4614         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  84
* EL131.cbl
  4615         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4616         16  FILLER                      PIC X(13).
  4617         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4618         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4619
  4620     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4621         16  AT-INFO-LINE-1              PIC X(60).
  4622         16  FILLER REDEFINES AT-INFO-LINE-1.
  4623             20  AT-NOTE-ERROR-NO OCCURS 15
  4624                                         PIC X(4).
  4625         16  AT-INFO-LINE-2              PIC X(60).
  4626         16  FILLER REDEFINES AT-INFO-LINE-2.
  4627             20  AT-ICD-CODE-1           PIC X(8).
  4628             20  AT-ICD-CODE-2           PIC X(8).
  4629             20  FILLER                  PIC X(44).
  4630         16  AT-INFO-TRAILER-TYPE        PIC X.
  4631             88  AT-ERRORS-NOTE          VALUE 'E'.
  4632             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4633             88  AT-CALL-NOTE            VALUE 'C'.
  4634             88  AT-MAINT-NOTE           VALUE 'M'.
  4635             88  AT-CERT-CHANGE          VALUE 'X'.
  4636             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4637             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4638             88  AT-CERT-CANCELLED       VALUE 'T'.
  4639         16  AT-CALL-TYPE                PIC X.
  4640             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4641             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4642         16  AT-NOTE-CONTINUATION        PIC X.
  4643             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4644         16  AT-EOB-CODES-EXIST          PIC X.
  4645             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4646         16  FILLER                      PIC X(35).
  4647         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4648         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4649
  4650     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4651         16  AT-PROMPT-LINE-1            PIC X(60).
  4652         16  AT-PROMPT-LINE-2            PIC X(60).
  4653         16  AT-PROMPT-START-DT          PIC XX.
  4654         16  AT-PROMPT-END-DT            PIC XX.
  4655         16  FILLER                      PIC X(35).
  4656         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4657         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4658
  4659     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4660         16  AT-DENIAL-INFO-1            PIC X(60).
  4661         16  AT-DENIAL-INFO-2            PIC X(60).
  4662         16  AT-DENIAL-DT                PIC XX.
  4663         16  AT-RETRACTION-DT            PIC XX.
  4664         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4665*         16  FILLER                      PIC X(31).
  4666         16  AT-DENIAL-PROOF-DT          PIC XX.
  4667         16  FILLER                      PIC X(29).
  4668         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4669         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4670
  4671     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4672         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  85
* EL131.cbl
  4673         16  AT-OLD-REPORTED-DT          PIC XX.
  4674         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4675         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4676         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4677         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4678         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4679         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4680         16  FILLER                      PIC X(26).
  4681         16  AT-OLD-DIAG-CODE            PIC X(6).
  4682         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4683         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4684         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4685         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4686         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4687         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4688         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4689         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4690         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4691         16  FILLER                      PIC X(9).
  4692         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4693
  4694     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4695         16  AT-FORM-SEND-ON-DT          PIC XX.
  4696         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4697         16  AT-FORM-RE-SEND-DT          PIC XX.
  4698         16  AT-FORM-ANSWERED-DT         PIC XX.
  4699         16  AT-FORM-PRINTED-DT          PIC XX.
  4700         16  AT-FORM-REPRINT-DT          PIC XX.
  4701         16  AT-FORM-TYPE                PIC X.
  4702             88  INITIAL-FORM                  VALUE '1'.
  4703             88  PROGRESS-FORM                 VALUE '2'.
  4704         16  AT-INSTRUCT-LN-1            PIC X(28).
  4705         16  AT-INSTRUCT-LN-2            PIC X(28).
  4706         16  AT-INSTRUCT-LN-3            PIC X(28).
  4707         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4708         16  AT-FORM-ADDRESS             PIC X.
  4709             88  FORM-TO-INSURED              VALUE 'I'.
  4710             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4711             88  FORM-TO-OTHER-1              VALUE 'O'.
  4712             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4713         16  AT-RELATED-1.
  4714             20 AT-REL-CARR-1            PIC X.
  4715             20 AT-REL-CLAIM-1           PIC X(7).
  4716             20 AT-REL-CERT-1            PIC X(11).
  4717         16  AT-RELATED-2.
  4718             20 AT-REL-CARR-2            PIC X.
  4719             20 AT-REL-CLAIM-2           PIC X(7).
  4720             20 AT-REL-CERT-2            PIC X(11).
  4721         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4722         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4723         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4724         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4725         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4726         16  AT-STOP-FORM-DT             PIC X(2).
  4727
  4728         16  FILLER                      PIC X(09).
  4729         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4730         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  86
* EL131.cbl
  4731******************************************************************
  4732
  4733*                                COPY ELCCNTL.
  4734******************************************************************
  4735*                                                                *
  4736*                                                                *
  4737*                            ELCCNTL.                            *
  4738*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4739*                            VMOD=2.059                          *
  4740*                                                                *
  4741*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4742*                                                                *
  4743*   FILE TYPE = VSAM,KSDS                                        *
  4744*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4745*                                                                *
  4746*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4747*       ALTERNATE INDEX = NONE                                   *
  4748*                                                                *
  4749*   LOG = YES                                                    *
  4750*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4751******************************************************************
  4752*                   C H A N G E   L O G
  4753*
  4754* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4755*-----------------------------------------------------------------
  4756*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4757* EFFECTIVE    NUMBER
  4758*-----------------------------------------------------------------
  4759* 082503                   PEMA  ADD BENEFIT GROUP
  4760* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4761* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4762* 092705    2005050300006  PEMA  ADD SPP LEASES
  4763* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4764* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4765* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4766* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4767* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4768* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4769* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4770* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4771* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4772* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4773* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4774******************************************************************
  4775*
  4776 01  CONTROL-FILE.
  4777     12  CF-RECORD-ID                       PIC XX.
  4778         88  VALID-CF-ID                        VALUE 'CF'.
  4779
  4780     12  CF-CONTROL-PRIMARY.
  4781         16  CF-COMPANY-ID                  PIC XXX.
  4782         16  CF-RECORD-TYPE                 PIC X.
  4783             88  CF-COMPANY-MASTER              VALUE '1'.
  4784             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4785             88  CF-STATE-MASTER                VALUE '3'.
  4786             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4787             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4788             88  CF-CARRIER-MASTER              VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  87
* EL131.cbl
  4789             88  CF-MORTALITY-MASTER            VALUE '7'.
  4790             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4791             88  CF-TERMINAL-MASTER             VALUE '9'.
  4792             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4793             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4794             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4795             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4796             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4797             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4798             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4799             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4800             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4801         16  CF-ACCESS-CD-GENL              PIC X(4).
  4802         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4803             20  CF-PROCESSOR               PIC X(4).
  4804         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4805             20  CF-STATE-CODE              PIC XX.
  4806             20  FILLER                     PIC XX.
  4807         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4808             20  FILLER                     PIC XX.
  4809             20  CF-HI-BEN-IN-REC           PIC XX.
  4810         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4811             20  FILLER                     PIC XXX.
  4812             20  CF-CARRIER-CNTL            PIC X.
  4813         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4814             20  FILLER                     PIC XX.
  4815             20  CF-HI-TYPE-IN-REC          PIC 99.
  4816         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4817             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4818                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4819             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4820             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4821         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4822             20  FILLER                     PIC X.
  4823             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4824         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4825             20  FILLER                     PIC XX.
  4826             20  CF-MORTGAGE-PLAN           PIC XX.
  4827         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4828
  4829     12  CF-LAST-MAINT-DT                   PIC XX.
  4830     12  CF-LAST-MAINT-BY                   PIC X(4).
  4831     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4832
  4833     12  CF-RECORD-BODY                     PIC X(728).
  4834
  4835
  4836****************************************************************
  4837*             COMPANY MASTER RECORD                            *
  4838****************************************************************
  4839
  4840     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4841         16  CF-COMPANY-ADDRESS.
  4842             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4843             20  CF-CL-IN-CARE-OF           PIC X(30).
  4844             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4845             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4846             20  CF-CL-CITY-STATE           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  88
* EL131.cbl
  4847             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4848             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4849         16  CF-COMPANY-CD                  PIC X.
  4850         16  CF-COMPANY-PASSWORD            PIC X(8).
  4851         16  CF-SECURITY-OPTION             PIC X.
  4852             88  ALL-SECURITY                   VALUE '1'.
  4853             88  COMPANY-VERIFY                 VALUE '2'.
  4854             88  PROCESSOR-VERIFY               VALUE '3'.
  4855             88  NO-SECURITY                    VALUE '4'.
  4856             88  ALL-BUT-TERM                   VALUE '5'.
  4857         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4858             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4859         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4860             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4861         16  CF-INFORCE-LOCATION            PIC X.
  4862             88  CERTS-ARE-ONLINE               VALUE '1'.
  4863             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4864             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4865         16  CF-LOWER-CASE-LETTERS          PIC X.
  4866         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4867             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4868             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4869             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4870             88  CF-ACCNT-CNTL                  VALUE '3'.
  4871             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4872
  4873         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4874         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4875
  4876         16  CF-LGX-CREDIT-USER             PIC X.
  4877             88  CO-IS-NOT-USER                 VALUE 'N'.
  4878             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4879
  4880         16 CF-CREDIT-CALC-CODES.
  4881             20  CF-CR-REM-TERM-CALC PIC X.
  4882               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4883               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4884               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4885               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4886               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4887               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4888               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4889             20  CF-CR-R78-METHOD           PIC X.
  4890               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4891               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4892
  4893         16  CF-CLAIM-CONTROL-COUNTS.
  4894             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4895                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4896
  4897             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4898                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4899
  4900             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4901                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4902
  4903             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4904                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  89
* EL131.cbl
  4905
  4906         16  CF-CURRENT-MONTH-END           PIC XX.
  4907
  4908         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4909             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4910             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4911             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4912             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4913                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4914                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4915             20  CF-CO-PREM-REJECT-SW       PIC X.
  4916                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4917                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4918             20  CF-CO-REF-REJECT-SW        PIC X.
  4919                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4920                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4921
  4922         16  CF-CO-REPORTING-DT             PIC XX.
  4923         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4924         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4925           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4926           88  CF-CO-MONTH-END                  VALUE '1'.
  4927
  4928         16  CF-LGX-CLAIM-USER              PIC X.
  4929             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4930             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4931
  4932         16  CF-CREDIT-EDIT-CONTROLS.
  4933             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4934             20  CF-MIN-AGE                 PIC 99.
  4935             20  CF-DEFAULT-AGE             PIC 99.
  4936             20  CF-MIN-TERM                PIC S999      COMP-3.
  4937             20  CF-MAX-TERM                PIC S999      COMP-3.
  4938             20  CF-DEFAULT-SEX             PIC X.
  4939             20  CF-JOINT-AGE-INPUT         PIC X.
  4940                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4941             20  CF-BIRTH-DATE-INPUT        PIC X.
  4942                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4943             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4944                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4945                 88  CF-ZERO-CARRIER            VALUE '1'.
  4946                 88  CF-ZERO-GROUPING           VALUE '2'.
  4947                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4948             20  CF-EDIT-SW                 PIC X.
  4949                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4950             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4951             20  CF-CR-PR-METHOD            PIC X.
  4952               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4953               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4954             20  FILLER                     PIC X.
  4955
  4956         16  CF-CREDIT-MISC-CONTROLS.
  4957             20  CF-REIN-TABLE-SW           PIC X.
  4958                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4959             20  CF-COMP-TABLE-SW           PIC X.
  4960                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4961             20  CF-EXPERIENCE-RETENTION-AGE
  4962                                            PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  90
* EL131.cbl
  4963             20  CF-CONVERSION-DT           PIC XX.
  4964             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4965             20  CF-RUN-FREQUENCY-SW        PIC X.
  4966                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4967                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4968
  4969             20  CF-CR-CHECK-NO-CONTROL.
  4970                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4971                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4972                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4973                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4974                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4975                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4976
  4977                 24  CF-CR-CHECK-COUNT       REDEFINES
  4978                     CF-CR-CHECK-COUNTER      PIC X(4).
  4979
  4980                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4981                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4982
  4983                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4984                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4985                 24  CF-MAIL-PROCESSING       PIC X.
  4986                     88  MAIL-PROCESSING          VALUE 'Y'.
  4987
  4988         16  CF-MISC-SYSTEM-CONTROL.
  4989             20  CF-SYSTEM-C                 PIC X.
  4990                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4991             20  CF-SYSTEM-D                 PIC X.
  4992                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4993             20  CF-SOC-SEC-NO-SW            PIC X.
  4994                 88  SOC-SEC-NO-USED             VALUE '1'.
  4995             20  CF-MEMBER-NO-SW             PIC X.
  4996                 88  MEMBER-NO-USED              VALUE '1'.
  4997             20  CF-TAX-ID-NUMBER            PIC X(11).
  4998             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4999             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5000                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5001                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5002                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5003                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5004             20  CF-SYSTEM-E                 PIC X.
  5005                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5006
  5007         16  CF-LGX-LIFE-USER               PIC X.
  5008             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5009             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5010
  5011         16  CF-CR-MONTH-END-DT             PIC XX.
  5012
  5013         16  CF-FILE-MAINT-DATES.
  5014             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5015                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5016             20  CF-LAST-BATCH       REDEFINES
  5017                 CF-LAST-BATCH-NO               PIC X(4).
  5018             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5019             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5020             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  91
* EL131.cbl
  5021             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5022             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5023             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5024             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5025             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5026             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5027             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5028
  5029         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5030         16  FILLER                         PIC X.
  5031
  5032         16  CF-ALT-MORT-CODE               PIC X(4).
  5033         16  CF-MEMBER-CAPTION              PIC X(10).
  5034
  5035         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5036             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5037             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5038             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5039             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5040             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5041
  5042         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5043
  5044         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5045         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5046         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5047         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5048
  5049         16  CF-AH-OVERRIDE-L1              PIC X.
  5050         16  CF-AH-OVERRIDE-L2              PIC XX.
  5051         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5052         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5053
  5054         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5055         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5056
  5057         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5058         16  CF-AR-LAST-EL860-DT            PIC XX.
  5059         16  CF-MP-MONTH-END-DT             PIC XX.
  5060
  5061         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5062         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5063             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5064
  5065         16  CF-AR-MONTH-END-DT             PIC XX.
  5066
  5067         16  CF-CRDTCRD-USER                PIC X.
  5068             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5069             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5070
  5071         16  CF-CC-MONTH-END-DT             PIC XX.
  5072
  5073         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5074
  5075         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5076             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5077             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5078             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  92
* EL131.cbl
  5079         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5080         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5081         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5082         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5083             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5084             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5085         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5086         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5087         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5088             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5089         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5090
  5091         16  CF-CL-ZIP-CODE.
  5092             20  CF-CL-ZIP-PRIME.
  5093                 24  CF-CL-ZIP-1ST          PIC X.
  5094                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5095                 24  FILLER                 PIC X(4).
  5096             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5097         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5098             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5099             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5100             20  FILLER                     PIC XXX.
  5101
  5102         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5103         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5104         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5105         16  CF-CO-OPTION-START-DATE        PIC XX.
  5106         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5107           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5108                                                      '3' '4'.
  5109           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5110           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5111           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5112           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5113           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5114           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5115
  5116         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5117
  5118         16  CF-PAYMENT-APPROVAL-LEVELS.
  5119             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5120             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5121             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5122             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5123             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5124             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5125
  5126         16  CF-END-USER-REPORTING-USER     PIC X.
  5127             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5128             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5129
  5130         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5131             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5132             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5133
  5134         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5135
  5136         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  93
* EL131.cbl
  5137         16  FILLER                         PIC X.
  5138
  5139         16  CF-CREDIT-ARCHIVE-CNTL.
  5140             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5141             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5142             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5143
  5144         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5145
  5146         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5147             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5148             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5149
  5150         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5151             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5152             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5153
  5154         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5155
  5156         16  CF-CO-ACH-ID-CODE              PIC  X.
  5157             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5158             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5159             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5160         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5161         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5162         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5163         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5164         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5165         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5166         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5167         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5168         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5169                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5170         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5171                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5172
  5173         16  CF-CO-OVER-SHORT.
  5174             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5175             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5176
  5177*         16  FILLER                         PIC X(102).
  5178         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5179             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5180             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5181
  5182         16  CF-AH-APPROVAL-DAYS.
  5183             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5184             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5185             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5186             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5187
  5188         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5189
  5190         16  CF-APPROV-LEV-5.
  5191             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5192             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5193             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5194
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  94
* EL131.cbl
  5195         16  FILLER                         PIC X(68).
  5196****************************************************************
  5197*             PROCESSOR/USER RECORD                            *
  5198****************************************************************
  5199
  5200     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5201         16  CF-PROCESSOR-NAME              PIC X(30).
  5202         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5203         16  CF-PROCESSOR-TITLE             PIC X(26).
  5204         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5205                 88  MESSAGE-YES                VALUE 'Y'.
  5206                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5207
  5208*****************************************************
  5209****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5210****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5211****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5212****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5213*****************************************************
  5214
  5215         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5216             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5217             20  CF-APPLICATION-FORCE       PIC X.
  5218             20  CF-INDIVIDUAL-APP.
  5219                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5220                     28  CF-BROWSE-APP      PIC X.
  5221                     28  CF-UPDATE-APP      PIC X.
  5222
  5223         16  CF-CURRENT-TERM-ON             PIC X(4).
  5224         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5225             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5226             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5227             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5228             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5229             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5230             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5231             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5232         16  CF-PROCESSOR-CARRIER           PIC X.
  5233             88  NO-CARRIER-SECURITY            VALUE ' '.
  5234         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5235             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5236         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5237             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5238         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5239             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5240
  5241         16  CF-PROC-SYS-ACCESS-SW.
  5242             20  CF-PROC-CREDIT-CLAIMS-SW.
  5243                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5244                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5245                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5246                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5247             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5248                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5249                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5250             20  CF-PROC-LIFE-GNRLDGR-SW.
  5251                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5252                     88  ACCESS-TO-LIFE             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  95
* EL131.cbl
  5253                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5254                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5255             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5256                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5257                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5258         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5259             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5260             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5261         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5262
  5263         16  CF-APPROVAL-LEVEL                  PIC X.
  5264             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5265             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5266             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5267             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5268             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5269
  5270         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5271
  5272         16  CF-LANGUAGE-TYPE                   PIC X.
  5273             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5274             88  CF-LANG-IS-FR                      VALUE 'F'.
  5275
  5276         16  CF-CSR-IND                         PIC X.
  5277         16  FILLER                             PIC X(239).
  5278
  5279****************************************************************
  5280*             PROCESSOR/REMINDERS RECORD                       *
  5281****************************************************************
  5282
  5283     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5284         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5285             20  CF-START-REMIND-DT         PIC XX.
  5286             20  CF-END-REMIND-DT           PIC XX.
  5287             20  CF-REMINDER-TEXT           PIC X(50).
  5288         16  FILLER                         PIC X(296).
  5289
  5290
  5291****************************************************************
  5292*             STATE MASTER RECORD                              *
  5293****************************************************************
  5294
  5295     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5296         16  CF-STATE-ABBREVIATION          PIC XX.
  5297         16  CF-STATE-NAME                  PIC X(25).
  5298         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5299         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5300             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5301             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5302             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5303             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5304                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5305                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5306             20  CF-ST-PREM-REJECT-SW       PIC X.
  5307                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5308                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5309             20  CF-ST-REF-REJECT-SW        PIC X.
  5310                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  96
* EL131.cbl
  5311                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5312         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5313         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5314         16  CF-ST-REFUND-RULES.
  5315             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5316             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5317             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5318         16  CF-ST-FST-PMT-EXTENSION.
  5319             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5320             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5321                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5322                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5323                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5324                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5325         16  CF-ST-STATE-CALL.
  5326             20  CF-ST-CALL-UNEARNED        PIC X.
  5327             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5328             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5329         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5330             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5331             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5332         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5333         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5334         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5335         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5336         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5337         16  FILLER                         PIC X.
  5338         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5339             20  CF-ST-BENEFIT-CD           PIC XX.
  5340             20  CF-ST-BENEFIT-KIND         PIC X.
  5341                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5342                 88  CF-ST-AH-KIND              VALUE 'A'.
  5343             20  CF-ST-REM-TERM-CALC        PIC X.
  5344                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5345                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5346                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5347                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5348                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5349                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5350                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5351                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5352
  5353             20  CF-ST-REFUND-CALC          PIC X.
  5354                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5355                 88  ST-REFD-BY-R78             VALUE '1'.
  5356                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5357                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5358                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5359                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5360                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5361                 88  ST-REFD-UTAH               VALUE '7'.
  5362                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5363                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5364                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5365
  5366             20  CF-ST-EARNING-CALC         PIC X.
  5367                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5368                 88  ST-EARN-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  97
* EL131.cbl
  5369                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5370                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5371                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5372                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5373                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5374                 88  ST-EARN-MEAN               VALUE '8'.
  5375                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5376
  5377             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5378                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5379                 88  ST-OVRD-BY-R78             VALUE '1'.
  5380                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5381                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5382                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5383                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5384                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5385                 88  ST-OVRD-MEAN               VALUE '8'.
  5386                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5387             20  cf-st-extra-periods        pic 9.
  5388*            20  FILLER                     PIC X.
  5389
  5390         16  CF-ST-COMMISSION-CAPS.
  5391             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5392             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5393             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5394             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5395         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5396                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5397                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5398                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5399
  5400         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5401
  5402         16  CF-ST-STATUTORY-INTEREST.
  5403             20  CF-ST-STAT-DATE-FROM       PIC X.
  5404                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5405                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5406             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5407             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5408             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5409             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5410             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5411
  5412         16  CF-ST-OVER-SHORT.
  5413             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5414             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5415
  5416         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5417
  5418         16  CF-ST-RT-CALC                  PIC X.
  5419
  5420         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5421         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5422         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5423         16  CF-ST-RF-LR-CALC               PIC X.
  5424         16  CF-ST-RF-LL-CALC               PIC X.
  5425         16  CF-ST-RF-LN-CALC               PIC X.
  5426         16  CF-ST-RF-AH-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  98
* EL131.cbl
  5427         16  CF-ST-RF-CP-CALC               PIC X.
  5428*        16  FILLER                         PIC X(206).
  5429*CIDMOD         16  FILLER                         PIC X(192).
  5430         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5431             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5432         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5433         16  CF-ST-VFY-2ND-BENE             PIC X.
  5434         16  CF-ST-CAUSAL-STATE             PIC X.
  5435         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5436         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5437         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5438             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5439         16  CF-ST-NET-ONLY-STATE           PIC X.
  5440             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5441         16  cf-commission-cap-required     pic x.
  5442         16  CF-ST-GA-COMMISSION-CAPS.
  5443             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5444             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5445             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5446             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5447         16  CF-ST-TOT-COMMISSION-CAPS.
  5448             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5449             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5450             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5451             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5452         16  FILLER                         PIC X(156).
  5453
  5454****************************************************************
  5455*             BENEFIT MASTER RECORD                            *
  5456****************************************************************
  5457
  5458     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5459         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5460             20  CF-BENEFIT-CODE            PIC XX.
  5461             20  CF-BENEFIT-NUMERIC  REDEFINES
  5462                 CF-BENEFIT-CODE            PIC XX.
  5463             20  CF-BENEFIT-ALPHA           PIC XXX.
  5464             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5465             20  CF-BENEFIT-COMMENT         PIC X(10).
  5466
  5467             20  CF-LF-COVERAGE-TYPE        PIC X.
  5468                 88  CF-REDUCING                VALUE 'R'.
  5469                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5470
  5471             20  CF-SPECIAL-CALC-CD         PIC X.
  5472                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5473                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5474                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5475                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5476                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5477                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5478                 88  CF-FARM-PLAN               VALUE 'F'.
  5479                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5480                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5481                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5482                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5483                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5484                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page  99
* EL131.cbl
  5485                 88  CF-PRUDENTIAL              VALUE 'P'.
  5486                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5487                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5488                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5489                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5490                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5491                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5492
  5493             20  CF-JOINT-INDICATOR         PIC X.
  5494                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5495
  5496*            20  FILLER                     PIC X(12).
  5497             20  cf-maximum-benefits        pic s999 comp-3.
  5498             20  FILLER                     PIC X(09).
  5499             20  CF-BENEFIT-CATEGORY        PIC X.
  5500             20  CF-LOAN-TYPE               PIC X(8).
  5501
  5502             20  CF-CO-REM-TERM-CALC        PIC X.
  5503                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5504                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5505                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5506                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5507                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5508
  5509             20  CF-CO-EARNINGS-CALC        PIC X.
  5510                 88  CO-EARN-BY-R78             VALUE '1'.
  5511                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5512                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5513                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5514                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5515                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5516                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5517                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5518
  5519             20  CF-CO-REFUND-CALC          PIC X.
  5520                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5521                 88  CO-REFD-BY-R78             VALUE '1'.
  5522                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5523                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5524                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5525                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5526                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5527                 88  CO-REFD-MEAN               VALUE '8'.
  5528                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5529                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5530                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5531
  5532             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5533                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5534                 88  CO-OVRD-BY-R78             VALUE '1'.
  5535                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5536                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5537                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5538                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5539                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5540                 88  CO-OVRD-MEAN               VALUE '8'.
  5541                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5542
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 100
* EL131.cbl
  5543             20  CF-CO-BEN-I-G-CD           PIC X.
  5544                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5545                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5546                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5547
  5548         16  FILLER                         PIC X(304).
  5549
  5550
  5551****************************************************************
  5552*             CARRIER MASTER RECORD                            *
  5553****************************************************************
  5554
  5555     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5556         16  CF-ADDRESS-DATA.
  5557             20  CF-MAIL-TO-NAME            PIC X(30).
  5558             20  CF-IN-CARE-OF              PIC X(30).
  5559             20  CF-ADDRESS-LINE-1          PIC X(30).
  5560             20  CF-ADDRESS-LINE-2          PIC X(30).
  5561             20  CF-CITY-STATE              PIC X(30).
  5562             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5563             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5564
  5565         16  CF-CLAIM-NO-CONTROL.
  5566             20  CF-CLAIM-NO-METHOD         PIC X.
  5567                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5568                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5569                 88  CLAIM-NO-SEQ               VALUE '3'.
  5570                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5571             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5572                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5573                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5574                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5575
  5576         16  CF-CHECK-NO-CONTROL.
  5577             20  CF-CHECK-NO-METHOD         PIC X.
  5578                 88  CHECK-NO-MANUAL            VALUE '1'.
  5579                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5580                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5581                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5582             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5583                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5584
  5585         16  CF-DOMICILE-STATE              PIC XX.
  5586
  5587         16  CF-EXPENSE-CONTROLS.
  5588             20  CF-EXPENSE-METHOD          PIC X.
  5589                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5590                 88  DOLLARS-PER-PMT            VALUE '2'.
  5591                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5592                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5593             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5594             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5595
  5596         16  CF-CORRESPONDENCE-CONTROL.
  5597             20  CF-LETTER-RESEND-OPT       PIC X.
  5598                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5599                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5600             20  FILLER                     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 101
* EL131.cbl
  5601
  5602         16  CF-RESERVE-CONTROLS.
  5603             20  CF-MANUAL-SW               PIC X.
  5604                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5605             20  CF-FUTURE-SW               PIC X.
  5606                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5607             20  CF-PTC-SW                  PIC X.
  5608                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5609             20  CF-IBNR-SW                 PIC X.
  5610                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5611             20  CF-PTC-LF-SW               PIC X.
  5612                 88  CF-LF-PTC-USED             VALUE '1'.
  5613             20  CF-CDT-ACCESS-METHOD       PIC X.
  5614                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5615                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5616                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5617             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5618
  5619         16  CF-CLAIM-CALC-METHOD           PIC X.
  5620             88  360-PLUS-MONTHS                VALUE '1'.
  5621             88  365-PLUS-MONTHS                VALUE '2'.
  5622             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5623             88  360-DAILY                      VALUE '4'.
  5624             88  365-DAILY                      VALUE '5'.
  5625
  5626         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5627         16  FILLER                         PIC X(11).
  5628
  5629         16  CF-LIMIT-AMOUNTS.
  5630             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5631             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5632             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5633             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5634             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5635             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5636             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5637             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5638             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5639             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5640
  5641         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5642         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5643         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5644
  5645         16  CF-ZIP-CODE.
  5646             20  CF-ZIP-PRIME.
  5647                 24  CF-ZIP-1ST             PIC X.
  5648                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5649                 24  FILLER                 PIC X(4).
  5650             20  CF-ZIP-PLUS4               PIC X(4).
  5651         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5652             20  CF-CAN-POSTAL-1            PIC XXX.
  5653             20  CF-CAN-POSTAL-2            PIC XXX.
  5654             20  FILLER                     PIC XXX.
  5655
  5656         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5657         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5658         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 102
* EL131.cbl
  5659
  5660         16  CF-RATING-SWITCH               PIC X.
  5661             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5662             88  CF-NO-RATING                   VALUE 'N'.
  5663
  5664         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5665
  5666         16  CF-CARRIER-OVER-SHORT.
  5667             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5668             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5669
  5670         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5671         16  CF-SECPAY-SWITCH               PIC X.
  5672             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5673             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5674         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5675         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5676         16  FILLER                         PIC X(444).
  5677*        16  FILLER                         PIC X(452).
  5678
  5679
  5680****************************************************************
  5681*             MORTALITY MASTER RECORD                          *
  5682****************************************************************
  5683
  5684     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5685         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5686                                INDEXED BY CF-MORT-NDX.
  5687             20  CF-MORT-TABLE              PIC X(5).
  5688             20  CF-MORT-TABLE-TYPE         PIC X.
  5689                 88  CF-MORT-JOINT              VALUE 'J'.
  5690                 88  CF-MORT-SINGLE             VALUE 'S'.
  5691                 88  CF-MORT-COMBINED           VALUE 'C'.
  5692                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5693                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5694             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5695             20  CF-MORT-AGE-METHOD         PIC XX.
  5696                 88  CF-AGE-LAST                VALUE 'AL'.
  5697                 88  CF-AGE-NEAR                VALUE 'AN'.
  5698             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5699             20  CF-MORT-ADJUSTMENT-DIRECTION
  5700                                            PIC X.
  5701                 88  CF-MINUS                   VALUE '-'.
  5702                 88  CF-PLUS                    VALUE '+'.
  5703             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5704             20  CF-MORT-JOINT-CODE         PIC X.
  5705                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5706             20  CF-MORT-PC-Q               PIC X.
  5707                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5708             20  CF-MORT-TABLE-CODE         PIC X(4).
  5709             20  CF-MORT-COMMENTS           PIC X(15).
  5710             20  FILLER                     PIC X(14).
  5711
  5712         16  FILLER                         PIC X(251).
  5713
  5714
  5715****************************************************************
  5716*             BUSSINESS TYPE MASTER RECORD                     *
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 103
* EL131.cbl
  5717****************************************************************
  5718
  5719     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5720* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5721* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5722* AND RECORD 05 IS TYPES 81-99
  5723         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5724             20  CF-BUSINESS-TITLE          PIC  X(19).
  5725             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5726                                            PIC S9V9(4) COMP-3.
  5727             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5728             20  FILLER                     PIC  X.
  5729         16  FILLER                         PIC  X(248).
  5730
  5731
  5732****************************************************************
  5733*             TERMINAL MASTER RECORD                           *
  5734****************************************************************
  5735
  5736     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5737
  5738         16  CF-COMPANY-TERMINALS.
  5739             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5740                                  PIC X(4).
  5741         16  FILLER               PIC X(248).
  5742
  5743
  5744****************************************************************
  5745*             LIFE EDIT MASTER RECORD                          *
  5746****************************************************************
  5747
  5748     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5749         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5750             20  CF-LIFE-CODE-IN            PIC XX.
  5751             20  CF-LIFE-CODE-OUT           PIC XX.
  5752         16  FILLER                         PIC X(248).
  5753
  5754
  5755****************************************************************
  5756*             AH EDIT MASTER RECORD                            *
  5757****************************************************************
  5758
  5759     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5760         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5761             20  CF-AH-CODE-IN              PIC XXX.
  5762             20  CF-AH-CODE-OUT             PIC XX.
  5763         16  FILLER                         PIC X(248).
  5764
  5765
  5766****************************************************************
  5767*             CREDIBILITY TABLES                               *
  5768****************************************************************
  5769
  5770     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5771         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5772                             INDEXED BY CF-CRDB-NDX.
  5773             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5774             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 104
* EL131.cbl
  5775             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5776         16  FILLER                         PIC  X(332).
  5777
  5778
  5779****************************************************************
  5780*             REPORT CUSTOMIZATION RECORD                      *
  5781****************************************************************
  5782
  5783     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5784         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5785             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5786             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5787             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5788**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5789****       A T-TRANSFER.                                   ****
  5790             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5791
  5792         16  FILLER                         PIC XX.
  5793
  5794         16  CF-CARRIER-CNTL-OPT.
  5795             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5796                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5797                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5798             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5799                                            PIC X.
  5800         16  CF-GROUP-CNTL-OPT.
  5801             20  CF-GROUP-OPT-SEQ           PIC 9.
  5802                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5803                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5804             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5805                                            PIC X(6).
  5806         16  CF-STATE-CNTL-OPT.
  5807             20  CF-STATE-OPT-SEQ           PIC 9.
  5808                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5809                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5810             20  CF-STATE-SELECT OCCURS 3 TIMES
  5811                                            PIC XX.
  5812         16  CF-ACCOUNT-CNTL-OPT.
  5813             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5814                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5815                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5816             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5817                                            PIC X(10).
  5818         16  CF-BUS-TYP-CNTL-OPT.
  5819             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5820                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5821                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5822             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5823                                            PIC XX.
  5824         16  CF-LF-TYP-CNTL-OPT.
  5825             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5826                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5827                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5828             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5829                                            PIC XX.
  5830         16  CF-AH-TYP-CNTL-OPT.
  5831             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5832                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 105
* EL131.cbl
  5833                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5834             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5835                                            PIC XX.
  5836         16  CF-REPTCD1-CNTL-OPT.
  5837             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5838                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5839                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5840             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5841                                            PIC X(10).
  5842         16  CF-REPTCD2-CNTL-OPT.
  5843             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5844                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5845                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5846             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5847                                            PIC X(10).
  5848         16  CF-USER1-CNTL-OPT.
  5849             20  CF-USER1-OPT-SEQ           PIC 9.
  5850                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5851                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5852             20  CF-USER1-SELECT OCCURS 3 TIMES
  5853                                            PIC X(10).
  5854         16  CF-USER2-CNTL-OPT.
  5855             20  CF-USER2-OPT-SEQ           PIC 9.
  5856                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5857                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5858             20  CF-USER2-SELECT OCCURS 3 TIMES
  5859                                            PIC X(10).
  5860         16  CF-USER3-CNTL-OPT.
  5861             20  CF-USER3-OPT-SEQ           PIC 9.
  5862                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5863                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5864             20  CF-USER3-SELECT OCCURS 3 TIMES
  5865                                            PIC X(10).
  5866         16  CF-USER4-CNTL-OPT.
  5867             20  CF-USER4-OPT-SEQ           PIC 9.
  5868                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5869                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5870             20  CF-USER4-SELECT OCCURS 3 TIMES
  5871                                            PIC X(10).
  5872         16  CF-USER5-CNTL-OPT.
  5873             20  CF-USER5-OPT-SEQ           PIC 9.
  5874                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5875                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5876             20  CF-USER5-SELECT OCCURS 3 TIMES
  5877                                            PIC X(10).
  5878         16  CF-REINS-CNTL-OPT.
  5879             20  CF-REINS-OPT-SEQ           PIC 9.
  5880                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5881                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5882             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5883                 24  CF-REINS-PRIME         PIC XXX.
  5884                 24  CF-REINS-SUB           PIC XXX.
  5885
  5886         16  CF-AGENT-CNTL-OPT.
  5887             20  CF-AGENT-OPT-SEQ           PIC 9.
  5888                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5889                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5890             20  CF-AGENT-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 106
* EL131.cbl
  5891                                            PIC X(10).
  5892
  5893         16  FILLER                         PIC X(43).
  5894
  5895         16  CF-LOSS-RATIO-SELECT.
  5896             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5897             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5898         16  CF-ENTRY-DATE-SELECT.
  5899             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5900             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5901         16  CF-EFFECTIVE-DATE-SELECT.
  5902             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5903             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5904
  5905         16  CF-EXCEPTION-LIST-IND          PIC X.
  5906             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5907
  5908         16  FILLER                         PIC X(318).
  5909
  5910****************************************************************
  5911*                  EXCEPTION REPORTING RECORD                  *
  5912****************************************************************
  5913
  5914     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5915         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5916             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5917
  5918         16  CF-COMBINED-LIFE-AH-OPT.
  5919             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5920             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5921             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5922             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5923
  5924         16  CF-LIFE-OPT.
  5925             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5926             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5927             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5928             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5929             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5930             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5931             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5932             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5933             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5934             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5935
  5936         16  CF-AH-OPT.
  5937             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5938             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5939             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5940             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5941             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5942             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5943             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5944             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5945             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5946             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5947
  5948         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 107
* EL131.cbl
  5949             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5950             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5951             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5952
  5953         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5954
  5955         16  FILLER                         PIC X(673).
  5956
  5957
  5958****************************************************************
  5959*             MORTGAGE SYSTEM PLAN RECORD                      *
  5960****************************************************************
  5961
  5962     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5963         16  CF-PLAN-TYPE                   PIC X.
  5964             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5965             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5966             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5967         16  CF-PLAN-ABBREV                 PIC XXX.
  5968         16  CF-PLAN-DESCRIPT               PIC X(10).
  5969         16  CF-PLAN-NOTES                  PIC X(20).
  5970         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5971         16  CF-PLAN-UNDERWRITING.
  5972             20  CF-PLAN-TERM-DATA.
  5973                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5974                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5975             20  CF-PLAN-AGE-DATA.
  5976                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5977                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5978                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5979             20  CF-PLAN-BENEFIT-DATA.
  5980                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5981                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5982                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5983                                            PIC S9(7)V99  COMP-3.
  5984         16  CF-PLAN-POLICY-FORMS.
  5985             20  CF-POLICY-FORM             PIC X(12).
  5986             20  CF-MASTER-APPLICATION      PIC X(12).
  5987             20  CF-MASTER-POLICY           PIC X(12).
  5988         16  CF-PLAN-RATING.
  5989             20  CF-RATE-CODE               PIC X(5).
  5990             20  CF-SEX-RATING              PIC X.
  5991                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5992                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5993             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5994             20  CF-SUB-STD-TYPE            PIC X.
  5995                 88  CF-PCT-OF-PREM            VALUE '1'.
  5996                 88  CF-PCT-OF-BENE            VALUE '2'.
  5997         16  CF-PLAN-PREM-TOLERANCES.
  5998             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5999             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6000         16  CF-PLAN-PYMT-TOLERANCES.
  6001             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6002             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6003         16  CF-PLAN-MISC-DATA.
  6004             20  FILLER                     PIC X.
  6005             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6006             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 108
* EL131.cbl
  6007         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6008         16  CF-PLAN-IND-GRP                PIC X.
  6009             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6010                                                     '1'.
  6011             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6012                                                     '2'.
  6013         16  CF-MIB-SEARCH-SW               PIC X.
  6014             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6015             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6016             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6017             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6018         16  CF-ALPHA-SEARCH-SW             PIC X.
  6019             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6020             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6021             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6022             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6023             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6024             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6025             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6026             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6027             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6028             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6029                                                     'A' 'B' 'C'
  6030                                                     'X' 'Y' 'Z'.
  6031         16  CF-EFF-DT-RULE-SW              PIC X.
  6032             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6033             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6034             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6035             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6036             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6037         16  FILLER                         PIC X(4).
  6038         16  CF-HEALTH-QUESTIONS            PIC X.
  6039             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6040         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6041         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6042         16  CF-PLAN-SNGL-JNT               PIC X.
  6043             88  CF-COMBINED-PLAN              VALUE 'C'.
  6044             88  CF-JNT-PLAN                   VALUE 'J'.
  6045             88  CF-SNGL-PLAN                  VALUE 'S'.
  6046         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6047         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6048         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6049         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6050         16  CF-RERATE-CNTL                 PIC  X.
  6051             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6052             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6053             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6054             88  CF-AUTO-RECALC                 VALUE '4'.
  6055         16  CF-BENEFIT-TYPE                PIC  X.
  6056             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6057             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6058         16  CF-POLICY-FEE                  PIC S999V99
  6059                                                    COMP-3.
  6060         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6061         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6062         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6063         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6064         16  FILLER                         PIC  X(32).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 109
* EL131.cbl
  6065         16  CF-TERMINATION-FORM            PIC  X(04).
  6066         16  FILLER                         PIC  X(08).
  6067         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6068                                                       COMP-3.
  6069         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6070         16  CF-ISSUE-LETTER                PIC  X(4).
  6071         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6072         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6073             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6074             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6075         16  CF-MP-REFUND-CALC              PIC X.
  6076             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6077             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6078             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6079             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6080             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6081             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6082             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6083             88  CF-MP-REFD-MEAN                VALUE '8'.
  6084         16  CF-ALT-RATE-CODE               PIC  X(5).
  6085
  6086
  6087         16  FILLER                         PIC X(498).
  6088****************************************************************
  6089*             MORTGAGE COMPANY MASTER RECORD                   *
  6090****************************************************************
  6091
  6092     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6093         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6094         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6095             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6096             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6097             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6098             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6099             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6100
  6101         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6102         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6103         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6104         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6105         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6106
  6107         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6108             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6109         16  CF-MP-RECON-USE-IND            PIC X(1).
  6110             88  CF-MP-USE-RECON             VALUE 'Y'.
  6111         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6112             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6113         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6114             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6115             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6116         16  FILLER                         PIC X(1).
  6117         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6118             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6119         16  CF-MORTG-MIB-VERSION           PIC X.
  6120             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6121             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6122             88  CF-MORTG-MIB-BOTH          VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 110
* EL131.cbl
  6123         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6124             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6125                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6126             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6127                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6128             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6129                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6130             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6131                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6132             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6133                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6134             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6135                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6136         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6137         16  FILLER                         PIC X(7).
  6138         16  CF-MORTG-DESTINATION-SYMBOL.
  6139             20  CF-MORTG-MIB-COMM          PIC X(5).
  6140             20  CF-MORTG-MIB-TERM          PIC X(5).
  6141         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6142             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6143         16  FILLER                         PIC X(03).
  6144         16  CF-MP-CHECK-NO-CONTROL.
  6145             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6146                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6147                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6148                                                ' ' LOW-VALUES.
  6149                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6150                                               VALUE '3'.
  6151         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6152         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6153         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6154             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6155                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6156             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6157                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6158             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6159                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6160             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6161                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6162             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6163                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6164             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6165                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6166         16  CF-MORTG-BILLING-AREA.
  6167             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6168                                            PIC X.
  6169         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6170         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6171         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6172         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6173             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6174             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6175         16  FILLER                         PIC X.
  6176         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6177             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6178             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6179         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6180         16  FILLER                         PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 111
* EL131.cbl
  6181         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6182         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6183         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6184         16  CF-ACH-COMPANY-ID.
  6185             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6186                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6187                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6188                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6189             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6190         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6191             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6192         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6193             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6194             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6195         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6196         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6197         16  FILLER                         PIC X(536).
  6198
  6199****************************************************************
  6200*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6201****************************************************************
  6202
  6203     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6204         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6205             20  CF-FEMALE-HEIGHT.
  6206                 24  CF-FEMALE-FT           PIC 99.
  6207                 24  CF-FEMALE-IN           PIC 99.
  6208             20  CF-FEMALE-MIN-WT           PIC 999.
  6209             20  CF-FEMALE-MAX-WT           PIC 999.
  6210         16  FILLER                         PIC X(428).
  6211
  6212     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6213         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6214             20  CF-MALE-HEIGHT.
  6215                 24  CF-MALE-FT             PIC 99.
  6216                 24  CF-MALE-IN             PIC 99.
  6217             20  CF-MALE-MIN-WT             PIC 999.
  6218             20  CF-MALE-MAX-WT             PIC 999.
  6219         16  FILLER                         PIC X(428).
  6220******************************************************************
  6221*             AUTOMATIC ACTIVITY RECORD                          *
  6222******************************************************************
  6223     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6224         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6225             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6226             20  CF-SYS-LETTER-ID           PIC X(04).
  6227             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6228             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6229             20  CF-SYS-RESET-SW            PIC X(01).
  6230             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6231             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6232
  6233         16  FILLER                         PIC X(50).
  6234
  6235         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6236             20  CF-USER-ACTIVE-SW          PIC X(01).
  6237             20  CF-USER-LETTER-ID          PIC X(04).
  6238             20  CF-USER-RESEND-DAYS        PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 112
* EL131.cbl
  6239             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6240             20  CF-USER-RESET-SW           PIC X(01).
  6241             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6242             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6243             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6244
  6245         16  FILLER                         PIC X(246).
  6246
  6247*                                COPY ELCACTQ.
  6248******************************************************************
  6249*                                                                *
  6250*                            ELCACTQ.                            *
  6251*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6252*                            VMOD=2.004                          *
  6253*                                                                *
  6254*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6255*                                                                *
  6256*   FILE TYPE = VSAM,KSDS                                        *
  6257*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6258*                                                                *
  6259*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6260*       ALTERNATE INDEX = NONE                                   *
  6261*                                                                *
  6262*   LOG = YES                                                    *
  6263*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6264*                                                                *
  6265*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6266******************************************************************
  6267
  6268 01  ACTIVITY-QUE.
  6269     12  AQ-RECORD-ID                PIC XX.
  6270         88  VALID-AQ-ID                VALUE 'AQ'.
  6271
  6272     12  AQ-CONTROL-PRIMARY.
  6273         16  AQ-COMPANY-CD           PIC X.
  6274         16  AQ-CARRIER              PIC X.
  6275         16  AQ-CLAIM-NO             PIC X(7).
  6276         16  AQ-CERT-NO.
  6277             20  AQ-CERT-PRIME       PIC X(10).
  6278             20  AQ-CERT-SFX         PIC X.
  6279
  6280     12  AQ-PENDING-ACTIVITY-FLAGS.
  6281         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6282         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6283             88  PENDING-PAYMENTS       VALUE '1'.
  6284         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6285             88  PENDING-FULL-PRINT     VALUE '1'.
  6286             88  PENDING-PART-PRINT     VALUE '2'.
  6287         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6288             88  PENDING-LETTERS        VALUE '1'.
  6289         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6290             88  PENDING-RESTORE        VALUE 'C'.
  6291             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6292
  6293     12  FILLER                      PIC X(20).
  6294
  6295     12  AQ-RESEND-DATE              PIC XX.
  6296     12  AQ-FOLLOWUP-DATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 113
* EL131.cbl
  6297     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6298     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6299     12  AQ-AUTO-LETTER              PIC X(4).
  6300     12  FILLER                      PIC XX.
  6301     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6302*****************************************************************
  6303
  6304*                                COPY ERCACCT.
  6305******************************************************************
  6306*                                                                *
  6307*                                                                *
  6308*                            ERCACCT                             *
  6309*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6310*                            VMOD=2.031                          *
  6311*                                                                *
  6312*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6313*                                                                *
  6314*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6315*   VSAM ACCOUNT MASTER FILES.                                   *
  6316*                                                                *
  6317*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6318*                                                                *
  6319*   FILE TYPE = VSAM,KSDS                                        *
  6320*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6321*                                                                *
  6322*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6323*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6324*                                                                *
  6325*   LOG = NO                                                     *
  6326*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6327*                                                                *
  6328*                                                                *
  6329******************************************************************
  6330*                   C H A N G E   L O G
  6331*
  6332* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6333*-----------------------------------------------------------------
  6334*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6335* EFFECTIVE    NUMBER
  6336*-----------------------------------------------------------------
  6337* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6338* 092705    2005050300006  PEMA  ADD SPP LEASES
  6339* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6340* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6341* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6342* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6343* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6344* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6345******************************************************************
  6346
  6347 01  ACCOUNT-MASTER.
  6348     12  AM-RECORD-ID                      PIC XX.
  6349         88  VALID-AM-ID                      VALUE 'AM'.
  6350
  6351     12  AM-CONTROL-PRIMARY.
  6352         16  AM-COMPANY-CD                 PIC X.
  6353         16  AM-MSTR-CNTRL.
  6354             20  AM-CONTROL-A.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 114
* EL131.cbl
  6355                 24  AM-CARRIER            PIC X.
  6356                 24  AM-GROUPING.
  6357                     28 AM-GROUPING-PREFIX PIC XXX.
  6358                     28 AM-GROUPING-PRIME  PIC XXX.
  6359                 24  AM-STATE              PIC XX.
  6360                 24  AM-ACCOUNT.
  6361                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6362                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6363             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6364                                           PIC X(19).
  6365             20  AM-CNTRL-B.
  6366                 24  AM-EXPIRATION-DT      PIC XX.
  6367                 24  FILLER                PIC X(4).
  6368             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6369                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6370
  6371     12  AM-CONTROL-BY-VAR-GRP.
  6372         16  AM-COMPANY-CD-A1              PIC X.
  6373         16  AM-VG-CARRIER                 PIC X.
  6374         16  AM-VG-GROUPING                PIC X(6).
  6375         16  AM-VG-STATE                   PIC XX.
  6376         16  AM-VG-ACCOUNT                 PIC X(10).
  6377         16  AM-VG-DATE.
  6378             20  AM-VG-EXPIRATION-DT       PIC XX.
  6379             20  FILLER                    PIC X(4).
  6380         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6381                                           PIC 9(11)      COMP-3.
  6382     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6383         16  FILLER                        PIC X(10).
  6384         16  AM-VG-KEY3.
  6385             20  AM-VG3-ACCOUNT            PIC X(10).
  6386             20  AM-VG3-EXP-DT             PIC XX.
  6387         16  FILLER                        PIC X(4).
  6388     12  AM-MAINT-INFORMATION.
  6389         16  AM-LAST-MAINT-DT              PIC XX.
  6390         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6391         16  AM-LAST-MAINT-USER            PIC X(4).
  6392         16  FILLER                        PIC XX.
  6393
  6394     12  AM-EFFECTIVE-DT                   PIC XX.
  6395     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6396
  6397     12  AM-PREV-DATES  COMP-3.
  6398         16  AM-PREV-EXP-DT                PIC 9(11).
  6399         16  AM-PREV-EFF-DT                PIC 9(11).
  6400
  6401     12  AM-REPORT-CODE-1                  PIC X(10).
  6402     12  AM-REPORT-CODE-2                  PIC X(10).
  6403
  6404     12  AM-CITY-CODE                      PIC X(4).
  6405     12  AM-COUNTY-PARISH                  PIC X(6).
  6406
  6407     12  AM-NAME                           PIC X(30).
  6408     12  AM-PERSON                         PIC X(30).
  6409     12  AM-ADDRS                          PIC X(30).
  6410     12  AM-CITY.
  6411         16  AM-ADDR-CITY                  PIC X(28).
  6412         16  AM-ADDR-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 115
* EL131.cbl
  6413     12  AM-ZIP.
  6414         16  AM-ZIP-PRIME.
  6415             20  AM-ZIP-PRI-1ST            PIC X.
  6416                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6417             20  FILLER                    PIC X(4).
  6418         16  AM-ZIP-PLUS4                  PIC X(4).
  6419     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6420         16  AM-CAN-POSTAL-1               PIC XXX.
  6421         16  AM-CAN-POSTAL-2               PIC XXX.
  6422         16  FILLER                        PIC XXX.
  6423     12  AM-TEL-NO.
  6424         16  AM-AREA-CODE                  PIC 999.
  6425         16  AM-TEL-PRE                    PIC 999.
  6426         16  AM-TEL-NBR                    PIC 9(4).
  6427     12  AM-TEL-LOC                        PIC X.
  6428         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6429         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6430
  6431     12  AM-COMM-STRUCTURE.
  6432         16  AM-DEFN-1.
  6433             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6434                 24  AM-AGT.
  6435                     28  AM-AGT-PREFIX     PIC X(4).
  6436                     28  AM-AGT-PRIME      PIC X(6).
  6437                 24  AM-COM-TYP            PIC X.
  6438                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6439                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6440                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6441                 24  AM-RECALC-LV-INDIC    PIC X.
  6442                 24  AM-RETRO-LV-INDIC     PIC X.
  6443                 24  AM-GL-CODES           PIC X.
  6444                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6445                 24  FILLER                PIC X(01).
  6446         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6447             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6448                 24  FILLER                PIC X(11).
  6449                 24  AM-L-COMA             PIC XXX.
  6450                 24  AM-J-COMA             PIC XXX.
  6451                 24  AM-A-COMA             PIC XXX.
  6452                 24  FILLER                PIC X(6).
  6453
  6454     12  AM-COMM-CHANGE-STATUS             PIC X.
  6455         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6456
  6457     12  AM-CSR-CODE                       PIC X(4).
  6458
  6459     12  AM-BILLING-STATUS                 PIC X.
  6460         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6461         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6462     12  AM-AUTO-REFUND-SW                 PIC X.
  6463         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6464         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6465     12  AM-GPCD                           PIC 99.
  6466     12  AM-IG                             PIC X.
  6467         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6468         88  AM-HAS-GROUP                     VALUE '2'.
  6469     12  AM-STATUS                         PIC X.
  6470         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 116
* EL131.cbl
  6471         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6472         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6473         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6474         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6475         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6476         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6477         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  6478         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6479         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6480     12  AM-REMIT-TO                       PIC 99.
  6481     12  AM-ID-NO                          PIC X(11).
  6482
  6483     12  AM-CAL-TABLE                      PIC XX.
  6484     12  AM-LF-DEVIATION                   PIC XXX.
  6485     12  AM-AH-DEVIATION                   PIC XXX.
  6486     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6487     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6488     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6489     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6490     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6491     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6492
  6493     12  AM-USER-FIELDS.
  6494         16  AM-FLD-1                      PIC XX.
  6495         16  AM-FLD-2                      PIC XX.
  6496         16  AM-FLD-3                      PIC XX.
  6497         16  AM-FLD-4                      PIC XX.
  6498         16  AM-FLD-5                      PIC XX.
  6499
  6500     12  AM-1ST-PROD-DATE.
  6501         16  AM-1ST-PROD-YR                PIC XX.
  6502         16  AM-1ST-PROD-MO                PIC XX.
  6503         16  AM-1ST-PROD-DA                PIC XX.
  6504     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6505     12  AM-CERTS-PURGED-DATE.
  6506         16  AM-PUR-YR                     PIC XX.
  6507         16  AM-PUR-MO                     PIC XX.
  6508         16  AM-PUR-DA                     PIC XX.
  6509     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6510     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6511     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6512     12  AM-INACTIVE-DATE.
  6513         16  AM-INA-MO                     PIC 99.
  6514         16  AM-INA-DA                     PIC 99.
  6515         16  AM-INA-YR                     PIC 99.
  6516     12  AM-AR-HI-CERT-DATE                PIC XX.
  6517
  6518     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6519     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6520
  6521     12  AM-OB-PAYMENT-MODE                PIC X.
  6522         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6523         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6524         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6525         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6526
  6527     12  AM-AH-ONLY-INDICATOR              PIC X.
  6528         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 117
* EL131.cbl
  6529         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6530
  6531     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6532
  6533     12  AM-OVER-SHORT.
  6534         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6535         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6536
  6537     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6538     12  AM-DCC-CLP-STATE                  PIC XX.
  6539
  6540     12  AM-RECALC-COMM                    PIC X.
  6541     12  AM-RECALC-REIN                    PIC X.
  6542
  6543     12  AM-REI-TABLE                      PIC XXX.
  6544     12  AM-REI-ET-LF                      PIC X.
  6545     12  AM-REI-ET-AH                      PIC X.
  6546     12  AM-REI-PE-LF                      PIC X.
  6547     12  AM-REI-PE-AH                      PIC X.
  6548     12  AM-REI-PRT-ST                     PIC X.
  6549     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6550     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6551     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6552     12  AM-REI-GROUP-A                    PIC X(6).
  6553     12  AM-REI-MORT                       PIC X(4).
  6554     12  AM-REI-PRT-OW                     PIC X.
  6555     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6556     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6557     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6558     12  AM-REI-GROUP-B                    PIC X(6).
  6559
  6560     12  AM-TRUST-TYPE                     PIC X(2).
  6561
  6562     12  AM-EMPLOYER-STMT-USED             PIC X.
  6563     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6564
  6565     12  AM-STD-AH-TYPE                    PIC XX.
  6566     12  AM-EARN-METHODS.
  6567         16  AM-EARN-METHOD-R              PIC X.
  6568             88 AM-REF-RL-R78                 VALUE 'R'.
  6569             88 AM-REF-RL-PR                  VALUE 'P'.
  6570             88 AM-REF-RL-MEAN                VALUE 'M'.
  6571             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6572         16  AM-EARN-METHOD-L              PIC X.
  6573             88 AM-REF-LL-R78                 VALUE 'R'.
  6574             88 AM-REF-LL-PR                  VALUE 'P'.
  6575             88 AM-REF-LL-MEAN                VALUE 'M'.
  6576             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6577         16  AM-EARN-METHOD-A              PIC X.
  6578             88 AM-REF-AH-R78                 VALUE 'R'.
  6579             88 AM-REF-AH-PR                  VALUE 'P'.
  6580             88 AM-REF-AH-MEAN                VALUE 'M'.
  6581             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6582             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6583             88 AM-REF-AH-NET                 VALUE 'N'.
  6584
  6585     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6586     12  AM-TOL-REF                        PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 118
* EL131.cbl
  6587     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6588
  6589     12  AM-RET-Y-N                        PIC X.
  6590     12  AM-RET-P-E                        PIC X.
  6591     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6592     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6593     12  AM-RET-GRP                        PIC X(6).
  6594     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6595         16  AM-POOL-PRIME                 PIC XXX.
  6596         16  AM-POOL-SUB                   PIC XXX.
  6597     12  AM-RETRO-EARNINGS.
  6598         16  AM-RET-EARN-R                 PIC X.
  6599         16  AM-RET-EARN-L                 PIC X.
  6600         16  AM-RET-EARN-A                 PIC X.
  6601     12  AM-RET-ST-TAX-USE                 PIC X.
  6602         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6603         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6604     12  AM-RETRO-BEG-EARNINGS.
  6605         16  AM-RET-BEG-EARN-R             PIC X.
  6606         16  AM-RET-BEG-EARN-L             PIC X.
  6607         16  AM-RET-BEG-EARN-A             PIC X.
  6608     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6609     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6610
  6611     12  AM-USER-SELECT-OPTIONS.
  6612         16  AM-USER-SELECT-1              PIC X(10).
  6613         16  AM-USER-SELECT-2              PIC X(10).
  6614         16  AM-USER-SELECT-3              PIC X(10).
  6615         16  AM-USER-SELECT-4              PIC X(10).
  6616         16  AM-USER-SELECT-5              PIC X(10).
  6617
  6618     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6619
  6620     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6621
  6622     12  AM-RPT045A-SWITCH                 PIC X.
  6623         88  RPT045A-OFF                   VALUE 'N'.
  6624
  6625     12  AM-INSURANCE-LIMITS.
  6626         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6627         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6628
  6629     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6630         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6631
  6632     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6633         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6634         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6635
  6636     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6637
  6638     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6639     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6640     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6641     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6642     12  AM-DCC-UEF-STATE                  PIC XX.
  6643     12  FILLER                            PIC XXX.
  6644     12  AM-REPORT-CODE-3                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 119
* EL131.cbl
  6645*    12  FILLER                            PIC X(22).
  6646
  6647     12  AM-RESERVE-DATE.
  6648         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6649         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6650         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6651
  6652     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6653     12  AM-NOTIFICATION-TYPES.
  6654         16  AM-NOTIF-OF-LETTERS           PIC X.
  6655         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6656         16  AM-NOTIF-OF-REPORTS           PIC X.
  6657         16  AM-NOTIF-OF-STATUS            PIC X.
  6658
  6659     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6660         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6661         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6662         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6663         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6664
  6665     12  AM-BENEFIT-CONTROLS.
  6666         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6667             20  AM-BENEFIT-CODE           PIC XX.
  6668             20  AM-BENEFIT-TYPE           PIC X.
  6669             20  AM-BENEFIT-REVISION       PIC XXX.
  6670             20  AM-BENEFIT-REM-TERM       PIC X.
  6671             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6672             20  FILLER                    PIC XX.
  6673         16  FILLER                        PIC X(80).
  6674
  6675     12  AM-TRANSFER-DATA.
  6676         16  AM-TRANSFERRED-FROM.
  6677             20  AM-TRNFROM-CARRIER        PIC X.
  6678             20  AM-TRNFROM-GROUPING.
  6679                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6680                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6681             20  AM-TRNFROM-STATE          PIC XX.
  6682             20  AM-TRNFROM-ACCOUNT.
  6683                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6684                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6685             20  AM-TRNFROM-DTE            PIC XX.
  6686         16  AM-TRANSFERRED-TO.
  6687             20  AM-TRNTO-CARRIER          PIC X.
  6688             20  AM-TRNTO-GROUPING.
  6689                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6690                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6691             20  AM-TRNTO-STATE            PIC XX.
  6692             20  AM-TRNTO-ACCOUNT.
  6693                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6694                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6695             20  AM-TRNTO-DTE              PIC XX.
  6696         16  FILLER                        PIC X(10).
  6697
  6698     12  AM-SAVED-REMIT-TO                 PIC 99.
  6699
  6700     12  AM-COMM-STRUCTURE-SAVED.
  6701         16  AM-DEFN-1-SAVED.
  6702             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 120
* EL131.cbl
  6703                 24  AM-AGT-SV             PIC X(10).
  6704                 24  AM-COM-TYP-SV         PIC X.
  6705                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6706                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6707                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6708                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6709                 24  FILLER                PIC X.
  6710                 24  AM-GL-CODES-SV        PIC X.
  6711                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6712                 24  FILLER                PIC X.
  6713         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6714             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6715                 24  FILLER                PIC X(11).
  6716                 24  AM-L-COMA-SV          PIC XXX.
  6717                 24  AM-J-COMA-SV          PIC XXX.
  6718                 24  AM-A-COMA-SV          PIC XXX.
  6719                 24  FILLER                PIC X(6).
  6720
  6721     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6722         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6723            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6724            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6725            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6726
  6727     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6728     12  FILLER                            PIC X(120).
  6729
  6730     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6731         16  AM-CONTROL-NAME               PIC X(30).
  6732         16  AM-EXECUTIVE-ONE.
  6733             20  AM-EXEC1-NAME             PIC X(15).
  6734             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6735                                                          COMP-3.
  6736             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6737                                                          COMP-3.
  6738         16  AM-EXECUTIVE-TWO.
  6739             20  AM-EXEC2-NAME             PIC X(15).
  6740             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6741                                                          COMP-3.
  6742             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6743                                                          COMP-3.
  6744
  6745     12  AM-RETRO-ADDITIONAL-DATA.
  6746         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6747         16  AM-RETRO-PREM-P-E             PIC X.
  6748         16  AM-RETRO-CLMS-P-I             PIC X.
  6749         16  AM-RETRO-RET-BRACKET-LF.
  6750             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6751                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6752                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6753             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6754                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6755                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6756             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6757                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6758                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6759         16  AM-RETRO-RET-BRACKET-AH.
  6760             20  AM-RETRO-RET-METHOD-AH    PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 121
* EL131.cbl
  6761                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6762                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6763                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6764             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6765                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6766                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6767             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6768                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6769                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6770
  6771     12  AM-COMMENTS.
  6772         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6773
  6774     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6775         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6776         16  AM-FLI-BILLING-CODE           PIC X.
  6777         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6778         16  AM-FLI-UNITED-IDENT           PIC X.
  6779         16  AM-FLI-INTEREST-LOST-DATA.
  6780             20  AM-FLI-BANK-NO            PIC X(5).
  6781             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6782             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6783             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6784         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6785             20  AM-FLI-AGT                PIC X(9).
  6786             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6787             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6788         16  FILLER                        PIC X(102).
  6789
  6790     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6791         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6792             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6793             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6794             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6795             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6796             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6797         16  FILLER                          PIC X(10).
  6798******************************************************************
  6799
  6800*                                COPY ELCCHKQ.
  6801******************************************************************
  6802*                                                                *
  6803*                                                                *
  6804*                            ELCCHKQ.                            *
  6805*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6806*                            VMOD=2.007                          *
  6807*                                                                *
  6808*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6809*                                                                *
  6810*   FILE TYPE = VSAM,KSDS                                        *
  6811*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6812*                                                                *
  6813*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6814*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6815*                                                                *
  6816*   LOG = YES                                                    *
  6817*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6818******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 122
* EL131.cbl
  6819 01  CHECK-QUE.
  6820     12  CQ-RECORD-ID                PIC XX.
  6821         88  VALID-CQ-ID         VALUE 'CQ'.
  6822
  6823     12  CQ-CONTROL-PRIMARY.
  6824         16  CQ-COMPANY-CD           PIC X.
  6825         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6826         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6827
  6828     12  CQ-CONTROL-BY-PAYEE.
  6829         16  CQ-CONTROL-BY-NUMBER.
  6830             20  CQ-COMPANY-CD-A1     PIC X.
  6831             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6832         16  CQ-PAYEE-CARRIER        PIC X.
  6833         16  CQ-PAYEE-GROUPING       PIC X(6).
  6834         16  CQ-PAYEE-STATE          PIC XX.
  6835         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6836         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6837
  6838     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6839         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6840         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6841         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6842         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6843         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6844         16  FILLER                  PIC X(3).
  6845
  6846     12  CQ-ENTRY-TYPE               PIC X.
  6847             88  CHECK-ON-QUE           VALUE 'Q'.
  6848             88  ALIGNMENT-CHECK        VALUE 'A'.
  6849             88  SPOILED-CHECK          VALUE 'S'.
  6850             88  PAYMENT-ABORTED        VALUE 'X'.
  6851
  6852     12  CQ-CLAIM-MAST-CNTL.
  6853         16  CQ-CARRIER              PIC X.
  6854         16  CQ-CLAIM-NO             PIC X(7).
  6855         16  CQ-CERT-NO.
  6856             20  CQ-CERT-PRIME       PIC X(10).
  6857             20  CQ-CERT-SFX         PIC X.
  6858         16  CQ-CLAIM-TYPE           PIC X.
  6859             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6860             88  CQ-AH-CLAIM            VALUE 'A'.
  6861         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6862             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6863             88  CQ-O-B-COVERAGE        VALUE '2'.
  6864             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6865
  6866     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6867     12  CQ-CHECK-NUMBER             PIC X(7).
  6868     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6869     12  CQ-PAYMENT-TYPE             PIC X.
  6870             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6871             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6872             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6873             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6874             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6875             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6876             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 123
* EL131.cbl
  6877             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6878     12  CQ-VOID-INDICATOR           PIC X.
  6879             88  CHECK-IS-STOPPED          VALUE 'S'.
  6880             88  CHECK-IS-VOID             VALUE 'V'.
  6881     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6882     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6883     12  CQ-CHECK-BY-USER            PIC X(4).
  6884     12  CQ-PRE-NUMBERING-SW         PIC X.
  6885       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6886       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6887
  6888     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6889     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6890     12  CQ-LEDGER-FLAG              PIC X(01).
  6891     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6892     12  CQ-LAST-UPDATED-DT          PIC XX.
  6893     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6894     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6895
  6896     12  FILLER                      PIC X(04).
  6897
  6898******************************************************************
  6899
  6900*                                COPY ELCARCH.
  6901******************************************************************
  6902*                                                                *
  6903*                            ELCARCH.                            *
  6904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6905*                            VMOD=2.007                          *
  6906*                                                                *
  6907*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6908*                                                                *
  6909*   FILE TYPE = VSAM,KSDS                                        *
  6910*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6911*                                                                *
  6912*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6913*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6914*                                                                *
  6915*   LOG = NO                                                     *
  6916*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6917*                                                                *
  6918*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6919******************************************************************
  6920 01  LETTER-ARCHIVE.
  6921     12  LA-RECORD-ID                PIC XX.
  6922         88  VALID-LA-ID                VALUE 'LA'.
  6923
  6924     12  LA-CONTROL-PRIMARY.
  6925         16  LA-COMPANY-CD           PIC X.
  6926         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6927         16  LA-RECORD-TYPE          PIC X.
  6928             88  LA-HEADER-DATA         VALUE '1'.
  6929             88  LA-ADDRESS-DATA        VALUE '2'.
  6930             88  LA-TEXT-DATA           VALUE '3'.
  6931             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6932         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6933
  6934     12  LA-CONTROL-BY-TYPE.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 124
* EL131.cbl
  6935         16  LA-COMPANY-CD-A1        PIC X.
  6936         16  LA-RECORD-TYPE-A1       PIC X.
  6937         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6938         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6939
  6940     12  LA-TEXT-RECORD.
  6941         16  LA-SKIP-CONTROL         PIC XX.
  6942             88  NO-LINES-SKIPPED       VALUE SPACES.
  6943             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6944         16  LA-TEXT-LINE            PIC X(70).
  6945
  6946     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6947         16  FILLER                  PIC XX.
  6948         16  LA-ADDRESS-LINE         PIC X(30).
  6949         16  FILLER                  PIC X(40).
  6950
  6951     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6952         16  FILLER                  PIC XX.
  6953         16  LA-CARRIER              PIC X.
  6954         16  LA-CLAIM-NO             PIC X(7).
  6955         16  LA-CERT-NO.
  6956             20  LA-CERT-PRIME       PIC X(10).
  6957             20  LA-CERT-SFX         PIC X.
  6958         16  LA-NO-OF-COPIES         PIC S9.
  6959         16  LA-RESEND-DATE          PIC XX.
  6960         16  LA-PROCESSOR-CD         PIC X(4).
  6961         16  LA-CREATION-DT          PIC XX.
  6962         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6963         16  LA-RESEND-PRINT-DATE    PIC XX.
  6964         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6965         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6966*
  6967* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6968*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6969*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6970*   I        20  LA-DMD-RES-ST           PIC XX.
  6971*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6972*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6973*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6974*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6975*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6976*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6977*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6978*   I        20  LA-DMD-UND-CODE         PIC XX.
  6979*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6980*   V    16  FILLER                  PIC X(15).
  6981* -----
  6982*
  6983* REINSERTED  CSO  MODS
  6984*
  6985         16  FILLER.
  6986             20  FILLER                  PIC X(29).
  6987             20  LA-CSO-LETTER-STATUS    PIC X.
  6988                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6989                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6990                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6991             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6992             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 125
* EL131.cbl
  6993*
  6994
  6995     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6996         16  FILLER                  PIC XX.
  6997         16  LA4-CARRIER             PIC X.
  6998         16  LA4-CLAIM-NO            PIC X(7).
  6999         16  LA4-CERT-NO.
  7000             20  LA4-CERT-PRIME      PIC X(10).
  7001             20  LA4-CERT-SFX        PIC X.
  7002         16  LA4-NO-OF-COPIES        PIC S9.
  7003         16  LA4-RESEND-DATE         PIC XX.
  7004         16  LA4-PROCESSOR-CD        PIC X(4).
  7005         16  LA4-CREATION-DT         PIC XX.
  7006         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7007         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7008         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7009         16  LA4-FORM-TYPE           PIC X.
  7010             88  LA4-INITIAL-FORM    VALUE '1'.
  7011             88  LA4-PROGRESS-FORM   VALUE '2'.
  7012         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7013         16  LA4-STATE               PIC X(02).
  7014         16  FILLER                  PIC X(31).
  7015******************************************************************
  7016
  7017*                                COPY ELCBENE.
  7018******************************************************************
  7019*                                                                *
  7020*                            ELCBENE.                            *
  7021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7022*                            VMOD=2.006                          *
  7023*                                                                *
  7024*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7025*                                                                *
  7026*   FILE TYPE = VSAM,KSDS                                        *
  7027*   RECORD SIZE = 500   RECFORM = FIX                            *
  7028*                                                                *
  7029*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7030*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7031*                                                                *
  7032*   LOG = YES                                                    *
  7033*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7034*                                                                *
  7035*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7036******************************************************************
  7037*                   C H A N G E   L O G
  7038*
  7039* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7040*-----------------------------------------------------------------
  7041*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7042* EFFECTIVE    NUMBER
  7043*-----------------------------------------------------------------
  7044* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7045* 082317  CR2017082100003  PEMA  Add sub type
  7046******************************************************************
  7047
  7048 01  BENEFICIARY-MASTER.
  7049     12  BE-RECORD-ID                PIC XX.
  7050         88  VALID-BE-ID                VALUE 'BE'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 126
* EL131.cbl
  7051
  7052     12  BE-CONTROL-PRIMARY.
  7053         16  BE-COMPANY-CD           PIC X.
  7054         16  BE-RECORD-TYPE          PIC X.
  7055             88  BENEFICIARY-RECORD  VALUE 'B'.
  7056             88  ADJUSTOR-RECORD     VALUE 'A'.
  7057         16  BE-BENEFICIARY          PIC X(10).
  7058     12  BE-CONTROL-BY-NAME.
  7059         16  BE-COMPANY-CD-A1        PIC X.
  7060         16  BE-RECORD-TYPE-A1       PIC X.
  7061         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7062         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7063
  7064     12  BE-LAST-MAINT-DT            PIC XX.
  7065     12  BE-LAST-MAINT-BY            PIC X(4).
  7066     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7067
  7068     12  BE-ADDRESS-DATA.
  7069         16  BE-MAIL-TO-NAME         PIC X(30).
  7070         16  BE-ADDRESS-LINE-1       PIC X(30).
  7071         16  BE-ADDRESS-LINE-2       PIC X(30).
  7072         16  BE-ADDRESS-LINE-3       PIC X(30).
  7073         16  BE-CITY-STATE.
  7074             20  BE-CITY             PIC X(28).
  7075             20  BE-STATE            PIC XX.
  7076         16  BE-ZIP-CODE.
  7077             20  BE-ZIP-PRIME.
  7078                 24  BE-ZIP-1ST      PIC X.
  7079                     88  BE-CANADIAN-POST-CODE
  7080                                         VALUE 'A' THRU 'Z'.
  7081                 24  FILLER          PIC X(4).
  7082             20  BE-ZIP-PLUS4        PIC X(4).
  7083         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7084             20  BE-CAN-POSTAL-1     PIC XXX.
  7085             20  BE-CAN-POSTAL-2     PIC XXX.
  7086             20  FILLER              PIC XXX.
  7087         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7088         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7089
  7090******************************************************************
  7091*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7092*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7093******************************************************************
  7094     12  BE-CARRIER                  PIC X.
  7095
  7096     12  BE-ADDRESS-DATA2.
  7097         16  BE-MAIL-TO-NAME2        PIC X(30).
  7098         16  BE-ADDRESS-LINE-12      PIC X(30).
  7099         16  BE-ADDRESS-LINE-22      PIC X(30).
  7100         16  BE-ADDRESS-LINE-32      PIC X(30).
  7101         16  BE-CITY-STATE2.
  7102             20  BE-CITY2            PIC X(28).
  7103             20  BE-STATE2           PIC XX.
  7104         16  BE-ZIP-CODE2.
  7105             20  BE-ZIP-PRIME2.
  7106                 24  BE-ZIP-1ST2     PIC X.
  7107                     88  BE-CANADIAN-POST-CODE2
  7108                                         VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 127
* EL131.cbl
  7109                 24  FILLER          PIC X(4).
  7110             20  BE-ZIP-PLUS42       PIC X(4).
  7111         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7112             20  BE-CAN-POSTAL-12    PIC XXX.
  7113             20  BE-CAN-POSTAL-22    PIC XXX.
  7114             20  FILLER              PIC XXX.
  7115         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7116         16  BE-ACH-DATA.
  7117             20  BE-ACH-YES-OR-NO    PIC X.
  7118                 88  BE-ON-ACH       VALUE 'Y'.
  7119                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7120             20  BE-ACH-ABA-ROUTING-NUMBER
  7121                                     PIC X(15).
  7122             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7123                                     PIC X(20).
  7124             20  BE-ACH-SUB-TYPE     PIC XX.
  7125             20  FILLER              PIC X(23).
  7126         16  BE-BILLING-STMT-DATA.
  7127*            20  BE-BSR              PIC X.
  7128*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7129*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7130*            20  BE-BSR-FROM         PIC X(30).
  7131*            20  BE-BSR-DEPT         PIC X(30).
  7132             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7133             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7134             20  BE-OUTPUT-TYPE      PIC X.
  7135                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7136                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7137
  7138     12  FILLER                      PIC X(28).
  7139******************************************************************
  7140
  7141*                                COPY ELCDAR.
  7142******************************************************************
  7143*                                                                *
  7144*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7145*   FILE TYPE = VSAM,KSDS                                        *
  7146*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7147*   BASE CLUSTER = DLYACTV                                       *
  7148*   LOG = YES                                                    *
  7149*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7150*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7151*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7152*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7153*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7154*               BY PROGRAM "LGINFCE".                            *
  7155*                                                                *
  7156******************************************************************
  7157 01  DAILY-ACTIVITY-RECORD.
  7158     05  DA-KEY.
  7159         10  DA-COMP-CD          PIC X.
  7160         10  DA-CARRIER          PIC X.
  7161         10  DA-CLAIM-NO         PIC X(7).
  7162         10  DA-CERT-NO.
  7163             15  DA-CERT-PRIME   PIC X(10).
  7164             15  DA-CERT-SFX     PIC X.
  7165     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7166     05  DA-RECORD-TYPE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 128
* EL131.cbl
  7167     05  FILLER                  PIC X(2).
  7168******************************************************************
  7169
  7170*                                COPY ELCALPH.
  7171******************************************************************
  7172*                                                                *
  7173*                            ELCALPH.                            *
  7174*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7175*                            VMOD=2.003                          *
  7176*                                                                *
  7177*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7178*                                                                *
  7179*   FILE TYPE = VSAM,KSDS                                        *
  7180*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7181*                                                                *
  7182*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7183*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7184*                                                                *
  7185*   LOG = YES                                                    *
  7186*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7187*                                                                *
  7188*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7189******************************************************************
  7190
  7191 01  ALPHA-INDEX.
  7192     12  AI-RECORD-ID                         PIC XX.
  7193         88  VALID-AI-ID                  VALUE 'AI'.
  7194     12  AI-CONTROL-PRIMARY.
  7195         16  AI-COMPANY-CD                     PIC X.
  7196         16  AI-SOURCE                         PIC X.
  7197             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7198             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7199         16  AI-NAME.
  7200             20  AI-LAST-NAME                  PIC X(15).
  7201             20  AI-FIRST-NAME.
  7202                 24  AI-FIRST-INITIAL          PIC X.
  7203                 24  FILLER                    PIC X(11).
  7204             20  AI-MIDDLE-INIT                PIC X.
  7205         16  AI-DATE                           PIC X(8).
  7206         16  AI-TIME                           PIC S9(07) COMP-3.
  7207
  7208     12  AI-CONTROL-BY-ADMIN-KEY.
  7209         16  AI-CM-COMPANY-CD                  PIC X.
  7210         16  AI-CM-SOURCE                      PIC X.
  7211         16  AI-CM-CARRIER                     PIC X.
  7212         16  AI-CM-GROUPING.
  7213             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7214             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7215         16  AI-CM-STATE                       PIC XX.
  7216         16  AI-CM-PRODUCER.
  7217             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7218             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7219         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7220         16  AI-CM-CERTIFICATE-NUMBER.
  7221             20  AI-CM-CERT-PRIME              PIC X(10).
  7222             20  AI-CM-CERT-SFX                PIC X.
  7223         16  AI-CM-DATE                        PIC X(8).
  7224         16  AI-CM-TIME                        PIC S9(7) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 129
* EL131.cbl
  7225         16  FILLER                            PIC X(11).
  7226
  7227     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7228         AI-CONTROL-BY-ADMIN-KEY.
  7229         16  AI-CL-COMPANY-CD                  PIC X.
  7230         16  AI-CL-SOURCE                      PIC X.
  7231         16  AI-CL-CARRIER                     PIC X.
  7232         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7233         16  AI-CL-CERTIFICATE-NUMBER.
  7234             20  AI-CL-CERT-PRIME              PIC X(10).
  7235             20  AI-CL-CERT-SFX                PIC X.
  7236         16  AI-CL-DATE                        PIC X(8).
  7237         16  AI-CL-INCURRED-DATE               PIC XX.
  7238         16  AI-CL-CLOSE-DATE                  PIC XX.
  7239         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7240         16  AI-CREDIT-CARD-NUMBER.
  7241             20  AI-CCN.
  7242                 24  AI-CCN-PREFIX             PIC X(4).
  7243                 24  AI-CCN-PRIME              PIC X(12).
  7244             20  AI-CCN-FILLER                 PIC X(4).
  7245
  7246     12  AI-MAINT-INFO.
  7247         16  AI-LAST-MAINT-BY                  PIC X(4).
  7248         16  AI-LAST-MAINT-DT                  PIC XX.
  7249         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7250
  7251     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7252
  7253     12  FILLER                                PIC X(15).
  7254
  7255
  7256*                                COPY ERCDMDNT.
  7257******************************************************************
  7258*                                                                *
  7259*                            ERCDMDNT                            *
  7260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7261*                            VMOD=2.005                          *
  7262*                                                                *
  7263*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7264*                                                                *
  7265*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7266*                                                                *
  7267*        FILE TYPE= VSAM,KSDS                                    *
  7268*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7269*                                                                *
  7270*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7271*                                                                *
  7272*        LOG = YES                                               *
  7273*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7274*                                                                *
  7275******************************************************************
  7276
  7277 01  CERTIFICATE-NOTE.
  7278     12  CN-RECORD-ID                     PIC  XX.
  7279         88  VALID-CN-ID                      VALUE 'CN'.
  7280
  7281     12  CN-CONTROL-PRIMARY.
  7282         16  CN-COMPANY-CD                PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 130
* EL131.cbl
  7283         16  CN-CERT-KEY.
  7284             20  CN-CARRIER               PIC X.
  7285             20  CN-GROUPING.
  7286                 24  CN-GROUPING-PREFIX   PIC XXX.
  7287                 24  CN-GROUPING-PRIME    PIC XXX.
  7288             20  CN-STATE                 PIC XX.
  7289             20  CN-ACCOUNT.
  7290                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7291                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7292             20  CN-CERT-EFF-DT           PIC XX.
  7293             20  CN-CERT-NO.
  7294                 24  CN-CERT-PRIME        PIC X(10).
  7295                 24  CN-CERT-SFX          PIC X.
  7296
  7297     12  CN-BILLING-START-LINE-NO         PIC 99.
  7298     12  CN-BILLING-END-LINE-NO           PIC 99.
  7299
  7300     12  CN-LINES.
  7301         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7302
  7303     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7304         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7305         16  CN-CSI-GENERAL-DATA-AREA.
  7306             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7307
  7308         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7309             CN-CSI-GENERAL-DATA-AREA.
  7310             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7311             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7312             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7313             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7314             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7315             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7316             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7317             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7318             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7319             20  FILLER                       PIC XX.
  7320             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7321             20  FILLER                       PIC X(38).
  7322
  7323         16  CN-CSI-PRODUCT-DATA-AREA.
  7324             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7325
  7326         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7327             CN-CSI-PRODUCT-DATA-AREA.
  7328             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7329             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7330             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7331             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7332             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7333             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7334             20  FILLER                   PIC XX.
  7335             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7336             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7337             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7338             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7339             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7340             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 131
* EL131.cbl
  7341             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7342             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7343             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7344             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7345             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7346             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7347             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7348             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7349             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7350             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7351             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7352             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7353             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7354             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7355             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7356             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7357             20  FILLER                   PIC X(25).
  7358
  7359         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7360             CN-CSI-CREDIT-CARD-DATA.
  7361             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7362             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7363             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7364             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7365             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7366             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7367             20  FILLER                   PIC XX.
  7368             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7369             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7370             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7371             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7372             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7373             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7374             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7375             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7376             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7377             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7378             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7379             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7380             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7381             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7382             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7383             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7384             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7385             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7386             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7387             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7388             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7389             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7390             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7391             20  FILLER                   PIC X(17).
  7392
  7393         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7394             CN-CSI-FAMILY-LEAVE-DATA.
  7395             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7396             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7397             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7398             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 132
* EL131.cbl
  7399             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7400             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7401             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7402             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7403             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7404             20  CN-CSI-SL-INT-ON-PROCEEDS
  7405                                          PIC S9(5)V99  COMP-3.
  7406             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7407             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7408             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7409             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7410             20  CN-CSI-SL-POLICY-BENEFITS
  7411                                          PIC S9(5)V99  COMP-3.
  7412             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7413             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7414             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7415             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7416             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7417             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7418             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7419             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7420             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7421             20  CN-CSI-SL-STATE-NOT      PIC X.
  7422             20  FILLER                   PIC XX.
  7423
  7424         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7425             CN-CSI-SENIOR-LIFE-DATA.
  7426             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7427             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7428             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7429                                          PIC S9(5)V99  COMP-3.
  7430             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7431             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7432             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7433             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7434             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7435             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7436             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7437             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7438             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7439             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7440             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7441             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7442             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7443             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7444             20  CN-CSI-PP-REPAIR         PIC X.
  7445             20  CN-CSI-PP-REPLACE        PIC X.
  7446             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7447             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7448             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7449             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7450             20  FILLER                   PIC X(5).
  7451
  7452         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7453             CN-CSI-PURCH-PROP-DATA.
  7454             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7455             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7456             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 133
* EL131.cbl
  7457             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7458             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7459             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7460             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7461             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7462             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7463             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7464             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7465             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7466             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7467             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7468             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7469             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7470             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7471             20  CN-CSI-EW-REPLACE        PIC X.
  7472             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7473             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7474             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7475             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7476             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7477             20  FILLER                   PIC X(4).
  7478
  7479     12  CN-LAST-MAINT-DT                 PIC XX.
  7480     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7481     12  CN-LAST-MAINT-USER               PIC X(4).
  7482     12  FILLER                           PIC X(6).
  7483
  7484******************************************************************
  7485
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 134
* EL131.cbl
  7487 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7488                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7489                          CONTROL-FILE ACTIVITY-QUE
  7490                          ACCOUNT-MASTER CHECK-QUE
  7491                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7492                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7493                          CERTIFICATE-NOTE.
  7494 0000-DFHEXIT SECTION.
  7495     MOVE '9#                    $   ' TO DFHEIV0.
  7496     MOVE 'EL131' TO DFHEIV1.
  7497     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7498
  7499     IF EIBCALEN = ZERO
  7500         GO TO 8800-UNAUTHORIZED-ACCESS.
  7501
  7502     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7503     MOVE '5'                    TO DC-OPTION-CODE.
  7504     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7505     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7506     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7507     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7508
  7509     IF SAVE-DATE-YY GREATER 70
  7510         MOVE 19                 TO SAVE-DATE-CC
  7511      ELSE
  7512         MOVE 20                 TO SAVE-DATE-CC.
  7513
  7514
  7515* EXEC CICS HANDLE CONDITION
  7516*        PGMIDERR (8820-XCTL-ERROR)
  7517*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7518*        ERROR    (9990-ABEND)
  7519*    END-EXEC.
  7520*    MOVE '"$LI.                 ! " #00007510' TO DFHEIV0
  7521     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7523     MOVE X'2220233030303037353130' TO DFHEIV0(25:11)
  7524     CALL 'kxdfhei1' USING DFHEIV0
  7525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7526
  7527
  7528     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7529     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7530     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7531
  7532     INITIALIZE    EDIT-WORK-AREA.
  7533     MOVE '/'                    TO WORK-SLASH.
  7534     MOVE SPACES                 TO ERROR-SWITCHES.
  7535
  7536     MOVE TRAN-ID                TO TRANS-ID.
  7537     MOVE EIBTRMID               TO PI-TERM.
  7538     MOVE MAP-ID                 TO PI-QUAL.
  7539
  7540     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7541
  7542     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7543         MOVE LOW-VALUES         TO EL131AO
  7544         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 135
* EL131.cbl
  7545         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7546         MOVE -1                 TO MAINTL
  7547         GO TO 8110-SEND-DATA.
  7548
  7549     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7550         MOVE LOW-VALUES         TO EL131AO
  7551         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7552         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7553         MOVE 'X'                TO PI-RETURN-CD-1
  7554         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7555         MOVE -1                 TO MAINTL
  7556         IF WS-RETURNED-FROM = XCTL-EL114
  7557             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7558         END-IF
  7559         GO TO 8100-SEND-MAP.
  7560
  7561     IF EIBAID = DFHCLEAR
  7562         GO TO 8200-RETURN-PRIOR.
  7563
  7564     IF PI-PROCESSOR-ID = 'LGXX'
  7565         NEXT SENTENCE
  7566     ELSE
  7567
  7568* EXEC CICS READQ TS
  7569*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7570*            INTO    (SECURITY-CONTROL)
  7571*            LENGTH  (SC-COMM-LENGTH)
  7572*            ITEM    (SC-ITEM)
  7573*        END-EXEC
  7574*    MOVE '*$II   L              ''   #00007555' TO DFHEIV0
  7575     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7576     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7577     MOVE X'2020233030303037353535' TO DFHEIV0(25:11)
  7578     CALL 'kxdfhei1' USING DFHEIV0,
  7579           PI-SECURITY-TEMP-STORE-ID,
  7580           SECURITY-CONTROL,
  7581           SC-COMM-LENGTH,
  7582           SC-ITEM,
  7583           DFHEIV99,
  7584           DFHEIV99
  7585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7586         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7587         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7588         IF NOT DISPLAY-CAP
  7589             MOVE 'READ'               TO  SM-READ
  7590             PERFORM 9995-SECURITY-VIOLATION
  7591             MOVE ER-0070              TO  EMI-ERROR
  7592             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7593             GO TO 8100-SEND-MAP.
  7594
  7595
  7596* EXEC CICS RECEIVE
  7597*        MAP    ('EL131A')
  7598*        MAPSET ('EL131S')
  7599*    END-EXEC.
  7600     MOVE 'EL131A' TO DFHEIV1
  7601     MOVE 'EL131S' TO DFHEIV2
  7602*    MOVE '8"T                   ''   #00007570' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 136
* EL131.cbl
  7603     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7604     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7605     MOVE X'2020233030303037353730' TO DFHEIV0(25:11)
  7606     CALL 'kxdfhei1' USING DFHEIV0,
  7607           DFHEIV1,
  7608           EL131AI,
  7609           DFHEIV99,
  7610           DFHEIV2,
  7611           DFHEIV99,
  7612           DFHEIV99
  7613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7614
  7615
  7616     IF PFKEYL GREATER THAN ZERO
  7617         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7618
  7619     IF SCREEN-ERROR
  7620         MOVE ER-0004 TO EMI-ERROR
  7621         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7622         MOVE -1 TO MAINTL
  7623         GO TO 8110-SEND-DATA.
  7624
  7625     IF EIBAID = DFHPF3
  7626         GO TO 8500-TRLR-MNT.
  7627
  7628     IF EIBAID = DFHPF4
  7629         GO TO 8600-ADDR-MNT.
  7630
  7631     IF EIBAID = DFHPF5
  7632         GO TO 8700-CERT-MNT.
  7633
  7634     IF PI-COMPANY-ID = 'DMD'
  7635       IF EIBAID = DFHPF6
  7636         GO TO 8750-DMD-CLM-FIX.
  7637
  7638     IF EIBAID = DFHPF7
  7639         GO TO 4000-FORCE-ERRORS.
  7640
  7641     IF EIBAID = DFHPF12
  7642         GO TO 8300-GET-HELP.
  7643
  7644     IF EIBAID = DFHPF15
  7645         GO TO 8725-BENEFICIARY-MNT
  7646     END-IF.
  7647
  7648     IF EIBAID = DFHPF23
  7649         GO TO 8810-PF23-ENTERED.
  7650
  7651     IF EIBAID = DFHPF24
  7652         GO TO 8400-RETURN-MASTER.
  7653
  7654     IF EIBAID NOT = DFHENTER
  7655         MOVE ER-0029            TO EMI-ERROR
  7656         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7657         MOVE -1                 TO MAINTL
  7658         GO TO 8110-SEND-DATA.
  7659
  7660     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 137
* EL131.cbl
  7661         MOVE ER-0311            TO EMI-ERROR
  7662         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7663         MOVE -1                 TO MAINTL
  7664         GO TO 8110-SEND-DATA.
  7665
  7666     IF MAINTI = 'A'
  7667         GO TO 0500-ADD-ALPHA-ONLY.
  7668
  7669     IF MAINTI = 'N'
  7670         GO TO 0600-CHANGE-NAME.
  7671
  7672     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7673     PERFORM 1030-EDIT-NAME THRU 1030-EXIT.
  7674
  7675     IF SCREEN-ERROR
  7676         GO TO 8110-SEND-DATA.
  7677
  7678     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7679         MOVE ER-0276            TO EMI-ERROR
  7680         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7681         MOVE -1                 TO MAINTL
  7682         GO TO 8110-SEND-DATA.
  7683
  7684     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7685
  7686     IF SCREEN-ERROR
  7687         GO TO 8110-SEND-DATA.
  7688
  7689     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7690
  7691     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7692
  7693     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7694         GO TO 8110-SEND-DATA.
  7695
  7696     IF EMI-FATAL-CTR GREATER THAN ZERO
  7697         GO TO 8110-SEND-DATA.
  7698
  7699     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7700
  7701     IF WS-OPEN-CLOSE-SW = 'Y'
  7702         IF PI-LETTER-SW = 'Y'
  7703             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7704             MOVE 'T'            TO  CNTL-REC-TYPE
  7705             MOVE SPACES         TO  CNTL-PROC-ID
  7706             MOVE +0             TO  CNTL-SEQ-NO
  7707
  7708* EXEC CICS READ
  7709*                DATASET   (CNTL-FILE-ID)
  7710*                RIDFLD    (CNTL-KEY)
  7711*                SET       (ADDRESS OF CONTROL-FILE)
  7712*            END-EXEC
  7713*    MOVE '&"S        E          (   #00007666' TO DFHEIV0
  7714     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7715     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7716     MOVE X'2020233030303037363636' TO DFHEIV0(25:11)
  7717     CALL 'kxdfhei1' USING DFHEIV0,
  7718           CNTL-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 138
* EL131.cbl
  7719           DFHEIV20,
  7720           DFHEIV99,
  7721           CNTL-KEY,
  7722           DFHEIV99,
  7723           DFHEIV99,
  7724           DFHEIV99
  7725     SET ADDRESS OF CONTROL-FILE TO
  7726         DFHEIV20
  7727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7728             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7729
  7730     MOVE ER-0000                TO EMI-ERROR.
  7731     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7732
  7733     MOVE SPACE                  TO MAINTO.
  7734     MOVE -1                     TO MAINTL.
  7735     GO TO 8100-SEND-MAP.
  7736
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 139
* EL131.cbl
  7738 0100-UPDATE-PI.
  7739
  7740     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7741     IF WS-RETURNED-FROM = XCTL-EL114
  7742***sometimes there is crap in positions 7-10 when no code was sele
  7743        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7744          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7745        END-IF
  7746     END-IF.
  7747
  7748     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7749         GO TO 0110-UPDATE-UP.
  7750
  7751     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7752     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7753     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7754     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7755     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7756     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7757     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7758     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7759     GO TO 0120-UPDATE-PI-EXIT.
  7760
  7761 0110-UPDATE-UP.
  7762     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7763     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7764     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7765     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7766     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7767     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7768     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7769     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7770
  7771
  7772* EXEC CICS HANDLE CONDITION
  7773*         QIDERR    (0130-TS-ERROR)
  7774*         ITEMERR   (0130-TS-ERROR)
  7775*    END-EXEC.
  7776*    MOVE '"$N<                  ! # #00007714' TO DFHEIV0
  7777     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7778     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7779     MOVE X'2320233030303037373134' TO DFHEIV0(25:11)
  7780     CALL 'kxdfhei1' USING DFHEIV0
  7781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7782
  7783
  7784     IF WS-RETURNED-FROM = XCTL-EL114
  7785
  7786* EXEC CICS READQ TS
  7787*            QUEUE    (PI-KEY)
  7788*            INTO     (EL131AI)
  7789*            LENGTH   (MAP-LENGTH)
  7790*       END-EXEC
  7791*    MOVE '*$I    L              ''   #00007720' TO DFHEIV0
  7792     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7793     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7794     MOVE X'2020233030303037373230' TO DFHEIV0(25:11)
  7795     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 140
* EL131.cbl
  7796           PI-KEY,
  7797           EL131AI,
  7798           MAP-LENGTH,
  7799           DFHEIV99,
  7800           DFHEIV99,
  7801           DFHEIV99
  7802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7803
  7804        IF WS-SAVE-BENEFICIARY > SPACES
  7805            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7806            MOVE +10            TO BENEL
  7807            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7808        END-IF
  7809        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7810     END-IF.
  7811
  7812
  7813* EXEC CICS READQ TS
  7814*         QUEUE    (PI-KEY)
  7815*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7816*         LENGTH   (PI-COMM-LENGTH)
  7817*    END-EXEC.
  7818*    MOVE '*$I    L              ''   #00007734' TO DFHEIV0
  7819     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7820     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7821     MOVE X'2020233030303037373334' TO DFHEIV0(25:11)
  7822     CALL 'kxdfhei1' USING DFHEIV0,
  7823           PI-KEY,
  7824           PROGRAM-INTERFACE-BLOCK,
  7825           PI-COMM-LENGTH,
  7826           DFHEIV99,
  7827           DFHEIV99,
  7828           DFHEIV99
  7829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7830
  7831
  7832
  7833* EXEC CICS DELETEQ TS
  7834*         QUEUE    (PI-KEY)
  7835*    END-EXEC.
  7836*    MOVE '*&                    #   #00007740' TO DFHEIV0
  7837     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7838     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7839     MOVE X'2020233030303037373430' TO DFHEIV0(25:11)
  7840     CALL 'kxdfhei1' USING DFHEIV0,
  7841           PI-KEY,
  7842           DFHEIV99
  7843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7844
  7845
  7846 0120-UPDATE-PI-EXIT.
  7847     EXIT.
  7848
  7849 0130-TS-ERROR.
  7850     MOVE LOW-VALUES             TO EL131AO.
  7851     MOVE ER-0192                TO EMI-ERROR.
  7852
  7853     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 141
* EL131.cbl
  7854
  7855     GO TO 8100-SEND-MAP.
  7856
  7857 0200-TRANS-PF.
  7858     IF EIBAID NOT = DFHENTER
  7859         MOVE 'X'                TO ERROR-SWITCH
  7860         GO TO 0210-EXIT.
  7861
  7862     IF PFKEYI NOT NUMERIC
  7863         MOVE 'X'                TO ERROR-SWITCH
  7864         GO TO 0210-EXIT.
  7865
  7866     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7867
  7868     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7869         MOVE 'X' TO ERROR-SWITCH
  7870         GO TO 0210-EXIT.
  7871
  7872     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7873
  7874 0210-EXIT.
  7875     EXIT.
  7876
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 142
* EL131.cbl
  7878 0500-ADD-ALPHA-ONLY.
  7879******************************************************************
  7880*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7881*    RECORD.                                                     *
  7882******************************************************************
  7883
  7884     IF MLNAMEL = +0 AND
  7885        MFNAMEL = +0 AND
  7886        MMINITL = +0
  7887         MOVE ER-0797                TO  EMI-ERROR
  7888         MOVE -1                     TO  MAINTL
  7889         MOVE AL-UABON               TO  MAINTA
  7890         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7891         GO TO 8110-SEND-DATA.
  7892
  7893     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7894     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7895     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7896     MOVE PI-CERT-NO                 TO  CERT-NO.
  7897
  7898
  7899* EXEC CICS READ
  7900*        DATASET   (CLMS-FILE-ID)
  7901*        RIDFLD    (MSTR-KEY)
  7902*        SET       (ADDRESS OF CLAIM-MASTER)
  7903*    END-EXEC.
  7904*    MOVE '&"S        E          (   #00007796' TO DFHEIV0
  7905     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7906     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7907     MOVE X'2020233030303037373936' TO DFHEIV0(25:11)
  7908     CALL 'kxdfhei1' USING DFHEIV0,
  7909           CLMS-FILE-ID,
  7910           DFHEIV20,
  7911           DFHEIV99,
  7912           MSTR-KEY,
  7913           DFHEIV99,
  7914           DFHEIV99,
  7915           DFHEIV99
  7916     SET ADDRESS OF CLAIM-MASTER TO
  7917         DFHEIV20
  7918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7919
  7920
  7921
  7922* EXEC CICS GETMAIN
  7923*        SET       (ADDRESS OF ALPHA-INDEX)
  7924*        LENGTH    (ALPH-LENGTH)
  7925*        INITIMG   (GETMAIN-SPACE)
  7926*    END-EXEC.
  7927*    MOVE ',"IL                  $   #00007802' TO DFHEIV0
  7928     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7929     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7930     MOVE X'2020233030303037383032' TO DFHEIV0(25:11)
  7931     CALL 'kxdfhei1' USING DFHEIV0,
  7932           DFHEIV20,
  7933           ALPH-LENGTH,
  7934           GETMAIN-SPACE
  7935     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 143
* EL131.cbl
  7936         DFHEIV20
  7937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7938
  7939
  7940     MOVE 'AI'                       TO  AI-RECORD-ID.
  7941     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7942                                         AI-CL-COMPANY-CD.
  7943     MOVE 'C'                        TO  AI-SOURCE
  7944                                         AI-CL-SOURCE.
  7945
  7946     IF MLNAMEL IS GREATER THAN +0
  7947         MOVE MLNAMEI                TO  AI-LAST-NAME
  7948     ELSE
  7949         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7950
  7951     IF MFNAMEL IS GREATER THAN +0
  7952         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7953     ELSE
  7954         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7955
  7956     IF MMINITL IS GREATER THAN +0
  7957         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7958     ELSE
  7959         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7960
  7961     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7962     MOVE '5'                        TO  DC-OPTION-CODE.
  7963     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7964     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7965     IF BUILD-YEAR IS GREATER THAN 50
  7966         MOVE '19'                   TO  WS-ALPHA-YY-1
  7967         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7968         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7969         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7970     ELSE
  7971         MOVE '20'                   TO  WS-ALPHA-YY-1
  7972         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7973         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7974         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7975
  7976     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7977                                         AI-CL-DATE.
  7978
  7979     MOVE EIBTIME                    TO  AI-TIME
  7980                                         AI-CL-TIME.
  7981
  7982     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7983     MOVE 'C'                        TO  AI-CL-SOURCE.
  7984     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7985     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7986     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7987     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7988     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7989
  7990     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7991     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7992     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7993
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 144
* EL131.cbl
  7994
  7995* EXEC CICS WRITE
  7996*        DATASET   (ALPH-FILE-ID)
  7997*        RIDFLD    (AI-CONTROL-PRIMARY)
  7998*        FROM      (ALPHA-INDEX)
  7999*    END-EXEC.
  8000     MOVE LENGTH OF
  8001      ALPHA-INDEX
  8002       TO DFHEIV11
  8003*    MOVE '&$ L                  ''   #00007862' TO DFHEIV0
  8004     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8005     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8006     MOVE X'2020233030303037383632' TO DFHEIV0(25:11)
  8007     CALL 'kxdfhei1' USING DFHEIV0,
  8008           ALPH-FILE-ID,
  8009           ALPHA-INDEX,
  8010           DFHEIV11,
  8011           AI-CONTROL-PRIMARY,
  8012           DFHEIV99,
  8013           DFHEIV99
  8014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8015
  8016
  8017     MOVE LOW-VALUES                 TO  EL131AO.
  8018     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8019     MOVE ER-0000                    TO  EMI-ERROR.
  8020     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8021     MOVE -1                         TO  MAINTL.
  8022     GO TO 8100-SEND-MAP.
  8023
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 145
* EL131.cbl
  8025 0600-CHANGE-NAME.
  8026******************************************************************
  8027*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  8028*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  8029******************************************************************
  8030
  8031     IF MLNAMEL = +0 AND
  8032        MFNAMEL = +0 AND
  8033        MMINITL = +0
  8034         MOVE ER-0276                TO  EMI-ERROR
  8035         MOVE -1                     TO  MAINTL
  8036         MOVE AL-UABON               TO  MAINTA
  8037         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8038         GO TO 8110-SEND-DATA.
  8039
  8040     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  8041     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  8042     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  8043     MOVE PI-CERT-NO                 TO  CERT-NO.
  8044
  8045
  8046* EXEC CICS READ
  8047*        DATASET   (CLMS-FILE-ID)
  8048*        RIDFLD    (MSTR-KEY)
  8049*        SET       (ADDRESS OF CLAIM-MASTER)
  8050*    END-EXEC.
  8051*    MOVE '&"S        E          (   #00007896' TO DFHEIV0
  8052     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8053     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8054     MOVE X'2020233030303037383936' TO DFHEIV0(25:11)
  8055     CALL 'kxdfhei1' USING DFHEIV0,
  8056           CLMS-FILE-ID,
  8057           DFHEIV20,
  8058           DFHEIV99,
  8059           MSTR-KEY,
  8060           DFHEIV99,
  8061           DFHEIV99,
  8062           DFHEIV99
  8063     SET ADDRESS OF CLAIM-MASTER TO
  8064         DFHEIV20
  8065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8066
  8067
  8068
  8069* EXEC CICS GETMAIN
  8070*        SET       (ADDRESS OF ALPHA-INDEX)
  8071*        LENGTH    (ALPH-LENGTH)
  8072*        INITIMG   (GETMAIN-SPACE)
  8073*    END-EXEC.
  8074*    MOVE ',"IL                  $   #00007902' TO DFHEIV0
  8075     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8076     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8077     MOVE X'2020233030303037393032' TO DFHEIV0(25:11)
  8078     CALL 'kxdfhei1' USING DFHEIV0,
  8079           DFHEIV20,
  8080           ALPH-LENGTH,
  8081           GETMAIN-SPACE
  8082     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 146
* EL131.cbl
  8083         DFHEIV20
  8084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8085
  8086
  8087     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  8088     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  8089     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  8090     MOVE CL-CERT-STATE          TO CERT-STATE
  8091     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  8092     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  8093     MOVE CL-CERT-NO             TO CERT-CERT
  8094
  8095
  8096* EXEC CICS READ
  8097*       DATASET   (CERT-FILE-ID)
  8098*       RIDFLD    (CERT-KEY)
  8099*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  8100*       RESP      (WS-RESPONSE)
  8101*    END-EXEC
  8102*    MOVE '&"S        E          (  N#00007916' TO DFHEIV0
  8103     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8104     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8105     MOVE X'204E233030303037393136' TO DFHEIV0(25:11)
  8106     CALL 'kxdfhei1' USING DFHEIV0,
  8107           CERT-FILE-ID,
  8108           DFHEIV20,
  8109           DFHEIV99,
  8110           CERT-KEY,
  8111           DFHEIV99,
  8112           DFHEIV99,
  8113           DFHEIV99
  8114     SET ADDRESS OF CERTIFICATE-MASTER TO
  8115         DFHEIV20
  8116     MOVE EIBRESP  TO WS-RESPONSE
  8117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8118
  8119     IF INSTYPEL > ZEROS
  8120        MOVE INSTYPEI TO CL-INSURED-TYPE
  8121     END-IF
  8122
  8123     IF MFNAMEL > +0
  8124        IF CL-INSURED-TYPE = 'C'
  8125          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  8126           MOVE ER-1675             TO EMI-ERROR
  8127           MOVE -1                  TO MFNAMEL
  8128           MOVE AL-UABON            TO MFNAMEA
  8129           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8130           GO TO 8110-SEND-DATA
  8131        ELSE
  8132          IF CL-INSURED-TYPE = 'P'
  8133            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  8134             MOVE ER-1676             TO EMI-ERROR
  8135             MOVE -1                  TO MFNAMEL
  8136             MOVE AL-UABON            TO MFNAMEA
  8137             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8138             GO TO 8110-SEND-DATA
  8139          END-IF
  8140        END-IF
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 147
* EL131.cbl
  8141     END-IF
  8142     MOVE 'AI'                       TO  AI-RECORD-ID.
  8143     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8144                                         AI-CL-COMPANY-CD.
  8145     MOVE 'C'                        TO  AI-SOURCE
  8146                                         AI-CL-SOURCE.
  8147
  8148     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8149     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8150     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8151
  8152     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8153     MOVE '5'                        TO  DC-OPTION-CODE.
  8154     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8155     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8156     IF BUILD-YEAR IS GREATER THAN 50
  8157         MOVE '19'                   TO  WS-ALPHA-YY-1
  8158         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8159         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8160         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8161     ELSE
  8162         MOVE '20'                   TO  WS-ALPHA-YY-1
  8163         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8164         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8165         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8166
  8167     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8168                                         AI-CL-DATE.
  8169
  8170     MOVE EIBTIME                    TO  AI-TIME
  8171                                         AI-CL-TIME.
  8172
  8173     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8174     MOVE 'C'                        TO  AI-CL-SOURCE.
  8175     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8176     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8177     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8178     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8179     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8180
  8181     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8182     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8183     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8184
  8185     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8186         MOVE 'Y'                TO CL-YESNOSW
  8187     END-IF.
  8188
  8189
  8190* EXEC CICS WRITE
  8191*        DATASET   (ALPH-FILE-ID)
  8192*        RIDFLD    (AI-CONTROL-PRIMARY)
  8193*        FROM      (ALPHA-INDEX)
  8194*    END-EXEC.
  8195     MOVE LENGTH OF
  8196      ALPHA-INDEX
  8197       TO DFHEIV11
  8198*    MOVE '&$ L                  ''   #00007993' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 148
* EL131.cbl
  8199     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8200     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8201     MOVE X'2020233030303037393933' TO DFHEIV0(25:11)
  8202     CALL 'kxdfhei1' USING DFHEIV0,
  8203           ALPH-FILE-ID,
  8204           ALPHA-INDEX,
  8205           DFHEIV11,
  8206           AI-CONTROL-PRIMARY,
  8207           DFHEIV99,
  8208           DFHEIV99
  8209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8210
  8211
  8212
  8213* EXEC CICS READ
  8214*        DATASET   (CLMS-FILE-ID)
  8215*        RIDFLD    (MSTR-KEY)
  8216*        SET       (ADDRESS OF CLAIM-MASTER)
  8217*        UPDATE
  8218*    END-EXEC.
  8219*    MOVE '&"S        EU         (   #00007999' TO DFHEIV0
  8220     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8221     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8222     MOVE X'2020233030303037393939' TO DFHEIV0(25:11)
  8223     CALL 'kxdfhei1' USING DFHEIV0,
  8224           CLMS-FILE-ID,
  8225           DFHEIV20,
  8226           DFHEIV99,
  8227           MSTR-KEY,
  8228           DFHEIV99,
  8229           DFHEIV99,
  8230           DFHEIV99
  8231     SET ADDRESS OF CLAIM-MASTER TO
  8232         DFHEIV20
  8233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8234
  8235
  8236     if (cl-priority-cd = '8')
  8237        and (pi-processor-id not = 'PEMA'and 'JMS '
  8238             AND 'AMWA' AND 'KMSB')
  8239        MOVE ER-8003             TO EMI-ERROR
  8240        PERFORM 9900-ERROR-FORMAT
  8241                                 THRU 9900-EXIT
  8242        MOVE -1                  TO MAINTL
  8243        GO TO 8110-SEND-DATA
  8244     end-if
  8245
  8246     IF MLNAMEL IS GREATER THAN +0
  8247         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8248
  8249     IF MFNAMEL IS GREATER THAN +0
  8250         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8251
  8252     IF MMINITL IS GREATER THAN +0
  8253         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
  8254
  8255     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8256     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 149
* EL131.cbl
  8257     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8258     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8259
  8260     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8261         MOVE 'Y'                TO CL-YESNOSW
  8262     END-IF.
  8263
  8264
  8265* EXEC CICS HANDLE CONDITION
  8266*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8267*    END-EXEC.
  8268*    MOVE '"$$                   ! $ #00008034' TO DFHEIV0
  8269     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8271     MOVE X'2420233030303038303334' TO DFHEIV0(25:11)
  8272     CALL 'kxdfhei1' USING DFHEIV0
  8273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8274
  8275
  8276
  8277* EXEC CICS REWRITE
  8278*        DATASET   (CLMS-FILE-ID)
  8279*        FROM      (CLAIM-MASTER)
  8280*    END-EXEC.
  8281     MOVE LENGTH OF
  8282      CLAIM-MASTER
  8283       TO DFHEIV11
  8284*    MOVE '&& L                  %   #00008038' TO DFHEIV0
  8285     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8286     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8287     MOVE X'2020233030303038303338' TO DFHEIV0(25:11)
  8288     CALL 'kxdfhei1' USING DFHEIV0,
  8289           CLMS-FILE-ID,
  8290           CLAIM-MASTER,
  8291           DFHEIV11,
  8292           DFHEIV99
  8293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8294
  8295
  8296 0600-CONTINUE-NAME-UPDATE.
  8297
  8298     MOVE LOW-VALUES                 TO  EL131AO.
  8299     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8300     MOVE ER-0000                    TO  EMI-ERROR.
  8301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8302     MOVE -1                         TO  MAINTL.
  8303     GO TO 8100-SEND-MAP.
  8304
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 150
* EL131.cbl
  8306 1000-EDIT-SCREEN.
  8307
  8308     MOVE MAINTI                 TO CHECK-MAINT.
  8309
  8310     IF NOT VALID-OPTIONS
  8311         MOVE 'X'                TO ERROR-SWITCH
  8312         MOVE -1                 TO MAINTL
  8313         MOVE AL-UABON           TO MAINTA
  8314         MOVE ER-0023            TO EMI-ERROR
  8315         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8316         GO TO 1010-EXIT.
  8317
  8318     IF NOT MODIFY-CAP
  8319         MOVE 'UPDATE'           TO  SM-READ
  8320         PERFORM 9995-SECURITY-VIOLATION
  8321         MOVE ER-0070               TO  EMI-ERROR
  8322         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8323         GO TO 8100-SEND-MAP.
  8324
  8325     IF DELETE-CLAIM
  8326         MOVE AL-UANON TO MAINTA
  8327         GO TO 1010-EXIT.
  8328
  8329     MOVE AL-UANON               TO MAINTA.
  8330
  8331     IF CCNOI GREATER THAN LOW-VALUES
  8332         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8333
  8334     IF PI-COMPANY-ID = 'CSL'
  8335        CONTINUE
  8336     ELSE
  8337        IF TYPEL > ZERO
  8338           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8339              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8340                    PI-LIFE-OVERRIDE-L1))
  8341                       OR
  8342              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8343              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8344                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
  8345              MOVE AL-UANON      TO TYPEA
  8346              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8347           ELSE
  8348              MOVE ER-0199       TO EMI-ERROR
  8349              PERFORM 9900-ERROR-FORMAT
  8350                                 THRU 9900-EXIT
  8351              MOVE AL-UABON      TO TYPEA
  8352              MOVE -1            TO TYPEL
  8353              MOVE 'X'           TO ERROR-SWITCH
  8354           END-IF
  8355        ELSE
  8356           MOVE AL-UANOF         TO TYPEA
  8357        END-IF
  8358     END-IF
  8359     IF STATUSI GREATER THAN LOW-VALUES
  8360         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8361             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8362             MOVE AL-UANON       TO STATUSA
  8363             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 151
* EL131.cbl
  8364             MOVE 'Y'            TO DLYACTV-SW
  8365         ELSE
  8366             MOVE ER-0333        TO EMI-ERROR
  8367             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8368             MOVE AL-UABON       TO STATUSA
  8369             MOVE -1             TO STATUSL
  8370             MOVE 'X'            TO ERROR-SWITCH
  8371         END-IF
  8372     ELSE
  8373         MOVE SPACE              TO TRLR-SWITCH
  8374         MOVE 'N'                TO DLYACTV-SW
  8375         MOVE AL-UANOF           TO STATUSA.
  8376
  8377     IF PROCI GREATER THAN LOW-VALUES
  8378         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8379     ELSE
  8380         MOVE AL-UANOF TO PROCA.
  8381
  8382     IF SEXI GREATER THAN LOW-VALUES
  8383         IF SEXI = 'F' OR 'M'
  8384             MOVE AL-UANON       TO SEXA
  8385             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8386           ELSE
  8387             MOVE ER-0219        TO EMI-ERROR
  8388             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8389             MOVE AL-UABON       TO SEXA
  8390             MOVE -1             TO SEXL
  8391             MOVE 'X'            TO ERROR-SWITCH
  8392       ELSE
  8393         MOVE AL-UANOF           TO SEXA.
  8394
  8395     IF BIRTHL = +0
  8396         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8397         MOVE AL-UANOF           TO  BIRTHA
  8398         GO TO 1000-CONTINUE-EDITS.
  8399
  8400     IF BIRTHI = SPACES
  8401         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8402         MOVE 'X'                TO  UPDATE-SWITCH
  8403                                     MSTR-SWITCH
  8404         GO TO 1000-CONTINUE-EDITS.
  8405
  8406     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8407     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8408     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8409     MOVE '4'                    TO  DC-OPTION-CODE.
  8410     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8411     IF DATE-CONVERSION-ERROR
  8412         MOVE ER-0220            TO  EMI-ERROR
  8413         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8414         MOVE AL-UABON           TO  BIRTHA
  8415         MOVE -1                 TO  BIRTHL
  8416         MOVE 'X'                TO  ERROR-SWITCH
  8417         GO TO 1000-CONTINUE-EDITS.
  8418
  8419******************************************************************
  8420**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8421**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 152
* EL131.cbl
  8422**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8423******************************************************************
  8424     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8425         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8426         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8427         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8428         MOVE '4'                TO  DC-OPTION-CODE
  8429         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8430         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8431                                     DC-ELAPSED-DAYS
  8432         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8433         IF DATE-CONVERSION-ERROR
  8434             MOVE ER-0220        TO  EMI-ERROR
  8435             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8436             MOVE AL-UABON       TO  BIRTHA
  8437             MOVE -1             TO  BIRTHL
  8438             MOVE 'X'            TO  ERROR-SWITCH
  8439             GO TO 1000-CONTINUE-EDITS.
  8440
  8441     MOVE AL-UANON               TO  BIRTHA.
  8442     MOVE 'X'                    TO  UPDATE-SWITCH
  8443                                     MSTR-SWITCH.
  8444     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8445     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8446     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8447
  8448 1000-CONTINUE-EDITS.
  8449
  8450     IF SOCIALI GREATER THAN LOW-VALUES
  8451         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8452         IF WS-SOC-SEC-NO NUMERIC AND
  8453           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8454             NEXT SENTENCE
  8455         ELSE
  8456            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8457               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8458               WS-SSN-DASH2 = '-'
  8459                 NEXT SENTENCE
  8460            ELSE
  8461                 MOVE ER-0887        TO  EMI-ERROR
  8462                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8463                 MOVE AL-UABON       TO  SOCIALA
  8464                 MOVE -1             TO  SOCIALL
  8465                 MOVE 'X'            TO  ERROR-SWITCH
  8466            END-IF
  8467        END-IF
  8468     END-IF.
  8469     if critpl > zeros
  8470        and critpi numeric
  8471        move al-uanon            to critpa
  8472        move 'X'                 to update-switch
  8473     end-if
  8474     IF SOCIALI GREATER THAN LOW-VALUES
  8475         MOVE AL-UANON           TO SOCIALA
  8476         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8477     ELSE
  8478         MOVE AL-UANOF           TO SOCIALA.
  8479
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 153
* EL131.cbl
  8480     IF OCCI GREATER THAN LOW-VALUES
  8481         MOVE AL-UANON           TO OCCA
  8482         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8483     ELSE
  8484         MOVE AL-UANOF           TO OCCA.
  8485
  8486     IF BENEL NOT GREATER THAN ZERO
  8487            GO TO 1005-CONTINUE-EDITS.
  8488
  8489     IF BENEI = SPACES
  8490        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8491           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8492           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8493           IF AUTO-PAY-TO-BENE = 'Y'
  8494               MOVE ER-1773      TO  EMI-ERROR
  8495               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8496               MOVE 'X'          TO ERROR-SWITCH
  8497               MOVE AL-UABON     TO BENEA
  8498               MOVE -1           TO BENEL
  8499           ELSE
  8500               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8501           END-IF
  8502        ELSE
  8503           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8504           IF PAYMENT-PENDING
  8505               MOVE ER-1772      TO  EMI-ERROR
  8506               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8507               MOVE 'X'          TO ERROR-SWITCH
  8508               MOVE AL-UABON     TO BENEA
  8509               MOVE -1           TO BENEL
  8510           END-IF
  8511           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8512        END-IF
  8513        GO TO 1005-CONTINUE-EDITS.
  8514
  8515
  8516* EXEC CICS HANDLE CONDITION
  8517*        NOTFND (1004-BENE-NOT-FOUND)
  8518*    END-EXEC.
  8519*    MOVE '"$I                   ! % #00008262' TO DFHEIV0
  8520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8522     MOVE X'2520233030303038323632' TO DFHEIV0(25:11)
  8523     CALL 'kxdfhei1' USING DFHEIV0
  8524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8525
  8526
  8527     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8528     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8529     MOVE BENEI                  TO  WS-ELBENE-ID.
  8530
  8531
  8532* EXEC CICS READ
  8533*        DATASET ('ELBENE')
  8534*        RIDFLD  (WS-ELBENE-KEY)
  8535*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8536*    END-EXEC.
  8537     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 154
* EL131.cbl
  8538*    MOVE '&"S        E          (   #00008270' TO DFHEIV0
  8539     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8540     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8541     MOVE X'2020233030303038323730' TO DFHEIV0(25:11)
  8542     CALL 'kxdfhei1' USING DFHEIV0,
  8543           DFHEIV1,
  8544           DFHEIV20,
  8545           DFHEIV99,
  8546           WS-ELBENE-KEY,
  8547           DFHEIV99,
  8548           DFHEIV99,
  8549           DFHEIV99
  8550     SET ADDRESS OF BENEFICIARY-MASTER TO
  8551         DFHEIV20
  8552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8553
  8554
  8555     MOVE AL-UANON               TO  BENEA.
  8556     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8557
  8558     GO TO 1005-CONTINUE-EDITS.
  8559
  8560 1004-BENE-NOT-FOUND.
  8561     MOVE ER-0565                TO  EMI-ERROR.
  8562
  8563     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8564     MOVE 'X'                    TO ERROR-SWITCH.
  8565     MOVE AL-UABON               TO BENEA.
  8566     MOVE -1                     TO BENEL.
  8567
  8568 1005-CONTINUE-EDITS.
  8569
  8570     IF DIAGI GREATER THAN LOW-VALUES
  8571         MOVE AL-UANON           TO DIAGA
  8572         MOVE 'X'                TO UPDATE-SWITCH
  8573                                    NINETY-TRLR-SWITCH
  8574     ELSE
  8575         MOVE AL-UANOF           TO DIAGA.
  8576
  8577     IF ICD1I GREATER THAN LOW-VALUES
  8578         IF (ICD1I GREATER THAN SPACES) AND
  8579            (ICD1I(4:1) NOT = '.')
  8580             IF ICD1I(4:1) = ' '
  8581                 MOVE '.' TO ICD1I(4:1)
  8582             ELSE
  8583                 IF ICD1I(8:1) = ' '
  8584                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8585                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8586                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8587                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8588                     MOVE '.'        TO ICD1I(4:1)
  8589                 END-IF
  8590             END-IF
  8591         END-IF
  8592         IF (ICD1I GREATER THAN SPACES) AND
  8593            (ICD1I(1:1) NOT > ' ' OR
  8594             ICD1I(2:1) NOT > ' ' OR
  8595             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 155
* EL131.cbl
  8596             ICD1I(4:1) NOT = '.')
  8597              MOVE ER-0992        TO  EMI-ERROR
  8598              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8599              MOVE 'X'            TO ERROR-SWITCH
  8600              MOVE AL-UABON       TO ICD1A
  8601              MOVE -1             TO ICD1L
  8602         ELSE
  8603             MOVE AL-UANON       TO ICD1A
  8604             MOVE 'X'            TO UPDATE-SWITCH
  8605                                    NINETY-TRLR-SWITCH
  8606         END-IF
  8607     ELSE
  8608         MOVE AL-UANOF           TO ICD1A
  8609     END-IF.
  8610
  8611     IF ICD2I GREATER THAN LOW-VALUES
  8612         IF (ICD2I GREATER THAN SPACES) AND
  8613            (ICD2I(4:1) NOT = '.')
  8614             IF ICD2I(4:1) = ' '
  8615                 MOVE '.' TO ICD2I(4:1)
  8616             ELSE
  8617                 IF ICD2I(8:1) = ' '
  8618                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8619                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8620                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8621                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8622                     MOVE '.'        TO ICD2I(4:1)
  8623                 END-IF
  8624             END-IF
  8625         END-IF
  8626         IF (ICD2I GREATER THAN SPACES) AND
  8627            (ICD2I(1:1) NOT > ' ' OR
  8628             ICD2I(2:1) NOT > ' ' OR
  8629             ICD2I(3:1) NOT > ' ' OR
  8630             ICD2I(4:1) NOT = '.')
  8631              MOVE ER-0992        TO EMI-ERROR
  8632              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8633              MOVE 'X'            TO ERROR-SWITCH
  8634              MOVE AL-UABON       TO ICD2A
  8635              MOVE -1             TO ICD2L
  8636         ELSE
  8637             MOVE AL-UANON       TO ICD2A
  8638             MOVE 'X'            TO UPDATE-SWITCH
  8639                                    NINETY-TRLR-SWITCH
  8640         END-IF
  8641     ELSE
  8642         MOVE AL-UANOF           TO ICD2A
  8643     END-IF.
  8644
  8645*    IF CAUSEI GREATER THAN LOW-VALUES
  8646*        MOVE AL-UANON           TO CAUSEA
  8647*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8648*    ELSE
  8649*        MOVE AL-UANOF           TO CAUSEA.
  8650
  8651*    IF ENDL GREATER THAN ZERO
  8652*        MOVE LOW-VALUES         TO HOLD-END
  8653*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 156
* EL131.cbl
  8654*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8655*        ELSE
  8656*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8657*            EXEC CICS BIF DEEDIT
  8658*                FIELD    (DEEDIT-DATE-INPUT)
  8659*                LENGTH   (DATE-LENGTH)
  8660*            END-EXEC
  8661*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8662*            MOVE '4'            TO DC-OPTION-CODE
  8663*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8664*            IF NOT DATE-CONVERSION-ERROR
  8665*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8666*                MOVE AL-UANON   TO ENDA
  8667*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8668*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8669*            ELSE
  8670*                MOVE ER-0224    TO EMI-ERROR
  8671*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8672*                MOVE AL-UABON   TO ENDA
  8673*                MOVE -1         TO ENDL
  8674*                MOVE 'X'        TO ERROR-SWITCH
  8675*      ELSE
  8676*          MOVE AL-UANOF         TO ENDA.
  8677
  8678     IF INCL GREATER THAN ZERO
  8679         MOVE LOW-VALUES         TO HOLD-INCUR
  8680         IF INCI = SPACES
  8681             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8682         ELSE
  8683             MOVE INCI           TO DEEDIT-DATE-INPUT
  8684
  8685* EXEC CICS BIF DEEDIT
  8686*                FIELD    (DEEDIT-DATE-INPUT)
  8687*                LENGTH   (DATE-LENGTH)
  8688*            END-EXEC
  8689*    MOVE '@"L                   #   #00008405' TO DFHEIV0
  8690     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8691     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8692     MOVE X'2020233030303038343035' TO DFHEIV0(25:11)
  8693     CALL 'kxdfhei1' USING DFHEIV0,
  8694           DEEDIT-DATE-INPUT,
  8695           DATE-LENGTH
  8696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8697             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8698             MOVE '4'            TO DC-OPTION-CODE
  8699             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8700             IF NOT DATE-CONVERSION-ERROR
  8701                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8702                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8703                 MOVE AL-UANON           TO INCA
  8704                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8705             ELSE
  8706                 MOVE ER-0222    TO EMI-ERROR
  8707                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8708                 MOVE AL-UABON   TO INCA
  8709                 MOVE -1         TO INCL
  8710                 MOVE 'X'        TO ERROR-SWITCH
  8711       ELSE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 157
* EL131.cbl
  8712           IF PI-NO-PMTS = ZEROS
  8713               MOVE AL-UANOF     TO INCA.
  8714
  8715     IF REPL GREATER THAN ZERO
  8716         MOVE LOW-VALUES         TO HOLD-REPORTED
  8717         IF REPI = SPACES
  8718             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8719         ELSE
  8720             MOVE REPI           TO DEEDIT-DATE-INPUT
  8721
  8722* EXEC CICS BIF DEEDIT
  8723*                FIELD    (DEEDIT-DATE-INPUT)
  8724*                LENGTH   (DATE-LENGTH)
  8725*            END-EXEC
  8726*    MOVE '@"L                   #   #00008433' TO DFHEIV0
  8727     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8728     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8729     MOVE X'2020233030303038343333' TO DFHEIV0(25:11)
  8730     CALL 'kxdfhei1' USING DFHEIV0,
  8731           DEEDIT-DATE-INPUT,
  8732           DATE-LENGTH
  8733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8734             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8735             MOVE '4'            TO DC-OPTION-CODE
  8736             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8737             IF NOT DATE-CONVERSION-ERROR
  8738                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8739                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8740                 MOVE AL-UANON   TO REPA
  8741                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8742             ELSE
  8743                 MOVE ER-0223    TO EMI-ERROR
  8744                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8745                 MOVE AL-UABON   TO REPA
  8746                 MOVE -1         TO REPL
  8747                 MOVE 'X'        TO ERROR-SWITCH
  8748       ELSE
  8749         MOVE AL-UANOF TO REPA.
  8750
  8751     IF PDTHRUI GREATER THAN LOW-VALUES
  8752        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8753        IF PDTHRUI = SPACES
  8754           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8755        ELSE
  8756           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8757
  8758* EXEC CICS BIF DEEDIT
  8759*               FIELD    (DEEDIT-DATE-INPUT)
  8760*               LENGTH   (DATE-LENGTH)
  8761*          END-EXEC
  8762*    MOVE '@"L                   #   #00008460' TO DFHEIV0
  8763     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8764     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8765     MOVE X'2020233030303038343630' TO DFHEIV0(25:11)
  8766     CALL 'kxdfhei1' USING DFHEIV0,
  8767           DEEDIT-DATE-INPUT,
  8768           DATE-LENGTH
  8769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 158
* EL131.cbl
  8770           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8771           MOVE '4'            TO DC-OPTION-CODE
  8772           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8773           IF NOT DATE-CONVERSION-ERROR
  8774              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8775              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8776              MOVE AL-UANON   TO PDTHRUA
  8777              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8778              IF PI-USES-PAID-TO
  8779                 MOVE '6'            TO DC-OPTION-CODE
  8780                 MOVE -1             TO DC-ELAPSED-DAYS
  8781                 MOVE +0             TO DC-ELAPSED-MONTHS
  8782                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8783                 IF NO-CONVERSION-ERROR
  8784                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8785                 ELSE
  8786                    NEXT SENTENCE
  8787              ELSE
  8788                 NEXT SENTENCE
  8789           ELSE
  8790              MOVE ER-0475    TO EMI-ERROR
  8791              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8792              MOVE AL-UABON   TO PDTHRUA
  8793              MOVE -1         TO PDTHRUL
  8794              MOVE 'X'        TO ERROR-SWITCH
  8795     ELSE
  8796        IF MODIFY-CAP
  8797           MOVE AL-UANOF        TO PDTHRUA.
  8798
  8799     IF PDAMTL GREATER THAN +0
  8800         MOVE ZEROS              TO HOLD-PDAMT
  8801
  8802* EXEC CICS BIF DEEDIT
  8803*            FIELD    (PDAMTI)
  8804*            LENGTH   (9)
  8805*        END-EXEC
  8806     MOVE 9
  8807       TO DFHEIV11
  8808*    MOVE '@"L                   #   #00008495' TO DFHEIV0
  8809     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8810     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8811     MOVE X'2020233030303038343935' TO DFHEIV0(25:11)
  8812     CALL 'kxdfhei1' USING DFHEIV0,
  8813           PDAMTI,
  8814           DFHEIV11
  8815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8816         IF PDAMTI NUMERIC
  8817             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8818             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8819             MOVE AL-UNNON       TO PDAMTA
  8820         ELSE
  8821             MOVE ER-0547        TO EMI-ERROR
  8822             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8823             MOVE AL-UNBON       TO PDAMTA
  8824             MOVE -1             TO PDAMTL
  8825             MOVE 'X'            TO ERROR-SWITCH
  8826     ELSE
  8827         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 159
* EL131.cbl
  8828            MOVE AL-UNNOF        TO PDAMTA.
  8829
  8830     IF NODAYSI GREATER THAN LOW-VALUES
  8831         MOVE ZEROS              TO HOLD-NODAYS
  8832
  8833* EXEC CICS BIF DEEDIT
  8834*            FIELD (NODAYSI)
  8835*            LENGTH (5)
  8836*        END-EXEC
  8837     MOVE 5
  8838       TO DFHEIV11
  8839*    MOVE '@"L                   #   #00008515' TO DFHEIV0
  8840     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8841     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8842     MOVE X'2020233030303038353135' TO DFHEIV0(25:11)
  8843     CALL 'kxdfhei1' USING DFHEIV0,
  8844           NODAYSI,
  8845           DFHEIV11
  8846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8847         IF NODAYSI NUMERIC
  8848             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8849             MOVE AL-UNNON       TO NODAYSA
  8850             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8851         ELSE
  8852             MOVE ER-0491        TO EMI-ERROR
  8853             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8854             MOVE AL-UNBON       TO NODAYSA
  8855             MOVE -1             TO NODAYSL
  8856             MOVE 'X'            TO ERROR-SWITCH
  8857     ELSE
  8858         IF MODIFY-CAP
  8859            MOVE AL-UNNOF        TO NODAYSA.
  8860
  8861     IF NOPMTSI GREATER THAN LOW-VALUES
  8862         MOVE ZEROS              TO HOLD-NOPMTS
  8863
  8864* EXEC CICS BIF DEEDIT
  8865*            FIELD (NOPMTSI)
  8866*            LENGTH (4)
  8867*        END-EXEC
  8868     MOVE 4
  8869       TO DFHEIV11
  8870*    MOVE '@"L                   #   #00008535' TO DFHEIV0
  8871     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8872     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8873     MOVE X'2020233030303038353335' TO DFHEIV0(25:11)
  8874     CALL 'kxdfhei1' USING DFHEIV0,
  8875           NOPMTSI,
  8876           DFHEIV11
  8877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8878         IF NOPMTSI NUMERIC
  8879             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8880             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8881             MOVE AL-UNNON       TO NOPMTSA
  8882           ELSE
  8883             MOVE ER-0548        TO EMI-ERROR
  8884             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8885             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 160
* EL131.cbl
  8886             MOVE -1             TO NOPMTSL
  8887             MOVE 'X'            TO ERROR-SWITCH
  8888       ELSE
  8889         IF MODIFY-CAP
  8890            MOVE AL-UNNOF        TO NOPMTSA.
  8891
  8892     IF FORMTYPI GREATER THAN LOW-VALUES
  8893         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8894             MOVE AL-UANON       TO FORMTYPA
  8895             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8896           ELSE
  8897             MOVE ER-7650        TO EMI-ERROR
  8898             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8899             MOVE AL-UABON       TO FORMTYPA
  8900             MOVE -1             TO FORMTYPL
  8901             MOVE 'X'            TO ERROR-SWITCH
  8902       ELSE
  8903         MOVE AL-UANOF           TO FORMTYPA.
  8904
  8905     IF PRICDL GREATER THAN ZERO
  8906         IF (PRICDI = ' ') OR
  8907            (PRICDI GREATER THAN ZERO   AND
  8908             PRICDI NOT GREATER THAN '9')
  8909             MOVE AL-UANON       TO PRICDA
  8910             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8911         ELSE
  8912             MOVE ER-0274        TO EMI-ERROR
  8913             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8914             MOVE AL-UABON       TO PRICDA
  8915             MOVE -1             TO PRICDL
  8916             MOVE 'X'            TO ERROR-SWITCH
  8917     ELSE
  8918         MOVE AL-UANOF TO PRICDA.
  8919
  8920     IF PI-COMPANY-ID = 'DMD'
  8921     IF PRICDL GREATER THAN ZERO
  8922       IF SYSTEM-MODIFY-CAP  OR
  8923          PI-PROCESSOR-ID = 'LGXX'
  8924             NEXT SENTENCE
  8925           ELSE
  8926            IF CL-PRIORITY-CD = '9'  OR
  8927               PRICDI         = '9'
  8928                  MOVE ER-0938        TO EMI-ERROR
  8929                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8930                  MOVE AL-UABON       TO PRICDA
  8931                  MOVE -1             TO PRICDL
  8932                  MOVE 'X'            TO ERROR-SWITCH.
  8933
  8934     IF FILETOL GREATER THAN ZERO
  8935         MOVE AL-UANON           TO FILETOA
  8936         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8937     ELSE
  8938         MOVE AL-UANOF TO FILETOA.
  8939
  8940     IF SUPVL GREATER THAN ZERO
  8941         IF SUPVI = 'Y' OR 'N' OR SPACE
  8942             MOVE AL-UANON       TO SUPVA
  8943             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 161
* EL131.cbl
  8944         ELSE
  8945             MOVE ER-0230        TO EMI-ERROR
  8946             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8947             MOVE AL-UABON       TO SUPVA
  8948             MOVE -1             TO SUPVL
  8949             MOVE 'X'            TO ERROR-SWITCH
  8950     ELSE
  8951         MOVE AL-UANOF           TO SUPVA.
  8952
  8953     IF MLNAMEL GREATER THAN ZERO
  8954         IF MLNAMEI GREATER THAN SPACES
  8955            MOVE AL-UANON        TO MLNAMEA
  8956            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8957                                     MSTR-KEY-SWITCH
  8958         ELSE
  8959            MOVE ER-0236         TO EMI-ERROR
  8960            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8961            MOVE AL-UABON        TO MLNAMEA
  8962            MOVE -1              TO MLNAMEL
  8963            MOVE 'X'             TO ERROR-SWITCH
  8964     ELSE
  8965         MOVE AL-UANOF           TO MLNAMEA.
  8966
  8967     IF MFNAMEI GREATER THAN LOW-VALUES
  8968         MOVE AL-UANON           TO MFNAMEA
  8969         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8970     ELSE
  8971         MOVE AL-UANOF           TO MFNAMEA.
  8972
  8973     IF MMINITI GREATER THAN LOW-VALUES
  8974         MOVE AL-UANON           TO MMINITA
  8975         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8976     ELSE
  8977         MOVE AL-UANOF           TO MMINITA.
  8978
  8979     IF CRTLNMEI GREATER THAN LOW-VALUES
  8980         IF CRTLNMEI NOT = SPACES
  8981            MOVE AL-UANON        TO CRTLNMEA
  8982            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8983                                     CERT-KEY-SWITCH
  8984        ELSE
  8985            MOVE ER-0236         TO EMI-ERROR
  8986            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8987            MOVE AL-UABON        TO CRTLNMEA
  8988            MOVE -1              TO CRTLNMEL
  8989            MOVE 'X'             TO ERROR-SWITCH
  8990     ELSE
  8991         MOVE AL-UANOF           TO CRTLNMEA.
  8992
  8993     IF CRTFNMEI GREATER THAN LOW-VALUES
  8994         MOVE AL-UANON           TO CRTFNMEA
  8995         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8996     ELSE
  8997         MOVE AL-UANOF           TO CRTFNMEA.
  8998
  8999     IF CRTINITI GREATER THAN LOW-VALUES
  9000         MOVE AL-UANON           TO CRTINITA
  9001         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 162
* EL131.cbl
  9002     ELSE
  9003         MOVE AL-UANOF           TO CRTINITA.
  9004
  9005     IF ISSAGEL GREATER THAN ZERO
  9006         IF ISSAGEI NUMERIC
  9007            MOVE AL-UANON        TO ISSAGEA
  9008            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9009         ELSE
  9010            MOVE ER-0237         TO EMI-ERROR
  9011            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9012            MOVE AL-UABON        TO ISSAGEA
  9013            MOVE -1              TO ISSAGEL
  9014            MOVE 'X'             TO ERROR-SWITCH
  9015     ELSE
  9016         MOVE AL-UANOF           TO ISSAGEA.
  9017
  9018     IF JNTFNMEI GREATER THAN LOW-VALUES
  9019         MOVE AL-UANON           TO JNTFNMEA
  9020         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9021     ELSE
  9022         MOVE AL-UANOF           TO JNTFNMEA.
  9023
  9024     IF JNTLNMEI GREATER THAN LOW-VALUES
  9025         MOVE AL-UANON           TO JNTLNMEA
  9026         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9027     ELSE
  9028         MOVE AL-UANOF           TO JNTLNMEA.
  9029
  9030     IF JNTINITI GREATER THAN LOW-VALUES
  9031         MOVE AL-UANON           TO JNTINITA
  9032         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9033     ELSE
  9034         MOVE AL-UANOF           TO JNTINITA.
  9035
  9036     IF JNTAGEL GREATER THAN ZERO
  9037         IF JNTAGEI NUMERIC
  9038            MOVE AL-UANON        TO JNTAGEA
  9039            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9040         ELSE
  9041            MOVE ER-0238         TO EMI-ERROR
  9042            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9043            MOVE AL-UABON        TO JNTAGEA
  9044            MOVE -1              TO JNTAGEL
  9045            MOVE 'X'             TO ERROR-SWITCH
  9046     ELSE
  9047         MOVE AL-UANOF           TO JNTAGEA.
  9048
  9049     IF ADDONDTI GREATER THAN LOW-VALUES
  9050         MOVE LOW-VALUES         TO HOLD-ADDON
  9051         IF ADDONDTI = SPACES
  9052             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  9053         ELSE
  9054             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  9055
  9056* EXEC CICS BIF DEEDIT
  9057*                FIELD    (DEEDIT-DATE-INPUT)
  9058*                LENGTH   (DATE-LENGTH)
  9059*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 163
* EL131.cbl
  9060*    MOVE '@"L                   #   #00008716' TO DFHEIV0
  9061     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9062     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9063     MOVE X'2020233030303038373136' TO DFHEIV0(25:11)
  9064     CALL 'kxdfhei1' USING DFHEIV0,
  9065           DEEDIT-DATE-INPUT,
  9066           DATE-LENGTH
  9067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9068             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9069             MOVE '4'            TO DC-OPTION-CODE
  9070             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9071             IF NOT DATE-CONVERSION-ERROR
  9072                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  9073                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  9074                                                  CERT-SWITCH
  9075                 MOVE AL-UANON   TO ADDONDTA
  9076                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  9077             ELSE
  9078                 MOVE ER-7651    TO EMI-ERROR
  9079                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9080                 MOVE AL-UABON   TO ADDONDTA
  9081                 MOVE -1         TO ADDONDTL
  9082                 MOVE 'X'        TO ERROR-SWITCH
  9083       ELSE
  9084         MOVE AL-UANOF TO ADDONDTA.
  9085
  9086     IF LCVCDI GREATER THAN LOW-VALUES
  9087         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  9088         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  9089     ELSE
  9090         MOVE AL-UANOF           TO LCVCDA.
  9091
  9092     IF ACVCDI GREATER THAN LOW-VALUES
  9093         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  9094         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  9095     ELSE
  9096         MOVE AL-UANOF           TO ACVCDA.
  9097
  9098     IF LCVOTRMI GREATER THAN LOW-VALUES
  9099
  9100* EXEC CICS BIF DEEDIT
  9101*            FIELD (LCVOTRMI)
  9102*            LENGTH(3)
  9103*        END-EXEC
  9104     MOVE 3
  9105       TO DFHEIV11
  9106*    MOVE '@"L                   #   #00008751' TO DFHEIV0
  9107     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9108     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9109     MOVE X'2020233030303038373531' TO DFHEIV0(25:11)
  9110     CALL 'kxdfhei1' USING DFHEIV0,
  9111           LCVOTRMI,
  9112           DFHEIV11
  9113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9114         IF LCVOTRMI IS NUMERIC
  9115             MOVE LCVOTRMI       TO LCVOTRMO
  9116             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9117             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 164
* EL131.cbl
  9118         ELSE
  9119             MOVE ER-0241        TO EMI-ERROR
  9120             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9121             MOVE AL-UNBON       TO LCVOTRMA
  9122             MOVE 'X'            TO ERROR-SWITCH
  9123             MOVE -1             TO LCVOTRML
  9124     ELSE
  9125         MOVE AL-UANOF           TO LCVOTRMA.
  9126
  9127     IF ACVOTRMI GREATER THAN LOW-VALUES
  9128
  9129* EXEC CICS BIF DEEDIT
  9130*            FIELD (ACVOTRMI)
  9131*            LENGTH(3)
  9132*        END-EXEC
  9133     MOVE 3
  9134       TO DFHEIV11
  9135*    MOVE '@"L                   #   #00008769' TO DFHEIV0
  9136     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9137     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9138     MOVE X'2020233030303038373639' TO DFHEIV0(25:11)
  9139     CALL 'kxdfhei1' USING DFHEIV0,
  9140           ACVOTRMI,
  9141           DFHEIV11
  9142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9143         IF ACVOTRMI IS NUMERIC
  9144             MOVE ACVOTRMI       TO ACVOTRMO
  9145             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9146             MOVE AL-UANON       TO ACVOTRMA
  9147         ELSE
  9148             MOVE ER-0241        TO EMI-ERROR
  9149             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9150             MOVE AL-UNBON       TO ACVOTRMA
  9151             MOVE 'X'            TO ERROR-SWITCH
  9152             MOVE -1             TO ACVOTRML
  9153     ELSE
  9154         MOVE AL-UANOF           TO ACVOTRMA.
  9155
  9156     IF LCVRATEL GREATER THAN +0
  9157
  9158* EXEC CICS BIF DEEDIT
  9159*            FIELD (LCVRATEI)
  9160*            LENGTH(6)
  9161*        END-EXEC
  9162     MOVE 6
  9163       TO DFHEIV11
  9164*    MOVE '@"L                   #   #00008787' TO DFHEIV0
  9165     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9166     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9167     MOVE X'2020233030303038373837' TO DFHEIV0(25:11)
  9168     CALL 'kxdfhei1' USING DFHEIV0,
  9169           LCVRATEI,
  9170           DFHEIV11
  9171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9172         IF LCVRATEI IS NUMERIC
  9173             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9174             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9175             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 165
* EL131.cbl
  9176         ELSE
  9177             MOVE ER-2280        TO EMI-ERROR
  9178             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9179             MOVE AL-UNBON       TO LCVRATEA
  9180             MOVE 'X'            TO ERROR-SWITCH
  9181             MOVE -1             TO LCVRATEL
  9182     ELSE
  9183         MOVE AL-UNNOF           TO LCVRATEA.
  9184
  9185     IF ACVRATEL GREATER THAN +0
  9186
  9187* EXEC CICS BIF DEEDIT
  9188*            FIELD (ACVRATEI)
  9189*            LENGTH(6)
  9190*        END-EXEC
  9191     MOVE 6
  9192       TO DFHEIV11
  9193*    MOVE '@"L                   #   #00008805' TO DFHEIV0
  9194     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9195     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9196     MOVE X'2020233030303038383035' TO DFHEIV0(25:11)
  9197     CALL 'kxdfhei1' USING DFHEIV0,
  9198           ACVRATEI,
  9199           DFHEIV11
  9200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9201         IF ACVRATEI IS NUMERIC
  9202             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9203             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9204             MOVE AL-UNNON       TO ACVRATEA
  9205         ELSE
  9206             MOVE ER-2280        TO EMI-ERROR
  9207             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9208             MOVE AL-UNBON       TO ACVRATEA
  9209             MOVE 'X'            TO ERROR-SWITCH
  9210             MOVE -1             TO ACVRATEL
  9211     ELSE
  9212         MOVE AL-UNNOF           TO ACVRATEA.
  9213
  9214     IF LCVBENEL GREATER THAN ZERO
  9215
  9216* EXEC CICS BIF DEEDIT
  9217*            FIELD (LCVBENEI)
  9218*            LENGTH (11)
  9219*        END-EXEC
  9220     MOVE 11
  9221       TO DFHEIV11
  9222*    MOVE '@"L                   #   #00008823' TO DFHEIV0
  9223     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9224     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9225     MOVE X'2020233030303038383233' TO DFHEIV0(25:11)
  9226     CALL 'kxdfhei1' USING DFHEIV0,
  9227           LCVBENEI,
  9228           DFHEIV11
  9229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9230         IF LCVBENEI IS NUMERIC
  9231            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9232            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9233            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 166
* EL131.cbl
  9234         ELSE
  9235            MOVE ER-0243         TO EMI-ERROR
  9236            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9237            MOVE AL-UNBON        TO LCVBENEA
  9238            MOVE -1              TO LCVBENEL
  9239            MOVE 'X'             TO ERROR-SWITCH
  9240     ELSE
  9241         MOVE AL-UANOF           TO LCVBENEA.
  9242
  9243     IF ACVBENEL GREATER THAN ZERO
  9244
  9245* EXEC CICS BIF DEEDIT
  9246*            FIELD (ACVBENEI)
  9247*            LENGTH (11)
  9248*        END-EXEC
  9249     MOVE 11
  9250       TO DFHEIV11
  9251*    MOVE '@"L                   #   #00008841' TO DFHEIV0
  9252     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9253     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9254     MOVE X'2020233030303038383431' TO DFHEIV0(25:11)
  9255     CALL 'kxdfhei1' USING DFHEIV0,
  9256           ACVBENEI,
  9257           DFHEIV11
  9258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9259         IF ACVBENEI IS NUMERIC
  9260            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9261            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9262            MOVE AL-UNNON        TO ACVBENEA
  9263         ELSE
  9264            MOVE ER-0243         TO EMI-ERROR
  9265            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9266            MOVE AL-UNBON        TO ACVBENEA
  9267            MOVE -1              TO ACVBENEL
  9268            MOVE 'X'             TO ERROR-SWITCH
  9269     ELSE
  9270         MOVE AL-UANOF           TO ACVBENEA.
  9271
  9272     IF LCVFORMI GREATER THAN LOW-VALUES
  9273        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9274        MOVE AL-UANON            TO LCVFORMA
  9275     ELSE
  9276        MOVE AL-UANOF            TO LCVFORMA.
  9277
  9278     IF ACVFORMI GREATER THAN LOW-VALUES
  9279        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9280        MOVE AL-UANON            TO ACVFORMA
  9281     ELSE
  9282        MOVE AL-UANOF            TO ACVFORMA.
  9283
  9284     IF LCVCNDTL GREATER THAN ZERO
  9285         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9286         IF LCVCNDTI = SPACES
  9287             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9288         ELSE
  9289             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9290             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9291             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 167
* EL131.cbl
  9292             MOVE '4'            TO DC-OPTION-CODE
  9293             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9294             IF NOT DATE-CONVERSION-ERROR
  9295                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9296                 MOVE AL-UANON   TO LCVCNDTA
  9297                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9298                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9299             ELSE
  9300                 MOVE ER-0246    TO EMI-ERROR
  9301                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9302                 MOVE AL-UABON   TO LCVCNDTA
  9303                 MOVE -1         TO LCVCNDTL
  9304                 MOVE 'X'        TO ERROR-SWITCH
  9305     ELSE
  9306         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9307         MOVE AL-UANOF           TO LCVCNDTA.
  9308
  9309     IF ACVCNDTL GREATER THAN ZERO
  9310         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9311         IF ACVCNDTI = SPACES
  9312             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9313         ELSE
  9314             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9315             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9316             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9317             MOVE '4'            TO DC-OPTION-CODE
  9318             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9319             IF NOT DATE-CONVERSION-ERROR
  9320                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9321                 MOVE AL-UANON   TO ACVCNDTA
  9322                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9323                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9324             ELSE
  9325                 MOVE ER-0246    TO EMI-ERROR
  9326                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9327                 MOVE AL-UABON   TO ACVCNDTA
  9328                 MOVE -1         TO ACVCNDTL
  9329                 MOVE 'X'        TO ERROR-SWITCH
  9330     ELSE
  9331         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9332         MOVE AL-UANOF           TO ACVCNDTA.
  9333
  9334     IF APRL GREATER THAN +0
  9335
  9336* EXEC CICS BIF DEEDIT
  9337*            FIELD    (APRI)
  9338*            LENGTH   (8)
  9339*        END-EXEC
  9340     MOVE 8
  9341       TO DFHEIV11
  9342*    MOVE '@"L                   #   #00008921' TO DFHEIV0
  9343     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9344     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9345     MOVE X'2020233030303038393231' TO DFHEIV0(25:11)
  9346     CALL 'kxdfhei1' USING DFHEIV0,
  9347           APRI,
  9348           DFHEIV11
  9349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 168
* EL131.cbl
  9350         IF APRI NUMERIC
  9351            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9352            MOVE APRI            TO HOLD-APR APRO
  9353            MOVE AL-UANON        TO APRA
  9354          ELSE
  9355            MOVE ER-0259         TO EMI-ERROR
  9356            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9357            MOVE AL-UABON        TO APRA
  9358            MOVE -1              TO APRL
  9359            MOVE 'X'             TO ERROR-SWITCH
  9360     ELSE
  9361         MOVE AL-UANOF           TO APRA.
  9362
  9363     IF PMTFREQL GREATER THAN ZERO
  9364
  9365* EXEC CICS BIF DEEDIT
  9366*            FIELD    (PMTFREQI)
  9367*            LENGTH   (2)
  9368*        END-EXEC
  9369     MOVE 2
  9370       TO DFHEIV11
  9371*    MOVE '@"L                   #   #00008939' TO DFHEIV0
  9372     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9373     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9374     MOVE X'2020233030303038393339' TO DFHEIV0(25:11)
  9375     CALL 'kxdfhei1' USING DFHEIV0,
  9376           PMTFREQI,
  9377           DFHEIV11
  9378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9379         IF PMTFREQI NUMERIC
  9380            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9381            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9382            MOVE AL-UANON        TO PMTFREQA
  9383          ELSE
  9384            MOVE ER-0427         TO EMI-ERROR
  9385            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9386            MOVE AL-UABON        TO PMTFREQA
  9387            MOVE -1              TO PMTFREQL
  9388            MOVE 'X'             TO ERROR-SWITCH
  9389     ELSE
  9390         MOVE AL-UANOF           TO PMTFREQA.
  9391
  9392     IF INDGRPL GREATER THAN ZERO
  9393         IF INDGRPI = 'I' OR 'G' OR SPACE
  9394             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9395             MOVE AL-UANON       TO INDGRPA
  9396          ELSE
  9397             MOVE ER-0260        TO EMI-ERROR
  9398             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9399             MOVE AL-UABON       TO INDGRPA
  9400             MOVE -1             TO INDGRPL
  9401             MOVE 'X'            TO ERROR-SWITCH
  9402     ELSE
  9403         MOVE AL-UANOF           TO INDGRPA.
  9404
  9405     IF PREMTYPL GREATER THAN ZERO
  9406         IF PREMTYPI = '1' OR '2' OR '3'
  9407            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 169
* EL131.cbl
  9408            MOVE AL-UNNON        TO PREMTYPA
  9409            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9410          ELSE
  9411            MOVE ER-0227         TO EMI-ERROR
  9412            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9413            MOVE AL-UNBON        TO PREMTYPA
  9414            MOVE -1              TO PREMTYPL
  9415            MOVE 'X'             TO ERROR-SWITCH
  9416     ELSE
  9417         MOVE AL-UANOF           TO PREMTYPA.
  9418
  9419     IF LOANBALL GREATER THAN ZERO
  9420
  9421* EXEC CICS BIF DEEDIT
  9422*             FIELD    (LOANBALI)
  9423*             LENGTH   (9)
  9424*        END-EXEC
  9425     MOVE 9
  9426       TO DFHEIV11
  9427*    MOVE '@"L                   #   #00008984' TO DFHEIV0
  9428     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9429     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9430     MOVE X'2020233030303038393834' TO DFHEIV0(25:11)
  9431     CALL 'kxdfhei1' USING DFHEIV0,
  9432           LOANBALI,
  9433           DFHEIV11
  9434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9435         IF LOANBALI NUMERIC
  9436             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9437             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9438             MOVE AL-UNNON TO LOANBALA
  9439         ELSE
  9440             MOVE ER-0639        TO EMI-ERROR
  9441             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9442             MOVE AL-UNBON       TO LOANBALA
  9443             MOVE -1             TO LOANBALL
  9444             MOVE 'X'            TO ERROR-SWITCH
  9445     ELSE
  9446         MOVE AL-UNNOF           TO LOANBALA.
  9447
  9448*    IF LOANNOL GREATER THAN ZERO
  9449*          MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9450*          MOVE AL-UANON            TO LOANNOA
  9451*       ELSE
  9452*          MOVE AL-UANOF            TO LOANNOA.
  9453
  9454     IF REINCDI GREATER THAN LOW-VALUES
  9455        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9456        MOVE AL-UANON            TO REINCDA
  9457     ELSE
  9458        MOVE AL-UANOF            TO REINCDA.
  9459
  9460     IF CERTI GREATER THAN LOW-VALUES
  9461         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9462     ELSE
  9463         MOVE AL-UANOF           TO CERTA.
  9464
  9465     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 170
* EL131.cbl
  9466         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9467     ELSE
  9468         MOVE AL-UANOF           TO CERTEFFA.
  9469
  9470     IF CERTACTI GREATER THAN LOW-VALUES
  9471         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9472     ELSE
  9473         MOVE AL-UANOF           TO CERTACTA.
  9474
  9475     IF CERTSTI GREATER THAN LOW-VALUES
  9476         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9477     ELSE
  9478         MOVE AL-UANOF           TO CERTSTA.
  9479
  9480     IF CERTCARI GREATER THAN LOW-VALUES
  9481         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9482     ELSE
  9483         MOVE AL-UANOF           TO CERTCARA.
  9484
  9485     IF DLYACTV-RECORD-NEEDED
  9486         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9487                 1150-EXIT
  9488     END-IF.
  9489
  9490     IF CERTEFFI GREATER LOW-VALUES OR
  9491        CERTACTI GREATER LOW-VALUES OR
  9492        CERTSTI  GREATER LOW-VALUES OR
  9493        CERTCARI GREATER LOW-VALUES OR
  9494        CERTGRPI GREATER LOW-VALUES
  9495        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9496
  9497*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9498*      IF PI-PREM-TYPE NOT = '1'  AND
  9499*         PI-NO-PMTS = ZEROS
  9500*          IF LOANBALL GREATER +0 OR
  9501*             ACVBENEL GREATER +0
  9502*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9503     if not acct-found
  9504        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9505     end-if
  9506     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9507     MOVE PI-CARRIER             TO CARRIER-CODE
  9508     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9509     MOVE PI-CERT-NO             TO CERT-NO
  9510
  9511* EXEC CICS READ
  9512*        DATASET   (CLMS-FILE-ID)
  9513*        RIDFLD    (MSTR-KEY)
  9514*        SET       (ADDRESS OF CLAIM-MASTER)
  9515*        RESP      (WS-RESPONSE)
  9516*    END-EXEC
  9517*    MOVE '&"S        E          (  N#00009063' TO DFHEIV0
  9518     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9519     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9520     MOVE X'204E233030303039303633' TO DFHEIV0(25:11)
  9521     CALL 'kxdfhei1' USING DFHEIV0,
  9522           CLMS-FILE-ID,
  9523           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 171
* EL131.cbl
  9524           DFHEIV99,
  9525           MSTR-KEY,
  9526           DFHEIV99,
  9527           DFHEIV99,
  9528           DFHEIV99
  9529     SET ADDRESS OF CLAIM-MASTER TO
  9530         DFHEIV20
  9531     MOVE EIBRESP  TO WS-RESPONSE
  9532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9533     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9534     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9535     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9536     MOVE CL-CERT-STATE          TO CERT-STATE
  9537     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9538     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9539     MOVE CL-CERT-NO             TO CERT-CERT
  9540
  9541* EXEC CICS READ
  9542*       DATASET   (CERT-FILE-ID)
  9543*       RIDFLD    (CERT-KEY)
  9544*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9545*       RESP      (WS-RESPONSE)
  9546*    END-EXEC
  9547*    MOVE '&"S        E          (  N#00009076' TO DFHEIV0
  9548     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9549     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9550     MOVE X'204E233030303039303736' TO DFHEIV0(25:11)
  9551     CALL 'kxdfhei1' USING DFHEIV0,
  9552           CERT-FILE-ID,
  9553           DFHEIV20,
  9554           DFHEIV99,
  9555           CERT-KEY,
  9556           DFHEIV99,
  9557           DFHEIV99,
  9558           DFHEIV99
  9559     SET ADDRESS OF CERTIFICATE-MASTER TO
  9560         DFHEIV20
  9561     MOVE EIBRESP  TO WS-RESPONSE
  9562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9563     if mfnamei > low-values
  9564        move mfnamei to w-name-first
  9565     else
  9566        move cl-insured-1st-name to w-name-first
  9567     end-if
  9568     if mlnamei > low-values
  9569        move mlnamei to w-name-last
  9570     else
  9571        move cl-insured-last-name to w-name-last
  9572     end-if
  9573     if instypel > zeros
  9574        evaluate true
  9575           when cl-no-of-days-paid > zeros
  9576              move er-1668       to emi-error
  9577              perform 9900-error-format
  9578                                 thru 9900-exit
  9579              move al-uabon      to instypea
  9580              move -1            to instypel
  9581              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 172
* EL131.cbl
  9582           when instypei = 'C'
  9583              if w-name-first (1:10) = cm-insured-first-name
  9584                 move er-1666    to emi-error
  9585                 PERFORM 9900-ERROR-FORMAT
  9586                                 THRU 9900-EXIT
  9587                 move al-uabon   to instypea
  9588                 move -1         to instypel
  9589                 move 'X'        to error-switch
  9590              end-if
  9591           when instypei = 'P'
  9592              if (w-name-first (1:10) <> cm-insured-first-name)
  9593                 or (w-name-last <> cm-insured-last-name)
  9594                 move er-1676    to emi-error
  9595                 PERFORM 9900-ERROR-FORMAT
  9596                                 THRU 9900-EXIT
  9597                 move al-uabon   to instypea
  9598                 move -1         to instypel
  9599                 move 'X'        to error-switch
  9600              end-if
  9601        end-evaluate
  9602     end-if
  9603*    if (instypel > zeros)
  9604*       and (cl-no-of-days-paid > zero)
  9605*       move er-1668             to emi-error
  9606*       perform 9900-error-format thru 9900-exit
  9607*       move al-uabon            to instypea
  9608*       move -1                  to instypel
  9609*       move 'X'                 to error-switch
  9610*    end-if
  9611*
  9612*    if instypel > zero
  9613*       if instypei = 'C'
  9614*          if w-name-first (1:10) = cm-insured-first-name
  9615*             move er-1666          to emi-error
  9616*             PERFORM 9900-ERROR-FORMAT
  9617*                                   THRU 9900-EXIT
  9618*             move al-uabon         to instypea
  9619*             move -1               to instypel
  9620*             move 'X'              to error-switch
  9621*          end-if
  9622*       end-if
  9623*    end-if
  9624     if (pi-company-id = 'DCC' OR 'VPP')
  9625        and (acct-found)
  9626        perform 2120-check-pdef  thru 2120-exit
  9627        IF EXTENSL > ZERO
  9628           IF EXTENSI NUMERIC
  9629              IF EXTENSI >  WS-MAX-EXTENSION
  9630                AND ERPDEF-FOUND
  9631                 MOVE ER-1678          TO EMI-ERROR
  9632                 PERFORM 9900-ERROR-FORMAT
  9633                                       THRU 9900-EXIT
  9634                 MOVE AL-UABON         TO EXTENSA
  9635                 MOVE -1               TO EXTENSL
  9636                 MOVE 'X'              TO ERROR-SWITCH
  9637              ELSE
  9638                 MOVE 'X'              TO UPDATE-SWITCH
  9639              END-IF
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 173
* EL131.cbl
  9640           ELSE
  9641              MOVE ER-1778          TO EMI-ERROR
  9642              PERFORM 9900-ERROR-FORMAT
  9643                                    THRU 9900-EXIT
  9644              MOVE AL-UABON         TO EXTENSA
  9645              MOVE -1               TO EXTENSL
  9646              MOVE 'X'              TO ERROR-SWITCH
  9647           END-IF
  9648        END-IF
  9649     end-if
  9650     if benperl > zeros
  9651        move al-uanon            to benpera
  9652     end-if
  9653     if benperl > zeros
  9654        if benperi numeric
  9655           perform 1015-edit-benefit-period
  9656                                 thru 1015-exit
  9657        else
  9658           move er-1669          to emi-error
  9659           PERFORM 9900-ERROR-FORMAT
  9660                                 THRU 9900-EXIT
  9661           move al-uabon         to benpera
  9662           move -1               to benperl
  9663           move 'X'              to error-switch
  9664        end-if
  9665    end-if
  9666     if instypel > zeros
  9667        if instypei = 'P' OR 'C'
  9668           move 'X'              to update-switch
  9669                                    mstr-switch
  9670           move al-uanon         to instypea
  9671        else
  9672            move er-1654          to emi-error
  9673           PERFORM 9900-ERROR-FORMAT
  9674                                 THRU 9900-EXIT
  9675           move al-uabon         to instypea
  9676           move -1               to instypel
  9677           move 'X'              to error-switch
  9678        end-if
  9679    end-if
  9680     if accswl > zeros
  9681        if accswi = 'Y' OR 'N'
  9682           MOVE 'X'              TO UPDATE-SWITCH
  9683                                    MSTR-SWITCH
  9684           MOVE AL-UANON         TO accswa
  9685*       else
  9686*          move er-1656          to emi-error
  9687*          PERFORM 9900-ERROR-FORMAT
  9688*                                THRU 9900-EXIT
  9689*          move al-uabon         to accswa
  9690*          move -1               to accswl
  9691*          move 'X'              to error-switch
  9692*          move al-uanof         to accswa
  9693        end-if
  9694     end-if
  9695     IF CERTL = ZEROS AND
  9696        SUFXL = ZEROS
  9697          GO TO 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 174
* EL131.cbl
  9698
  9699     IF CERTL GREATER THAN ZEROS
  9700         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9701             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9702             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9703             MOVE 'X'            TO ERROR-SWITCH
  9704             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9705
  9706     IF SUFXL GREATER THAN ZEROS
  9707         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9708             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9709             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9710             MOVE 'X'            TO ERROR-SWITCH
  9711             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9712
  9713 1010-EXIT.
  9714     EXIT.
  9715
  9716 1015-edit-benefit-period.
  9717     move ' '                    to ws-benper-sw
  9718     evaluate true
  9719        when not erpdef-found
  9720           set good-benper       to true
  9721        when pd-recurring-yn (a1) = 'Y'
  9722           set good-benper       to true
  9723        when pd-recurring-yn (a1) = 'N'
  9724           if benperi < 02
  9725              set good-benper    to true
  9726           end-if
  9727        when pd-rec-crit-period (a1) numeric
  9728           if benperi <= pd-rec-crit-period (a1)
  9729              set good-benper    to true
  9730           end-if
  9731     end-evaluate
  9732     MOVE CERT-KEY               TO ELCRTT-KEY
  9733     MOVE 'B'                    TO CTRLR-REC-TYPE
  9734
  9735* EXEC CICS READ
  9736*       DATASET   ('ELCRTT')
  9737*       RIDFLD    (ELCRTT-KEY)
  9738*       INTO      (CERTIFICATE-TRAILERS)
  9739*       RESP      (WS-RESPONSE)
  9740*    END-EXEC
  9741     MOVE LENGTH OF
  9742      CERTIFICATE-TRAILERS
  9743       TO DFHEIV11
  9744     MOVE 'ELCRTT' TO DFHEIV1
  9745*    MOVE '&"IL       E          (  N#00009253' TO DFHEIV0
  9746     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9747     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9748     MOVE X'204E233030303039323533' TO DFHEIV0(25:11)
  9749     CALL 'kxdfhei1' USING DFHEIV0,
  9750           DFHEIV1,
  9751           CERTIFICATE-TRAILERS,
  9752           DFHEIV11,
  9753           ELCRTT-KEY,
  9754           DFHEIV99,
  9755           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 175
* EL131.cbl
  9756           DFHEIV99
  9757     MOVE EIBRESP  TO WS-RESPONSE
  9758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9759     IF WS-RESP-NORMAL
  9760        perform varying s1 from +1 by +1 until
  9761           (s1 > +24)
  9762           or ((cs-claim-type (s1) = cl-claim-type)
  9763           and (cs-insured-type (s1) = cl-insured-type)
  9764           and (cs-benefit-period (s1) > benperi))
  9765        end-perform
  9766        if s1 < +25
  9767           move er-1665          to emi-error
  9768           PERFORM 9900-ERROR-FORMAT
  9769                                 THRU 9900-EXIT
  9770           move al-uabon         to benpera
  9771           move -1               to benperl
  9772           move 'X'              to error-switch
  9773           go to 1015-exit
  9774*       else
  9775*          set good-benper       to true
  9776        end-if
  9777     end-if
  9778     if good-benper
  9779        move 'X'                 to update-switch
  9780                                    mstr-switch
  9781        move al-uanon            to benpera
  9782     else
  9783        move er-1669             to emi-error
  9784        PERFORM 9900-ERROR-FORMAT
  9785                                 THRU 9900-EXIT
  9786        move al-uabon            to benpera
  9787        move -1                  to benperl
  9788        move 'X'                 to error-switch
  9789     end-if
  9790     .
  9791 1015-exit.
  9792     exit.
  9793 1030-EDIT-NAME.
  9794     IF INSTYPEL > ZEROS
  9795        MOVE INSTYPEI TO CL-INSURED-TYPE
  9796     END-IF
  9797     IF MFNAMEL > +0
  9798        IF CL-INSURED-TYPE = 'C'
  9799          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  9800           MOVE ER-1675             TO EMI-ERROR
  9801           MOVE -1                  TO MFNAMEL
  9802           MOVE AL-UABON            TO MFNAMEA
  9803           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9804           MOVE 'X'                 TO ERROR-SWITCH
  9805        ELSE
  9806          IF CL-INSURED-TYPE = 'P'
  9807            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  9808             MOVE ER-1676             TO EMI-ERROR
  9809             MOVE -1                  TO MFNAMEL
  9810             MOVE AL-UABON            TO MFNAMEA
  9811             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9812             MOVE 'X'                 TO ERROR-SWITCH
  9813          END-IF
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 176
* EL131.cbl
  9814        END-IF
  9815     END-IF.
  9816
  9817 1030-EXIT.
  9818     EXIT.
  9819 1050-EDIT-BENE.
  9820     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9821     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9822     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9823     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9824     MOVE 1000               TO TRLR-SEQ-NO.
  9825
  9826
  9827* EXEC CICS HANDLE CONDITION
  9828*         NOTFND    (1052-DONE)
  9829*         ENDFILE   (1052-DONE)
  9830*    END-EXEC.
  9831*    MOVE '"$I''                  ! & #00009326' TO DFHEIV0
  9832     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9834     MOVE X'2620233030303039333236' TO DFHEIV0(25:11)
  9835     CALL 'kxdfhei1' USING DFHEIV0
  9836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9837
  9838
  9839
  9840* EXEC CICS STARTBR
  9841*        DATASET (TRLR-FILE-ID)
  9842*        RIDFLD  (TRLR-KEY)
  9843*    END-EXEC
  9844     MOVE 0
  9845       TO DFHEIV11
  9846*    MOVE '&,         G          &   #00009331' TO DFHEIV0
  9847     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9848     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9849     MOVE X'2020233030303039333331' TO DFHEIV0(25:11)
  9850     CALL 'kxdfhei1' USING DFHEIV0,
  9851           TRLR-FILE-ID,
  9852           TRLR-KEY,
  9853           DFHEIV99,
  9854           DFHEIV11,
  9855           DFHEIV99
  9856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9857
  9858
  9859     MOVE SPACES TO WS-TRLR-FILE-EOF
  9860                    WS-PAYMENT-PENDING
  9861     PERFORM 1052-READ-TRLR THRU 1052-EXIT
  9862       UNTIL  TRLR-FILE-EOF
  9863         OR PAYMENT-PENDING
  9864
  9865
  9866* EXEC CICS ENDBR
  9867*        DATASET (TRLR-FILE-ID)
  9868*    END-EXEC.
  9869     MOVE 0
  9870       TO DFHEIV11
  9871*    MOVE '&2                    $   #00009343' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 177
* EL131.cbl
  9872     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9873     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9874     MOVE X'2020233030303039333433' TO DFHEIV0(25:11)
  9875     CALL 'kxdfhei1' USING DFHEIV0,
  9876           TRLR-FILE-ID,
  9877           DFHEIV11,
  9878           DFHEIV99
  9879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9880
  9881 1050-EXIT.
  9882     EXIT.
  9883
  9884 1052-READ-TRLR.
  9885
  9886* EXEC CICS READNEXT
  9887*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9888*         DATASET  (TRLR-FILE-ID)
  9889*         RIDFLD   (TRLR-KEY)
  9890*    END-EXEC.
  9891     MOVE 0
  9892       TO DFHEIV11
  9893*    MOVE '&.S                   )   #00009350' TO DFHEIV0
  9894     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9895     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9896     MOVE X'2020233030303039333530' TO DFHEIV0(25:11)
  9897     CALL 'kxdfhei1' USING DFHEIV0,
  9898           TRLR-FILE-ID,
  9899           DFHEIV20,
  9900           DFHEIV99,
  9901           TRLR-KEY,
  9902           DFHEIV99,
  9903           DFHEIV11,
  9904           DFHEIV99,
  9905           DFHEIV99
  9906     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9907         DFHEIV20
  9908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9909
  9910
  9911     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9912       AND PI-CARRIER  = TRLR-CARRIER
  9913       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9914       AND PI-CERT-NO  = TRLR-CERT-NO
  9915        CONTINUE
  9916     ELSE
  9917        GO TO 1052-DONE
  9918     END-IF.
  9919
  9920     IF PAYMENT-TR
  9921       AND BENEFICIARY-PAID
  9922       AND AT-VOID-DT = LOW-VALUES
  9923       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9924         SET PAYMENT-PENDING TO TRUE
  9925     END-IF.
  9926
  9927     IF CORRESPONDENCE-TR
  9928        IF AT-AUTH-RCVD = 'Y'
  9929           SET AUTH-RCVD TO TRUE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 178
* EL131.cbl
  9930        ELSE
  9931        IF AT-AUTH-RCVD = 'N'
  9932           SET NO-AUTH-RCVD TO TRUE
  9933        END-IF
  9934        END-IF
  9935     END-IF.
  9936
  9937     GO TO 1052-EXIT.
  9938
  9939 1052-DONE.
  9940     SET TRLR-FILE-EOF TO TRUE.
  9941 1052-EXIT.
  9942     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 179
* EL131.cbl
  9944 1120-EDIT-PROC.
  9945     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9946     MOVE '2'                    TO CNTL-REC-TYPE.
  9947     MOVE PROCI                  TO CNTL-PROC-ID.
  9948     MOVE ZERO                   TO CNTL-SEQ-NO.
  9949
  9950
  9951* EXEC CICS HANDLE CONDITION
  9952*         NOTFND    (1120-CNTL-NOTFND)
  9953*    END-EXEC.
  9954*    MOVE '"$I                   ! '' #00009395' TO DFHEIV0
  9955     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9957     MOVE X'2720233030303039333935' TO DFHEIV0(25:11)
  9958     CALL 'kxdfhei1' USING DFHEIV0
  9959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9960
  9961
  9962
  9963* EXEC CICS READ
  9964*         SET      (ADDRESS OF CONTROL-FILE)
  9965*         DATASET  (CNTL-FILE-ID)
  9966*         RIDFLD   (CNTL-KEY)
  9967*    END-EXEC.
  9968*    MOVE '&"S        E          (   #00009399' TO DFHEIV0
  9969     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9970     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9971     MOVE X'2020233030303039333939' TO DFHEIV0(25:11)
  9972     CALL 'kxdfhei1' USING DFHEIV0,
  9973           CNTL-FILE-ID,
  9974           DFHEIV20,
  9975           DFHEIV99,
  9976           CNTL-KEY,
  9977           DFHEIV99,
  9978           DFHEIV99,
  9979           DFHEIV99
  9980     SET ADDRESS OF CONTROL-FILE TO
  9981         DFHEIV20
  9982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9983
  9984
  9985     MOVE AL-UANON               TO PROCA.
  9986     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9987     GO TO 1120-EXIT.
  9988
  9989 1120-CNTL-NOTFND.
  9990     MOVE ER-0273                TO EMI-ERROR.
  9991     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9992     MOVE AL-UABON               TO PROCA.
  9993     MOVE -1                     TO PROCL.
  9994     MOVE 'X'                    TO ERROR-SWITCH.
  9995
  9996 1120-EXIT.
  9997     EXIT.
  9998
  9999*************************************************************
 10000*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
 10001*************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 180
* EL131.cbl
 10002
 10003 1150-OUTPUT-ACTIVITY-RECORD.
 10004
 10005
 10006* EXEC CICS GETMAIN
 10007*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 10008*        LENGTH (25)
 10009*        INITIMG (WS-BLANK)
 10010*    END-EXEC.
 10011     MOVE 25
 10012       TO DFHEIV11
 10013*    MOVE ',"IL                  $   #00009425' TO DFHEIV0
 10014     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10015     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10016     MOVE X'2020233030303039343235' TO DFHEIV0(25:11)
 10017     CALL 'kxdfhei1' USING DFHEIV0,
 10018           DFHEIV20,
 10019           DFHEIV11,
 10020           WS-BLANK
 10021     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 10022         DFHEIV20
 10023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10024
 10025
 10026     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 10027     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 10028     MOVE PI-CARRIER             TO DA-CARRIER.
 10029     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
 10030     MOVE PI-CERT-NO             TO DA-CERT-NO.
 10031     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
 10032     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
 10033
 10034
 10035* EXEC CICS HANDLE CONDITION
 10036*        NOTOPEN (1150-NOTOPEN-ERROR)
 10037*        DUPREC (1150-EXIT)
 10038*    END-EXEC.
 10039*    MOVE '"$J%                  ! ( #00009439' TO DFHEIV0
 10040     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 10041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10042     MOVE X'2820233030303039343339' TO DFHEIV0(25:11)
 10043     CALL 'kxdfhei1' USING DFHEIV0
 10044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10045
 10046     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
 10047     MOVE 'DLYACTV'              TO JP-FILE-ID.
 10048     MOVE 'A'                    TO JP-RECORD-TYPE.
 10049     MOVE +48                    TO JOURNAL-LENGTH.
 10050
 10051
 10052* EXEC CICS WRITE
 10053*        DATASET ('DLYACTV')
 10054*        RIDFLD (DA-KEY)
 10055*        FROM (DAILY-ACTIVITY-RECORD)
 10056*        LENGTH (25)
 10057*    END-EXEC.
 10058     MOVE 'DLYACTV' TO DFHEIV1
 10059     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 181
* EL131.cbl
 10060       TO DFHEIV11
 10061*    MOVE '&$ L                  ''   #00009448' TO DFHEIV0
 10062     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10063     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10064     MOVE X'2020233030303039343438' TO DFHEIV0(25:11)
 10065     CALL 'kxdfhei1' USING DFHEIV0,
 10066           DFHEIV1,
 10067           DAILY-ACTIVITY-RECORD,
 10068           DFHEIV11,
 10069           DA-KEY,
 10070           DFHEIV99,
 10071           DFHEIV99
 10072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10073
 10074
 10075     GO TO 1150-EXIT.
 10076
 10077 1150-NOTOPEN-ERROR.
 10078
 10079     MOVE '2955'                 TO EMI-ERROR.
 10080     MOVE -1                     TO MAINTL.
 10081     MOVE AL-UANON               TO MAINTA.
 10082     MOVE 'X'                    TO ERROR-SWITCH.
 10083     PERFORM 9900-ERROR-FORMAT THRU
 10084             9900-EXIT.
 10085
 10086 1150-EXIT.
 10087     EXIT.
 10088
 10089*************************************************************
 10090*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
 10091*************************************************************
 10092
 10093 1240-EDIT-LIFE-CODE.
 10094
 10095     IF INVALID-BENEFIT-CODE
 10096         GO TO 1240-SET-ERROR.
 10097
 10098     MOVE SPACES                 TO BENEFIT-KEY.
 10099     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10100     MOVE '4'                    TO BEN-REC-TYPE.
 10101     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10102     MOVE ZERO                   TO BEN-SEQ-NO.
 10103
 10104
 10105* EXEC CICS READ GTEQ
 10106*         DATASET  (CNTL-FILE-ID)
 10107*         RIDFLD   (BENEFIT-KEY)
 10108*         SET      (ADDRESS OF CONTROL-FILE)
 10109*    END-EXEC.
 10110*    MOVE '&"S        G          (   #00009484' TO DFHEIV0
 10111     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10112     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10113     MOVE X'2020233030303039343834' TO DFHEIV0(25:11)
 10114     CALL 'kxdfhei1' USING DFHEIV0,
 10115           CNTL-FILE-ID,
 10116           DFHEIV20,
 10117           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 182
* EL131.cbl
 10118           BENEFIT-KEY,
 10119           DFHEIV99,
 10120           DFHEIV99,
 10121           DFHEIV99
 10122     SET ADDRESS OF CONTROL-FILE TO
 10123         DFHEIV20
 10124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10125
 10126
 10127     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10128        CF-RECORD-TYPE NOT = '4'
 10129         GO TO 1240-SET-ERROR.
 10130
 10131     MOVE ZERO                   TO COUNT-2.
 10132     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10133
 10134     IF SCREEN-ERROR
 10135         GO TO 1240-SET-ERROR.
 10136
 10137 1240-SET-CODE-SWITCHES.
 10138     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10139     MOVE AL-UANON               TO LCVCDA.
 10140     GO TO 1240-EXIT.
 10141
 10142 1240-SET-ERROR.
 10143     MOVE ER-0240                TO EMI-ERROR.
 10144     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10145     MOVE 'X'                    TO ERROR-SWITCH.
 10146     MOVE AL-UABON               TO LCVCDA.
 10147     MOVE -1                     TO LCVCDL.
 10148
 10149 1240-EXIT.
 10150     EXIT.
 10151
 10152 1310-EDIT-AH-CODE.
 10153     IF INVALID-BENEFIT-CODE
 10154         GO TO 1310-SET-ERROR.
 10155
 10156     MOVE SPACES                 TO BENEFIT-KEY.
 10157     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10158     MOVE '5'                    TO BEN-REC-TYPE.
 10159     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10160     MOVE ZERO                   TO BEN-SEQ-NO.
 10161
 10162
 10163* EXEC CICS READ GTEQ
 10164*         DATASET  (CNTL-FILE-ID)
 10165*         RIDFLD   (BENEFIT-KEY)
 10166*         SET      (ADDRESS OF CONTROL-FILE)
 10167*    END-EXEC.
 10168*    MOVE '&"S        G          (   #00009525' TO DFHEIV0
 10169     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10170     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10171     MOVE X'2020233030303039353235' TO DFHEIV0(25:11)
 10172     CALL 'kxdfhei1' USING DFHEIV0,
 10173           CNTL-FILE-ID,
 10174           DFHEIV20,
 10175           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 183
* EL131.cbl
 10176           BENEFIT-KEY,
 10177           DFHEIV99,
 10178           DFHEIV99,
 10179           DFHEIV99
 10180     SET ADDRESS OF CONTROL-FILE TO
 10181         DFHEIV20
 10182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10183
 10184
 10185     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10186        CF-RECORD-TYPE NOT = '5'
 10187         GO TO 1310-SET-ERROR.
 10188
 10189     MOVE ZERO                   TO COUNT-2.
 10190     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10191     IF SCREEN-ERROR
 10192         GO TO 1310-SET-ERROR.
 10193
 10194 1310-SET-CODE-SWITCHES.
 10195     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10196     MOVE AL-UANON               TO ACVCDA.
 10197     GO TO 1310-EXIT.
 10198
 10199 1310-SET-ERROR.
 10200     MOVE ER-0250                TO EMI-ERROR.
 10201     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10202     MOVE AL-UABON               TO ACVCDA.
 10203     MOVE 'X'                    TO ERROR-SWITCH.
 10204     MOVE -1                     TO ACVCDL.
 10205
 10206 1310-EXIT.
 10207     EXIT.
 10208
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 184
* EL131.cbl
 10210 1460-EDIT-CERT-NO.
 10211     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10212     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10213
 10214     IF WS-SAVE-CERT-NO = SPACES
 10215         MOVE ER-0203            TO EMI-ERROR
 10216         GO TO 1460-CERT-NO-ERROR.
 10217
 10218     IF WS-CERT-NO-PRIME = SPACES AND
 10219        WS-CERT-NO-SUFX GREATER THAN SPACE
 10220            MOVE ER-0210         TO EMI-ERROR
 10221            GO TO 1460-CERT-NO-ERROR.
 10222
 10223     MOVE 'X'                    TO UPDATE-SWITCH.
 10224     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10225     MOVE AL-UANON               TO CERTA.
 10226
 10227     IF SUFXL IS GREATER THAN 0
 10228         MOVE AL-UANON           TO SUFXA.
 10229
 10230     GO TO 1460-EXIT.
 10231
 10232 1460-CERT-NO-ERROR.
 10233     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10234     MOVE AL-UABON               TO SUFXA.
 10235     MOVE AL-UABON               TO CERTA.
 10236     MOVE -1                     TO CERTL.
 10237     MOVE 'X'                    TO ERROR-SWITCH.
 10238
 10239 1460-EXIT.
 10240     EXIT.
 10241
 10242 1470-EDIT-EFF.
 10243     IF CERTEFFI = SPACES
 10244         GO TO 1470-DATE-ERROR.
 10245
 10246     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10247     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10248     IF DEEDIT-DATE = ZERO
 10249         GO TO 1470-DATE-ERROR.
 10250
 10251     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10252     MOVE '4'                    TO DC-OPTION-CODE.
 10253     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10254     IF NOT DATE-CONVERSION-ERROR
 10255         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10256         MOVE AL-UANON           TO CERTEFFA
 10257         MOVE 'X'                TO UPDATE-SWITCH
 10258         MOVE 'Y'                TO CERT-KEY-SWITCH
 10259         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10260         GO TO 1470-EXIT.
 10261
 10262 1470-DATE-ERROR.
 10263     MOVE ER-0215                TO EMI-ERROR.
 10264     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10265     MOVE AL-UABON               TO CERTEFFA.
 10266     MOVE -1                     TO CERTEFFL.
 10267     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 185
* EL131.cbl
 10268
 10269 1470-EXIT.
 10270     EXIT.
 10271
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 186
* EL131.cbl
 10273 1480-EDIT-ACCT.
 10274     IF CERTACTI = SPACES
 10275         MOVE ER-0232            TO EMI-ERROR
 10276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10277         MOVE AL-UABON           TO CERTACTA
 10278         MOVE -1                 TO CERTACTL
 10279         MOVE 'X'                TO ERROR-SWITCH
 10280     ELSE
 10281         MOVE 'X'                TO UPDATE-SWITCH
 10282         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10283
 10284 1480-EXIT.
 10285     EXIT.
 10286
 10287 1490-EDIT-STATE.
 10288     IF CERTSTI = SPACES
 10289         MOVE ER-0233            TO EMI-ERROR
 10290         GO TO 1490-STATE-ERROR.
 10291
 10292     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10293     MOVE '3'                    TO CNTL-REC-TYPE.
 10294     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10295     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10296     MOVE ZERO                   TO CNTL-SEQ-NO.
 10297
 10298
 10299* EXEC CICS HANDLE CONDITION
 10300*         NOTFND (1490-STATE-NOTFND)
 10301*    END-EXEC.
 10302*    MOVE '"$I                   ! ) #00009644' TO DFHEIV0
 10303     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10305     MOVE X'2920233030303039363434' TO DFHEIV0(25:11)
 10306     CALL 'kxdfhei1' USING DFHEIV0
 10307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10308
 10309
 10310
 10311* EXEC CICS READ
 10312*         SET        (ADDRESS OF CONTROL-FILE)
 10313*         DATASET    ('ELCNTL')
 10314*         RIDFLD     (CNTL-KEY)
 10315*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10316*         GENERIC
 10317*    END-EXEC.
 10318     MOVE 'ELCNTL' TO DFHEIV1
 10319*    MOVE '&"S  KG    E          (   #00009648' TO DFHEIV0
 10320     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10321     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10322     MOVE X'2020233030303039363438' TO DFHEIV0(25:11)
 10323     CALL 'kxdfhei1' USING DFHEIV0,
 10324           DFHEIV1,
 10325           DFHEIV20,
 10326           DFHEIV99,
 10327           CNTL-KEY,
 10328           CNTL-GENERIC-LENGTH,
 10329           DFHEIV99,
 10330           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 187
* EL131.cbl
 10331     SET ADDRESS OF CONTROL-FILE TO
 10332         DFHEIV20
 10333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10334
 10335
 10336     MOVE AL-UANON               TO CERTSTA.
 10337     MOVE 'X'                    TO UPDATE-SWITCH.
 10338     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10339     GO TO 1490-EXIT.
 10340
 10341 1490-STATE-NOTFND.
 10342     MOVE ER-0149                TO EMI-ERROR.
 10343
 10344 1490-STATE-ERROR.
 10345     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10346     MOVE AL-UABON               TO CERTSTA.
 10347     MOVE -1                     TO CERTSTL.
 10348     MOVE 'X'                    TO ERROR-SWITCH.
 10349
 10350 1490-EXIT.
 10351     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 188
* EL131.cbl
 10353 1500-EDIT-CARR.
 10354     IF CERTCARI = SPACES
 10355         GO TO 1500-CARR-NOTFND.
 10356
 10357     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10358     MOVE '6'                    TO CNTL-REC-TYPE.
 10359     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10360     MOVE CERTCARI               TO CNTL-CARRIER.
 10361     MOVE ZERO                   TO CNTL-SEQ-NO.
 10362
 10363
 10364* EXEC CICS HANDLE CONDITION
 10365*         NOTFND   (1500-CARR-NOTFND)
 10366*    END-EXEC.
 10367*    MOVE '"$I                   ! * #00009683' TO DFHEIV0
 10368     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10370     MOVE X'2A20233030303039363833' TO DFHEIV0(25:11)
 10371     CALL 'kxdfhei1' USING DFHEIV0
 10372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10373
 10374
 10375
 10376* EXEC CICS READ
 10377*         SET        (ADDRESS OF CONTROL-FILE)
 10378*         DATASET    ('ELCNTL')
 10379*         RIDFLD     (CNTL-KEY)
 10380*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10381*         GENERIC
 10382*    END-EXEC.
 10383     MOVE 'ELCNTL' TO DFHEIV1
 10384*    MOVE '&"S  KG    E          (   #00009687' TO DFHEIV0
 10385     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10386     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10387     MOVE X'2020233030303039363837' TO DFHEIV0(25:11)
 10388     CALL 'kxdfhei1' USING DFHEIV0,
 10389           DFHEIV1,
 10390           DFHEIV20,
 10391           DFHEIV99,
 10392           CNTL-KEY,
 10393           CNTL-GENERIC-LENGTH,
 10394           DFHEIV99,
 10395           DFHEIV99
 10396     SET ADDRESS OF CONTROL-FILE TO
 10397         DFHEIV20
 10398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10399
 10400
 10401     MOVE AL-UANON               TO CERTCARA.
 10402     MOVE 'X'                    TO UPDATE-SWITCH.
 10403     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10404     GO TO 1500-EXIT.
 10405
 10406 1500-CARR-NOTFND.
 10407     MOVE ER-0360                TO EMI-ERROR.
 10408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10409     MOVE AL-UABON               TO CERTCARA.
 10410     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 189
* EL131.cbl
 10411     MOVE 'X'                    TO ERROR-SWITCH.
 10412
 10413 1500-EXIT.
 10414     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 190
* EL131.cbl
 10416 1510-DEEDIT-DATE.
 10417
 10418* EXEC CICS BIF DEEDIT
 10419*         FIELD    (DEEDIT-DATE-INPUT)
 10420*         LENGTH   (DATE-LENGTH)
 10421*    END-EXEC.
 10422*    MOVE '@"L                   #   #00009711' TO DFHEIV0
 10423     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10424     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10425     MOVE X'2020233030303039373131' TO DFHEIV0(25:11)
 10426     CALL 'kxdfhei1' USING DFHEIV0,
 10427           DEEDIT-DATE-INPUT,
 10428           DATE-LENGTH
 10429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10430
 10431
 10432 1510-EXIT.
 10433     EXIT.
 10434
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 191
* EL131.cbl
 10436 1620-VERIFY-ACCT.
 10437
 10438     move ' '                    to ws-eracct-sw
 10439     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10440     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10441     MOVE PI-GROUPING            TO ACCT-GROUP.
 10442     MOVE PI-STATE               TO ACCT-STATE.
 10443     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10444
 10445     IF CERTEFFI GREATER THAN LOW-VALUES
 10446         MOVE HOLD-EFF           TO ACCT-DATE
 10447     ELSE
 10448         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10449
 10450     IF CERTACTI GREATER THAN LOW-VALUES
 10451         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10452     IF CERTSTI GREATER THAN LOW-VALUES
 10453         MOVE CERTSTI            TO  ACCT-STATE.
 10454     IF CERTCARI GREATER THAN LOW-VALUES
 10455         MOVE CERTCARI           TO  ACCT-CARRIER.
 10456     IF CERTGRPI GREATER THAN LOW-VALUES
 10457         MOVE CERTGRPI           TO ACCT-GROUP.
 10458
 10459     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10460
 10461
 10462* EXEC CICS HANDLE CONDITION
 10463*         NOTFND  (1620-ACCT-NOTFND)
 10464*    END-EXEC.
 10465*    MOVE '"$I                   ! + #00009745' TO DFHEIV0
 10466     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10468     MOVE X'2B20233030303039373435' TO DFHEIV0(25:11)
 10469     CALL 'kxdfhei1' USING DFHEIV0
 10470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10471
 10472
 10473
 10474* EXEC CICS STARTBR
 10475*         DATASET   (ACCT-FILE-ID)
 10476*         RIDFLD    (ACCT-KEY)
 10477*    END-EXEC.
 10478     MOVE 0
 10479       TO DFHEIV11
 10480*    MOVE '&,         G          &   #00009749' TO DFHEIV0
 10481     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10482     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10483     MOVE X'2020233030303039373439' TO DFHEIV0(25:11)
 10484     CALL 'kxdfhei1' USING DFHEIV0,
 10485           ACCT-FILE-ID,
 10486           ACCT-KEY,
 10487           DFHEIV99,
 10488           DFHEIV11,
 10489           DFHEIV99
 10490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10491
 10492
 10493 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 192
* EL131.cbl
 10494
 10495
 10496* EXEC CICS READNEXT
 10497*         DATASET  (ACCT-FILE-ID)
 10498*         RIDFLD   (ACCT-KEY)
 10499*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10500*    END-EXEC.
 10501     MOVE 0
 10502       TO DFHEIV11
 10503*    MOVE '&.S                   )   #00009756' TO DFHEIV0
 10504     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10505     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10506     MOVE X'2020233030303039373536' TO DFHEIV0(25:11)
 10507     CALL 'kxdfhei1' USING DFHEIV0,
 10508           ACCT-FILE-ID,
 10509           DFHEIV20,
 10510           DFHEIV99,
 10511           ACCT-KEY,
 10512           DFHEIV99,
 10513           DFHEIV11,
 10514           DFHEIV99,
 10515           DFHEIV99
 10516     SET ADDRESS OF ACCOUNT-MASTER TO
 10517         DFHEIV20
 10518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10519
 10520
 10521     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10522         GO TO 1620-ACCT-NOTFND.
 10523
 10524     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10525        HOLD-EFF     LESS AM-EXPIRATION-DT
 10526         NEXT SENTENCE
 10527     ELSE
 10528         GO TO 1620-ACCT-LOOP.
 10529
 10530     set acct-found to true
 10531     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10532         GO TO 1620-ACCT-END-BROWSE.
 10533
 10534     IF LOANBALL GREATER THAN +0
 10535         IF AM-MAX-TOT-BEN NUMERIC  AND
 10536            AM-MAX-TOT-BEN GREATER THAN ZERO
 10537             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10538                 MOVE AL-UNBON     TO LOANBALA
 10539                 MOVE -1           TO LOANBALL
 10540                 MOVE 'X'          TO ERROR-SWITCH
 10541                 MOVE ER-7641      TO EMI-ERROR
 10542                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10543
 10544     IF ACVBENEL GREATER THAN +0
 10545         IF AM-MAX-MON-BEN NUMERIC  AND
 10546            AM-MAX-MON-BEN GREATER THAN ZERO
 10547             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10548                 MOVE AL-UNBON     TO ACVBENEA
 10549                 MOVE -1           TO ACVBENEL
 10550                 MOVE 'X'          TO ERROR-SWITCH
 10551                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 193
* EL131.cbl
 10552                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10553
 10554 1620-ACCT-END-BROWSE.
 10555
 10556
 10557* EXEC CICS ENDBR
 10558*         DATASET (ACCT-FILE-ID)
 10559*    END-EXEC.
 10560     MOVE 0
 10561       TO DFHEIV11
 10562*    MOVE '&2                    $   #00009797' TO DFHEIV0
 10563     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10564     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10565     MOVE X'2020233030303039373937' TO DFHEIV0(25:11)
 10566     CALL 'kxdfhei1' USING DFHEIV0,
 10567           ACCT-FILE-ID,
 10568           DFHEIV11,
 10569           DFHEIV99
 10570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10571
 10572
 10573     GO TO 1620-EXIT.
 10574
 10575 1620-ACCT-NOTFND.
 10576
 10577     MOVE -1                     TO MAINTL.
 10578     MOVE 'X'                    TO ERROR-SWITCH.
 10579     MOVE ER-0426                TO EMI-ERROR.
 10580     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10581
 10582 1620-EXIT.
 10583     EXIT.
 10584
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 194
* EL131.cbl
 10586 2000-UPDATE-CLAIM.
 10587
 10588     MOVE SPACES                 TO ERROR-SWITCH.
 10589     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10590     MOVE PI-CARRIER             TO CARRIER-CODE.
 10591     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10592     MOVE PI-CERT-NO             TO CERT-NO.
 10593
 10594     IF DELETE-CLAIM
 10595         GO TO 3000-DELETE-CLAIM.
 10596
 10597     IF  NOT MODIFY-CAP
 10598         MOVE ER-0070            TO EMI-ERROR
 10599         MOVE 'X'                TO ERROR-SWITCH
 10600         MOVE -1                 TO MAINTL
 10601         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10602         GO TO 2000-EXIT.
 10603
 10604     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10605     MOVE ZERO                   TO TRLR-SEQ-NO.
 10606
 10607
 10608* EXEC CICS READ UPDATE
 10609*         SET       (ADDRESS OF CLAIM-MASTER)
 10610*         DATASET   (CLMS-FILE-ID)
 10611*         RIDFLD    (MSTR-KEY)
 10612*    END-EXEC.
 10613*    MOVE '&"S        EU         (   #00009835' TO DFHEIV0
 10614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10615     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10616     MOVE X'2020233030303039383335' TO DFHEIV0(25:11)
 10617     CALL 'kxdfhei1' USING DFHEIV0,
 10618           CLMS-FILE-ID,
 10619           DFHEIV20,
 10620           DFHEIV99,
 10621           MSTR-KEY,
 10622           DFHEIV99,
 10623           DFHEIV99,
 10624           DFHEIV99
 10625     SET ADDRESS OF CLAIM-MASTER TO
 10626         DFHEIV20
 10627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10628
 10629
 10630     if (incl > zeros)
 10631        and (cl-no-of-pmts-made > 0)
 10632        and (hold-incur > low-values)
 10633        and (hold-incur not = cl-incurred-dt)
 10634        if hold-incur > cl-incurred-dt
 10635           move cl-incurred-dt   to dc-bin-date-1
 10636           move hold-incur       to dc-bin-date-2
 10637        else
 10638           move hold-incur       to dc-bin-date-1
 10639           move cl-incurred-dt   to dc-bin-date-2
 10640        end-if
 10641        move '1'                 to dc-option-code
 10642        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10643        if dc-elapsed-days > +180
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 195
* EL131.cbl
 10644           MOVE ER-1663             TO EMI-ERROR
 10645           PERFORM 9900-ERROR-FORMAT
 10646                                 THRU 9900-EXIT
 10647           MOVE -1                  TO MAINTL
 10648           GO TO 8110-SEND-DATA
 10649        end-if
 10650     end-if
 10651     IF (CL-PRIORITY-CD = '8')
 10652        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10653             AND 'AMWA' AND 'KMSB')
 10654        MOVE ER-8003             TO EMI-ERROR
 10655        PERFORM 9900-ERROR-FORMAT
 10656                                 THRU 9900-EXIT
 10657        MOVE -1                  TO MAINTL
 10658        GO TO 8110-SEND-DATA
 10659     END-IF
 10660
 10661     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10662         MOVE ER-0068            TO EMI-ERROR
 10663         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10664         GO TO 2000-EXIT.
 10665
 10666     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10667         MOVE ER-0068            TO EMI-ERROR
 10668         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10669         GO TO 2000-EXIT.
 10670
 10671     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10672         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10673
 10674     IF CL-PURGED-DT NOT = LOW-VALUES
 10675         MOVE ER-7691            TO EMI-ERROR
 10676         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10677         GO TO 2000-EXIT.
 10678
 10679     IF CERT-KEY-CHANGED
 10680         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10681
 10682     IF SCREEN-ERROR
 10683         MOVE ER-0068            TO EMI-ERROR
 10684         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10685         GO TO 2000-EXIT.
 10686
 10687     IF NINETY-TRLR-UPDATED
 10688         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10689
 10690     IF MSTR-KEY-CHANGED
 10691         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10692        ELSE
 10693         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10694
 10695     IF TRLR-UPDATE-REQUIRED
 10696         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10697
 10698 2000-CHECK-CERT.
 10699     IF NOT CERT-UPDATES
 10700         GO TO 2000-EXIT.
 10701
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 196
* EL131.cbl
 10702     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10703     MOVE PI-CARRIER             TO CERT-CARRIER.
 10704     MOVE PI-GROUPING            TO CERT-GROUP.
 10705     MOVE PI-STATE               TO CERT-STATE.
 10706     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10707     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10708     MOVE PI-CERT-NO             TO CERT-CERT.
 10709
 10710     IF CERT-ALT-KEY-CHANGED
 10711         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10712     ELSE
 10713         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10714
 10715 2000-EXIT.
 10716     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 197
* EL131.cbl
 10718 2010-RELEASE-REC.
 10719
 10720* EXEC CICS UNLOCK
 10721*         DATASET  (CLMS-FILE-ID)
 10722*    END-EXEC
 10723*    MOVE '&*                    #   #00009930' TO DFHEIV0
 10724     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10725     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10726     MOVE X'2020233030303039393330' TO DFHEIV0(25:11)
 10727     CALL 'kxdfhei1' USING DFHEIV0,
 10728           CLMS-FILE-ID,
 10729           DFHEIV99
 10730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10731
 10732     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10733     MOVE 'X'                    TO ERROR-SWITCH.
 10734
 10735 2010-EXIT.
 10736     EXIT.
 10737
 10738 2020-NORMAL-UPDATE.
 10739     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10740
 10741     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10742
 10743     IF WS-OPEN-CLOSE-SW = 'Y'
 10744       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10745       IF PI-REC-FOUND-SW = 'Y'
 10746         IF CL-ACTIVITY-CODE = 09
 10747           NEXT SENTENCE
 10748         ELSE
 10749           IF WS-RESET-SW = 'Y'
 10750             IF CL-CLAIM-STATUS = 'C'
 10751               MOVE 07               TO  CL-ACTIVITY-CODE
 10752               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10753               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10754             ELSE
 10755               MOVE 08               TO  CL-ACTIVITY-CODE
 10756               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10757               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10758
 10759     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10760         MOVE 'Y'                TO CL-YESNOSW
 10761     END-IF.
 10762
 10763     if pi-company-id = 'DCC' OR 'VPP'
 10764        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10765        perform 2120-check-pdef  thru 2120-exit
 10766     end-if
 10767     if ((benperl <> zeros)
 10768        and (benperi numeric))
 10769                  or
 10770            (instypel <> zeros)
 10771        perform 2140-update-elcrtt thru 2140-exit
 10772     end-if
 10773
 10774* EXEC CICS HANDLE CONDITION
 10775*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 198
* EL131.cbl
 10776*    END-EXEC.
 10777*    MOVE '"$$                   ! , #00009975' TO DFHEIV0
 10778     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10780     MOVE X'2C20233030303039393735' TO DFHEIV0(25:11)
 10781     CALL 'kxdfhei1' USING DFHEIV0
 10782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10783
 10784
 10785
 10786* EXEC CICS REWRITE
 10787*         DATASET   (CLMS-FILE-ID)
 10788*         FROM      (CLAIM-MASTER)
 10789*    END-EXEC.
 10790     MOVE LENGTH OF
 10791      CLAIM-MASTER
 10792       TO DFHEIV11
 10793*    MOVE '&& L                  %   #00009979' TO DFHEIV0
 10794     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10795     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10796     MOVE X'2020233030303039393739' TO DFHEIV0(25:11)
 10797     CALL 'kxdfhei1' USING DFHEIV0,
 10798           CLMS-FILE-ID,
 10799           CLAIM-MASTER,
 10800           DFHEIV11,
 10801           DFHEIV99
 10802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10803
 10804
 10805 2020-EXIT.
 10806     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 199
* EL131.cbl
 10808 2030-KEY-UPDATE.
 10809     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10810
 10811
 10812* EXEC CICS DELETE
 10813*        DATASET  (CLMS-FILE-ID)
 10814*    END-EXEC.
 10815*    MOVE '&(                    &   #00009990' TO DFHEIV0
 10816     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10817     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10818     MOVE X'2020233030303039393930' TO DFHEIV0(25:11)
 10819     CALL 'kxdfhei1' USING DFHEIV0,
 10820           CLMS-FILE-ID,
 10821           DFHEIV99,
 10822           DFHEIV99,
 10823           DFHEIV99,
 10824           DFHEIV99
 10825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10826
 10827
 10828
 10829* EXEC CICS GETMAIN
 10830*         SET      (ADDRESS OF CLAIM-MASTER)
 10831*         LENGTH   (MSTR-LENGTH)
 10832*         INITIMG  (GETMAIN-SPACE)
 10833*    END-EXEC.
 10834*    MOVE ',"IL                  $   #00009994' TO DFHEIV0
 10835     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10836     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10837     MOVE X'2020233030303039393934' TO DFHEIV0(25:11)
 10838     CALL 'kxdfhei1' USING DFHEIV0,
 10839           DFHEIV20,
 10840           MSTR-LENGTH,
 10841           GETMAIN-SPACE
 10842     SET ADDRESS OF CLAIM-MASTER TO
 10843         DFHEIV20
 10844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10845
 10846
 10847     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10848
 10849     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10850
 10851     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10852
 10853     IF WS-OPEN-CLOSE-SW = 'Y'
 10854       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10855         IF PI-REC-FOUND-SW = 'Y'
 10856           IF CL-ACTIVITY-CODE = 09
 10857             NEXT SENTENCE
 10858           ELSE
 10859             IF WS-RESET-SW = 'Y'
 10860               IF CL-CLAIM-STATUS = 'C'
 10861                 MOVE 07             TO  CL-ACTIVITY-CODE
 10862                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10863                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10864               ELSE
 10865                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 200
* EL131.cbl
 10866                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10867                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10868
 10869
 10870* EXEC CICS HANDLE CONDITION
 10871*         DUPKEY    (2030-EXIT)
 10872*    END-EXEC.
 10873*    MOVE '"$$                   ! - #00010022' TO DFHEIV0
 10874     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10875     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10876     MOVE X'2D20233030303130303232' TO DFHEIV0(25:11)
 10877     CALL 'kxdfhei1' USING DFHEIV0
 10878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10879
 10880
 10881** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10882*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10883
 10884     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10885         MOVE 'Y'                TO CL-YESNOSW
 10886     END-IF.
 10887
 10888
 10889* EXEC CICS WRITE
 10890*         DATASET   (CLMS-FILE-ID)
 10891*         RIDFLD    (MSTR-KEY)
 10892*         FROM      (CLAIM-MASTER)
 10893*    END-EXEC.
 10894     MOVE LENGTH OF
 10895      CLAIM-MASTER
 10896       TO DFHEIV11
 10897*    MOVE '&$ L                  ''   #00010033' TO DFHEIV0
 10898     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10899     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10900     MOVE X'2020233030303130303333' TO DFHEIV0(25:11)
 10901     CALL 'kxdfhei1' USING DFHEIV0,
 10902           CLMS-FILE-ID,
 10903           CLAIM-MASTER,
 10904           DFHEIV11,
 10905           MSTR-KEY,
 10906           DFHEIV99,
 10907           DFHEIV99
 10908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10909
 10910
 10911 2030-EXIT.
 10912     EXIT.
 10913
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 201
* EL131.cbl
 10915 2040-NORMAL-UPDATE.
 10916
 10917* EXEC CICS READ UPDATE
 10918*         DATASET  (CERT-FILE-ID)
 10919*         RIDFLD   (CERT-KEY)
 10920*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10921*    END-EXEC.
 10922*    MOVE '&"S        EU         (   #00010044' TO DFHEIV0
 10923     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10924     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10925     MOVE X'2020233030303130303434' TO DFHEIV0(25:11)
 10926     CALL 'kxdfhei1' USING DFHEIV0,
 10927           CERT-FILE-ID,
 10928           DFHEIV20,
 10929           DFHEIV99,
 10930           CERT-KEY,
 10931           DFHEIV99,
 10932           DFHEIV99,
 10933           DFHEIV99
 10934     SET ADDRESS OF CERTIFICATE-MASTER TO
 10935         DFHEIV20
 10936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10937
 10938
 10939     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10940
 10941
 10942* EXEC CICS HANDLE CONDITION
 10943*         DUPKEY   (2040-EXIT)
 10944*    END-EXEC.
 10945*    MOVE '"$$                   ! . #00010052' TO DFHEIV0
 10946     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10947     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10948     MOVE X'2E20233030303130303532' TO DFHEIV0(25:11)
 10949     CALL 'kxdfhei1' USING DFHEIV0
 10950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10951
 10952
 10953
 10954* EXEC CICS REWRITE
 10955*         DATASET  (CERT-FILE-ID)
 10956*         FROM     (CERTIFICATE-MASTER)
 10957*    END-EXEC.
 10958     MOVE LENGTH OF
 10959      CERTIFICATE-MASTER
 10960       TO DFHEIV11
 10961*    MOVE '&& L                  %   #00010056' TO DFHEIV0
 10962     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10963     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10964     MOVE X'2020233030303130303536' TO DFHEIV0(25:11)
 10965     CALL 'kxdfhei1' USING DFHEIV0,
 10966           CERT-FILE-ID,
 10967           CERTIFICATE-MASTER,
 10968           DFHEIV11,
 10969           DFHEIV99
 10970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10971
 10972
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 202
* EL131.cbl
 10973 2040-EXIT.
 10974     EXIT.
 10975
 10976 2050-KEY-UPDATE.
 10977
 10978* EXEC CICS READ UPDATE
 10979*         DATASET  (CERT-FILE-ID)
 10980*         RIDFLD   (CERT-KEY)
 10981*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10982*    END-EXEC.
 10983*    MOVE '&"S        EU         (   #00010065' TO DFHEIV0
 10984     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10985     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10986     MOVE X'2020233030303130303635' TO DFHEIV0(25:11)
 10987     CALL 'kxdfhei1' USING DFHEIV0,
 10988           CERT-FILE-ID,
 10989           DFHEIV20,
 10990           DFHEIV99,
 10991           CERT-KEY,
 10992           DFHEIV99,
 10993           DFHEIV99,
 10994           DFHEIV99
 10995     SET ADDRESS OF CERTIFICATE-MASTER TO
 10996         DFHEIV20
 10997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10998
 10999
 11000     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 11001
 11002
 11003* EXEC CICS DELETE
 11004*         DATASET   (CERT-FILE-ID)
 11005*    END-EXEC.
 11006*    MOVE '&(                    &   #00010073' TO DFHEIV0
 11007     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11008     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11009     MOVE X'2020233030303130303733' TO DFHEIV0(25:11)
 11010     CALL 'kxdfhei1' USING DFHEIV0,
 11011           CERT-FILE-ID,
 11012           DFHEIV99,
 11013           DFHEIV99,
 11014           DFHEIV99,
 11015           DFHEIV99
 11016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11017
 11018
 11019
 11020* EXEC CICS GETMAIN
 11021*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11022*         LENGTH    (CERT-LENGTH)
 11023*         INITIMG   (GETMAIN-SPACE)
 11024*    END-EXEC.
 11025*    MOVE ',"IL                  $   #00010077' TO DFHEIV0
 11026     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11027     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11028     MOVE X'2020233030303130303737' TO DFHEIV0(25:11)
 11029     CALL 'kxdfhei1' USING DFHEIV0,
 11030           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 203
* EL131.cbl
 11031           CERT-LENGTH,
 11032           GETMAIN-SPACE
 11033     SET ADDRESS OF CERTIFICATE-MASTER TO
 11034         DFHEIV20
 11035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11036
 11037
 11038     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 11039
 11040     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11041
 11042
 11043* EXEC CICS HANDLE CONDITION
 11044*         DUPKEY (2050-EXIT)
 11045*    END-EXEC.
 11046*    MOVE '"$$                   ! / #00010087' TO DFHEIV0
 11047     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11049     MOVE X'2F20233030303130303837' TO DFHEIV0(25:11)
 11050     CALL 'kxdfhei1' USING DFHEIV0
 11051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11052
 11053
 11054
 11055* EXEC CICS WRITE
 11056*         DATASET  (CERT-FILE-ID)
 11057*         RIDFLD   (CERT-KEY)
 11058*         FROM     (CERTIFICATE-MASTER)
 11059*    END-EXEC.
 11060     MOVE LENGTH OF
 11061      CERTIFICATE-MASTER
 11062       TO DFHEIV11
 11063*    MOVE '&$ L                  ''   #00010091' TO DFHEIV0
 11064     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11065     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11066     MOVE X'2020233030303130303931' TO DFHEIV0(25:11)
 11067     CALL 'kxdfhei1' USING DFHEIV0,
 11068           CERT-FILE-ID,
 11069           CERTIFICATE-MASTER,
 11070           DFHEIV11,
 11071           CERT-KEY,
 11072           DFHEIV99,
 11073           DFHEIV99
 11074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11075
 11076
 11077 2050-EXIT.
 11078     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 204
* EL131.cbl
 11080 2060-CHANGE-CERT.
 11081     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11082     MOVE PI-CARRIER             TO CERT-CARRIER.
 11083     MOVE PI-GROUPING            TO CERT-GROUP.
 11084     MOVE PI-STATE               TO CERT-STATE.
 11085     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11086     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11087     MOVE PI-CERT-NO             TO CERT-CERT.
 11088     IF CERTEFFI GREATER THAN LOW-VALUES
 11089         MOVE HOLD-EFF           TO CERT-DATE.
 11090     IF CERTACTI GREATER THAN LOW-VALUES
 11091         MOVE CERTACTI           TO CERT-ACCOUNT.
 11092     IF CERTSTI GREATER THAN LOW-VALUES
 11093         MOVE CERTSTI            TO CERT-STATE.
 11094     IF CERTCARI GREATER THAN LOW-VALUES
 11095         MOVE CERTCARI           TO CERT-CARRIER.
 11096     IF CERTGRPI GREATER THAN LOW-VALUES
 11097         MOVE CERTGRPI           TO CERT-GROUP.
 11098     IF CERTI GREATER THAN LOW-VALUES
 11099         MOVE CERTI              TO CERT-CERT-PRIME.
 11100     IF SUFXI GREATER THAN LOW-VALUES
 11101         MOVE SUFXI              TO CERT-CERT-SUFX.
 11102
 11103
 11104* EXEC CICS HANDLE CONDITION
 11105*         NOTFND   (2060-CERT-NOTFND)
 11106*    END-EXEC.
 11107*    MOVE '"$I                   ! 0 #00010123' TO DFHEIV0
 11108     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11110     MOVE X'3020233030303130313233' TO DFHEIV0(25:11)
 11111     CALL 'kxdfhei1' USING DFHEIV0
 11112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11113
 11114
 11115
 11116* EXEC CICS READ UPDATE
 11117*         DATASET  (CERT-FILE-ID)
 11118*         RIDFLD   (CERT-KEY)
 11119*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11120*    END-EXEC.
 11121*    MOVE '&"S        EU         (   #00010127' TO DFHEIV0
 11122     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11123     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11124     MOVE X'2020233030303130313237' TO DFHEIV0(25:11)
 11125     CALL 'kxdfhei1' USING DFHEIV0,
 11126           CERT-FILE-ID,
 11127           DFHEIV20,
 11128           DFHEIV99,
 11129           CERT-KEY,
 11130           DFHEIV99,
 11131           DFHEIV99,
 11132           DFHEIV99
 11133     SET ADDRESS OF CERTIFICATE-MASTER TO
 11134         DFHEIV20
 11135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11136
 11137
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 205
* EL131.cbl
 11138     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 11139
 11140     IF CM-CLAIM-INTERFACE-SW = SPACES
 11141        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11142
 11143
 11144* EXEC CICS HANDLE CONDITION
 11145*         DUPKEY   (2060-DUPKEY)
 11146*    END-EXEC.
 11147*    MOVE '"$$                   ! 1 #00010138' TO DFHEIV0
 11148     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11150     MOVE X'3120233030303130313338' TO DFHEIV0(25:11)
 11151     CALL 'kxdfhei1' USING DFHEIV0
 11152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11153
 11154
 11155
 11156* EXEC CICS REWRITE
 11157*         DATASET  (CERT-FILE-ID)
 11158*         FROM     (CERTIFICATE-MASTER)
 11159*    END-EXEC.
 11160     MOVE LENGTH OF
 11161      CERTIFICATE-MASTER
 11162       TO DFHEIV11
 11163*    MOVE '&& L                  %   #00010142' TO DFHEIV0
 11164     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11165     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11166     MOVE X'2020233030303130313432' TO DFHEIV0(25:11)
 11167     CALL 'kxdfhei1' USING DFHEIV0,
 11168           CERT-FILE-ID,
 11169           CERTIFICATE-MASTER,
 11170           DFHEIV11,
 11171           DFHEIV99
 11172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11173
 11174
 11175 2060-DUPKEY.
 11176
 11177     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11178
 11179 2060-CHANGE-TRLR-ACTQ.
 11180     IF SCREEN-ERROR
 11181         GO TO 2060-EXIT.
 11182
 11183     IF CERTI    GREATER LOW-VALUES OR
 11184        SUFXI    GREATER LOW-VALUES OR
 11185        CERTCARI GREATER LOW-VALUES
 11186         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11187         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11188
 11189     MOVE SPACES                 TO CERT-KEY-SWITCH
 11190                                    CERT-SWITCH
 11191                                    TRLR-SWITCH
 11192                                    NINETY-TRLR-SWITCH.
 11193     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11194     GO TO 2060-EXIT.
 11195
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 206
* EL131.cbl
 11196 2060-CERT-NOTFND.
 11197     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11198
 11199     IF WS-REC-FOUND-SW = 'N'
 11200         MOVE ER-0206            TO  EMI-ERROR
 11201         MOVE -1                 TO  MAINTL
 11202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11203
 11204* EXEC CICS UNLOCK
 11205*            DATASET   (CLMS-FILE-ID)
 11206*        END-EXEC
 11207*    MOVE '&*                    #   #00010175' TO DFHEIV0
 11208     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11209     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11210     MOVE X'2020233030303130313735' TO DFHEIV0(25:11)
 11211     CALL 'kxdfhei1' USING DFHEIV0,
 11212           CLMS-FILE-ID,
 11213           DFHEIV99
 11214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11215         GO TO 8110-SEND-DATA.
 11216
 11217     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11218
 11219     GO TO 2060-CHANGE-TRLR-ACTQ.
 11220
 11221 2060-EXIT.
 11222     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 207
* EL131.cbl
 11224 2070-CHECK-OLD.
 11225
 11226
 11227* EXEC CICS HANDLE CONDITION
 11228*        NOTFND   (2070-NOT-FOUND)
 11229*    END-EXEC.
 11230*    MOVE '"$I                   ! 2 #00010189' TO DFHEIV0
 11231     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11233     MOVE X'3220233030303130313839' TO DFHEIV0(25:11)
 11234     CALL 'kxdfhei1' USING DFHEIV0
 11235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11236
 11237
 11238     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11239     MOVE PI-CARRIER             TO CERT-CARRIER.
 11240     MOVE PI-GROUPING            TO CERT-GROUP.
 11241     MOVE PI-STATE               TO CERT-STATE.
 11242     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11243     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11244     MOVE PI-CERT-NO             TO CERT-CERT.
 11245
 11246
 11247* EXEC CICS READ UPDATE
 11248*         DATASET  (CERT-FILE-ID)
 11249*         RIDFLD   (CERT-KEY)
 11250*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11251*    END-EXEC.
 11252*    MOVE '&"S        EU         (   #00010201' TO DFHEIV0
 11253     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11254     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11255     MOVE X'2020233030303130323031' TO DFHEIV0(25:11)
 11256     CALL 'kxdfhei1' USING DFHEIV0,
 11257           CERT-FILE-ID,
 11258           DFHEIV20,
 11259           DFHEIV99,
 11260           CERT-KEY,
 11261           DFHEIV99,
 11262           DFHEIV99,
 11263           DFHEIV99
 11264     SET ADDRESS OF CERTIFICATE-MASTER TO
 11265         DFHEIV20
 11266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11267
 11268
 11269     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11270     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11271     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11272
 11273     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11274         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11275
 11276     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11277       AND
 11278        CERT-WAS-CREATED-FOR-CLAIM
 11279         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11280
 11281* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 208
* EL131.cbl
 11282*             DATASET   (CERT-FILE-ID)
 11283*        END-EXEC
 11284*    MOVE '&(                    &   #00010218' TO DFHEIV0
 11285     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11286     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11287     MOVE X'2020233030303130323138' TO DFHEIV0(25:11)
 11288     CALL 'kxdfhei1' USING DFHEIV0,
 11289           CERT-FILE-ID,
 11290           DFHEIV99,
 11291           DFHEIV99,
 11292           DFHEIV99,
 11293           DFHEIV99
 11294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11295         GO TO 2070-EXIT.
 11296
 11297     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11298         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11299
 11300
 11301* EXEC CICS HANDLE CONDITION
 11302*         DUPKEY   (2070-EXIT)
 11303*    END-EXEC.
 11304*    MOVE '"$$                   ! 3 #00010226' TO DFHEIV0
 11305     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11307     MOVE X'3320233030303130323236' TO DFHEIV0(25:11)
 11308     CALL 'kxdfhei1' USING DFHEIV0
 11309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11310
 11311
 11312
 11313* EXEC CICS REWRITE
 11314*         DATASET  (CERT-FILE-ID)
 11315*         FROM     (CERTIFICATE-MASTER)
 11316*    END-EXEC.
 11317     MOVE LENGTH OF
 11318      CERTIFICATE-MASTER
 11319       TO DFHEIV11
 11320*    MOVE '&& L                  %   #00010230' TO DFHEIV0
 11321     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11322     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11323     MOVE X'2020233030303130323330' TO DFHEIV0(25:11)
 11324     CALL 'kxdfhei1' USING DFHEIV0,
 11325           CERT-FILE-ID,
 11326           CERTIFICATE-MASTER,
 11327           DFHEIV11,
 11328           DFHEIV99
 11329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11330
 11331
 11332     GO TO 2070-EXIT.
 11333
 11334 2070-NOT-FOUND.
 11335     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11336
 11337 2070-EXIT.
 11338     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 209
* EL131.cbl
 11340 2080-CREATE-CERT.
 11341
 11342* EXEC CICS GETMAIN
 11343*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11344*         LENGTH    (CERT-LENGTH)
 11345*         INITIMG   (GETMAIN-SPACE)
 11346*    END-EXEC.
 11347*    MOVE ',"IL                  $   #00010244' TO DFHEIV0
 11348     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11349     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11350     MOVE X'2020233030303130323434' TO DFHEIV0(25:11)
 11351     CALL 'kxdfhei1' USING DFHEIV0,
 11352           DFHEIV20,
 11353           CERT-LENGTH,
 11354           GETMAIN-SPACE
 11355     SET ADDRESS OF CERTIFICATE-MASTER TO
 11356         DFHEIV20
 11357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11358
 11359
 11360     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11361
 11362     IF CERTEFFI GREATER THAN LOW-VALUES
 11363         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11364                                    DC-BIN-DATE-1
 11365         MOVE '6'                TO DC-OPTION-CODE
 11366         MOVE +1                 TO DC-ELAPSED-MONTHS
 11367         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11368         IF NO-CONVERSION-ERROR
 11369             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11370
 11371     IF CERTACTI GREATER THAN LOW-VALUES
 11372         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11373     IF CERTSTI GREATER THAN LOW-VALUES
 11374         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11375     IF CERTCARI GREATER THAN LOW-VALUES
 11376         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11377     IF CERTGRPI GREATER THAN LOW-VALUES
 11378         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11379     IF CERTI GREATER THAN LOW-VALUES
 11380         MOVE CERTI              TO CERT-CERT-PRIME
 11381                                    CM-CERT-PRIME
 11382         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11383
 11384     IF SUFXI GREATER THAN LOW-VALUES
 11385         MOVE SUFXI              TO CERT-CERT-SUFX
 11386                                    CM-CERT-SFX
 11387         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11388
 11389     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11390
 11391     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11392
 11393     MOVE SPACES                 TO CM-ENTRY-BATCH
 11394                                    CM-LF-EXIT-BATCH
 11395                                    CM-AH-EXIT-BATCH
 11396                                    CM-CREDIT-INTERFACE-SW-1
 11397                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 210
* EL131.cbl
 11398
 11399     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11400                               '9' OR 'D' OR 'V'
 11401         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11402
 11403     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11404                               '9' OR 'D' OR 'V'
 11405         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11406
 11407     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11408                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11409     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11410
 11411
 11412* EXEC CICS HANDLE CONDITION
 11413*         DUPKEY (2080-EXIT)
 11414*    END-EXEC.
 11415*    MOVE '"$$                   ! 4 #00010301' TO DFHEIV0
 11416     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11417     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11418     MOVE X'3420233030303130333031' TO DFHEIV0(25:11)
 11419     CALL 'kxdfhei1' USING DFHEIV0
 11420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11421
 11422
 11423
 11424* EXEC CICS WRITE
 11425*         DATASET  (CERT-FILE-ID)
 11426*         RIDFLD   (CERT-KEY)
 11427*         FROM     (CERTIFICATE-MASTER)
 11428*    END-EXEC.
 11429     MOVE LENGTH OF
 11430      CERTIFICATE-MASTER
 11431       TO DFHEIV11
 11432*    MOVE '&$ L                  ''   #00010305' TO DFHEIV0
 11433     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11434     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11435     MOVE X'2020233030303130333035' TO DFHEIV0(25:11)
 11436     CALL 'kxdfhei1' USING DFHEIV0,
 11437           CERT-FILE-ID,
 11438           CERTIFICATE-MASTER,
 11439           DFHEIV11,
 11440           CERT-KEY,
 11441           DFHEIV99,
 11442           DFHEIV99
 11443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11444
 11445
 11446 2080-EXIT.
 11447     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 211
* EL131.cbl
 11449 2100-MOVE-MSTR.
 11450     IF TYPEI GREATER THAN LOW-VALUES
 11451         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11452
 11453     IF STATUSI = LOW-VALUES
 11454         GO TO 2100-NO-STATUS-CHANGE.
 11455
 11456     IF STATUSI = 'OPEN' OR 'O'
 11457         IF CL-CLAIM-STATUS = 'O'
 11458             MOVE SPACES         TO TRLR-SWITCH
 11459                 GO TO 2100-NO-STATUS-CHANGE.
 11460
 11461     IF STATUSI = 'CLOSED' OR 'C'
 11462         IF CL-CLAIM-STATUS = 'C'
 11463             MOVE SPACES         TO TRLR-SWITCH
 11464                 GO TO 2100-NO-STATUS-CHANGE.
 11465
 11466     IF PI-COMPANY-ID = 'DMD'
 11467        IF STATUSI = 'OPEN' OR 'O'
 11468           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11469              MOVE ZERO       TO STATUSL
 11470              MOVE LOW-VALUES TO STATUSI
 11471              GO TO 2100-NO-STATUS-CHANGE.
 11472
 11473     IF PI-COMPANY-ID = 'DMD'
 11474         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11475
 11476     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11477
 11478 2100-NO-STATUS-CHANGE.
 11479
 11480     IF CCNOI GREATER THAN LOW-VALUES
 11481         MOVE CCNOI              TO CL-CCN.
 11482
 11483     IF PROCI GREATER THAN LOW-VALUES
 11484         MOVE PROCI              TO CL-PROCESSOR-ID.
 11485
 11486     if (accswi > low-values)
 11487        and (accswi = 'Y' OR 'N')
 11488        move accswi              to cl-accident-claim-sw
 11489     end-if
 11490     if benperi > low-values
 11491        and benperi numeric
 11492        move benperi             to cl-benefit-period
 11493     end-if
 11494     if instypei > low-values
 11495        move instypei            to cl-insured-type
 11496     end-if
 11497     IF SEXI GREATER THAN LOW-VALUES
 11498         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11499
 11500     IF BIRTHI GREATER THAN LOW-VALUES
 11501         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11502
 11503     IF SOCIALI GREATER THAN LOW-VALUES
 11504       AND
 11505        SOCIALI = SPACES
 11506         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 212
* EL131.cbl
 11507         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11508         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11509     ELSE
 11510         IF SOCIALI GREATER THAN LOW-VALUES
 11511             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11512
 11513     IF OCCI GREATER THAN LOW-VALUES
 11514         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11515
 11516     IF BENEL GREATER THAN ZERO
 11517         MOVE BENEI              TO CL-BENEFICIARY.
 11518
 11519     IF DIAGI GREATER THAN LOW-VALUES
 11520         MOVE DIAGI              TO WS-DIAGNOSIS.
 11521
 11522     IF ICD1I GREATER THAN LOW-VALUES
 11523         MOVE ICD1I              TO WS-ICD-CODE-1
 11524     END-IF.
 11525
 11526     IF ICD2I GREATER THAN LOW-VALUES
 11527         MOVE ICD2I              TO WS-ICD-CODE-2
 11528     END-IF.
 11529
 11530     IF PREMTYPI GREATER THAN LOW-VALUES
 11531         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11532
 11533*    IF CAUSEI GREATER THAN LOW-VALUES
 11534*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11535
 11536*    IF ENDI GREATER THAN LOW-VALUES
 11537*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11538
 11539     IF PDTHRUI GREATER THAN LOW-VALUES
 11540        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11541
 11542     IF PDAMTL GREATER THAN +0
 11543        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11544
 11545     IF NODAYSI GREATER THAN LOW-VALUES
 11546        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11547
 11548     IF NOPMTSI GREATER THAN LOW-VALUES
 11549        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11550
 11551     IF FORMTYPI GREATER THAN LOW-VALUES
 11552        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11553
 11554     IF INCI GREATER THAN LOW-VALUES
 11555        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11556
 11557     IF REPI GREATER THAN LOW-VALUES
 11558        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11559
 11560     IF ADDONDTI GREATER THAN LOW-VALUES
 11561        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11562
 11563     IF PRICDI GREATER THAN LOW-VALUES
 11564         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 213
* EL131.cbl
 11565
 11566     IF CRITPL  > ZEROS
 11567        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11568     END-IF
 11569
 11570     IF EXTENSL  > ZEROS
 11571        MOVE EXTENSI             TO CL-NO-OF-EXTENSIONS
 11572     END-IF
 11573*    IF CRITPTL > ZEROS
 11574*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11575*    END-IF
 11576
 11577*    IF RTWMOSL > ZEROS
 11578*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11579*    END-IF
 11580     IF FILETOI GREATER THAN LOW-VALUES
 11581         MOVE FILETOI            TO CL-FILE-LOCATION.
 11582
 11583     IF SUPVI GREATER THAN LOW-VALUES
 11584         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11585
 11586     IF MLNAMEI GREATER THAN LOW-VALUES
 11587         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11588
 11589     IF MFNAMEI GREATER THAN LOW-VALUES
 11590         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11591
 11592     IF MMINITI GREATER THAN LOW-VALUES
 11593         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11594
 11595     IF CERTEFFI GREATER THAN LOW-VALUES
 11596         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11597
 11598     IF CERTACTI GREATER THAN LOW-VALUES
 11599         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11600
 11601     IF CERTSTI GREATER THAN LOW-VALUES
 11602         MOVE CERTSTI            TO CL-CERT-STATE.
 11603
 11604     IF CERTCARI GREATER THAN LOW-VALUES
 11605         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11606                                    CL-CARRIER.
 11607
 11608     IF CERTGRPI GREATER THAN LOW-VALUES
 11609         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11610
 11611     IF CERTI GREATER THAN LOW-VALUES
 11612         MOVE CERTI              TO CERT-NO-PRIME.
 11613
 11614     IF SUFXI GREATER THAN LOW-VALUES
 11615         MOVE SUFXI              TO CERT-NO-SUFX.
 11616
 11617     MOVE CERT-NO                TO CL-CERT-NO
 11618                                    CL-CERT-NO-A4.
 11619
 11620     IF PI-COMPANY-ID = 'FLA'
 11621          NEXT SENTENCE
 11622     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 214
* EL131.cbl
 11623         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11624         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11625         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 11626         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11627
 11628     IF TRLR-UPDATE-REQUIRED
 11629        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11630        MOVE ZEROS              TO TRLR-SEQ-NO
 11631
 11632* EXEC CICS READ
 11633*            DATASET   (TRLR-FILE-ID)
 11634*            RIDFLD    (TRLR-KEY)
 11635*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11636*       END-EXEC
 11637*    MOVE '&"S        E          (   #00010496' TO DFHEIV0
 11638     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11639     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11640     MOVE X'2020233030303130343936' TO DFHEIV0(25:11)
 11641     CALL 'kxdfhei1' USING DFHEIV0,
 11642           TRLR-FILE-ID,
 11643           DFHEIV20,
 11644           DFHEIV99,
 11645           TRLR-KEY,
 11646           DFHEIV99,
 11647           DFHEIV99,
 11648           DFHEIV99
 11649     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11650         DFHEIV20
 11651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11652        IF AT-TRAILER-TYPE = '1'
 11653           MOVE +1 TO MISC-SUB
 11654           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11655           MISC-SUB GREATER THAN +6 OR
 11656           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11657           IF MISC-SUB GREATER THAN +1
 11658              SUBTRACT +1 FROM MISC-SUB
 11659              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11660                 GO TO 2100-BYPASS-LAST-UPDATE.
 11661
 11662     IF TRLR-UPDATE-REQUIRED AND
 11663        CLAIM-IS-OPEN
 11664         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11665     ELSE
 11666         IF TRLR-UPDATE-REQUIRED AND
 11667            CLAIM-IS-CLOSED
 11668             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11669             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11670
 11671 2100-BYPASS-LAST-UPDATE.
 11672     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11673     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11674
 11675     GO TO 2100-EXIT.
 11676
 11677 2100-BUMP-OPEN-CLOSE-HIST.
 11678     ADD +1                      TO MISC-SUB.
 11679
 11680 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 215
* EL131.cbl
 11681     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 216
* EL131.cbl
 11683 2120-check-pdef.
 11684     move +0                     to s1
 11685     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11686     move spaces                 to ws-dcc-error-line
 11687     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11688     IF ERPDEF-FOUND
 11689        perform 2130-check-trlr  thru 2130-exit
 11690        move +1                  to s1
 11691*       if cl-accident-claim-sw = ' '
 11692*          move er-1655             to ws-error-no (s1)
 11693*          add +1 to s1
 11694*       end-if
 11695        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11696        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11697        if (hold-incur > low-values)
 11698           and (incl > zeros)
 11699           and (hold-incur not = cl-incurred-dt)
 11700           move hold-incur       to dc-bin-date-2
 11701        end-if
 11702        MOVE '1'                 TO DC-OPTION-CODE
 11703        MOVE +0                  TO DC-ELAPSED-MONTHS
 11704                                    DC-ELAPSED-DAYS
 11705        PERFORM 9800-CONVERT-DATE
 11706                                 THRU 9800-EXIT
 11707        IF NO-CONVERSION-ERROR
 11708           MOVE DC-ELAPSED-MONTHS
 11709                                 TO WS-MONTHS-BETWEEN
 11710           IF DC-ELAPSED-DAYS > 1
 11711              ADD 1 TO WS-MONTHS-BETWEEN
 11712           END-IF
 11713        ELSE
 11714           display ' dte conv error ' dc-error-code
 11715           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11716        END-IF
 11717        IF (WS-EXCL-PERIOD = ZEROS)
 11718           OR (WS-MONTHS-BETWEEN = ZEROS)
 11719           CONTINUE
 11720        ELSE
 11721           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11722              MOVE ER-1651       TO ws-error-no (s1)
 11723              add +1             to s1
 11724           END-IF
 11725        END-IF
 11726        IF (WS-COV-ENDS = ZEROS)
 11727           OR (WS-MONTHS-BETWEEN = ZEROS)
 11728           CONTINUE
 11729        ELSE
 11730           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11731              MOVE -1            TO MAINTL
 11732              MOVE ER-1653       TO ws-error-no (s1)
 11733              add +1 to s1
 11734           END-IF
 11735        END-IF
 11736        IF (WS-ACC-PERIOD = ZEROS)
 11737           OR (WS-MONTHS-BETWEEN = ZEROS)
 11738           CONTINUE
 11739        ELSE
 11740           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 217
* EL131.cbl
 11741              and (accswi = spaces or low-values)
 11742*             and (cl-accident-claim-sw = ' ')
 11743              move er-1655       to ws-error-no (s1)
 11744              add +1             to s1
 11745           end-if
 11746           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11747*             if (cl-accident-claim-sw not = 'Y')
 11748              if (accswi not = 'Y')
 11749                 MOVE ER-1652    TO ws-error-no (s1)
 11750              else
 11751                 move er-1662    to ws-error-no (s1)
 11752              end-if
 11753              MOVE -1            TO MAINTL
 11754              add +1             to s1
 11755           END-IF
 11756        END-IF
 11757        if cl-claim-type  = 'I'
 11758           move er-1661          to ws-error-no (s1)
 11759           add +1                to s1
 11760        end-if
 11761        perform 2130-check-trlr  thru 2130-exit
 11762     END-IF
 11763
 11764     .
 11765 2120-exit.
 11766     exit.
 11767
 11768 2130-check-trlr.
 11769
 11770     evaluate true
 11771        when s1 = +0
 11772           move cl-control-primary
 11773                                 to trlr-key
 11774           MOVE +95              TO TRLR-SEQ-NO
 11775
 11776* EXEC CICS READ
 11777*             update
 11778*             DATASET  ('ELTRLR')
 11779*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11780*             RIDFLD   (TRLR-KEY)
 11781*             RESP     (WS-RESPONSE)
 11782*          END-EXEC
 11783     MOVE 'ELTRLR' TO DFHEIV1
 11784*    MOVE '&"S        EU         (  N#00010624' TO DFHEIV0
 11785     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11786     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11787     MOVE X'204E233030303130363234' TO DFHEIV0(25:11)
 11788     CALL 'kxdfhei1' USING DFHEIV0,
 11789           DFHEIV1,
 11790           DFHEIV20,
 11791           DFHEIV99,
 11792           TRLR-KEY,
 11793           DFHEIV99,
 11794           DFHEIV99,
 11795           DFHEIV99
 11796     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11797         DFHEIV20
 11798     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 218
* EL131.cbl
 11799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11800           if ws-resp-normal
 11801              move spaces        to at-info-line-1
 11802           end-if
 11803        when s1 = +1
 11804           if ws-resp-normal
 11805
 11806* exec cics rewrite
 11807*                dataset   ('ELTRLR')
 11808*                from      (activity-trailers)
 11809*             end-exec
 11810     MOVE LENGTH OF
 11811      activity-trailers
 11812       TO DFHEIV11
 11813     MOVE 'ELTRLR' TO DFHEIV1
 11814*    MOVE '&& L                  %   #00010636' TO DFHEIV0
 11815     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11816     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11817     MOVE X'2020233030303130363336' TO DFHEIV0(25:11)
 11818     CALL 'kxdfhei1' USING DFHEIV0,
 11819           DFHEIV1,
 11820           activity-trailers,
 11821           DFHEIV11,
 11822           DFHEIV99
 11823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11824           end-if
 11825        when s1 > +1
 11826           if ws-resp-normal
 11827              move ws-dcc-error-line
 11828                                 to at-info-line-1
 11829
 11830* exec cics rewrite
 11831*                dataset   ('ELTRLR')
 11832*                from      (activity-trailers)
 11833*             end-exec
 11834     MOVE LENGTH OF
 11835      activity-trailers
 11836       TO DFHEIV11
 11837     MOVE 'ELTRLR' TO DFHEIV1
 11838*    MOVE '&& L                  %   #00010645' TO DFHEIV0
 11839     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11840     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11841     MOVE X'2020233030303130363435' TO DFHEIV0(25:11)
 11842     CALL 'kxdfhei1' USING DFHEIV0,
 11843           DFHEIV1,
 11844           activity-trailers,
 11845           DFHEIV11,
 11846           DFHEIV99
 11847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11848           else
 11849
 11850* EXEC CICS GETMAIN
 11851*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11852*                LENGTH   (TRLR-LENGTH)
 11853*                INITIMG  (GETMAIN-SPACE)
 11854*             END-EXEC
 11855*    MOVE ',"IL                  $   #00010650' TO DFHEIV0
 11856     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 219
* EL131.cbl
 11857     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11858     MOVE X'2020233030303130363530' TO DFHEIV0(25:11)
 11859     CALL 'kxdfhei1' USING DFHEIV0,
 11860           DFHEIV20,
 11861           TRLR-LENGTH,
 11862           GETMAIN-SPACE
 11863     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11864         DFHEIV20
 11865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11866              move 'AT'          to at-record-id
 11867              move cl-control-primary
 11868                                 to at-control-primary
 11869              move +95           to at-sequence-no
 11870              move '6'           to at-trailer-type
 11871              move ws-dcc-error-line
 11872                                 to at-info-line-1
 11873              move 'E'           to at-info-trailer-type
 11874              move save-bin-date to at-recorded-dt
 11875                                    at-gen-info-last-maint-dt
 11876              move pi-processor-id
 11877                                 to at-recorded-by
 11878                                    at-gen-info-last-updated-by
 11879              move eibtime       to at-last-maint-hhmmss
 11880
 11881* exec cics write
 11882*                dataset   ('ELTRLR')
 11883*                from      (activity-trailers)
 11884*                ridfld    (trlr-key)
 11885*             end-exec
 11886     MOVE LENGTH OF
 11887      activity-trailers
 11888       TO DFHEIV11
 11889     MOVE 'ELTRLR' TO DFHEIV1
 11890*    MOVE '&$ L                  ''   #00010669' TO DFHEIV0
 11891     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11892     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11893     MOVE X'2020233030303130363639' TO DFHEIV0(25:11)
 11894     CALL 'kxdfhei1' USING DFHEIV0,
 11895           DFHEIV1,
 11896           activity-trailers,
 11897           DFHEIV11,
 11898           trlr-key,
 11899           DFHEIV99,
 11900           DFHEIV99
 11901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11902              perform varying s1 from +1 by +1 until
 11903                 ws-error-no (s1) = spaces
 11904                 move ws-error-no (s1)
 11905                                 to emi-error
 11906                 PERFORM 9900-ERROR-FORMAT
 11907                                 THRU 9900-EXIT
 11908              end-perform
 11909           end-if
 11910     end-evaluate
 11911
 11912     .
 11913 2130-exit.
 11914     exit.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 220
* EL131.cbl
 11915 2140-update-elcrtt.
 11916     move ' '                    to crtt-switch
 11917     MOVE CERT-KEY               TO ELCRTT-KEY
 11918     MOVE 'B'                    TO CTRLR-REC-TYPE
 11919
 11920* EXEC CICS READ
 11921*       UPDATE
 11922*       DATASET   ('ELCRTT')
 11923*       RIDFLD    (ELCRTT-KEY)
 11924*       INTO      (CERTIFICATE-TRAILERS)
 11925*       RESP      (WS-RESPONSE)
 11926*    END-EXEC
 11927     MOVE LENGTH OF
 11928      CERTIFICATE-TRAILERS
 11929       TO DFHEIV11
 11930     MOVE 'ELCRTT' TO DFHEIV1
 11931*    MOVE '&"IL       EU         (  N#00010691' TO DFHEIV0
 11932     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11933     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11934     MOVE X'204E233030303130363931' TO DFHEIV0(25:11)
 11935     CALL 'kxdfhei1' USING DFHEIV0,
 11936           DFHEIV1,
 11937           CERTIFICATE-TRAILERS,
 11938           DFHEIV11,
 11939           ELCRTT-KEY,
 11940           DFHEIV99,
 11941           DFHEIV99,
 11942           DFHEIV99
 11943     MOVE EIBRESP  TO WS-RESPONSE
 11944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11945     IF WS-RESP-NORMAL
 11946        perform varying s1 from +1 by +1 until
 11947           (s1 > +24)
 11948           or (cs-claim-no (s1) = cl-claim-no)
 11949        end-perform
 11950        if (s1 < +25)
 11951           if (benperl <> zeros)
 11952              and (cs-benefit-period (s1) not = benperi)
 11953              move benperi       to cs-benefit-period (s1)
 11954              set crtt-update    to true
 11955          end-if
 11956          if (instypel <> zeros)
 11957             and (instypei not = cs-insured-type (s1))
 11958             move instypei      to cs-insured-type (s1)
 11959             set crtt-update    to true
 11960          end-if
 11961          move cs-claim-type (s1) to ws-claim-type
 11962          move cs-benefit-period (s1) to ws-ben-per
 11963        end-if
 11964        if crtt-update
 11965           perform 2150-accum    thru 2150-exit
 11966
 11967* EXEC CICS REWRITE
 11968*             DATASET   ('ELCRTT')
 11969*             FROM      (CERTIFICATE-TRAILERS)
 11970*          END-EXEC
 11971     MOVE LENGTH OF
 11972      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 221
* EL131.cbl
 11973       TO DFHEIV11
 11974     MOVE 'ELCRTT' TO DFHEIV1
 11975*    MOVE '&& L                  %   #00010719' TO DFHEIV0
 11976     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11977     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11978     MOVE X'2020233030303130373139' TO DFHEIV0(25:11)
 11979     CALL 'kxdfhei1' USING DFHEIV0,
 11980           DFHEIV1,
 11981           CERTIFICATE-TRAILERS,
 11982           DFHEIV11,
 11983           DFHEIV99
 11984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11985        else
 11986
 11987* exec cics unlock
 11988*             dataset   ('ELCRTT')
 11989*          end-exec
 11990     MOVE 'ELCRTT' TO DFHEIV1
 11991*    MOVE '&*                    #   #00010724' TO DFHEIV0
 11992     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11993     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11994     MOVE X'2020233030303130373234' TO DFHEIV0(25:11)
 11995     CALL 'kxdfhei1' USING DFHEIV0,
 11996           DFHEIV1,
 11997           DFHEIV99
 11998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11999        end-if
 12000     end-if
 12001     .
 12002 2140-exit.
 12003     exit.
 12004 2150-accum.
 12005     if not erpdef-found
 12006        perform 3997-get-erpdef  thru 3997-exit
 12007     end-if
 12008     if (erpdef-found)
 12009        and (ws-max-moben not = zeros)
 12010        and (ws-max-moben < cm-ah-benefit-amt)
 12011        continue
 12012     else
 12013        move cm-ah-benefit-amt   to ws-max-moben
 12014     end-if
 12015     move cm-ah-orig-term        to ws-max-bens
 12016     if cl-critical-period not = zeros and spaces
 12017        move cl-critical-period  to ws-max-bens
 12018     end-if
 12019     move zeros to ws-tot-days-paid ws-tot-amt-paid
 12020     perform varying s2 from +1 by +1 until
 12021        (s2 > +24)
 12022        or (cs-claim-no (s2) = spaces)
 12023        if (cs-benefit-period (s2) = ws-ben-per)
 12024           and (cs-claim-type (s2) = ws-claim-type)
 12025           and (cs-insured-type (s2) = cl-insured-type)
 12026*          compute ws-tot-days-paid =
 12027*             ws-tot-days-paid + cs-days-paid (s2)
 12028           compute ws-tot-amt-paid =
 12029              ws-tot-amt-paid + cs-total-paid (s2)
 12030        end-if
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 222
* EL131.cbl
 12031     end-perform
 12032     if s2 < +25
 12033        compute ws-pd-bens rounded =
 12034           ws-tot-amt-paid / ws-max-moben
 12035        compute cs-remaining-bens (s1) =
 12036           ws-max-bens - ws-pd-bens
 12037        if cs-remaining-bens (s1) < zeros
 12038           move zeros            to cs-remaining-bens (s1)
 12039        end-if
 12040     end-if
 12041     .
 12042 2150-exit.
 12043     exit.
 12044 2200-MOVE-CERT.
 12045     IF CRTLNMEI GREATER THAN LOW-VALUES
 12046         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 12047
 12048     IF CRTFNMEI GREATER THAN LOW-VALUES
 12049         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 12050         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 12051
 12052     IF CRTINITI GREATER THAN LOW-VALUES
 12053         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 12054
 12055     IF CM-INSURED-INITIALS = SPACES
 12056         MOVE '**'               TO CM-INSURED-INITIALS.
 12057
 12058     IF ISSAGEI GREATER THAN LOW-VALUES
 12059         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 12060
 12061     IF JNTFNMEI GREATER THAN LOW-VALUES
 12062         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 12063
 12064     IF JNTLNMEI GREATER THAN LOW-VALUES
 12065         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 12066
 12067     IF JNTINITI GREATER THAN LOW-VALUES
 12068         MOVE JNTINITI           TO CM-JT-INITIAL.
 12069
 12070     IF JNTAGEI GREATER THAN LOW-VALUES
 12071         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 12072
 12073     IF ADDONDTI GREATER THAN LOW-VALUES
 12074        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 12075
 12076     IF LCVCDI GREATER THAN LOW-VALUES
 12077        IF LCVCDI = SPACES OR ZEROS
 12078           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 12079        ELSE
 12080           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 12081
 12082     IF LCVOTRMI GREATER THAN LOW-VALUES
 12083         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 12084
 12085     IF LCVRATEL GREATER THAN +0
 12086         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 12087
 12088     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 223
* EL131.cbl
 12089         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 12090
 12091     IF LCVFORMI GREATER THAN LOW-VALUES
 12092         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 12093
 12094     IF LCVCNDTI = LOW-VALUES
 12095        GO TO 2210-SET-STATUS.
 12096
 12097     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 12098        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 12099        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 12100        GO TO 2210-SET-STATUS.
 12101
 12102     IF CM-LF-CURRENT-STATUS = '7'
 12103        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 12104        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 12105        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12106                                    CM-LF-DEATH-DT
 12107        GO TO 2210-SET-STATUS.
 12108
 12109     IF CM-LF-CURRENT-STATUS = '8'
 12110        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 12111        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12112                                    CM-LF-CANCEL-DT.
 12113
 12114 2210-SET-STATUS.
 12115
 12116     IF CM-LF-CURRENT-STATUS = SPACES
 12117         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 12118
 12119     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 12120         MOVE '6'                TO DC-OPTION-CODE
 12121         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12122         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12123         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12124         IF NO-CONVERSION-ERROR
 12125             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 12126         ELSE
 12127             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 12128     ELSE
 12129         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 12130
 12131 2215-PROCESS-AH-SIDE.
 12132
 12133     IF ACVCDI GREATER THAN LOW-VALUES
 12134        IF ACVCDI = SPACES OR ZEROS
 12135           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 12136        ELSE
 12137           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 12138
 12139     IF ACVOTRMI GREATER THAN LOW-VALUES
 12140         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 12141
 12142     IF ACVRATEL GREATER THAN +0
 12143         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 12144
 12145     IF ACVBENEL GREATER THAN +0
 12146         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 224
* EL131.cbl
 12147                                    PI-PAYMENT-AMT.
 12148
 12149     IF ACVFORMI GREATER THAN LOW-VALUES
 12150         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 12151
 12152     IF ACVCNDTI = LOW-VALUES
 12153        GO TO 2220-SET-STATUS.
 12154
 12155     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 12156        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 12157        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 12158        GO TO 2220-SET-STATUS.
 12159
 12160     IF CM-AH-CURRENT-STATUS = '6'
 12161        MOVE CM-AH-STATUS-AT-SETTLEMENT
 12162                                 TO CM-AH-CURRENT-STATUS
 12163        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 12164        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12165                                    CM-AH-SETTLEMENT-DT
 12166        GO TO 2220-SET-STATUS.
 12167
 12168     IF CM-AH-CURRENT-STATUS = '8'
 12169        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 12170        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12171                                    CM-AH-CANCEL-DT.
 12172
 12173 2220-SET-STATUS.
 12174     IF CM-AH-CURRENT-STATUS = SPACES
 12175         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 12176
 12177     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 12178         MOVE '6'                TO DC-OPTION-CODE
 12179         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12180         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12181         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12182         IF NO-CONVERSION-ERROR
 12183             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12184         ELSE
 12185             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12186     ELSE
 12187         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12188
 12189 2225-FINISH-CERT.
 12190     IF APRL GREATER THAN +0
 12191         MOVE HOLD-APR           TO CM-LOAN-APR.
 12192
 12193     IF PMTFREQI GREATER THAN LOW-VALUES
 12194         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12195
 12196     IF INDGRPI GREATER THAN LOW-VALUES
 12197         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12198
 12199*    IF LOANNOI GREATER THAN LOW-VALUES
 12200*       MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12201
 12202     IF LOANBALL GREATER THAN +0
 12203        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12204
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 225
* EL131.cbl
 12205     IF PREMTYPI GREATER THAN LOW-VALUES
 12206         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12207
 12208     IF REINCDI GREATER THAN LOW-VALUES
 12209         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12210                                    WS-REIN-1
 12211                                    WS-REIN-2
 12212                                    WS-REIN-3
 12213         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12214
 12215     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12216
 12217     MOVE ZEROS                  TO CM-LOAN-TERM
 12218                                    CM-LIFE-COMM-PCT
 12219                                    CM-AH-COMM-PCT.
 12220
 12221*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12222*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12223*         PI-NO-PMTS = ZEROS
 12224*          IF LOANBALL GREATER THAN +0          OR
 12225*             ACVBENEL GREATER THAN +0          OR
 12226*             APRL     GREATER THAN +0          OR
 12227*             LCVRATEL GREATER THAN +0          OR
 12228*             ACVRATEL GREATER THAN +0
 12229*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12230
 12231 2200-EXIT.
 12232     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 226
* EL131.cbl
 12234 2300-UPDATE-TRLR.
 12235     MOVE ZERO                   TO TRLR-SEQ-NO.
 12236
 12237* EXEC CICS READ UPDATE
 12238*         DATASET  (TRLR-FILE-ID)
 12239*         RIDFLD   (TRLR-KEY)
 12240*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12241*    END-EXEC.
 12242*    MOVE '&"S        EU         (   #00010964' TO DFHEIV0
 12243     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12244     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12245     MOVE X'2020233030303130393634' TO DFHEIV0(25:11)
 12246     CALL 'kxdfhei1' USING DFHEIV0,
 12247           TRLR-FILE-ID,
 12248           DFHEIV20,
 12249           DFHEIV99,
 12250           TRLR-KEY,
 12251           DFHEIV99,
 12252           DFHEIV99,
 12253           DFHEIV99
 12254     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12255         DFHEIV20
 12256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12257
 12258
 12259     MOVE ZERO                   TO COUNT-2.
 12260
 12261     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12262         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12263
 12264     IF NOT UPDATE-MADE
 12265         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12266
 12267
 12268* EXEC CICS REWRITE
 12269*         DATASET  (TRLR-FILE-ID)
 12270*         FROM     (ACTIVITY-TRAILERS)
 12271*    END-EXEC.
 12272     MOVE LENGTH OF
 12273      ACTIVITY-TRAILERS
 12274       TO DFHEIV11
 12275*    MOVE '&& L                  %   #00010978' TO DFHEIV0
 12276     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12277     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12278     MOVE X'2020233030303130393738' TO DFHEIV0(25:11)
 12279     CALL 'kxdfhei1' USING DFHEIV0,
 12280           TRLR-FILE-ID,
 12281           ACTIVITY-TRAILERS,
 12282           DFHEIV11,
 12283           DFHEIV99
 12284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12285
 12286
 12287 2300-EXIT.
 12288     EXIT.
 12289
 12290 2310-INS-STATUS.
 12291     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 227
* EL131.cbl
 12292     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12293         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12294         MOVE 'Y'                TO TRLR-SWITCH.
 12295
 12296 2310-EXIT.
 12297     EXIT.
 12298
 12299 2320-SHIFT-STATUS.
 12300     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12301        MOVE 6                   TO COUNT-2
 12302        GO TO 2320-EXIT.
 12303
 12304     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12305     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12306     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12307     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12308     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12309     MOVE 6       TO COUNT-2.
 12310     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12311
 12312 2320-EXIT.
 12313     EXIT.
 12314
 12315 2330-ADD-UPDATE.
 12316
 12317     IF COUNT-2 GREATER THAN 1
 12318        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12319        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12320           GO TO 2330-EXIT.
 12321
 12322     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12323                                   AT-RESERVES-LAST-MAINT-DT
 12324
 12325     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12326     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12327     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12328     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12329
 12330 2330-EXIT.
 12331     EXIT.
 12332
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 228
* EL131.cbl
 12334 2400-UPDATE-TRLR.
 12335
 12336* EXEC CICS HANDLE CONDITION
 12337*         NOTFND    (2400-TRLR-NOTFND)
 12338*         ENDFILE   (2410-EXIT)
 12339*    END-EXEC.
 12340*    MOVE '"$I''                  ! 5 #00011031' TO DFHEIV0
 12341     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12342     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12343     MOVE X'3520233030303131303331' TO DFHEIV0(25:11)
 12344     CALL 'kxdfhei1' USING DFHEIV0
 12345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12346
 12347
 12348
 12349* EXEC CICS STARTBR
 12350*        DATASET (TRLR-FILE-ID)
 12351*        RIDFLD  (TRLR-KEY)
 12352*    END-EXEC.
 12353     MOVE 0
 12354       TO DFHEIV11
 12355*    MOVE '&,         G          &   #00011036' TO DFHEIV0
 12356     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12357     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12358     MOVE X'2020233030303131303336' TO DFHEIV0(25:11)
 12359     CALL 'kxdfhei1' USING DFHEIV0,
 12360           TRLR-FILE-ID,
 12361           TRLR-KEY,
 12362           DFHEIV99,
 12363           DFHEIV11,
 12364           DFHEIV99
 12365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12366
 12367
 12368
 12369* EXEC CICS GETMAIN
 12370*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12371*         LENGTH    (TRLR-LENGTH)
 12372*         INITIMG   (GETMAIN-SPACE)
 12373*    END-EXEC.
 12374*    MOVE ',"IL                  $   #00011041' TO DFHEIV0
 12375     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12376     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12377     MOVE X'2020233030303131303431' TO DFHEIV0(25:11)
 12378     CALL 'kxdfhei1' USING DFHEIV0,
 12379           DFHEIV20,
 12380           TRLR-LENGTH,
 12381           GETMAIN-SPACE
 12382     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12383         DFHEIV20
 12384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12385
 12386
 12387     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12388
 12389
 12390* EXEC CICS ENDBR
 12391*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 229
* EL131.cbl
 12392*    END-EXEC.
 12393     MOVE 0
 12394       TO DFHEIV11
 12395*    MOVE '&2                    $   #00011049' TO DFHEIV0
 12396     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12397     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12398     MOVE X'2020233030303131303439' TO DFHEIV0(25:11)
 12399     CALL 'kxdfhei1' USING DFHEIV0,
 12400           TRLR-FILE-ID,
 12401           DFHEIV11,
 12402           DFHEIV99
 12403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12404
 12405
 12406     GO TO 2400-EXIT.
 12407
 12408 2400-TRLR-NOTFND.
 12409     MOVE ER-0205                TO EMI-ERROR.
 12410     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12411     MOVE 'X'                    TO ERROR-SWITCH.
 12412
 12413 2400-EXIT.
 12414     EXIT.
 12415
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 230
* EL131.cbl
 12417 2410-CHANGE-TRLR.
 12418
 12419* EXEC CICS READNEXT
 12420*        DATASET (TRLR-FILE-ID)
 12421*        RIDFLD  (TRLR-KEY)
 12422*        INTO    (ACTIVITY-TRAILERS)
 12423*    END-EXEC.
 12424     MOVE LENGTH OF
 12425      ACTIVITY-TRAILERS
 12426       TO DFHEIV12
 12427     MOVE 0
 12428       TO DFHEIV11
 12429*    MOVE '&.IL                  )   #00011065' TO DFHEIV0
 12430     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12431     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12432     MOVE X'2020233030303131303635' TO DFHEIV0(25:11)
 12433     CALL 'kxdfhei1' USING DFHEIV0,
 12434           TRLR-FILE-ID,
 12435           ACTIVITY-TRAILERS,
 12436           DFHEIV12,
 12437           TRLR-KEY,
 12438           DFHEIV99,
 12439           DFHEIV11,
 12440           DFHEIV99,
 12441           DFHEIV99
 12442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12443
 12444
 12445     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12446        GO TO 2410-CHANGE-TRLR.
 12447
 12448     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12449                                    CHECK-KEY.
 12450
 12451     IF CHECK-KEY NOT = MSTR-KEY
 12452         GO TO 2410-EXIT.
 12453
 12454
 12455* EXEC CICS ENDBR
 12456*        DATASET (TRLR-FILE-ID)
 12457*    END-EXEC.
 12458     MOVE 0
 12459       TO DFHEIV11
 12460*    MOVE '&2                    $   #00011080' TO DFHEIV0
 12461     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12462     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12463     MOVE X'2020233030303131303830' TO DFHEIV0(25:11)
 12464     CALL 'kxdfhei1' USING DFHEIV0,
 12465           TRLR-FILE-ID,
 12466           DFHEIV11,
 12467           DFHEIV99
 12468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12469
 12470
 12471
 12472* EXEC CICS READ UPDATE
 12473*        DATASET (TRLR-FILE-ID)
 12474*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 231
* EL131.cbl
 12475*        INTO    (ACTIVITY-TRAILERS)
 12476*    END-EXEC.
 12477     MOVE LENGTH OF
 12478      ACTIVITY-TRAILERS
 12479       TO DFHEIV11
 12480*    MOVE '&"IL       EU         (   #00011084' TO DFHEIV0
 12481     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12482     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12483     MOVE X'2020233030303131303834' TO DFHEIV0(25:11)
 12484     CALL 'kxdfhei1' USING DFHEIV0,
 12485           TRLR-FILE-ID,
 12486           ACTIVITY-TRAILERS,
 12487           DFHEIV11,
 12488           TRLR-KEY,
 12489           DFHEIV99,
 12490           DFHEIV99,
 12491           DFHEIV99
 12492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12493
 12494
 12495
 12496* EXEC CICS DELETE
 12497*        DATASET (TRLR-FILE-ID)
 12498*    END-EXEC.
 12499*    MOVE '&(                    &   #00011090' TO DFHEIV0
 12500     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12501     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12502     MOVE X'2020233030303131303930' TO DFHEIV0(25:11)
 12503     CALL 'kxdfhei1' USING DFHEIV0,
 12504           TRLR-FILE-ID,
 12505           DFHEIV99,
 12506           DFHEIV99,
 12507           DFHEIV99,
 12508           DFHEIV99
 12509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12510
 12511
 12512     IF AT-SEQUENCE-NO = ZERO AND
 12513        TRLR-UPDATE-REQUIRED
 12514         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12515
 12516     IF CERTI GREATER THAN LOW-VALUES
 12517        MOVE CERTI               TO AT-CERT-PRIME.
 12518
 12519     IF SUFXI GREATER THAN LOW-VALUES
 12520        MOVE SUFXI               TO AT-CERT-SFX.
 12521
 12522     IF CERTCARI GREATER THAN LOW-VALUES
 12523        MOVE CERTCARI            TO AT-CARRIER.
 12524
 12525     IF PAYMENT-TR
 12526        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12527           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12528              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12529
 12530     IF CORRESPONDENCE-TR
 12531        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12532           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 232
* EL131.cbl
 12533
 12534
 12535* EXEC CICS WRITE
 12536*         DATASET  (TRLR-FILE-ID)
 12537*         RIDFLD   (AT-CONTROL-PRIMARY)
 12538*         FROM     (ACTIVITY-TRAILERS)
 12539*    END-EXEC.
 12540     MOVE LENGTH OF
 12541      ACTIVITY-TRAILERS
 12542       TO DFHEIV11
 12543*    MOVE '&$ L                  ''   #00011116' TO DFHEIV0
 12544     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12545     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12546     MOVE X'2020233030303131313136' TO DFHEIV0(25:11)
 12547     CALL 'kxdfhei1' USING DFHEIV0,
 12548           TRLR-FILE-ID,
 12549           ACTIVITY-TRAILERS,
 12550           DFHEIV11,
 12551           AT-CONTROL-PRIMARY,
 12552           DFHEIV99,
 12553           DFHEIV99
 12554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12555
 12556
 12557
 12558* EXEC CICS STARTBR
 12559*         DATASET  (TRLR-FILE-ID)
 12560*         RIDFLD   (TRLR-KEY)
 12561*    END-EXEC.
 12562     MOVE 0
 12563       TO DFHEIV11
 12564*    MOVE '&,         G          &   #00011122' TO DFHEIV0
 12565     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12566     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12567     MOVE X'2020233030303131313232' TO DFHEIV0(25:11)
 12568     CALL 'kxdfhei1' USING DFHEIV0,
 12569           TRLR-FILE-ID,
 12570           TRLR-KEY,
 12571           DFHEIV99,
 12572           DFHEIV11,
 12573           DFHEIV99
 12574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12575
 12576
 12577     GO TO 2410-CHANGE-TRLR.
 12578
 12579 2410-EXIT.
 12580     EXIT.
 12581
 12582 2420-UPDATE-TRLR.
 12583     MOVE ZERO TO COUNT-2.
 12584     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12585         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12586
 12587     IF NOT UPDATE-MADE
 12588         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12589
 12590 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 233
* EL131.cbl
 12591     EXIT.
 12592
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 234
* EL131.cbl
 12594 2425-UPDATE-NINETY-TRLR.
 12595
 12596     MOVE +90                    TO TRLR-SEQ-NO.
 12597
 12598
 12599* EXEC CICS HANDLE CONDITION
 12600*         NOTFND    (2425-NINETY-NOTFND)
 12601*         ENDFILE   (2425-NINETY-NOTFND)
 12602*    END-EXEC.
 12603*    MOVE '"$I''                  ! 6 #00011148' TO DFHEIV0
 12604     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12605     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12606     MOVE X'3620233030303131313438' TO DFHEIV0(25:11)
 12607     CALL 'kxdfhei1' USING DFHEIV0
 12608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12609
 12610
 12611
 12612* EXEC CICS READ UPDATE
 12613*        DATASET (TRLR-FILE-ID)
 12614*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12615*        RIDFLD  (TRLR-KEY)
 12616*    END-EXEC.
 12617*    MOVE '&"S        EU         (   #00011153' TO DFHEIV0
 12618     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12619     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12620     MOVE X'2020233030303131313533' TO DFHEIV0(25:11)
 12621     CALL 'kxdfhei1' USING DFHEIV0,
 12622           TRLR-FILE-ID,
 12623           DFHEIV20,
 12624           DFHEIV99,
 12625           TRLR-KEY,
 12626           DFHEIV99,
 12627           DFHEIV99,
 12628           DFHEIV99
 12629     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12630         DFHEIV20
 12631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12632
 12633     if (diagi > low-values)
 12634        and (diagi not = at-info-line-1)
 12635        and (cl-total-paid-amt > zeros)
 12636        move cl-cert-eff-dt      to dc-bin-date-1
 12637        move cl-paid-thru-dt     to dc-bin-date-2
 12638        move '1'                 to dc-option-code
 12639        perform 9800-convert-date
 12640                                 thru 9800-exit
 12641        if no-conversion-error
 12642           and dc-elapsed-months < +24
 12643           and (not emi-bypass-forcables)
 12644           move er-1581          to emi-error
 12645           perform 9900-error-format
 12646                                thru 9900-exit
 12647           move -1              to diagl
 12648           go to 8110-send-data
 12649        end-if
 12650     end-if
 12651     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 235
* EL131.cbl
 12652     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12653     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12654
 12655     IF DIAGI GREATER THAN LOW-VALUES
 12656         MOVE DIAGI             TO AT-INFO-LINE-1
 12657     END-IF.
 12658
 12659     IF ICD1I GREATER THAN LOW-VALUES
 12660         MOVE ICD1I             TO AT-ICD-CODE-1
 12661     END-IF.
 12662
 12663     IF ICD2I GREATER THAN LOW-VALUES
 12664         MOVE ICD2I             TO AT-ICD-CODE-2
 12665     END-IF.
 12666
 12667
 12668* EXEC CICS REWRITE
 12669*        DATASET (TRLR-FILE-ID)
 12670*        FROM    (ACTIVITY-TRAILERS)
 12671*    END-EXEC.
 12672     MOVE LENGTH OF
 12673      ACTIVITY-TRAILERS
 12674       TO DFHEIV11
 12675*    MOVE '&& L                  %   #00011192' TO DFHEIV0
 12676     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12677     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12678     MOVE X'2020233030303131313932' TO DFHEIV0(25:11)
 12679     CALL 'kxdfhei1' USING DFHEIV0,
 12680           TRLR-FILE-ID,
 12681           ACTIVITY-TRAILERS,
 12682           DFHEIV11,
 12683           DFHEIV99
 12684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12685
 12686
 12687     IF DIAGI GREATER THAN LOW-VALUES
 12688       AND DIAGI NOT = WS-DIAGNOSIS
 12689         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12690         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12691         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12692
 12693     IF ICD1I GREATER THAN LOW-VALUES
 12694       AND ICD1I NOT = WS-ICD-CODE-1
 12695         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12696         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12697         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12698     END-IF.
 12699
 12700     IF ICD2I GREATER THAN LOW-VALUES
 12701       AND ICD2I NOT = WS-ICD-CODE-2
 12702         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12703         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12704         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12705     END-IF.
 12706
 12707     GO TO 2425-EXIT.
 12708
 12709 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 236
* EL131.cbl
 12710
 12711
 12712* EXEC CICS GETMAIN
 12713*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12714*         LENGTH    (TRLR-LENGTH)
 12715*         INITIMG   (GETMAIN-SPACE)
 12716*    END-EXEC.
 12717*    MOVE ',"IL                  $   #00011221' TO DFHEIV0
 12718     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12719     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12720     MOVE X'2020233030303131323231' TO DFHEIV0(25:11)
 12721     CALL 'kxdfhei1' USING DFHEIV0,
 12722           DFHEIV20,
 12723           TRLR-LENGTH,
 12724           GETMAIN-SPACE
 12725     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12726         DFHEIV20
 12727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12728
 12729
 12730     MOVE +90                  TO TRLR-SEQ-NO.
 12731     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12732
 12733     MOVE 'AT'                 TO AT-RECORD-ID
 12734     MOVE '6'                  TO AT-TRAILER-TYPE
 12735     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12736                                  AT-GEN-INFO-LAST-MAINT-DT
 12737     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12738                                  AT-GEN-INFO-LAST-UPDATED-BY
 12739     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12740     MOVE DIAGI                TO AT-INFO-LINE-1.
 12741     MOVE ICD1I                TO AT-ICD-CODE-1.
 12742     MOVE ICD2I                TO AT-ICD-CODE-2.
 12743
 12744
 12745* EXEC CICS WRITE
 12746*        DATASET (TRLR-FILE-ID)
 12747*        FROM    (ACTIVITY-TRAILERS)
 12748*        RIDFLD  (TRLR-KEY)
 12749*    END-EXEC.
 12750     MOVE LENGTH OF
 12751      ACTIVITY-TRAILERS
 12752       TO DFHEIV11
 12753*    MOVE '&$ L                  ''   #00011241' TO DFHEIV0
 12754     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12755     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12756     MOVE X'2020233030303131323431' TO DFHEIV0(25:11)
 12757     CALL 'kxdfhei1' USING DFHEIV0,
 12758           TRLR-FILE-ID,
 12759           ACTIVITY-TRAILERS,
 12760           DFHEIV11,
 12761           TRLR-KEY,
 12762           DFHEIV99,
 12763           DFHEIV99
 12764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12765
 12766
 12767 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 237
* EL131.cbl
 12768     EXIT.
 12769
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 238
* EL131.cbl
 12771 2430-UPDATE-ACTQ.
 12772
 12773* EXEC CICS HANDLE CONDITION
 12774*         NOTFND    (2430-EXIT)
 12775*         ENDFILE   (2440-EXIT)
 12776*    END-EXEC.
 12777*    MOVE '"$I''                  ! 7 #00011252' TO DFHEIV0
 12778     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12780     MOVE X'3720233030303131323532' TO DFHEIV0(25:11)
 12781     CALL 'kxdfhei1' USING DFHEIV0
 12782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12783
 12784
 12785
 12786* EXEC CICS STARTBR
 12787*         DATASET  (ACTQ-FILE-ID)
 12788*         RIDFLD   (ACTQ-KEY)
 12789*    END-EXEC.
 12790     MOVE 0
 12791       TO DFHEIV11
 12792*    MOVE '&,         G          &   #00011257' TO DFHEIV0
 12793     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12794     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12795     MOVE X'2020233030303131323537' TO DFHEIV0(25:11)
 12796     CALL 'kxdfhei1' USING DFHEIV0,
 12797           ACTQ-FILE-ID,
 12798           ACTQ-KEY,
 12799           DFHEIV99,
 12800           DFHEIV11,
 12801           DFHEIV99
 12802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12803
 12804
 12805
 12806* EXEC CICS GETMAIN
 12807*         SET      (ADDRESS OF ACTIVITY-QUE)
 12808*         LENGTH   (ACTQ-LENGTH)
 12809*         INITIMG  (GETMAIN-SPACE)
 12810*    END-EXEC.
 12811*    MOVE ',"IL                  $   #00011262' TO DFHEIV0
 12812     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12813     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12814     MOVE X'2020233030303131323632' TO DFHEIV0(25:11)
 12815     CALL 'kxdfhei1' USING DFHEIV0,
 12816           DFHEIV20,
 12817           ACTQ-LENGTH,
 12818           GETMAIN-SPACE
 12819     SET ADDRESS OF ACTIVITY-QUE TO
 12820         DFHEIV20
 12821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12822
 12823
 12824     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12825
 12826 2430-EXIT.
 12827     EXIT.
 12828
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 239
* EL131.cbl
 12829 2440-CHANGE-ACTQ.
 12830
 12831
 12832* EXEC CICS READNEXT
 12833*         DATASET  (ACTQ-FILE-ID)
 12834*         RIDFLD   (ACTQ-KEY)
 12835*         INTO     (ACTIVITY-QUE)
 12836*    END-EXEC.
 12837     MOVE LENGTH OF
 12838      ACTIVITY-QUE
 12839       TO DFHEIV12
 12840     MOVE 0
 12841       TO DFHEIV11
 12842*    MOVE '&.IL                  )   #00011275' TO DFHEIV0
 12843     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12844     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12845     MOVE X'2020233030303131323735' TO DFHEIV0(25:11)
 12846     CALL 'kxdfhei1' USING DFHEIV0,
 12847           ACTQ-FILE-ID,
 12848           ACTIVITY-QUE,
 12849           DFHEIV12,
 12850           ACTQ-KEY,
 12851           DFHEIV99,
 12852           DFHEIV11,
 12853           DFHEIV99,
 12854           DFHEIV99
 12855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12856
 12857
 12858
 12859* EXEC CICS ENDBR
 12860*         DATASET (ACTQ-FILE-ID)
 12861*    END-EXEC.
 12862     MOVE 0
 12863       TO DFHEIV11
 12864*    MOVE '&2                    $   #00011281' TO DFHEIV0
 12865     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12866     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12867     MOVE X'2020233030303131323831' TO DFHEIV0(25:11)
 12868     CALL 'kxdfhei1' USING DFHEIV0,
 12869           ACTQ-FILE-ID,
 12870           DFHEIV11,
 12871           DFHEIV99
 12872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12873
 12874
 12875     IF ACTQ-KEY NOT = MSTR-KEY
 12876         GO TO 2440-EXIT.
 12877
 12878
 12879* EXEC CICS READ UPDATE
 12880*         DATASET  (ACTQ-FILE-ID)
 12881*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12882*         SET      (ADDRESS OF ACTIVITY-QUE)
 12883*    END-EXEC.
 12884*    MOVE '&"S        EU         (   #00011288' TO DFHEIV0
 12885     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12886     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 240
* EL131.cbl
 12887     MOVE X'2020233030303131323838' TO DFHEIV0(25:11)
 12888     CALL 'kxdfhei1' USING DFHEIV0,
 12889           ACTQ-FILE-ID,
 12890           DFHEIV20,
 12891           DFHEIV99,
 12892           AQ-CONTROL-PRIMARY,
 12893           DFHEIV99,
 12894           DFHEIV99,
 12895           DFHEIV99
 12896     SET ADDRESS OF ACTIVITY-QUE TO
 12897         DFHEIV20
 12898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12899
 12900
 12901     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12902
 12903
 12904* EXEC CICS DELETE
 12905*         DATASET (ACTQ-FILE-ID)
 12906*    END-EXEC.
 12907*    MOVE '&(                    &   #00011296' TO DFHEIV0
 12908     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12909     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12910     MOVE X'2020233030303131323936' TO DFHEIV0(25:11)
 12911     CALL 'kxdfhei1' USING DFHEIV0,
 12912           ACTQ-FILE-ID,
 12913           DFHEIV99,
 12914           DFHEIV99,
 12915           DFHEIV99,
 12916           DFHEIV99
 12917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12918
 12919
 12920     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12921     IF CERTI GREATER THAN LOW-VALUES
 12922        MOVE CERTI               TO AQ-CERT-PRIME.
 12923     IF SUFXI GREATER THAN LOW-VALUES
 12924        MOVE SUFXI               TO AQ-CERT-SFX.
 12925     IF CERTCARI GREATER THAN LOW-VALUES
 12926        MOVE CERTCARI            TO AQ-CARRIER.
 12927
 12928
 12929* EXEC CICS HANDLE CONDITION
 12930*         DUPREC   (2440-EXIT)
 12931*    END-EXEC.
 12932*    MOVE '"$%                   ! 8 #00011308' TO DFHEIV0
 12933     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12935     MOVE X'3820233030303131333038' TO DFHEIV0(25:11)
 12936     CALL 'kxdfhei1' USING DFHEIV0
 12937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12938
 12939
 12940
 12941* EXEC CICS WRITE
 12942*         DATASET  (ACTQ-FILE-ID)
 12943*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12944*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 241
* EL131.cbl
 12945*    END-EXEC.
 12946     MOVE LENGTH OF
 12947      ACTIVITY-QUE
 12948       TO DFHEIV11
 12949*    MOVE '&$ L                  ''   #00011312' TO DFHEIV0
 12950     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12951     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12952     MOVE X'2020233030303131333132' TO DFHEIV0(25:11)
 12953     CALL 'kxdfhei1' USING DFHEIV0,
 12954           ACTQ-FILE-ID,
 12955           ACTIVITY-QUE,
 12956           DFHEIV11,
 12957           AQ-CONTROL-PRIMARY,
 12958           DFHEIV99,
 12959           DFHEIV99
 12960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12961
 12962
 12963 2440-EXIT.
 12964     EXIT.
 12965
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 242
* EL131.cbl
 12967 2460-UPDATE-CHECKQ.
 12968
 12969* EXEC CICS HANDLE CONDITION
 12970*         NOTFND   (2460-EXIT)
 12971*    END-EXEC.
 12972*    MOVE '"$I                   ! 9 #00011323' TO DFHEIV0
 12973     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12975     MOVE X'3920233030303131333233' TO DFHEIV0(25:11)
 12976     CALL 'kxdfhei1' USING DFHEIV0
 12977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12978
 12979
 12980     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12981     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12982     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12983
 12984
 12985* EXEC CICS READ UPDATE
 12986*         DATASET   (CHKQ-FILE-ID)
 12987*         RIDFLD    (CHKQ-KEY)
 12988*         SET       (ADDRESS OF CHECK-QUE)
 12989*    END-EXEC.
 12990*    MOVE '&"S        EU         (   #00011331' TO DFHEIV0
 12991     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12992     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12993     MOVE X'2020233030303131333331' TO DFHEIV0(25:11)
 12994     CALL 'kxdfhei1' USING DFHEIV0,
 12995           CHKQ-FILE-ID,
 12996           DFHEIV20,
 12997           DFHEIV99,
 12998           CHKQ-KEY,
 12999           DFHEIV99,
 13000           DFHEIV99,
 13001           DFHEIV99
 13002     SET ADDRESS OF CHECK-QUE TO
 13003         DFHEIV20
 13004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13005
 13006
 13007     IF CERTI GREATER THAN LOW-VALUES
 13008        MOVE CERTI               TO CQ-CERT-PRIME.
 13009     IF SUFXI GREATER THAN LOW-VALUES
 13010        MOVE SUFXI               TO CQ-CERT-SFX.
 13011     IF CERTCARI GREATER THAN LOW-VALUES
 13012        MOVE CERTCARI            TO CQ-CARRIER.
 13013
 13014
 13015* EXEC CICS REWRITE
 13016*         DATASET  (CHKQ-FILE-ID)
 13017*         FROM     (CHECK-QUE)
 13018*    END-EXEC.
 13019     MOVE LENGTH OF
 13020      CHECK-QUE
 13021       TO DFHEIV11
 13022*    MOVE '&& L                  %   #00011344' TO DFHEIV0
 13023     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13024     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 243
* EL131.cbl
 13025     MOVE X'2020233030303131333434' TO DFHEIV0(25:11)
 13026     CALL 'kxdfhei1' USING DFHEIV0,
 13027           CHKQ-FILE-ID,
 13028           CHECK-QUE,
 13029           DFHEIV11,
 13030           DFHEIV99
 13031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13032
 13033
 13034 2460-EXIT.
 13035     EXIT.
 13036
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 244
* EL131.cbl
 13038 2475-UPDATE-LETTER.
 13039
 13040* EXEC CICS HANDLE CONDITION
 13041*         NOTFND   (2475-EXIT)
 13042*    END-EXEC.
 13043*    MOVE '"$I                   ! : #00011354' TO DFHEIV0
 13044     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13045     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13046     MOVE X'3A20233030303131333534' TO DFHEIV0(25:11)
 13047     CALL 'kxdfhei1' USING DFHEIV0
 13048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13049
 13050
 13051     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 13052     MOVE '1'                    TO ARCH-RECORD-TYPE.
 13053     MOVE ZEROS                  TO ARCH-SEQ-NO.
 13054     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 13055
 13056
 13057* EXEC CICS READ UPDATE
 13058*         DATASET   (ARCH-FILE-ID)
 13059*         RIDFLD    (ARCH-KEY)
 13060*         SET       (ADDRESS OF LETTER-ARCHIVE)
 13061*    END-EXEC.
 13062*    MOVE '&"S        EU         (   #00011363' TO DFHEIV0
 13063     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13064     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13065     MOVE X'2020233030303131333633' TO DFHEIV0(25:11)
 13066     CALL 'kxdfhei1' USING DFHEIV0,
 13067           ARCH-FILE-ID,
 13068           DFHEIV20,
 13069           DFHEIV99,
 13070           ARCH-KEY,
 13071           DFHEIV99,
 13072           DFHEIV99,
 13073           DFHEIV99
 13074     SET ADDRESS OF LETTER-ARCHIVE TO
 13075         DFHEIV20
 13076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13077
 13078
 13079* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 13080* TO THIS MASTER-KEY INFORMATION.
 13081
 13082     IF LA-CARRIER  = CARRIER-CODE AND
 13083        LA-CLAIM-NO = CLAIM-NO     AND
 13084        LA-CERT-NO  = CERT-NO
 13085        NEXT SENTENCE
 13086     ELSE
 13087        GO TO 2475-UNLOCK.
 13088
 13089     IF CERTI GREATER THAN LOW-VALUES
 13090        MOVE CERTI               TO LA-CERT-PRIME.
 13091     IF SUFXI GREATER THAN LOW-VALUES
 13092        MOVE SUFXI               TO LA-CERT-SFX.
 13093     IF CERTCARI GREATER THAN LOW-VALUES
 13094        MOVE CERTCARI            TO LA-CARRIER.
 13095
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 245
* EL131.cbl
 13096
 13097* EXEC CICS REWRITE
 13098*         DATASET  (ARCH-FILE-ID)
 13099*         FROM     (LETTER-ARCHIVE)
 13100*    END-EXEC.
 13101     MOVE LENGTH OF
 13102      LETTER-ARCHIVE
 13103       TO DFHEIV11
 13104*    MOVE '&& L                  %   #00011386' TO DFHEIV0
 13105     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13106     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13107     MOVE X'2020233030303131333836' TO DFHEIV0(25:11)
 13108     CALL 'kxdfhei1' USING DFHEIV0,
 13109           ARCH-FILE-ID,
 13110           LETTER-ARCHIVE,
 13111           DFHEIV11,
 13112           DFHEIV99
 13113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13114
 13115
 13116     GO TO 2475-EXIT.
 13117
 13118 2475-UNLOCK.
 13119
 13120* EXEC CICS UNLOCK
 13121*         DATASET  (ARCH-FILE-ID)
 13122*    END-EXEC.
 13123*    MOVE '&*                    #   #00011394' TO DFHEIV0
 13124     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13125     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13126     MOVE X'2020233030303131333934' TO DFHEIV0(25:11)
 13127     CALL 'kxdfhei1' USING DFHEIV0,
 13128           ARCH-FILE-ID,
 13129           DFHEIV99
 13130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13131
 13132
 13133 2475-EXIT.
 13134     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 246
* EL131.cbl
 13136 2600-CREATE-MAINT-NOTE.
 13137     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13138     MOVE '1'                    TO CNTL-REC-TYPE.
 13139     MOVE SPACES                 TO CNTL-PROC-ID.
 13140     MOVE ZERO                   TO CNTL-SEQ-NO.
 13141
 13142
 13143* EXEC CICS READ
 13144*         SET        (ADDRESS OF CONTROL-FILE)
 13145*         DATASET    ('ELCNTL')
 13146*         RIDFLD     (CNTL-KEY)
 13147*    END-EXEC.
 13148     MOVE 'ELCNTL' TO DFHEIV1
 13149*    MOVE '&"S        E          (   #00011407' TO DFHEIV0
 13150     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13151     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13152     MOVE X'2020233030303131343037' TO DFHEIV0(25:11)
 13153     CALL 'kxdfhei1' USING DFHEIV0,
 13154           DFHEIV1,
 13155           DFHEIV20,
 13156           DFHEIV99,
 13157           CNTL-KEY,
 13158           DFHEIV99,
 13159           DFHEIV99,
 13160           DFHEIV99
 13161     SET ADDRESS OF CONTROL-FILE TO
 13162         DFHEIV20
 13163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13164
 13165
 13166     IF CO-NO-USE-AUDIT-CHANGES
 13167         GO TO 2600-EXIT.
 13168
 13169     IF PROCL GREATER ZERO
 13170     IF PROCI NOT = LOW-VALUES
 13171     IF PROCI NOT = CL-PROCESSOR-ID
 13172         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 13173         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 13174         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13175
 13176     IF SEXL GREATER ZERO
 13177     IF SEXI NOT = LOW-VALUES
 13178     IF SEXI NOT = CL-INSURED-SEX-CD
 13179         MOVE 'SEX'                TO SPLIT-INFO-DESC
 13180         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13181         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13182
 13183     IF BIRTHL GREATER ZERO
 13184     IF HOLD-BIRTH NOT = LOW-VALUES
 13185     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13186         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13187         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13188         MOVE SPACES               TO DC-OPTION-CODE
 13189         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13190         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13191         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13192
 13193     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 247
* EL131.cbl
 13194     IF SOCIALI NOT = LOW-VALUES
 13195     IF SOCIALI NOT = CL-SOC-SEC-NO
 13196         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13197         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13198         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13199
 13200     IF OCCL GREATER ZERO
 13201     IF OCCI NOT = LOW-VALUES
 13202     IF OCCI NOT = CL-INSURED-OCC-CD
 13203         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13204         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13205         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13206
 13207     IF BENEL GREATER ZERO
 13208     IF BENEI NOT = LOW-VALUES
 13209     IF BENEI NOT = CL-BENEFICIARY
 13210         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13211         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13212         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13213
 13214     IF PREMTYPL GREATER ZERO
 13215     IF PREMTYPI NOT = LOW-VALUES
 13216     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13217         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13218         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13219         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13220
 13221*    IF CAUSEL GREATER ZERO
 13222*    IF CAUSEI NOT = LOW-VALUES
 13223*    IF CAUSEI NOT = CL-CAUSE-CD
 13224*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13225*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13226*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13227
 13228*    IF ENDL GREATER ZERO
 13229*    IF HOLD-END NOT = LOW-VALUES
 13230*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13231*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13232*        MOVE CL-EST-END-OF-DISAB-DT
 13233*                                  TO DC-BIN-DATE-1
 13234*        MOVE SPACES               TO DC-OPTION-CODE
 13235*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13236*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13237*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13238
 13239     IF PDTHRUL GREATER ZERO
 13240     IF HOLD-PDTHRU NOT = LOW-VALUES
 13241     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13242         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13243         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13244         MOVE SPACES               TO DC-OPTION-CODE
 13245         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13246         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13247         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13248
 13249     IF PDAMTL GREATER ZERO
 13250     IF HOLD-PDAMT NOT = ZEROS
 13251     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 248
* EL131.cbl
 13252         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13253         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13254         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13255         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13256
 13257     IF NODAYSL GREATER ZERO
 13258     IF HOLD-NODAYS NOT = ZEROS
 13259     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13260         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13261         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13262         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13263         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13264
 13265     IF NOPMTSL GREATER ZERO
 13266     IF HOLD-NOPMTS NOT = ZEROS
 13267     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13268         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13269         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13270         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13271         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13272
 13273     IF FORMTYPL GREATER ZERO
 13274     IF FORMTYPI NOT = LOW-VALUES
 13275     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13276         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13277         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13278         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13279
 13280     IF REPL GREATER ZERO
 13281     IF HOLD-REPORTED NOT = LOW-VALUES
 13282     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13283         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13284         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13285         MOVE SPACES               TO DC-OPTION-CODE
 13286         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13287         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13288         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13289
 13290     IF ADDONDTL GREATER ZERO
 13291     IF HOLD-ADDON NOT = LOW-VALUES
 13292     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13293         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13294         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13295         MOVE SPACES               TO DC-OPTION-CODE
 13296         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13297         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13298         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13299
 13300     IF PRICDL GREATER ZERO
 13301     IF PRICDI NOT = LOW-VALUES
 13302     IF PRICDI NOT = CL-PRIORITY-CD
 13303         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13304         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13305         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13306
 13307     IF FILETOL GREATER ZERO
 13308     IF FILETOI NOT = LOW-VALUES
 13309     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 249
* EL131.cbl
 13310         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13311         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13312         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13313
 13314     IF SUPVL GREATER ZERO
 13315     IF SUPVI NOT = LOW-VALUES
 13316     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13317         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13318         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13319         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13320*    IF (CRITPTL > ZERO)
 13321*       AND (CRITPTI NOT = LOW-VALUES)
 13322*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13323*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13324*       MOVE CL-CRIT-PER-RECURRENT
 13325*                                TO SPLIT-INFO-OLD
 13326*       PERFORM 2650-WRITE-MAINT-NOTE
 13327*                                THRU 2650-EXIT
 13328*    END-IF
 13329
 13330*    IF (RTWMOSL > ZERO)
 13331*       AND (RTWMOSI NOT = LOW-VALUES)
 13332*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13333*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13334*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13335*       PERFORM 2650-WRITE-MAINT-NOTE
 13336*                                THRU 2650-EXIT
 13337*    END-IF
 13338     IF MLNAMEL GREATER ZERO
 13339     IF MLNAMEI NOT = LOW-VALUES
 13340     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13341         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13342         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13343         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13344
 13345     IF MFNAMEL GREATER ZERO
 13346     IF MFNAMEI NOT = LOW-VALUES
 13347     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13348         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13349         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13350         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13351
 13352     IF MMINITL GREATER ZERO
 13353     IF MMINITI NOT = LOW-VALUES
 13354     IF MMINITI NOT = CL-INSURED-MID-INIT
 13355         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13356         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13357         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13358
 13359     IF CERTEFFL GREATER ZERO
 13360     IF HOLD-EFF NOT = LOW-VALUES
 13361     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13362         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13363         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13364         MOVE SPACES               TO DC-OPTION-CODE
 13365         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13366         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13367         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 250
* EL131.cbl
 13368
 13369     IF CERTACTL GREATER ZERO
 13370     IF CERTACTI NOT = LOW-VALUES
 13371     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13372         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13373         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13374         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13375
 13376     IF CERTSTL GREATER ZERO
 13377     IF CERTSTI NOT = LOW-VALUES
 13378     IF CERTSTI NOT = CL-CERT-STATE
 13379         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13380         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13381         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13382
 13383     IF CERTCARL GREATER ZERO
 13384     IF CERTCARI NOT = LOW-VALUES
 13385     IF CERTCARI NOT = CL-CERT-CARRIER
 13386         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13387         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13388         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13389
 13390     IF CERTGRPL GREATER ZERO
 13391     IF CERTGRPI NOT = LOW-VALUES
 13392     IF CERTGRPI NOT = CL-CERT-GROUPING
 13393         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13394         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13395         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13396
 13397     IF CERTL GREATER ZERO OR
 13398        SUFXL GREATER ZERO
 13399     IF (CERTI NOT = LOW-VALUES AND
 13400                     CL-CERT-PRIME)
 13401                OR
 13402        (SUFXI NOT = LOW-VALUES AND
 13403                     CL-CERT-SFX)
 13404         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13405         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13406         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13407     IF incl > zeros
 13408        IF (HOLD-INCUR NOT = LOW-VALUES)
 13409           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13410           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13411           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13412           MOVE SPACES           TO DC-OPTION-CODE
 13413           PERFORM 9800-CONVERT-DATE
 13414                                 THRU 9800-EXIT
 13415           MOVE DC-GREG-DATE-1-EDIT
 13416                                 TO SPLIT-INFO-OLD
 13417           PERFORM 2650-WRITE-MAINT-NOTE
 13418                                 THRU 2650-EXIT
 13419        END-IF
 13420     END-IF
 13421     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 13422       IF (REPL GREATER ZERO
 13423         AND HOLD-REPORTED NOT = LOW-VALUES
 13424         AND HOLD-REPORTED NOT = CL-REPORTED-DT)
 13425        OR (incl > zeros
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 251
* EL131.cbl
 13426          AND (HOLD-INCUR NOT = LOW-VALUES)
 13427             AND (HOLD-INCUR NOT = CL-INCURRED-DT))
 13428          PERFORM 2610-CHECK-2-YEAR-CONTESTABLE THRU 2610-EXIT
 13429       END-IF
 13430     END-IF
 13431     IF incl > zeros
 13432       AND PI-COMPANY-ID = 'CID'
 13433        IF (HOLD-INCUR NOT = LOW-VALUES)
 13434           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13435           IF TYPEI = PI-AH-OVERRIDE-L1
 13436              SET ELAPSED-BETWEEN-BIN TO TRUE
 13437              MOVE ZERO               TO DC-ELAPSED-MONTHS
 13438                                         DC-ELAPSED-DAYS
 13439
 13440              MOVE HOLD-INCUR  TO DC-BIN-DATE-1
 13441              MOVE SAVE-BIN-DATE TO DC-BIN-DATE-2
 13442              PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13443              IF DC-ODD-DAYS-OVER > ZERO
 13444                 ADD 1 TO DC-ELAPSED-MONTHS
 13445              END-IF
 13446
 13447              IF PI-STATE = 'HI'
 13448                AND DC-ELAPSED-MONTHS <= 18
 13449                 CONTINUE
 13450              ELSE
 13451                 IF DC-ELAPSED-MONTHS > 15
 13452                    MOVE ER-7572            TO EMI-ERROR
 13453                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13454                 END-IF
 13455              END-IF
 13456              PERFORM 2620-CHECK-TRLR THRU 2620-EXIT
 13457           END-IF
 13458        END-IF
 13459     END-IF
 13460     .
 13461 2600-EXIT.
 13462      EXIT.
 13463 2610-CHECK-2-YEAR-CONTESTABLE.
 13464     SET ELAPSED-BETWEEN-BIN TO TRUE
 13465     MOVE ZERO               TO DC-ELAPSED-MONTHS
 13466                                DC-ELAPSED-DAYS
 13467
 13468     MOVE HOLD-EFF TO DC-BIN-DATE-1.
 13469     IF HOLD-INCUR > SPACES
 13470        MOVE HOLD-INCUR TO DC-BIN-DATE-2
 13471     ELSE
 13472        MOVE CL-INCURRED-DT TO DC-BIN-DATE-2
 13473     END-IF
 13474     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13475     IF DC-ODD-DAYS-OVER > ZERO
 13476        ADD 1 TO DC-ELAPSED-MONTHS
 13477     END-IF
 13478
 13479     IF DC-ELAPSED-MONTHS <= 24
 13480        IF HOLD-REPORTED > SPACES
 13481           MOVE HOLD-REPORTED TO DC-BIN-DATE-2
 13482        ELSE
 13483           MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 252
* EL131.cbl
 13484        END-IF
 13485        MOVE ZERO           TO DC-ELAPSED-MONTHS
 13486                               DC-ELAPSED-DAYS
 13487        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13488        IF DC-ODD-DAYS-OVER > ZERO
 13489           ADD 1 TO DC-ELAPSED-MONTHS
 13490        END-IF
 13491        IF DC-ELAPSED-MONTHS > 24
 13492           MOVE ER-1679            TO EMI-ERROR
 13493           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13494        END-IF
 13495     END-IF.
 13496
 13497     PERFORM 2615-CHECK-TRLR THRU 2615-EXIT.
 13498
 13499 2610-EXIT.
 13500     EXIT.
 13501 2615-CHECK-TRLR.
 13502
 13503     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13504     MOVE +96              TO TRLR-SEQ-NO
 13505
 13506* EXEC CICS READ
 13507*       UPDATE
 13508*       DATASET  ('ELTRLR')
 13509*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13510*       RIDFLD   (TRLR-KEY)
 13511*       RESP     (WS-RESPONSE)
 13512*    END-EXEC
 13513     MOVE 'ELTRLR' TO DFHEIV1
 13514*    MOVE '&"S        EU         (  N#00011752' TO DFHEIV0
 13515     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13516     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13517     MOVE X'204E233030303131373532' TO DFHEIV0(25:11)
 13518     CALL 'kxdfhei1' USING DFHEIV0,
 13519           DFHEIV1,
 13520           DFHEIV20,
 13521           DFHEIV99,
 13522           TRLR-KEY,
 13523           DFHEIV99,
 13524           DFHEIV99,
 13525           DFHEIV99
 13526     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13527         DFHEIV20
 13528     MOVE EIBRESP  TO WS-RESPONSE
 13529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13530     IF WS-RESP-NORMAL
 13531        IF EMI-ERROR =  ER-1679
 13532           IF EMI-ERROR-NUMBER(1) = ER-1679
 13533              MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13534           ELSE
 13535           IF EMI-ERROR-NUMBER(2) = ER-1679
 13536              MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13537           ELSE
 13538           IF EMI-ERROR-NUMBER(3) = ER-1679
 13539              MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13540           END-IF
 13541           END-IF
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 253
* EL131.cbl
 13542           END-IF
 13543
 13544* EXEC CICS REWRITE
 13545*             DATASET   ('ELTRLR')
 13546*             FROM      (ACTIVITY-TRAILERS)
 13547*          END-EXEC
 13548     MOVE LENGTH OF
 13549      ACTIVITY-TRAILERS
 13550       TO DFHEIV11
 13551     MOVE 'ELTRLR' TO DFHEIV1
 13552*    MOVE '&& L                  %   #00011772' TO DFHEIV0
 13553     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13554     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13555     MOVE X'2020233030303131373732' TO DFHEIV0(25:11)
 13556     CALL 'kxdfhei1' USING DFHEIV0,
 13557           DFHEIV1,
 13558           ACTIVITY-TRAILERS,
 13559           DFHEIV11,
 13560           DFHEIV99
 13561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13562        ELSE
 13563           MOVE WS-CONTEST-NOTE TO AT-INFO-LINE-1
 13564
 13565* EXEC CICS REWRITE
 13566*                DATASET   ('ELTRLR')
 13567*                FROM      (ACTIVITY-TRAILERS)
 13568*             END-EXEC
 13569     MOVE LENGTH OF
 13570      ACTIVITY-TRAILERS
 13571       TO DFHEIV11
 13572     MOVE 'ELTRLR' TO DFHEIV1
 13573*    MOVE '&& L                  %   #00011778' TO DFHEIV0
 13574     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13575     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13576     MOVE X'2020233030303131373738' TO DFHEIV0(25:11)
 13577     CALL 'kxdfhei1' USING DFHEIV0,
 13578           DFHEIV1,
 13579           ACTIVITY-TRAILERS,
 13580           DFHEIV11,
 13581           DFHEIV99
 13582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13583        END-IF
 13584     ELSE
 13585
 13586* EXEC CICS GETMAIN
 13587*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13588*          LENGTH   (TRLR-LENGTH)
 13589*          INITIMG  (GETMAIN-SPACE)
 13590*       END-EXEC
 13591*    MOVE ',"IL                  $   #00011784' TO DFHEIV0
 13592     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13593     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13594     MOVE X'2020233030303131373834' TO DFHEIV0(25:11)
 13595     CALL 'kxdfhei1' USING DFHEIV0,
 13596           DFHEIV20,
 13597           TRLR-LENGTH,
 13598           GETMAIN-SPACE
 13599     SET ADDRESS OF ACTIVITY-TRAILERS TO
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 254
* EL131.cbl
 13600         DFHEIV20
 13601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13602        MOVE 'AT'          TO AT-RECORD-ID
 13603        MOVE CL-CONTROL-PRIMARY
 13604                           TO AT-CONTROL-PRIMARY
 13605        MOVE +96           TO AT-SEQUENCE-NO
 13606        MOVE '6'           TO AT-TRAILER-TYPE
 13607        MOVE SPACES             TO AT-GENERAL-INFO-TR
 13608        INITIALIZE AT-GENERAL-INFO-TR
 13609        IF EMI-ERROR-NUMBER(1) = ER-1679
 13610           MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13611        ELSE
 13612        IF EMI-ERROR-NUMBER(2) = ER-1679
 13613           MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13614        ELSE
 13615        IF EMI-ERROR-NUMBER(3) = ER-1679
 13616           MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13617        END-IF
 13618        END-IF
 13619        END-IF
 13620        MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13621        MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13622                              AT-GEN-INFO-LAST-MAINT-DT
 13623        MOVE PI-PROCESSOR-ID
 13624                           TO AT-RECORDED-BY
 13625                              AT-GEN-INFO-LAST-UPDATED-BY
 13626        MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13627
 13628* EXEC CICS WRITE
 13629*          DATASET   ('ELTRLR')
 13630*          FROM      (ACTIVITY-TRAILERS)
 13631*          RIDFLD    (TRLR-KEY)
 13632*       END-EXEC
 13633     MOVE LENGTH OF
 13634      ACTIVITY-TRAILERS
 13635       TO DFHEIV11
 13636     MOVE 'ELTRLR' TO DFHEIV1
 13637*    MOVE '&$ L                  ''   #00011814' TO DFHEIV0
 13638     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13639     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13640     MOVE X'2020233030303131383134' TO DFHEIV0(25:11)
 13641     CALL 'kxdfhei1' USING DFHEIV0,
 13642           DFHEIV1,
 13643           ACTIVITY-TRAILERS,
 13644           DFHEIV11,
 13645           TRLR-KEY,
 13646           DFHEIV99,
 13647           DFHEIV99
 13648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13649     END-IF
 13650     .
 13651 2615-EXIT.
 13652     EXIT.
 13653
 13654 2620-CHECK-TRLR.
 13655
 13656     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13657     MOVE +96              TO TRLR-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 255
* EL131.cbl
 13658
 13659* EXEC CICS READ
 13660*       UPDATE
 13661*       DATASET  ('ELTRLR')
 13662*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13663*       RIDFLD   (TRLR-KEY)
 13664*       RESP     (WS-RESPONSE)
 13665*    END-EXEC
 13666     MOVE 'ELTRLR' TO DFHEIV1
 13667*    MOVE '&"S        EU         (  N#00011828' TO DFHEIV0
 13668     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13669     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13670     MOVE X'204E233030303131383238' TO DFHEIV0(25:11)
 13671     CALL 'kxdfhei1' USING DFHEIV0,
 13672           DFHEIV1,
 13673           DFHEIV20,
 13674           DFHEIV99,
 13675           TRLR-KEY,
 13676           DFHEIV99,
 13677           DFHEIV99,
 13678           DFHEIV99
 13679     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13680         DFHEIV20
 13681     MOVE EIBRESP  TO WS-RESPONSE
 13682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13683     IF WS-RESP-NORMAL
 13684        IF EMI-ERROR =  ER-7572
 13685           IF EMI-ERROR-NUMBER(1) = ER-7572
 13686              MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13687           ELSE
 13688           IF EMI-ERROR-NUMBER(2) = ER-7572
 13689              MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13690           ELSE
 13691           IF EMI-ERROR-NUMBER(3) = ER-7572
 13692              MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13693           END-IF
 13694           END-IF
 13695           END-IF
 13696
 13697* EXEC CICS REWRITE
 13698*             DATASET   ('ELTRLR')
 13699*             FROM      (ACTIVITY-TRAILERS)
 13700*          END-EXEC
 13701     MOVE LENGTH OF
 13702      ACTIVITY-TRAILERS
 13703       TO DFHEIV11
 13704     MOVE 'ELTRLR' TO DFHEIV1
 13705*    MOVE '&& L                  %   #00011848' TO DFHEIV0
 13706     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13707     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13708     MOVE X'2020233030303131383438' TO DFHEIV0(25:11)
 13709     CALL 'kxdfhei1' USING DFHEIV0,
 13710           DFHEIV1,
 13711           ACTIVITY-TRAILERS,
 13712           DFHEIV11,
 13713           DFHEIV99
 13714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13715        ELSE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 256
* EL131.cbl
 13716           MOVE WS-FILE-LIM-NOTE TO AT-INFO-LINE-1
 13717
 13718* EXEC CICS REWRITE
 13719*                DATASET   ('ELTRLR')
 13720*                FROM      (ACTIVITY-TRAILERS)
 13721*             END-EXEC
 13722     MOVE LENGTH OF
 13723      ACTIVITY-TRAILERS
 13724       TO DFHEIV11
 13725     MOVE 'ELTRLR' TO DFHEIV1
 13726*    MOVE '&& L                  %   #00011854' TO DFHEIV0
 13727     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13728     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13729     MOVE X'2020233030303131383534' TO DFHEIV0(25:11)
 13730     CALL 'kxdfhei1' USING DFHEIV0,
 13731           DFHEIV1,
 13732           ACTIVITY-TRAILERS,
 13733           DFHEIV11,
 13734           DFHEIV99
 13735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13736        END-IF
 13737     ELSE
 13738        IF EMI-ERROR =  ER-7572
 13739
 13740* EXEC CICS GETMAIN
 13741*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13742*             LENGTH   (TRLR-LENGTH)
 13743*             INITIMG  (GETMAIN-SPACE)
 13744*          END-EXEC
 13745*    MOVE ',"IL                  $   #00011861' TO DFHEIV0
 13746     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13747     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13748     MOVE X'2020233030303131383631' TO DFHEIV0(25:11)
 13749     CALL 'kxdfhei1' USING DFHEIV0,
 13750           DFHEIV20,
 13751           TRLR-LENGTH,
 13752           GETMAIN-SPACE
 13753     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13754         DFHEIV20
 13755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13756           MOVE 'AT'          TO AT-RECORD-ID
 13757           MOVE CL-CONTROL-PRIMARY
 13758                              TO AT-CONTROL-PRIMARY
 13759           MOVE +96           TO AT-SEQUENCE-NO
 13760           MOVE '6'           TO AT-TRAILER-TYPE
 13761           MOVE SPACES             TO AT-GENERAL-INFO-TR
 13762           INITIALIZE AT-GENERAL-INFO-TR
 13763           IF EMI-ERROR-NUMBER(1) = ER-7572
 13764              MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13765           ELSE
 13766           IF EMI-ERROR-NUMBER(2) = ER-7572
 13767              MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13768           ELSE
 13769           IF EMI-ERROR-NUMBER(3) = ER-7572
 13770              MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13771           END-IF
 13772           END-IF
 13773           END-IF
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 257
* EL131.cbl
 13774           MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13775           MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13776                                 AT-GEN-INFO-LAST-MAINT-DT
 13777           MOVE PI-PROCESSOR-ID
 13778                              TO AT-RECORDED-BY
 13779                                 AT-GEN-INFO-LAST-UPDATED-BY
 13780           MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13781
 13782* EXEC CICS WRITE
 13783*             DATASET   ('ELTRLR')
 13784*             FROM      (ACTIVITY-TRAILERS)
 13785*             RIDFLD    (TRLR-KEY)
 13786*          END-EXEC
 13787     MOVE LENGTH OF
 13788      ACTIVITY-TRAILERS
 13789       TO DFHEIV11
 13790     MOVE 'ELTRLR' TO DFHEIV1
 13791*    MOVE '&$ L                  ''   #00011891' TO DFHEIV0
 13792     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13793     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13794     MOVE X'2020233030303131383931' TO DFHEIV0(25:11)
 13795     CALL 'kxdfhei1' USING DFHEIV0,
 13796           DFHEIV1,
 13797           ACTIVITY-TRAILERS,
 13798           DFHEIV11,
 13799           TRLR-KEY,
 13800           DFHEIV99,
 13801           DFHEIV99
 13802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13803        END-IF
 13804     END-IF
 13805     .
 13806 2620-EXIT.
 13807     EXIT.
 13808
 13809 2650-WRITE-MAINT-NOTE.
 13810
 13811* EXEC CICS GETMAIN
 13812*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13813*         LENGTH   (TRLR-LENGTH)
 13814*         INITIMG  (GETMAIN-SPACE)
 13815*    END-EXEC.
 13816*    MOVE ',"IL                  $   #00011903' TO DFHEIV0
 13817     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13818     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13819     MOVE X'2020233030303131393033' TO DFHEIV0(25:11)
 13820     CALL 'kxdfhei1' USING DFHEIV0,
 13821           DFHEIV20,
 13822           TRLR-LENGTH,
 13823           GETMAIN-SPACE
 13824     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13825         DFHEIV20
 13826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13827
 13828
 13829
 13830* EXEC CICS HANDLE CONDITION
 13831*         DUPREC   (2650-EXIT)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 258
* EL131.cbl
 13832*    END-EXEC.
 13833*    MOVE '"$%                   ! ; #00011909' TO DFHEIV0
 13834     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13836     MOVE X'3B20233030303131393039' TO DFHEIV0(25:11)
 13837     CALL 'kxdfhei1' USING DFHEIV0
 13838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13839
 13840
 13841     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13842
 13843     IF CERTL GREATER ZERO
 13844         MOVE CERTI          TO CL-CERT-PRIME.
 13845
 13846     IF SUFXL GREATER ZERO
 13847         MOVE SUFXI          TO CL-CERT-SFX.
 13848
 13849     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13850
 13851     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13852     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13853
 13854     MOVE 'AT'               TO AT-RECORD-ID.
 13855
 13856     MOVE '6'                TO AT-TRAILER-TYPE.
 13857     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13858                                AT-GEN-INFO-LAST-MAINT-DT.
 13859     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13860                                AT-GEN-INFO-LAST-UPDATED-BY.
 13861     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13862     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13863     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13864
 13865
 13866* EXEC CICS WRITE
 13867*         DATASET  (TRLR-FILE-ID)
 13868*         RIDFLD   (AT-CONTROL-PRIMARY)
 13869*         FROM     (ACTIVITY-TRAILERS)
 13870*    END-EXEC.
 13871     MOVE LENGTH OF
 13872      ACTIVITY-TRAILERS
 13873       TO DFHEIV11
 13874*    MOVE '&$ L                  ''   #00011937' TO DFHEIV0
 13875     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13876     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13877     MOVE X'2020233030303131393337' TO DFHEIV0(25:11)
 13878     CALL 'kxdfhei1' USING DFHEIV0,
 13879           TRLR-FILE-ID,
 13880           ACTIVITY-TRAILERS,
 13881           DFHEIV11,
 13882           AT-CONTROL-PRIMARY,
 13883           DFHEIV99,
 13884           DFHEIV99
 13885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13886
 13887
 13888 2650-EXIT.
 13889      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 259
* EL131.cbl
 13890
 13891 2800-CHECK-AUTO-PAY.
 13892
 13893     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13894     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13895     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13896     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13897     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13898
 13899
 13900* EXEC CICS HANDLE CONDITION
 13901*         NOTFND    (2800-EXIT)
 13902*         ENDFILE   (2800-EXIT)
 13903*    END-EXEC.
 13904*    MOVE '"$I''                  ! < #00011954' TO DFHEIV0
 13905     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13906     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13907     MOVE X'3C20233030303131393534' TO DFHEIV0(25:11)
 13908     CALL 'kxdfhei1' USING DFHEIV0
 13909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13910
 13911
 13912
 13913* EXEC CICS READ
 13914*        DATASET (TRLR-FILE-ID)
 13915*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13916*        RIDFLD  (TRLR-KEY)
 13917*    END-EXEC.
 13918*    MOVE '&"S        E          (   #00011959' TO DFHEIV0
 13919     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13920     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13921     MOVE X'2020233030303131393539' TO DFHEIV0(25:11)
 13922     CALL 'kxdfhei1' USING DFHEIV0,
 13923           TRLR-FILE-ID,
 13924           DFHEIV20,
 13925           DFHEIV99,
 13926           TRLR-KEY,
 13927           DFHEIV99,
 13928           DFHEIV99,
 13929           DFHEIV99
 13930     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13931         DFHEIV20
 13932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13933
 13934
 13935     IF BENEFICIARY-PAID-AUTO
 13936         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13937     END-IF.
 13938
 13939 2800-EXIT.
 13940      EXIT.
 13941
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 260
* EL131.cbl
 13943 3000-DELETE-CLAIM.
 13944     IF  NOT MODIFY-CAP
 13945         MOVE ER-0070            TO EMI-ERROR
 13946         MOVE -1                 TO MAINTL
 13947         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13948         GO TO 8110-SEND-DATA.
 13949
 13950
 13951* EXEC CICS READ
 13952*         SET      (ADDRESS OF CLAIM-MASTER)
 13953*         DATASET  (CLMS-FILE-ID)
 13954*         RIDFLD   (MSTR-KEY)
 13955*    END-EXEC.
 13956*    MOVE '&"S        E          (   #00011980' TO DFHEIV0
 13957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13959     MOVE X'2020233030303131393830' TO DFHEIV0(25:11)
 13960     CALL 'kxdfhei1' USING DFHEIV0,
 13961           CLMS-FILE-ID,
 13962           DFHEIV20,
 13963           DFHEIV99,
 13964           MSTR-KEY,
 13965           DFHEIV99,
 13966           DFHEIV99,
 13967           DFHEIV99
 13968     SET ADDRESS OF CLAIM-MASTER TO
 13969         DFHEIV20
 13970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13971
 13972
 13973     IF CL-1ST-TRL-AVAIL
 13974         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13975     ELSE
 13976        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13977        MOVE 0                   TO TRLR-SEQ-NO
 13978
 13979* EXEC CICS STARTBR
 13980*            DATASET (TRLR-FILE-ID)
 13981*            RIDFLD  (TRLR-KEY)
 13982*        END-EXEC
 13983     MOVE 0
 13984       TO DFHEIV11
 13985*    MOVE '&,         G          &   #00011991' TO DFHEIV0
 13986     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13987     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13988     MOVE X'2020233030303131393931' TO DFHEIV0(25:11)
 13989     CALL 'kxdfhei1' USING DFHEIV0,
 13990           TRLR-FILE-ID,
 13991           TRLR-KEY,
 13992           DFHEIV99,
 13993           DFHEIV11,
 13994           DFHEIV99
 13995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13996         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13997
 13998* EXEC CICS ENDBR
 13999*            DATASET (TRLR-FILE-ID)
 14000*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 261
* EL131.cbl
 14001     MOVE 0
 14002       TO DFHEIV11
 14003*    MOVE '&2                    $   #00011996' TO DFHEIV0
 14004     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14005     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14006     MOVE X'2020233030303131393936' TO DFHEIV0(25:11)
 14007     CALL 'kxdfhei1' USING DFHEIV0,
 14008           TRLR-FILE-ID,
 14009           DFHEIV11,
 14010           DFHEIV99
 14011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14012        IF SCREEN-ERROR
 14013            MOVE ER-0208         TO EMI-ERROR
 14014            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14015            MOVE -1              TO MAINTL
 14016            GO TO 8110-SEND-DATA
 14017        ELSE
 14018            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 14019
 14020     IF SCREEN-ERROR
 14021         MOVE -1                 TO MAINTL
 14022         GO TO 8110-SEND-DATA.
 14023
 14024     MOVE -1                     TO ONE-OR-MIN1.
 14025     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 14026
 14027     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 14028         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 14029                                    WS-SAVE-CLAIM-KEY
 14030         MOVE +1                 TO ONE-OR-MIN1
 14031         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 14032
 14033     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 14034
 14035     MOVE LOW-VALUES             TO EL131AO.
 14036     MOVE ER-0000                TO EMI-ERROR.
 14037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14038     MOVE 'X'                    TO PI-RETURN-CD-1.
 14039     MOVE -1                     TO MAINTL.
 14040     GO TO 8100-SEND-MAP.
 14041
 14042 3010-DEL-MSTR-TRLR.
 14043
 14044* EXEC CICS READ UPDATE
 14045*         SET       (ADDRESS OF CLAIM-MASTER)
 14046*         DATASET   (CLMS-FILE-ID)
 14047*         RIDFLD    (MSTR-KEY)
 14048*    END-EXEC.
 14049*    MOVE '&"S        EU         (   #00012030' TO DFHEIV0
 14050     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14051     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14052     MOVE X'2020233030303132303330' TO DFHEIV0(25:11)
 14053     CALL 'kxdfhei1' USING DFHEIV0,
 14054           CLMS-FILE-ID,
 14055           DFHEIV20,
 14056           DFHEIV99,
 14057           MSTR-KEY,
 14058           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 262
* EL131.cbl
 14059           DFHEIV99,
 14060           DFHEIV99
 14061     SET ADDRESS OF CLAIM-MASTER TO
 14062         DFHEIV20
 14063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14064
 14065
 14066     if (cl-priority-cd = '8')
 14067        and (pi-processor-id not = 'PEMA' and 'JMS '
 14068             AND 'AMWA')
 14069        MOVE ER-8003             TO EMI-ERROR
 14070        PERFORM 9900-ERROR-FORMAT
 14071                                 THRU 9900-EXIT
 14072        MOVE -1                  TO MAINTL
 14073        GO TO 8110-SEND-DATA
 14074     end-if
 14075
 14076     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 14077     MOVE ZERO                   TO TRLR-SEQ-NO.
 14078
 14079
 14080* EXEC CICS HANDLE CONDITION
 14081*         NOTFND    (3010-DEL-ACTQ)
 14082*         ENDFILE   (3040-EXIT)
 14083*    END-EXEC.
 14084*    MOVE '"$I''                  ! = #00012049' TO DFHEIV0
 14085     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14086     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14087     MOVE X'3D20233030303132303439' TO DFHEIV0(25:11)
 14088     CALL 'kxdfhei1' USING DFHEIV0
 14089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14090
 14091
 14092     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 14093
 14094 3010-DEL-ACTQ.
 14095
 14096
 14097* EXEC CICS HANDLE CONDITION
 14098*         NOTFND    (3010-NO-ACTIVITY)
 14099*         ENDFILE   (3050-EXIT)
 14100*    END-EXEC.
 14101*    MOVE '"$I''                  ! > #00012058' TO DFHEIV0
 14102     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14103     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14104     MOVE X'3E20233030303132303538' TO DFHEIV0(25:11)
 14105     CALL 'kxdfhei1' USING DFHEIV0
 14106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14107
 14108
 14109
 14110* EXEC CICS STARTBR
 14111*         DATASET  (ACTQ-FILE-ID)
 14112*         RIDFLD   (ACTQ-KEY)
 14113*    END-EXEC.
 14114     MOVE 0
 14115       TO DFHEIV11
 14116*    MOVE '&,         G          &   #00012063' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 263
* EL131.cbl
 14117     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14118     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14119     MOVE X'2020233030303132303633' TO DFHEIV0(25:11)
 14120     CALL 'kxdfhei1' USING DFHEIV0,
 14121           ACTQ-FILE-ID,
 14122           ACTQ-KEY,
 14123           DFHEIV99,
 14124           DFHEIV11,
 14125           DFHEIV99
 14126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14127
 14128
 14129
 14130* EXEC CICS GETMAIN
 14131*         SET      (ADDRESS OF ACTIVITY-QUE)
 14132*         LENGTH   (ACTQ-LENGTH)
 14133*         INITIMG  (GETMAIN-SPACE)
 14134*    END-EXEC.
 14135*    MOVE ',"IL                  $   #00012068' TO DFHEIV0
 14136     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14137     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14138     MOVE X'2020233030303132303638' TO DFHEIV0(25:11)
 14139     CALL 'kxdfhei1' USING DFHEIV0,
 14140           DFHEIV20,
 14141           ACTQ-LENGTH,
 14142           GETMAIN-SPACE
 14143     SET ADDRESS OF ACTIVITY-QUE TO
 14144         DFHEIV20
 14145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14146
 14147
 14148     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 14149
 14150
 14151* EXEC CICS ENDBR
 14152*         DATASET (ACTQ-FILE-ID)
 14153*    END-EXEC.
 14154     MOVE 0
 14155       TO DFHEIV11
 14156*    MOVE '&2                    $   #00012076' TO DFHEIV0
 14157     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14158     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14159     MOVE X'2020233030303132303736' TO DFHEIV0(25:11)
 14160     CALL 'kxdfhei1' USING DFHEIV0,
 14161           ACTQ-FILE-ID,
 14162           DFHEIV11,
 14163           DFHEIV99
 14164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14165
 14166
 14167 3010-NO-ACTIVITY.
 14168
 14169
 14170* EXEC CICS HANDLE CONDITION
 14171*        NOTFND   (3010-CERT-NOT-FOUND)
 14172*    END-EXEC.
 14173*    MOVE '"$I                   ! ? #00012082' TO DFHEIV0
 14174     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 264
* EL131.cbl
 14175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14176     MOVE X'3F20233030303132303832' TO DFHEIV0(25:11)
 14177     CALL 'kxdfhei1' USING DFHEIV0
 14178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14179
 14180
 14181     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 14182     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 14183     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 14184     MOVE CL-CERT-STATE          TO CERT-STATE.
 14185     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 14186     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 14187     MOVE CL-CERT-NO             TO CERT-CERT.
 14188
 14189
 14190* EXEC CICS READ
 14191*        DATASET   (CERT-FILE-ID)
 14192*        RIDFLD    (CERT-KEY)
 14193*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14194*    END-EXEC.
 14195*    MOVE '&"S        E          (   #00012094' TO DFHEIV0
 14196     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14198     MOVE X'2020233030303132303934' TO DFHEIV0(25:11)
 14199     CALL 'kxdfhei1' USING DFHEIV0,
 14200           CERT-FILE-ID,
 14201           DFHEIV20,
 14202           DFHEIV99,
 14203           CERT-KEY,
 14204           DFHEIV99,
 14205           DFHEIV99,
 14206           DFHEIV99
 14207     SET ADDRESS OF CERTIFICATE-MASTER TO
 14208         DFHEIV20
 14209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14210
 14211
 14212     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 14213       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 14214         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 14215     ELSE
 14216         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 14217
 14218 3010-UPDATE-CERT-TRLR.
 14219
 14220     MOVE CERT-KEY               TO ELCRTT-KEY
 14221     MOVE 'B'                    TO CTRLR-REC-TYPE
 14222
 14223* EXEC CICS READ
 14224*       UPDATE
 14225*       DATASET   ('ELCRTT')
 14226*       RIDFLD    (ELCRTT-KEY)
 14227*       INTO      (CERTIFICATE-TRAILERS)
 14228*       RESP      (WS-RESPONSE)
 14229*    END-EXEC
 14230     MOVE LENGTH OF
 14231      CERTIFICATE-TRAILERS
 14232       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 265
* EL131.cbl
 14233     MOVE 'ELCRTT' TO DFHEIV1
 14234*    MOVE '&"IL       EU         (  N#00012110' TO DFHEIV0
 14235     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14236     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14237     MOVE X'204E233030303132313130' TO DFHEIV0(25:11)
 14238     CALL 'kxdfhei1' USING DFHEIV0,
 14239           DFHEIV1,
 14240           CERTIFICATE-TRAILERS,
 14241           DFHEIV11,
 14242           ELCRTT-KEY,
 14243           DFHEIV99,
 14244           DFHEIV99,
 14245           DFHEIV99
 14246     MOVE EIBRESP  TO WS-RESPONSE
 14247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14248     IF WS-RESP-NORMAL
 14249        perform varying s1 from +1 by +1 until
 14250           (s1 > +24)
 14251           or (cs-claim-no (s1) = cl-claim-no)
 14252        end-perform
 14253        if s1 < +25
 14254           move spaces           to cs-claim-no (s1)
 14255                                    cs-claim-type (s1)
 14256                                    cs-insured-type (s1)
 14257           move zeros            to cs-days-paid (s1)
 14258                                    cs-total-paid (s1)
 14259                                    cs-benefit-period (s1)
 14260           if s1 not = +24
 14261              compute s2 = s1 + +1
 14262              perform 3015-bump  thru 3015-exit
 14263           end-if
 14264
 14265* EXEC CICS REWRITE
 14266*             DATASET   ('ELCRTT')
 14267*             FROM      (CERTIFICATE-TRAILERS)
 14268*          END-EXEC
 14269     MOVE LENGTH OF
 14270      CERTIFICATE-TRAILERS
 14271       TO DFHEIV11
 14272     MOVE 'ELCRTT' TO DFHEIV1
 14273*    MOVE '&& L                  %   #00012133' TO DFHEIV0
 14274     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14275     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14276     MOVE X'2020233030303132313333' TO DFHEIV0(25:11)
 14277     CALL 'kxdfhei1' USING DFHEIV0,
 14278           DFHEIV1,
 14279           CERTIFICATE-TRAILERS,
 14280           DFHEIV11,
 14281           DFHEIV99
 14282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14283        end-if
 14284     end-if
 14285     .
 14286 3010-CERT-NOT-FOUND.
 14287
 14288
 14289* EXEC CICS DELETE
 14290*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 266
* EL131.cbl
 14291*    END-EXEC.
 14292*    MOVE '&(                    &   #00012142' TO DFHEIV0
 14293     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14294     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14295     MOVE X'2020233030303132313432' TO DFHEIV0(25:11)
 14296     CALL 'kxdfhei1' USING DFHEIV0,
 14297           CLMS-FILE-ID,
 14298           DFHEIV99,
 14299           DFHEIV99,
 14300           DFHEIV99,
 14301           DFHEIV99
 14302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14303
 14304
 14305 3010-EXIT.
 14306      EXIT.
 14307
 14308 3015-bump.
 14309     perform varying s2 from s2 by +1 until s2 > +24
 14310        move cs-mb-claim-data (s2)
 14311                                 to cs-mb-claim-data (s1)
 14312        move spaces              to cs-mb-claim-data (s2)
 14313        add +1 to s1
 14314     end-perform
 14315     .
 14316 3015-exit.
 14317     exit.
 14318 3020-UPDATE-CERT.
 14319
 14320* EXEC CICS READ UPDATE
 14321*         DATASET  (CERT-FILE-ID)
 14322*         RIDFLD   (CERT-KEY)
 14323*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14324*    END-EXEC.
 14325*    MOVE '&"S        EU         (   #00012160' TO DFHEIV0
 14326     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14327     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14328     MOVE X'2020233030303132313630' TO DFHEIV0(25:11)
 14329     CALL 'kxdfhei1' USING DFHEIV0,
 14330           CERT-FILE-ID,
 14331           DFHEIV20,
 14332           DFHEIV99,
 14333           CERT-KEY,
 14334           DFHEIV99,
 14335           DFHEIV99,
 14336           DFHEIV99
 14337     SET ADDRESS OF CERTIFICATE-MASTER TO
 14338         DFHEIV20
 14339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14340
 14341
 14342     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 14343
 14344
 14345* EXEC CICS HANDLE CONDITION
 14346*         DUPKEY   (3020-EXIT)
 14347*    END-EXEC.
 14348*    MOVE '"$$                   ! @ #00012168' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 267
* EL131.cbl
 14349     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 14350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14351     MOVE X'4020233030303132313638' TO DFHEIV0(25:11)
 14352     CALL 'kxdfhei1' USING DFHEIV0
 14353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14354
 14355
 14356
 14357* EXEC CICS REWRITE
 14358*         DATASET  (CERT-FILE-ID)
 14359*         FROM     (CERTIFICATE-MASTER)
 14360*    END-EXEC.
 14361     MOVE LENGTH OF
 14362      CERTIFICATE-MASTER
 14363       TO DFHEIV11
 14364*    MOVE '&& L                  %   #00012172' TO DFHEIV0
 14365     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14366     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14367     MOVE X'2020233030303132313732' TO DFHEIV0(25:11)
 14368     CALL 'kxdfhei1' USING DFHEIV0,
 14369           CERT-FILE-ID,
 14370           CERTIFICATE-MASTER,
 14371           DFHEIV11,
 14372           DFHEIV99
 14373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14374
 14375
 14376 3020-EXIT.
 14377     EXIT.
 14378
 14379 3030-DELETE-CERT.
 14380
 14381* EXEC CICS READ UPDATE
 14382*         DATASET  (CERT-FILE-ID)
 14383*         RIDFLD   (CERT-KEY)
 14384*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14385*    END-EXEC.
 14386*    MOVE '&"S        EU         (   #00012181' TO DFHEIV0
 14387     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14388     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14389     MOVE X'2020233030303132313831' TO DFHEIV0(25:11)
 14390     CALL 'kxdfhei1' USING DFHEIV0,
 14391           CERT-FILE-ID,
 14392           DFHEIV20,
 14393           DFHEIV99,
 14394           CERT-KEY,
 14395           DFHEIV99,
 14396           DFHEIV99,
 14397           DFHEIV99
 14398     SET ADDRESS OF CERTIFICATE-MASTER TO
 14399         DFHEIV20
 14400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14401
 14402
 14403
 14404* EXEC CICS DELETE
 14405*         DATASET   (CERT-FILE-ID)
 14406*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 268
* EL131.cbl
 14407*    MOVE '&(                    &   #00012187' TO DFHEIV0
 14408     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14409     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14410     MOVE X'2020233030303132313837' TO DFHEIV0(25:11)
 14411     CALL 'kxdfhei1' USING DFHEIV0,
 14412           CERT-FILE-ID,
 14413           DFHEIV99,
 14414           DFHEIV99,
 14415           DFHEIV99,
 14416           DFHEIV99
 14417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14418
 14419
 14420 3030-EXIT.
 14421     EXIT.
 14422
 14423 3040-DELETE-TRLR.
 14424
 14425* EXEC CICS READ
 14426*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14427*         DATASET  (TRLR-FILE-ID)
 14428*         RIDFLD   (TRLR-KEY)
 14429*         GTEQ
 14430*    END-EXEC.
 14431*    MOVE '&"S        G          (   #00012195' TO DFHEIV0
 14432     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14433     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14434     MOVE X'2020233030303132313935' TO DFHEIV0(25:11)
 14435     CALL 'kxdfhei1' USING DFHEIV0,
 14436           TRLR-FILE-ID,
 14437           DFHEIV20,
 14438           DFHEIV99,
 14439           TRLR-KEY,
 14440           DFHEIV99,
 14441           DFHEIV99,
 14442           DFHEIV99
 14443     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14444         DFHEIV20
 14445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14446
 14447
 14448     IF PI-COMPANY-CD = AT-COMPANY-CD
 14449        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 14450        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14451           GO TO 3040-EXIT
 14452        ELSE
 14453           NEXT SENTENCE
 14454     ELSE
 14455        GO TO 3040-EXIT.
 14456
 14457
 14458* EXEC CICS DELETE
 14459*         DATASET  (TRLR-FILE-ID)
 14460*         RIDFLD   (TRLR-KEY)
 14461*    END-EXEC.
 14462*    MOVE '&(  R                 &   #00012211' TO DFHEIV0
 14463     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14464     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 269
* EL131.cbl
 14465     MOVE X'2020233030303132323131' TO DFHEIV0(25:11)
 14466     CALL 'kxdfhei1' USING DFHEIV0,
 14467           TRLR-FILE-ID,
 14468           TRLR-KEY,
 14469           DFHEIV99,
 14470           DFHEIV99,
 14471           DFHEIV99
 14472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14473
 14474
 14475     GO TO 3040-DELETE-TRLR.
 14476
 14477 3040-EXIT.
 14478     EXIT.
 14479
 14480 3050-DELETE-ACTQ.
 14481
 14482* EXEC CICS READNEXT
 14483*         DATASET  (ACTQ-FILE-ID)
 14484*         RIDFLD   (ACTQ-KEY)
 14485*         INTO     (ACTIVITY-QUE)
 14486*    END-EXEC.
 14487     MOVE LENGTH OF
 14488      ACTIVITY-QUE
 14489       TO DFHEIV12
 14490     MOVE 0
 14491       TO DFHEIV11
 14492*    MOVE '&.IL                  )   #00012222' TO DFHEIV0
 14493     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14494     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14495     MOVE X'2020233030303132323232' TO DFHEIV0(25:11)
 14496     CALL 'kxdfhei1' USING DFHEIV0,
 14497           ACTQ-FILE-ID,
 14498           ACTIVITY-QUE,
 14499           DFHEIV12,
 14500           ACTQ-KEY,
 14501           DFHEIV99,
 14502           DFHEIV11,
 14503           DFHEIV99,
 14504           DFHEIV99
 14505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14506
 14507
 14508     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 14509         GO TO 3050-EXIT.
 14510
 14511
 14512* EXEC CICS ENDBR
 14513*         DATASET  (ACTQ-FILE-ID)
 14514*    END-EXEC.
 14515     MOVE 0
 14516       TO DFHEIV11
 14517*    MOVE '&2                    $   #00012231' TO DFHEIV0
 14518     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14519     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14520     MOVE X'2020233030303132323331' TO DFHEIV0(25:11)
 14521     CALL 'kxdfhei1' USING DFHEIV0,
 14522           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 270
* EL131.cbl
 14523           DFHEIV11,
 14524           DFHEIV99
 14525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14526
 14527
 14528
 14529* EXEC CICS DELETE
 14530*         DATASET   (ACTQ-FILE-ID)
 14531*         RIDFLD    (ACTQ-KEY)
 14532*    END-EXEC.
 14533*    MOVE '&(  R                 &   #00012235' TO DFHEIV0
 14534     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14535     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14536     MOVE X'2020233030303132323335' TO DFHEIV0(25:11)
 14537     CALL 'kxdfhei1' USING DFHEIV0,
 14538           ACTQ-FILE-ID,
 14539           ACTQ-KEY,
 14540           DFHEIV99,
 14541           DFHEIV99,
 14542           DFHEIV99
 14543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14544
 14545
 14546
 14547* EXEC CICS STARTBR
 14548*         DATASET   (ACTQ-FILE-ID)
 14549*         RIDFLD    (ACTQ-KEY)
 14550*    END-EXEC.
 14551     MOVE 0
 14552       TO DFHEIV11
 14553*    MOVE '&,         G          &   #00012240' TO DFHEIV0
 14554     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14555     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14556     MOVE X'2020233030303132323430' TO DFHEIV0(25:11)
 14557     CALL 'kxdfhei1' USING DFHEIV0,
 14558           ACTQ-FILE-ID,
 14559           ACTQ-KEY,
 14560           DFHEIV99,
 14561           DFHEIV11,
 14562           DFHEIV99
 14563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14564
 14565
 14566     GO TO 3050-DELETE-ACTQ.
 14567
 14568 3050-EXIT.
 14569     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 271
* EL131.cbl
 14571 3060-READ-TRLR.
 14572
 14573* EXEC CICS HANDLE CONDITION
 14574*         NOTFND    (3060-EXIT)
 14575*         ENDFILE   (3060-EXIT)
 14576*    END-EXEC.
 14577*    MOVE '"$I''                  ! A #00012251' TO DFHEIV0
 14578     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14579     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14580     MOVE X'4120233030303132323531' TO DFHEIV0(25:11)
 14581     CALL 'kxdfhei1' USING DFHEIV0
 14582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14583
 14584
 14585 3060-LOOP.
 14586
 14587* EXEC CICS READNEXT
 14588*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14589*         DATASET  (TRLR-FILE-ID)
 14590*         RIDFLD   (TRLR-KEY)
 14591*    END-EXEC.
 14592     MOVE 0
 14593       TO DFHEIV11
 14594*    MOVE '&.S                   )   #00012257' TO DFHEIV0
 14595     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14596     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14597     MOVE X'2020233030303132323537' TO DFHEIV0(25:11)
 14598     CALL 'kxdfhei1' USING DFHEIV0,
 14599           TRLR-FILE-ID,
 14600           DFHEIV20,
 14601           DFHEIV99,
 14602           TRLR-KEY,
 14603           DFHEIV99,
 14604           DFHEIV11,
 14605           DFHEIV99,
 14606           DFHEIV99
 14607     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14608         DFHEIV20
 14609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14610
 14611
 14612     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14613         GO TO 3060-EXIT.
 14614
 14615     IF FORM-CONTROL-TR
 14616         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14617             NEXT SENTENCE
 14618         ELSE
 14619             MOVE 'X'            TO ERROR-SWITCH
 14620             GO TO 3060-EXIT
 14621     ELSE
 14622         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14623            MOVE 'X'                 TO ERROR-SWITCH
 14624            GO TO 3060-EXIT.
 14625
 14626     GO TO 3060-LOOP.
 14627
 14628 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 272
* EL131.cbl
 14629     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 273
* EL131.cbl
 14631 3997-GET-ERPDEF.
 14632
 14633     move cl-company-cd          to cert-company-code
 14634     move cl-cert-key-data       to cert-key (2:21)
 14635     move cl-cert-no             to cert-cert
 14636
 14637
 14638* EXEC CICS READ
 14639*        DATASET   (CERT-FILE-ID)
 14640*        RIDFLD    (CERT-KEY)
 14641*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14642*        resp      (ws-response)
 14643*    END-EXEC
 14644*    MOVE '&"S        E          (  N#00012288' TO DFHEIV0
 14645     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14647     MOVE X'204E233030303132323838' TO DFHEIV0(25:11)
 14648     CALL 'kxdfhei1' USING DFHEIV0,
 14649           CERT-FILE-ID,
 14650           DFHEIV20,
 14651           DFHEIV99,
 14652           CERT-KEY,
 14653           DFHEIV99,
 14654           DFHEIV99,
 14655           DFHEIV99
 14656     SET ADDRESS OF CERTIFICATE-MASTER TO
 14657         DFHEIV20
 14658     MOVE EIBRESP  TO ws-response
 14659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14660
 14661     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14662                                    WS-ERPDEF-SW
 14663     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14664                                    WS-CRIT-PER-RTW-MOS
 14665
 14666     if cm-clp-state = spaces or low-values or zeros
 14667        move cm-state            to cm-clp-state
 14668     end-if
 14669     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14670     MOVE CM-clp-state           TO ERPDEF-STATE
 14671     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14672     evaluate true
 14673        when (cl-claim-type = 'L' or 'P')
 14674           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14675             and 'CU')
 14676           move 'L'              to erpdef-ben-type
 14677           move cm-lf-benefit-cd to erpdef-ben-code
 14678        when (cl-claim-type not = 'L' and 'P')
 14679           and (cm-ah-benefit-cd not = '00' and '  ')
 14680           move 'A'              to erpdef-ben-type
 14681           move cm-ah-benefit-cd to erpdef-ben-code
 14682        when (cl-claim-type not = 'L' and 'P')
 14683           and (cm-ah-benefit-cd = '00' or '  ')
 14684           move 'L'              to erpdef-ben-type
 14685           move cm-lf-benefit-cd to erpdef-ben-code
 14686        when (cl-claim-type = 'L' or 'P')
 14687           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14688           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 274
* EL131.cbl
 14689           move cm-ah-benefit-cd to erpdef-ben-code
 14690        when other
 14691           move 'A'              to erpdef-ben-type
 14692           move cm-ah-benefit-cd to erpdef-ben-code
 14693     end-evaluate
 14694
 14695*    if (cl-claim-type = 'L' or 'P')
 14696*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14697*          and 'CU')
 14698*       move 'L'                 to erpdef-ben-type
 14699*       move cm-lf-benefit-cd    to erpdef-ben-code
 14700*    else
 14701*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14702*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14703*    end-if
 14704     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14705     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14706
 14707
 14708* EXEC CICS STARTBR
 14709*        DATASET  ('ERPDEF')
 14710*        RIDFLD   (ERPDEF-KEY)
 14711*        GTEQ
 14712*        RESP     (WS-RESPONSE)
 14713*    END-EXEC
 14714     MOVE 'ERPDEF' TO DFHEIV1
 14715     MOVE 0
 14716       TO DFHEIV11
 14717*    MOVE '&,         G          &  N#00012341' TO DFHEIV0
 14718     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14719     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14720     MOVE X'204E233030303132333431' TO DFHEIV0(25:11)
 14721     CALL 'kxdfhei1' USING DFHEIV0,
 14722           DFHEIV1,
 14723           ERPDEF-KEY,
 14724           DFHEIV99,
 14725           DFHEIV11,
 14726           DFHEIV99
 14727     MOVE EIBRESP  TO WS-RESPONSE
 14728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14729
 14730     IF WS-RESP-NORMAL
 14731
 14732* EXEC CICS READNEXT
 14733*          DATASET  ('ERPDEF')
 14734*          INTO     (PRODUCT-MASTER)
 14735*          RIDFLD   (ERPDEF-KEY)
 14736*          RESP     (WS-RESPONSE)
 14737*       END-EXEC
 14738     MOVE LENGTH OF
 14739      PRODUCT-MASTER
 14740       TO DFHEIV12
 14741     MOVE 'ERPDEF' TO DFHEIV1
 14742     MOVE 0
 14743       TO DFHEIV11
 14744*    MOVE '&.IL                  )  N#00012349' TO DFHEIV0
 14745     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14746     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 275
* EL131.cbl
 14747     MOVE X'204E233030303132333439' TO DFHEIV0(25:11)
 14748     CALL 'kxdfhei1' USING DFHEIV0,
 14749           DFHEIV1,
 14750           PRODUCT-MASTER,
 14751           DFHEIV12,
 14752           ERPDEF-KEY,
 14753           DFHEIV99,
 14754           DFHEIV11,
 14755           DFHEIV99,
 14756           DFHEIV99
 14757     MOVE EIBRESP  TO WS-RESPONSE
 14758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14759        IF WS-RESP-NORMAL
 14760           IF (ERPDEF-KEY-SAVE (1:16) =
 14761              PD-CONTROL-PRIMARY (1:16))
 14762              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14763              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14764                 (A1 > +8)
 14765                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14766              END-PERFORM
 14767              IF A1 < +9
 14768                 SET ERPDEF-FOUND TO TRUE
 14769                 MOVE PD-CRIT-PERIOD (A1)
 14770                              TO WS-CRITICAL-PERIOD
 14771                 MOVE PD-REC-CRIT-PERIOD (A1)
 14772                              TO WS-CRIT-PER-RECURRENT
 14773                 IF PD-RTW-MOS (A1) NUMERIC
 14774                    MOVE PD-RTW-MOS (A1)
 14775                              TO WS-CRIT-PER-RTW-MOS
 14776                 ELSE
 14777                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14778                 END-IF
 14779                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14780                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14781                                 TO WS-EXCL-PERIOD
 14782                 END-IF
 14783                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14784                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14785                                 TO WS-COV-ENDS
 14786                 END-IF
 14787                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14788                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14789                                 TO WS-ACC-PERIOD
 14790                 END-IF
 14791                 if pd-max-extension (a1) numeric
 14792                    move pd-max-extension (a1)
 14793                                 to ws-max-extension
 14794                 end-if
 14795                 if pd-max-amt (a1) numeric
 14796                    move pd-max-amt (a1)
 14797                                 to ws-max-moben
 14798                 end-if
 14799              END-IF
 14800           END-IF
 14801        END-IF
 14802     END-IF
 14803
 14804     .
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 276
* EL131.cbl
 14805 3997-EXIT.
 14806     EXIT.
 14807 4000-FORCE-ERRORS.
 14808     IF PI-RETURN-CD-1 = 'X'
 14809         MOVE ER-0311            TO EMI-ERROR
 14810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14811         MOVE -1                 TO MAINTL
 14812         GO TO 8110-SEND-DATA.
 14813
 14814     IF NOT FORCE-CAP
 14815         MOVE ER-0416            TO EMI-ERROR
 14816         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14817         MOVE -1                 TO MAINTL
 14818         GO TO 8110-SEND-DATA.
 14819
 14820     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14821     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14822     IF EMI-FATAL-CTR GREATER THAN ZERO
 14823         GO TO 4000-FATAL-ERRORS.
 14824
 14825     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14826
 14827     IF EMI-FATAL-CTR GREATER THAN ZERO
 14828         GO TO 4000-FATAL-ERRORS.
 14829
 14830     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14831
 14832     IF EMI-FATAL-CTR GREATER THAN ZERO
 14833         GO TO 4000-FATAL-ERRORS.
 14834
 14835     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14836     MOVE AL-UANOF               TO CERTA.
 14837     MOVE ER-0000 TO EMI-ERROR.
 14838     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14839
 14840 4000-FATAL-ERRORS.
 14841     MOVE -1                     TO MAINTL.
 14842     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 277
* EL131.cbl
 14844
 14845 4100-SAVE-CHANGES.
 14846     IF MAINTL > 0
 14847         MOVE MAINTI  TO WS-SAVE-MAINTI
 14848         MOVE MAINTL  TO WS-SAVE-MAINTL
 14849     END-IF
 14850     IF STATUSL > 0
 14851         MOVE STATUSI  TO WS-SAVE-STATUSI
 14852         MOVE STATUSL  TO WS-SAVE-STATUSL
 14853     END-IF
 14854     IF REPL > 0
 14855         MOVE REPI  TO WS-SAVE-REPI
 14856         MOVE REPL  TO WS-SAVE-REPL
 14857     END-IF
 14858*    IF CAUSEL > 0
 14859*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14860*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14861*    END-IF
 14862*    IF ENDL > 0
 14863*        MOVE ENDI  TO WS-SAVE-ENDI
 14864*        MOVE ENDL  TO WS-SAVE-ENDL
 14865*    END-IF
 14866     IF DIAGL > 0
 14867         MOVE DIAGI  TO WS-SAVE-DIAGI
 14868         MOVE DIAGL  TO WS-SAVE-DIAGL
 14869     END-IF
 14870     IF ICD1L > 0
 14871         MOVE ICD1I  TO WS-SAVE-ICD1I
 14872         MOVE ICD1L  TO WS-SAVE-ICD1L
 14873     END-IF
 14874     IF ICD2L > 0
 14875         MOVE ICD2I  TO WS-SAVE-ICD2I
 14876         MOVE ICD2L  TO WS-SAVE-ICD2L
 14877     END-IF
 14878     IF BENEL > 0
 14879         MOVE BENEI  TO WS-SAVE-BENEI
 14880         MOVE BENEL  TO WS-SAVE-BENEL
 14881     END-IF
 14882     IF BIRTHL > 0
 14883         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14884         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14885     END-IF
 14886     IF SOCIALL > 0
 14887         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14888         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14889     END-IF
 14890     IF SEXL > 0
 14891         MOVE SEXI  TO WS-SAVE-SEXI
 14892         MOVE SEXL  TO WS-SAVE-SEXL
 14893     END-IF
 14894     IF MLNAMEL > 0
 14895         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14896         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14897     END-IF
 14898     IF MFNAMEL > 0
 14899         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14900         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14901     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 278
* EL131.cbl
 14902     IF MMINITL > 0
 14903         MOVE MMINITI  TO WS-SAVE-MMINITI
 14904         MOVE MMINITL  TO WS-SAVE-MMINITL
 14905     END-IF
 14906*    IF LOANNOL > 0
 14907*        MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14908*        MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14909*    END-IF
 14910     IF LOANBALL > 0
 14911         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14912         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14913     END-IF
 14914     IF PROCL > 0
 14915         MOVE PROCI  TO WS-SAVE-PROCI
 14916         MOVE PROCL  TO WS-SAVE-PROCL
 14917     END-IF
 14918     IF SUPVL > 0
 14919         MOVE SUPVI  TO WS-SAVE-SUPVI
 14920         MOVE SUPVL  TO WS-SAVE-SUPVL
 14921     END-IF
 14922     IF PRICDL > 0
 14923         MOVE PRICDI  TO WS-SAVE-PRICDI
 14924         MOVE PRICDL  TO WS-SAVE-PRICDL
 14925     END-IF
 14926     IF FILETOL > 0
 14927         MOVE FILETOI  TO WS-SAVE-FILETOI
 14928         MOVE FILETOL  TO WS-SAVE-FILETOL
 14929     END-IF
 14930     IF PDTHRUL > 0
 14931         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14932         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14933     END-IF
 14934     IF PDAMTL > 0
 14935         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14936         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14937     END-IF
 14938     IF NODAYSL > 0
 14939         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14940         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14941     END-IF
 14942     IF NOPMTSL > 0
 14943         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14944         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14945     END-IF
 14946     IF FORMTYPL > 0
 14947         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14948         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14949     END-IF
 14950     IF OCCL > 0
 14951         MOVE OCCI  TO WS-SAVE-OCCI
 14952         MOVE OCCL  TO WS-SAVE-OCCL
 14953     END-IF.
 14954 4100-EXIT.
 14955      EXIT.
 14956
 14957 4200-LOAD-CHANGES.
 14958     IF WS-SAVE-MAINTL > 0
 14959         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 279
* EL131.cbl
 14960         MOVE WS-SAVE-MAINTL  TO MAINTL
 14961         MOVE AL-UANON        TO MAINTA
 14962     END-IF
 14963     IF WS-SAVE-STATUSL > 0
 14964         MOVE WS-SAVE-STATUSI  TO STATUSI
 14965         MOVE WS-SAVE-STATUSL  TO STATUSL
 14966         MOVE AL-UANON         TO STATUSA
 14967     END-IF
 14968     IF WS-SAVE-REPL > 0
 14969         MOVE WS-SAVE-REPI  TO REPI
 14970         MOVE WS-SAVE-REPL  TO REPL
 14971         MOVE AL-UANON      TO REPA
 14972     END-IF
 14973*    IF WS-SAVE-CAUSEL > 0
 14974*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14975*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14976*        MOVE AL-UANON        TO CAUSEA
 14977*    END-IF
 14978*    IF WS-SAVE-ENDL > 0
 14979*        MOVE WS-SAVE-ENDI  TO ENDI
 14980*        MOVE WS-SAVE-ENDL  TO ENDL
 14981*        MOVE AL-UANON      TO ENDA
 14982*    END-IF
 14983     IF WS-SAVE-DIAGL > 0
 14984         MOVE WS-SAVE-DIAGI  TO DIAGI
 14985         MOVE WS-SAVE-DIAGL  TO DIAGL
 14986         MOVE AL-UANON       TO DIAGA
 14987     END-IF
 14988     IF WS-SAVE-ICD1L > 0
 14989         MOVE WS-SAVE-ICD1I  TO ICD1I
 14990         MOVE WS-SAVE-ICD1L  TO ICD1L
 14991         MOVE AL-UANON       TO ICD1A
 14992     END-IF
 14993     IF WS-SAVE-ICD2L > 0
 14994         MOVE WS-SAVE-ICD2I  TO ICD2I
 14995         MOVE WS-SAVE-ICD2L  TO ICD2L
 14996         MOVE AL-UANON       TO ICD2A
 14997     END-IF
 14998     IF WS-SAVE-BENEL > 0
 14999         MOVE WS-SAVE-BENEI  TO BENEI
 15000         MOVE WS-SAVE-BENEL  TO BENEL
 15001         MOVE AL-UANON       TO BENEA
 15002     END-IF
 15003     IF WS-SAVE-BIRTHL > 0
 15004         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 15005         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 15006         MOVE AL-UANON        TO BIRTHA
 15007     END-IF
 15008     IF WS-SAVE-SOCIALL > 0
 15009         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 15010         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 15011         MOVE AL-UANON         TO SOCIALA
 15012     END-IF
 15013     IF WS-SAVE-SEXL > 0
 15014         MOVE WS-SAVE-SEXI  TO SEXI
 15015         MOVE WS-SAVE-SEXL  TO SEXL
 15016         MOVE AL-UANON      TO SEXA
 15017     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 280
* EL131.cbl
 15018     IF WS-SAVE-MLNAMEL > 0
 15019         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 15020         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 15021         MOVE AL-UANON         TO MLNAMEA
 15022     END-IF
 15023     IF WS-SAVE-MFNAMEL > 0
 15024         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 15025         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 15026         MOVE AL-UANON         TO MFNAMEA
 15027     END-IF
 15028     IF WS-SAVE-MMINITL > 0
 15029         MOVE WS-SAVE-MMINITI  TO MMINITI
 15030         MOVE WS-SAVE-MMINITL  TO MMINITL
 15031         MOVE AL-UANON         TO MMINITA
 15032     END-IF
 15033*    IF WS-SAVE-LOANNOL > 0
 15034*        MOVE WS-SAVE-LOANNOI  TO LOANNOI
 15035*        MOVE WS-SAVE-LOANNOL  TO LOANNOL
 15036*        MOVE AL-UANON         TO LOANNOA
 15037*    END-IF
 15038     IF WS-SAVE-LOANBALL > 0
 15039         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 15040         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 15041         MOVE AL-UANON          TO LOANBALA
 15042     END-IF
 15043     IF WS-SAVE-PROCL > 0
 15044         MOVE WS-SAVE-PROCI  TO PROCI
 15045         MOVE WS-SAVE-PROCL  TO PROCL
 15046         MOVE AL-UANON       TO PROCA
 15047     END-IF
 15048     IF WS-SAVE-SUPVL > 0
 15049         MOVE WS-SAVE-SUPVI  TO SUPVI
 15050         MOVE WS-SAVE-SUPVL  TO SUPVL
 15051         MOVE AL-UANON       TO SUPVA
 15052     END-IF
 15053     IF WS-SAVE-PRICDL > 0
 15054         MOVE WS-SAVE-PRICDI  TO PRICDI
 15055         MOVE WS-SAVE-PRICDL  TO PRICDL
 15056         MOVE AL-UANON        TO PRICDA
 15057     END-IF
 15058     IF WS-SAVE-FILETOL > 0
 15059         MOVE WS-SAVE-FILETOI  TO FILETOI
 15060         MOVE WS-SAVE-FILETOL  TO FILETOL
 15061         MOVE AL-UANON         TO FILETOA
 15062     END-IF
 15063     IF WS-SAVE-PDTHRUL > 0
 15064         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 15065         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 15066         MOVE AL-UANON         TO PDTHRUA
 15067     END-IF
 15068     IF WS-SAVE-PDAMTL > 0
 15069         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 15070         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 15071         MOVE AL-UANON        TO PDAMTA
 15072     END-IF
 15073     IF WS-SAVE-NODAYSL > 0
 15074         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 15075         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 281
* EL131.cbl
 15076         MOVE AL-UANON         TO NODAYSA
 15077     END-IF
 15078     IF WS-SAVE-NOPMTSL > 0
 15079         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 15080         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 15081         MOVE AL-UANON         TO NOPMTSA
 15082     END-IF
 15083     IF WS-SAVE-FORMTYPL > 0
 15084         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 15085         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 15086         MOVE AL-UANON          TO FORMTYPA
 15087     END-IF
 15088     IF WS-SAVE-OCCL > 0
 15089         MOVE WS-SAVE-OCCI  TO OCCI
 15090         MOVE WS-SAVE-OCCL  TO OCCL
 15091         MOVE AL-UANON      TO OCCA
 15092     END-IF.
 15093 4200-EXIT.
 15094      EXIT.
 15095
 15096 5000-BUILD-MAP.
 15097     IF PI-RETURN-CD-1 = SPACE
 15098         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 15099
 15100     MOVE SPACE                  TO PI-RETURN-CD-1.
 15101
 15102     MOVE LOW-VALUES             TO EL131AI.
 15103
 15104     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 15105     MOVE PI-CARRIER             TO CARRIER-CODE.
 15106     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 15107     MOVE PI-CERT-NO             TO CERT-NO.
 15108
 15109 5000-READ-CLAIM-MASTER.
 15110
 15111
 15112* EXEC CICS READ
 15113*         SET      (ADDRESS OF CLAIM-MASTER)
 15114*         DATASET  (CLMS-FILE-ID)
 15115*         RIDFLD   (MSTR-KEY)
 15116*    END-EXEC.
 15117*    MOVE '&"S        E          (   #00012707' TO DFHEIV0
 15118     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15119     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15120     MOVE X'2020233030303132373037' TO DFHEIV0(25:11)
 15121     CALL 'kxdfhei1' USING DFHEIV0,
 15122           CLMS-FILE-ID,
 15123           DFHEIV20,
 15124           DFHEIV99,
 15125           MSTR-KEY,
 15126           DFHEIV99,
 15127           DFHEIV99,
 15128           DFHEIV99
 15129     SET ADDRESS OF CLAIM-MASTER TO
 15130         DFHEIV20
 15131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15132
 15133
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 282
* EL131.cbl
 15134     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 15135
 15136 5000-READ-DIAGNOSIS-TRAILER.
 15137
 15138
 15139* EXEC CICS HANDLE CONDITION
 15140*         NOTFND (5000-TRLR-NOT-FOUND)
 15141*    END-EXEC.
 15142*    MOVE '"$I                   ! B #00012717' TO DFHEIV0
 15143     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15145     MOVE X'4220233030303132373137' TO DFHEIV0(25:11)
 15146     CALL 'kxdfhei1' USING DFHEIV0
 15147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15148
 15149
 15150     MOVE MSTR-KEY               TO TRLR-KEY.
 15151     MOVE NINETY                 TO TRLR-SEQ-NO.
 15152
 15153
 15154* EXEC CICS READ
 15155*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15156*         DATASET  (TRLR-FILE-ID)
 15157*         RIDFLD   (TRLR-KEY)
 15158*    END-EXEC.
 15159*    MOVE '&"S        E          (   #00012724' TO DFHEIV0
 15160     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15162     MOVE X'2020233030303132373234' TO DFHEIV0(25:11)
 15163     CALL 'kxdfhei1' USING DFHEIV0,
 15164           TRLR-FILE-ID,
 15165           DFHEIV20,
 15166           DFHEIV99,
 15167           TRLR-KEY,
 15168           DFHEIV99,
 15169           DFHEIV99,
 15170           DFHEIV99
 15171     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15172         DFHEIV20
 15173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15174
 15175
 15176     MOVE AT-INFO-LINE-1         TO DIAGO.
 15177     MOVE AT-ICD-CODE-1          TO ICD1O.
 15178     MOVE AT-ICD-CODE-2          TO ICD2O.
 15179
 15180 5000-READ-CERTIFICATE-MASTER.
 15181
 15182     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 15183     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 15184     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 15185     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 15186     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 15187     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 15188     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 15189
 15190
 15191* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 283
* EL131.cbl
 15192*         NOTFND (5000-CERT-NOT-FOUND)
 15193*    END-EXEC.
 15194*    MOVE '"$I                   ! C #00012744' TO DFHEIV0
 15195     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15197     MOVE X'4320233030303132373434' TO DFHEIV0(25:11)
 15198     CALL 'kxdfhei1' USING DFHEIV0
 15199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15200
 15201
 15202
 15203* EXEC CICS READ
 15204*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 15205*         DATASET  (CERT-FILE-ID)
 15206*         RIDFLD   (CERT-KEY)
 15207*    END-EXEC.
 15208*    MOVE '&"S        E          (   #00012748' TO DFHEIV0
 15209     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15210     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15211     MOVE X'2020233030303132373438' TO DFHEIV0(25:11)
 15212     CALL 'kxdfhei1' USING DFHEIV0,
 15213           CERT-FILE-ID,
 15214           DFHEIV20,
 15215           DFHEIV99,
 15216           CERT-KEY,
 15217           DFHEIV99,
 15218           DFHEIV99,
 15219           DFHEIV99
 15220     SET ADDRESS OF CERTIFICATE-MASTER TO
 15221         DFHEIV20
 15222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15223
 15224
 15225     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 15226     PERFORM 5100-LOAD-CORR-TRLR THRU 5100-EXIT.
 15227     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 15228
 15229     GO TO 5000-EXIT.
 15230
 15231 5000-TRLR-NOT-FOUND.
 15232     MOVE ER-7687                TO EMI-ERROR.
 15233     MOVE -1                     TO DIAGL.
 15234     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15235     GO TO 5000-EXIT.
 15236
 15237 5000-CERT-NOT-FOUND.
 15238     MOVE ER-0206                TO EMI-ERROR.
 15239     MOVE -1                     TO CERTL.
 15240     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15241
 15242 5000-EXIT.
 15243     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 284
* EL131.cbl
 15245 5010-RESET-PI-AREA.
 15246     IF CERTI GREATER THAN LOW-VALUES
 15247         MOVE CERTI              TO PI-CERT-PRIME.
 15248
 15249     IF SUFXI GREATER THAN LOW-VALUES
 15250         MOVE SUFXI              TO PI-CERT-SFX.
 15251
 15252     IF CERTEFFI GREATER THAN LOW-VALUES
 15253         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 15254
 15255     IF CERTACTI GREATER THAN LOW-VALUES
 15256         MOVE CERTACTI           TO PI-ACCOUNT.
 15257
 15258     IF CERTSTI GREATER THAN LOW-VALUES
 15259         MOVE CERTSTI            TO PI-STATE.
 15260
 15261     IF CERTCARI GREATER THAN LOW-VALUES
 15262         MOVE CERTCARI           TO PI-CARRIER.
 15263
 15264     IF CERTGRPI GREATER THAN LOW-VALUES
 15265         MOVE CERTGRPI           TO PI-GROUPING.
 15266
 15267 5010-EXIT.
 15268     EXIT.
 15269
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 285
* EL131.cbl
 15271 5020-MOVE-MSTR.
 15272
 15273     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 15274     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 15275     MOVE WS-CLAIM-SEQU          TO SEQUO.
 15276     MOVE AL-SABON               TO SEQUA.
 15277     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 15278     MOVE CL-CLAIM-TYPE          TO TYPEO
 15279                                    pi-claim-type
 15280
 15281     IF CL-TOTAL-PAID-AMT  = +0 AND
 15282        CL-LAST-PMT-AMT    = +0 AND
 15283        CL-NO-OF-PMTS-MADE = +0
 15284          MOVE AL-UANON          TO TYPEA.
 15285
 15286     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 15287     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 15288     MOVE CL-CERT-PRIME          TO CERTO.
 15289     MOVE CL-CERT-SFX            TO SUFXO.
 15290     MOVE CL-CERT-CARRIER        TO CARRO.
 15291
 15292     IF CL-CLAIM-STATUS = 'C'
 15293         MOVE 'CLOSED'           TO STATUSO
 15294     ELSE
 15295         MOVE 'OPEN  '           TO STATUSO.
 15296
 15297     move cl-accident-claim-sw   to accswo
 15298     if cl-benefit-period not numeric
 15299        move zeros               to cl-benefit-period
 15300     end-if
 15301     move cl-benefit-period      to benpero
 15302     move cl-insured-type        to instypeo
 15303     MOVE CL-PROCESSOR-ID        TO PROCO.
 15304
 15305     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 15306     MOVE CL-CCN                 TO CCNOO.
 15307
 15308     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 15309     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 15310     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 15311     MOVE CL-INSURED-SEX-CD      TO SEXO.
 15312
 15313     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 15314         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 15315         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15316         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15317         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 15318     ELSE
 15319         MOVE SPACES             TO BIRTHO.
 15320
 15321     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 15322        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 15323         NEXT SENTENCE
 15324       ELSE
 15325         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 15326
 15327     IF PI-COMPANY-ID = 'DMD'
 15328       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 286
* EL131.cbl
 15329          IF SOCIALO = SPACES OR LOW-VALUES
 15330            MOVE ER-0885         TO EMI-ERROR
 15331            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15332
 15333     MOVE CL-INSURED-OCC-CD      TO OCCO.
 15334*    MOVE CL-CAUSE-CD            TO CAUSEO.
 15335
 15336*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 15337*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 15338*        MOVE SPACES                 TO DC-OPTION-CODE
 15339*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15340*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 15341*    ELSE
 15342*        MOVE SPACES             TO ENDO.
 15343
 15344     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 15345        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15346        MOVE SPACES             TO DC-OPTION-CODE
 15347        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15348        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15349        IF PI-USES-PAID-TO
 15350           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15351           MOVE '6'                TO DC-OPTION-CODE
 15352           MOVE +1                 TO DC-ELAPSED-DAYS
 15353           MOVE +0                 TO DC-ELAPSED-MONTHS
 15354           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15355           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15356        ELSE
 15357           NEXT SENTENCE
 15358     ELSE
 15359        MOVE SPACES             TO PDTHRUO.
 15360
 15361     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 15362     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 15363     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 15364     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 15365
 15366     IF MODIFY-CAP
 15367        MOVE AL-UNNOF            TO PDAMTA
 15368                                    NODAYSA
 15369                                    NOPMTSA
 15370        MOVE AL-UANOF            TO PDTHRUA.
 15371     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 15372     MOVE '2'                    TO CNTL-REC-TYPE
 15373     MOVE +0                     TO CNTL-SEQ-NO
 15374     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 15375
 15376
 15377* EXEC CICS READ
 15378*         DATASET  (CNTL-FILE-ID)
 15379*         SET      (ADDRESS OF CONTROL-FILE)
 15380*         RIDFLD   (CNTL-KEY)
 15381*         RESP     (WS-RESPONSE)
 15382*    END-EXEC
 15383*    MOVE '&"S        E          (  N#00012905' TO DFHEIV0
 15384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15386     MOVE X'204E233030303132393035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 287
* EL131.cbl
 15387     CALL 'kxdfhei1' USING DFHEIV0,
 15388           CNTL-FILE-ID,
 15389           DFHEIV20,
 15390           DFHEIV99,
 15391           CNTL-KEY,
 15392           DFHEIV99,
 15393           DFHEIV99,
 15394           DFHEIV99
 15395     SET ADDRESS OF CONTROL-FILE TO
 15396         DFHEIV20
 15397     MOVE EIBRESP  TO WS-RESPONSE
 15398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15399
 15400     IF WS-RESP-NORMAL
 15401        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 15402     end-if
 15403     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 15404         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15405         MOVE SPACES             TO DC-OPTION-CODE
 15406         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15407         MOVE DC-GREG-DATE-1-EDIT TO INCO
 15408     ELSE
 15409         MOVE SPACES             TO INCO.
 15410
 15411     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 15412        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 15413        MOVE AL-UANOF            TO INCA
 15414     end-if
 15415     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 15416
 15417     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 15418         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 15419         MOVE SPACES             TO DC-OPTION-CODE
 15420         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15421         MOVE DC-GREG-DATE-1-EDIT TO REPO
 15422     ELSE
 15423         MOVE SPACES             TO REPO.
 15424
 15425     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 15426         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 15427         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15428         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15429         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 15430     ELSE
 15431         MOVE SPACES             TO ESTO.
 15432
 15433     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 15434         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 15435         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15436         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15437         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 15438     ELSE
 15439         MOVE SPACES             TO MNTDTO.
 15440
 15441
 15442     IF CL-LAST-MAINT-TYPE = SPACE
 15443         MOVE 'SET-UP'           TO MNTTYPEO
 15444     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 288
* EL131.cbl
 15445     IF CL-LAST-MAINT-TYPE = '1'
 15446         MOVE 'PAYMNT'           TO MNTTYPEO
 15447     ELSE
 15448     IF CL-LAST-MAINT-TYPE = '2'
 15449         MOVE 'LETTER'           TO MNTTYPEO
 15450     ELSE
 15451     IF CL-LAST-MAINT-TYPE = '3'
 15452         MOVE 'UPDATE'           TO MNTTYPEO
 15453     ELSE
 15454     IF CL-LAST-MAINT-TYPE = '4'
 15455         MOVE 'RESTOR'           TO MNTTYPEO
 15456     ELSE
 15457     IF CL-LAST-MAINT-TYPE = '5'
 15458         MOVE 'INC DT'           TO MNTTYPEO
 15459     ELSE
 15460     IF CL-LAST-MAINT-TYPE = '6'
 15461         MOVE ' CONV'            TO MNTTYPEO
 15462     ELSE
 15463     IF CL-LAST-MAINT-TYPE = 'C'
 15464         MOVE 'CHGBEN'           TO MNTTYPEO
 15465     ELSE
 15466     IF CL-LAST-MAINT-TYPE = 'E'
 15467         MOVE 'ERRCOR'           TO MNTTYPEO
 15468     ELSE
 15469         MOVE SPACES             TO MNTTYPEO.
 15470
 15471     MOVE CL-BENEFICIARY         TO BENEO.
 15472     MOVE CL-FILE-LOCATION       TO FILETOO.
 15473     IF CL-CRITICAL-PERIOD NOT NUMERIC
 15474        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 15475     END-IF
 15476     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 15477     IF CL-NO-OF-EXTENSIONS NOT NUMERIC
 15478        MOVE ZEROS               TO CL-NO-OF-EXTENSIONS
 15479     END-IF
 15480     MOVE CL-NO-OF-EXTENSIONS    TO EXTENSO
 15481*    MOVE CL-CRIT-PER-RECURRENT
 15482*                                TO CRITPTO
 15483*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 15484*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 15485*    END-IF
 15486*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 15487     MOVE CL-PRIORITY-CD         TO PRICDO.
 15488     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 15489     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15490     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15491     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 15492
 15493 5020-EXIT.
 15494     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 289
* EL131.cbl
 15496 5030-MOVE-CERT.
 15497
 15498     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 15499         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 15500         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15501         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15502         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 15503       ELSE
 15504         MOVE SPACES             TO CERTEFFO
 15505         MOVE ZERO               TO HOLD-DATE.
 15506
 15507     MOVE CM-ACCOUNT             TO CERTACTO.
 15508     MOVE CM-STATE               TO CERTSTO PI-STATE.
 15509     MOVE CM-GROUPING            TO CERTGRPO.
 15510     MOVE CM-CARRIER             TO CERTCARO.
 15511     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 15512     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 15513     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 15514     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 15515     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 15516     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 15517     MOVE CM-JT-INITIAL          TO JNTINITO.
 15518     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 15519
 15520*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 15521     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 15522     MOVE '3'                    TO CNTL-REC-TYPE.
 15523     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 15524     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 15525     MOVE ZERO                   TO CNTL-SEQ-NO.
 15526
 15527
 15528* EXEC CICS READ
 15529*         SET        (ADDRESS OF CONTROL-FILE)
 15530*         DATASET    ('ELCNTL')
 15531*         RIDFLD     (CNTL-KEY)
 15532*         RESP       (WS-RESPONSE)
 15533*    END-EXEC.
 15534     MOVE 'ELCNTL' TO DFHEIV1
 15535*    MOVE '&"S        E          (  N#00013039' TO DFHEIV0
 15536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15538     MOVE X'204E233030303133303339' TO DFHEIV0(25:11)
 15539     CALL 'kxdfhei1' USING DFHEIV0,
 15540           DFHEIV1,
 15541           DFHEIV20,
 15542           DFHEIV99,
 15543           CNTL-KEY,
 15544           DFHEIV99,
 15545           DFHEIV99,
 15546           DFHEIV99
 15547     SET ADDRESS OF CONTROL-FILE TO
 15548         DFHEIV20
 15549     MOVE EIBRESP  TO WS-RESPONSE
 15550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15551
 15552
 15553     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 290
* EL131.cbl
 15554        MOVE ZERO                TO CP-FREE-LOOK
 15555     ELSE
 15556        MOVE CF-ST-FREE-LOOK-PERIOD
 15557                                 TO CP-FREE-LOOK.
 15558
 15559     IF CM-LF-BENEFIT-CD = '00'
 15560        GO TO 5030-MOVE-CERT-AH.
 15561
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 291
* EL131.cbl
 15563     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 15564     MOVE '5'                    TO DC-OPTION-CODE
 15565     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15566     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 15567     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15568     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 15569     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15570     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15571     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15572     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15573     MOVE '4'                    TO CP-REM-TERM-METHOD
 15574     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15575     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15576     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15577
 15578     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15579     IF CM-LF-PREMIUM-RATE NUMERIC
 15580         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15581     ELSE
 15582         MOVE ZEROS              TO LCVRATEO.
 15583
 15584     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15585         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15586
 15587     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15588
 15589     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15590
 15591     IF CM-LF-CURRENT-STATUS = '8'
 15592        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15593            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15594            MOVE ' '             TO DC-OPTION-CODE
 15595            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15596            IF NOT DATE-CONVERSION-ERROR
 15597                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15598
 15599     IF CM-LF-CURRENT-STATUS = '7'
 15600        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15601            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15602            MOVE ' '             TO DC-OPTION-CODE
 15603            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15604            IF NOT DATE-CONVERSION-ERROR
 15605                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15606
 15607     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15608         MOVE ' '                TO DC-OPTION-CODE
 15609         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15610         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15611         IF NOT DATE-CONVERSION-ERROR
 15612             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15613             MOVE HOLD-MONTH     TO WORK-MONTH
 15614             MOVE HOLD-YEAR      TO WORK-YEAR
 15615             MOVE WORK-DATE-MY   TO LCVEXITO.
 15616
 15617     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15618        IF CP-REMAINING-TERM-3 = ZEROS
 15619           MOVE 'EXPIRED'        TO LCVSTATO
 15620        ELSE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 292
* EL131.cbl
 15621           MOVE 'ACTIVE'         TO LCVSTATO.
 15622
 15623     IF CM-LF-CURRENT-STATUS = '2'
 15624        MOVE 'PEND   '           TO LCVSTATO.
 15625     IF CM-LF-CURRENT-STATUS = '3'
 15626        MOVE 'RESTORE'           TO LCVSTATO.
 15627     IF CM-LF-CURRENT-STATUS = '5'
 15628        MOVE 'REISSUE'           TO LCVSTATO.
 15629     IF CM-LF-CURRENT-STATUS = '6'
 15630        MOVE 'LMP DIS'           TO LCVSTATO.
 15631     IF CM-LF-CURRENT-STATUS = '7'
 15632        MOVE 'DEATH  '           TO LCVSTATO.
 15633     IF CM-LF-CURRENT-STATUS = '8'
 15634        MOVE 'CANCEL '           TO LCVSTATO.
 15635     IF CM-LF-CURRENT-STATUS = '9'
 15636        MOVE 'RE-ONLY'           TO LCVSTATO.
 15637     IF CM-LF-CURRENT-STATUS = 'V'
 15638        MOVE 'VOID   '           TO LCVSTATO.
 15639     IF CM-LF-CURRENT-STATUS = 'D'
 15640        MOVE 'DECLINE'           TO LCVSTATO.
 15641
 15642     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15643     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15644     MOVE '4'                    TO BEN-REC-TYPE.
 15645     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15646     MOVE ZERO                   TO BEN-SEQ-NO.
 15647
 15648
 15649* EXEC CICS READ GTEQ
 15650*         DATASET  (CNTL-FILE-ID)
 15651*         RIDFLD   (BENEFIT-KEY)
 15652*         SET      (ADDRESS OF CONTROL-FILE)
 15653*    END-EXEC.
 15654*    MOVE '&"S        G          (   #00013141' TO DFHEIV0
 15655     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15657     MOVE X'2020233030303133313431' TO DFHEIV0(25:11)
 15658     CALL 'kxdfhei1' USING DFHEIV0,
 15659           CNTL-FILE-ID,
 15660           DFHEIV20,
 15661           DFHEIV99,
 15662           BENEFIT-KEY,
 15663           DFHEIV99,
 15664           DFHEIV99,
 15665           DFHEIV99
 15666     SET ADDRESS OF CONTROL-FILE TO
 15667         DFHEIV20
 15668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15669
 15670
 15671     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15672        CF-RECORD-TYPE NOT = '4'
 15673         MOVE ER-0240            TO EMI-ERROR
 15674         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15675         GO TO 5030-MOVE-CERT-FINISH.
 15676
 15677     MOVE ZERO                   TO COUNT-2.
 15678     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 293
* EL131.cbl
 15679
 15680     IF SCREEN-ERROR
 15681         MOVE ER-0282            TO EMI-ERROR
 15682         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15683        ELSE
 15684         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15685
 15686 5030-MOVE-CERT-AH.
 15687
 15688     IF CM-LF-BENEFIT-CD = '00'
 15689         IF CM-AH-BENEFIT-CD = '00'
 15690             GO TO 5030-MOVE-CERT-FINISH.
 15691
 15692     IF CM-AH-BENEFIT-CD = '00'
 15693        MOVE SPACES             TO ACVKINDO
 15694        COMPUTE PI-PAYMENT-AMT =
 15695                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15696        GO TO 5030-MOVE-CERT-FINISH.
 15697
 15698     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15699     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15700     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15701     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15702     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15703     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15704     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15705     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15706
 15707**DMD **********************************************
 15708     IF PI-COMPANY-ID = 'DMD'
 15709         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15710                                   CM-PMT-EXTENSION-DAYS
 15711         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15712                                      CL-NO-OF-DAYS-PAID
 15713         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15714             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15715         MOVE WS-REM-MOS         TO ACVRTRMO
 15716                                    CP-REMAINING-TERM-3
 15717*        MOVE WS-REM-DAYS        TO DAYSPO
 15718         GO TO 5030-SKIP-RTRM.
 15719**DMD **********************************************
 15720
 15721     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15722     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15723     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15724     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15725
 15726 5030-SKIP-RTRM.
 15727     IF CM-AH-PREMIUM-RATE NUMERIC
 15728         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15729     ELSE
 15730         MOVE ZEROS              TO ACVRATEO.
 15731
 15732     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15733     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15734
 15735     IF CM-AH-CURRENT-STATUS = '8'
 15736        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 294
* EL131.cbl
 15737            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15738            MOVE ' '             TO DC-OPTION-CODE
 15739            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15740            IF NOT DATE-CONVERSION-ERROR
 15741                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15742
 15743     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15744        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15745            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15746            MOVE ' '             TO DC-OPTION-CODE
 15747            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15748            IF NOT DATE-CONVERSION-ERROR
 15749                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15750
 15751     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15752        IF CP-REMAINING-TERM-3 = ZEROS
 15753           MOVE 'EXPIRED'        TO ACVSTATO
 15754        ELSE
 15755           MOVE 'ACTIVE'         TO ACVSTATO.
 15756
 15757     IF CM-AH-CURRENT-STATUS = '2'
 15758        MOVE 'PEND   '           TO ACVSTATO.
 15759     IF CM-AH-CURRENT-STATUS = '3'
 15760        MOVE 'RESTORE'           TO ACVSTATO.
 15761     IF CM-AH-CURRENT-STATUS = '5'
 15762        MOVE 'REISSUE'           TO ACVSTATO.
 15763     IF CM-AH-CURRENT-STATUS = '6'
 15764        MOVE 'LMP DIS'           TO ACVSTATO.
 15765     IF CM-AH-CURRENT-STATUS = '7'
 15766        MOVE 'DEATH  '           TO ACVSTATO.
 15767     IF CM-AH-CURRENT-STATUS = '8'
 15768        MOVE 'CANCEL '           TO ACVSTATO.
 15769     IF CM-AH-CURRENT-STATUS = '9'
 15770        MOVE 'RE-ONLY'           TO ACVSTATO.
 15771     IF CM-AH-CURRENT-STATUS = 'V'
 15772        MOVE 'VOID   '           TO ACVSTATO.
 15773     IF CM-AH-CURRENT-STATUS = '9'
 15774        MOVE 'DECLINE'           TO ACVSTATO.
 15775
 15776     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15777         MOVE ' '                TO DC-OPTION-CODE
 15778         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15779         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15780         IF NOT DATE-CONVERSION-ERROR
 15781             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15782             MOVE HOLD-MONTH     TO WORK-MONTH
 15783             MOVE HOLD-YEAR      TO WORK-YEAR
 15784             MOVE WORK-DATE-MY   TO ACVEXITO.
 15785
 15786     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15787
 15788     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15789     MOVE '5'                    TO BEN-REC-TYPE.
 15790     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15791     MOVE ZERO                   TO BEN-SEQ-NO.
 15792
 15793
 15794* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 295
* EL131.cbl
 15795*         DATASET  (CNTL-FILE-ID)
 15796*         RIDFLD   (BENEFIT-KEY)
 15797*         SET      (ADDRESS OF CONTROL-FILE)
 15798*    END-EXEC.
 15799*    MOVE '&"S        G          (   #00013269' TO DFHEIV0
 15800     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15802     MOVE X'2020233030303133323639' TO DFHEIV0(25:11)
 15803     CALL 'kxdfhei1' USING DFHEIV0,
 15804           CNTL-FILE-ID,
 15805           DFHEIV20,
 15806           DFHEIV99,
 15807           BENEFIT-KEY,
 15808           DFHEIV99,
 15809           DFHEIV99,
 15810           DFHEIV99
 15811     SET ADDRESS OF CONTROL-FILE TO
 15812         DFHEIV20
 15813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15814
 15815
 15816     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15817        CF-RECORD-TYPE NOT = '5'
 15818         MOVE ER-0250            TO EMI-ERROR
 15819         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15820         GO TO 5030-MOVE-CERT-FINISH.
 15821
 15822     MOVE ZERO                   TO COUNT-2.
 15823     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15824
 15825     IF SCREEN-ERROR
 15826         MOVE ER-0283            TO EMI-ERROR
 15827         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15828       ELSE
 15829         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15830
 15831 5030-MOVE-CERT-FINISH.
 15832
 15833     MOVE CM-LOAN-APR            TO APRO.
 15834     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15835     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15836     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15837*    MOVE CM-LOAN-NUMBER         TO LOANNOO
 15838     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15839     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15840
 15841     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15842         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15843         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15844         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15845         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15846     ELSE
 15847         MOVE SPACES               TO ADDONDTO.
 15848
 15849     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15850
 15851 5030-EXIT.
 15852     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 296
* EL131.cbl
 15854 5040-FIND-BENEFIT.
 15855     ADD 1                       TO COUNT-2.
 15856     IF COUNT-2 GREATER THAN 8
 15857         GO TO 5050-BENEFIT-NOTFND.
 15858
 15859     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15860         GO TO 5060-EXIT.
 15861
 15862     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15863         GO TO 5050-BENEFIT-NOTFND.
 15864
 15865     GO TO 5040-FIND-BENEFIT.
 15866
 15867 5050-BENEFIT-NOTFND.
 15868     MOVE 'X'                    TO ERROR-SWITCH.
 15869
 15870 5060-EXIT.
 15871     EXIT.
 15872 5100-LOAD-CORR-TRLR.
 15873     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 15874     MOVE PI-CARRIER         TO TRLR-CARRIER.
 15875     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 15876     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 15877     MOVE 1000               TO TRLR-SEQ-NO.
 15878
 15879
 15880* EXEC CICS HANDLE CONDITION
 15881*         NOTFND    (1052-DONE)
 15882*         ENDFILE   (1052-DONE)
 15883*    END-EXEC.
 15884*    MOVE '"$I''                  ! D #00013338' TO DFHEIV0
 15885     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15887     MOVE X'4420233030303133333338' TO DFHEIV0(25:11)
 15888     CALL 'kxdfhei1' USING DFHEIV0
 15889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15890
 15891
 15892
 15893* EXEC CICS STARTBR
 15894*        DATASET (TRLR-FILE-ID)
 15895*        RIDFLD  (TRLR-KEY)
 15896*    END-EXEC
 15897     MOVE 0
 15898       TO DFHEIV11
 15899*    MOVE '&,         G          &   #00013343' TO DFHEIV0
 15900     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15901     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15902     MOVE X'2020233030303133333433' TO DFHEIV0(25:11)
 15903     CALL 'kxdfhei1' USING DFHEIV0,
 15904           TRLR-FILE-ID,
 15905           TRLR-KEY,
 15906           DFHEIV99,
 15907           DFHEIV11,
 15908           DFHEIV99
 15909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15910
 15911
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 297
* EL131.cbl
 15912     MOVE SPACES TO WS-TRLR-FILE-EOF
 15913                    WS-AUTH-RCVD
 15914     PERFORM 1052-READ-TRLR THRU 1052-EXIT
 15915       UNTIL  TRLR-FILE-EOF
 15916         OR WS-AUTH-RCVD > SPACES.
 15917
 15918
 15919* EXEC CICS ENDBR
 15920*        DATASET (TRLR-FILE-ID)
 15921*    END-EXEC.
 15922     MOVE 0
 15923       TO DFHEIV11
 15924*    MOVE '&2                    $   #00013355' TO DFHEIV0
 15925     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15926     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15927     MOVE X'2020233030303133333535' TO DFHEIV0(25:11)
 15928     CALL 'kxdfhei1' USING DFHEIV0,
 15929           TRLR-FILE-ID,
 15930           DFHEIV11,
 15931           DFHEIV99
 15932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15933
 15934
 15935     IF AUTH-RCVD
 15936        MOVE 'Y' TO AUTHRCVO
 15937     ELSE
 15938        MOVE 'N' TO AUTHRCVO
 15939     END-IF.
 15940
 15941
 15942 5100-EXIT.
 15943     EXIT.
 15944
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 298
* EL131.cbl
 15946 6000-CALCULATE-CERT-TERM.
 15947
 15948     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15949         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15950     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15951         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15952     IF CM-LOAN-APR NOT NUMERIC
 15953         MOVE ZEROS              TO CM-LOAN-APR.
 15954
 15955*    IF WS-CALC-METHOD  = 'G'
 15956         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15957*     ELSE
 15958*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15959
 15960     IF N GREATER 120
 15961         MOVE 120                TO N.
 15962
 15963     MOVE '6'                    TO DC-OPTION-CODE.
 15964     MOVE N                      TO DC-ELAPSED-MONTHS.
 15965     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15966     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15967
 15968     IF CM-LF-BENEFIT-CD NOT = ZERO
 15969         MOVE N                  TO CM-LF-ORIG-TERM
 15970         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15971         IF NO-CONVERSION-ERROR
 15972             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15973
 15974     IF CM-AH-BENEFIT-CD NOT = ZERO
 15975         MOVE N                  TO CM-AH-ORIG-TERM
 15976         IF NO-CONVERSION-ERROR
 15977             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15978
 15979 6000-EXIT.
 15980      EXIT.
 15981
 15982 6100-CALC-GROSS-TERM.
 15983     MOVE CM-LOAN-BALANCE         TO L.
 15984     MOVE PI-PAYMENT-AMT          TO M.
 15985
 15986     COMPUTE N = L / M.
 15987     IF N LESS 1
 15988         MOVE 1  TO N.
 15989
 15990     IF CM-LF-BENEFIT-CD NOT = ZERO
 15991         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15992     ELSE
 15993         MOVE ZEROS               TO WS-LF-RATE.
 15994
 15995     IF CM-AH-BENEFIT-CD NOT = ZERO
 15996         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15997     ELSE
 15998         MOVE ZEROS               TO WS-AH-RATE.
 15999
 16000     COMPUTE I = CM-LOAN-APR / +1200.
 16001
 16002 6105-LOOP.
 16003     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 299
* EL131.cbl
 16004         GO TO 6200-EXIT.
 16005     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 16006     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 16007         ADD 1 TO N
 16008         GO TO 6105-LOOP.
 16009
 16010 6200-EXIT.
 16011      EXIT.
 16012
 16013 6210-CALC-LEFT-RIGHTONE.
 16014      MOVE L         TO LEFT-TOT-1.
 16015      SUBTRACT 1 FROM N.
 16016      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 16017      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 16018      ADD 1 TO N.
 16019 6211-CALC-TERM1.
 16020      MOVE N         TO TERM1.
 16021      MULTIPLY M BY TERM1.
 16022 6212-LOOP.
 16023      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 16024      ADD 1 TO A-N.
 16025      MULTIPLY A-N BY TERM1.
 16026      SUBTRACT 1 FROM A-N.
 16027      ADD TERM1 TO LEFT-TOT-1.
 16028 6213-CALC-TERM2.
 16029      MOVE M         TO TERM2.
 16030      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 16031      MULTIPLY IA-N BY TERM2.
 16032      SUBTRACT TERM2 FROM LEFT-TOT-1.
 16033 6215-CALC-RIGHTONE.
 16034      MOVE M         TO RIGHT-TOT-1.
 16035      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 16036      MULTIPLY A-N BY RIGHT-TOT-1.
 16037 6220-EXIT.
 16038      EXIT.
 16039
 16040 6300-CALC-A-N.
 16041     IF N LESS 1
 16042         MOVE 0     TO A-N
 16043         GO TO 6300-EXIT.
 16044     IF I = 0
 16045         MOVE .00001 TO I.
 16046     ADD 1 TO I.
 16047     DIVIDE I INTO 1 GIVING V.
 16048     SUBTRACT 1 FROM I.
 16049     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16050     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 16051     DIVIDE I INTO TERM3 GIVING A-N.
 16052 6300-EXIT.
 16053      EXIT.
 16054
 16055 6350-CALC-IA-N.
 16056     IF N LESS 1
 16057         MOVE 0      TO IA-N
 16058         GO TO 6400-EXIT.
 16059     ADD 1 TO N.
 16060     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16061     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 300
* EL131.cbl
 16062     MULTIPLY N BY V-EX-N GIVING TERM3.
 16063     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 16064     SUBTRACT V FROM 1 GIVING TERM4.
 16065     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 16066 6400-EXIT.
 16067      EXIT.
 16068
 16069 6450-CALC-V-EX-N.
 16070     IF N LESS 1
 16071         MOVE 1    TO V-EX-N
 16072         GO TO 6490-EXIT.
 16073     MOVE N        TO NV-STORE.
 16074     IF V-EX-ONETIME = 1  OR
 16075        V NOT = V-EXPONENT (1)
 16076          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 16077 6460-LOOP.
 16078     IF N GREATER 248
 16079         MOVE 248 TO N.
 16080     IF N = 1
 16081         MOVE V               TO V-EX-N
 16082      ELSE
 16083         MOVE V-EXPONENT (N)  TO V-EX-N.
 16084     GO TO 6490-EXIT.
 16085
 16086 6470-BUILD-V-EX-TABLE.
 16087     MOVE 2      TO N.
 16088     MOVE V      TO V-EXPONENT (1)
 16089                    V-EX-N.
 16090 6471-LOOP.
 16091     MULTIPLY V BY V-EX-N.
 16092     MOVE V-EX-N   TO V-EXPONENT (N).
 16093     ADD 1 TO N.
 16094     IF N LESS 248
 16095         GO TO 6471-LOOP.
 16096     MOVE NV-STORE     TO N.
 16097     MOVE 0            TO V-EX-ONETIME.
 16098 6480-EXIT.
 16099      EXIT.
 16100
 16101 6490-EXIT.
 16102      EXIT.
 16103
 16104 6500-CALC-NET-TERM.
 16105     MOVE CM-LOAN-BALANCE         TO L.
 16106     MOVE PI-PAYMENT-AMT          TO M.
 16107
 16108     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 16109     IF WS-REMAIN GREATER ZERO
 16110         ADD 1 TO N.
 16111     IF N = 0
 16112         MOVE 1 TO N.
 16113
 16114 6700-EXIT.
 16115      EXIT.
 16116
 16117 6999-CALC-TERM-EXIT.
 16118     EXIT.
 16119
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 301
* EL131.cbl
 16121 7000-RESET-ATTRIBUTE.
 16122
 16123     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 16124                                    CERTSTA   CERTCARA
 16125                                    CERTGRPA.
 16126     MOVE -1                     TO CERTCARL.
 16127
 16128 7000-EXIT.
 16129     EXIT.
 16130
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 302
* EL131.cbl
 16132 7600-BROWSE-CLAIM.
 16133
 16134
 16135* EXEC CICS READ
 16136*        DATASET(CLMS-FILE-ID)
 16137*        SET    (ADDRESS OF CLAIM-MASTER)
 16138*        RIDFLD (MSTR-KEY)
 16139*        GENERIC
 16140*        EQUAL
 16141*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16142*    END-EXEC.
 16143*    MOVE '&"S  KG    E          (   #00013558' TO DFHEIV0
 16144     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16145     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16146     MOVE X'2020233030303133353538' TO DFHEIV0(25:11)
 16147     CALL 'kxdfhei1' USING DFHEIV0,
 16148           CLMS-FILE-ID,
 16149           DFHEIV20,
 16150           DFHEIV99,
 16151           MSTR-KEY,
 16152           ELMSTR-GENERIC-LENGTH,
 16153           DFHEIV99,
 16154           DFHEIV99
 16155     SET ADDRESS OF CLAIM-MASTER TO
 16156         DFHEIV20
 16157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16158
 16159
 16160     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 16161
 16162     if cl-assoc-cert-total = 0
 16163        move 1 to cl-assoc-cert-total
 16164     end-if
 16165     IF CL-ASSOC-CERT-SEQU = 0
 16166        MOVE 1 TO CL-ASSOC-CERT-SEQU
 16167     END-IF
 16168
 16169     IF CL-ASSOC-CERT-TOTAL = 1
 16170         MOVE AL-SADOF           TO BCERT1A
 16171                                    BSUFX1A
 16172                                    BCERT2A
 16173                                    BSUFX2A
 16174                                    BCERT3A
 16175                                    BSUFX3A
 16176                                    BCERT4A
 16177                                    BSUFX4A
 16178                                    BCERT5A
 16179                                    BSUFX5A
 16180                                    PCERTNOA
 16181                                    PSUFXA
 16182                                    LABEL1A
 16183                                    LABEL2A
 16184         GO TO 7699-EXIT.
 16185
 16186 7610-BROWSE-CLAIM-LOOP.
 16187
 16188     MOVE LOW-VALUES             TO BCERT1O
 16189                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 303
* EL131.cbl
 16190                                    BCERT2O
 16191                                    BSUFX2O
 16192                                    BCERT3O
 16193                                    BSUFX3O
 16194                                    BCERT4O
 16195                                    BSUFX4O
 16196                                    BCERT5O
 16197                                    BSUFX5O.
 16198
 16199
 16200* EXEC CICS HANDLE CONDITION
 16201*        ENDFILE  (7630-END-BROWSE)
 16202*    END-EXEC.
 16203*    MOVE '"$''                   ! E #00013606' TO DFHEIV0
 16204     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16206     MOVE X'4520233030303133363036' TO DFHEIV0(25:11)
 16207     CALL 'kxdfhei1' USING DFHEIV0
 16208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16209
 16210
 16211
 16212* EXEC CICS STARTBR
 16213*        DATASET    (CLMS-FILE-ID)
 16214*        RIDFLD     (MSTR-KEY)
 16215*    END-EXEC.
 16216     MOVE 0
 16217       TO DFHEIV11
 16218*    MOVE '&,         G          &   #00013610' TO DFHEIV0
 16219     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16220     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16221     MOVE X'2020233030303133363130' TO DFHEIV0(25:11)
 16222     CALL 'kxdfhei1' USING DFHEIV0,
 16223           CLMS-FILE-ID,
 16224           MSTR-KEY,
 16225           DFHEIV99,
 16226           DFHEIV11,
 16227           DFHEIV99
 16228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16229
 16230
 16231     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 16232
 16233 7620-READ-CLAIM-LOOP.
 16234
 16235
 16236* EXEC CICS READNEXT
 16237*        DATASET   (CLMS-FILE-ID)
 16238*        SET       (ADDRESS OF CLAIM-MASTER)
 16239*        RIDFLD    (MSTR-KEY)
 16240*    END-EXEC.
 16241     MOVE 0
 16242       TO DFHEIV11
 16243*    MOVE '&.S                   )   #00013619' TO DFHEIV0
 16244     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16245     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16246     MOVE X'2020233030303133363139' TO DFHEIV0(25:11)
 16247     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 304
* EL131.cbl
 16248           CLMS-FILE-ID,
 16249           DFHEIV20,
 16250           DFHEIV99,
 16251           MSTR-KEY,
 16252           DFHEIV99,
 16253           DFHEIV11,
 16254           DFHEIV99,
 16255           DFHEIV99
 16256     SET ADDRESS OF CLAIM-MASTER TO
 16257         DFHEIV20
 16258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16259
 16260
 16261     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 16262        CL-CARRIER     NOT = CARRI           OR
 16263        CL-CLAIM-NO    NOT = CLAIMI
 16264        GO TO 7630-END-BROWSE.
 16265
 16266     IF WS-ASSOCIATED-CERTS = 1
 16267         MOVE CL-CERT-PRIME      TO BCERT1O
 16268         MOVE CL-CERT-SFX        TO BSUFX1O.
 16269
 16270     IF WS-ASSOCIATED-CERTS = 2
 16271         MOVE CL-CERT-PRIME      TO BCERT2O
 16272         MOVE CL-CERT-SFX        TO BSUFX2O.
 16273
 16274     IF WS-ASSOCIATED-CERTS = 3
 16275         MOVE CL-CERT-PRIME      TO BCERT3O
 16276         MOVE CL-CERT-SFX        TO BSUFX3O.
 16277
 16278     IF WS-ASSOCIATED-CERTS = 4
 16279         MOVE CL-CERT-PRIME      TO BCERT4O
 16280         MOVE CL-CERT-SFX        TO BSUFX4O.
 16281
 16282     IF WS-ASSOCIATED-CERTS = 5
 16283         MOVE CL-CERT-PRIME      TO BCERT5O
 16284         MOVE CL-CERT-SFX        TO BSUFX5O
 16285     ELSE
 16286         ADD +1                  TO WS-ASSOCIATED-CERTS
 16287         GO TO 7620-READ-CLAIM-LOOP.
 16288
 16289 7630-END-BROWSE.
 16290
 16291
 16292* EXEC CICS ENDBR
 16293*        DATASET   (CLMS-FILE-ID)
 16294*    END-EXEC.
 16295     MOVE 0
 16296       TO DFHEIV11
 16297*    MOVE '&2                    $   #00013655' TO DFHEIV0
 16298     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16299     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16300     MOVE X'2020233030303133363535' TO DFHEIV0(25:11)
 16301     CALL 'kxdfhei1' USING DFHEIV0,
 16302           CLMS-FILE-ID,
 16303           DFHEIV11,
 16304           DFHEIV99
 16305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 305
* EL131.cbl
 16306
 16307
 16308 7640-HIGHLIGHT-CERT-DISPLAYED.
 16309
 16310     MOVE AL-SANON               TO BCERT1A
 16311                                    BSUFX1A
 16312                                    BCERT2A
 16313                                    BSUFX2A
 16314                                    BCERT3A
 16315                                    BSUFX3A
 16316                                    BCERT4A
 16317                                    BSUFX4A
 16318                                    BCERT5A
 16319                                    BSUFX5A.
 16320
 16321     IF BCERT1O = CERTI AND
 16322        BSUFX1O = SUFXI
 16323            MOVE AL-SABON        TO BCERT1A
 16324                                    BSUFX1A.
 16325
 16326     IF BCERT2O = CERTI AND
 16327        BSUFX2O = SUFXI
 16328            MOVE AL-SABON        TO BCERT2A
 16329                                    BSUFX2A.
 16330
 16331     IF BCERT3O = CERTI AND
 16332        BSUFX3O = SUFXI
 16333            MOVE AL-SABON        TO BCERT3A
 16334                                    BSUFX3A.
 16335
 16336     IF BCERT4O = CERTI AND
 16337        BSUFX4O = SUFXI
 16338            MOVE AL-SABON        TO BCERT4A
 16339                                    BSUFX4A.
 16340
 16341     IF BCERT5O = CERTI AND
 16342        BSUFX5O = SUFXI
 16343            MOVE AL-SABON        TO BCERT5A
 16344                                    BSUFX5A.
 16345
 16346 7699-EXIT.
 16347     EXIT.
 16348
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 306
* EL131.cbl
 16350 7700-CHECK-SEQUENCE.
 16351
 16352
 16353* EXEC CICS HANDLE CONDITION
 16354*        ENDFILE  (7799-EXIT)
 16355*        NOTFND   (7799-EXIT)
 16356*    END-EXEC.
 16357*    MOVE '"$''I                  ! F #00013703' TO DFHEIV0
 16358     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16359     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16360     MOVE X'4620233030303133373033' TO DFHEIV0(25:11)
 16361     CALL 'kxdfhei1' USING DFHEIV0
 16362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16363
 16364
 16365
 16366* EXEC CICS READ
 16367*        DATASET(CLMS-FILE-ID)
 16368*        SET    (ADDRESS OF CLAIM-MASTER)
 16369*        RIDFLD (MSTR-KEY)
 16370*        GENERIC
 16371*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16372*    END-EXEC.
 16373*    MOVE '&"S  KG    E          (   #00013708' TO DFHEIV0
 16374     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16375     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16376     MOVE X'2020233030303133373038' TO DFHEIV0(25:11)
 16377     CALL 'kxdfhei1' USING DFHEIV0,
 16378           CLMS-FILE-ID,
 16379           DFHEIV20,
 16380           DFHEIV99,
 16381           MSTR-KEY,
 16382           ELMSTR-GENERIC-LENGTH,
 16383           DFHEIV99,
 16384           DFHEIV99
 16385     SET ADDRESS OF CLAIM-MASTER TO
 16386         DFHEIV20
 16387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16388
 16389
 16390     COMPUTE WS-ASSOC-CERT-TOTAL =
 16391             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 16392
 16393     GO TO 7799-EXIT.
 16394
 16395 7710-RESEQUENCE-CLAIMS.
 16396
 16397
 16398* EXEC CICS HANDLE CONDITION
 16399*        ENDFILE  (7799-EXIT)
 16400*    END-EXEC.
 16401*    MOVE '"$''                   ! G #00013723' TO DFHEIV0
 16402     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16404     MOVE X'4720233030303133373233' TO DFHEIV0(25:11)
 16405     CALL 'kxdfhei1' USING DFHEIV0
 16406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16407
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 307
* EL131.cbl
 16408
 16409
 16410* EXEC CICS STARTBR
 16411*        DATASET(CLMS-FILE-ID)
 16412*        RIDFLD (MSTR-KEY)
 16413*    END-EXEC.
 16414     MOVE 0
 16415       TO DFHEIV11
 16416*    MOVE '&,         G          &   #00013727' TO DFHEIV0
 16417     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16418     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16419     MOVE X'2020233030303133373237' TO DFHEIV0(25:11)
 16420     CALL 'kxdfhei1' USING DFHEIV0,
 16421           CLMS-FILE-ID,
 16422           MSTR-KEY,
 16423           DFHEIV99,
 16424           DFHEIV11,
 16425           DFHEIV99
 16426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16427
 16428
 16429     COMPUTE WS-ASSOC-CERT-SEQU =
 16430             WS-ASSOC-CERT-SEQU + 1.
 16431
 16432     COMPUTE WS-READNEXT-SWITCH =
 16433             WS-READNEXT-SWITCH + 1.
 16434
 16435 7720-READ-CLAIM-LOOP.
 16436
 16437
 16438* EXEC CICS READNEXT
 16439*        DATASET(CLMS-FILE-ID)
 16440*        SET    (ADDRESS OF CLAIM-MASTER)
 16441*        RIDFLD (MSTR-KEY)
 16442*    END-EXEC.
 16443     MOVE 0
 16444       TO DFHEIV11
 16445*    MOVE '&.S                   )   #00013740' TO DFHEIV0
 16446     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16447     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16448     MOVE X'2020233030303133373430' TO DFHEIV0(25:11)
 16449     CALL 'kxdfhei1' USING DFHEIV0,
 16450           CLMS-FILE-ID,
 16451           DFHEIV20,
 16452           DFHEIV99,
 16453           MSTR-KEY,
 16454           DFHEIV99,
 16455           DFHEIV11,
 16456           DFHEIV99,
 16457           DFHEIV99
 16458     SET ADDRESS OF CLAIM-MASTER TO
 16459         DFHEIV20
 16460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16461
 16462
 16463     IF WS-READNEXT-SWITCH = 1
 16464         ADD 1                   TO WS-READNEXT-SWITCH
 16465         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 308
* EL131.cbl
 16466
 16467 7730-END-BROWSE.
 16468
 16469
 16470* EXEC CICS ENDBR
 16471*        DATASET(CLMS-FILE-ID)
 16472*    END-EXEC.
 16473     MOVE 0
 16474       TO DFHEIV11
 16475*    MOVE '&2                    $   #00013752' TO DFHEIV0
 16476     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16477     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16478     MOVE X'2020233030303133373532' TO DFHEIV0(25:11)
 16479     CALL 'kxdfhei1' USING DFHEIV0,
 16480           CLMS-FILE-ID,
 16481           DFHEIV11,
 16482           DFHEIV99
 16483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16484
 16485
 16486 7740-READ-CLAIM-UPDATE.
 16487
 16488     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 16489        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 16490        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 16491        GO TO 7799-EXIT
 16492     ELSE
 16493        MOVE ZERO                TO WS-READNEXT-SWITCH.
 16494
 16495
 16496* EXEC CICS READ
 16497*        DATASET(CLMS-FILE-ID)
 16498*        SET    (ADDRESS OF CLAIM-MASTER)
 16499*        RIDFLD (MSTR-KEY)
 16500*        UPDATE
 16501*    END-EXEC.
 16502*    MOVE '&"S        EU         (   #00013765' TO DFHEIV0
 16503     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16504     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16505     MOVE X'2020233030303133373635' TO DFHEIV0(25:11)
 16506     CALL 'kxdfhei1' USING DFHEIV0,
 16507           CLMS-FILE-ID,
 16508           DFHEIV20,
 16509           DFHEIV99,
 16510           MSTR-KEY,
 16511           DFHEIV99,
 16512           DFHEIV99,
 16513           DFHEIV99
 16514     SET ADDRESS OF CLAIM-MASTER TO
 16515         DFHEIV20
 16516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16517
 16518
 16519     if (cl-priority-cd = '8')
 16520        and (pi-processor-id not = 'PEMA' and 'JMS '
 16521             AND 'AMWA')
 16522        MOVE ER-8003             TO EMI-ERROR
 16523        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 309
* EL131.cbl
 16524                                 THRU 9900-EXIT
 16525        MOVE -1                  TO MAINTL
 16526        GO TO 8110-SEND-DATA
 16527     end-if
 16528
 16529     IF PI-COMPANY-ID = 'CID' or 'AHL'
 16530         MOVE 'Y'                TO CL-YESNOSW
 16531     END-IF.
 16532
 16533     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16534     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16535
 16536
 16537* EXEC CICS REWRITE
 16538*         DATASET(CLMS-FILE-ID)
 16539*         FROM   (CLAIM-MASTER)
 16540*    END-EXEC.
 16541     MOVE LENGTH OF
 16542      CLAIM-MASTER
 16543       TO DFHEIV11
 16544*    MOVE '&& L                  %   #00013789' TO DFHEIV0
 16545     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16546     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16547     MOVE X'2020233030303133373839' TO DFHEIV0(25:11)
 16548     CALL 'kxdfhei1' USING DFHEIV0,
 16549           CLMS-FILE-ID,
 16550           CLAIM-MASTER,
 16551           DFHEIV11,
 16552           DFHEIV99
 16553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16554
 16555
 16556     GO TO 7710-RESEQUENCE-CLAIMS.
 16557
 16558 7799-EXIT.
 16559     EXIT.
 16560
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 310
* EL131.cbl
 16562 7800-CHECK-AUTO-ACTIVITY.
 16563
 16564
 16565* EXEC CICS HANDLE CONDITION
 16566*        NOTFND   (7800-NOT-FOUND)
 16567*    END-EXEC.
 16568*    MOVE '"$I                   ! H #00013802' TO DFHEIV0
 16569     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16571     MOVE X'4820233030303133383032' TO DFHEIV0(25:11)
 16572     CALL 'kxdfhei1' USING DFHEIV0
 16573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16574
 16575
 16576     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 16577     MOVE 'T'                        TO  CNTL-REC-TYPE.
 16578     MOVE SPACES                     TO  CNTL-PROC-ID.
 16579     MOVE +0                         TO  CNTL-SEQ-NO.
 16580
 16581
 16582* EXEC CICS READ
 16583*        DATASET   (CNTL-FILE-ID)
 16584*        RIDFLD    (CNTL-KEY)
 16585*        SET       (ADDRESS OF CONTROL-FILE)
 16586*    END-EXEC.
 16587*    MOVE '&"S        E          (   #00013811' TO DFHEIV0
 16588     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16590     MOVE X'2020233030303133383131' TO DFHEIV0(25:11)
 16591     CALL 'kxdfhei1' USING DFHEIV0,
 16592           CNTL-FILE-ID,
 16593           DFHEIV20,
 16594           DFHEIV99,
 16595           CNTL-KEY,
 16596           DFHEIV99,
 16597           DFHEIV99,
 16598           DFHEIV99
 16599     SET ADDRESS OF CONTROL-FILE TO
 16600         DFHEIV20
 16601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16602
 16603
 16604     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 16605         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 16606
 16607     IF CL-ACTIVITY-CODE NOT = ZEROS
 16608         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 16609         IF MISC-SUB IS GREATER THAN +9
 16610             SUBTRACT +9 FROM MISC-SUB
 16611             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 16612         ELSE
 16613             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 16614     ELSE
 16615         MOVE 'Y'                              TO  WS-RESET-SW.
 16616
 16617     IF STATUSI = 'C' OR 'CLOSED'
 16618         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 16619             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 311
* EL131.cbl
 16620                                         PI-LETTER-SW
 16621             GO TO 7800-EXIT.
 16622
 16623     IF STATUSI = 'C' OR 'CLOSED'
 16624         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 16625             MOVE 'N'                TO  PI-LETTER-SW
 16626         ELSE
 16627             MOVE 'Y'                TO  PI-LETTER-SW.
 16628
 16629     IF STATUSI = 'O' OR 'OPEN'
 16630         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 16631             MOVE 'N'                TO  PI-REC-FOUND-SW
 16632                                         PI-LETTER-SW
 16633             GO TO 7800-EXIT.
 16634
 16635     IF STATUSI = 'O' OR 'OPEN'
 16636         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 16637             MOVE 'N'                TO  PI-LETTER-SW
 16638         ELSE
 16639             MOVE 'Y'                TO  PI-LETTER-SW.
 16640
 16641     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16642     GO TO 7800-EXIT.
 16643
 16644 7800-NOT-FOUND.
 16645
 16646     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16647                                         PI-LETTER-SW.
 16648
 16649 7800-EXIT.
 16650     EXIT.
 16651
 16652 7850-AUTO-LETTER-WRITER.
 16653
 16654     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16655     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16656
 16657     IF STATUSI = 'C' OR 'CLOSED'
 16658         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16659     ELSE
 16660         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16661
 16662     IF STATUSI = 'C' OR 'CLOSED'
 16663         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16664             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16665             MOVE '6'                TO  DC-OPTION-CODE
 16666             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16667             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16668             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16669             IF NO-CONVERSION-ERROR
 16670                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16671             ELSE
 16672                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16673
 16674     IF STATUSI = 'C' OR 'CLOSED'
 16675         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16676             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16677             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 312
* EL131.cbl
 16678             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16679             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16680             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16681             IF NO-CONVERSION-ERROR
 16682                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16683             ELSE
 16684                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16685
 16686     IF STATUSI = 'O' OR 'OPEN'
 16687         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16688             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16689             MOVE '6'                TO  DC-OPTION-CODE
 16690             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16691             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16692             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16693             IF NO-CONVERSION-ERROR
 16694                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16695             ELSE
 16696                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16697
 16698     IF STATUSI = 'O' OR 'OPEN'
 16699         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16700             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16701             MOVE '6'                TO  DC-OPTION-CODE
 16702             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16703             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16704             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16705             IF NO-CONVERSION-ERROR
 16706                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16707             ELSE
 16708                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16709
 16710
 16711* EXEC CICS LINK
 16712*        PROGRAM    (LINK-1523)
 16713*        COMMAREA   (W-1523-LINKDATA)
 16714*        LENGTH     (W-1523-COMM-LENGTH)
 16715*    END-EXEC.
 16716*    MOVE '."C                   (   #00013923' TO DFHEIV0
 16717     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16718     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16719     MOVE X'2020233030303133393233' TO DFHEIV0(25:11)
 16720     CALL 'kxdfhei1' USING DFHEIV0,
 16721           LINK-1523,
 16722           W-1523-LINKDATA,
 16723           W-1523-COMM-LENGTH,
 16724           DFHEIV99,
 16725           DFHEIV99,
 16726           DFHEIV99,
 16727           DFHEIV99
 16728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16729
 16730
 16731     IF W-1523-ERROR-CODE = ZEROS
 16732         GO TO 7850-EXIT.
 16733
 16734     IF W-1523-FATAL-ERROR
 16735         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 313
* EL131.cbl
 16736         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16737
 16738     IF W-1523-ERROR-CODE = 0191
 16739         MOVE ER-0803                TO  EMI-ERROR
 16740         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16741
 16742 7850-EXIT.
 16743     EXIT.
 16744
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 314
* EL131.cbl
 16746 8000-CREATE-DMO-REC.
 16747     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16748     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16749     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16750
 16751
 16752* EXEC CICS HANDLE CONDITION
 16753*         NOTFND   (8000-NOTE-NOT-FOUND)
 16754*    END-EXEC.
 16755*    MOVE '"$I                   ! I #00013949' TO DFHEIV0
 16756     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16758     MOVE X'4920233030303133393439' TO DFHEIV0(25:11)
 16759     CALL 'kxdfhei1' USING DFHEIV0
 16760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16761
 16762
 16763
 16764* EXEC CICS READ
 16765*         DATASET(NOTE-FILE-ID)
 16766*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16767*         RIDFLD (NOTE-KEY)
 16768*    END-EXEC.
 16769*    MOVE '&"S        E          (   #00013953' TO DFHEIV0
 16770     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16772     MOVE X'2020233030303133393533' TO DFHEIV0(25:11)
 16773     CALL 'kxdfhei1' USING DFHEIV0,
 16774           NOTE-FILE-ID,
 16775           DFHEIV20,
 16776           DFHEIV99,
 16777           NOTE-KEY,
 16778           DFHEIV99,
 16779           DFHEIV99,
 16780           DFHEIV99
 16781     SET ADDRESS OF CERTIFICATE-NOTE TO
 16782         DFHEIV20
 16783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16784
 16785
 16786     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16787     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16788     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16789
 16790     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16791         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16792     ELSE
 16793         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16794
 16795     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16796     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16797
 16798
 16799* EXEC CICS LINK
 16800*        PROGRAM    ('DLO006')
 16801*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16802*        LENGTH     (WS-DCT-LENGTH)
 16803*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 315
* EL131.cbl
 16804     MOVE 'DLO006' TO DFHEIV1
 16805*    MOVE '."C                   (   #00013971' TO DFHEIV0
 16806     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16808     MOVE X'2020233030303133393731' TO DFHEIV0(25:11)
 16809     CALL 'kxdfhei1' USING DFHEIV0,
 16810           DFHEIV1,
 16811           DCT-COMMUNICATION-AREA,
 16812           WS-DCT-LENGTH,
 16813           DFHEIV99,
 16814           DFHEIV99,
 16815           DFHEIV99,
 16816           DFHEIV99
 16817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16818
 16819
 16820     IF  DCT-RETURN-CODE = 'OK'
 16821         GO TO 8000-CONT.
 16822
 16823     IF DCT-RETURN-CODE = '01' OR '02'
 16824         GO TO 8000-EXIT.
 16825
 16826     IF DCT-RETURN-CODE = '03'
 16827         MOVE ER-0951            TO EMI-ERROR
 16828         MOVE -1                 TO MAINTL
 16829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16830         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16831         GO TO 8110-SEND-DATA.
 16832
 16833     IF DCT-RETURN-CODE = '04'
 16834         MOVE ER-0946            TO EMI-ERROR
 16835         MOVE -1                 TO MAINTL
 16836         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16837         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16838         GO TO 8110-SEND-DATA.
 16839
 16840     IF DCT-RETURN-CODE = '05'
 16841         MOVE ER-0947            TO EMI-ERROR
 16842         MOVE -1                 TO MAINTL
 16843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16844         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16845         GO TO 8110-SEND-DATA.
 16846
 16847     IF DCT-RETURN-CODE = '06'
 16848         MOVE ER-0921            TO EMI-ERROR
 16849         MOVE -1                 TO MAINTL
 16850         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16851         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16852         GO TO 8110-SEND-DATA.
 16853
 16854     IF DCT-RETURN-CODE = '07'
 16855         MOVE ER-0919            TO EMI-ERROR
 16856         MOVE -1                 TO MAINTL
 16857         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16858         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16859         GO TO 8110-SEND-DATA.
 16860
 16861     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 316
* EL131.cbl
 16862         MOVE ER-0948            TO EMI-ERROR
 16863         MOVE -1                 TO MAINTL
 16864         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16865         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16866         GO TO 8110-SEND-DATA.
 16867
 16868     IF DCT-RETURN-CODE = 'N1'
 16869         MOVE ER-0950            TO EMI-ERROR
 16870         MOVE -1                 TO MAINTL
 16871         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16872         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16873         GO TO 8110-SEND-DATA.
 16874
 16875     IF DCT-RETURN-CODE = 'E1'
 16876         MOVE ER-0974            TO EMI-ERROR
 16877         MOVE -1                 TO MAINTL
 16878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16879         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16880         GO TO 8110-SEND-DATA.
 16881
 16882     IF DCT-RETURN-CODE = 'E2'
 16883         MOVE ER-0975            TO EMI-ERROR
 16884         MOVE -1                 TO MAINTL
 16885         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16886         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16887         GO TO 8110-SEND-DATA.
 16888
 16889     IF DCT-RETURN-CODE NOT = 'OK'
 16890         MOVE ER-0949            TO EMI-ERROR
 16891         MOVE -1                 TO MAINTL
 16892         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16893         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16894         GO TO 8110-SEND-DATA.
 16895
 16896 8000-CONT.
 16897
 16898     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16899     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16900     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16901     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16902     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16903     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16904     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16905     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16906
 16907     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16908     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16909     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16910     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16911     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16912
 16913     IF STATUSI = 'OPEN' OR 'O'
 16914         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16915      ELSE
 16916         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16917
 16918     IF STATUSI = 'OPEN' OR 'O'
 16919        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 317
* EL131.cbl
 16920         MOVE '1'                TO DM-CLAIM-STATUS
 16921      ELSE
 16922         MOVE '2'                TO DM-CLAIM-STATUS.
 16923
 16924     IF STATUSI = 'CLOSED' OR 'C'
 16925        IF NOT FINAL-PAID
 16926         MOVE '3'                TO DM-CLAIM-STATUS
 16927      ELSE
 16928         MOVE '4'                TO DM-CLAIM-STATUS.
 16929
 16930     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16931
 16932
 16933* EXEC CICS LINK
 16934*        PROGRAM    ('DLO025')
 16935*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16936*        LENGTH     (WS-DMO-LENGTH)
 16937*    END-EXEC.
 16938     MOVE 'DLO025' TO DFHEIV1
 16939*    MOVE '."C                   (   #00014089' TO DFHEIV0
 16940     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16942     MOVE X'2020233030303134303839' TO DFHEIV0(25:11)
 16943     CALL 'kxdfhei1' USING DFHEIV0,
 16944           DFHEIV1,
 16945           DMO-COMMUNICATION-AREA,
 16946           WS-DMO-LENGTH,
 16947           DFHEIV99,
 16948           DFHEIV99,
 16949           DFHEIV99,
 16950           DFHEIV99
 16951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16952
 16953
 16954     IF  DM-RETURN-CODE = 'OK'
 16955         GO TO 8000-EXIT.
 16956
 16957     IF DM-RETURN-CODE = '01'
 16958         MOVE ER-8051            TO EMI-ERROR
 16959         MOVE -1                 TO MAINTL
 16960         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16961         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16962         GO TO 8110-SEND-DATA.
 16963
 16964     IF DM-RETURN-CODE = '02'
 16965         MOVE ER-8052            TO EMI-ERROR
 16966         MOVE -1                 TO MAINTL
 16967         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16968         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16969         GO TO 8110-SEND-DATA.
 16970
 16971     IF DM-RETURN-CODE = '03'
 16972         MOVE ER-8053            TO EMI-ERROR
 16973         MOVE -1                 TO MAINTL
 16974         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16975         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16976         GO TO 8110-SEND-DATA.
 16977
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 318
* EL131.cbl
 16978     IF DM-RETURN-CODE = '04'
 16979         MOVE ER-8054            TO EMI-ERROR
 16980         MOVE -1                 TO MAINTL
 16981         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16982         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16983         GO TO 8110-SEND-DATA.
 16984
 16985     IF DM-RETURN-CODE = '05'
 16986         MOVE ER-8055            TO EMI-ERROR
 16987         MOVE -1                 TO MAINTL
 16988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16989         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16990         GO TO 8110-SEND-DATA.
 16991
 16992     IF DM-RETURN-CODE = '06'
 16993         MOVE ER-8056            TO EMI-ERROR
 16994         MOVE -1                 TO MAINTL
 16995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16996         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16997         GO TO 8110-SEND-DATA.
 16998
 16999     IF DM-RETURN-CODE = '07'
 17000         MOVE ER-8057            TO EMI-ERROR
 17001         MOVE -1                 TO MAINTL
 17002         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17003         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17004         GO TO 8110-SEND-DATA.
 17005
 17006     IF DM-RETURN-CODE = '08'
 17007         MOVE ER-8058            TO EMI-ERROR
 17008         MOVE -1                 TO MAINTL
 17009         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17010         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17011         GO TO 8110-SEND-DATA.
 17012
 17013     IF DM-RETURN-CODE = '09'
 17014         MOVE ER-8059            TO EMI-ERROR
 17015         MOVE -1                 TO MAINTL
 17016         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17017         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17018         GO TO 8110-SEND-DATA.
 17019
 17020     IF DM-RETURN-CODE = '10'
 17021         MOVE ER-8060            TO EMI-ERROR
 17022         MOVE -1                 TO MAINTL
 17023         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17024         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17025         GO TO 8110-SEND-DATA.
 17026
 17027     IF DM-RETURN-CODE = '11'
 17028         MOVE ER-8061            TO EMI-ERROR
 17029         MOVE -1                 TO MAINTL
 17030         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17031         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17032         GO TO 8110-SEND-DATA.
 17033
 17034     IF DM-RETURN-CODE = '12'
 17035         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 319
* EL131.cbl
 17036         MOVE -1                 TO MAINTL
 17037         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17038         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17039         GO TO 8110-SEND-DATA.
 17040
 17041     IF DM-RETURN-CODE = '13'
 17042         MOVE ER-8063            TO EMI-ERROR
 17043         MOVE -1                 TO MAINTL
 17044         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17045         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17046         GO TO 8110-SEND-DATA.
 17047
 17048     IF DM-RETURN-CODE = '14'
 17049         MOVE ER-8064            TO EMI-ERROR
 17050         MOVE -1                 TO MAINTL
 17051         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17052         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17053         GO TO 8110-SEND-DATA.
 17054
 17055     IF DM-RETURN-CODE = '15'
 17056         MOVE ER-8065            TO EMI-ERROR
 17057         MOVE -1                 TO MAINTL
 17058         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17059         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17060         GO TO 8110-SEND-DATA.
 17061
 17062     IF DM-RETURN-CODE = '16'
 17063         MOVE ER-8154            TO EMI-ERROR
 17064         MOVE -1                 TO MAINTL
 17065         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17066         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17067         GO TO 8110-SEND-DATA.
 17068
 17069     IF DM-RETURN-CODE = '17'
 17070         MOVE ER-8155            TO EMI-ERROR
 17071         MOVE -1                 TO MAINTL
 17072         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17073         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17074         GO TO 8110-SEND-DATA.
 17075
 17076     IF DM-RETURN-CODE = 'N1'
 17077         MOVE ER-8152            TO EMI-ERROR
 17078         MOVE -1                 TO MAINTL
 17079         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17080         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17081         GO TO 8110-SEND-DATA.
 17082
 17083     IF DM-RETURN-CODE = 'E1'
 17084         MOVE ER-8153            TO EMI-ERROR
 17085         MOVE -1                 TO MAINTL
 17086         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17087         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17088         GO TO 8110-SEND-DATA.
 17089
 17090     MOVE ER-8066                TO EMI-ERROR.
 17091     MOVE -1                     TO MAINTL.
 17092     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17093     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 320
* EL131.cbl
 17094     GO TO 8110-SEND-DATA.
 17095
 17096 8000-NOTE-NOT-FOUND.
 17097
 17098* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17099*    MOVE '6"R                   !   #00014238' TO DFHEIV0
 17100     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17102     MOVE X'2020233030303134323338' TO DFHEIV0(25:11)
 17103     CALL 'kxdfhei1' USING DFHEIV0
 17104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17105
 17106     MOVE ER-0954                TO EMI-ERROR.
 17107     MOVE -1                     TO MAINTL.
 17108     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17109     GO TO 8110-SEND-DATA.
 17110
 17111 8000-EXIT.
 17112     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 321
* EL131.cbl
 17114 8050-FORMAT-LAST-NAME-1ST.
 17115*****************************************************************
 17116*             M O V E   N A M E   R O U T I N E                 *
 17117*                                                               *
 17118*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 17119*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 17120*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 17121*                                                               *
 17122*                  FIELD               VALUE                    *
 17123*                  -----               -----                    *
 17124*           W-NAME-LAST    (CL15)      SMITH                    *
 17125*           W-NAME-FIRST   (CL15)      JOHN                     *
 17126*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 17127*                                                               *
 17128*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 17129*                SMITH, JOHN ALLEN                              *
 17130*                     OR                                        *
 17131*                SMITH, JOHN A.                                 *
 17132*                                                               *
 17133*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 17134*     COPYBOOK, ELCNWA.                                         *
 17135*****************************************************************.
 17136
 17137     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 17138     MOVE ZERO                   TO WS-NAME-SW.
 17139     SET NWA-INDEX               TO +1.
 17140
 17141     IF W-NAME-LAST   = SPACES  AND
 17142        W-NAME-MIDDLE = SPACES
 17143          MOVE +1                TO WS-NAME-SW.
 17144
 17145     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 17146     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17147
 17148     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 17149     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17150
 17151     SET NWA-INDEX UP BY +1.
 17152
 17153     IF W-NAME-MIDDLE NOT = SPACES
 17154         IF W-NAME-MIDDLE-2 = SPACES
 17155             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 17156             SET NWA-INDEX UP BY +1
 17157             MOVE '.'            TO WS-NW (NWA-INDEX)
 17158             SET NWA-INDEX UP BY +2
 17159         ELSE
 17160             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 17161             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17162
 17163 8050-EXIT.
 17164     EXIT.
 17165
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 322
* EL131.cbl
 17167 8060-MOVE-NAME.
 17168     IF WS-NAME-SW GREATER THAN +1
 17169         GO TO 8060-EXIT.
 17170
 17171     IF WS-NAME-WORK2 = SPACES
 17172         GO TO 8060-EXIT.
 17173
 17174     SET NWA-INDEX2            TO +1.
 17175     SET NWA-INDEX3            TO +2.
 17176
 17177 8060-MOVE-NAME-CYCLE.
 17178     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 17179
 17180     IF NWA-INDEX LESS THAN +30
 17181         SET NWA-INDEX UP BY +1
 17182     ELSE
 17183         ADD +2 TO  WS-NAME-SW
 17184         GO TO 8060-EXIT.
 17185
 17186     IF NWA-INDEX2 LESS THAN +20
 17187         SET NWA-INDEX3 UP BY +1
 17188         SET NWA-INDEX2 UP BY +1.
 17189
 17190     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 17191        WS-NW2 (NWA-INDEX3) = SPACES
 17192         IF WS-NAME-SW = ZERO
 17193             MOVE ','            TO WS-NW (NWA-INDEX)
 17194             SET NWA-INDEX UP BY +2
 17195             MOVE +1             TO WS-NAME-SW
 17196             GO TO 8060-EXIT
 17197         ELSE
 17198             GO TO 8060-EXIT.
 17199
 17200     GO TO 8060-MOVE-NAME-CYCLE.
 17201
 17202 8060-EXIT.
 17203     EXIT.
 17204
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 323
* EL131.cbl
 17206
 17207 8070-UNLOCK-CLAIM-MSTR.
 17208
 17209* EXEC CICS UNLOCK
 17210*        DATASET   (CLMS-FILE-ID)
 17211*    END-EXEC.
 17212*    MOVE '&*                    #   #00014341' TO DFHEIV0
 17213     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 17214     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17215     MOVE X'2020233030303134333431' TO DFHEIV0(25:11)
 17216     CALL 'kxdfhei1' USING DFHEIV0,
 17217           CLMS-FILE-ID,
 17218           DFHEIV99
 17219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17220
 17221
 17222 8070-EXIT.
 17223      EXIT.
 17224
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 324
* EL131.cbl
 17226 8100-SEND-MAP.
 17227     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 17228
 17229     move al-uanon               to accswa
 17230     IF NOT PI-NO-CARRIER-SECURITY
 17231        MOVE AL-SANOF            TO CERTCARA.
 17232     IF NOT PI-NO-ACCOUNT-SECURITY
 17233        MOVE AL-SANOF            TO CERTACTA.
 17234
 17235     IF PI-PROCESSOR-ID = 'LGXX'
 17236        MOVE AL-UANON            TO CCNOA.
 17237
 17238     IF PI-COMPANY-ID = 'DMD'
 17239        NEXT SENTENCE
 17240     ELSE
 17241        MOVE AL-SADOF            TO PFKEY6A.
 17242     IF NOT (PI-COMPANY-ID = 'DCC' OR 'VPP')
 17243        MOVE AL-SANOF TO EXTENSA
 17244     END-IF
 17245
 17246     IF PI-USES-PAID-TO
 17247        MOVE 'PAID TO  :' TO PTHRHDGO.
 17248
 17249
 17250* EXEC CICS SEND
 17251*         MAP     ('EL131A')
 17252*         MAPSET  ('EL131S')
 17253*         ERASE
 17254*         FREEKB
 17255*         CURSOR
 17256*    END-EXEC.
 17257     MOVE 'EL131A' TO DFHEIV1
 17258     MOVE -1
 17259       TO DFHEIV11
 17260     MOVE 'EL131S' TO DFHEIV2
 17261*    MOVE '8$     CT  E F  H     ,   #00014372' TO DFHEIV0
 17262     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17263     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17264     MOVE X'2020233030303134333732' TO DFHEIV0(25:11)
 17265     CALL 'kxdfhei1' USING DFHEIV0,
 17266           DFHEIV1,
 17267           EL131AO,
 17268           DFHEIV99,
 17269           DFHEIV2,
 17270           DFHEIV99,
 17271           DFHEIV99,
 17272           DFHEIV99,
 17273           DFHEIV11,
 17274           DFHEIV99,
 17275           DFHEIV99,
 17276           DFHEIV99
 17277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17278
 17279
 17280     GO TO 9000-RETURN-TRANS.
 17281
 17282 8110-SEND-DATA.
 17283     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 325
* EL131.cbl
 17284
 17285     IF PI-USES-PAID-TO
 17286        MOVE 'PAID TO  :' TO PTHRHDGO.
 17287
 17288     IF PI-PROCESSOR-ID = 'LGXX'
 17289        MOVE AL-UANON            TO CCNOA.
 17290
 17291     IF PI-COMPANY-ID = 'DMD'
 17292        NEXT SENTENCE
 17293     ELSE
 17294        MOVE AL-SADOF            TO PFKEY6A.
 17295
 17296
 17297* EXEC CICS SEND
 17298*         MAP      ('EL131A')
 17299*         MAPSET   ('EL131S')
 17300*         DATAONLY
 17301*         FREEKB
 17302*         CURSOR
 17303*    END-EXEC.
 17304     MOVE 'EL131A' TO DFHEIV1
 17305     MOVE -1
 17306       TO DFHEIV11
 17307     MOVE 'EL131S' TO DFHEIV2
 17308*    MOVE '8$D    CT    F  H     ,   #00014396' TO DFHEIV0
 17309     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17310     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17311     MOVE X'2020233030303134333936' TO DFHEIV0(25:11)
 17312     CALL 'kxdfhei1' USING DFHEIV0,
 17313           DFHEIV1,
 17314           EL131AO,
 17315           DFHEIV99,
 17316           DFHEIV2,
 17317           DFHEIV99,
 17318           DFHEIV99,
 17319           DFHEIV99,
 17320           DFHEIV11,
 17321           DFHEIV99,
 17322           DFHEIV99,
 17323           DFHEIV99
 17324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17325
 17326
 17327     GO TO 9000-RETURN-TRANS.
 17328
 17329 8120-FORMAT-TIME-DATE.
 17330     perform 8140-check-for-prev-errors
 17331                                 thru 8140-exit
 17332     IF SKIP-ATTRIBUTE = 'Y'
 17333        MOVE SPACES              TO SKIP-ATTRIBUTE
 17334        MOVE ER-0598             TO EMI-ERROR
 17335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17336        GO TO 8125-SKIP-ATTRIBUTE.
 17337
 17338*     IF PI-COMPANY-ID = 'DMD'
 17339      IF PI-PROCESSOR-ID <> 'EMER'
 17340         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 17341                                    CERTCARA  CERTGRPA CERTA SUFXA
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 326
* EL131.cbl
 17342
 17343     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 17344                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 17345                                    JNTINITA  JNTAGEA   APRA
 17346                                    LCVCDA    LCVOTRMA  LCVRTRMA
 17347                                    LCVBENEA  LCVFORMA  LCVCNDTA
 17348                                    LCVEXITA  LCVSTATA  LCVKINDA
 17349                                    ACVCDA    ACVOTRMA  ACVRTRMA
 17350                                    ACVBENEA  ACVFORMA  ACVCNDTA
 17351                                    ACVEXITA  ACVSTATA  ACVKINDA
 17352                                    PMTFREQA  INDGRPA   PREMTYPA
 17353                                    REINCDA   LCVRATEA  ACVRATEA
 17354                                    ADDONDTA.
 17355
 17356*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 17357*       IF PI-COMPANY-ID = 'DMD'
 17358*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 17359*                                   SUFXA
 17360*                                   PDAMTA    NODAYSA   NOPMTSA
 17361*                                   INCA      OCCA
 17362*          IF NOT SYSTEM-MODIFY-CAP
 17363*              MOVE AL-SANOF         TO PDTHRUA.
 17364
 17365     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 17366         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 17367
 17368 8125-SKIP-ATTRIBUTE.
 17369
 17370     MOVE SAVE-DATE              TO DATEO.
 17371
 17372* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 17373*    END-EXEC
 17374*    MOVE '0"A                   "   #00014448' TO DFHEIV0
 17375     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 17376     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 17377     MOVE X'2020233030303134343438' TO DFHEIV0(25:11)
 17378     CALL 'kxdfhei1' USING DFHEIV0,
 17379           LCP-CICS-TIME
 17380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17381
 17382* EXEC CICS FORMATTIME
 17383*              ABSTIME(LCP-CICS-TIME)
 17384*              TIME(LCP-TIME-OF-DAY-XX)
 17385*    END-EXEC
 17386*    MOVE 'j$(     (             #   #00014450' TO DFHEIV0
 17387     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 17388     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17389     MOVE X'2020233030303134343530' TO DFHEIV0(25:11)
 17390     CALL 'kxdfhei1' USING DFHEIV0,
 17391           LCP-CICS-TIME,
 17392           LCP-TIME-OF-DAY-XX
 17393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17394     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 17395     MOVE UN-HOURS               TO FOR-HOURS.
 17396     MOVE UN-MINUTES             TO FOR-MINUTES.
 17397     MOVE TIME-OUT               TO TIMEO.
 17398     MOVE PI-COMPANY-ID          TO COMPO.
 17399     MOVE PI-PROCESSOR-ID        TO USERIDO.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 327
* EL131.cbl
 17400     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 17401     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17402     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 17403     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 17404
 17405 8130-EXIT.
 17406     EXIT.
 17407
 17408 8140-check-for-prev-errors.
 17409
 17410     MOVE PI-COMPANY-CD          TO trlr-company-cd
 17411     MOVE PI-CARRIER             TO trlr-carrier
 17412     MOVE PI-CLAIM-NO            TO trlr-claim-no
 17413     MOVE PI-CERT-NO             TO trlr-cert-no
 17414     MOVE +95                    TO TRLR-SEQ-NO
 17415
 17416
 17417* EXEC CICS READ
 17418*       DATASET  ('ELTRLR')
 17419*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17420*       RIDFLD   (TRLR-KEY)
 17421*       RESP     (WS-RESPONSE)
 17422*    END-EXEC
 17423     MOVE 'ELTRLR' TO DFHEIV1
 17424*    MOVE '&"S        E          (  N#00014476' TO DFHEIV0
 17425     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17427     MOVE X'204E233030303134343736' TO DFHEIV0(25:11)
 17428     CALL 'kxdfhei1' USING DFHEIV0,
 17429           DFHEIV1,
 17430           DFHEIV20,
 17431           DFHEIV99,
 17432           TRLR-KEY,
 17433           DFHEIV99,
 17434           DFHEIV99,
 17435           DFHEIV99
 17436     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17437         DFHEIV20
 17438     MOVE EIBRESP  TO WS-RESPONSE
 17439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17440
 17441     if ws-resp-normal
 17442        perform varying s1 from +1 by +1 until
 17443           at-note-error-no (s1) = spaces
 17444           if at-note-error-no (s1) = '1652'
 17445              continue
 17446           else
 17447              move at-note-error-no (s1)
 17448                                 to emi-error
 17449              move -1 to maintl
 17450              if at-note-error-no (s1) = '1653'
 17451                 evaluate true
 17452                    when pi-claim-type = 'L'
 17453                       move '  LF  '
 17454                        to emi-claim-type
 17455                    when pi-claim-type = 'I'
 17456                       move '  IU  '
 17457                        to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 328
* EL131.cbl
 17458                    WHEN PI-CLAIM-TYPE = 'F'
 17459                       MOVE '  FL  '
 17460                        TO EMI-CLAIM-TYPE
 17461                    when other
 17462                       move '  AH  '
 17463                        to emi-claim-type
 17464                 end-evaluate
 17465              end-if
 17466              PERFORM 9900-ERROR-FORMAT
 17467                                 THRU 9900-EXIT
 17468           end-if
 17469*          if at-note-error-no (s1) = '1653'
 17470*             perform varying emi-sub from 1 by 1 until
 17471*                emi-sub > 3
 17472*                if emi-error-number (emi-sub) = '1653'
 17473*                   evaluate true
 17474*                      when pi-claim-type = 'L'
 17475*                         move '  LF  '
 17476*                          to emi-claim-type
 17477*                      when pi-claim-type = 'I'
 17478*                         move '  IU  '
 17479*                          to emi-claim-type
 17480*                      when other
 17481*                         move '  AH  '
 17482*                          to emi-claim-type
 17483*                   end-evaluate
 17484*                end-if
 17485*             end-perform
 17486*          end-if
 17487        end-perform
 17488     else
 17489        display ' resp not normal ' ws-response ' '
 17490        trlr-key (2:19)
 17491     end-if
 17492
 17493     .
 17494 8140-exit.
 17495     exit.
 17496 8150-ENTERED-CLAIM-NOTFOUND.
 17497
 17498     MOVE ER-0204                TO EMI-ERROR.
 17499     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17500     MOVE -1                     TO MAINTL.
 17501     GO TO 8100-SEND-MAP.
 17502
 17503 8200-RETURN-PRIOR.
 17504     MOVE SPACE                  TO PI-RETURN-CD-1.
 17505     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 17506     GO TO 9200-XCTL.
 17507
 17508 8300-GET-HELP.
 17509     MOVE XCTL-EL010             TO CALL-PGM.
 17510     GO TO 9200-XCTL.
 17511
 17512 8400-RETURN-MASTER.
 17513     MOVE SPACE                  TO PI-RETURN-CD-1.
 17514     MOVE XCTL-EL126             TO CALL-PGM.
 17515     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 329
* EL131.cbl
 17516
 17517 8500-TRLR-MNT.
 17518     IF PI-RETURN-CD-1 = 'X'
 17519         MOVE ER-0311            TO EMI-ERROR
 17520         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17521         MOVE -1                 TO MAINTL
 17522         GO TO 8110-SEND-DATA.
 17523
 17524
 17525* EXEC CICS WRITEQ TS
 17526*         QUEUE     (PI-KEY)
 17527*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17528*         LENGTH    (PI-COMM-LENGTH)
 17529*    END-EXEC.
 17530*    MOVE '*"     L              ''   #00014566' TO DFHEIV0
 17531     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17532     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17533     MOVE X'2020233030303134353636' TO DFHEIV0(25:11)
 17534     CALL 'kxdfhei1' USING DFHEIV0,
 17535           PI-KEY,
 17536           PROGRAM-INTERFACE-BLOCK,
 17537           PI-COMM-LENGTH,
 17538           DFHEIV99,
 17539           DFHEIV99,
 17540           DFHEIV99
 17541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17542
 17543
 17544     MOVE XCTL-EL142             TO CALL-PGM.
 17545     GO TO 9200-XCTL.
 17546
 17547 8600-ADDR-MNT.
 17548     IF PI-RETURN-CD-1 = 'X'
 17549         MOVE ER-0311            TO EMI-ERROR
 17550         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17551         MOVE -1                 TO MAINTL
 17552         GO TO 8110-SEND-DATA.
 17553
 17554
 17555* EXEC CICS WRITEQ TS
 17556*         QUEUE     (PI-KEY)
 17557*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17558*         LENGTH    (PI-COMM-LENGTH)
 17559*    END-EXEC.
 17560*    MOVE '*"     L              ''   #00014582' TO DFHEIV0
 17561     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17562     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17563     MOVE X'2020233030303134353832' TO DFHEIV0(25:11)
 17564     CALL 'kxdfhei1' USING DFHEIV0,
 17565           PI-KEY,
 17566           PROGRAM-INTERFACE-BLOCK,
 17567           PI-COMM-LENGTH,
 17568           DFHEIV99,
 17569           DFHEIV99,
 17570           DFHEIV99
 17571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17572
 17573
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 330
* EL131.cbl
 17574     MOVE XCTL-EL141             TO CALL-PGM.
 17575     GO TO 9200-XCTL.
 17576
 17577 8700-CERT-MNT.
 17578     IF PI-RETURN-CD-1 = 'X'
 17579         MOVE ER-7690            TO EMI-ERROR
 17580         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17581         MOVE -1                 TO MAINTL
 17582         GO TO 8110-SEND-DATA.
 17583
 17584
 17585* EXEC CICS WRITEQ TS
 17586*         QUEUE     (PI-KEY)
 17587*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17588*         LENGTH    (PI-COMM-LENGTH)
 17589*    END-EXEC.
 17590*    MOVE '*"     L              ''   #00014598' TO DFHEIV0
 17591     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17592     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17593     MOVE X'2020233030303134353938' TO DFHEIV0(25:11)
 17594     CALL 'kxdfhei1' USING DFHEIV0,
 17595           PI-KEY,
 17596           PROGRAM-INTERFACE-BLOCK,
 17597           PI-COMM-LENGTH,
 17598           DFHEIV99,
 17599           DFHEIV99,
 17600           DFHEIV99
 17601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17602
 17603
 17604     MOVE XCTL-EL1273            TO CALL-PGM.
 17605     GO TO 9200-XCTL.
 17606
 17607 8725-BENEFICIARY-MNT.
 17608     IF PI-RETURN-CD-1 = 'X'
 17609         MOVE ER-0311            TO EMI-ERROR
 17610         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17611         MOVE -1                 TO MAINTL
 17612         GO TO 8110-SEND-DATA.
 17613
 17614
 17615* EXEC CICS WRITEQ TS
 17616*         QUEUE     (PI-KEY)
 17617*         FROM      (EL131AI)
 17618*         LENGTH    (MAP-LENGTH)
 17619*    END-EXEC.
 17620*    MOVE '*"     L              ''   #00014614' TO DFHEIV0
 17621     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17622     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17623     MOVE X'2020233030303134363134' TO DFHEIV0(25:11)
 17624     CALL 'kxdfhei1' USING DFHEIV0,
 17625           PI-KEY,
 17626           EL131AI,
 17627           MAP-LENGTH,
 17628           DFHEIV99,
 17629           DFHEIV99,
 17630           DFHEIV99
 17631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 331
* EL131.cbl
 17632
 17633
 17634
 17635* EXEC CICS WRITEQ TS
 17636*         QUEUE     (PI-KEY)
 17637*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17638*         LENGTH    (PI-COMM-LENGTH)
 17639*    END-EXEC.
 17640*    MOVE '*"     L              ''   #00014620' TO DFHEIV0
 17641     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17642     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17643     MOVE X'2020233030303134363230' TO DFHEIV0(25:11)
 17644     CALL 'kxdfhei1' USING DFHEIV0,
 17645           PI-KEY,
 17646           PROGRAM-INTERFACE-BLOCK,
 17647           PI-COMM-LENGTH,
 17648           DFHEIV99,
 17649           DFHEIV99,
 17650           DFHEIV99
 17651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17652
 17653
 17654     MOVE XCTL-EL114             TO CALL-PGM.
 17655     GO TO 9200-XCTL.
 17656
 17657 8750-DMD-CLM-FIX.
 17658
 17659* EXEC CICS WRITEQ TS
 17660*         QUEUE     (PI-KEY)
 17661*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17662*         LENGTH    (PI-COMM-LENGTH)
 17663*    END-EXEC.
 17664*    MOVE '*"     L              ''   #00014630' TO DFHEIV0
 17665     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17666     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17667     MOVE X'2020233030303134363330' TO DFHEIV0(25:11)
 17668     CALL 'kxdfhei1' USING DFHEIV0,
 17669           PI-KEY,
 17670           PROGRAM-INTERFACE-BLOCK,
 17671           PI-COMM-LENGTH,
 17672           DFHEIV99,
 17673           DFHEIV99,
 17674           DFHEIV99
 17675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17676
 17677
 17678     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17679     GO TO 9200-XCTL.
 17680
 17681 8800-UNAUTHORIZED-ACCESS.
 17682     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17683     GO TO 8990-SEND-TEXT.
 17684
 17685 8810-PF23-ENTERED.
 17686     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 17687     MOVE XCTL-EL005             TO CALL-PGM.
 17688     GO TO 9200-XCTL.
 17689
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 332
* EL131.cbl
 17690 8820-XCTL-ERROR.
 17691
 17692* EXEC CICS HANDLE CONDITION
 17693*        PGMIDERR (8990-SEND-TEXT)
 17694*    END-EXEC.
 17695*    MOVE '"$L                   ! J #00014649' TO DFHEIV0
 17696     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17698     MOVE X'4A20233030303134363439' TO DFHEIV0(25:11)
 17699     CALL 'kxdfhei1' USING DFHEIV0
 17700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17701
 17702
 17703     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17704     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17705     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17706     MOVE XCTL-EL005            TO CALL-PGM.
 17707     GO TO 9200-XCTL.
 17708
 17709 8990-SEND-TEXT.
 17710
 17711* EXEC CICS SEND TEXT
 17712*         FROM      (LOGOFF-TEXT)
 17713*         LENGTH    (LOGOFF-LENGTH)
 17714*         ERASE
 17715*         FREEKB
 17716*    END-EXEC.
 17717*    MOVE '8&      T  E F  H   F -   #00014660' TO DFHEIV0
 17718     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17719     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17720     MOVE X'2020233030303134363630' TO DFHEIV0(25:11)
 17721     CALL 'kxdfhei1' USING DFHEIV0,
 17722           LOGOFF-TEXT,
 17723           LOGOFF-LENGTH,
 17724           DFHEIV99,
 17725           DFHEIV99,
 17726           DFHEIV99,
 17727           DFHEIV99,
 17728           DFHEIV99,
 17729           DFHEIV99,
 17730           DFHEIV99,
 17731           DFHEIV99,
 17732           DFHEIV99,
 17733           DFHEIV99
 17734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17735
 17736
 17737     GO TO 9100-RETURN-CICS.
 17738
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 333
* EL131.cbl
 17740 9000-RETURN-TRANS.
 17741
 17742* EXEC CICS RETURN
 17743*         TRANSID   (TRANS-ID)
 17744*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17745*         LENGTH    (PI-COMM-LENGTH)
 17746*    END-EXEC.
 17747*    MOVE '.(CT                  ''   #00014671' TO DFHEIV0
 17748     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17749     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17750     MOVE X'2020233030303134363731' TO DFHEIV0(25:11)
 17751     CALL 'kxdfhei1' USING DFHEIV0,
 17752           TRANS-ID,
 17753           PROGRAM-INTERFACE-BLOCK,
 17754           PI-COMM-LENGTH,
 17755           DFHEIV99,
 17756           DFHEIV99,
 17757           DFHEIV99
 17758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17759
 17760
 17761
 17762* GOBACK.
 17763     MOVE '9%                    "   ' TO DFHEIV0
 17764     MOVE 'EL131' TO DFHEIV1
 17765     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17766     GOBACK.
 17767
 17768 9100-RETURN-CICS.
 17769
 17770* EXEC CICS RETURN
 17771*    END-EXEC.
 17772*    MOVE '.(                    ''   #00014680' TO DFHEIV0
 17773     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17774     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17775     MOVE X'2020233030303134363830' TO DFHEIV0(25:11)
 17776     CALL 'kxdfhei1' USING DFHEIV0,
 17777           DFHEIV99,
 17778           DFHEIV99,
 17779           DFHEIV99,
 17780           DFHEIV99,
 17781           DFHEIV99,
 17782           DFHEIV99
 17783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17784
 17785
 17786
 17787* GOBACK.
 17788     MOVE '9%                    "   ' TO DFHEIV0
 17789     MOVE 'EL131' TO DFHEIV1
 17790     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17791     GOBACK.
 17792
 17793 9200-XCTL.
 17794
 17795* EXEC CICS XCTL
 17796*         PROGRAM    (CALL-PGM)
 17797*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 334
* EL131.cbl
 17798*         LENGTH     (PI-COMM-LENGTH)
 17799*    END-EXEC.
 17800*    MOVE '.$C                   %   #00014686' TO DFHEIV0
 17801     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17802     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17803     MOVE X'2020233030303134363836' TO DFHEIV0(25:11)
 17804     CALL 'kxdfhei1' USING DFHEIV0,
 17805           CALL-PGM,
 17806           PROGRAM-INTERFACE-BLOCK,
 17807           PI-COMM-LENGTH,
 17808           DFHEIV99
 17809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17810
 17811
 17812 9700-LINK-RTRM-FILE-ID.
 17813
 17814* EXEC CICS LINK
 17815*        PROGRAM  (RTRM-FILE-ID)
 17816*        COMMAREA (CALCULATION-PASS-AREA)
 17817*        LENGTH   (CP-COMM-LENGTH)
 17818*    END-EXEC.
 17819*    MOVE '."C                   (   #00014693' TO DFHEIV0
 17820     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17821     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17822     MOVE X'2020233030303134363933' TO DFHEIV0(25:11)
 17823     CALL 'kxdfhei1' USING DFHEIV0,
 17824           RTRM-FILE-ID,
 17825           CALCULATION-PASS-AREA,
 17826           CP-COMM-LENGTH,
 17827           DFHEIV99,
 17828           DFHEIV99,
 17829           DFHEIV99,
 17830           DFHEIV99
 17831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17832
 17833
 17834 9700-EXIT.
 17835      EXIT.
 17836
 17837 9800-CONVERT-DATE.
 17838     MOVE SPACES TO DC-ERROR-CODE.
 17839
 17840* EXEC CICS LINK
 17841*         PROGRAM    (DATE-CONV)
 17842*         COMMAREA   (DATE-CONVERSION-DATA)
 17843*         LENGTH     (DC-COMM-LENGTH)
 17844*    END-EXEC.
 17845*    MOVE '."C                   (   #00014704' TO DFHEIV0
 17846     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17847     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17848     MOVE X'2020233030303134373034' TO DFHEIV0(25:11)
 17849     CALL 'kxdfhei1' USING DFHEIV0,
 17850           DATE-CONV,
 17851           DATE-CONVERSION-DATA,
 17852           DC-COMM-LENGTH,
 17853           DFHEIV99,
 17854           DFHEIV99,
 17855           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 335
* EL131.cbl
 17856           DFHEIV99
 17857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17858
 17859
 17860 9800-EXIT.
 17861     EXIT.
 17862
 17863 9900-ERROR-FORMAT.
 17864
 17865* EXEC CICS LINK
 17866*         PROGRAM    (XCTL-EL001)
 17867*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17868*         LENGTH     (EMI-COMM-LENGTH)
 17869*    END-EXEC.
 17870*    MOVE '."C                   (   #00014714' TO DFHEIV0
 17871     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17872     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17873     MOVE X'2020233030303134373134' TO DFHEIV0(25:11)
 17874     CALL 'kxdfhei1' USING DFHEIV0,
 17875           XCTL-EL001,
 17876           ERROR-MESSAGE-INTERFACE-BLOCK,
 17877           EMI-COMM-LENGTH,
 17878           DFHEIV99,
 17879           DFHEIV99,
 17880           DFHEIV99,
 17881           DFHEIV99
 17882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17883
 17884
 17885 9900-EXIT.
 17886     EXIT.
 17887
 17888 9990-ABEND.
 17889     MOVE DFHEIBLK               TO EMI-LINE1.
 17890
 17891* EXEC CICS LINK
 17892*         PROGRAM   (XCTL-EL004)
 17893*         COMMAREA  (EMI-LINE1)
 17894*         LENGTH    (72)
 17895*     END-EXEC.
 17896     MOVE 72
 17897       TO DFHEIV11
 17898*    MOVE '."C                   (   #00014725' TO DFHEIV0
 17899     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17900     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17901     MOVE X'2020233030303134373235' TO DFHEIV0(25:11)
 17902     CALL 'kxdfhei1' USING DFHEIV0,
 17903           XCTL-EL004,
 17904           EMI-LINE1,
 17905           DFHEIV11,
 17906           DFHEIV99,
 17907           DFHEIV99,
 17908           DFHEIV99,
 17909           DFHEIV99
 17910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17911
 17912
 17913     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 336
* EL131.cbl
 17914
 17915     GO TO 8110-SEND-DATA.
 17916
 17917 9995-SECURITY-VIOLATION.
 17918*           COPY ELCSCTP.
 17919******************************************************************
 17920*                                                                *
 17921*                            ELCSCTP                             *
 17922*                            VMOD=2.001                          *
 17923*                                                                *
 17924*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17925******************************************************************
 17926
 17927
 17928     MOVE EIBDATE          TO SM-JUL-DATE.
 17929     MOVE EIBTRMID         TO SM-TERMID.
 17930     MOVE THIS-PGM         TO SM-PGM.
 17931     MOVE EIBTIME          TO TIME-IN.
 17932     MOVE TIME-OUT         TO SM-TIME.
 17933     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17934
 17935
 17936* EXEC CICS LINK
 17937*         PROGRAM  ('EL003')
 17938*         COMMAREA (SECURITY-MESSAGE)
 17939*         LENGTH   (80)
 17940*    END-EXEC.
 17941     MOVE 'EL003' TO DFHEIV1
 17942     MOVE 80
 17943       TO DFHEIV11
 17944*    MOVE '."C                   (   #00014753' TO DFHEIV0
 17945     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17946     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17947     MOVE X'2020233030303134373533' TO DFHEIV0(25:11)
 17948     CALL 'kxdfhei1' USING DFHEIV0,
 17949           DFHEIV1,
 17950           SECURITY-MESSAGE,
 17951           DFHEIV11,
 17952           DFHEIV99,
 17953           DFHEIV99,
 17954           DFHEIV99,
 17955           DFHEIV99
 17956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17957
 17958
 17959******************************************************************
 17960
 17961
 17962
 17963 9999-DFHBACK SECTION.
 17964     MOVE '9%                    "   ' TO DFHEIV0
 17965     MOVE 'EL131' TO DFHEIV1
 17966     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17967     GOBACK.
 17968 9999-DFHEXIT.
 17969     IF DFHEIGDJ EQUAL 0001
 17970         NEXT SENTENCE
 17971     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 337
* EL131.cbl
 17972         GO TO 8820-XCTL-ERROR,
 17973               8150-ENTERED-CLAIM-NOTFOUND,
 17974               9990-ABEND
 17975         DEPENDING ON DFHEIGDI
 17976     ELSE IF DFHEIGDJ EQUAL 3
 17977         GO TO 0130-TS-ERROR,
 17978               0130-TS-ERROR
 17979         DEPENDING ON DFHEIGDI
 17980     ELSE IF DFHEIGDJ EQUAL 4
 17981         GO TO 0600-CONTINUE-NAME-UPDATE
 17982         DEPENDING ON DFHEIGDI
 17983     ELSE IF DFHEIGDJ EQUAL 5
 17984         GO TO 1004-BENE-NOT-FOUND
 17985         DEPENDING ON DFHEIGDI
 17986     ELSE IF DFHEIGDJ EQUAL 6
 17987         GO TO 1052-DONE,
 17988               1052-DONE
 17989         DEPENDING ON DFHEIGDI
 17990     ELSE IF DFHEIGDJ EQUAL 7
 17991         GO TO 1120-CNTL-NOTFND
 17992         DEPENDING ON DFHEIGDI
 17993     ELSE IF DFHEIGDJ EQUAL 8
 17994         GO TO 1150-NOTOPEN-ERROR,
 17995               1150-EXIT
 17996         DEPENDING ON DFHEIGDI
 17997     ELSE IF DFHEIGDJ EQUAL 9
 17998         GO TO 1490-STATE-NOTFND
 17999         DEPENDING ON DFHEIGDI
 18000     ELSE IF DFHEIGDJ EQUAL 10
 18001         GO TO 1500-CARR-NOTFND
 18002         DEPENDING ON DFHEIGDI
 18003     ELSE IF DFHEIGDJ EQUAL 11
 18004         GO TO 1620-ACCT-NOTFND
 18005         DEPENDING ON DFHEIGDI
 18006     ELSE IF DFHEIGDJ EQUAL 12
 18007         GO TO 2020-EXIT
 18008         DEPENDING ON DFHEIGDI
 18009     ELSE IF DFHEIGDJ EQUAL 13
 18010         GO TO 2030-EXIT
 18011         DEPENDING ON DFHEIGDI
 18012     ELSE IF DFHEIGDJ EQUAL 14
 18013         GO TO 2040-EXIT
 18014         DEPENDING ON DFHEIGDI
 18015     ELSE IF DFHEIGDJ EQUAL 15
 18016         GO TO 2050-EXIT
 18017         DEPENDING ON DFHEIGDI
 18018     ELSE IF DFHEIGDJ EQUAL 16
 18019         GO TO 2060-CERT-NOTFND
 18020         DEPENDING ON DFHEIGDI
 18021     ELSE IF DFHEIGDJ EQUAL 17
 18022         GO TO 2060-DUPKEY
 18023         DEPENDING ON DFHEIGDI
 18024     ELSE IF DFHEIGDJ EQUAL 18
 18025         GO TO 2070-NOT-FOUND
 18026         DEPENDING ON DFHEIGDI
 18027     ELSE IF DFHEIGDJ EQUAL 19
 18028         GO TO 2070-EXIT
 18029         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 338
* EL131.cbl
 18030     ELSE IF DFHEIGDJ EQUAL 20
 18031         GO TO 2080-EXIT
 18032         DEPENDING ON DFHEIGDI
 18033     ELSE IF DFHEIGDJ EQUAL 21
 18034         GO TO 2400-TRLR-NOTFND,
 18035               2410-EXIT
 18036         DEPENDING ON DFHEIGDI
 18037     ELSE IF DFHEIGDJ EQUAL 22
 18038         GO TO 2425-NINETY-NOTFND,
 18039               2425-NINETY-NOTFND
 18040         DEPENDING ON DFHEIGDI
 18041     ELSE IF DFHEIGDJ EQUAL 23
 18042         GO TO 2430-EXIT,
 18043               2440-EXIT
 18044         DEPENDING ON DFHEIGDI
 18045     ELSE IF DFHEIGDJ EQUAL 24
 18046         GO TO 2440-EXIT
 18047         DEPENDING ON DFHEIGDI
 18048     ELSE IF DFHEIGDJ EQUAL 25
 18049         GO TO 2460-EXIT
 18050         DEPENDING ON DFHEIGDI
 18051     ELSE IF DFHEIGDJ EQUAL 26
 18052         GO TO 2475-EXIT
 18053         DEPENDING ON DFHEIGDI
 18054     ELSE IF DFHEIGDJ EQUAL 27
 18055         GO TO 2650-EXIT
 18056         DEPENDING ON DFHEIGDI
 18057     ELSE IF DFHEIGDJ EQUAL 28
 18058         GO TO 2800-EXIT,
 18059               2800-EXIT
 18060         DEPENDING ON DFHEIGDI
 18061     ELSE IF DFHEIGDJ EQUAL 29
 18062         GO TO 3010-DEL-ACTQ,
 18063               3040-EXIT
 18064         DEPENDING ON DFHEIGDI
 18065     ELSE IF DFHEIGDJ EQUAL 30
 18066         GO TO 3010-NO-ACTIVITY,
 18067               3050-EXIT
 18068         DEPENDING ON DFHEIGDI
 18069     ELSE IF DFHEIGDJ EQUAL 31
 18070         GO TO 3010-CERT-NOT-FOUND
 18071         DEPENDING ON DFHEIGDI
 18072     ELSE IF DFHEIGDJ EQUAL 32
 18073         GO TO 3020-EXIT
 18074         DEPENDING ON DFHEIGDI
 18075     ELSE IF DFHEIGDJ EQUAL 33
 18076         GO TO 3060-EXIT,
 18077               3060-EXIT
 18078         DEPENDING ON DFHEIGDI
 18079     ELSE IF DFHEIGDJ EQUAL 34
 18080         GO TO 5000-TRLR-NOT-FOUND
 18081         DEPENDING ON DFHEIGDI
 18082     ELSE IF DFHEIGDJ EQUAL 35
 18083         GO TO 5000-CERT-NOT-FOUND
 18084         DEPENDING ON DFHEIGDI
 18085     ELSE IF DFHEIGDJ EQUAL 36
 18086         GO TO 1052-DONE,
 18087               1052-DONE
* Micro Focus Server Express         V5.1 revision 000 29-May-18 13:07 Page 339
* EL131.cbl
 18088         DEPENDING ON DFHEIGDI
 18089     ELSE IF DFHEIGDJ EQUAL 37
 18090         GO TO 7630-END-BROWSE
 18091         DEPENDING ON DFHEIGDI
 18092     ELSE IF DFHEIGDJ EQUAL 38
 18093         GO TO 7799-EXIT,
 18094               7799-EXIT
 18095         DEPENDING ON DFHEIGDI
 18096     ELSE IF DFHEIGDJ EQUAL 39
 18097         GO TO 7799-EXIT
 18098         DEPENDING ON DFHEIGDI
 18099     ELSE IF DFHEIGDJ EQUAL 40
 18100         GO TO 7800-NOT-FOUND
 18101         DEPENDING ON DFHEIGDI
 18102     ELSE IF DFHEIGDJ EQUAL 41
 18103         GO TO 8000-NOTE-NOT-FOUND
 18104         DEPENDING ON DFHEIGDI
 18105     ELSE IF DFHEIGDJ EQUAL 42
 18106         GO TO 8990-SEND-TEXT
 18107         DEPENDING ON DFHEIGDI.
 18108     MOVE '9%                    "   ' TO DFHEIV0
 18109     MOVE 'EL131' TO DFHEIV1
 18110     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18111     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14236     Code:       64039
