* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page   1
* EL201.cbl
* Options: int("EL201.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL201.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL201.
    10*
    11*AUTHOR.    Pablo.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page   2
* EL201.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  Post check number and check written date to refund checks ***
    17***                                                            ***
    18***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 011714  CR2013053000001  PEMA  NEW PROGRAM
    28* 022014  IR2014022000001  PEMA  chg process when file is empty
    29* 082014  IR2014081400001  PEMA  bypass manual request checks
    30* 082014  IR2015082100001  PEMA  bypass more manual request checks
    31* 092215  IR2015092200001  PEMA  modify determination of manual ch
    32* 091615  CR2015082000001  PEMA  Add Endorsement check processing
    33* 020816  IR2016020500001  PEMA  Add env to unikix cmd for cid1p
    34* 042517  IR2017042500001  PEMA  Reduce number of print lines per
    35* 060717  CR2017032900002  PEMA  CHANGE TEST DB
    36* 030921  CR2019012500003  PEMA  Connect to sdv-db01.cso.local
    37* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    38 environment division.
    39 INPUT-OUTPUT SECTION.
    40 FILE-CONTROL.
    41 SELECT CPS-WRITTEN-IN ASSIGN TO dynamic ws-written-in
    42    FILE STATUS IS WRITTEN-STATUS
    43                            ORGANIZATION IS LINE SEQUENTIAL.
    44 SELECT CPS-WRITTEN-RPT ASSIGN TO dynamic ws-written-rpt
    45    FILE STATUS IS WRITRPT-STATUS
    46                            ORGANIZATION IS LINE SEQUENTIAL.
    47 data division.
    48 FILE SECTION.
    49 FD  CPS-WRITTEN-IN
    50     BLOCK CONTAINS 0
    51     RECORDING MODE F.
    52 01  CPS-WRITTEN-IN-REC          pic x(200).
    53 FD  CPS-WRITTEN-RPT
    54     BLOCK CONTAINS 0
    55     RECORDING MODE F.
    56 01  CPS-WRITTEN-RPT-REC         pic x(132).
    57 working-storage section.
    58 01  DFH-START PIC X(04).
    59 77  ws-process-sw               pic x value ' '.
    60     88  process-cashed            value 'C'.
    61     88  process-written           value 'W'.
    62 77  ws-writ-cnt                 pic 9(5) value zeros.
    63 77  ws-tot-writ-amt             pic s9(9)v99 comp-3 value +0.
    64 77  s1                          pic s999 comp-3 value +0.
    65 77  s2                          pic s999 comp-3 value +0.
    66 77  i1                          pic s999 comp-3 value +0.
    67 77  o1                          pic s999 comp-3 value +0.
    68 77  ws-bin-cashed-dt            pic xx  value low-values.
    69 77  ws-bin-check-dt             pic xx  value low-values.
    70 77  ws-page-cntr                pic 999  value zeros.
    71 77  ws-line-cntr                pic 999  value 070.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page   3
* EL201.cbl
    72 77  ws-max-lines                pic 999  value 055.
    73 77  ws-erchek-sw                pic x    value spaces.
    74     88  erchek-found              value 'Y'.
    75 77  ws-table-sw                 pic x    value spaces.
    76     88  table-found               value 'Y'.
    77 77  ws-continue-sw              pic x  value 'Y'.
    78     88  ok-to-continue            value 'Y'.
    79     88  not-ok-to-continue        value 'N'.
    80 77  ws-in-recs                  pic 9(5) value zeros.
    81 77  ws-eof-sw                   pic x  value spaces.
    82     88  end-of-input                  value 'Y'.
    83 77  ws-sql-code                 pic s9(7) value zeros.
    84 77  ws-dis-sql-code             pic -9999999 value zeros.
    85 01  ws-work-dynamic.
    86     05  ws-work-dir             pic x(27) value spaces.
    87     05  ws-work-env             pic x(8)  value spaces.
    88     05  ws-work-comp-id         pic xxx   value spaces.
    89     05  ws-work-file-in         pic x(16) value spaces.
    90     05  ws-work-rpt-out         pic x(13) value spaces.
    91     05  ws-work-job-name        pic x(8)  value spaces.
    92 01  ws-written-in               pic x(58).
    93 01  ws-written-rpt              pic x(58).
    94 01  P pointer.
    95 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    96 01  var-ptr pointer.
    97 01  env-var-len                 pic 9(4)  binary.
    98 01  rc                          pic 9(9)  binary.
    99
   100 01  WS-KIXSYS.
   101     05  WS-KIX-FIL1             PIC X(10).
   102     05  WS-KIX-APPS             PIC X(10).
   103     05  WS-KIX-ENV              PIC X(10).
   104     05  WS-KIX-MYENV            PIC X(10).
   105     05  WS-KIX-SYS              PIC X(10).
*  106 EXEC SQL
*  107    INCLUDE SQLDA
*  108 END-EXEC
   109 01 SQLDA sync.
   110    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   111    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   112    05 SQLN                  PIC S9(4) COMP-5 value 0.
   113    05 SQLD                  PIC S9(4) COMP-5 value 0.
   114    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   115       10 SQLTYPE            PIC S9(4) COMP-5.
   116       10 SQLLEN             PIC S9(4) COMP-5.
   117$IF P64 SET
   118X      *> For 64-bit environments, ensure that SQLDATA is
   119X      *> aligned on an 8-byte boundary.
   120X      10 FILLER             PIC S9(9) COMP-5.
   121$END
   122       10 SQLDATA            USAGE POINTER.
   123       10 SQLIND             USAGE POINTER.
   124       10 SQLNAME.
   125          15 SQLNAMEL        PIC S9(4) COMP-5.
   126          15 SQLNAMEC        PIC X(30).
   127
   128* Values for SQLTYPE
   129
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page   4
* EL201.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-DATE-CHAR              VALUE 384.
   131 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   132 78  ESQL-DATE-REC               VALUE 386.
   133 78  ESQL-DATE-REC-NULL          VALUE 387.
   134 78  ESQL-TIME-CHAR              VALUE 388.
   135 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   136 78  ESQL-TIME-REC               VALUE 390.
   137 78  ESQL-TIME-REC-NULL          VALUE 391.
   138 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   139 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   140 78  ESQL-TIMESTAMP-REC          VALUE 394.
   141 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   142 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   143 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   144 78  ESQL-TS-OFFSET-REC          VALUE 398.
   145 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   146 78  ESQL-LONGVARBINARY          VALUE 404.
   147 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   148 78  ESQL-LONGVARCHAR            VALUE 408.
   149 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   150 78  ESQL-BINARY                 VALUE 444.
   151 78  ESQL-BINARY-NULL            VALUE 445.
   152 78  ESQL-VARBINARY              VALUE 446.
   153 78  ESQL-VARBINARY-NULL         VALUE 447.
   154 78  ESQL-VARCHAR                VALUE 448.
   155 78  ESQL-VARCHAR-NULL           VALUE 449.
   156
   157 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   158 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   159
   160 78  ESQL-CHAR                   VALUE 452.
   161 78  ESQL-CHAR-NULL              VALUE 453.
   162
   163 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   164 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   165
   166 78  ESQL-DOUBLE                 VALUE 480.
   167 78  ESQL-DOUBLE-NULL            VALUE 481.
   168 78  ESQL-REAL                   VALUE 482.
   169 78  ESQL-REAL-NULL              VALUE 483.
   170 78  ESQL-DECIMAL                VALUE 484.
   171 78  ESQL-DECIMAL-NULL           VALUE 485.
   172 78  ESQL-INTEGER                VALUE 496.
   173 78  ESQL-INTEGER-NULL           VALUE 497.
   174 78  ESQL-SMALLINT               VALUE 500.
   175 78  ESQL-SMALLINT-NULL          VALUE 501.
   176 78  ESQL-TINYINT                VALUE 502.
   177 78  ESQL-TINYINT-NULL           VALUE 503.
*  178 EXEC SQL
*  179    INCLUDE SQLCA
*  180 END-EXEC
   181 01 SQLCA.
   182     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   183     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   184     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   185     05  SQLERRM.
   186         49  SQLERRML    PIC S9(4) COMP-5.
   187         49  SQLERRMC    PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page   5
* EL201.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188     05  SQLERRP         PIC X(8).
   189     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   190     05  SQLWARN.
   191         10  SQLWARN0    PIC X.
   192         10  SQLWARN1    PIC X.
   193         10  SQLWARN2    PIC X.
   194         10  SQLWARN3    PIC X.
   195         10  SQLWARN4    PIC X.
   196         10  SQLWARN5    PIC X.
   197         10  SQLWARN6    PIC X.
   198         10  SQLWARN7    PIC X.
   199     05  SQLEXT.
   200         10  SQLWARN8    PIC X.
   201         10  SQLWARN9    PIC X.
   202         10  SQLWARN10   PIC X.
   203         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   204     05  SQLSTATE    PIC X(5).
   205 EXEC SQL
   206    BEGIN DECLARE SECTION
   207 END-EXEC
   208 01  ws-key-stuff.
   209     05  ws-check-key            pic 9(7).
   210     05  ws-check-no             pic x(7).
   211     05  ws-compid               pic xxx.
   212     05  ws-carrier              pic x.
   213     05  ws-grouping             pic x(6).
   214     05  ws-state                pic xx.
   215     05  ws-account              pic x(10).
   216     05  ws-eff-date             pic x(10).
   217     05  ws-certificate          pic x(10).
   218     05  ws-cert-sfx             pic x.
   219     05  ws-seq-no               pic 999.
   220     05  ws-type                 pic 999.
   221 01  sqlcmd                      pic x(1024).
   222 01  WS-MOE-DATE                 pic x(10).
   223 01  svr                         pic x(32).
   224 01  usr                         pic x(32).
   225 01  pass                        pic x(32).
   226 01  usr-pass                    pic x(64).
   227 01  ws-disp-code                pic s9(11).
   228***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   229***                                                            ***
   230***  These indicators are used to determine if a variable      ***
   231***  is passed nulls from sql. The indicator will be -1        ***
   232***  if the value on sql is nulls and +0 if the value is       ***
   233***  something other than nulls. Here is an example on how     ***
   234***  to use the indicator variables.                           ***
   235***                                                            ***
   236***     EXEC SQL                                               ***
   237***        fetch checkapp into                                 ***
   238***           :db-app-status :nu-app-status,                   ***
   239***           :db-app-by     :nu-app-by,                       ***
   240***           :db-app-date   :nu-app-date,                     ***
   241***           :db-app-batch  :nu-app-batch                     ***
   242***     END-EXEC                                               ***
   243***                                                            ***
   244***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   245 01  indicator-vaiables-for-nulls.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page   6
* EL201.cbl
   246     05  nu-app-status           pic s9(4) comp value +0.
   247     05  nu-app-by               pic s9(4) comp value +0.
   248     05  nu-app-date             pic s9(4) comp value +0.
   249     05  nu-app-batch            pic s9(4) comp value +0.
   250     05  nu-fincar               pic s9(4) comp value +0.
   251     05  nu-checkno              pic s9(4) comp value +0.
   252 01  daily-check-request-rec.
   253     05  db-checkkey             pic x(7).
   254     05  db-compid               pic xxx.
   255     05  db-carrier              pic x.
   256     05  db-grouping             pic x(6).
   257     05  db-state                pic xx.
   258     05  db-account              pic x(10).
   259     05  db-effdate              pic x(24).
   260     05  db-certificate          pic x(10).
   261     05  db-cert-sfx             pic x.
   262     05  db-seq-no               pic x(7).
   263     05  db-type                 pic x(7).
   264     05  db-amount               pic x(10).
   265     05  db-amount-n redefines
   266         db-amount               pic 9(7).99.
   267     05  db-checkno              pic x(15).
   268     05  db-checkdate            pic x(10).
   269     05  db-checkstatus          pic 9(5).
   270     05  db-releasebatch         pic 9(5).
   271     05  db-releasedt            pic x(10).
   272     05  db-releaseby            pic x(4).
   273     05  db-payeename1           pic x(30).
   274     05  db-payeename2           pic x(30).
   275     05  db-payeeaddr1           pic x(30).
   276     05  db-payeeaddr2           pic x(30).
   277     05  db-payeecity            pic x(30).
   278     05  db-payeest              pic xx.
   279     05  db-payeezip             pic x(10).
   280     05  db-fincar               pic x.
   281     05  db-fingrp               pic x(6).
   282     05  db-finresp              pic x(10).
   283     05  db-finacct              pic x(10).
   284     05  db-preparer             pic x(4).
   285     05  db-app-status           pic x(9).
   286     05  dp-app-status-n redefines db-app-status
   287                                 pic 9(9).
   288     05  db-app-by               pic x(20).
   289     05  db-app-date             pic x(30).
   290     05  db-app-batch            pic x(10).
   291     05  db-return-to            pic x(30).
   292     05  db-check-sub-type       pic x.
   293 EXEC SQL
   294    END DECLARE SECTION
   295 END-EXEC
   296 01  FILE-KEYS.
   297     12  ELCNTL-KEY.
   298         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   299         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   300         16 ELCNTL-ACCESS.
   301             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   302             20  FILLER              PIC X       VALUE SPACES.
   303             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page   7
* EL201.cbl
   304         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   305 01  f.
   306     05  ws-connect-sw               pic x  value ' '.
   307         88  connected-to-db             value 'Y'.
   308     05  written-status          pic xx.
   309     05  writrpt-status          pic xx.
   310     05  ws-comp-id              pic xxx.
   311     05  ws-comp-cd              pic x.
   312 01  ws-raw-record.
   313     05  raw-check-no            pic x(20).
   314     05  raw-check-dt            pic x(20).
   315     05  raw-check-amt           pic x(15).
   316     05  raw-vendor-id           pic x(20).
   317     05  raw-user-defined        pic x(30).
   318     05  raw-voucher-ref         pic x(35).
   319 01  ws-written-rec.
   320     05  wsw-check-no            pic x(20).
   321     05  wsw-check-dt            pic x(20).
   322     05  wsw-check-amt           pic x(15).
   323     05  wsw-vendor-id           pic x(20).
   324     05  wsw-user-defined        pic x(30).
   325     05  wsw-voucher-ref         pic x(35).
   326 01  filler.
   327     05  wsw-check-key           pic x(7).
   328     05  wsw-check-key-num redefines wsw-check-key
   329                                 pic 9(7).
   330 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   331     88  RESP-NORMAL                    VALUE +0.
   332     88  resp-file-notfnd               value +12.
   333     88  RESP-NOTFND                    VALUE +13.
   334     88  resp-duprec                    value +14.
   335     88  resp-dupkey                    value +15.
   336     88  resp-invreq                    value +16.
   337     88  RESP-NOTOPEN                   VALUE +19.
   338     88  RESP-ENDFILE                   VALUE +20.
   339     88  resp-lengtherr                 value +22.
   340 01  ws-work-amt-alpha           pic x(10).
   341 01  ws-work-amt-num redefines ws-work-amt-alpha
   342                                 pic 9(8)v99.
   343 01  ws-qry-string               pic x(80) value spaces.
   344 01  ws-qrystr-len               pic s9(8) comp value +60.
   345 01  ws-seq-alpha                pic x(5).
   346 01  ws-seq-no-num redefines ws-seq-alpha
   347                                 pic 9(5).
   348*                                copy ERCCHEK.
   349******************************************************************
   350*                                                                *
   351*                                                                *
   352*                            ERCCHEK                             *
   353*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   354*                            VMOD=2.008                          *
   355*                                                                *
   356*   FILE DESCRIPTION = CHECK RECORDS                             *
   357*                                                                *
   358*   FILE TYPE = VSAM,KSDS                                        *
   359*   RECORD SIZE = 600    RECFORM = FIXED                         *
   360*                                                                *
   361*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page   8
* EL201.cbl
   362*       ALTERNATE INDEX = NONE                                   *
   363*                                                                *
   364*   LOG = YES                                                    *
   365*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   366******************************************************************
   367*                   C H A N G E   L O G
   368*
   369* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   370*-----------------------------------------------------------------
   371*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   372* EFFECTIVE    NUMBER
   373*-----------------------------------------------------------------
   374* 021414    2003053000001  PEMA  changes for auto chk request
   375******************************************************************
   376 01  CHECK-RECORDS.
   377     12  CH-RECORD-ID                      PIC XX.
   378         88  VALID-CH-ID                      VALUE 'CH'.
   379
   380     12  CH-CONTROL-PRIMARY.
   381         16  CH-COMPANY-CD                 PIC X.
   382         16  CH-CARRIER                    PIC X.
   383         16  CH-GROUPING                   PIC X(6).
   384         16  CH-STATE                      PIC XX.
   385         16  CH-ACCOUNT                    PIC X(10).
   386         16  CH-CERT-EFF-DT                PIC XX.
   387         16  CH-CERT-NO.
   388             20  CH-CERT-PRIME             PIC X(10).
   389             20  CH-CERT-SFX               PIC X.
   390         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
   391
   392     12  CH-RECORDED-DT                    PIC XX.
   393     12  CH-RECORDED-BY                    PIC X(4).
   394     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
   395
   396     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
   397     12  CH-CHECK-NO                       PIC X(7).
   398     12  CH-REASON-FOR-CHECK               PIC X(25).
   399     12  CH-CHECK-WRITTEN-DT               PIC XX.
   400     12  FILLER                            PIC X.
   401
   402     12  CH-PAYEE-INFO.
   403         16  CH-PAYEE-NAME-1               PIC X(30).
   404         16  CH-PAYEE-NAME-2               PIC X(30).
   405         16  CH-PAYEE-ADDRESS-1            PIC X(30).
   406         16  CH-PAYEE-ADDRESS-2            PIC X(30).
   407         16  CH-PAYEE-CITY-ST.
   408             20  CH-PAYEE-CITY             PIC X(28).
   409             20  CH-PAYEE-STATE            PIC XX.
   410         16  CH-PAYEE-ZIP-CODE.
   411             20  CH-PAYEE-ZIP.
   412                 24  CH-ZIP-PRI-1ST        PIC X.
   413                     88  CH-CANADIAN-POST-CODE
   414                                           VALUES 'A' THRU 'Z'.
   415                 24  FILLER                PIC X(4).
   416             20  CH-PAYEE-ZIP-EXT          PIC X(4).
   417         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
   418             20  CH-CAN-POSTAL-1           PIC XXX.
   419             20  CH-CAN-POSTAL-2           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page   9
* EL201.cbl
   420             20  FILLER                    PIC XXX.
   421
   422     12  CH-CHECK-STUB-TEXT.
   423         16  CH-STUB-LINE-1                PIC X(30).
   424         16  CH-TEXT-LINE-1                PIC X(50).
   425         16  CH-TEXT-LINE-2                PIC X(50).
   426         16  CH-TEXT-LINE-3                PIC X(40).
   427     12  CH-RETURN-TO                      PIC X(30).
   428
   429     12  CH-COMPENSATION-CONTROL.
   430         16  CH-COMP-CARRIER               PIC X.
   431         16  CH-COMP-GROUPING              PIC X(6).
   432         16  CH-COMP-FIN-RESP              PIC X(10).
   433         16  CH-COMP-ACCOUNT               PIC X(10).
   434
   435     12  CH-CREDIT-SELECT-DT               PIC XX.
   436     12  CH-CREDIT-ACCEPT-DT               PIC XX.
   437     12  CH-PAYEE-CODE                     PIC X(6).
   438
   439     12  CH-VOID-DATA.
   440         20  CH-VOID-DT                    PIC XX.
   441         20  CH-VOID-BY                    PIC X(4).
   442         20  CH-VOID-REASON                PIC X(25).
   443
   444     12  CH-APPROVAL-DATA.
   445         20  CH-APPROVAL-DT                PIC XX.
   446         20  CH-APPROVAL-STATUS            PIC X.
   447             88  CH-IN-LIMBO                  VALUE ' '.
   448             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   449             88  CH-APPROVED                  VALUE 'A'.
   450             88  CH-DENIED                    VALUE 'D'.
   451         20  CH-APPROVED-BY                PIC XXXX.
   452     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
   453             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   454     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
   455
   456     12  ch-released-dt                    pic xx.
   457     12  ch-check-cashed-dt                pic xx.
   458     12  FILLER                            PIC X.
   459*    12  CH-CHECK-REFERENCE                PIC X(12).
   460     12  CH-CHECK-ORIGIN-SW                PIC X.
   461             88  CH-REFUND-CHECK              VALUE 'R'.
   462             88  CH-MAINT-CHECK               VALUE 'M'.
   463
   464     12  CH-CANC-DT                        PIC XX.
   465     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
   466     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
   467
   468     12  CH-INSURED-NAME                   PIC X(28).
   469
   470     12  ch-released-by                    pic x(4).
   471     12  ch-csr                            pic x(4).
   472     12  ch-deduct-commission              pic x.
   473         88  ch-deduct-comm                  value 'Y'.
   474         88  ch-do-not-deduct-comm           value 'N'.
   475
   476     12  FILLER                            PIC X(11).
   477*    12  CH-LETTER-TABLE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  10
* EL201.cbl
   478*        16  CH-LETTERS OCCURS 3 TIMES
   479*                       INDEXED BY CH-LT-NDX
   480*                                          PIC X(04).
   481
   482     12  FILLER                            PIC X(07).
   483
   484*                                copy ELCFUNDT.
   485*****************************************************************
   486*                                                               *
   487*                            ELCFUNDT.                          *
   488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   489*                            VMOD=2.001                         *
   490*                                                               *
   491*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   492*                                                               *
   493*****************************************************************
   494
   495
   496 01  FUNCTION-DATE.
   497     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   498     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   499         10  WS-FN-CCYR            PIC 9(4).
   500         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   501             15  WS-FN-CC          PIC 99.
   502             15  WS-FN-YR          PIC 99.
   503         10  WS-FN-MO              PIC 99.
   504         10  WS-FN-DA              PIC 99.
   505     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   506     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   507     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   508     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   509     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   510         88  WS-BEHIND-GMT                     VALUE '-'.
   511         88  WS-AFTER-GMT                      VALUE '+'.
   512         88  WS-NO-GMT                         VALUE ZERO.
   513     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   514     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   515*                                COPY ELCDATE.
   516******************************************************************
   517*                                                                *
   518*                                                                *
   519*                            ELCDATE.                            *
   520*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   521*                            VMOD=2.003
   522*                                                                *
   523*                                                                *
   524*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   525*                 LENGTH = 200                                   *
   526******************************************************************
   527
   528 01  DATE-CONVERSION-DATA.
   529     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   530     12  DC-OPTION-CODE                PIC X.
   531         88  BIN-TO-GREG                VALUE ' '.
   532         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   533         88  EDIT-GREG-TO-BIN           VALUE '2'.
   534         88  YMD-GREG-TO-BIN            VALUE '3'.
   535         88  MDY-GREG-TO-BIN            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  11
* EL201.cbl
   536         88  JULIAN-TO-BIN              VALUE '5'.
   537         88  BIN-PLUS-ELAPSED           VALUE '6'.
   538         88  FIND-CENTURY               VALUE '7'.
   539         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   540         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   541         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   542         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   543         88  JULIAN-TO-BIN-3            VALUE 'C'.
   544         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   545         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   546         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   547         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   548         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   549         88  CHECK-LEAP-YEAR            VALUE 'H'.
   550         88  BIN-3-TO-GREG              VALUE 'I'.
   551         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   552         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   553         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   554         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   555         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   556         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   557         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   558         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   559         88  THREE-CHARACTER-BIN
   560                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   561         88  GREGORIAN-TO-BIN
   562                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   563         88  BIN-TO-GREGORIAN
   564                  VALUES ' ' '1' 'I' '8' 'G'.
   565         88  JULIAN-TO-BINARY
   566                  VALUES '5' 'C' 'E' 'F'.
   567     12  DC-ERROR-CODE                 PIC X.
   568         88  NO-CONVERSION-ERROR        VALUE ' '.
   569         88  DATE-CONVERSION-ERROR
   570                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   571         88  DATE-IS-ZERO               VALUE '1'.
   572         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   573         88  DATE-IS-INVALID            VALUE '3'.
   574         88  DATE1-GREATER-DATE2        VALUE '4'.
   575         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   576         88  DATE-INVALID-OPTION        VALUE '9'.
   577         88  INVALID-CENTURY            VALUE 'A'.
   578         88  ONLY-CENTURY               VALUE 'B'.
   579         88  ONLY-LEAP-YEAR             VALUE 'C'.
   580         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   581     12  DC-END-OF-MONTH               PIC X.
   582         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   583     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   584         88  USE-NORMAL-PROCESS         VALUE ' '.
   585         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   586         88  ADJUST-UP-100-YRS          VALUE '2'.
   587     12  FILLER                        PIC X.
   588     12  DC-CONVERSION-DATES.
   589         16  DC-BIN-DATE-1             PIC XX.
   590         16  DC-BIN-DATE-2             PIC XX.
   591         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   592         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   593                       DC-GREG-DATE-1-EDIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  12
* EL201.cbl
   594             20  DC-EDIT1-MONTH        PIC 99.
   595             20  SLASH1-1              PIC X.
   596             20  DC-EDIT1-DAY          PIC 99.
   597             20  SLASH1-2              PIC X.
   598             20  DC-EDIT1-YEAR         PIC 99.
   599         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   600         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   601                     DC-GREG-DATE-2-EDIT.
   602             20  DC-EDIT2-MONTH        PIC 99.
   603             20  SLASH2-1              PIC X.
   604             20  DC-EDIT2-DAY          PIC 99.
   605             20  SLASH2-2              PIC X.
   606             20  DC-EDIT2-YEAR         PIC 99.
   607         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   608         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   609                     DC-GREG-DATE-1-YMD.
   610             20  DC-YMD-YEAR           PIC 99.
   611             20  DC-YMD-MONTH          PIC 99.
   612             20  DC-YMD-DAY            PIC 99.
   613         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   614         16  DC-GREG-DATE-1-MDY-R REDEFINES
   615                      DC-GREG-DATE-1-MDY.
   616             20  DC-MDY-MONTH          PIC 99.
   617             20  DC-MDY-DAY            PIC 99.
   618             20  DC-MDY-YEAR           PIC 99.
   619         16  DC-GREG-DATE-1-ALPHA.
   620             20  DC-ALPHA-MONTH        PIC X(10).
   621             20  DC-ALPHA-DAY          PIC 99.
   622             20  FILLER                PIC XX.
   623             20  DC-ALPHA-CENTURY.
   624                 24 DC-ALPHA-CEN-N     PIC 99.
   625             20  DC-ALPHA-YEAR         PIC 99.
   626         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   627         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   628         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   629         16  DC-JULIAN-DATE            PIC 9(05).
   630         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   631                                       PIC 9(05).
   632         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   633             20  DC-JULIAN-YEAR        PIC 99.
   634             20  DC-JULIAN-DAYS        PIC 999.
   635         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   636         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   637         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   638     12  DATE-CONVERSION-VARIBLES.
   639         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   640         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   641             20  FILLER                PIC 9(3).
   642             20  HOLD-CEN-1-CCYY.
   643                 24  HOLD-CEN-1-CC     PIC 99.
   644                 24  HOLD-CEN-1-YY     PIC 99.
   645             20  HOLD-CEN-1-MO         PIC 99.
   646             20  HOLD-CEN-1-DA         PIC 99.
   647         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   648             20  HOLD-CEN-1-R-MO       PIC 99.
   649             20  HOLD-CEN-1-R-DA       PIC 99.
   650             20  HOLD-CEN-1-R-CCYY.
   651                 24  HOLD-CEN-1-R-CC   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  13
* EL201.cbl
   652                 24  HOLD-CEN-1-R-YY   PIC 99.
   653             20  FILLER                PIC 9(3).
   654         16  HOLD-CENTURY-1-X.
   655             20  FILLER                PIC X(3)  VALUE SPACES.
   656             20  HOLD-CEN-1-X-CCYY.
   657                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   658                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   659             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   660             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   661         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   662             20  HOLD-CEN-1-R-X-MO     PIC XX.
   663             20  HOLD-CEN-1-R-X-DA     PIC XX.
   664             20  HOLD-CEN-1-R-X-CCYY.
   665                 24  HOLD-CEN-1-R-X-CC PIC XX.
   666                 24  HOLD-CEN-1-R-X-YY PIC XX.
   667             20  FILLER                PIC XXX.
   668         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   669         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   670         16  DC-JULIAN-DATE-1          PIC 9(07).
   671         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   672             20  DC-JULIAN-1-CCYY.
   673                 24  DC-JULIAN-1-CC    PIC 99.
   674                 24  DC-JULIAN-1-YR    PIC 99.
   675             20  DC-JULIAN-DA-1        PIC 999.
   676         16  DC-JULIAN-DATE-2          PIC 9(07).
   677         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   678             20  DC-JULIAN-2-CCYY.
   679                 24  DC-JULIAN-2-CC    PIC 99.
   680                 24  DC-JULIAN-2-YR    PIC 99.
   681             20  DC-JULIAN-DA-2        PIC 999.
   682         16  DC-GREG-DATE-A-EDIT.
   683             20  DC-EDITA-MONTH        PIC 99.
   684             20  SLASHA-1              PIC X VALUE '/'.
   685             20  DC-EDITA-DAY          PIC 99.
   686             20  SLASHA-2              PIC X VALUE '/'.
   687             20  DC-EDITA-CCYY.
   688                 24  DC-EDITA-CENT     PIC 99.
   689                 24  DC-EDITA-YEAR     PIC 99.
   690         16  DC-GREG-DATE-B-EDIT.
   691             20  DC-EDITB-MONTH        PIC 99.
   692             20  SLASHB-1              PIC X VALUE '/'.
   693             20  DC-EDITB-DAY          PIC 99.
   694             20  SLASHB-2              PIC X VALUE '/'.
   695             20  DC-EDITB-CCYY.
   696                 24  DC-EDITB-CENT     PIC 99.
   697                 24  DC-EDITB-YEAR     PIC 99.
   698         16  DC-GREG-DATE-CYMD         PIC 9(08).
   699         16  DC-GREG-DATE-CYMD-R REDEFINES
   700                              DC-GREG-DATE-CYMD.
   701             20  DC-CYMD-CEN           PIC 99.
   702             20  DC-CYMD-YEAR          PIC 99.
   703             20  DC-CYMD-MONTH         PIC 99.
   704             20  DC-CYMD-DAY           PIC 99.
   705         16  DC-GREG-DATE-MDCY         PIC 9(08).
   706         16  DC-GREG-DATE-MDCY-R REDEFINES
   707                              DC-GREG-DATE-MDCY.
   708             20  DC-MDCY-MONTH         PIC 99.
   709             20  DC-MDCY-DAY           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  14
* EL201.cbl
   710             20  DC-MDCY-CEN           PIC 99.
   711             20  DC-MDCY-YEAR          PIC 99.
   712    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   713        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   714    12  DC-EL310-DATE                  PIC X(21).
   715    12  FILLER                         PIC X(28).
   716*                                COPY ELCCNTL.
   717******************************************************************
   718*                                                                *
   719*                                                                *
   720*                            ELCCNTL.                            *
   721*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   722*                            VMOD=2.059                          *
   723*                                                                *
   724*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   725*                                                                *
   726*   FILE TYPE = VSAM,KSDS                                        *
   727*   RECORD SIZE = 750  RECFORM = FIXED                           *
   728*                                                                *
   729*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   730*       ALTERNATE INDEX = NONE                                   *
   731*                                                                *
   732*   LOG = YES                                                    *
   733*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   734******************************************************************
   735*                   C H A N G E   L O G
   736*
   737* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   738*-----------------------------------------------------------------
   739*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   740* EFFECTIVE    NUMBER
   741*-----------------------------------------------------------------
   742* 082503                   PEMA  ADD BENEFIT GROUP
   743* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   744* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   745* 092705    2005050300006  PEMA  ADD SPP LEASES
   746* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   747* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   748* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   749* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   750* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   751* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   752* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   753* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   754* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   755* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   756* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
   757******************************************************************
   758*
   759 01  CONTROL-FILE.
   760     12  CF-RECORD-ID                       PIC XX.
   761         88  VALID-CF-ID                        VALUE 'CF'.
   762
   763     12  CF-CONTROL-PRIMARY.
   764         16  CF-COMPANY-ID                  PIC XXX.
   765         16  CF-RECORD-TYPE                 PIC X.
   766             88  CF-COMPANY-MASTER              VALUE '1'.
   767             88  CF-PROCESSOR-MASTER            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  15
* EL201.cbl
   768             88  CF-STATE-MASTER                VALUE '3'.
   769             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   770             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   771             88  CF-CARRIER-MASTER              VALUE '6'.
   772             88  CF-MORTALITY-MASTER            VALUE '7'.
   773             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   774             88  CF-TERMINAL-MASTER             VALUE '9'.
   775             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   776             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   777             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   778             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   779             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   780             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   781             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   782             88  CF-REMINDERS-MASTER            VALUE 'R'.
   783             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   784         16  CF-ACCESS-CD-GENL              PIC X(4).
   785         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   786             20  CF-PROCESSOR               PIC X(4).
   787         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   788             20  CF-STATE-CODE              PIC XX.
   789             20  FILLER                     PIC XX.
   790         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   791             20  FILLER                     PIC XX.
   792             20  CF-HI-BEN-IN-REC           PIC XX.
   793         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   794             20  FILLER                     PIC XXX.
   795             20  CF-CARRIER-CNTL            PIC X.
   796         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   797             20  FILLER                     PIC XX.
   798             20  CF-HI-TYPE-IN-REC          PIC 99.
   799         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   800             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   801                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   802             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   803             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   804         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   805             20  FILLER                     PIC X.
   806             20  CF-CUSTOM-REPORT-NO        PIC 999.
   807         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   808             20  FILLER                     PIC XX.
   809             20  CF-MORTGAGE-PLAN           PIC XX.
   810         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   811
   812     12  CF-LAST-MAINT-DT                   PIC XX.
   813     12  CF-LAST-MAINT-BY                   PIC X(4).
   814     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   815
   816     12  CF-RECORD-BODY                     PIC X(728).
   817
   818
   819****************************************************************
   820*             COMPANY MASTER RECORD                            *
   821****************************************************************
   822
   823     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   824         16  CF-COMPANY-ADDRESS.
   825             20  CF-CL-MAIL-TO-NAME         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  16
* EL201.cbl
   826             20  CF-CL-IN-CARE-OF           PIC X(30).
   827             20  CF-CL-ADDR-LINE-1          PIC X(30).
   828             20  CF-CL-ADDR-LINE-2          PIC X(30).
   829             20  CF-CL-CITY-STATE           PIC X(30).
   830             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   831             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   832         16  CF-COMPANY-CD                  PIC X.
   833         16  CF-COMPANY-PASSWORD            PIC X(8).
   834         16  CF-SECURITY-OPTION             PIC X.
   835             88  ALL-SECURITY                   VALUE '1'.
   836             88  COMPANY-VERIFY                 VALUE '2'.
   837             88  PROCESSOR-VERIFY               VALUE '3'.
   838             88  NO-SECURITY                    VALUE '4'.
   839             88  ALL-BUT-TERM                   VALUE '5'.
   840         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   841             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   842         16  CF-LGX-INTERFACE-CNTL          PIC X.
   843             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   844         16  CF-INFORCE-LOCATION            PIC X.
   845             88  CERTS-ARE-ONLINE               VALUE '1'.
   846             88  CERTS-ARE-OFFLINE              VALUE '2'.
   847             88  NO-CERTS-AVAILABLE             VALUE '3'.
   848         16  CF-LOWER-CASE-LETTERS          PIC X.
   849         16  CF-CERT-ACCESS-CONTROL         PIC X.
   850             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   851             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   852             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   853             88  CF-ACCNT-CNTL                  VALUE '3'.
   854             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   855
   856         16  CF-FORMS-PRINTER-ID            PIC X(4).
   857         16  CF-CHECK-PRINTER-ID            PIC X(4).
   858
   859         16  CF-LGX-CREDIT-USER             PIC X.
   860             88  CO-IS-NOT-USER                 VALUE 'N'.
   861             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   862
   863         16 CF-CREDIT-CALC-CODES.
   864             20  CF-CR-REM-TERM-CALC PIC X.
   865               88  CR-EARN-AFTER-15TH           VALUE '1'.
   866               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   867               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   868               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   869               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   870               88  CR-EARN-AFTER-14TH           VALUE '6'.
   871               88  CR-EARN-AFTER-16TH           VALUE '7'.
   872             20  CF-CR-R78-METHOD           PIC X.
   873               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   874               88  DONT-USE-PLUS-ONE            VALUE '1'.
   875
   876         16  CF-CLAIM-CONTROL-COUNTS.
   877             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   878                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   879
   880             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   881                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   882
   883             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  17
* EL201.cbl
   884                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   885
   886             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   887                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   888
   889         16  CF-CURRENT-MONTH-END           PIC XX.
   890
   891         16  CF-CO-CALC-QUOTE-TOLERANCE.
   892             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   893             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   894             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   895             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   896                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   897                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   898             20  CF-CO-PREM-REJECT-SW       PIC X.
   899                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   900                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   901             20  CF-CO-REF-REJECT-SW        PIC X.
   902                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   903                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   904
   905         16  CF-CO-REPORTING-DT             PIC XX.
   906         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   907         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   908           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   909           88  CF-CO-MONTH-END                  VALUE '1'.
   910
   911         16  CF-LGX-CLAIM-USER              PIC X.
   912             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   913             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   914
   915         16  CF-CREDIT-EDIT-CONTROLS.
   916             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   917             20  CF-MIN-AGE                 PIC 99.
   918             20  CF-DEFAULT-AGE             PIC 99.
   919             20  CF-MIN-TERM                PIC S999      COMP-3.
   920             20  CF-MAX-TERM                PIC S999      COMP-3.
   921             20  CF-DEFAULT-SEX             PIC X.
   922             20  CF-JOINT-AGE-INPUT         PIC X.
   923                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   924             20  CF-BIRTH-DATE-INPUT        PIC X.
   925                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   926             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   927                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   928                 88  CF-ZERO-CARRIER            VALUE '1'.
   929                 88  CF-ZERO-GROUPING           VALUE '2'.
   930                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   931             20  CF-EDIT-SW                 PIC X.
   932                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   933             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   934             20  CF-CR-PR-METHOD            PIC X.
   935               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   936               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   937             20  FILLER                     PIC X.
   938
   939         16  CF-CREDIT-MISC-CONTROLS.
   940             20  CF-REIN-TABLE-SW           PIC X.
   941                 88 REIN-TABLES-ARE-USED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  18
* EL201.cbl
   942             20  CF-COMP-TABLE-SW           PIC X.
   943                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   944             20  CF-EXPERIENCE-RETENTION-AGE
   945                                            PIC S9        COMP-3.
   946             20  CF-CONVERSION-DT           PIC XX.
   947             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   948             20  CF-RUN-FREQUENCY-SW        PIC X.
   949                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   950                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   951
   952             20  CF-CR-CHECK-NO-CONTROL.
   953                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   954                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   955                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   956                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   957                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   958                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   959
   960                 24  CF-CR-CHECK-COUNT       REDEFINES
   961                     CF-CR-CHECK-COUNTER      PIC X(4).
   962
   963                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   964                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   965
   966                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   967                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   968                 24  CF-MAIL-PROCESSING       PIC X.
   969                     88  MAIL-PROCESSING          VALUE 'Y'.
   970
   971         16  CF-MISC-SYSTEM-CONTROL.
   972             20  CF-SYSTEM-C                 PIC X.
   973                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   974             20  CF-SYSTEM-D                 PIC X.
   975                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   976             20  CF-SOC-SEC-NO-SW            PIC X.
   977                 88  SOC-SEC-NO-USED             VALUE '1'.
   978             20  CF-MEMBER-NO-SW             PIC X.
   979                 88  MEMBER-NO-USED              VALUE '1'.
   980             20  CF-TAX-ID-NUMBER            PIC X(11).
   981             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   982             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   983                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   984                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   985                 88  CF-ALL-APPROVED             VALUE 'Y'.
   986                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   987             20  CF-SYSTEM-E                 PIC X.
   988                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   989
   990         16  CF-LGX-LIFE-USER               PIC X.
   991             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   992             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   993
   994         16  CF-CR-MONTH-END-DT             PIC XX.
   995
   996         16  CF-FILE-MAINT-DATES.
   997             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   998                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   999             20  CF-LAST-BATCH       REDEFINES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  19
* EL201.cbl
  1000                 CF-LAST-BATCH-NO               PIC X(4).
  1001             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1002             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1003             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1004             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1005             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1006             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1007             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1008             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1009             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1010             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1011
  1012         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1013         16  FILLER                         PIC X.
  1014
  1015         16  CF-ALT-MORT-CODE               PIC X(4).
  1016         16  CF-MEMBER-CAPTION              PIC X(10).
  1017
  1018         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1019             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1020             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1021             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1022             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1023             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1024
  1025         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1026
  1027         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1028         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1029         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1030         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1031
  1032         16  CF-AH-OVERRIDE-L1              PIC X.
  1033         16  CF-AH-OVERRIDE-L2              PIC XX.
  1034         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1035         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1036
  1037         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1038         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1039
  1040         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1041         16  CF-AR-LAST-EL860-DT            PIC XX.
  1042         16  CF-MP-MONTH-END-DT             PIC XX.
  1043
  1044         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1045         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1046             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1047
  1048         16  CF-AR-MONTH-END-DT             PIC XX.
  1049
  1050         16  CF-CRDTCRD-USER                PIC X.
  1051             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1052             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1053
  1054         16  CF-CC-MONTH-END-DT             PIC XX.
  1055
  1056         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1057
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  20
* EL201.cbl
  1058         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1059             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1060             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1061             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1062         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1063         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1064         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1065         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1066             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1067             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1068         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1069         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1070         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1071             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1072         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1073
  1074         16  CF-CL-ZIP-CODE.
  1075             20  CF-CL-ZIP-PRIME.
  1076                 24  CF-CL-ZIP-1ST          PIC X.
  1077                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1078                 24  FILLER                 PIC X(4).
  1079             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1080         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1081             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1082             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1083             20  FILLER                     PIC XXX.
  1084
  1085         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1086         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1087         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1088         16  CF-CO-OPTION-START-DATE        PIC XX.
  1089         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1090           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1091                                                      '3' '4'.
  1092           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1093           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1094           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1095           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1096           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1097           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1098
  1099         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1100
  1101         16  CF-PAYMENT-APPROVAL-LEVELS.
  1102             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1103             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1104             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1105             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1106             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1107             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1108
  1109         16  CF-END-USER-REPORTING-USER     PIC X.
  1110             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1111             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1112
  1113         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1114             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1115             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  21
* EL201.cbl
  1116
  1117         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1118
  1119         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1120         16  FILLER                         PIC X.
  1121
  1122         16  CF-CREDIT-ARCHIVE-CNTL.
  1123             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1124             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1125             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1126
  1127         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1128
  1129         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1130             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1131             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1132
  1133         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1134             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1135             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1136
  1137         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1138
  1139         16  CF-CO-ACH-ID-CODE              PIC  X.
  1140             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1141             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1142             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1143         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1144         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1145         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1146         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1147         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1148         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1149         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1150         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1151         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1152                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1153         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1154                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1155
  1156         16  CF-CO-OVER-SHORT.
  1157             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1158             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1159
  1160*         16  FILLER                         PIC X(102).
  1161         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1162             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1163             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1164
  1165         16  CF-AH-APPROVAL-DAYS.
  1166             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1167             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1168             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1169             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1170
  1171         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1172
  1173         16  CF-APPROV-LEV-5.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  22
* EL201.cbl
  1174             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1175             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1176             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1177
  1178         16  FILLER                         PIC X(68).
  1179****************************************************************
  1180*             PROCESSOR/USER RECORD                            *
  1181****************************************************************
  1182
  1183     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1184         16  CF-PROCESSOR-NAME              PIC X(30).
  1185         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1186         16  CF-PROCESSOR-TITLE             PIC X(26).
  1187         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1188                 88  MESSAGE-YES                VALUE 'Y'.
  1189                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1190
  1191*****************************************************
  1192****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1193****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1194****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1195****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1196*****************************************************
  1197
  1198         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1199             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1200             20  CF-APPLICATION-FORCE       PIC X.
  1201             20  CF-INDIVIDUAL-APP.
  1202                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1203                     28  CF-BROWSE-APP      PIC X.
  1204                     28  CF-UPDATE-APP      PIC X.
  1205
  1206         16  CF-CURRENT-TERM-ON             PIC X(4).
  1207         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1208             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1209             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1210             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1211             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1212             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1213             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1214             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1215         16  CF-PROCESSOR-CARRIER           PIC X.
  1216             88  NO-CARRIER-SECURITY            VALUE ' '.
  1217         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1218             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1219         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1220             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1221         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1222             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1223
  1224         16  CF-PROC-SYS-ACCESS-SW.
  1225             20  CF-PROC-CREDIT-CLAIMS-SW.
  1226                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1227                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1228                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1229                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1230             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1231                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  23
* EL201.cbl
  1232                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1233             20  CF-PROC-LIFE-GNRLDGR-SW.
  1234                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1235                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1236                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1237                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1238             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1239                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1240                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1241         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1242             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1243             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1244         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1245
  1246         16  CF-APPROVAL-LEVEL                  PIC X.
  1247             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1248             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1249             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1250             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1251             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1252
  1253         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1254
  1255         16  CF-LANGUAGE-TYPE                   PIC X.
  1256             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1257             88  CF-LANG-IS-FR                      VALUE 'F'.
  1258
  1259         16  CF-CSR-IND                         PIC X.
  1260         16  FILLER                             PIC X(239).
  1261
  1262****************************************************************
  1263*             PROCESSOR/REMINDERS RECORD                       *
  1264****************************************************************
  1265
  1266     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1267         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1268             20  CF-START-REMIND-DT         PIC XX.
  1269             20  CF-END-REMIND-DT           PIC XX.
  1270             20  CF-REMINDER-TEXT           PIC X(50).
  1271         16  FILLER                         PIC X(296).
  1272
  1273
  1274****************************************************************
  1275*             STATE MASTER RECORD                              *
  1276****************************************************************
  1277
  1278     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1279         16  CF-STATE-ABBREVIATION          PIC XX.
  1280         16  CF-STATE-NAME                  PIC X(25).
  1281         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1282         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1283             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1284             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1285             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1286             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1287                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1288                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1289             20  CF-ST-PREM-REJECT-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  24
* EL201.cbl
  1290                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1291                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1292             20  CF-ST-REF-REJECT-SW        PIC X.
  1293                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1294                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1295         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1296         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1297         16  CF-ST-REFUND-RULES.
  1298             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1299             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1300             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1301         16  CF-ST-FST-PMT-EXTENSION.
  1302             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1303             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1304                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1305                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1306                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1307                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1308         16  CF-ST-STATE-CALL.
  1309             20  CF-ST-CALL-UNEARNED        PIC X.
  1310             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1311             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1312         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1313             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1314             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1315         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1316         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1317         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1318         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1319         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1320         16  FILLER                         PIC X.
  1321         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1322             20  CF-ST-BENEFIT-CD           PIC XX.
  1323             20  CF-ST-BENEFIT-KIND         PIC X.
  1324                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1325                 88  CF-ST-AH-KIND              VALUE 'A'.
  1326             20  CF-ST-REM-TERM-CALC        PIC X.
  1327                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1328                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1329                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1330                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1331                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1332                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1333                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1334                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1335
  1336             20  CF-ST-REFUND-CALC          PIC X.
  1337                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1338                 88  ST-REFD-BY-R78             VALUE '1'.
  1339                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1340                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1341                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1342                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1343                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1344                 88  ST-REFD-UTAH               VALUE '7'.
  1345                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1346                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1347                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  25
* EL201.cbl
  1348
  1349             20  CF-ST-EARNING-CALC         PIC X.
  1350                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1351                 88  ST-EARN-BY-R78             VALUE '1'.
  1352                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1353                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1354                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1355                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1356                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1357                 88  ST-EARN-MEAN               VALUE '8'.
  1358                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1359
  1360             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1361                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1362                 88  ST-OVRD-BY-R78             VALUE '1'.
  1363                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1364                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1365                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1366                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1367                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1368                 88  ST-OVRD-MEAN               VALUE '8'.
  1369                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1370             20  cf-st-extra-periods        pic 9.
  1371*            20  FILLER                     PIC X.
  1372
  1373         16  CF-ST-COMMISSION-CAPS.
  1374             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1375             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1376             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1377             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1378         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1379                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1380                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1381                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1382
  1383         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1384
  1385         16  CF-ST-STATUTORY-INTEREST.
  1386             20  CF-ST-STAT-DATE-FROM       PIC X.
  1387                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1388                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1389             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1390             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1391             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1392             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1393             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1394
  1395         16  CF-ST-OVER-SHORT.
  1396             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1397             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1398
  1399         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1400
  1401         16  CF-ST-RT-CALC                  PIC X.
  1402
  1403         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1404         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1405         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  26
* EL201.cbl
  1406         16  CF-ST-RF-LR-CALC               PIC X.
  1407         16  CF-ST-RF-LL-CALC               PIC X.
  1408         16  CF-ST-RF-LN-CALC               PIC X.
  1409         16  CF-ST-RF-AH-CALC               PIC X.
  1410         16  CF-ST-RF-CP-CALC               PIC X.
  1411*        16  FILLER                         PIC X(206).
  1412*CIDMOD         16  FILLER                         PIC X(192).
  1413         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1414             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1415         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1416         16  CF-ST-VFY-2ND-BENE             PIC X.
  1417         16  CF-ST-CAUSAL-STATE             PIC X.
  1418         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1419         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1420         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1421             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1422         16  CF-ST-NET-ONLY-STATE           PIC X.
  1423             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1424         16  cf-commission-cap-required     pic x.
  1425         16  CF-ST-GA-COMMISSION-CAPS.
  1426             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  1427             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  1428             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  1429             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  1430         16  CF-ST-TOT-COMMISSION-CAPS.
  1431             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  1432             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  1433             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  1434             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  1435         16  FILLER                         PIC X(156).
  1436
  1437****************************************************************
  1438*             BENEFIT MASTER RECORD                            *
  1439****************************************************************
  1440
  1441     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1442         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1443             20  CF-BENEFIT-CODE            PIC XX.
  1444             20  CF-BENEFIT-NUMERIC  REDEFINES
  1445                 CF-BENEFIT-CODE            PIC XX.
  1446             20  CF-BENEFIT-ALPHA           PIC XXX.
  1447             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1448             20  CF-BENEFIT-COMMENT         PIC X(10).
  1449
  1450             20  CF-LF-COVERAGE-TYPE        PIC X.
  1451                 88  CF-REDUCING                VALUE 'R'.
  1452                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1453
  1454             20  CF-SPECIAL-CALC-CD         PIC X.
  1455                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1456                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1457                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1458                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1459                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1460                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1461                 88  CF-FARM-PLAN               VALUE 'F'.
  1462                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1463                 88  CF-2-MTH-INTEREST          VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  27
* EL201.cbl
  1464                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1465                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1466                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1467                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1468                 88  CF-PRUDENTIAL              VALUE 'P'.
  1469                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1470                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1471                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1472                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1473                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1474                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1475
  1476             20  CF-JOINT-INDICATOR         PIC X.
  1477                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1478
  1479*            20  FILLER                     PIC X(12).
  1480             20  cf-maximum-benefits        pic s999 comp-3.
  1481             20  FILLER                     PIC X(09).
  1482             20  CF-BENEFIT-CATEGORY        PIC X.
  1483             20  CF-LOAN-TYPE               PIC X(8).
  1484
  1485             20  CF-CO-REM-TERM-CALC        PIC X.
  1486                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1487                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1488                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1489                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1490                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1491
  1492             20  CF-CO-EARNINGS-CALC        PIC X.
  1493                 88  CO-EARN-BY-R78             VALUE '1'.
  1494                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1495                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1496                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1497                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1498                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1499                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1500                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1501
  1502             20  CF-CO-REFUND-CALC          PIC X.
  1503                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1504                 88  CO-REFD-BY-R78             VALUE '1'.
  1505                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1506                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1507                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1508                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1509                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1510                 88  CO-REFD-MEAN               VALUE '8'.
  1511                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1512                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1513                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1514
  1515             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1516                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1517                 88  CO-OVRD-BY-R78             VALUE '1'.
  1518                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1519                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1520                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1521                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  28
* EL201.cbl
  1522                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1523                 88  CO-OVRD-MEAN               VALUE '8'.
  1524                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1525
  1526             20  CF-CO-BEN-I-G-CD           PIC X.
  1527                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1528                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1529                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1530
  1531         16  FILLER                         PIC X(304).
  1532
  1533
  1534****************************************************************
  1535*             CARRIER MASTER RECORD                            *
  1536****************************************************************
  1537
  1538     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1539         16  CF-ADDRESS-DATA.
  1540             20  CF-MAIL-TO-NAME            PIC X(30).
  1541             20  CF-IN-CARE-OF              PIC X(30).
  1542             20  CF-ADDRESS-LINE-1          PIC X(30).
  1543             20  CF-ADDRESS-LINE-2          PIC X(30).
  1544             20  CF-CITY-STATE              PIC X(30).
  1545             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1546             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1547
  1548         16  CF-CLAIM-NO-CONTROL.
  1549             20  CF-CLAIM-NO-METHOD         PIC X.
  1550                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1551                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1552                 88  CLAIM-NO-SEQ               VALUE '3'.
  1553                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1554             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1555                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1556                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1557                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1558
  1559         16  CF-CHECK-NO-CONTROL.
  1560             20  CF-CHECK-NO-METHOD         PIC X.
  1561                 88  CHECK-NO-MANUAL            VALUE '1'.
  1562                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1563                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1564                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1565             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1566                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1567
  1568         16  CF-DOMICILE-STATE              PIC XX.
  1569
  1570         16  CF-EXPENSE-CONTROLS.
  1571             20  CF-EXPENSE-METHOD          PIC X.
  1572                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1573                 88  DOLLARS-PER-PMT            VALUE '2'.
  1574                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1575                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1576             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1577             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1578
  1579         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  29
* EL201.cbl
  1580             20  CF-LETTER-RESEND-OPT       PIC X.
  1581                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1582                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1583             20  FILLER                     PIC X(4).
  1584
  1585         16  CF-RESERVE-CONTROLS.
  1586             20  CF-MANUAL-SW               PIC X.
  1587                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1588             20  CF-FUTURE-SW               PIC X.
  1589                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1590             20  CF-PTC-SW                  PIC X.
  1591                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1592             20  CF-IBNR-SW                 PIC X.
  1593                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1594             20  CF-PTC-LF-SW               PIC X.
  1595                 88  CF-LF-PTC-USED             VALUE '1'.
  1596             20  CF-CDT-ACCESS-METHOD       PIC X.
  1597                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1598                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1599                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1600             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1601
  1602         16  CF-CLAIM-CALC-METHOD           PIC X.
  1603             88  360-PLUS-MONTHS                VALUE '1'.
  1604             88  365-PLUS-MONTHS                VALUE '2'.
  1605             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1606             88  360-DAILY                      VALUE '4'.
  1607             88  365-DAILY                      VALUE '5'.
  1608
  1609         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1610         16  FILLER                         PIC X(11).
  1611
  1612         16  CF-LIMIT-AMOUNTS.
  1613             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1614             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1615             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1616             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1617             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1618             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1619             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1620             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1621             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1622             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1623
  1624         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1625         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1626         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1627
  1628         16  CF-ZIP-CODE.
  1629             20  CF-ZIP-PRIME.
  1630                 24  CF-ZIP-1ST             PIC X.
  1631                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1632                 24  FILLER                 PIC X(4).
  1633             20  CF-ZIP-PLUS4               PIC X(4).
  1634         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1635             20  CF-CAN-POSTAL-1            PIC XXX.
  1636             20  CF-CAN-POSTAL-2            PIC XXX.
  1637             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  30
* EL201.cbl
  1638
  1639         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1640         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1641         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1642
  1643         16  CF-RATING-SWITCH               PIC X.
  1644             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1645             88  CF-NO-RATING                   VALUE 'N'.
  1646
  1647         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1648
  1649         16  CF-CARRIER-OVER-SHORT.
  1650             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1651             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1652
  1653         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1654         16  CF-SECPAY-SWITCH               PIC X.
  1655             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1656             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1657         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1658         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1659         16  FILLER                         PIC X(444).
  1660*        16  FILLER                         PIC X(452).
  1661
  1662
  1663****************************************************************
  1664*             MORTALITY MASTER RECORD                          *
  1665****************************************************************
  1666
  1667     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1668         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1669                                INDEXED BY CF-MORT-NDX.
  1670             20  CF-MORT-TABLE              PIC X(5).
  1671             20  CF-MORT-TABLE-TYPE         PIC X.
  1672                 88  CF-MORT-JOINT              VALUE 'J'.
  1673                 88  CF-MORT-SINGLE             VALUE 'S'.
  1674                 88  CF-MORT-COMBINED           VALUE 'C'.
  1675                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1676                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1677             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1678             20  CF-MORT-AGE-METHOD         PIC XX.
  1679                 88  CF-AGE-LAST                VALUE 'AL'.
  1680                 88  CF-AGE-NEAR                VALUE 'AN'.
  1681             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1682             20  CF-MORT-ADJUSTMENT-DIRECTION
  1683                                            PIC X.
  1684                 88  CF-MINUS                   VALUE '-'.
  1685                 88  CF-PLUS                    VALUE '+'.
  1686             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1687             20  CF-MORT-JOINT-CODE         PIC X.
  1688                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1689             20  CF-MORT-PC-Q               PIC X.
  1690                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1691             20  CF-MORT-TABLE-CODE         PIC X(4).
  1692             20  CF-MORT-COMMENTS           PIC X(15).
  1693             20  FILLER                     PIC X(14).
  1694
  1695         16  FILLER                         PIC X(251).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  31
* EL201.cbl
  1696
  1697
  1698****************************************************************
  1699*             BUSSINESS TYPE MASTER RECORD                     *
  1700****************************************************************
  1701
  1702     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1703* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1704* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1705* AND RECORD 05 IS TYPES 81-99
  1706         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1707             20  CF-BUSINESS-TITLE          PIC  X(19).
  1708             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1709                                            PIC S9V9(4) COMP-3.
  1710             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1711             20  FILLER                     PIC  X.
  1712         16  FILLER                         PIC  X(248).
  1713
  1714
  1715****************************************************************
  1716*             TERMINAL MASTER RECORD                           *
  1717****************************************************************
  1718
  1719     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1720
  1721         16  CF-COMPANY-TERMINALS.
  1722             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1723                                  PIC X(4).
  1724         16  FILLER               PIC X(248).
  1725
  1726
  1727****************************************************************
  1728*             LIFE EDIT MASTER RECORD                          *
  1729****************************************************************
  1730
  1731     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1732         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1733             20  CF-LIFE-CODE-IN            PIC XX.
  1734             20  CF-LIFE-CODE-OUT           PIC XX.
  1735         16  FILLER                         PIC X(248).
  1736
  1737
  1738****************************************************************
  1739*             AH EDIT MASTER RECORD                            *
  1740****************************************************************
  1741
  1742     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1743         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1744             20  CF-AH-CODE-IN              PIC XXX.
  1745             20  CF-AH-CODE-OUT             PIC XX.
  1746         16  FILLER                         PIC X(248).
  1747
  1748
  1749****************************************************************
  1750*             CREDIBILITY TABLES                               *
  1751****************************************************************
  1752
  1753     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  32
* EL201.cbl
  1754         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1755                             INDEXED BY CF-CRDB-NDX.
  1756             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1757             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1758             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1759         16  FILLER                         PIC  X(332).
  1760
  1761
  1762****************************************************************
  1763*             REPORT CUSTOMIZATION RECORD                      *
  1764****************************************************************
  1765
  1766     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1767         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1768             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1769             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1770             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1771**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1772****       A T-TRANSFER.                                   ****
  1773             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1774
  1775         16  FILLER                         PIC XX.
  1776
  1777         16  CF-CARRIER-CNTL-OPT.
  1778             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1779                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1780                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1781             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1782                                            PIC X.
  1783         16  CF-GROUP-CNTL-OPT.
  1784             20  CF-GROUP-OPT-SEQ           PIC 9.
  1785                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1786                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1787             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1788                                            PIC X(6).
  1789         16  CF-STATE-CNTL-OPT.
  1790             20  CF-STATE-OPT-SEQ           PIC 9.
  1791                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1792                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1793             20  CF-STATE-SELECT OCCURS 3 TIMES
  1794                                            PIC XX.
  1795         16  CF-ACCOUNT-CNTL-OPT.
  1796             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1797                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1798                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1799             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1800                                            PIC X(10).
  1801         16  CF-BUS-TYP-CNTL-OPT.
  1802             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1803                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1804                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1805             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1806                                            PIC XX.
  1807         16  CF-LF-TYP-CNTL-OPT.
  1808             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1809                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1810                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1811             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  33
* EL201.cbl
  1812                                            PIC XX.
  1813         16  CF-AH-TYP-CNTL-OPT.
  1814             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1815                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1816                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1817             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1818                                            PIC XX.
  1819         16  CF-REPTCD1-CNTL-OPT.
  1820             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1821                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1822                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1823             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1824                                            PIC X(10).
  1825         16  CF-REPTCD2-CNTL-OPT.
  1826             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1827                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1828                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1829             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1830                                            PIC X(10).
  1831         16  CF-USER1-CNTL-OPT.
  1832             20  CF-USER1-OPT-SEQ           PIC 9.
  1833                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1834                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1835             20  CF-USER1-SELECT OCCURS 3 TIMES
  1836                                            PIC X(10).
  1837         16  CF-USER2-CNTL-OPT.
  1838             20  CF-USER2-OPT-SEQ           PIC 9.
  1839                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1840                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1841             20  CF-USER2-SELECT OCCURS 3 TIMES
  1842                                            PIC X(10).
  1843         16  CF-USER3-CNTL-OPT.
  1844             20  CF-USER3-OPT-SEQ           PIC 9.
  1845                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1846                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1847             20  CF-USER3-SELECT OCCURS 3 TIMES
  1848                                            PIC X(10).
  1849         16  CF-USER4-CNTL-OPT.
  1850             20  CF-USER4-OPT-SEQ           PIC 9.
  1851                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1852                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1853             20  CF-USER4-SELECT OCCURS 3 TIMES
  1854                                            PIC X(10).
  1855         16  CF-USER5-CNTL-OPT.
  1856             20  CF-USER5-OPT-SEQ           PIC 9.
  1857                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1858                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1859             20  CF-USER5-SELECT OCCURS 3 TIMES
  1860                                            PIC X(10).
  1861         16  CF-REINS-CNTL-OPT.
  1862             20  CF-REINS-OPT-SEQ           PIC 9.
  1863                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1864                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1865             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1866                 24  CF-REINS-PRIME         PIC XXX.
  1867                 24  CF-REINS-SUB           PIC XXX.
  1868
  1869         16  CF-AGENT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  34
* EL201.cbl
  1870             20  CF-AGENT-OPT-SEQ           PIC 9.
  1871                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1872                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1873             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1874                                            PIC X(10).
  1875
  1876         16  FILLER                         PIC X(43).
  1877
  1878         16  CF-LOSS-RATIO-SELECT.
  1879             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1880             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1881         16  CF-ENTRY-DATE-SELECT.
  1882             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1883             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1884         16  CF-EFFECTIVE-DATE-SELECT.
  1885             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1886             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1887
  1888         16  CF-EXCEPTION-LIST-IND          PIC X.
  1889             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1890
  1891         16  FILLER                         PIC X(318).
  1892
  1893****************************************************************
  1894*                  EXCEPTION REPORTING RECORD                  *
  1895****************************************************************
  1896
  1897     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1898         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1899             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1900
  1901         16  CF-COMBINED-LIFE-AH-OPT.
  1902             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1903             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1904             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1905             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1906
  1907         16  CF-LIFE-OPT.
  1908             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1909             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1910             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1911             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1912             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1913             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1914             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1915             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1916             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1917             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1918
  1919         16  CF-AH-OPT.
  1920             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1921             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1922             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1923             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1924             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1925             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1926             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1927             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  35
* EL201.cbl
  1928             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1929             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1930
  1931         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1932             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1933             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1934             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1935
  1936         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1937
  1938         16  FILLER                         PIC X(673).
  1939
  1940
  1941****************************************************************
  1942*             MORTGAGE SYSTEM PLAN RECORD                      *
  1943****************************************************************
  1944
  1945     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1946         16  CF-PLAN-TYPE                   PIC X.
  1947             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1948             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1949             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1950         16  CF-PLAN-ABBREV                 PIC XXX.
  1951         16  CF-PLAN-DESCRIPT               PIC X(10).
  1952         16  CF-PLAN-NOTES                  PIC X(20).
  1953         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1954         16  CF-PLAN-UNDERWRITING.
  1955             20  CF-PLAN-TERM-DATA.
  1956                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1957                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1958             20  CF-PLAN-AGE-DATA.
  1959                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1960                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1961                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1962             20  CF-PLAN-BENEFIT-DATA.
  1963                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1964                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1965                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1966                                            PIC S9(7)V99  COMP-3.
  1967         16  CF-PLAN-POLICY-FORMS.
  1968             20  CF-POLICY-FORM             PIC X(12).
  1969             20  CF-MASTER-APPLICATION      PIC X(12).
  1970             20  CF-MASTER-POLICY           PIC X(12).
  1971         16  CF-PLAN-RATING.
  1972             20  CF-RATE-CODE               PIC X(5).
  1973             20  CF-SEX-RATING              PIC X.
  1974                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1975                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1976             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1977             20  CF-SUB-STD-TYPE            PIC X.
  1978                 88  CF-PCT-OF-PREM            VALUE '1'.
  1979                 88  CF-PCT-OF-BENE            VALUE '2'.
  1980         16  CF-PLAN-PREM-TOLERANCES.
  1981             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1982             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1983         16  CF-PLAN-PYMT-TOLERANCES.
  1984             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1985             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  36
* EL201.cbl
  1986         16  CF-PLAN-MISC-DATA.
  1987             20  FILLER                     PIC X.
  1988             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1989             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1990         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1991         16  CF-PLAN-IND-GRP                PIC X.
  1992             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1993                                                     '1'.
  1994             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1995                                                     '2'.
  1996         16  CF-MIB-SEARCH-SW               PIC X.
  1997             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1998             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1999             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2000             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2001         16  CF-ALPHA-SEARCH-SW             PIC X.
  2002             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2003             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2004             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2005             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2006             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2007             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2008             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2009             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2010             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2011             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2012                                                     'A' 'B' 'C'
  2013                                                     'X' 'Y' 'Z'.
  2014         16  CF-EFF-DT-RULE-SW              PIC X.
  2015             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2016             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2017             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2018             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2019             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2020         16  FILLER                         PIC X(4).
  2021         16  CF-HEALTH-QUESTIONS            PIC X.
  2022             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2023         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2024         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2025         16  CF-PLAN-SNGL-JNT               PIC X.
  2026             88  CF-COMBINED-PLAN              VALUE 'C'.
  2027             88  CF-JNT-PLAN                   VALUE 'J'.
  2028             88  CF-SNGL-PLAN                  VALUE 'S'.
  2029         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2030         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2031         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2032         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2033         16  CF-RERATE-CNTL                 PIC  X.
  2034             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2035             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2036             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2037             88  CF-AUTO-RECALC                 VALUE '4'.
  2038         16  CF-BENEFIT-TYPE                PIC  X.
  2039             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2040             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2041         16  CF-POLICY-FEE                  PIC S999V99
  2042                                                    COMP-3.
  2043         16  CF-1ST-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  37
* EL201.cbl
  2044         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2045         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2046         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2047         16  FILLER                         PIC  X(32).
  2048         16  CF-TERMINATION-FORM            PIC  X(04).
  2049         16  FILLER                         PIC  X(08).
  2050         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2051                                                       COMP-3.
  2052         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2053         16  CF-ISSUE-LETTER                PIC  X(4).
  2054         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2055         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2056             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2057             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2058         16  CF-MP-REFUND-CALC              PIC X.
  2059             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2060             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2061             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2062             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2063             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2064             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2065             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2066             88  CF-MP-REFD-MEAN                VALUE '8'.
  2067         16  CF-ALT-RATE-CODE               PIC  X(5).
  2068
  2069
  2070         16  FILLER                         PIC X(498).
  2071****************************************************************
  2072*             MORTGAGE COMPANY MASTER RECORD                   *
  2073****************************************************************
  2074
  2075     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2076         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2077         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2078             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2079             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2080             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2081             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2082             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2083
  2084         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2085         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2086         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2087         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2088         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2089
  2090         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2091             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2092         16  CF-MP-RECON-USE-IND            PIC X(1).
  2093             88  CF-MP-USE-RECON             VALUE 'Y'.
  2094         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2095             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2096         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2097             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2098             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2099         16  FILLER                         PIC X(1).
  2100         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2101             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  38
* EL201.cbl
  2102         16  CF-MORTG-MIB-VERSION           PIC X.
  2103             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2104             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2105             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2106         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2107             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2108                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2109             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2110                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2111             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2112                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2113             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2114                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2115             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2116                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2117             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2118                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2119         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2120         16  FILLER                         PIC X(7).
  2121         16  CF-MORTG-DESTINATION-SYMBOL.
  2122             20  CF-MORTG-MIB-COMM          PIC X(5).
  2123             20  CF-MORTG-MIB-TERM          PIC X(5).
  2124         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2125             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2126         16  FILLER                         PIC X(03).
  2127         16  CF-MP-CHECK-NO-CONTROL.
  2128             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2129                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2130                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2131                                                ' ' LOW-VALUES.
  2132                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2133                                               VALUE '3'.
  2134         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2135         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2136         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2137             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2138                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2139             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2140                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2141             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2142                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2143             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2144                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2145             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2146                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2147             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2148                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2149         16  CF-MORTG-BILLING-AREA.
  2150             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2151                                            PIC X.
  2152         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2153         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2154         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2155         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2156             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2157             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2158         16  FILLER                         PIC X.
  2159         16  CF-MORTG-LABEL-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  39
* EL201.cbl
  2160             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2161             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2162         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2163         16  FILLER                         PIC X(8).
  2164         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2165         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2166         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2167         16  CF-ACH-COMPANY-ID.
  2168             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2169                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2170                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2171                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2172             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2173         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2174             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2175         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2176             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2177             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2178         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2179         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2180         16  FILLER                         PIC X(536).
  2181
  2182****************************************************************
  2183*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2184****************************************************************
  2185
  2186     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2187         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2188             20  CF-FEMALE-HEIGHT.
  2189                 24  CF-FEMALE-FT           PIC 99.
  2190                 24  CF-FEMALE-IN           PIC 99.
  2191             20  CF-FEMALE-MIN-WT           PIC 999.
  2192             20  CF-FEMALE-MAX-WT           PIC 999.
  2193         16  FILLER                         PIC X(428).
  2194
  2195     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2196         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2197             20  CF-MALE-HEIGHT.
  2198                 24  CF-MALE-FT             PIC 99.
  2199                 24  CF-MALE-IN             PIC 99.
  2200             20  CF-MALE-MIN-WT             PIC 999.
  2201             20  CF-MALE-MAX-WT             PIC 999.
  2202         16  FILLER                         PIC X(428).
  2203******************************************************************
  2204*             AUTOMATIC ACTIVITY RECORD                          *
  2205******************************************************************
  2206     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2207         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2208             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2209             20  CF-SYS-LETTER-ID           PIC X(04).
  2210             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2211             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2212             20  CF-SYS-RESET-SW            PIC X(01).
  2213             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2214             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2215
  2216         16  FILLER                         PIC X(50).
  2217
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  40
* EL201.cbl
  2218         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2219             20  CF-USER-ACTIVE-SW          PIC X(01).
  2220             20  CF-USER-LETTER-ID          PIC X(04).
  2221             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2222             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2223             20  CF-USER-RESET-SW           PIC X(01).
  2224             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2225             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2226             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2227
  2228         16  FILLER                         PIC X(246).
  2229 01  ws-heading1.
  2230     05  ws-head1                pic x(120)  value '
  2231-     '                                   DAILY CHECK RECONCILIATI
  2232-     'ON                                            '.
  2233     05  ws-h1-rpt-id            pic x(6)  value 'EL201A'.
  2234 01  ws-heading2.
  2235     05  filler                  pic x(51) value spaces.
  2236     05  WS-H2-CLIENT-NAME       PIC X(59) VALUE SPACES.
  2237     05  WS-H2-DATE              PIC X(10).
  2238     05  ws-h2-time              pic x(8).
  2239 01  ws-heading3.
  2240     05  filler                  pic x(53) value spaces.
  2241     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2242     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2243     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2244 01  ws-heading4.
  2245     05  filler                  pic x(117)   value ' CAR  GROUP
  2246-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2247-        '  CHECK CASHED DT   PREPARER   AMOUNT    MESSAGE'.
  2248 01  ws-hd1-written.
  2249     05  filler                  pic x(120)  value '
  2250-     '                                   DAILY WRITTEN CHECKS REP
  2251-     'ORT                                           '.
  2252 01  ws-hd4-written.
  2253     05  filler                  pic x(117)   value ' CAR  GROUP
  2254-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2255-        '  CHECK WRITTEN DT  PREPARER   AMOUNT    MESSAGE'.
  2256 01  ws-detail1.
  2257     05  filler                  pic xx value '  '.
  2258     05  ws-d1-carr              pic x(4) value spaces.
  2259     05  ws-d1-grp               pic x(7) value spaces.
  2260     05  ws-d1-state             pic x(4) value spaces.
  2261     05  ws-d1-account           pic x(12) value spaces.
  2262     05  ws-d1-eff-dt            pic x(12) value spaces.
  2263     05  ws-d1-cert-no           pic x(14) value spaces.
  2264     05  ws-d1-chk-type          pic x(5) value spaces.
  2265     05  ws-d1-chk-no            pic x(12) value spaces.
  2266     05  f                       pic xx value spaces.
  2267     05  ws-d1-writ-cash-dt      pic x(16) value spaces.
  2268     05  ws-d1-preparer          pic x(8) value spaces.
  2269     05  ws-d1-chk-amt-a         pic x(10) value spaces.
  2270     05  ws-d1-chk-amt redefines
  2271         ws-d1-chk-amt-a         pic $$$,$$9.99.
  2272     05  filler                  pic xx value spaces.
  2273     05  ws-d1-message           pic x(20) value spaces.
  2274 01  ws-detail2.
  2275     05  filler                  pic x(12) value '    PAYEE - '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  41
* EL201.cbl
  2276     05  ws-d2-addr-line         pic x(120) value spaces.
  2277 01  ws-total1.
  2278     05  filler                  pic x(5) value '     '.
  2279     05  ws-t1-cnt               pic zzzz9  value zeros.
  2280     05  ws-t1-chks              pic x(24)  value spaces.
  2281     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2282 01  w-doctoken                  pic x(16).
  2283 01 output-data.
  2284    05  filler                   pic x(6) value "TITLE=".
  2285    05  output-title             pic x(26) value 'Check Posting'.
  2286    05  filler                   pic x(8) value "&COMPID=".
  2287    05  out-comp-id              pic xxx.
  2288    05  filler                   pic x(5) value "&MSG=".
  2289    05  output-msg               pic x(50).
  2290 01  tran-data-line1             pic x(80) value spaces.
  2291 01  tran-data-line2             pic x(80) value spaces.
  2292* 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
  2293**    'cd /apps/prod/cid1p/jcl'.
  2294*      'cd /apps/test/ahltst/jcl'.
  2295* 01  TRAN-DATA-LINE2.
  2296*     05  filler                  pic x(10) value 'unikixjob '.
  2297*     05  tdl2-job                pic x(8) value 'cilg201b'.
  2298**    05  filler                  pic x(9) value ' -k cid1p'.
  2299*     05  filler                  pic x(10) value ' -k ahltst'.
  2300*     05  filler                  pic x(50) value spaces.
  2301****************************************************************
  2302*
  2303* Copyright (c) 2007-2013 Dell Inc.
  2304* All rights reserved.
  2305*
  2306****************************************************************
  2307 01  DFHEIV.
  2308   02  DFHEIV0               PIC X(35).
  2309   02  DFHEIV1               PIC X(08).
  2310   02  DFHEIV2               PIC X(08).
  2311   02  DFHEIV3               PIC X(08).
  2312   02  DFHEIV4               PIC X(06).
  2313   02  DFHEIV5               PIC X(04).
  2314   02  DFHEIV6               PIC X(04).
  2315   02  DFHEIV7               PIC X(02).
  2316   02  DFHEIV8               PIC X(02).
  2317   02  DFHEIV9               PIC X(01).
  2318   02  DFHEIV10              PIC S9(7) COMP-3.
  2319   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2320   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2321   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2322   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2323   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2324   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2325   02  DFHEIV17              PIC X(04).
  2326   02  DFHEIV18              PIC X(04).
  2327   02  DFHEIV19              PIC X(04).
  2328   02  DFHEIV20              USAGE IS POINTER.
  2329   02  DFHEIV21              USAGE IS POINTER.
  2330   02  DFHEIV22              USAGE IS POINTER.
  2331   02  DFHEIV23              USAGE IS POINTER.
  2332   02  DFHEIV24              USAGE IS POINTER.
  2333   02  DFHEIV25              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  42
* EL201.cbl
  2334   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2335   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2336   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2337   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2338   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2339   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2340   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2341   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2342   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2343   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2344   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2345   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2346   02  FILLER                PIC X(02).
  2347   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2348   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2349   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2350   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2351   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2352   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2353   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2354 LINKAGE  SECTION.
  2355*****************************************************************
  2356*                                                               *
  2357* Copyright (c) 2007-2013 Dell Inc.                             *
  2358* All rights reserved.                                          *
  2359*                                                               *
  2360*****************************************************************
  2361 01  dfheiblk.
  2362     02  eibtime          pic s9(7) comp-3.
  2363     02  eibdate          pic s9(7) comp-3.
  2364     02  eibtrnid         pic x(4).
  2365     02  eibtaskn         pic s9(7) comp-3.
  2366     02  eibtrmid         pic x(4).
  2367     02  dfheigdi         pic s9(4) comp.
  2368     02  eibcposn         pic s9(4) comp.
  2369     02  eibcalen         pic s9(4) comp.
  2370     02  eibaid           pic x(1).
  2371     02  eibfiller1       pic x(1).
  2372     02  eibfn            pic x(2).
  2373     02  eibfiller2       pic x(2).
  2374     02  eibrcode         pic x(6).
  2375     02  eibfiller3       pic x(2).
  2376     02  eibds            pic x(8).
  2377     02  eibreqid         pic x(8).
  2378     02  eibrsrce         pic x(8).
  2379     02  eibsync          pic x(1).
  2380     02  eibfree          pic x(1).
  2381     02  eibrecv          pic x(1).
  2382     02  eibsend          pic x(1).
  2383     02  eibatt           pic x(1).
  2384     02  eibeoc           pic x(1).
  2385     02  eibfmh           pic x(1).
  2386     02  eibcompl         pic x(1).
  2387     02  eibsig           pic x(1).
  2388     02  eibconf          pic x(1).
  2389     02  eiberr           pic x(1).
  2390     02  eibrldbk         pic x(1).
  2391     02  eiberrcd         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  43
* EL201.cbl
  2392     02  eibsynrb         pic x(1).
  2393     02  eibnodat         pic x(1).
  2394     02  eibfiller5       pic x(2).
  2395     02  eibresp          pic s9(8) comp.
  2396     02  eibresp2         pic s9(8) comp.
  2397     02  dfheigdj         pic s9(4) comp.
  2398     02  dfheigdk         pic s9(4) comp.
  2399 01  DFHCOMMAREA       PIC X(01).
  2400 01  VAR                         PIC X(30).
  2401 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  2402 0000-DFHEXIT SECTION.
  2403     MOVE '9#                    $   ' TO DFHEIV0.
  2404     MOVE 'EL201' TO DFHEIV1.
  2405     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2406***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2407***                                                            ***
  2408***  Even though this program is using WEB Servies we don't    ***
  2409***  have any form fields to browse through, we are getting    ***
  2410***  the information we need through the variables that are    ***
  2411***  included in the URL. These variables are retrieved by     ***
  2412***  the           exec cics web extract                       ***
  2413***                   querystring  (data-value)                ***
  2414***                   querystrlen  (data-value)                ***
  2415***                end-exec                                    ***
  2416***  BTW, you must provide the length it isn't passed to you.  ***
  2417***  Allow for extra on the length or you will get a length    ***
  2418***  error instead of just truncation.                         ***
  2419***                                                            ***
  2420***  This program is expecting                                 ***
  2421*** http://slunikix:7001/cics/cwba/EL201?comp=CID&file=written***
  2422*** http://slunikix:7003/cics/cwba/EL201?comp=CID&file=written***
  2423*** http://logictest:6007/cics/cwba/EL201?comp=CID&file=written***
  2424***                                                            ***
  2425***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2426     display ' Entering program EL201 '
  2427     set P to address of KIXSYS
  2428     CALL "getenv" using by value P returning var-ptr
  2429     if var-ptr = null then
  2430        display ' kixsys not set '
  2431     else
  2432        set address of var to var-ptr
  2433        move 0 to env-var-len
  2434        inspect var tallying env-var-len
  2435          for characters before X'00'
  2436        unstring var (1:env-var-len) delimited by '/'
  2437           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2438              WS-KIX-SYS
  2439        end-unstring
  2440     end-if
  2441     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2442     move ws-fn-cymd             to dc-greg-date-cymd
  2443     move 'L'                    to dc-option-code
  2444     perform 9700-date-convert   thru 9700-exit
  2445     if no-conversion-error
  2446        move dc-greg-date-1-alpha to ws-h3-date
  2447        move dc-greg-date-1-edit to ws-h2-date
  2448     else
  2449        display ' error current dt invalid ' dc-error-code
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  44
* EL201.cbl
  2450     end-if
  2451     string ws-fn-hours   ':'
  2452            ws-fn-minutes ':'
  2453            ws-fn-seconds
  2454        delimited by size into ws-h2-time
  2455     end-string
  2456
  2457* exec cics web extract
  2458*       querystring  (ws-qry-string)
  2459*       querystrlen  (ws-qrystr-len)
  2460*    end-exec
  2461*    MOVE 'X0  QL                .   #00002359' TO DFHEIV0
  2462     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2463     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2464     MOVE X'2020233030303032333539' TO DFHEIV0(25:11)
  2465     CALL 'kxdfhei1' USING DFHEIV0,
  2466           DFHEIV99,
  2467           DFHEIV99,
  2468           ws-qry-string,
  2469           ws-qrystr-len,
  2470           DFHEIV99,
  2471           DFHEIV99,
  2472           DFHEIV99,
  2473           DFHEIV99,
  2474           DFHEIV99,
  2475           DFHEIV99,
  2476           DFHEIV99,
  2477           DFHEIV99,
  2478           DFHEIV99
  2479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2480     move ws-qry-string (6:3)    to ws-comp-id
  2481                                    out-comp-id
  2482     move 'Successful Run   '    to output-msg
  2483     move ws-comp-id             to elcntl-key
  2484     move '1'                    to elcntl-rec-type
  2485     move +0                     to elcntl-seq
  2486
  2487* exec cics read
  2488*       dataset  ('ELCNTL')
  2489*       into     (control-file)
  2490*       ridfld   (elcntl-key)
  2491*       resp     (ws-response)
  2492*    end-exec
  2493     MOVE LENGTH OF
  2494      control-file
  2495       TO DFHEIV11
  2496     MOVE 'ELCNTL' TO DFHEIV1
  2497*    MOVE '&"IL       E          (  N#00002369' TO DFHEIV0
  2498     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2500     MOVE X'204E233030303032333639' TO DFHEIV0(25:11)
  2501     CALL 'kxdfhei1' USING DFHEIV0,
  2502           DFHEIV1,
  2503           control-file,
  2504           DFHEIV11,
  2505           elcntl-key,
  2506           DFHEIV99,
  2507           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  45
* EL201.cbl
  2508           DFHEIV99
  2509     MOVE EIBRESP  TO ws-response
  2510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2511     if resp-normal
  2512        move cf-cl-mail-to-name  to ws-h2-client-name
  2513        move cf-company-cd       to ws-comp-cd
  2514     else
  2515        move 'Company Rec not found ' to ws-h2-client-name
  2516                                         output-msg
  2517        display ' error elcntl read ' ws-response ' '
  2518           elcntl-key (1:8)
  2519        go to 0000-return
  2520     end-if
  2521     evaluate true
  2522        when ws-qry-string (15:7) = 'written' or 'WRITTEN'
  2523           set process-written      to true
  2524           perform 2000-process-written
  2525                                 thru 2000-exit
  2526        when other
  2527           move 'Invalid File ' to output-msg
  2528     end-evaluate
  2529     if connected-to-db
  2530        EXEC SQL
  2531            commit work release
  2532        END-EXEC
  2533        if sqlcode not = 0
  2534           move ' Failed to Commit DB '
  2535                                 to output-msg
  2536           display "Error: commit release "
  2537           display ' sql return code ' sqlcode
  2538           display ' sql err mess    ' sqlerrmc
  2539        end-if
  2540     end-if
  2541     .
  2542 0000-return.
  2543     perform 1030-send-form      thru 1030-exit
  2544
  2545* exec cics
  2546*       return
  2547*    end-exec
  2548*    MOVE '.(                    ''   #00002408' TO DFHEIV0
  2549     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2550     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2551     MOVE X'2020233030303032343038' TO DFHEIV0(25:11)
  2552     CALL 'kxdfhei1' USING DFHEIV0,
  2553           DFHEIV99,
  2554           DFHEIV99,
  2555           DFHEIV99,
  2556           DFHEIV99,
  2557           DFHEIV99,
  2558           DFHEIV99
  2559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2560     .
  2561 1000-CONNECT-DB.
  2562     string
  2563         usr delimited space
  2564         "." delimited size
  2565         pass delimited space into usr-pass
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  46
* EL201.cbl
  2566     end-string
  2567     EXEC SQL
  2568        CONNECT TO :svr USER :usr-pass
  2569     END-EXEC
  2570     if sqlcode not = 0
  2571        display "Error: cannot connect "
  2572        display sqlcode
  2573        display sqlerrmc
  2574        move 'Failed to connect to DB'
  2575                                 to output-msg
  2576        go to 0000-return
  2577     else
  2578        set connected-to-db to true
  2579     end-if
  2580     .
  2581 1000-EXIT.
  2582     EXIT.
  2583 1020-read-erchek.
  2584     move ws-comp-cd             to ch-company-cd
  2585     move db-carrier             to ch-carrier
  2586     move db-grouping            to ch-grouping
  2587     move db-state               to ch-state
  2588     move db-account             to ch-account
  2589     move db-certificate         to ch-cert-prime
  2590     move db-cert-sfx            to ch-cert-sfx
  2591     string db-effdate (1:4)
  2592            db-effdate (6:2)
  2593            db-effdate (9:2)
  2594        delimited by size into dc-greg-date-cymd-r
  2595     end-string
  2596     move 'L'                    to dc-option-code
  2597     perform 9700-date-convert   thru 9700-exit
  2598     if no-conversion-error
  2599        move dc-bin-date-1       to ch-cert-eff-dt
  2600     else
  2601        display ' error cvtdte eff dt ' db-effdate ' '
  2602           dc-error-code
  2603     end-if
  2604     move zeros                  to ws-seq-alpha
  2605     move +5                     to s2
  2606     perform varying s1 from +5 by -1 until s1 < +1
  2607        if db-seq-no (s1:1) numeric
  2608           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2609           subtract +1 from s2
  2610        end-if
  2611     end-perform
  2612     move ws-seq-no-num          to ch-sequence-no
  2613*    display ' dte   **' db-effdate '**'
  2614*    display ' carrier ' ch-carrier
  2615*    display ' group   ' ch-grouping
  2616*    display ' state   ' ch-state
  2617*    display ' acct    ' ch-account
  2618*    display ' cert  **' ch-cert-no '**'
  2619*    display ' seq     ' ch-sequence-no
  2620
  2621* exec cics read
  2622*       update
  2623*       dataset    ('ERCHEK')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  47
* EL201.cbl
  2624*       into       (check-records)
  2625*       ridfld     (ch-control-primary)
  2626*       resp       (ws-response)
  2627*    end-exec
  2628     MOVE LENGTH OF
  2629      check-records
  2630       TO DFHEIV11
  2631     MOVE 'ERCHEK' TO DFHEIV1
  2632*    MOVE '&"IL       EU         (  N#00002471' TO DFHEIV0
  2633     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2634     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2635     MOVE X'204E233030303032343731' TO DFHEIV0(25:11)
  2636     CALL 'kxdfhei1' USING DFHEIV0,
  2637           DFHEIV1,
  2638           check-records,
  2639           DFHEIV11,
  2640           ch-control-primary,
  2641           DFHEIV99,
  2642           DFHEIV99,
  2643           DFHEIV99
  2644     MOVE EIBRESP  TO ws-response
  2645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2646     .
  2647 1020-exit.
  2648     exit.
  2649 1030-send-form.
  2650
  2651* exec cics document create
  2652*       doctoken   (w-doctoken)
  2653*       template   ('WCHECKS')
  2654*       symbollist (output-data)
  2655*       listlength (length of output-data)
  2656*    end-exec
  2657     MOVE 'WCHECKS' TO DFHEIV1
  2658     MOVE LENGTH OF
  2659      output-data TO DFHEIV16
  2660*    MOVE '\"D tSL               )   #00002482' TO DFHEIV0
  2661     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  2662     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2663     MOVE X'2020233030303032343832' TO DFHEIV0(25:11)
  2664     CALL 'kxdfhei1' USING DFHEIV0,
  2665           w-doctoken,
  2666           DFHEIV99,
  2667           DFHEIV1,
  2668           output-data,
  2669           DFHEIV16,
  2670           DFHEIV99,
  2671           DFHEIV99,
  2672           DFHEIV99
  2673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2674
  2675* exec cics web send
  2676*       doctoken(w-doctoken)
  2677*    end-exec
  2678*    MOVE 'X$D                   *   #00002488' TO DFHEIV0
  2679     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2680     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2681     MOVE X'2020233030303032343838' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  48
* EL201.cbl
  2682     CALL 'kxdfhei1' USING DFHEIV0,
  2683           w-doctoken,
  2684           DFHEIV99,
  2685           DFHEIV99,
  2686           DFHEIV99,
  2687           DFHEIV99,
  2688           DFHEIV99,
  2689           DFHEIV99,
  2690           DFHEIV99,
  2691           DFHEIV99
  2692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2693     .
  2694 1030-exit.
  2695     exit.
  2696 1050-disconnect.
  2697     if connected-to-db
  2698        EXEC SQL
  2699            disconnect all
  2700        END-EXEC
  2701        move ' ' to ws-connect-sw
  2702     end-if
  2703     .
  2704 1050-exit.
  2705     exit.
  2706 2000-process-written.
  2707     perform 2010-open-files     thru 2010-exit
  2708     perform 2020-init           thru 2020-exit
  2709     perform 2050-process-input  thru 2050-exit until
  2710        end-of-input
  2711     if ws-writ-cnt > zeros
  2712        move ws-writ-cnt         to ws-t1-cnt
  2713        move ' Written '         to ws-t1-chks
  2714        move ws-tot-writ-amt     to ws-t1-amount
  2715     else
  2716        perform 4010-write-headings
  2717                                 thru 4010-exit
  2718        move spaces              to ws-total1
  2719        string ' No checks for '
  2720           ws-work-comp-id
  2721           ' today. ' delimited by size into ws-total1
  2722        end-string
  2723     end-if
  2724     move spaces                 to cps-written-rpt-rec
  2725     perform 4020-write-a-line   thru 4020-exit
  2726     move ws-total1              to cps-written-rpt-rec
  2727     perform 4020-write-a-line   thru 4020-exit
  2728     perform 2500-close-files    thru 2500-exit
  2729     perform 5000-submit-job     thru 5000-exit
  2730     .
  2731 2000-exit.
  2732     exit.
  2733 2010-open-files.
  2734     if ws-kix-myenv = 'cid1p'
  2735        move 'SDVDB01_ChkApprv'  to svr
  2736        move 'appuser'           to usr
  2737        move 'appuser@cso'       to pass
  2738        move '/data/seqfiles/'   to ws-work-dir
  2739        move 'cd /apps/prod/cid1p/jcl'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  49
* EL201.cbl
  2740                                 to tran-data-line1
  2741        move ws-kix-myenv        to ws-work-env
  2742     else
  2743        move 'HOVTSTDB01_ChkApprv' to svr
  2744        move 'appuser'           to usr
  2745        move 'appuser@cso'       to pass
  2746        move ws-kix-myenv        to ws-work-env
  2747        string
  2748           '/data/test/' delimited by size
  2749           ws-work-env   delimited by space
  2750           '/seqfiles/'  delimited by size
  2751              into ws-work-dir
  2752        end-string
  2753        string
  2754           'cd /apps/test/' delimited by size
  2755           ws-work-env      delimited by space
  2756           '/jcl'           delimited by size
  2757              into tran-data-line1
  2758        end-string
  2759     end-if
  2760     move function upper-case(ws-comp-id)
  2761                                 to ws-work-comp-id
  2762     evaluate true
  2763        when ws-work-comp-id = 'AHL'
  2764           move 'miscpymtsahl.csv'
  2765                                 to ws-work-file-in
  2766           move 'ahlg201b'       to ws-work-job-name
  2767        when ws-work-comp-id = 'FNL'
  2768           move 'miscpymtsfnl.csv'
  2769                                 to ws-work-file-in
  2770           move 'fllg201b'       to ws-work-job-name
  2771        when other
  2772           move 'miscpymts.csv'  to ws-work-file-in
  2773           move 'cilg201b'       to ws-work-job-name
  2774     end-evaluate
  2775     move spaces                 to ws-written-in
  2776                                    ws-written-rpt
  2777     string
  2778        ws-work-dir delimited by space
  2779        ws-work-file-in delimited by space
  2780           into ws-written-in
  2781     end-string
  2782     move 'miscpymts.rpt'        to ws-work-rpt-out
  2783     string
  2784        ws-work-dir delimited by space
  2785        ws-work-comp-id delimited by size
  2786        ws-work-rpt-out delimited by size
  2787           into ws-written-rpt
  2788     end-string
  2789     string
  2790        'unikixjob '     delimited by size
  2791        ws-work-job-name delimited by size
  2792        ' -k '           delimited by size
  2793        ws-work-env      delimited by space
  2794           into tran-data-line2
  2795     end-string
  2796*     display ' svr    ' svr
  2797*     display ' user   ' usr
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  50
* EL201.cbl
  2798*     display ' pw     ' pass
  2799*     display ' input  ' ws-written-in
  2800*     display ' output ' ws-written-rpt
  2801*     display ' line 1 ' tran-data-line1
  2802*     display ' line 2 ' tran-data-line2
  2803     open input CPS-WRITTEN-IN
  2804         output CPS-WRITTEN-RPT
  2805     if written-status not = '00'
  2806        display 'error written open ' written-status
  2807        move ' Invalid or missing file '
  2808                                 to output-msg
  2809        go to 0000-return
  2810     end-if
  2811     .
  2812 2010-exit.
  2813     exit.
  2814 2020-init.
  2815     move spaces                 to ws-detail1
  2816     move ws-hd1-written         to ws-head1
  2817     move 'EL201B'               to ws-h1-rpt-id
  2818     move ws-hd4-written         to ws-heading4
  2819     move 'Posting of Written Checks '
  2820                                 to output-title
  2821*    if ws-comp-id = 'AHL'
  2822*       move 'ahlg201b'          to tdl2-job
  2823*    else
  2824*       move 'cilg201b'          to tdl2-job
  2825*    end-if
  2826     if not connected-to-db
  2827        perform 1000-connect-db  thru 1000-exit
  2828     end-if
  2829***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2830***                                                            ***
  2831**     I do 2 reads to bypass the header record                ***
  2832***                                                            ***
  2833***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2834     perform 2040-read-input     thru 2040-exit
  2835     perform 2040-read-input     thru 2040-exit
  2836     .
  2837 2020-exit.
  2838     exit.
  2839 2040-read-input.
  2840     read CPS-WRITTEN-IN at end
  2841        set end-of-input   to true
  2842     end-read
  2843     if not end-of-input
  2844        add 1 to ws-in-recs
  2845     end-if
  2846     .
  2847 2040-exit.
  2848     exit.
  2849 2050-process-input.
  2850     move spaces                 to ws-raw-record
  2851                                    ws-written-rec
  2852     unstring cps-written-in-rec
  2853        delimited by ',' into
  2854           raw-check-no
  2855           raw-check-dt
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  51
* EL201.cbl
  2856           raw-check-amt
  2857           raw-vendor-id
  2858           raw-user-defined
  2859           raw-voucher-ref
  2860     end-unstring
  2861*    display ' chk no    **' wsw-check-no '**'
  2862*    display ' chk dt    **' wsw-check-dt '**'
  2863*    display ' chk amt   **' wsw-check-amt '**'
  2864*    display ' vend id   **' wsw-vendor-id '**'
  2865*    display ' user def  **' wsw-user-defined '**'
  2866*    display ' vouch ref **' wsw-voucher-ref '**'
  2867***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2868***                                                            ***
  2869***    Every now and then I get bogus records with quotes      ***
  2870***  so I am just going to remove them.  These are normally    ***
  2871***  a result of a manual process that should not be included  ***
  2872***  in this file.                                             ***
  2873***                                                            ***
  2874***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2875
  2876     move +1                     to o1
  2877     perform varying i1 from +1 by +1 until i1 > +20
  2878        if raw-check-no (i1:1) <> '"'
  2879           move raw-check-no (i1:1)
  2880                                 to wsw-check-no (o1:1)
  2881           add +1 to o1
  2882        end-if
  2883     end-perform
  2884
  2885     move +1                     to o1
  2886     perform varying i1 from +1 by +1 until i1 > +20
  2887        if raw-check-dt (i1:1) <> '"'
  2888           move raw-check-dt (i1:1)
  2889                                 to wsw-check-dt (o1:1)
  2890           add +1 to o1
  2891        end-if
  2892     end-perform
  2893
  2894     move +1                     to o1
  2895     perform varying i1 from +1 by +1 until i1 > +15
  2896        if raw-check-amt (i1:1) <> '"'
  2897           move raw-check-amt (i1:1)
  2898                                 to wsw-check-amt (o1:1)
  2899           add +1 to o1
  2900        end-if
  2901     end-perform
  2902
  2903     move +1                     to o1
  2904     perform varying i1 from +1 by +1 until i1 > +20
  2905        if raw-vendor-id (i1:1) <> '"'
  2906           move raw-vendor-id (i1:1)
  2907                                 to wsw-vendor-id (o1:1)
  2908           add +1 to o1
  2909        end-if
  2910     end-perform
  2911
  2912     move +1                     to o1
  2913     perform varying i1 from +1 by +1 until i1 > +30
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  52
* EL201.cbl
  2914        if raw-user-defined (i1:1) <> '"'
  2915           move raw-user-defined (i1:1)
  2916                                 to wsw-user-defined (o1:1)
  2917           add +1 to o1
  2918        end-if
  2919     end-perform
  2920
  2921     move +1                     to o1
  2922     perform varying i1 from +1 by +1 until i1 > +35
  2923        if raw-voucher-ref (i1:1) <> '"'
  2924           move raw-voucher-ref (i1:1)
  2925                                 to wsw-voucher-ref (o1:1)
  2926           add +1 to o1
  2927        end-if
  2928     end-perform
  2929     if (wsw-check-no = spaces)
  2930        and (wsw-check-dt = spaces)
  2931        and (wsw-check-amt = spaces)
  2932        display ' empty record ' cps-written-in-rec
  2933        go to 2050-read
  2934     end-if
  2935     string wsw-check-dt (1:4)
  2936            wsw-check-dt (6:2)
  2937            wsw-check-dt (9:2)
  2938        delimited by size into dc-greg-date-cymd-r
  2939     end-string
  2940     move 'L'                    to dc-option-code
  2941     perform 9700-date-convert   thru 9700-exit
  2942     if no-conversion-error
  2943        move dc-bin-date-1       to ws-bin-check-dt
  2944     else
  2945        display ' error cvtdte chek dt ' wsw-check-dt ' '
  2946           dc-error-code
  2947     end-if
  2948     perform varying s1 from +1 by +1 until
  2949        (s1 > +28)
  2950        or (wsw-voucher-ref (s1:6) = 'REF DI' or 'REFUND' or
  2951          'CANCEL')
  2952     end-perform
  2953     if s1 < +29
  2954        move 'Bypass- Manual Entry'    to ws-d1-message
  2955        move ' '                 to ws-table-sw
  2956        go to 2050-continue
  2957     end-if
  2958*    if wsw-user-defined (1:3) not numeric
  2959*       move 'Bypass- Manual Entry'
  2960*                                to ws-d1-message
  2961*       move ' '                 to ws-table-sw
  2962*       go to 2050-continue
  2963*    end-if
  2964     perform varying s1 from +1 by +1 until
  2965        (s1 > +30)
  2966        or (wsw-user-defined (s1:1) = ' ')
  2967     end-perform
  2968     if (s1 < +12)
  2969        and (s1 > +8)
  2970        continue
  2971     else
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  53
* EL201.cbl
  2972        move 'Bypass- Manual Entry'
  2973                                 to ws-d1-message
  2974        move ' '                 to ws-table-sw
  2975        go to 2050-continue
  2976     end-if
  2977     move spaces                 to wsw-check-key
  2978     perform varying s1 from +30 by -1 until
  2979        (s1 < +1)
  2980        or (wsw-user-defined (s1:1) numeric)
  2981     end-perform
  2982     if s1 > +7
  2983        move wsw-user-defined (s1 - 6:7)
  2984                                 to wsw-check-key
  2985     else
  2986        move 'Invalid Input CK-KEY'    to ws-d1-message
  2987        go to 2050-continue
  2988     end-if
  2989*    go to 2050-read
  2990     move ' '                    to ws-erchek-sw
  2991                                    ws-table-sw
  2992     perform 2200-get-tbl-row    thru 2200-exit
  2993     if sqlcode = 0
  2994        set table-found          to true
  2995        perform 1020-read-erchek thru 1020-exit
  2996        if resp-normal
  2997           set erchek-found to true
  2998           perform 2310-upd-erchek
  2999                                 thru 2310-exit
  3000           perform 2320-upd-table thru 2320-exit
  3001        else
  3002           display ' erchek not fnd ' ch-carrier ' ' ch-state ' '
  3003              ch-account ' ' db-effdate (1:10) ' ' db-certificate
  3004              ' ' ws-response
  3005           move ' chk rec not found ' to ws-d1-message
  3006        end-if
  3007     else
  3008        move ' tbl row not found ' to ws-d1-message
  3009     end-if
  3010     .
  3011 2050-continue.
  3012     perform 2400-build-print-line thru 2400-exit
  3013     .
  3014 2050-read.
  3015     perform 2040-read-input     thru 2040-exit
  3016     .
  3017 2050-exit.
  3018     exit.
  3019 2200-get-tbl-row.
  3020***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3021***                                                            ***
  3022***  I'm only expecting one row so no cursor is declared       ***
  3023***                                                            ***
  3024***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3025     move ws-comp-id             to ws-compid
  3026     move wsw-check-key-num      to ws-check-key
  3027     move 1                      to ws-type
  3028     exec sql
  3029        SELECT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  54
* EL201.cbl
  3030           CheckKey,
  3031           Company,
  3032           CertCarrier,
  3033           CertGroup,
  3034           CertState,
  3035           CertAccount,
  3036           CertEffDate,
  3037           CertNumber,
  3038           CertNumberSuf,
  3039           CheckSeqNbr,
  3040           CheckType,
  3041           CheckAmount,
  3042           Preparer,
  3043           CheckSubType
  3044        INTO
  3045           :db-checkkey,
  3046           :db-compid,
  3047           :db-carrier,
  3048           :db-grouping,
  3049           :db-state,
  3050           :db-account,
  3051           :db-effdate,
  3052           :db-certificate,
  3053           :db-cert-sfx,
  3054           :db-seq-no,
  3055           :db-type,
  3056           :db-amount,
  3057           :db-preparer,
  3058           :db-check-sub-type
  3059        FROM
  3060           ChkApp_Check
  3061        WHERE
  3062           (CheckKey    = :ws-check-key)
  3063           and (Company = :ws-compid)
  3064     end-exec
  3065     if sqlcode not = 0
  3066        move sqlcode to ws-sql-code
  3067        move ws-sql-code to ws-dis-sql-code
  3068        display ' dis sql code ' ws-dis-sql-code
  3069        display "Error: cannot read row "
  3070        display ' sql return code ' sqlcode
  3071        display ' sql err mess    ' sqlerrmc
  3072     end-if
  3073     .
  3074 2200-exit.
  3075     exit.
  3076 2310-upd-erchek.
  3077     move ws-bin-check-dt        to ch-check-written-dt
  3078     if wsw-check-no (1:1) = '"'
  3079        move wsw-check-no (5:7)  to ch-check-no
  3080     else
  3081        move wsw-check-no (4:7)  to ch-check-no
  3082     end-if
  3083*    move zeros                  to ws-response
  3084
  3085* exec cics rewrite
  3086*       dataset     ('ERCHEK')
  3087*       from        (check-records)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  55
* EL201.cbl
  3088*       resp        (ws-response)
  3089*    end-exec
  3090     MOVE LENGTH OF
  3091      check-records
  3092       TO DFHEIV11
  3093     MOVE 'ERCHEK' TO DFHEIV1
  3094*    MOVE '&& L                  %  N#00002883' TO DFHEIV0
  3095     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3096     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3097     MOVE X'204E233030303032383833' TO DFHEIV0(25:11)
  3098     CALL 'kxdfhei1' USING DFHEIV0,
  3099           DFHEIV1,
  3100           check-records,
  3101           DFHEIV11,
  3102           DFHEIV99
  3103     MOVE EIBRESP  TO ws-response
  3104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3105     if resp-normal
  3106        add 1 to ws-writ-cnt
  3107        compute ws-tot-writ-amt =
  3108           ws-tot-writ-amt + ch-amount-paid
  3109        move 'Successful Post '  to ws-d1-message
  3110     else
  3111        move '*** ERROR - NOT POSTED ***' TO ws-d1-message
  3112     end-if
  3113     .
  3114 2310-exit.
  3115     exit.
  3116 2320-upd-table.
  3117     string wsw-check-dt (6:2) '/'
  3118            wsw-check-dt (9:2) '/'
  3119            wsw-check-dt (1:4)
  3120        delimited by size into db-checkdate
  3121     move ch-check-no            to db-checkno
  3122*    move zeros to sqlcode
  3123     EXEC SQL
  3124        UPDATE
  3125           ChkApp_Check
  3126        SET
  3127           CheckNumber = :db-checkno,
  3128           CheckDate = :db-checkdate
  3129        WHERE
  3130           CheckKey = :db-checkkey
  3131     END-EXEC
  3132     if sqlcode not = 0
  3133        move 'Table not updated ' to ws-d1-message
  3134        display "Error: cannot update table   "
  3135        display ' sql retrun code ' sqlcode
  3136        display ' sql err mess    ' sqlerrmc
  3137     end-if
  3138     .
  3139 2320-exit.
  3140     exit.
  3141 2400-build-print-line.
  3142     if table-found
  3143        move db-carrier          to ws-d1-carr
  3144        move db-grouping         to ws-d1-grp
  3145        move db-state            to ws-d1-state
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  56
* EL201.cbl
  3146        move db-account          to ws-d1-account
  3147        string
  3148           db-effdate (6:2)   '/'
  3149           db-effdate (9:2)   '/'
  3150           db-effdate (1:4)
  3151           delimited by size into ws-d1-eff-dt
  3152        end-string
  3153        move db-certificate      to ws-d1-cert-no
  3154        move db-cert-sfx         to ws-d1-cert-no (11:1)
  3155        if db-check-sub-type = '2'
  3156           move 'COR'            to ws-d1-chk-type
  3157        else
  3158           move 'REF'            to ws-d1-chk-type
  3159        end-if
  3160        move +10                 to s2
  3161        move zeros               to ws-work-amt-alpha
  3162        perform varying s1 from +10 by -1 until s1 < +1
  3163           if db-amount (s1:1) numeric
  3164              move db-amount (s1:1)
  3165                                 to ws-work-amt-alpha (s2:1)
  3166              subtract +1 from s2
  3167           end-if
  3168        end-perform
  3169        move ws-work-amt-num     to ws-d1-chk-amt
  3170        move db-preparer         to ws-d1-preparer
  3171        move db-checkno          to ws-d1-chk-no
  3172        move db-checkdate        to ws-d1-writ-cash-dt
  3173     else
  3174        move wsw-check-no        to ws-d1-chk-no
  3175     end-if
  3176     perform 4000-write-report   thru 4000-exit
  3177     move spaces                 to ws-detail1
  3178     .
  3179 2400-exit.
  3180     exit.
  3181 2500-close-files.
  3182     close cps-written-in cps-written-rpt
  3183     .
  3184 2500-exit.
  3185     exit.
  3186 4000-write-report.
  3187     if ws-line-cntr > ws-max-lines
  3188        move zeros               to ws-line-cntr
  3189        perform 4010-write-headings thru 4010-exit
  3190     end-if
  3191     move ws-detail1             to cps-written-rpt-rec
  3192     perform 4020-write-a-line   thru 4020-exit
  3193     .
  3194 4000-exit.
  3195     exit.
  3196 4010-write-headings.
  3197     add 1 to ws-page-cntr
  3198     move ws-page-cntr           to ws-h3-page
  3199     move ws-heading1            to cps-written-rpt-rec
  3200     perform 4020-write-a-line   thru 4020-exit
  3201     move ws-heading2            to cps-written-rpt-rec
  3202     perform 4020-write-a-line   thru 4020-exit
  3203     move ws-heading3            to cps-written-rpt-rec
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  57
* EL201.cbl
  3204     perform 4020-write-a-line   thru 4020-exit
  3205     move spaces                 to cps-written-rpt-rec
  3206     perform 4020-write-a-line   thru 4020-exit
  3207     move spaces                 to cps-written-rpt-rec
  3208     perform 4020-write-a-line   thru 4020-exit
  3209     move ws-heading4            to cps-written-rpt-rec
  3210     perform 4020-write-a-line   thru 4020-exit
  3211     move spaces                 to cps-written-rpt-rec
  3212     perform 4020-write-a-line   thru 4020-exit
  3213     .
  3214 4010-exit.
  3215     exit.
  3216 4020-write-a-line.
  3217     write cps-written-rpt-rec
  3218     add 1 to ws-line-cntr
  3219     .
  3220 4020-exit.
  3221     exit.
  3222 5000-submit-job.
  3223
  3224* EXEC CICS WRITEQ TD
  3225*       QUEUE ('BTCH')
  3226*       FROM (TRAN-DATA-LINE1)
  3227*       LENGTH (80)
  3228*    END-EXEC
  3229     MOVE 80
  3230       TO DFHEIV11
  3231     MOVE 'BTCH' TO DFHEIV5
  3232*    MOVE '(" L   L              &   #00003006' TO DFHEIV0
  3233     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  3234     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3235     MOVE X'2020233030303033303036' TO DFHEIV0(25:11)
  3236     CALL 'kxdfhei1' USING DFHEIV0,
  3237           DFHEIV5,
  3238           TRAN-DATA-LINE1,
  3239           DFHEIV11,
  3240           DFHEIV99,
  3241           DFHEIV99
  3242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3243
  3244* EXEC CICS WRITEQ TD
  3245*       QUEUE ('BTCH')
  3246*       FROM (TRAN-DATA-LINE2)
  3247*       LENGTH (80)
  3248*    END-EXEC
  3249     MOVE 80
  3250       TO DFHEIV11
  3251     MOVE 'BTCH' TO DFHEIV5
  3252*    MOVE '(" L   L              &   #00003011' TO DFHEIV0
  3253     MOVE X'2822204C2020204C20202020' TO DFHEIV0(1:12)
  3254     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3255     MOVE X'2020233030303033303131' TO DFHEIV0(25:11)
  3256     CALL 'kxdfhei1' USING DFHEIV0,
  3257           DFHEIV5,
  3258           TRAN-DATA-LINE2,
  3259           DFHEIV11,
  3260           DFHEIV99,
  3261           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:07 Page  58
* EL201.cbl
  3262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3263     .
  3264 5000-exit.
  3265     exit.
  3266 9700-DATE-CONVERT.
  3267
  3268* EXEC CICS LINK
  3269*         PROGRAM  ('ELDATCV')
  3270*         COMMAREA (DATE-CONVERSION-DATA)
  3271*         LENGTH   (DC-COMM-LENGTH)
  3272*    END-EXEC.
  3273     MOVE 'ELDATCV' TO DFHEIV1
  3274*    MOVE '."C                   (   #00003020' TO DFHEIV0
  3275     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3277     MOVE X'2020233030303033303230' TO DFHEIV0(25:11)
  3278     CALL 'kxdfhei1' USING DFHEIV0,
  3279           DFHEIV1,
  3280           DATE-CONVERSION-DATA,
  3281           DC-COMM-LENGTH,
  3282           DFHEIV99,
  3283           DFHEIV99,
  3284           DFHEIV99,
  3285           DFHEIV99
  3286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3287
  3288 9700-EXIT.
  3289      EXIT.
  3290
  3291 9999-DFHBACK SECTION.
  3292     MOVE '9%                    "   ' TO DFHEIV0
  3293     MOVE 'EL201' TO DFHEIV1
  3294     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3295     GOBACK.
  3296 9999-DFHEXIT.
  3297     IF DFHEIGDJ EQUAL 0001
  3298         NEXT SENTENCE.
  3299     MOVE '9%                    "   ' TO DFHEIV0
  3300     MOVE 'EL201' TO DFHEIV1
  3301     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3302     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      140212     Code:       10770
