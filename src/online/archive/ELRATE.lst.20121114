* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* ELRATE.cbl
* Options: int("ELRATE.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRATE.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATE.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* ELRATE.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192******************************************************************
   193
   194 01  NET-PAY-WORK-AREA.
   195     12  OPTION-SW               PIC X   VALUE 'X'.
   196        88  NPO-STD         VALUE SPACE.
   197        88  NPO-ALT         VALUE 'A'.
   198        88  NPO-SIMPLE      VALUE 'S'.
   199        88  NPO-2MO         VALUE 'I'.
   200        88  NPO-3MO         VALUE 'J'.
   201        88  NPO-4MO         VALUE 'K'.
   202        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   203        88  NPO-TRUNC-0     VALUE 'T'.
   204        88  NPO-TRUNC-1     VALUE 'U'.
   205        88  NPO-TRUNC-2     VALUE 'V'.
   206        88  NPO-TRUNC-3     VALUE 'W'.
   207        88  NPO-TRUNC-4     VALUE 'X'.
   208        88  NPO-REFUND      VALUE 'R'.
   209        88  NPO-PRUDENTIAL  VALUE 'P'.
   210
   211     12  TYPE-SW             PIC X   VALUE 'N'.
   212        88  NET-STD             VALUE 'N'.
   213        88  NET-SMP             VALUE 'S'.
   214
   215     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   216        88  NP-RATING           VALUE '1'.
   217        88  NP-REFUND           VALUE '2'.
   218        88  NP-REMAIN-AMT       VALUE '3'.
   219
   220     12  COMP-3-WORK-AREA         COMP-3.
   221         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   222         16  V               PIC SV9(13)       VALUE +.0.
   223         16  J               PIC SV9(9)        VALUE +0.
   224         16  K               PIC SV9(9)        VALUE +0.
   225         16  I               PIC SV9(10)       VALUE +.0.
   226         16  D               PIC S9(5)         VALUE +.0.
   227         16  APR100          PIC SV9(9)        VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* ELRATE.cbl
   228         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   229         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   230         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   232         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   233         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   234         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   235         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   236         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   237         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   238         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   239         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   240         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   241         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   242         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   243         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   244         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   246         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   247         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   248         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   251         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   252         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   253         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   254         16  K1              PIC S999          VALUE +1.
   255         16  K12             PIC S999          VALUE +12.
   256         16  K100            PIC S999          VALUE +100.
   257         16  K1000           PIC S9(7)         VALUE +1000.
   258         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   259         16  Y REDEFINES NC-LR
   260                             PIC S99V9(5).
   261         16  TI              PIC S999V9(5)     VALUE +0.
   262         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   263         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   264         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   265         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   266         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   267         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   268         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   269         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   270
   271         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   272         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   273         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   274         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   275         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   276         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   277         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   278         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   279         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   280         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   281         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   282         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   283         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   284
   285         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* ELRATE.cbl
   286
   287         16  ORIGINAL-TERM   PIC S999.
   288         16  M              REDEFINES ORIGINAL-TERM
   289                             PIC S999.
   290
   291         16  REMAINING-TERM  PIC S999.
   292         16  R              REDEFINES REMAINING-TERM
   293                             PIC S999.
   294
   295         16  LOAN-TERM       PIC S999.
   296         16  N              REDEFINES LOAN-TERM
   297                             PIC S999.
   298
   299         16  EXPIRED-TERM    PIC S999.
   300         16  E              REDEFINES EXPIRED-TERM
   301                             PIC S999.
   302
   303         16  PRUDENTIAL-WORK-AMT
   304                             PIC S9(7)V9(8).
   305         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   306                             PIC S9(7)V9(8).
   307
   308         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   309         16  VX              PIC S9V9(13)      VALUE +0.0.
   310         16  SV              PIC S9V9(13)      VALUE +0.0.
   311         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   312         16  SX              PIC S9V9(13)      VALUE +0.0.
   313         16  SE              PIC S9V9(10)      VALUE +0.0.
   314         16  N2              PIC S9(7)         VALUE +0.
   315         16  N3              PIC S9(7)         VALUE +0.
   316         16  K-I             PIC S9V9(8)       VALUE +0.0.
   317
   318     12  BINARY-WORK-AREA        COMP.
   319         16  X1              PIC S999        VALUE +0.
   320         16  X2              PIC S999        VALUE +0.
   321         16  MAX-X           PIC S9(5)       VALUE +0.
   322         16  B1              PIC S9(5)       VALUE +1.
   323         16  LINDX           PIC S999        VALUE ZEROS.
   324         16  AHNDX           PIC S999        VALUE ZEROS.
   325
   326     12  CSO-RATE-WORK-AREAS.
   327         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   328         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   329         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   330     12  WS-WORK-MISC.
   331         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   332         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   333*        16  WS-AGE              PIC 99           VALUE ZEROS.
   334         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   335         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   336         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   337         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   338         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   339         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   340         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   341         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   342         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   343         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* ELRATE.cbl
   344         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   345         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   346******************************************************************
   347
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* ELRATE.cbl
   349*                            COPY ELCDATE.
   350******************************************************************
   351*                                                                *
   352*                                                                *
   353*                            ELCDATE.                            *
   354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   355*                            VMOD=2.003
   356*                                                                *
   357*                                                                *
   358*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   359*                 LENGTH = 200                                   *
   360******************************************************************
   361
   362 01  DATE-CONVERSION-DATA.
   363     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   364     12  DC-OPTION-CODE                PIC X.
   365         88  BIN-TO-GREG                VALUE ' '.
   366         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   367         88  EDIT-GREG-TO-BIN           VALUE '2'.
   368         88  YMD-GREG-TO-BIN            VALUE '3'.
   369         88  MDY-GREG-TO-BIN            VALUE '4'.
   370         88  JULIAN-TO-BIN              VALUE '5'.
   371         88  BIN-PLUS-ELAPSED           VALUE '6'.
   372         88  FIND-CENTURY               VALUE '7'.
   373         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   374         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   375         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   376         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   377         88  JULIAN-TO-BIN-3            VALUE 'C'.
   378         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   379         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   380         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   381         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   382         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   383         88  CHECK-LEAP-YEAR            VALUE 'H'.
   384         88  BIN-3-TO-GREG              VALUE 'I'.
   385         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   386         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   387         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   388         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   389         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   390         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   391         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   392         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   393         88  THREE-CHARACTER-BIN
   394                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   395         88  GREGORIAN-TO-BIN
   396                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   397         88  BIN-TO-GREGORIAN
   398                  VALUES ' ' '1' 'I' '8' 'G'.
   399         88  JULIAN-TO-BINARY
   400                  VALUES '5' 'C' 'E' 'F'.
   401     12  DC-ERROR-CODE                 PIC X.
   402         88  NO-CONVERSION-ERROR        VALUE ' '.
   403         88  DATE-CONVERSION-ERROR
   404                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   405         88  DATE-IS-ZERO               VALUE '1'.
   406         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* ELRATE.cbl
   407         88  DATE-IS-INVALID            VALUE '3'.
   408         88  DATE1-GREATER-DATE2        VALUE '4'.
   409         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   410         88  DATE-INVALID-OPTION        VALUE '9'.
   411         88  INVALID-CENTURY            VALUE 'A'.
   412         88  ONLY-CENTURY               VALUE 'B'.
   413         88  ONLY-LEAP-YEAR             VALUE 'C'.
   414         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   415     12  DC-END-OF-MONTH               PIC X.
   416         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   417     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   418         88  USE-NORMAL-PROCESS         VALUE ' '.
   419         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   420         88  ADJUST-UP-100-YRS          VALUE '2'.
   421     12  FILLER                        PIC X.
   422     12  DC-CONVERSION-DATES.
   423         16  DC-BIN-DATE-1             PIC XX.
   424         16  DC-BIN-DATE-2             PIC XX.
   425         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   426         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   427                       DC-GREG-DATE-1-EDIT.
   428             20  DC-EDIT1-MONTH        PIC 99.
   429             20  SLASH1-1              PIC X.
   430             20  DC-EDIT1-DAY          PIC 99.
   431             20  SLASH1-2              PIC X.
   432             20  DC-EDIT1-YEAR         PIC 99.
   433         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   434         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   435                     DC-GREG-DATE-2-EDIT.
   436             20  DC-EDIT2-MONTH        PIC 99.
   437             20  SLASH2-1              PIC X.
   438             20  DC-EDIT2-DAY          PIC 99.
   439             20  SLASH2-2              PIC X.
   440             20  DC-EDIT2-YEAR         PIC 99.
   441         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   442         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   443                     DC-GREG-DATE-1-YMD.
   444             20  DC-YMD-YEAR           PIC 99.
   445             20  DC-YMD-MONTH          PIC 99.
   446             20  DC-YMD-DAY            PIC 99.
   447         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   448         16  DC-GREG-DATE-1-MDY-R REDEFINES
   449                      DC-GREG-DATE-1-MDY.
   450             20  DC-MDY-MONTH          PIC 99.
   451             20  DC-MDY-DAY            PIC 99.
   452             20  DC-MDY-YEAR           PIC 99.
   453         16  DC-GREG-DATE-1-ALPHA.
   454             20  DC-ALPHA-MONTH        PIC X(10).
   455             20  DC-ALPHA-DAY          PIC 99.
   456             20  FILLER                PIC XX.
   457             20  DC-ALPHA-CENTURY.
   458                 24 DC-ALPHA-CEN-N     PIC 99.
   459             20  DC-ALPHA-YEAR         PIC 99.
   460         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   461         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   462         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   463         16  DC-JULIAN-DATE            PIC 9(05).
   464         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* ELRATE.cbl
   465                                       PIC 9(05).
   466         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   467             20  DC-JULIAN-YEAR        PIC 99.
   468             20  DC-JULIAN-DAYS        PIC 999.
   469         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   470         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   471         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   472     12  DATE-CONVERSION-VARIBLES.
   473         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   474         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   475             20  FILLER                PIC 9(3).
   476             20  HOLD-CEN-1-CCYY.
   477                 24  HOLD-CEN-1-CC     PIC 99.
   478                 24  HOLD-CEN-1-YY     PIC 99.
   479             20  HOLD-CEN-1-MO         PIC 99.
   480             20  HOLD-CEN-1-DA         PIC 99.
   481         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   482             20  HOLD-CEN-1-R-MO       PIC 99.
   483             20  HOLD-CEN-1-R-DA       PIC 99.
   484             20  HOLD-CEN-1-R-CCYY.
   485                 24  HOLD-CEN-1-R-CC   PIC 99.
   486                 24  HOLD-CEN-1-R-YY   PIC 99.
   487             20  FILLER                PIC 9(3).
   488         16  HOLD-CENTURY-1-X.
   489             20  FILLER                PIC X(3)  VALUE SPACES.
   490             20  HOLD-CEN-1-X-CCYY.
   491                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   492                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   493             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   494             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   495         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   496             20  HOLD-CEN-1-R-X-MO     PIC XX.
   497             20  HOLD-CEN-1-R-X-DA     PIC XX.
   498             20  HOLD-CEN-1-R-X-CCYY.
   499                 24  HOLD-CEN-1-R-X-CC PIC XX.
   500                 24  HOLD-CEN-1-R-X-YY PIC XX.
   501             20  FILLER                PIC XXX.
   502         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   503         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   504         16  DC-JULIAN-DATE-1          PIC 9(07).
   505         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   506             20  DC-JULIAN-1-CCYY.
   507                 24  DC-JULIAN-1-CC    PIC 99.
   508                 24  DC-JULIAN-1-YR    PIC 99.
   509             20  DC-JULIAN-DA-1        PIC 999.
   510         16  DC-JULIAN-DATE-2          PIC 9(07).
   511         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   512             20  DC-JULIAN-2-CCYY.
   513                 24  DC-JULIAN-2-CC    PIC 99.
   514                 24  DC-JULIAN-2-YR    PIC 99.
   515             20  DC-JULIAN-DA-2        PIC 999.
   516         16  DC-GREG-DATE-A-EDIT.
   517             20  DC-EDITA-MONTH        PIC 99.
   518             20  SLASHA-1              PIC X VALUE '/'.
   519             20  DC-EDITA-DAY          PIC 99.
   520             20  SLASHA-2              PIC X VALUE '/'.
   521             20  DC-EDITA-CCYY.
   522                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* ELRATE.cbl
   523                 24  DC-EDITA-YEAR     PIC 99.
   524         16  DC-GREG-DATE-B-EDIT.
   525             20  DC-EDITB-MONTH        PIC 99.
   526             20  SLASHB-1              PIC X VALUE '/'.
   527             20  DC-EDITB-DAY          PIC 99.
   528             20  SLASHB-2              PIC X VALUE '/'.
   529             20  DC-EDITB-CCYY.
   530                 24  DC-EDITB-CENT     PIC 99.
   531                 24  DC-EDITB-YEAR     PIC 99.
   532         16  DC-GREG-DATE-CYMD         PIC 9(08).
   533         16  DC-GREG-DATE-CYMD-R REDEFINES
   534                              DC-GREG-DATE-CYMD.
   535             20  DC-CYMD-CEN           PIC 99.
   536             20  DC-CYMD-YEAR          PIC 99.
   537             20  DC-CYMD-MONTH         PIC 99.
   538             20  DC-CYMD-DAY           PIC 99.
   539         16  DC-GREG-DATE-MDCY         PIC 9(08).
   540         16  DC-GREG-DATE-MDCY-R REDEFINES
   541                              DC-GREG-DATE-MDCY.
   542             20  DC-MDCY-MONTH         PIC 99.
   543             20  DC-MDCY-DAY           PIC 99.
   544             20  DC-MDCY-CEN           PIC 99.
   545             20  DC-MDCY-YEAR          PIC 99.
   546    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   547        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   548    12  DC-EL310-DATE                  PIC X(21).
   549    12  FILLER                         PIC X(28).
   550
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* ELRATE.cbl
   552*                            COPY ELCCALC.
   553******************************************************************
   554*                                                                *
   555*                           ELCCALC.                            *
   556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   557*                            VMOD=2.025                          *
   558*                                                                *
   559*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   560*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   561*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   562*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   563*                                                                *
   564*  PASSED TO ELRTRM                                              *
   565*  -----------------                                             *
   566*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   567*  ORIGINAL TERM                                                 *
   568*  BEGINNING DATE                                                *
   569*  ENDING DATE                                                   *
   570*  COMPANY I.D.                                                  *
   571*  ACCOUNT MASTER USER FIELD                                     *
   572*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   573*  FREE LOOK DAYS                                                *
   574*                                                                *
   575*  RETURNED FROM ELRTRM                                          *
   576*  ---------------------                                         *
   577*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   578*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   579*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   580*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   581*----------------------------------------------------------------*
   582*  PASSED TO ELRAMT                                              *
   583*  ----------------                                              *
   584*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   585*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   586*  ORIGINAL AMOUNT                                               *
   587*  ALTERNATE BENEFIT (BALLON)                                    *
   588*  A.P.R. - NET PAY ONLY                                         *
   589*  METHOD
   590*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   591*  COMPANY I.D.                                                  *
   592*  BENEFIT TYPE                                                  *
   593*                                                                *
   594*  RETURNED FROM ELRAMT                                          *
   595*  --------------------                                          *
   596*  REMAINING AMOUNT 1 - CURRENT                                  *
   597*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   598*  REMAINING AMOUNT FACTOR
   599*----------------------------------------------------------------*
   600*  PASSED TO ELRESV                                              *
   601*  -----------------                                             *
   602*  CERTIFICATE EFFECTIVE DATE                                    *
   603*  VALUATION DATE                                                *
   604*  PAID THRU DATE                                                *
   605*  BENEFIT                                                       *
   606*  INCURRED DATE                                                 *
   607*  REPORTED DATE                                                 *
   608*  ISSUE AGE                                                     *
   609*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* ELRATE.cbl
   610*  CDT PERCENT                                                   *
   611*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   612* *CLAIM TYPE (LIFE, A/H)                                        *
   613* *REMAINING BENEFIT (FROM ELRAMT)                               *
   614* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   615*                                                                *
   616*  RETURNED FROM ELRESV                                          *
   617*  --------------------                                          *
   618*  CDT TABLE USED                                                *
   619*  CDT FACTOR USED                                               *
   620*  PAY TO CURRENT RESERVE                                        *
   621*  I.B.N.R. - A/H ONLY                                           *
   622*  FUTURE (ACCRUED) AH ONLY                                      *
   623*----------------------------------------------------------------*
   624*  PASSED TO ELRATE                                              *
   625*  ----------------                                              *
   626*  CERT ISSUE DATE                                               *
   627*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   628*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   629*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   630*  STATE CODE (CLIENT DEFINED)                                   *
   631*  STATE CODE (STANDARD P.O. ABBRV)                              *
   632*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   633*  DEVIATION CODE                                                *
   634*  ISSUE AGE                                                     *
   635*  ORIGINAL BENEFIT AMOUNT                                       *
   636*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   637*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   638*  BENEFIT KIND (LIFE OR A/H)                                    *
   639*  A.P.R.                                                        *
   640*  METHOD
   641*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   642*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   643*  COMPANY I.D. (3 CHARACTER)                                    *
   644*  BENEFIT CODE                                                  *
   645*  BENEFIT OVERRIDE CODE                                         *
   646*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   647*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   648*  JOINT INDICATOR (CSL ONLY)                                    *
   649*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   650*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   651*                                                                *
   652*  RETURNED FROM ELRATE                                          *
   653*  --------------------                                          *
   654*  CALCULATED PREMIUM                                            *
   655*  PREMIUM RATE                                                  *
   656*  MORTALITY CODE                                                *
   657*  MAX ATTAINED AGE                                              *
   658*  MAX AGE                                                       *
   659*  MAX TERM                                                      *
   660*  MAX MONTHLY BENEFIT                                           *
   661*  MAX TOTAL BENIFIT                                             *
   662*  COMPOSITE RATE (OPEN-END ONLY)                                *
   663*----------------------------------------------------------------*
   664*  PASSED TO ELRFND                                              *
   665*  ----------------                                              *
   666*  CERT ISSUE DATE                                               *
   667*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* ELRATE.cbl
   668*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   669*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   670*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   671*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   672*  STATE CODE (CLIENT DEFINED)                                   *
   673*  STATE CODE (STANDARD P.O. ABBRV)                              *
   674*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   675*  DEVIATION CODE                                                *
   676*  ISSUE AGE                                                     *
   677*  ORIGINAL BENEFIT AMOUNT                                       *
   678*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   679*  PROCESS TYPE (CANCEL)                                         *
   680*  BENEFIT KIND (LIFE OR A/H)                                    *
   681*  A.P.R.                                                        *
   682*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   683*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   684*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   685*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   686*  COMPANY I.D. (3 CHARACTER)                                    *
   687*  BENEFIT CODE                                                  *
   688*  BENEFIT OVERRIDE CODE                                         *
   689*                                                                *
   690*  RETURNED FROM ELRFND                                          *
   691*  --------------------                                          *
   692*  CALCULATED REFUND                                             *
   693*----------------------------------------------------------------*
   694*  PASSED TO ELEARN                                              *
   695*  ----------------                                              *
   696*  CERT ISSUE DATE                                               *
   697*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   698*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   699*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   700*  STATE CODE (CLIENT DEFINED)                                   *
   701*  STATE CODE (STANDARD P.O. ABBRV)                              *
   702*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   703*  DEVIATION CODE                                                *
   704*  ISSUE AGE                                                     *
   705*  ORIGINAL BENEFIT AMOUNT                                       *
   706*  BENEFIT KIND (LIFE OR A/H)                                    *
   707*  A.P.R.                                                        *
   708*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   709*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   710*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   711*  COMPANY I.D. (3 CHARACTER)                                    *
   712*  BENEFIT CODE                                                  *
   713*  BENEFIT OVERRIDE CODE                                         *
   714*                                                                *
   715*  RETURNED FROM ELEARN                                          *
   716*  --------------------                                          *
   717*  INDICATED  EARNINGS                                           *
   718*----------------------------------------------------------------*
   719*                 LENGTH = 450                                   *
   720*                                                                *
   721******************************************************************
   722******************************************************************
   723*                   C H A N G E   L O G
   724*
   725* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* ELRATE.cbl
   726*-----------------------------------------------------------------
   727*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   728* EFFECTIVE    NUMBER
   729*-----------------------------------------------------------------
   730* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   731* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   732* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   733* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   734* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   735* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   736* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   737* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   738* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   739******************************************************************
   740
   741 01  CALCULATION-PASS-AREA.
   742     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   743                                     COMP.
   744
   745     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   746       88  NO-CP-ERROR                             VALUE ZERO.
   747       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   748                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   749       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   750       88  CP-ERROR-IN-DATES                       VALUE '2'.
   751       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   752       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   753       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   754       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   755       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   756       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   757       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   758       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   759       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   760       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   761       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   762       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   763       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   764       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   765       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   766
   767     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   768       88  NO-CP-ERROR-2                           VALUE ZERO.
   769***********************  INPUT AREAS ****************************
   770
   771     12  CP-CALCULATION-AREA.
   772         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   773         16  CP-CERT-EFF-DT        PIC XX.
   774         16  CP-VALUATION-DT       PIC XX.
   775         16  CP-PAID-THRU-DT       PIC XX.
   776         16  CP-BENEFIT-TYPE       PIC X.
   777           88  CP-AH                               VALUE 'A' 'D'
   778                                                   'I' 'U'.
   779           88  CP-REDUCING-LIFE                    VALUE 'R'.
   780           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   781         16  CP-INCURRED-DT        PIC XX.
   782         16  CP-REPORTED-DT        PIC XX.
   783         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* ELRATE.cbl
   784         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   785         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   786                                     COMP-3.
   787         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   788                                     COMP-3.
   789         16  CP-CDT-METHOD         PIC X.
   790           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   791           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   792           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   793         16  CP-CLAIM-TYPE         PIC X.
   794           88  CP-AH-CLAIM                         VALUE 'A'.
   795           88  CP-LIFE-CLAIM                       VALUE 'L'.
   796         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   797                                     COMP-3.
   798         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   799                                     COMP-3.
   800         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   801                                     COMP-3.
   802         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   803                                     COMP-3.
   804         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   805                                     COMP-3.
   806         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   807                                     COMP-3.
   808         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   809                                     COMP-3.
   810         16  CP-REM-TERM-METHOD    PIC X.
   811           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   812           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   813           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   814           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   815           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   816           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   817           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   818         16  CP-EARNING-METHOD     PIC X.
   819           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   820           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   821           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   822           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   823           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   824           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   825           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   826           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   827           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   828           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   829           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   830           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   831           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   832           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   833         16  CP-PROCESS-TYPE       PIC X.
   834           88  CP-CLAIM                            VALUE '1'.
   835           88  CP-CANCEL                           VALUE '2'.
   836           88  CP-ISSUE                            VALUE '3'.
   837         16  CP-SPECIAL-CALC-CD    PIC X.
   838           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   839           88  CP-1-MTH-INTEREST               VALUE ' '.
   840           88  CP-0-MTH-INTEREST               VALUE 'A'.
   841           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* ELRATE.cbl
   842           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   843           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   844           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   845           88  CP-FARM-PLAN                    VALUE 'F'.
   846           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   847           88  CP-2-MTH-INTEREST               VALUE 'I'.
   848           88  CP-3-MTH-INTEREST               VALUE 'J'.
   849           88  CP-4-MTH-INTEREST               VALUE 'K'.
   850           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   851           88  CP-MORTGAGE-REC                 VALUE 'M'.
   852           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   853           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   854           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   855           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   856                                                     'W' 'X'.
   857           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   858           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   859           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   860           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   861           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   862           88  CP-SUMMARY-REC                  VALUE 'Z'.
   863           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   864           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   865           88  CP-AD-D-BENEFIT                 VALUE '4'.
   866           88  CP-CSL-METH-1                   VALUE '5'.
   867           88  CP-CSL-METH-2                   VALUE '6'.
   868           88  CP-CSL-METH-3                   VALUE '7'.
   869           88  CP-CSL-METH-4                   VALUE '8'.
   870
   871         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   872                                     COMP-3.
   873         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   874         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   875         16  CP-STATE              PIC XX          VALUE SPACE.
   876         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   877         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   878           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   879               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   880         16  CP-R78-OPTION         PIC X.
   881           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   882           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   883
   884         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   885         16  CP-IBNR-RESERVE-SW    PIC X.
   886         16  CP-CLAIM-STATUS       PIC X.
   887         16  CP-RATE-FILE          PIC X.
   888         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   889                                     COMP-3.
   890
   891         16  CP-LIFE-OVERRIDE-CODE PIC X.
   892         16  CP-AH-OVERRIDE-CODE   PIC X.
   893
   894         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   895                                     COMP-3.
   896         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   897                                   PIC S9(5)V99 COMP-3.
   898         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   899                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* ELRATE.cbl
   900         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   901                                     COMP-3.
   902         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   903                                     COMP-3.
   904         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   905                                  PIC S9(7)V99 COMP-3.
   906
   907         16  CP-PAID-FROM-DATE     PIC X(02).
   908         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   909         16  CP-EXT-DAYS-CALC      PIC X.
   910           88  CP-EXT-NO-CHG                   VALUE ' '.
   911           88  CP-EXT-CHG-LF                   VALUE '1'.
   912           88  CP-EXT-CHG-AH                   VALUE '2'.
   913           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   914         16  CP-DOMICILE-STATE     PIC XX.
   915         16  CP-CARRIER            PIC X.
   916         16  CP-REIN-FLAG          PIC X.
   917         16  CP-REM-TRM-CALC-OPTION PIC X.
   918           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   919                      '2' '3' '4' '5'.
   920           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   921           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   922           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   923           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   924           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   925           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   926           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   927           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   928         16  CP-SIG-SWITCH         PIC X.
   929         16  CP-RATING-METHOD      PIC X.
   930           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   931           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   932           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   933           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   934           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   935           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   936           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   937           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   938           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   939         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   940                                     COMP-3.
   941         16  CP-BEN-CATEGORY       PIC X.
   942         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   943         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   944                                   PIC S99V9(5) COMP-3.
   945         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   946         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   947                                   PIC S99V9(5) COMP-3.
   948         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   949         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   950         16  CP-EXPIRE-DT          PIC XX.
   951         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   952         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   953         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   954         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   955         16  CP-DDF-SPEC-CALC      PIC X.
   956             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   957             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* ELRATE.cbl
   958         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   959         16  CP-CANCEL-REASON      PIC X.
   960         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   961         16  CP-PMT-MODE           PIC X.
   962         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   963         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   964         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   965         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   966         16  FILLER                PIC X.
   967
   968***************    OUTPUT FROM ELRESV   ************************
   969
   970         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   971
   972         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   973                                     COMP-3.
   974         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   975                                     COMP-3.
   976         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   977                                     COMP-3.
   978         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   979                                     COMP-3.
   980         16  FILLER                PIC X(09).
   981***************    OUTPUT FROM ELRTRM   *************************
   982
   983         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   984                                     COMP-3.
   985         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   986                                     COMP-3.
   987         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   988                                     COMP-3.
   989         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   990                                     COMP-3.
   991         16  FILLER                PIC X(12).
   992
   993***************    OUTPUT FROM ELRAMT   *************************
   994
   995         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   996                                     COMP-3.
   997         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   998                                     COMP-3.
   999         16  FILLER                PIC X(12).
  1000
  1001***************    OUTPUT FROM ELRATE   *************************
  1002
  1003         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1004                                     COMP-3.
  1005         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1006                                     COMP-3.
  1007         16  CP-MORTALITY-CODE     PIC X(4).
  1008         16  CP-RATE-EDIT-FLAG     PIC X.
  1009             88  CP-RATES-NEED-APR                  VALUE '1'.
  1010         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1011                                     COMP-3.
  1012         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1013         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1014         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1015                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* ELRATE.cbl
  1016         16  FILLER                PIC X(07).
  1017
  1018***************    OUTPUT FROM ELRFND   *************************
  1019
  1020         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1021                                     COMP-3.
  1022         16  CP-REFUND-TYPE-USED   PIC X.
  1023           88  CP-R-AS-R78                         VALUE '1'.
  1024           88  CP-R-AS-PRORATA                     VALUE '2'.
  1025           88  CP-R-AS-CALIF                       VALUE '3'.
  1026           88  CP-R-AS-TEXAS                       VALUE '4'.
  1027           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1028           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1029           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1030           88  CP-R-AS-MEAN                        VALUE '8'.
  1031           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1032           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1033           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1034           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1035           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1036           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1037         16  FILLER                PIC X(12).
  1038
  1039***************    OUTPUT FROM ELEARN   *************************
  1040
  1041         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1042                                     COMP-3.
  1043         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1044                                     COMP-3.
  1045         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1046                                     COMP-3.
  1047         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1048                                     COMP-3.
  1049         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1050                                     COMP-3.
  1051         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1052                                     COMP-3.
  1053         16  CP-EARNING-TYPE-USED  PIC X.
  1054           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1055           88  CP-E-AS-R78                         VALUE '1'.
  1056           88  CP-E-AS-PRORATA                     VALUE '2'.
  1057           88  CP-E-AS-TEXAS                       VALUE '4'.
  1058           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1059           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1060           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1061           88  CP-E-AS-MEAN                        VALUE '8'.
  1062           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1063         16  FILLER                PIC X(12).
  1064
  1065***************    OUTPUT FROM ELPMNT   *************************
  1066
  1067         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1068                                     COMP-3.
  1069         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1070                                     COMP-3.
  1071         16  FILLER                PIC X(12).
  1072
  1073***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* ELRATE.cbl
  1074         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1075                                     COMP-3.
  1076         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1077                                     COMP-3.
  1078         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1079                                     COMP-3.
  1080         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1081                                     COMP-3.
  1082         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1083                                     COMP-3.
  1084         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1085                                     COMP-3.
  1086         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1087             88  OPEN-RATE-FILE                   VALUE 'O'.
  1088             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1089             88  IO-ERROR                         VALUE 'E'.
  1090
  1091         16  CP-FIRST-PAY-DATE     PIC XX.
  1092
  1093         16  CP-JOINT-INDICATOR    PIC X.
  1094
  1095         16  CP-RESERVE-REMAINING-TERM
  1096                                   PIC S9(4)V9    VALUE ZERO
  1097                                     COMP-3.
  1098
  1099         16  CP-INSURED-BIRTH-DT   PIC XX.
  1100
  1101         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1102                                     COMP-3.
  1103
  1104         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1105                                     COMP-3.
  1106
  1107         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1108                                     COMP-3.
  1109
  1110         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1111                                     COMP-3.
  1112
  1113         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1114                                     COMP-3.
  1115
  1116         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1117                                     COMP-3.
  1118
  1119         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1120                                     COMP-3.
  1121
  1122         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1123             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1124
  1125         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1126                                     COMP-3.
  1127         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1128                                     COMP-3.
  1129         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1130         16  FILLER                PIC X(15).
  1131******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* ELRATE.cbl
  1132
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* ELRATE.cbl
  1134****************************************************************
  1135*
  1136* Copyright (c) 2007 by Clerity Solutions, Inc.
  1137* All rights reserved.
  1138*
  1139****************************************************************
  1140 01  DFHEIV.
  1141   02  DFHEIV0               PIC X(35).
  1142   02  DFHEIV1               PIC X(08).
  1143   02  DFHEIV2               PIC X(08).
  1144   02  DFHEIV3               PIC X(08).
  1145   02  DFHEIV4               PIC X(06).
  1146   02  DFHEIV5               PIC X(04).
  1147   02  DFHEIV6               PIC X(04).
  1148   02  DFHEIV7               PIC X(02).
  1149   02  DFHEIV8               PIC X(02).
  1150   02  DFHEIV9               PIC X(01).
  1151   02  DFHEIV10              PIC S9(7) COMP-3.
  1152   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1153   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1154   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1155   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1156   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1157   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1158   02  DFHEIV17              PIC X(04).
  1159   02  DFHEIV18              PIC X(04).
  1160   02  DFHEIV19              PIC X(04).
  1161   02  DFHEIV20              USAGE IS POINTER.
  1162   02  DFHEIV21              USAGE IS POINTER.
  1163   02  DFHEIV22              USAGE IS POINTER.
  1164   02  DFHEIV23              USAGE IS POINTER.
  1165   02  DFHEIV24              USAGE IS POINTER.
  1166   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1167   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1168   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1169   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1170   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1171   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1172   02  FILLER                PIC X(02).
  1173   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1174   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1175   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1176   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1177   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1178 LINKAGE  SECTION.
  1179*****************************************************************
  1180*                                                               *
  1181* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1182* All rights reserved.                                          *
  1183*                                                               *
  1184*****************************************************************
  1185 01  dfheiblk.
  1186     02  eibtime          pic s9(7) comp-3.
  1187     02  eibdate          pic s9(7) comp-3.
  1188     02  eibtrnid         pic x(4).
  1189     02  eibtaskn         pic s9(7) comp-3.
  1190     02  eibtrmid         pic x(4).
  1191     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* ELRATE.cbl
  1192     02  eibcposn         pic s9(4) comp.
  1193     02  eibcalen         pic s9(4) comp.
  1194     02  eibaid           pic x(1).
  1195     02  eibfiller1       pic x(1).
  1196     02  eibfn            pic x(2).
  1197     02  eibfiller2       pic x(2).
  1198     02  eibrcode         pic x(6).
  1199     02  eibfiller3       pic x(2).
  1200     02  eibds            pic x(8).
  1201     02  eibreqid         pic x(8).
  1202     02  eibrsrce         pic x(8).
  1203     02  eibsync          pic x(1).
  1204     02  eibfree          pic x(1).
  1205     02  eibrecv          pic x(1).
  1206     02  eibsend          pic x(1).
  1207     02  eibatt           pic x(1).
  1208     02  eibeoc           pic x(1).
  1209     02  eibfmh           pic x(1).
  1210     02  eibcompl         pic x(1).
  1211     02  eibsig           pic x(1).
  1212     02  eibconf          pic x(1).
  1213     02  eiberr           pic x(1).
  1214     02  eibrldbk         pic x(1).
  1215     02  eiberrcd         pic x(4).
  1216     02  eibsynrb         pic x(1).
  1217     02  eibnodat         pic x(1).
  1218     02  eibfiller5       pic x(2).
  1219     02  eibresp          pic 9(09) comp.
  1220     02  eibresp2         pic 9(09) comp.
  1221     02  dfheigdj         pic s9(4) comp.
  1222     02  dfheigdk         pic s9(4) comp.
  1223 01  DFHCOMMAREA             PIC X(450).
  1224
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* ELRATE.cbl
  1226*01 PARMLIST              COMP.
  1227*    02  FILLER              PIC S9(8).
  1228*    02  ERRATE-POINTER      PIC S9(8).
  1229
  1230*                                COPY ERCRATE.
  1231******************************************************************
  1232*                                                                *
  1233*                                                                *
  1234*                            ERCRATE                             *
  1235*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1236*                            VMOD=2.008                          *
  1237*                                                                *
  1238*   ONLINE CREDIT SYSTEM                                         *
  1239*                                                                *
  1240*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1241*                                                                *
  1242*   FILE TYPE = VSAM,KSDS                                        *
  1243*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1244*                                                                *
  1245*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1246*       ALTERNATE PATH = NONE                                    *
  1247*                                                                *
  1248*   LOG = NO                                                     *
  1249*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1250*                                                                *
  1251******************************************************************
  1252
  1253 01  RATE-RECORD.
  1254     12  RT-RECORD-ID                      PIC XX.
  1255         88  VALID-RT-ID                      VALUE 'RT'.
  1256
  1257     12  RT-CONTROL-PRIMARY.
  1258         16  RT-COMPANY-CD                 PIC X.
  1259         16  RT-STATE-CODE.
  1260             20  RT-ST-CODE                PIC XX.
  1261             20  RT-ST-CLASS               PIC XX.
  1262             20  RT-ST-DEV                 PIC XXX.
  1263         16  RT-L-AH-CODE.
  1264             20  RT-L-AH                   PIC X.
  1265             20  RT-LAH-NUM                PIC XX.
  1266         16  RT-LIMITS.
  1267             20  RT-HIGH-AGE               PIC 99.
  1268             20  RT-HIGH-AMT               PIC 9(6).
  1269             20  RT-FUTURE                 PIC XX.
  1270             20  RT-SEX                    PIC X.
  1271         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1272
  1273     12  RT-MAINT-INFORMATION.
  1274         16  RT-LAST-MAINT-DT              PIC XX.
  1275         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1276         16  RT-LAST-MAINT-USER            PIC X(4).
  1277         16  FILLER                        PIC X(10).
  1278
  1279     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1280     12  RT-RATE-COMMENT                   PIC X(50).
  1281
  1282     12  CSL-RESERVED                      PIC X(10).
  1283     12  FILLER                            PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* ELRATE.cbl
  1284
  1285     12  RT-MAX-AGE                        PIC 99.
  1286
  1287     12  RT-LIFE-LIMS-FLDS.
  1288         16  RT-LIFE-MORT-CODE             PIC X(4).
  1289         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1290             20  RT-L-EX-AGE               PIC 99.
  1291             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1292             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1293         16  FILLER                        PIC X(20).
  1294
  1295     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1296         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1297             20  RT-AH-AGE                 PIC 99.
  1298             20  RT-AH-TERM                PIC S999       COMP-3.
  1299             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1300             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1301
  1302     12  RT-LIFE-RATES.
  1303         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1304
  1305     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1306         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1307
  1308     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1309
  1310     12  RT-DISCOUNT-OPTION                PIC X.
  1311         88  RT-DO-NOT-USE                     VALUE ' '.
  1312         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1313         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1314
  1315     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1316     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1317
  1318     12  RT-COMPOSITE-OPTION               PIC X.
  1319         88  RT-NO-COMPOSITE                   VALUE ' '.
  1320         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1321
  1322     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1323
  1324     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.
  1325     12  FILLER                            PIC X(13).
  1326
  1327     12  RT-TYPE-RATE                      PIC X.
  1328         88  RT-IS-STND                        VALUE ' ' 'S'.
  1329         88  RT-IS-OB                          VALUE 'O'.
  1330
  1331     12  RT-SRT-ALPHA                      PIC X.
  1332
  1333     12  RT-CONTROL-2.
  1334         16  RTC-1                         PIC X(7).
  1335         16  RTC-3                         PIC X(11).
  1336         16  RTC-4                         PIC 9(11) COMP-3.
  1337         16  RTC-2                         PIC X(3).
  1338******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* ELRATE.cbl
  1340 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1341 0000-DFHEXIT SECTION.
  1342     MOVE '9#                    $   ' TO DFHEIV0.
  1343     MOVE 'ELRATE' TO DFHEIV1.
  1344     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1345
  1346     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1347
  1348 000-START-PREMIUM-CALC.
  1349     MOVE ZERO                   TO CP-RETURN-CODE
  1350                                    CP-CALC-PREMIUM
  1351                                    CP-PREMIUM-RATE
  1352                                    CP-POLICY-FEE.
  1353
  1354     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1355     MOVE ALL '9'                TO ERRATE-KEY.
  1356
  1357*    IF CP-RATE-FILE = 'O'
  1358*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1359
  1360     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1361     MOVE CP-STATE               TO RATE-ST-CODE.
  1362     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1363     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1364     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1365
  1366     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1367        CP-RATING-BENEFIT-AMT = ZEROS
  1368         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1369     ELSE
  1370         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1371
  1372     IF CP-AH
  1373         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1374     ELSE
  1375         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1376
  1377     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1378     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1379     MOVE SPACE                  TO DC-OPTION-CODE.
  1380
  1381     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1382
  1383*** Y2K, PROJ 7744
  1384     IF NO-CONVERSION-ERROR
  1385         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1386                                       WS-HOLD-RATE-EXP-DT
  1387         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1388         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1389         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1390     ELSE
  1391         MOVE '2'                   TO CP-RETURN-CODE
  1392         GO TO 9999-CALC-RATE-PREM-X
  1393     END-IF.
  1394*** Y2K, PROJ 7744
  1395
  1396
  1397* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* ELRATE.cbl
  1398*        NOTFND   (9999-RATE-NOTFND)
  1399*        NOTOPEN  (9999-RATE-NOTOPEN)
  1400*        ENDFILE  (9999-RATE-NOTFND)
  1401*    END-EXEC.
  1402*    MOVE '"$IJ''                 ! " #00001392' TO DFHEIV0
  1403     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1405     MOVE X'2220233030303031333932' TO DFHEIV0(25:11)
  1406     CALL 'kxdfhei1' USING DFHEIV0
  1407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1408
  1409
  1410 0050-RATE-START-BROWSE.
  1411
  1412* EXEC CICS STARTBR
  1413*        DATASET  (ERRATE-FILE-ID)
  1414*        RIDFLD   (ERRATE-KEY)
  1415*        GTEQ
  1416*    END-EXEC.
  1417     MOVE 0
  1418       TO DFHEIV11
  1419*    MOVE '&,         G          &   #00001399' TO DFHEIV0
  1420     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1422     MOVE X'2020233030303031333939' TO DFHEIV0(25:11)
  1423     CALL 'kxdfhei1' USING DFHEIV0,
  1424           ERRATE-FILE-ID,
  1425           ERRATE-KEY,
  1426           DFHEIV99,
  1427           DFHEIV11,
  1428           DFHEIV99
  1429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1430
  1431
  1432     MOVE 'Y'                  TO WS-BROWSE-SW.
  1433
  1434 0100-READ-RATE-LOOP.
  1435
  1436* EXEC CICS READNEXT
  1437*        DATASET  (ERRATE-FILE-ID)
  1438*        SET      (ADDRESS OF RATE-RECORD)
  1439*        RIDFLD   (ERRATE-KEY)
  1440*    END-EXEC.
  1441     MOVE 0
  1442       TO DFHEIV11
  1443*    MOVE '&.S                   )   #00001408' TO DFHEIV0
  1444     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1445     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1446     MOVE X'2020233030303031343038' TO DFHEIV0(25:11)
  1447     CALL 'kxdfhei1' USING DFHEIV0,
  1448           ERRATE-FILE-ID,
  1449           DFHEIV20,
  1450           DFHEIV99,
  1451           ERRATE-KEY,
  1452           DFHEIV99,
  1453           DFHEIV11,
  1454           DFHEIV99,
  1455           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* ELRATE.cbl
  1456     SET ADDRESS OF RATE-RECORD TO
  1457         DFHEIV20
  1458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1459
  1460
  1461 0110-CHECK-KEYS.
  1462*                            COPY ELCRATPD.
  1463******************************************************************
  1464*                                                                *
  1465*                                                                *
  1466*                            ELCRATPD                            *
  1467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1468*                            VMOD=2.061                          *
  1469*                                                                *
  1470******************************************************************
  1471******************************************************************
  1472*                   C H A N G E   L O G
  1473*
  1474* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1475*-----------------------------------------------------------------
  1476*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1477* EFFECTIVE    NUMBER
  1478*-----------------------------------------------------------------
  1479* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1480* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1481* 032603                   PEMA  ADD SPECIAL AZ CALC
  1482* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1483* 120403                   PEMA  ADD SPECIAL TX CALC
  1484* 092205                   PEMA  FIX CRIT PER FOR DCC
  1485* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1486* 021207                   PEMA  ADD PA NP
  1487* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1488* 032807                   PEMA  ADD VT NP PLUS 2
  1489* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1490* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1491* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1492* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1493* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1494* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1495* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1496* 071211    2010012700001  PEMA  ADD SPPDD
  1497* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1498* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1499* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1500* 032612  CR2011110200001  PEMA  AHL CHANGES
  1501******************************************************************
  1502
  1503 0110-CHECK-KEY.
  1504     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1505        SVRT-ST-CODE    = RT-ST-CODE     AND
  1506        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1507        SVRT-ST-DEV     = RT-ST-DEV      AND
  1508        SVRT-L-AH       = RT-L-AH        AND
  1509        SVRT-LAH-NUM    = RT-LAH-NUM
  1510         NEXT SENTENCE
  1511     ELSE
  1512         GO TO 9999-RATE-NOTFND.
  1513
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* ELRATE.cbl
  1514     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1515         GO TO 9999-RATE-NOTFND.
  1516
  1517     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1518        GO TO 0100-READ-RATE-LOOP.
  1519
  1520     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1521         GO TO 0100-READ-RATE-LOOP.
  1522
  1523     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1524         GO TO 0100-READ-RATE-LOOP.
  1525
  1526     IF RT-MAX-AGE = ZEROS
  1527         NEXT SENTENCE
  1528     ELSE
  1529         COMPUTE WS-AGE =
  1530             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1531         IF WS-AGE >= RT-MAX-AGE
  1532             MOVE 'B'               TO CP-RETURN-CODE.
  1533
  1534     IF CP-LOAN-TERM NOT NUMERIC
  1535         MOVE +0                    TO CP-LOAN-TERM.
  1536
  1537     IF CP-LOAN-TERM = ZERO
  1538         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1539
  1540     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1541         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1542
  1543     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1544     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1545
  1546     IF CP-AH
  1547         GO TO 2000-TYPE-IS-AH.
  1548
  1549     IF ((RT-IS-OB)
  1550        AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1551                      OR
  1552        ((CP-COMPANY-ID = 'DCC')
  1553        AND (CP-BENEFIT-CD (1:1) = 'P'))
  1554        MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1555     ELSE
  1556        MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1557     END-IF
  1558
  1559     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1560     MOVE SPACE                     TO DC-OPTION-CODE.
  1561
  1562     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1563
  1564 1000-TYPE-IS-LIFE.
  1565     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1566
  1567     MOVE ZERO                      TO CP-R-MAX-AGE
  1568                                       CP-R-MAX-TERM
  1569                                       CP-R-MAX-MON-BEN
  1570                                       CP-R-MAX-TOT-BEN.
  1571
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* ELRATE.cbl
  1572     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1573
  1574     IF RT-POLICY-FEE NUMERIC
  1575        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  1576
  1577     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1578
  1579     IF (RT-DISCOUNT-OPTION EQUAL
  1580                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1581        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1582        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1583         NEXT SENTENCE
  1584     ELSE
  1585         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1586            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1587             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1588                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1589                 GO TO 1050-REGULAR-RATES
  1590             ELSE
  1591                 GO TO 1050-REGULAR-RATES
  1592         ELSE
  1593             GO TO 1050-REGULAR-RATES.
  1594
  1595*    display ' discount option ' rt-discount-option
  1596     IF RT-DISCOUNT-RATE NOT NUMERIC
  1597        MOVE +0                  TO RT-DISCOUNT-RATE.
  1598
  1599     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1600        NEXT SENTENCE
  1601     ELSE
  1602        MOVE +0                  TO CP-PREMIUM-RATE
  1603                                    CP-COMPOSITE-RATE
  1604                                    CP-CALC-PREMIUM
  1605         MOVE '4'                TO CP-RETURN-CODE
  1606         GO TO 9999-CALC-RATE-PREM-X.
  1607
  1608     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1609        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1610     ELSE
  1611        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1612
  1613*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1614*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1615*       GO TO 1075-BYPASS-REGULAR-RATE.
  1616
  1617     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1618        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1619        COMPUTE WS-WORK-DIS-RATE EQUAL
  1620                WS-WORK-DIS-RATE / +100
  1621        GO TO 1075-BYPASS-REGULAR-RATE.
  1622
  1623     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1624        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1625        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1626        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1627        GO TO 1075-BYPASS-REGULAR-RATE.
  1628
  1629     IF (CP-COMPANY-ID EQUAL 'GTL') AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* ELRATE.cbl
  1630        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1631        (CP-TRUNCATED-LIFE)
  1632        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1633        GO TO 1075-BYPASS-REGULAR-RATE.
  1634
  1635     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1636        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1637        (CP-EARN-AS-NET-PAY)
  1638*       (CP-TRUNCATED-LIFE)
  1639        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1640        GO TO 1075-BYPASS-REGULAR-RATE.
  1641
  1642     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1643        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1644                   AND
  1645        ((CP-EARN-AS-NET-PAY)
  1646               OR
  1647        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1648        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1649        GO TO 1075-BYPASS-REGULAR-RATE.
  1650
  1651     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1652        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1653        (CP-EARN-AS-NET-PAY) AND
  1654        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1655        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1656        GO TO 1075-BYPASS-REGULAR-RATE.
  1657
  1658     IF (CP-COMPANY-ID = 'CID')
  1659        AND (CP-STATE-STD-ABBRV = 'MN')
  1660        AND (RT-DISCOUNT-OPTION = '1')
  1661        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1662                     OR
  1663            (CP-LEVEL-LIFE)
  1664            AND (CP-CERT-EFF-DT > X'A4FF'))
  1665        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1666        GO TO 1075-BYPASS-REGULAR-RATE
  1667     END-IF
  1668     IF (CP-COMPANY-ID EQUAL 'CID')
  1669        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1670                      OR
  1671            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1672        AND (CP-EARN-AS-NET-PAY)
  1673        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1674        GO TO 1075-BYPASS-REGULAR-RATE
  1675     END-IF
  1676     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1677        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1678        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1679         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1680         GO TO 1075-BYPASS-REGULAR-RATE.
  1681
  1682     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1683        CONTINUE
  1684     ELSE
  1685        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1686           (CP-EARN-AS-NET-PAY ) AND
  1687           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* ELRATE.cbl
  1688            GO TO 1075-BYPASS-REGULAR-RATE
  1689        END-IF
  1690     END-IF
  1691     IF (CP-COMPANY-ID = 'CID') AND
  1692        (CP-EARN-AS-NET-PAY) AND
  1693        (CP-LEVEL-LIFE) AND
  1694        (CP-STATE-STD-ABBRV = 'CA') AND
  1695        (CP-STATE-STD-ABBRV = CP-STATE)
  1696        COMPUTE WS-WORK-DIS-RATE =
  1697             RT-DISCOUNT-RATE / +100
  1698        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1699        GO TO 1075-BYPASS-REGULAR-RATE
  1700     END-IF
  1701
  1702     IF (CP-COMPANY-ID = 'CID')
  1703        AND (CP-EARN-AS-NET-PAY)
  1704        AND (CP-STATE-STD-ABBRV = 'ME')
  1705        COMPUTE WS-WORK-DIS-RATE =
  1706             RT-DISCOUNT-RATE / +100
  1707        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1708        GO TO 1075-BYPASS-REGULAR-RATE
  1709     END-IF
  1710     IF (CP-COMPANY-ID = 'CID')
  1711        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1712           OR 'IN' OR 'AZ')
  1713        AND (CP-FARM-PLAN)
  1714        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1715        GO TO 1075-BYPASS-REGULAR-RATE
  1716     END-IF
  1717     IF (CP-COMPANY-ID = 'DCC')
  1718        AND (CP-BEN-CATEGORY = 'D')
  1719        AND (CP-EARN-AS-NET-PAY)
  1720        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1721        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1722           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1723*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1724*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1725*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1726*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1727        GO TO 1075-BYPASS-REGULAR-RATE
  1728     END-IF
  1729     IF (CP-COMPANY-ID = 'CID') AND
  1730        (CP-EARN-AS-NET-PAY) AND
  1731        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1732                            OR 'VT')
  1733                   OR
  1734        ((CP-STATE-STD-ABBRV = 'IN') AND
  1735        (CP-CERT-EFF-DT > X'9A7F'))
  1736                   OR
  1737        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1738        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1739        (CP-STATE-STD-ABBRV = CP-STATE)
  1740        COMPUTE WS-WORK-DIS-RATE =
  1741             RT-DISCOUNT-RATE / +100
  1742        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1743        GO TO 1075-BYPASS-REGULAR-RATE
  1744     END-IF
  1745
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* ELRATE.cbl
  1746     IF (CP-COMPANY-ID = 'CID') AND
  1747        (CP-EARN-AS-NET-PAY) AND
  1748        (CP-STATE-STD-ABBRV = 'TX') AND
  1749        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1750        (WS-DISCOUNT-OPTION NOT = ' ')
  1751        COMPUTE WS-WORK-DIS-RATE =
  1752             RT-DISCOUNT-RATE / +100
  1753        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1754        GO TO 1075-BYPASS-REGULAR-RATE
  1755     END-IF
  1756
  1757     IF (CP-COMPANY-ID = 'CID') AND
  1758        (CP-EARN-AS-NET-PAY) AND
  1759        (CP-TRUNCATED-LIFE) AND
  1760        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1761        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1762        (WS-DISCOUNT-OPTION NOT = ' ')
  1763        COMPUTE WS-WORK-DIS-RATE =
  1764             RT-DISCOUNT-RATE / +100
  1765        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1766        GO TO 1075-BYPASS-REGULAR-RATE
  1767     END-IF
  1768
  1769     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1770        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1771           COMPUTE WS-WORK-DIS-RATE EQUAL
  1772                   WS-WORK-DIS-RATE / +100.
  1773
  1774     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1775        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1776           IF CP-MONTHLY-PAYMENT EQUAL +0
  1777            IF CP-LOAN-APR GREATER THAN +2
  1778              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1779              CP-ORIGINAL-BENEFIT /
  1780               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1781               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1782            ELSE
  1783             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1784               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1785
  1786     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1787        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1788          IF WS-WORK-DIS-RATE GREATER THAN +0
  1789           COMPUTE WK1 ROUNDED EQUAL
  1790           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1791                              (WS-RATE-TERM - +1)) /
  1792                        (WS-WORK-DIS-RATE / +12)
  1793           COMPUTE WK2 ROUNDED EQUAL
  1794           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1795                              (WS-RATE-TERM)) /
  1796                        (WS-WORK-DIS-RATE / +12)
  1797           COMPUTE WK3 EQUAL
  1798                RT-DISCOUNT-OB-RATE *
  1799                (1 + WS-WORK-DIS-RATE / +12)
  1800                MOVE WK3 TO CP-PREMIUM-RATE
  1801                COMPUTE WK5 EQUAL WK3 / +1000
  1802           GO TO 1075-BYPASS-REGULAR-RATE.
  1803*               (RT-DISCOUNT-OB-RATE / +1000) *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* ELRATE.cbl
  1804*               (1 + WS-WORK-DIS-RATE / +12)
  1805*          GO TO 1075-BYPASS-REGULAR-RATE.
  1806
  1807     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1808        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1809           COMPUTE WK3 EQUAL
  1810           RT-DISCOUNT-OB-RATE *
  1811           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1812           MOVE WK3 TO CP-PREMIUM-RATE
  1813           COMPUTE WK5 EQUAL WK3 / +1000
  1814           GO TO 1075-BYPASS-REGULAR-RATE.
  1815
  1816     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1817        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1818        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1819        GO TO 1075-BYPASS-REGULAR-RATE.
  1820
  1821     COMPUTE WS-SIN-PREM-RATE =
  1822             (RT-DISCOUNT-OB-RATE / +1000) *
  1823             ((WS-RATE-TERM + +1) / +2).
  1824
  1825     COMPUTE CP-PREMIUM-RATE =
  1826             WS-SIN-PREM-RATE /
  1827             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1828             WS-RATE-TERM) / +24)).
  1829
  1830     IF CP-PREMIUM-RATE NOT = +0
  1831        MULTIPLY +100 BY CP-PREMIUM-RATE
  1832        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1833        GO TO 1075-BYPASS-REGULAR-RATE.
  1834
  1835 1050-REGULAR-RATES.
  1836
  1837     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1838        COMPUTE WK5 EQUAL
  1839        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1840        (6 * (WS-RATE-TERM + 1))
  1841        MOVE WK5 TO CP-PREMIUM-RATE
  1842        GO TO 1075-BYPASS-REGULAR-RATE.
  1843
  1844     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1845        (CP-CSL-VALID-NP-BENEFIT-CD)
  1846        IF CP-JOINT-INDICATOR EQUAL 'J'
  1847           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1848           GO TO 1075-BYPASS-REGULAR-RATE
  1849        ELSE
  1850           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1851           GO TO 1075-BYPASS-REGULAR-RATE.
  1852
  1853     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1854        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1855        (CP-EARN-AS-NET-PAY )
  1856        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1857        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1858        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1859        MOVE '1'                 TO DC-OPTION-CODE
  1860        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1861        IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* ELRATE.cbl
  1862            MOVE '2'                TO CP-RETURN-CODE
  1863            GO TO 9999-CALC-RATE-PREM-X
  1864        ELSE
  1865            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1866                                         DC-ODD-DAYS-OVER
  1867            GO TO 1075-BYPASS-REGULAR-RATE.
  1868
  1869     IF RT-COMPOSITE-RATE NOT NUMERIC
  1870         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1871
  1872*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1873     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1874         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1875                                              WS-PREMIUM-RATE
  1876         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1877     ELSE
  1878         MOVE +0                           TO CP-PREMIUM-RATE
  1879                                              CP-COMPOSITE-RATE
  1880                                              CP-CALC-PREMIUM
  1881         GO TO 9999-CALC-RATE-PREM-X.
  1882
  1883     IF (CP-COMPANY-ID EQUAL 'CID')
  1884        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1885        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1886        AND (CP-EARN-AS-NET-PAY)
  1887        GO TO 1075-BYPASS-REGULAR-RATE
  1888     END-IF
  1889******************************************************
  1890*    IF CP-COMPANY-ID NOT = 'LBL'
  1891     IF CP-COMPANY-ID NOT = 'LBL' AND 'CID'
  1892         GO TO 1075-BYPASS-REGULAR-RATE.
  1893
  1894     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1895     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1896     MOVE '1'                    TO DC-OPTION-CODE.
  1897     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1898     IF DATE-CONVERSION-ERROR
  1899         MOVE '2'                TO CP-RETURN-CODE
  1900         GO TO 9999-CALC-RATE-PREM-X
  1901       ELSE
  1902         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1903         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1904
  1905     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1906        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1907        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1908
  1909     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1910        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1911           NEXT SENTENCE
  1912         ELSE
  1913           GO TO 1075-BYPASS-REGULAR-RATE
  1914       ELSE
  1915        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1916           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1917           NEXT SENTENCE
  1918         ELSE
  1919           GO TO 1075-BYPASS-REGULAR-RATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* ELRATE.cbl
  1920
  1921     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1922        COMPUTE CP-PREMIUM-RATE =
  1923        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1924         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1925         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1926
  1927     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1928        COMPUTE CP-PREMIUM-RATE =
  1929        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1930        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1931        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1932        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1933         * (CP-ORIGINAL-TERM - 1)).
  1934******************************************************
  1935
  1936 1075-BYPASS-REGULAR-RATE.
  1937
  1938     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1939
  1940     MOVE +1 TO LINDX.
  1941
  1942     IF CP-COMPANY-ID EQUAL 'CRI'
  1943        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  1944           MOVE +5               TO LINDX
  1945           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1946              MOVE 'F'           TO CP-RETURN-CODE
  1947              GO TO 1200-CALCULATE-PREMIUMS.
  1948
  1949     IF RT-L-EX-AGE (LINDX) = ZERO
  1950          GO TO 1200-CALCULATE-PREMIUMS.
  1951
  1952 1100-SEARCH-LIFE-LIMITS.
  1953
  1954     IF CP-COMPANY-ID EQUAL 'CRI'
  1955        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  1956           IF LINDX GREATER THAN +4
  1957              MOVE 'A'           TO CP-RETURN-CODE
  1958              GO TO 1200-CALCULATE-PREMIUMS.
  1959
  1960     IF LINDX GREATER +8
  1961         MOVE 'A'                TO CP-RETURN-CODE
  1962         GO TO 1200-CALCULATE-PREMIUMS.
  1963
  1964     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  1965         IF RT-L-EX-AGE (LINDX) = ZEROS
  1966             ADD +1              TO LINDX
  1967             GO TO 1100-SEARCH-LIFE-LIMITS
  1968         ELSE
  1969             MOVE RT-L-EX-AGE (LINDX)
  1970                                 TO CP-R-MAX-AGE
  1971             MOVE RT-L-EX-TERM (LINDX)
  1972                                 TO CP-R-MAX-TERM
  1973             MOVE RT-L-EX-FACE (LINDX)
  1974                                 TO CP-R-MAX-TOT-BEN
  1975             ADD +1              TO LINDX
  1976             GO TO 1100-SEARCH-LIFE-LIMITS
  1977     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* ELRATE.cbl
  1978         MOVE RT-L-EX-AGE (LINDX)
  1979                                 TO CP-R-MAX-AGE
  1980         MOVE RT-L-EX-TERM (LINDX)
  1981                                 TO CP-R-MAX-TERM
  1982         MOVE RT-L-EX-FACE (LINDX)
  1983                                 TO CP-R-MAX-TOT-BEN.
  1984
  1985     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  1986         MOVE '9'                TO CP-RETURN-CODE.
  1987
  1988     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  1989         MOVE '8'                TO CP-RETURN-CODE.
  1990
  1991 1200-CALCULATE-PREMIUMS.
  1992
  1993     IF CP-COMPANY-ID = 'CSL'
  1994        IF CP-CSL-VALID-NP-BENEFIT-CD
  1995           GO TO 1240-NET-PAY-CONT
  1996        ELSE
  1997           GO TO 1250-CSL-CALC.
  1998
  1999     IF CP-COMPANY-ID = 'WDS'
  2000        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  2001           IF CP-EARN-AS-REG-BALLOON
  2002              GO TO 1240-NET-PAY-CONT.
  2003
  2004     IF (CP-COMPANY-ID = 'CID')
  2005        AND (CP-STATE-STD-ABBRV = 'MN')
  2006        AND (CP-EARN-AS-REG-BALLOON)
  2007        AND (CP-CERT-EFF-DT > X'A4FF')
  2008        GO TO 1240-NET-PAY-CONT
  2009     END-IF
  2010     IF (CP-COMPANY-ID = 'CID')
  2011        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2012           OR 'IN' OR 'AZ')
  2013        AND (CP-FARM-PLAN)
  2014***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  2015***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2016        MOVE +1.0                TO CP-LOAN-APR
  2017        GO TO 1240-NET-PAY-CONT
  2018     END-IF
  2019     IF CP-RATE-AS-STANDARD
  2020         GO TO 1210-REGULAR-RATE.
  2021
  2022     IF CP-CRITICAL-PERIOD
  2023         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2024
  2025     IF CP-EARN-AS-TEXAS
  2026         GO TO 1230-TEXAS-CONT.
  2027
  2028     IF CP-EARN-AS-NET-PAY
  2029        IF CP-STATE-STD-ABBRV = 'MD'
  2030          IF CP-COMPANY-ID = 'MON'
  2031            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2032                               '14' OR '26' OR '47'
  2033              GO TO 1210-REGULAR-RATE.
  2034
  2035     IF CP-SPECIAL-CALC-CD EQUAL 'H'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* ELRATE.cbl
  2036        IF CP-MONTHLY-PAYMENT EQUAL +0
  2037           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2038                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2039
  2040     IF CP-COMPANY-ID EQUAL 'GTL'
  2041        NEXT SENTENCE
  2042     ELSE
  2043     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2044        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2045           COMPUTE WK3 ROUNDED EQUAL
  2046           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2047           CP-MONTHLY-PAYMENT
  2048           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2049           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2050           CP-ALTERNATE-BENEFIT)
  2051           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2052           WK3 * WK5
  2053           GO TO 9999-CALC-RATE-PREM-X
  2054        ELSE
  2055           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2056           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2057           (WS-WORK-DIS-RATE / +12)
  2058           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2059           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2060                               WK5
  2061           GO TO 9999-CALC-RATE-PREM-X.
  2062
  2063     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2064        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2065        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2066        CP-ORIGINAL-TERM LESS THAN +61
  2067        COMPUTE CP-CALC-PREMIUM EQUAL
  2068                        (CP-ORIGINAL-BENEFIT *
  2069           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2070           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2071        COMPUTE CP-CALC-PREMIUM EQUAL
  2072                CP-CALC-PREMIUM +
  2073              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2074        (CP-ORIGINAL-TERM + 1)) /
  2075        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2076        GO TO 9999-CALC-RATE-PREM-X.
  2077
  2078     IF CP-COMPANY-ID = 'GTL'     AND
  2079        CP-STATE-STD-ABBRV = 'PA' AND
  2080        CP-SPECIAL-CALC-CD = 'H'
  2081         GO TO 1260-GTL-PA-LEASE.
  2082
  2083     IF (CP-EARN-AS-NET-PAY)
  2084        AND (CP-LOAN-APR > ZEROS)
  2085        GO TO 1240-NET-PAY-CONT
  2086     END-IF
  2087
  2088     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2089         GO TO 1210-REGULAR-RATE.
  2090
  2091**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2092**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2093****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* ELRATE.cbl
  2094     IF CP-DEVIATION-CODE = 'LEV' AND
  2095        CP-LOAN-APR = ZEROS
  2096         GO TO 1210-REGULAR-RATE.
  2097
  2098     IF (CP-STATE-STD-ABBRV = 'OH')
  2099        AND (CP-CLASS-CODE NOT = 'L ')
  2100        AND (CP-ORIGINAL-TERM > 60)
  2101        AND (DC-GREG-DATE-CYMD > 19831031)
  2102        AND (CP-LOAN-APR > ZEROS)
  2103        GO TO 1240-NET-PAY-CONT
  2104     END-IF
  2105
  2106     IF (CP-STATE-STD-ABBRV = 'UT')
  2107        AND (CP-ORIGINAL-TERM > 62)
  2108        AND (DC-GREG-DATE-CYMD > 19810831)
  2109        AND (DC-GREG-DATE-CYMD < 19830901)
  2110        AND (CP-LOAN-APR > ZEROS)
  2111        GO TO 1240-NET-PAY-CONT
  2112     END-IF
  2113
  2114     IF (CP-STATE-STD-ABBRV = 'RI')
  2115        AND (CP-ORIGINAL-TERM > 60)
  2116        AND (DC-GREG-DATE-CYMD > 19831231)
  2117        AND (CP-LOAN-APR > ZEROS)
  2118        GO TO 1240-NET-PAY-CONT
  2119     END-IF
  2120     .
  2121 1210-REGULAR-RATE.
  2122
  2123     IF (CP-COMPANY-ID = 'CID')
  2124        AND (CP-EARN-AS-NET-PAY)
  2125        AND (CP-LOAN-APR = 0)
  2126        IF RT-L-RATE (WS-RATE-TERM) = 0
  2127           COMPUTE WS-SIN-PREM-RATE =
  2128              (RT-DISCOUNT-OB-RATE / +1000) *
  2129              ((WS-RATE-TERM + +1) / +2)
  2130           COMPUTE CP-PREMIUM-RATE =
  2131              WS-SIN-PREM-RATE /
  2132              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2133              WS-RATE-TERM) / +24))
  2134        ELSE
  2135           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2136        END-IF
  2137     END-IF
  2138*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2139*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2140*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2141*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2142*
  2143*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2144*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2145*          COMPUTE WK3 ROUNDED EQUAL
  2146*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2147*          CP-MONTHLY-PAYMENT
  2148*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2149*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2150*          CP-ALTERNATE-BENEFIT)
  2151*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* ELRATE.cbl
  2152*          WK3 * WK5
  2153*          GO TO 9999-CALC-RATE-PREM-X
  2154*       ELSE
  2155*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2156*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2157*          (WS-WORK-DIS-RATE / +12)
  2158*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2159*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2160*                              WK5
  2161*          GO TO 9999-CALC-RATE-PREM-X.
  2162
  2163     IF CP-TERM-IS-DAYS
  2164         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2165             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2166         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2167             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2168                          * CP-TERM-OR-EXT-DAYS
  2169           GO TO 9999-CALC-RATE-PREM-X.
  2170
  2171     if (cp-company-id = 'AHL')
  2172        and (cp-loan-term > cp-original-term)
  2173        continue
  2174     else
  2175     IF NOT CP-TRUNCATED-LIFE
  2176         GO TO 1212-GROSS-NOT-TRUNCATED
  2177        end-if
  2178     end-if
  2179
  2180****  GROSS TRUNCATED CALCULATION
  2181
  2182     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2183         MOVE 'H'                TO  CP-RETURN-CODE
  2184         GO TO 9999-CALC-RATE-PREM-X.
  2185
  2186     if cp-company-id = 'AHL'
  2187        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2188           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2189           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2190           cp-original-term) * (cp-loan-term - cp-original-term
  2191            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2192            cp-premium-rate / 100 * cp-original-term /
  2193            cp-loan-term * cp-original-benefit
  2194        else
  2195           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2196           cp-original-term) * (cp-loan-term - cp-original-term
  2197            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2198            cp-premium-rate * cp-original-benefit / 100
  2199        end-if
  2200        go to 9999-calc-rate-prem-x
  2201     end-if
  2202
  2203     IF CP-COMPANY-ID = 'NCL'
  2204         COMPUTE WK-MONTHLY-RATE =
  2205               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2206                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2207                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2208                                 /
  2209                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* ELRATE.cbl
  2210                                 *
  2211                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2212         COMPUTE CP-CALC-PREMIUM =
  2213                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2214     ELSE
  2215         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2216                                 CP-ORIGINAL-TERM
  2217         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2218                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2219                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2220                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2221     END-IF
  2222     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2223        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2224           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2225           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2226     END-IF
  2227     GO TO 9999-CALC-RATE-PREM-X
  2228     .
  2229 1212-GROSS-NOT-TRUNCATED.
  2230*    DISPLAY ' ELCRATPD '
  2231*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2232*    display ' premium rate ' cp-premium-rate
  2233
  2234     IF (CP-COMPANY-ID = 'CID')
  2235        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2236           OR 'IN')
  2237        AND (CP-BENEFIT-CD = '55' OR '56')
  2238        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2239          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2240          (CP-ORIGINAL-TERM) *
  2241          ((CP-ORIGINAL-TERM) / 12) *
  2242          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2243          GO TO 9999-CALC-RATE-PREM-X
  2244     END-IF
  2245     IF (CP-COMPANY-ID = 'CID')
  2246        AND (CP-STATE-STD-ABBRV = 'GA')
  2247        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2248        COMPUTE WK3 ROUNDED =
  2249          CP-ORIGINAL-BENEFIT *
  2250          ((CP-ORIGINAL-TERM + 1) / 2) *
  2251          (RT-DISCOUNT-OB-RATE / 1000)
  2252          MOVE WK3 TO CP-CALC-PREMIUM
  2253          GO TO 9999-CALC-RATE-PREM-X
  2254     END-IF
  2255     IF (CP-COMPANY-ID EQUAL 'CID')
  2256        AND (CP-STATE-STD-ABBRV = 'MN')
  2257        AND (CP-LEVEL-LIFE)
  2258        AND (CP-CERT-EFF-DT > X'A4FF')
  2259        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2260        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2261        MOVE '1'                 TO DC-OPTION-CODE
  2262        PERFORM 9100-CONVERT-DATE
  2263                                 THRU 9100-EXIT
  2264        IF DATE-CONVERSION-ERROR
  2265           MOVE '2'              TO CP-RETURN-CODE
  2266           MOVE ZEROS            TO FACTOR
  2267                                 CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* ELRATE.cbl
  2268           GO TO 9999-CALC-RATE-PREM-X
  2269        END-IF
  2270        MOVE DC-ELAPSED-DAYS     TO D
  2271        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2272           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2273           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2274        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2275           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2276        GO TO 9999-CALC-RATE-PREM-X
  2277     END-IF
  2278     IF (CP-COMPANY-ID = 'CID')
  2279        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2280        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2281           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2282     ELSE
  2283        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2284                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2285     END-IF
  2286*    display ' calc premium ' cp-calc-premium
  2287
  2288*    IF CP-COMPANY-ID = 'LBL'
  2289     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2290        AND (NOT CP-EARN-AS-NET-PAY)
  2291        GO TO 9999-CALC-RATE-PREM-X
  2292     END-IF
  2293
  2294*    display ' fell through to ext days '
  2295     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2296         GO TO 9999-CALC-RATE-PREM-X.
  2297
  2298     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2299         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2300            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2301               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2302
  2303     GO TO 9999-CALC-RATE-PREM-X.
  2304
  2305 1220-CRITICAL-PERIOD-LF-CONT.
  2306     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2307               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2308
  2309     GO TO 9999-CALC-RATE-PREM-X.
  2310
  2311 1230-TEXAS-CONT.
  2312     IF CP-FARM-PLAN
  2313         GO TO 1235-TEXAS-FARM-CONT.
  2314
  2315     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2316               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2317
  2318     COMPUTE TEX-FACT-9 =
  2319                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2320                 (CP-ORIGINAL-TERM + 1).
  2321
  2322     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2323                 CP-CALC-PREMIUM * TEX-FACT-9.
  2324
  2325     GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* ELRATE.cbl
  2326
  2327 1235-TEXAS-FARM-CONT.
  2328     COMPUTE WS-FARM-TERM =
  2329               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2330
  2331     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2332     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2333
  2334
  2335     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2336              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2337
  2338     GO TO 9999-CALC-RATE-PREM-X.
  2339
  2340 1240-NET-PAY-CONT.
  2341
  2342     MOVE CP-LOAN-APR             TO N-P-APR.
  2343     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2344                                     N-P-REM
  2345                                     N-P-LOAN.
  2346
  2347     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2348
  2349     IF CP-TRUNCATED-LIFE
  2350         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2351
  2352     IF CP-COMPANY-ID EQUAL 'NCL'
  2353        NEXT SENTENCE
  2354     ELSE
  2355        GO TO 1241-NET-PAY-CONT.
  2356
  2357     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2358     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2359     MOVE '1'                    TO DC-OPTION-CODE
  2360     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2361     IF DATE-CONVERSION-ERROR
  2362         MOVE '2'                TO CP-RETURN-CODE
  2363         GO TO 9999-CALC-RATE-PREM-X
  2364     ELSE
  2365        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2366        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2367
  2368     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2369        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2370        NEXT SENTENCE
  2371     ELSE
  2372        MOVE +1                  TO ODF
  2373        GO TO 1241-NET-PAY-CONT.
  2374
  2375     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2376        COMPUTE CP-PREMIUM-RATE EQUAL
  2377        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2378        CP-PREMIUM-RATE) *
  2379        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2380
  2381     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2382        COMPUTE CP-PREMIUM-RATE EQUAL
  2383        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* ELRATE.cbl
  2384        N-P-LOAN * (N-P-LOAN - 1))) *
  2385        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2386        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2387
  2388     COMPUTE ODF EQUAL
  2389     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2390     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2391
  2392 1241-NET-PAY-CONT.
  2393
  2394     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2395
  2396*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2397     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2398        NEXT SENTENCE
  2399     ELSE
  2400        GO TO 9999-CALC-RATE-PREM-X.
  2401
  2402     IF RT-DISCOUNT-OPTION EQUAL '6'
  2403         GO TO 9999-CALC-RATE-PREM-X.
  2404
  2405     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2406        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2407        GO TO 9999-CALC-RATE-PREM-X.
  2408
  2409     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2410
  2411     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2412        GO TO 9999-CALC-RATE-PREM-X.
  2413
  2414     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2415        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2416        (CP-TRUNCATED-LIFE)
  2417        GO TO 9999-CALC-RATE-PREM-X.
  2418
  2419     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2420        (CP-CSL-VALID-NP-BENEFIT-CD)
  2421        GO TO 9999-CALC-RATE-PREM-X.
  2422
  2423     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2424        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2425        (CP-EARN-AS-NET-PAY)
  2426        GO TO 9999-CALC-RATE-PREM-X.
  2427
  2428*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2429*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2430*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2431*       GO TO 9999-CALC-RATE-PREM-X.
  2432
  2433     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2434        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2435        (CP-EARN-AS-NET-PAY)
  2436        GO TO 9999-CALC-RATE-PREM-X.
  2437
  2438     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2439        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2440        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2441        GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* ELRATE.cbl
  2442
  2443     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2444        (CP-EARN-AS-NET-PAY)
  2445        GO TO 9999-CALC-RATE-PREM-X.
  2446
  2447     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2448        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2449        (CP-TRUNCATED-LIFE)
  2450        GO TO 9999-CALC-RATE-PREM-X.
  2451
  2452     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2453        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2454        (CP-EARN-AS-NET-PAY)
  2455*       (CP-TRUNCATED-LIFE)
  2456        GO TO 9999-CALC-RATE-PREM-X.
  2457
  2458     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2459        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2460                   AND
  2461        ((CP-EARN-AS-NET-PAY)
  2462               OR
  2463        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2464        GO TO 9999-CALC-RATE-PREM-X.
  2465
  2466     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2467        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2468        (CP-EARN-AS-NET-PAY) AND
  2469        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2470        GO TO 9999-CALC-RATE-PREM-X.
  2471
  2472     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2473        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2474        (CP-EARN-AS-NET-PAY)
  2475        GO TO 9999-CALC-RATE-PREM-X.
  2476
  2477     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2478        CONTINUE
  2479     ELSE
  2480        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2481           (CP-EARN-AS-NET-PAY) AND
  2482           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2483           GO TO 9999-CALC-RATE-PREM-X
  2484        END-IF
  2485     END-IF
  2486
  2487     IF (CP-COMPANY-ID = 'CID')
  2488        AND (CP-EARN-AS-NET-PAY)
  2489        AND (CP-STATE-STD-ABBRV = 'ME')
  2490        GO TO 9999-CALC-RATE-PREM-X
  2491     END-IF
  2492     IF (CP-COMPANY-ID = 'DCC')
  2493        AND (CP-BEN-CATEGORY = 'D')
  2494        AND (CP-EARN-AS-NET-PAY)
  2495        GO TO 9999-CALC-RATE-PREM-X
  2496     END-IF
  2497     IF (CP-COMPANY-ID = 'CID')
  2498        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2499           OR 'IN' OR 'AZ')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* ELRATE.cbl
  2500        AND (CP-FARM-PLAN)
  2501        GO TO 9999-CALC-RATE-PREM-X
  2502     END-IF
  2503     IF (CP-COMPANY-ID = 'CID') AND
  2504        (CP-EARN-AS-NET-PAY) AND
  2505        (CP-LEVEL-LIFE) AND
  2506        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2507        (CP-STATE-STD-ABBRV = CP-STATE)
  2508        GO TO 9999-CALC-RATE-PREM-X
  2509     END-IF
  2510
  2511     IF (CP-COMPANY-ID = 'CID') AND
  2512        (CP-EARN-AS-NET-PAY) AND
  2513        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2514                            OR 'VT')
  2515                   OR
  2516        ((CP-STATE-STD-ABBRV = 'IN') AND
  2517        (CP-CERT-EFF-DT > X'9A7F'))
  2518                   OR
  2519        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2520        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2521        (CP-STATE-STD-ABBRV = CP-STATE)
  2522        GO TO 9999-CALC-RATE-PREM-X
  2523     END-IF
  2524
  2525     IF (CP-COMPANY-ID = 'CID') AND
  2526        (CP-EARN-AS-NET-PAY) AND
  2527        (CP-STATE-STD-ABBRV = 'TX') AND
  2528        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2529        (WS-DISCOUNT-OPTION NOT = ' ')
  2530        GO TO 9999-CALC-RATE-PREM-X
  2531     END-IF
  2532
  2533     IF (CP-COMPANY-ID = 'CID')
  2534        AND (CP-STATE-STD-ABBRV = 'MN')
  2535        AND (RT-DISCOUNT-OPTION = '1')
  2536        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2537        GO TO 9999-CALC-RATE-PREM-X
  2538     END-IF
  2539     IF (CP-COMPANY-ID = 'CID')
  2540        AND (CP-EARN-AS-NET-PAY)
  2541        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2542                      OR
  2543            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2544        GO TO 9999-CALC-RATE-PREM-X
  2545     END-IF
  2546     IF (CP-COMPANY-ID = 'CID')
  2547        AND (CP-EARN-AS-NET-PAY)
  2548        AND (CP-STATE-STD-ABBRV = 'SC')
  2549        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2550        GO TO 9999-CALC-RATE-PREM-X
  2551     END-IF
  2552     IF (CP-COMPANY-ID = 'CID') AND
  2553        (CP-EARN-AS-NET-PAY) AND
  2554        (CP-TRUNCATED-LIFE) AND
  2555        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2556        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2557        (WS-DISCOUNT-OPTION NOT = ' ')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* ELRATE.cbl
  2558        GO TO 9999-CALC-RATE-PREM-X
  2559     END-IF
  2560
  2561     IF (CP-COMPANY-ID EQUAL 'DCC') AND
  2562        (CP-EARN-AS-NET-PAY)
  2563        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2564        GO TO 9999-CALC-RATE-PREM-X
  2565     END-IF
  2566
  2567     IF (CP-COMPANY-ID EQUAL 'CID')
  2568        AND (CP-EARN-AS-NET-PAY)
  2569        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2570        GO TO 9999-CALC-RATE-PREM-X
  2571     END-IF
  2572
  2573     IF (RT-IS-OB) AND
  2574        (CP-COMPANY-ID NOT EQUAL 'CID')
  2575        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2576               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2577      ELSE
  2578         IF (CP-COMPANY-ID = 'DCC')
  2579            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2580            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2581*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2582             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2583               CP-ORIGINAL-TERM
  2584             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2585             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2586        ELSE
  2587           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2588               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2589        END-IF
  2590     END-IF
  2591
  2592     IF CP-ROA-PREM-AT-REFUND
  2593         COMPUTE NET-BEN ROUNDED =
  2594             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2595     ELSE
  2596         COMPUTE NET-BEN ROUNDED =
  2597              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2598
  2599     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2600        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2601          COMPUTE NET-BEN ROUNDED =
  2602              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2603                         (CP-TERM-OR-EXT-DAYS / 30)).
  2604
  2605     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2606*       OR 'DCC'
  2607*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2608     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2609       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2610       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2611                        * CP-ORIGINAL-TERM / 1200))
  2612     ELSE
  2613     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2614       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2615       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* ELRATE.cbl
  2616
  2617****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2618****** INTEREST IS CHARGED ON PREMIUM.
  2619
  2620*    IF CP-STATE-STD-ABBRV = 'MI'
  2621*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2622*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2623
  2624     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2625
  2626     GO TO 9999-CALC-RATE-PREM-X.
  2627
  2628******
  2629****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2630******
  2631
  2632 1250-CSL-CALC.
  2633     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2634     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2635     MOVE '1' TO DC-OPTION-CODE.
  2636     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2637
  2638     IF DATE-CONVERSION-ERROR
  2639         MOVE '2' TO CP-RETURN-CODE
  2640         GO TO 9999-CALC-RATE-PREM-X.
  2641
  2642     IF CP-JOINT-INDICATOR = 'J'
  2643         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2644     ELSE
  2645         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2646
  2647     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2648     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2649
  2650     IF CP-PAY-FREQUENCY = 12
  2651         MOVE 01               TO WS-PAY-SCH.
  2652     IF CP-PAY-FREQUENCY = 04
  2653         MOVE 03               TO WS-PAY-SCH.
  2654     IF CP-PAY-FREQUENCY = 02
  2655         MOVE 06               TO WS-PAY-SCH.
  2656     IF CP-PAY-FREQUENCY = 01
  2657         MOVE 12               TO WS-PAY-SCH.
  2658
  2659     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2660     IF CP-PAY-FREQUENCY NOT = 12
  2661         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2662                                WS-NUM-PAYMTS.
  2663
  2664     IF CP-STATE = 'SC'  AND
  2665       (CP-BENEFIT-CD = '07'  OR  '08')
  2666         GO TO 1250-CSL-CALC-LIFE-6.
  2667
  2668     IF CP-CSL-METH-1
  2669         GO TO 1250-CSL-CALC-LIFE-1.
  2670
  2671     IF CP-CSL-METH-2
  2672         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2673                          WS-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* ELRATE.cbl
  2674             GO TO 1250-CSL-CALC-LIFE-2
  2675         ELSE
  2676             GO TO 1250-CSL-CALC-LIFE-1.
  2677
  2678     IF CP-CSL-METH-3
  2679         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2680             GO TO 1250-CSL-CALC-LIFE-2
  2681         ELSE
  2682             GO TO 1250-CSL-CALC-LIFE-3.
  2683
  2684     IF CP-CSL-METH-4
  2685         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2686                          WS-MAX-TOT-BEN
  2687             GO TO 1250-CSL-CALC-LIFE-5
  2688         ELSE
  2689             GO TO 1250-CSL-CALC-LIFE-4.
  2690
  2691 1250-CSL-CALC-LIFE-1.
  2692     IF CP-JOINT-INDICATOR = 'J'
  2693         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2694     ELSE
  2695         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2696
  2697     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2698                    365) - 1) * 365 / 12.
  2699     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2700                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2701                    4380.
  2702     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2703                    WS-NUM-PAYMTS * WK-S.
  2704
  2705     GO TO 9999-CALC-RATE-PREM-X.
  2706
  2707 1250-CSL-CALC-LIFE-2.
  2708     IF CP-JOINT-INDICATOR = 'J'
  2709         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2710     ELSE
  2711         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2712
  2713     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2714     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2715     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2716                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2717                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2718     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2719                    WK-S) + WK-D.
  2720
  2721     GO TO 9999-CALC-RATE-PREM-X.
  2722
  2723 1250-CSL-CALC-LIFE-3.
  2724     IF CP-JOINT-INDICATOR = 'J'
  2725         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2726     ELSE
  2727         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2728
  2729     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2730     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2731     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* ELRATE.cbl
  2732                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2733                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2734     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2735                    WK-S) + WK-D.
  2736
  2737     GO TO 9999-CALC-RATE-PREM-X.
  2738
  2739 1250-CSL-CALC-LIFE-4.
  2740     IF CP-JOINT-INDICATOR = 'J'
  2741         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2742     ELSE
  2743         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2744
  2745     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2746     COMPUTE WK-S ROUNDED =
  2747                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2748                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2749                    CP-PAY-FREQUENCY.
  2750     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2751                    WS-NUM-PAYMTS * WK-S.
  2752
  2753     GO TO 9999-CALC-RATE-PREM-X.
  2754
  2755 1250-CSL-CALC-LIFE-5.
  2756     IF CP-JOINT-INDICATOR = 'J'
  2757         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2758     ELSE
  2759         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2760
  2761     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2762     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2763                    CP-PAY-FREQUENCY.
  2764     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2765                    - 1) + WS-NUM-PAYMTS) * 12) /
  2766                    CP-PAY-FREQUENCY.
  2767     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2768     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2769                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2770
  2771     GO TO 9999-CALC-RATE-PREM-X.
  2772
  2773 1250-CSL-CALC-LIFE-6.
  2774
  2775     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2776                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2777
  2778     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2779                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2780
  2781     GO TO 9999-CALC-RATE-PREM-X.
  2782
  2783******
  2784****** END OF PREMIUM CALCULATIONS FOR CSL
  2785******
  2786
  2787 1260-GTL-PA-LEASE.
  2788
  2789     IF CP-REDUCING-LIFE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* ELRATE.cbl
  2790         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2791                                 TO  CP-PREMIUM-RATE
  2792         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2793                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2794     ELSE
  2795         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2796                                 TO  CP-PREMIUM-RATE
  2797         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2798                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2799                 (+1 + CP-SALES-TAX) / +100.
  2800
  2801     GO TO 9999-CALC-RATE-PREM-X.
  2802
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* ELRATE.cbl
  2804******************************************************************
  2805 2000-TYPE-IS-AH.
  2806     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2807
  2808     MOVE ZERO                      TO CP-R-MAX-AGE
  2809                                       CP-R-MAX-TERM
  2810                                       CP-R-MAX-MON-BEN
  2811                                       CP-R-MAX-TOT-BEN.
  2812
  2813     IF RT-POLICY-FEE NUMERIC
  2814        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  2815
  2816     IF RT-COMPOSITE-RATE NOT NUMERIC
  2817        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2818
  2819     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2820        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2821                                 TO CP-PREMIUM-RATE
  2822                                    WS-PREMIUM-RATE
  2823        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2824     ELSE
  2825         MOVE +0                 TO CP-PREMIUM-RATE
  2826                                    CP-CALC-PREMIUM
  2827         GO TO 9999-CALC-RATE-PREM-X
  2828     END-IF
  2829
  2830     IF (CP-COMPANY-ID = 'DCC')
  2831        AND ((CP-BENEFIT-CD (1:1) = 'P')
  2832        OR (CP-DDF-SPEC-CALC = 'T'))
  2833        AND (CP-LOAN-TERM > ZERO AND < 361)
  2834        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2835                                 TO CP-PREMIUM-RATE
  2836                                    WS-PREMIUM-RATE
  2837     END-IF
  2838     MOVE +1 TO AHNDX.
  2839
  2840     IF CP-COMPANY-ID EQUAL 'CRI'
  2841        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2842           MOVE +5               TO AHNDX
  2843           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2844              MOVE 'F'           TO CP-RETURN-CODE
  2845              GO TO 2200-CALCULATE-PREMIUMS.
  2846
  2847     IF RT-AH-AGE (AHNDX) = ZERO
  2848          GO TO 2200-CALCULATE-PREMIUMS.
  2849
  2850 2100-SEARCH-AH-LIMITS.
  2851
  2852     IF CP-COMPANY-ID EQUAL 'CRI'
  2853        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2854           IF AHNDX GREATER THAN +4
  2855              MOVE 'A'             TO CP-RETURN-CODE
  2856              GO TO 2200-CALCULATE-PREMIUMS.
  2857
  2858     IF AHNDX GREATER +8
  2859         MOVE 'A'                TO CP-RETURN-CODE
  2860         GO TO 2200-CALCULATE-PREMIUMS.
  2861
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* ELRATE.cbl
  2862     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2863         IF RT-AH-AGE (AHNDX) = ZEROS
  2864             ADD +1               TO AHNDX
  2865             GO TO 2100-SEARCH-AH-LIMITS
  2866         ELSE
  2867             MOVE RT-AH-AGE (AHNDX)
  2868                                 TO CP-R-MAX-AGE
  2869             MOVE RT-AH-TERM (AHNDX)
  2870                                 TO CP-R-MAX-TERM
  2871             MOVE RT-AH-BEN-M (AHNDX)
  2872                                 TO CP-R-MAX-MON-BEN
  2873             ADD +1               TO AHNDX
  2874             GO TO 2100-SEARCH-AH-LIMITS
  2875     ELSE
  2876         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2877         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2878         MOVE RT-AH-BEN-M (AHNDX)
  2879                                 TO CP-R-MAX-MON-BEN.
  2880
  2881     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2882         MOVE '9'                 TO CP-RETURN-CODE.
  2883
  2884     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2885         MOVE '8'                 TO CP-RETURN-CODE.
  2886
  2887     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2888         GIVING WS-AH-FACE-BENEFIT.
  2889
  2890     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2891         MOVE 'C'                 TO CP-RETURN-CODE.
  2892
  2893 2200-CALCULATE-PREMIUMS.
  2894
  2895     IF CP-COMPANY-ID = 'CSL'
  2896         GO TO 2250-CSL-CALC.
  2897
  2898*    IF CP-CRITICAL-PERIOD
  2899*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  2900
  2901     IF CP-CRITICAL-PERIOD
  2902        IF (CP-COMPANY-ID = 'DCC')
  2903           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  2904               OR 'S' OR 'P')
  2905                          OR
  2906                (CP-BEN-CATEGORY = 'G' OR 'L'))
  2907           CONTINUE
  2908        ELSE
  2909           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  2910        END-IF
  2911     END-IF
  2912
  2913     IF (CP-COMPANY-ID = 'DCC')
  2914        AND (CP-BEN-CATEGORY = 'D')
  2915        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  2916           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  2917     END-IF
  2918     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2919        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* ELRATE.cbl
  2920        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  2921                                     CP-PREMIUM-RATE
  2922        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2923        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  2924        CP-PREMIUM-RATE) / +100
  2925     ELSE
  2926        IF (CP-COMPANY-ID = 'DCC')
  2927           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  2928           MOVE CP-PREMIUM-RATE  TO WK-S
  2929*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  2930           IF CP-RATE-DEV-PCT NOT = ZEROS
  2931              COMPUTE WK-S ROUNDED =
  2932                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  2933           END-IF
  2934           IF CP-BENEFIT-CD (1:1) = 'M'
  2935              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2936              CP-ORIGINAL-BENEFIT * WK-S / 100
  2937           ELSE
  2938              IF CP-BENEFIT-CD (1:1) = 'H'
  2939                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2940                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2941                    WK-S) / 1000
  2942              ELSE
  2943                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  2944                    GO TO 2300-CALC-DCC-MOB-NET-AH
  2945                 ELSE
  2946                    IF CP-BEN-CATEGORY = 'D'
  2947                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2948                        CP-ORIGINAL-BENEFIT *
  2949                        CP-ORIGINAL-TERM * WK-S / 100
  2950                    ELSE
  2951                      IF CP-BENEFIT-CD (1:1) = 'P'
  2952                         GO TO 2300-CALC-DCC-BEN-P-AH
  2953                      ELSE
  2954                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2955                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2956                        WK-S) / 100
  2957                      END-IF
  2958                    END-IF
  2959                 END-IF
  2960              END-IF
  2961           END-IF
  2962           MOVE ZEROS            TO CP-RATE-DEV-PCT
  2963        ELSE
  2964           IF CP-BENEFIT-CD (1:1) = 'M'
  2965              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2966                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  2967           ELSE
  2968              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  2969                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2970                    (CP-NET-BENEFIT-AMT *
  2971                    CP-PREMIUM-RATE) / 1000
  2972              ELSE
  2973                 IF CP-AH-BALLOON-SW = 'Y'
  2974                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  2975                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  2976                      CP-PREMIUM-RATE) / 100
  2977                 ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* ELRATE.cbl
  2978                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  2979                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  2980                    CP-PREMIUM-RATE) / 100
  2981                 END-IF
  2982              END-IF
  2983           END-IF
  2984        END-IF
  2985     END-IF
  2986
  2987     IF (CP-COMPANY-ID = 'DCC')
  2988        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  2989        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  2990     END-IF
  2991     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2992         GO TO 9999-CALC-RATE-PREM-X.
  2993
  2994     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  2995         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2996             CP-CALC-PREMIUM +
  2997                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  2998                                       * CP-TERM-OR-EXT-DAYS).
  2999
  3000     GO TO 9999-CALC-RATE-PREM-X.
  3001
  3002 2200-CRITICAL-PERIOD-AH-CONT.
  3003
  3004     IF CP-COMPANY-ID = 'WDS'
  3005         IF CP-ORIGINAL-TERM GREATER THAN 60
  3006             MOVE 60              TO CP-LOAN-TERM.
  3007
  3008     IF CP-COMPANY-ID EQUAL 'CVL'
  3009         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3010           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3011                                       * CP-PREMIUM-RATE
  3012         GO TO 9999-CALC-RATE-PREM-X.
  3013
  3014     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3015           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3016                                       * CP-PREMIUM-RATE.
  3017
  3018     GO TO 9999-CALC-RATE-PREM-X.
  3019
  3020 2250-CSL-CALC.
  3021
  3022     IF RT-DAILY-RATE NOT NUMERIC OR
  3023        RT-DAILY-RATE = ZEROS
  3024            MOVE ZEROS TO CP-CALC-PREMIUM
  3025            MOVE '7' TO CP-RETURN-CODE
  3026            GO TO 9999-CALC-RATE-PREM-X.
  3027
  3028     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  3029     COMPUTE WK-MONTHLY-RATE =
  3030          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3031
  3032     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3033     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3034     MOVE '1' TO DC-OPTION-CODE.
  3035     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* ELRATE.cbl
  3036     IF DATE-CONVERSION-ERROR
  3037         MOVE '2' TO CP-RETURN-CODE
  3038         GO TO 9999-CALC-RATE-PREM-X.
  3039
  3040     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3041     IF CP-CSL-METH-1
  3042         GO TO 2250-CSL-CALC-AH-1.
  3043     IF CP-CSL-METH-2
  3044         GO TO 2250-CSL-CALC-AH-2.
  3045     IF CP-CSL-METH-3
  3046         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3047             GO TO 2250-CSL-CALC-AH-4
  3048         ELSE
  3049             GO TO 2250-CSL-CALC-AH-3.
  3050
  3051 2250-CSL-CALC-AH-1.
  3052
  3053     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3054     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3055                    + WK-MONTHLY-RATE.
  3056     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3057                    CP-ORIGINAL-TERM * WK-D.
  3058
  3059     GO TO 9999-CALC-RATE-PREM-X.
  3060
  3061
  3062 2250-CSL-CALC-AH-2.
  3063     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3064     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3065                    + WK-MONTHLY-RATE.
  3066     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3067                    CP-ORIGINAL-TERM * WK-D.
  3068
  3069     GO TO 9999-CALC-RATE-PREM-X.
  3070
  3071 2250-CSL-CALC-AH-3.
  3072
  3073     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3074     COMPUTE WK-T = WK-K + 1.
  3075     COMPUTE WK-MONTHLY-RATE-T =
  3076          RT-AH-RATE (WK-T) / 100.
  3077     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3078
  3079     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3080     IF WK-T1 EQUAL ZEROS
  3081         MOVE ZEROS TO CP-CALC-PREMIUM
  3082         MOVE 'G' TO CP-RETURN-CODE
  3083         GO TO 9999-CALC-RATE-PREM-X.
  3084
  3085     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3086                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3087                    - WK-T)).
  3088     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3089     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3090                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3091                       WS-MAX-TOT-BEN).
  3092     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3093                    WK-MONTHLY-RATE-T) + WK-PREM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* ELRATE.cbl
  3094
  3095     GO TO 9999-CALC-RATE-PREM-X.
  3096
  3097 2250-CSL-CALC-AH-4.
  3098     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3099     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3100     COMPUTE WK-MONTHLY-RATE-J =
  3101          RT-AH-RATE (WK-J) / 100.
  3102     COMPUTE WK-T = WK-J + 1.
  3103     COMPUTE WK-MONTHLY-RATE-T =
  3104          RT-AH-RATE (WK-T) / 100.
  3105     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3106     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3107                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3108                    (CP-ORIGINAL-TERM - WK-T)).
  3109     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3110     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3111                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3112                       WS-MAX-TOT-BEN).
  3113     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3114                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3115
  3116     GO TO 9999-CALC-RATE-PREM-X.
  3117
  3118 2300-CALC-DCC-BEN-P-AH.
  3119     IF CP-NO-OF-PMTS NOT NUMERIC
  3120        MOVE +0                  TO CP-NO-OF-PMTS
  3121     END-IF
  3122     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3123        AND ' ' AND 'M'
  3124        MOVE ' '                 TO CP-PMT-MODE
  3125     END-IF
  3126     EVALUATE CP-PMT-MODE
  3127        WHEN 'W'
  3128           MOVE +7               TO C-DAYS-IN-PMT-PER
  3129           MOVE +52              TO C-PMTS-PER-YEAR
  3130           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3131        WHEN 'B'
  3132           MOVE +14              TO C-DAYS-IN-PMT-PER
  3133           MOVE +26              TO C-PMTS-PER-YEAR
  3134           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3135        WHEN OTHER
  3136           MOVE +30              TO C-DAYS-IN-PMT-PER
  3137           MOVE +12              TO C-PMTS-PER-YEAR
  3138           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  3139     END-EVALUATE
  3140     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3141     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3142        C-DAYS-IN-PMT-PER)) / (1 + I)
  3143     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3144     COMPUTE ANGLEN-1 = ANGLEN / Y
  3145     COMPUTE WK3 = CP-NET-BENEFIT-AMT / ANGLEN-1
  3146     if cp-net-benefit-amt = zeros
  3147        compute wk3 = cp-original-benefit - cp-original-premium
  3148     end-if
  3149     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3150     GO TO 9999-CALC-RATE-PREM-X
  3151     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* ELRATE.cbl
  3152 2300-CALC-DCC-MOB-NET-AH.
  3153     IF CP-ALTERNATE-BENEFIT = ZEROS
  3154        CONTINUE
  3155     ELSE
  3156        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3157     END-IF
  3158     MOVE CP-ORIGINAL-TERM       TO M
  3159     MOVE CP-LOAN-TERM           TO N
  3160     IF N = ZEROS
  3161        MOVE M                   TO N
  3162     END-IF
  3163     COMPUTE I = CP-LOAN-APR / +1200
  3164     IF CP-BENEFIT-CD (1:1) = 'S'
  3165        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3166        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3167        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3168          (WK-S / 1000)
  3169          * 1
  3170        MOVE WK3                 TO CP-CALC-PREMIUM
  3171        GO TO 9999-CALC-RATE-PREM-X
  3172     END-IF
  3173     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3174        / (1 + I)
  3175     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3176          ** ((N - M) * -1))) / I)
  3177     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3178     COMPUTE J = I + (WK-S / +1000)
  3179     COMPUTE WK2 = (1 + J) ** (M * -1)
  3180     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3181     COMPUTE ANGLEM = ((1 - ((1 + J)
  3182          ** (M * -1))) / J) / OD
  3183     IF CP-NET-BENEFIT-AMT = ZEROS
  3184        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3185           * ANGLEM
  3186     END-IF
  3187     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3188     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3189          ** ((N - M) * -1))) / I)
  3190     MOVE +0                     TO WK3
  3191     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3192        (WS-COUNTER > M)
  3193        COMPUTE ANGLEM = (1 - ((1 + J)
  3194          ** ((M - WS-COUNTER + 1) * -1))) / J
  3195        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3196        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3197        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3198     END-PERFORM
  3199     MOVE WK3                    TO CP-CALC-PREMIUM
  3200     GO TO 9999-CALC-RATE-PREM-X
  3201     .
  3202 2300-CALC-DCC-MOB-BAL-AH.
  3203     IF CP-BENEFIT-CD (1:1) = 'S'
  3204        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3205     END-IF
  3206     MOVE CP-ORIGINAL-TERM       TO M
  3207     MOVE CP-LOAN-TERM           TO N
  3208     IF N = ZEROS
  3209        MOVE M                   TO N
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* ELRATE.cbl
  3210     END-IF
  3211     COMPUTE I = CP-LOAN-APR / +1200
  3212     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3213        / (1 + I)
  3214     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3215     COMPUTE J = I + (WK-S / +1000)
  3216     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3217     MOVE I TO K
  3218     COMPUTE WK2 = (1 + J) ** (M * -1)
  3219     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3220     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3221          ** ((M - 1) * -1))) / J)
  3222     COMPUTE ANGLEM = ((1 - ((1 + J)
  3223          ** (M * -1))) / J) / OD
  3224     IF CP-NET-BENEFIT-AMT = ZEROS
  3225        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3226           * ANGLEM
  3227     END-IF
  3228     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3229        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3230        / ANGLEM-1
  3231     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3232          ** ((N - M) * -1))) / I)
  3233     MOVE +0                     TO WK3
  3234     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3235        (WS-COUNTER > M)
  3236        COMPUTE ANGLEM = (1 - ((1 + J)
  3237          ** ((M - WS-COUNTER) * -1))) / J
  3238        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3239        COMPUTE WK5-CSL = (RA * ANGLEM)
  3240        + (CP-ALTERNATE-BENEFIT * WK2)
  3241        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3242          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3243          (WK-S / 1000)
  3244     END-PERFORM
  3245     MOVE WK3                    TO CP-CALC-PREMIUM
  3246     GO TO 9999-CALC-RATE-PREM-X
  3247     .
  3248 2300-CALC-DCC-MOB-BAL-AHSUM.
  3249     MOVE CP-ORIGINAL-TERM       TO M
  3250     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3251        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3252        * WK-S / 1000
  3253*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3254*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3255*       * WK-S / 1000
  3256     MOVE WK3                    TO CP-CALC-PREMIUM
  3257     GO TO 9999-CALC-RATE-PREM-X
  3258     .
  3259 9999-RATE-NOTFND.
  3260     MOVE '6'                    TO CP-RETURN-CODE.
  3261     GO TO 9999-CALC-RATE-PREM-X.
  3262
  3263 9999-RATE-NOTOPEN.
  3264     MOVE 'D'                    TO CP-RETURN-CODE.
  3265     GO TO 9999-CALC-RATE-PREM-X.
  3266
  3267 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* ELRATE.cbl
  3268     IF (CP-COMPANY-ID = 'DCC')
  3269        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3270        CONTINUE
  3271     ELSE
  3272        IF CP-RATE-DEV-PCT NOT = ZERO
  3273           COMPUTE CP-CALC-PREMIUM =
  3274              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3275
  3276
  3277     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3278
  3279     IF WS-BROWSE-STARTED
  3280
  3281* EXEC CICS ENDBR
  3282*            DATASET  (ERRATE-FILE-ID)
  3283*       END-EXEC.
  3284     MOVE 0
  3285       TO DFHEIV11
  3286*    MOVE '&2                    $   #00003233' TO DFHEIV0
  3287     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3288     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3289     MOVE X'2020233030303033323333' TO DFHEIV0(25:11)
  3290     CALL 'kxdfhei1' USING DFHEIV0,
  3291           ERRATE-FILE-ID,
  3292           DFHEIV11,
  3293           DFHEIV99
  3294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3295
  3296
  3297
  3298* EXEC CICS RETURN
  3299*    END-EXEC.
  3300*    MOVE '.(                    &   #00003237' TO DFHEIV0
  3301     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3302     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3303     MOVE X'2020233030303033323337' TO DFHEIV0(25:11)
  3304     CALL 'kxdfhei1' USING DFHEIV0,
  3305           DFHEIV99,
  3306           DFHEIV99,
  3307           DFHEIV99,
  3308           DFHEIV99,
  3309           DFHEIV99
  3310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3311
  3312
  3313 9100-CONVERT-DATE.
  3314
  3315* EXEC CICS LINK
  3316*        PROGRAM  ('ELDATCV')
  3317*        COMMAREA (DATE-CONVERSION-DATA)
  3318*        LENGTH   (DC-COMM-LENGTH)
  3319*    END-EXEC.
  3320     MOVE 'ELDATCV' TO DFHEIV1
  3321*    MOVE '."C                   ''   #00003241' TO DFHEIV0
  3322     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3323     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3324     MOVE X'2020233030303033323431' TO DFHEIV0(25:11)
  3325     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* ELRATE.cbl
  3326           DFHEIV1,
  3327           DATE-CONVERSION-DATA,
  3328           DC-COMM-LENGTH,
  3329           DFHEIV99,
  3330           DFHEIV99,
  3331           DFHEIV99
  3332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3333
  3334
  3335 9100-EXIT.
  3336     EXIT.
  3337
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* ELRATE.cbl
  3339 10000-NET-TERM SECTION.
  3340*                         COPY ERCNETP.
  3341*****************************************************************
  3342*                                                               *
  3343*                            ERCNETP                            *
  3344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3345*                            VMOD=2.029                         *
  3346*                                                               *
  3347*****************************************************************.
  3348*
  3349*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3350*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3351*                                   ORIGINAL TERM (S999)
  3352*                                   REMAINING TERM (S999)
  3353*                                   NET PAY OPTION (X)
  3354*                                   LOAN TERM (S999)
  3355*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3356*
  3357*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3358*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3359*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3360*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3361*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3362*    CHARGED.
  3363*
  3364*    OPTIONS - S = NET SIMPLE
  3365*          SPACE = NET PAY  (1 MO. INTEREST)
  3366*              A = NET PAY  (0 MO. INTEREST)
  3367*              I = NET PAY  (2 MO. INTEREST)
  3368*              J = NET PAY  (3 MO. INTEREST)
  3369*              K = NET PAY  (4 MO. INTEREST)
  3370*              T = TRUNCATED  (0 MO. INTEREST)
  3371*              U = TRUNCATED  (1 MO. INTEREST)
  3372*              V = TRUNCATED  (2 MO. INTEREST)
  3373*              W = TRUNCATED  (3 MO. INTEREST)
  3374*              X = TRUNCATED  (4 MO. INTEREST)
  3375*              R = REFUNDS (REGULAR OR TRUNCATED)
  3376******************************************************************
  3377*                   C H A N G E   L O G
  3378*
  3379* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3380*-----------------------------------------------------------------
  3381*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3382* EFFECTIVE    NUMBER
  3383*-----------------------------------------------------------------
  3384* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3385* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3386* 120403                   PEMA  ADD SPECIAL TX CALC
  3387* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3388* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3389* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3390* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3391* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3392* 021207                   PEMA  ADD PA NP
  3393* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3394* 032807                   PEMA  ADD VT NP PLUS 2
  3395* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3396* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* ELRATE.cbl
  3397* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3398* 110207      TO 'AL' NET PAY CALC
  3399* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3400* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3401* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3402* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3403* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3404* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3405* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3406* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3407* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3408* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3409* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3410* 032612  CR2011110200001  PEMA  AHL CHANGES
  3411******************************************************************
  3412
  3413     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3414     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3415     MOVE N-P-LOAN    TO LOAN-TERM.
  3416     MOVE N-P-REM     TO REMAINING-TERM.
  3417     MOVE N-P-OPT     TO OPTION-SW.
  3418
  3419     MOVE +0 TO FACTOR.
  3420
  3421     IF ANNUAL-INT-RATE = ZERO
  3422         GO TO 99000-ERROR.
  3423     IF ORIGINAL-TERM = ZERO
  3424         GO TO 99999-RETURN.
  3425     IF REMAINING-TERM = ZERO
  3426         GO TO 99999-RETURN.
  3427     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3428         GO TO 99000-ERROR.
  3429     IF LOAN-TERM = ZERO
  3430         GO TO 99999-RETURN.
  3431     IF LOAN-TERM LESS ORIGINAL-TERM
  3432         GO TO 99000-ERROR.
  3433
  3434*    IF ANNUAL-INT-RATE LESS +2
  3435*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3436*    IF ANNUAL-INT-RATE LESS +2
  3437*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3438*    IF ANNUAL-INT-RATE LESS +2
  3439*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3440
  3441     IF NPO-REFUND
  3442         MOVE '2' TO NP-PROCESS-SW
  3443       ELSE
  3444         IF ORIGINAL-TERM = REMAINING-TERM
  3445            MOVE '1'   TO NP-PROCESS-SW
  3446           ELSE
  3447            MOVE '3'   TO NP-PROCESS-SW.
  3448
  3449     IF NPO-SIMPLE
  3450         MOVE 'S' TO TYPE-SW
  3451     ELSE
  3452         MOVE 'N' TO TYPE-SW.
  3453
  3454     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* ELRATE.cbl
  3455
  3456     COMPUTE V ROUNDED = K1 / (K1 + I).
  3457
  3458     MOVE V     TO VX
  3459                   SV.
  3460
  3461     MOVE +1    TO X1
  3462                   SX.
  3463
  3464     MOVE LOAN-TERM TO MAX-X.
  3465
  3466     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3467
  3468     IF MAX-X = +1
  3469        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3470
  3471     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3472
  3473     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3474         OR 'DCC'        OR 'NCL') AND
  3475        (NOT NP-REFUND)
  3476        NEXT SENTENCE
  3477     ELSE
  3478     IF LOAN-TERM NOT = ORIGINAL-TERM
  3479        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3480
  3481     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3482
  3483 10500-VX-LOOP.
  3484
  3485***  VX = AMORT. LOAN TERM.
  3486***  SV = AMORT. INSURANCE TERM.
  3487***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3488***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3489***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3490
  3491     IF X2 = 1
  3492        MOVE V         TO SX
  3493     END-IF
  3494     COMPUTE VX ROUNDED = VX * V.
  3495
  3496     ADD B1 TO X1.
  3497
  3498     IF X1 = REMAINING-TERM
  3499          MOVE VX    TO SV.
  3500
  3501     IF X1 EQUAL SV-MINUS-ONE
  3502        MOVE VX      TO SV-MINUS-ONE.
  3503
  3504     IF X1 = X2
  3505          MOVE VX    TO SX.
  3506
  3507     IF X1 NOT = MAX-X
  3508          GO TO 10500-VX-LOOP.
  3509
  3510 10700-COMPUTE-REMAINING-FACTOR.
  3511*****  WK1 = LOAN TERM AMORT
  3512     COMPUTE WK1 = K1 - VX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* ELRATE.cbl
  3513*****  WK2 = INS TERM AMORT
  3514     COMPUTE WK2 = K1 - SV.
  3515*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3516     COMPUTE WK5 = K1 - SX.
  3517*****  WK6 = INS TERM - 1
  3518     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3519
  3520     IF NP-RATING
  3521         GO TO 12000-PREMIUM-RATE.
  3522
  3523     IF NP-REFUND
  3524         GO TO 11000-REFUND-CALC.
  3525
  3526     IF NET-STD
  3527         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3528
  3529     IF NET-SMP
  3530         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3531         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3532         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3533         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3534
  3535     IF REMAINING-TERM LESS THAN X2
  3536         MOVE +0 TO WK3.
  3537
  3538     MOVE WK3 TO FACTOR.
  3539
  3540     GO TO 99999-RETURN.
  3541
  3542 11000-REFUND-CALC.
  3543     IF REMAINING-TERM NOT LESS MAX-X
  3544        MOVE +1 TO FACTOR
  3545        GO TO 99999-RETURN.
  3546
  3547     IF REMAINING-TERM LESS +1
  3548        MOVE 0 TO FACTOR
  3549        GO TO 99999-RETURN.
  3550
  3551     COMPUTE WK2 ROUNDED = WK2 / I.
  3552     COMPUTE WK5 ROUNDED = WK5 / I.
  3553     COMPUTE WK1 ROUNDED = WK1 / I.
  3554
  3555     IF (CP-COMPANY-ID EQUAL 'CID')
  3556        AND (CP-STATE-STD-ABBRV = 'MN')
  3557        AND (CP-CERT-EFF-DT > X'A4FF')
  3558        AND (CP-RATE-AS-REG-BALLOON)
  3559        AND (CP-EARN-AS-NET-PAY)
  3560        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3561        CONTINUE
  3562     ELSE
  3563        GO TO 11000-CHECK-MN-LEV-BALLOON
  3564     END-IF
  3565
  3566     COMPUTE R = M - E
  3567     COMPUTE FACTOR = (R - WK2 + WK5) /
  3568        (M - WK1 + WK5)
  3569
  3570     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* ELRATE.cbl
  3571
  3572      .
  3573 11000-CHECK-MN-LEV-BALLOON.
  3574
  3575     IF (CP-COMPANY-ID EQUAL 'CID')
  3576        AND (CP-STATE-STD-ABBRV = 'MN')
  3577        AND (CP-CERT-EFF-DT > X'A4FF')
  3578        AND (CP-RATE-AS-REG-BALLOON)
  3579        AND (CP-EARN-AS-NET-PAY)
  3580        AND (CP-DEVIATION-CODE = 'LEV')
  3581        CONTINUE
  3582     ELSE
  3583        GO TO 11000-CONTINUE-REFUND
  3584     END-IF
  3585
  3586     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3587     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3588        ** (M - E)) / I
  3589
  3590     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3591
  3592     GO TO 99999-RETURN
  3593
  3594     .
  3595 11000-CONTINUE-REFUND.
  3596*    IF CP-GAP-ACTUARIAL
  3597*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3598*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3599*       COMPUTE WK3 = WK2 / ANGLEN
  3600*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3601     IF CP-GAP-ACTUARIAL
  3602        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3603           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3604        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3605     ELSE
  3606        COMPUTE WK3 ROUNDED =
  3607          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3608     END-IF
  3609
  3610     MOVE WK3  TO FACTOR.
  3611
  3612     GO TO 99999-RETURN.
  3613
  3614 12000-PREMIUM-RATE.
  3615*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3616*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3617*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3618*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3619*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3620*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3621
  3622     COMPUTE K-I = K1 + I.
  3623     MOVE K-I TO ONE-PLUS-I.
  3624
  3625     IF NPO-ALT OR NPO-TRUNC-0
  3626         MOVE K1 TO K-I.
  3627
  3628     IF NPO-2MO OR NPO-TRUNC-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* ELRATE.cbl
  3629         COMPUTE K-I = K1 + (2 * I).
  3630
  3631     IF NPO-3MO OR NPO-TRUNC-3
  3632         COMPUTE K-I = K1 + (3 * I).
  3633
  3634     IF NPO-4MO OR NPO-TRUNC-4
  3635         COMPUTE K-I = K1 + (4 * I).
  3636
  3637     COMPUTE RA ROUNDED = 1 -
  3638             ((X2 * (X2 + 1)) /
  3639              (N *  (N  + 1))).
  3640
  3641     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3642        (CP-CSL-VALID-NP-BENEFIT-CD)
  3643        NEXT SENTENCE
  3644     ELSE
  3645        GO TO XXXX-CHECK-DISCOUNT-5.
  3646
  3647     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3648     MOVE ' ' TO DC-OPTION-CODE.
  3649     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3650
  3651     IF DATE-CONVERSION-ERROR
  3652        MOVE '2'                 TO CP-RETURN-CODE
  3653        MOVE ZEROS               TO FACTOR
  3654                                    CP-CALC-PREMIUM
  3655         GO TO 99999-RETURN.
  3656
  3657     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3658     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3659     MOVE ' ' TO DC-OPTION-CODE
  3660     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3661
  3662     IF DATE-CONVERSION-ERROR
  3663        MOVE '2'                 TO CP-RETURN-CODE
  3664        MOVE ZEROS               TO FACTOR
  3665                                    CP-CALC-PREMIUM
  3666         GO TO 99999-RETURN.
  3667
  3668     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  3669
  3670     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  3671
  3672     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3673        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3674        CP-PAY-FREQUENCY / 365) * I
  3675     ELSE
  3676        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3677        CP-PAY-FREQUENCY / 365) * I.
  3678
  3679     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3680     13).
  3681
  3682     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3683     (N - ( ANGLEN-1 / WK3)).
  3684
  3685     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3686
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* ELRATE.cbl
  3687     COMPUTE WS-CALC-FREQ-RATE EQUAL
  3688       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3689
  3690     COMPUTE WS-Y-X-FACTOR EQUAL
  3691       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3692       WS-CALC-FREQ-RATE).
  3693
  3694     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3695       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3696
  3697     COMPUTE WS-X-Y-FACTOR EQUAL
  3698       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3699
  3700     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3701       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3702       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3703
  3704     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3705
  3706     GO TO 99999-RETURN.
  3707
  3708 XXXX-CHECK-DISCOUNT-5.
  3709
  3710     IF WS-DISCOUNT-OPTION EQUAL '5'
  3711        NEXT SENTENCE
  3712     ELSE
  3713        GO TO 12000-CHECK-CLIENT.
  3714
  3715      COMPUTE ANGLEN EQUAL WK1 / I.
  3716
  3717      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3718
  3719      COMPUTE WK3 EQUAL
  3720        (12 *
  3721        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3722        CP-ORIGINAL-BENEFIT)) /
  3723        APR100.
  3724
  3725     COMPUTE WK3 EQUAL
  3726        (WK3 * CP-PREMIUM-RATE) / +1000.
  3727
  3728     COMPUTE WK3 EQUAL
  3729        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3730
  3731      MOVE WK3 TO CP-CALC-PREMIUM.
  3732
  3733     GO TO 99999-RETURN.
  3734
  3735 12000-CHECK-CLIENT.
  3736
  3737     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3738        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3739        (CP-TRUNCATED-LIFE)
  3740        NEXT SENTENCE
  3741     ELSE
  3742        GO TO 12000-CHECK-NEXT.
  3743
  3744     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* ELRATE.cbl
  3745
  3746     COMPUTE ANGLEN EQUAL WK1 / I.
  3747     COMPUTE ANGLEM EQUAL WK2 / I.
  3748
  3749     COMPUTE FM EQUAL
  3750                    (((ONE-PLUS-I ** M) * I * M) /
  3751                    ((ONE-PLUS-I ** M) - 1))
  3752                    - 1.
  3753
  3754     COMPUTE FN EQUAL
  3755                    (((ONE-PLUS-I ** N) * I * N) /
  3756                    ((ONE-PLUS-I ** N) - 1))
  3757                    - 1.
  3758
  3759     COMPUTE FNM EQUAL
  3760                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3761                    ((ONE-PLUS-I ** (N - M)) - 1))
  3762                    - 1.
  3763
  3764     COMPUTE GR EQUAL
  3765                    (WS-WORK-RATE * ANGLEM * I) /
  3766                    (M - ANGLEM).
  3767
  3768     COMPUTE ODF EQUAL
  3769                     (1 +
  3770                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3771                     360)) /
  3772                     ONE-PLUS-I.
  3773
  3774     COMPUTE OD EQUAL
  3775                    (1 + (ODF * (FN / I - 1))) +
  3776                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3777
  3778     COMPUTE WK3 EQUAL
  3779*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3780                    ((1 + FN) * ODF *
  3781                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3782                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3783                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3784
  3785     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3786     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  3787
  3788     COMPUTE WK3 EQUAL
  3789                    (WK3 / (ODF * (1 + FN))) -
  3790*                   CP-ORIGINAL-BENEFIT.
  3791                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  3792
  3793      MOVE WK3 TO CP-CALC-PREMIUM.
  3794
  3795     GO TO 99999-RETURN.
  3796
  3797 12000-CHECK-NEXT.
  3798
  3799     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  3800        NEXT SENTENCE
  3801     ELSE
  3802        GO TO 12000-CHECK-PA-TRUNC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* ELRATE.cbl
  3803
  3804      IF WS-WORK-DIS-RATE EQUAL +0
  3805         MOVE '7'                TO CP-RETURN-CODE
  3806         MOVE ZEROS              TO FACTOR
  3807                                    CP-CALC-PREMIUM
  3808         GO TO 99999-RETURN.
  3809
  3810      COMPUTE ANGLEN EQUAL WK1 / I.
  3811
  3812      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3813
  3814      IF WS-WORK-DIS-RATE EQUAL APR100
  3815         ADD .00001 TO APR100.
  3816
  3817      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  3818      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  3819
  3820     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3821        / (1 + I)
  3822     COMPUTE ANGLEN-1 = ANGLEN / Y
  3823      IF CP-COMPANY-ID EQUAL 'CDL'
  3824         COMPUTE WK3 EQUAL
  3825
  3826          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  3827          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  3828
  3829          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3830
  3831          ((WK8 ** N) /
  3832          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3833
  3834          ((WK9 ** N) /
  3835          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  3836
  3837      ELSE
  3838         COMPUTE WK3 EQUAL
  3839
  3840          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3841          (12 + WS-WORK-DIS-RATE) * 12) *
  3842
  3843          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3844
  3845          ((WK8 ** N) /
  3846          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3847
  3848          ((WK9 ** N) /
  3849          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  3850
  3851      COMPUTE WK3 EQUAL
  3852          (WK3 * CP-PREMIUM-RATE) / +1000.
  3853
  3854      MOVE WK3 TO CP-CALC-PREMIUM.
  3855
  3856     GO TO 99999-RETURN.
  3857
  3858 12000-CHECK-PA-TRUNC.
  3859
  3860     IF (CP-COMPANY-ID EQUAL 'NCL') AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* ELRATE.cbl
  3861        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  3862        (CP-EARN-AS-NET-PAY) AND
  3863        (CP-TRUNCATED-LIFE)
  3864        NEXT SENTENCE
  3865     ELSE
  3866        GO TO 12000-CHECK-MD-TRUNC.
  3867
  3868     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3869
  3870     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3871     COMPUTE ANGLEN EQUAL WK1 / I.
  3872
  3873     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3874
  3875     COMPUTE WK3 EQUAL
  3876        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  3877        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  3878
  3879     MOVE WK3 TO CP-CALC-PREMIUM.
  3880
  3881     GO TO 99999-RETURN.
  3882
  3883 12000-CHECK-MD-TRUNC.
  3884
  3885     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3886        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3887        (CP-EARN-AS-NET-PAY) AND
  3888        (CP-TRUNCATED-LIFE)
  3889        NEXT SENTENCE
  3890     ELSE
  3891        GO TO 12000-CHECK-MD.
  3892
  3893     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3894
  3895     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3896     COMPUTE ANGLEM EQUAL WK2 / I.
  3897     COMPUTE ANGLEN EQUAL WK1 / I.
  3898
  3899     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3900
  3901     COMPUTE WK3 EQUAL
  3902        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3903        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3904        (ANGLEN-1 * (M - ANGLEM))).
  3905
  3906     MOVE WK3 TO CP-CALC-PREMIUM.
  3907
  3908     GO TO 99999-RETURN.
  3909
  3910 12000-CHECK-MD.
  3911
  3912     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3913        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3914        (CP-EARN-AS-NET-PAY)
  3915        NEXT SENTENCE
  3916     ELSE
  3917        GO TO 12000-CHECK-ME-TRUNC.
  3918
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* ELRATE.cbl
  3919     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3920
  3921     COMPUTE WK3 EQUAL
  3922        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3923
  3924     MOVE WK3 TO CP-CALC-PREMIUM.
  3925
  3926     GO TO 99999-RETURN.
  3927
  3928 12000-CHECK-ME-TRUNC.
  3929
  3930     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3931        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3932        AND (CP-EARN-AS-NET-PAY)
  3933        AND (CP-TRUNCATED-LIFE)
  3934        CONTINUE
  3935     ELSE
  3936        GO TO 12000-CHECK-CID-FARMPLAN
  3937     END-IF
  3938
  3939     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3940     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3941     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3942     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3943     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3944     COMPUTE ANGLEN-1 = ANGLEN / Y
  3945     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3946     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3947     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3948     COMPUTE WK3
  3949        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3950        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3951            * (1 / (1.0635 ** (M / 12))))
  3952*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3953*    COMPUTE WK9 EQUAL
  3954*       1 / (1 + (.045 * (N - M) / 24))
  3955*    COMPUTE WK7 EQUAL
  3956*       WS-WORK-RATE * 20 / (M + 1).
  3957*    COMPUTE WK3 EQUAL
  3958*       ((( N - ANGLEN) * WK7 * WK8) /
  3959*       (10 * ANGLEN-1 * I)) -
  3960*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3961*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3962*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3963*
  3964     MOVE WK3 TO CP-CALC-PREMIUM.
  3965
  3966     GO TO 99999-RETURN.
  3967 12000-CHECK-CID-FARMPLAN.
  3968     IF (CP-COMPANY-ID EQUAL 'CID')
  3969        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3970           OR 'IN' OR 'AZ')
  3971        AND (CP-FARM-PLAN)
  3972        CONTINUE
  3973     ELSE
  3974        GO TO 12000-CHECK-SC-CID
  3975     END-IF
  3976     COMPUTE N = M / CP-PAY-FREQUENCY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* ELRATE.cbl
  3977     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3978     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3979        ** CP-PAY-FREQUENCY) - 1
  3980     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3981     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3982        ** TI) / WS-WORK-DIS-RATE
  3983     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3984     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3985     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3986        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3987     COMPUTE WK2 = WK2 * (1 + J)
  3988     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3989     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3990     COMPUTE WK3 = WK3 * (1 + J)
  3991     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3992        ** (N - 1))) / J
  3993     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3994        ((N * WK2) - WK5)) + (N * WK1)) *
  3995        (CP-PREMIUM-RATE / 1000)
  3996     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3997     COMPUTE WK6 = (WK7 * GR)
  3998     MOVE WK6 TO CP-CALC-PREMIUM
  3999     GO TO 99999-RETURN
  4000     .
  4001 12000-CHECK-SC-CID.
  4002     IF (CP-COMPANY-ID EQUAL 'CID')
  4003        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  4004        AND (CP-EARN-AS-NET-PAY)
  4005        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4006        CONTINUE
  4007     ELSE
  4008        GO TO 12000-CHECK-AL-CID
  4009     END-IF
  4010     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4011     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4012     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4013     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4014     COMPUTE ANGLEN-1 = ANGLEN / Y
  4015     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4016        / 12)) / ((M + 1) / 2)
  4017     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4018     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4019        + 6 * M) * (WK2 / 100) * (1 + I)
  4020     MOVE WK3 TO CP-CALC-PREMIUM
  4021     GO TO 99999-RETURN
  4022     .
  4023 12000-CHECK-AL-CID.
  4024     IF (CP-COMPANY-ID EQUAL 'CID')
  4025        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4026        AND (CP-EARN-AS-NET-PAY)
  4027        CONTINUE
  4028     ELSE
  4029        GO TO 12000-CHECK-NH-CID
  4030     END-IF
  4031     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4032     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4033     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4034     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* ELRATE.cbl
  4035                   / (1 + I)
  4036     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4037     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4038     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4039        (CP-PREMIUM-RATE / 1000)
  4040     MOVE WK3 TO CP-CALC-PREMIUM
  4041     GO TO 99999-RETURN
  4042     .
  4043 12000-CHECK-NH-CID.
  4044     IF (CP-COMPANY-ID EQUAL 'CID')
  4045        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4046        AND (CP-EARN-AS-NET-PAY)
  4047        CONTINUE
  4048     ELSE
  4049        GO TO 12000-CHECK-PA-CID
  4050     END-IF
  4051     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4052     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4053     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4054                   / (1 + I)
  4055     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4056     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4057     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4058        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4059     MOVE WK3 TO CP-CALC-PREMIUM
  4060     GO TO 99999-RETURN
  4061     .
  4062 12000-CHECK-PA-CID.
  4063     IF (CP-COMPANY-ID EQUAL 'CID')
  4064        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4065        AND (CP-EARN-AS-NET-PAY)
  4066        CONTINUE
  4067     ELSE
  4068        GO TO 12000-CHECK-ME-CID
  4069     END-IF
  4070
  4071     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4072     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4073     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4074     COMPUTE ANGLEN-1 = ANGLEN / Y
  4075     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4076     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4077     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4078     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4079        * WK5
  4080     MOVE WK3 TO CP-CALC-PREMIUM
  4081     GO TO 99999-RETURN
  4082     .
  4083 12000-CHECK-ME-CID.
  4084     IF (CP-COMPANY-ID EQUAL 'CID')
  4085        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4086        AND (CP-EARN-AS-NET-PAY)
  4087        CONTINUE
  4088     ELSE
  4089        GO TO 12000-CHECK-VT-TRUNC
  4090     END-IF
  4091     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4092     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* ELRATE.cbl
  4093     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4094     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4095     COMPUTE ANGLEN-1 = ANGLEN / Y
  4096     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4097     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4098     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4099        * WK5
  4100     MOVE WK3 TO CP-CALC-PREMIUM
  4101     GO TO 99999-RETURN
  4102     .
  4103 12000-CHECK-VT-TRUNC.
  4104
  4105     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4106        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4107        (CP-EARN-AS-NET-PAY) AND
  4108        (CP-TRUNCATED-LIFE)
  4109        NEXT SENTENCE
  4110     ELSE
  4111        GO TO 12000-CHECK-VT.
  4112
  4113      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4114
  4115      COMPUTE ANGLEN EQUAL WK1 / I.
  4116
  4117      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4118
  4119      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4120      COMPUTE WK9 EQUAL
  4121        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4122        ((.0054 - I) / (1 + I)).
  4123      COMPUTE WK7 EQUAL
  4124        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4125      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4126        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4127
  4128      MOVE WK3 TO CP-CALC-PREMIUM.
  4129
  4130     GO TO 99999-RETURN.
  4131
  4132 12000-CHECK-VT.
  4133
  4134     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4135        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4136        (CP-EARN-AS-NET-PAY)
  4137        NEXT SENTENCE
  4138     ELSE
  4139        GO TO 12000-CHECK-MINN-WDS.
  4140
  4141      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4142
  4143      COMPUTE ANGLEN EQUAL WK1 / I.
  4144
  4145      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4146
  4147      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4148                        (ANGLEN-1 * I)) *
  4149
  4150                        (((1.0054 ** N - 1) /
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* ELRATE.cbl
  4151                        (1.0054 ** (N - 1) * .0054)) -
  4152
  4153                        ((V * (1 - 1.0054 ** N * VX)) /
  4154                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4155
  4156      MOVE WK3 TO CP-CALC-PREMIUM.
  4157
  4158     GO TO 99999-RETURN.
  4159
  4160 12000-CHECK-MINN-WDS.
  4161
  4162     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4163        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4164        (CP-EARN-AS-NET-PAY)
  4165        NEXT SENTENCE
  4166     ELSE
  4167        GO TO 12000-CHECK-MINN-BALL-LEV.
  4168
  4169     COMPUTE ANGLEN EQUAL WK1 / I.
  4170     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  4171              (N / +12) * (2 / (N + 1)).
  4172     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  4173         WK3 * ((N - ANGLEN) / I).
  4174
  4175      MOVE WK3 TO CP-CALC-PREMIUM.
  4176
  4177     GO TO 99999-RETURN.
  4178
  4179 12000-CHECK-MINN-BALL-LEV.
  4180
  4181     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4182        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4183        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4184        (CP-EARN-AS-REG-BALLOON)
  4185        NEXT SENTENCE
  4186     ELSE
  4187        GO TO 12000-CHECK-MINN-BALL.
  4188
  4189     COMPUTE ANGLEN EQUAL WK1 / I.
  4190
  4191     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4192
  4193     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4194        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4195
  4196     MOVE WK3 TO CP-CALC-PREMIUM.
  4197
  4198     GO TO 99999-RETURN.
  4199
  4200 12000-CHECK-MINN-BALL.
  4201
  4202     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4203        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4204        (CP-EARN-AS-REG-BALLOON)
  4205        NEXT SENTENCE
  4206     ELSE
  4207        GO TO 12000-CHECK-CID-MN-BALL.
  4208
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* ELRATE.cbl
  4209     COMPUTE ANGLEN EQUAL WK1 / I.
  4210     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4211
  4212     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4213     / +100 * (N - 1) / 12 * 2 / N *
  4214     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4215
  4216      MOVE WK3 TO CP-CALC-PREMIUM.
  4217
  4218     GO TO 99999-RETURN.
  4219
  4220 12000-CHECK-CID-MN-BALL.
  4221     IF (CP-COMPANY-ID EQUAL 'CID')
  4222        AND (CP-STATE-STD-ABBRV = 'MN')
  4223        AND (CP-CERT-EFF-DT > X'A4FF')
  4224        AND (CP-EARN-AS-REG-BALLOON)
  4225        CONTINUE
  4226     ELSE
  4227        GO TO 12000-CHECK-NC-WDS
  4228     END-IF
  4229     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4230     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4231     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4232     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4233     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4234     COMPUTE V = 1 / (1 + I)
  4235     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4236     COMPUTE Y = (1 + (D * I) / +30)
  4237        / (1 + I)
  4238     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4239        * CP-PREMIUM-RATE / 1000
  4240*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4241*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4242*    ELSE
  4243*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4244*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4245*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4246*       DISPLAY ' BALLOON TOP ' WK6
  4247*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4248*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4249*          / 100
  4250*       DISPLAY ' BALLOON BOTTOM ' WK7
  4251*       COMPUTE GR = WK6 / WK7
  4252*       DISPLAY ' BALLOON PAYMENT ' GR
  4253*    END-IF
  4254     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4255     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4256        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4257     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4258     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4259        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4260           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4261           * CP-PREMIUM-RATE / 1000
  4262     MOVE WK3                    TO CP-CALC-PREMIUM
  4263     GO TO 99999-RETURN.
  4264     .
  4265 12000-CHECK-NC-WDS.
  4266
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* ELRATE.cbl
  4267     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4268        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4269        (CP-EARN-AS-NET-PAY)
  4270        NEXT SENTENCE
  4271     ELSE
  4272        GO TO 12000-CHECK-NC-BALL-LEV.
  4273
  4274     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4275     COMPUTE ANGLEN EQUAL WK1 / I.
  4276     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4277              CP-PREMIUM-RATE / +100 *
  4278              N / +12 * 2 / (N + 1) *
  4279              (WK4 - ANGLEN) / (I * ANGLEN).
  4280
  4281      MOVE WK3 TO CP-CALC-PREMIUM.
  4282
  4283     GO TO 99999-RETURN.
  4284
  4285 12000-CHECK-NC-BALL-LEV.
  4286
  4287     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4288        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4289        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4290        (CP-EARN-AS-REG-BALLOON)
  4291        NEXT SENTENCE
  4292     ELSE
  4293        GO TO 12000-CHECK-NC-BALL.
  4294
  4295     COMPUTE ANGLEN EQUAL WK1 / I.
  4296
  4297**** VX = 1 / (1 + I)**N.
  4298
  4299     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4300        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4301
  4302     MOVE WK3 TO CP-CALC-PREMIUM.
  4303
  4304     GO TO 99999-RETURN.
  4305
  4306 12000-CHECK-NC-BALL.
  4307
  4308     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4309        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4310        (CP-EARN-AS-REG-BALLOON)
  4311        NEXT SENTENCE
  4312     ELSE
  4313        GO TO 12000-CHECK-MINN-TRUNC.
  4314
  4315     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4316     COMPUTE ANGLEN EQUAL WK1 / I.
  4317     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4318**** VX = 1 / (1 + I)**N.
  4319
  4320     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4321     / +100 * (N - 1) / 12 * 2 / N *
  4322     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4323
  4324      MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* ELRATE.cbl
  4325
  4326     GO TO 99999-RETURN.
  4327
  4328 12000-CHECK-MINN-TRUNC.
  4329
  4330     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4331        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4332        (M GREATER THAN +63) AND
  4333        (CP-EARN-AS-NET-PAY) AND
  4334        (CP-TRUNCATED-LIFE)
  4335        NEXT SENTENCE
  4336     ELSE
  4337        GO TO 12000-CHECK-MINN.
  4338
  4339      COMPUTE ANGLEN EQUAL WK1 / I.
  4340      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4341
  4342      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4343
  4344      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4345       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4346       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4347
  4348      MOVE WK3 TO CP-CALC-PREMIUM.
  4349
  4350     GO TO 99999-RETURN.
  4351
  4352 12000-CHECK-MINN.
  4353
  4354     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4355        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4356        (M GREATER THAN +63) AND
  4357        (CP-EARN-AS-NET-PAY)
  4358        NEXT SENTENCE
  4359     ELSE
  4360        GO TO 12000-CHECK-MONTANA-TRUNC.
  4361
  4362      COMPUTE ANGLEN EQUAL WK1 / I.
  4363
  4364      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4365
  4366      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4367       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4368       (((N - ANGLEN) / I) + (2 * N)).
  4369
  4370      MOVE WK3 TO CP-CALC-PREMIUM.
  4371
  4372     GO TO 99999-RETURN.
  4373
  4374 12000-CHECK-MONTANA-TRUNC.
  4375
  4376     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4377        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4378        (M GREATER THAN +63) AND
  4379        (CP-EARN-AS-NET-PAY) AND
  4380        (CP-TRUNCATED-LIFE)
  4381        NEXT SENTENCE
  4382     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* ELRATE.cbl
  4383        GO TO 12000-CHECK-MONTANA.
  4384
  4385      COMPUTE ANGLEN EQUAL WK1 / I.
  4386      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4387
  4388      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4389
  4390      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4391      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4392       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4393
  4394      MOVE WK3 TO CP-CALC-PREMIUM.
  4395
  4396     GO TO 99999-RETURN.
  4397
  4398 12000-CHECK-MONTANA.
  4399
  4400     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4401        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4402        (M GREATER THAN +63) AND
  4403        (CP-EARN-AS-NET-PAY)
  4404        NEXT SENTENCE
  4405     ELSE
  4406        GO TO 12001-CONTINUE-NCL-TRUNC.
  4407
  4408      COMPUTE ANGLEN EQUAL WK1 / I.
  4409
  4410      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4411
  4412      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4413       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4414       (((N - ANGLEN) / I) + (4 * N)).
  4415
  4416      MOVE WK3 TO CP-CALC-PREMIUM.
  4417
  4418     GO TO 99999-RETURN.
  4419
  4420 12001-CONTINUE-NCL-TRUNC.
  4421
  4422     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4423        (CP-EARN-AS-NET-PAY) AND
  4424        (CP-TRUNCATED-LIFE)
  4425        NEXT SENTENCE
  4426     ELSE
  4427        GO TO 12001-CONTINUE-NCL.
  4428
  4429      COMPUTE ANGLEN EQUAL WK1 / I.
  4430      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4431
  4432      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4433
  4434      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4435      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4436      (ANGLEN-1 * (N + 1) * I).
  4437
  4438      MOVE WK3 TO CP-CALC-PREMIUM.
  4439
  4440     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* ELRATE.cbl
  4441
  4442 12001-CONTINUE-NCL.
  4443
  4444     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4445        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4446        (CP-EARN-AS-NET-PAY)
  4447        GO TO 12001-CHECK-NC-NET-PLUS3.
  4448
  4449     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4450        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4451        (CP-EARN-AS-NET-PAY)
  4452        GO TO 12001-CHECK-CA.
  4453
  4454     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4455        (CP-EARN-AS-NET-PAY)
  4456        NEXT SENTENCE
  4457     ELSE
  4458        GO TO 12000-CONTINUE-NET.
  4459
  4460      COMPUTE ANGLEN EQUAL WK1 / I.
  4461      MOVE ANGLEN                TO ANGLEN-1.
  4462
  4463      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4464
  4465      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4466       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4467       ((N - ANGLEN) / I).
  4468
  4469      MOVE WK3 TO CP-CALC-PREMIUM.
  4470
  4471     GO TO 99999-RETURN.
  4472
  4473 12000-CONTINUE-NET.
  4474
  4475     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4476        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4477        (CP-EARN-AS-NET-PAY)
  4478        NEXT SENTENCE
  4479     ELSE
  4480        GO TO 12001-CONTINUE-MINN.
  4481
  4482      COMPUTE ANGLEN EQUAL WK6 / I.
  4483      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  4484
  4485      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  4486      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  4487      COMPUTE WK3 EQUAL (WK3 / I) *
  4488       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  4489
  4490      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  4491         MOVE +0 TO CP-R-MAX-TOT-BEN.
  4492
  4493      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  4494
  4495      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  4496         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  4497         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  4498
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* ELRATE.cbl
  4499      MOVE WK3 TO CP-CALC-PREMIUM.
  4500
  4501     GO TO 99999-RETURN.
  4502
  4503 12001-CONTINUE-MINN.
  4504
  4505     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4506        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  4507        (CP-TRUNCATED-LIFE)
  4508        NEXT SENTENCE
  4509     ELSE
  4510        GO TO 12001-CHECK-RI-GTL.
  4511
  4512      COMPUTE ANGLEN EQUAL WK1 / I.
  4513      COMPUTE ANGLEM EQUAL WK2 / I.
  4514
  4515      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  4516       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  4517       * M / 2400) * 1000 + .5) / 1000000.
  4518
  4519      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  4520       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  4521
  4522     GO TO 99999-RETURN.
  4523
  4524 12001-CHECK-RI-GTL.
  4525
  4526     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4527        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4528        (CP-EARN-AS-NET-PAY)
  4529        NEXT SENTENCE
  4530     ELSE
  4531        GO TO 12001-CHECK-RI-LEASE-GTL.
  4532
  4533      COMPUTE ANGLEN EQUAL WK1 / I.
  4534*     COMPUTE ANGLEM EQUAL WK2 / I.
  4535
  4536      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  4537               (1 + WS-WORK-DIS-RATE * N).
  4538      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  4539         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  4540
  4541
  4542     GO TO 99999-RETURN.
  4543
  4544 12001-CHECK-RI-LEASE-GTL.
  4545
  4546     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4547        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4548        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4549        NEXT SENTENCE
  4550     ELSE
  4551        GO TO 12001-CHECK-OR-GTL.
  4552
  4553     COMPUTE ANGLEN EQUAL WK1 / I.
  4554
  4555     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  4556        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* ELRATE.cbl
  4557                        /
  4558        (1000 * I * (1 + .0021 * N)).
  4559     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  4560       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  4561                            /
  4562       (1000 * (1 + .0027 * (N + 1))).
  4563
  4564     GO TO 99999-RETURN.
  4565
  4566 12001-CHECK-OR-GTL.
  4567
  4568     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4569        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  4570        (CP-EARN-AS-NET-PAY)
  4571        NEXT SENTENCE
  4572     ELSE
  4573        GO TO 12001-CHECK-GA-GTL.
  4574
  4575     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4576     COMPUTE ANGLEN EQUAL WK1 / I.
  4577
  4578     IF M LESS THAN +64
  4579        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4580         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  4581                   /
  4582         (I * ANGLEN * (N - (N - M) + 1) * 600)
  4583        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  4584     ELSE
  4585        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4586        CP-PREMIUM-RATE * (1 + I))
  4587                  /
  4588        (+1000 * I * ANGLEN)
  4589        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4590*    MOVE WK3 TO CP-CALC-PREMIUM.
  4591     GO TO 99999-RETURN.
  4592
  4593 12001-CHECK-GA-GTL.
  4594
  4595     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4596        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  4597        (CP-EARN-AS-NET-PAY)
  4598*       (CP-TRUNCATED-LIFE)
  4599        NEXT SENTENCE
  4600     ELSE
  4601        GO TO 12001-CHECK-MA-GTL.
  4602
  4603     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4604     COMPUTE ANGLEN EQUAL WK1 / I.
  4605
  4606     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  4607     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  4608      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  4609     MOVE WK3 TO CP-CALC-PREMIUM.
  4610
  4611     GO TO 99999-RETURN.
  4612
  4613 12001-CHECK-MA-GTL.
  4614
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* ELRATE.cbl
  4615     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4616        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  4617        (CP-EARN-AS-NET-PAY) AND
  4618        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4619        NEXT SENTENCE
  4620     ELSE
  4621        GO TO 12001-CHECK-NV-NET.
  4622
  4623     COMPUTE ANGLEN EQUAL WK1 / I.
  4624
  4625     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  4626      CP-ALTERNATE-BENEFIT * N.
  4627
  4628     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  4629     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  4630
  4631     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  4632     WK7 * (N - ANGLEN) / I.
  4633     MOVE WK3 TO CP-CALC-PREMIUM.
  4634
  4635     GO TO 99999-RETURN.
  4636
  4637 12001-CHECK-NV-NET.
  4638     IF (CP-COMPANY-ID EQUAL 'CID')
  4639        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4640        AND (CP-EARN-AS-NET-PAY)
  4641        CONTINUE
  4642     ELSE
  4643        GO TO 12001-CHECK-MN-NET
  4644     END-IF
  4645     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4646     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4647     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4648                   / (1 + I)
  4649     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4650     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4651     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4652        (CP-PREMIUM-RATE * K-I / 1000)
  4653     MOVE WK3                    TO CP-CALC-PREMIUM
  4654     GO TO 99999-RETURN
  4655      .
  4656 12001-CHECK-MN-NET.
  4657     IF (CP-COMPANY-ID EQUAL 'CID')
  4658        AND (CP-STATE-STD-ABBRV = 'MN')
  4659        AND (CP-EARN-AS-NET-PAY)
  4660        AND (NOT CP-LEVEL-LIFE)
  4661        AND (WS-DISCOUNT-OPTION = '1')
  4662        CONTINUE
  4663     ELSE
  4664        GO TO 12001-CHECK-NC-NET
  4665     END-IF
  4666     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4667     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4668     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4669                   / (1 + I)
  4670     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4671     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4672     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* ELRATE.cbl
  4673        (CP-PREMIUM-RATE / 1000) * (1 + I)
  4674     MOVE WK3                    TO CP-CALC-PREMIUM
  4675     GO TO 99999-RETURN
  4676      .
  4677 12001-CHECK-NC-NET.
  4678
  4679     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  4680        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4681        (CP-EARN-AS-NET-PAY)
  4682        NEXT SENTENCE
  4683     ELSE
  4684        GO TO 12001-CHECK-NC-NET-PLUS3.
  4685
  4686      COMPUTE ANGLEN EQUAL WK1 / I.
  4687      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4688
  4689      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  4690          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  4691          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  4692          N * (CP-PREMIUM-RATE / 1000)).
  4693
  4694      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  4695          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  4696
  4697      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  4698          ((N - ANGLEN) / I + 3) / ANGLEN) /
  4699          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  4700          (ANGLEN * 2))
  4701
  4702      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  4703
  4704      IF ANGLEN IS NOT LESS THAN WK7
  4705          COMPUTE CP-PREMIUM-RATE ROUNDED =
  4706              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  4707          COMPUTE WK3 ROUNDED =
  4708              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  4709
  4710     MOVE WK3 TO CP-CALC-PREMIUM.
  4711
  4712     GO TO 99999-RETURN.
  4713
  4714 12001-CHECK-NC-NET-PLUS3.
  4715
  4716     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4717        (CP-EARN-AS-NET-PAY) AND
  4718        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  4719        NEXT SENTENCE
  4720     ELSE
  4721        GO TO 12001-CHECK-CA.
  4722
  4723     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  4724     MOVE ' ' TO DC-OPTION-CODE.
  4725     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  4726
  4727     IF DATE-CONVERSION-ERROR
  4728        MOVE '2'                 TO CP-RETURN-CODE
  4729        MOVE ZEROS               TO FACTOR
  4730                                    CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* ELRATE.cbl
  4731         GO TO 99999-RETURN.
  4732
  4733     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  4734        NEXT SENTENCE
  4735     ELSE
  4736        GO TO 12001-CONTINUE-NET.
  4737
  4738     COMPUTE ANGLEN EQUAL WK1 / I.
  4739     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4740
  4741     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  4742
  4743     COMPUTE NC-R = 20 *
  4744                    ((NC-LR * ORIGINAL-TERM) / 12)
  4745                          / (ORIGINAL-TERM + 1).
  4746
  4747     COMPUTE NC-OB = NC-R / 1000.
  4748
  4749     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  4750                    (NC-OB * ORIGINAL-TERM * 3).
  4751
  4752     IF CP-EXT-CHG-LF
  4753         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  4754     ELSE
  4755         MOVE 30                 TO  NC-BIG-D.
  4756
  4757     COMPUTE NC-LITTLE-D = (1 + I) /
  4758             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  4759
  4760     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  4761             (ANGLEN * NC-LITTLE-D ).
  4762
  4763     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  4764
  4765     GO TO 99999-RETURN.
  4766
  4767 12001-CHECK-CA.
  4768
  4769     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4770        (WS-DISCOUNT-OPTION = '6')
  4771        NEXT SENTENCE
  4772     ELSE
  4773        GO TO 12001-CHECK-GTL-IA.
  4774
  4775     COMPUTE CA-J = CA-DISCOUNT / 12.
  4776     COMPUTE ANGLEN EQUAL WK1 / I.
  4777     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  4778     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  4779     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  4780     COMPUTE CA-VI = (1 + I)** -1.
  4781     COMPUTE CP-CALC-PREMIUM =
  4782         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  4783         ((1 + CA-J) / I) *
  4784         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  4785         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  4786         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  4787
  4788     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* ELRATE.cbl
  4789
  4790 12001-CHECK-GTL-IA.
  4791
  4792     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  4793        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  4794        (CP-EARN-AS-NET-PAY)
  4795        NEXT SENTENCE
  4796     ELSE
  4797        GO TO 12001-CHECK-CID-TRN-VA.
  4798
  4799***************************************************************
  4800
  4801     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  4802
  4803     IF GTL-IA-ODD-DAYS = ZEROS
  4804         MOVE ZERO               TO  GTL-IA-SGN
  4805     ELSE
  4806         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  4807             MOVE +1             TO  GTL-IA-SGN
  4808         ELSE
  4809             MOVE -1             TO  GTL-IA-SGN.
  4810
  4811     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  4812     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  4813
  4814     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  4815                          GTL-IA-SGN.
  4816
  4817     COMPUTE ANGLEN EQUAL WK1 / I.
  4818     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4819
  4820     IF GTL-IA-ODF NOT = ZERO
  4821         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  4822         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  4823
  4824     COMPUTE GTL-IA-DIVIDEND =
  4825           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  4826                             (ANGLEN - ANGLEN-M))) *
  4827           ((K1 + I) * CP-PREMIUM-RATE *
  4828                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  4829
  4830     COMPUTE GTL-IA-DIVISOR =
  4831      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  4832
  4833     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  4834
  4835     COMPUTE CP-CALC-PREMIUM =
  4836                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  4837     GO TO 99999-RETURN.
  4838
  4839
  4840 12001-CHECK-CID-TRN-VA.
  4841
  4842     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4843        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  4844        (CP-EARN-AS-NET-PAY) AND
  4845        (CP-TRUNCATED-LIFE) AND
  4846        (CP-STATE-STD-ABBRV = CP-STATE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* ELRATE.cbl
  4847        CONTINUE
  4848     ELSE
  4849        GO TO 12001-CHECK-CID-TX
  4850     END-IF
  4851
  4852     COMPUTE ANGLEN EQUAL WK1 / I
  4853     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4854     IF WS-WORK-DIS-RATE = ZEROS
  4855        CONTINUE
  4856     ELSE
  4857        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4858        COMPUTE WK7 = (1 / I) *
  4859              (((WK4 ** M - 1) / (WK4 - 1)) -
  4860              ((WK4 ** M * SX - VX) /
  4861              (WK4 * (1 + I) - 1))) *
  4862              (CP-PREMIUM-RATE / 1000)
  4863        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4864        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4865        COMPUTE CP-CALC-PREMIUM =
  4866           WK8 *  ((WK4 * ANGLEN) / 100)
  4867     END-IF
  4868
  4869     GO TO 99999-RETURN
  4870
  4871     .
  4872
  4873 12001-CHECK-CID-TX.
  4874     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4875        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4876        (CP-EARN-AS-NET-PAY) AND
  4877        (WS-WORK-DIS-RATE > ZEROS) AND
  4878        (CP-STATE-STD-ABBRV = CP-STATE)
  4879        CONTINUE
  4880     ELSE
  4881        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4882     END-IF
  4883* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4884     COMPUTE K-I = 1 + (1 * I)
  4885     COMPUTE ANGLEN EQUAL WK1 / I
  4886     COMPUTE ANGLEM EQUAL WK2 / I
  4887     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4888     IF WS-WORK-DIS-RATE = ZEROS
  4889        CONTINUE
  4890     ELSE
  4891        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4892        COMPUTE WK7 = (K-I / I) *
  4893              (((WK4 ** M - 1) / (WK4 - 1)) -
  4894*             ((WK4 ** M * SX - VX) /
  4895              ((WK4 ** M * SX) - VX) /
  4896*             (WK4 * (1 + I) - 1))) *
  4897              (WK4 * (1 + I) - 1)) *
  4898              (CP-PREMIUM-RATE / 1000)
  4899        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4900        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4901        COMPUTE CP-CALC-PREMIUM =
  4902           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4903     END-IF
  4904
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* ELRATE.cbl
  4905     GO TO 99999-RETURN
  4906     .
  4907 12001-CHECK-CID-LEV-MN-NEW.
  4908*    IF (CP-COMPANY-ID EQUAL 'CID')
  4909*       AND (CP-STATE-STD-ABBRV = 'MN')
  4910*       AND (CP-EARN-AS-NET-PAY)
  4911*       AND (CP-LEVEL-LIFE)
  4912*       AND (CP-CERT-EFF-DT > X'A4FF')
  4913*       CONTINUE
  4914*    ELSE
  4915*       GO TO 12001-CHECK-CID-LEV-MN
  4916*    END-IF
  4917*
  4918*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4919*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4920*    MOVE '1'                    TO DC-OPTION-CODE
  4921*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4922*
  4923*    IF DATE-CONVERSION-ERROR
  4924*       MOVE '2'                 TO CP-RETURN-CODE
  4925*       MOVE ZEROS               TO FACTOR
  4926*                                   CP-CALC-PREMIUM
  4927*       GO TO 99999-RETURN
  4928*    END-IF
  4929*
  4930*    COMPUTE I = CP-LOAN-APR / 100
  4931*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4932*
  4933*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4934*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4935*      * 12 / 360 * D)
  4936*
  4937*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4938*       * 12 / 360 * D
  4939*
  4940*    GO TO 99999-RETURN
  4941      .
  4942 12001-CHECK-CID-LEV-MN.
  4943
  4944     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4945        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4946        (CP-EARN-AS-NET-PAY) AND
  4947        (CP-LEVEL-LIFE) AND
  4948        (CP-STATE-STD-ABBRV = CP-STATE)
  4949        CONTINUE
  4950     ELSE
  4951        GO TO 12001-CHECK-CID-LEV-CA
  4952     END-IF
  4953
  4954     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4955         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4956         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4957
  4958     GO TO 99999-RETURN
  4959
  4960      .
  4961 12001-CHECK-CID-LEV-CA.
  4962
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* ELRATE.cbl
  4963     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4964        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4965        (CP-EARN-AS-NET-PAY) AND
  4966        (CP-LEVEL-LIFE) AND
  4967        (CP-STATE-STD-ABBRV = CP-STATE)
  4968        CONTINUE
  4969     ELSE
  4970        GO TO 12001-CHECK-CID-TRN-CA
  4971     END-IF
  4972
  4973     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4974     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4975     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4976     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4977     COMPUTE CP-CALC-PREMIUM =
  4978          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4979          (CP-PREMIUM-RATE / 1000)) /
  4980          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4981
  4982     GO TO 99999-RETURN
  4983
  4984      .
  4985 12001-CHECK-CID-TRN-CA.
  4986
  4987     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4988        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4989        (CP-EARN-AS-NET-PAY) AND
  4990        (CP-TRUNCATED-LIFE) AND
  4991        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4992        (WS-DISCOUNT-OPTION NOT = ' ')
  4993        CONTINUE
  4994     ELSE
  4995        GO TO 12001-CHECK-CID-TRN-MT
  4996     END-IF
  4997
  4998     COMPUTE ANGLEN EQUAL WK1 / I
  4999     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5000     IF WS-WORK-DIS-RATE = ZEROS
  5001        CONTINUE
  5002     ELSE
  5003        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5004        COMPUTE WK7 = (1 / I) *
  5005              (((WK4 ** M - 1) / (WK4 - 1)) -
  5006              ((WK4 ** M * SX - VX) /
  5007              (WK4 * (1 + I) - 1))) *
  5008              (CP-PREMIUM-RATE / 1000)
  5009        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5010        COMPUTE CP-CALC-PREMIUM =
  5011           WK4 *  WK7
  5012     END-IF
  5013
  5014     GO TO 99999-RETURN
  5015
  5016      .
  5017 12001-CHECK-CID-TRN-MT.
  5018
  5019     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5020        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* ELRATE.cbl
  5021                   OR
  5022        ((CP-STATE-STD-ABBRV = 'IN') AND
  5023        (CP-CERT-EFF-DT > X'9A7F'))
  5024                   OR
  5025        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5026        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5027        (CP-EARN-AS-NET-PAY) AND
  5028        (CP-TRUNCATED-LIFE) AND
  5029        (CP-STATE-STD-ABBRV = CP-STATE)
  5030        CONTINUE
  5031     ELSE
  5032        GO TO 12001-CHECK-CID-MT
  5033     END-IF
  5034
  5035* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5036     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5037        MOVE 0                   TO K-I
  5038     ELSE
  5039        MOVE 2                   TO K-I
  5040     END-IF
  5041     COMPUTE CP-TERM-OR-EXT-DAYS =
  5042           CP-TERM-OR-EXT-DAYS + 30
  5043
  5044     COMPUTE ANGLEN EQUAL WK1 / I
  5045     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5046     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5047                   / (1 + I)
  5048     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5049     IF WS-WORK-DIS-RATE = ZEROS
  5050        CONTINUE
  5051     ELSE
  5052        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5053*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5054        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5055              (((WK4 ** M - 1) / (WK4 - 1)) -
  5056              ((WK4 ** M * SX - VX) /
  5057              (WK4 * (1 + I) - 1))) *
  5058              (CP-PREMIUM-RATE / 1000)
  5059        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5060*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5061        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5062        COMPUTE CP-CALC-PREMIUM =
  5063           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5064*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5065     END-IF
  5066
  5067     GO TO 99999-RETURN
  5068
  5069     .
  5070 12001-CHECK-CID-MT.
  5071
  5072     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5073        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5074                                OR 'VT')
  5075                   OR
  5076        ((CP-STATE-STD-ABBRV = 'IN') AND
  5077        (CP-CERT-EFF-DT > X'9A7F'))
  5078                   OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* ELRATE.cbl
  5079        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5080        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5081        (CP-EARN-AS-NET-PAY) AND
  5082        (CP-STATE-STD-ABBRV = CP-STATE)
  5083        CONTINUE
  5084     ELSE
  5085        GO TO 12001-CHECK-DCC-DD
  5086     END-IF
  5087
  5088     COMPUTE CP-TERM-OR-EXT-DAYS =
  5089           CP-TERM-OR-EXT-DAYS + 30
  5090
  5091* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5092     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5093        MOVE 0                   TO K-I
  5094     ELSE
  5095        IF CP-STATE-STD-ABBRV = 'NJ'
  5096           MOVE 1                TO K-I
  5097        ELSE
  5098           MOVE 2                TO K-I
  5099        END-IF
  5100     END-IF
  5101     COMPUTE ANGLEN EQUAL WK1 / I
  5102     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5103     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5104                   / (1 + I)
  5105     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5106     IF WS-WORK-DIS-RATE = ZEROS
  5107        CONTINUE
  5108     ELSE
  5109        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5110*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5111        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5112              (((WK4 ** N - 1) / (WK4 - 1)) -
  5113              ((WK4 ** N - SV) /
  5114              (WK4 * (1 + I) - 1))) *
  5115              (CP-PREMIUM-RATE / 1000)
  5116        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5117*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5118        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5119        COMPUTE CP-CALC-PREMIUM =
  5120           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5121*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5122     END-IF
  5123
  5124     GO TO 99999-RETURN
  5125
  5126     .
  5127 12001-CHECK-DCC-DD.
  5128     IF (CP-COMPANY-ID EQUAL 'DCC')
  5129        AND (CP-EARN-AS-NET-PAY)
  5130        AND (CP-BEN-CATEGORY = 'D')
  5131        CONTINUE
  5132     ELSE
  5133        GO TO 12001-CHECK-DCC-NET
  5134     END-IF
  5135
  5136     COMPUTE CP-TERM-OR-EXT-DAYS =
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* ELRATE.cbl
  5137           CP-TERM-OR-EXT-DAYS + 30
  5138
  5139     COMPUTE ANGLEN EQUAL WK1 / I.
  5140     COMPUTE ANGLEM EQUAL WK2 / I.
  5141     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5142
  5143     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5144           / (1 + I)
  5145     COMPUTE GR     = ANGLEN / ODF
  5146*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5147*      CP-RATE-DEV-PCT
  5148     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5149     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5150       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5151     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5152     MOVE WK3                    TO CP-CALC-PREMIUM
  5153
  5154     GO TO 99999-RETURN
  5155
  5156     .
  5157 12001-CHECK-DCC-NET.
  5158
  5159     IF (CP-COMPANY-ID EQUAL 'DCC')
  5160        AND (CP-EARN-AS-NET-PAY)
  5161        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5162             AND 'H' AND 'S' AND 'P')
  5163        CONTINUE
  5164     ELSE
  5165        GO TO 12001-CHECK-DCC-PNET
  5166     END-IF
  5167
  5168     COMPUTE CP-TERM-OR-EXT-DAYS =
  5169           CP-TERM-OR-EXT-DAYS + 30
  5170
  5171     COMPUTE ANGLEN EQUAL WK1 / I.
  5172     COMPUTE ANGLEM EQUAL WK2 / I.
  5173     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5174
  5175     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5176           / (1 + I)
  5177     COMPUTE GR     = ANGLEN / ODF
  5178     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5179     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5180       CP-RATE-DEV-PCT
  5181     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5182*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5183
  5184     COMPUTE WK8 = CP-PREMIUM-RATE *
  5185        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5186     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5187     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5188     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5189       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5190     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5191     MOVE WK3                    TO CP-CALC-PREMIUM
  5192
  5193     GO TO 99999-RETURN
  5194
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* ELRATE.cbl
  5195     .
  5196 12001-CHECK-DCC-PNET.
  5197     IF (CP-COMPANY-ID EQUAL 'DCC')
  5198        AND (CP-EARN-AS-NET-PAY)
  5199        AND (CP-BENEFIT-CD (1:1) = 'P')
  5200        CONTINUE
  5201     ELSE
  5202        GO TO 12001-CHECK-DCC-MNET
  5203     END-IF
  5204     IF CP-NO-OF-PMTS NOT NUMERIC
  5205        MOVE +0                  TO CP-NO-OF-PMTS
  5206     END-IF
  5207     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5208        AND ' ' AND 'M'
  5209        MOVE ' '                 TO CP-PMT-MODE
  5210     END-IF
  5211     EVALUATE CP-PMT-MODE
  5212        WHEN 'W'
  5213           MOVE +7               TO C-DAYS-IN-PMT-PER
  5214           MOVE +52              TO C-PMTS-PER-YEAR
  5215           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  5216        WHEN 'B'
  5217           MOVE +14              TO C-DAYS-IN-PMT-PER
  5218           MOVE +26              TO C-PMTS-PER-YEAR
  5219           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  5220        WHEN OTHER
  5221           MOVE +30              TO C-DAYS-IN-PMT-PER
  5222           MOVE +12              TO C-PMTS-PER-YEAR
  5223           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  5224     END-EVALUATE
  5225     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5226     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5227        C-DAYS-IN-PMT-PER)) / (1 + I)
  5228     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5229     COMPUTE ANGLEN-1 = ANGLEN / Y
  5230     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5231     IF CP-RATE-DEV-PCT NOT = ZEROS
  5232        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5233           CP-PREMIUM-RATE
  5234     END-IF
  5235     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5236     GO TO 99999-RETURN
  5237     .
  5238 12001-CHECK-DCC-MNET.
  5239
  5240     IF (CP-COMPANY-ID EQUAL 'DCC')
  5241        AND (CP-EARN-AS-NET-PAY)
  5242        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5243        CONTINUE
  5244     ELSE
  5245        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5246     END-IF
  5247
  5248*    COMPUTE ANGLEN EQUAL WK1 / I.
  5249*    COMPUTE ANGLEM EQUAL WK2 / I.
  5250*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5251
  5252     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* ELRATE.cbl
  5253     MOVE WK3                    TO CP-CALC-PREMIUM
  5254
  5255     GO TO 99999-RETURN
  5256
  5257     .
  5258 12001-CHECK-DCC-MNET-LF-BAL.
  5259
  5260     IF (CP-COMPANY-ID EQUAL 'DCC')
  5261        AND (CP-EARN-AS-NET-PAY)
  5262        AND (CP-BENEFIT-CD (1:1) = 'N')
  5263        AND (CP-BEN-CATEGORY NOT = 'N')
  5264        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5265        CONTINUE
  5266     ELSE
  5267        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5268     END-IF
  5269
  5270     IF CP-RATE-DEV-PCT NOT = ZEROS
  5271        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5272           CP-PREMIUM-RATE
  5273     END-IF
  5274*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5275     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5276        / (1 + I)
  5277     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5278     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5279     COMPUTE WK2 = (1 + J) ** (M * -1)
  5280     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5281     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5282          ** ((M - 1) * -1))) / J)
  5283     COMPUTE ANGLEM = ((1 - ((1 + J)
  5284          ** (M * -1))) / J) / OD
  5285     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5286        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5287        / ANGLEM-1
  5288     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5289          ** ((N - M) * -1))) / I)
  5290     MOVE +0                     TO WK3
  5291     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5292        (WS-COUNTER > M)
  5293        COMPUTE ANGLEM = (1 - ((1 + J)
  5294          ** ((M - WS-COUNTER) * -1))) / J
  5295        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5296        COMPUTE WK5-CSL = (RA * ANGLEM)
  5297        + (CP-ALTERNATE-BENEFIT * WK2)
  5298        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5299     END-PERFORM
  5300     MOVE WK3                    TO CP-CALC-PREMIUM
  5301
  5302     GO TO 99999-RETURN
  5303
  5304     .
  5305 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5306
  5307     IF (CP-COMPANY-ID EQUAL 'DCC')
  5308        AND (CP-EARN-AS-NET-PAY)
  5309        AND (CP-BENEFIT-CD (1:1) = 'S')
  5310        AND (CP-BEN-CATEGORY NOT = 'N')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* ELRATE.cbl
  5311        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5312        CONTINUE
  5313     ELSE
  5314        GO TO 12001-CHECK-DCC-MNET-LF
  5315     END-IF
  5316
  5317     IF CP-RATE-DEV-PCT NOT = ZEROS
  5318        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5319           CP-PREMIUM-RATE
  5320     END-IF
  5321     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5322     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5323          ** ((M - 1) * -1))) / K)
  5324     COMPUTE ANGLEM = ((1 - ((1 + K)
  5325          ** (M * -1))) / K)
  5326     MOVE CP-MONTHLY-PAYMENT     TO RA
  5327     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5328        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5329        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5330        CP-PREMIUM-RATE / 1000
  5331     MOVE WK3                    TO CP-CALC-PREMIUM
  5332
  5333     GO TO 99999-RETURN
  5334
  5335     .
  5336 12001-CHECK-DCC-MNET-LF.
  5337
  5338     IF (CP-COMPANY-ID EQUAL 'DCC')
  5339        AND (CP-EARN-AS-NET-PAY)
  5340        AND (CP-BENEFIT-CD (1:1) = 'N')
  5341        AND (CP-BEN-CATEGORY NOT = 'N')
  5342        CONTINUE
  5343     ELSE
  5344        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5345     END-IF
  5346
  5347     IF CP-RATE-DEV-PCT NOT = ZEROS
  5348        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5349           CP-PREMIUM-RATE
  5350     END-IF
  5351*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5352     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5353        / (1 + I)
  5354     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5355     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5356     COMPUTE WK2 = (1 + J) ** (M * -1)
  5357     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5358     COMPUTE ANGLEM = ((1 - ((1 + J)
  5359          ** (M * -1))) / J) / OD
  5360     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5361     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5362          ** ((N - M) * -1))) / I)
  5363     MOVE +0                     TO WK3
  5364     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5365        (WS-COUNTER > M)
  5366        COMPUTE ANGLEM = (1 - ((1 + J)
  5367          ** ((M - WS-COUNTER + 1) * -1))) / J
  5368        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* ELRATE.cbl
  5369        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5370        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5371     END-PERFORM
  5372     MOVE WK3                    TO CP-CALC-PREMIUM
  5373
  5374     GO TO 99999-RETURN
  5375
  5376     .
  5377 12001-CHECK-DCC-MNET-SUMLF.
  5378
  5379     IF (CP-COMPANY-ID EQUAL 'DCC')
  5380        AND (CP-EARN-AS-NET-PAY)
  5381        AND (CP-BENEFIT-CD (1:1) = 'S')
  5382        AND (CP-BEN-CATEGORY NOT = 'N')
  5383        CONTINUE
  5384     ELSE
  5385        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5386     END-IF
  5387
  5388     IF CP-RATE-DEV-PCT NOT = ZEROS
  5389        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5390           CP-PREMIUM-RATE
  5391     END-IF
  5392     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5393     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5394        / (1 + K)
  5395     COMPUTE ANGLEN-M = (WK5 / I)
  5396     COMPUTE WK2 = (1 + K) ** (M * -1)
  5397     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5398     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5399     COMPUTE ANGLEM = ((1 - ((1 + K)
  5400          ** (M * -1))) / K) / Y
  5401     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5402     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5403        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5404        - 1)) / K) * RA
  5405     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5406        + (CP-DAYS-TO-1ST-PMT - +30)
  5407        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5408        +0 / 1000 * 12 / 12)
  5409     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5410        * (12 / 12)
  5411     MOVE WK3                    TO CP-CALC-PREMIUM
  5412
  5413     GO TO 99999-RETURN
  5414
  5415     .
  5416 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5417
  5418     IF (CP-COMPANY-ID EQUAL 'DCC')
  5419        AND (CP-EARN-AS-NET-PAY)
  5420        AND (CP-BENEFIT-CD (1:1) = 'N')
  5421        AND (CP-BEN-CATEGORY = 'N')
  5422        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5423        CONTINUE
  5424     ELSE
  5425        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5426     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* ELRATE.cbl
  5427
  5428*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5429     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5430        / (1 + I)
  5431     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5432     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5433     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5434     COMPUTE WK2 = (1 + J) ** (M * -1)
  5435     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5436     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5437          ** ((M - 1) * -1))) / J)
  5438     COMPUTE ANGLEM = ((1 - ((1 + J)
  5439          ** (M * -1))) / J) / OD
  5440     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5441        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5442        / ANGLEM-1
  5443     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5444          ** ((N - M) * -1))) / I)
  5445     MOVE +0                     TO WK3
  5446     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5447        (WS-COUNTER > M)
  5448        COMPUTE ANGLEM = (1 - ((1 + J)
  5449          ** ((M - WS-COUNTER) * -1))) / J
  5450        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5451        COMPUTE WK5-CSL = (RA * ANGLEM)
  5452        + (CP-ALTERNATE-BENEFIT * WK2)
  5453        COMPUTE WK3 = WK3 +
  5454         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5455        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5456          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5457          (CP-DCC-AH-RATE / 1000)
  5458     END-PERFORM
  5459     MOVE WK3                    TO CP-CALC-PREMIUM
  5460
  5461     GO TO 99999-RETURN
  5462
  5463     .
  5464 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5465
  5466     IF (CP-COMPANY-ID EQUAL 'DCC')
  5467        AND (CP-EARN-AS-NET-PAY)
  5468        AND (CP-BENEFIT-CD (1:1) = 'S')
  5469        AND (CP-BEN-CATEGORY = 'N')
  5470        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5471        CONTINUE
  5472     ELSE
  5473        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5474     END-IF
  5475
  5476     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5477     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5478          ** ((M - 1) * -1))) / K)
  5479     COMPUTE ANGLEM = ((1 - ((1 + K)
  5480          ** (M * -1))) / K)
  5481     MOVE CP-MONTHLY-PAYMENT     TO RA
  5482     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5483        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5484        * CP-DCC-AH-RATE / 1000))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* ELRATE.cbl
  5485        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5486        CP-DCC-LF-RATE / 1000
  5487     MOVE WK3                    TO CP-LF-PREM
  5488     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5489        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5490        * CP-DCC-AH-RATE / 1000
  5491     COMPUTE WK3 = WK3 + WK5-CSL
  5492     MOVE WK3                    TO CP-CALC-PREMIUM
  5493
  5494     GO TO 99999-RETURN
  5495      .
  5496 12001-CHECK-DCC-MNET-TOT-N.
  5497
  5498     IF (CP-COMPANY-ID EQUAL 'DCC')
  5499        AND (CP-EARN-AS-NET-PAY)
  5500        AND (CP-BENEFIT-CD (1:1) = 'N')
  5501        AND (CP-BEN-CATEGORY = 'N')
  5502        CONTINUE
  5503     ELSE
  5504        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5505     END-IF
  5506
  5507*    I = APR/1200
  5508*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5509*    RA = PAYMENT AMOUNT
  5510*    WK5-CSL = THE BALANCE (PAY OFF )
  5511*    WK3 = THE ACCUMULATED PREMIUM
  5512*    WK2 = (1 + I) ^ (m * -1)
  5513*    OD  = GAMMA
  5514*
  5515*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5516     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5517        / (1 + I)
  5518     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5519     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5520        (CP-DCC-AH-RATE / +1000)
  5521     COMPUTE WK2 = (1 + J) ** (M * -1)
  5522     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5523     COMPUTE ANGLEM = ((1 - ((1 + J)
  5524          ** (M * -1))) / J) / OD
  5525     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5526     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5527          ** ((N - M) * -1))) / I)
  5528     MOVE +0                     TO WK3
  5529     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5530        (WS-COUNTER > M)
  5531        COMPUTE ANGLEM = (1 - ((1 + J)
  5532          ** ((M - WS-COUNTER + 1) * -1))) / J
  5533        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5534        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5535        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5536           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5537     END-PERFORM
  5538     MOVE WK3                    TO CP-CALC-PREMIUM
  5539
  5540     GO TO 99999-RETURN
  5541
  5542     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* ELRATE.cbl
  5543 12001-CHECK-DCC-MNET-TOT-S.
  5544
  5545     IF (CP-COMPANY-ID EQUAL 'DCC')
  5546        AND (CP-EARN-AS-NET-PAY)
  5547        AND (CP-BENEFIT-CD (1:1) = 'S')
  5548        AND (CP-BEN-CATEGORY = 'N')
  5549        CONTINUE
  5550     ELSE
  5551        GO TO 12001-CONTINUE-NET
  5552     END-IF
  5553
  5554*    I = APR/1200
  5555*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5556*    RA = PAYMENT AMOUNT
  5557*    WK5-CSL = THE BALANCE (PAY OFF )
  5558*    WK3 = THE ACCUMULATED PREMIUM
  5559*    WK2 = (1 + I) ^ (m * -1)
  5560*    OD  = GAMMA
  5561*
  5562     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5563     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5564        / (1 + J)
  5565     COMPUTE ANGLEM = ((1 - ((1 + J)
  5566          ** (M * -1))) / J) / OD
  5567     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5568          ** ((N - M) * -1))) / I)
  5569          * (1 + J) ** (-1 * M)
  5570     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5571     MOVE CP-MONTHLY-PAYMENT     TO RA
  5572     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5573        / +30)
  5574     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5575        ** (WK1) - 1)) / J) * RA
  5576     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5577        + (CP-DAYS-TO-1ST-PMT - +30)
  5578        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5579        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5580     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5581        (12 / 12)
  5582     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5583        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5584        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5585     COMPUTE WK3 = WK3 + WK5-CSL
  5586     MOVE WK3                    TO CP-CALC-PREMIUM
  5587     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5588     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5589        / (1 + K)
  5590     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5591          ** ((N - M) * -1))) / I)
  5592     COMPUTE WK2 = (1 + K) ** (M * -1)
  5593     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5594     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5595     COMPUTE ANGLEM = ((1 - ((1 + K)
  5596          ** (M * -1))) / K) / Y
  5597*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5598     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5599        ((1 + K) ** (M + 1 / Y
  5600        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* ELRATE.cbl
  5601        - 1)) / K) * RA
  5602     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5603        + (CP-DAYS-TO-1ST-PMT - +30)
  5604        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5605        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5606     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5607        * (12 / 12)
  5608     MOVE WK3                    TO CP-LF-PREM
  5609
  5610     GO TO 99999-RETURN
  5611
  5612     .
  5613 12001-CONTINUE-NET.
  5614
  5615     IF NET-STD
  5616        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  5617*          OR 'DCC'
  5618         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5619         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5620         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5621         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5622                               * ((1 + N) / (1 + M))
  5623        ELSE
  5624         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5625         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5626         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5627         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  5628
  5629     IF NET-SMP
  5630         COMPUTE N2 = N * N
  5631         COMPUTE N3 = N2 * N
  5632         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  5633         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  5634         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  5635         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  5636         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  5637
  5638     IF NPO-PRUDENTIAL
  5639       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  5640           VARYING WS-COUNTER FROM 1 BY 1
  5641               UNTIL WS-COUNTER = N
  5642       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  5643       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  5644
  5645     MOVE WK3 TO FACTOR.
  5646
  5647     GO TO 99999-RETURN.
  5648
  5649 12100-PRU-CALC.
  5650     IF WS-COUNTER = 1
  5651         COMPUTE PWK = (I + 1)
  5652     ELSE
  5653         COMPUTE PWK = PWK * (I + 1).
  5654
  5655 12199-EXIT.
  5656      EXIT.
  5657
  5658 99000-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* ELRATE.cbl
  5659     MOVE +9999.999999999 TO N-P-FACTOR.
  5660     MOVE '4'             TO CP-RETURN-CODE.
  5661
  5662     GO TO 99999-EXIT.
  5663
  5664 99999-RETURN.
  5665     MOVE FACTOR          TO N-P-FACTOR.
  5666
  5667 99999-EXIT.
  5668      EXIT.
  5669 99999-DUMMY-STOP-RUN.
  5670
  5671* GOBACK.
  5672     MOVE '9%                    "   ' TO DFHEIV0
  5673     MOVE 'ELRATE' TO DFHEIV1
  5674     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5675     GOBACK.
  5676
  5677
  5678 9999-DFHBACK SECTION.
  5679     MOVE '9%                    "   ' TO DFHEIV0
  5680     MOVE 'ELRATE' TO DFHEIV1
  5681     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5682     GOBACK.
  5683 9999-DFHEXIT.
  5684     IF DFHEIGDJ EQUAL 0001
  5685         NEXT SENTENCE
  5686     ELSE IF DFHEIGDJ EQUAL 2
  5687         GO TO 9999-RATE-NOTFND,
  5688               9999-RATE-NOTOPEN,
  5689               9999-RATE-NOTFND
  5690         DEPENDING ON DFHEIGDI.
  5691     MOVE '9%                    "   ' TO DFHEIV0
  5692     MOVE 'ELRATE' TO DFHEIV1
  5693     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5694     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2556     Code:       50073
