* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    58* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    59******************************************************************
    60 ENVIRONMENT DIVISION.
    61
    62 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page   3
* EL050.cbl
    64 WORKING-STORAGE SECTION.
    65 01  DFH-START PIC X(04).
    66
    67 77  FILLER   PIC X(32) VALUE '********************************'.
    68 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    69 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    70
    71 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    72 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    73                                   USAGE POINTER.
    74 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    75 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    76 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    77                                   USAGE IS POINTER.
    78 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    79 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    80                                   USAGE IS POINTER.
    81 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    82 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    83                                   USAGE IS POINTER.
    84
    85 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    86 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    87                                   USAGE IS POINTER.
    88
    89*    COPY ELC50WS.
    90*****************************************************************
    91*                                                               *
    92*                            ELC50WS.                           *
    93*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    94*                            VMOD=2.061.                        *
    95*                                                               *
    96*   THIS IS THE WORKING STORAGE FOR EL050                       *
    97*                                   EL517                       *
    98*****************************************************************
    99******************************************************************
   100*                   C H A N G E   L O G
   101*
   102* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   103*-----------------------------------------------------------------
   104*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   105* EFFECTIVE    NUMBER
   106*-----------------------------------------------------------------
   107* 123102                   PEMA  ADD DCC PROCESSING
   108* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   109* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   110* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   111* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   112* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   113* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   114* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   115* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   116* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   117* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   118* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   119* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   120* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   121* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page   4
* EL050.cbl
   122* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   123* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   124* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   125* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   126* 030309  CR2009021700001  PEMA  ADD ER-2883
   127* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   128* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   129* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   130* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   131* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   132* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   133* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   134* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   135* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   136* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   137* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   138* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   139* 061412  CR2011022800001  AJRA  NAPERSOFT
   140* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   141* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   142* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   143* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   144* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   145* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   146* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   147* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   148* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   149* 091114  IR2014091000001  TANA  ADD ERROR 2898
   150* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   151* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   152* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   153* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   154* 100617  CR2017062000003  PEMA  Inforce state comm cap
   155* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   156* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   157* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   158* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   159* 100518  CR2017061500001  TANA  ADD NEW ERROR MSGS
   160*-----------------------------------------------------------------
   161
   162 01  WORK-AREAS.
   163
   164*****************************************************************
   165*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   166*****************************************************************
   167
   168     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   169     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   170     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   171     12  WS-NAME-EDIT-WORK-AREA.
   172         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   173         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   174             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   175         16  WS-WORK-NAME.
   176             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   177             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   178             20  FILLER           PIC X(10)     VALUE SPACES.
   179         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page   5
* EL050.cbl
   180             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   181
   182*****************************************************************
   183*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   184*****************************************************************
   185
   186     12  WS-ERRESC-KEY.
   187         16 WS-ERRESC-SEARCH-KEY.
   188             20  WS-ERRESC-COMPANY-CD PIC  X.
   189             20  WS-ERRESC-CARRIER    PIC  X.
   190             20  WS-ERRESC-GROUP      PIC X(6).
   191             20  WS-ERRESC-STATE      PIC XX.
   192             20  WS-ERRESC-ACCOUNT    PIC X(10).
   193         16 WS-ERRESC-RESIDUAL-KEY.
   194             20  WS-ERRESC-AGENT      PIC X(10).
   195             20  WS-ERRESC-RES-STATE  PIC XX.
   196             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   197*                                          YYYYMMDD
   198     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   199     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   200
   201*RESIDENT STATE TAX MASTER(ERRESS)
   202*
   203     12  WS-ERRESS-KEY.
   204         16  WS-ERRESS-COMPANY-CD      PIC  X.
   205         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   206         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   207         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   208*                                          YYYYMMDD
   209
   210     12  WS-CONTRACT-DATE              PIC 9(8).
   211*                                          YYYYMMDD
   212     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   213     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   214         16 WS-YEAR-YY                 PIC   9999.
   215         16 FILLER                     PIC 9(4).
   216*                                          YYYYMMDD
   217     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   218     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   219     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   220     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   221
   222     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   223         88  DPRB-1ST-TIME                      VALUE ' '.
   224
   225*****************************************************************
   226*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   227*****************************************************************
   228
   229     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   230     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   231     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   232     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   233     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   234     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   235     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   236     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   237     12  ws-st-agent-sig-edit    pic x          value spaces.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page   6
* EL050.cbl
   238     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   239     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   240     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   242         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   243         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   244     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   245         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   246         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   247     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   248
   249     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   250     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   251
   252     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   253     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   258     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   259     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   263     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   264     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   265     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   266     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   267     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   271     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   279     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   280     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   281     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   282     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   283     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   284     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   285     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   286     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   287     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   288     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   289     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   290     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   291     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   292     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   293     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   294     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   295     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page   7
* EL050.cbl
   296     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   297     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   298     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   299     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   300     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   301     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   302     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   303     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   304     12  WS-2671-SW               PIC X         VALUE SPACE.
   305     12  WS-2672-SW               PIC X         VALUE SPACE.
   306     12  ws-9813-sw               pic x         value spaces.
   307     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   308         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   309     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   310         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   311     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   312
   313     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   314         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   315         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   316         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   317         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   318
   319     12  WS-CREDIT-EDIT-CONTROLS.
   320         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   321         16  WS-MIN-AGE           PIC 99                VALUE  0.
   322         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   323         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   324         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   325         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   326
   327     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   328     12  WS-AGE-FIELDS.
   329         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   330         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   331         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   332         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   333
   334     12  WS-SAVE-ALLOWABLE-BENEFIT.
   335         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   336         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   337         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   338         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   339         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   340         16  FILLER                      PIC XX.
   341
   342     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   343     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   344     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   345     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   346     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   347     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   348     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   349     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   350     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   351     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   352
   353     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page   8
* EL050.cbl
   354     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   355     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   356     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   357     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   358     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   359     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   360     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   361         88  WS-REDUCING              VALUE 'R'.
   362         88  WS-LEVEL                 VALUE 'L' 'P'.
   363     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   364
   365     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   366     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   367     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   368     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   369     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   370     12  ws-ah-max-bens           pic 99        value zeros.
   371     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   372     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   373     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   374     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   375
   376     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   377     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   378     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   379     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   380     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   381     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   382     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   383     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   384     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   385     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   386     12  WS-ACCT-SIG-SW.
   387         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   388         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   389     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   390     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   391     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   392     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   393     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   394     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   395     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   396     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   397     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   398     12  WS-INITIALS.
   399         16  WS-INIT-1            PIC X         VALUE SPACES.
   400         16  WS-INIT-2            PIC X         VALUE SPACES.
   401
   402     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   403     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   404     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   405     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   406     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   407*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   408     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   409     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   410     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   411     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page   9
* EL050.cbl
   412     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   413     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   414     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   415     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   416     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   417     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   418     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   419     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   420     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   421     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   422     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   423     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   424     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   425     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   426     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   427     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   428     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   429     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   430******** FLA
   431     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   432     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   433     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   434     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   435     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   436********
   437     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   438     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   439     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   440     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   441     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   442     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   443     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   444     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   445     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   446     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   447
   448     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   449         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   450                                         '0' THRU '9'.
   451
   452     12  NUMBER-OF-MONTHS.
   453         16  SK-MO OCCURS 12 TIMES PIC X.
   454
   455     12  WS-WORK-DATE.
   456         16  WS-YEAR            PIC 99    VALUE 00.
   457         16  WS-MONTH           PIC 99    VALUE 00.
   458         16  WS-DAY             PIC 99    VALUE 00.
   459
   460     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   461     12  WS-WORK-CRIT-DEV       REDEFINES
   462         WS-WORK-LF-CRIT-PER    PIC X(03).
   463
   464     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   465     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   466
   467     12  WS-WORK-DATE-FROM.
   468         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   469         16  FILLER             PIC X  VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  10
* EL050.cbl
   470         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   471         16  FILLER             PIC X         VALUE SPACE.
   472         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   473
   474     12  WS-WORK-DATE-THRU.
   475         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   476         16  FILLER             PIC X         VALUE SPACE.
   477         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   478         16  FILLER             PIC X         VALUE SPACE.
   479         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   480
   481     12  WS-LF-INPUT-CD.
   482         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   483         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   484
   485     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   486     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   487         16  WS-AH-INPUT-CD-1   PIC X.
   488         16  WS-AH-INPUT-CD-2-3 PIC XX.
   489
   490     12  WS-SWITCHES.
   491         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   492         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   493             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   494         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   495             88  BANK-ACCT-FOUND          VALUE 'Y'.
   496         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   497             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   498         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   499             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   500         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   501             88  COMP-MASTER-FOUND        VALUE 'Y'.
   502         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   503             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   504         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   505             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   506         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   507             88  STAT-MASTER-FOUND        VALUE 'Y'.
   508         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   509             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   510         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
   511             88  ELCRTT-FOUND             VALUE 'Y'.
   512         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
   513             88  ELCRTT-UPDATE            VALUE 'Y'.
   514         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   515             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   516         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   517             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   518         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   519             88  FORM-MASTER-FOUND        VALUE 'Y'.
   520         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   521             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   522         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   523             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   524         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   525             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   526         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   527             88  NO-BENEFIT-FOUND         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  11
* EL050.cbl
   528         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   529             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   530         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   531             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   532         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   533             88  AH-BENEFIT-FOUND         VALUE ' '.
   534             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   535         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   536             88  LF-BENEFIT-FOUND         VALUE ' '.
   537             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   538         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   539             88  NO-STATE-RECORD          VALUE '1'.
   540         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   541             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   542         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   543             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   544         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   545             88  CERT-WAS-FOUND           VALUE ' '.
   546             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   547         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   548             88  BROWSE-STARTED           VALUE 'Y'.
   549         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   550             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   551         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   552             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   553         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   554             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   555         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   556             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   557         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   558             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   559         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   560             88  APP-CERT-USED            VALUE 'Y' 'A'.
   561         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   562             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   563             88  FIRST-TIME-THROUGH       VALUE '1'.
   564             88  CTBL-NOT-FOUND           VALUE '2'.
   565
   566         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   567             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   568
   569         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   570             88  DLO-ERROR-FOUND          VALUE 'Y'.
   571
   572********FLA
   573     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   574     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   575********
   576     12  RC-SW-1                  PIC X           VALUE '0'.
   577     12  RC-SW-2                  PIC X           VALUE '0'.
   578     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   579     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   580     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   581     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   582     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   583     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   584     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   585     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  12
* EL050.cbl
   586     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   587     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   588     12  LIT-SPACES               PIC X           VALUE SPACES.
   589     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   590     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   591     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   592     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   593     12  erpndm-unlock-sw         pic x           value spaces.
   594         88  need-to-unlock-erpndm  value 'Y'.
   595     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   596     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   597     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   598         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   599         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   600     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   601         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   602
   603 01  WS-EXTRA-PERIODS-BY-STATE.
   604     12  WS-INT-PERIODS          PIC 9.
   605     12  WS-EXTRA-PMTS           PIC 9.
   606 01  ws-net-only-state           pic x value 'N'.
   607 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   608     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   609     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   610 01  WS-CRI-SSN-WORK-AREA.
   611     05  WS-CRI-SOC-SEC-NO.
   612         10  WS-SS-REPT-CD       PIC X(5).
   613         10  WS-SS-LAST-NAME     PIC X(5).
   614         10  WS-SS-INITIAL       PIC X.
   615
   616     05  WS-CRI-REPORT-CODE.
   617         10  FILLER              PIC X(5).
   618         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   619
   620     05  WS-CRI-LAST-NAME.
   621         10  WS-CRI-NAME-MOVE    PIC X(5).
   622         10  FILLER              PIC X(10).
   623
   624 01  ws-state-commission-caps.
   625     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   626     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   627     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   628     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   629     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   630     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   631     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   632     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   633     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   634     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   635     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   636     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   637     05  ws-st-cap-limit-to      pic x.
   638     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   639     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   640     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   641     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   642     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   643     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  13
* EL050.cbl
   644     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   645     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   646     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   647     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   648     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   649     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   650 01  WS-NUM-TABLE                PIC X(26)  VALUE
   651     '12345678012345070923456789'.
   652 01  FILLER REDEFINES WS-NUM-TABLE.
   653     05  WS-NUM OCCURS 26        PIC 9.
   654 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   655 01  V1                          PIC S999 COMP-3.
   656 01  V2                          PIC S999 COMP-3.
   657 01  V3                          PIC S999 COMP-3.
   658 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   659 01  FILLER REDEFINES WS-WORK-VIN.
   660     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   661 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   662 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   663 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   664 01  WS-HEX-WORK.
   665     05  FILLER                  PIC X  VALUE LOW-VALUES.
   666     05  WS-HEX-BYTE             PIC X.
   667 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   668 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   669 01  WS-WORK-HIN-ROW-B.
   670     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   671
   672 01  ws-benefit-cd-chg-sw      pic x value spaces.
   673     88  benefit-code-chg           value 'Y'.
   674 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   675 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   676     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   677 01  WS-ROW-D-TABLE.
   678     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   679
   680 01  WS-HIN-TABLE-B.
   681     05  F                       PIC XX VALUE 'A2'.
   682     05  F                       PIC XX VALUE 'B3'.
   683     05  F                       PIC XX VALUE 'C4'.
   684     05  F                       PIC XX VALUE 'D5'.
   685     05  F                       PIC XX VALUE 'E6'.
   686     05  F                       PIC XX VALUE 'F7'.
   687     05  F                       PIC XX VALUE 'G8'.
   688     05  F                       PIC XX VALUE 'H9'.
   689     05  F                       PIC XX VALUE 'I1'.
   690     05  F                       PIC XX VALUE 'J2'.
   691     05  F                       PIC XX VALUE 'K3'.
   692     05  F                       PIC XX VALUE 'L4'.
   693     05  F                       PIC XX VALUE 'M5'.
   694     05  F                       PIC XX VALUE 'N6'.
   695     05  F                       PIC XX VALUE 'O0'.
   696     05  F                       PIC XX VALUE 'P7'.
   697     05  F                       PIC XX VALUE 'Q0'.
   698     05  F                       PIC XX VALUE 'R8'.
   699     05  F                       PIC XX VALUE 'S9'.
   700     05  F                       PIC XX VALUE 'T2'.
   701     05  F                       PIC XX VALUE 'U3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  14
* EL050.cbl
   702     05  F                       PIC XX VALUE 'V4'.
   703     05  F                       PIC XX VALUE 'W5'.
   704     05  F                       PIC XX VALUE 'X6'.
   705     05  F                       PIC XX VALUE 'Y7'.
   706     05  F                       PIC XX VALUE 'Z8'.
   707 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   708     05  WS-VAL-IN               PIC X.
   709     05  WS-VAL-OUT              PIC 9.
   710 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   711 01  ws-greg-eff-date            pic x(10) value ' '.
   712 01  WS-COMPARE-BINARY-DATES.
   713     05  WS-971231                PIC XX VALUE X'92FF'.
   714     05  WS-931231                PIC XX VALUE X'8CFF'.
   715     05  WS-791231                PIC XX VALUE X'77FF'.
   716     05  WS-771001                PIC XX VALUE X'74A1'.
   717     05  WS-820301                PIC XX VALUE X'7B41'.
   718     05  WS-831031                PIC XX VALUE X'7DBF'.
   719     05  WS-831231                PIC XX VALUE X'7DFF'.
   720     05  WS-810831                PIC XX VALUE X'7A7F'.
   721     05  WS-830901                PIC XX VALUE X'7D81'.
   722
   723 01  FILE-ACCESS-IDS.
   724     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   725     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   726     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   727     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   728     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   729     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   730     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   731     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   732     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   733     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   734     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   735     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   736     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   737     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   738     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   739     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   740     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   741 01  DD-IU-SW                    PIC X   VALUE ' '.
   742     88  DD-IU-PRESENT                 VALUE 'Y'.
   743
   744 01  ACCESS-KEYS.
   745     12  ELMSTR-KEY.
   746         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   747         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   748     12  W-CLAIM-KEY.
   749         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   750         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   751
   752     12  ELCNTL-KEY.
   753         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   754         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   755         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   756         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   757
   758     12  ELCERT-KEY.
   759         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  15
* EL050.cbl
   760         16  CERT-CARRIER         PIC X       VALUE SPACE.
   761         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   762         16  CERT-STATE           PIC XX      VALUE SPACES.
   763         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   764         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   765         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   766
   767     12  ELCERT2-KEY.
   768         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   769         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   770
   771     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   772
   773     12  ELCERT-SAVE.
   774         16  FILLER                      PIC XX    VALUE SPACES.
   775
   776         16  WCS-CONTROL-PRIMARY.
   777             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   778             20  WCS-CARRIER             PIC X     VALUE SPACE.
   779             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   780             20  WCS-STATE               PIC XX    VALUE SPACES.
   781             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   782             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   783             20  WCS-CERT-NO.
   784                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   785                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   786
   787         16  CS-CONTROL-BY-NAME.
   788             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   789             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   790             20  CS-INSURED-INITIALS.
   791                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   792                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   793
   794         16  CS-CONTROL-BY-SSN.
   795             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   796             20  CS-SOC-SEC-NO.
   797                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   798                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   799                 24  CS-SSN-LN3.
   800                     28 CS-INSURED-INITIALS-A2   PIC XX
   801                                     VALUE SPACES.
   802                     28 CS-PART-LAST-NAME-A2     PIC X
   803                                     VALUE SPACE.
   804
   805         16  CS-CONTROL-BY-CERT-NO.
   806             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   807             20  CS-CERT-NO-A4           PIC X(11)
   808                                     VALUE SPACES.
   809
   810         16  CS-CONTROL-BY-MEMB.
   811             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   812             20  CS-MEMBER-NO.
   813                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   814                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   815                 24  CS-MEMB-LN4.
   816                     28 CS-INSURED-INITIALS-A5   PIC XX
   817                                      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  16
* EL050.cbl
   818                     28 CS-PART-LAST-NAME-A5     PIC XX
   819                                      VALUE SPACES.
   820
   821         16  FILLER              PIC X(360) VALUE SPACES.
   822
   823     12  ERACCT-KEY.
   824         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   825         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   826         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   827         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   828         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   829         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   830
   831     12  ERCOMP-KEY.
   832         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   833         16  COMP-CARRIER         PIC X     VALUE SPACES.
   834         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   835         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   836         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   837         16  COMP-TYPE            PIC X     VALUE SPACES.
   838
   839     12  ERLOFC-KEY.
   840         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   841         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   842         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   843         16  LOFC-STATE           PIC XX    VALUE SPACES.
   844         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   845         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   846
   847     12  WS-ELCRTT-KEY.
   848         16  WS-ELCRTT-PRIMARY       PIC X(33).
   849         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   850
   851     12  ERBXRF-KEY.
   852         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   853         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   854         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   855         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   856
   857     12  ERAGTC-KEY.
   858         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   859         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   860         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   861         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   862         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   863         16  AGTC-TYPE            PIC X     VALUE SPACES.
   864
   865     12  ERPLAN-KEY.
   866         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   867         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   868         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   869         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   870         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   871         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   872         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   873         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   874
   875     12  ERFORM-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  17
* EL050.cbl
   876         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   877         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   878         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   879         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   880
   881     12  ERREIN-KEY.
   882         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   883         16  REIN-TYPE            PIC X     VALUE SPACES.
   884         16  REIN-TABLE-CO.
   885             20  REIN-CODE-1      PIC X     VALUE SPACE.
   886             20  REIN-CODE-2      PIC X     VALUE SPACE.
   887             20  REIN-CODE-3      PIC X     VALUE SPACE.
   888         16  FILLER               PIC X(3)  VALUE SPACES.
   889
   890     12  ERCTBL-KEY.
   891         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   892         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   893         16  CTBL-CNTRL-2.
   894             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   895             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   896
   897     12  ELCRTO-KEY.
   898         16  ELCRTO-COMPANY-CD       PIC X.
   899         16  ELCRTO-CARRIER          PIC X.
   900         16  ELCRTO-GROUPING         PIC X(6).
   901         16  ELCRTO-STATE            PIC XX.
   902         16  ELCRTO-ACCOUNT          PIC X(10).
   903         16  ELCRTO-CERT-EFF-DT      PIC XX.
   904         16  ELCRTO-CERT-NO.
   905             20  ELCRTO-CERT-PRIME   PIC X(10).
   906             20  ELCRTO-CERT-SFX     PIC X.
   907         16  ELCRTO-RECORD-TYPE      PIC X.
   908         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   909
   910
   911     12  WS-ACCESS.
   912         16  FILLER               PIC XX    VALUE SPACES.
   913         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   914
   915     12  WS-CARR-ACCESS.
   916         16  FILLER               PIC X(3)  VALUE SPACES.
   917         16  WS-CARR              PIC X     VALUE SPACE.
   918*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   919*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   920     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   921         88  WS-DMD-LF-RATING   VALUE 'Y'.
   922         88  WS-DMD-AH-RATING   VALUE 'Y'.
   923         88  WS-DMD-NO-RATING   VALUE 'N'.
   924
   925     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   926         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   927                                         'NJ' 'NL'
   928                                         'PJ' 'PL'
   929                                         'SJ' 'SL'.
   930     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   931         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   932                                         'NI' 'NJ' 'NL' 'NU'
   933                                         'PJ' 'PL' 'PI' 'PU'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  18
* EL050.cbl
   934                                         'SI' 'SJ' 'SL' 'SU'
   935                                         'MX' 'MY' 'MZ'.
   936 01  ERPDEF-KEY-SAVE             PIC X(18).
   937 01  ERPDEF-KEY.
   938     12  ERPDEF-COMPANY-CD       PIC X.
   939     12  ERPDEF-STATE            PIC XX.
   940     12  ERPDEF-PROD-CD          PIC XXX.
   941     12  F                       PIC X(7).
   942     12  ERPDEF-BEN-TYPE         PIC X.
   943     12  ERPDEF-BEN-CODE         PIC XX.
   944     12  ERPDEF-EXP-DT           PIC XX.
   945
   946 01  ELSTAT-KEY-SAVE             PIC X(20).
   947 01  ELSTAT-KEY.
   948     12  ELSTAT-COMPANY-ID       PIC XXX.
   949     12  ELSTAT-CARRIER          PIC X.
   950     12  ELSTAT-GROUP            PIC X(6).
   951     12  ELSTAT-STATE            PIC XX.
   952     12  ELSTAT-EXP-DT           PIC 9(8).
   953 01  WS-ERROR-VALUES.
   954     12  ER-1570                     PIC S9(4)   VALUE +1570.
   955     12  ER-1571                     PIC S9(4)   VALUE +1571.
   956     12  er-1572                     pic s9(4)   value +1572.
   957     12  er-1573                     pic s9(4)   value +1573.
   958     12  er-1574                     pic s9(4)   value +1574.
   959     12  ER-1575                     PIC S9(4)   VALUE +1575.
   960     12  er-1576                     pic s9(4)   value +1576.
   961     12  er-1583                     pic s9(4)   value +1583.
   962     12  er-1743                     pic s9(4)   value +1743.
   963     12  er-1744                     pic s9(4)   value +1744.
   964     12  er-1745                     pic s9(4)   value +1745.
   965     12  er-1746                     pic s9(4)   value +1746.
   966     12  er-1747                     pic s9(4)   value +1747.
   967     12  er-1748                     pic s9(4)   value +1748.
   968     12  er-1749                     pic s9(4)   value +1749.
   969     12  er-1750                     pic s9(4)   value +1750.
   970     12  er-1751                     pic s9(4)   value +1751.
   971     12  er-1752                     pic s9(4)   value +1752.
   972     12  er-1753                     pic s9(4)   value +1753.
   973     12  er-1754                     pic s9(4)   value +1754.
   974     12  er-1755                     pic s9(4)   value +1755.
   975     12  er-1756                     pic s9(4)   value +1756.
   976     12  er-1757                     pic s9(4)   value +1757.
   977     12  er-1758                     pic s9(4)   value +1758.
   978     12  er-1759                     pic s9(4)   value +1759.
   979     12  er-1760                     pic s9(4)   value +1760.
   980     12  er-1761                     pic s9(4)   value +1761.
   981     12  ER-1891                     PIC S9(4)   VALUE +1891.
   982     12  ER-1892                     PIC S9(4)   VALUE +1892.
   983     12  ER-1893                     PIC S9(4)   VALUE +1893.
   984     12  ER-1894                     PIC S9(4)   VALUE +1894.
   985     12  ER-1895                     PIC S9(4)   VALUE +1895.
   986     12  ER-1896                     PIC S9(4)   VALUE +1896.
   987     12  ER-1897                     PIC S9(4)   VALUE +1897.
   988     12  ER-1898                     PIC S9(4)   VALUE +1898.
   989     12  ER-1899                     PIC S9(4)   VALUE +1899.
   990     12  ER-1900                     PIC S9(4)   VALUE +1900.
   991     12  ER-1901                     PIC S9(4)   VALUE +1901.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  19
* EL050.cbl
   992     12  ER-1902                     PIC S9(4)   VALUE +1902.
   993     12  ER-1903                     PIC S9(4)   VALUE +1903.
   994     12  ER-1904                     PIC S9(4)   VALUE +1904.
   995     12  ER-1905                     PIC S9(4)   VALUE +1905.
   996     12  ER-1906                     PIC S9(4)   VALUE +1906.
   997     12  ER-1907                     PIC S9(4)   VALUE +1907.
   998     12  ER-1909                     PIC S9(4)   VALUE +1909.
   999     12  ER-1910                     PIC S9(4)   VALUE +1910.
  1000     12  ER-1911                     PIC S9(4)   VALUE +1911.
  1001     12  ER-1912                     PIC S9(4)   VALUE +1912.
  1002     12  ER-1913                     PIC S9(4)   VALUE +1913.
  1003     12  ER-1914                     PIC S9(4)   VALUE +1914.
  1004     12  ER-1915                     PIC S9(4)   VALUE +1915.
  1005     12  ER-1916                     PIC S9(4)   VALUE +1916.
  1006     12  ER-1917                     PIC S9(4)   VALUE +1917.
  1007     12  ER-1918                     PIC S9(4)   VALUE +1918.
  1008     12  ER-1919                     PIC S9(4)   VALUE +1919.
  1009     12  ER-1920                     PIC S9(4)   VALUE +1920.
  1010     12  ER-1921                     PIC S9(4)   VALUE +1921.
  1011     12  ER-1922                     PIC S9(4)   VALUE +1922.
  1012     12  ER-1923                     PIC S9(4)   VALUE +1923.
  1013     12  ER-1924                     PIC S9(4)   VALUE +1924.
  1014     12  ER-1925                     PIC S9(4)   VALUE +1925.
  1015     12  ER-1926                     PIC S9(4)   VALUE +1926.
  1016     12  ER-1927                     PIC S9(4)   VALUE +1927.
  1017     12  ER-1955                     PIC s9(4)   VALUE +1955.
  1018     12  ER-1956                     PIC s9(4)   VALUE +1956.
  1019     12  ER-1957                     PIC s9(4)   VALUE +1957.
  1020     12  ER-1958                     PIC s9(4)   VALUE +1958.
  1021     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1022     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1023     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1024     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1025     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1026     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1027     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1028     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1029     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1030     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1031     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1032     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1033     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1034     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1035     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1036     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1037     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1038     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1039     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1040     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1041     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1042     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1043     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1044     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1045     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1046     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1047     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1048     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1049     12  ER-2622                     PIC S9(4)   VALUE +2622.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  20
* EL050.cbl
  1050     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1051     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1052     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1053     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1054     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1055     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1056     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1057     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1058     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1059     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1060     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1061     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1062     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1063     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1064     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1065     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1066     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1067     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1068     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1069     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1070     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1071     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1072     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1073     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1074     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1075     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1076     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1077     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1078     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1079     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1080     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1081     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1082     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1083     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1084     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1085     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1086     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1087     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1088     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1089     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1090     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1091     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1092     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1093     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1094     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1095     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1096     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1097     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1098     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1099     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1100     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1101     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1102     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1103     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1104     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1105     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1106     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1107     12  ER-2680                     PIC S9(4)   VALUE +2680.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  21
* EL050.cbl
  1108     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1109     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1110     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1111     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1112     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1113     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1114     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1115     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1116     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1117     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1118     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1119     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1120     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1121     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1122     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1123     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1124     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1125     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1126     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1127     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1128     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1129     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1130     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1131     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1132     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1133     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1134     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1135     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1136     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1137     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1138     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1139     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1140     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1141     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1142     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1143     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1144     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1145     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1146     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1147     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1148     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1149     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1150     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1151     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1152     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1153     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1154     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1155     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1156     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1157     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1158     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1159     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1160     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1161     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1162     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1163     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1164     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1165     12  ER-2748                     PIC S9(4)   VALUE +2748.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  22
* EL050.cbl
  1166     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1167     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1168     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1169     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1170     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1171     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1172     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1173     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1174     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1175     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1176     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1177     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1178     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1179     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1180     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1181     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1182     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1183     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1184     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1185     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1186     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1187     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1188     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1189     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1190     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1191     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1192     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1193     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1194     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1195     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1196     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1197     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1198     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1199     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1200     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1201     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1202     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1203     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1204     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1205     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1206     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1207     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1208     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1209     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1210     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1211     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1212     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1213     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1214     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1215     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1216     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1217     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1218     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1219     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1220     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1221     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1222     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1223     12  ER-2890                     PIC S9(4)   VALUE +2890.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  23
* EL050.cbl
  1224     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1225     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1226     12  ER-2894                     PIC S9(4)   VALUE +2894.
  1227     12  ER-2895                     PIC S9(4)   VALUE +2895.
  1228     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1229     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1230     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1231     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1232     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1233     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1234     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1235     12  ER-2998                     PIC S9(4)   VALUE +2998.
  1236     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1237     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1238     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1239     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1240     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1241     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1242     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1243     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1244     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1245     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1246     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1247     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1248     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1249     12  er-3270                     pic s9(4)   value +3270.
  1250     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1251     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1252     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1253     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1254     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1255     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1256     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1257     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1258     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1259     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1260     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1261     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1262     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1263     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1264     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1265     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1266     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1267     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1268     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1269     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1270     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1271     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1272     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1273     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1274     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1275     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1276     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1277     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1278     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1279     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1280     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1281     12  ER-8045                     PIC S9(4)   VALUE +8045.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  24
* EL050.cbl
  1282     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1283     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1284     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1285     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1286     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1287     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1288     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1289     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1290     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1291     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1292     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1293     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1294     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1295     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1296     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1297     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1298     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1299     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1300     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1301     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1302     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1303     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1304     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1305     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1306     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1307     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1308     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1309     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1310     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1311     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1312     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1313     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1314     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1315     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1316     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1317     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1318     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1319     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1320     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1321     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1322     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1323     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1324     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1325     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1326     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1327     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1328     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1329     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1330     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1331     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1332     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1333     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1334     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1335     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1336     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1337     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1338     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1339     12  ER-9501                     PIC S9(4)   VALUE +9501.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  25
* EL050.cbl
  1340     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1341     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1342     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1343     12  er-9823                     pic s9(4)   value +9823.
  1344     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1345******************************************************************
  1346***************   END OF ELC50WS     ****************************
  1347******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  26
* EL050.cbl
  1350 01  WORKING-STORAGE-WORK-AREAS.
  1351     12  WS-RESPONSE             PIC S9(8)  COMP.
  1352         88  WS-RESP-NORMAL           VALUE +00.
  1353         88  WS-RESP-ERROR            VALUE +01.
  1354         88  WS-RESP-NOTFND           VALUE +13.
  1355         88  WS-RESP-DUPREC           VALUE +14.
  1356         88  WS-RESP-ENDFILE          VALUE +20.
  1357     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1358     12  WORK-AREAS.
  1359         16  WK-CONV-GREG.
  1360             24  WCG-CENT             PIC XX.
  1361             24  WCG-REST             PIC X(4).
  1362         16  WORK-GREGORIAN-DATE.
  1363             24  WK-GREG-CENT         PIC XX.
  1364             24  WK-GREG-DATE-YYMMDD.
  1365                 28  WK-GREG-YYMM     PIC X(4).
  1366                 28  WK-GREG-DD       PIC XX.
  1367
  1368         16  WORK-SELECT-DATE.
  1369             24  WK-SELECT-CENT            PIC XX.
  1370             24  WK-SELECT-DATE-YYMMDD.
  1371                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1372                 28  FILLER                PIC XX.
  1373
  1374         16  WK-FORM-NO.
  1375             24  WK-FORM-BANK-ID       PIC X(5).
  1376             24  WK-FORM-UNDRWRTR      PIC X(1).
  1377             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1378
  1379         16  WK-MEMBER-NO.
  1380             24  WK-MEMBER-1-6        PIC X(6).
  1381             24  WK-MEMBER-7-12       PIC X(6).
  1382
  1383         16  WK-FULL-CERT-NO.
  1384             24  WK-CERT-POS-1-2      PIC X(2).
  1385             24  WK-CERT-POS-3        PIC X(1).
  1386             24  WK-CERT-POS-4        PIC X(1).
  1387             24  WK-CERT-POS-5-6      PIC X(2).
  1388             24  WK-CERT-POS-7        PIC X(1).
  1389             24  WK-CERT-POS-8-11     PIC X(4).
  1390
  1391         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1392             88  VALID-RATE-CODE        VALUE 'Y'.
  1393             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1394
  1395         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1396         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1397         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1398         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1399         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1400         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1401         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1402         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1403         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1404         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1405
  1406* DLO001
  1407 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  27
* EL050.cbl
  1408     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1409     12  DMPF-RETURN-CODE          PIC XX.
  1410         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1411         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1412         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1413         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1414         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1415         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1416
  1417* DLO002
  1418 01  WS-DLO-INTERNAL-POLICY-FORM.
  1419     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1420     12  DIPF-RETURN-CODE          PIC XX.
  1421         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1422         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1423         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1424         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1425         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1426         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1427
  1428* DLO003
  1429 01  WS-DLO-VALID-BANK-ID.
  1430     12  DVBI-BANK-ID              PIC X(5).
  1431     12  DVBI-BANK-ID-TYPE         PIC X.
  1432         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1433         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1434         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1435         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1436         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1437     12  DVBI-RETURN-CODE          PIC XX.
  1438         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1439         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1440         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1441         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1442         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1443         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1444         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1445         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1446         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1447
  1448* DLO007
  1449 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1450     12  DCUA-RES-STATE            PIC XX.
  1451     12  DCUA-BEN-TYPE             PIC XX.
  1452     12  DCUA-SYS-IDENT            PIC X.
  1453         88  DCUA-CLAIM                        VALUE 'C'.
  1454         88  DCUA-PREMIUM                      VALUE 'P'.
  1455     12  DCUA-COVERAGE-RULE        PIC X.
  1456     12  DCUA-CLIENT-ID            PIC X(10).
  1457     12  DCUA-EFF-DATE             PIC X(8).
  1458     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1459     12  DCUA-RETURN-CODE          PIC XX.
  1460         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1461     12  DCUA-CERT-NUMBER          PIC X(11).
  1462     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1463     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1464
  1465* DLO011
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  28
* EL050.cbl
  1466 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1467     12  DPRB-RATE-CODE            PIC X(4).
  1468     12  DPRB-COVERAGE-CATEG       PIC X.
  1469     12  DPRB-RETURN-CODE          PIC XX.
  1470         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1471         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1472         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1473         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1474         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1475         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1476         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1477         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1478         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1479     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1480     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1481     12  DPRB-BEN-TYPE             PIC XX.
  1482
  1483* DLO017
  1484 01  WS-DLO-VALID-RATE-CODE.
  1485     12  DVRC-RATE-CODE            PIC X(4).
  1486     12  DVRC-RETURN-CODE          PIC XX.
  1487         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1488         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1489         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1490         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1491         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1492         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1493
  1494* DLO019
  1495 01  WS-DLO-ORIG-COV-CAT.
  1496     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1497     12  DOCC-RETURN-CODE          PIC XX.
  1498     12  DOCC-ORIG-COV-CAT         PIC X.
  1499     12  DOCC-UNDERWITER           PIC XX.
  1500     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1501     12  DOCC-FILLER               PIC X(6).
  1502
  1503* DLO021
  1504 01  WS-DLO-VALID-LOAN-OFFICER.
  1505     12  DVLO-LOAN-OFFICER.
  1506         16  DVLO-BILL-TYPE        PIC X.
  1507         16  DVLO-BILL-SOURCE      PIC X.
  1508         16  DVLO-BATCH-TYPE       PIC X.
  1509     12  DVLO-RETURN-CODE          PIC XX.
  1510         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1511         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1512         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1513         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1514         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1515         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1516
  1517* DLO022
  1518 01  WS-DLO-VALID-STATE-CODE.
  1519     12  DVSC-STATE-CODE           PIC XX.
  1520     12  DVSC-RETURN-CODE          PIC XX.
  1521         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1522
  1523* DLO023
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  29
* EL050.cbl
  1524 01  WS-DLO-VALID-CODE-VALUES.
  1525     12  DVCV-SYSTEM-ID            PIC XX.
  1526         88  DVCV-CLAIMS                       VALUE 'CL'.
  1527         88  DVCV-CREDIT                       VALUE 'CR'.
  1528     12  DVCV-RECORD-TYPE          PIC XX.
  1529         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1530         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1531         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1532         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1533         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1534         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1535         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1536         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1537     12  DVCV-RECORD-KEY           PIC X(6).
  1538     12  DVCV-RETURN-CODE          PIC XX.
  1539         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1540         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1541         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1542         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1543         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1544         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1545         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1546     12  DVCV-CODE-DESC            PIC X(60).
  1547     12  DVCV-GEN-DESC-1           PIC X(20).
  1548     12  DVCV-GEN-DESC-2           PIC X(20).
  1549     12  DVCV-GEN-DESC-3           PIC X(20).
  1550
  1551 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1552 01  hldi-pass-area.
  1553     03  PA-VIN                  PIC X(17).
  1554     03  PA-ErrorCode            PIC X(10).
  1555     03  PA-ErrorDesc            PIC X(30).
  1556     03  PA-ModelYear            PIC 9(7).
  1557     03  PA-MakeName             PIC X(50).
  1558     03  PA-ModelName            PIC X(50).
  1559     03  PA-SeriesName           PIC X(50).
  1560 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1561 01  zipcd-pass-area.
  1562     03  PA-zip                  PIC X(5).
  1563     03  PA-ErrorCode-zip        PIC X(10).
  1564     03  PA-city                 PIC x(50).
  1565     03  PA-state                PIC Xx.
  1566 01  clmhs-pass-area-len         pic s9(4) comp value +40.
  1567 01  clmhs-pass-area.
  1568     03  pa-clmhs-state          pic xx.
  1569     03  pa-account              pic x(10).
  1570     03  pa-eff-dt               pic x(10).
  1571     03  pa-cert-no              pic x(11).
  1572     03  pa-clm-count            pic 9(5).
  1573****  this is for aggregate report.
  1574****  Length is erpndb + 100 of passed-key-area
  1575 01  ws-passed-key-length        pic s9(4) comp value +587.
  1576 01  ws-pass-to-pemaggo.
  1577     05  ws-passed-erpndb        pic x(585).
  1578     05  ws-exceed-limit-yn      pic x.
  1579     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  30
* EL050.cbl
  1581*    COPY ERCBXRF.
  1582******************************************************************
  1583*                                                                *
  1584*                                                                *
  1585*                            ERCBXRF                             *
  1586*                                                                *
  1587*   ONLINE CREDIT SYSTEM                                         *
  1588*                                                                *
  1589*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1590*                                                                *
  1591*   FILE TYPE = VSAM,KSDS                                        *
  1592*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1593*                                                                *
  1594*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1595*       ALTERNATE PATH = NONE                                    *
  1596*                                                                *
  1597*   LOG = NO                                                     *
  1598*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1599*                                                                *
  1600******************************************************************
  1601
  1602 01  BANK-CROSS-REFERENCE.
  1603     12  BK-RECORD-ID                PIC XX.
  1604         88  VALID-BK-ID             VALUE 'BK'.
  1605
  1606     12  BK-CONTROL-PRIMARY.
  1607         16  BK-COMPANY-CD           PIC X.
  1608         16  BK-CARRIER              PIC X.
  1609         16  BK-GROUPING             PIC X(6).
  1610         16  BK-BANK-NO              PIC X(10).
  1611
  1612     12  BK-MAINT-INFORMATION.
  1613         16  BK-LAST-MAINT-DT        PIC XX.
  1614         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1615         16  BK-LAST-MAINT-USER      PIC X(4).
  1616         16  FILLER                  PIC X(9).
  1617
  1618     12  FILLER                      PIC X(37).
  1619
  1620     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1621
  1622     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1623                            DEPENDING ON BK-BANK-POINTER-CNT.
  1624         16  BK-AM-ACCOUNT           PIC X(10).
  1625         16  BK-AM-EXP-DT            PIC XX.
  1626         16  BK-AM-EFF-DT            PIC XX.
  1627         16  BK-AM-STATE             PIC XX.
  1628         16  FILLER                  PIC X(20).
  1629
  1630******************************************************************
  1631
  1632*    COPY ERCCOMP.
  1633******************************************************************
  1634*                                                                *
  1635*                                                                *
  1636*                            ERCCOMP                             *
  1637*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1638*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  31
* EL050.cbl
  1639*                                                                *
  1640*   ONLINE CREDIT SYSTEM                                         *
  1641*                                                                *
  1642*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1643*                                                                *
  1644*   FILE TYPE = VSAM,KSDS                                        *
  1645*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1646*                                                                *
  1647*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1648*       ALTERNATE PATH = NONE                                    *
  1649*                                                                *
  1650*   LOG = NO                                                     *
  1651*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1652*                                                                *
  1653******************************************************************
  1654*                   C H A N G E   L O G
  1655*
  1656* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1657*-----------------------------------------------------------------
  1658*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1659* EFFECTIVE    NUMBER
  1660*-----------------------------------------------------------------
  1661* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1662* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1663* 092205    2005050300006  PEMA  ADD LEASE FEE
  1664* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1665* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1666* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1667* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1668* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1669* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1670******************************************************************
  1671
  1672 01  COMPENSATION-MASTER.
  1673     12  CO-RECORD-ID                          PIC XX.
  1674         88  VALID-CO-ID                          VALUE 'CO'.
  1675
  1676     12  CO-CONTROL-PRIMARY.
  1677         16  CO-COMPANY-CD                     PIC X.
  1678         16  CO-CONTROL.
  1679             20  CO-CTL-1.
  1680                 24  CO-CARR-GROUP.
  1681                     28  CO-CARRIER            PIC X.
  1682                     28  CO-GROUPING.
  1683                         32  CO-GROUP-PREFIX   PIC XXX.
  1684                         32  CO-GROUP-PRIME    PIC XXX.
  1685                 24  CO-RESP-NO.
  1686                     28  CO-RESP-PREFIX        PIC X(4).
  1687                     28  CO-RESP-PRIME         PIC X(6).
  1688             20  CO-CTL-2.
  1689                 24  CO-ACCOUNT.
  1690                     28  CO-ACCT-PREFIX        PIC X(4).
  1691                     28  CO-ACCT-PRIME         PIC X(6).
  1692         16  CO-TYPE                           PIC X.
  1693             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1694             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1695             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1696
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  32
* EL050.cbl
  1697     12  CO-MAINT-INFORMATION.
  1698         16  CO-LAST-MAINT-DT                  PIC XX.
  1699         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1700         16  CO-LAST-MAINT-USER                PIC X(4).
  1701     12  FILLER                                PIC XX.
  1702     12  CO-STMT-TYPE                          PIC XXX.
  1703     12  CO-COMP-TYPE                          PIC X.
  1704         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1705     12  CO-STMT-OWNER                         PIC X(4).
  1706     12  CO-BALANCE-CONTROL                    PIC X.
  1707         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1708         88  CO-NO-BALANCE                        VALUE 'N'.
  1709
  1710     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1711         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1712         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1713         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1714
  1715     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1716         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1717         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1718
  1719     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1720     12  CO-GA-DIRECT-DEP                      PIC X.
  1721     12  CO-FUTURE-SPACE                       PIC X.
  1722         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1723
  1724     12  CO-ACCT-NAME                          PIC X(30).
  1725     12  CO-MAIL-NAME                          PIC X(30).
  1726     12  CO-ADDR-1                             PIC X(30).
  1727     12  CO-ADDR-2                             PIC X(30).
  1728     12  CO-ADDR-3.
  1729         16  CO-ADDR-CITY                      PIC X(27).
  1730         16  CO-ADDR-STATE                     PIC XX.
  1731     12  CO-CSO-1099                           PIC X.
  1732     12  CO-ZIP.
  1733         16  CO-ZIP-PRIME.
  1734             20  CO-ZIP-PRI-1ST                PIC X.
  1735                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1736             20  FILLER                        PIC X(4).
  1737         16  CO-ZIP-PLUS4                      PIC X(4).
  1738     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1739         16  CO-CAN-POSTAL-1                   PIC XXX.
  1740         16  CO-CAN-POSTAL-2                   PIC XXX.
  1741         16  FILLER                            PIC XXX.
  1742     12  CO-SOC-SEC                            PIC X(13).
  1743     12  CO-TELEPHONE.
  1744         16  CO-AREA-CODE                      PIC XXX.
  1745         16  CO-PREFIX                         PIC XXX.
  1746         16  CO-PHONE                          PIC X(4).
  1747
  1748     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1749
  1750     12  CO-AR-BAL-LEVEL                       PIC X.
  1751         88  CO-AR-REF-LVL                        VALUE '1'.
  1752         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1753         88  CO-AR-BILL-LVL                       VALUE '2'.
  1754         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  33
* EL050.cbl
  1755         88  CO-AR-FR-LVL                         VALUE '4'.
  1756
  1757     12  CO-AR-NORMAL-PRINT                    PIC X.
  1758         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1759         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1760
  1761     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1762
  1763     12  CO-AR-REPORTING                       PIC X.
  1764         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1765         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1766
  1767     12  CO-AR-PULL-CHECK                      PIC X.
  1768         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1769         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1770
  1771     12  CO-AR-BALANCE-PRINT                   PIC X.
  1772         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1773
  1774     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1775         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1776         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1777         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1778
  1779     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1780
  1781     12  CO-USER-CODE                          PIC X.
  1782     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1783
  1784******************************************************************
  1785*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1786*    THE LAST MONTH END RUN.
  1787******************************************************************
  1788
  1789     12  CO-LAST-ACTIVITY-DATE.
  1790         16  CO-ACT-YEAR                       PIC 99.
  1791         16  CO-ACT-MONTH                      PIC 99.
  1792         16  CO-ACT-DAY                        PIC 99.
  1793
  1794     12  CO-LAST-STMT-DT.
  1795         16  CO-LAST-STMT-YEAR                 PIC 99.
  1796         16  CO-LAST-STMT-MONTH                PIC 99.
  1797         16  CO-LAST-STMT-DAY                  PIC 99.
  1798
  1799     12  CO-MO-END-TOTALS.
  1800         16  CO-MONTHLY-TOTALS.
  1801             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1802             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1803             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1804             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1805             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1806
  1807         16  CO-AGING-TOTALS.
  1808             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1809             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1810             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1811             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1812
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  34
* EL050.cbl
  1813         16  CO-YTD-TOTALS.
  1814             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1815             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1816
  1817         16  CO-OVER-UNDER-TOTALS.
  1818             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1819             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1820
  1821     12  CO-MISCELLANEOUS-TOTALS.
  1822         16  CO-FICA-TOTALS.
  1823             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1824             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1825
  1826         16  CO-CLAIM-TOTALS.
  1827             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1828             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1829
  1830******************************************************************
  1831*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1832*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1833******************************************************************
  1834
  1835     12  CO-CURRENT-TOTALS.
  1836         16  CO-CURRENT-LAST-STMT-DT.
  1837             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1838             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1839             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1840
  1841         16  CO-CURRENT-MONTHLY-TOTALS.
  1842             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1843             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1844             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1845             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1846             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1847
  1848         16  CO-CURRENT-AGING-TOTALS.
  1849             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1850             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1851             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1852             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1853
  1854         16  CO-CURRENT-YTD-TOTALS.
  1855             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1856             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1857
  1858     12  CO-PAID-COMM-TOTALS.
  1859         16  CO-YTD-PAID-COMMS.
  1860             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1861             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1862
  1863     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1864         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1865         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1866
  1867     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1868         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1869         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1870         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  35
* EL050.cbl
  1871         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1872         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1873         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1874         88  CO-FINAL-LETTER                  VALUE 'F'.
  1875         88  CO-RECONCILING                   VALUE 'R'.
  1876         88  CO-PHONE-CALL                    VALUE 'P'.
  1877         88  CO-LEGAL                         VALUE 'L'.
  1878         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1879         88  CO-WRITE-OFF                     VALUE 'W'.
  1880         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1881
  1882     12  CO-CSR-CODE                       PIC X(4).
  1883
  1884     12  CO-GA-STATUS-INFO.
  1885         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1886         16  CO-GA-TERMINATION-DT          PIC XX.
  1887         16  CO-GA-STATUS-CODE             PIC X.
  1888             88  CO-GA-ACTIVE                 VALUE 'A'.
  1889             88  CO-GA-INACTIVE               VALUE 'I'.
  1890             88  CO-GA-PENDING                VALUE 'P'.
  1891         16  CO-GA-COMMENTS.
  1892             20  CO-GA-COMMENT-1           PIC X(40).
  1893             20  CO-GA-COMMENT-2           PIC X(40).
  1894             20  CO-GA-COMMENT-3           PIC X(40).
  1895             20  CO-GA-COMMENT-4           PIC X(40).
  1896
  1897     12  CO-RPTCD2                         PIC X(10).
  1898     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1899         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1900         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1901
  1902     12  CO-TYPE-AGENT                     PIC X(01).
  1903         88  CO-CORPORATION                   VALUE 'C'.
  1904         88  CO-PARTNERSHIP                   VALUE 'P'.
  1905         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1906         88  CO-TRUST                         VALUE 'T'.
  1907         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1908
  1909     12  CO-FAXNO.
  1910         16  CO-FAX-AREA-CODE                  PIC XXX.
  1911         16  CO-FAX-PREFIX                     PIC XXX.
  1912         16  CO-FAX-PHONE                      PIC X(4).
  1913
  1914     12  CO-BANK-INFORMATION.
  1915         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1916         16  CO-BANK-TRANSIT-NON REDEFINES
  1917             CO-BANK-TRANSIT-NO                PIC 9(8).
  1918
  1919         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1920     12  CO-MISC-DEDUCT-INFO REDEFINES
  1921                  CO-BANK-INFORMATION.
  1922         16  CO-MD-GL-ACCT                     PIC X(10).
  1923         16  CO-MD-DIV                         PIC XX.
  1924         16  CO-MD-CENTER                      PIC X(4).
  1925         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1926         16  CO-CREATE-AP-CHECK                PIC X.
  1927         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1928         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  36
* EL050.cbl
  1929     12  CO-ACH-STATUS                         PIC X.
  1930         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1931         88  CO-ACH-PENDING                        VALUE 'P'.
  1932
  1933     12  CO-BILL-SW                            PIC X.
  1934     12  CO-CONTROL-NAME                       PIC X(30).
  1935     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1936     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1937     12  CO-CLP-STATE                          PIC XX.
  1938     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1939     12  CO-SPP-REFUND-EDIT                    PIC X.
  1940
  1941******************************************************************
  1942
  1943*    COPY ERCAGTC.
  1944******************************************************************
  1945*                                                                *
  1946*                                                                *
  1947*                            ERCAGTC                             *
  1948*                            VMOD=2.001                          *
  1949*                                                                *
  1950*   ONLINE CREDIT SYSTEM                                         *
  1951*                                                                *
  1952*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1953*                                                                *
  1954*   FILE TYPE = VSAM,KSDS                                        *
  1955*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1956*                                                                *
  1957*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1958*       ALTERNATE PATH = NONE                                    *
  1959*                                                                *
  1960*   LOG = NO                                                     *
  1961*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1962*                                                                *
  1963******************************************************************
  1964*                   C H A N G E   L O G
  1965*
  1966* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1967*-----------------------------------------------------------------
  1968*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1969* EFFECTIVE    NUMBER
  1970*-----------------------------------------------------------------
  1971* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1972* 111004                         NEW FILE AND COPYBOOK
  1973* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1974******************************************************************
  1975 01  AGENT-COMMISSIONS.
  1976     12  AG-RECORD-ID                          PIC XX.
  1977         88  VALID-CO-ID                          VALUE 'AG'.
  1978     12  AG-CONTROL-PRIMARY.
  1979         16  AG-COMPANY-CD                     PIC X.
  1980         16  AG-CONTROL.
  1981             20  AG-CTL-1.
  1982                 24  AG-CARR-GROUP.
  1983                     28  AG-CARRIER            PIC X.
  1984                     28  AG-GROUPING           PIC X(6).
  1985                 24  AG-BANK                   PIC X(10).
  1986             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  37
* EL050.cbl
  1987                 24  AG-EXP-DT                 PIC XX.
  1988         16  AG-TYPE                           PIC X.
  1989             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1990             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1991     12  AG-MAINT-INFORMATION.
  1992         16  AG-LAST-MAINT-DT                  PIC XX.
  1993         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1994         16  AG-LAST-MAINT-USER                PIC X(4).
  1995         16  FILLER                            PIC X(10).
  1996     12  AG-EFF-DT                             PIC XX.
  1997     12  AG-COMM-STRUCTURE.
  1998         16  AG-AGT-COMMS OCCURS 10.
  1999             20  AG-AGT                PIC X(10).
  2000             20  AG-COM-TYP            PIC X.
  2001             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2002             20  AG-RECALC-LV-INDIC    PIC X.
  2003             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2004             20  AG-LRCALC-LV-INDIC    PIC X.
  2005             20  FILLER                PIC X(05).
  2006     12  FILLER                  PIC X(145).
  2007******************************************************************
  2008*    COPY ERCRESS.
  2009******************************************************************
  2010*                                                                *
  2011*                            ERCRESS                             *
  2012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2013*                            VMOD=2.002                          *
  2014*                                                                *
  2015*   CREDIT RESIDENT STATE TAXES MASTER                          *
  2016*                                                                *
  2017*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  2018*   VSAM RESIDENT STATE TAX MASTER                              *
  2019*                                                                *
  2020*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  2021*                                                                *
  2022*   FILE TYPE = VSAM,KSDS                                        *
  2023*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  2024*                                                                *
  2025*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  2026*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  2027*                                                                *
  2028*   LOG = NO                                                     *
  2029*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2030*                                                                *
  2031*                                                                *
  2032******************************************************************
  2033
  2034 01  RESIDENT-STATE-TAX-MASTER.
  2035
  2036     10  ERRESS-PRIMARY-KEY.
  2037         15  RES-COMPANY-CD        PIC X.
  2038         15  RES-RESIDENT-STATE    PIC XX.
  2039         15  RES-COVERAGE-CATEGORY PIC X.
  2040         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2041*                                      YYYYMMDD
  2042*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2043
  2044     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  38
* EL050.cbl
  2045
  2046         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2047         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2048         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2049         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2050
  2051     10 RES-RECALC-SW              PIC   X.
  2052         88 RECALC                VALUE 'Y'.
  2053         88 NO-RECALC             VALUE 'N'.
  2054     10  RES-MAINT-BY              PIC X(4).
  2055     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2056     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2057*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  39
* EL050.cbl
  2059*    COPY ERCRESC.
  2060******************************************************************
  2061*                                                                *
  2062*                            ERCRESC                             *
  2063*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2064*                            VMOD=2.003                          *
  2065*                                                                *
  2066*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2067*                                                                *
  2068*   FILE TYPE = VSAM,KSDS                                        *
  2069*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2070*                                                                *
  2071*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2072*       ALTERNATE PATH1 = NONE                                   *
  2073*                                                                *
  2074*   LOG = NO                                                     *
  2075*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2076*                                                                *
  2077******************************************************************
  2078
  2079 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2080
  2081     10  ERRESC-RECORD-KEY.
  2082         15  RESC-COMPANY-CD           PIC   X.
  2083         15  RESC-CARRIER              PIC   X.
  2084         15  RESC-GROUP                PIC   X(6).
  2085         15  RESC-STATE                PIC   XX.
  2086         15  RESC-ACCOUNT              PIC   X(10).
  2087         15  RESC-AGENT                PIC   X(10).
  2088         15  RESC-RESIDENT-STATE       PIC   XX.
  2089         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2090*                                           YYYYMMDD
  2091     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2092
  2093     10  RESC-COMM-RECORD-DATA.
  2094         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2095             20 RESC-COVERAGE-CAT      PIC    X.
  2096             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2097             20 RESC-COMMISSION-TAB REDEFINES
  2098                RESC-COMMISSION-PER    PIC  XXX.
  2099
  2100     10  RESC-MAINT-BY                 PIC X(4).
  2101     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2102     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2103*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  40
* EL050.cbl
  2105*    COPY ERCPLAN.
  2106******************************************************************
  2107*                                                                *
  2108*                                                                *
  2109*                            ERCPLAN                             *
  2110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2111*                            VMOD=2.003                          *
  2112*                                                                *
  2113*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2114*                                                                *
  2115*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2116*   PLAN MASTER                                                  *
  2117*                                                                *
  2118*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2119*                                                                *
  2120*   FILE TYPE = VSAM,KSDS                                        *
  2121*   RECORD SIZE = 420   RECFORM = FIX                            *
  2122*                                                                *
  2123*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2124*       ALTERNATE PATH1 = N/A                                    *
  2125*                                                                *
  2126*   LOG = NO                                                     *
  2127*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2128*                                                                *
  2129*                                                                *
  2130******************************************************************
  2131
  2132 01  PLAN-MASTER.
  2133     12  PL-RECORD-ID                      PIC XX.
  2134         88  VALID-PL-ID                      VALUE 'PL'.
  2135
  2136     12  PL-CONTROL-PRIMARY.
  2137         16  PL-COMPANY-CD                 PIC X.
  2138         16  PL-MSTR-CNTRL.
  2139             20  PL-CONTROL-A.
  2140                 24  PL-CARRIER            PIC X.
  2141                 24  PL-GROUPING           PIC X(6).
  2142                 24  PL-STATE              PIC XX.
  2143                 24  PL-ACCOUNT            PIC X(10).
  2144             20  PL-BENEFIT-TYPE           PIC X.
  2145             20  PL-BENEFIT-CODE           PIC XX.
  2146             20  PL-REVISION-NO            PIC X(3).
  2147
  2148     12  PL-CONTROL-BY-VAR-GRP.
  2149         16  PL-COMPANY-CD-A1              PIC X.
  2150         16  PL-VG-CARRIER                 PIC X.
  2151         16  PL-VG-GROUPING                PIC X(6).
  2152         16  PL-VG-STATE                   PIC XX.
  2153         16  PL-VG-ACCOUNT                 PIC X(10).
  2154         16  PL-BENEFIT-TYPE-A1            PIC X.
  2155         16  PL-BENEFIT-CODE-A1            PIC XX.
  2156         16  PL-REVISION-NO-A1             PIC 999.
  2157
  2158     12  PL-MAINT-INFORMATION.
  2159         16  PL-LAST-MAINT-DT              PIC XX.
  2160         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2161         16  PL-LAST-MAINT-USER            PIC X(4).
  2162         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  41
* EL050.cbl
  2163
  2164     12  PL-LIABILITY-LIMITS.
  2165         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2166         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2167             20  PL-LM-AGE                 PIC S99        COMP-3.
  2168             20  PL-LM-DUR                 PIC S999       COMP-3.
  2169             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2170             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2171
  2172     12  FILLER                            PIC X(30).
  2173
  2174     12  PL-GL-ACCOUNT-NOS.
  2175         16  PL-PREMIUM-GL                 PIC X(8).
  2176         16  PL-COMM-GL                    PIC X(8).
  2177         16  PL-CLAIM-GL                   PIC X(8).
  2178     12  FILLER                            PIC X(24).
  2179     12  PL-TOLERANCES.
  2180         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2181         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2182         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2183         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2184         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2185         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2186     12  PL-OVER-SHORT.
  2187         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2188         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2189     12  FILLER                            PIC X(24).
  2190     12  PLAN-MISC.
  2191         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2192         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2193         16  PL-IG                         PIC X.
  2194         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2195         16  PL-POLICY-FORM                PIC X(12).
  2196         16  PL-EDIT-FOR-FORM              PIC X(01).
  2197         16  PL-DEV-CODE                   PIC XXX.
  2198         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2199         16  PL-CALC-METHOD                PIC X.
  2200         16  PL-BENEFIT-GROUP              PIC X(05).
  2201         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2202
  2203         16  FILLER                        PIC X(99).
  2204******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  42
* EL050.cbl
  2206*    COPY ELCCERT.
  2207******************************************************************
  2208*                                                                *
  2209*                            ELCCERT.                            *
  2210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2211*                            VMOD=2.013                          *
  2212*                                                                *
  2213*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2214*                                                                *
  2215*   FILE TYPE = VSAM,KSDS                                        *
  2216*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2217*                                                                *
  2218*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2219*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2220*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2221*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2222*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2223*                                                                *
  2224*   LOG = YES                                                    *
  2225*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2226******************************************************************
  2227*                   C H A N G E   L O G
  2228*
  2229* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2230*-----------------------------------------------------------------
  2231*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2232* EFFECTIVE    NUMBER
  2233*-----------------------------------------------------------------
  2234* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2235* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2236* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2237* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2238* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2239* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2240* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2241* 032612  CR2011110200001  PEMA  AHL CHANGES
  2242* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2243* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2244* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2245******************************************************************
  2246
  2247 01  CERTIFICATE-MASTER.
  2248     12  CM-RECORD-ID                      PIC XX.
  2249         88  VALID-CM-ID                      VALUE 'CM'.
  2250
  2251     12  CM-CONTROL-PRIMARY.
  2252         16  CM-COMPANY-CD                 PIC X.
  2253         16  CM-CARRIER                    PIC X.
  2254         16  CM-GROUPING.
  2255             20  CM-GROUPING-PREFIX        PIC X(3).
  2256             20  CM-GROUPING-PRIME         PIC X(3).
  2257         16  CM-STATE                      PIC XX.
  2258         16  CM-ACCOUNT.
  2259             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2260             20  CM-ACCOUNT-PRIME          PIC X(6).
  2261         16  CM-CERT-EFF-DT                PIC XX.
  2262         16  CM-CERT-NO.
  2263             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  43
* EL050.cbl
  2264             20  CM-CERT-SFX               PIC X.
  2265
  2266     12  CM-CONTROL-BY-NAME.
  2267         16  CM-COMPANY-CD-A1              PIC X.
  2268         16  CM-INSURED-LAST-NAME          PIC X(15).
  2269         16  CM-INSURED-INITIALS.
  2270             20  CM-INSURED-INITIAL1       PIC X.
  2271             20  CM-INSURED-INITIAL2       PIC X.
  2272
  2273     12  CM-CONTROL-BY-SSN.
  2274         16  CM-COMPANY-CD-A2              PIC X.
  2275         16  CM-SOC-SEC-NO.
  2276             20  CM-SSN-STATE              PIC XX.
  2277             20  CM-SSN-ACCOUNT            PIC X(6).
  2278             20  CM-SSN-LN3.
  2279                 25  CM-INSURED-INITIALS-A2.
  2280                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2281                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2282                 25 CM-PART-LAST-NAME-A2         PIC X.
  2283
  2284     12  CM-CONTROL-BY-CERT-NO.
  2285         16  CM-COMPANY-CD-A4              PIC X.
  2286         16  CM-CERT-NO-A4                 PIC X(11).
  2287
  2288     12  CM-CONTROL-BY-MEMB.
  2289         16  CM-COMPANY-CD-A5              PIC X.
  2290         16  CM-MEMBER-NO.
  2291             20  CM-MEMB-STATE             PIC XX.
  2292             20  CM-MEMB-ACCOUNT           PIC X(6).
  2293             20  CM-MEMB-LN4.
  2294                 25  CM-INSURED-INITIALS-A5.
  2295                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2296                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2297                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2298
  2299     12  CM-INSURED-PROFILE-DATA.
  2300         16  CM-INSURED-FIRST-NAME.
  2301             20  CM-INSURED-1ST-INIT       PIC X.
  2302             20  FILLER                    PIC X(9).
  2303         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2304         16  CM-INSURED-SEX                PIC X.
  2305             88  CM-SEX-MALE                  VALUE 'M'.
  2306             88  CM-SEX-FEMAL                 VALUE 'F'.
  2307         16  CM-INSURED-JOINT-AGE          PIC 99.
  2308         16  CM-JOINT-INSURED-NAME.
  2309             20  CM-JT-LAST-NAME           PIC X(15).
  2310             20  CM-JT-FIRST-NAME.
  2311                 24  CM-JT-1ST-INIT        PIC X.
  2312                 24  FILLER                PIC X(9).
  2313             20  CM-JT-INITIAL             PIC X.
  2314
  2315     12  CM-LIFE-DATA.
  2316         16  CM-LF-BENEFIT-CD              PIC XX.
  2317         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2318         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2319         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2320         16  CM-LF-DEV-CODE                PIC XXX.
  2321         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  44
* EL050.cbl
  2322         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2323         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2324         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2325         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2326         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2327         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2328         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2329         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2330         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2331         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2332         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2333         16  cm-temp-epiq                  pic xx.
  2334             88  EPIQ-CLASS                  value 'EQ'.
  2335*        16  FILLER                        PIC XX.
  2336
  2337     12  CM-AH-DATA.
  2338         16  CM-AH-BENEFIT-CD              PIC XX.
  2339         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2340         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2341         16  CM-AH-DEV-CODE                PIC XXX.
  2342         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2343         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2344         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2345         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2346         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2347         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2348         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2349         16  CM-AH-PAID-THRU-DT            PIC XX.
  2350             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2351         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2352         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2353         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2354         16  FILLER                        PIC X.
  2355
  2356     12  CM-LOAN-INFORMATION.
  2357         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2358         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2359                                           PIC S9(5)V99  COMP-3.
  2360         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2361         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2362         16  CM-PAY-FREQUENCY              PIC S99.
  2363         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2364         16  CM-RATE-CLASS                 PIC XX.
  2365         16  CM-BENEFICIARY                PIC X(25).
  2366         16  CM-POLICY-FORM-NO             PIC X(12).
  2367         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2368         16  CM-LAST-ADD-ON-DT             PIC XX.
  2369         16  CM-DEDUCTIBLE-AMOUNTS.
  2370             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2371             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2372         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2373             20  CM-RESIDENT-STATE         PIC XX.
  2374             20  CM-RATE-CODE              PIC X(4).
  2375             20  FILLER                    PIC XX.
  2376         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2377             20  CM-LOAN-OFFICER           PIC X(5).
  2378             20  FILLER                    PIC XXX.
  2379         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  45
* EL050.cbl
  2380         16  CM-UNDERWRITING-CODE          PIC X.
  2381             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2382         16  CM-POST-CARD-IND              PIC X.
  2383         16  CM-REF-INTERFACE-SW           PIC X.
  2384         16  CM-PREMIUM-TYPE               PIC X.
  2385             88  CM-SING-PRM                  VALUE '1'.
  2386             88  CM-O-B-COVERAGE              VALUE '2'.
  2387             88  CM-OPEN-END                  VALUE '3'.
  2388         16  CM-IND-GRP-TYPE               PIC X.
  2389             88  CM-INDIVIDUAL                VALUE 'I'.
  2390             88  CM-GROUP                     VALUE 'G'.
  2391         16  CM-SKIP-CODE                  PIC X.
  2392             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2393             88  SKIP-JULY                    VALUE '1'.
  2394             88  SKIP-AUGUST                  VALUE '2'.
  2395             88  SKIP-SEPTEMBER               VALUE '3'.
  2396             88  SKIP-JULY-AUG                VALUE '4'.
  2397             88  SKIP-AUG-SEPT                VALUE '5'.
  2398             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2399             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2400             88  SKIP-JUNE                    VALUE '8'.
  2401             88  SKIP-JUNE-JULY               VALUE '9'.
  2402             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2403             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2404         16  CM-PAYMENT-MODE               PIC X.
  2405             88  PAY-MONTHLY                  VALUE SPACE.
  2406             88  PAY-WEEKLY                   VALUE '1'.
  2407             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2408             88  PAY-BI-WEEKLY                VALUE '3'.
  2409             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2410         16  CM-LOAN-NUMBER                PIC X(8).
  2411         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2412         16  CM-OLD-LOF                    PIC XXX.
  2413*        16  CM-LOAN-OFFICER               PIC XXX.
  2414         16  CM-REIN-TABLE                 PIC XXX.
  2415         16  CM-SPECIAL-REIN-CODE          PIC X.
  2416         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2417         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2418         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2419
  2420     12  CM-STATUS-DATA.
  2421         16  CM-ENTRY-STATUS               PIC X.
  2422         16  CM-ENTRY-DT                   PIC XX.
  2423
  2424         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2425         16  CM-LF-CANCEL-DT               PIC XX.
  2426         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2427
  2428         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2429         16  CM-LF-DEATH-DT                PIC XX.
  2430         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2431
  2432         16  CM-LF-CURRENT-STATUS          PIC X.
  2433             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2434                                                'M' '4' '5' '9'.
  2435             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2436             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2437             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  46
* EL050.cbl
  2438             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2439             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2440             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2441             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2442             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2443             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2444             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2445             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2446             88  CM-LF-DECLINED               VALUE 'D'.
  2447             88  CM-LF-VOIDED                 VALUE 'V'.
  2448
  2449         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2450         16  CM-AH-CANCEL-DT               PIC XX.
  2451         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2452
  2453         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2454         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2455         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2456
  2457         16  CM-AH-CURRENT-STATUS          PIC X.
  2458             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2459                                                'M' '4' '5' '9'.
  2460             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2461             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2462             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2463             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2464             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2465             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2466             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2467             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2468             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2469             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2470             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2471             88  CM-AH-DECLINED               VALUE 'D'.
  2472             88  CM-AH-VOIDED                 VALUE 'V'.
  2473
  2474         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2475             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2476             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2477             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2478         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2479
  2480         16  CM-ENTRY-BATCH                PIC X(6).
  2481         16  CM-LF-EXIT-BATCH              PIC X(6).
  2482         16  CM-AH-EXIT-BATCH              PIC X(6).
  2483         16  CM-LAST-MONTH-END             PIC XX.
  2484
  2485     12  CM-NOTE-SW                        PIC X.
  2486         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2487         88  CERT-NOTES-PRESENT               VALUE '1'.
  2488         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2489         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2490         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2491         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2492         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2493         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2494     12  CM-COMP-EXCP-SW                   PIC X.
  2495         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  47
* EL050.cbl
  2496         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2497     12  CM-INSURED-ADDRESS-SW             PIC X.
  2498         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2499         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2500
  2501*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2502     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2503     12  FILLER                            PIC X.
  2504
  2505*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2506     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2507     12  FILLER                            PIC X.
  2508*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2509     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2510
  2511     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2512         88  CERT-ADDED-BATCH                 VALUE ' '.
  2513         88  CERT-ADDED-ONLINE                VALUE '1'.
  2514         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2515         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2516         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2517     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2518         88  CERT-AS-LOADED                   VALUE ' '.
  2519         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2520         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2521         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2522         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2523         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2524         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2525         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2526
  2527     12  CM-ACCOUNT-COMM-PCTS.
  2528         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2529         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2530
  2531     12  CM-USER-FIELD                     PIC X.
  2532     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2533     12  CM-CLP-STATE                      PIC XX.
  2534     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2535     12  CM-USER-RESERVED                  PIC XXX.
  2536     12  FILLER REDEFINES CM-USER-RESERVED.
  2537         16  CM-AH-CLASS-CD                PIC XX.
  2538         16  F                             PIC X.
  2539******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  48
* EL050.cbl
  2541*    COPY ERCMAIL.
  2542******************************************************************
  2543*                                                                *
  2544*                                                                *
  2545*                            ERCMAIL                             *
  2546*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2547*                            VMOD=2.003                          *
  2548*                                                                *
  2549*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2550*                                                                *
  2551*   FILE TYPE = VSAM,KSDS                                        *
  2552*   RECORD SIZE = 374   RECFORM = FIX                            *
  2553*                                                                *
  2554*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2555*   ALTERNATE PATH    = NOT USED                                 *
  2556*                                                                *
  2557*   LOG = YES                                                    *
  2558*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2559******************************************************************
  2560*                   C H A N G E   L O G
  2561*
  2562* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2563*-----------------------------------------------------------------
  2564*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2565* EFFECTIVE    NUMBER
  2566*-----------------------------------------------------------------
  2567* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2568* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2569* 111108                   PEMA  ADD CRED BENE ADDR2
  2570******************************************************************
  2571
  2572 01  MAILING-DATA.
  2573     12  MA-RECORD-ID                      PIC XX.
  2574         88  VALID-MA-ID                       VALUE 'MA'.
  2575
  2576     12  MA-CONTROL-PRIMARY.
  2577         16  MA-COMPANY-CD                 PIC X.
  2578         16  MA-CARRIER                    PIC X.
  2579         16  MA-GROUPING.
  2580             20  MA-GROUPING-PREFIX        PIC XXX.
  2581             20  MA-GROUPING-PRIME         PIC XXX.
  2582         16  MA-STATE                      PIC XX.
  2583         16  MA-ACCOUNT.
  2584             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2585             20  MA-ACCOUNT-PRIME          PIC X(6).
  2586         16  MA-CERT-EFF-DT                PIC XX.
  2587         16  MA-CERT-NO.
  2588             20  MA-CERT-PRIME             PIC X(10).
  2589             20  MA-CERT-SFX               PIC X.
  2590
  2591     12  FILLER                            PIC XX.
  2592
  2593     12  MA-ACCESS-CONTROL.
  2594         16  MA-SOURCE-SYSTEM              PIC XX.
  2595             88  MA-FROM-CREDIT                VALUE 'CR'.
  2596             88  MA-FROM-VSI                   VALUE 'VS'.
  2597             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2598             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  49
* EL050.cbl
  2599         16  MA-RECORD-ADD-DT              PIC XX.
  2600         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2601         16  MA-LAST-MAINT-DT              PIC XX.
  2602         16  MA-LAST-MAINT-BY              PIC XXXX.
  2603         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2604
  2605     12  MA-PROFILE-INFO.
  2606         16  MA-QUALIFY-CODE-1             PIC XX.
  2607         16  MA-QUALIFY-CODE-2             PIC XX.
  2608         16  MA-QUALIFY-CODE-3             PIC XX.
  2609         16  MA-QUALIFY-CODE-4             PIC XX.
  2610         16  MA-QUALIFY-CODE-5             PIC XX.
  2611
  2612         16  MA-INSURED-LAST-NAME          PIC X(15).
  2613         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2614         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2615         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2616         16  MA-INSURED-BIRTH-DT           PIC XX.
  2617         16  MA-INSURED-SEX                PIC X.
  2618             88  MA-SEX-MALE                   VALUE 'M'.
  2619             88  MA-SEX-FEMALE                 VALUE 'F'.
  2620         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2621
  2622         16  MA-ADDRESS-CORRECTED          PIC X.
  2623         16  MA-JOINT-BIRTH-DT             PIC XX.
  2624*        16  FILLER                        PIC X(12).
  2625
  2626         16  MA-ADDRESS-LINE-1             PIC X(30).
  2627         16  MA-ADDRESS-LINE-2             PIC X(30).
  2628         16  MA-CITY-STATE.
  2629             20  MA-CITY                   PIC X(28).
  2630             20  MA-ADDR-STATE             PIC XX.
  2631         16  MA-ZIP.
  2632             20  MA-ZIP-CODE.
  2633                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2634                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2635                 24  FILLER                PIC X(4).
  2636             20  MA-ZIP-PLUS4              PIC X(4).
  2637         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2638             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2639             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2640             20  FILLER                    PIC X(3).
  2641
  2642         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2643
  2644         16  FILLER                        PIC XXX.
  2645*        16  FILLER                        PIC X(10).
  2646
  2647     12  MA-CRED-BENE-INFO.
  2648         16  MA-CRED-BENE-NAME                 PIC X(25).
  2649         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2650         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2651         16  MA-CRED-BENE-CTYST.
  2652             20  MA-CRED-BENE-CITY             PIC X(28).
  2653             20  MA-CRED-BENE-STATE            PIC XX.
  2654         16  MA-CRED-BENE-ZIP.
  2655             20  MA-CB-ZIP-CODE.
  2656                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  50
* EL050.cbl
  2657                     88  MA-CB-CANADIAN-POST-CODE
  2658                                           VALUE 'A' THRU 'Z'.
  2659                 24  FILLER                    PIC X(4).
  2660             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2661         16  MA-CB-CANADIAN-POSTAL-CODE
  2662                            REDEFINES MA-CRED-BENE-ZIP.
  2663             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2664             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2665             20  FILLER                        PIC X(3).
  2666     12  MA-POST-CARD-MAIL-DATA.
  2667         16  MA-MAIL-DATA OCCURS 7.
  2668             20  MA-MAIL-TYPE              PIC X.
  2669                 88  MA-12MO-MAILING           VALUE '1'.
  2670                 88  MA-EXP-MAILING            VALUE '2'.
  2671             20  MA-MAIL-STATUS            PIC X.
  2672                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2673                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2674                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2675             20  MA-MAIL-DATE              PIC XX.
  2676     12  FILLER                            PIC XX.
  2677     12  FILLER                            PIC XX.
  2678*    12  FILLER                            PIC X(30).
  2679******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  51
* EL050.cbl
  2681*    COPY ERCPNDM.
  2682******************************************************************
  2683*                                                                *
  2684*                                                                *
  2685*                            ERCPNDM                             *
  2686*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2687*                            VMOD=2.003                          *
  2688*                                                                *
  2689*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2690*                                                                *
  2691*   FILE TYPE = VSAM,KSDS                                        *
  2692*   RECORD SIZE = 374   RECFORM = FIX                            *
  2693*                                                                *
  2694*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2695*   ALTERNATE PATH    = NOT USED                                 *
  2696*                                                                *
  2697*   LOG = YES                                                    *
  2698*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2699******************************************************************
  2700*                   C H A N G E   L O G
  2701*
  2702* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2703*-----------------------------------------------------------------
  2704*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2705* EFFECTIVE    NUMBER
  2706*-----------------------------------------------------------------
  2707* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2708* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2709* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2710* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2711******************************************************************
  2712
  2713 01  PENDING-MAILING-DATA.
  2714     12  PM-RECORD-ID                      PIC XX.
  2715         88  VALID-MA-ID                       VALUE 'PM'.
  2716
  2717     12  PM-CONTROL-PRIMARY.
  2718         16  PM-COMPANY-CD                 PIC X.
  2719         16  PM-ENTRY-BATCH                PIC X(6).
  2720         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2721         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2722
  2723     12  FILLER                            PIC X(14).
  2724
  2725     12  PM-ACCESS-CONTROL.
  2726         16  PM-SOURCE-SYSTEM              PIC XX.
  2727             88  PM-FROM-CREDIT                VALUE 'CR'.
  2728             88  PM-FROM-VSI                   VALUE 'VS'.
  2729             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2730             88  PM-FROM-OTHER                 VALUE 'OT'.
  2731         16  PM-RECORD-ADD-DT              PIC XX.
  2732         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2733         16  PM-LAST-MAINT-DT              PIC XX.
  2734         16  PM-LAST-MAINT-BY              PIC XXXX.
  2735         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2736
  2737     12  PM-PROFILE-INFO.
  2738         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  52
* EL050.cbl
  2739         16  PM-QUALIFY-CODE-2             PIC XX.
  2740         16  PM-QUALIFY-CODE-3             PIC XX.
  2741         16  PM-QUALIFY-CODE-4             PIC XX.
  2742         16  PM-QUALIFY-CODE-5             PIC XX.
  2743
  2744         16  PM-INSURED-LAST-NAME          PIC X(15).
  2745         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2746         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2747         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2748         16  PM-INSURED-BIRTH-DT           PIC XX.
  2749         16  PM-INSURED-SEX                PIC X.
  2750             88  PM-SEX-MALE                   VALUE 'M'.
  2751             88  PM-SEX-FEMALE                 VALUE 'F'.
  2752         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2753
  2754         16  PM-ADDRESS-CORRECTED          PIC X.
  2755         16  PM-JOINT-BIRTH-DT             PIC XX.
  2756*        16  FILLER                        PIC X(12).
  2757
  2758         16  PM-ADDRESS-LINE-1             PIC X(30).
  2759         16  PM-ADDRESS-LINE-2             PIC X(30).
  2760         16  PM-CITY-STATE.
  2761             20  PM-CITY                   PIC X(28).
  2762             20  PM-STATE                  PIC XX.
  2763         16  PM-ZIP.
  2764             20  PM-ZIP-CODE.
  2765                 24  PM-ZIP-1              PIC X.
  2766                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2767                 24  FILLER                PIC X(4).
  2768             20  PM-ZIP-PLUS4              PIC X(4).
  2769         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2770             20  PM-CAN-POST1              PIC XXX.
  2771             20  PM-CAN-POST2              PIC XXX.
  2772             20  FILLER                    PIC XXX.
  2773
  2774         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2775         16  pm-city-st-zip-verified       pic x.
  2776         16  FILLER                        PIC XX.
  2777
  2778     12  PM-CRED-BENE-INFO.
  2779         16  PM-CRED-BENE-NAME             PIC X(25).
  2780         16  PM-CRED-BENE-ADDR             PIC X(30).
  2781         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2782         16  PM-CRED-BENE-CTYST.
  2783             20  PM-CRED-BENE-CITY         PIC X(28).
  2784             20  PM-CRED-BENE-STATE        PIC XX.
  2785         16  PM-CRED-BENE-ZIP.
  2786             20  PM-CB-ZIP-CODE.
  2787                 24  PM-CB-ZIP-1           PIC X.
  2788                     88  PM-CB-CANADIAN-POST-CODE
  2789                                  VALUE 'A' THRU 'Z'.
  2790                 24  FILLER                PIC X(4).
  2791             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2792         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2793             20  PM-CB-CAN-POST1           PIC XXX.
  2794             20  PM-CB-CAN-POST2           PIC XXX.
  2795             20  FILLER                    PIC XXX.
  2796     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  53
* EL050.cbl
  2797         16  PM-MAIL-DATA OCCURS 7.
  2798             20  PM-MAIL-TYPE              PIC X.
  2799                 88  PM-12MO-MAILING           VALUE '1'.
  2800                 88  PM-EXP-MAILING            VALUE '2'.
  2801             20  PM-MAIL-STATUS            PIC X.
  2802                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2803                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2804                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2805             20  PM-MAIL-DATE              PIC XX.
  2806     12  FILLER                            PIC XX.
  2807     12  FILLER                            PIC X(12).
  2808*    12  FILLER                            PIC X(30).
  2809
  2810******************************************************************
  2811*                                COPY ERCLOFC.
  2812******************************************************************
  2813*                                                                *
  2814*                                                                *
  2815*                            ERCLOFC                             *
  2816*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2817*                            VMOD=2.003                          *
  2818*                                                                *
  2819*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2820*                                                                *
  2821*   FILE TYPE = VSAM,KSDS                                        *
  2822*   RECORD SIZE = 670   RECFORM = FIX                            *
  2823*                                                                *
  2824*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2825*                                                                *
  2826*   LOG = YES                                                    *
  2827*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2828*                                                                *
  2829******************************************************************
  2830
  2831 01  LOAN-OFFICER-MASTER.
  2832     12  LO-RECORD-ID                PIC XX.
  2833         88  VALID-LO-ID                VALUE 'LO'.
  2834
  2835     12  LO-CONTROL-PRIMARY.
  2836         16  LO-COMPANY-CD           PIC X.
  2837         16  LO-CARRIER              PIC X.
  2838         16  LO-GROUPING.
  2839             20  LO-GROUPING-PREFIX  PIC XXX.
  2840             20  LO-GROUPING-PRIME   PIC XXX.
  2841         16  LO-STATE                PIC XX.
  2842         16  LO-ACCOUNT.
  2843             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2844             20  LO-ACCOUNT-PRIME    PIC X(6).
  2845         16  LO-OFFICER-CODE         PIC X(5).
  2846
  2847     12  LO-OFFICER-NAME             PIC X(30).
  2848
  2849     12  LO-LAST-MAINT-DT            PIC XX.
  2850     12  LO-LAST-USER                PIC X(4).
  2851     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2852
  2853     12  LO-COMP-CONTROL             PIC X.
  2854             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  54
* EL050.cbl
  2855             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2856     12  LO-DETAIL-CONTROL           PIC X.
  2857             88  LO-PRINT-DETAIL        VALUE 'D'.
  2858             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2859
  2860     12  LO-SV-CARRIER               PIC X.
  2861     12  LO-SV-GROUPING              PIC X(6).
  2862     12  LO-SV-STATE                 PIC XX.
  2863
  2864     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2865     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2866
  2867     12  LO-OFFICER-INFO.
  2868         16  FILLER OCCURS 12 TIMES.
  2869             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2870             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2871             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2872             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2873             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2874             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2875             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2876             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2877     12  FILLER                      PIC X(198).
  2878******************************************************************
  2879*                                COPY ERCPDEF.
  2880******************************************************************
  2881*                                                                *
  2882*                                                                *
  2883*                            ERCPDEF.                            *
  2884*                                                                *
  2885*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2886*                                                                *
  2887*    FILE TYPE = VSAM,KSDS                                       *
  2888*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2889*                                                                *
  2890*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2891*                                                                *
  2892*    LOG = YES                                                   *
  2893*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2894******************************************************************
  2895*                   C H A N G E   L O G
  2896*
  2897* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2898*-----------------------------------------------------------------
  2899*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2900* EFFECTIVE    NUMBER
  2901*-----------------------------------------------------------------
  2902* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2903* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2904* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2905* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  2906******************************************************************
  2907 01  PRODUCT-MASTER.
  2908    12  PD-RECORD-ID                 PIC X(02).
  2909        88  VALID-PD-ID                  VALUE 'PD'.
  2910    12  PD-CONTROL-PRIMARY.
  2911        16  PD-COMPANY-CD            PIC X.
  2912        16  PD-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  55
* EL050.cbl
  2913        16  PD-PRODUCT-CD            PIC XXX.
  2914        16  PD-FILLER                PIC X(7).
  2915        16  PD-BEN-TYPE              PIC X.
  2916        16  PD-BEN-CODE              PIC XX.
  2917        16  PD-PROD-EXP-DT           PIC XX.
  2918    12  FILLER                       PIC X(50).
  2919    12  PD-PRODUCT-DATA OCCURS 8.
  2920        16  PD-PROD-CODE             PIC X.
  2921            88  PD-PROD-LIFE           VALUE 'L'.
  2922            88  PD-PROD-PROP           VALUE 'P'.
  2923            88  PD-PROD-AH             VALUE 'A'.
  2924            88  PD-PROD-IU             VALUE 'I'.
  2925            88  PD-PROD-GAP            VALUE 'G'.
  2926            88  PD-PROD-FAML           VALUE 'F'.
  2927            88  PD-PROD-OTH            VALUE 'O'.
  2928        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2929        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2930        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2931        16  PD-MAX-TERM              PIC S999        COMP-3.
  2932        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2933        16  FILLER                   PIC X.
  2934        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2935        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2936        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2937        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2938        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2939        16  PD-REC-CRIT-PERIOD       PIC 99.
  2940        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2941            20  PD-RECURRING-YN      PIC X.
  2942            20  FILLER               PIC X.
  2943        16  PD-RTW-MOS               PIC 99.
  2944        16  PD-MAX-EXTENSION         PIC 99.
  2945        16  pd-ben-pct               pic sv999 comp-3.
  2946*       16  FILLER                   PIC XX.
  2947    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2948    12  PD-TERM-LIMITS OCCURS 15.
  2949        16  PD-LOW-TERM              PIC S999        COMP-3.
  2950        16  PD-HI-TERM               PIC S999        COMP-3.
  2951*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2952    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2953        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2954        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2955    12  PD-EARN-FACTORS.
  2956        16  FILLER OCCURS 15.
  2957            20  FILLER OCCURS 15.
  2958                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2959    12  PD-PRODUCT-DESC              PIC X(80).
  2960    12  PD-TRUNCATED                 PIC X.
  2961    12  FILLER                       PIC X(59).
  2962    12  PD-MAINT-INFORMATION.
  2963        16  PD-LAST-MAINT-DT         PIC X(02).
  2964        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2965        16  PD-LAST-MAINT-BY         PIC X(04).
  2966*                                COPY ELCSTATE.
  2967******************************************************************
  2968*                                                                *
  2969*                                                                *
  2970*                            ELCSTATE.                           *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  56
* EL050.cbl
  2971*                                                                *
  2972*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2973*                                                                *
  2974*   FILE TYPE = VSAM,KSDS                                        *
  2975*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2976*                                                                *
  2977*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2978*       ALTERNATE INDEX = NONE                                   *
  2979*                                                                *
  2980*   LOG = YES                                                    *
  2981*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2982******************************************************************
  2983*                   C H A N G E   L O G
  2984*
  2985* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2986*-----------------------------------------------------------------
  2987*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2988* EFFECTIVE    NUMBER
  2989*-----------------------------------------------------------------
  2990* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2991******************************************************************
  2992*
  2993 01  STATE-FILE.
  2994     12  SF-RECORD-ID                       PIC XX.
  2995         88  VALID-CF-ID                        VALUE 'SF'.
  2996     12  SF-CONTROL-PRIMARY.
  2997         16  SF-COMPANY-ID                  PIC XXX.
  2998         16  SF-CARRIER-CODE                PIC X.
  2999         16  SF-GROUPING                    PIC X(6).
  3000         16  SF-STATE-CODE                  PIC XX.
  3001         16  SF-EXPIRE-DATE                 PIC 9(8).
  3002****************************************************************
  3003*             STATE CONTROLS
  3004****************************************************************
  3005     12  SF-LAST-MAINT-DT                   PIC XX.
  3006     12  SF-LAST-MAINT-BY                   PIC X(4).
  3007     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3008     12  SF-STATE-RT-CONTROLS.
  3009         16  SF-ST-RT-CALC                  PIC X.
  3010     12  SF-ST-TAX-CONTROLS.
  3011         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3012         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3013         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3014     12  SF-ST-REFUND-OPTIONS.
  3015         16  SF-ST-RF-LR-CALC               PIC X.
  3016         16  SF-ST-RF-LL-CALC               PIC X.
  3017         16  SF-ST-RF-LN-CALC               PIC X.
  3018         16  SF-ST-RF-AH-CALC               PIC X.
  3019         16  SF-ST-RF-CP-CALC               PIC X.
  3020     12  SF-ST-UNEARN-PREM-OPTIONS.
  3021         16  SF-ST-LUEP-R78                 PIC X.
  3022         16  SF-ST-LUEP-PRO                 PIC X.
  3023         16  SF-ST-LUEP-ST                  PIC X.
  3024         16  SF-ST-LUEP-DOM                 PIC X.
  3025         16  SF-ST-AUEP-R78                 PIC X.
  3026         16  SF-ST-AUEP-PRO                 PIC X.
  3027         16  SF-ST-AUEP-ST                  PIC X.
  3028         16  SF-ST-AUEP-DOM                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  57
* EL050.cbl
  3029         16  SF-ST-CUEP-R78                 PIC X.
  3030         16  SF-ST-CUEP-PRO                 PIC X.
  3031         16  SF-ST-CUEP-ST                  PIC X.
  3032         16  SF-ST-CUEP-DOM                 PIC X.
  3033     12  SF-ST-EARN-PREM-OPTIONS.
  3034         16  SF-ST-LEP-R78                  PIC X.
  3035         16  SF-ST-LEP-PRO                  PIC X.
  3036         16  SF-ST-LEP-ST                   PIC X.
  3037         16  SF-ST-LEP-DOM                  PIC X.
  3038         16  SF-ST-AEP-R78                  PIC X.
  3039         16  SF-ST-AEP-PRO                  PIC X.
  3040         16  SF-ST-AEP-ST                   PIC X.
  3041         16  SF-ST-AEP-DOM                  PIC X.
  3042         16  SF-ST-CEP-R78                  PIC X.
  3043         16  SF-ST-CEP-PRO                  PIC X.
  3044         16  SF-ST-CEP-ST                   PIC X.
  3045         16  SF-ST-CEP-DOM                  PIC X.
  3046     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  58
* EL050.cbl
  3048*    COPY ELCCRTT.
  3049******************************************************************
  3050*                                                                *
  3051*                            ELCCRTT.                            *
  3052*                                                                *
  3053*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3054*                                                                *
  3055*   FILE TYPE = VSAM,KSDS                                        *
  3056*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3057*                                                                *
  3058*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3059*                                                                *
  3060*   LOG = YES                                                    *
  3061*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3062******************************************************************
  3063*                   C H A N G E   L O G
  3064*
  3065* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3066*-----------------------------------------------------------------
  3067*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3068* EFFECTIVE    NUMBER
  3069*-----------------------------------------------------------------
  3070* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3071* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3072* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3073* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3074* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3075* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3076* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3077* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3078* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3079* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3080* 091318  CR2018073000001  PEMA  ADD Refund methods
  3081* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3082******************************************************************
  3083
  3084 01  CERTIFICATE-TRAILERS.
  3085     12  CS-RECORD-ID                      PIC XX.
  3086         88  VALID-CS-ID                      VALUE 'CS'.
  3087
  3088     12  CS-CONTROL-PRIMARY.
  3089         16  CS-COMPANY-CD                 PIC X.
  3090         16  CS-CARRIER                    PIC X.
  3091         16  CS-GROUPING                   PIC X(6).
  3092         16  CS-STATE                      PIC XX.
  3093         16  CS-ACCOUNT                    PIC X(10).
  3094         16  CS-CERT-EFF-DT                PIC XX.
  3095         16  CS-CERT-NO.
  3096             20  CS-CERT-PRIME             PIC X(10).
  3097             20  CS-CERT-SFX               PIC X.
  3098         16  CS-TRAILER-TYPE               PIC X.
  3099             88  COMM-TRLR           VALUE 'A'.
  3100             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3101             88  CERT-DATA-TRLR      VALUE 'C'.
  3102
  3103     12  CS-DATA-AREA                      PIC X(516).
  3104
  3105     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  59
* EL050.cbl
  3106         16  CS-BANK-COMMISSION-AREA.
  3107             20  CS-BANK-COMMS       OCCURS 10.
  3108                 24  CS-AGT                PIC X(10).
  3109                 24  CS-COM-TYP            PIC X.
  3110                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3111                 24  CS-RECALC-LV-INDIC    PIC X.
  3112                 24  FILLER                PIC X(10).
  3113         16  FILLER                        PIC X(256).
  3114
  3115     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3116****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3117         16  CS-MB-CLAIM-DATA OCCURS 24.
  3118             20  CS-CLAIM-NO               PIC X(7).
  3119             20  CS-CLAIM-TYPE             PIC X.
  3120                 88  CS-AH-CLM               VALUE 'A'.
  3121                 88  CS-IU-CLM               VALUE 'I'.
  3122                 88  CS-GP-CLM               VALUE 'G'.
  3123                 88  CS-LF-CLM               VALUE 'L'.
  3124                 88  CS-PR-CLM               VALUE 'P'.
  3125                 88  CS-FL-CLM               VALUE 'F'.
  3126                 88  CS-OT-CLM               VALUE 'O'.
  3127             20  CS-INSURED-TYPE           PIC X.
  3128                 88  CS-PRIM-INSURED          VALUE 'P'.
  3129                 88  CS-CO-BORROWER           VALUE 'C'.
  3130             20  CS-BENEFIT-PERIOD         PIC 99.
  3131             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3132             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3133             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3134         16  FILLER                        PIC X(12).
  3135     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3136         16  CS-VIN-NUMBER                 PIC X(17).
  3137         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3138         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3139         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3140         16  cs-agent-name.
  3141             20  cs-agent-fname            pic x(20).
  3142             20  cs-agent-mi               pic x.
  3143             20  cs-agent-lname            pic x(25).
  3144         16  cs-license-no                 pic x(15).
  3145         16  cs-npn-number                 pic x(10).
  3146         16  cs-agent-edit-status          pic x.
  3147             88  cs-ae-refer-to-manager      value 'M'.
  3148             88  cs-ae-cover-sheet           value 'C'.
  3149             88  cs-ae-sig-form              value 'S'.
  3150             88  cs-ae-verified              value 'V'.
  3151             88  cs-unidentified-signature   value 'U'.
  3152             88  cs-cert-returned            value 'R'.
  3153             88  cs-accept-no-commission     value 'N'.
  3154         16  cs-year                       pic 9999.
  3155         16  cs-make                       pic x(20).
  3156         16  cs-model                      pic x(20).
  3157         16  cs-future                     pic x(20).
  3158         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3159         16  cs-claim-verification-status  pic x.
  3160             88  cs-clm-ver-eligible         value 'A'.
  3161             88  cs-clm-ver-partial-elig     value 'B'.
  3162             88  cs-clm-ver-not-eligible     value 'C'.
  3163             88  cs-clm-ver-not-elig-opn-clm value 'D'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  60
* EL050.cbl
  3164             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3165             88  cs-clm-ver-ND-CERT          value 'F'.
  3166             88  cs-clm-ver-spec-other       value 'G'.
  3167             88  cs-clam-ver-pratial-corrected
  3168                                             value 'H'.
  3169             88  cs-clm-ver-no-matches       value 'I'.
  3170             88  cs-clm-ver-not-elig-corrected
  3171                                             value 'J'.
  3172             88  cs-clm-ver-needs-review     value 'R'.
  3173             88  cs-clm-ver-sent-to-claims   value 'W'.
  3174         16  CS-LF-REFUND-METHOD           PIC X.
  3175         16  CS-AH-REFUND-METHOD           PIC X.
  3176         16  FILLER                        PIC X(353). *> was 420
  3177*        16  FILLER                        PIC X(496).
  3178*    COPY ELCCRTO.
  3179******************************************************************
  3180*                                                                *
  3181*                            ELCCRTO.                            *
  3182*                                                                *
  3183*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3184*                                                                *
  3185*   FILE TYPE = VSAM,KSDS                                        *
  3186*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3187*                                                                *
  3188*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3189*                                                                *
  3190*   LOG = YES                                                    *
  3191*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3192******************************************************************
  3193*                   C H A N G E   L O G
  3194*
  3195* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3196*-----------------------------------------------------------------
  3197*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3198* EFFECTIVE    NUMBER
  3199*-----------------------------------------------------------------
  3200* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3201* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3202* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3203* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3204* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3205******************************************************************
  3206 01  ORIGINAL-CERTIFICATE.
  3207     12  OC-RECORD-ID                      PIC XX.
  3208         88  VALID-OC-ID                      VALUE 'OC'.
  3209     12  OC-CONTROL-PRIMARY.
  3210         16  OC-COMPANY-CD                 PIC X.
  3211         16  OC-CARRIER                    PIC X.
  3212         16  OC-GROUPING                   PIC X(6).
  3213         16  OC-STATE                      PIC XX.
  3214         16  OC-ACCOUNT                    PIC X(10).
  3215         16  OC-CERT-EFF-DT                PIC XX.
  3216         16  OC-CERT-NO.
  3217             20  OC-CERT-PRIME             PIC X(10).
  3218             20  OC-CERT-SFX               PIC X.
  3219         16  OC-RECORD-TYPE                PIC X.
  3220         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3221     12  OC-LAST-MAINT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  61
* EL050.cbl
  3222     12  OC-LAST-MAINT-BY                  PIC X(4).
  3223     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3224     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3225     12  FILLER                            PIC X(49).
  3226     12  OC-ORIG-REC.
  3227         16  OC-INS-LAST-NAME              PIC X(15).
  3228         16  OC-INS-FIRST-NAME             PIC X(10).
  3229         16  OC-INS-MIDDLE-INIT            PIC X.
  3230         16  OC-INS-AGE                    PIC S999     COMP-3.
  3231         16  OC-JNT-LAST-NAME              PIC X(15).
  3232         16  OC-JNT-FIRST-NAME             PIC X(10).
  3233         16  OC-JNT-MIDDLE-INIT            PIC X.
  3234         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3235         16  OC-LF-BENCD                   PIC XX.
  3236         16  OC-LF-TERM                    PIC S999      COMP-3.
  3237         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3238         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3239         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3240         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3241         16  OC-LF-EXP-DT                  PIC XX.
  3242         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3243         16  OC-LF-CANCEL-DT               PIC XX.
  3244         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3245         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3246         16  OC-AH-BENCD                   PIC XX.
  3247         16  OC-AH-TERM                    PIC S999      COMP-3.
  3248         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3249         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3250         16  OC-AH-EXP-DT                  PIC XX.
  3251         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3252         16  OC-AH-CP                      PIC 99.
  3253         16  OC-AH-CANCEL-DT               PIC XX.
  3254         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3255         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3256         16  OC-CRED-BENE-NAME             PIC X(25).
  3257         16  OC-1ST-PMT-DT                 PIC XX.
  3258         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3259         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3260         16  OC-ISSUE-TRAN-IND             PIC X.
  3261         16  OC-CANCEL-TRAN-IND            PIC X.
  3262         16  FILLER                        PIC X(211).
  3263
  3264     12  FILLER                            PIC X(50).
  3265******************************************************************
  3266
  3267*    COPY ELCDATE.
  3268******************************************************************
  3269*                                                                *
  3270*                                                                *
  3271*                            ELCDATE.                            *
  3272*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3273*                            VMOD=2.003
  3274*                                                                *
  3275*                                                                *
  3276*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3277*                 LENGTH = 200                                   *
  3278******************************************************************
  3279
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  62
* EL050.cbl
  3280 01  DATE-CONVERSION-DATA.
  3281     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3282     12  DC-OPTION-CODE                PIC X.
  3283         88  BIN-TO-GREG                VALUE ' '.
  3284         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3285         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3286         88  YMD-GREG-TO-BIN            VALUE '3'.
  3287         88  MDY-GREG-TO-BIN            VALUE '4'.
  3288         88  JULIAN-TO-BIN              VALUE '5'.
  3289         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3290         88  FIND-CENTURY               VALUE '7'.
  3291         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3292         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3293         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3294         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3295         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3296         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3297         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3298         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3299         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3300         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3301         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3302         88  BIN-3-TO-GREG              VALUE 'I'.
  3303         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3304         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3305         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3306         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3307         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3308         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3309         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3310         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3311         88  THREE-CHARACTER-BIN
  3312                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3313         88  GREGORIAN-TO-BIN
  3314                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3315         88  BIN-TO-GREGORIAN
  3316                  VALUES ' ' '1' 'I' '8' 'G'.
  3317         88  JULIAN-TO-BINARY
  3318                  VALUES '5' 'C' 'E' 'F'.
  3319     12  DC-ERROR-CODE                 PIC X.
  3320         88  NO-CONVERSION-ERROR        VALUE ' '.
  3321         88  DATE-CONVERSION-ERROR
  3322                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3323         88  DATE-IS-ZERO               VALUE '1'.
  3324         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3325         88  DATE-IS-INVALID            VALUE '3'.
  3326         88  DATE1-GREATER-DATE2        VALUE '4'.
  3327         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3328         88  DATE-INVALID-OPTION        VALUE '9'.
  3329         88  INVALID-CENTURY            VALUE 'A'.
  3330         88  ONLY-CENTURY               VALUE 'B'.
  3331         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3332         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3333     12  DC-END-OF-MONTH               PIC X.
  3334         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3335     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3336         88  USE-NORMAL-PROCESS         VALUE ' '.
  3337         88  ADJUST-DOWN-100-YRS        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  63
* EL050.cbl
  3338         88  ADJUST-UP-100-YRS          VALUE '2'.
  3339     12  FILLER                        PIC X.
  3340     12  DC-CONVERSION-DATES.
  3341         16  DC-BIN-DATE-1             PIC XX.
  3342         16  DC-BIN-DATE-2             PIC XX.
  3343         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3344         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3345                       DC-GREG-DATE-1-EDIT.
  3346             20  DC-EDIT1-MONTH        PIC 99.
  3347             20  SLASH1-1              PIC X.
  3348             20  DC-EDIT1-DAY          PIC 99.
  3349             20  SLASH1-2              PIC X.
  3350             20  DC-EDIT1-YEAR         PIC 99.
  3351         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3352         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3353                     DC-GREG-DATE-2-EDIT.
  3354             20  DC-EDIT2-MONTH        PIC 99.
  3355             20  SLASH2-1              PIC X.
  3356             20  DC-EDIT2-DAY          PIC 99.
  3357             20  SLASH2-2              PIC X.
  3358             20  DC-EDIT2-YEAR         PIC 99.
  3359         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3360         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3361                     DC-GREG-DATE-1-YMD.
  3362             20  DC-YMD-YEAR           PIC 99.
  3363             20  DC-YMD-MONTH          PIC 99.
  3364             20  DC-YMD-DAY            PIC 99.
  3365         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3366         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3367                      DC-GREG-DATE-1-MDY.
  3368             20  DC-MDY-MONTH          PIC 99.
  3369             20  DC-MDY-DAY            PIC 99.
  3370             20  DC-MDY-YEAR           PIC 99.
  3371         16  DC-GREG-DATE-1-ALPHA.
  3372             20  DC-ALPHA-MONTH        PIC X(10).
  3373             20  DC-ALPHA-DAY          PIC 99.
  3374             20  FILLER                PIC XX.
  3375             20  DC-ALPHA-CENTURY.
  3376                 24 DC-ALPHA-CEN-N     PIC 99.
  3377             20  DC-ALPHA-YEAR         PIC 99.
  3378         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3379         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3380         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3381         16  DC-JULIAN-DATE            PIC 9(05).
  3382         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3383                                       PIC 9(05).
  3384         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3385             20  DC-JULIAN-YEAR        PIC 99.
  3386             20  DC-JULIAN-DAYS        PIC 999.
  3387         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3388         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3389         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3390     12  DATE-CONVERSION-VARIBLES.
  3391         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3392         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3393             20  FILLER                PIC 9(3).
  3394             20  HOLD-CEN-1-CCYY.
  3395                 24  HOLD-CEN-1-CC     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  64
* EL050.cbl
  3396                 24  HOLD-CEN-1-YY     PIC 99.
  3397             20  HOLD-CEN-1-MO         PIC 99.
  3398             20  HOLD-CEN-1-DA         PIC 99.
  3399         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3400             20  HOLD-CEN-1-R-MO       PIC 99.
  3401             20  HOLD-CEN-1-R-DA       PIC 99.
  3402             20  HOLD-CEN-1-R-CCYY.
  3403                 24  HOLD-CEN-1-R-CC   PIC 99.
  3404                 24  HOLD-CEN-1-R-YY   PIC 99.
  3405             20  FILLER                PIC 9(3).
  3406         16  HOLD-CENTURY-1-X.
  3407             20  FILLER                PIC X(3)  VALUE SPACES.
  3408             20  HOLD-CEN-1-X-CCYY.
  3409                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3410                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3411             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3412             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3413         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3414             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3415             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3416             20  HOLD-CEN-1-R-X-CCYY.
  3417                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3418                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3419             20  FILLER                PIC XXX.
  3420         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3421         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3422         16  DC-JULIAN-DATE-1          PIC 9(07).
  3423         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3424             20  DC-JULIAN-1-CCYY.
  3425                 24  DC-JULIAN-1-CC    PIC 99.
  3426                 24  DC-JULIAN-1-YR    PIC 99.
  3427             20  DC-JULIAN-DA-1        PIC 999.
  3428         16  DC-JULIAN-DATE-2          PIC 9(07).
  3429         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3430             20  DC-JULIAN-2-CCYY.
  3431                 24  DC-JULIAN-2-CC    PIC 99.
  3432                 24  DC-JULIAN-2-YR    PIC 99.
  3433             20  DC-JULIAN-DA-2        PIC 999.
  3434         16  DC-GREG-DATE-A-EDIT.
  3435             20  DC-EDITA-MONTH        PIC 99.
  3436             20  SLASHA-1              PIC X VALUE '/'.
  3437             20  DC-EDITA-DAY          PIC 99.
  3438             20  SLASHA-2              PIC X VALUE '/'.
  3439             20  DC-EDITA-CCYY.
  3440                 24  DC-EDITA-CENT     PIC 99.
  3441                 24  DC-EDITA-YEAR     PIC 99.
  3442         16  DC-GREG-DATE-B-EDIT.
  3443             20  DC-EDITB-MONTH        PIC 99.
  3444             20  SLASHB-1              PIC X VALUE '/'.
  3445             20  DC-EDITB-DAY          PIC 99.
  3446             20  SLASHB-2              PIC X VALUE '/'.
  3447             20  DC-EDITB-CCYY.
  3448                 24  DC-EDITB-CENT     PIC 99.
  3449                 24  DC-EDITB-YEAR     PIC 99.
  3450         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3451         16  DC-GREG-DATE-CYMD-R REDEFINES
  3452                              DC-GREG-DATE-CYMD.
  3453             20  DC-CYMD-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  65
* EL050.cbl
  3454             20  DC-CYMD-YEAR          PIC 99.
  3455             20  DC-CYMD-MONTH         PIC 99.
  3456             20  DC-CYMD-DAY           PIC 99.
  3457         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3458         16  DC-GREG-DATE-MDCY-R REDEFINES
  3459                              DC-GREG-DATE-MDCY.
  3460             20  DC-MDCY-MONTH         PIC 99.
  3461             20  DC-MDCY-DAY           PIC 99.
  3462             20  DC-MDCY-CEN           PIC 99.
  3463             20  DC-MDCY-YEAR          PIC 99.
  3464    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3465        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3466    12  DC-EL310-DATE                  PIC X(21).
  3467    12  FILLER                         PIC X(28).
  3468
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  66
* EL050.cbl
  3470*    COPY ELCCALC.
  3471******************************************************************
  3472*                                                                *
  3473*                           ELCCALC.                            *
  3474*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3475*                            VMOD=2.025                          *
  3476*                                                                *
  3477*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3478*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3479*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3480*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3481*                                                                *
  3482*  PASSED TO ELRTRM                                              *
  3483*  -----------------                                             *
  3484*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3485*  ORIGINAL TERM                                                 *
  3486*  BEGINNING DATE                                                *
  3487*  ENDING DATE                                                   *
  3488*  COMPANY I.D.                                                  *
  3489*  ACCOUNT MASTER USER FIELD                                     *
  3490*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3491*  FREE LOOK DAYS                                                *
  3492*                                                                *
  3493*  RETURNED FROM ELRTRM                                          *
  3494*  ---------------------                                         *
  3495*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3496*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3497*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3498*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3499*----------------------------------------------------------------*
  3500*  PASSED TO ELRAMT                                              *
  3501*  ----------------                                              *
  3502*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3503*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3504*  ORIGINAL AMOUNT                                               *
  3505*  ALTERNATE BENEFIT (BALLON)                                    *
  3506*  A.P.R. - NET PAY ONLY                                         *
  3507*  METHOD
  3508*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3509*  COMPANY I.D.                                                  *
  3510*  BENEFIT TYPE                                                  *
  3511*                                                                *
  3512*  RETURNED FROM ELRAMT                                          *
  3513*  --------------------                                          *
  3514*  REMAINING AMOUNT 1 - CURRENT                                  *
  3515*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3516*  REMAINING AMOUNT FACTOR
  3517*----------------------------------------------------------------*
  3518*  PASSED TO ELRESV                                              *
  3519*  -----------------                                             *
  3520*  CERTIFICATE EFFECTIVE DATE                                    *
  3521*  VALUATION DATE                                                *
  3522*  PAID THRU DATE                                                *
  3523*  BENEFIT                                                       *
  3524*  INCURRED DATE                                                 *
  3525*  REPORTED DATE                                                 *
  3526*  ISSUE AGE                                                     *
  3527*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  67
* EL050.cbl
  3528*  CDT PERCENT                                                   *
  3529*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3530* *CLAIM TYPE (LIFE, A/H)                                        *
  3531* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3532* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3533*                                                                *
  3534*  RETURNED FROM ELRESV                                          *
  3535*  --------------------                                          *
  3536*  CDT TABLE USED                                                *
  3537*  CDT FACTOR USED                                               *
  3538*  PAY TO CURRENT RESERVE                                        *
  3539*  I.B.N.R. - A/H ONLY                                           *
  3540*  FUTURE (ACCRUED) AH ONLY                                      *
  3541*----------------------------------------------------------------*
  3542*  PASSED TO ELRATE                                              *
  3543*  ----------------                                              *
  3544*  CERT ISSUE DATE                                               *
  3545*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3546*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3547*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3548*  STATE CODE (CLIENT DEFINED)                                   *
  3549*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3550*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3551*  DEVIATION CODE                                                *
  3552*  ISSUE AGE                                                     *
  3553*  ORIGINAL BENEFIT AMOUNT                                       *
  3554*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3555*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3556*  BENEFIT KIND (LIFE OR A/H)                                    *
  3557*  A.P.R.                                                        *
  3558*  METHOD
  3559*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3560*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3561*  COMPANY I.D. (3 CHARACTER)                                    *
  3562*  BENEFIT CODE                                                  *
  3563*  BENEFIT OVERRIDE CODE                                         *
  3564*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3565*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3566*  JOINT INDICATOR (CSL ONLY)                                    *
  3567*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3568*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3569*                                                                *
  3570*  RETURNED FROM ELRATE                                          *
  3571*  --------------------                                          *
  3572*  CALCULATED PREMIUM                                            *
  3573*  PREMIUM RATE                                                  *
  3574*  MORTALITY CODE                                                *
  3575*  MAX ATTAINED AGE                                              *
  3576*  MAX AGE                                                       *
  3577*  MAX TERM                                                      *
  3578*  MAX MONTHLY BENEFIT                                           *
  3579*  MAX TOTAL BENIFIT                                             *
  3580*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3581*----------------------------------------------------------------*
  3582*  PASSED TO ELRFND                                              *
  3583*  ----------------                                              *
  3584*  CERT ISSUE DATE                                               *
  3585*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  68
* EL050.cbl
  3586*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3587*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3588*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3589*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3590*  STATE CODE (CLIENT DEFINED)                                   *
  3591*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3592*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3593*  DEVIATION CODE                                                *
  3594*  ISSUE AGE                                                     *
  3595*  ORIGINAL BENEFIT AMOUNT                                       *
  3596*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3597*  PROCESS TYPE (CANCEL)                                         *
  3598*  BENEFIT KIND (LIFE OR A/H)                                    *
  3599*  A.P.R.                                                        *
  3600*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3601*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3602*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3603*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3604*  COMPANY I.D. (3 CHARACTER)                                    *
  3605*  BENEFIT CODE                                                  *
  3606*  BENEFIT OVERRIDE CODE                                         *
  3607*                                                                *
  3608*  RETURNED FROM ELRFND                                          *
  3609*  --------------------                                          *
  3610*  CALCULATED REFUND                                             *
  3611*----------------------------------------------------------------*
  3612*  PASSED TO ELEARN                                              *
  3613*  ----------------                                              *
  3614*  CERT ISSUE DATE                                               *
  3615*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3616*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3617*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3618*  STATE CODE (CLIENT DEFINED)                                   *
  3619*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3620*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3621*  DEVIATION CODE                                                *
  3622*  ISSUE AGE                                                     *
  3623*  ORIGINAL BENEFIT AMOUNT                                       *
  3624*  BENEFIT KIND (LIFE OR A/H)                                    *
  3625*  A.P.R.                                                        *
  3626*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3627*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3628*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3629*  COMPANY I.D. (3 CHARACTER)                                    *
  3630*  BENEFIT CODE                                                  *
  3631*  BENEFIT OVERRIDE CODE                                         *
  3632*                                                                *
  3633*  RETURNED FROM ELEARN                                          *
  3634*  --------------------                                          *
  3635*  INDICATED  EARNINGS                                           *
  3636*----------------------------------------------------------------*
  3637*                 LENGTH = 450                                   *
  3638*                                                                *
  3639******************************************************************
  3640******************************************************************
  3641*                   C H A N G E   L O G
  3642*
  3643* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  69
* EL050.cbl
  3644*-----------------------------------------------------------------
  3645*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3646* EFFECTIVE    NUMBER
  3647*-----------------------------------------------------------------
  3648* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3649* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3650* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3651* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3652* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3653* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3654* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3655* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3656* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3657* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3658* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3659******************************************************************
  3660
  3661 01  CALCULATION-PASS-AREA.
  3662     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3663                                     COMP.
  3664
  3665     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3666       88  NO-CP-ERROR                             VALUE ZERO.
  3667       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3668                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3669       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3670       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3671       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3672       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3673       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3674       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3675       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3676       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3677       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3678       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3679       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3680       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3681       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3682       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3683       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3684       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3685       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3686
  3687     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3688       88  NO-CP-ERROR-2                           VALUE ZERO.
  3689***********************  INPUT AREAS ****************************
  3690
  3691     12  CP-CALCULATION-AREA.
  3692         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3693         16  CP-CERT-EFF-DT        PIC XX.
  3694         16  CP-VALUATION-DT       PIC XX.
  3695         16  CP-PAID-THRU-DT       PIC XX.
  3696         16  CP-BENEFIT-TYPE       PIC X.
  3697           88  CP-AH                               VALUE 'A' 'D'
  3698                                                   'I' 'U'.
  3699           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3700           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3701         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  70
* EL050.cbl
  3702         16  CP-REPORTED-DT        PIC XX.
  3703         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3704         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3705         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3706                                     COMP-3.
  3707         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3708                                     COMP-3.
  3709         16  CP-CDT-METHOD         PIC X.
  3710           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3711           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3712           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3713         16  CP-CLAIM-TYPE         PIC X.
  3714           88  CP-AH-CLAIM                         VALUE 'A'.
  3715           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3716         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3717                                     COMP-3.
  3718         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3719                                     COMP-3.
  3720         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3721                                     COMP-3.
  3722         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3725                                     COMP-3.
  3726         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3727                                     COMP-3.
  3728         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3729                                     COMP-3.
  3730         16  CP-REM-TERM-METHOD    PIC X.
  3731           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3732           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3733           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3734           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3735           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3736           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3737           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3738         16  CP-EARNING-METHOD     PIC X.
  3739           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3740           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3741           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3742           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3743           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3744           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3745           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3746           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3747           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3748           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3749           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3750           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3751           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3752           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3753         16  CP-PROCESS-TYPE       PIC X.
  3754           88  CP-CLAIM                            VALUE '1'.
  3755           88  CP-CANCEL                           VALUE '2'.
  3756           88  CP-ISSUE                            VALUE '3'.
  3757         16  CP-SPECIAL-CALC-CD    PIC X.
  3758           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3759           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  71
* EL050.cbl
  3760           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3761           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3762           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3763           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3764           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3765           88  CP-FARM-PLAN                    VALUE 'F'.
  3766           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3767           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3768           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3769           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3770           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3771           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3772           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3773           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3774           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3775           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3776                                                     'W' 'X'.
  3777           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3778           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3779           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3780           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3781           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3782           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3783           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3784           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3785           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3786           88  CP-CSL-METH-1                   VALUE '5'.
  3787           88  CP-CSL-METH-2                   VALUE '6'.
  3788           88  CP-CSL-METH-3                   VALUE '7'.
  3789           88  CP-CSL-METH-4                   VALUE '8'.
  3790
  3791         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3794         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3795         16  CP-STATE              PIC XX          VALUE SPACE.
  3796         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3797         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3798           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3799               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3800         16  CP-R78-OPTION         PIC X.
  3801           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3802           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3803
  3804         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3805         16  CP-IBNR-RESERVE-SW    PIC X.
  3806         16  CP-CLAIM-STATUS       PIC X.
  3807         16  CP-RATE-FILE          PIC X.
  3808         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3809                                     COMP-3.
  3810
  3811         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3812         16  CP-AH-OVERRIDE-CODE   PIC X.
  3813
  3814         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3815                                     COMP-3.
  3816         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3817                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  72
* EL050.cbl
  3818         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3819                                     COMP-3.
  3820         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3825                                  PIC S9(7)V99 COMP-3.
  3826
  3827         16  CP-PAID-FROM-DATE     PIC X(02).
  3828         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3829         16  CP-EXT-DAYS-CALC      PIC X.
  3830           88  CP-EXT-NO-CHG                   VALUE ' '.
  3831           88  CP-EXT-CHG-LF                   VALUE '1'.
  3832           88  CP-EXT-CHG-AH                   VALUE '2'.
  3833           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3834         16  CP-DOMICILE-STATE     PIC XX.
  3835         16  CP-CARRIER            PIC X.
  3836         16  CP-REIN-FLAG          PIC X.
  3837         16  CP-REM-TRM-CALC-OPTION PIC X.
  3838           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3839                      '2' '3' '4' '5'.
  3840           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3841           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3842           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3843           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3844           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3845           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3846           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3847           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3848         16  CP-SIG-SWITCH         PIC X.
  3849         16  CP-RATING-METHOD      PIC X.
  3850           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3851           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3852           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3853           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3854           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3855           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3856           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3857           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3858           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3859         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3860                                     COMP-3.
  3861         16  CP-BEN-CATEGORY       PIC X.
  3862         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3863         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3864                                   PIC S99V9(5) COMP-3.
  3865         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3866         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3867                                   PIC S99V9(5) COMP-3.
  3868         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3869         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3870         16  CP-EXPIRE-DT          PIC XX.
  3871         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3872         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3873         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3874         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3875         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  73
* EL050.cbl
  3876             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3877             88  CP-CALC-CLP              VALUE 'C'.
  3878         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3879         16  CP-CANCEL-REASON      PIC X.
  3880         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3881         16  CP-PMT-MODE           PIC X.
  3882         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3883         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3884         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3885         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3886         16  FILLER                PIC X.
  3887
  3888***************    OUTPUT FROM ELRESV   ************************
  3889
  3890         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3891
  3892         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3893                                     COMP-3.
  3894         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3895                                     COMP-3.
  3896         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3897                                     COMP-3.
  3898         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3899                                     COMP-3.
  3900         16  FILLER                PIC X(09).
  3901***************    OUTPUT FROM ELRTRM   *************************
  3902
  3903         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3904                                     COMP-3.
  3905         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3906                                     COMP-3.
  3907         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3908                                     COMP-3.
  3909         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3910                                     COMP-3.
  3911         16  FILLER                PIC X(12).
  3912
  3913***************    OUTPUT FROM ELRAMT   *************************
  3914
  3915         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3916                                     COMP-3.
  3917         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3918                                     COMP-3.
  3919         16  FILLER                PIC X(12).
  3920
  3921***************    OUTPUT FROM ELRATE   *************************
  3922
  3923         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3924                                     COMP-3.
  3925         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3926                                     COMP-3.
  3927         16  CP-MORTALITY-CODE     PIC X(4).
  3928         16  CP-RATE-EDIT-FLAG     PIC X.
  3929             88  CP-RATES-NEED-APR                  VALUE '1'.
  3930         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3931                                     COMP-3.
  3932         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3933         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  74
* EL050.cbl
  3934         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3935                                   PIC S9(7)V99 COMP-3.
  3936         16  FILLER                PIC X(07).
  3937
  3938***************    OUTPUT FROM ELRFND   *************************
  3939
  3940         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3941                                     COMP-3.
  3942         16  CP-REFUND-TYPE-USED   PIC X.
  3943           88  CP-R-AS-R78                         VALUE '1'.
  3944           88  CP-R-AS-PRORATA                     VALUE '2'.
  3945           88  CP-R-AS-CALIF                       VALUE '3'.
  3946           88  CP-R-AS-TEXAS                       VALUE '4'.
  3947           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3948           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3949           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3950           88  CP-R-AS-MEAN                        VALUE '8'.
  3951           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3952           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3953           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3954           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3955           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3956           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3957         16  FILLER                PIC X(12).
  3958
  3959***************    OUTPUT FROM ELEARN   *************************
  3960
  3961         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3962                                     COMP-3.
  3963         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3964                                     COMP-3.
  3965         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3966                                     COMP-3.
  3967         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3968                                     COMP-3.
  3969         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3970                                     COMP-3.
  3971         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3972                                     COMP-3.
  3973         16  CP-EARNING-TYPE-USED  PIC X.
  3974           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3975           88  CP-E-AS-R78                         VALUE '1'.
  3976           88  CP-E-AS-PRORATA                     VALUE '2'.
  3977           88  CP-E-AS-TEXAS                       VALUE '4'.
  3978           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3979           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3980           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3981           88  CP-E-AS-MEAN                        VALUE '8'.
  3982           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3983         16  FILLER                PIC X(12).
  3984
  3985***************    OUTPUT FROM ELPMNT   *************************
  3986
  3987         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3988                                     COMP-3.
  3989         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3990                                     COMP-3.
  3991         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  75
* EL050.cbl
  3992
  3993***************   MISC WORK AREAS    *****************************
  3994         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3995                                     COMP-3.
  3996         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3997                                     COMP-3.
  3998         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3999                                     COMP-3.
  4000         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4001                                     COMP-3.
  4002         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4003                                     COMP-3.
  4004         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4005                                     COMP-3.
  4006         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4007             88  OPEN-RATE-FILE                   VALUE 'O'.
  4008             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4009             88  IO-ERROR                         VALUE 'E'.
  4010
  4011         16  CP-FIRST-PAY-DATE     PIC XX.
  4012
  4013         16  CP-JOINT-INDICATOR    PIC X.
  4014
  4015         16  CP-RESERVE-REMAINING-TERM
  4016                                   PIC S9(4)V9    VALUE ZERO
  4017                                     COMP-3.
  4018
  4019         16  CP-INSURED-BIRTH-DT   PIC XX.
  4020
  4021         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4022                                     COMP-3.
  4023
  4024         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4025                                     COMP-3.
  4026
  4027         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4028                                     COMP-3.
  4029
  4030         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4031                                     COMP-3.
  4032
  4033         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4034                                     COMP-3.
  4035
  4036         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4037                                     COMP-3.
  4038
  4039         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4040                                     COMP-3.
  4041
  4042         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4043             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4044
  4045         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4046                                     COMP-3.
  4047         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4048                                     COMP-3.
  4049         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  76
* EL050.cbl
  4050         16  cp-extra-periods      pic 9 value zeros.
  4051         16  cp-net-only-state     pic x value spaces.
  4052         16  FILLER                PIC X(13).
  4053******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  77
* EL050.cbl
  4055******************************************************************
  4056*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4057*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4058*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4059*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4060*** MODIFICATION.                                              ***
  4061*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4062*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4063******************************************************************
  4064*    COPY ERCPNDB.
  4065******************************************************************
  4066*                                                                *
  4067*                                                                *
  4068*                            ERCPNDB.                            *
  4069*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4070*                            VMOD=2.025                          *
  4071*                                                                *
  4072*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4073*                                                                *
  4074******************************************************************
  4075*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4076*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4077******************************************************************
  4078*                                                                *
  4079*                                                                *
  4080*   FILE TYPE = VSAM,KSDS                                        *
  4081*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4082*                                                                *
  4083*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4084*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4085*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4086*                                                 RKP=13,LEN=36  *
  4087*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4088*                                      AND CHG-SEQ.)             *
  4089*                                                RKP=49,LEN=11   *
  4090*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4091*                                      AND CHG-SEQ.)             *
  4092*                                                RKP=60,LEN=15   *
  4093*                                                                *
  4094*   LOG = NO                                                     *
  4095*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4096******************************************************************
  4097******************************************************************
  4098*                   C H A N G E   L O G
  4099*
  4100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4101*-----------------------------------------------------------------
  4102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4103* EFFECTIVE    NUMBER
  4104*-----------------------------------------------------------------
  4105* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4106* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4107* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4108* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4109* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4110* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4111* 032306                   PEMA  ADD BOW LOAN NUMBER
  4112* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  78
* EL050.cbl
  4113* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4114* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4115* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4116* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4117* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4118* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4119* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4120* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4121* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4122* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4123* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4124******************************************************************
  4125
  4126 01  PENDING-BUSINESS.
  4127     12  PB-RECORD-ID                     PIC XX.
  4128         88  VALID-PB-ID                        VALUE 'PB'.
  4129
  4130     12  PB-CONTROL-PRIMARY.
  4131         16  PB-COMPANY-CD                PIC X.
  4132         16  PB-ENTRY-BATCH               PIC X(6).
  4133         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4134         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4135
  4136     12  PB-CONTROL-BY-ACCOUNT.
  4137         16  PB-COMPANY-CD-A1             PIC X.
  4138         16  PB-CARRIER                   PIC X.
  4139         16  PB-GROUPING.
  4140             20  PB-GROUPING-PREFIX       PIC XXX.
  4141             20  PB-GROUPING-PRIME        PIC XXX.
  4142         16  PB-STATE                     PIC XX.
  4143         16  PB-ACCOUNT.
  4144             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4145             20  PB-ACCOUNT-PRIME         PIC X(6).
  4146         16  PB-CERT-EFF-DT               PIC XX.
  4147         16  PB-CERT-NO.
  4148             20  PB-CERT-PRIME            PIC X(10).
  4149             20  PB-CERT-SFX              PIC X.
  4150         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4151
  4152         16  PB-RECORD-TYPE               PIC X.
  4153             88  PB-MAILING-DATA                VALUE '0'.
  4154             88  PB-ISSUE                       VALUE '1'.
  4155             88  PB-CANCELLATION                VALUE '2'.
  4156             88  PB-BATCH-TRAILER               VALUE '9'.
  4157
  4158     12  PB-CONTROL-BY-ORIG-BATCH.
  4159         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4160         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4161         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4162         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4163
  4164     12  PB-CONTROL-BY-CSR.
  4165         16  PB-CSR-COMPANY-CD            PIC X.
  4166         16  PB-CSR-ID                    PIC X(4).
  4167         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4168         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4169         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4170******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  79
* EL050.cbl
  4171*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4172******************************************************************
  4173
  4174     12  PB-LAST-MAINT-DT                 PIC XX.
  4175     12  PB-LAST-MAINT-BY                 PIC X(4).
  4176     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4177
  4178     12  PB-RECORD-BODY                   PIC X(375).
  4179
  4180     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4181         16  PB-CERT-ORIGIN               PIC X.
  4182             88  CLASIC-CREATED-CERT         VALUE '1'.
  4183         16  PB-I-NAME.
  4184             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4185             20  PB-I-INSURED-FIRST-NAME.
  4186                 24  PB-I-INSURED-1ST-INIT PIC X.
  4187                 24  FILLER                PIC X(9).
  4188             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4189         16  PB-I-AGE                     PIC S99   COMP-3.
  4190         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4191         16  PB-I-BIRTHDAY                PIC XX.
  4192         16  PB-I-INSURED-SEX             PIC X.
  4193             88  PB-SEX-MALE     VALUE 'M'.
  4194             88  PB-SEX-FEMALE   VALUE 'F'.
  4195
  4196         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4197         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4198         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4199         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4200         16  PB-I-SKIP-CODE               PIC X.
  4201             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4202             88  PB-SKIP-JULY              VALUE '1'.
  4203             88  PB-SKIP-AUGUST            VALUE '2'.
  4204             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4205             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4206             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4207             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4208             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4209             88  PB-SKIP-JUNE              VALUE '8'.
  4210             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4211             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4212             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4213         16  PB-I-TERM-TYPE               PIC X.
  4214             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4215             88  PB-PAID-WEEKLY            VALUE 'W'.
  4216             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4217             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4218             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4219         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4220         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4221         16  PB-I-DATA-ENTRY-SW           PIC X.
  4222             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4223             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4224             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4225             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4226         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4227         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4228*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  80
* EL050.cbl
  4229         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4230         16  FILLER                       PIC X.
  4231
  4232         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4233             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4234             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4235                                                   '90' THRU '99'.
  4236         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4237                                          PIC XX.
  4238         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4239         16  PB-I-AMOUNT-FINANCED REDEFINES
  4240                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4241         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4242         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4243                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4244         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4245         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4246         16  PB-I-CLP-AMOUNT REDEFINES
  4247                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4248         16  PB-I-LF-CALC-FLAG            PIC X.
  4249             88 PB-COMP-LF-PREM               VALUE '?'.
  4250         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4251         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4252         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4253         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4254         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4255         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4256         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4257         16  PB-I-LF-ABBR                 PIC XXX.
  4258         16  PB-I-LF-INPUT-CD             PIC XX.
  4259
  4260         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4261             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4262             88  PB-INVALID-AH               VALUE '  ' '00'
  4263                                                   '90' THRU '99'.
  4264         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4265         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4266         16  PB-I-AH-CALC-FLAG            PIC X.
  4267             88 PB-COMP-AH-PREM                  VALUE '?'.
  4268         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4269         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4270         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4271         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4272         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4273         16  PB-I-AH-ABBR                 PIC XXX.
  4274         16  PB-I-AH-INPUT-CD             PIC XXX.
  4275
  4276         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4277         16  PB-I-REIN-TABLE              PIC XXX.
  4278         16  PB-I-BUSINESS-TYPE           PIC 99.
  4279         16  PB-I-INDV-GRP-CD             PIC X.
  4280         16  PB-I-MORT-CODE.
  4281             20  PB-I-TABLE               PIC X.
  4282             20  PB-I-INTEREST            PIC XX.
  4283             20  PB-I-MORT-TYP            PIC X.
  4284         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4285         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4286         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  81
* EL050.cbl
  4287         16  PB-I-INDV-GRP-OVRD           PIC X.
  4288         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4289         16  PB-I-SIG-SW                  PIC X.
  4290             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4291         16  PB-I-RATE-CLASS              PIC XX.
  4292         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4293         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4294         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4295         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4296         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4297         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4298         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4299         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4300         16  PB-I-OB-FLAG                 PIC X.
  4301             88  PB-I-OB                      VALUE 'B'.
  4302             88  PB-I-SUMMARY                 VALUE 'Z'.
  4303         16  PB-I-ENTRY-STATUS            PIC X.
  4304             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4305                                              'M' '5' '9' '2'.
  4306             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4307             88  PB-I-POLICY-PENDING          VALUE '2'.
  4308             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4309             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4310             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4311             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4312             88  PB-I-REIN-ONLY               VALUE '9'.
  4313             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4314             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4315             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4316             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4317         16  PB-I-INT-CODE                PIC X.
  4318             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4319             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4320         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4321         16  PB-I-SOC-SEC-NO              PIC X(11).
  4322         16  PB-I-MEMBER-NO               PIC X(12).
  4323         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4324*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4325         16  PB-I-OLD-LOF                 PIC XXX.
  4326         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4327         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4328         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4329         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4330         16  PB-I-LIFE-INDICATOR          PIC X.
  4331             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4332         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4333         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4334                                          PIC S9(5)V99    COMP-3.
  4335         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4336             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4337             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4338         16  PB-I-1ST-PMT-DT              PIC XX.
  4339         16  PB-I-JOINT-INSURED.
  4340             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4341             20 PB-I-JOINT-FIRST-NAME.
  4342                24  PB-I-JOINT-FIRST-INIT PIC X.
  4343                24  FILLER                PIC X(9).
  4344             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  82
* EL050.cbl
  4345*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4346         16  PB-I-BENEFICIARY-NAME.
  4347             20  PB-I-BANK-NUMBER         PIC X(10).
  4348             20  FILLER                   PIC X(15).
  4349         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4350         16  PB-I-REFERENCE               PIC X(12).
  4351         16  FILLER REDEFINES PB-I-REFERENCE.
  4352             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4353             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4354             20  PB-I-CLP-STATE           PIC XX.
  4355         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4356             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4357             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4358             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4359         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4360         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4361         16  PB-I-RESIDENT-STATE          PIC XX.
  4362         16  PB-I-RATE-CODE               PIC X(4).
  4363         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4364         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4365         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4366         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4367         16  PB-I-BANK-NOCHRGB            PIC 99.
  4368         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4369         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4370
  4371     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4372         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4373             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4374         16  PB-C-CANCEL-ORIGIN           PIC X.
  4375             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4376         16  PB-C-LF-CANCEL-DT            PIC XX.
  4377         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4378         16  PB-C-LF-CALC-REQ             PIC X.
  4379             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4380         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4381         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4382         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4383             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4384         16  PB-C-AH-CANCEL-DT            PIC XX.
  4385         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4386         16  PB-C-AH-CALC-REQ             PIC X.
  4387             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4388         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4389         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4390         16  PB-C-LAST-NAME               PIC X(15).
  4391         16  PB-C-REFUND-SW               PIC X.
  4392             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4393             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4394         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4395         16  PB-C-PAYEE-CODE              PIC X(6).
  4396         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4397         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4398         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4399         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4400         16  PB-C-REFERENCE               PIC X(12).
  4401         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4402         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  83
* EL050.cbl
  4403         16  PB-C-POST-CARD-IND           PIC X.
  4404         16  PB-C-CANCEL-REASON           PIC X.
  4405         16  PB-C-REF-INTERFACE-SW        PIC X.
  4406         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4407         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4408         16  FILLER                       PIC X(01).
  4409*        16  FILLER                       PIC X(18).
  4410         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4411*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4412         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4413         16  PB-CANCELED-CERT-DATA.
  4414             20  PB-CI-INSURED-NAME.
  4415                 24  PB-CI-LAST-NAME      PIC X(15).
  4416                 24  PB-CI-INITIALS       PIC XX.
  4417             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4418             20  PB-CI-INSURED-SEX        PIC X.
  4419             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4420             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4421             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4422             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4423             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4424             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4425             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4426             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4427             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4428             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4429             20  PB-CI-RATE-CLASS         PIC XX.
  4430             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4431             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4432             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4433             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4434             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4435             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4436             20  PB-CI-LF-ABBR            PIC X(3).
  4437             20  PB-CI-AH-ABBR            PIC X(3).
  4438             20  PB-CI-OB-FLAG            PIC X.
  4439                 88  PB-CI-OB                VALUE 'B'.
  4440             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4441                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4442                                           'M' '4' '5' '9' '2'.
  4443                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4444                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4445                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4446                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4447                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4448                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4449                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4450                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4451                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4452                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4453                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4454                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4455                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4456             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4457                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4458                                           'M' '4' '5' '9' '2'.
  4459                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4460                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  84
* EL050.cbl
  4461                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4462                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4463                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4464                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4465                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4466                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4467                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4468                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4469                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4470                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4471                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4472             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4473             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4474             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4475             20  PB-CI-MEMBER-NO          PIC X(12).
  4476             20  PB-CI-INT-CODE           PIC X.
  4477                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4478                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4479             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4480             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4481             20  PB-CI-COMP-EXCP-SW       PIC X.
  4482                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4483                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4484             20  PB-CI-ENTRY-STATUS       PIC X.
  4485             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4486             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4487             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4488             20  PB-CI-DEATH-DT           PIC XX.
  4489             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4490             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4491             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4492             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4493             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4494             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4495             20  PB-CI-ENTRY-DT              PIC XX.
  4496             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4497             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4498             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4499             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4500             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4501             20  PB-CI-OLD-LOF               PIC XXX.
  4502*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4503             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4504             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4505             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4506             20  PB-CI-INDV-GRP-CD           PIC X.
  4507             20  PB-CI-BENEFICIARY-NAME.
  4508                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4509                 24  FILLER                  PIC X(15).
  4510             20  PB-CI-NOTE-SW               PIC X.
  4511             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4512             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4513             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4514             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4515             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4516             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4517             20  PB-CI-FIRST-NAME            PIC X(10).
  4518             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  85
* EL050.cbl
  4519
  4520         16  FILLER                       PIC X(13).
  4521*032306  16  FILLER                       PIC X(27).
  4522*        16  FILLER                       PIC X(46).
  4523
  4524     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4525         16  FILLER                       PIC X(10).
  4526         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4527         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4528         16  PB-M-INSURED-MID-INIT        PIC X.
  4529         16  PB-M-INSURED-AGE             PIC 99.
  4530         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4531         16  PB-M-INSURED-SEX             PIC X.
  4532         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4533         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4534         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4535         16  PB-M-INSURED-CITY-STATE.
  4536             20  PB-M-INSURED-CITY        PIC X(28).
  4537             20  PB-M-INSURED-STATE       PIC XX.
  4538         16  PB-M-INSURED-ZIP-CODE.
  4539             20  PB-M-INSURED-ZIP-PRIME.
  4540                 24  PB-M-INSURED-ZIP-1   PIC X.
  4541                     88  PB-M-CANADIAN-POST-CODE
  4542                                             VALUE 'A' THRU 'Z'.
  4543                 24  FILLER               PIC X(4).
  4544             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4545         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4546                                        PB-M-INSURED-ZIP-CODE.
  4547             20  PM-M-INS-CAN-POST1       PIC XXX.
  4548             20  PM-M-INS-CAN-POST2       PIC XXX.
  4549             20  FILLER                   PIC XXX.
  4550         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4551         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4552         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4553         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4554         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4555         16  PB-M-CRED-BENE-CITYST.
  4556             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4557             20  PB-M-CRED-BENE-STATE     PIC XX.
  4558         16  FILLER                       PIC X(92).
  4559
  4560     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4561         16  FILLER                       PIC X(10).
  4562         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4563         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4564         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4565         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4566         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4567         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4568         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4569         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4570         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4571         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4572         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4573         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4574         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4575         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4576         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  86
* EL050.cbl
  4577         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4578         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4579         16  PB-ACCOUNT-NAME              PIC X(30).
  4580         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4581         16  PB-REFERENCE                 PIC X(12).
  4582         16  PB-B-RECEIVED-DT             PIC XX.
  4583         16  FILLER                       PIC X(234).
  4584
  4585     12  PB-RECORD-STATUS.
  4586         16  PB-CREDIT-SELECT-DT          PIC XX.
  4587         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4588         16  PB-BILLED-DT                 PIC XX.
  4589         16  PB-BILLING-STATUS            PIC X.
  4590             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4591             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4592             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4593         16  PB-RECORD-BILL               PIC X.
  4594             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4595             88  PB-RECORD-RETURNED           VALUE 'R'.
  4596             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4597             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4598             88  PB-OVERRIDE-AH               VALUE 'A'.
  4599             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4600         16  PB-BATCH-ENTRY               PIC X.
  4601             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4602             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4603             88  PB-REISSUED-CERT             VALUE 'E'.
  4604             88  PB-CASH-CERT                 VALUE 'C'.
  4605             88  PB-MONTHLY-CERT              VALUE 'M'.
  4606             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4607             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4608             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4609         16  PB-FORCE-CODE                PIC X.
  4610             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4611             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4612             88  PB-CANCEL-FORCE              VALUE '8'.
  4613             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4614             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4615             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4616             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4617             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4618             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4619             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4620             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4621         16  PB-FATAL-FLAG                PIC X.
  4622             88  PB-FATAL-ERRORS              VALUE 'X'.
  4623         16  PB-FORCE-ER-CD               PIC X.
  4624             88  PB-FORCE-ERRORS              VALUE 'F'.
  4625             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4626         16  PB-WARN-ER-CD                PIC X.
  4627             88  PB-WARNING-ERRORS            VALUE 'W'.
  4628         16  FILLER                       PIC X.
  4629         16  PB-OUT-BAL-CD                PIC X.
  4630             88  PB-OUT-OF-BAL                VALUE 'O'.
  4631         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4632         16  PB-AH-OVERRIDE-L1            PIC X.
  4633         16  PB-INPUT-DT                  PIC XX.
  4634         16  PB-INPUT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  87
* EL050.cbl
  4635         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4636         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4637         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4638         16  PB-LF-EARNING-METHOD         PIC X.
  4639         16  PB-AH-EARNING-METHOD         PIC X.
  4640         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4641         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4642         16  PB-REIN-CD                   PIC XXX.
  4643         16  PB-LF-REFUND-TYPE            PIC X.
  4644         16  PB-AH-REFUND-TYPE            PIC X.
  4645         16  PB-ACCT-EFF-DT               PIC XX.
  4646         16  PB-ACCT-EXP-DT               PIC XX.
  4647         16  PB-COMPANY-ID                PIC X(3).
  4648         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4649         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4650         16  PB-SV-CARRIER                PIC X.
  4651         16  PB-SV-GROUPING               PIC X(6).
  4652         16  PB-SV-STATE                  PIC XX.
  4653         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4654         16  PB-GA-BILLING-INFO.
  4655             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4656                                          PIC XX.
  4657         16  PB-SV-REMIT-TO  REDEFINES
  4658             PB-GA-BILLING-INFO           PIC X(10).
  4659         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4660         16  PB-I-LOAN-OFFICER            PIC X(5).
  4661         16  PB-I-VIN                     PIC X(17).
  4662
  4663         16  FILLER                       PIC X(04).
  4664         16  IMNET-BYPASS-SW              PIC X.
  4665
  4666******************************************************************
  4667*                COMMON EDIT ERRORS                              *
  4668******************************************************************
  4669
  4670     12  PB-COMMON-ERRORS.
  4671         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4672                                           PIC S9(4)     COMP.
  4673
  4674******************************************************************
  4675
  4676* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4677*    COPY ELC50W1.
  4678******************************************************************
  4679*                                                                *
  4680*                                                                *
  4681*                             ELC50W1                            *
  4682*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4683*                            VMOD=2.004                          *
  4684*                                                                *
  4685*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4686*                                                                *
  4687*                                                                *
  4688******************************************************************
  4689
  4690     12  WK-WORK-AREA.
  4691         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4692         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  88
* EL050.cbl
  4693         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4694         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4695         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4696         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4697         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4698         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4699         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4700         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4701         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4702         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4703         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4704         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4705         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4706         16  WK-CREDIT-EDIT-CONTROLS.
  4707             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4708             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4709             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4710             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4711             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4712             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4713         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4714         16  WK-SAVE-REIN-DATA.
  4715             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4716             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4717             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4718         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4719             88  ENTRY-FROM-EL6311       VALUE '6'.
  4720         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4721         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4722     12  WK-RECORD-ADDRESSES.
  4723         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4724         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4725         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4726         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4727         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4728         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4729         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4730         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4731     12  WK-OVER-SHORT-AREA.
  4732         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4733         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4734         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4735             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4736         16  FILLER                   PIC X(5) VALUE SPACES.
  4737
  4738*    COPY ELCEDITC.
  4739******************************************************************
  4740*                                                                *
  4741*                                                                *
  4742*                            ELCEDITC                            *
  4743*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4744*                            VMOD=2.012                          *
  4745*                                                                *
  4746*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4747*                     EL6313, EL050 AND EL517.                   *
  4748*                                                                *
  4749******************************************************************
  4750******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  89
* EL050.cbl
  4751*                   C H A N G E   L O G
  4752*
  4753* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4754*-----------------------------------------------------------------
  4755*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4756* EFFECTIVE    NUMBER
  4757*-----------------------------------------------------------------
  4758* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4759******************************************************************
  4760
  4761     12  EDIT-CRITERIA-DATA.
  4762         16  EC-CO-MONTH-END-DT       PIC XX.
  4763         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4764         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4765         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4766         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4767         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4768         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4769         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4770         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4771         16  EC-CO-REM-TERM-CALC      PIC X.
  4772               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4773               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4774               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4775               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4776
  4777         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4778               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4779               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4780               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4781               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4782               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4783               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4784               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4785               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4786               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4787               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4788
  4789         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4790               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4791               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4792               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4793               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4794               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4795               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4796               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4797               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4798
  4799         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4800                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4801                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4802
  4803         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4804                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4805                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4806                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4807                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4808                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  90
* EL050.cbl
  4809                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4810                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4811                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4812
  4813         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4814               88  EC-BR-REDUCING                   VALUE 'R'.
  4815               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4816
  4817         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4818         16  EC-BR-LF-DESC             PIC X(10).
  4819         16  EC-BR-AH-DESC             PIC X(10).
  4820         16  EC-BR-LF-COMMENT          PIC X(10).
  4821         16  EC-BR-AH-COMMENT          PIC X(10).
  4822
  4823         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4824               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4825               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4826               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4827               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4828
  4829         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4830               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4831               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4832               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4833               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4834
  4835         16  EC-BR-LF-REFUND-CALC      PIC X.
  4836                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4837                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4838                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4839                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4840                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4841                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4842                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4843
  4844         16  EC-BR-AH-REFUND-CALC      PIC X.
  4845                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4846                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4847                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4848                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4849                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4850                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4851                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4852                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4853
  4854         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4855                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4856                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4857                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4858
  4859         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4860                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4861                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4862                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4863
  4864         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4865         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4866         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  91
* EL050.cbl
  4867         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4868
  4869         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4870         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4871                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4872                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4873                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4874                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4875
  4876         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4877               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4878               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4879               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4880               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4881               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4882
  4883         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4884               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4885               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4886               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4887               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4888               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4889
  4890         16  EC-ST-LF-REFUND-CALC      PIC X.
  4891                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4892                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4893                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4894                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4895                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4896                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4897                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4898                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4899
  4900         16  EC-ST-AH-REFUND-CALC      PIC X.
  4901                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4902                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4903                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4904                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4905                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4906                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4907                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4908                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4909
  4910         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4911         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4912         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4913         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4914         16  EC-AM-EXPIRATION-DT       PIC XX.
  4915         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4916         16  EC-AM-CLASS-CD            PIC XX.
  4917         16  EC-AM-LF-DEVIATION        PIC XXX.
  4918         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4919         16  EC-AM-AH-DEVIATION        PIC XXX.
  4920         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4921         16  EC-AM-PHONE-NO            PIC X(10).
  4922
  4923         16  EC-AM-LF-REFUND-CALC      PIC X.
  4924                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  92
* EL050.cbl
  4925                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4926                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4927                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4928                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4929                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4930                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4931
  4932         16  EC-AM-AH-REFUND-CALC      PIC X.
  4933                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4934                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4935                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4936                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4937                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4938                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4939                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4940
  4941         16  EC-AM-BEN-I-G-CD          PIC X.
  4942                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4943                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4944                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4945
  4946         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4947         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4948         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4949         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4950         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4951         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4952         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4953         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4954         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4955
  4956         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4957         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4958         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4959         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4960         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4961         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4962         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4963         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4964         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4965         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4966         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4967         16  EC-RT-LF-NSP-ST           PIC XX.
  4968         16  EC-RT-AH-NSP-ST           PIC XX.
  4969         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4970         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4971
  4972         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4973             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4974                                             'M' '5' '9' '2'.
  4975             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4976             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4977             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4978             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4979             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4980             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4981             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4982             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  93
* EL050.cbl
  4983             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4984             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4985
  4986         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4987             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4988                                             'M' '5' '9' '2'.
  4989             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4990             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4991             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4992             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4993             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4994             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4995             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4996             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4997             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4998             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4999
  5000         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5001         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5002         16  EC-CM-LF-CANCEL-DT        PIC XX.
  5003         16  EC-CM-AH-CANCEL-DT        PIC XX.
  5004         16  EC-CM-DEATH-DT            PIC XX.
  5005
  5006*DMD CUSTOM CODING FIELDS BELOW
  5007*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  5008         16  EC-BR-DMD-RATING-SW       PIC X.
  5009                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  5010                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  5011                 88  NO-DMD-RATING               VALUE 'N'.
  5012
  5013         16  EC-NEW-CERT               PIC X(11).
  5014         16  EC-NEW-STATE              PIC XX.
  5015         16  FILLER                    PIC X.
  5016*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  5017         16  OVER-SHORT-EDIT-FIELDS.
  5018             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5019             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5020             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5021             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5022             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  5023             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5024             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5025             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5026             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5027         16  FILLER                    PIC X(71).
  5028******************************************************************
  5029
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  94
* EL050.cbl
  5031*    COPY ELCDIFRD.
  5032******************************************************************
  5033*                                                                *
  5034*                                                                *
  5035*                            ELCDIFRD.                           *
  5036*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5037*                            VMOD=2.004                          *
  5038*                                                                *
  5039*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  5040*                                                                *
  5041******************************************************************
  5042*
  5043  01  WS-DIFFERENCE-CALCULATION.
  5044        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  5045        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  5046        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  5047        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  5048        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  5049        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5050        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5051        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5052        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5053        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5054        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5055
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  95
* EL050.cbl
  5057****************************************************************
  5058*
  5059* Copyright (c) 2007-2013 Dell Inc.
  5060* All rights reserved.
  5061*
  5062****************************************************************
  5063 01  DFHEIV.
  5064   02  DFHEIV0               PIC X(35).
  5065   02  DFHEIV1               PIC X(08).
  5066   02  DFHEIV2               PIC X(08).
  5067   02  DFHEIV3               PIC X(08).
  5068   02  DFHEIV4               PIC X(06).
  5069   02  DFHEIV5               PIC X(04).
  5070   02  DFHEIV6               PIC X(04).
  5071   02  DFHEIV7               PIC X(02).
  5072   02  DFHEIV8               PIC X(02).
  5073   02  DFHEIV9               PIC X(01).
  5074   02  DFHEIV10              PIC S9(7) COMP-3.
  5075   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5076   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5077   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5078   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5079   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5080   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5081   02  DFHEIV17              PIC X(04).
  5082   02  DFHEIV18              PIC X(04).
  5083   02  DFHEIV19              PIC X(04).
  5084   02  DFHEIV20              USAGE IS POINTER.
  5085   02  DFHEIV21              USAGE IS POINTER.
  5086   02  DFHEIV22              USAGE IS POINTER.
  5087   02  DFHEIV23              USAGE IS POINTER.
  5088   02  DFHEIV24              USAGE IS POINTER.
  5089   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5090   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5091   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5092   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5093   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5094   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5095   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5096   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5097   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5098   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5099   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5100   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5101   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5102   02  FILLER                PIC X(02).
  5103   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5104   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5105   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5106   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5107   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5108   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5109   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5110 LINKAGE  SECTION.
  5111*****************************************************************
  5112*                                                               *
  5113* Copyright (c) 2007-2013 Dell Inc.                             *
  5114* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  96
* EL050.cbl
  5115*                                                               *
  5116*****************************************************************
  5117 01  dfheiblk.
  5118     02  eibtime          pic s9(7) comp-3.
  5119     02  eibdate          pic s9(7) comp-3.
  5120     02  eibtrnid         pic x(4).
  5121     02  eibtaskn         pic s9(7) comp-3.
  5122     02  eibtrmid         pic x(4).
  5123     02  dfheigdi         pic s9(4) comp.
  5124     02  eibcposn         pic s9(4) comp.
  5125     02  eibcalen         pic s9(4) comp.
  5126     02  eibaid           pic x(1).
  5127     02  eibfiller1       pic x(1).
  5128     02  eibfn            pic x(2).
  5129     02  eibfiller2       pic x(2).
  5130     02  eibrcode         pic x(6).
  5131     02  eibfiller3       pic x(2).
  5132     02  eibds            pic x(8).
  5133     02  eibreqid         pic x(8).
  5134     02  eibrsrce         pic x(8).
  5135     02  eibsync          pic x(1).
  5136     02  eibfree          pic x(1).
  5137     02  eibrecv          pic x(1).
  5138     02  eibsend          pic x(1).
  5139     02  eibatt           pic x(1).
  5140     02  eibeoc           pic x(1).
  5141     02  eibfmh           pic x(1).
  5142     02  eibcompl         pic x(1).
  5143     02  eibsig           pic x(1).
  5144     02  eibconf          pic x(1).
  5145     02  eiberr           pic x(1).
  5146     02  eibrldbk         pic x(1).
  5147     02  eiberrcd         pic x(4).
  5148     02  eibsynrb         pic x(1).
  5149     02  eibnodat         pic x(1).
  5150     02  eibfiller5       pic x(2).
  5151     02  eibresp          pic s9(8) comp.
  5152     02  eibresp2         pic s9(8) comp.
  5153     02  dfheigdj         pic s9(4) comp.
  5154     02  dfheigdk         pic s9(4) comp.
  5155
  5156 01  DFHCOMMAREA                   PIC X(1036).
  5157
  5158*01 PARMLIST .
  5159*    02  FILLER                    PIC S9(8)   COMP.
  5160*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5161*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5162*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5163*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5164*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5165*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5166*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5167
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  97
* EL050.cbl
  5169*    COPY ELCCNTL.
  5170******************************************************************
  5171*                                                                *
  5172*                                                                *
  5173*                            ELCCNTL.                            *
  5174*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5175*                            VMOD=2.059                          *
  5176*                                                                *
  5177*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5178*                                                                *
  5179*   FILE TYPE = VSAM,KSDS                                        *
  5180*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5181*                                                                *
  5182*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5183*       ALTERNATE INDEX = NONE                                   *
  5184*                                                                *
  5185*   LOG = YES                                                    *
  5186*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5187******************************************************************
  5188*                   C H A N G E   L O G
  5189*
  5190* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5191*-----------------------------------------------------------------
  5192*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5193* EFFECTIVE    NUMBER
  5194*-----------------------------------------------------------------
  5195* 082503                   PEMA  ADD BENEFIT GROUP
  5196* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5197* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5198* 092705    2005050300006  PEMA  ADD SPP LEASES
  5199* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5200* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5201* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5202* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5203* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5204* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5205* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5206* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5207* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5208* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5209* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5210******************************************************************
  5211*
  5212 01  CONTROL-FILE.
  5213     12  CF-RECORD-ID                       PIC XX.
  5214         88  VALID-CF-ID                        VALUE 'CF'.
  5215
  5216     12  CF-CONTROL-PRIMARY.
  5217         16  CF-COMPANY-ID                  PIC XXX.
  5218         16  CF-RECORD-TYPE                 PIC X.
  5219             88  CF-COMPANY-MASTER              VALUE '1'.
  5220             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5221             88  CF-STATE-MASTER                VALUE '3'.
  5222             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5223             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5224             88  CF-CARRIER-MASTER              VALUE '6'.
  5225             88  CF-MORTALITY-MASTER            VALUE '7'.
  5226             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  98
* EL050.cbl
  5227             88  CF-TERMINAL-MASTER             VALUE '9'.
  5228             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5229             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5230             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5231             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5232             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5233             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5234             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5235             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5236             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5237         16  CF-ACCESS-CD-GENL              PIC X(4).
  5238         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5239             20  CF-PROCESSOR               PIC X(4).
  5240         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5241             20  CF-STATE-CODE              PIC XX.
  5242             20  FILLER                     PIC XX.
  5243         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5244             20  FILLER                     PIC XX.
  5245             20  CF-HI-BEN-IN-REC           PIC XX.
  5246         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5247             20  FILLER                     PIC XXX.
  5248             20  CF-CARRIER-CNTL            PIC X.
  5249         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5250             20  FILLER                     PIC XX.
  5251             20  CF-HI-TYPE-IN-REC          PIC 99.
  5252         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5253             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5254                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5255             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5256             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5257         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5258             20  FILLER                     PIC X.
  5259             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5260         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5261             20  FILLER                     PIC XX.
  5262             20  CF-MORTGAGE-PLAN           PIC XX.
  5263         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5264
  5265     12  CF-LAST-MAINT-DT                   PIC XX.
  5266     12  CF-LAST-MAINT-BY                   PIC X(4).
  5267     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5268
  5269     12  CF-RECORD-BODY                     PIC X(728).
  5270
  5271
  5272****************************************************************
  5273*             COMPANY MASTER RECORD                            *
  5274****************************************************************
  5275
  5276     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5277         16  CF-COMPANY-ADDRESS.
  5278             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5279             20  CF-CL-IN-CARE-OF           PIC X(30).
  5280             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5281             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5282             20  CF-CL-CITY-STATE           PIC X(30).
  5283             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5284             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page  99
* EL050.cbl
  5285         16  CF-COMPANY-CD                  PIC X.
  5286         16  CF-COMPANY-PASSWORD            PIC X(8).
  5287         16  CF-SECURITY-OPTION             PIC X.
  5288             88  ALL-SECURITY                   VALUE '1'.
  5289             88  COMPANY-VERIFY                 VALUE '2'.
  5290             88  PROCESSOR-VERIFY               VALUE '3'.
  5291             88  NO-SECURITY                    VALUE '4'.
  5292             88  ALL-BUT-TERM                   VALUE '5'.
  5293         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5294             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5295         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5296             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5297         16  CF-INFORCE-LOCATION            PIC X.
  5298             88  CERTS-ARE-ONLINE               VALUE '1'.
  5299             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5300             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5301         16  CF-LOWER-CASE-LETTERS          PIC X.
  5302         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5303             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5304             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5305             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5306             88  CF-ACCNT-CNTL                  VALUE '3'.
  5307             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5308
  5309         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5310         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5311
  5312         16  CF-LGX-CREDIT-USER             PIC X.
  5313             88  CO-IS-NOT-USER                 VALUE 'N'.
  5314             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5315
  5316         16 CF-CREDIT-CALC-CODES.
  5317             20  CF-CR-REM-TERM-CALC PIC X.
  5318               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5319               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5320               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5321               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5322               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5323               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5324               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5325             20  CF-CR-R78-METHOD           PIC X.
  5326               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5327               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5328
  5329         16  CF-CLAIM-CONTROL-COUNTS.
  5330             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5331                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5332
  5333             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5334                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5335
  5336             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5337                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5338
  5339             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5340                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5341
  5342         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 100
* EL050.cbl
  5343
  5344         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5345             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5346             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5347             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5348             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5349                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5350                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5351             20  CF-CO-PREM-REJECT-SW       PIC X.
  5352                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5353                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5354             20  CF-CO-REF-REJECT-SW        PIC X.
  5355                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5356                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5357
  5358         16  CF-CO-REPORTING-DT             PIC XX.
  5359         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5360         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5361           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5362           88  CF-CO-MONTH-END                  VALUE '1'.
  5363
  5364         16  CF-LGX-CLAIM-USER              PIC X.
  5365             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5366             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5367
  5368         16  CF-CREDIT-EDIT-CONTROLS.
  5369             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5370             20  CF-MIN-AGE                 PIC 99.
  5371             20  CF-DEFAULT-AGE             PIC 99.
  5372             20  CF-MIN-TERM                PIC S999      COMP-3.
  5373             20  CF-MAX-TERM                PIC S999      COMP-3.
  5374             20  CF-DEFAULT-SEX             PIC X.
  5375             20  CF-JOINT-AGE-INPUT         PIC X.
  5376                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5377             20  CF-BIRTH-DATE-INPUT        PIC X.
  5378                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5379             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5380                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5381                 88  CF-ZERO-CARRIER            VALUE '1'.
  5382                 88  CF-ZERO-GROUPING           VALUE '2'.
  5383                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5384             20  CF-EDIT-SW                 PIC X.
  5385                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5386             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5387             20  CF-CR-PR-METHOD            PIC X.
  5388               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5389               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5390             20  FILLER                     PIC X.
  5391
  5392         16  CF-CREDIT-MISC-CONTROLS.
  5393             20  CF-REIN-TABLE-SW           PIC X.
  5394                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5395             20  CF-COMP-TABLE-SW           PIC X.
  5396                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5397             20  CF-EXPERIENCE-RETENTION-AGE
  5398                                            PIC S9        COMP-3.
  5399             20  CF-CONVERSION-DT           PIC XX.
  5400             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 101
* EL050.cbl
  5401             20  CF-RUN-FREQUENCY-SW        PIC X.
  5402                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5403                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5404
  5405             20  CF-CR-CHECK-NO-CONTROL.
  5406                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5407                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5408                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5409                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5410                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5411                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5412
  5413                 24  CF-CR-CHECK-COUNT       REDEFINES
  5414                     CF-CR-CHECK-COUNTER      PIC X(4).
  5415
  5416                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5417                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5418
  5419                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5420                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5421                 24  CF-MAIL-PROCESSING       PIC X.
  5422                     88  MAIL-PROCESSING          VALUE 'Y'.
  5423
  5424         16  CF-MISC-SYSTEM-CONTROL.
  5425             20  CF-SYSTEM-C                 PIC X.
  5426                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5427             20  CF-SYSTEM-D                 PIC X.
  5428                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5429             20  CF-SOC-SEC-NO-SW            PIC X.
  5430                 88  SOC-SEC-NO-USED             VALUE '1'.
  5431             20  CF-MEMBER-NO-SW             PIC X.
  5432                 88  MEMBER-NO-USED              VALUE '1'.
  5433             20  CF-TAX-ID-NUMBER            PIC X(11).
  5434             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5435             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5436                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5437                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5438                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5439                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5440             20  CF-SYSTEM-E                 PIC X.
  5441                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5442
  5443         16  CF-LGX-LIFE-USER               PIC X.
  5444             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5445             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5446
  5447         16  CF-CR-MONTH-END-DT             PIC XX.
  5448
  5449         16  CF-FILE-MAINT-DATES.
  5450             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5451                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5452             20  CF-LAST-BATCH       REDEFINES
  5453                 CF-LAST-BATCH-NO               PIC X(4).
  5454             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5455             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5456             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5457             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5458             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 102
* EL050.cbl
  5459             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5460             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5461             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5462             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5463             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5464
  5465         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5466         16  FILLER                         PIC X.
  5467
  5468         16  CF-ALT-MORT-CODE               PIC X(4).
  5469         16  CF-MEMBER-CAPTION              PIC X(10).
  5470
  5471         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5472             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5473             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5474             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5475             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5476             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5477
  5478         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5479
  5480         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5481         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5482         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5483         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5484
  5485         16  CF-AH-OVERRIDE-L1              PIC X.
  5486         16  CF-AH-OVERRIDE-L2              PIC XX.
  5487         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5488         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5489
  5490         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5491         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5492
  5493         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5494         16  CF-AR-LAST-EL860-DT            PIC XX.
  5495         16  CF-MP-MONTH-END-DT             PIC XX.
  5496
  5497         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5498         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5499             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5500
  5501         16  CF-AR-MONTH-END-DT             PIC XX.
  5502
  5503         16  CF-CRDTCRD-USER                PIC X.
  5504             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5505             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5506
  5507         16  CF-CC-MONTH-END-DT             PIC XX.
  5508
  5509         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5510
  5511         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5512             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5513             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5514             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5515         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5516         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 103
* EL050.cbl
  5517         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5518         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5519             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5520             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5521         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5522         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5523         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5524             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5525         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5526
  5527         16  CF-CL-ZIP-CODE.
  5528             20  CF-CL-ZIP-PRIME.
  5529                 24  CF-CL-ZIP-1ST          PIC X.
  5530                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5531                 24  FILLER                 PIC X(4).
  5532             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5533         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5534             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5535             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5536             20  FILLER                     PIC XXX.
  5537
  5538         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5539         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5540         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5541         16  CF-CO-OPTION-START-DATE        PIC XX.
  5542         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5543           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5544                                                      '3' '4'.
  5545           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5546           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5547           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5548           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5549           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5550           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5551
  5552         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5553
  5554         16  CF-PAYMENT-APPROVAL-LEVELS.
  5555             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5556             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5557             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5558             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5559             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5560             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5561
  5562         16  CF-END-USER-REPORTING-USER     PIC X.
  5563             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5564             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5565
  5566         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5567             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5568             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5569
  5570         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5571
  5572         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5573         16  FILLER                         PIC X.
  5574
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 104
* EL050.cbl
  5575         16  CF-CREDIT-ARCHIVE-CNTL.
  5576             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5577             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5578             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5579
  5580         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5581
  5582         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5583             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5584             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5585
  5586         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5587             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5588             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5589
  5590         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5591
  5592         16  CF-CO-ACH-ID-CODE              PIC  X.
  5593             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5594             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5595             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5596         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5597         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5598         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5599         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5600         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5601         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5602         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5603         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5604         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5605                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5606         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5607                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5608
  5609         16  CF-CO-OVER-SHORT.
  5610             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5611             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5612
  5613*         16  FILLER                         PIC X(102).
  5614         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5615             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5616             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5617
  5618         16  CF-AH-APPROVAL-DAYS.
  5619             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5620             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5621             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5622             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5623
  5624         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5625
  5626         16  CF-APPROV-LEV-5.
  5627             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5628             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5629             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5630
  5631         16  FILLER                         PIC X(68).
  5632****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 105
* EL050.cbl
  5633*             PROCESSOR/USER RECORD                            *
  5634****************************************************************
  5635
  5636     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5637         16  CF-PROCESSOR-NAME              PIC X(30).
  5638         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5639         16  CF-PROCESSOR-TITLE             PIC X(26).
  5640         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5641                 88  MESSAGE-YES                VALUE 'Y'.
  5642                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5643
  5644*****************************************************
  5645****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5646****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5647****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5648****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5649*****************************************************
  5650
  5651         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5652             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5653             20  CF-APPLICATION-FORCE       PIC X.
  5654             20  CF-INDIVIDUAL-APP.
  5655                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5656                     28  CF-BROWSE-APP      PIC X.
  5657                     28  CF-UPDATE-APP      PIC X.
  5658
  5659         16  CF-CURRENT-TERM-ON             PIC X(4).
  5660         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5661             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5662             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5663             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5664             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5665             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5666             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5667             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5668         16  CF-PROCESSOR-CARRIER           PIC X.
  5669             88  NO-CARRIER-SECURITY            VALUE ' '.
  5670         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5671             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5672         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5673             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5674         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5675             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5676
  5677         16  CF-PROC-SYS-ACCESS-SW.
  5678             20  CF-PROC-CREDIT-CLAIMS-SW.
  5679                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5680                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5681                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5682                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5683             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5684                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5685                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5686             20  CF-PROC-LIFE-GNRLDGR-SW.
  5687                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5688                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5689                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5690                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 106
* EL050.cbl
  5691             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5692                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5693                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5694         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5695             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5696             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5697         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5698
  5699         16  CF-APPROVAL-LEVEL                  PIC X.
  5700             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5701             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5702             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5703             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5704             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5705
  5706         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5707
  5708         16  CF-LANGUAGE-TYPE                   PIC X.
  5709             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5710             88  CF-LANG-IS-FR                      VALUE 'F'.
  5711
  5712         16  CF-CSR-IND                         PIC X.
  5713         16  FILLER                             PIC X(239).
  5714
  5715****************************************************************
  5716*             PROCESSOR/REMINDERS RECORD                       *
  5717****************************************************************
  5718
  5719     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5720         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5721             20  CF-START-REMIND-DT         PIC XX.
  5722             20  CF-END-REMIND-DT           PIC XX.
  5723             20  CF-REMINDER-TEXT           PIC X(50).
  5724         16  FILLER                         PIC X(296).
  5725
  5726
  5727****************************************************************
  5728*             STATE MASTER RECORD                              *
  5729****************************************************************
  5730
  5731     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5732         16  CF-STATE-ABBREVIATION          PIC XX.
  5733         16  CF-STATE-NAME                  PIC X(25).
  5734         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5735         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5736             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5737             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5738             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5739             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5740                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5741                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5742             20  CF-ST-PREM-REJECT-SW       PIC X.
  5743                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5744                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5745             20  CF-ST-REF-REJECT-SW        PIC X.
  5746                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5747                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5748         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 107
* EL050.cbl
  5749         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5750         16  CF-ST-REFUND-RULES.
  5751             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5752             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5753             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5754         16  CF-ST-FST-PMT-EXTENSION.
  5755             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5756             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5757                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5758                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5759                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5760                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5761         16  CF-ST-STATE-CALL.
  5762             20  CF-ST-CALL-UNEARNED        PIC X.
  5763             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5764             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5765         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5766             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5767             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5768         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5769         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5770         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5771         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5772         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5773         16  FILLER                         PIC X.
  5774         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5775             20  CF-ST-BENEFIT-CD           PIC XX.
  5776             20  CF-ST-BENEFIT-KIND         PIC X.
  5777                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5778                 88  CF-ST-AH-KIND              VALUE 'A'.
  5779             20  CF-ST-REM-TERM-CALC        PIC X.
  5780                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5781                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5782                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5783                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5784                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5785                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5786                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5787                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5788
  5789             20  CF-ST-REFUND-CALC          PIC X.
  5790                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5791                 88  ST-REFD-BY-R78             VALUE '1'.
  5792                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5793                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5794                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5795                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5796                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5797                 88  ST-REFD-UTAH               VALUE '7'.
  5798                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5799                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5800                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5801
  5802             20  CF-ST-EARNING-CALC         PIC X.
  5803                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5804                 88  ST-EARN-BY-R78             VALUE '1'.
  5805                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5806                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 108
* EL050.cbl
  5807                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5808                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5809                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5810                 88  ST-EARN-MEAN               VALUE '8'.
  5811                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5812
  5813             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5814                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5815                 88  ST-OVRD-BY-R78             VALUE '1'.
  5816                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5817                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5818                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5819                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5820                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5821                 88  ST-OVRD-MEAN               VALUE '8'.
  5822                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5823             20  cf-st-extra-periods        pic 9.
  5824*            20  FILLER                     PIC X.
  5825
  5826         16  CF-ST-COMMISSION-CAPS.
  5827             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5828             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5829             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5830             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5831         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5832                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5833                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5834                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5835
  5836         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5837
  5838         16  CF-ST-STATUTORY-INTEREST.
  5839             20  CF-ST-STAT-DATE-FROM       PIC X.
  5840                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5841                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5842             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5843             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5844             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5845             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5846             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5847
  5848         16  CF-ST-OVER-SHORT.
  5849             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5850             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5851
  5852         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5853
  5854         16  CF-ST-RT-CALC                  PIC X.
  5855
  5856         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5857         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5858         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5859         16  CF-ST-RF-LR-CALC               PIC X.
  5860         16  CF-ST-RF-LL-CALC               PIC X.
  5861         16  CF-ST-RF-LN-CALC               PIC X.
  5862         16  CF-ST-RF-AH-CALC               PIC X.
  5863         16  CF-ST-RF-CP-CALC               PIC X.
  5864*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 109
* EL050.cbl
  5865*CIDMOD         16  FILLER                         PIC X(192).
  5866         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5867             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5868         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5869         16  CF-ST-VFY-2ND-BENE             PIC X.
  5870         16  CF-ST-CAUSAL-STATE             PIC X.
  5871         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5872         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5873         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5874             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5875         16  CF-ST-NET-ONLY-STATE           PIC X.
  5876             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5877         16  cf-commission-cap-required     pic x.
  5878         16  CF-ST-GA-COMMISSION-CAPS.
  5879             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5880             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5881             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5882             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5883         16  CF-ST-TOT-COMMISSION-CAPS.
  5884             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5885             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5886             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5887             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5888         16  FILLER                         PIC X(156).
  5889
  5890****************************************************************
  5891*             BENEFIT MASTER RECORD                            *
  5892****************************************************************
  5893
  5894     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5895         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5896             20  CF-BENEFIT-CODE            PIC XX.
  5897             20  CF-BENEFIT-NUMERIC  REDEFINES
  5898                 CF-BENEFIT-CODE            PIC XX.
  5899             20  CF-BENEFIT-ALPHA           PIC XXX.
  5900             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5901             20  CF-BENEFIT-COMMENT         PIC X(10).
  5902
  5903             20  CF-LF-COVERAGE-TYPE        PIC X.
  5904                 88  CF-REDUCING                VALUE 'R'.
  5905                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5906
  5907             20  CF-SPECIAL-CALC-CD         PIC X.
  5908                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5909                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5910                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5911                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5912                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5913                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5914                 88  CF-FARM-PLAN               VALUE 'F'.
  5915                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5916                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5917                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5918                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5919                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5920                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5921                 88  CF-PRUDENTIAL              VALUE 'P'.
  5922                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 110
* EL050.cbl
  5923                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5924                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5925                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5926                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5927                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5928
  5929             20  CF-JOINT-INDICATOR         PIC X.
  5930                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5931
  5932*            20  FILLER                     PIC X(12).
  5933             20  cf-maximum-benefits        pic s999 comp-3.
  5934             20  FILLER                     PIC X(09).
  5935             20  CF-BENEFIT-CATEGORY        PIC X.
  5936             20  CF-LOAN-TYPE               PIC X(8).
  5937
  5938             20  CF-CO-REM-TERM-CALC        PIC X.
  5939                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5940                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5941                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5942                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5943                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5944
  5945             20  CF-CO-EARNINGS-CALC        PIC X.
  5946                 88  CO-EARN-BY-R78             VALUE '1'.
  5947                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5948                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5949                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5950                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5951                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5952                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5953                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5954
  5955             20  CF-CO-REFUND-CALC          PIC X.
  5956                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5957                 88  CO-REFD-BY-R78             VALUE '1'.
  5958                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5959                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5960                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5961                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5962                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5963                 88  CO-REFD-MEAN               VALUE '8'.
  5964                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5965                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5966                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5967
  5968             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5969                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5970                 88  CO-OVRD-BY-R78             VALUE '1'.
  5971                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5972                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5973                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5974                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5975                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5976                 88  CO-OVRD-MEAN               VALUE '8'.
  5977                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5978
  5979             20  CF-CO-BEN-I-G-CD           PIC X.
  5980                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 111
* EL050.cbl
  5981                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5982                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5983
  5984         16  FILLER                         PIC X(304).
  5985
  5986
  5987****************************************************************
  5988*             CARRIER MASTER RECORD                            *
  5989****************************************************************
  5990
  5991     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5992         16  CF-ADDRESS-DATA.
  5993             20  CF-MAIL-TO-NAME            PIC X(30).
  5994             20  CF-IN-CARE-OF              PIC X(30).
  5995             20  CF-ADDRESS-LINE-1          PIC X(30).
  5996             20  CF-ADDRESS-LINE-2          PIC X(30).
  5997             20  CF-CITY-STATE              PIC X(30).
  5998             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5999             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6000
  6001         16  CF-CLAIM-NO-CONTROL.
  6002             20  CF-CLAIM-NO-METHOD         PIC X.
  6003                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6004                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6005                 88  CLAIM-NO-SEQ               VALUE '3'.
  6006                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6007             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6008                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6009                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6010                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6011
  6012         16  CF-CHECK-NO-CONTROL.
  6013             20  CF-CHECK-NO-METHOD         PIC X.
  6014                 88  CHECK-NO-MANUAL            VALUE '1'.
  6015                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6016                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6017                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6018             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6019                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6020
  6021         16  CF-DOMICILE-STATE              PIC XX.
  6022
  6023         16  CF-EXPENSE-CONTROLS.
  6024             20  CF-EXPENSE-METHOD          PIC X.
  6025                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6026                 88  DOLLARS-PER-PMT            VALUE '2'.
  6027                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6028                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6029             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6030             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6031
  6032         16  CF-CORRESPONDENCE-CONTROL.
  6033             20  CF-LETTER-RESEND-OPT       PIC X.
  6034                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6035                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6036             20  FILLER                     PIC X(4).
  6037
  6038         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 112
* EL050.cbl
  6039             20  CF-MANUAL-SW               PIC X.
  6040                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6041             20  CF-FUTURE-SW               PIC X.
  6042                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6043             20  CF-PTC-SW                  PIC X.
  6044                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6045             20  CF-IBNR-SW                 PIC X.
  6046                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6047             20  CF-PTC-LF-SW               PIC X.
  6048                 88  CF-LF-PTC-USED             VALUE '1'.
  6049             20  CF-CDT-ACCESS-METHOD       PIC X.
  6050                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6051                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6052                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6053             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6054
  6055         16  CF-CLAIM-CALC-METHOD           PIC X.
  6056             88  360-PLUS-MONTHS                VALUE '1'.
  6057             88  365-PLUS-MONTHS                VALUE '2'.
  6058             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6059             88  360-DAILY                      VALUE '4'.
  6060             88  365-DAILY                      VALUE '5'.
  6061
  6062         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6063         16  FILLER                         PIC X(11).
  6064
  6065         16  CF-LIMIT-AMOUNTS.
  6066             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6067             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6068             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6069             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6070             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6071             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6072             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6073             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6074             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6075             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6076
  6077         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6078         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6079         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6080
  6081         16  CF-ZIP-CODE.
  6082             20  CF-ZIP-PRIME.
  6083                 24  CF-ZIP-1ST             PIC X.
  6084                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6085                 24  FILLER                 PIC X(4).
  6086             20  CF-ZIP-PLUS4               PIC X(4).
  6087         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6088             20  CF-CAN-POSTAL-1            PIC XXX.
  6089             20  CF-CAN-POSTAL-2            PIC XXX.
  6090             20  FILLER                     PIC XXX.
  6091
  6092         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6093         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6094         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6095
  6096         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 113
* EL050.cbl
  6097             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6098             88  CF-NO-RATING                   VALUE 'N'.
  6099
  6100         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6101
  6102         16  CF-CARRIER-OVER-SHORT.
  6103             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6104             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6105
  6106         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6107         16  CF-SECPAY-SWITCH               PIC X.
  6108             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6109             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6110         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6111         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6112         16  FILLER                         PIC X(444).
  6113*        16  FILLER                         PIC X(452).
  6114
  6115
  6116****************************************************************
  6117*             MORTALITY MASTER RECORD                          *
  6118****************************************************************
  6119
  6120     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6121         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6122                                INDEXED BY CF-MORT-NDX.
  6123             20  CF-MORT-TABLE              PIC X(5).
  6124             20  CF-MORT-TABLE-TYPE         PIC X.
  6125                 88  CF-MORT-JOINT              VALUE 'J'.
  6126                 88  CF-MORT-SINGLE             VALUE 'S'.
  6127                 88  CF-MORT-COMBINED           VALUE 'C'.
  6128                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6129                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6130             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6131             20  CF-MORT-AGE-METHOD         PIC XX.
  6132                 88  CF-AGE-LAST                VALUE 'AL'.
  6133                 88  CF-AGE-NEAR                VALUE 'AN'.
  6134             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6135             20  CF-MORT-ADJUSTMENT-DIRECTION
  6136                                            PIC X.
  6137                 88  CF-MINUS                   VALUE '-'.
  6138                 88  CF-PLUS                    VALUE '+'.
  6139             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6140             20  CF-MORT-JOINT-CODE         PIC X.
  6141                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6142             20  CF-MORT-PC-Q               PIC X.
  6143                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6144             20  CF-MORT-TABLE-CODE         PIC X(4).
  6145             20  CF-MORT-COMMENTS           PIC X(15).
  6146             20  FILLER                     PIC X(14).
  6147
  6148         16  FILLER                         PIC X(251).
  6149
  6150
  6151****************************************************************
  6152*             BUSSINESS TYPE MASTER RECORD                     *
  6153****************************************************************
  6154
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 114
* EL050.cbl
  6155     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6156* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6157* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6158* AND RECORD 05 IS TYPES 81-99
  6159         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6160             20  CF-BUSINESS-TITLE          PIC  X(19).
  6161             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6162                                            PIC S9V9(4) COMP-3.
  6163             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6164             20  FILLER                     PIC  X.
  6165         16  FILLER                         PIC  X(248).
  6166
  6167
  6168****************************************************************
  6169*             TERMINAL MASTER RECORD                           *
  6170****************************************************************
  6171
  6172     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6173
  6174         16  CF-COMPANY-TERMINALS.
  6175             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6176                                  PIC X(4).
  6177         16  FILLER               PIC X(248).
  6178
  6179
  6180****************************************************************
  6181*             LIFE EDIT MASTER RECORD                          *
  6182****************************************************************
  6183
  6184     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6185         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6186             20  CF-LIFE-CODE-IN            PIC XX.
  6187             20  CF-LIFE-CODE-OUT           PIC XX.
  6188         16  FILLER                         PIC X(248).
  6189
  6190
  6191****************************************************************
  6192*             AH EDIT MASTER RECORD                            *
  6193****************************************************************
  6194
  6195     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6196         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6197             20  CF-AH-CODE-IN              PIC XXX.
  6198             20  CF-AH-CODE-OUT             PIC XX.
  6199         16  FILLER                         PIC X(248).
  6200
  6201
  6202****************************************************************
  6203*             CREDIBILITY TABLES                               *
  6204****************************************************************
  6205
  6206     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6207         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6208                             INDEXED BY CF-CRDB-NDX.
  6209             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6210             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6211             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6212         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 115
* EL050.cbl
  6213
  6214
  6215****************************************************************
  6216*             REPORT CUSTOMIZATION RECORD                      *
  6217****************************************************************
  6218
  6219     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6220         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6221             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6222             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6223             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6224**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6225****       A T-TRANSFER.                                   ****
  6226             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6227
  6228         16  FILLER                         PIC XX.
  6229
  6230         16  CF-CARRIER-CNTL-OPT.
  6231             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6232                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6233                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6234             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6235                                            PIC X.
  6236         16  CF-GROUP-CNTL-OPT.
  6237             20  CF-GROUP-OPT-SEQ           PIC 9.
  6238                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6239                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6240             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6241                                            PIC X(6).
  6242         16  CF-STATE-CNTL-OPT.
  6243             20  CF-STATE-OPT-SEQ           PIC 9.
  6244                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6245                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6246             20  CF-STATE-SELECT OCCURS 3 TIMES
  6247                                            PIC XX.
  6248         16  CF-ACCOUNT-CNTL-OPT.
  6249             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6250                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6251                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6252             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6253                                            PIC X(10).
  6254         16  CF-BUS-TYP-CNTL-OPT.
  6255             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6256                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6257                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6258             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6259                                            PIC XX.
  6260         16  CF-LF-TYP-CNTL-OPT.
  6261             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6262                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6263                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6264             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6265                                            PIC XX.
  6266         16  CF-AH-TYP-CNTL-OPT.
  6267             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6268                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6269                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6270             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 116
* EL050.cbl
  6271                                            PIC XX.
  6272         16  CF-REPTCD1-CNTL-OPT.
  6273             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6274                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6275                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6276             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6277                                            PIC X(10).
  6278         16  CF-REPTCD2-CNTL-OPT.
  6279             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6280                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6281                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6282             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6283                                            PIC X(10).
  6284         16  CF-USER1-CNTL-OPT.
  6285             20  CF-USER1-OPT-SEQ           PIC 9.
  6286                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6287                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6288             20  CF-USER1-SELECT OCCURS 3 TIMES
  6289                                            PIC X(10).
  6290         16  CF-USER2-CNTL-OPT.
  6291             20  CF-USER2-OPT-SEQ           PIC 9.
  6292                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6293                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6294             20  CF-USER2-SELECT OCCURS 3 TIMES
  6295                                            PIC X(10).
  6296         16  CF-USER3-CNTL-OPT.
  6297             20  CF-USER3-OPT-SEQ           PIC 9.
  6298                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6299                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6300             20  CF-USER3-SELECT OCCURS 3 TIMES
  6301                                            PIC X(10).
  6302         16  CF-USER4-CNTL-OPT.
  6303             20  CF-USER4-OPT-SEQ           PIC 9.
  6304                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6305                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6306             20  CF-USER4-SELECT OCCURS 3 TIMES
  6307                                            PIC X(10).
  6308         16  CF-USER5-CNTL-OPT.
  6309             20  CF-USER5-OPT-SEQ           PIC 9.
  6310                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6311                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6312             20  CF-USER5-SELECT OCCURS 3 TIMES
  6313                                            PIC X(10).
  6314         16  CF-REINS-CNTL-OPT.
  6315             20  CF-REINS-OPT-SEQ           PIC 9.
  6316                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6317                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6318             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6319                 24  CF-REINS-PRIME         PIC XXX.
  6320                 24  CF-REINS-SUB           PIC XXX.
  6321
  6322         16  CF-AGENT-CNTL-OPT.
  6323             20  CF-AGENT-OPT-SEQ           PIC 9.
  6324                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6325                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6326             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6327                                            PIC X(10).
  6328
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 117
* EL050.cbl
  6329         16  FILLER                         PIC X(43).
  6330
  6331         16  CF-LOSS-RATIO-SELECT.
  6332             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6333             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6334         16  CF-ENTRY-DATE-SELECT.
  6335             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6336             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6337         16  CF-EFFECTIVE-DATE-SELECT.
  6338             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6339             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6340
  6341         16  CF-EXCEPTION-LIST-IND          PIC X.
  6342             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6343
  6344         16  FILLER                         PIC X(318).
  6345
  6346****************************************************************
  6347*                  EXCEPTION REPORTING RECORD                  *
  6348****************************************************************
  6349
  6350     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6351         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6352             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6353
  6354         16  CF-COMBINED-LIFE-AH-OPT.
  6355             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6356             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6357             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6358             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6359
  6360         16  CF-LIFE-OPT.
  6361             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6362             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6363             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6364             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6365             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6366             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6367             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6368             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6369             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6370             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6371
  6372         16  CF-AH-OPT.
  6373             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6374             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6375             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6376             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6377             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6378             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6379             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6380             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6381             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6382             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6383
  6384         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6385             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6386             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 118
* EL050.cbl
  6387             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6388
  6389         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6390
  6391         16  FILLER                         PIC X(673).
  6392
  6393
  6394****************************************************************
  6395*             MORTGAGE SYSTEM PLAN RECORD                      *
  6396****************************************************************
  6397
  6398     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6399         16  CF-PLAN-TYPE                   PIC X.
  6400             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6401             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6402             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6403         16  CF-PLAN-ABBREV                 PIC XXX.
  6404         16  CF-PLAN-DESCRIPT               PIC X(10).
  6405         16  CF-PLAN-NOTES                  PIC X(20).
  6406         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6407         16  CF-PLAN-UNDERWRITING.
  6408             20  CF-PLAN-TERM-DATA.
  6409                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6410                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6411             20  CF-PLAN-AGE-DATA.
  6412                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6413                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6414                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6415             20  CF-PLAN-BENEFIT-DATA.
  6416                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6417                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6418                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6419                                            PIC S9(7)V99  COMP-3.
  6420         16  CF-PLAN-POLICY-FORMS.
  6421             20  CF-POLICY-FORM             PIC X(12).
  6422             20  CF-MASTER-APPLICATION      PIC X(12).
  6423             20  CF-MASTER-POLICY           PIC X(12).
  6424         16  CF-PLAN-RATING.
  6425             20  CF-RATE-CODE               PIC X(5).
  6426             20  CF-SEX-RATING              PIC X.
  6427                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6428                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6429             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6430             20  CF-SUB-STD-TYPE            PIC X.
  6431                 88  CF-PCT-OF-PREM            VALUE '1'.
  6432                 88  CF-PCT-OF-BENE            VALUE '2'.
  6433         16  CF-PLAN-PREM-TOLERANCES.
  6434             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6435             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6436         16  CF-PLAN-PYMT-TOLERANCES.
  6437             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6438             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6439         16  CF-PLAN-MISC-DATA.
  6440             20  FILLER                     PIC X.
  6441             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6442             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6443         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6444         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 119
* EL050.cbl
  6445             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6446                                                     '1'.
  6447             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6448                                                     '2'.
  6449         16  CF-MIB-SEARCH-SW               PIC X.
  6450             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6451             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6452             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6453             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6454         16  CF-ALPHA-SEARCH-SW             PIC X.
  6455             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6456             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6457             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6458             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6459             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6460             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6461             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6462             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6463             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6464             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6465                                                     'A' 'B' 'C'
  6466                                                     'X' 'Y' 'Z'.
  6467         16  CF-EFF-DT-RULE-SW              PIC X.
  6468             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6469             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6470             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6471             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6472             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6473         16  FILLER                         PIC X(4).
  6474         16  CF-HEALTH-QUESTIONS            PIC X.
  6475             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6476         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6477         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6478         16  CF-PLAN-SNGL-JNT               PIC X.
  6479             88  CF-COMBINED-PLAN              VALUE 'C'.
  6480             88  CF-JNT-PLAN                   VALUE 'J'.
  6481             88  CF-SNGL-PLAN                  VALUE 'S'.
  6482         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6483         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6484         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6485         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6486         16  CF-RERATE-CNTL                 PIC  X.
  6487             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6488             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6489             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6490             88  CF-AUTO-RECALC                 VALUE '4'.
  6491         16  CF-BENEFIT-TYPE                PIC  X.
  6492             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6493             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6494         16  CF-POLICY-FEE                  PIC S999V99
  6495                                                    COMP-3.
  6496         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6497         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6498         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6499         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6500         16  FILLER                         PIC  X(32).
  6501         16  CF-TERMINATION-FORM            PIC  X(04).
  6502         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 120
* EL050.cbl
  6503         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6504                                                       COMP-3.
  6505         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6506         16  CF-ISSUE-LETTER                PIC  X(4).
  6507         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6508         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6509             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6510             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6511         16  CF-MP-REFUND-CALC              PIC X.
  6512             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6513             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6514             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6515             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6516             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6517             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6518             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6519             88  CF-MP-REFD-MEAN                VALUE '8'.
  6520         16  CF-ALT-RATE-CODE               PIC  X(5).
  6521
  6522
  6523         16  FILLER                         PIC X(498).
  6524****************************************************************
  6525*             MORTGAGE COMPANY MASTER RECORD                   *
  6526****************************************************************
  6527
  6528     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6529         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6530         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6531             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6532             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6533             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6534             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6535             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6536
  6537         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6538         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6539         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6540         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6541         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6542
  6543         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6544             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6545         16  CF-MP-RECON-USE-IND            PIC X(1).
  6546             88  CF-MP-USE-RECON             VALUE 'Y'.
  6547         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6548             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6549         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6550             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6551             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6552         16  FILLER                         PIC X(1).
  6553         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6554             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6555         16  CF-MORTG-MIB-VERSION           PIC X.
  6556             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6557             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6558             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6559         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6560             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 121
* EL050.cbl
  6561                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6562             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6563                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6564             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6565                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6566             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6567                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6568             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6569                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6570             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6571                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6572         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6573         16  FILLER                         PIC X(7).
  6574         16  CF-MORTG-DESTINATION-SYMBOL.
  6575             20  CF-MORTG-MIB-COMM          PIC X(5).
  6576             20  CF-MORTG-MIB-TERM          PIC X(5).
  6577         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6578             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6579         16  FILLER                         PIC X(03).
  6580         16  CF-MP-CHECK-NO-CONTROL.
  6581             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6582                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6583                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6584                                                ' ' LOW-VALUES.
  6585                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6586                                               VALUE '3'.
  6587         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6588         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6589         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6590             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6591                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6592             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6593                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6594             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6595                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6596             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6597                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6598             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6599                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6600             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6601                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6602         16  CF-MORTG-BILLING-AREA.
  6603             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6604                                            PIC X.
  6605         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6606         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6607         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6608         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6609             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6610             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6611         16  FILLER                         PIC X.
  6612         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6613             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6614             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6615         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6616         16  FILLER                         PIC X(8).
  6617         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6618         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 122
* EL050.cbl
  6619         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6620         16  CF-ACH-COMPANY-ID.
  6621             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6622                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6623                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6624                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6625             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6626         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6627             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6628         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6629             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6630             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6631         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6632         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6633         16  FILLER                         PIC X(536).
  6634
  6635****************************************************************
  6636*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6637****************************************************************
  6638
  6639     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6640         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6641             20  CF-FEMALE-HEIGHT.
  6642                 24  CF-FEMALE-FT           PIC 99.
  6643                 24  CF-FEMALE-IN           PIC 99.
  6644             20  CF-FEMALE-MIN-WT           PIC 999.
  6645             20  CF-FEMALE-MAX-WT           PIC 999.
  6646         16  FILLER                         PIC X(428).
  6647
  6648     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6649         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6650             20  CF-MALE-HEIGHT.
  6651                 24  CF-MALE-FT             PIC 99.
  6652                 24  CF-MALE-IN             PIC 99.
  6653             20  CF-MALE-MIN-WT             PIC 999.
  6654             20  CF-MALE-MAX-WT             PIC 999.
  6655         16  FILLER                         PIC X(428).
  6656******************************************************************
  6657*             AUTOMATIC ACTIVITY RECORD                          *
  6658******************************************************************
  6659     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6660         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6661             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6662             20  CF-SYS-LETTER-ID           PIC X(04).
  6663             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6664             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6665             20  CF-SYS-RESET-SW            PIC X(01).
  6666             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6667             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6668
  6669         16  FILLER                         PIC X(50).
  6670
  6671         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6672             20  CF-USER-ACTIVE-SW          PIC X(01).
  6673             20  CF-USER-LETTER-ID          PIC X(04).
  6674             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6675             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6676             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 123
* EL050.cbl
  6677             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6678             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6679             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6680
  6681         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 124
* EL050.cbl
  6683*    COPY ERCACCT.
  6684******************************************************************
  6685*                                                                *
  6686*                                                                *
  6687*                            ERCACCT                             *
  6688*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6689*                            VMOD=2.031                          *
  6690*                                                                *
  6691*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6692*                                                                *
  6693*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6694*   VSAM ACCOUNT MASTER FILES.                                   *
  6695*                                                                *
  6696*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6697*                                                                *
  6698*   FILE TYPE = VSAM,KSDS                                        *
  6699*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6700*                                                                *
  6701*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6702*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6703*                                                                *
  6704*   LOG = NO                                                     *
  6705*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6706*                                                                *
  6707*                                                                *
  6708******************************************************************
  6709*                   C H A N G E   L O G
  6710*
  6711* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6712*-----------------------------------------------------------------
  6713*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6714* EFFECTIVE    NUMBER
  6715*-----------------------------------------------------------------
  6716* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6717* 092705    2005050300006  PEMA  ADD SPP LEASES
  6718* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6719* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6720* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6721* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6722* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6723* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6724******************************************************************
  6725
  6726 01  ACCOUNT-MASTER.
  6727     12  AM-RECORD-ID                      PIC XX.
  6728         88  VALID-AM-ID                      VALUE 'AM'.
  6729
  6730     12  AM-CONTROL-PRIMARY.
  6731         16  AM-COMPANY-CD                 PIC X.
  6732         16  AM-MSTR-CNTRL.
  6733             20  AM-CONTROL-A.
  6734                 24  AM-CARRIER            PIC X.
  6735                 24  AM-GROUPING.
  6736                     28 AM-GROUPING-PREFIX PIC XXX.
  6737                     28 AM-GROUPING-PRIME  PIC XXX.
  6738                 24  AM-STATE              PIC XX.
  6739                 24  AM-ACCOUNT.
  6740                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 125
* EL050.cbl
  6741                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6742             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6743                                           PIC X(19).
  6744             20  AM-CNTRL-B.
  6745                 24  AM-EXPIRATION-DT      PIC XX.
  6746                 24  FILLER                PIC X(4).
  6747             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6748                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6749
  6750     12  AM-CONTROL-BY-VAR-GRP.
  6751         16  AM-COMPANY-CD-A1              PIC X.
  6752         16  AM-VG-CARRIER                 PIC X.
  6753         16  AM-VG-GROUPING                PIC X(6).
  6754         16  AM-VG-STATE                   PIC XX.
  6755         16  AM-VG-ACCOUNT                 PIC X(10).
  6756         16  AM-VG-DATE.
  6757             20  AM-VG-EXPIRATION-DT       PIC XX.
  6758             20  FILLER                    PIC X(4).
  6759         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6760                                           PIC 9(11)      COMP-3.
  6761     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6762         16  FILLER                        PIC X(10).
  6763         16  AM-VG-KEY3.
  6764             20  AM-VG3-ACCOUNT            PIC X(10).
  6765             20  AM-VG3-EXP-DT             PIC XX.
  6766         16  FILLER                        PIC X(4).
  6767     12  AM-MAINT-INFORMATION.
  6768         16  AM-LAST-MAINT-DT              PIC XX.
  6769         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6770         16  AM-LAST-MAINT-USER            PIC X(4).
  6771         16  FILLER                        PIC XX.
  6772
  6773     12  AM-EFFECTIVE-DT                   PIC XX.
  6774     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6775
  6776     12  AM-PREV-DATES  COMP-3.
  6777         16  AM-PREV-EXP-DT                PIC 9(11).
  6778         16  AM-PREV-EFF-DT                PIC 9(11).
  6779
  6780     12  AM-REPORT-CODE-1                  PIC X(10).
  6781     12  AM-REPORT-CODE-2                  PIC X(10).
  6782
  6783     12  AM-CITY-CODE                      PIC X(4).
  6784     12  AM-COUNTY-PARISH                  PIC X(6).
  6785
  6786     12  AM-NAME                           PIC X(30).
  6787     12  AM-PERSON                         PIC X(30).
  6788     12  AM-ADDRS                          PIC X(30).
  6789     12  AM-CITY.
  6790         16  AM-ADDR-CITY                  PIC X(28).
  6791         16  AM-ADDR-STATE                 PIC XX.
  6792     12  AM-ZIP.
  6793         16  AM-ZIP-PRIME.
  6794             20  AM-ZIP-PRI-1ST            PIC X.
  6795                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6796             20  FILLER                    PIC X(4).
  6797         16  AM-ZIP-PLUS4                  PIC X(4).
  6798     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 126
* EL050.cbl
  6799         16  AM-CAN-POSTAL-1               PIC XXX.
  6800         16  AM-CAN-POSTAL-2               PIC XXX.
  6801         16  FILLER                        PIC XXX.
  6802     12  AM-TEL-NO.
  6803         16  AM-AREA-CODE                  PIC 999.
  6804         16  AM-TEL-PRE                    PIC 999.
  6805         16  AM-TEL-NBR                    PIC 9(4).
  6806     12  AM-TEL-LOC                        PIC X.
  6807         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6808         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6809
  6810     12  AM-COMM-STRUCTURE.
  6811         16  AM-DEFN-1.
  6812             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6813                 24  AM-AGT.
  6814                     28  AM-AGT-PREFIX     PIC X(4).
  6815                     28  AM-AGT-PRIME      PIC X(6).
  6816                 24  AM-COM-TYP            PIC X.
  6817                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6818                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6819                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6820                 24  AM-RECALC-LV-INDIC    PIC X.
  6821                 24  AM-RETRO-LV-INDIC     PIC X.
  6822                 24  AM-GL-CODES           PIC X.
  6823                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6824                 24  FILLER                PIC X(01).
  6825         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6826             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6827                 24  FILLER                PIC X(11).
  6828                 24  AM-L-COMA             PIC XXX.
  6829                 24  AM-J-COMA             PIC XXX.
  6830                 24  AM-A-COMA             PIC XXX.
  6831                 24  FILLER                PIC X(6).
  6832
  6833     12  AM-COMM-CHANGE-STATUS             PIC X.
  6834         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6835
  6836     12  AM-CSR-CODE                       PIC X(4).
  6837
  6838     12  AM-BILLING-STATUS                 PIC X.
  6839         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6840         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6841     12  AM-AUTO-REFUND-SW                 PIC X.
  6842         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6843         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6844     12  AM-GPCD                           PIC 99.
  6845     12  AM-IG                             PIC X.
  6846         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6847         88  AM-HAS-GROUP                     VALUE '2'.
  6848     12  AM-STATUS                         PIC X.
  6849         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6850         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6851         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6852         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6853         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6854         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6855         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6856         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 127
* EL050.cbl
  6857         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6858         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6859     12  AM-REMIT-TO                       PIC 99.
  6860     12  AM-ID-NO                          PIC X(11).
  6861
  6862     12  AM-CAL-TABLE                      PIC XX.
  6863     12  AM-LF-DEVIATION                   PIC XXX.
  6864     12  AM-AH-DEVIATION                   PIC XXX.
  6865     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6866     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6867     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6868     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6869     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6870     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6871
  6872     12  AM-USER-FIELDS.
  6873         16  AM-FLD-1                      PIC XX.
  6874         16  AM-FLD-2                      PIC XX.
  6875         16  AM-FLD-3                      PIC XX.
  6876         16  AM-FLD-4                      PIC XX.
  6877         16  AM-FLD-5                      PIC XX.
  6878
  6879     12  AM-1ST-PROD-DATE.
  6880         16  AM-1ST-PROD-YR                PIC XX.
  6881         16  AM-1ST-PROD-MO                PIC XX.
  6882         16  AM-1ST-PROD-DA                PIC XX.
  6883     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6884     12  AM-CERTS-PURGED-DATE.
  6885         16  AM-PUR-YR                     PIC XX.
  6886         16  AM-PUR-MO                     PIC XX.
  6887         16  AM-PUR-DA                     PIC XX.
  6888     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6889     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6890     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6891     12  AM-INACTIVE-DATE.
  6892         16  AM-INA-MO                     PIC 99.
  6893         16  AM-INA-DA                     PIC 99.
  6894         16  AM-INA-YR                     PIC 99.
  6895     12  AM-AR-HI-CERT-DATE                PIC XX.
  6896
  6897     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6898     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6899
  6900     12  AM-OB-PAYMENT-MODE                PIC X.
  6901         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6902         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6903         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6904         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6905
  6906     12  AM-AH-ONLY-INDICATOR              PIC X.
  6907         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6908         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6909
  6910     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6911
  6912     12  AM-OVER-SHORT.
  6913         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6914         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 128
* EL050.cbl
  6915
  6916     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6917     12  AM-DCC-CLP-STATE                  PIC XX.
  6918
  6919     12  AM-RECALC-COMM                    PIC X.
  6920     12  AM-RECALC-REIN                    PIC X.
  6921
  6922     12  AM-REI-TABLE                      PIC XXX.
  6923     12  AM-REI-ET-LF                      PIC X.
  6924     12  AM-REI-ET-AH                      PIC X.
  6925     12  AM-REI-PE-LF                      PIC X.
  6926     12  AM-REI-PE-AH                      PIC X.
  6927     12  AM-REI-PRT-ST                     PIC X.
  6928     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6929     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6930     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6931     12  AM-REI-GROUP-A                    PIC X(6).
  6932     12  AM-REI-MORT                       PIC X(4).
  6933     12  AM-REI-PRT-OW                     PIC X.
  6934     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6935     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6936     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6937     12  AM-REI-GROUP-B                    PIC X(6).
  6938
  6939     12  AM-TRUST-TYPE                     PIC X(2).
  6940
  6941     12  AM-EMPLOYER-STMT-USED             PIC X.
  6942     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6943
  6944     12  AM-STD-AH-TYPE                    PIC XX.
  6945     12  AM-EARN-METHODS.
  6946         16  AM-EARN-METHOD-R              PIC X.
  6947             88 AM-REF-RL-R78                 VALUE 'R'.
  6948             88 AM-REF-RL-PR                  VALUE 'P'.
  6949             88 AM-REF-RL-MEAN                VALUE 'M'.
  6950             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6951         16  AM-EARN-METHOD-L              PIC X.
  6952             88 AM-REF-LL-R78                 VALUE 'R'.
  6953             88 AM-REF-LL-PR                  VALUE 'P'.
  6954             88 AM-REF-LL-MEAN                VALUE 'M'.
  6955             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6956         16  AM-EARN-METHOD-A              PIC X.
  6957             88 AM-REF-AH-R78                 VALUE 'R'.
  6958             88 AM-REF-AH-PR                  VALUE 'P'.
  6959             88 AM-REF-AH-MEAN                VALUE 'M'.
  6960             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6961             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6962             88 AM-REF-AH-NET                 VALUE 'N'.
  6963
  6964     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6965     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6966     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6967
  6968     12  AM-RET-Y-N                        PIC X.
  6969     12  AM-RET-P-E                        PIC X.
  6970     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6971     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6972     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 129
* EL050.cbl
  6973     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6974         16  AM-POOL-PRIME                 PIC XXX.
  6975         16  AM-POOL-SUB                   PIC XXX.
  6976     12  AM-RETRO-EARNINGS.
  6977         16  AM-RET-EARN-R                 PIC X.
  6978         16  AM-RET-EARN-L                 PIC X.
  6979         16  AM-RET-EARN-A                 PIC X.
  6980     12  AM-RET-ST-TAX-USE                 PIC X.
  6981         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6982         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6983     12  AM-RETRO-BEG-EARNINGS.
  6984         16  AM-RET-BEG-EARN-R             PIC X.
  6985         16  AM-RET-BEG-EARN-L             PIC X.
  6986         16  AM-RET-BEG-EARN-A             PIC X.
  6987     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6988     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6989
  6990     12  AM-USER-SELECT-OPTIONS.
  6991         16  AM-USER-SELECT-1              PIC X(10).
  6992         16  AM-USER-SELECT-2              PIC X(10).
  6993         16  AM-USER-SELECT-3              PIC X(10).
  6994         16  AM-USER-SELECT-4              PIC X(10).
  6995         16  AM-USER-SELECT-5              PIC X(10).
  6996
  6997     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6998
  6999     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7000
  7001     12  AM-RPT045A-SWITCH                 PIC X.
  7002         88  RPT045A-OFF                   VALUE 'N'.
  7003
  7004     12  AM-INSURANCE-LIMITS.
  7005         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  7006         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  7007
  7008     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  7009         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  7010
  7011     12  AM-DISMBR-COVERAGE-SW             PIC X.
  7012         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  7013         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  7014
  7015     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  7016
  7017     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  7018     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  7019     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  7020     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  7021     12  AM-DCC-UEF-STATE                  PIC XX.
  7022     12  FILLER                            PIC XXX.
  7023     12  AM-REPORT-CODE-3                  PIC X(10).
  7024*    12  FILLER                            PIC X(22).
  7025
  7026     12  AM-RESERVE-DATE.
  7027         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  7028         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  7029         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  7030
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 130
* EL050.cbl
  7031     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  7032     12  AM-NOTIFICATION-TYPES.
  7033         16  AM-NOTIF-OF-LETTERS           PIC X.
  7034         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  7035         16  AM-NOTIF-OF-REPORTS           PIC X.
  7036         16  AM-NOTIF-OF-STATUS            PIC X.
  7037
  7038     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  7039         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  7040         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  7041         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  7042         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  7043
  7044     12  AM-BENEFIT-CONTROLS.
  7045         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  7046             20  AM-BENEFIT-CODE           PIC XX.
  7047             20  AM-BENEFIT-TYPE           PIC X.
  7048             20  AM-BENEFIT-REVISION       PIC XXX.
  7049             20  AM-BENEFIT-REM-TERM       PIC X.
  7050             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  7051             20  FILLER                    PIC XX.
  7052         16  FILLER                        PIC X(80).
  7053
  7054     12  AM-TRANSFER-DATA.
  7055         16  AM-TRANSFERRED-FROM.
  7056             20  AM-TRNFROM-CARRIER        PIC X.
  7057             20  AM-TRNFROM-GROUPING.
  7058                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7059                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7060             20  AM-TRNFROM-STATE          PIC XX.
  7061             20  AM-TRNFROM-ACCOUNT.
  7062                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7063                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7064             20  AM-TRNFROM-DTE            PIC XX.
  7065         16  AM-TRANSFERRED-TO.
  7066             20  AM-TRNTO-CARRIER          PIC X.
  7067             20  AM-TRNTO-GROUPING.
  7068                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7069                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7070             20  AM-TRNTO-STATE            PIC XX.
  7071             20  AM-TRNTO-ACCOUNT.
  7072                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7073                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7074             20  AM-TRNTO-DTE              PIC XX.
  7075         16  FILLER                        PIC X(10).
  7076
  7077     12  AM-SAVED-REMIT-TO                 PIC 99.
  7078
  7079     12  AM-COMM-STRUCTURE-SAVED.
  7080         16  AM-DEFN-1-SAVED.
  7081             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7082                 24  AM-AGT-SV             PIC X(10).
  7083                 24  AM-COM-TYP-SV         PIC X.
  7084                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7085                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7086                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7087                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7088                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 131
* EL050.cbl
  7089                 24  AM-GL-CODES-SV        PIC X.
  7090                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7091                 24  FILLER                PIC X.
  7092         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7093             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7094                 24  FILLER                PIC X(11).
  7095                 24  AM-L-COMA-SV          PIC XXX.
  7096                 24  AM-J-COMA-SV          PIC XXX.
  7097                 24  AM-A-COMA-SV          PIC XXX.
  7098                 24  FILLER                PIC X(6).
  7099
  7100     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7101         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7102            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7103            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7104            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7105
  7106     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7107     12  FILLER                            PIC X(120).
  7108
  7109     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7110         16  AM-CONTROL-NAME               PIC X(30).
  7111         16  AM-EXECUTIVE-ONE.
  7112             20  AM-EXEC1-NAME             PIC X(15).
  7113             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7114                                                          COMP-3.
  7115             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7116                                                          COMP-3.
  7117         16  AM-EXECUTIVE-TWO.
  7118             20  AM-EXEC2-NAME             PIC X(15).
  7119             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7120                                                          COMP-3.
  7121             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7122                                                          COMP-3.
  7123
  7124     12  AM-RETRO-ADDITIONAL-DATA.
  7125         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7126         16  AM-RETRO-PREM-P-E             PIC X.
  7127         16  AM-RETRO-CLMS-P-I             PIC X.
  7128         16  AM-RETRO-RET-BRACKET-LF.
  7129             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7130                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7131                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7132             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7133                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7134                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7135             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7136                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7137                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7138         16  AM-RETRO-RET-BRACKET-AH.
  7139             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7140                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7141                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7142                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7143             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7144                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7145                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7146             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 132
* EL050.cbl
  7147                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7148                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7149
  7150     12  AM-COMMENTS.
  7151         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7152
  7153     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7154         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7155         16  AM-FLI-BILLING-CODE           PIC X.
  7156         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7157         16  AM-FLI-UNITED-IDENT           PIC X.
  7158         16  AM-FLI-INTEREST-LOST-DATA.
  7159             20  AM-FLI-BANK-NO            PIC X(5).
  7160             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7161             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7162             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7163         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7164             20  AM-FLI-AGT                PIC X(9).
  7165             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7166             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7167         16  FILLER                        PIC X(102).
  7168
  7169     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7170         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7171             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7172             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7173             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7174             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7175             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7176         16  FILLER                          PIC X(10).
  7177******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 133
* EL050.cbl
  7179*    COPY ERCREIN.
  7180******************************************************************
  7181*                                                                *
  7182*                            ERCREIN                             *
  7183*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7184*                            VMOD=2.010                          *
  7185*                                                                *
  7186*   ONLINE CREDIT SYSTEM                                         *
  7187*                                                                *
  7188*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7189*                                                                *
  7190*   FILE TYPE = VSAM,KSDS                                        *
  7191*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7192*                                                                *
  7193*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7194*       ALTERNATE PATH = NONE                                    *
  7195*                                                                *
  7196*   LOG = NO                                                     *
  7197*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7198*                                                                *
  7199******************************************************************
  7200*                   C H A N G E   L O G
  7201*
  7202* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7203*-----------------------------------------------------------------
  7204*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7205* EFFECTIVE    NUMBER
  7206*-----------------------------------------------------------------
  7207* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7208* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7209******************************************************************
  7210 01  REINSURANCE-RECORD.
  7211     12  RE-RECORD-ID                      PIC XX.
  7212         88  VALID-RE-ID                      VALUE 'RE'.
  7213
  7214     12  RE-CONTROL-PRIMARY.
  7215         16  RE-COMPANY-CD                 PIC X.
  7216         16  RE-KEY.
  7217             20  RE-CODE                   PIC X.
  7218                 88  RE-TABLE-RECORD          VALUE 'A'.
  7219                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7220             20  RE-TABLE                  PIC XXX.
  7221             20  FILLER                    PIC XXX.
  7222         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7223             20  FILLER                    PIC X.
  7224             20  RE-COMPANY.
  7225                 24  RE-COMP-PRIME         PIC XXX.
  7226                 24  RE-COMP-SUB           PIC XXX.
  7227
  7228     12  RE-MAINT-INFORMATION.
  7229         16  RE-LAST-MAINT-DT              PIC XX.
  7230         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7231         16  RE-LAST-MAINT-USER            PIC X(4).
  7232         16  FILLER                        PIC X(10).
  7233
  7234     12  RE-TABLE-DATA.
  7235         16  RE-100-COMP                   PIC 99.
  7236
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 134
* EL050.cbl
  7237         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7238             20  RE-REI-COMP-NO.
  7239                 24  RE-REI-COMP           PIC XXX.
  7240                 24  RE-REI-COMP-SUB       PIC XXX.
  7241             20  RE-LF-QC                  PIC X.
  7242             20  RE-AH-QC                  PIC X.
  7243             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7244             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7245             20  RE-LFAGE-LO               PIC 99.
  7246             20  RE-LFAGE-HI               PIC 99.
  7247             20  RE-AHAGE-LO               PIC 99.
  7248             20  RE-AHAGE-HI               PIC 99.
  7249             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7250             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7251             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7252             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7253             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7254             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7255             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7256             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7257             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7258             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7259             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7260             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7261             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7262             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7263             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7264             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7265             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7266             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7267             20  RE-LF-BEN-CODE            PIC X.
  7268             20  RE-AH-BEN-CODE            PIC X.
  7269             20  RE-INTERACTIVE            PIC X.
  7270             20  RE-REMAINING              PIC X.
  7271             20  RE-LF-RUNOFF-SW           PIC X.
  7272             20  RE-AH-RUNOFF-SW           PIC X.
  7273             20  FILLER                    PIC X(19).
  7274
  7275         16  RE-COMP-INFO-END              PIC X(6).
  7276         16  RE-NSP-ST-CD-LF               PIC XX.
  7277         16  RE-NSP-ST-CD-AH               PIC XX.
  7278         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7279             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7280
  7281         16  FILLER                        PIC X(27).
  7282
  7283     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7284         16  RE-NAME                       PIC X(30).
  7285         16  RE-LF-PE                      PIC X.
  7286         16  RE-AH-PE                      PIC X.
  7287         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7288         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7289         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7290         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7291         16  RE-PRT-ST                     PIC X.
  7292         16  RE-PRT-OW                     PIC X.
  7293         16  RE-MORT-CODE                  PIC X(4).
  7294         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 135
* EL050.cbl
  7295         16  RE-ZERO-LF-FEE                PIC X.
  7296         16  RE-ZERO-AH-FEE                PIC X.
  7297         16  RE-CEDE-NAME                  PIC X(30).
  7298         16  RE-LF-COMM                    PIC X.
  7299         16  RE-AH-COMM                    PIC X.
  7300         16  RE-LF-TAX                     PIC X.
  7301         16  RE-AH-TAX                     PIC X.
  7302         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7303         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7304         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7305
  7306         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7307             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7308
  7309         16  RE-LF-CEDING-FEE-BRACKETS.
  7310             20  RE-LF-FEE-METHOD          PIC X.
  7311                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7312                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7313                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7314                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7315             20  RE-LF-FEE-BASIS           PIC X.
  7316                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7317                 88  RE-LF-NET-CEDED               VALUE '2'.
  7318                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7319                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7320                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7321                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7322                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7323                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7324             20  FILLER                    PIC XXX.
  7325             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7326                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7327                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7328
  7329         16  RE-AH-CEDING-FEE-BRACKETS.
  7330             20  RE-AH-FEE-METHOD          PIC X.
  7331                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7332                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7333                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7334                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7335             20  RE-AH-FEE-BASIS           PIC X.
  7336                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7337                 88  RE-AH-NET-CEDED               VALUE '2'.
  7338                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7339                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7340                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7341                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7342                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7343                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7344             20  FILLER                    PIC XXX.
  7345             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7346                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7347                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7348
  7349         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7350
  7351         16  RE-OLD-CEDING-STMT            PIC X.
  7352
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 136
* EL050.cbl
  7353         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7354         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7355         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7356         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7357         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7358         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7359         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7360         16  RE-MORT-SW                    PIC X.
  7361         16  RE-CEDING-TYPE-FLAG           PIC X.
  7362             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7363             88  RE-CEDED                          VALUE 'C'.
  7364             88  RE-ASSUMED                        VALUE 'A'.
  7365             88  RE-PHANTOM                        VALUE 'P'.
  7366
  7367         16  RE-CEDING-STMT-OPT-A          PIC X.
  7368             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7369         16  RE-CEDING-STMT-OPT-B          PIC X.
  7370             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7371         16  RE-CEDING-STMT-OPT-C          PIC X.
  7372             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7373         16  RE-CEDING-STMT-OPT-D          PIC X.
  7374             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7375         16  RE-CEDING-STMT-OPT-E          PIC X.
  7376             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7377
  7378         16  RE-PRT-CRSV                   PIC X.
  7379
  7380         16  RE-GL-CENTER                  PIC X(4).
  7381
  7382         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7383
  7384         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7385
  7386         16  RE-EARN-STOP-CODE             PIC X.
  7387             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7388             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7389
  7390         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7391             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7392
  7393         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7394         16  FILLER                        PIC X(2281).
  7395
  7396         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7397
  7398******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 137
* EL050.cbl
  7400*    COPY ERCCTBL.
  7401******************************************************************
  7402*                                                                *
  7403*                                                                *
  7404*                            ERCCTBL                             *
  7405*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7406*                            VMOD=2.003
  7407*                                                                *
  7408*   ONLINE CREDIT SYSTEM                                         *
  7409*                                                                *
  7410*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7411*                                                                *
  7412*   FILE TYPE = VSAM,KSDS                                        *
  7413*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7414*                                                                *
  7415*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7416*       ALTERNATE PATH = NONE                                    *
  7417*                                                                *
  7418*   LOG = NO                                                     *
  7419*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7420*                                                                *
  7421*                                                                *
  7422******************************************************************
  7423
  7424 01  COMM-TABLE-RECORD.
  7425     12  CT-RECORD-ID                      PIC XX.
  7426         88  VALID-CT-ID                      VALUE 'CT'.
  7427
  7428     12  CT-CONTROL-PRIMARY.
  7429         16  CT-COMPANY-CD                 PIC X.
  7430         16  CT-TABLE                      PIC XXX.
  7431         16  CT-CNTRL-2.
  7432             20  CT-BEN-TYPE               PIC X.
  7433             20  CT-BEN-CODE               PIC XX.
  7434
  7435     12  CT-MAINT-INFORMATION.
  7436         16  CT-LAST-MAINT-DT              PIC XX.
  7437         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7438         16  CT-LAST-MAINT-USER            PIC X(4).
  7439         16  FILLER                        PIC X(31).
  7440
  7441     12  CT-LIMITS.
  7442         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7443
  7444         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7445
  7446         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7447
  7448     12  CT-RATES.
  7449         16  CT-RTX          OCCURS 27 TIMES.
  7450             20  CT-RT                     PIC SV9(5)     COMP-3.
  7451             20  CT-RT-R   REDEFINES
  7452                 CT-RT                     PIC XXX.
  7453
  7454     12  FILLER                            PIC  X(42).
  7455
  7456******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 138
* EL050.cbl
  7458*    COPY ERCFORM.
  7459******************************************************************
  7460*                                                                *
  7461*                                                                *
  7462*                            ERCFORM.                            *
  7463*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7464*                            VMOD=2.003                          *
  7465*                                                                *
  7466*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7467*                                                                *
  7468*    FILE TYPE = VSAM,KSDS                                       *
  7469*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7470*                                                                *
  7471*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7472*                                                                *
  7473*    LOG = YES                                                   *
  7474*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7475******************************************************************
  7476 01  FORM-MASTER.
  7477    12  FO-RECORD-ID                 PIC X(02).
  7478        88  VALID-FO-ID                  VALUE 'FO'.
  7479
  7480    12  FO-CONTROL-PRIMARY.
  7481        16  FO-COMPANY-CD            PIC X(01).
  7482        16  FO-STATE                 PIC X(02).
  7483        16  FO-FORM-ID               PIC X(12).
  7484        16  FO-FORM-EXP-DT           PIC X(02).
  7485
  7486    12  FO-POLICY-FORM-DATA.
  7487        16  FO-IND-GRP-CD            PIC X(01).
  7488        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7489        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7490        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7491        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7492        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7493        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7494        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7495        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7496        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7497        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7498        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7499        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7500        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7501        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7502        16  FO-APP-CERT-USE-CD       PIC X(01).
  7503
  7504    12  FILLER                       PIC X(29).
  7505
  7506    12  FO-FORM-PLAN-TABLE.
  7507        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7508            20  FO-PLAN-TYPE         PIC X(01).
  7509            20  FO-PLAN-ID           PIC X(02).
  7510            20  FO-PLAN-TERM         PIC 9(03).
  7511            20  FO-PLAN-REFUND-METHOD
  7512                                     PIC X.
  7513
  7514    12  FILLER                       PIC X(30).
  7515
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 139
* EL050.cbl
  7516    12  FO-COMMENTS-AREA.
  7517        16  FO-COMMENT-LINE-1        PIC X(78).
  7518
  7519    12  FILLER                       PIC X(20).
  7520
  7521    12  FO-MAINT-INFORMATION.
  7522        16  FO-LAST-MAINT-DT         PIC X(02).
  7523        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7524        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 140
* EL050.cbl
  7526*    COPY ELCMSTR.
  7527******************************************************************
  7528*                                                                *
  7529*                            ELCMSTR.                            *
  7530*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7531*                            VMOD=2.012                          *
  7532*                                                                *
  7533*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7534*                                                                *
  7535*   FILE TYPE = VSAM,KSDS                                        *
  7536*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7537*                                                                *
  7538*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7539*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7540*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7541*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7542*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7543*                                                 RKP=75,LEN=21  *
  7544*                                                                *
  7545*   **** NOTE ****                                               *
  7546*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7547*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7548*                                                                *
  7549*   LOG = YES                                                    *
  7550*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7551******************************************************************
  7552*                   C H A N G E   L O G
  7553*
  7554* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7555*-----------------------------------------------------------------
  7556*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7557* EFFECTIVE    NUMBER
  7558*-----------------------------------------------------------------
  7559* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7560* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7561* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7562* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7563* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7564* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7565* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7566******************************************************************
  7567 01  CLAIM-MASTER.
  7568     12  CL-RECORD-ID                PIC XX.
  7569         88  VALID-CL-ID         VALUE 'CL'.
  7570
  7571     12  CL-CONTROL-PRIMARY.
  7572         16  CL-COMPANY-CD           PIC X.
  7573         16  CL-CARRIER              PIC X.
  7574         16  CL-CLAIM-NO             PIC X(7).
  7575         16  CL-CERT-NO.
  7576             20  CL-CERT-PRIME       PIC X(10).
  7577             20  CL-CERT-SFX         PIC X.
  7578
  7579     12  CL-CONTROL-BY-NAME.
  7580         16  CL-COMPANY-CD-A1        PIC X.
  7581         16  CL-INSURED-LAST-NAME    PIC X(15).
  7582         16  CL-INSURED-NAME.
  7583             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 141
* EL050.cbl
  7584             20  CL-INSURED-MID-INIT PIC X.
  7585
  7586     12  CL-CONTROL-BY-SSN.
  7587         16  CL-COMPANY-CD-A2        PIC X.
  7588         16  CL-SOC-SEC-NO.
  7589             20  CL-SSN-STATE        PIC XX.
  7590             20  CL-SSN-ACCOUNT      PIC X(6).
  7591             20  CL-SSN-LN3          PIC X(3).
  7592
  7593     12  CL-CONTROL-BY-CERT-NO.
  7594         16  CL-COMPANY-CD-A4        PIC X.
  7595         16  CL-CERT-NO-A4.
  7596             20  CL-CERT-A4-PRIME    PIC X(10).
  7597             20  CL-CERT-A4-SFX      PIC X.
  7598
  7599     12  CL-CONTROL-BY-CCN.
  7600         16  CL-COMPANY-CD-A5        PIC X.
  7601         16  CL-CCN-A5.
  7602             20  CL-CCN.
  7603                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7604                 24  CL-CCN-PRIME-A5 PIC X(12).
  7605             20  CL-CCN-FILLER-A5    PIC X(4).
  7606
  7607     12  CL-INSURED-PROFILE-DATA.
  7608         16  CL-INSURED-BIRTH-DT     PIC XX.
  7609         16  CL-INSURED-SEX-CD       PIC X.
  7610             88  INSURED-IS-MALE        VALUE 'M'.
  7611             88  INSURED-IS-FEMALE      VALUE 'F'.
  7612             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7613         16  CL-INSURED-OCC-CD       PIC X(6).
  7614         16  FILLER                  PIC X(5).
  7615
  7616     12  CL-PROCESSING-INFO.
  7617         16  CL-PROCESSOR-ID         PIC X(4).
  7618         16  CL-CLAIM-STATUS         PIC X.
  7619             88  CLAIM-IS-OPEN          VALUE 'O'.
  7620             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7621         16  CL-CLAIM-TYPE           PIC X.
  7622*            88  AH-CLAIM               VALUE 'A'.
  7623*            88  LIFE-CLAIM             VALUE 'L'.
  7624*            88  PROPERTY-CLAIM         VALUE 'P'.
  7625*            88  IUI-CLAIM              VALUE 'I'.
  7626*            88  GAP-CLAIM              VALUE 'G'.
  7627*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7628*            88  OTHER-CLAIM            VALUE 'O'.
  7629         16  CL-CLAIM-PREM-TYPE      PIC X.
  7630             88  SINGLE-PREMIUM         VALUE '1'.
  7631             88  O-B-COVERAGE           VALUE '2'.
  7632             88  OPEN-END-COVERAGE      VALUE '3'.
  7633         16  CL-INCURRED-DT          PIC XX.
  7634         16  CL-REPORTED-DT          PIC XX.
  7635         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7636         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7637         16  CL-LAST-PMT-DT          PIC XX.
  7638         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7639         16  CL-PAID-THRU-DT         PIC XX.
  7640         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7641         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 142
* EL050.cbl
  7642         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7643         16  CL-PMT-CALC-METHOD      PIC X.
  7644             88  CL-360-DAY-YR          VALUE '1'.
  7645             88  CL-365-DAY-YR          VALUE '2'.
  7646             88  CL-FULL-MONTHS         VALUE '3'.
  7647         16  CL-CAUSE-CD             PIC X(6).
  7648
  7649         16  CL-PRIME-CERT-NO.
  7650             20  CL-PRIME-CERT-PRIME PIC X(10).
  7651             20  CL-PRIME-CERT-SFX   PIC X.
  7652
  7653         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7654             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7655             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7656
  7657         16  CL-MICROFILM-NO         PIC X(10).
  7658         16  FILLER REDEFINES CL-MICROFILM-NO.
  7659             20  CL-BENEFIT-PERIOD   PIC 99.
  7660             20  FILLER              PIC X(8).
  7661         16  CL-PROG-FORM-TYPE       PIC X.
  7662         16  CL-LAST-ADD-ON-DT       PIC XX.
  7663
  7664         16  CL-LAST-REOPEN-DT       PIC XX.
  7665         16  CL-LAST-CLOSE-DT        PIC XX.
  7666         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7667             88  FINAL-PAID             VALUE '1'.
  7668             88  CLAIM-DENIED           VALUE '2'.
  7669             88  AUTO-CLOSE             VALUE '3'.
  7670             88  MANUAL-CLOSE           VALUE '4'.
  7671             88  BENEFITS-CHANGED       VALUE 'C'.
  7672             88  SETUP-ERRORS           VALUE 'E'.
  7673         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7674         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7675         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7676             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7677         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7678         16  FILLER                  PIC X.
  7679
  7680     12  CL-CERTIFICATE-DATA.
  7681         16  CL-CERT-ORIGIN          PIC X.
  7682             88  CERT-WAS-ONLINE        VALUE '1'.
  7683             88  CERT-WAS-CREATED       VALUE '2'.
  7684             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7685         16  CL-CERT-KEY-DATA.
  7686             20  CL-CERT-CARRIER     PIC X.
  7687             20  CL-CERT-GROUPING    PIC X(6).
  7688             20  CL-CERT-STATE       PIC XX.
  7689             20  CL-CERT-ACCOUNT.
  7690                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7691                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7692             20  CL-CERT-EFF-DT      PIC XX.
  7693
  7694     12  CL-STATUS-CONTROLS.
  7695         16  CL-PRIORITY-CD          PIC X.
  7696             88  CONFIDENTIAL-DATA      VALUE '8'.
  7697             88  HIGHEST-PRIORITY       VALUE '9'.
  7698         16  CL-SUPV-ATTN-CD         PIC X.
  7699             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 143
* EL050.cbl
  7700             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7701         16  CL-PURGED-DT            PIC XX.
  7702         16  CL-RESTORED-DT          PIC XX.
  7703         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7704         16  CL-NEXT-RESEND-DT       PIC XX.
  7705         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7706         16  CL-CRITICAL-PERIOD      PIC 99.
  7707*        16  FILLER                  PIC XX.
  7708         16  CL-LAST-MAINT-DT        PIC XX.
  7709         16  CL-LAST-MAINT-USER      PIC X(4).
  7710         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7711         16  CL-LAST-MAINT-TYPE      PIC X.
  7712             88  CLAIM-SET-UP           VALUE ' '.
  7713             88  PAYMENT-MADE           VALUE '1'.
  7714             88  LETTER-SENT            VALUE '2'.
  7715             88  MASTER-WAS-ALTERED     VALUE '3'.
  7716             88  MASTER-WAS-RESTORED    VALUE '4'.
  7717             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7718             88  FILE-CONVERTED         VALUE '6'.
  7719             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7720             88  ERROR-CORRECTION       VALUE 'E'.
  7721         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7722         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7723         16  CL-BENEFICIARY          PIC X(10).
  7724         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7725         16  CL-DENIAL-TYPE          PIC X.
  7726             88  CL-TYPE-DENIAL          VALUE '1'.
  7727             88  CL-TYPE-RESCISSION      VALUE '2'.
  7728             88  CL-TYPE-REFORMATION     VALUE '3'.
  7729             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7730             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7731         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7732         16  filler                  pic x(3).
  7733*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7734*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7735*        16  CL-RTW-DT               PIC XX.
  7736
  7737     12  CL-TRAILER-CONTROLS.
  7738         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7739             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7740             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7741             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7742         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7743         16  FILLER                  PIC XX.
  7744         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7745         16  CL-ADDRESS-TRAILER-CNT.
  7746             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7747                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7748             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7749                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7750             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7751                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7752             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7753                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7754             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7755                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7756             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7757                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 144
* EL050.cbl
  7758             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7759                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7760
  7761     12  CL-CV-REFERENCE-NO.
  7762         16  CL-CV-REFNO-PRIME       PIC X(18).
  7763         16  CL-CV-REFNO-SFX         PIC XX.
  7764
  7765     12  CL-FILE-LOCATION            PIC X(4).
  7766
  7767     12  CL-PROCESS-ERRORS.
  7768         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7769             88  NO-FATAL-ERRORS        VALUE ZERO.
  7770         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7771             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7772
  7773     12  CL-PRODUCT-CD               PIC X.
  7774
  7775     12  CL-CURRENT-KEY-DATA.
  7776         16  CL-CURRENT-CARRIER      PIC X.
  7777         16  CL-CURRENT-GROUPING     PIC X(6).
  7778         16  CL-CURRENT-STATE        PIC XX.
  7779         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7780
  7781     12  CL-ASSOCIATES               PIC X.
  7782         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7783         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7784         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7785         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7786
  7787     12  CL-ACTIVITY-CODE            PIC 99.
  7788     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7789     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7790
  7791     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7792     12  CL-LAG-REPORT-CODE          PIC 9.
  7793     12  CL-LOAN-TYPE                PIC XX.
  7794     12  CL-LEGAL-STATE              PIC XX.
  7795
  7796     12  CL-YESNOSW                  PIC X.
  7797     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7798         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7799         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7800         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7801     12  cl-insured-type             pic x.
  7802         88  cl-claim-on-primary         value 'P'.
  7803         88  cl-claim-on-co-borrower     value 'C'.
  7804     12  cl-benefit-expiration-dt    PIC XX.
  7805
  7806 01  PLAN-RECORDS.
  7807     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7808     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7809
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 145
* EL050.cbl
  7811 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7812                          ACCOUNT-MASTER REINSURANCE-RECORD
  7813                          COMM-TABLE-RECORD FORM-MASTER
  7814                          CLAIM-MASTER PLAN-RECORDS.
  7815 0000-DFHEXIT SECTION.
  7816     MOVE '9#                    $   ' TO DFHEIV0.
  7817     MOVE 'EL050' TO DFHEIV1.
  7818     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7819
  7820     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7821
  7822
  7823* EXEC CICS  HANDLE CONDITION
  7824*           ERROR    (9300-ABEND)
  7825*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7826*    END-EXEC.
  7827*    MOVE '"$.J                  ! " #00007818' TO DFHEIV0
  7828     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7830     MOVE X'2220233030303037383138' TO DFHEIV0(25:11)
  7831     CALL 'kxdfhei1' USING DFHEIV0
  7832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7833
  7834
  7835 0000-COPY-PROCEDURE-DIV.
  7836*                          COPY ELC50PD.
  7837******************************************************************
  7838*                                                                *
  7839*                            ELC50PD                             *
  7840*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7841*                            VMOD=2.188                          *
  7842*                                                                *
  7843******************************************************************
  7844*                   C H A N G E   L O G
  7845*
  7846* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7847*-----------------------------------------------------------------
  7848*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7849* EFFECTIVE    NUMBER
  7850*-----------------------------------------------------------------
  7851* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7852* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7853* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7854*                             2709 AND 2718
  7855* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7856* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7857* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7858* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7859* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7860*                                IS OPEN OR CNC DT < PD THRU
  7861* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7862* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7863* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7864* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7865* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7866* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7867* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7868* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 146
* EL050.cbl
  7869* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7870* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7871* 020906                   PEMA  EXPAND LOAN OFFICER
  7872* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7873* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7874* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7875* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7876* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7877* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7878* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7879* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7880* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7881* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7882* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7883* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7884* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7885* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7886* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7887* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7888* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7889* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7890* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7891* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7892* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7893* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7894* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7895* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7896* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7897*                                UPDATE VIN ON CERT TRAILER
  7898* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7899* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7900* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7901* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7902* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7903* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7904* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7905* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7906* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7907* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7908* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7909* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7910* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7911* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7912* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7913* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7914* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7915* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7916* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7917* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7918* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7919* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7920* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7921* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7922* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7923* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7924* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7925* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7926* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 147
* EL050.cbl
  7927* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7928* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7929* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7930* 032912  CR2011110200001  PEMA  AHL CHANGES
  7931* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7932* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7933* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7934* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7935* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7936* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7937* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7938* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7939* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7940* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7941* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7942* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7943* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7944* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7945* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7946* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7947* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7948* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7949* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7950* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7951* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7952* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7953* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7954* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7955* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7956* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7957* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7958*                                CERT #, ADD 2898 FORCIBLE ERROR
  7959* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7960* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7961* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7962* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7963* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7964* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7965* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7966* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7967* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7968* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7969* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7970* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7971* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7972* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7973* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7974* 100617  CR2017062000003  PEMA  New comm cap edits
  7975* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7976* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7977* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7978* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7979* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7980* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7981* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
  7982* 092118  CR2018073000001  PEMA  Add lf & ah refund method to ELCR
  7983******************************************************************
  7984************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 148
* EL050.cbl
  7985******************************************************************
  7986
  7987     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7988
  7989     MOVE SPACES                 TO PB-FATAL-FLAG
  7990                                    PB-FORCE-ER-CD
  7991                                    PB-WARN-ER-CD
  7992                                    PB-OUT-BAL-CD.
  7993
  7994     MOVE SPACE                  TO WS-IG-OVRD-AH
  7995                                    WS-IG-OVRD-LF
  7996                                    WS-IG-OVRD-AM
  7997                                    WS-IG-OVRD
  7998                                    WS-IG-OVRD-AH-PL
  7999                                    WS-IG-OVRD-LF-PL
  8000                                    WS-IG-OVRD-AH-BEN
  8001                                    WS-IG-OVRD-LF-BEN.
  8002
  8003******************************************************************
  8004*************       INITIALIZE COMMON ERRORS       ***************
  8005******************************************************************
  8006
  8007     MOVE +0                     TO PB-NO-OF-ERRORS.
  8008     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  8009
  8010******************************************************************
  8011
  8012     MOVE EIBDATE                TO DC-JULIAN-DATE.
  8013     SET JULIAN-TO-BIN           TO TRUE.
  8014*    MOVE 5                      TO DC-OPTION-CODE.
  8015     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8016     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  8017
  8018     MOVE ZERO                   TO  SUB4.
  8019
  8020 0040-INITIALIZE-GA-BILL-DT.
  8021
  8022     ADD +1                      TO  SUB4.
  8023
  8024     IF  SUB4 GREATER THAN +5
  8025         GO TO 0050-CHECK-CNTL-FOUND.
  8026
  8027     IF  PB-GA-BILL-DT (SUB4) = SPACES
  8028         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  8029
  8030     GO TO 0040-INITIALIZE-GA-BILL-DT.
  8031
  8032 0050-CHECK-CNTL-FOUND.
  8033
  8034     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  8035        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  8036                                         WS-AH-REM-TERM-CALC
  8037                                         EC-CO-REM-TERM-CALC
  8038        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  8039        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  8040        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  8041                                         WS-TOL-AH-CLAIM
  8042        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 149
* EL050.cbl
  8043                                         WS-TOL-AH-PREM
  8044                                         EC-CO-TOL-PREM
  8045        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  8046                                         WS-TOL-AH-REFUND
  8047                                         EC-CO-TOL-REFUND
  8048        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  8049                                         WS-AH-REFUND-OVS-AMT
  8050                                         EC-CO-OVR-SHT-AMT
  8051        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  8052                                         WS-TOL-AH-PREM-PCT
  8053                                         EC-CO-TOL-PREM-PCT
  8054        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  8055                                         WS-TOL-AH-REFUND-PCT
  8056                                         EC-CO-TOL-REFUND-PCT
  8057        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  8058                                         WS-AH-REFUND-OVS-PCT
  8059                                         EC-CO-OVR-SHT-PCT
  8060        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8061        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8062        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8063        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8064        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8065        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8066        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8067        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8068        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8069        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8070        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8071        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8072                                         EC-CO-MONTH-END-DT
  8073        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8074          GO TO 0100-READ-ACCT.
  8075
  8076     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8077     MOVE SPACES                 TO CNTL-ACCESS.
  8078     MOVE '1'                    TO CNTL-REC-TYPE.
  8079     MOVE +0                     TO CNTL-SEQ-NO.
  8080
  8081     MOVE '1' TO RC-SW-1.
  8082     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8083     IF NOT CF-COMPANY-MASTER
  8084         MOVE ZEROS             TO WK-CO-TOL-PREM
  8085                                   WK-CO-TOL-CLAIM
  8086                                   WK-CO-TOL-REFUND
  8087                                   WK-REFUND-OVS-AMT
  8088                                   WK-REFUND-OVS-PCT
  8089                                   WK-CO-TOL-PREM-PCT
  8090                                   WK-CO-TOL-REFUND-PCT
  8091                                   WK-DEFAULT-APR
  8092                                   WK-CO-MAX-CAP
  8093        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8094                                   WK-CR-R78-METHOD
  8095                                   WK-CO-REF-REJECT-SW
  8096                                   WK-CO-PREM-REJECT-SW
  8097                                   WK-REM-TRM-CALC-OPTION
  8098                                   WK-BIRTH-DATE-INPUT
  8099                                   WK-JOINT-AGE-INPUT
  8100        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 150
* EL050.cbl
  8101        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8102        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8103        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8104          GO TO 0099-COMPANY-NOT-FOUND.
  8105
  8106     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8107        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8108     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8109        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8110     IF CF-CO-TOL-CAP NOT NUMERIC
  8111        MOVE +0                    TO CF-CO-TOL-CAP.
  8112     IF CF-DEFAULT-APR NOT NUMERIC
  8113        MOVE +0                    TO CF-DEFAULT-APR.
  8114
  8115     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8116     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8117     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8118     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8119     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8120     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8121     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8122     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8123     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8124     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8125     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8126     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8127
  8128     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8129          CF-CO-OVR-SHT-AMT > +0
  8130        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8131
  8132     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8133          CF-CO-OVR-SHT-PCT > +0
  8134        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8135
  8136     IF CF-VALID-REM-TRM-OPTION
  8137         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8138     ELSE
  8139         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8140
  8141     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8142     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8143     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8144     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8145
  8146     GO TO 0050-CHECK-CNTL-FOUND.
  8147
  8148 0099-COMPANY-NOT-FOUND.
  8149
  8150     MOVE ER-2616                TO WS-ERROR.
  8151     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8152
  8153 0100-READ-ACCT.
  8154
  8155     MOVE SPACES                 TO DATE-RANGE-SW.
  8156
  8157     IF WK-ACCT-ADDR = ZEROS
  8158        GO TO 0102-ACCT-GETMAIN.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 151
* EL050.cbl
  8159
  8160     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8161     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8162     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8163
  8164     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8165        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8166        GO TO 0105-READ-ACCT
  8167     END-IF
  8168
  8169     IF PB-CARRIER NOT = SPACES
  8170        IF PB-CARRIER NOT = AM-VG-CARRIER
  8171           GO TO 0105-READ-ACCT.
  8172
  8173     IF PB-STATE NOT = SPACES
  8174        IF PB-STATE NOT = AM-VG-STATE
  8175           GO TO 0105-READ-ACCT.
  8176
  8177     IF PB-GROUPING NOT = SPACES
  8178        IF PB-GROUPING NOT = AM-VG-GROUPING
  8179           GO TO 0105-READ-ACCT.
  8180
  8181     MOVE 'X'                 TO DATE-RANGE-SW.
  8182
  8183     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8184        MOVE 'X'                 TO DATE-RANGE-SW
  8185        GO TO 0105-READ-ACCT.
  8186
  8187     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8188        GO TO 0105-READ-ACCT.
  8189
  8190     GO TO 0180-ACCOUNT-FOUND.
  8191
  8192 0102-ACCT-GETMAIN.
  8193     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8194     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8195
  8196 0105-READ-ACCT.
  8197     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8198     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8199     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8200     MOVE PB-STATE               TO ACCT-STATE.
  8201     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8202     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8203
  8204     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8205
  8206     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8207
  8208 0110-FIND-ACCT-TOLERANCES-LOOP.
  8209     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8210
  8211     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8212        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8213        GO TO 0199-ACCT-NOT-FOUND
  8214     END-IF
  8215     IF PB-CARRIER NOT = SPACES
  8216        IF PB-CARRIER NOT = AM-VG-CARRIER
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 152
* EL050.cbl
  8217           GO TO 0199-ACCT-NOT-FOUND.
  8218
  8219     IF PB-STATE NOT = SPACES
  8220        IF PB-STATE NOT = AM-VG-STATE
  8221           GO TO 0199-ACCT-NOT-FOUND.
  8222
  8223     IF PB-GROUPING NOT = SPACES
  8224        IF PB-GROUPING NOT = AM-VG-GROUPING
  8225           GO TO 0199-ACCT-NOT-FOUND.
  8226
  8227     MOVE 'X'                    TO DATE-RANGE-SW.
  8228
  8229     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8230        MOVE 'X'                 TO DATE-RANGE-SW
  8231        GO TO 0199-ACCT-NOT-FOUND.
  8232
  8233     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8234        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8235
  8236 0180-ACCOUNT-FOUND.
  8237     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8238     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8239     MOVE AM-STATE               TO PB-SV-STATE.
  8240     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8241
  8242     IF AM-CANCEL-FEE  NOT NUMERIC
  8243        MOVE ZEROS TO AM-CANCEL-FEE.
  8244
  8245     IF AM-MAX-MON-BEN NOT NUMERIC
  8246        MOVE ZEROS TO AM-MAX-MON-BEN.
  8247
  8248     IF AM-MAX-TOT-BEN NOT NUMERIC
  8249        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8250
  8251     IF AM-CLP-TOL-PCT NOT NUMERIC
  8252        MOVE +0                  TO AM-CLP-TOL-PCT
  8253     END-IF
  8254     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8255        MOVE +0                  TO AM-SPP-LEASE-COMM
  8256     END-IF
  8257     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8258        MOVE ER-2611             TO   WS-ERROR
  8259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8260
  8261     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8262        MOVE ER-2621             TO   WS-ERROR
  8263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8264
  8265     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8266        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8267        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8268        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8269         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8270
  8271     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8272     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8273     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8274     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 153
* EL050.cbl
  8275     IF AM-CLP-TOL-PCT NOT = ZEROS
  8276        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8277     END-IF
  8278     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8279        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8280     END-IF
  8281*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8282*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8283*                                   WS-ADMIN-FEES
  8284*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8285*          (SUB5 > +10)
  8286*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8287*             AND (AM-A-COM (SUB5) NUMERIC)
  8288*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8289*                + (AM-A-COM (SUB5) * 1000)
  8290*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8291*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8292*                + (AM-A-COM (SUB5) * 1000)
  8293*             END-IF
  8294*             IF AM-COM-TYP (SUB5) = 'N'
  8295*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8296*                + (AM-A-COM (SUB5) * 1000)
  8297*             END-IF
  8298*          END-IF
  8299*       END-PERFORM
  8300*    END-IF
  8301     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8302        AND (PB-ISSUE)
  8303        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8304                                    ws-cred-union-fees
  8305        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8306           (SUB5 > +10)
  8307           MOVE +0 TO WS-WK-RATE
  8308           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8309                                   'O' OR 'S')
  8310              IF (AM-A-COM (SUB5) NUMERIC)
  8311                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8312                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8313              ELSE
  8314                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8315                 IF PB-ISSUE
  8316                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8317                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8318                 ELSE
  8319                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8320                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8321                 END-IF
  8322                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8323                 MOVE ZEROS             TO WS-SUB1
  8324                                           WS-COMMISSION
  8325                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8326                 MOVE '0530'               TO CTBL-SW
  8327                 MOVE ' '                  TO WS-CTBL-READ-SW
  8328                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8329                 IF FIRST-TIME-THROUGH
  8330                    MOVE 'AA'              TO CTBL-BEN-CODE
  8331                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8332                 END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 154
* EL050.cbl
  8333                 IF CTBL-TABLE-FOUND
  8334                    IF PB-ISSUE
  8335                       COMPUTE WS-COMM-CK-AMT =
  8336                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8337                    ELSE
  8338                       COMPUTE WS-COMM-CK-AMT =
  8339                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8340                    END-IF
  8341                    PERFORM 8800-GET-COMP-RATE
  8342                              THRU 8800-EXIT
  8343                 END-IF
  8344              END-IF
  8345              if am-com-typ (sub5) = 'O' or 'S'
  8346                 compute ws-cred-union-fees rounded =
  8347                    ws-cred-union-fees +
  8348                    (pb-i-ah-premium-amt * ws-wk-rate)
  8349              else
  8350                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8351                + (WS-WK-RATE * 1000)
  8352              end-if
  8353           END-IF
  8354        END-PERFORM
  8355     END-IF
  8356     IF PB-COMPANY-ID EQUAL 'CRI'
  8357         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8358
  8359     IF PB-COMPANY-ID EQUAL 'NCL'
  8360         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8361     END-IF
  8362
  8363     GO TO 0200-READ-CERT.
  8364
  8365 0199-ACCT-NOT-FOUND.
  8366
  8367     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8368
  8369     IF DATE-RANGE-SW NOT = SPACES
  8370        MOVE ER-2601             TO WS-ERROR
  8371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8372     ELSE
  8373        MOVE ER-2619             TO WS-ERROR
  8374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8375
  8376     GO TO 9990-RETURN.
  8377
  8378 0200-READ-CERT.
  8379
  8380     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8381     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8382     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8383     MOVE PB-SV-STATE            TO CERT-STATE.
  8384     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8385     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8386     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8387
  8388     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8389
  8390     IF CERT-WAS-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 155
* EL050.cbl
  8391        GO TO 0299-CERT-NOT-FOUND.
  8392
  8393     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8394        MOVE ER-2759             TO WS-ERROR
  8395        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8396        GO TO 0298-UNLOCK-RETURN.
  8397
  8398     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8399         MOVE ER-2758            TO WS-ERROR
  8400         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8401         GO TO 0298-UNLOCK-RETURN.
  8402
  8403     IF PB-ISSUE
  8404        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8405           IF CERT-WAS-CREATED-FOR-CLAIM
  8406              NEXT SENTENCE
  8407            ELSE
  8408              MOVE ER-2626       TO WS-ERROR
  8409              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8410              GO TO 0298-UNLOCK-RETURN.
  8411
  8412     IF NOT PB-CANCELLATION
  8413        GO TO 0300-CONTINUE-EDIT.
  8414
  8415     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8416     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8417     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8418     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8419     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8420     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8421
  8422     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8423     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8424     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8425     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8426     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8427     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8428     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8429     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8430     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8431
  8432     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8433     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8434     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8435     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8436     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8437     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8438     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8439
  8440     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8441     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8442
  8443     MOVE CM-CREDIT-INTERFACE-SW-1
  8444                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8445     MOVE CM-CREDIT-INTERFACE-SW-2
  8446                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8447
  8448     IF CM-O-B-COVERAGE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 156
* EL050.cbl
  8449         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8450
  8451     IF CM-LIVES NOT NUMERIC
  8452         MOVE ZERO                TO CM-LIVES.
  8453
  8454     IF CM-BILLED NOT NUMERIC
  8455         MOVE ZERO                TO CM-BILLED.
  8456
  8457     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8458         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8459         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8460         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8461         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8462         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8463         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8464         MOVE CM-LIVES             TO PB-CI-LIVES
  8465*The next line causes a problem with my change  I dont think it is
  8466*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8467
  8468     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8469     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8470     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8471     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8472     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8473     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8474
  8475     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8476     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8477     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8478     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8479
  8480     IF CM-LIFE-COMM-PCT NUMERIC
  8481         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8482     ELSE
  8483         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8484
  8485     IF CM-AH-COMM-PCT NUMERIC
  8486         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8487     ELSE
  8488         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8489
  8490     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8491
  8492     IF CM-LOAN-APR       NOT NUMERIC
  8493           MOVE ZERO               TO CM-LOAN-APR.
  8494
  8495     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8496           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8497
  8498     IF CM-LOAN-TERM      NOT NUMERIC
  8499           MOVE ZERO               TO CM-LOAN-TERM.
  8500
  8501     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8502           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8503
  8504     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8505           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8506
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 157
* EL050.cbl
  8507     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8508     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8509     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8510     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8511     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8512     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8513     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8514     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8515     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8516     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8517     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8518     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8519     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8520
  8521     IF CM-STATE = CM-SSN-STATE
  8522         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8523
  8524     IF CM-STATE NOT = CM-MEMB-STATE
  8525         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8526
  8527     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8528
  8529     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8530*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8531        IF CM-ADDL-CLP NOT NUMERIC
  8532           MOVE +0               TO CM-ADDL-CLP
  8533        END-IF
  8534        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8535        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8536           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8537        END-IF
  8538     END-IF
  8539     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8540        MOVE +0                  TO WS-ADMIN-FEES
  8541                                    WS-CSO-ADMIN-FEE
  8542                                    WS-COMM-AND-MFEE
  8543                                    WS-1ST-YR-ALLOW
  8544        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8545           (SUB5 > +10)
  8546           MOVE +0 TO WS-WK-RATE
  8547           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8548              IF (AM-A-COM (SUB5) NUMERIC)
  8549                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8550                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8551              ELSE
  8552                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8553                 IF PB-ISSUE
  8554                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8555                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8556                 ELSE
  8557                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8558                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8559                 END-IF
  8560                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8561                 MOVE ZEROS             TO WS-SUB1
  8562                                           WS-COMMISSION
  8563                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8564                 MOVE '0530'               TO CTBL-SW
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 158
* EL050.cbl
  8565                 MOVE ' '                  TO WS-CTBL-READ-SW
  8566                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8567                 IF FIRST-TIME-THROUGH
  8568                    MOVE 'AA'              TO CTBL-BEN-CODE
  8569                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8570                 END-IF
  8571                 IF CTBL-TABLE-FOUND
  8572                    IF PB-ISSUE
  8573                       COMPUTE WS-COMM-CK-AMT =
  8574                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8575                    ELSE
  8576                       COMPUTE WS-COMM-CK-AMT =
  8577                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8578                    END-IF
  8579                    PERFORM 8800-GET-COMP-RATE
  8580                              THRU 8800-EXIT
  8581                 END-IF
  8582              END-IF
  8583              IF AM-COM-TYP (SUB5) = 'I'
  8584                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8585                   + (WS-WK-RATE * 1000)
  8586              END-IF
  8587              IF AM-COM-TYP (SUB5) = 'N'
  8588                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8589                   + (WS-WK-RATE * 1000)
  8590              END-IF
  8591              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8592                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8593                   + (WS-WK-RATE * 1000)
  8594              END-IF
  8595              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8596                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8597                   + (WS-WK-RATE * 1000)
  8598              END-IF
  8599           END-IF
  8600        END-PERFORM
  8601     END-IF
  8602     GO TO 0300-CONTINUE-EDIT.
  8603
  8604 0298-UNLOCK-RETURN.
  8605      PERFORM 9250-UNLOCK-RETURN
  8606      GO TO 9990-RETURN.
  8607
  8608 0299-CERT-NOT-FOUND.
  8609
  8610     MOVE '1'                     TO CERT-STATUS-SW.
  8611
  8612     IF PB-COMPANY-ID = 'UCL'
  8613         IF WS-ERROR = ER-2799
  8614             GO TO 3000-CONTINUE-EDIT.
  8615
  8616     IF NOT PB-CANCELLATION
  8617         GO TO 0300-CONTINUE-EDIT.
  8618
  8619     MOVE ER-2726                  TO  WS-ERROR.
  8620     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8621     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8622     MOVE ZEROS                  TO PB-CI-INSURED-AGE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 159
* EL050.cbl
  8623                                    PB-CI-LF-TERM
  8624                                    PB-C-LF-REM-TERM
  8625                                    PB-CI-AH-TERM
  8626                                    PB-C-AH-REM-TERM
  8627                                    PB-CI-LF-BENEFIT-CD
  8628                                    PB-CI-LF-BENEFIT-AMT
  8629                                    PB-CI-LF-ALT-BENEFIT-AMT
  8630                                    PB-CI-LF-PREMIUM-AMT
  8631                                    PB-CI-LF-ALT-PREMIUM-AMT
  8632                                    PB-CI-AH-BENEFIT-CD
  8633                                    PB-CI-AH-BENEFIT-AMT
  8634                                    PB-CI-AH-PREMIUM-AMT
  8635                                    PB-CI-PAY-FREQUENCY
  8636                                    PB-CI-LOAN-APR
  8637                                    PB-CI-LOAN-TERM
  8638                                    PB-CI-LIFE-COMMISSION
  8639                                    PB-CI-AH-COMMISSION
  8640                                    PB-CI-CURR-SEQ
  8641                                    PB-CI-AH-CANCEL-AMT
  8642                                    PB-CI-LF-CANCEL-AMT
  8643                                    PB-CI-RATE-DEV-PCT-LF
  8644                                    PB-CI-RATE-DEV-PCT-AH
  8645                                    PB-CI-EXTENTION-DAYS
  8646                                    PB-CI-TERM-IN-DAYS
  8647                                    PB-CI-LIVES
  8648                                    PB-CI-LF-CRIT-PER
  8649                                    PB-CI-AH-CRIT-PER
  8650                                    PB-CI-ADDL-CLP
  8651                                    PB-CI-DDF-IU-RATE-UP.
  8652
  8653     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8654                                    PB-CI-AH-SETTLEMENT-DT
  8655                                    PB-CI-DEATH-DT
  8656                                    PB-CI-LF-PRIOR-CANCEL-DT
  8657                                    PB-CI-AH-PRIOR-CANCEL-DT
  8658                                    PB-CI-ENTRY-DT
  8659                                    PB-CI-LF-EXPIRE-DT
  8660                                    PB-CI-AH-EXPIRE-DT
  8661                                    PB-CI-LOAN-1ST-PMT-DT.
  8662
  8663     IF ACCOUNT-MAST-FOUND
  8664        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8665        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8666
  8667
  8668 0300-CONTINUE-EDIT.
  8669
  8670     IF PB-ISSUE
  8671        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8672            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8673
  8674     IF PB-ISSUE
  8675        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8676            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8677
  8678     IF PB-ISSUE
  8679       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8680          (AM-NO-AH-ONLY)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 160
* EL050.cbl
  8681           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8682               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8683                   MOVE ER-2679 TO WS-ERROR
  8684                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8685
  8686     IF PB-ISSUE
  8687        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8688        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8689        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8690     ELSE
  8691        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8692        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8693        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8694
  8695     MOVE 'N'                    TO PLAN-MASTER-SW
  8696                                    PLAN-MASTER-LIFE-SW
  8697                                    FORM-MASTER-SW
  8698                                    WS-APP-CERT-SW.
  8699
  8700     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8701                                    WS-PL-TOL-LF-REFUND
  8702                                    WS-PL-REF-OVS-AMT
  8703                                    WS-PL-TOL-LF-PREM-PCT
  8704                                    WS-PL-TOL-LF-REFUND-PCT
  8705                                    WS-PL-REF-OVS-PCT
  8706                                    WS-PL-TOL-LF-CLAIM.
  8707
  8708     IF PB-COMPANY-ID = 'NCL'
  8709       IF PB-ISSUE
  8710         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8711             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8712             IF FORM-MASTER-FOUND
  8713                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8714
  8715     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8716        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8717
  8718********************** MON CODE **********************
  8719     IF PB-COMPANY-ID = 'MON'
  8720     IF PB-ISSUE
  8721     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8722        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8723             PB-I-LOAN-APR = ZERO)
  8724               MOVE 14.0         TO PB-I-LOAN-APR.
  8725******************************************************
  8726
  8727     IF PB-COMPANY-ID = 'NCL'
  8728       IF PB-ISSUE
  8729           IF FORM-MASTER-FOUND
  8730             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8731                AM-DISMBR-COVERAGE
  8732                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8733                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8734                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8735                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8736                                           PB-I-LIFE-BENEFIT-CD.
  8737
  8738     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 161
* EL050.cbl
  8739
  8740     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8741         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8742         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8743         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8744         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8745         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8746           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8747             GO TO 0301-LIFE-BENEFIT-SEARCH
  8748         ELSE
  8749             NEXT SENTENCE
  8750     ELSE
  8751         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8752
  8753     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8754     MOVE '4'                    TO CNTL-REC-TYPE.
  8755     MOVE +0                     TO CNTL-SEQ-NO.
  8756     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8757
  8758     MOVE '1' TO RC-SW-2.
  8759     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8760
  8761     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8762        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8763         GO TO 0305-BENEFIT-NOT-FOUND.
  8764
  8765     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8766
  8767 0301-LIFE-BENEFIT-SEARCH.
  8768
  8769     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8770
  8771     IF NO-BENEFIT-FOUND
  8772        GO TO 0305-BENEFIT-NOT-FOUND.
  8773
  8774     IF WS-BEN-CD = '99'
  8775        GO TO 0305-BENEFIT-NOT-FOUND.
  8776
  8777     IF PB-COMPANY-ID = 'NCL'
  8778         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8779             GO TO 0304-LIFE-BENEFIT-FOUND.
  8780
  8781     MOVE +1                     TO SUB5.
  8782     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8783
  8784* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8785* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8786     IF PB-COMPANY-ID = 'DMD'
  8787         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8788
  8789 0302-EDIT-ACCT-LF-BENEFITS.
  8790
  8791     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8792        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8793           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8794                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8795           GO TO 03XX-GET-LIFE-ERPLAN.
  8796
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 162
* EL050.cbl
  8797     IF SUB5 LESS THAN +20
  8798        ADD +1                   TO SUB5
  8799        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8800
  8801     MOVE +1                     TO SUB5.
  8802
  8803     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8804        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8805
  8806 0303-EDIT-DMD-EXTRA-BENEFITS.
  8807
  8808     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8809        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8810           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8811                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8812           GO TO 03XX-GET-LIFE-ERPLAN.
  8813
  8814     IF SUB5 LESS THAN +30
  8815        ADD +1                   TO SUB5
  8816        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8817
  8818     MOVE +1                     TO SUB5.
  8819
  8820 03XX-EDIT-FOR-NINETY-LF.
  8821
  8822***************************************************************
  8823*                                                             *
  8824*    NINETY BENEFIT PLAN TYPES:                               *
  8825*                                                             *
  8826*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8827*      92 = ALL GROUP REDUCING BENEFITS                       *
  8828*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8829*      94 = ALL GROUP LEVEL BENEFITS                          *
  8830*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8831*           BENEFIT CONTROLS.                                 *
  8832*      99 = ALL BENEFITS                                      *
  8833*                                                             *
  8834***************************************************************
  8835
  8836     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8837                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8838
  8839     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8840       AND
  8841        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8842        GO TO 03XX-GET-LIFE-ERPLAN.
  8843
  8844     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8845       AND
  8846        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8847        IF CF-REDUCING (SUB3)
  8848           IF (PB-I-INDV-GRP-OVRD = 'I')
  8849              OR
  8850           ((AM-IG = '1') AND
  8851           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8852              OR
  8853           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8854           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 163
* EL050.cbl
  8855           (AM-IG NOT = '2'))
  8856              GO TO 03XX-GET-LIFE-ERPLAN.
  8857
  8858     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8859       AND
  8860        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8861        IF CF-REDUCING (SUB3)
  8862           IF (PB-I-INDV-GRP-OVRD = 'G')
  8863              OR
  8864           ((AM-IG = '2') AND
  8865           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8866              OR
  8867           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8868           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8869           (AM-IG NOT = '1'))
  8870              GO TO 03XX-GET-LIFE-ERPLAN.
  8871
  8872     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8873       AND
  8874        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8875        IF CF-LEVEL    (SUB3)
  8876           IF (PB-I-INDV-GRP-OVRD = 'I')
  8877              OR
  8878           ((AM-IG = '1') AND
  8879           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8880              OR
  8881           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8882           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8883            (AM-IG NOT = '2'))
  8884              GO TO 03XX-GET-LIFE-ERPLAN.
  8885
  8886     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8887       AND
  8888        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8889        IF CF-LEVEL    (SUB3)
  8890           IF (PB-I-INDV-GRP-OVRD = 'G')
  8891              OR
  8892           ((AM-IG = '2') AND
  8893           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8894              OR
  8895           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8896           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8897           (AM-IG NOT = '1'))
  8898              GO TO 03XX-GET-LIFE-ERPLAN.
  8899
  8900     IF SUB5 LESS THAN +20
  8901        ADD +1                   TO SUB5
  8902        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8903
  8904     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8905
  8906     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8907        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8908
  8909     MOVE +1                     TO SUB5.
  8910
  8911 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8912
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 164
* EL050.cbl
  8913     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8914                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8915
  8916     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8917       AND
  8918        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8919        GO TO 03XX-GET-LIFE-ERPLAN.
  8920
  8921     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8922       AND
  8923        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8924        IF CF-REDUCING (SUB3)
  8925           IF (PB-I-INDV-GRP-OVRD = 'I')
  8926              OR
  8927           ((AM-IG = '1') AND
  8928           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8929              OR
  8930           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8931           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8932           (AM-IG NOT = '2'))
  8933              GO TO 03XX-GET-LIFE-ERPLAN.
  8934
  8935     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8936       AND
  8937        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8938        IF CF-REDUCING (SUB3)
  8939           IF (PB-I-INDV-GRP-OVRD = 'G')
  8940              OR
  8941           ((AM-IG = '2') AND
  8942           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8943              OR
  8944           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8945           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8946           (AM-IG NOT = '1'))
  8947              GO TO 03XX-GET-LIFE-ERPLAN.
  8948
  8949     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8950       AND
  8951        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8952        IF CF-LEVEL    (SUB3)
  8953           IF (PB-I-INDV-GRP-OVRD = 'I')
  8954              OR
  8955           ((AM-IG = '1') AND
  8956           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8957              OR
  8958           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8959           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8960            (AM-IG NOT = '2'))
  8961              GO TO 03XX-GET-LIFE-ERPLAN.
  8962
  8963     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8964       AND
  8965        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8966        IF CF-LEVEL    (SUB3)
  8967           IF (PB-I-INDV-GRP-OVRD = 'G')
  8968              OR
  8969           ((AM-IG = '2') AND
  8970           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 165
* EL050.cbl
  8971              OR
  8972           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8973           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8974           (AM-IG NOT = '1'))
  8975              GO TO 03XX-GET-LIFE-ERPLAN.
  8976
  8977     IF SUB5 LESS THAN +30
  8978        ADD +1                   TO SUB5
  8979        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8980
  8981     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8982
  8983 03XX-EDIT-FOR-NINETY-LF-CONT.
  8984
  8985     MOVE +99                    TO SUB5.
  8986
  8987     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8988        IF PB-ISSUE
  8989           MOVE ER-1924          TO  WS-ERROR
  8990           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8991
  8992     GO TO 0304-LIFE-BENEFIT-FOUND.
  8993
  8994 03XX-GET-LIFE-ERPLAN.
  8995
  8996     IF WK-PLAN-ADDR EQUAL +0
  8997        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8998
  8999     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9000     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9001     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9002     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  9003     MOVE 'Y'                    TO PLAN-MASTER-SW
  9004                                    PLAN-MASTER-LIFE-SW.
  9005     GO TO XXXX-CHECK-LF-PLAN-KEY.
  9006
  9007 03XX-ERPLAN-LIFE-GETMAIN.
  9008
  9009     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9010     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9011
  9012 03XX-ERPLAN-LIFE-READ.
  9013
  9014     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9015     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9016     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9017     MOVE PB-SV-STATE            TO PLAN-STATE.
  9018     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9019     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  9020     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9021     MOVE WS-SAVE-BENEFIT-REVISION
  9022                                 TO PLAN-REVISION-NO.
  9023
  9024     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9025     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  9026
  9027     IF PB-COMPANY-ID = 'NCL'
  9028       IF NOT LF-PLAN-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 166
* EL050.cbl
  9029         IF NOT PB-POLICY-IS-DECLINED  AND
  9030            NOT PB-POLICY-IS-VOIDED
  9031             MOVE  ER-1921         TO  WS-ERROR
  9032             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9033             GO TO 0304-LIFE-BENEFIT-FOUND.
  9034
  9035     IF NOT LF-PLAN-MASTER-FOUND
  9036        GO TO 0304-LIFE-BENEFIT-FOUND.
  9037
  9038 XXXX-CHECK-LF-PLAN-KEY.
  9039
  9040     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9041        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9042        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9043        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9044        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9045        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9046        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9047        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9048        MOVE 'N'                 TO PLAN-MASTER-SW
  9049          GO TO 03XX-ERPLAN-LIFE-READ.
  9050
  9051     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  9052
  9053     IF  PB-CANCELLATION
  9054         GO TO  0303-LF-ACCT-BEN-FOUND.
  9055
  9056     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9057        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9058           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9059           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9060              MOVE ER-2644             TO WS-ERROR
  9061              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9062           ELSE
  9063              NEXT SENTENCE
  9064        ELSE
  9065           IF PB-COMPANY-ID NOT = 'NCL'
  9066              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9067                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9068
  9069 0303-LF-ACCT-BEN-FOUND.
  9070
  9071     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9072
  9073     IF PL-DEV-CODE NOT = SPACES
  9074        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9075
  9076     IF PL-DEV-PCT NUMERIC AND
  9077        PL-DEV-PCT NOT = ZEROS
  9078        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9079
  9080     IF PL-TOL-PREM-AMT GREATER THAN +0
  9081        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9082
  9083     IF PL-TOL-REF-AMT GREATER THAN +0
  9084        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9085
  9086     IF PL-TOL-PREM-PCT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 167
* EL050.cbl
  9087        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9088
  9089     IF PL-TOL-REF-PCT GREATER THAN +0
  9090        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9091
  9092     IF PL-TOL-CLM-AMT GREATER THAN +0
  9093        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9094
  9095     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9096                          PL-OVER-SHORT-AMT > +0
  9097        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9098
  9099     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9100                          PL-OVER-SHORT-PCT > +0
  9101        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9102
  9103     IF PL-SALES-TAX NUMERIC AND
  9104                          PL-SALES-TAX > +0
  9105         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9106
  9107     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9108        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9109                                    WS-IG-OVRD-AM.
  9110
  9111 0304-LIFE-BENEFIT-FOUND.
  9112
  9113     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9114
  9115     IF PB-ISSUE
  9116        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9117     ELSE
  9118        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9119
  9120     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9121     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9122     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9123     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9124     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9125                                         WS-LF-REFUND-CALC.
  9126     if (ws-lf-earnings-calc = '5')
  9127        and (pb-i-loan-apr = zeros)
  9128        and (benefit-code-chg)
  9129        move +99.9999 to pb-i-loan-apr
  9130     end-if
  9131
  9132     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9133        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9134
  9135     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9136        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9137     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9138
  9139     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9140     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9141     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9142     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9143     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9144     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 168
* EL050.cbl
  9145
  9146     IF PB-COMPANY-ID = 'NCL'  AND
  9147        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9148         NEXT SENTENCE
  9149     ELSE
  9150         IF SUB5 NOT GREATER THAN +20
  9151            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9152               MOVE WS-SAVE-BENEFIT-REM-TERM
  9153                                      TO WS-AM-LF-BENE-REM-TERM
  9154                                         EC-BR-LF-REM-TERM-CALC.
  9155
  9156     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9157     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9158
  9159     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9160
  9161 0305-BENEFIT-NOT-FOUND.
  9162
  9163     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9164     MOVE ER-2604                TO WS-ERROR.
  9165     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9166
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 169
* EL050.cbl
  9168
  9169 0310-FIND-AH-BENEFIT-RECORD.
  9170
  9171     MOVE 'N'                    TO PLAN-MASTER-SW
  9172                                    PLAN-MASTER-AH-SW.
  9173
  9174     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9175                                    WS-PL-TOL-AH-REFUND
  9176                                    WS-AH-PL-REF-OVS-AMT
  9177                                    WS-PL-TOL-AH-PREM-PCT
  9178                                    WS-PL-TOL-AH-REFUND-PCT
  9179                                    WS-AH-PL-REF-OVS-PCT
  9180                                    WS-PL-TOL-AH-CLAIM.
  9181     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9182
  9183
  9184     if pb-issue
  9185        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9186           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9187        end-if
  9188        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9189           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9190           GO TO 0399-BENEFIT-NOT-FOUND
  9191        end-if
  9192     end-if
  9193
  9194     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9195        GO TO 0400-FIND-CARRIER.
  9196
  9197     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9198
  9199     IF WK-AH-BEN-ADDR NOT = ZEROS
  9200         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9201         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9202         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9203         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9204           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9205             GO TO 0311-AH-BENEFIT-SEARCH
  9206         ELSE
  9207             NEXT SENTENCE
  9208     ELSE
  9209         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9210
  9211     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9212     MOVE '5'                    TO CNTL-REC-TYPE.
  9213     MOVE +0                     TO CNTL-SEQ-NO.
  9214     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9215
  9216     MOVE '2' TO RC-SW-2.
  9217     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9218
  9219     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9220        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9221          GO TO 0399-BENEFIT-NOT-FOUND.
  9222
  9223     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9224
  9225 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 170
* EL050.cbl
  9226
  9227     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9228
  9229     IF NO-BENEFIT-FOUND
  9230         GO TO 0399-BENEFIT-NOT-FOUND.
  9231
  9232     IF WS-BEN-CD = '99'
  9233        GO TO 0399-BENEFIT-NOT-FOUND.
  9234
  9235     IF PB-COMPANY-ID  =  'NCL'
  9236         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9237             GO TO 0314-A-H-BENEFIT-FOUND.
  9238
  9239     MOVE +1                     TO SUB5.
  9240     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9241
  9242* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9243* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9244     IF PB-COMPANY-ID = 'DMD'
  9245         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9246
  9247 0312-EDIT-ACCT-AH-BENEFITS.
  9248
  9249     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9250        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9251           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9252                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9253           GO TO 03XX-GET-AH-ERPLAN.
  9254
  9255     IF SUB5 LESS THAN +20
  9256        ADD +1                   TO SUB5
  9257        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9258
  9259     MOVE +1                     TO SUB5.
  9260
  9261     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9262        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9263
  9264 0313-EDIT-DMD-EXTRA-BENEFITS.
  9265
  9266     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9267        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9268           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9269                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9270           GO TO 03XX-GET-AH-ERPLAN.
  9271
  9272     IF SUB5 LESS THAN +30
  9273        ADD +1                   TO SUB5
  9274        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9275
  9276     MOVE +1                     TO SUB5.
  9277
  9278 03XX-EDIT-FOR-NINETY-AH.
  9279
  9280***************************************************************
  9281*                                                             *
  9282*    NINETY BENEFIT PLAN TYPES:                               *
  9283*                                                             *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 171
* EL050.cbl
  9284*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9285*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9286*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9287*           BENEFIT CONTROLS.                                 *
  9288*      99 = ALL BENEFITS.                                     *
  9289*                                                             *
  9290***************************************************************
  9291
  9292     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9293                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9294
  9295     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9296       AND
  9297        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9298        GO TO 03XX-GET-AH-ERPLAN.
  9299
  9300     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9301       AND
  9302        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9303           IF (PB-I-INDV-GRP-OVRD = 'I')
  9304              OR
  9305           ((AM-IG = '1') AND
  9306           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9307              OR
  9308           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9309           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9310           (AM-IG NOT = '2'))
  9311              GO TO 03XX-GET-AH-ERPLAN.
  9312
  9313     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9314       AND
  9315        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9316           IF (PB-I-INDV-GRP-OVRD = 'G')
  9317              OR
  9318           ((AM-IG = '2') AND
  9319           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9320              OR
  9321           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9322           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9323           (AM-IG NOT = '1'))
  9324              GO TO 03XX-GET-AH-ERPLAN.
  9325
  9326     IF SUB5 LESS THAN +20
  9327        ADD +1                   TO SUB5
  9328        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9329
  9330     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9331        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9332
  9333     MOVE +1                    TO SUB5.
  9334
  9335 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9336
  9337     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9338                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9339
  9340     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9341       AND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 172
* EL050.cbl
  9342        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9343        GO TO 03XX-GET-AH-ERPLAN.
  9344
  9345     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9346       AND
  9347        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9348           IF (PB-I-INDV-GRP-OVRD = 'I')
  9349              OR
  9350           ((AM-IG = '1') AND
  9351           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9352              OR
  9353           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9354           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9355           (AM-IG NOT = '2'))
  9356              GO TO 03XX-GET-AH-ERPLAN.
  9357
  9358     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9359       AND
  9360        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9361           IF (PB-I-INDV-GRP-OVRD = 'G')
  9362              OR
  9363           ((AM-IG = '2') AND
  9364           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9365              OR
  9366           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9367           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9368           (AM-IG NOT = '1'))
  9369              GO TO 03XX-GET-AH-ERPLAN.
  9370
  9371     IF SUB5 LESS THAN +30
  9372        ADD +1                   TO SUB5
  9373        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9374
  9375 03XX-EDIT-FOR-NINETY-AH-CONT.
  9376
  9377     MOVE +99                    TO SUB5.
  9378
  9379     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9380
  9381     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9382        IF PB-ISSUE
  9383           MOVE ER-1925          TO  WS-ERROR
  9384           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9385
  9386     GO TO 0314-A-H-BENEFIT-FOUND.
  9387
  9388 03XX-GET-AH-ERPLAN.
  9389
  9390     IF WK-PLAN-ADDR EQUAL +0
  9391         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9392
  9393     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9394     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9395     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9396     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9397     MOVE 'Y'                    TO PLAN-MASTER-SW
  9398                                    PLAN-MASTER-AH-SW.
  9399*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 173
* EL050.cbl
  9400     GO TO 03XX-ERPLAN-AH-READ.
  9401
  9402 03XX-ERPLAN-AH-GETMAIN.
  9403
  9404     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9405     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9406
  9407 03XX-ERPLAN-AH-READ.
  9408
  9409     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9410     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9411     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9412     MOVE PB-SV-STATE            TO PLAN-STATE.
  9413     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9414     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9415     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9416     MOVE WS-SAVE-BENEFIT-REVISION
  9417                                 TO PLAN-REVISION-NO.
  9418
  9419     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9420     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9421
  9422     IF PB-COMPANY-ID = 'NCL'
  9423       IF NOT AH-PLAN-MASTER-FOUND
  9424         IF NOT PB-POLICY-IS-DECLINED  AND
  9425            NOT PB-POLICY-IS-VOIDED
  9426             MOVE  ER-1922         TO  WS-ERROR
  9427             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9428             GO TO 0314-A-H-BENEFIT-FOUND.
  9429
  9430     IF NOT AH-PLAN-MASTER-FOUND
  9431        GO TO 0314-A-H-BENEFIT-FOUND.
  9432
  9433 XXXX-CHECK-AH-PLAN-KEY.
  9434
  9435     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9436        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9437        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9438        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9439        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9440        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9441        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9442        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9443        MOVE 'N'                 TO PLAN-MASTER-SW
  9444          GO TO 03XX-ERPLAN-AH-READ.
  9445
  9446     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9447
  9448     IF  PB-CANCELLATION
  9449         GO TO  0313-AH-ACCT-BEN-FOUND.
  9450
  9451     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9452       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9453          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9454          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9455             MOVE ER-2644             TO WS-ERROR
  9456             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9457          ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 174
* EL050.cbl
  9458             NEXT SENTENCE
  9459       ELSE
  9460          IF PB-COMPANY-ID NOT = 'NCL'
  9461             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9462                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9463
  9464 0313-AH-ACCT-BEN-FOUND.
  9465
  9466     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9467
  9468     IF PL-DEV-CODE NOT = SPACES
  9469        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9470
  9471     IF PL-DEV-PCT NUMERIC AND
  9472        PL-DEV-PCT NOT = ZEROS
  9473        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9474
  9475     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9476        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9477
  9478     IF PL-TOL-REF-AMT NOT EQUAL +0
  9479        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9480
  9481     IF PL-TOL-PREM-PCT GREATER THAN +0
  9482        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9483
  9484     IF PL-TOL-REF-PCT GREATER THAN +0
  9485        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9486
  9487     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9488        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9489
  9490     IF PL-OVER-SHORT-AMT NUMERIC AND
  9491                          PL-OVER-SHORT-AMT > +0
  9492        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9493
  9494     IF PL-OVER-SHORT-PCT NUMERIC AND
  9495                          PL-OVER-SHORT-PCT > +0
  9496        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9497
  9498     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9499        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9500        IF WS-IG-OVRD-AM EQUAL SPACES
  9501            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9502
  9503 0314-A-H-BENEFIT-FOUND.
  9504
  9505     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9506
  9507     IF PB-ISSUE
  9508        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9509       ELSE
  9510        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9511
  9512     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9513     if cf-maximum-benefits (sub3) numeric
  9514        move cf-maximum-benefits (sub3)
  9515                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 175
* EL050.cbl
  9516     else
  9517        move zeros               to ws-ah-max-bens
  9518     end-if
  9519     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9520     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9521     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9522                                         WS-AH-REFUND-CALC.
  9523
  9524     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9525        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9526
  9527     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9528        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9529     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9530
  9531     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9532     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9533     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9534     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9535     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9536     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9537
  9538     IF PB-COMPANY-ID = 'NCL'  AND
  9539        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9540         NEXT SENTENCE
  9541     ELSE
  9542         IF SUB5 NOT GREATER THAN +20
  9543            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9544                MOVE WS-SAVE-BENEFIT-REM-TERM
  9545                                      TO WS-AM-AH-BENE-REM-TERM
  9546                                         EC-BR-AH-REM-TERM-CALC.
  9547
  9548     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9549     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9550
  9551     GO TO 0400-FIND-CARRIER.
  9552
  9553 0399-BENEFIT-NOT-FOUND.
  9554
  9555     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9556     MOVE ER-2605                TO WS-ERROR.
  9557     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9558
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 176
* EL050.cbl
  9560
  9561 0400-FIND-CARRIER.
  9562
  9563     MOVE PB-SV-CARRIER          TO WS-CARR.
  9564
  9565     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9566     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9567     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9568     MOVE '6'                    TO CNTL-REC-TYPE.
  9569
  9570*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9571     MOVE SPACE                  TO WS-DMD-RATING-SW
  9572                                    EC-BR-DMD-RATING-SW.
  9573
  9574     MOVE '2'                    TO RC-SW-1.
  9575     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9576
  9577     IF NOT CF-CARRIER-MASTER
  9578        GO TO 0400-CARRIER-NOT-FOUND.
  9579
  9580 0400-BUILD-CARR-TOL.
  9581
  9582     IF CF-CR-TOL-PREM NUMERIC AND
  9583        CF-CR-TOL-PREM GREATER THAN +0
  9584        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9585                                    WS-TOL-AH-PREM.
  9586
  9587     IF CF-CR-TOL-REFUND NUMERIC AND
  9588        CF-CR-TOL-REFUND GREATER THAN +0
  9589        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9590                                    WS-TOL-AH-REFUND.
  9591
  9592     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9593        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9594        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9595                                    WS-AH-REFUND-OVS-AMT.
  9596
  9597     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9598        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9599        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9600                                    WS-AH-REFUND-OVS-PCT.
  9601
  9602     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9603        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9604        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9605                                    WS-TOL-AH-PREM-PCT.
  9606
  9607     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9608        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9609        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9610                                     WS-TOL-AH-REFUND-PCT.
  9611
  9612     IF CF-COMPANY-ID EQUAL 'DMD'
  9613         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9614                                    EC-BR-DMD-RATING-SW.
  9615
  9616     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9617     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 177
* EL050.cbl
  9618        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9619     END-IF
  9620     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9621        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9622     END-IF
  9623     IF WS-TOL-CLP-PCT = ZEROS
  9624        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9625     END-IF
  9626
  9627     IF WS-SPP-LEASE-COMM = ZEROS
  9628        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9629     END-IF
  9630     GO TO 0400-FIND-ERPDEF.
  9631
  9632 0400-CARRIER-NOT-FOUND.
  9633
  9634     MOVE ER-2602                TO WS-ERROR.
  9635     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9636
  9637 0400-FIND-ERPDEF.
  9638*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9639     IF (PB-COMPANY-ID = 'DCC')
  9640        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9641        CONTINUE
  9642     ELSE
  9643        GO TO 0400-FIND-ERCOMP
  9644     END-IF
  9645     MOVE ' '                    TO PDEF-MASTER-SW
  9646     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9647     MOVE PB-STATE               TO ERPDEF-STATE
  9648     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9649        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9650     END-IF
  9651     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9652     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9653     IF PB-ISSUE
  9654        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9655     ELSE
  9656        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9657     END-IF
  9658     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9659     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9660     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9661     IF PDEF-MASTER-FOUND
  9662        MOVE 'N'                 TO PDEF-MASTER-SW
  9663        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9664        IF PDEF-MASTER-FOUND
  9665           IF (ERPDEF-KEY-SAVE (1:16) =
  9666                        PD-CONTROL-PRIMARY (1:16))
  9667              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9668              CONTINUE
  9669           ELSE
  9670              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9671              IF (ERPDEF-KEY-SAVE (1:16) =
  9672                        PD-CONTROL-PRIMARY (1:16))
  9673                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9674                 CONTINUE
  9675              ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 178
* EL050.cbl
  9676                 MOVE 'N'        TO PDEF-MASTER-SW
  9677              END-IF
  9678           END-IF
  9679        END-IF
  9680        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9681     END-IF
  9682     IF PDEF-MASTER-FOUND
  9683        IF PD-TRUNCATED = 'Y'
  9684           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9685        END-IF
  9686     END-IF
  9687     .
  9688 0400-FIND-ERCOMP.
  9689     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9690        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9691           (WS-SUB1 > +10)
  9692           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9693                 OR 'A' OR 'N'
  9694              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9695              MOVE PB-CARRIER    TO COMP-CARRIER
  9696              MOVE PB-GROUPING   TO COMP-GROUPING
  9697              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9698              MOVE AM-AGT (WS-SUB1)
  9699                                 TO COMP-FIN-RESP
  9700              MOVE 'G'           TO COMP-TYPE
  9701              PERFORM 8582-READ-COMPENSATION-MASTER
  9702                                 THRU 8582-EXIT
  9703              IF COMP-MASTER-FOUND
  9704                 IF CO-GA-INACTIVE
  9705                    MOVE ER-2763 TO WS-ERROR
  9706                    PERFORM 9900-ERROR-FORMAT
  9707                                 THRU 9900-EXIT
  9708                    MOVE +11     TO WS-SUB1
  9709                 END-IF
  9710                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9711                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9712                    MOVE ER-2788 TO WS-ERROR
  9713                    PERFORM 9900-ERROR-FORMAT
  9714                                 THRU 9900-EXIT
  9715                    MOVE +11     TO WS-SUB1
  9716                 END-IF
  9717              END-IF
  9718           END-IF
  9719        END-PERFORM
  9720     END-IF
  9721     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9722        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9723           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9724                                    WS-CLP-STATE
  9725        ELSE
  9726           MOVE SPACES           TO PB-I-CLP-STATE
  9727                                    WS-CLP-STATE
  9728        END-IF
  9729     END-IF
  9730
  9731     IF (PB-COMPANY-ID = 'DCC')
  9732        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9733        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 179
* EL050.cbl
  9734        CONTINUE
  9735     ELSE
  9736        GO TO 0400-FIND-STATE-RECORD
  9737     END-IF
  9738     MOVE SPACES                 TO WS-CLP-STATE
  9739     MOVE +0                     TO WS-BANK-FEE
  9740                                    WS-BANK-LFEE
  9741                                    WS-BANK-NOCHRGB
  9742
  9743     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9744     IF (PB-ISSUE)
  9745        AND (PB-I-BANK-NUMBER NOT =
  9746            SPACES AND ZEROS AND LOW-VALUES)
  9747        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9748     ELSE
  9749        IF (PB-CANCELLATION)
  9750           AND (PB-CI-BANK-NUMBER NOT =
  9751                SPACES AND ZEROS AND LOW-VALUES)
  9752           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9753        END-IF
  9754     END-IF
  9755     IF COMP-FIN-RESP NOT = LOW-VALUES
  9756        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9757        MOVE PB-CARRIER          TO COMP-CARRIER
  9758        MOVE PB-GROUPING         TO COMP-GROUPING
  9759        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9760        MOVE 'B'                 TO COMP-TYPE
  9761        PERFORM 8582-READ-COMPENSATION-MASTER
  9762                                 THRU 8582-EXIT
  9763        IF COMP-MASTER-FOUND
  9764           IF CO-MAX-BANK-FEE NOT NUMERIC
  9765              MOVE +0            TO CO-MAX-BANK-FEE
  9766           END-IF
  9767           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9768              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9769           END-IF
  9770           IF CO-GA-INACTIVE
  9771              MOVE ER-2763       TO WS-ERROR
  9772              PERFORM 9900-ERROR-FORMAT
  9773                                 THRU 9900-EXIT
  9774           END-IF
  9775           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9776              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9777              MOVE ER-2788 TO WS-ERROR
  9778              PERFORM 9900-ERROR-FORMAT
  9779                                 THRU 9900-EXIT
  9780              MOVE +11     TO WS-SUB1
  9781           END-IF
  9782           IF WS-AH-BEN-CATEGORY = 'G'
  9783              MOVE CO-MAX-BANK-FEE
  9784                                 TO WS-BANK-FEE
  9785                                    PB-I-BANK-FEE
  9786           ELSE
  9787              MOVE CO-MAX-BANK-FEE-LEASE
  9788                                 TO WS-BANK-LFEE
  9789                                    PB-I-BANK-FEE
  9790           END-IF
  9791           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 180
* EL050.cbl
  9792              AND (WS-AH-REFUND-CALC = 'G'))
  9793                        OR
  9794              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9795              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9796              CONTINUE
  9797           ELSE
  9798              MOVE ER-2789 TO WS-ERROR
  9799              PERFORM 9900-ERROR-FORMAT
  9800                                 THRU 9900-EXIT
  9801           END-IF
  9802           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9803                                    PB-I-CLP-STATE
  9804           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9805           MOVE CO-CARRIER       TO BXRF-CARRIER
  9806           MOVE CO-GROUPING      TO BXRF-GROUPING
  9807           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9808           MOVE BXRF-MAX-REC-LENGTH
  9809                                 TO BXRF-REC-LENGTH
  9810           PERFORM 8584-READ-BANK-CROSS-REF
  9811                                 THRU 8584-EXIT
  9812           IF BXRF-MASTER-FOUND
  9813              MOVE ' '           TO BANK-ACCT-SW
  9814              MOVE BK-BANK-POINTER-CNT
  9815                                 TO BK-BANK-POINTER-CNT
  9816              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9817                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9818                 OR (BANK-ACCT-FOUND)
  9819                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9820                    AND (BK-AM-EXP-DT (WS-SUB1)
  9821                                 > PB-CERT-EFF-DT)
  9822                    AND (BK-AM-EFF-DT (WS-SUB1)
  9823                                 NOT > PB-CERT-EFF-DT)
  9824                    SET BANK-ACCT-FOUND TO TRUE
  9825                 END-IF
  9826              END-PERFORM
  9827              IF NOT BANK-ACCT-FOUND
  9828                 MOVE ZEROS      TO WS-BANK-FEE
  9829                                    WS-BANK-LFEE
  9830                 MOVE ER-2869    TO WS-ERROR
  9831                 PERFORM 9900-ERROR-FORMAT
  9832                                 THRU 9900-EXIT
  9833              ELSE
  9834                 PERFORM 5000-PROCESS-REPS
  9835                                 THRU 5000-EXIT
  9836                 IF AGENT-MASTER-FOUND
  9837                    MOVE +0      TO WS-BANK-FEE
  9838                                    WS-BANK-LFEE
  9839*                   MOVE AG-SPP-FEES (1)
  9840*                                TO PB-I-BANK-FEE
  9841*                                   WS-BANK-FEE
  9842                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9843                       (WS-SUB1 > +10)
  9844                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9845                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9846                       END-IF
  9847                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9848                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9849                       END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 181
* EL050.cbl
  9850                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9851                          AG-SPP-FEES (WS-SUB1)
  9852                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9853                          AG-SPP-LFEES (WS-SUB1)
  9854                    END-PERFORM
  9855                    IF WS-AH-BEN-CATEGORY = 'G'
  9856                       MOVE WS-BANK-FEE
  9857                                 TO PB-I-BANK-FEE
  9858                    ELSE
  9859                       MOVE WS-BANK-LFEE
  9860                                 TO PB-I-BANK-FEE
  9861                    END-IF
  9862                 END-IF
  9863              END-IF
  9864           END-IF
  9865        ELSE
  9866           MOVE ER-2879          TO WS-ERROR
  9867           PERFORM 9900-ERROR-FORMAT
  9868                                 THRU 9900-EXIT
  9869        END-IF
  9870     ELSE
  9871        MOVE ER-2879             TO WS-ERROR
  9872        PERFORM 9900-ERROR-FORMAT
  9873                                 THRU 9900-EXIT
  9874     END-IF
  9875     IF WS-AH-BEN-CATEGORY = 'G'
  9876        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9877        + WS-BANK-FEE
  9878     ELSE
  9879        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9880        + WS-BANK-LFEE
  9881     END-IF
  9882     .
  9883 0400-FIND-STATE-RECORD.
  9884
  9885     IF WK-STATE-ADDR NOT = ZEROS
  9886         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9887         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9888         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9889         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9890         IF PB-SV-STATE = CF-STATE-CODE
  9891             GO TO 0405-CONTINUE-EDIT
  9892         ELSE
  9893             NEXT SENTENCE
  9894     ELSE
  9895         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9896
  9897     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9898     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9899     MOVE '3'                    TO CNTL-REC-TYPE.
  9900     MOVE +0                     TO CNTL-SEQ-NO.
  9901
  9902     MOVE '3'                    TO RC-SW-2.
  9903     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9904
  9905     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9906        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9907        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 182
* EL050.cbl
  9908        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9909                                    WS-TOL-AH-CLAIM
  9910                                    WS-MINIMUM-REFUND
  9911                                    WS-TOL-LF-PREM
  9912                                    WS-TOL-AH-PREM
  9913                                    WS-TOL-LF-REFUND
  9914                                    WS-TOL-AH-REFUND
  9915                                    EC-ST-TOL-PREM-PCT
  9916                                    WS-TOL-LF-PREM-PCT
  9917                                    WS-TOL-AH-PREM-PCT
  9918                                    EC-ST-TOL-REFUND-PCT
  9919                                    WS-TOL-LF-REFUND-PCT
  9920                                    WS-TOL-AH-REFUND-PCT
  9921                                    EC-ST-TOL-PREM
  9922                                    EC-ST-TOL-REFUND
  9923                                    EC-ST-FST-PMT-DAYS-MAX
  9924                                    WS-FREE-LOOK-PERIOD
  9925                                    WS-ST-LF-PREM-TAX
  9926                                    WS-ST-AH-PREM-TAX-I
  9927                                    WS-ST-AH-PREM-TAX-G
  9928                                    WS-BANK-FEE
  9929                                    WS-BANK-LFEE
  9930                                    WS-TOL-CLP-PCT
  9931                                    WS-SPP-LEASE-COMM
  9932                                    WS-INT-PERIODS
  9933                                    WS-EXTRA-PMTS
  9934        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9935                                    EC-ST-FST-PMT-DAYS-CHG
  9936                                    WS-LF-REM-TERM-CALC
  9937                                    WS-LF-REFUND-CALC
  9938                                    EC-ST-LF-REM-TERM-CALC
  9939                                    EC-ST-LF-REFUND-CALC
  9940                                    WS-AH-REM-TERM-CALC
  9941                                    WS-AH-REFUND-CALC
  9942                                    WS-LF-BEN-CATEGORY
  9943                                    WS-AH-BEN-CATEGORY
  9944                                    WS-CLP-STATE
  9945                                    WS-ST-REFUND-CLAIM-FLAG
  9946                                    WS-ST-CAUSAL-STATE
  9947                                    ws-st-agent-sig-edit
  9948                                    EC-ST-AH-REM-TERM-CALC
  9949                                    EC-ST-AH-REFUND-CALC
  9950          GO TO 0499-STATE-NOT-FOUND.
  9951
  9952     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9953
  9954 0405-CONTINUE-EDIT.
  9955
  9956     IF (PB-COMPANY-ID <> 'AHL')
  9957        and (pb-issue)
  9958        MOVE +0                  TO SUB3
  9959        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9960        IF SUB3 > +0
  9961           MOVE ER-3270          TO WS-ERROR
  9962           PERFORM 9900-ERROR-FORMAT
  9963                                 THRU 9900-EXIT
  9964        else
  9965           IF PB-CERT-PRIME NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 183
* EL050.cbl
  9966              MOVE ER-2722       TO WS-ERROR
  9967              PERFORM 9900-ERROR-FORMAT
  9968                                 THRU 9900-EXIT
  9969           end-if
  9970        END-IF
  9971     END-IF
  9972     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9973
  9974     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9975        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9976                                    WS-TOL-AH-CLAIM.
  9977
  9978     IF CF-ST-REFUND-MIN NOT NUMERIC
  9979        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9980
  9981     IF CF-ST-REFUND-MIN NOT = ZEROS
  9982        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9983
  9984     IF CF-ST-TOL-PREM  NOT = ZEROS
  9985        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9986                                    WS-TOL-AH-PREM
  9987        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9988
  9989     IF CF-ST-TOL-REFUND NOT = ZEROS
  9990        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9991                                    WS-TOL-AH-REFUND
  9992        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9993
  9994     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9995        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9996        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9997                                    WS-AH-REFUND-OVS-AMT
  9998                                    EC-ST-OVR-SHT-AMT.
  9999
 10000     IF CF-ST-TOL-PREM-PCT NUMERIC AND
 10001        CF-ST-TOL-PREM-PCT GREATER THAN +0
 10002        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
 10003                                    WS-TOL-LF-PREM-PCT
 10004                                    WS-TOL-AH-PREM-PCT.
 10005
 10006     IF CF-ST-TOL-REF-PCT NUMERIC AND
 10007        CF-ST-TOL-REF-PCT GREATER THAN +0
 10008        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
 10009                                    WS-TOL-LF-REFUND-PCT
 10010                                    WS-TOL-AH-REFUND-PCT.
 10011
 10012     IF CF-ST-OVR-SHT-PCT NUMERIC AND
 10013        CF-ST-OVR-SHT-PCT GREATER THAN +0
 10014        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
 10015                                    WS-AH-REFUND-OVS-PCT
 10016                                    EC-ST-OVR-SHT-PCT.
 10017
 10018     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
 10019     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
 10020
 10021     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
 10022          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
 10023
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 184
* EL050.cbl
 10024     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
 10025     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
 10026     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
 10027
 10028     IF CF-ST-LF-PREM-TAX NUMERIC
 10029        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10030     END-IF
 10031     IF CF-ST-AH-PREM-TAX-I NUMERIC
 10032        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10033     END-IF
 10034     IF CF-ST-AH-PREM-TAX-G NUMERIC
 10035        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10036     END-IF
 10037
 10038     IF CF-ST-REF-AH-DEATH-IND > SPACES
 10039         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 10040     END-IF.
 10041
 10042     IF CF-ST-CAUSAL-STATE > SPACES
 10043         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 10044     END-IF.
 10045     if cf-st-extra-interest-periods not numeric
 10046        move zeros               to cf-st-extra-interest-periods
 10047     end-if
 10048     if cf-st-extra-payments not numeric
 10049        move zeros               to cf-st-extra-payments
 10050     end-if
 10051
 10052     move cf-st-extra-interest-periods
 10053                                 to ws-int-periods
 10054     move cf-st-extra-payments   to ws-extra-pmts
 10055     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10056     move cf-st-net-only-state   to ws-net-only-state
 10057     if cf-st-comm-cap-sl not numeric
 10058        move zeros               to cf-st-comm-cap-sl
 10059     end-if
 10060     if cf-st-comm-cap-jl not numeric
 10061        move zeros               to cf-st-comm-cap-jl
 10062     end-if
 10063     if cf-st-comm-cap-sa not numeric
 10064        move zeros               to cf-st-comm-cap-sa
 10065     end-if
 10066     if cf-st-comm-cap-ja not numeric
 10067        move zeros               to cf-st-comm-cap-ja
 10068     end-if
 10069     if cf-st-ga-comm-cap-sl not numeric
 10070        move zeros               to cf-st-ga-comm-cap-sl
 10071     end-if
 10072     if cf-st-ga-comm-cap-jl not numeric
 10073        move zeros               to cf-st-ga-comm-cap-jl
 10074     end-if
 10075     if cf-st-ga-comm-cap-sa not numeric
 10076        move zeros               to cf-st-ga-comm-cap-sa
 10077     end-if
 10078     if cf-st-ga-comm-cap-ja not numeric
 10079        move zeros               to cf-st-ga-comm-cap-ja
 10080     end-if
 10081
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 185
* EL050.cbl
 10082     if cf-st-tot-comm-cap-sl not numeric
 10083        move zeros               to cf-st-tot-comm-cap-sl
 10084     end-if
 10085     if cf-st-tot-comm-cap-jl not numeric
 10086        move zeros               to cf-st-tot-comm-cap-jl
 10087     end-if
 10088     if cf-st-tot-comm-cap-sa not numeric
 10089        move zeros               to cf-st-tot-comm-cap-sa
 10090     end-if
 10091     if cf-st-tot-comm-cap-ja not numeric
 10092        move zeros               to cf-st-tot-comm-cap-ja
 10093     end-if
 10094
 10095     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10096     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10097     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10098     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10099     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10100     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10101     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10102     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10103     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10104     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10105     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10106     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10107     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10108     IF WS-LF-BENEFIT-CD = ZEROS
 10109        GO TO 0410-CHECK-AH.
 10110
 10111     IF CF-ST-RT-CALC NOT = SPACES
 10112        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10113                                    EC-ST-LF-REM-TERM-CALC
 10114     END-IF
 10115
 10116     IF WS-LF-COVERAGE-TYPE = 'R'
 10117        IF WS-LF-EARNINGS-CALC = '5'
 10118           IF CF-ST-RF-LN-CALC > '0'
 10119              MOVE CF-ST-RF-LN-CALC
 10120                                 TO WS-LF-REFUND-CALC
 10121                                    EC-ST-LF-REFUND-CALC
 10122           END-IF
 10123        ELSE
 10124           IF CF-ST-RF-LR-CALC > '0'
 10125              MOVE CF-ST-RF-LR-CALC
 10126                                 TO WS-LF-REFUND-CALC
 10127                                    EC-ST-LF-REFUND-CALC
 10128           END-IF
 10129        END-IF
 10130     ELSE
 10131        IF CF-ST-RF-LL-CALC > '0'
 10132           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10133                                    EC-ST-LF-REFUND-CALC
 10134        END-IF
 10135     END-IF
 10136
 10137     IF CF-ST-RT-CALC NOT = SPACES
 10138        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10139                                    EC-ST-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 186
* EL050.cbl
 10140     END-IF
 10141
 10142     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10143     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10144
 10145     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10146
 10147     IF NO-BENEFIT-FOUND
 10148        GO TO 0410-CHECK-AH.
 10149
 10150     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10151        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10152                                 TO EC-ST-LF-REM-TERM-CALC
 10153                                    WS-LF-REM-TERM-CALC
 10154     END-IF
 10155
 10156     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10157        MOVE CF-ST-REFUND-CALC (SUB3)
 10158                                 TO WS-LF-REFUND-CALC
 10159                                    EC-ST-LF-REFUND-CALC
 10160     END-IF
 10161*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10162     if cf-st-extra-periods (sub3) not numeric
 10163        move zeros               to cf-st-extra-periods (sub3)
 10164     end-if
 10165     if cf-st-extra-periods (sub3) > zeros
 10166        if ws-lf-ben-category = 'P'
 10167           move cf-st-extra-periods (sub3)
 10168                                 to ws-extra-pmts
 10169        else
 10170           if ws-lf-ben-category = 'I'
 10171              move cf-st-extra-periods (sub3)
 10172                                 to ws-int-periods
 10173           end-if
 10174        end-if
 10175     end-if
 10176     .
 10177 0410-CHECK-AH.
 10178
 10179     IF WS-AH-BENEFIT-CD = ZEROS
 10180        GO TO 0500-SET-ACCOUNT.
 10181
 10182     IF CF-ST-RT-CALC NOT = SPACES
 10183        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10184                                    EC-ST-AH-REM-TERM-CALC
 10185     END-IF
 10186
 10187     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10188        IF CF-ST-RF-CP-CALC > '0'
 10189           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10190                                    EC-ST-AH-REFUND-CALC
 10191        END-IF
 10192     ELSE
 10193        IF CF-ST-RF-AH-CALC > '0'
 10194           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10195                                    EC-ST-AH-REFUND-CALC
 10196        END-IF
 10197     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 187
* EL050.cbl
 10198     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10199     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10200
 10201     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10202
 10203     IF NO-BENEFIT-FOUND
 10204        GO TO 0500-SET-ACCOUNT.
 10205
 10206     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10207        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10208                                 TO WS-AH-REM-TERM-CALC
 10209                                    EC-ST-AH-REM-TERM-CALC
 10210     END-IF
 10211
 10212     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10213        MOVE CF-ST-REFUND-CALC (SUB3)
 10214                                 TO WS-AH-REFUND-CALC
 10215                                    EC-ST-AH-REFUND-CALC
 10216     END-IF
 10217
 10218*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10219
 10220     GO TO 0500-SET-ACCOUNT.
 10221
 10222 0499-STATE-NOT-FOUND.
 10223
 10224     MOVE ER-2603                TO WS-ERROR.
 10225     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10226
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 188
* EL050.cbl
 10228
 10229 0500-SET-ACCOUNT.
 10230*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10231     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10232        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10233        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10234        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10235        MOVE '3'                 TO CNTL-REC-TYPE
 10236        MOVE +0                  TO CNTL-SEQ-NO
 10237
 10238        MOVE '3'                 TO RC-SW-2
 10239        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10240
 10241        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10242           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10243           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10244           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10245                                    WS-ST-AH-PREM-TAX-I
 10246                                    WS-ST-AH-PREM-TAX-G
 10247        ELSE
 10248           IF CF-ST-LF-PREM-TAX NUMERIC
 10249              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10250           END-IF
 10251           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10252              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10253           END-IF
 10254           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10255              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10256           END-IF
 10257        END-IF
 10258        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10259     END-IF
 10260*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10261*  FOR DCC ONLY
 10262     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10263
 10264        MOVE ' '                 TO STAT-MASTER-SW
 10265        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10266        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10267        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10268        MOVE PB-STATE            TO ELSTAT-STATE
 10269        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10270           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10271        END-IF
 10272
 10273        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10274        SET BIN-TO-GREG          TO TRUE
 10275        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10276        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10277        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10278
 10279        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10280        IF STAT-MASTER-FOUND
 10281           MOVE 'N'              TO STAT-MASTER-SW
 10282           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10283           IF STAT-MASTER-FOUND
 10284              IF (ELSTAT-KEY-SAVE (1:12) =
 10285                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 189
* EL050.cbl
 10286                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10287                    MOVE 'F'        TO STAT-MASTER-SW
 10288                 ELSE
 10289                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10290                    IF (STAT-MASTER-FOUND)
 10291                       AND (ELSTAT-KEY-SAVE (1:12) =
 10292                           SF-CONTROL-PRIMARY (1:12))
 10293                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10294                       MOVE 'F'     TO STAT-MASTER-SW
 10295                    END-IF
 10296                 END-IF
 10297              END-IF
 10298           END-IF
 10299        END-IF
 10300
 10301        IF STAT-MASTER-SW = 'F'
 10302           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10303              and (sf-st-lf-prem-tax > zeros)
 10304              MOVE SF-ST-LF-PREM-TAX
 10305                                 TO WS-ST-LF-PREM-TAX
 10306           END-IF
 10307           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10308              and (sf-st-ah-prem-tax-i > zeros)
 10309              MOVE SF-ST-AH-PREM-TAX-I
 10310                                 TO WS-ST-AH-PREM-TAX-I
 10311           END-IF
 10312           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10313              and (sf-st-ah-prem-tax-g > zeros)
 10314              MOVE SF-ST-AH-PREM-TAX-G
 10315                                 TO WS-ST-AH-PREM-TAX-G
 10316           END-IF
 10317        END-IF
 10318     END-IF
 10319     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10320        AND (PB-ISSUE)
 10321        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10322        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10323        AND (AM-GPCD = 06)
 10324        MOVE 'Y'                 TO WS-GOOD-HIN
 10325        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10326           MOVE PB-I-VIN         TO WS-WORK-VIN
 10327           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10328              (V1 > 16)
 10329              IF WS-WORK-VIN (V1:1) NUMERIC
 10330                 MOVE WS-WORK-VIN-N (V1)
 10331                                 TO WS-ROW-B-VAL (V1)
 10332              ELSE
 10333                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10334                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10335                    OR (V2 > 26)
 10336                 END-PERFORM
 10337                 IF V2 < 27
 10338                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10339                 ELSE
 10340                    MOVE 'N'     TO WS-GOOD-HIN
 10341                 END-IF
 10342              END-IF
 10343              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 190
* EL050.cbl
 10344                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10345              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10346                 WS-ROW-D-VAL (V1)
 10347           END-PERFORM
 10348           MOVE ZEROS            TO WS-VIN-REMAINDER
 10349           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10350             REMAINDER WS-VIN-REMAINDER
 10351           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10352              CONTINUE
 10353           ELSE
 10354              MOVE 'N'           TO WS-GOOD-HIN
 10355           END-IF
 10356        ELSE
 10357           MOVE 'N'              TO WS-GOOD-HIN
 10358        END-IF
 10359        IF WS-GOOD-HIN NOT = 'Y'
 10360           MOVE ER-3826           TO WS-ERROR
 10361           PERFORM 9900-ERROR-FORMAT
 10362                                 THRU 9900-EXIT
 10363        END-IF
 10364     END-IF
 10365     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10366        AND (PB-ISSUE)
 10367        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10368        AND (AM-GPCD NOT = 06)
 10369        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10370           perform 3400-edit-vin thru 3400-exit
 10371        ELSE
 10372          MOVE ER-3826           TO WS-ERROR
 10373          PERFORM 9900-ERROR-FORMAT
 10374                                 THRU 9900-EXIT
 10375        END-IF
 10376     END-IF
 10377     if (pb-company-id = 'CID')
 10378        and (pb-issue)
 10379        and (pb-i-vin not = spaces and low-values and zeros)
 10380        perform 3400-edit-vin    thru 3400-exit
 10381     end-if
 10382******************************************************************
 10383******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10384******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10385******* METHODS.
 10386******************************************************************
 10387     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10388        IF PB-CANCELLATION
 10389           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10390              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10391                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10392                IF FORM-MASTER-FOUND
 10393                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10394******************************************************************
 10395
 10396     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10397     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10398
 10399     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10400     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10401     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 191
* EL050.cbl
 10402     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10403
 10404
 10405     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10406     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10407     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10408
 10409     IF AM-LF-OB-RATE NOT NUMERIC
 10410         MOVE ZERO               TO AM-LF-OB-RATE.
 10411
 10412     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10413         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10414
 10415     IF AM-AH-OB-RATE NOT NUMERIC
 10416         MOVE ZERO               TO AM-AH-OB-RATE.
 10417
 10418     IF WS-LF-JOINT-INDICATOR = 'J'
 10419         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10420     ELSE
 10421         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10422
 10423     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10424
 10425     IF WS-IG-OVRD-AM  EQUAL SPACE
 10426         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10427
 10428     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10429         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10430                                       WS-IG-OVRD
 10431     ELSE
 10432         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10433             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10434                                       WS-IG-OVRD
 10435         ELSE
 10436             MOVE AM-IG             TO WS-IG-OVRD-AH
 10437                                       WS-IG-OVRD.
 10438
 10439     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10440         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10441                                       WS-IG-OVRD
 10442     ELSE
 10443         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10444             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10445                                       WS-IG-OVRD
 10446         ELSE
 10447             MOVE AM-IG             TO WS-IG-OVRD-LF
 10448                                       WS-IG-OVRD.
 10449
 10450     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10451     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10452     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10453     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10454*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10455     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10456                                              TO 'PRLDSFCTIA'.
 10457
 10458     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10459     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 192
* EL050.cbl
 10460     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10461     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10462
 10463     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10464     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10465     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10466     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10467     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10468     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10469     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10470
 10471     IF WS-ACCT-AH-DEV-PCT > +0
 10472        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10473     ELSE
 10474        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10475
 10476     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10477        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10478     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10479        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10480
 10481        IF AM-EARN-METHOD-L = 'S'
 10482            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10483                                        WS-LF-REFUND-CALC.
 10484
 10485        IF AM-EARN-METHOD-R = 'S'
 10486            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10487                                        WS-LF-REFUND-CALC.
 10488
 10489     IF WS-LF-COVERAGE-TYPE = 'R'
 10490         IF AM-EARN-METHOD-R = 'R'
 10491            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10492                                    WS-LF-REFUND-CALC.
 10493     IF WS-LF-COVERAGE-TYPE = 'R'
 10494         IF AM-EARN-METHOD-R = 'P'
 10495            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10496                                    WS-LF-REFUND-CALC.
 10497     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10498         IF AM-EARN-METHOD-L = 'R'
 10499            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10500                                    WS-LF-REFUND-CALC.
 10501     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10502         IF AM-EARN-METHOD-L = 'P'
 10503            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10504                                    WS-LF-REFUND-CALC.
 10505     IF WS-LF-COVERAGE-TYPE = 'R'
 10506         IF AM-EARN-METHOD-R = 'A'
 10507            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10508                                    WS-LF-REFUND-CALC.
 10509     IF WS-LF-COVERAGE-TYPE = 'R'
 10510         IF AM-EARN-METHOD-R = 'M'
 10511            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10512                                    WS-LF-REFUND-CALC.
 10513     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10514         IF AM-EARN-METHOD-L = 'A'
 10515            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10516                                    WS-LF-REFUND-CALC.
 10517     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 193
* EL050.cbl
 10518         IF AM-EARN-METHOD-L = 'M'
 10519            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10520                                    WS-LF-REFUND-CALC.
 10521
 10522     IF AM-EARN-METHOD-A = 'R'
 10523        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10524                                    WS-AH-REFUND-CALC.
 10525     IF AM-EARN-METHOD-A = 'P'
 10526        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10527                                    WS-AH-REFUND-CALC.
 10528     IF AM-EARN-METHOD-A = 'C'
 10529        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10530                                    WS-AH-REFUND-CALC.
 10531     IF AM-EARN-METHOD-A = 'A'
 10532        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10533                                    WS-AH-REFUND-CALC.
 10534     IF AM-EARN-METHOD-A = 'M'
 10535        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10536                                    WS-AH-REFUND-CALC.
 10537     IF AM-EARN-METHOD-A = 'N'
 10538        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10539                                    WS-AH-REFUND-CALC.
 10540     IF AM-EARN-METHOD-A = 'S'
 10541        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10542                                    WS-AH-REFUND-CALC.
 10543
 10544     IF AM-TOL-PREM NOT = ZEROS
 10545        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10546                                    WS-TOL-AH-PREM.
 10547
 10548     IF AM-OVR-SHT-AMT NUMERIC AND
 10549                  AM-OVR-SHT-AMT > 0
 10550        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10551                                    EC-AM-LF-OVR-SHT-AMT
 10552                                    WS-AH-REFUND-OVS-AMT
 10553                                    EC-AM-AH-OVR-SHT-AMT.
 10554
 10555     IF AM-OVR-SHT-PCT NUMERIC AND
 10556                    AM-OVR-SHT-PCT > 0
 10557        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10558                                    EC-AM-LF-OVR-SHT-PCT
 10559                                    WS-AH-REFUND-OVS-PCT
 10560                                    EC-AM-AH-OVR-SHT-PCT.
 10561
 10562     IF AM-TOL-REF-PCT NUMERIC AND
 10563                  AM-TOL-REF-PCT > 0
 10564        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10565                                    WS-TOL-AH-REFUND-PCT.
 10566
 10567     IF AM-TOL-REF  NOT = ZEROS  AND
 10568                  AM-TOL-REF NUMERIC
 10569        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10570                                    EC-AM-LF-TOL-REFUND
 10571                                    WS-TOL-AH-REFUND
 10572                                    EC-AM-AH-TOL-REFUND.
 10573
 10574     IF AM-TOL-CLM  NOT = ZEROS
 10575        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 194
* EL050.cbl
 10576                                    WS-TOL-AH-CLAIM.
 10577
 10578     IF AM-CLP-TOL-PCT NOT NUMERIC
 10579        MOVE +0                  TO AM-CLP-TOL-PCT
 10580     END-IF
 10581
 10582     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10583        MOVE +0                  TO AM-SPP-LEASE-COMM
 10584     END-IF
 10585     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10586        MOVE WS-PL-TOL-LF-PREM-PCT
 10587                                 TO WS-TOL-LF-PREM-PCT.
 10588
 10589     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10590        MOVE WS-PL-TOL-AH-PREM-PCT
 10591                                 TO WS-TOL-AH-PREM-PCT.
 10592
 10593     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10594        MOVE WS-PL-TOL-LF-REFUND-PCT
 10595                                 TO WS-TOL-LF-REFUND-PCT.
 10596
 10597     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10598        MOVE WS-PL-TOL-AH-REFUND-PCT
 10599                                 TO WS-TOL-AH-REFUND-PCT.
 10600
 10601     IF WS-PL-REF-OVS-AMT > +0
 10602        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10603
 10604     IF WS-PL-REF-OVS-PCT > +0
 10605        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10606
 10607     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10608        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10609     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10610        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10611     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10612        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10613     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10614        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10615     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10616        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10617     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10618        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10619
 10620     IF WS-AH-PL-REF-OVS-AMT > +0
 10621        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10622
 10623     IF WS-AH-PL-REF-OVS-PCT > +0
 10624        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10625
 10626     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10627     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10628
 10629     IF PB-CANCELLATION
 10630        GO TO 3000-CONTINUE-EDIT.
 10631
 10632     MOVE +1 TO SUB1.
 10633     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 195
* EL050.cbl
 10634     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10635
 10636     IF CF-COMPANY-ID = 'DMD'
 10637       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10638         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10639        ELSE
 10640         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10641
 10642  0525-FIND-ACCT-COMM.
 10643     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10644        NEXT SENTENCE
 10645      ELSE
 10646         ADD +1 TO SUB1
 10647         IF SUB1 LESS +11
 10648            GO TO 0525-FIND-ACCT-COMM
 10649          ELSE
 10650             GO TO 0550-st-comm-cap-check.
 10651
 10652     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10653     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10654                                    PB-I-LIFE-COMMISSION.
 10655***  IF PB-COMPANY-ID = 'CRI'
 10656     IF PB-PREM-ACCTNG-ONLY
 10657         GO TO 0550-st-comm-cap-check.
 10658
 10659     MOVE '0530' TO CTBL-SW.
 10660     MOVE ' '    TO WS-CTBL-READ-SW.
 10661
 10662
 10663 0530-GET-AH-COMP.
 10664     IF NO-AH-COVERAGE  OR
 10665        NO-AH-BENEFIT-MATCH
 10666           GO TO 0540-NEXT-READ-STEP.
 10667
 10668     IF AM-A-COM (SUB1) NUMERIC
 10669        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10670         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10671         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10672         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10673         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10674     ELSE
 10675          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10676          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10677          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10678          MOVE ZEROS             TO WS-SUB1
 10679                                    WS-COMMISSION
 10680          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10681          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10682          IF WS-COMMISSION > ZEROS
 10683             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10684             GO TO 0540-NEXT-READ-STEP
 10685          END-IF
 10686          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10687          IF CTBL-TABLE-FOUND
 10688             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10689                                        PB-I-AH-TERM
 10690             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10691             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 196
* EL050.cbl
 10692             GO TO 0540-NEXT-READ-STEP
 10693          ELSE
 10694             IF FIRST-TIME-THROUGH
 10695                 GO TO 0530-GET-AH-COMP
 10696             ELSE
 10697                 MOVE ER-2609                TO WS-ERROR
 10698                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10699
 10700 0540-NEXT-READ-STEP.
 10701     MOVE '0540' TO CTBL-SW.
 10702     MOVE ' '    TO WS-CTBL-READ-SW.
 10703
 10704 0540-GET-LF-COMP.
 10705     IF NO-LIFE-COVERAGE  OR
 10706        NO-LF-BENEFIT-MATCH
 10707           GO TO 0550-st-comm-cap-check.
 10708
 10709     IF WS-LF-JOINT-INDICATOR = 'J'
 10710        IF AM-J-COM (SUB1) NUMERIC
 10711           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10712           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10713           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10714           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10715           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10716        ELSE
 10717           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10718           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10719           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10720           MOVE ZEROS                TO WS-SUB1
 10721                                        WS-COMMISSION
 10722           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10723           IF WS-COMMISSION > ZEROS
 10724              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10725              GO TO 0550-st-comm-cap-check
 10726           END-IF
 10727           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10728           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10729           IF CTBL-TABLE-FOUND
 10730              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10731              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10732              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10733              GO TO 0550-st-comm-cap-check
 10734           ELSE
 10735              IF FIRST-TIME-THROUGH
 10736                  GO TO 0540-GET-LF-COMP
 10737              ELSE
 10738                  MOVE ER-2609                TO WS-ERROR
 10739                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10740                  GO TO 0550-st-comm-cap-check.
 10741
 10742     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10743        IF AM-L-COM (SUB1) NUMERIC
 10744           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10745           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10746           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10747           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10748           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10749        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 197
* EL050.cbl
 10750           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10751           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10752           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10753           MOVE ZEROS                TO WS-SUB1
 10754                                        WS-COMMISSION
 10755           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10756           IF WS-COMMISSION IS GREATER THAN ZEROS
 10757              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10758              GO TO 0550-st-comm-cap-check
 10759           END-IF
 10760           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10761           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10762           IF CTBL-TABLE-FOUND
 10763              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10764              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10765              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10766              GO TO 0550-st-comm-cap-check
 10767           ELSE
 10768              IF FIRST-TIME-THROUGH
 10769                  GO TO 0540-GET-LF-COMP
 10770              ELSE
 10771                  MOVE ER-2609                TO WS-ERROR
 10772                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10773
 10774 0550-st-comm-cap-check.
 10775
 10776     move +0                     to ws-tot-sl-wk-rate
 10777                                    ws-sl-wk-rate
 10778                                    ws-ga-sl-wk-rate
 10779                                    ws-tot-jl-wk-rate
 10780                                    ws-jl-wk-rate
 10781                                    ws-ga-jl-wk-rate
 10782                                    ws-tot-sa-wk-rate
 10783                                    ws-sa-wk-rate
 10784                                    ws-ga-sa-wk-rate
 10785                                    ws-tot-ja-wk-rate
 10786                                    ws-ja-wk-rate
 10787                                    ws-ga-ja-wk-rate
 10788     perform varying sub5 from +1 by +1 until
 10789        (sub5 > +10)
 10790        move +0                  to ws-wk-rate
 10791        if (am-gl-codes (sub5) <> 'Y')
 10792           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10793           if pb-i-lf-benefit-cd <> '  ' and '00'
 10794              move zeros         to ws-wk-rate
 10795              if (am-l-com (sub5) numeric)
 10796                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10797                 move am-l-com(sub5)
 10798                                 to ws-wk-rate
 10799              else
 10800                 move pb-company-cd to ctbl-company-cd
 10801                 move pb-i-lf-benefit-cd
 10802                                 to ctbl-ben-code
 10803                 move pb-i-lf-term  to ws-work-term
 10804                 move pb-life-override-l1
 10805                                 to ctbl-ben-type
 10806                 move zeros      to ws-sub1
 10807                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 198
* EL050.cbl
 10808                 move am-l-coma (sub5)
 10809                                 to ctbl-table
 10810                 move '0540'     to ctbl-sw
 10811                 perform 0552-get-it
 10812                                 thru 0552-exit
 10813              end-if
 10814              compute ws-tot-sl-wk-rate =
 10815                 ws-tot-sl-wk-rate + ws-wk-rate
 10816              if am-com-typ(sub5) = 'C' or 'D'
 10817                 compute ws-sl-wk-rate =
 10818                    ws-sl-wk-rate + ws-wk-rate
 10819              else
 10820                 if am-com-typ(sub5) = 'O' or 'P'
 10821                    compute ws-ga-sl-wk-rate =
 10822                       ws-ga-sl-wk-rate + ws-wk-rate
 10823                 end-if
 10824              end-if
 10825
 10826              move zeros         to ws-wk-rate
 10827              if (am-j-com (sub5) numeric)
 10828                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10829                 move am-j-com(sub5)
 10830                                 to ws-wk-rate
 10831              else
 10832                 move pb-company-cd to ctbl-company-cd
 10833                 move pb-i-lf-benefit-cd
 10834                                 to ctbl-ben-code
 10835                 move pb-i-lf-term  to ws-work-term
 10836                 move pb-life-override-l1
 10837                                 to ctbl-ben-type
 10838                 move zeros      to ws-sub1
 10839                                    ws-commission
 10840                 move am-j-coma (sub5)
 10841                                 to ctbl-table
 10842                 move '0540'     to ctbl-sw
 10843                 perform 0552-get-it
 10844                                 thru 0552-exit
 10845              end-if
 10846              compute ws-tot-jl-wk-rate =
 10847                 ws-tot-jl-wk-rate + ws-wk-rate
 10848              if am-com-typ(sub5) = 'C' or 'D'
 10849                 compute ws-jl-wk-rate =
 10850                    ws-jl-wk-rate + ws-wk-rate
 10851              else
 10852                 if am-com-typ(sub5) = 'O' or 'P'
 10853                    compute ws-ga-jl-wk-rate =
 10854                       ws-ga-jl-wk-rate + ws-wk-rate
 10855                 end-if
 10856              end-if
 10857           end-if
 10858           move zeros            to ws-wk-rate
 10859
 10860           if pb-i-ah-benefit-cd <> '  ' and '00'
 10861              if (am-a-com (sub5) numeric)
 10862                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10863                 move am-a-com(sub5)
 10864                                 to ws-wk-rate
 10865              else
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 199
* EL050.cbl
 10866                 move pb-company-cd to ctbl-company-cd
 10867                 move pb-i-ah-benefit-cd
 10868                                 to ctbl-ben-code
 10869                 move pb-i-ah-term  to ws-work-term
 10870                 move pb-ah-override-l1
 10871                                 to ctbl-ben-type
 10872                 move zeros      to ws-sub1
 10873                                    ws-commission
 10874                 move am-a-coma (sub5)
 10875                                 to ctbl-table
 10876                 move '0530'     to ctbl-sw
 10877                 perform 0552-get-it
 10878                                 thru 0552-exit
 10879              end-if
 10880              compute ws-tot-sa-wk-rate =
 10881                 ws-tot-sa-wk-rate + ws-wk-rate
 10882              if am-com-typ(sub5) = 'C' or 'D'
 10883                 compute ws-sa-wk-rate =
 10884                    ws-sa-wk-rate + ws-wk-rate
 10885              else
 10886                 if am-com-typ(sub5) = 'O' or 'P'
 10887                    compute ws-ga-sa-wk-rate =
 10888                       ws-ga-sa-wk-rate + ws-wk-rate
 10889                 end-if
 10890              end-if
 10891           end-if
 10892        end-if
 10893     end-perform
 10894
 10895     go to 0550-continue
 10896
 10897     .
 10898 0552-get-it.
 10899
 10900     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10901     MOVE ZEROS                  TO WS-SUB1
 10902                                    WS-COMMISSION
 10903     MOVE ' '                    TO WS-CTBL-READ-SW
 10904     PERFORM 8300-READ-CTBL-TABLE
 10905                                 THRU 8300-EXIT
 10906     IF FIRST-TIME-THROUGH
 10907        MOVE 'AA'                TO CTBL-BEN-CODE
 10908        PERFORM 8300-READ-CTBL-TABLE
 10909                                 THRU 8300-EXIT
 10910     END-IF
 10911     IF CTBL-TABLE-FOUND
 10912        if pb-life-override-l1 = ctbl-ben-type
 10913           move pb-i-lf-benefit-amt
 10914                                 to WS-COMM-CK-AMT
 10915        else
 10916           compute ws-comm-ck-amt =
 10917              pb-I-ah-benefit-amt * pb-i-ah-term
 10918        end-if
 10919        PERFORM 8800-GET-COMP-RATE
 10920                                 THRU 8800-EXIT
 10921     else
 10922        move zeros               to ws-wk-rate
 10923     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 200
* EL050.cbl
 10924
 10925     .
 10926 0552-exit.
 10927     exit.
 10928
 10929 0550-continue.
 10930
 10931     if ws-lf-joint-indicator = 'J'
 10932        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10933           and (ws-st-comm-cap-jl <> zeros)
 10934           MOVE ER-1956          TO WS-ERROR
 10935           PERFORM 9900-ERROR-FORMAT
 10936                                 THRU 9900-EXIT
 10937        end-if
 10938        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10939           and (ws-st-ga-comm-cap-jl <> zeros)
 10940           MOVE ER-1959          TO WS-ERROR
 10941           PERFORM 9900-ERROR-FORMAT
 10942                                 THRU 9900-EXIT
 10943        end-if
 10944        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10945           and (ws-st-tot-comm-cap-jl <> zeros)
 10946           MOVE ER-1962          TO WS-ERROR
 10947           PERFORM 9900-ERROR-FORMAT
 10948                                 THRU 9900-EXIT
 10949        end-if
 10950     else
 10951        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10952           and (ws-st-comm-cap-sl <> zeros)
 10953           MOVE ER-1955          TO WS-ERROR
 10954           PERFORM 9900-ERROR-FORMAT
 10955                                 THRU 9900-EXIT
 10956        end-if
 10957        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10958           and (ws-st-ga-comm-cap-sl <> zeros)
 10959           MOVE ER-1958          TO WS-ERROR
 10960           PERFORM 9900-ERROR-FORMAT
 10961                                 THRU 9900-EXIT
 10962        end-if
 10963        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10964           and (ws-st-tot-comm-cap-sl <> zeros)
 10965           MOVE ER-1961          TO WS-ERROR
 10966           PERFORM 9900-ERROR-FORMAT
 10967                                 THRU 9900-EXIT
 10968        end-if
 10969
 10970     if ws-ah-joint-indicator = 'J'
 10971        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10972           and (ws-st-comm-cap-ja <> zeros)
 10973           MOVE ER-1957          TO WS-ERROR
 10974           PERFORM 9900-ERROR-FORMAT
 10975                                 THRU 9900-EXIT
 10976        end-if
 10977        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10978           and (ws-st-ga-comm-cap-ja <> zeros)
 10979           MOVE ER-1960          TO WS-ERROR
 10980           PERFORM 9900-ERROR-FORMAT
 10981                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 201
* EL050.cbl
 10982        end-if
 10983        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10984           and (ws-st-tot-comm-cap-ja <> zeros)
 10985           MOVE ER-1963          TO WS-ERROR
 10986           PERFORM 9900-ERROR-FORMAT
 10987                                 THRU 9900-EXIT
 10988        end-if
 10989     else
 10990        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 10991           and (ws-st-comm-cap-sa <> zeros)
 10992           MOVE ER-1957          TO WS-ERROR
 10993           PERFORM 9900-ERROR-FORMAT
 10994                                 THRU 9900-EXIT
 10995        end-if
 10996        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 10997           and (ws-st-ga-comm-cap-sa <> zeros)
 10998           MOVE ER-1960          TO WS-ERROR
 10999           PERFORM 9900-ERROR-FORMAT
 11000                                 THRU 9900-EXIT
 11001        end-if
 11002        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 11003           and (ws-st-tot-comm-cap-sa <> zeros)
 11004           MOVE ER-1963          TO WS-ERROR
 11005           PERFORM 9900-ERROR-FORMAT
 11006                                 THRU 9900-EXIT
 11007        end-if
 11008     end-if
 11009     .
 11010 0560-EDIT-CONTINUE.
 11011     MOVE ZEROS                  TO WS-LF-PMF-COMM
 11012                                    WS-AH-PMF-COMM
 11013*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 11014*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 11015     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 11016        (SUB1 > +10)
 11017        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 11018           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 11019           MOVE '0530'           TO CTBL-SW
 11020           MOVE ' '              TO WS-CTBL-READ-SW
 11021           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 11022           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 11023           MOVE '0540'           TO CTBL-SW
 11024           MOVE ' '              TO WS-CTBL-READ-SW
 11025           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 11026        END-IF
 11027     END-PERFORM
 11028     GO TO 0564-EDIT-CONTINUE
 11029     .
 11030 0561-CHECK-AH.
 11031     IF (NO-AH-COVERAGE)
 11032        OR (NO-AH-BENEFIT-MATCH)
 11033        CONTINUE
 11034     ELSE
 11035        IF (AM-A-COM (SUB1) NUMERIC)
 11036           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11037           IF (AM-COM-TYP (SUB1) = 'A')
 11038              AND (WS-AH-PMF-COMM = ZEROS)
 11039              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 202
* EL050.cbl
 11040           END-IF
 11041           CONTINUE
 11042        ELSE
 11043           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 11044           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 11045           MOVE PB-AH-OVERRIDE-L1
 11046                                 TO CTBL-BEN-TYPE
 11047           MOVE ZEROS            TO WS-SUB1
 11048                                    WS-COMMISSION
 11049           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11050           PERFORM 8300-READ-CTBL-TABLE
 11051                                 THRU 8300-EXIT
 11052           IF CTBL-TABLE-FOUND
 11053              IF (AM-COM-TYP (SUB1) = 'A')
 11054                 AND (WS-AH-PMF-COMM = ZEROS)
 11055                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11056                                        PB-I-AH-TERM
 11057                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11058                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11059              END-IF
 11060              CONTINUE
 11061           ELSE
 11062              IF FIRST-TIME-THROUGH
 11063                 GO TO 0561-CHECK-AH
 11064              ELSE
 11065                 MOVE ER-2609    TO WS-ERROR
 11066                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11067              END-IF
 11068           END-IF
 11069        END-IF
 11070     END-IF
 11071     .
 11072 0561-EXIT.
 11073     EXIT.
 11074 0563-CHECK-LF.
 11075     IF (NO-LIFE-COVERAGE)
 11076        OR (NO-LF-BENEFIT-MATCH)
 11077        CONTINUE
 11078     ELSE
 11079        IF WS-LF-JOINT-INDICATOR = 'J'
 11080           IF AM-J-COM (SUB1) NUMERIC
 11081              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11082              IF (AM-COM-TYP (SUB1) = 'A')
 11083                 AND (WS-LF-PMF-COMM = ZEROS)
 11084                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11085              END-IF
 11086              CONTINUE
 11087           ELSE
 11088              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11089              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11090              MOVE PB-LIFE-OVERRIDE-L1
 11091                                 TO CTBL-BEN-TYPE
 11092              MOVE ZEROS         TO WS-SUB1
 11093                                    WS-COMMISSION
 11094              MOVE AM-J-COMA (SUB1)
 11095                                 TO CTBL-TABLE
 11096              PERFORM 8300-READ-CTBL-TABLE
 11097                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 203
* EL050.cbl
 11098              IF CTBL-TABLE-FOUND
 11099                 IF (AM-COM-TYP (SUB1) = 'A')
 11100                    AND (WS-LF-PMF-COMM = ZEROS)
 11101                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11102                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11103                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11104                 END-IF
 11105                 CONTINUE
 11106              ELSE
 11107                 IF FIRST-TIME-THROUGH
 11108                    GO TO 0563-CHECK-LF
 11109                 ELSE
 11110                    MOVE ER-2609 TO WS-ERROR
 11111                    PERFORM 9900-ERROR-FORMAT
 11112                                 THRU 9900-EXIT
 11113*                   GO TO 0560-EDIT-CONTINUE
 11114                 END-IF
 11115              END-IF
 11116           END-IF
 11117        ELSE
 11118           IF AM-L-COM (SUB1) NUMERIC
 11119              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11120              IF (AM-COM-TYP (SUB1) = 'A')
 11121                 AND (WS-LF-PMF-COMM = ZEROS)
 11122                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11123              END-IF
 11124              CONTINUE
 11125           ELSE
 11126              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11127              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11128              MOVE PB-LIFE-OVERRIDE-L1
 11129                                 TO CTBL-BEN-TYPE
 11130              MOVE ZEROS         TO WS-SUB1
 11131                                    WS-COMMISSION
 11132              MOVE AM-L-COMA (SUB1)
 11133                                 TO CTBL-TABLE
 11134              PERFORM 8300-READ-CTBL-TABLE
 11135                                 THRU 8300-EXIT
 11136              IF CTBL-TABLE-FOUND
 11137                 CONTINUE
 11138              ELSE
 11139                 IF FIRST-TIME-THROUGH
 11140                    GO TO 0563-CHECK-LF
 11141                 ELSE
 11142                    MOVE ER-2609 TO WS-ERROR
 11143                    PERFORM 9900-ERROR-FORMAT
 11144                                 THRU 9900-EXIT
 11145                 END-IF
 11146              END-IF
 11147           END-IF
 11148        END-IF
 11149     END-IF
 11150     .
 11151 0563-EXIT.
 11152     EXIT.
 11153 0564-EDIT-CONTINUE.
 11154
 11155     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 204
* EL050.cbl
 11156         IF PB-I-NUM-BILLED EQUAL ZEROS
 11157            MOVE ER-8148       TO WS-ERROR
 11158            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11159
 11160*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11161*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11162*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11163*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11164*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11165*         IF NO-CONVERSION-ERROR
 11166*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11167*         ELSE
 11168*             IF PB-COMPANY-ID EQUAL 'HAN'
 11169*                 MOVE ZEROS     TO PB-I-AGE.
 11170     IF PB-I-BIRTHDAY > LOW-VALUES
 11171        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11172        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11173        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11174        PERFORM 8500-DATE-CONVERT
 11175                                 THRU 8500-EXIT
 11176        IF NO-CONVERSION-ERROR
 11177           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11178           IF PB-I-AGE > ZEROS
 11179              IF WS-WORK-AGE NOT = PB-I-AGE
 11180                 MOVE ER-9501    TO WS-ERROR
 11181                 PERFORM 9900-ERROR-FORMAT
 11182                                 THRU 9900-EXIT
 11183              END-IF
 11184           ELSE
 11185              MOVE WS-WORK-AGE   TO PB-I-AGE
 11186           END-IF
 11187        END-IF
 11188     END-IF
 11189     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11190                                   WS-INS-AGE-SET
 11191     IF PB-I-AGE = ZEROS
 11192        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11193           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11194                                   WS-INS-AGE-SET
 11195           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11196
 11197     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11198                                   WS-AH-EDIT-AGE.
 11199
 11200     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11201        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11202        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11203        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11204        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11205        IF NO-CONVERSION-ERROR
 11206           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11207           IF PB-I-JOINT-AGE > 0
 11208              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11209                 MOVE ER-9503    TO WS-ERROR
 11210                 PERFORM 9900-ERROR-FORMAT
 11211                                 THRU 9900-EXIT
 11212              END-IF
 11213           ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 205
* EL050.cbl
 11214              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11215           END-IF
 11216        ELSE
 11217           MOVE ZEROS            TO PB-I-JOINT-AGE
 11218        END-IF
 11219     END-IF
 11220     IF PB-I-JOINT-AGE NOT NUMERIC
 11221        MOVE ZERO               TO PB-I-JOINT-AGE.
 11222
 11223     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11224                                   WS-JNT-AGE-SET
 11225     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11226        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11227           (WS-AH-JOINT-INDICATOR = 'J')
 11228           IF PB-I-JOINT-AGE = ZEROS
 11229               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11230                                          WS-JNT-AGE-SET
 11231               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11232           END-IF
 11233        END-IF
 11234     END-IF
 11235
 11236     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11237     IF WS-LF-JOINT-INDICATOR = 'J'
 11238        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11239        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11240            IF  PB-I-JOINT-AGE = ZERO
 11241                MOVE ER-2686       TO WS-ERROR
 11242                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11243            ELSE
 11244                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11245                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11246                    IF PB-COMPANY-ID NOT = 'LBL'
 11247                        MOVE ER-2685    TO WS-ERROR
 11248                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11249
 11250     IF WS-AH-JOINT-INDICATOR = 'J'
 11251        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11252            IF  PB-I-JOINT-AGE = ZERO
 11253                MOVE ER-2686       TO WS-ERROR
 11254                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11255            ELSE
 11256                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11257                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11258                                           WS-EDIT-AGE
 11259                    IF PB-COMPANY-ID NOT = 'LBL'
 11260                        MOVE ER-2685    TO WS-ERROR
 11261                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11262
 11263******************************************************************
 11264*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11265******************************************************************
 11266
 11267     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11268        (WS-AH-SPECIAL-CALC-CD = 'O')
 11269        NEXT SENTENCE
 11270     ELSE
 11271        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 206
* EL050.cbl
 11272          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11273           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11274            WS-AH-JOINT-INDICATOR = 'J')  AND
 11275           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11276            MOVE ER-2627             TO WS-ERROR
 11277            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11278
 11279     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11280        (WS-AH-SPECIAL-CALC-CD = 'O')
 11281         NEXT SENTENCE
 11282     ELSE
 11283         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11284            WS-AH-JOINT-INDICATOR = 'J'
 11285             IF PB-I-JOINT-INSURED = SPACES
 11286                 IF PB-COMPANY-ID NOT = 'JAL'
 11287                     MOVE ER-2696    TO WS-ERROR
 11288                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11289
 11290     IF PB-COMPANY-ID NOT = 'BOA'
 11291        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11292           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11293           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11294               PB-I-JOINT-INSURED NOT = SPACES)
 11295                MOVE ER-2691         TO WS-ERROR
 11296                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11297
 11298     IF PB-COMPANY-ID = 'BOA'
 11299        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11300           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11301            IF PB-I-JOINT-AGE NOT = ZEROS
 11302                MOVE ER-2691         TO WS-ERROR
 11303                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11304
 11305     IF PB-COMPANY-ID = 'CRI'
 11306        IF PB-I-SIG-SW = 'J'
 11307           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11308              WS-AH-JOINT-INDICATOR NOT = 'J'
 11309              MOVE ER-2675       TO WS-ERROR
 11310              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11311
 11312     IF PB-COMPANY-ID = 'CRI'
 11313        IF PB-I-SIG-SW = 'S'
 11314           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11315              WS-AH-JOINT-INDICATOR = 'J'
 11316              MOVE ER-2676       TO WS-ERROR
 11317              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11318
 11319     IF PB-COMPANY-ID = 'CVL'
 11320         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11321            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11322              MOVE ER-2783           TO WS-ERROR
 11323              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11324     IF (WS-LF-JOINT-INDICATOR = 'J')
 11325        AND (WS-AH-JOINT-INDICATOR = 'J')
 11326        AND (PB-I-LF-TERM > 120)
 11327        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11328        MOVE ER-2783             TO WS-ERROR
 11329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 207
* EL050.cbl
 11330     END-IF
 11331     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11332
 11333     IF PB-I-INDV-GRP-OVRD = 'I'
 11334        MOVE ER-2666             TO WS-ERROR
 11335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11336        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11337
 11338     IF PB-I-INDV-GRP-OVRD = 'G'
 11339        MOVE ER-2666             TO WS-ERROR
 11340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11341        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11342
 11343     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11344        NEXT SENTENCE
 11345     ELSE
 11346        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11347
 11348     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11349        IF WS-ERROR = ER-2666
 11350           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11351           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11352
 11353     IF PB-COMPANY-ID = 'CID'
 11354        IF PB-STATE = 'UT' OR 'MO'
 11355           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11356                 OR '76' OR '77')
 11357                      OR
 11358               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11359                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11360                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11361                   OR '2K' OR '2L'))
 11362              AND PB-I-INDV-GRP-CD = 'I'
 11363              MOVE ER-2721             TO WS-ERROR
 11364              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11365           END-IF
 11366        END-IF
 11367     END-IF
 11368
 11369     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11370     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11371        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11372     ELSE
 11373        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11374     END-IF
 11375
 11376*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11377*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11378     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11379                                    ACCOUNT-AH-CK-SW.
 11380
 11381     IF PB-REISSUED-CERT       OR
 11382        PB-REIN-ONLY-CERT      OR
 11383        PB-POLICY-IS-DECLINED  OR
 11384        PB-POLICY-IS-VOIDED
 11385*       OR PB-MONTHLY-CERT
 11386         GO TO 3000-CONTINUE-EDIT.
 11387
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 208
* EL050.cbl
 11388     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11389        IF WS-EDIT-AGE           > +65
 11390           MOVE ER-2709          TO WS-ERROR
 11391           PERFORM 9900-ERROR-FORMAT
 11392                                 THRU 9900-EXIT
 11393        ELSE
 11394           IF WS-EDIT-AGE        > +55
 11395              MOVE ER-2718       TO WS-ERROR
 11396              PERFORM 9900-ERROR-FORMAT
 11397                                 THRU 9900-EXIT
 11398           END-IF
 11399        END-IF
 11400     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11401        IF WS-EDIT-AGE           > +65
 11402           MOVE ER-2709          TO WS-ERROR
 11403           PERFORM 9900-ERROR-FORMAT
 11404                                 THRU 9900-EXIT
 11405        END-IF
 11406     END-IF
 11407     .
 11408
 11409 0565-LIFE-PLAN-LIMIT-EDITS.
 11410
 11411     IF NOT LF-PLAN-MASTER-FOUND
 11412        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11413                                    EC-AM-LF-MAX-TOT-BEN
 11414        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11415
 11416     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11417
 11418     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11419         IF PL-LM-AGE (1) = ZEROS
 11420             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11421
 11422     IF NO-LF-BENEFIT-MATCH          OR
 11423        WS-LF-BENEFIT-CD = ZEROS     OR
 11424        WS-LF-SPECIAL-CALC-CD = 'M'
 11425        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11426
 11427     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11428     MOVE +1                     TO SUB2.
 11429
 11430     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11431        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11432           MOVE +5   TO SUB2
 11433           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11434              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11435              (PL-LM-AGE (SUB2) EQUAL +0)
 11436              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11437              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11438
 11439     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11440
 11441     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11442                               + PB-I-LF-ALT-BENEFIT-AMT.
 11443
 11444 0568-CHECK-LIFE-ATT-AGE.
 11445
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 209
* EL050.cbl
 11446     IF PL-ATT-AGE NUMERIC AND
 11447        PL-ATT-AGE > +0
 11448        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11449     END-IF
 11450*    IF PL-ATT-AGE NUMERIC AND
 11451*       PL-ATT-AGE > +0
 11452*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11453*       IF PB-I-BIRTHDAY > LOW-VALUES
 11454*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11455*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11456*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11457*          SET BIN-PLUS-ELAPSED  TO TRUE
 11458*          PERFORM 8500-DATE-CONVERT
 11459*                                THRU 8500-EXIT
 11460*          IF NO-CONVERSION-ERROR
 11461*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11462*             MOVE ER-2669       TO WS-ERROR
 11463*             PERFORM 9900-ERROR-FORMAT
 11464*                                THRU 9900-EXIT
 11465*          END-IF
 11466*       ELSE
 11467*          IF WS-ATT-AGE >= PL-ATT-AGE
 11468*             MOVE ER-2669       TO WS-ERROR
 11469*             PERFORM 9900-ERROR-FORMAT
 11470*                                THRU 9900-EXIT
 11471*          END-IF
 11472*       END-IF
 11473*    END-IF
 11474     .
 11475 0570-CHECK-LIFE-LIMITS.
 11476
 11477     IF PB-COMPANY-ID EQUAL 'CRI'
 11478        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11479           IF SUB2 GREATER THAN +4
 11480              MOVE ER-2637 TO WS-ERROR
 11481              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11482              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11483
 11484     IF PB-COMPANY-ID  =  'NCL'
 11485        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11486            SUB2 GREATER THAN +8
 11487             MOVE 'U'         TO PB-BATCH-ENTRY
 11488             MOVE ER-2637     TO WS-ERROR
 11489             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11490             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11491
 11492     IF SUB2 > +8
 11493        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11494           AND (PB-I-SIG-SW = 'Y')
 11495           CONTINUE
 11496        ELSE
 11497           MOVE ER-2637          TO WS-ERROR
 11498           PERFORM 9900-ERROR-FORMAT
 11499                                 THRU 9900-EXIT
 11500        END-IF
 11501        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11502     END-IF
 11503     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 210
* EL050.cbl
 11504     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11505     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11506
 11507     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11508        ADD +1  TO SUB2
 11509        GO TO 0570-CHECK-LIFE-LIMITS.
 11510
 11511     IF PB-COMPANY-ID = 'NCL'
 11512         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11513
 11514     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11515        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11516        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11517           AND (PB-I-SIG-SW = 'Y')
 11518           CONTINUE
 11519        ELSE
 11520           MOVE ER-2637          TO WS-ERROR
 11521           PERFORM 9900-ERROR-FORMAT
 11522                                 THRU 9900-EXIT
 11523        END-IF
 11524     END-IF
 11525     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11526
 11527
 11528 0570-CHECK-NCL-LIFE-LIMITS.
 11529
 11530     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11531        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11532         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11533
 11534     IF APP-CERT-USED
 11535         IF SUB2  LESS THAN  +5
 11536             MOVE +5          TO SUB2
 11537             GO TO 0570-CHECK-LIFE-LIMITS.
 11538
 11539     MOVE ER-2637             TO WS-ERROR.
 11540     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11541
 11542     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11543
 11544 0575-CHECK-NCL-SIG-SWITCH.
 11545
 11546     IF NOT APP-CERT-USED
 11547         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11548
 11549     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11550        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11551        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11552        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11553         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11554
 11555     IF SUB2 GREATER THAN +4
 11556         IF PL-LM-AGE (5) = ZEROS  AND
 11557            PL-LM-AGE (6) = ZEROS  AND
 11558            PL-LM-AGE (7) = ZEROS  AND
 11559            PL-LM-AGE (8) = ZEROS
 11560             MOVE  ER-1927        TO WS-ERROR
 11561             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 211
* EL050.cbl
 11562             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11563         ELSE
 11564             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11565                 MOVE  ER-1920    TO WS-ERROR
 11566                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11567
 11568     IF PB-I-SIG-SW  = 'Y'
 11569       IF NOT PB-I-POLICY-ACCEPTED  AND
 11570          NOT PB-I-POLICY-DECLINED
 11571           MOVE 'U'               TO PB-BATCH-ENTRY
 11572           MOVE  ER-1926          TO WS-ERROR
 11573           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11574
 11575
 11576 0580-AH-PLAN-LIMIT-EDITS.
 11577
 11578     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11579        IF PB-I-AH-BENEFIT-AMT > +1250
 11580           MOVE ER-2702          TO WS-ERROR
 11581           PERFORM 9900-ERROR-FORMAT
 11582                                 THRU 9900-EXIT
 11583        END-IF
 11584     END-IF
 11585
 11586     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11587        AND (PB-MONTHLY-CERT)
 11588        IF PB-I-AH-BENEFIT-AMT > +3000
 11589           MOVE ER-2881          TO WS-ERROR
 11590           PERFORM 9900-ERROR-FORMAT
 11591                                 THRU 9900-EXIT
 11592        END-IF
 11593     END-IF
 11594     IF NOT AH-PLAN-MASTER-FOUND
 11595        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11596        GO TO 3000-CONTINUE-EDIT.
 11597
 11598     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11599
 11600     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11601         IF PL-LM-AGE (1) = ZEROS
 11602             GO TO 3000-CONTINUE-EDIT.
 11603
 11604     IF NO-AH-BENEFIT-MATCH          OR
 11605        WS-AH-BENEFIT-CD = ZEROS     OR
 11606        WS-AH-SPECIAL-CALC-CD = 'M'
 11607        GO TO 3000-CONTINUE-EDIT.
 11608
 11609     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11610     MOVE +1                     TO SUB2.
 11611
 11612     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11613        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11614           MOVE +5 TO SUB2
 11615           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11616              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11617              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11618              (PL-LM-AGE (SUB2) EQUAL +0)
 11619              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 212
* EL050.cbl
 11620              GO TO 3000-CONTINUE-EDIT.
 11621
 11622     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11623
 11624 0590-CHECK-AH-ATT-AGE.
 11625
 11626     IF PL-ATT-AGE NUMERIC AND
 11627        PL-ATT-AGE GREATER THAN +0
 11628        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11629     END-IF
 11630*       IF WS-ATT-AGE >= PL-ATT-AGE
 11631*          MOVE ER-3054          TO WS-ERROR
 11632*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11633     .
 11634 0597-CHECK-AH-LIMITS.
 11635
 11636     IF PB-COMPANY-ID EQUAL 'CRI'
 11637        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11638           IF SUB2 GREATER THAN +4
 11639              MOVE ER-2638       TO WS-ERROR
 11640              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11641              GO TO 3000-CONTINUE-EDIT.
 11642
 11643     IF PB-COMPANY-ID  =  'NCL'
 11644        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11645            SUB2 GREATER THAN +8
 11646             MOVE 'U'            TO PB-BATCH-ENTRY
 11647             MOVE ER-2638        TO WS-ERROR
 11648             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11649             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11650
 11651     IF SUB2 > +8
 11652        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11653           AND (PB-I-SIG-SW = 'Y')
 11654           CONTINUE
 11655        ELSE
 11656           MOVE ER-2638          TO WS-ERROR
 11657           PERFORM 9900-ERROR-FORMAT
 11658                                 THRU 9900-EXIT
 11659        END-IF
 11660        GO TO 3000-CONTINUE-EDIT
 11661     END-IF
 11662
 11663     IF PB-COMPANY-ID = 'CRI'
 11664        IF WS-ERROR = ER-2638
 11665           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11666
 11667     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11668     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11669     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11670     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11671
 11672     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11673        ADD +1                   TO SUB2
 11674        GO TO 0597-CHECK-AH-LIMITS.
 11675
 11676     IF PB-COMPANY-ID = 'NCL'
 11677         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 213
* EL050.cbl
 11678
 11679     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11680        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11681        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11682                                 > PL-LM-AMT (SUB2))
 11683        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11684           AND (PB-I-SIG-SW = 'Y')
 11685           CONTINUE
 11686        ELSE
 11687           MOVE ER-2638          TO WS-ERROR
 11688           PERFORM 9900-ERROR-FORMAT
 11689                                 THRU 9900-EXIT
 11690        END-IF
 11691     END-IF
 11692
 11693     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11694         IF  WS-ERROR    EQUAL    ER-2638
 11695             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11696                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11697                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11698                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11699                MOVE  ER-1910    TO  WS-ERROR
 11700                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11701
 11702     IF PB-COMPANY-ID = 'CRI'
 11703        IF WS-ERROR = ER-2638
 11704            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11705            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11706            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11707
 11708     GO TO 3000-CONTINUE-EDIT.
 11709
 11710 0597-CHECK-NCL-AH-LIMITS.
 11711
 11712     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11713        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11714        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11715                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11716         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11717
 11718     IF APP-CERT-USED
 11719         IF SUB2  LESS THAN  +5
 11720             MOVE +5             TO SUB2
 11721             GO TO 0597-CHECK-AH-LIMITS.
 11722
 11723     MOVE ER-2638                TO WS-ERROR.
 11724     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11725
 11726     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11727
 11728 0599-CHECK-NCL-SIG-SWITCH.
 11729
 11730     IF NOT APP-CERT-USED
 11731         GO TO 3000-CONTINUE-EDIT.
 11732
 11733     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11734        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11735        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 214
* EL050.cbl
 11736        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11737         GO TO 3000-CONTINUE-EDIT.
 11738
 11739     IF SUB2 GREATER THAN +4
 11740         IF PL-LM-AGE (5) = ZEROS  AND
 11741            PL-LM-AGE (6) = ZEROS  AND
 11742            PL-LM-AGE (7) = ZEROS  AND
 11743            PL-LM-AGE (8) = ZEROS
 11744             MOVE  ER-1927        TO WS-ERROR
 11745             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11746             GO TO 3000-CONTINUE-EDIT
 11747         ELSE
 11748             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11749                 MOVE  ER-1920    TO WS-ERROR
 11750                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11751
 11752     IF PB-I-SIG-SW  = 'Y'
 11753       IF NOT PB-I-POLICY-ACCEPTED  AND
 11754          NOT PB-I-POLICY-DECLINED
 11755           MOVE 'U'               TO PB-BATCH-ENTRY
 11756           MOVE  ER-1926          TO WS-ERROR
 11757           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11758
 11759******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 215
* EL050.cbl
 11761
 11762 3000-CONTINUE-EDIT.
 11763
 11764     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11765     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11766     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11767     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11768     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11769
 11770     IF BROWSE-STARTED
 11771        PERFORM 9990-RETURN THRU 9990-EXIT
 11772        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11773
 11774     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11775        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11776        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11777        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11778*       MOVE 1                   TO DC-OPTION-CODE
 11779        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11780        IF DATE-CONVERSION-ERROR
 11781           MOVE ER-2622          TO WS-ERROR
 11782           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11783        ELSE
 11784           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11785              MOVE ER-2623       TO WS-ERROR
 11786              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11787           ELSE
 11788              MOVE ER-2622       TO WS-ERROR
 11789              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11790
 11791     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11792     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11793     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11794*    MOVE 1                      TO DC-OPTION-CODE.
 11795     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11796     IF DATE-CONVERSION-ERROR
 11797        GO TO 3005-EDIT-CONTINUE
 11798     ELSE
 11799        IF DC-ELAPSED-DAYS GREATER +180
 11800           MOVE ER-2613          TO WS-ERROR
 11801           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11802        ELSE
 11803           IF DC-ELAPSED-DAYS GREATER +90
 11804              MOVE ER-2612       TO WS-ERROR
 11805              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11806           ELSE
 11807             IF DC-ELAPSED-DAYS GREATER +60
 11808                MOVE ER-2614     TO WS-ERROR
 11809                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11810
 11811 3005-EDIT-CONTINUE.
 11812
 11813     IF PB-CANCELLATION
 11814         GO TO 3700-EDIT-CANCEL.
 11815
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 216
* EL050.cbl
 11817******************************************************************
 11818*                  E D I T   I S S U E                           *
 11819******************************************************************
 11820
 11821 3020-EDIT-ISSUE.
 11822
 11823      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11824      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11825      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11826      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11827      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11828
 11829     IF PB-ISSUE-FORCE
 11830        OR PB-ISSUE-DATE-FORCED
 11831        OR PB-FORCE-OFF
 11832        OR PB-OVERCHARGE-FORCE
 11833        or pb-exceeded-limit-forced
 11834        CONTINUE
 11835     ELSE
 11836        MOVE ER-2670             TO WS-ERROR
 11837        PERFORM 9900-ERROR-FORMAT
 11838                                 THRU 9900-EXIT
 11839     END-IF
 11840     .
 11841 3022-SET-POLICY-STATUS.
 11842
 11843     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11844
 11845     IF (PB-REISSUED-CERT)
 11846             OR
 11847        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11848         AND (PB-MONTHLY-CERT))
 11849         MOVE '5'                TO PB-I-ENTRY-STATUS
 11850         MOVE 'E'                TO PB-BATCH-ENTRY
 11851     END-IF
 11852
 11853     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11854        IF PB-MONTHLY-CERT
 11855           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11856        END-IF
 11857        IF PB-CASH-CERT
 11858           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11859        END-IF
 11860     END-IF
 11861     IF PB-POLICY-IS-DECLINED
 11862         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11863     IF PB-POLICY-IS-VOIDED
 11864         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11865     IF PB-NEEDS-UNDERWRITING
 11866         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11867     IF PB-REIN-ONLY-CERT
 11868         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11869     IF PB-PREM-ACCTNG-ONLY
 11870         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11871
 11872     MOVE SPACE                  TO PB-I-OB-FLAG.
 11873
 11874     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 217
* EL050.cbl
 11875         MOVE ER-2665            TO WS-ERROR
 11876         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11877         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11878
 11879     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11880        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11881           MOVE 'Z'             TO PB-I-OB-FLAG.
 11882
 11883     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11884        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11885           MOVE 'Z'             TO PB-I-OB-FLAG.
 11886
 11887     IF ACCOUNT-MAST-FOUND
 11888         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11889         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11890         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11891         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11892         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11893         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11894         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11895     END-IF
 11896
 11897     IF ACCOUNT-MAST-FOUND
 11898        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11899         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11900
 11901     IF (ACCOUNT-MAST-FOUND)
 11902*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11903        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11904        IF PB-REISSUED-CERT
 11905           CONTINUE
 11906        ELSE
 11907           MOVE ER-2608          TO WS-ERROR
 11908           PERFORM 9900-ERROR-FORMAT
 11909                                 THRU 9900-EXIT
 11910         END-IF
 11911     END-IF
 11912
 11913     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11914        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11915        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11916
 11917**********   DMD CUSTOM CODE FOLLOWS  **********
 11918 3024-EDIT-DMD-FIELDS.
 11919     IF PB-COMPANY-ID NOT = 'DMD'
 11920        GO TO 3025-EDIT-REINSURANCE.
 11921
 11922*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11923*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11924*** ERROR IF THEY ARE NOT EQUAL.
 11925
 11926     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11927     SET BIN-TO-GREG               TO TRUE.
 11928     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11929     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11930**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11931
 11932     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 218
* EL050.cbl
 11933     SET BIN-TO-GREG               TO TRUE.
 11934     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11935     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11936**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11937
 11938     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11939        MOVE ER-8116               TO WS-ERROR
 11940        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11941
 11942     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11943
 11944     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11945                                      WK-FULL-CERT-NO.
 11946     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11947
 11948     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11949
 11950     IF PB-VALID-LIFE
 11951        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11952     ELSE
 11953        IF PB-VALID-AH
 11954          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11955
 11956
 11957     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11958     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11959     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11960                                      DCUA-UNDRWRTR-CODE
 11961                                      DCUA-UNDRWRTR-GROUP-CODE
 11962                                      DCUA-RETURN-CODE.
 11963
 11964****************************************************************
 11965*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11966***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11967***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11968***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11969***   TO THIS RECORD.                                        ***
 11970****************************************************************
 11971     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11972     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11973     IF DCUA-SUCCESSFUL-PROCESS
 11974        GO TO 3024-EDIT-DL7-CONT.
 11975
 11976     IF DCUA-RETURN-CODE EQUAL '01'
 11977        MOVE ER-8110               TO WS-ERROR
 11978        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11979        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11980        GO TO 3024-EDIT-DL7-CONT.
 11981
 11982     IF DCUA-RETURN-CODE EQUAL '02'
 11983        MOVE ER-8111               TO WS-ERROR
 11984        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11985        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11986        GO TO 3024-EDIT-DL7-CONT.
 11987
 11988     IF DCUA-RETURN-CODE EQUAL '03'
 11989        MOVE ER-8074               TO WS-ERROR
 11990        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 219
* EL050.cbl
 11991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11992        GO TO 3024-EDIT-DL7-CONT.
 11993
 11994     IF DCUA-RETURN-CODE EQUAL '04'
 11995        MOVE ER-8075               TO WS-ERROR
 11996        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11998        GO TO 3024-EDIT-DL7-CONT.
 11999
 12000     IF DCUA-RETURN-CODE EQUAL '05'
 12001        MOVE ER-8076               TO WS-ERROR
 12002        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12003        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12004        GO TO 3024-EDIT-DL7-CONT.
 12005
 12006     IF DCUA-RETURN-CODE EQUAL '06'
 12007        MOVE ER-8077               TO WS-ERROR
 12008        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12010        GO TO 3024-EDIT-DL7-CONT.
 12011
 12012     IF DCUA-RETURN-CODE EQUAL '07'
 12013        MOVE ER-8078               TO WS-ERROR
 12014        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12015        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12016        GO TO 3024-EDIT-DL7-CONT.
 12017
 12018     IF DCUA-RETURN-CODE EQUAL 'E1'
 12019        MOVE ER-8079               TO WS-ERROR
 12020        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12021        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12022        GO TO 3024-EDIT-DL7-CONT.
 12023
 12024     IF DCUA-RETURN-CODE EQUAL 'E2'
 12025        MOVE ER-8080               TO WS-ERROR
 12026        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12027        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12028        GO TO 3024-EDIT-DL7-CONT.
 12029
 12030     IF DCUA-RETURN-CODE EQUAL 'E3'
 12031        MOVE ER-8098               TO WS-ERROR
 12032        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12033        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12034        GO TO 3024-EDIT-DL7-CONT.
 12035
 12036     IF DCUA-RETURN-CODE EQUAL 'C1'
 12037        MOVE ER-8099               TO WS-ERROR
 12038        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12039        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12040        GO TO 3024-EDIT-DL7-CONT.
 12041
 12042     IF DCUA-RETURN-CODE EQUAL 'U1'
 12043        MOVE ER-8109               TO WS-ERROR
 12044        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12045        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12046        GO TO 3024-EDIT-DL7-CONT.
 12047
 12048     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 220
* EL050.cbl
 12049        MOVE ER-8112               TO WS-ERROR
 12050        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12051        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12052        GO TO 3024-EDIT-DL7-CONT.
 12053
 12054     IF DCUA-RETURN-CODE EQUAL 'N2'
 12055        MOVE ER-8113               TO WS-ERROR
 12056        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12057        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12058        GO TO 3024-EDIT-DL7-CONT.
 12059
 12060     IF DCUA-RETURN-CODE EQUAL 'N3'
 12061        MOVE ER-8114               TO WS-ERROR
 12062        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12063        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12064        GO TO 3024-EDIT-DL7-CONT.
 12065
 12066     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12067     MOVE ER-8097                  TO WS-ERROR.
 12068     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12069     GO TO 3024-EDIT-DL7-CONT.
 12070
 12071 3024-EDIT-DL7-CONT.
 12072
 12073     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12074     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12075     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12076        NEXT SENTENCE
 12077     ELSE
 12078        MOVE ER-9263               TO WS-ERROR
 12079        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12080
 12081******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12082******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12083     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12084        NEXT SENTENCE
 12085     ELSE
 12086        MOVE ER-8039               TO WS-ERROR
 12087        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12088
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 221
* EL050.cbl
 12090****************************************************************
 12091*** VALIDATE STATE  : DLO022                                 ***
 12092****************************************************************
 12093     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12094     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12095
 12096     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12097     IF DVSC-SUCCESSFUL-EDIT
 12098        GO TO 3024-EDIT-DL22-CONT.
 12099
 12100     IF DVSC-RETURN-CODE EQUAL '01'
 12101        MOVE ER-8300               TO WS-ERROR
 12102        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12103        GO TO 3024-EDIT-DL22-CONT.
 12104
 12105     IF DVSC-RETURN-CODE EQUAL '02'
 12106        MOVE ER-8301               TO WS-ERROR
 12107        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12108        GO TO 3024-EDIT-DL22-CONT.
 12109
 12110     IF DVSC-RETURN-CODE EQUAL '03'
 12111        MOVE ER-8302               TO WS-ERROR
 12112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12113        GO TO 3024-EDIT-DL22-CONT.
 12114
 12115     IF DVSC-RETURN-CODE EQUAL 'N1'
 12116        MOVE ER-8304               TO WS-ERROR
 12117        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12118        GO TO 3024-EDIT-DL22-CONT.
 12119
 12120     MOVE ER-8303                  TO WS-ERROR
 12121     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12122
 12123 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 222
* EL050.cbl
 12125****************************************************************
 12126*** VALIDATE LOAN OFFICER : DLO021                           ***
 12127****************************************************************
 12128
 12129     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12130     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12131     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12132     IF DVLO-SUCCESSFUL-EDIT
 12133        GO TO 3024-EDIT-DL21-CONT.
 12134
 12135     IF DVLO-RETURN-CODE EQUAL '01'
 12136        MOVE ER-8081               TO WS-ERROR
 12137        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12138        GO TO 3024-EDIT-DL21-CONT.
 12139
 12140     IF DVLO-RETURN-CODE EQUAL '02'
 12141        MOVE ER-8082               TO WS-ERROR
 12142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12143        GO TO 3024-EDIT-DL21-CONT.
 12144
 12145     IF DVLO-RETURN-CODE EQUAL '03'
 12146        MOVE ER-8083               TO WS-ERROR
 12147        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12148        GO TO 3024-EDIT-DL21-CONT.
 12149
 12150     IF DVLO-RETURN-CODE EQUAL '04'
 12151        MOVE ER-8084               TO WS-ERROR
 12152        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12153        GO TO 3024-EDIT-DL21-CONT.
 12154
 12155     IF DVLO-RETURN-CODE EQUAL '05'
 12156        MOVE ER-8085               TO WS-ERROR
 12157        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12158        GO TO 3024-EDIT-DL21-CONT.
 12159
 12160     MOVE ER-7825                  TO WS-ERROR
 12161     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12162     GO TO 3024-EDIT-DL21-CONT.
 12163
 12164 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 223
* EL050.cbl
 12166
 12167****************************************************************
 12168*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12169****************************************************************
 12170
 12171     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12172     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12173     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12174     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12175     IF DIPF-SUCCESSFUL-EDIT
 12176        GO TO 3024-EDIT-DL02-CONT.
 12177
 12178     IF DIPF-RETURN-CODE EQUAL '01'
 12179        MOVE ER-8086               TO WS-ERROR
 12180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12181        GO TO 3024-EDIT-DL02-CONT.
 12182
 12183     IF DIPF-RETURN-CODE EQUAL '02'
 12184        MOVE ER-8087               TO WS-ERROR
 12185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12186        GO TO 3024-EDIT-DL02-CONT.
 12187
 12188     IF DIPF-RETURN-CODE EQUAL '03'
 12189        MOVE ER-8088               TO WS-ERROR
 12190        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12191        GO TO 3024-EDIT-DL02-CONT.
 12192
 12193     MOVE ER-8095                  TO WS-ERROR
 12194     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12195     GO TO 3024-EDIT-DL02-CONT.
 12196
 12197 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 224
* EL050.cbl
 12199
 12200****************************************************************
 12201*** VALIDATE BANK ID : DLO003                                ***
 12202****************************************************************
 12203
 12204     MOVE WK-GREG-CENT           TO WCG-CENT.
 12205     MOVE WK-GREG-YYMM           TO WCG-REST.
 12206     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12207        MOVE ER-8040               TO WS-ERROR
 12208        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12209
 12210     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12211     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12212     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12213     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12214     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12215     IF DVBI-SUCCESSFUL-EDIT
 12216        GO TO 3024-EDIT-DL03-CONT.
 12217
 12218     IF DVBI-RETURN-CODE EQUAL '01'
 12219        MOVE ER-8089               TO WS-ERROR
 12220        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12221        GO TO 3024-EDIT-DL03-CONT.
 12222
 12223     IF DVBI-RETURN-CODE EQUAL '02'
 12224        MOVE ER-8090               TO WS-ERROR
 12225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12226        GO TO 3024-EDIT-DL03-CONT.
 12227
 12228     IF DVBI-RETURN-CODE EQUAL '03'
 12229        MOVE ER-8091               TO WS-ERROR
 12230        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12231        GO TO 3024-EDIT-DL03-CONT.
 12232
 12233     IF DVBI-RETURN-CODE EQUAL '04'
 12234        MOVE ER-8092               TO WS-ERROR
 12235        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12236        GO TO 3024-EDIT-DL03-CONT.
 12237
 12238     IF DVBI-RETURN-CODE EQUAL '05'
 12239        MOVE ER-8093               TO WS-ERROR
 12240        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12241        GO TO 3024-EDIT-DL03-CONT.
 12242
 12243     IF DVBI-RETURN-CODE EQUAL '06'
 12244        MOVE ER-8094               TO WS-ERROR
 12245        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12246        GO TO 3024-EDIT-DL03-CONT.
 12247
 12248     MOVE ER-8096                  TO WS-ERROR
 12249     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12250     GO TO 3024-EDIT-DL03-CONT.
 12251
 12252 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 225
* EL050.cbl
 12254
 12255     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12256        NEXT SENTENCE
 12257     ELSE
 12258        MOVE ER-8042               TO WS-ERROR
 12259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12260
 12261     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12262     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12263     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12264
 12265     IF DMPF-RETURN-CODE = '01'
 12266        MOVE ER-8067               TO WS-ERROR
 12267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12268        GO TO 3024-EDIT-DL01-CONT.
 12269
 12270     IF DMPF-RETURN-CODE = '02'
 12271        MOVE ER-8068               TO WS-ERROR
 12272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12273        GO TO 3024-EDIT-DL01-CONT.
 12274
 12275     IF DMPF-RETURN-CODE = '03'
 12276        MOVE ER-8069               TO WS-ERROR
 12277        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12278        GO TO 3024-EDIT-DL01-CONT.
 12279
 12280     IF DMPF-RETURN-CODE = 'E1'
 12281        MOVE ER-8070               TO WS-ERROR
 12282        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12283        GO TO 3024-EDIT-DL01-CONT.
 12284
 12285     IF DMPF-RETURN-CODE = 'N1'
 12286        MOVE ER-8071               TO WS-ERROR
 12287        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12288        GO TO 3024-EDIT-DL01-CONT.
 12289
 12290     IF DMPF-RETURN-CODE NOT = 'OK'
 12291        MOVE ER-8072               TO WS-ERROR
 12292        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12293
 12294 3024-EDIT-DL01-CONT.
 12295******************************************************************
 12296***  VALIDATES RATE CODES : DLO017                             ***
 12297******************************************************************
 12298
 12299      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12300      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12301      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12302      IF DVRC-SUCCESSFUL-EDIT
 12303        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12304        GO TO 3024-CHECK-VALID-RATE.
 12305
 12306      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12307
 12308      IF DVRC-RETURN-CODE EQUAL '01'
 12309         MOVE ER-7817                   TO WS-ERROR
 12310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12311         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 226
* EL050.cbl
 12312
 12313      IF DVRC-RETURN-CODE EQUAL '02'
 12314         MOVE ER-7818                   TO WS-ERROR
 12315         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12316         GO TO 3025-EDIT-REINSURANCE.
 12317
 12318      IF DVRC-RETURN-CODE EQUAL '03'
 12319         MOVE ER-7819                   TO WS-ERROR
 12320         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12321         GO TO 3025-EDIT-REINSURANCE.
 12322
 12323       MOVE ER-7820                     TO WS-ERROR.
 12324       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12325       GO TO 3025-EDIT-REINSURANCE.
 12326
 12327******************************************************************
 12328***  GET PREMIUM RATES : DLO011                                ***
 12329******************************************************************
 12330
 12331 3024-CHECK-VALID-RATE.
 12332
 12333     IF VALID-RATE-CODE
 12334        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12335        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12336        MOVE SPACES                TO DPRB-RETURN-CODE
 12337        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12338     ELSE
 12339         GO TO 3025-EDIT-REINSURANCE.
 12340
 12341      IF DPRB-SUCCESSFUL-PROCESS
 12342         IF PB-VALID-LIFE
 12343             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12344             GO TO 3025-EDIT-REINSURANCE
 12345         ELSE
 12346             IF PB-VALID-AH
 12347                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12348                 GO TO 3025-EDIT-REINSURANCE.
 12349
 12350      IF DPRB-RETURN-CODE EQUAL '01'
 12351         MOVE ER-7812                   TO WS-ERROR
 12352         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12353         GO TO 3025-EDIT-REINSURANCE.
 12354
 12355      IF DPRB-RETURN-CODE EQUAL '02'
 12356         MOVE ER-7813                   TO WS-ERROR
 12357         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12358         GO TO 3025-EDIT-REINSURANCE.
 12359
 12360      IF DPRB-RETURN-CODE EQUAL '03'
 12361         MOVE ER-7814                   TO WS-ERROR
 12362         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12363         GO TO 3025-EDIT-REINSURANCE.
 12364
 12365      IF DPRB-RETURN-CODE EQUAL '04'
 12366         IF NOT DPRB-1ST-TIME
 12367            MOVE ER-7815                   TO WS-ERROR
 12368            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12369            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 227
* EL050.cbl
 12370          ELSE
 12371         IF PB-VALID-LIFE
 12372            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12373          ELSE
 12374            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12375         END-IF
 12376         MOVE SPACES                TO DOCC-RETURN-CODE
 12377         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12378         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12379         IF DOCC-RETURN-CODE = 'OK'
 12380             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12381             GO TO 3024-CHECK-VALID-RATE
 12382           ELSE
 12383             MOVE ER-7823               TO WS-ERROR
 12384             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12385             GO TO 3025-EDIT-REINSURANCE.
 12386
 12387       MOVE ER-7816                     TO WS-ERROR.
 12388       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12389       GO TO 3025-EDIT-REINSURANCE.
 12390
 12391**********   DMD CUSTOM CODE ABOVE    **********
 12392
 12393 3025-EDIT-REINSURANCE.
 12394     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12395         GO TO 3027-EDIT-CONTINUE.
 12396
 12397     MOVE LOW-VALUES               TO ERREIN-KEY.
 12398     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12399     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12400                                      REIN-CODE-2
 12401                                      REIN-CODE-3.
 12402     MOVE 'A'                      TO REIN-TYPE.
 12403
 12404     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12405
 12406     MOVE '3026' TO REIN-SW.
 12407     MOVE ' '                   TO WS-REIN-READ-SW.
 12408
 12409     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12410     IF REIN-TABLE-NOT-FOUND
 12411         GO TO 3026-NO-SPEC-TABLE.
 12412
 12413     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12414     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12415                                   WS-NSP-ST-CD-LF.
 12416     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12417                                   WS-NSP-ST-CD-AH.
 12418
 12419     GO TO 3040-EDIT-CONTINUE.
 12420
 12421 3026-NO-SPEC-TABLE.
 12422
 12423     MOVE ER-2664                TO WS-ERROR.
 12424     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12425     GO TO 3040-EDIT-CONTINUE.
 12426
 12427 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 228
* EL050.cbl
 12428
 12429     IF PB-I-REIN-TABLE = SPACES
 12430       GO TO 3040-EDIT-CONTINUE.
 12431
 12432     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12433          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12434          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12435           GO TO 3040-EDIT-CONTINUE.
 12436
 12437     MOVE LOW-VALUES            TO ERREIN-KEY.
 12438     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12439     MOVE 'A'                   TO REIN-TYPE.
 12440     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12441
 12442     MOVE '3028'                TO REIN-SW.
 12443     MOVE ' '                   TO WS-REIN-READ-SW.
 12444
 12445     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12446     IF REIN-TABLE-NOT-FOUND
 12447         GO TO 3028-NO-REIN-TABLE.
 12448
 12449     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12450     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12451                                   WS-NSP-ST-CD-LF.
 12452     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12453                                   WS-NSP-ST-CD-AH.
 12454
 12455     GO TO 3040-EDIT-CONTINUE.
 12456
 12457 3028-NO-REIN-TABLE.
 12458
 12459     MOVE ER-2615                TO WS-ERROR.
 12460     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12461     GO TO 3040-EDIT-CONTINUE.
 12462
 12463 3040-EDIT-CONTINUE.
 12464
 12465     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12466         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12467
 12468     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12469         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12470
 12471     IF (NOT PB-REISSUED-CERT)
 12472        AND (NOT PB-MONTHLY-CERT)
 12473        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12474            MOVE '001'           TO PB-I-LF-TERM
 12475            MOVE 'M'             TO PB-I-INSURED-SEX.
 12476
 12477     IF (NOT PB-REISSUED-CERT)
 12478        AND (NOT PB-MONTHLY-CERT)
 12479        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12480            MOVE '001'           TO PB-I-AH-TERM
 12481            MOVE 'M'             TO PB-I-INSURED-SEX.
 12482
 12483 3040-EDIT-1ST-PMT-DT.
 12484     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12485     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 229
* EL050.cbl
 12486         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12487
 12488******************************************************************
 12489*                                                                *
 12490*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12491*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12492*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12493*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12494*                                                                *
 12495******************************************************************
 12496
 12497     IF PB-EFF-DT-PROCESSING
 12498        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12499                                    PB-I-LF-EXPIRE-DT
 12500                                    PB-I-AH-EXPIRE-DT
 12501        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12502        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12503        MOVE ZERO                TO DC-ELAPSED-DAYS
 12504        MOVE +1                  TO DC-ELAPSED-MONTHS
 12505        SET BIN-PLUS-ELAPSED     TO TRUE
 12506*       MOVE 6                   TO DC-OPTION-CODE
 12507        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12508        IF NO-CONVERSION-ERROR
 12509           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12510
 12511******************************************************************
 12512*                                                                *
 12513*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12514*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12515*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12516*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12517*                                                                *
 12518******************************************************************
 12519
 12520     IF PB-EXT-DAYS-PROCESSING
 12521          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12522                                         PB-I-LF-EXPIRE-DT
 12523                                         PB-I-AH-EXPIRE-DT
 12524          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12525          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12526          MOVE +1                     TO DC-ELAPSED-MONTHS
 12527          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12528          SET BIN-PLUS-ELAPSED        TO TRUE
 12529*         MOVE 6                      TO DC-OPTION-CODE
 12530          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12531          IF NO-CONVERSION-ERROR
 12532             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12533
 12534******************************************************************
 12535*                                                                *
 12536*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12537*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12538*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12539*        (EXPIRE DATE - (TERM -1))  *  -1.
 12540*                                                                *
 12541******************************************************************
 12542
 12543     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 230
* EL050.cbl
 12544        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12545           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12546              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12547              MOVE PB-I-AH-TERM      TO WS-TERM
 12548           ELSE
 12549              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12550              MOVE PB-I-LF-TERM      TO WS-TERM
 12551        ELSE
 12552           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12553              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12554              MOVE PB-I-LF-TERM      TO WS-TERM
 12555           ELSE
 12556              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12557              MOVE PB-I-AH-TERM      TO WS-TERM.
 12558
 12559     IF PB-EXPIRE-DT-PROCESSING
 12560        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12561        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12562        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12563        MOVE ZERO                TO DC-ELAPSED-DAYS
 12564                                    DC-ODD-DAYS-OVER
 12565          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12566          SET BIN-PLUS-ELAPSED    TO TRUE
 12567*         MOVE 6                  TO DC-OPTION-CODE
 12568          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12569          IF NO-CONVERSION-ERROR
 12570             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12571
 12572******************************************************************
 12573*                                                                *
 12574*            1ST PAYMENT DATE PROCESSING                         *
 12575*                                                                *
 12576******************************************************************
 12577
 12578     IF PB-1ST-PMT-DT-PROCESSING
 12579        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12580                                    PB-I-AH-EXPIRE-DT
 12581        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12582
 12583     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12584         NEXT SENTENCE
 12585     ELSE
 12586         MOVE ER-2680                 TO WS-ERROR
 12587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12588         GO TO 3060-ORIG-TERM-CHECK.
 12589
 12590     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12591     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12592     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12593*    MOVE 1                      TO DC-OPTION-CODE.
 12594     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12595                                    DC-ELAPSED-DAYS
 12596                                    DC-ODD-DAYS-OVER.
 12597
 12598     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12599
 12600     IF DATE-CONVERSION-ERROR
 12601        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 231
* EL050.cbl
 12602
 12603     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12604     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12605        AND (WS-LF-COVERAGE-TYPE = 'L')
 12606        IF (DC-ELAPSED-MONTHS > 1)
 12607                      OR
 12608           ((DC-ELAPSED-MONTHS = 1)
 12609           AND (DC-ODD-DAYS-OVER > 0))
 12610           MOVE ER-2882          TO WS-ERROR
 12611           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12612        END-IF
 12613     END-IF
 12614     if dc-elapsed-months > 0
 12615        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12616        + dc-odd-days-over
 12617     end-if
 12618     IF PB-EXT-DAYS-PROCESSING
 12619        CONTINUE
 12620     ELSE
 12621        IF DC-ELAPSED-MONTHS = +0
 12622           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12623        ELSE
 12624           IF (WS-LF-EARNINGS-CALC = '4')
 12625              AND (DC-ELAPSED-MONTHS > ZERO)
 12626              AND (DC-ELAPSED-DAYS > ZERO)
 12627              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12628           ELSE
 12629              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12630                                 THRU 6499-EXIT
 12631              MOVE WS-ODD-DAYS-OVER
 12632                                 TO PB-I-EXTENTION-DAYS
 12633           END-IF
 12634        END-IF
 12635     END-IF
 12636******************************************************************
 12637*                                                                *
 12638*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12639*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12640*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12641*            AND ANY ODD DAYS.                                   *
 12642*                                                                *
 12643******************************************************************
 12644
 12645     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12646                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12647     IF WS-LF-EARNINGS-CALC NOT = '4'
 12648        IF DC-ELAPSED-DAYS > ZEROS
 12649           MOVE ER-2681          TO WS-ERROR
 12650           PERFORM 9900-ERROR-FORMAT
 12651                                 THRU 9900-EXIT
 12652        END-IF
 12653     END-IF
 12654
 12655     IF WS-LF-EARNINGS-CALC NOT = '4'
 12656        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12657           MOVE ER-2681          TO WS-ERROR
 12658           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12659
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 232
* EL050.cbl
 12660     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12661        (PB-I-LF-TERM NOT = ZERO) AND
 12662         NOT NO-LIFE-COVERAGE
 12663          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12664          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12665          IF WS-LF-EARNINGS-CALC = '4'
 12666             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12667             PB-I-PAY-FREQUENCY
 12668          END-IF
 12669          MOVE ZERO              TO DC-ELAPSED-DAYS
 12670                                    DC-ODD-DAYS-OVER
 12671          MOVE 1                 TO DC-END-OF-MONTH
 12672          SET BIN-PLUS-ELAPSED        TO TRUE
 12673*         MOVE 6                 TO DC-OPTION-CODE
 12674          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12675          IF NO-CONVERSION-ERROR
 12676             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12677             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12678                (WS-LF-SPECIAL-CALC-CD = 'L')
 12679                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12680                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12681                  MOVE +1             TO DC-ELAPSED-MONTHS
 12682                  SET BIN-PLUS-ELAPSED  TO TRUE
 12683*                 MOVE 6              TO DC-OPTION-CODE
 12684                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12685                  IF NO-CONVERSION-ERROR
 12686                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12687
 12688* okay, i had to move the new att age edit down here because the
 12689* expiration date could get recalculated and i need the exp date
 12690     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12691        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12692        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12693        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12694           AND ZEROS
 12695           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12696           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12697           SET ELAPSED-BETWEEN-BIN TO TRUE
 12698           PERFORM 8500-DATE-CONVERT
 12699                                 THRU 8500-EXIT
 12700           IF NO-CONVERSION-ERROR
 12701              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12702                 MOVE ER-2669       TO WS-ERROR
 12703*                PERFORM 9900-ERROR-FORMAT
 12704*                                THRU 9900-EXIT
 12705              END-IF
 12706           END-IF
 12707        ELSE
 12708           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12709           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12710              MOVE ER-2669       TO WS-ERROR
 12711*             PERFORM 9900-ERROR-FORMAT
 12712*                                THRU 9900-EXIT
 12713           ELSE
 12714              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12715                 MOVE ER-1570    TO WS-ERROR
 12716                 PERFORM 9900-ERROR-FORMAT
 12717                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 233
* EL050.cbl
 12718              END-IF
 12719           END-IF
 12720        END-IF
 12721        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12722           AND ZEROS
 12723           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12724           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12725           SET ELAPSED-BETWEEN-BIN TO TRUE
 12726           PERFORM 8500-DATE-CONVERT
 12727                                 THRU 8500-EXIT
 12728           IF NO-CONVERSION-ERROR
 12729              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12730                 MOVE ER-2669       TO WS-ERROR
 12731*                PERFORM 9900-ERROR-FORMAT
 12732*                                THRU 9900-EXIT
 12733              END-IF
 12734           END-IF
 12735        ELSE
 12736           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12737             (PB-I-LF-TERM / 12)
 12738           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12739              MOVE ER-2669       TO WS-ERROR
 12740*             PERFORM 9900-ERROR-FORMAT
 12741*                                THRU 9900-EXIT
 12742           ELSE
 12743              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12744                 MOVE ER-1571    TO WS-ERROR
 12745                 PERFORM 9900-ERROR-FORMAT
 12746                                 THRU 9900-EXIT
 12747              END-IF
 12748           END-IF
 12749        END-IF
 12750        IF WS-ERROR = ER-2669
 12751           PERFORM 9900-ERROR-FORMAT
 12752                                 THRU 9900-EXIT
 12753        END-IF
 12754     END-IF
 12755     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12756        (PB-I-AH-TERM NOT = ZERO) AND
 12757         NOT NO-AH-COVERAGE
 12758          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12759             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12760             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12761             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12762          ELSE
 12763             IF WS-LF-EARNINGS-CALC = '4'
 12764                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12765                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12766                PB-I-PAY-FREQUENCY
 12767             ELSE
 12768                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12769                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12770             END-IF
 12771          END-IF
 12772          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12773                                         DC-ODD-DAYS-OVER
 12774          MOVE 1                      TO DC-END-OF-MONTH
 12775          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 234
* EL050.cbl
 12776*         MOVE 6                      TO DC-OPTION-CODE
 12777          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12778          IF NO-CONVERSION-ERROR
 12779             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12780     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12781        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12782        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12783        IF PB-I-BIRTHDAY > LOW-VALUES
 12784           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12785           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12786           SET ELAPSED-BETWEEN-BIN TO TRUE
 12787           PERFORM 8500-DATE-CONVERT
 12788                                 THRU 8500-EXIT
 12789           IF NO-CONVERSION-ERROR
 12790              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12791                 MOVE ER-3054       TO WS-ERROR
 12792*                PERFORM 9900-ERROR-FORMAT
 12793*                                THRU 9900-EXIT
 12794              END-IF
 12795           END-IF
 12796        ELSE
 12797           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12798           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12799              MOVE ER-3054       TO WS-ERROR
 12800*             PERFORM 9900-ERROR-FORMAT
 12801*                                THRU 9900-EXIT
 12802           END-IF
 12803        END-IF
 12804        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12805           AND ZEROS
 12806           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12807           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12808           SET ELAPSED-BETWEEN-BIN TO TRUE
 12809           PERFORM 8500-DATE-CONVERT
 12810                                 THRU 8500-EXIT
 12811           IF NO-CONVERSION-ERROR
 12812              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12813                 MOVE ER-3054       TO WS-ERROR
 12814*                PERFORM 9900-ERROR-FORMAT
 12815*                                THRU 9900-EXIT
 12816              END-IF
 12817           END-IF
 12818        ELSE
 12819           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12820             (PB-I-AH-TERM / 12)
 12821           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12822              MOVE ER-3054       TO WS-ERROR
 12823*             PERFORM 9900-ERROR-FORMAT
 12824*                                THRU 9900-EXIT
 12825           END-IF
 12826        END-IF
 12827        IF WS-ERROR = ER-3054
 12828           PERFORM 9900-ERROR-FORMAT
 12829                                 THRU 9900-EXIT
 12830        END-IF
 12831     END-IF
 12832     MOVE SPACE                       TO DC-END-OF-MONTH.
 12833
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 235
* EL050.cbl
 12834     IF PB-COMPANY-ID = 'NCB'
 12835        GO TO 3040-EDIT-EXTENSION-DAYS.
 12836
 12837     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12838       AND
 12839        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12840        NEXT SENTENCE
 12841     ELSE
 12842        GO TO 3040-EDIT-EXTENSION-DAYS.
 12843
 12844     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12845        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12846        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12847     ELSE
 12848        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12849        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12850
 12851     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12852*    MOVE '1'      TO DC-OPTION-CODE
 12853     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12854     IF (NO-CONVERSION-ERROR)
 12855        AND (DC-ELAPSED-MONTHS > +1)
 12856        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12857        MOVE ER-2668   TO WS-ERROR
 12858        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12859
 12860 3040-EDIT-EXTENSION-DAYS.
 12861
 12862     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12863        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12864         GO TO 3050-EDIT-TERM-IN-DAYS
 12865     ELSE
 12866         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12867
 12868     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12869         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12870     ELSE
 12871        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12872           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12873           MOVE ER-2681         TO WS-ERROR
 12874           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12875
 12876     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12877        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12878        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12879         GO TO 3060-ORIG-TERM-CHECK.
 12880
 12881     GO TO 3060-ORIG-TERM-CHECK.
 12882
 12883 3050-EDIT-TERM-IN-DAYS.
 12884
 12885     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12886
 12887     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12888         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12889     ELSE
 12890         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12891            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 236
* EL050.cbl
 12892            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12893
 12894     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12895                                       REMAINDER WS-WORK-TERM.
 12896     IF WS-WORK-TERM GREATER THAN ZERO
 12897         ADD +1 TO PB-I-LF-TERM.
 12898
 12899     IF NOT NO-AH-COVERAGE
 12900         MOVE ER-2684            TO WS-ERROR
 12901         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12902
 12903
 12904 3060-ORIG-TERM-CHECK.
 12905
 12906******************************************************************
 12907*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12908******************************************************************
 12909
 12910     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12911        NEXT SENTENCE
 12912     ELSE
 12913        IF NOT NO-LIFE-COVERAGE
 12914           IF PB-I-LF-TERM NUMERIC
 12915              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12916              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12917              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12918                  NEXT SENTENCE
 12919           ELSE
 12920              MOVE ER-2647       TO WS-ERROR
 12921              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12922
 12923     IF NOT NO-AH-COVERAGE
 12924         IF PB-I-AH-TERM NUMERIC
 12925            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12926            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12927            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12928             NEXT SENTENCE
 12929          ELSE
 12930              MOVE ER-2658       TO WS-ERROR
 12931              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12932
 12933     IF PB-COMPANY-ID = 'NCB'
 12934        GO TO 3070-LOAN-TERM-CHECK.
 12935
 12936     IF POLICY-HAS-AH
 12937       AND
 12938        POLICY-HAS-LIFE
 12939       AND
 12940        PB-I-LF-TERM NUMERIC
 12941       AND
 12942        PB-I-AH-TERM NUMERIC
 12943        NEXT SENTENCE
 12944     ELSE
 12945        GO TO 3070-LOAN-TERM-CHECK.
 12946
 12947     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12948     IF WS-TEX-FACT-2 LESS THAN +0
 12949        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 237
* EL050.cbl
 12950
 12951     IF WS-TEX-FACT-2 GREATER THAN +1
 12952        MOVE ER-2668             TO WS-ERROR
 12953        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12954
 12955 3070-LOAN-TERM-CHECK.
 12956
 12957     IF (WS-LF-BENEFIT-CD = ZERO)
 12958         OR (NO-LF-BENEFIT-MATCH)
 12959            GO TO 3125-EDIT-PMT-FREQ.
 12960*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12961*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12962*          AND 'V' AND 'W' AND 'X'
 12963*          GO TO 3125-EDIT-PMT-FREQ
 12964*       END-IF
 12965*    ELSE
 12966*       IF WS-AH-DCC-TRUNC = 'T'
 12967*          CONTINUE
 12968*       ELSE
 12969*          GO TO 3125-EDIT-PMT-FREQ
 12970*       END-IF
 12971*    END-IF
 12972     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12973                    OR
 12974        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12975        AND (WS-AH-DCC-TRUNC = 'T'))
 12976        CONTINUE
 12977     ELSE
 12978        GO TO 3125-EDIT-PMT-FREQ
 12979     END-IF
 12980     IF PB-I-LOAN-TERM NOT NUMERIC
 12981         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12982
 12983     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12984        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12985*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12986        PB-I-LOAN-TERM NOT GREATER THAN +360
 12987         NEXT SENTENCE
 12988     ELSE
 12989         MOVE ER-2648            TO WS-ERROR
 12990         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12991
 12992     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12993        MOVE ER-3058             TO WS-ERROR
 12994        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12995     end-if
 12996
 12997     IF WS-STATE-ABBREVIATION = 'NC'
 12998        IF PB-I-LOAN-TERM > +59
 12999           CONTINUE
 13000        ELSE
 13001           MOVE ER-2792          TO WS-ERROR
 13002           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13003        END-IF
 13004     END-IF
 13005
 13006     .
 13007 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 238
* EL050.cbl
 13008     IF (WS-LF-BENEFIT-CD = ZERO)
 13009         OR (NO-LF-BENEFIT-MATCH)
 13010            GO TO 3127-EDIT-LOAN-OFFICER.
 13011     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 13012                    OR
 13013        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 13014        AND (WS-AH-DCC-TRUNC = 'T'))
 13015                    OR
 13016         (PB-COMPANY-ID = 'AHL')
 13017        CONTINUE
 13018     ELSE
 13019        IF (PB-I-LOAN-TERM > ZEROS)
 13020           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 13021           MOVE ER-1575          TO WS-ERROR
 13022           PERFORM 9900-ERROR-FORMAT
 13023                                 THRU 9900-EXIT
 13024        END-IF
 13025     END-IF
 13026     IF WS-LF-EARNINGS-CALC NOT = '4'
 13027         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 13028            MOVE ER-2653         TO WS-ERROR
 13029            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13030            GO TO 3127-EDIT-LOAN-OFFICER
 13031         ELSE
 13032            GO TO 3127-EDIT-LOAN-OFFICER.
 13033
 13034     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 13035         MOVE ER-2655            TO WS-ERROR
 13036         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13037         GO TO 3127-EDIT-LOAN-OFFICER.
 13038
 13039     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 13040         MOVE ER-2654            TO WS-ERROR
 13041         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13042         GO TO 3127-EDIT-LOAN-OFFICER.
 13043
 13044     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 13045         GIVING WS-TEX-FACT-2
 13046             REMAINDER WS-TEX-FACT-3.
 13047
 13048*    IF WS-TEX-FACT-3 NOT = ZERO
 13049*       MOVE ER-2654             TO WS-ERROR
 13050*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13051
 13052
 13053 3127-EDIT-LOAN-OFFICER.
 13054
 13055     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13056        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13057           MOVE ER-2690          TO WS-ERROR
 13058           PERFORM 9900-ERROR-FORMAT
 13059                                 THRU 9900-EXIT
 13060        ELSE
 13061           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13062           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13063           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13064           MOVE PB-SV-STATE      TO LOFC-STATE
 13065           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 239
* EL050.cbl
 13066           MOVE PB-I-LOAN-OFFICER
 13067                                 TO LOFC-CODE
 13068           PERFORM 8586-READ-LOAN-OFFICER
 13069                                 THRU 8586-EXIT
 13070           IF (NOT LOFC-MASTER-FOUND)
 13071              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13072              MOVE ER-3006       TO WS-ERROR
 13073              PERFORM 9900-ERROR-FORMAT
 13074                                 THRU 9900-EXIT
 13075           END-IF
 13076        END-IF
 13077     END-IF
 13078     .
 13079 3129-EDIT-APR.
 13080
 13081     IF (WS-LF-BENEFIT-CD = ZERO)
 13082        OR (NO-LF-BENEFIT-MATCH)
 13083        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13084           GO TO 3130-EDIT-AGE
 13085*       ELSE
 13086*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13087*             GO TO 3130-EDIT-AGE
 13088*          END-IF
 13089        END-IF
 13090     END-IF
 13091
 13092     IF (WS-STATE-ABBREVIATION = 'OH')
 13093         AND (PB-I-RATE-CLASS NOT = 'L ')
 13094         AND (PB-I-LF-TERM GREATER THAN 60)
 13095         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13096         GO TO 3129-APR-CONT.
 13097
 13098     IF (WS-STATE-ABBREVIATION = 'RI')
 13099         AND (PB-I-LF-TERM GREATER THAN 60)
 13100         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13101         GO TO 3129-APR-CONT.
 13102
 13103     IF (WS-STATE-ABBREVIATION = 'UT')
 13104         AND (PB-I-LF-TERM GREATER THAN 62)
 13105         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13106         AND (PB-CERT-EFF-DT LESS WS-830901)
 13107         GO TO 3129-APR-CONT.
 13108
 13109     IF PB-COMPANY-ID = 'LAP'
 13110        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13111           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13112              MOVE ER-2656         TO WS-ERROR
 13113              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13114              GO TO 3130-EDIT-AGE.
 13115
 13116     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13117        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13118        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13119        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13120        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13121        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13122         GO TO 3130-EDIT-AGE.
 13123
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 240
* EL050.cbl
 13124 3129-APR-CONT.
 13125     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13126         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13127         GO TO 3130-EDIT-AGE.
 13128
 13129     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13130         WS-AH-BENEFIT-CD (1:1) = 'S')
 13131        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13132        AND (PB-I-LOAN-APR = ZERO)
 13133        MOVE ER-2657             TO WS-ERROR
 13134        PERFORM 9900-ERROR-FORMAT
 13135                                 THRU 9900-EXIT
 13136        GO TO 3130-EDIT-AGE
 13137     END-IF
 13138*    IF PB-I-LOAN-APR = ZERO
 13139*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13140*    END-IF
 13141
 13142     if pb-i-loan-apr = +99.9999
 13143        move er-2656             to ws-error
 13144        PERFORM 9900-ERROR-FORMAT
 13145                                 THRU 9900-EXIT
 13146        GO TO 3130-EDIT-AGE
 13147     end-if
 13148*    IF PB-I-LOAN-APR = ZERO
 13149*       MOVE ER-2656             TO WS-ERROR
 13150*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13151*       GO TO 3130-EDIT-AGE.
 13152
 13153*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13154     if pb-i-loan-apr not = +99.9999
 13155        IF PB-I-LOAN-APR > +30.000
 13156           MOVE ER-2657          TO WS-ERROR
 13157           PERFORM 9900-ERROR-FORMAT
 13158                                 THRU 9900-EXIT
 13159        end-if
 13160     end-if
 13161     .
 13162 3130-EDIT-AGE.
 13163
 13164******************************************************************
 13165*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13166******************************************************************
 13167
 13168     IF NOT NO-LIFE-COVERAGE
 13169        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13170           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13171               MOVE ER-2628             TO WS-ERROR
 13172               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13173
 13174     IF NOT NO-AH-COVERAGE
 13175        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13176           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13177               MOVE ER-2628         TO WS-ERROR
 13178               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13179
 13180 3133-SEX-CODE.
 13181     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 241
* EL050.cbl
 13182         IF WS-DEFAULT-SEX = 'M'
 13183             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13184          ELSE
 13185             IF WS-DEFAULT-SEX = 'F'
 13186             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13187
 13188     IF PB-I-INSURED-SEX = '1'
 13189         MOVE 'M' TO PB-I-INSURED-SEX.
 13190
 13191     IF PB-I-INSURED-SEX = '2'
 13192         MOVE 'F' TO PB-I-INSURED-SEX.
 13193
 13194 3134-SIG-SW-EDIT.
 13195     IF PB-I-SIG-SW = SPACE
 13196         MOVE 'N'                TO  PB-I-SIG-SW.
 13197
 13198     IF PB-COMPANY-ID = 'NCL'
 13199         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13200             NEXT SENTENCE
 13201         ELSE
 13202             MOVE ER-1923        TO  WS-ERROR
 13203             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13204     ELSE
 13205     IF PB-COMPANY-ID = 'CRI'
 13206         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13207             NEXT SENTENCE
 13208         ELSE
 13209             MOVE ER-2606        TO  WS-ERROR
 13210             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13211     ELSE
 13212     IF PB-COMPANY-ID = 'TMS'
 13213         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13214             NEXT SENTENCE
 13215         ELSE
 13216             MOVE ER-2689        TO  WS-ERROR
 13217             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13218     ELSE
 13219         IF PB-I-SIG-SW = 'Y' OR 'N'
 13220             NEXT SENTENCE
 13221         ELSE
 13222             MOVE ER-2651        TO  WS-ERROR
 13223             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13224
 13225     IF PB-COMPANY-ID = 'FLA'
 13226         IF (WS-EDIT-AGE GREATER 54  OR
 13227             WS-AH-EDIT-AGE GREATER 54)  AND
 13228            PB-I-SIG-SW = 'N'
 13229            MOVE ER-2651         TO  WS-ERROR
 13230            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13231
 13232 3135-NAME-EDIT.
 13233
 13234     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13235        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13236        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13237           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13238                                 TO PB-I-JOINT-FIRST-NAME
 13239        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 242
* EL050.cbl
 13240     END-IF
 13241     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13242        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13243        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13244           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13245                                 TO PB-I-JOINT-LAST-NAME
 13246        END-PERFORM
 13247     END-IF
 13248     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13249        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13250        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13251           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13252                                 TO PB-I-INSURED-FIRST-NAME
 13253        END-PERFORM
 13254     END-IF
 13255     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13256        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13257        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13258           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13259                                 TO PB-I-INSURED-LAST-NAME
 13260        END-PERFORM
 13261     END-IF
 13262     IF PB-I-INSURED-LAST-NAME = SPACES
 13263       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13264       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13265           MOVE ER-2660    TO WS-ERROR
 13266           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13267
 13268 3136-EDIT-SEX.
 13269
 13270******************************************************************
 13271*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13272******************************************************************
 13273
 13274     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13275        (WS-AH-SPECIAL-CALC-CD = 'O')
 13276        NEXT SENTENCE
 13277     ELSE
 13278        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13279           NEXT SENTENCE
 13280        ELSE
 13281           MOVE ER-2629            TO WS-ERROR
 13282           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13283
 13284 3137-EDIT-EFF-DATE.
 13285
 13286     IF PB-REISSUED-CERT       OR
 13287        PB-POLICY-IS-DECLINED  OR
 13288        PB-POLICY-IS-VOIDED
 13289         GO TO 3139-EDIT-COVERAGE-CODES.
 13290
 13291     MOVE SPACE                  TO WS-2671-SW
 13292                                    WS-2672-SW.
 13293
 13294     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13295         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13296             MOVE ER-2703        TO WS-ERROR
 13297             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 243
* EL050.cbl
 13298             GO TO 3139-EDIT-COVERAGE-CODES.
 13299
 13300     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13301         GO TO 3139-EDIT-COVERAGE-CODES.
 13302
 13303     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13304     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13305*    MOVE '1'                    TO DC-OPTION-CODE.
 13306     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13307     MOVE +0                     TO DC-ELAPSED-MONTHS
 13308                                    DC-ELAPSED-DAYS.
 13309     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13310
 13311     IF DATE-CONVERSION-ERROR
 13312         GO TO 3139-EDIT-COVERAGE-CODES.
 13313
 13314     IF DC-ELAPSED-DAYS GREATER +180
 13315         MOVE ER-2672            TO WS-ERROR
 13316         MOVE 'Y'                TO WS-2672-SW
 13317         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13318     END-IF
 13319
 13320     IF WS-ERROR = ER-2671  AND
 13321        PB-COMPANY-ID  = 'LBL'
 13322        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13323        MOVE SPACE               TO WS-2671-SW
 13324        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13325
 13326     IF PB-ISSUE-DATE-FORCED  AND
 13327      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13328         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13329         MOVE ER-2673            TO WS-ERROR
 13330         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13331         MOVE SPACE              TO WS-2671-SW
 13332                                    WS-2672-SW.
 13333
 13334     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13335         IF PB-ISSUE-DATE-FORCED
 13336             MOVE ER-2600          TO  WS-ERROR
 13337             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13338         ELSE
 13339             MOVE ER-2692          TO  WS-ERROR
 13340             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13341
 13342
 13343 3139-EDIT-COVERAGE-CODES.
 13344
 13345     if pb-company-id not = 'AHL'
 13346        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13347           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13348           MOVE ER-2787          TO WS-ERROR
 13349           PERFORM 9900-ERROR-FORMAT
 13350                                 THRU 9900-EXIT
 13351        END-IF
 13352     end-if
 13353     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13354        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13355                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 244
* EL050.cbl
 13356           MOVE ER-2719          TO WS-ERROR
 13357           PERFORM 9900-ERROR-FORMAT
 13358                                 THRU 9900-EXIT
 13359        END-IF
 13360     END-IF
 13361
 13362     IF PB-POLICY-IS-DECLINED  OR
 13363        PB-POLICY-IS-VOIDED
 13364         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13365
 13366     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13367        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13368         MOVE ER-2630                TO WS-ERROR
 13369         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13370
 13371     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13372        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13373        PB-I-LF-PREMIUM-AMT = ZERO
 13374         GO TO 3140-CHECK-AH-FOR-ZERO.
 13375
 13376     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13377        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13378        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13379         GO TO 3140-CHECK-AH-FOR-ZERO.
 13380
 13381     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13382        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13383        MOVE ER-2631             TO WS-ERROR
 13384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13385     END-IF
 13386
 13387
 13388******************************************************************
 13389*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13390******************************************************************
 13391
 13392     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13393        NEXT SENTENCE
 13394     ELSE
 13395        IF PB-I-LF-BENEFIT-AMT = ZERO
 13396           MOVE ER-2632             TO WS-ERROR
 13397           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13398
 13399
 13400******************************************************************
 13401*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13402******************************************************************
 13403
 13404     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13405        CONTINUE
 13406     ELSE
 13407        IF PB-I-LF-PREMIUM-AMT = ZERO
 13408           IF (NOT PB-COMP-LF-PREM)
 13409              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13410              and (ws-lf-ben-category not = 'C')
 13411              MOVE ER-2633       TO WS-ERROR
 13412              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13413           END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 245
* EL050.cbl
 13414        END-IF
 13415     END-IF
 13416     .
 13417 3140-CHECK-AH-FOR-ZERO.
 13418
 13419     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13420        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13421        PB-I-AH-PREMIUM-AMT = ZERO
 13422         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13423
 13424     IF PB-COMPANY-ID = 'CSL'  AND
 13425        PB-I-AH-BENEFIT-CD = ZERO  AND
 13426        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13427        PB-I-AH-PREMIUM-AMT = ZERO
 13428         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13429
 13430     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13431        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13432        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13433         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13434
 13435     IF PB-I-AH-BENEFIT-CD = ZERO
 13436         MOVE ER-2634            TO WS-ERROR
 13437         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13438
 13439******************************************************************
 13440*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13441******************************************************************
 13442
 13443     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13444        NEXT SENTENCE
 13445     ELSE
 13446        IF PB-I-AH-BENEFIT-AMT = ZERO
 13447           MOVE ER-2635             TO WS-ERROR
 13448           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13449
 13450******************************************************************
 13451*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13452******************************************************************
 13453
 13454     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13455        NEXT SENTENCE
 13456     ELSE
 13457        IF PB-I-AH-PREMIUM-AMT = ZERO
 13458            IF NOT PB-COMP-AH-PREM
 13459                MOVE ER-2636    TO WS-ERROR
 13460                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13461
 13462
 13463 3140-EDIT-MAX-AMT-SIZES.
 13464* CUSTOM CODE FOR CLIENT    'DMD'
 13465     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13466                                     WS-RES-MUNI-TAX
 13467                                     PB-I-STATE-TAX
 13468                                     PB-I-MUNI-TAX.
 13469
 13470     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13471
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 246
* EL050.cbl
 13472     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13473        GO TO 3150-RATE-OUTSTAND-BAL.
 13474
 13475     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13476        GO TO 3150-RATE-OUTSTAND-BAL.
 13477
 13478     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13479        GO TO 3150-RATE-OUTSTAND-BAL.
 13480
 13481     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13482                             OR 'RIC')
 13483        GO TO 3150-RATE-OUTSTAND-BAL.
 13484
 13485     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13486        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13487            GO TO 3150-RATE-OUTSTAND-BAL
 13488        ELSE
 13489           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13490               GO TO 3150-RATE-OUTSTAND-BAL.
 13491
 13492     IF NOT PB-NO-MONTHS-SKIPPED
 13493        GO TO 3150-RATE-OUTSTAND-BAL.
 13494
 13495     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13496        GO TO 3150-RATE-OUTSTAND-BAL.
 13497
 13498     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13499        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13500           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13501             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13502           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13503           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13504              MOVE ER-2693     TO WS-ERROR
 13505              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13506              GO TO 3150-RATE-OUTSTAND-BAL
 13507           ELSE
 13508              GO TO 3150-RATE-OUTSTAND-BAL.
 13509
 13510 3150-RATE-OUTSTAND-BAL.
 13511
 13512* DMD RATING TEST
 13513     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13514         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13515         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13516         MOVE ER-2687                 TO WS-ERROR
 13517         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13518         MOVE 'B'                     TO PB-I-OB-FLAG
 13519         GO TO 3260-EDIT-CONTINUE.
 13520
 13521     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13522         IF  WS-ERROR    EQUAL    ER-2693
 13523             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13524                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13525                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13526                 MOVE  +0            TO  WS-ERROR.
 13527
 13528     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13529         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 247
* EL050.cbl
 13530             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13531                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13532                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13533                 MOVE  +0            TO  WS-ERROR.
 13534
 13535     IF PLAN-MASTER-AH-SW = 'Y'
 13536        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13537            IF  WS-ERROR    EQUAL    ER-2693
 13538              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13539                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13540                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13541                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13542                 MOVE  ER-1910           TO  WS-ERROR
 13543                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13544
 13545     IF PLAN-MASTER-AH-SW = 'Y'
 13546        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13547            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13548               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13549               MOVE  ER-1910           TO  WS-ERROR
 13550               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13551
 13552     IF PLAN-MASTER-AH-SW = 'Y'
 13553        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13554            IF  WS-ERROR    EQUAL    ER-2693
 13555                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13556                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13557                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13558                 MOVE  +0       TO  WS-ERROR.
 13559
 13560     IF WS-ERROR = ER-2693
 13561        IF PB-COMPANY-ID = 'JAL' AND
 13562           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13563           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13564           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13565
 13566     IF WS-ERROR = ER-2693
 13567        IF PB-COMPANY-ID = 'NCL'  AND
 13568           PB-I-AH-BENEFIT-CD = 'OA'
 13569           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13570           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13571
 13572     IF WS-ERROR = ER-2693
 13573        IF PB-COMPANY-ID = 'CNL' AND
 13574           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13575           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13576           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13577
 13578     IF WS-ERROR = ER-2693
 13579        IF PB-COMPANY-ID = 'HER'
 13580           IF WS-LEVEL
 13581              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13582              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13583
 13584     IF ((LF-BENEFIT-FOUND) AND
 13585         (NOT NO-LIFE-COVERAGE)  AND
 13586         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13587       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 248
* EL050.cbl
 13588             (NOT NO-AH-COVERAGE)    AND
 13589             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13590         NEXT SENTENCE
 13591     ELSE
 13592         GO TO 3215-EDIT-RATES.
 13593
 13594     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13595        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13596           MOVE ER-2674          TO WS-ERROR
 13597           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13598           GO TO 3215-EDIT-RATES.
 13599
 13600     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13601        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13602           MOVE ER-2674          TO WS-ERROR
 13603           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13604           GO TO 3215-EDIT-RATES.
 13605
 13606     MOVE 'B'                    TO PB-I-OB-FLAG.
 13607
 13608     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13609         NEXT SENTENCE
 13610     ELSE
 13611         IF NOT NO-LIFE-COVERAGE
 13612             IF WS-ACCT-LF-OB-RT = ZERO
 13613                MOVE ER-2641    TO WS-ERROR
 13614                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13615
 13616     IF PB-COMPANY-ID = 'CRI'
 13617       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13618         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13619         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13620         IF WS-ERROR = ER-2675
 13621            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13622            MOVE ER-2687              TO WS-ERROR
 13623            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13624         ELSE
 13625            MOVE ER-2687              TO WS-ERROR
 13626            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13627
 13628
 13629     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13630         NEXT SENTENCE
 13631     ELSE
 13632       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13633            NEXT SENTENCE
 13634       ELSE
 13635         IF NOT NO-AH-COVERAGE
 13636             IF WS-ACCT-AH-OB-RT = ZERO
 13637                MOVE ER-2642    TO WS-ERROR
 13638                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13639
 13640     IF PB-COMPANY-ID = 'CRI'
 13641       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13642         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13643         IF WS-ERROR = ER-2676
 13644            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13645            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 249
* EL050.cbl
 13646            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13647         ELSE
 13648            MOVE ER-2687              TO WS-ERROR
 13649            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13650
 13651     IF PB-COMPANY-ID NOT = 'GIC'
 13652         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13653            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13654     ELSE
 13655         IF PB-I-LF-PREM-CALC = ZEROS
 13656             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13657                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13658
 13659     IF PB-COMPANY-ID NOT = 'GIC'
 13660         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13661            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13662     ELSE
 13663         IF PB-I-AH-PREM-CALC = ZEROS
 13664             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13665                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13666
 13667     MOVE ZEROS TO PB-I-MORT-CODE.
 13668
 13669     GO TO 3260-EDIT-CONTINUE.
 13670
 13671
 13672 3215-EDIT-RATES.
 13673     IF ACCOUNT-MAST-FOUND
 13674         NEXT SENTENCE
 13675     ELSE
 13676         GO TO 3999-END-EDIT.
 13677
 13678 3220-CHECK-LF-RATES.
 13679
 13680     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13681        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13682        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13683        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13684           AND (NOT WS-LF-CASH))
 13685                           OR
 13686           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13687           AND (NOT WS-AH-CASH)))
 13688                       AND
 13689           (PB-I-ENTRY-STATUS NOT = '5')
 13690           MOVE 'M'              TO PB-BATCH-ENTRY
 13691                                    PB-I-ENTRY-STATUS
 13692        END-IF
 13693     END-IF
 13694     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13695                                    PB-I-AH-PREM-CALC
 13696                                    PB-I-LF-ALT-PREM-CALC
 13697                                    PB-I-LF-ALT-RATE
 13698                                    PB-I-LF-REI-RATE
 13699                                    PB-I-LF-ALT-REI-RATE
 13700                                    PB-I-AH-REI-RATE
 13701                                    PB-I-TOT-FEES-CALC.
 13702
 13703     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 250
* EL050.cbl
 13704        NEXT SENTENCE
 13705     ELSE
 13706        MOVE ZEROS               TO PB-I-LF-RATE
 13707                                    PB-I-AH-RATE.
 13708
 13709     IF PB-I-TOT-FEES NOT NUMERIC
 13710        MOVE ZEROS               TO PB-I-TOT-FEES
 13711     END-IF
 13712     IF PB-I-LIVES NOT NUMERIC
 13713         MOVE ZERO               TO PB-I-LIVES.
 13714
 13715     IF PB-I-NUM-BILLED NOT NUMERIC
 13716         MOVE ZERO               TO PB-I-NUM-BILLED.
 13717
 13718     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13719        MOVE +0                  TO PB-I-LF-PREM-TAX
 13720     END-IF
 13721
 13722     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13723        MOVE +0                  TO PB-I-AH-PREM-TAX
 13724     END-IF
 13725
 13726     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13727        PB-I-PAY-FREQUENCY = ZEROS
 13728            MOVE 12 TO CP-PAY-FREQUENCY
 13729     ELSE
 13730            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13731
 13732     IF PB-I-STATE-TAX NOT NUMERIC
 13733         MOVE ZEROS               TO PB-I-STATE-TAX.
 13734
 13735     IF PB-I-MUNI-TAX NOT NUMERIC
 13736         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13737
 13738     MOVE SPACES                 TO CP-BEN-CATEGORY
 13739     IF PB-COMPANY-ID  = 'CSL'  AND
 13740        PB-I-LF-TERM NOT = ZERO
 13741        COMPUTE WS-PAYMENT-AMT =
 13742             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13743        COMPUTE WS-CSL-AMT1 =
 13744             PB-I-LF-TERM * AM-MAX-MON-BEN
 13745        COMPUTE WS-CSL-AMT2 =
 13746             WS-PAYMENT-AMT * PB-I-LF-TERM
 13747        IF CP-PAY-FREQUENCY NOT = 12
 13748           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13749           MOVE '8' TO WS-CSL-CALC-CD
 13750        ELSE
 13751           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13752              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13753               AM-MAX-TOT-BEN
 13754               MOVE '6' TO WS-CSL-CALC-CD
 13755           ELSE
 13756              IF (WS-CSL-AMT1  GREATER THAN
 13757                 AM-MAX-TOT-BEN) AND
 13758                 (WS-CSL-AMT2  GREATER THAN
 13759                 AM-MAX-TOT-BEN)
 13760                 MOVE '7' TO WS-CSL-CALC-CD
 13761              ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 251
* EL050.cbl
 13762                 MOVE '5' TO WS-CSL-CALC-CD.
 13763
 13764     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13765         NEXT SENTENCE
 13766     ELSE
 13767         GO TO 3300-CHECK-AH-RATES.
 13768
 13769*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13770
 13771     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13772        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13773              OR
 13774           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13775           MOVE ER-2618          TO WS-ERROR
 13776           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13777           GO TO 3300-CHECK-AH-RATES.
 13778
 13779     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13780           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13781                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13782
 13783     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13784         MOVE ER-2687             TO WS-ERROR
 13785         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13786         MOVE 'Z000'              TO PB-I-MORT-CODE
 13787         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13788         GO TO 3300-CHECK-AH-RATES.
 13789
 13790     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13791        IF PB-I-LIVES = ZERO
 13792           MOVE ER-2688          TO WS-ERROR
 13793           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13794
 13795     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13796
 13797     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13798     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13799     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13800     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13801     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13802     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13803     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13804     MOVE '3'                    TO CP-PROCESS-TYPE.
 13805     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13806     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13807
 13808******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13809     IF PB-COMPANY-ID EQUAL 'CDL'
 13810         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13811            CP-EARN-AS-NET-PAY)
 13812             IF PB-CERT-EFF-DT GREATER  WS-931231
 13813                 MOVE '1'        TO CP-EARNING-METHOD.
 13814*******
 13815
 13816     MOVE PB-SV-STATE            TO CP-STATE.
 13817     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13818     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13819     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 252
* EL050.cbl
 13820     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13821     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13822                                    CP-RATING-BENEFIT-AMT.
 13823     IF CP-STATE-STD-ABBRV = 'OR'
 13824         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13825                                         PB-I-LF-ALT-BENEFIT-AMT.
 13826     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13827     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13828     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13829     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13830     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13831     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13832     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13833     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13834     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13835                                    CP-REMAINING-TERM
 13836                                    CP-LOAN-TERM.
 13837
 13838     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13839         NEXT SENTENCE
 13840     ELSE
 13841         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13842             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13843                                           PB-I-LF-PREMIUM-AMT.
 13844
 13845     IF PB-COMPANY-ID EQUAL 'CSL'
 13846        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13847           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13848                                         PB-I-LF-PREMIUM-AMT.
 13849
 13850     IF PB-COMPANY-ID EQUAL 'NCB'
 13851         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13852            CP-EARN-AS-NET-PAY
 13853             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13854                 PB-I-LF-PREMIUM-AMT.
 13855
 13856     IF (CP-TRUNCATED-LIFE)
 13857        or ((pb-company-id = 'AHL')
 13858           and (pb-i-loan-term > pb-i-lf-term))
 13859        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13860
 13861     IF PB-COMPANY-ID EQUAL 'CRI'
 13862        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13863
 13864     IF CP-TERM-IS-DAYS
 13865         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13866     ELSE
 13867         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13868     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13869        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13870        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13871        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13872        IF WS-LF-BEN-CATEGORY = 'D'
 13873           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13874           MOVE PB-I-LIFE-COMMISSION
 13875                                 TO CP-DCC-ACT-COMM
 13876           MOVE WS-LF-BEN-CATEGORY
 13877                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 253
* EL050.cbl
 13878        END-IF
 13879        IF (CP-BENEFIT-CD (1:1) = 'P')
 13880           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13881           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13882           add pb-i-ah-premium-amt to cp-original-premium
 13883        END-IF
 13884     END-IF
 13885     IF PB-COMPANY-ID = 'CSL'
 13886         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13887         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13888         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13889
 13890     IF PB-COMPANY-ID = 'CSL'
 13891        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13892
 13893     IF (CP-SPECIAL-CALC-CD = 'H')
 13894        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13895         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13896                                    TO CP-ALTERNATE-BENEFIT
 13897         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13898     if (pb-company-id = 'CID')
 13899        and (ws-lf-earnings-calc = '4')
 13900        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13901        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13902        move pb-i-term-type      to cp-pmt-mode
 13903        move pb-i-no-of-payments to cp-no-of-pmts
 13904     end-if
 13905     move ws-net-only-state      to cp-net-only-state
 13906     IF (PB-COMPANY-ID = 'CID')
 13907        AND (WS-LF-EARNINGS-CALC = 'B')
 13908        AND (CP-STATE-STD-ABBRV = 'MN')
 13909        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13910                                 TO CP-ALTERNATE-BENEFIT
 13911        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13912     END-IF
 13913     IF (PB-COMPANY-ID = 'CID')
 13914        AND (WS-LF-EARNINGS-CALC = 'B')
 13915        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13916                                 TO CP-ALTERNATE-BENEFIT
 13917        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13918        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13919*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13920*         pb-i-lf-alt-premium-amt
 13921        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13922        IF WS-LF-BEN-CATEGORY = 'P'
 13923           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13924        ELSE
 13925           IF WS-LF-BEN-CATEGORY = 'I'
 13926              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13927           END-IF
 13928        END-IF
 13929     END-IF
 13930     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13931     MOVE 'R'                   TO CP-RATE-FILE.
 13932     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13933
 13934     IF CP-ERROR-RATE-NOT-FOUND
 13935        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 254
* EL050.cbl
 13936        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13937        GO TO 3300-CHECK-AH-RATES.
 13938
 13939     IF PB-COMPANY-ID EQUAL 'CRI'
 13940        IF CP-ERROR-NO-LIMITS-CRI
 13941           IF NOT ACCOUNT-LIFE-CHECKED
 13942              MOVE ER-2607      TO WS-ERROR
 13943              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13944
 13945******************************************************************
 13946*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13947*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13948******************************************************************
 13949
 13950* CALC LIFE AGE AT EXPIRATION.
 13951
 13952     COMPUTE WS-AGE-AT-EXPIRE =
 13953          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13954
 13955*    IF PB-STATE = 'CO' OR 'UT'
 13956*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13957*        MOVE 'F'            TO PB-FATAL-FLAG
 13958*        MOVE ER-2709        TO WS-ERROR
 13959*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13960*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13961
 13962*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13963*        MOVE 'X'            TO PB-FATAL-FLAG
 13964*        MOVE ER-2718        TO WS-ERROR
 13965*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13966*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13967
 13968* CALC A & H AGE AT EXPIRATION.
 13969
 13970     COMPUTE WS-AGE-AT-EXPIRE =
 13971          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13972
 13973*    IF PB-STATE = 'CO' OR 'UT'
 13974*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13975*        MOVE 'F'            TO PB-FATAL-FLAG
 13976*        MOVE ER-2709        TO WS-ERROR
 13977*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13978*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13979
 13980*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13981*        MOVE 'X'            TO PB-FATAL-FLAG
 13982*        MOVE ER-2718        TO WS-ERROR
 13983*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13984*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13985
 13986     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13987        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13988
 13989     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13990        and (not pb-monthly-cert)
 13991        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13992     end-if
 13993
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 255
* EL050.cbl
 13994     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13995        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13996
 13997     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13998         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13999         MOVE ER-2639        TO WS-ERROR
 14000         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14001
 14002
 14003******************************************************************
 14004*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14005******************************************************************
 14006
 14007 PREMIUM-EDITING-IS-BYPASSED.
 14008     IF (CP-R-MAX-ATT-AGE NUMERIC)
 14009        AND (CP-R-MAX-ATT-AGE > +0)
 14010        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 14011        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14012           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14013           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14014           MOVE '1'              TO DC-OPTION-CODE
 14015           PERFORM 8500-DATE-CONVERT
 14016                                 THRU 8500-EXIT
 14017           IF NO-CONVERSION-ERROR
 14018              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14019                 MOVE ER-2661       TO WS-ERROR
 14020*                PERFORM 9900-ERROR-FORMAT
 14021*                                THRU 9900-EXIT
 14022              END-IF
 14023           END-IF
 14024        ELSE
 14025           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14026           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14027              MOVE ER-2661       TO WS-ERROR
 14028*             PERFORM 9900-ERROR-FORMAT
 14029*                                THRU 9900-EXIT
 14030           ELSE
 14031              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14032                 MOVE ER-1570    TO WS-ERROR
 14033                 PERFORM 9900-ERROR-FORMAT
 14034                                 THRU 9900-EXIT
 14035              END-IF
 14036           END-IF
 14037        END-IF
 14038        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14039           MOVE PB-I-JOINT-BIRTHDAY
 14040                                 TO DC-BIN-DATE-1
 14041           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14042           MOVE '1'              TO DC-OPTION-CODE
 14043           PERFORM 8500-DATE-CONVERT
 14044                                 THRU 8500-EXIT
 14045           IF NO-CONVERSION-ERROR
 14046              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14047                 MOVE ER-2661       TO WS-ERROR
 14048*                PERFORM 9900-ERROR-FORMAT
 14049*                                THRU 9900-EXIT
 14050              END-IF
 14051           ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 256
* EL050.cbl
 14052              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14053           END-IF
 14054        ELSE
 14055           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14056             (PB-I-LF-TERM / 12)
 14057           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14058              MOVE ER-2661       TO WS-ERROR
 14059*             PERFORM 9900-ERROR-FORMAT
 14060*                                THRU 9900-EXIT
 14061           ELSE
 14062              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14063                 MOVE ER-1571    TO WS-ERROR
 14064                 PERFORM 9900-ERROR-FORMAT
 14065                                 THRU 9900-EXIT
 14066              END-IF
 14067           END-IF
 14068        END-IF
 14069        IF WS-ERROR = ER-2661
 14070           PERFORM 9900-ERROR-FORMAT
 14071                                 THRU 9900-EXIT
 14072        END-IF
 14073     END-IF
 14074*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14075*       MOVE ER-2661             TO WS-ERROR
 14076*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14077
 14078     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14079        MOVE ER-2662             TO WS-ERROR
 14080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14081
 14082     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14083        MOVE ER-2677             TO WS-ERROR
 14084        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14085
 14086     IF CP-ERROR-LOAN-TERM
 14087        MOVE ER-2648             TO WS-ERROR
 14088        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14089
 14090 3221-CHECK-ERROR-RATE-OPEN.
 14091
 14092     IF CP-ERROR-RATE-FILE-NOTOPEN
 14093         GO TO 3990-FILES-NOT-OPEN.
 14094
 14095     IF PB-COMPANY-ID NOT = 'DMD'
 14096        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14097     END-IF
 14098     .
 14099 3221-CONTINUE.
 14100     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14101                                    WS-DCC-AH-RATE
 14102     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14103        IF WS-LF-BEN-CATEGORY = 'D'
 14104           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14105              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14106        END-IF
 14107     END-IF
 14108     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14109*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 257
* EL050.cbl
 14110     IF (PB-COMPANY-ID = 'CID')
 14111        AND (WS-LF-EARNINGS-CALC = 'B')
 14112        AND (CP-STATE-STD-ABBRV = 'MN')
 14113        AND (PB-CERT-EFF-DT > X'A4FF')
 14114        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14115     END-IF
 14116     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14117
 14118     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14119     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14120        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14121        AND (PB-I-POLICY-IS-MONTHLY)
 14122        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14123        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14124     END-IF
 14125     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14126     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14127     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14128     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14129     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14130        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14131        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14132        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14133        MOVE ER-2786             TO WS-ERROR
 14134        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14135     END-IF
 14136
 14137     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14138
 14139******************************************************************
 14140*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14141******************************************************************
 14142     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14143        and ((not pb-monthly-cert)
 14144        or (ws-lf-ben-category = 'C'))
 14145        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14146
 14147     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14148        GO TO 3225-CHECK-ALT-LIFE-RATE
 14149     ELSE
 14150       IF PB-I-LF-RATE = ZERO
 14151          MOVE ER-2641          TO WS-ERROR
 14152          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14153
 14154 3225-CHECK-ALT-LIFE-RATE.
 14155
 14156     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14157        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14158        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14159         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14160
 14161     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14162         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14163             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14164                   OR
 14165              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14166              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14167              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 258
* EL050.cbl
 14168             MOVE ER-2720        TO  WS-ERROR
 14169             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14170             GO TO 3225-RATING-CONT
 14171         ELSE
 14172             GO TO 3225-RATING-CONT.
 14173     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14174        AND (AM-GPCD = 01 OR 06 OR 15)
 14175        MOVE ER-2798             TO WS-ERROR
 14176        PERFORM 9900-ERROR-FORMAT
 14177                                 THRU 9900-EXIT
 14178*       GO TO 3225-RATING-CONT
 14179     END-IF
 14180     if (pb-company-id = 'CID')
 14181        and (ws-lf-earnings-calc = 'B')
 14182        and (ws-lf-ben-category = 'P' or 'I')
 14183        and (ws-net-only-state = 'Y')
 14184        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14185*       display ' balloon prem ' pb-i-lf-alt-prem-calc
 14186        go to 3225-rating-cont
 14187     end-if
 14188     IF (PB-COMPANY-ID = 'CID')
 14189        AND (WS-LF-EARNINGS-CALC = 'B')
 14190        AND (CP-STATE-STD-ABBRV = 'MN')
 14191        AND (PB-CERT-EFF-DT > X'A4FF')
 14192        GO TO 3225-RATING-CONT
 14193     END-IF
 14194     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14195        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14196           AND (PB-I-POLICY-IS-MONTHLY)
 14197           GO TO 3225-RATING-CONT
 14198        END-IF
 14199     END-IF
 14200
 14201     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14202        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14203        CP-EARN-AS-REG-BALLOON
 14204        NEXT SENTENCE
 14205     ELSE
 14206        MOVE '2'                 TO CP-EARNING-METHOD.
 14207
 14208 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14209
 14210     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14211
 14212     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14213        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14214        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14215         NEXT SENTENCE
 14216     ELSE
 14217         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14218
 14219     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14220     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14221     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14222                                     CP-RATING-BENEFIT-AMT.
 14223     IF CP-STATE-STD-ABBRV = 'OR'
 14224         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14225                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 259
* EL050.cbl
 14226     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14227        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14228     END-IF
 14229     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14230     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14231     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14232                                    CP-REMAINING-TERM
 14233                                    CP-LOAN-TERM.
 14234     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14235        ADD +1                   TO CP-ORIGINAL-TERM
 14236                                    CP-REMAINING-TERM
 14237                                    CP-LOAN-TERM.
 14238
 14239     MOVE 'R'                   TO CP-RATE-FILE.
 14240     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14241
 14242     IF CP-ERROR-RATE-NOT-FOUND
 14243         MOVE ER-2641            TO WS-ERROR
 14244         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14245         GO TO 3300-CHECK-AH-RATES.
 14246
 14247     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14248     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14249
 14250     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14251         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14252
 14253     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14254                               + PB-I-LF-ALT-BENEFIT-AMT.
 14255
 14256     IF ACCOUNT-LIFE-CHECKED  OR
 14257        PB-POLICY-IS-VOIDED   OR
 14258        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14259        and (not pb-monthly-cert))
 14260        GO TO 3225-CONTINUE.
 14261
 14262     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14263        GO TO 3225-CONTINUE.
 14264
 14265     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14266                             EC-RT-LF-MAX-TOT-BEN
 14267        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14268        MOVE ER-2639       TO WS-ERROR
 14269        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14270
 14271 3225-CONTINUE.
 14272     IF PB-I-LF-ALT-RATE = ZERO
 14273         MOVE ER-2659            TO WS-ERROR
 14274         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14275
 14276     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14277        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14278        MOVE ER-2698             TO WS-ERROR
 14279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14280
 14281 3225-RATING-CONT.
 14282
 14283     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 260
* EL050.cbl
 14284        and (not pb-monthly-cert)
 14285         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14286         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14287         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14288            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14289            CONTINUE
 14290         ELSE
 14291            MOVE ER-2687         TO WS-ERROR
 14292            PERFORM 9900-ERROR-FORMAT
 14293                                 THRU 9900-EXIT
 14294         END-IF
 14295         GO TO 3290-EDIT-LF-REIN-RATE
 14296     END-IF
 14297
 14298* DMD RATING TEST
 14299     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14300         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14301         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14302         MOVE ER-2687                 TO WS-ERROR
 14303         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14304         GO TO 3290-EDIT-LF-REIN-RATE.
 14305
 14306 3230-CLIENT-MORT-CD-SPECIALS.
 14307
 14308     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14309     SET BIN-TO-GREG          TO TRUE.
 14310*    MOVE ' '                 TO DC-OPTION-CODE.
 14311     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14312     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14313
 14314 C-POS-3230-MORT-CD.
 14315     IF PB-COMPANY-ID = 'POS' AND
 14316        PB-SV-CARRIER = '2'
 14317         NEXT SENTENCE
 14318     ELSE
 14319         GO TO C-POS-3240-MORT-CD.
 14320
 14321     IF PB-SV-GROUPING = '030'
 14322        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14323         MOVE '2350' TO PB-I-MORT-CODE
 14324      ELSE
 14325         MOVE '3300' TO PB-I-MORT-CODE.
 14326
 14327
 14328 C-POS-3240-MORT-CD.
 14329     IF PB-COMPANY-ID = 'POS' AND
 14330        PB-SV-CARRIER = '1'
 14331         NEXT SENTENCE
 14332     ELSE
 14333         GO TO 3230-CONTINUE.
 14334
 14335     IF PB-SV-STATE = '45' OR '47'
 14336        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14337         MOVE '5200' TO PB-I-MORT-CODE
 14338     ELSE
 14339         MOVE '8300' TO PB-I-MORT-CODE.
 14340
 14341 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 261
* EL050.cbl
 14342
 14343     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14344        GO TO 3240-CONTINUE
 14345     END-IF
 14346
 14347     IF PB-CERT-EFF-DT > WS-971231
 14348        GO TO 3240-CONTINUE
 14349     END-IF
 14350
 14351     IF LF-BENEFIT-FOUND AND
 14352        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14353         MOVE 'F250'       TO PB-I-MORT-CODE
 14354     ELSE
 14355         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14356             MOVE '7250'   TO PB-I-MORT-CODE
 14357         ELSE
 14358             MOVE '4251'   TO PB-I-MORT-CODE
 14359         END-IF
 14360     END-IF
 14361
 14362     .
 14363 3240-CONTINUE.
 14364
 14365     IF PB-COMPANY-ID NOT = 'GNL'
 14366         GO TO 3256-CONTINUE.
 14367
 14368     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14369         MOVE 'A300' TO PB-I-MORT-CODE
 14370     ELSE
 14371         MOVE '8350' TO PB-I-MORT-CODE.
 14372
 14373 3256-CONTINUE.
 14374     IF PB-COMPANY-ID NOT = 'ABL'
 14375         GO TO 3260-EDIT-CONTINUE.
 14376
 14377     IF PB-I-LF-TERM GREATER THAN 59
 14378         MOVE 'F550' TO PB-I-MORT-CODE
 14379     ELSE
 14380         MOVE 'E550' TO PB-I-MORT-CODE.
 14381
 14382 3260-EDIT-CONTINUE.
 14383     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14384
 14385 3290-EDIT-LF-REIN-RATE.
 14386     IF LF-REIN-NSP-NOT-USED
 14387         GO TO 3290-RATING-CONT.
 14388
 14389     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14390        GO TO 3290-RATING-CONT.
 14391     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14392     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14393     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14394     MOVE '3'                   TO CP-PROCESS-TYPE.
 14395     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14396
 14397******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14398     IF PB-COMPANY-ID EQUAL 'CDL'
 14399         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 262
* EL050.cbl
 14400            CP-EARN-AS-NET-PAY)
 14401             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14402*            MOVE SPACE          TO DC-OPTION-CODE
 14403             SET BIN-TO-GREG     TO TRUE
 14404             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14405***  Y2K PROJ 7744
 14406             IF DC-GREG-DATE-CYMD GREATER 19931231
 14407                 MOVE '1'        TO CP-EARNING-METHOD.
 14408***  Y2K PROJ 7744
 14409*******
 14410
 14411     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14412     MOVE PB-SV-STATE           TO CP-STATE.
 14413     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14414     MOVE ZERO                  TO CP-DEVIATION-CODE
 14415                                   CP-RATE-DEV-PCT.
 14416     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14417     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14418                                   CP-RATING-BENEFIT-AMT.
 14419
 14420************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14421     IF PB-COMPANY-ID EQUAL 'NCB'
 14422         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14423            CP-EARN-AS-NET-PAY
 14424             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14425                 PB-I-LF-PREMIUM-AMT.
 14426************
 14427
 14428     IF CP-STATE-STD-ABBRV = 'OR'
 14429         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14430                                         PB-I-LF-ALT-BENEFIT-AMT.
 14431     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14432     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14433     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14434     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14435     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14436     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14437     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14438     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14439                                   CP-REMAINING-TERM
 14440                                   CP-LOAN-TERM.
 14441     IF CP-TRUNCATED-LIFE
 14442        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14443
 14444     IF CP-TERM-IS-DAYS
 14445         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14446     ELSE
 14447         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14448
 14449     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14450        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14451     END-IF
 14452     IF PB-COMPANY-ID NOT = 'TIC'
 14453          MOVE ZERO          TO CP-CLASS-CODE.
 14454
 14455     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14456
 14457     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 263
* EL050.cbl
 14458     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14459
 14460     IF CP-ERROR-RATE-NOT-FOUND
 14461        IF PB-I-OB
 14462           MOVE ER-2625      TO WS-ERROR
 14463           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14464           GO TO 3299-EDIT-CONTINUE
 14465        ELSE
 14466           MOVE ER-2643      TO WS-ERROR
 14467           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14468           GO TO 3299-EDIT-CONTINUE.
 14469
 14470     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14471
 14472     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14473     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14474
 14475     IF PB-I-LF-REI-RATE = ZERO
 14476         MOVE ER-2643        TO WS-ERROR
 14477         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14478
 14479 3290-CHECK-ALT-REIN-RATE.
 14480
 14481     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14482        GO TO 3290-RATING-CONT.
 14483
 14484     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14485     MOVE '2'                    TO CP-EARNING-METHOD.
 14486     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14487     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14488     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14489     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14490                                     CP-RATING-BENEFIT-AMT.
 14491     IF CP-STATE-STD-ABBRV = 'OR'
 14492         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14493                                         PB-I-LF-ALT-BENEFIT-AMT.
 14494     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14495        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14496     END-IF
 14497     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14498     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14499     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14500                                    CP-REMAINING-TERM
 14501                                    CP-LOAN-TERM.
 14502     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14503        ADD +1                   TO CP-ORIGINAL-TERM
 14504                                    CP-REMAINING-TERM
 14505                                    CP-LOAN-TERM.
 14506
 14507     MOVE 'R'                   TO CP-RATE-FILE.
 14508     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14509
 14510     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14511
 14512     IF PB-I-LF-ALT-REI-RATE = ZERO
 14513         MOVE ER-2643            TO WS-ERROR
 14514         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14515
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 264
* EL050.cbl
 14516 3290-RATING-CONT.
 14517
 14518     IF PB-I-OB
 14519*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14520        GO TO 3300-CHECK-AH-RATES.
 14521
 14522 3299-EDIT-CONTINUE.
 14523
 14524     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14525         NEXT SENTENCE
 14526     ELSE
 14527         MOVE ER-2620           TO WS-ERROR
 14528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14529
 14530 3300-CHECK-AH-RATES.
 14531     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14532         NEXT SENTENCE
 14533     ELSE
 14534         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14535
 14536     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14537        and (not pb-monthly-cert))
 14538                  or
 14539        ((CF-COMPANY-ID = 'DMD') AND
 14540                (NO-DMD-RATING))
 14541         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14542            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14543            CONTINUE
 14544         ELSE
 14545            MOVE ER-2687         TO WS-ERROR
 14546            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14547         END-IF
 14548         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14549         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14550     END-IF
 14551
 14552     IF PB-I-OB
 14553        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14554
 14555     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14556         MOVE ER-2687             TO WS-ERROR
 14557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14558         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14559         GO TO 3999-END-EDIT.
 14560
 14561*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14562     if pb-company-id = 'AHL'
 14563        go to 3300-skip-crit-per
 14564     end-if
 14565     if (pb-i-ah-crit-per not = zeros)
 14566        and (ws-ah-special-calc-cd not = 'C')
 14567        MOVE ER-1572             TO WS-ERROR
 14568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14569        go to 3300-skip-crit-per
 14570     END-IF
 14571     if (pb-company-id = 'DCC' or 'VPP')
 14572        and (am-dcc-product-code not = spaces)
 14573        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 265
* EL050.cbl
 14574     end-if
 14575     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14576        IF PB-I-AH-CRIT-PER = ZERO
 14577           move ws-ah-max-bens   to pb-i-ah-crit-per
 14578*          MOVE ER-2618       TO WS-ERROR
 14579*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14580*          GO TO 3999-END-EDIT
 14581        END-IF
 14582     END-IF
 14583     if (ws-ah-special-calc-cd = 'C')
 14584        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14585        MOVE ER-1576             TO WS-ERROR
 14586        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14587     end-if
 14588
 14589     .
 14590 3300-skip-crit-per.
 14591     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14592     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14593     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14594     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14595     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14596     MOVE PB-SV-STATE            TO CP-STATE.
 14597     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14598     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14599     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14600*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14601     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14602     MOVE '3'                    TO CP-PROCESS-TYPE.
 14603     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14604     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14605                                    CP-RATING-BENEFIT-AMT.
 14606     IF PB-COMPANY-ID = 'CID'
 14607               OR
 14608        CP-STATE-STD-ABBRV = 'OR'
 14609         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14610                                         PB-I-AH-TERM.
 14611     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14612        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14613           AND (PB-I-POLICY-IS-MONTHLY)
 14614           MOVE PB-I-LF-BENEFIT-AMT
 14615                                 TO CP-NET-BENEFIT-AMT
 14616           move pb-i-ah-premium-amt to cp-original-premium
 14617           add pb-i-lf-premium-amt to cp-original-premium
 14618        END-IF
 14619     END-IF
 14620     MOVE SPACES                 TO CP-BEN-CATEGORY
 14621     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14622        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14623        EVALUATE TRUE
 14624           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14625              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14626              MOVE PB-I-LF-BENEFIT-AMT
 14627                                 TO CP-RATING-BENEFIT-AMT
 14628              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14629           WHEN WS-AH-BEN-CATEGORY = 'G'
 14630              MOVE PB-I-UNPAID-CASH-PRICE
 14631                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 266
* EL050.cbl
 14632           WHEN WS-AH-BEN-CATEGORY = 'D'
 14633              MOVE WS-AH-PMF-COMM
 14634                                 TO CP-DCC-PMF-COMM
 14635              MOVE PB-I-AH-COMMISSION
 14636                                 TO CP-DCC-ACT-COMM
 14637        END-EVALUATE
 14638     END-IF
 14639     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14640     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14641     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14642     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14643     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14644     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14645     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14646                                    CP-REMAINING-TERM
 14647                                    WS-WORK-TERM.
 14648     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14649
 14650     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14651     SET BIN-TO-GREG             TO TRUE.
 14652*    MOVE ' '                    TO DC-OPTION-CODE.
 14653     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14654     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE
 14655
 14656     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14657     IF NOT VALID-SKIP-CODE
 14658         MOVE ER-2683            TO WS-ERROR
 14659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14660         GO TO 3320-RATE-CONTINUE.
 14661
 14662     IF PB-NO-MONTHS-SKIPPED
 14663         GO TO 3320-RATE-CONTINUE.
 14664
 14665     MOVE SPACE TO NUMBER-OF-MONTHS.
 14666
 14667     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14668         MOVE 'S'                TO SK-MO (6).
 14669     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14670         MOVE 'S'                TO SK-MO (7).
 14671     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14672         MOVE 'S'                TO SK-MO (8).
 14673     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14674         MOVE 'S'                TO SK-MO (9).
 14675     IF PB-I-SKIP-CODE = 'A'
 14676         MOVE 'S'                TO SK-MO (10).
 14677
 14678     MOVE 1                      TO SUB2.
 14679     MOVE PB-I-AH-TERM           TO SUB3.
 14680     MOVE WS-MONTH               TO SUB1.
 14681     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14682     GO TO 3320-RATE-CONTINUE.
 14683
 14684 3310-GET-SKIP-MO.
 14685     IF SUB1 = 13
 14686         MOVE 1                  TO SUB1.
 14687
 14688     IF SK-MO (SUB1) = 'S'
 14689         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 267
* EL050.cbl
 14690
 14691     ADD 1 TO SUB2
 14692              SUB1.
 14693
 14694 3320-RATE-CONTINUE.
 14695
 14696     IF WS-WORK-TERM = ZERO
 14697         MOVE 1                  TO WS-WORK-TERM.
 14698
 14699     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14700                                    CP-LOAN-TERM.
 14701
 14702     IF PB-COMPANY-ID EQUAL 'DMD'
 14703         NEXT SENTENCE
 14704     ELSE
 14705         MOVE ZERO               TO PB-I-AH-RATE
 14706                                    PB-I-AH-REI-RATE.
 14707
 14708
 14709     IF PB-COMPANY-ID EQUAL 'CRI'
 14710        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14711
 14712     IF PB-COMPANY-ID = 'CSL'
 14713         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14714         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14715         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14716         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14717
 14718     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14719        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14720           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14721              PB-I-RATE-DEV-PCT-LF
 14722        END-IF
 14723        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14724                                 TO CP-ALTERNATE-BENEFIT
 14725        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14726        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14727        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14728     END-IF
 14729*    if ws-clp-state not = spaces
 14730*       move ws-clp-state to cp-state
 14731*    end-if
 14732     IF (PB-COMPANY-ID = 'CID')
 14733        AND (WS-LF-EARNINGS-CALC = 'B')
 14734        AND (CP-STATE-STD-ABBRV = 'MN')
 14735        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14736     ELSE
 14737        MOVE ' '                 TO CP-AH-BALLOON-SW
 14738     END-IF
 14739     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14740     MOVE 'R'                   TO CP-RATE-FILE.
 14741     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14742
 14743     IF (CP-ERROR-RATE-NOT-FOUND)
 14744        and (not pb-monthly-cert)
 14745        IF PB-I-OB
 14746           MOVE ER-2624          TO WS-ERROR
 14747           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 268
* EL050.cbl
 14748           GO TO 3340-CALCULATE-PREMIUM-AMT
 14749        ELSE
 14750          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14751              NEXT SENTENCE
 14752          ELSE
 14753           MOVE ER-2642          TO WS-ERROR
 14754           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14755           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14756
 14757     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14758        CP-ERROR-DIV-BY-ZERO
 14759           MOVE ER-3782          TO WS-ERROR
 14760           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14761
 14762     IF PB-COMPANY-ID EQUAL 'CRI'
 14763        IF CP-ERROR-NO-LIMITS-CRI
 14764           IF NOT ACCOUNT-AH-CHECKED
 14765              MOVE ER-2607          TO WS-ERROR
 14766              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14767
 14768     IF ACCOUNT-AH-CHECKED
 14769        NEXT SENTENCE
 14770     ELSE
 14771       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14772          MOVE ER-2640           TO WS-ERROR
 14773          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14774
 14775     IF PB-COMPANY-ID = 'CRI'
 14776         IF WS-ERROR = ER-2640
 14777             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14778     IF ACCOUNT-AH-CHECKED
 14779        CONTINUE
 14780     ELSE
 14781        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14782           AND (CP-R-MAX-ATT-AGE > +0)
 14783           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14784           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14785              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14786              MOVE PB-I-AH-EXPIRE-DT
 14787                                 TO DC-BIN-DATE-2
 14788              MOVE '1'           TO DC-OPTION-CODE
 14789              PERFORM 8500-DATE-CONVERT
 14790                                 THRU 8500-EXIT
 14791              IF NO-CONVERSION-ERROR
 14792                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14793                    MOVE ER-2661       TO WS-ERROR
 14794*                   PERFORM 9900-ERROR-FORMAT
 14795*                                THRU 9900-EXIT
 14796                 END-IF
 14797              END-IF
 14798           ELSE
 14799              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14800              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14801                 MOVE ER-2661    TO WS-ERROR
 14802*                PERFORM 9900-ERROR-FORMAT
 14803*                                THRU 9900-EXIT
 14804              ELSE
 14805                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 269
* EL050.cbl
 14806                    MOVE ER-1570 TO WS-ERROR
 14807                    PERFORM 9900-ERROR-FORMAT
 14808                                 THRU 9900-EXIT
 14809                 END-IF
 14810              END-IF
 14811           END-IF
 14812           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14813              MOVE PB-I-JOINT-BIRTHDAY
 14814                                    TO DC-BIN-DATE-1
 14815              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14816              MOVE '1'              TO DC-OPTION-CODE
 14817              PERFORM 8500-DATE-CONVERT
 14818                                    THRU 8500-EXIT
 14819              IF NO-CONVERSION-ERROR
 14820                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14821                    MOVE ER-2661       TO WS-ERROR
 14822*                   PERFORM 9900-ERROR-FORMAT
 14823*                                   THRU 9900-EXIT
 14824                 END-IF
 14825              END-IF
 14826           ELSE
 14827              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14828                (PB-I-AH-TERM / 12)
 14829              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14830                 MOVE ER-2661       TO WS-ERROR
 14831*                PERFORM 9900-ERROR-FORMAT
 14832*                                   THRU 9900-EXIT
 14833              ELSE
 14834                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14835                    MOVE ER-1571 TO WS-ERROR
 14836                    PERFORM 9900-ERROR-FORMAT
 14837                                 THRU 9900-EXIT
 14838                 END-IF
 14839              END-IF
 14840           END-IF
 14841           IF WS-ERROR = ER-2661
 14842              PERFORM 9900-ERROR-FORMAT
 14843                                    THRU 9900-EXIT
 14844           END-IF
 14845        END-IF
 14846     END-IF
 14847*    IF ACCOUNT-AH-CHECKED
 14848*       NEXT SENTENCE
 14849*    ELSE
 14850*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14851*          MOVE ER-2661          TO WS-ERROR
 14852*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14853
 14854     IF ACCOUNT-AH-CHECKED
 14855        NEXT SENTENCE
 14856     ELSE
 14857        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14858           MOVE ER-2663          TO WS-ERROR
 14859           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14860
 14861     IF ACCOUNT-AH-CHECKED OR
 14862        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14863         PB-POLICY-IS-VOIDED
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 270
* EL050.cbl
 14864        NEXT SENTENCE
 14865     ELSE
 14866        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14867           MOVE ER-2667            TO WS-ERROR
 14868           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14869
 14870     IF PB-COMPANY-ID = 'CRI'
 14871         IF WS-ERROR = ER-2667
 14872             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14873
 14874     IF ACCOUNT-AH-CHECKED
 14875        NEXT SENTENCE
 14876     ELSE
 14877        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14878           MOVE ER-2678            TO WS-ERROR
 14879           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14880
 14881     IF CP-ERROR-RATE-FILE-NOTOPEN
 14882         GO TO 3990-FILES-NOT-OPEN.
 14883
 14884 3321-CONTINUE.
 14885     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14886     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14887     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14888*    IF (PB-COMPANY-ID = 'DCC')
 14889        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14890        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14891                                    PB-I-LF-ALT-PREM-CALC
 14892        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14893        IF WS-AH-BEN-CATEGORY = 'G'
 14894           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14895           + PB-I-ADDL-CLP)
 14896           * (1 + WS-TOL-CLP-PCT)
 14897*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14898        ELSE
 14899           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14900           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14901*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14902        END-IF
 14903        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14904                                 TO PB-I-AH-PREM-CALC
 14905        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14906           MOVE ER-8152          TO WS-ERROR
 14907           PERFORM 9900-ERROR-FORMAT
 14908                                 THRU 9900-EXIT
 14909        ELSE
 14910           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14911                 PB-I-ADDL-CLP)
 14912              MOVE ER-8148       TO WS-ERROR
 14913              PERFORM 9900-ERROR-FORMAT
 14914                                 THRU 9900-EXIT
 14915           END-IF
 14916        END-IF
 14917     END-IF
 14918     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14919        AND (PB-I-POLICY-IS-MONTHLY)
 14920        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14921        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 271
* EL050.cbl
 14922        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14923           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14924        END-IF
 14925     END-IF
 14926     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14927        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14928        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14929        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14930        MOVE ER-2786             TO WS-ERROR
 14931        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14932     END-IF
 14933     MOVE +0                     TO PB-I-AH-CLP
 14934     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14935        evaluate true
 14936           when WS-AH-BEN-CATEGORY = 'D'
 14937              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14938                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14939           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14940              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14941           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14942              compute ws-cred-union-fees rounded =
 14943                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14944                    pb-i-ah-commission)
 14945              COMPUTE PB-I-AH-CLP =
 14946                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14947        end-evaluate
 14948     END-IF
 14949     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14950
 14951     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14952         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14953
 14954     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14955         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14956
 14957     if (ws-ah-special-calc-cd = 'E')
 14958        and (pb-monthly-cert)
 14959        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14960     end-if
 14961     IF PB-COMPANY-ID = 'CRI'
 14962         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14963            PB-I-PAYMENT-AMOUNT = ZERO
 14964             NEXT SENTENCE
 14965         ELSE
 14966             COMPUTE PB-I-AH-PREM-CALC =
 14967                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14968                 (CP-PREMIUM-RATE / 100)
 14969             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14970                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14971                                             PB-I-RATE-DEV-PCT-AH.
 14972
 14973     IF (PB-I-AH-RATE  = ZERO)
 14974        and (not pb-monthly-cert)
 14975       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14976           NEXT SENTENCE
 14977       ELSE
 14978         MOVE ER-2642            TO WS-ERROR
 14979         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 272
* EL050.cbl
 14980
 14981     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14982     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14983     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14984     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14985     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14986     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14987
 14988     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14989        AND (WS-AH-BEN-CATEGORY = 'G')
 14990        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14991        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14992        IF CP-DEVIATION-CODE NOT = '000'
 14993           MOVE '000'            TO CP-DEVIATION-CODE
 14994           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14995           IF NO-CP-ERROR
 14996              COMPUTE PB-I-DDF-IU-RATE-UP =
 14997              PB-I-AH-CLP - CP-CALC-PREMIUM
 14998           ELSE
 14999              MOVE ER-3057        TO WS-ERROR
 15000              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15001           END-IF
 15002        END-IF
 15003     END-IF
 15004     .
 15005 3335-EDIT-AH-REIN-NSP-RATE.
 15006     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15007        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 15008              compute ws-cred-union-fees rounded =
 15009                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 15010                    pb-i-ah-commission)
 15011              COMPUTE PB-I-AH-CLP =
 15012                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 15013        end-if
 15014     END-IF
 15015     IF AH-REIN-NSP-NOT-USED
 15016         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15017
 15018     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 15019     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15020         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15021     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 15022     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 15023     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 15024     MOVE PB-SV-STATE            TO CP-STATE.
 15025     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15026     MOVE ZERO                   TO CP-DEVIATION-CODE
 15027                                    CP-RATE-DEV-PCT.
 15028*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15029     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15030     MOVE '3'                    TO CP-PROCESS-TYPE.
 15031     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 15032     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15033                                    CP-RATING-BENEFIT-AMT.
 15034     IF CP-STATE-STD-ABBRV = 'OR'
 15035         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 15036                                         PB-I-AH-TERM.
 15037     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 273
* EL050.cbl
 15038     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15039     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15040     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15041     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15042     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 15043                                    CP-REMAINING-TERM
 15044                                    WS-WORK-TERM.
 15045     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 15046     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15047        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15048     END-IF
 15049     IF  PB-COMPANY-ID = 'TIC'
 15050         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15051            MOVE ZERO TO CP-CLASS-CODE.
 15052
 15053     IF PB-COMPANY-ID NOT = 'TIC'
 15054          MOVE ZERO          TO CP-CLASS-CODE.
 15055
 15056     MOVE ZERO               TO CP-DEVIATION-CODE.
 15057
 15058     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15059
 15060     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15061
 15062     MOVE 'R'                   TO CP-RATE-FILE.
 15063     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15064
 15065     IF CP-ERROR-RATE-NOT-FOUND
 15066         MOVE ER-2645        TO WS-ERROR
 15067         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15068         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15069
 15070     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15071
 15072     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15073     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15074
 15075     IF PB-I-AH-REI-RATE = ZERO
 15076         MOVE ER-2645        TO WS-ERROR
 15077         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15078
 15079
 15080 3340-CALCULATE-PREMIUM-AMT.
 15081     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15082     SET BIN-TO-GREG             TO TRUE
 15083     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 15084     move dc-greg-date-a-edit    to ws-greg-eff-date
 15085
 15086     IF PB-COMPANY-ID = 'NCL'
 15087         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15088             WS-AH-SPECIAL-CALC-CD = 'O')
 15089             GO TO 3999-END-EDIT.
 15090
 15091     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15092                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15093                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15094                         OR 'AHL'
 15095         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 274
* EL050.cbl
 15096     ELSE
 15097         IF WS-STATE-ABBREVIATION = 'CT'
 15098             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15099                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 15100                 COMPUTE PB-I-LF-PREM-CALC =
 15101                                     PB-I-LF-PREM-CALC * .90
 15102                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15103                                     PB-I-LF-ALT-PREM-CALC * .90
 15104                 COMPUTE PB-I-AH-PREM-CALC =
 15105                                     PB-I-AH-PREM-CALC * .90.
 15106
 15107     IF PB-COMP-LF-PREM
 15108        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15109        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15110
 15111     IF PB-COMP-AH-PREM
 15112        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15113
 15114 3340-CHECK-DCC-TOT-FEES.
 15115     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15116        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15117        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15118        AND (PB-I-POLICY-IS-MONTHLY)
 15119        CONTINUE
 15120     ELSE
 15121        GO TO 3340-EDIT-LF-AH-TOL
 15122     END-IF
 15123     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15124     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15125     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15126        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15127           PB-I-RATE-DEV-PCT-LF
 15128     END-IF
 15129     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15130        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15131           PB-I-RATE-DEV-PCT-AH
 15132     END-IF
 15133     MOVE 'N'                    TO CP-BEN-CATEGORY
 15134     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15135
 15136     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15137     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15138     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15139     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15140     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15141     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15142     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15143     MOVE '3'                    TO CP-PROCESS-TYPE.
 15144     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15145     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15146
 15147     MOVE PB-SV-STATE            TO CP-STATE.
 15148     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15149     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15150     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15151     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15152     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15153                                    CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 275
* EL050.cbl
 15154     IF CP-STATE-STD-ABBRV = 'OR'
 15155         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15156                                         PB-I-LF-ALT-BENEFIT-AMT.
 15157     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 15158     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15159     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15160     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15161     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15162     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15163     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15164     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15165     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15166                                    CP-REMAINING-TERM
 15167                                    CP-LOAN-TERM.
 15168     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15169        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15170           PB-I-LF-PREMIUM-AMT
 15171     end-if
 15172
 15173     IF CP-TRUNCATED-LIFE
 15174        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15175
 15176     IF CP-TERM-IS-DAYS
 15177         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15178     ELSE
 15179         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15180
 15181     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15182     IF CP-SPECIAL-CALC-CD = 'H'
 15183         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15184                                    TO CP-ALTERNATE-BENEFIT
 15185         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15186     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15187     MOVE 'R'                    TO CP-RATE-FILE
 15188     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15189     IF NOT CP-ERROR-RATE-NOT-FOUND
 15190        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15191        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15192           AND (CP-BENEFIT-CD (1:1) = 'S')
 15193           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15194                                    PB-I-LF-PREMIUM-AMT
 15195        END-IF
 15196     ELSE
 15197        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15198     END-IF
 15199     .
 15200 3340-EDIT-LF-AH-TOL.
 15201
 15202***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15203***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15204***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15205***
 15206     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15207         PB-I-AH-PREMIUM-AMT
 15208          GIVING WS-CALC-WORK.
 15209
 15210     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15211        AND WS-CALC-WORK NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 276
* EL050.cbl
 15212         MOVE ER-2649            TO WS-ERROR
 15213         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15214
 15215     SUBTRACT PB-I-LF-PREM-CALC
 15216             FROM PB-I-LF-PREMIUM-AMT
 15217                 GIVING WS-UNSIGN-WRK1.
 15218
 15219     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15220             FROM PB-I-LF-ALT-PREMIUM-AMT
 15221                 GIVING WS-UNSIGN-WRK4.
 15222
 15223     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15224                                + WS-UNSIGN-WRK4.
 15225
 15226     SUBTRACT PB-I-AH-PREM-CALC
 15227             FROM PB-I-AH-PREMIUM-AMT
 15228                 GIVING WS-UNSIGN-WRK2.
 15229
 15230******************************************************************
 15231*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15232******************************************************************
 15233
 15234     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15235         MOVE ZERO TO WS-UNSIGN-WRK1.
 15236
 15237     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15238         MOVE ZERO TO WS-UNSIGN-WRK2.
 15239
 15240     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15241             GIVING WS-UNSIGN-WRK3.
 15242
 15243 3342-CONTINUE.
 15244
 15245     IF (PB-I-LF-RATE = ZERO  AND
 15246         PB-I-AH-RATE = ZERO)
 15247         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15248            WS-AH-SPECIAL-CALC-CD = 'O'
 15249              NEXT SENTENCE
 15250         ELSE
 15251             GO TO 3345-EDIT-CONTINUE.
 15252
 15253     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15254         NEXT SENTENCE
 15255     ELSE
 15256     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15257        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15258           IF (PB-REISSUED-CERT         OR
 15259               PB-POLICY-IS-DECLINED    OR
 15260               PB-POLICY-IS-VOIDED)
 15261              NEXT SENTENCE
 15262           ELSE
 15263              IF WS-PREM-REJECT-SW = SPACE
 15264                 MOVE ER-2652    TO WS-ERROR
 15265                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15266                 GO TO 3344-CHECK-AH
 15267              ELSE
 15268                 MOVE ER-2650    TO WS-ERROR
 15269                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 277
* EL050.cbl
 15270                 GO TO 3344-CHECK-AH.
 15271
 15272***
 15273***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 15274***
 15275
 15276     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15277         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15278            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15279             (1 + WS-TOL-LF-PREM-PCT)
 15280         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15281            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15282             (1 - WS-TOL-LF-PREM-PCT)
 15283     ELSE
 15284         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15285         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15286
 15287***
 15288***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15289***
 15290
 15291     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15292         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15293          WS-TOL-LF-PREM.
 15294
 15295     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15296         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15297          WS-TOL-LF-PREM.
 15298
 15299     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15300        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15301
 15302     IF PB-REISSUED-CERT
 15303        or PB-POLICY-IS-DECLINED
 15304        or PB-POLICY-IS-VOIDED
 15305        continue
 15306     ELSE
 15307        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15308              > WS-TOL-LF-HIGH-PREM-AMT)
 15309           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15310              < WS-TOL-LF-LOW-PREM-AMT))
 15311                      or
 15312           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15313              > WS-TOL-LF-HIGH-PREM-PCT)
 15314           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15315              < WS-TOL-LF-LOW-PREM-PCT))
 15316           IF WS-PREM-REJECT-SW = SPACE
 15317              MOVE ER-2652       TO WS-ERROR
 15318              PERFORM 9900-ERROR-FORMAT
 15319                                 THRU 9900-EXIT
 15320           ELSE
 15321              MOVE ER-2650       TO WS-ERROR
 15322              PERFORM 9900-ERROR-FORMAT
 15323                                 THRU 9900-EXIT
 15324           end-if
 15325        end-if
 15326     end-if
 15327
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 278
* EL050.cbl
 15328*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15329*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15330*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15331*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15332
 15333     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15334        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15335                      OR
 15336           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15337           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15338           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15339           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15340        END-IF
 15341     END-IF
 15342
 15343     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15344        IF WS-COMP-MAX-CAP GREATER THAN +0
 15345           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15346              IF (PB-REISSUED-CERT         OR
 15347                  PB-POLICY-IS-DECLINED    OR
 15348                  PB-POLICY-IS-VOIDED)
 15349                 NEXT SENTENCE
 15350              ELSE
 15351                  MOVE ER-2646   TO  WS-ERROR
 15352                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15353
 15354 3344-CVL-TOLERANCE-CHECK.
 15355
 15356      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15357          GO TO 3344-CHECK-AH.
 15358
 15359      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15360          GO TO 3344-CHECK-AH.
 15361
 15362      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15363                                     WS-UNSIGN-WRK6.
 15364
 15365      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15366          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15367                                 + PB-I-LF-PREMIUM-AMT
 15368                                 - PB-I-LF-PREM-CALC.
 15369
 15370      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15371          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15372                                 + PB-I-LF-ALT-PREMIUM-AMT
 15373                                 - PB-I-LF-ALT-PREM-CALC.
 15374
 15375      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15376          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15377              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15378                 MOVE ER-2652    TO  WS-ERROR
 15379                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15380              ELSE
 15381                 MOVE ER-2650    TO  WS-ERROR
 15382                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15383
 15384      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15385          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 279
* EL050.cbl
 15386              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15387                 MOVE ER-2652    TO  WS-ERROR
 15388                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15389              ELSE
 15390                 MOVE ER-2650    TO  WS-ERROR
 15391                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15392
 15393 3344-CHECK-AH.
 15394
 15395****************************************************************
 15396***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15397***
 15398
 15399     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15400         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15401             (1 + WS-TOL-AH-PREM-PCT)
 15402         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15403             (1 - WS-TOL-AH-PREM-PCT)
 15404     ELSE
 15405         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15406         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15407
 15408***
 15409***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15410***
 15411
 15412     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15413         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15414
 15415     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15416         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15417
 15418     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15419        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15420
 15421     IF (PB-REISSUED-CERT)
 15422        OR (PB-POLICY-IS-DECLINED)
 15423        OR (PB-POLICY-IS-VOIDED)
 15424        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15425        CONTINUE
 15426     ELSE
 15427        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15428              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15429                          or
 15430           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15431              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15432           IF WS-PREM-REJECT-SW = SPACE
 15433              MOVE ER-3052       TO WS-ERROR
 15434              PERFORM 9900-ERROR-FORMAT
 15435                                 THRU 9900-EXIT
 15436           ELSE
 15437              MOVE ER-3050       TO WS-ERROR
 15438              PERFORM 9900-ERROR-FORMAT
 15439                                 THRU 9900-EXIT
 15440           END-IF
 15441        END-IF
 15442     END-IF
 15443     if (pb-company-id = 'DCC' or 'VPP')
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 280
* EL050.cbl
 15444        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15445        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15446        and (pb-i-policy-is-monthly)
 15447        compute ws-tol-ah-high-prem-amt =
 15448           pb-i-tot-fees-calc + ws-tol-ah-prem
 15449        compute ws-tol-ah-low-prem-amt =
 15450           pb-i-tot-fees-calc - ws-tol-ah-prem
 15451        if ws-tol-ah-prem-pct > zeros
 15452           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15453              (1 + ws-tol-ah-prem-pct)
 15454           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15455              (1 - ws-tol-ah-prem-pct)
 15456        else
 15457           move +9999999.99      to ws-tol-ah-high-prem-pct
 15458           move +0               to ws-tol-ah-low-prem-pct
 15459        end-if
 15460        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15461            or
 15462           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15463                          or
 15464           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15465           or
 15466           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15467            move er-3049         to ws-error
 15468           perform 9900-error-format
 15469                                 thru 9900-exit
 15470
 15471        end-if
 15472     end-if
 15473     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15474         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15475             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15476             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15477
 15478     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15479        IF WS-COMP-MAX-CAP GREATER THAN +0
 15480           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15481              IF (PB-REISSUED-CERT         OR
 15482                  PB-POLICY-IS-DECLINED    OR
 15483                  PB-POLICY-IS-VOIDED)
 15484                 NEXT SENTENCE
 15485              ELSE
 15486                  MOVE ER-2646   TO  WS-ERROR
 15487                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15488
 15489     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15490        (WS-COMP-MAX-CAP EQUAL +0)
 15491           GO TO 3345-EDIT-CONTINUE.
 15492
 15493     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15494        GREATER THAN WS-COMP-MAX-CAP
 15495           MOVE ER-2646          TO  WS-ERROR
 15496           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15497
 15498 3345-EDIT-CONTINUE.
 15499
 15500*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15501*       IF PB-ENTRY-BATCH   NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 281
* EL050.cbl
 15502*          IF PB-ISSUE
 15503*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15504*          ELSE
 15505*              IF PB-CANCELLATION
 15506*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15507
 15508*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15509*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15510*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15511*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15512*        ELSE
 15513*            MOVE  ER-1909            TO  WS-ERROR
 15514*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15515
 15516     IF PB-I-POLICY-ACCEPTED
 15517        IF PB-POLICY-IS-DECLINED  OR
 15518           PB-REISSUED-CERT  OR
 15519           PB-REIN-ONLY-CERT  OR
 15520           PB-POLICY-IS-VOIDED
 15521            MOVE  ER-1891         TO  WS-ERROR
 15522            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15523        ELSE
 15524            MOVE SPACE            TO  PB-BATCH-ENTRY
 15525            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15526
 15527     IF PB-I-POLICY-DECLINED
 15528        IF PB-REISSUED-CERT  OR
 15529           PB-REIN-ONLY-CERT  OR
 15530           PB-POLICY-IS-VOIDED
 15531            MOVE  ER-1906         TO  WS-ERROR
 15532            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15533        ELSE
 15534            MOVE  'D'             TO  PB-BATCH-ENTRY
 15535                                      PB-I-ENTRY-STATUS.
 15536
 15537     IF PB-I-NEEDS-UNDERWRITING
 15538        IF PB-POLICY-IS-DECLINED OR
 15539           PB-REISSUED-CERT  OR
 15540           PB-REIN-ONLY-CERT  OR
 15541           PB-POLICY-IS-VOIDED
 15542            MOVE  ER-1907         TO  WS-ERROR
 15543            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15544        ELSE
 15545            MOVE 'U'              TO  PB-BATCH-ENTRY
 15546                                      PB-I-ENTRY-STATUS.
 15547
 15548     IF PB-NEEDS-UNDERWRITING
 15549        MOVE  ER-1901             TO  WS-ERROR
 15550        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15551     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15552        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15553        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15554        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15555           AND (NOT WS-LF-CASH))
 15556                           OR
 15557           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15558           AND (NOT WS-AH-CASH)))
 15559                       AND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 282
* EL050.cbl
 15560           (PB-I-ENTRY-STATUS NOT = '5')
 15561           MOVE 'M'              TO PB-BATCH-ENTRY
 15562                                    PB-I-ENTRY-STATUS
 15563        END-IF
 15564     END-IF
 15565     move pending-business       to ws-passed-erpndb
 15566     move ' '                    to ws-exceed-limit-yn
 15567     perform 7780-call-agg       thru 7780-exit
 15568*    display ' el050 exceed ' ws-exceed-limit-yn
 15569     if ws-exceed-limit-yn = 'Y'
 15570        MOVE  ER-9813            TO WS-ERROR
 15571        move 'Y'                 to ws-9813-sw
 15572        PERFORM  9900-ERROR-FORMAT
 15573                                 THRU 9900-EXIT
 15574     end-if
 15575     if (PB-EXCEEDED-LIMIT-FORCED)
 15576        and (ws-9813-sw = 'Y')
 15577        subtract +1 from PB-NO-OF-ERRORS
 15578        move er-9823             to ws-error
 15579        PERFORM  9900-ERROR-FORMAT
 15580                                 THRU 9900-EXIT
 15581     end-if
 15582     IF  PB-COMPANY-ID NOT = 'NCL'
 15583         GO TO 3999-END-EDIT.
 15584
 15585     IF PB-REISSUED-CERT  OR
 15586        PB-POLICY-IS-DECLINED  OR
 15587        PB-POLICY-IS-VOIDED  OR
 15588        PB-I-OB
 15589         GO TO 3999-END-EDIT.
 15590
 15591     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15592         MOVE  ER-2644            TO  WS-ERROR
 15593         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15594         GO TO 3999-END-EDIT.
 15595
 15596     MOVE 'N'                     TO  FORM-MASTER-SW.
 15597     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15598
 15599     IF NOT FORM-MASTER-FOUND
 15600         GO TO 3999-END-EDIT.
 15601
 15602     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15603                                      FORM-MASTER-AH-SW.
 15604
 15605     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15606         MOVE  +1                 TO SUB6
 15607         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15608
 15609     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15610         MOVE  +1                 TO SUB6
 15611         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15612
 15613     IF LF-FORM-MASTER-FOUND  OR
 15614        AH-FORM-MASTER-FOUND
 15615         GO TO 3360-CHECK-FORM-LIMITS
 15616     ELSE
 15617         GO TO 3999-END-EDIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 283
* EL050.cbl
 15618
 15619******************************************************************
 15620*                  3350-GET-ERFORM                               *
 15621*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15622*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15623******************************************************************
 15624
 15625 3350-GET-ERFORM.
 15626
 15627     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15628         GO TO  3350-ERFORM-GETMAIN.
 15629
 15630     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15631     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15632     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15633     MOVE 'Y'                     TO FORM-MASTER-SW.
 15634
 15635     IF PB-CANCELLATION
 15636         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15637            PB-SV-STATE          EQUAL   FO-STATE       AND
 15638            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15639              GO TO 3350-EXIT
 15640         ELSE
 15641             NEXT SENTENCE
 15642     ELSE
 15643         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15644            PB-SV-STATE          EQUAL   FO-STATE       AND
 15645            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15646              GO TO 3350-EXIT.
 15647
 15648 3350-ERFORM-GETMAIN.
 15649
 15650     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15651     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15652
 15653 3350-ERFORM-READ.
 15654
 15655     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15656     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15657     IF PB-CANCELLATION
 15658         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15659     ELSE
 15660         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15661     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15662
 15663     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15664
 15665     IF FORM-MASTER-FOUND
 15666       IF PB-CANCELLATION
 15667          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15668             PB-SV-STATE          EQUAL   FO-STATE       AND
 15669             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15670              GO  TO 3350-EXIT
 15671          ELSE
 15672              NEXT SENTENCE
 15673       ELSE
 15674          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15675             PB-SV-STATE          EQUAL   FO-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 284
* EL050.cbl
 15676             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15677              GO  TO 3350-EXIT.
 15678
 15679     MOVE  'N'                    TO  FORM-MASTER-SW.
 15680     MOVE  ER-1895                TO  WS-ERROR.
 15681     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15682
 15683 3350-EXIT.
 15684      EXIT.
 15685
 15686******************************************************************
 15687*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15688*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15689*   VALID FOR THE POLICY FORM USED.                              *
 15690******************************************************************
 15691
 15692 3355-EDIT-FORM-LF-BENEFITS.
 15693
 15694     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15695        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15696         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15697         GO TO   3355-EXIT.
 15698
 15699     IF  SUB6    LESS THAN   +40
 15700         ADD  +1      TO  SUB6
 15701         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15702
 15703     MOVE  ER-1896         TO  WS-ERROR.
 15704     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15705
 15706 3355-EXIT.
 15707      EXIT.
 15708
 15709******************************************************************
 15710*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15711*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15712*   VALID FOR THE POLICY FORM USED.                              *
 15713******************************************************************
 15714
 15715 3356-EDIT-FORM-AH-BENEFITS.
 15716
 15717     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15718        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15719         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15720         GO TO  3356-EXIT.
 15721
 15722      IF  SUB6    LESS THAN     +40
 15723          ADD  +1      TO  SUB6
 15724          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15725
 15726     MOVE  ER-1897         TO  WS-ERROR.
 15727     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15728
 15729 3356-EXIT.
 15730      EXIT.
 15731
 15732******************************************************************
 15733*                  3357-BENEFIT-SEARCH                           *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 285
* EL050.cbl
 15734*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15735*   CANCELLATIONS ONLY.                                          *
 15736******************************************************************
 15737 3357-BENEFIT-SEARCH.
 15738     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15739         MOVE +1                          TO SUB6
 15740         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15741
 15742     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15743         MOVE +1                          TO SUB6
 15744         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15745
 15746 3357-EXIT.
 15747     EXIT.
 15748
 15749******************************************************************
 15750*                  3358-BENEFIT-LIFE-SEARCH                      *
 15751*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15752*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15753*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15754******************************************************************
 15755 3358-BENEFIT-LIFE-SEARCH.
 15756     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15757       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15758         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15759           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15760              IF FO-PLAN-REFUND-METHOD (SUB6)
 15761                     IS GREATER THAN SPACES
 15762                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15763                                          WS-LF-REFUND-CALC
 15764                 GO TO 3358-EXIT.
 15765
 15766     IF SUB6 LESS THAN +40
 15767         ADD +1                 TO SUB6
 15768         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15769
 15770 3358-EXIT.
 15771     EXIT.
 15772******************************************************************
 15773*                  3359-BENEFIT-AH-SEARCH                        *
 15774*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15775*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15776*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15777******************************************************************
 15778 3359-BENEFIT-AH-SEARCH.
 15779     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15780       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15781         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15782           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15783              IF FO-PLAN-REFUND-METHOD (SUB6)
 15784                      IS GREATER THAN SPACES
 15785                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15786                                          WS-AH-REFUND-CALC
 15787                 GO TO 3359-EXIT.
 15788
 15789     IF SUB6 LESS THAN +40
 15790         ADD +1                 TO SUB6
 15791         GO TO 3359-BENEFIT-AH-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 286
* EL050.cbl
 15792
 15793 3359-EXIT.
 15794     EXIT.
 15795
 15796******************************************************************
 15797*                  3360-CHECK-FORM-LIMITS                        *
 15798*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15799*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15800******************************************************************
 15801
 15802 3360-CHECK-FORM-LIMITS.
 15803
 15804     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15805         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15806
 15807     IF NOT LF-FORM-MASTER-FOUND
 15808         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15809
 15810 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15811
 15812     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15813       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15814        WS-LF-JOINT-INDICATOR = 'J'  AND
 15815        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15816         IF PB-COMPANY-ID = 'NCL'
 15817            MOVE  ER-1911          TO  WS-ERROR
 15818            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15819         ELSE
 15820            MOVE  ER-1892          TO  WS-ERROR
 15821            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15822
 15823 3360-CHECK-FORM-LF-ATT-AGE.
 15824
 15825     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15826
 15827     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15828         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15829         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15830            IF PB-COMPANY-ID = 'NCL'
 15831                MOVE  ER-1913      TO  WS-ERROR
 15832                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15833            ELSE
 15834                MOVE  ER-1894      TO  WS-ERROR
 15835                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15836
 15837 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15838
 15839     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15840         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15841         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15842            IF PB-COMPANY-ID = 'NCL'
 15843                MOVE  ER-1914      TO  WS-ERROR
 15844                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15845            ELSE
 15846                MOVE  ER-1899      TO  WS-ERROR
 15847                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15848
 15849 3360-CHECK-FORM-LF-TERM-BAMT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 287
* EL050.cbl
 15850
 15851     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15852         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15853         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15854           IF  PB-COMPANY-ID = 'NCL'
 15855               MOVE  ER-1916       TO  WS-ERROR
 15856               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15857           ELSE
 15858               MOVE  ER-1902       TO  WS-ERROR
 15859               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15860
 15861     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15862                                    PB-I-LF-ALT-BENEFIT-AMT.
 15863
 15864     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15865         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15866         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15867             IF  PB-COMPANY-ID = 'NCL'
 15868                 MOVE  ER-1918     TO  WS-ERROR
 15869                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15870             ELSE
 15871                 MOVE  ER-1904     TO  WS-ERROR
 15872                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15873
 15874******************************************************************
 15875*                  3360-CHECK-FORM-AH-LIMITS                     *
 15876*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15877*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15878******************************************************************
 15879
 15880 3360-CHECK-FORM-AH-LIMITS.
 15881
 15882     IF NOT AH-FORM-MASTER-FOUND
 15883         GO TO 3999-END-EDIT.
 15884
 15885 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15886
 15887     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15888       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15889        WS-AH-JOINT-INDICATOR = 'J'  AND
 15890        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15891         IF PB-COMPANY-ID = 'NCL'
 15892            MOVE  ER-1912          TO  WS-ERROR
 15893            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15894         ELSE
 15895            MOVE  ER-1893          TO  WS-ERROR
 15896            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15897
 15898 3360-CHECK-FORM-AH-ATT-AGE.
 15899
 15900     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15901
 15902     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15903         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15904         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15905            IF PB-COMPANY-ID = 'NCL'
 15906                MOVE  ER-1913      TO  WS-ERROR
 15907                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 288
* EL050.cbl
 15908            ELSE
 15909                MOVE  ER-1894      TO  WS-ERROR
 15910                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15911
 15912 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15913
 15914     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15915         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15916         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15917            IF PB-COMPANY-ID = 'NCL'
 15918                MOVE  ER-1915      TO  WS-ERROR
 15919                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15920            ELSE
 15921                MOVE  ER-1900      TO  WS-ERROR
 15922                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15923
 15924 3360-CHECK-FORM-AH-TERM-BAMT.
 15925
 15926     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15927         FO-AH-MAX-TERM    GREATER THAN  +0
 15928         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15929             IF  PB-COMPANY-ID = 'NCL'
 15930                 MOVE  ER-1917     TO  WS-ERROR
 15931                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15932             ELSE
 15933                  MOVE  ER-1903    TO  WS-ERROR
 15934                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15935
 15936     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15937         FO-MAX-AH-AMT    GREATER THAN  +0
 15938         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15939             IF  PB-COMPANY-ID = 'NCL'
 15940                 MOVE  ER-1919     TO  WS-ERROR
 15941                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15942             ELSE
 15943                 MOVE  ER-1905     TO  WS-ERROR
 15944                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15945
 15946     GO TO 3999-END-EDIT.
 15947
 15948******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 289
* EL050.cbl
 15950 3400-edit-vin.
 15951
 15952     move spaces                 to hldi-pass-area
 15953     MOVE PB-I-VIN               TO WS-WORK-VIN
 15954     MOVE +8                     TO V2
 15955     MOVE ZEROS                  TO WS-VIN-TOTAL
 15956     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15957      (V1 > 17)
 15958        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15959           MOVE ER-3825          TO WS-ERROR
 15960           PERFORM 9900-ERROR-FORMAT
 15961                                 THRU 9900-EXIT
 15962        ELSE
 15963           IF V1 = 8
 15964              MOVE 10            TO V2
 15965           END-IF
 15966           IF V1 = 9
 15967              MOVE 0             TO V2
 15968           END-IF
 15969           IF V1 = 10
 15970              MOVE 9             TO V2
 15971           END-IF
 15972           IF WS-WORK-VIN (V1:1) NUMERIC
 15973              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15974               + (WS-WORK-VIN-N (V1) * V2)
 15975           ELSE
 15976              MOVE WS-WORK-VIN (V1:1)
 15977                            TO WS-HEX-BYTE
 15978              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15979              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15980               + (WS-NUM (V3) * V2)
 15981           END-IF
 15982           COMPUTE V2 = V2 - 1
 15983        END-IF
 15984     END-PERFORM
 15985     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15986     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15987        REMAINDER WS-VIN-REMAINDER
 15988     IF ((WS-WORK-VIN (9:1) = 'X')
 15989        AND (WS-VIN-REMAINDER = 10))
 15990                OR
 15991        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15992        if pb-company-id = 'VPP'
 15993           perform 3410-check-with-hldi
 15994                                 thru 3410-exit
 15995        end-if
 15996     ELSE
 15997        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15998           MOVE ER-3826          TO WS-ERROR
 15999           PERFORM 9900-ERROR-FORMAT
 16000                                 THRU 9900-EXIT
 16001        ELSE
 16002           MOVE ER-3827          TO WS-ERROR
 16003           PERFORM 9900-ERROR-FORMAT
 16004                                 THRU 9900-EXIT
 16005        END-IF
 16006     END-IF
 16007
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 290
* EL050.cbl
 16008     .
 16009 3400-exit.
 16010     exit.
 16011 3410-check-with-hldi.
 16012     move spaces                 to hldi-pass-area
 16013     move pb-i-vin               to pa-vin
 16014     perform 7785-call-hldi      thru 7785-exit
 16015*    display 'PA-VIN        ' PA-VIN
 16016*    display 'PA-ErrorCode  ' PA-ErrorCode
 16017*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 16018*    display 'PA-ModelYear  ' PA-ModelYear
 16019*    display 'PA-MakeName   ' PA-MakeName
 16020*    display 'PA-ModelName  ' PA-ModelName
 16021*    display 'PA-SeriesName ' PA-SeriesName
 16022     if pa-errorcode (1:1) not = '0'
 16023        move spaces              to hldi-pass-area
 16024        move pb-i-vin            to pa-vin
 16025*       move pa-errordesc        to pa-seriesname
 16026*       perform 7786-call-hldim  thru 7786-exit
 16027*       display 'PA-VIN        ' PA-VIN
 16028*       display 'PA-ErrorCode  ' PA-ErrorCode
 16029*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 16030*       display 'PA-ModelYear  ' PA-ModelYear
 16031*       display 'PA-MakeName   ' PA-MakeName
 16032*       display 'PA-ModelName  ' PA-ModelName
 16033*       display 'PA-SeriesName ' PA-SeriesName
 16034     end-if
 16035     .
 16036 3410-exit.
 16037     exit.
 16038******************************************************************
 16039*                  E D I T   C A N C E L                         *
 16040******************************************************************
 16041
 16042 3700-EDIT-CANCEL.
 16043     IF PB-COMPANY-ID = 'DMD'
 16044         MOVE ZEROS                   TO WS-RES-STATE-TAX
 16045                                         WS-RES-MUNI-TAX
 16046                                         PB-CI-STATE-TAX
 16047                                         PB-CI-MUNI-TAX
 16048         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 16049
 16050*    IF PB-COMPANY-ID  EQUAL  'NCL'
 16051*       IF PB-ENTRY-BATCH  NUMERIC
 16052*          IF PB-CANCELLATION
 16053*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16054*          ELSE
 16055*             IF PB-ISSUE
 16056*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16057
 16058     IF PB-C-INT-ON-REFS NOT NUMERIC
 16059        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16060     END-IF
 16061*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16062*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16063
 16064     IF CM-ENTRY-STATUS = 'V'
 16065        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 291
* EL050.cbl
 16066        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16067        GO TO 3999-END-EDIT.
 16068
 16069     IF CM-ENTRY-STATUS = 'D'
 16070        MOVE ER-2781             TO WS-ERROR
 16071        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16072        GO TO 3999-END-EDIT.
 16073
 16074     IF CM-ENTRY-STATUS = 'U'
 16075        MOVE ER-2782             TO WS-ERROR
 16076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16077
 16078***************************************************************
 16079*                                                             *
 16080*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16081*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16082*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16083*   OF ANOTHER COVERAGE.                                      *
 16084*                                                             *
 16085***************************************************************
 16086
 16087     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16088                                    PB-C-AH-CANCEL-VOID-SW.
 16089
 16090     if pb-company-id = 'DCC' or 'VPP'
 16091        if ((pb-ci-lf-cancel-amt <> zeros)
 16092                       or
 16093            (pb-ci-ah-cancel-amt <> zeros))
 16094           MOVE ER-3068          TO WS-ERROR
 16095           PERFORM 9900-ERROR-FORMAT
 16096                                 THRU 9900-EXIT
 16097           GO TO 3999-END-EDIT
 16098        end-if
 16099     end-if
 16100     IF PB-C-LF-CANCEL-AMT = ZERO
 16101        NEXT SENTENCE
 16102     ELSE
 16103        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16104           AND
 16105           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16106               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16107               MOVE ER-2745           TO WS-ERROR
 16108               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16109
 16110     IF PB-C-AH-CANCEL-AMT = ZERO
 16111        NEXT SENTENCE
 16112     ELSE
 16113        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16114           AND
 16115           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16116               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16117               MOVE ER-2745           TO WS-ERROR
 16118               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16119
 16120     IF WS-LF-EARNINGS-CALC = '4'
 16121        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16122
 16123     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 292
* EL050.cbl
 16124     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16125     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16126     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16127     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16128     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16129
 16130     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16131                                      PB-C-AH-REF-CALC.
 16132     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16133
 16134******************************************************************
 16135*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16136*             TO VALIDATE COVERAGE.                              *
 16137******************************************************************
 16138
 16139     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16140        PB-C-LF-CANCEL-AMT = ZEROS
 16141          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16142      ELSE
 16143          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16144
 16145     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16146        PB-C-AH-CANCEL-AMT = ZEROS
 16147          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16148      ELSE
 16149          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16150
 16151     EVALUATE TRUE
 16152         WHEN PB-CANCEL-FORCE             OR
 16153              PB-CANCEL-DATE-FORCED       OR
 16154              PB-FORCE-OFF
 16155                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16156                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16157                  END-IF
 16158         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16159               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16160              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16161                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16162         WHEN OTHER
 16163              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16164                 MOVE ER-2794              TO WS-ERROR
 16165              ELSE
 16166                 MOVE ER-2749              TO WS-ERROR
 16167              END-IF
 16168              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16169     END-EVALUATE.
 16170
 16171
 16172*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16173*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16174*            MOVE  ER-1909            TO  WS-ERROR
 16175*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16176*        ELSE
 16177*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16178
 16179     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16180     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16181        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 293
* EL050.cbl
 16182     ELSE
 16183        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16184     END-IF
 16185     .
 16186 3705-EDIT-CANCEL-DT.
 16187
 16188     IF LF-COVERAGE-CANCELLED
 16189        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16190         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16191         MOVE WS-CURRENT-MONTH-END
 16192                                 TO DC-BIN-DATE-2
 16193         SET ELAPSED-BETWEEN-BIN TO TRUE
 16194*        MOVE 1                  TO DC-OPTION-CODE
 16195         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16196         IF DATE-CONVERSION-ERROR
 16197            NEXT SENTENCE
 16198          ELSE
 16199             IF DC-ELAPSED-DAYS GREATER +180
 16200                IF PB-CANCEL-DATE-FORCED  OR
 16201                   PB-CANCEL-DATE-FORCED-NO-FEE
 16202                      MOVE ER-2751  TO WS-ERROR
 16203                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16204                 ELSE
 16205                   MOVE ER-2752  TO WS-ERROR
 16206                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16207
 16208     IF AH-COVERAGE-CANCELLED
 16209        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16210         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16211         MOVE WS-CURRENT-MONTH-END
 16212                                 TO DC-BIN-DATE-2
 16213         SET ELAPSED-BETWEEN-BIN TO TRUE
 16214*        MOVE 1                  TO DC-OPTION-CODE
 16215         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16216         IF DATE-CONVERSION-ERROR
 16217            NEXT SENTENCE
 16218          ELSE
 16219             IF DC-ELAPSED-DAYS GREATER +180
 16220                IF PB-CANCEL-DATE-FORCED OR
 16221                   PB-CANCEL-DATE-FORCED-NO-FEE
 16222                      MOVE ER-2751  TO WS-ERROR
 16223                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16224                 ELSE
 16225                   MOVE ER-2752  TO WS-ERROR
 16226                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16227
 16228     IF WS-ERROR = ER-2752
 16229        AND (PB-COMPANY-ID = 'ABL'
 16230         OR  PB-COMPANY-ID = 'FGL'
 16231         OR  PB-COMPANY-ID = 'IST'
 16232         OR  PB-COMPANY-ID = 'JHL'
 16233         OR  PB-COMPANY-ID = 'LAP'
 16234         OR  PB-COMPANY-ID = 'LBL'
 16235         OR  PB-COMPANY-ID = 'NCB'
 16236         OR  PB-COMPANY-ID = 'NLI'
 16237         OR  PB-COMPANY-ID = 'OFI'
 16238         OR  PB-COMPANY-ID = 'PLI'
 16239         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 294
* EL050.cbl
 16240         OR  PB-COMPANY-ID = 'TIC'
 16241         OR  PB-COMPANY-ID = 'HER'
 16242         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16243         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16244            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16245            MOVE ER-2762     TO WS-ERROR
 16246            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16247
 16248     IF LF-COVERAGE-CANCELLED
 16249        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16250        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16251             MOVE ER-2733         TO WS-ERROR
 16252             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16253
 16254     IF AH-COVERAGE-CANCELLED
 16255        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16256        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16257              MOVE ER-2733        TO WS-ERROR
 16258              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16259
 16260     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16261        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16262        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16263           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16264            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16265              IF PB-COMPANY-ID NOT = 'LAP'
 16266               MOVE ER-2704            TO WS-ERROR
 16267               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16268
 16269     IF CERT-WAS-NOT-FOUND
 16270         GO TO 3999-END-EDIT.
 16271
 16272     IF PB-COMPANY-ID EQUAL 'CDC'
 16273        IF LF-COVERAGE-CANCELLED
 16274           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16275            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16276            MOVE PB-C-LF-CANCEL-DT
 16277                                 TO DC-BIN-DATE-2
 16278            SET ELAPSED-BETWEEN-BIN TO TRUE
 16279*           MOVE 1               TO DC-OPTION-CODE
 16280            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16281            IF DATE-CONVERSION-ERROR
 16282               NEXT SENTENCE
 16283             ELSE
 16284                IF DC-ELAPSED-DAYS GREATER +60
 16285                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16286
 16287     IF PB-COMPANY-ID EQUAL 'CDC'
 16288        IF AH-COVERAGE-CANCELLED
 16289           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16290            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16291            MOVE PB-C-AH-CANCEL-DT
 16292                                 TO DC-BIN-DATE-2
 16293            MOVE +0              TO DC-ELAPSED-DAYS
 16294                                    DC-ELAPSED-MONTHS
 16295            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16296*           MOVE 1               TO DC-OPTION-CODE
 16297            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 295
* EL050.cbl
 16298            IF DATE-CONVERSION-ERROR
 16299               NEXT SENTENCE
 16300             ELSE
 16301                IF DC-ELAPSED-DAYS GREATER +60
 16302                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16303
 16304     MOVE +0                     TO DC-ELAPSED-DAYS
 16305                                    DC-ELAPSED-MONTHS.
 16306
 16307     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16308        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16309          MOVE 'Z'                TO PB-CI-OB-FLAG
 16310          MOVE ER-2767            TO WS-ERROR
 16311          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16312          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16313          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16314          GO TO 3775-OVER-REF-CHK
 16315        ELSE
 16316          MOVE ZEROS              TO PB-CI-LIVES
 16317                                     PB-C-LIVES
 16318          IF PB-CI-OB-FLAG NOT = 'B'
 16319             MOVE SPACE           TO PB-CI-OB-FLAG.
 16320
 16321     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16322         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16323     ELSE
 16324         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16325
 16326     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16327        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16328            MOVE ER-2760         TO WS-ERROR
 16329            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16330
 16331     IF LF-COVERAGE-CANCELLED
 16332        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16333         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16334            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16335               MOVE ER-2774       TO WS-ERROR
 16336               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16337
 16338     IF AH-COVERAGE-CANCELLED
 16339        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16340         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16341            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16342               MOVE ER-2775       TO WS-ERROR
 16343               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16344
 16345     IF LF-COVERAGE-CANCELLED
 16346        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16347         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16348            MOVE ER-2776         TO WS-ERROR
 16349            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16350
 16351     IF AH-COVERAGE-CANCELLED
 16352        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16353         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16354            MOVE ER-2777         TO WS-ERROR
 16355            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 296
* EL050.cbl
 16356
 16357     IF LF-COVERAGE-CANCELLED
 16358        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16359        if pb-ci-lf-expire-dt = low-values or spaces
 16360           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16361           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16362           MOVE PB-CI-EXTENTION-DAYS
 16363                                 TO DC-ELAPSED-DAYS
 16364           SET BIN-PLUS-ELAPSED  TO TRUE
 16365           PERFORM 8500-DATE-CONVERT
 16366                                 THRU 8500-EXIT
 16367           IF DATE-CONVERSION-ERROR
 16368              move low-values    to dc-bin-date-2
 16369           end-if
 16370        else
 16371           move pb-ci-lf-expire-dt
 16372                                 to dc-bin-date-2
 16373        end-if
 16374        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16375           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16376                             OR  'FIA'
 16377              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16378           ELSE
 16379              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16380              MOVE ER-2731       TO WS-ERROR
 16381              PERFORM 9900-ERROR-FORMAT
 16382                                 THRU 9900-EXIT
 16383           end-if
 16384        end-if
 16385     end-if
 16386*    IF LF-COVERAGE-CANCELLED
 16387*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16388*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16389*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16390*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16391*        SET BIN-PLUS-ELAPSED      TO TRUE
 16392*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16393*        IF DATE-CONVERSION-ERROR
 16394*           NEXT SENTENCE
 16395*         ELSE
 16396*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16397*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16398*                            OR  'FIA'
 16399*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16400*              ELSE
 16401*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16402*               MOVE ER-2731       TO WS-ERROR
 16403*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16404     .
 16405 3705-EDIT-AH-CANCEL-DT.
 16406     IF AH-COVERAGE-CANCELLED
 16407        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16408        if pb-ci-AH-expire-dt = low-values or spaces
 16409           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16410           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16411           MOVE PB-CI-EXTENTION-DAYS
 16412                                 TO DC-ELAPSED-DAYS
 16413           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 297
* EL050.cbl
 16414           PERFORM 8500-DATE-CONVERT
 16415                                 THRU 8500-EXIT
 16416           IF DATE-CONVERSION-ERROR
 16417              move low-values    to dc-bin-date-2
 16418           end-if
 16419        else
 16420           move pb-ci-ah-expire-dt
 16421                                 to dc-bin-date-2
 16422        end-if
 16423        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16424           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16425                             OR  'FIA'
 16426              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16427           ELSE
 16428              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16429              MOVE ER-2771       TO WS-ERROR
 16430              PERFORM 9900-ERROR-FORMAT
 16431                                 THRU 9900-EXIT
 16432           end-if
 16433        end-if
 16434     end-if
 16435*    IF AH-COVERAGE-CANCELLED
 16436*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16437*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16438*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16439*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16440**       MOVE 6                    TO DC-OPTION-CODE
 16441*        SET BIN-PLUS-ELAPSED      TO TRUE
 16442*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16443*        IF DATE-CONVERSION-ERROR
 16444*           NEXT SENTENCE
 16445*         ELSE
 16446*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16447*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16448*                             OR 'FIA'
 16449*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16450*             ELSE
 16451*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16452*              MOVE ER-2771       TO WS-ERROR
 16453*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16454     .
 16455 3705-EDIT-CONTINUED.
 16456
 16457*    IF LF-COVERAGE-CANCELLED
 16458*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16459*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16460*            MOVE ER-2727         TO WS-ERROR
 16461*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16462*
 16463*    IF AH-COVERAGE-CANCELLED
 16464*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16465*        IF PB-COMPANY-ID = 'ACE'
 16466*           MOVE ER-2727        TO WS-ERROR
 16467*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16468*        ELSE
 16469*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16470*              MOVE ER-2727     TO WS-ERROR
 16471*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 298
* EL050.cbl
 16472
 16473     IF PB-COMPANY-ID = 'ACE'
 16474       IF AH-COVERAGE-CANCELLED
 16475         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16476           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16477              MOVE ER-2732      TO WS-ERROR
 16478              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16479
 16480     IF PB-COMPANY-ID      EQUAL   'HER'
 16481        IF WS-ERROR        EQUAL   ER-2727
 16482            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16483            MOVE  ER-2725          TO  WS-ERROR
 16484            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16485
 16486     IF PB-C-CLAIM-CREATED-CANCEL
 16487            MOVE ER-2748         TO WS-ERROR
 16488            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16489
 16490     IF PB-C-LAST-NAME NOT = SPACES
 16491         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16492            MOVE ER-2747         TO WS-ERROR
 16493            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16494
 16495 3710-EDIT-LUMP-SUM-PRIOR.
 16496
 16497     IF AH-COVERAGE-CANCELLED
 16498         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16499             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16500                MOVE ER-2735    TO WS-ERROR
 16501                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16502
 16503     IF LF-COVERAGE-CANCELLED
 16504         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16505             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16506                MOVE ER-2735    TO WS-ERROR
 16507                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16508
 16509 3710-EDIT-PRIOR-DEATH.
 16510
 16511*    IF LF-COVERAGE-CANCELLED
 16512*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16513*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16514*           (NOT PB-CI-OB)
 16515*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16516*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16517*                   MOVE ER-2732  TO WS-ERROR
 16518*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16519*
 16520*    IF AH-COVERAGE-CANCELLED
 16521*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16522*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16523*           (NOT PB-CI-OB)
 16524*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16525*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16526*                   MOVE ER-2732  TO WS-ERROR
 16527*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16528
 16529     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 299
* EL050.cbl
 16530         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16531            (NOT PB-COMP-LF-CANCEL)
 16532             NEXT SENTENCE
 16533         ELSE
 16534           IF PB-C-LF-CANCEL-VOIDED
 16535              NEXT SENTENCE
 16536           ELSE
 16537              MOVE ER-2753      TO WS-ERROR
 16538              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16539
 16540     IF CANCEL-FUTURE-DT
 16541         GO TO 3999-END-EDIT.
 16542
 16543 3715-GET-REMAIN-TERM-LF.
 16544
 16545     IF NO-LF-BENEFIT-MATCH  OR
 16546        WS-LF-BENEFIT-CD = ZEROS
 16547        GO TO 3730-GET-AH-REMAIN-TERM.
 16548
 16549     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16550     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16551     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16552     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16553     MOVE PB-SV-STATE            TO CP-STATE.
 16554     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16555     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16556     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16557     MOVE '2'                    TO CP-PROCESS-TYPE.
 16558     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16559     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16560     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16561     IF (PB-COMPANY-ID = 'CID')
 16562        AND (CP-STATE-STD-ABBRV = 'WI')
 16563        MOVE '7'                 TO CP-REM-TERM-METHOD
 16564        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16565     ELSE
 16566        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16567        MOVE WS-REM-TRM-CALC-OPTION
 16568                                 TO CP-REM-TRM-CALC-OPTION
 16569     END-IF
 16570**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16571     IF (PB-COMPANY-ID = 'CID')
 16572        AND (CP-STATE-STD-ABBRV = 'MO')
 16573        AND (PB-CERT-EFF-DT >= X'9B41')
 16574        AND (PB-CERT-EFF-DT <= X'A2FB')
 16575        MOVE '7'                 TO CP-REM-TERM-METHOD
 16576        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16577     END-IF
 16578     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16579                                    CP-LOAN-TERM.
 16580     IF CP-TRUNCATED-LIFE
 16581        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16582
 16583     IF CP-TERM-IS-DAYS
 16584         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16585     ELSE
 16586         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16587
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 300
* EL050.cbl
 16588     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16589
 16590     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16591
 16592     IF LF-COVERAGE-CANCELLED
 16593        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16594        NEXT SENTENCE
 16595      ELSE
 16596          GO TO 3730-GET-AH-REMAIN-TERM.
 16597
 16598 3720-GET-LF-REFUND.
 16599
 16600     IF PB-C-LF-CANCEL-VOIDED
 16601        GO TO 3730-GET-AH-REMAIN-TERM
 16602     end-if
 16603
 16604     IF PB-COMPANY-ID EQUAL 'BOA'
 16605         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16606         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16607         GO TO 3730-GET-AH-REMAIN-TERM.
 16608
 16609     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16610        (WS-AH-SPECIAL-CALC-CD = 'M')
 16611         MOVE ER-2767            TO WS-ERROR
 16612         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16613         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16614         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16615         GO TO 3780-UPDATE-CANCEL-CERT.
 16616
 16617*    if (ws-lf-earnings-calc = '6')
 16618*       or (pb-c-lf-refund-override = '6')
 16619*       move cp-remaining-term-1 to cp-remaining-term-2
 16620*    end-if
 16621     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16622
 16623     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16624     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16625     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16626     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16627     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16628     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16629     IF PB-COMPANY-ID = 'DCC'
 16630        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16631        IF PDEF-MASTER-FOUND
 16632           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16633              (V1 > +8)
 16634              OR (PD-PROD-CODE (V1) = 'L')
 16635           END-PERFORM
 16636           IF V1 < +9
 16637              MOVE PD-MAX-AMT (V1)
 16638                           TO CP-R-MAX-TOT-BEN
 16639                              EC-AM-LF-MAX-TOT-BEN
 16640           END-IF
 16641        ELSE
 16642        MOVE ' '                 TO PDEF-MASTER-SW
 16643        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16644        MOVE PB-STATE            TO ERPDEF-STATE
 16645        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 301
* EL050.cbl
 16646           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16647        END-IF
 16648        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16649        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16650        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16651        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16652        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16653        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16654        IF PDEF-MASTER-FOUND
 16655           MOVE 'N'              TO PDEF-MASTER-SW
 16656           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16657           IF PDEF-MASTER-FOUND
 16658              IF (ERPDEF-KEY-SAVE (1:16) =
 16659                           PD-CONTROL-PRIMARY (1:16))
 16660                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16661                 CONTINUE
 16662              ELSE
 16663                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16664                 IF (ERPDEF-KEY-SAVE (1:16) =
 16665                           PD-CONTROL-PRIMARY (1:16))
 16666                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16667                    CONTINUE
 16668                 ELSE
 16669                    MOVE 'N'     TO PDEF-MASTER-SW
 16670                 END-IF
 16671              END-IF
 16672
 16673              IF PDEF-MASTER-FOUND
 16674                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16675                    (V1 > +8)
 16676                    OR (PD-PROD-CODE (V1) = 'L')
 16677                 END-PERFORM
 16678                 IF V1 < +9
 16679                    MOVE PD-MAX-AMT (V1)
 16680                                 TO CP-R-MAX-TOT-BEN
 16681                                    EC-AM-LF-MAX-TOT-BEN
 16682                 END-IF
 16683              END-IF
 16684           END-IF
 16685           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16686        END-IF
 16687        END-IF
 16688     END-IF
 16689     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16690
 16691     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16692
 16693     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16694                                    PB-C-LF-REM-TERM.
 16695
 16696     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16697     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16698
 16699     IF PB-COMPANY-ID EQUAL 'FLC'
 16700        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16701           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16702           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16703                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 302
* EL050.cbl
 16704                    - CM-LF-ITD-DEATH-AMT
 16705           IF PB-C-LF-REF-CALC LESS THAN +0
 16706              MOVE +0            TO PB-C-LF-REF-CALC
 16707              GO TO 3730-GET-AH-REMAIN-TERM
 16708           ELSE
 16709              GO TO 3730-GET-AH-REMAIN-TERM.
 16710
 16711     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16712                            OR '4' OR '5' OR '6' OR '8'
 16713                            OR '9' OR 'G'
 16714        MOVE PB-C-LF-REFUND-OVERRIDE
 16715                                 TO CP-EARNING-METHOD.
 16716
 16717     if pb-company-id = 'AHL'
 16718        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16719        if cp-class-code = spaces
 16720           move zeros            to cp-class-code
 16721        end-if
 16722     ELSE
 16723        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16724     END-IF
 16725*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16726     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16727     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16728                                    CP-RATING-BENEFIT-AMT.
 16729     IF CP-STATE-STD-ABBRV = 'OR'
 16730         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16731                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16732     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16733     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16734     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16735     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16736     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16737     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16738     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16739     IF WS-DEFAULT-APR NOT NUMERIC
 16740         MOVE ZEROS TO WS-DEFAULT-APR.
 16741****   N O T E   ****
 16742*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16743*      THE OH HARD CODING IN ELCRFNDP
 16744
 16745     IF PB-COMPANY-ID = 'CID'
 16746        IF CP-STATE-STD-ABBRV = 'OH'
 16747           MOVE WS-LF-EARNINGS-CALC
 16748                                 TO CP-EARNING-METHOD
 16749        END-IF
 16750     END-IF
 16751
 16752****   N O T E   ****
 16753
 16754*    IF CP-EARN-AS-NET-PAY
 16755*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16756*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16757*               MOVE WS-DEFAULT-APR
 16758*                                TO  CP-LOAN-APR
 16759*               MOVE ER-3780     TO  WS-ERROR
 16760*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16761*           ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 303
* EL050.cbl
 16762*               MOVE ER-3781     TO  WS-ERROR
 16763*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16764*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16765     move ' '                    to cp-ext-days-calc
 16766     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16767
 16768     IF CP-REFUND-TYPE-USED NOT = SPACE
 16769         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16770
 16771     IF CP-ERROR-RATE-IS-ZERO OR
 16772        CP-ERROR-RATE-NOT-FOUND
 16773        MOVE ER-2740             TO WS-ERROR
 16774        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16775
 16776     IF CP-ERROR-RATE-FILE-NOTOPEN
 16777        MOVE ER-2617             TO WS-ERROR
 16778        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16779
 16780     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16781        AND PB-CI-ENTRY-STATUS = 'M'
 16782        MOVE +0                  TO PB-C-LF-REF-CALC
 16783     ELSE
 16784        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16785     END-IF
 16786
 16787     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16788         GO TO 3730-GET-AH-REMAIN-TERM.
 16789
 16790*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16791*       ADD +1                   TO PB-C-LF-REM-TERM
 16792*                                   CP-REMAINING-TERM
 16793*                                   CP-ORIGINAL-TERM.
 16794
 16795     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16796     MOVE '2'                    TO CP-EARNING-METHOD
 16797                                    CP-RATING-METHOD.
 16798     IF PB-COMPANY-ID = 'CID'
 16799        IF (CP-STATE-STD-ABBRV = 'MN')
 16800           AND (PB-CERT-EFF-DT > X'A4FF')
 16801           AND (WS-LF-EARNINGS-CALC = 'B')
 16802           MOVE '5'              TO CP-EARNING-METHOD
 16803           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16804        END-IF
 16805     END-IF
 16806     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16807                                        CP-REMAINING-BENEFIT
 16808                                        CP-RATING-BENEFIT-AMT.
 16809     IF CP-STATE-STD-ABBRV = 'OR'
 16810         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16811                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16812     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16813     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16814
 16815     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16816
 16817     IF CP-ERROR-RATE-IS-ZERO OR
 16818        CP-ERROR-RATE-NOT-FOUND
 16819        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 304
* EL050.cbl
 16820        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16821
 16822     IF CP-ERROR-RATE-FILE-NOTOPEN
 16823        MOVE ER-2617             TO WS-ERROR
 16824        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16825
 16826     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16827
 16828******************************************************************
 16829
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 305
* EL050.cbl
 16831 3730-GET-AH-REMAIN-TERM.
 16832     IF NO-AH-BENEFIT-MATCH  OR
 16833        WS-AH-BENEFIT-CD = ZEROS
 16834         GO TO 3770-CHECK-REFUNDS.
 16835
 16836     IF PB-CI-AH-LUMP-SUM-DISAB
 16837         IF  PB-C-AH-CANCEL-AMT = ZERO
 16838            IF NOT PB-COMP-AH-CANCEL
 16839             GO TO 3770-CHECK-REFUNDS.
 16840
 16841     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16842     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16843     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16844     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16845     MOVE PB-SV-STATE            TO CP-STATE.
 16846     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16847     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16848     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16849     MOVE '2'                    TO CP-PROCESS-TYPE.
 16850     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16851     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16852     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16853     IF (PB-COMPANY-ID = 'CID')
 16854        AND (CP-STATE-STD-ABBRV = 'WI')
 16855        MOVE '7'                 TO CP-REM-TERM-METHOD
 16856        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16857     ELSE
 16858        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16859        MOVE WS-REM-TRM-CALC-OPTION
 16860                                 TO CP-REM-TRM-CALC-OPTION
 16861     END-IF
 16862     IF (PB-COMPANY-ID = 'CID')
 16863        AND (CP-STATE-STD-ABBRV = 'MO')
 16864        AND (PB-CERT-EFF-DT >= X'9B41')
 16865        AND (PB-CERT-EFF-DT <= X'A2FB')
 16866        MOVE '7'                 TO CP-REM-TERM-METHOD
 16867        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16868     END-IF
 16869     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16870                                    CP-LOAN-TERM.
 16871     IF NOT CP-TERM-IS-DAYS
 16872         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16873
 16874     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16875
 16876     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16877
 16878     IF AH-COVERAGE-CANCELLED
 16879        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16880        NEXT SENTENCE
 16881      ELSE
 16882         GO TO 3770-CHECK-REFUNDS.
 16883
 16884 3740-GET-AH-REFUND.
 16885
 16886     IF PB-C-AH-CANCEL-VOIDED
 16887        GO TO 3780-UPDATE-CANCEL-CERT
 16888     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 306
* EL050.cbl
 16889
 16890     IF PB-COMPANY-ID = 'BOA'
 16891         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16892         GO TO 3770-CHECK-REFUNDS.
 16893
 16894     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16895*    MOVE ' '                    TO DC-OPTION-CODE
 16896     SET BIN-TO-GREG             TO TRUE
 16897     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16898     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16899                                    PB-C-AH-REM-TERM.
 16900     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16901     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16902
 16903     IF PB-COMPANY-ID EQUAL 'FLC'
 16904        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16905           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16906           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16907                    - CM-AH-ITD-AH-PMT)
 16908           IF PB-C-AH-REF-CALC LESS THAN +0
 16909              MOVE +0            TO PB-C-AH-REF-CALC
 16910              GO TO 3770-CHECK-REFUNDS
 16911           ELSE
 16912              GO TO 3770-CHECK-REFUNDS.
 16913
 16914     IF PB-COMPANY-ID = 'DCC'
 16915        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16916            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16917           MOVE 'S'              TO CP-EARNING-METHOD
 16918        END-IF
 16919     END-IF
 16920     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16921                            OR '4' OR '5' OR '6' OR '8'
 16922                            OR '9' OR 'G' OR 'S'
 16923        MOVE PB-C-AH-REFUND-OVERRIDE
 16924                                 TO CP-EARNING-METHOD.
 16925
 16926     if pb-company-id = 'AHL'
 16927        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16928        if cp-class-code = spaces
 16929           move zeros            to cp-class-code
 16930        end-if
 16931     ELSE
 16932        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16933     END-IF
 16934*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16935     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16936     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16937                                    CP-RATING-BENEFIT-AMT.
 16938     IF CP-STATE-STD-ABBRV = 'OR'
 16939         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16940                                         PB-CI-AH-TERM.
 16941     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16942     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16943     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16944     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16945     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16946     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 307
* EL050.cbl
 16947
 16948     IF CP-STATE-STD-ABBRV = 'OH'
 16949        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16950                                AND 'CID' AND 'DCC' and 'VPP'
 16951                                AND 'AHL')
 16952           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16953              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16954              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16955              MOVE '6' TO CP-EARNING-METHOD
 16956           END-IF
 16957        END-IF
 16958        IF PB-COMPANY-ID = 'CID'
 16959           IF NO-LIFE-COVERAGE
 16960              IF CP-CRITICAL-PERIOD
 16961                 MOVE '2'       TO CP-EARNING-METHOD
 16962              ELSE
 16963                 MOVE '6'       TO CP-EARNING-METHOD
 16964              END-IF
 16965           ELSE
 16966              IF WS-LF-COVERAGE-TYPE = 'L'
 16967                 MOVE '2'       TO CP-EARNING-METHOD
 16968              ELSE
 16969                 IF (PB-CI-LF-TERM > +60) OR
 16970                    (WS-LF-EARNINGS-CALC = '5')
 16971                    IF CP-CRITICAL-PERIOD
 16972                       MOVE '2'  TO CP-EARNING-METHOD
 16973                    ELSE
 16974                       MOVE '6'  TO CP-EARNING-METHOD
 16975                    END-IF
 16976                 ELSE
 16977                    MOVE '1'     TO CP-EARNING-METHOD
 16978                 END-IF
 16979              END-IF
 16980           END-IF
 16981        END-IF
 16982     END-IF
 16983
 16984*    IF CP-STATE-STD-ABBRV = 'VA'
 16985*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16986*          IF CP-ORIGINAL-TERM GREATER 61
 16987*             MOVE '6' TO CP-EARNING-METHOD
 16988*          ELSE
 16989*             MOVE '1' TO CP-EARNING-METHOD.
 16990
 16991     IF WS-DEFAULT-APR NOT NUMERIC
 16992         MOVE ZEROS TO WS-DEFAULT-APR.
 16993     IF CP-EARN-AS-NET-PAY
 16994         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16995            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16996                MOVE WS-DEFAULT-APR
 16997                                 TO  CP-LOAN-APR
 16998                MOVE ER-3780     TO  WS-ERROR
 16999                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 17000            ELSE
 17001                MOVE ER-3781     TO  WS-ERROR
 17002                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 17003     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17004     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 308
* EL050.cbl
 17005        AND CP-CANCEL-REASON = 'R'
 17006        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17007        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 17008     END-IF
 17009     IF PB-COMPANY-ID = 'DCC'
 17010        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17011        AND (CP-EARNING-METHOD = 'D')
 17012        AND (CP-CANCEL-REASON NOT = 'R')
 17013        CONTINUE
 17014     ELSE
 17015        GO TO 3750-CONTINUE
 17016     END-IF
 17017     MOVE ' '                    TO DD-IU-SW
 17018     IF NOT PDEF-MASTER-FOUND
 17019        MOVE ' '                 TO PDEF-MASTER-SW
 17020        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17021        MOVE PB-STATE            TO ERPDEF-STATE
 17022        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 17023           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 17024        END-IF
 17025        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17026        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17027        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17028        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17029        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17030        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17031        IF PDEF-MASTER-FOUND
 17032           MOVE 'N'              TO PDEF-MASTER-SW
 17033           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17034           IF PDEF-MASTER-FOUND
 17035              IF (ERPDEF-KEY-SAVE (1:16) =
 17036                           PD-CONTROL-PRIMARY (1:16))
 17037                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17038                 CONTINUE
 17039              ELSE
 17040                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17041                 IF (ERPDEF-KEY-SAVE (1:16) =
 17042                           PD-CONTROL-PRIMARY (1:16))
 17043                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17044                    CONTINUE
 17045                 ELSE
 17046                    MOVE ER-2740 TO WS-ERROR
 17047                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17048                    GO TO 3770-CHECK-REFUNDS
 17049                 END-IF
 17050              END-IF
 17051           END-IF
 17052           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17053        END-IF
 17054     END-IF
 17055     IF PDEF-MASTER-FOUND
 17056        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17057           (V1 > +8)
 17058           OR (PD-PROD-CODE (V1) = 'I')
 17059        END-PERFORM
 17060        IF V1 < +9
 17061           SET DD-IU-PRESENT        TO TRUE
 17062        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 309
* EL050.cbl
 17063        IF WS-AH-DCC-TRUNC = 'T'
 17064           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17065        ELSE
 17066           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17067        END-IF
 17068        EVALUATE TRUE
 17069           WHEN WS-TERM > +168
 17070              MOVE 15               TO V1
 17071           WHEN WS-TERM > +156
 17072              MOVE 14               TO V1
 17073           WHEN WS-TERM > +144
 17074              MOVE 13               TO V1
 17075           WHEN WS-TERM > +132
 17076              MOVE 12               TO V1
 17077           WHEN WS-TERM > +120
 17078              MOVE 11               TO V1
 17079           WHEN WS-TERM > +108
 17080              MOVE 10               TO V1
 17081           WHEN WS-TERM > +96
 17082              MOVE 9                TO V1
 17083           WHEN WS-TERM > +84
 17084              MOVE 8                TO V1
 17085           WHEN WS-TERM > +72
 17086              MOVE 7                TO V1
 17087           WHEN WS-TERM > +60
 17088              MOVE 6                TO V1
 17089           WHEN WS-TERM > +48
 17090              MOVE 5                TO V1
 17091           WHEN WS-TERM > +36
 17092              MOVE 4                TO V1
 17093           WHEN WS-TERM > +24
 17094              MOVE 3                TO V1
 17095           WHEN WS-TERM > +12
 17096              MOVE 2                TO V1
 17097           WHEN OTHER
 17098              MOVE 1                TO V1
 17099        END-EVALUATE
 17100
 17101        EVALUATE TRUE
 17102*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17103*             < +13)
 17104*             AND (DD-IU-PRESENT)
 17105*             MOVE 2                TO V2
 17106*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17107*             MOVE 1                TO V2
 17108           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17109              MOVE 2                TO V2
 17110           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17111              MOVE 3                TO V2
 17112           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17113              MOVE 4                TO V2
 17114           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17115              MOVE 5                TO V2
 17116           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17117              MOVE 6                TO V2
 17118           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17119              MOVE 7                TO V2
 17120           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 310
* EL050.cbl
 17121              MOVE 8                TO V2
 17122           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17123              MOVE 9                TO V2
 17124           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17125              MOVE 10               TO V2
 17126           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17127              MOVE 11               TO V2
 17128           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17129              MOVE 12               TO V2
 17130           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17131              MOVE 13               TO V2
 17132           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17133              MOVE 14               TO V2
 17134           WHEN OTHER
 17135              MOVE 15               TO V2
 17136        END-EVALUATE
 17137
 17138        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17139                                 TO CP-DDF-LO-FACT
 17140        MOVE PD-UEP-FACTOR (V1 V2)
 17141                                 TO CP-DDF-HI-FACT
 17142
 17143        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17144        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17145        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17146           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17147        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17148        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17149        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17150           + PD-1ST-YR-ADMIN-ALLOW
 17151
 17152        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17153*       IF PI-CLP-YN = 'Y'
 17154*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17155*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17156*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17157*       END-IF
 17158
 17159        IF DD-IU-PRESENT
 17160           MOVE 'I'              TO CP-EARNING-METHOD
 17161        END-IF
 17162        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17163                                     CP-CLP-RATE-UP
 17164        IF CP-IU-RATE-UP NOT = ZEROS
 17165           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17166              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17167           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17168              / (1 - WS-WORK-FACT)
 17169        END-IF
 17170     END-IF
 17171     .
 17172 3750-CONTINUE.
 17173     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17174
 17175     IF CP-REFUND-TYPE-USED NOT = SPACE
 17176         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17177
 17178     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 311
* EL050.cbl
 17179        CP-ERROR-RATE-NOT-FOUND
 17180        MOVE ER-2740             TO WS-ERROR
 17181        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17182
 17183     IF CP-ERROR-RATE-FILE-NOTOPEN
 17184        MOVE ER-2617             TO WS-ERROR
 17185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17186     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17187        AND (PB-CI-ENTRY-STATUS = 'M')
 17188        MOVE +0                  TO PB-C-AH-REF-CALC
 17189     ELSE
 17190        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17191     END-IF
 17192     if pb-company-id = 'VPP'
 17193        MOVE cm-ah-clp           to cp-original-premium
 17194        move zeros               to cp-calc-refund
 17195        perform 7600-get-refund  thru 7600-exit
 17196        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17197           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17198        else
 17199           move zeros            to pb-c-ah-rfnd-clp
 17200        end-if
 17201        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17202           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17203           pb-ci-cancel-fee
 17204     end-if
 17205     IF PB-COMPANY-ID = 'DCC'
 17206        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17207        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17208        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17209        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17210        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17211        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17212        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17213        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17214*       if pb-c-cancel-amt < +0
 17215*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17216*       end-if
 17217*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17218     END-IF
 17219     .
 17220 3770-CHECK-REFUNDS.
 17221
 17222     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17223        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17224           MOVE ER-2766          TO WS-ERROR
 17225           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17226           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17227           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17228              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17229
 17230     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17231        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17232           MOVE ER-2766          TO WS-ERROR
 17233           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17234           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17235           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17236              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 312
* EL050.cbl
 17237
 17238     IF PB-COMP-LF-CANCEL
 17239        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17240        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17241           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17242              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17243
 17244     IF PB-COMP-AH-CANCEL
 17245        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17246        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17247           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17248              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17249
 17250     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17251             GIVING WS-UNSIGN-WRK1
 17252     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17253             GIVING WS-UNSIGN-WRK2.
 17254
 17255     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17256         MOVE ZERO TO WS-UNSIGN-WRK1.
 17257
 17258     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17259         MOVE ZERO TO WS-UNSIGN-WRK2.
 17260
 17261     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17262
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 313
* EL050.cbl
 17264
 17265 3772-CONTINUE.
 17266
 17267**********************************
 17268*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17269*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17270*** DOUBLES THE TOLERANCE AMOUNT.
 17271***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17272**********************************
 17273     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17274     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17275         IF WS-REF-REJECT-SW = SPACE
 17276             MOVE ER-2754        TO WS-ERROR
 17277             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17278           ELSE
 17279             MOVE ER-2736        TO WS-ERROR
 17280             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17281**********************************
 17282
 17283 3773-CONTINUE.
 17284
 17285     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17286        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17287           MOVE ER-2723          TO WS-ERROR
 17288           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17289
 17290     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17291        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17292           MOVE ER-2724          TO WS-ERROR
 17293           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17294
 17295     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17296         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17297             (1 + WS-LF-REFUND-OVS-PCT)
 17298     ELSE
 17299         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17300
 17301     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17302         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17303             (1 - WS-TOL-LF-REFUND-PCT)
 17304     ELSE
 17305         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17306
 17307     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17308        AND (PB-CI-ENTRY-STATUS = 'M')
 17309        AND (PB-C-LF-CANCEL-AMT > +0)
 17310        MOVE ER-3843             TO WS-ERROR
 17311        PERFORM 9900-ERROR-FORMAT
 17312                                 THRU 9900-EXIT
 17313     END-IF
 17314     EVALUATE TRUE
 17315        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17316           CONTINUE
 17317        WHEN PB-C-LF-CANCEL-AMT = +0
 17318                 AND PB-C-LF-REF-CALC > +0
 17319           CONTINUE
 17320        WHEN WS-LF-REFUND-OVS-AMT = 0
 17321                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 314
* EL050.cbl
 17322           CONTINUE
 17323        WHEN OTHER
 17324           IF WS-TOL-LF-REFUND  = +0
 17325              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17326           END-IF
 17327           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17328                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17329                          (PB-C-LF-CANCEL-AMT))
 17330              CONTINUE
 17331           ELSE
 17332              IF WS-LF-REFUND-OVS-AMT = +0
 17333                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17334              END-IF
 17335              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17336                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17337                                       PB-C-LF-CANCEL-AMT)
 17338                 CONTINUE
 17339              ELSE
 17340                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17341                   MOVE ER-2754   TO  WS-ERROR
 17342                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17343                 ELSE
 17344                    MOVE ER-2736   TO  WS-ERROR
 17345                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17346                 END-IF
 17347              END-IF
 17348           END-IF
 17349     END-EVALUATE.
 17350
 17351     EVALUATE TRUE
 17352        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17353           CONTINUE
 17354        WHEN PB-C-LF-CANCEL-AMT = +0
 17355                 AND PB-C-LF-REF-CALC > +0
 17356           CONTINUE
 17357        WHEN OTHER
 17358           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17359               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17360              CONTINUE
 17361           ELSE
 17362              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17363               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17364                CONTINUE
 17365              ELSE
 17366                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17367                     MOVE ER-2754   TO  WS-ERROR
 17368                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17369                 ELSE
 17370                     MOVE ER-2736   TO  WS-ERROR
 17371                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17372                 END-IF
 17373              END-IF
 17374           END-IF
 17375     END-EVALUATE.
 17376
 17377     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17378         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17379             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 315
* EL050.cbl
 17380     ELSE
 17381         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17382
 17383     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17384         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17385             (1 - WS-TOL-AH-REFUND-PCT)
 17386     ELSE
 17387         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17388
 17389     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17390        AND (PB-CI-ENTRY-STATUS = 'M')
 17391        AND (PB-C-AH-CANCEL-AMT > +0)
 17392        MOVE ER-3843             TO WS-ERROR
 17393        PERFORM 9900-ERROR-FORMAT
 17394                                 THRU 9900-EXIT
 17395     END-IF
 17396     EVALUATE TRUE
 17397        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17398           CONTINUE
 17399*       WHEN PB-C-AH-REF-CALC = +0 AND
 17400*                  PB-C-AH-CANCEL-AMT > +0
 17401        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17402                   PB-C-AH-REF-CALC > +0
 17403           CONTINUE
 17404        WHEN WS-AH-REFUND-OVS-AMT = +0
 17405                AND WS-TOL-AH-REFUND = +0
 17406           CONTINUE
 17407        WHEN OTHER
 17408           IF WS-TOL-AH-REFUND = +0
 17409              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17410           END-IF
 17411           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17412               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17413                                         PB-C-AH-CANCEL-AMT)
 17414              CONTINUE
 17415           ELSE
 17416              IF WS-AH-REFUND-OVS-AMT = +0
 17417                 MOVE +9999999.99 TO
 17418                         WS-AH-REFUND-OVS-AMT
 17419              END-IF
 17420              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17421                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17422                                         PB-C-AH-CANCEL-AMT)
 17423                 CONTINUE
 17424              ELSE
 17425                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17426                    MOVE ER-2754   TO  WS-ERROR
 17427                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17428                 ELSE
 17429                    MOVE ER-2736   TO  WS-ERROR
 17430                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17431                 END-IF
 17432              END-IF
 17433           END-IF
 17434     END-EVALUATE.
 17435
 17436     EVALUATE TRUE
 17437        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 316
* EL050.cbl
 17438           CONTINUE
 17439*       WHEN PB-C-AH-REF-CALC > +0 AND
 17440*                  PB-C-AH-CANCEL-AMT = +0
 17441        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17442                   PB-C-AH-REF-CALC = +0
 17443           CONTINUE
 17444        WHEN OTHER
 17445           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17446               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17447              CONTINUE
 17448           ELSE
 17449              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17450                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17451                 CONTINUE
 17452              ELSE
 17453                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17454                     MOVE ER-2754   TO  WS-ERROR
 17455                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17456                 ELSE
 17457                     MOVE ER-2736   TO  WS-ERROR
 17458                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17459                 END-IF
 17460              END-IF
 17461           END-IF
 17462     END-EVALUATE.
 17463
 17464     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17465        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17466        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17467           AND  PB-C-LF-REF-CALC < +1.00
 17468           AND  PB-C-AH-REF-CALC < +1.00
 17469           CONTINUE
 17470        ELSE
 17471           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17472              AND (PB-CI-ENTRY-STATUS = 'M')
 17473              CONTINUE
 17474           ELSE
 17475              MOVE ER-2741       TO WS-ERROR
 17476              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17477           END-IF
 17478        END-IF
 17479     END-IF
 17480
 17481     IF (PB-C-LF-CANCEL-AMT = ZERO
 17482        AND WS-LF-BENEFIT-CD NOT = ZERO
 17483        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17484        AND PB-C-LF-REF-CALC NOT = ZERO)
 17485        OR
 17486        (PB-C-LF-CANCEL-AMT = ZERO
 17487        AND WS-LF-BENEFIT-CD NOT = ZERO
 17488        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17489             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17490                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17491                NEXT SENTENCE
 17492             ELSE
 17493                MOVE ER-2739        TO WS-ERROR
 17494                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17495
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 317
* EL050.cbl
 17496     IF (PB-C-AH-CANCEL-AMT = ZERO
 17497        AND WS-AH-BENEFIT-CD NOT = ZERO
 17498        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17499        AND PB-C-AH-REF-CALC NOT = ZERO)
 17500        OR
 17501        (PB-C-AH-CANCEL-AMT = ZERO
 17502        AND WS-AH-BENEFIT-CD NOT = ZERO
 17503        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17504             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17505                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17506                NEXT SENTENCE
 17507             ELSE
 17508                MOVE ER-2738        TO WS-ERROR
 17509                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17510
 17511 3775-OVER-REF-CHK.
 17512
 17513     IF PB-CI-ENTRY-STATUS = '5'
 17514        GO TO 3780-UPDATE-CANCEL-CERT.
 17515
 17516     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17517                              PB-CI-LF-ALT-PREMIUM-AMT.
 17518
 17519     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17520        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17521                                 PB-C-LF-REF-CALC
 17522      ELSE
 17523        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17524                                 PB-C-LF-CANCEL-AMT.
 17525
 17526     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17527        MOVE ER-2755             TO WS-ERROR
 17528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17529
 17530     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17531
 17532     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17533        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17534                                 PB-C-AH-REF-CALC
 17535      ELSE
 17536        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17537                                 PB-C-AH-CANCEL-AMT.
 17538
 17539     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17540        MOVE ER-2778             TO WS-ERROR
 17541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17542
 17543     IF PB-CI-OB-FLAG NOT = 'Z'
 17544        NEXT SENTENCE
 17545       ELSE
 17546         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17547            MOVE ER-2757           TO WS-ERROR
 17548            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17549
 17550 3780-UPDATE-CANCEL-CERT.
 17551
 17552     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17553        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 318
* EL050.cbl
 17554        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17555
 17556     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17557         MOVE ER-2729              TO WS-ERROR
 17558         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17559
 17560     IF PB-CI-LF-BENEFIT-CD = ZERO
 17561         GO TO 3780-UPDATE-CONT-1.
 17562
 17563     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17564         GO TO 3780-UPDATE-CONT-1.
 17565
 17566     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17567       AND
 17568        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17569       AND
 17570        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17571       AND
 17572        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17573            NEXT SENTENCE
 17574       ELSE
 17575        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17576          AND
 17577***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17578***       AND
 17579           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17580            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17581               MOVE ER-2730      TO WS-ERROR
 17582               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17583               GO TO 3999-END-EDIT
 17584            ELSE
 17585               GO TO 3999-END-EDIT
 17586        ELSE
 17587            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17588               MOVE ER-2765           TO WS-ERROR
 17589               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17590               GO TO 3785-CHECK-REF-INT.
 17591*              GO TO 3999-END-EDIT.
 17592
 17593 3780-UPDATE-CONT-1.
 17594     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17595
 17596     IF PB-CI-AH-BENEFIT-CD = ZERO
 17597         GO TO 3780-UPDATE-CONT-2.
 17598
 17599     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17600         GO TO 3780-UPDATE-CONT-2.
 17601
 17602     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17603
 17604     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17605       AND
 17606        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17607       AND
 17608        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17609       AND
 17610        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17611            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 319
* EL050.cbl
 17612       ELSE
 17613        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17614          AND
 17615***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17616***       AND
 17617           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17618           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17619            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17620               MOVE ER-2773      TO WS-ERROR
 17621               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17622               GO TO 3999-END-EDIT
 17623            ELSE
 17624               GO TO 3999-END-EDIT
 17625            END-IF
 17626           ELSE
 17627             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17628                IF MSTR-CERT-NO = W-CL-CERT-NO
 17629                   MOVE ER-2890 TO WS-ERROR
 17630                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17631                   GO TO 3999-END-EDIT
 17632                ELSE
 17633                   MOVE ER-2898 TO WS-ERROR
 17634                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17635                   GO TO 3999-END-EDIT
 17636                END-IF
 17637             ELSE
 17638                GO TO 3785-CHECK-REF-INT
 17639             END-IF
 17640           END-IF
 17641          ELSE
 17642            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17643              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17644                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17645                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17646                      MOVE ER-2890 TO WS-ERROR
 17647                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17648                      GO TO 3999-END-EDIT
 17649                   ELSE
 17650                      MOVE ER-2898 TO WS-ERROR
 17651                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17652                      GO TO 3999-END-EDIT
 17653                   END-IF
 17654                ELSE
 17655                   MOVE ER-2765 TO WS-ERROR
 17656                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17657                   GO TO 3785-CHECK-REF-INT
 17658                END-IF
 17659              ELSE
 17660               MOVE ER-2765      TO WS-ERROR
 17661               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17662               GO TO 3785-CHECK-REF-INT.
 17663*              GO TO 3999-END-EDIT.
 17664
 17665 3780-UPDATE-CONT-2.
 17666
 17667     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17668        AND WS-LF-BENEFIT-CD = ZERO
 17669           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 320
* EL050.cbl
 17670           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17671
 17672     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17673        AND WS-AH-BENEFIT-CD = ZERO
 17674           MOVE ER-2744           TO WS-ERROR
 17675           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17676
 17677     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17678        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17679        AND
 17680        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17681         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17682           MOVE ER-2746           TO WS-ERROR
 17683           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17684
 17685     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17686       AND
 17687        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17688             MOVE ER-2737        TO WS-ERROR
 17689             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17690
 17691     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17692       AND
 17693        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17694             MOVE ER-2737        TO WS-ERROR
 17695             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17696
 17697     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17698         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17699             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17700             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17701         ELSE
 17702             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17703                 MOVE ER-2768    TO WS-ERROR
 17704                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17705             ELSE
 17706                 MOVE ER-2756    TO WS-ERROR
 17707                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17708
 17709     IF CERT-PEND-ISSUE-RETURNED
 17710        MOVE ER-2772             TO WS-ERROR
 17711        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17712 3785-CHECK-REF-INT.
 17713*    IF PB-STATE NOT = 'NH' and 'TN'
 17714     IF PB-STATE NOT = 'NH'
 17715        GO TO 3999-END-EDIT
 17716     END-IF
 17717
 17718     MOVE ER-2796                TO WS-ERROR
 17719     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17720     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17721        OR (CM-REF-INTERFACE-SW = 'Y')
 17722        MOVE ER-2793             TO WS-ERROR
 17723        PERFORM 9900-ERROR-FORMAT
 17724                                 THRU 9900-EXIT
 17725     END-IF
 17726     MOVE +0                     TO WS-PAYMENT-AMT
 17727     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 321
* EL050.cbl
 17728        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17729               PB-C-AH-CANCEL-DT
 17730           GO TO 3999-END-EDIT
 17731        END-IF
 17732     end-if
 17733***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17734***-_-
 17735***-_-   For TN it's only flat cancels
 17736***-_-
 17737***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17738     if pb-state = 'TN'
 17739        if ((pb-c-lf-cancel-dt <> low-values)
 17740           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17741                      or
 17742           ((pb-c-ah-cancel-dt <> low-values)
 17743           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17744           GO TO 3999-END-EDIT
 17745        END-IF
 17746     end-if
 17747     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17748        GO TO 3999-END-EDIT
 17749     END-IF
 17750***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17751***-_-
 17752***-_-   if cancel date within 15 days of effective date, bypass
 17753***-_-
 17754***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17755     IF PB-STATE NOT = 'NH'
 17756        GO TO 3785-CONTINUE
 17757     END-IF
 17758     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17759     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17760     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17761        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17762     END-IF
 17763     MOVE '1'                    TO DC-OPTION-CODE
 17764     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17765     IF NO-CONVERSION-ERROR
 17766        IF DC-ELAPSED-DAYS < +16
 17767           GO TO 3999-END-EDIT
 17768        END-IF
 17769     END-IF
 17770***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17771***-_-
 17772***-_-   if cancel date within 30 days of current date then
 17773***-_-   bypass else subtract 15 days from period
 17774***-_-
 17775***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17776     MOVE +0                     TO DC-ELAPSED-DAYS
 17777     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17778     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17779     MOVE '1'                    TO DC-OPTION-CODE
 17780     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17781     IF NO-CONVERSION-ERROR
 17782        IF DC-ELAPSED-DAYS > +30
 17783           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17784        ELSE
 17785           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 322
* EL050.cbl
 17786        END-IF
 17787     ELSE
 17788        GO TO 3999-END-EDIT
 17789     END-IF
 17790     .
 17791 3785-CONTINUE.
 17792     if pb-state = 'TN'
 17793        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17794        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17795        MOVE '1'                 TO DC-OPTION-CODE
 17796        PERFORM 8500-DATE-CONVERT
 17797                                 THRU 8500-EXIT
 17798        IF no-CONVERSION-ERROR
 17799           IF DC-ELAPSED-DAYS < +16
 17800              GO TO 3999-END-EDIT
 17801           END-IF
 17802        END-IF
 17803     end-if
 17804***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17805***-_-
 17806***-_-   'NH' is 10%, TN is 3.5%
 17807***-_-
 17808***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17809*    if pb-state = 'NH'
 17810*       move +1.10               to ws-work-rate
 17811*    else
 17812*       move +1.035              to ws-work-rate
 17813*    end-if
 17814     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17815     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17816        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17817           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17818     IF WS-PAYMENT-AMT < 10.00
 17819        GO TO 3999-END-EDIT
 17820     END-IF
 17821*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17822
 17823     if (cm-soc-sec-no(1:9) numeric)
 17824        and (cm-soc-sec-no(1:9) not = zeros)
 17825        GO TO 3999-END-EDIT
 17826     END-IF
 17827     MOVE ER-2795                TO WS-ERROR
 17828     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17829
 17830     GO TO 3999-END-EDIT.
 17831******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 323
* EL050.cbl
 17833 3990-FILES-NOT-OPEN.
 17834
 17835     MOVE ER-2617                TO WS-ERROR.
 17836     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17837     GO TO 9990-RETURN.
 17838
 17839 3999-END-EDIT.
 17840
 17841     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17842
 17843     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17844         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17845         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17846             PERFORM 9250-UNLOCK-RETURN
 17847             GO TO 9990-RETURN
 17848          ELSE
 17849             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17850             GO TO 9990-RETURN.
 17851
 17852     IF PB-CANCELLATION
 17853          GO TO 9990-RETURN.
 17854
 17855     IF CERT-WAS-NOT-FOUND
 17856        MOVE SPACES              TO CERTIFICATE-MASTER.
 17857
 17858     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17859
 17860     IF CERT-WAS-FOUND
 17861         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17862             PERFORM 9250-UNLOCK-RETURN
 17863          ELSE
 17864            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17865      ELSE
 17866         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17867
 17868*    if pb-company-id = 'VPP'
 17869*       perform 8150-read-elcrtt thru 8150-exit
 17870*       if ws-vehicle-odometer numeric
 17871*          if ws-vehicle-odometer > 6000
 17872*             move er-1583       to ws-error
 17873*             PERFORM 9900-ERROR-FORMAT
 17874*                                THRU 9900-EXIT
 17875*          end-if
 17876*       end-if
 17877*    end-if
 17878     perform 8145-read-elcrtt-upd thru 8145-exit
 17879     if not elcrtt-found
 17880        move 'CS'                to certificate-trailers
 17881        move cm-control-primary  to cs-control-primary
 17882        move 'C'                 TO cs-trailer-type
 17883        move zeros               to cs-vehicle-odometer
 17884     end-if
 17885     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17886        IF ((PB-COMPANY-ID = 'DCC')
 17887           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17888                         or
 17889           (pb-company-id = 'CID' or 'VPP')
 17890           IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 324
* EL050.cbl
 17891               or (hldi-pass-area not = spaces)
 17892               move pa-modelyear        to cs-year
 17893               move pa-makename         to cs-make
 17894               move pa-modelname        to cs-model
 17895               move pa-seriesname       to cs-future
 17896               MOVE PB-I-VIN            TO CS-VIN-NUMBER
 17897               move 'Y'                 to elcrtt-update-sw
 17898           end-if
 17899        end-if
 17900     end-if
 17901     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17902        IF WS-INS-AGE-SET = 'Y'
 17903           MOVE WS-INS-AGE-DEFAULTED
 17904                                 TO CS-INS-AGE-DEFAULT-FLAG
 17905           move 'Y'              to elcrtt-update-sw
 17906        END-IF
 17907        IF WS-JNT-AGE-SET = 'Y'
 17908           MOVE WS-JNT-AGE-DEFAULTED
 17909                                 TO CS-JNT-AGE-DEFAULT-FLAG
 17910           move 'Y'              to elcrtt-update-sw
 17911        END-IF
 17912     end-if
 17913     move cs-ins-age-default-flag to ws-ins-age-defaulted
 17914     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 17915     move cs-vehicle-odometer    to ws-vehicle-odometer
 17916     if ws-ins-age-defaulted = 'Y'
 17917        move er-1573             to ws-error
 17918        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17919     end-if
 17920
 17921     if ws-jnt-age-defaulted = 'Y'
 17922        move er-1574             to ws-error
 17923        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17924     end-if
 17925***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17926***                                                           ****
 17927***  Set an error if the state requires verification of agent ****
 17928***  and agent hasn't verified yet and the status is not =    ****
 17929***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17930***  and the entry date > 09/01/2015.                         ****
 17931***                                                           ****
 17932***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17933     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17934        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17935        and (pb-account (9:2) not = 'OB')
 17936        if (ws-st-agent-sig-edit = 'Y')
 17937           and (am-report-code-1 not = 'CONLEY')
 17938           evaluate true
 17939              when cs-agent-edit-status = 'C'
 17940                 move er-1743    to ws-error
 17941                 perform 9900-error-format
 17942                                 thru 9900-exit
 17943              when cs-agent-edit-status = 'S'
 17944                 move er-1744    to ws-error
 17945                 perform 9900-error-format
 17946                                 thru 9900-exit
 17947              when cs-agent-edit-status = 'M'
 17948                 move er-1745    to ws-error
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 325
* EL050.cbl
 17949                 perform 9900-error-format
 17950                                 thru 9900-exit
 17951              when cs-agent-edit-status = 'R'
 17952                 move er-1747    to ws-error
 17953                 perform 9900-error-format
 17954                                 thru 9900-exit
 17955              when cs-agent-edit-status = 'N'
 17956                 move er-1748    to ws-error
 17957                 perform 9900-error-format
 17958                                 thru 9900-exit
 17959              when cs-agent-edit-status <> 'V' and 'U' and
 17960                                           'R' and 'N'
 17961                 move er-1746    to ws-error
 17962                 perform 9900-error-format
 17963                                 thru 9900-exit
 17964           end-evaluate
 17965        end-if
 17966     end-if
 17967*    move ' ' to cs-claim-verification-status
 17968*    move 'Y' to elcrtt-update-sw
 17969     if cs-claim-verification-status = ' ' or 'R'
 17970        move pb-state            to pa-clmhs-state
 17971        move pb-account          to pa-account
 17972        move ws-greg-eff-date    to pa-eff-dt
 17973        move pb-cert-no          to pa-cert-no
 17974        perform 7795-call-sqlclmhs
 17975                                 thru 7795-exit
 17976        if pa-clm-count > 0
 17977           if cs-claim-verification-status = ' '
 17978              move 'R'           to cs-claim-verification-status
 17979*             display 'Updating elcrtt ' pb-state ' '
 17980*                pb-account ' ' pb-cert-no
 17981              move 'Y'           to elcrtt-update-sw
 17982           end-if
 17983        else
 17984           if cs-claim-verification-status = 'R'
 17985              move ' '           to cs-claim-verification-status
 17986              move 'Y'           to elcrtt-update-sw
 17987           end-if
 17988        end-if
 17989     end-if
 17990
 17991     if cs-claim-verification-status <> ' '
 17992        evaluate true
 17993           when cs-claim-verification-status = 'R'
 17994              move er-1749    to ws-error
 17995              perform 9900-error-format
 17996                              thru 9900-exit
 17997           when cs-claim-verification-status = 'W'
 17998              move er-1750    to ws-error
 17999              perform 9900-error-format
 18000                              thru 9900-exit
 18001           when cs-claim-verification-status = 'I'
 18002              move er-1751    to ws-error
 18003              perform 9900-error-format
 18004                              thru 9900-exit
 18005           when cs-claim-verification-status = 'K'
 18006              move er-1761    to ws-error
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 326
* EL050.cbl
 18007              perform 9900-error-format
 18008                              thru 9900-exit
 18009           when cs-claim-verification-status = 'A'
 18010              move er-1752    to ws-error
 18011              perform 9900-error-format
 18012                              thru 9900-exit
 18013           when cs-claim-verification-status = 'B'
 18014              move er-1754    to ws-error
 18015              perform 9900-error-format
 18016                              thru 9900-exit
 18017           when cs-claim-verification-status = 'C'
 18018              move er-1753    to ws-error
 18019              perform 9900-error-format
 18020                              thru 9900-exit
 18021           when cs-claim-verification-status = 'D'
 18022              move er-1757    to ws-error
 18023              perform 9900-error-format
 18024                              thru 9900-exit
 18025           when cs-claim-verification-status = 'E'
 18026              move er-1758    to ws-error
 18027              perform 9900-error-format
 18028                              thru 9900-exit
 18029           when cs-claim-verification-status = 'F'
 18030              move er-1759    to ws-error
 18031              perform 9900-error-format
 18032                              thru 9900-exit
 18033           when cs-claim-verification-status = 'G'
 18034              move er-1760    to ws-error
 18035              perform 9900-error-format
 18036                              thru 9900-exit
 18037*          when cs-claim-verification-status = 'H'
 18038*             move er-1756    to ws-error
 18039*             perform 9900-error-format
 18040*                             thru 9900-exit
 18041*          when cs-claim-verification-status = 'J'
 18042*             move er-1755    to ws-error
 18043*             perform 9900-error-format
 18044*                             thru 9900-exit
 18045        end-evaluate
 18046     end-if
 18047
 18048     IF ELCRTT-UPDATE
 18049        perform 8150-update-elcrtt thru 8150-exit
 18050*       display ' back from 8150 ' elcrtt-file-status
 18051     else
 18052        if elcrtt-found
 18053           perform 8155-unlock-elcrtt
 18054                                 thru 8155-exit
 18055        end-if
 18056     end-if
 18057     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18058     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 18059        AND (WS-NO-SECURE-PAY))
 18060                  OR
 18061        (WS-LF-SPECIAL-CALC-CD = 'O'
 18062        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18063        SET SKIP-ADDR-EDIT       TO TRUE
 18064     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 327
* EL050.cbl
 18065     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18066        AND (NOT SKIP-ADDR-EDIT)
 18067        MOVE ER-2963             TO WS-ERROR
 18068        PERFORM 9900-ERROR-FORMAT
 18069                                 THRU 9900-EXIT
 18070        GO TO 9990-RETURN
 18071     END-IF
 18072     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 18073     IF ERPNDM-FOUND NOT = 'X'
 18074        move 'Y'                 to erpndm-unlock-sw
 18075        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18076           OR (PM-CITY        = SPACES OR LOW-VALUES)
 18077           OR (PM-STATE       = SPACES OR LOW-VALUES)
 18078           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 18079           or (pm-zip-code    = zeros)
 18080           or (pm-zip-code not numeric))
 18081           AND (NOT SKIP-ADDR-EDIT)
 18082           MOVE ER-2694          TO WS-ERROR
 18083           PERFORM 9900-ERROR-FORMAT
 18084                                 THRU 9900-EXIT
 18085        END-IF
 18086        MOVE ' '                 TO STATE-RECORD-ERROR
 18087        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18088        MOVE PM-STATE            TO CNTL-ACCESS
 18089        MOVE '3'                 TO CNTL-REC-TYPE
 18090        MOVE +0                  TO CNTL-SEQ-NO
 18091        MOVE '0'                 TO RC-SW-2
 18092        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18093        IF (NO-STATE-RECORD)
 18094           OR (CF-RECORD-TYPE NOT = '3')
 18095           OR (PM-STATE NOT = CF-STATE-CODE)
 18096           IF (PM-STATE = SPACES)
 18097              AND (SKIP-ADDR-EDIT)
 18098              CONTINUE
 18099           ELSE
 18100              MOVE ER-2963       TO WS-ERROR
 18101              PERFORM 9900-ERROR-FORMAT
 18102                                 THRU 9900-EXIT
 18103           END-IF
 18104        END-IF
 18105        if (ws-error not = er-2963 and er-2694)
 18106           and (pm-city-st-zip-verified = ' ')
 18107           and (pb-company-id = 'CID')
 18108           move spaces           to zipcd-pass-area
 18109           move pm-zip-code      to pa-zip
 18110           move pm-city          to pa-city
 18111           move pm-state         to pa-state
 18112           perform 7790-call-zip-verify
 18113                                 thru 7790-exit
 18114           if pa-errorcode-zip (1:1) = ' '
 18115                    move 'Y'     to pm-city-st-zip-verified
 18116                    PERFORM 8102-REWRITE-ERPNDM
 18117                                 THRU 8102-EXIT
 18118                    move 'N'     to erpndm-unlock-sw
 18119           else
 18120              MOVE ER-3061       TO WS-ERROR
 18121              PERFORM 9900-ERROR-FORMAT
 18122                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 328
* EL050.cbl
 18123           end-if
 18124        end-if
 18125        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18126           MOVE ER-2883          TO WS-ERROR
 18127           PERFORM 9900-ERROR-FORMAT
 18128                                 THRU 9900-EXIT
 18129        END-IF
 18130        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18131           MOVE ' '                 TO STATE-RECORD-ERROR
 18132           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18133           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18134           MOVE '3'                 TO CNTL-REC-TYPE
 18135           MOVE +0                  TO CNTL-SEQ-NO
 18136           MOVE '0'                 TO RC-SW-2
 18137           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18138           IF NO-STATE-RECORD
 18139              OR (CF-RECORD-TYPE NOT = '3')
 18140              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18141              MOVE ER-2964          TO WS-ERROR
 18142              PERFORM 9900-ERROR-FORMAT
 18143                                    THRU 9900-EXIT
 18144           END-IF
 18145        END-IF
 18146     ELSE
 18147        IF NOT SKIP-ADDR-EDIT
 18148           MOVE ER-2393          TO WS-ERROR
 18149           PERFORM 9900-ERROR-FORMAT
 18150                                 THRU 9900-EXIT
 18151        END-IF
 18152     END-IF
 18153     if need-to-unlock-erpndm
 18154        perform 8104-unlock-erpndm
 18155                                 thru 8104-exit
 18156     end-if
 18157     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 18158
 18159     IF (ERMAIL-FOUND = ' ' AND
 18160        ERPNDM-FOUND = ' ')
 18161        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 18162           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18163           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18164          OR
 18165           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18166          OR
 18167           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18168           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18169           GO TO 3999-UNLOCK-ERMAIL.
 18170
 18171     IF ERPNDM-FOUND = 'X'
 18172        GO TO 3999-UNLOCK-ERMAIL.
 18173
 18174     IF PM-INSURED-LAST-NAME      = SPACES
 18175        AND PM-INSURED-FIRST-NAME = SPACES
 18176        AND PM-ADDRESS-LINE-1     = SPACES
 18177        AND PM-ADDRESS-LINE-2     = SPACES
 18178        AND PM-CITY-STATE         = SPACES
 18179        AND PM-CRED-BENE-NAME     = SPACES
 18180        AND PM-CRED-BENE-ADDR     = SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 329
* EL050.cbl
 18181        AND PM-CRED-BENE-CTYST    = SPACES
 18182        GO TO 3999-UNLOCK-ERMAIL
 18183     END-IF
 18184
 18185     MOVE SPACES                 TO MAILING-DATA.
 18186
 18187     MOVE 'MA'                   TO MA-RECORD-ID.
 18188     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18189     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18190     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18191     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18192     MOVE PB-SV-STATE            TO MA-STATE.
 18193     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18194     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18195
 18196     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18197     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18198
 18199     IF ERMAIL-FOUND = ' '
 18200        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18201     ELSE
 18202        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18203        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18204        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18205
 18206     GO TO 9990-RETURN.
 18207
 18208 3999-UNLOCK-ERMAIL.
 18209     IF ERMAIL-FOUND = ' '
 18210        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18211
 18212     GO TO 9990-RETURN.
 18213******************************************************************
 18214
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 330
* EL050.cbl
 18216 4000-UPDATE-CANCELLED-CERT.
 18217     IF CERT-WAS-NOT-FOUND
 18218        GO TO 4299-EXIT.
 18219
 18220*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18221     IF PB-C-INT-ON-REFS > ZEROS
 18222        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18223     END-IF
 18224     IF PB-C-REF-INTERFACE-SW = 'Y'
 18225        MOVE PB-C-REF-INTERFACE-SW
 18226                                 TO CM-ref-INTERFACE-SW
 18227     END-IF
 18228*    IF ERMAIL-FOUND = ' '
 18229*       PERFORM 8140-UNLOCK-ERMAIL
 18230*                                THRU 8140-EXIT
 18231*    end-if
 18232     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18233     IF ERMAIL-FOUND = 'X'
 18234        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18235        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18236        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18237        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18238           MOVE ER-2694          TO WS-ERROR
 18239           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18240     END-IF
 18241
 18242     IF PB-C-POST-CARD-IND = 'Y'
 18243        MOVE +8                  TO SUB
 18244*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18245        IF ERMAIL-FOUND = ' '
 18246           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18247              (SUB > +7)
 18248              OR (MA-MAIL-STATUS (SUB) = '1')
 18249           END-PERFORM
 18250        END-IF
 18251        IF (SUB > +7)
 18252           OR (ERMAIL-FOUND = 'X')
 18253           MOVE ER-3789          TO WS-ERROR
 18254           PERFORM 9900-ERROR-FORMAT
 18255                                 THRU 9900-EXIT
 18256        END-IF
 18257     ELSE
 18258        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18259     END-IF
 18260
 18261     IF ERMAIL-FOUND = ' '
 18262        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18263     END-IF.
 18264
 18265     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18266
 18267     IF PB-CI-OB-FLAG = 'Z'
 18268        GO TO 4150-SUMMARY-CERT-CANCEL.
 18269     perform 8145-read-elcrtt-upd thru 8145-exit
 18270     if not elcrtt-found
 18271        move 'CS'                to certificate-trailers
 18272        move cm-control-primary  to cs-control-primary
 18273        move 'C'                 TO cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 331
* EL050.cbl
 18274        move zeros               to cs-vehicle-odometer
 18275     end-if
 18276
 18277     if pb-lf-refund-type <> cs-lf-refund-method
 18278        move pb-lf-refund-type   to cs-lf-refund-method
 18279        set elcrtt-update to true
 18280     end-if
 18281     if pb-ah-refund-type <> cs-ah-refund-method
 18282        move pb-ah-refund-type   to cs-ah-refund-method
 18283        set elcrtt-update to true
 18284     end-if
 18285     IF PB-C-LF-CANCEL-VOIDED
 18286         PERFORM 4200-REVERSE-LF-CANCEL.
 18287     IF PB-C-AH-CANCEL-VOIDED
 18288         PERFORM 4200-REVERSE-AH-CANCEL.
 18289     IF ELCRTT-UPDATE
 18290        perform 8150-update-elcrtt thru 8150-exit
 18291     else
 18292        if elcrtt-found
 18293           perform 8155-unlock-elcrtt
 18294                                 thru 8155-exit
 18295        end-if
 18296     end-if
 18297     .
 18298 4100-APPLY-LF-CANCEL.
 18299
 18300     MOVE +0                     TO WS-SUB.
 18301
 18302 4100-CHECK-LF-ERRORS.
 18303
 18304     ADD +1                       TO WS-SUB.
 18305
 18306     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18307        IF LF-COVERAGE-CANCELLED
 18308           GO TO 4100-LF-CANCEL-CONT
 18309        ELSE
 18310           GO TO 4100-UPDATE-LF-COVERAGE.
 18311
 18312     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18313                                   ER-2729 OR
 18314                                   ER-2730 OR
 18315                                   ER-2731 OR
 18316                                   ER-2732 OR
 18317                                   ER-2737 OR
 18318                                   ER-2740 OR
 18319                                   ER-2743 OR
 18320                                   ER-2749 OR
 18321                                   ER-2750 OR
 18322                                   ER-2755 OR
 18323                                   ER-2757 OR
 18324                                   ER-2760 OR
 18325                                   ER-2772 OR
 18326                                   ER-2774 OR
 18327                                   ER-2776 OR
 18328                                   ER-2794
 18329        GO TO 4100-UPDATE-LF-COVERAGE.
 18330
 18331     GO TO 4100-CHECK-LF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 332
* EL050.cbl
 18332
 18333 4100-UPDATE-LF-COVERAGE.
 18334
 18335     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18336     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18337     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18338        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18339     END-IF
 18340     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18341                                      TO CM-CREDIT-INTERFACE-SW-2.
 18342     IF CM-LF-CANCEL-DT = LOW-VALUE
 18343         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18344
 18345     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18346         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18347                                         CM-LF-STATUS-AT-CANCEL.
 18348
 18349     GO TO 4100-APPLY-AH-CANCEL.
 18350
 18351 4100-LF-CANCEL-CONT.
 18352     IF PB-C-LF-CANCEL-VOIDED
 18353         GO TO 4100-APPLY-AH-CANCEL.
 18354
 18355     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18356         GO TO 4100-APPLY-AH-CANCEL.
 18357
 18358     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18359        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18360           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18361        ELSE
 18362           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18363
 18364     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18365     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18366
 18367     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18368         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18369
 18370     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18371        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18372         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18373         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18374
 18375     IF PB-RECORD-RETURNED
 18376        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18377      ELSE
 18378        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18379
 18380 4100-APPLY-AH-CANCEL.
 18381
 18382     MOVE +0                      TO WS-SUB.
 18383
 18384 4100-CHECK-AH-ERRORS.
 18385
 18386     ADD +1                       TO WS-SUB.
 18387
 18388     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18389        IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 333
* EL050.cbl
 18390           GO TO 4100-AH-CANCEL-CONT
 18391        ELSE
 18392           GO TO 4100-UPDATE-AH-COVERAGE.
 18393
 18394     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18395                                   ER-2729 OR
 18396                                   ER-2732 OR
 18397                                   ER-2737 OR
 18398                                   ER-2740 OR
 18399                                   ER-2744 OR
 18400                                   ER-2749 OR
 18401                                   ER-2750 OR
 18402                                   ER-2755 OR
 18403                                   ER-2757 OR
 18404                                   ER-2760 OR
 18405                                   ER-2771 OR
 18406                                   ER-2772 OR
 18407                                   ER-2773 OR
 18408                                   ER-2775 OR
 18409                                   ER-2777 OR
 18410                                   ER-2778 OR
 18411                                   ER-2794
 18412        GO TO 4100-UPDATE-AH-COVERAGE.
 18413
 18414     GO TO 4100-CHECK-AH-ERRORS.
 18415
 18416 4100-UPDATE-AH-COVERAGE.
 18417
 18418     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18419     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18420     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18421     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18422                                      TO CM-CREDIT-INTERFACE-SW-2.
 18423     IF CM-AH-CANCEL-DT = LOW-VALUE
 18424         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18425
 18426     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18427         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18428                                         CM-AH-STATUS-AT-CANCEL.
 18429
 18430     IF LF-COVERAGE-CANCELLED
 18431         IF PB-RECORD-RETURNED
 18432              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18433          ELSE
 18434              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18435
 18436     GO TO 4299-EXIT.
 18437
 18438 4100-AH-CANCEL-CONT.
 18439     IF PB-C-AH-CANCEL-VOIDED
 18440         GO TO 4299-EXIT.
 18441
 18442     if cm-credit-interface-sw-2 = ' '
 18443        if pb-fatal-errors or pb-unforced-errors
 18444           move '4'              to cm-credit-interface-sw-2
 18445        else
 18446           move '1'              to cm-credit-interface-sw-2
 18447        end-if
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 334
* EL050.cbl
 18448     end-if
 18449     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18450         GO TO 4299-EXIT.
 18451
 18452     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18453        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18454           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18455        ELSE
 18456           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18457
 18458     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18459     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18460
 18461     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18462         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18463
 18464     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18465         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18466         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18467
 18468     IF PB-RECORD-RETURNED
 18469        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18470      ELSE
 18471        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18472
 18473     GO TO 4299-EXIT.
 18474
 18475 4150-SUMMARY-CERT-CANCEL.
 18476     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18477
 18478     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18479        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18480                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18481     ELSE
 18482        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18483                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18484
 18485     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18486        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18487                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18488     ELSE
 18489        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18490                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18491
 18492     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18493        NEXT SENTENCE
 18494     ELSE
 18495        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18496
 18497     GO TO 4299-EXIT.
 18498
 18499 4200-REVERSE-LF-CANCEL.
 18500     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18501
 18502     IF CM-LF-CANCEL-APPLIED
 18503        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18504        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18505        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 335
* EL050.cbl
 18506
 18507     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18508
 18509     IF PB-RECORD-RETURNED
 18510        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18511       ELSE
 18512        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18513
 18514 4200-REVERSE-LF-EXIT.
 18515       EXIT.
 18516
 18517 4200-REVERSE-AH-CANCEL.
 18518     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18519
 18520     IF CM-AH-CANCEL-APPLIED
 18521        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18522        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18523        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18524
 18525     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18526
 18527     IF PB-RECORD-RETURNED
 18528        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18529       ELSE
 18530        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18531
 18532 4200-REVERSE-AH-EXIT.
 18533       EXIT.
 18534
 18535 4299-EXIT.
 18536       EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 336
* EL050.cbl
 18538
 18539 4500-UPDATE-NEW-CERT.
 18540     IF CERT-WAS-FOUND
 18541         NEXT SENTENCE
 18542       ELSE
 18543         GO TO 4520-BUILD-NEW-KEY.
 18544
 18545     IF  CLASIC-CREATED-CERT
 18546         GO TO 4999-EXIT.
 18547
 18548     IF  CERT-WAS-CREATED-FOR-CLAIM
 18549         GO TO 4520-BUILD-NEW-KEY.
 18550
 18551     IF CERT-ADDED-BATCH
 18552        IF CM-RECORD-ID = 'CM'
 18553            GO TO 4999-EXIT.
 18554
 18555 4520-BUILD-NEW-KEY.
 18556* BUILD CONTROL PRIMARY
 18557
 18558     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18559                                       CM-COMPANY-CD-A1
 18560                                       CM-COMPANY-CD-A2
 18561                                       CM-COMPANY-CD-A4
 18562                                       CM-COMPANY-CD-A5.
 18563
 18564     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18565     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18566     MOVE PB-SV-STATE               TO CM-STATE.
 18567     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18568     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18569     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18570     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18571
 18572     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18573
 18574     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18575     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18576     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18577     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18578
 18579     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18580        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18581
 18582     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18583         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18584         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18585         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18586         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18587     ELSE
 18588         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18589
 18590     IF PB-COMPANY-ID   EQUAL  'CRI'
 18591         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18592         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18593         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18594         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18595         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 337
* EL050.cbl
 18596
 18597     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18598        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18599         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18600
 18601     IF PB-COMPANY-ID  = 'LBL'
 18602        IF PB-I-JOINT-COVERAGE
 18603            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18604                                           PB-I-MEMBER-NO
 18605            GO TO 4550-CONT-CERT-PROCESS.
 18606
 18607     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18608        NEXT SENTENCE
 18609     ELSE
 18610        GO TO 4540-BUILD-MEMBER-NO.
 18611
 18612******************************************************************
 18613*                                                                *
 18614*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18615*    FOR 'MON'.                                                  *
 18616*                                                                *
 18617******************************************************************
 18618
 18619     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18620     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18621     MOVE +1                     TO WS-SUB1
 18622                                    WS-SUB2.
 18623
 18624 4530-EDIT-MEMB-NAME.
 18625
 18626     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18627        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18628        ADD +1                       TO WS-SUB2.
 18629
 18630     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18631        ADD +1                       TO WS-SUB1
 18632        GO TO 4530-EDIT-MEMB-NAME.
 18633
 18634     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18635     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18636     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18637*    MOVE SPACE                      TO DC-OPTION-CODE.
 18638     SET  BIN-TO-GREG                TO TRUE.
 18639     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18640     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18641
 18642     GO TO 4550-CONT-CERT-PROCESS.
 18643
 18644******************************************************************
 18645*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18646******************************************************************
 18647
 18648 4540-BUILD-MEMBER-NO.
 18649
 18650     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18651         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18652         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18653         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 338
* EL050.cbl
 18654         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18655     ELSE
 18656         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18657
 18658     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18659        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18660         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18661
 18662 4550-CONT-CERT-PROCESS.
 18663
 18664*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18665*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18666*    ELSE
 18667*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18668
 18669     IF CERT-WAS-CREATED-FOR-CLAIM
 18670        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18671        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18672
 18673     IF CERT-AND-CLAIM-ONLINE
 18674        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18675        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18676
 18677     MOVE 'CM'                     TO CM-RECORD-ID.
 18678     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18679
 18680     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18681        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18682        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18683     ELSE
 18684        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18685        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18686
 18687     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18688     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18689     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18690     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18691     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18692     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18693     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18694                                      CM-LF-ITD-CANCEL-AMT
 18695                                      CM-LF-ITD-DEATH-AMT
 18696                                      CM-AH-ITD-AH-PMT
 18697                                      CM-AH-ITD-LUMP-PMT
 18698                                      CM-AH-ITD-CANCEL-AMT
 18699                                      CM-LF-NSP-PREMIUM-AMT
 18700                                      CM-AH-NSP-PREMIUM-AMT.
 18701*                                     CM-CLAIM-DEDUCT-WITHHELD
 18702*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18703     if pb-i-loan-apr = +99.9999
 18704        move zeros                 to cm-loan-apr
 18705     else
 18706        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18707     end-if
 18708     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18709     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18710     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18711     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 339
* EL050.cbl
 18712     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18713     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18714     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18715     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18716     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18717     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18718     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18719
 18720     IF PB-I-LIVES NOT NUMERIC
 18721         MOVE ZERO                 TO PB-I-LIVES.
 18722
 18723     IF PB-I-NUM-BILLED NOT NUMERIC
 18724         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18725
 18726     MOVE PB-I-LIVES               TO CM-LIVES.
 18727     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18728
 18729     IF PB-COMPANY-ID EQUAL  'DMD'
 18730         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18731         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18732
 18733     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18734     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18735     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18736     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18737     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18738     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18739
 18740     IF PB-I-LF-POLICY-FEE NUMERIC
 18741        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18742     ELSE
 18743        MOVE +0                    TO CM-LF-POLICY-FEE.
 18744
 18745     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18746        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18747        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18748     ELSE
 18749        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18750
 18751     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18752     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18753     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18754     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18755     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18756     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18757     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18758     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18759     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18760
 18761     IF PB-I-CANCEL-FEE NUMERIC
 18762        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18763     ELSE
 18764        MOVE +0                  TO CM-CANCEL-FEE
 18765     END-IF
 18766
 18767     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18768        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18769     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 340
* EL050.cbl
 18770        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18771
 18772     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18773     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18774
 18775     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18776                                      CM-LF-DEATH-EXIT-DT
 18777                                      CM-AH-SETTLEMENT-EXIT-DT.
 18778
 18779*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18780*                       'TIH' OR 'OFL' OR 'FLA' OR
 18781*                       'TII' OR 'TMS' OR 'CRI' OR
 18782*                       'NCL'
 18783     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18784
 18785     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18786         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18787            MOVE '2'                TO CM-PREMIUM-TYPE.
 18788
 18789     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18790         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18791            MOVE '2'                TO CM-PREMIUM-TYPE.
 18792
 18793     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18794         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18795     ELSE
 18796         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18797         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18798
 18799     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18800     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18801     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18802     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18803     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18804     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18805     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18806     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18807
 18808     IF PB-NO-MONTHS-SKIPPED
 18809         MOVE SPACE                 TO CM-SKIP-CODE
 18810     ELSE
 18811         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18812
 18813     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18814     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18815                                       CM-LF-STATUS-AT-CANCEL.
 18816
 18817     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18818     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18819                                       CM-AH-STATUS-AT-CANCEL.
 18820
 18821     MOVE '1'                       TO CM-ENTRY-STATUS.
 18822
 18823     IF PB-REISSUED-CERT
 18824        MOVE '5'                    TO CM-ENTRY-STATUS.
 18825
 18826     IF PB-MONTHLY-CERT
 18827        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 341
* EL050.cbl
 18828
 18829     IF PB-CASH-CERT
 18830        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18831
 18832     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18833     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18834     IF PB-POLICY-IS-DECLINED
 18835        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18836
 18837     IF PB-POLICY-IS-VOIDED
 18838        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18839
 18840     IF PB-NEEDS-UNDERWRITING
 18841        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18842
 18843     IF PB-REIN-ONLY-CERT
 18844        MOVE '9'                    TO CM-ENTRY-STATUS.
 18845
 18846     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18847         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18848     ELSE
 18849         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18850
 18851     IF PB-RECORD-RETURNED
 18852        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18853      ELSE
 18854        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18855
 18856     IF PB-I-MAIL-ADDRS-PRESENT
 18857        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18858
 18859     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18860                                       CM-ENTRY-DT.
 18861
 18862 4999-EXIT.
 18863     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 342
* EL050.cbl
 18865
 18866 5000-PROCESS-REPS.
 18867     MOVE ' '                    TO AGTC-MASTER-SW
 18868     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18869     MOVE CO-TYPE                TO AGTC-TYPE
 18870     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18871     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18872     IF (AGTC-MASTER-SW NOT = 'N')
 18873        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18874        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18875        PERFORM 8583-READ-ERAGTC-NEXT
 18876                                 THRU 8583-EXIT
 18877     END-IF
 18878     IF AGTC-MASTER-SW = 'N'
 18879        CONTINUE
 18880     ELSE
 18881        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18882           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18883              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18884              MOVE 'Y'           TO AGTC-MASTER-SW
 18885           END-IF
 18886        END-IF
 18887     END-IF
 18888     .
 18889 5000-EXIT.
 18890     EXIT.
 18891 6370-EDIT-INPUT-LF-CODE.
 18892     move ' ' to ws-benefit-cd-chg-sw
 18893     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18894        MOVE +1                  TO SUB
 18895        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18896        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18897        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18898        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18899        GO TO 6370-SEARCH-LOOP.
 18900
 18901     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18902
 18903     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18904     MOVE SPACES                 TO CNTL-ACCESS.
 18905*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18906     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18907     MOVE +0                     TO CNTL-SEQ-NO.
 18908     MOVE '4' TO RC-SW-2.
 18909     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18910
 18911     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18912        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18913        GO TO 6370-NO-LF-FOUND.
 18914
 18915     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18916     MOVE +1                     TO SUB.
 18917
 18918 6370-SEARCH-LOOP.
 18919     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18920         GO TO 6370-NO-LF-FOUND.
 18921
 18922     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 343
* EL050.cbl
 18923        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18924           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18925           set benefit-code-chg to true
 18926        end-if
 18927        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18928        GO TO 6370-HER-NET-PAY-CHECK.
 18929
 18930     ADD 1   TO SUB.
 18931*    IF SUB GREATER 120
 18932     IF SUB GREATER 200
 18933         GO TO 6370-NO-LF-FOUND.
 18934
 18935     GO TO 6370-SEARCH-LOOP.
 18936
 18937 6370-NO-LF-FOUND.
 18938
 18939     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18940        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18941        set benefit-code-chg to true
 18942     end-if
 18943     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18944
 18945 6370-HER-NET-PAY-CHECK.
 18946
 18947     IF PB-COMPANY-ID = 'CID'
 18948        IF PB-SV-STATE = 'CA' OR 'MN'
 18949           IF PB-I-LF-BENEFIT-CD = '02'
 18950              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18951           ELSE
 18952              IF PB-I-LF-BENEFIT-CD = '04'
 18953                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18954              END-IF
 18955           END-IF
 18956        END-IF
 18957     END-IF
 18958
 18959     IF PB-COMPANY-ID NOT = 'HER'
 18960         GO TO 6370-EXIT.
 18961
 18962     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18963         GO TO 6370-EXIT.
 18964
 18965     IF PB-I-LF-TERM NOT NUMERIC
 18966         MOVE ZEROS              TO PB-I-LF-TERM.
 18967
 18968     IF PB-I-LOAN-TERM NOT NUMERIC
 18969         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18970
 18971     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18972         GO TO 6370-EXIT.
 18973
 18974     IF PB-I-LF-BENEFIT-CD = '33'
 18975         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18976
 18977     IF PB-I-LF-BENEFIT-CD = '34'
 18978         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18979
 18980 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 344
* EL050.cbl
 18981     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 345
* EL050.cbl
 18983
 18984 6380-EDIT-INPUT-AH-CODE.
 18985     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18986        MOVE +1                  TO SUB
 18987        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18988        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18989        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18990        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18991        GO TO 6380-SEARCH-LOOP.
 18992
 18993     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18994
 18995     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18996     MOVE SPACES                 TO CNTL-ACCESS.
 18997     MOVE 'A'                    TO CNTL-REC-TYPE.
 18998*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18999     MOVE +0                     TO CNTL-SEQ-NO.
 19000     MOVE '5' TO RC-SW-2.
 19001     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 19002
 19003     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 19004        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 19005        GO TO 6380-NO-AH-FOUND.
 19006
 19007     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 19008     MOVE +1 TO SUB.
 19009
 19010 6380-SEARCH-LOOP.
 19011     IF CF-AH-CODE-OUT (SUB) = ZEROS
 19012         GO TO 6380-NO-AH-FOUND.
 19013
 19014     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 19015         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 19016         GO TO 6380-CSO-AH-ONLY-CHECKS.
 19017
 19018     ADD 1   TO SUB.
 19019     IF SUB GREATER THAN 96
 19020*    IF SUB GREATER THAN 300
 19021         GO TO 6380-NO-AH-FOUND.
 19022
 19023     GO TO 6380-SEARCH-LOOP.
 19024
 19025 6380-NO-AH-FOUND.
 19026
 19027     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 19028
 19029     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 19030         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 19031     ELSE
 19032         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 19033
 19034 6380-CSO-AH-ONLY-CHECKS.
 19035
 19036     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 19037        NEXT SENTENCE
 19038      ELSE
 19039        GO TO 6380-EXIT.
 19040
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 346
* EL050.cbl
 19041     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 19042         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 19043
 19044
 19045     GO TO 6380-EXIT
 19046     .
 19047 6380-CSO-LIFE-WITH-AH-CHECKS.
 19048
 19049
 19050     .
 19051 6380-EXIT.
 19052     EXIT.
 19053
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 347
* EL050.cbl
 19055
 19056 6400-COMPUTE-EXTENSION-DAYS.
 19057
 19058******************************************************************
 19059*                                                                *
 19060*                   COMPUTE EXTENSION DAYS                       *
 19061*                                                                *
 19062*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 19063*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 19064*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 19065*    THE EXTENSION DAYS.                                         *
 19066*                                                                *
 19067******************************************************************
 19068
 19069     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 19070     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 19071
 19072******************************************************************
 19073*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 19074*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 19075******************************************************************
 19076
 19077     IF DC-ELAPSED-MONTHS GREATER THAN +0
 19078        COMPUTE WS-ODD-DAYS-OVER =
 19079               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 19080     ELSE
 19081        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 19082
 19083     IF WS-ODD-DAYS-OVER = ZEROS
 19084           GO TO 6499-EXIT
 19085     ELSE
 19086        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 19087           IF WS-WDF-MONTH = 02
 19088              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 19089              ADD 2       TO  WS-ODD-DAYS-OVER
 19090              GO TO 6499-EXIT
 19091           ELSE
 19092              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 19093                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 19094                 GO TO 6499-EXIT
 19095               ELSE
 19096                 GO TO 6499-EXIT
 19097        ELSE
 19098           GO TO 6499-EXIT.
 19099
 19100 6412-CHECK-TO-DAY.
 19101
 19102        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 19103           IF WS-WDT-DAY = 28
 19104              ADD 2              TO WS-ODD-DAYS-OVER
 19105           ELSE
 19106              IF WS-WDT-DAY = 29
 19107                 ADD 1           TO WS-ODD-DAYS-OVER
 19108              ELSE
 19109                 NEXT SENTENCE
 19110        ELSE
 19111           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 19112              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 348
* EL050.cbl
 19113
 19114     GO TO 6499-EXIT.
 19115
 19116
 19117 6415-CHECK-LEAP-YEAR.
 19118
 19119     IF DC-DAYS-IN-MONTH = 29
 19120        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 19121
 19122 6415-EXIT.
 19123     EXIT.
 19124
 19125 6499-EXIT.
 19126      EXIT.
 19127
 19128 6500-END.
 19129     EXIT.
 19130
 19131
 19132******************************************************************
 19133************* PROCEDURE DIVISION FOR EL050 ***********************
 19134********************** ELC50PD END *******************************
 19135
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 349
* EL050.cbl
 19137
 19138**START***********************************************************
 19139*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 19140*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 19141******************************************************************
 19142*
 19143 6600-GET-STATE-MUNICIPAL-TAX.
 19144
 19145     IF PB-COMPANY-ID NOT = 'DMD'
 19146         GO TO 6640-EXIT.
 19147
 19148     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19149     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19150     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19151*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19152*
 19153***  Y2K PROJ 7744
 19154     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19155     SET BIN-TO-GREG          TO TRUE.
 19156     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19157
 19158     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19159
 19160     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19161     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 19162
 19163
 19164* EXEC CICS HANDLE CONDITION
 19165*        INVREQ    (6610-START-BROWSE)
 19166*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19167*        NOTFND    (6630-END-OF-FILE)
 19168*    END-EXEC.
 19169*    MOVE '"$8JI                 ! # #00019153' TO DFHEIV0
 19170     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 19171     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19172     MOVE X'2320233030303139313533' TO DFHEIV0(25:11)
 19173     CALL 'kxdfhei1' USING DFHEIV0
 19174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19175
 19176
 19177 6610-START-BROWSE.
 19178
 19179
 19180* EXEC CICS HANDLE CONDITION
 19181*        NOTFND    (6630-END-OF-FILE)
 19182*        DISABLED  (6630-ERRESS-PROBLEM)
 19183*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19184*        ENDFILE   (6630-END-OF-FILE)
 19185*    END-EXEC.
 19186*    MOVE '"$IcJ''                ! $ #00019161' TO DFHEIV0
 19187     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19189     MOVE X'2420233030303139313631' TO DFHEIV0(25:11)
 19190     CALL 'kxdfhei1' USING DFHEIV0
 19191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19192
 19193
 19194
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 350
* EL050.cbl
 19195* EXEC CICS STARTBR
 19196*        DATASET (FILE-ID-ERRESS)
 19197*        RIDFLD  (WS-ERRESS-KEY)
 19198*        GTEQ
 19199*    END-EXEC.
 19200     MOVE 0
 19201       TO DFHEIV11
 19202*    MOVE '&,         G          &   #00019168' TO DFHEIV0
 19203     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19204     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19205     MOVE X'2020233030303139313638' TO DFHEIV0(25:11)
 19206     CALL 'kxdfhei1' USING DFHEIV0,
 19207           FILE-ID-ERRESS,
 19208           WS-ERRESS-KEY,
 19209           DFHEIV99,
 19210           DFHEIV11,
 19211           DFHEIV99
 19212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19213
 19214
 19215 6620-READ-NEXT-ERRESS-MASTER.
 19216
 19217
 19218* EXEC CICS HANDLE CONDITION
 19219*        NOTFND    (6630-END-OF-FILE)
 19220*        ENDFILE   (6630-END-OF-FILE)
 19221*        DISABLED  (6630-ERRESS-PROBLEM)
 19222*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19223*    END-EXEC.
 19224*    MOVE '"$I''cJ                ! % #00019176' TO DFHEIV0
 19225     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19227     MOVE X'2520233030303139313736' TO DFHEIV0(25:11)
 19228     CALL 'kxdfhei1' USING DFHEIV0
 19229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19230
 19231
 19232
 19233* EXEC CICS READNEXT
 19234*        DATASET (FILE-ID-ERRESS)
 19235*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19236*        RIDFLD  (WS-ERRESS-KEY)
 19237*    END-EXEC.
 19238     MOVE LENGTH OF
 19239      RESIDENT-STATE-TAX-MASTER
 19240       TO DFHEIV12
 19241     MOVE 0
 19242       TO DFHEIV11
 19243*    MOVE '&.IL                  )   #00019183' TO DFHEIV0
 19244     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19245     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19246     MOVE X'2020233030303139313833' TO DFHEIV0(25:11)
 19247     CALL 'kxdfhei1' USING DFHEIV0,
 19248           FILE-ID-ERRESS,
 19249           RESIDENT-STATE-TAX-MASTER,
 19250           DFHEIV12,
 19251           WS-ERRESS-KEY,
 19252           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 351
* EL050.cbl
 19253           DFHEIV11,
 19254           DFHEIV99,
 19255           DFHEIV99
 19256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19257
 19258
 19259     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19260
 19261* EXEC CICS ENDBR
 19262*            DATASET (FILE-ID-ERRESS)
 19263*       END-EXEC
 19264     MOVE 0
 19265       TO DFHEIV11
 19266*    MOVE '&2                    $   #00019190' TO DFHEIV0
 19267     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19268     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19269     MOVE X'2020233030303139313930' TO DFHEIV0(25:11)
 19270     CALL 'kxdfhei1' USING DFHEIV0,
 19271           FILE-ID-ERRESS,
 19272           DFHEIV11,
 19273           DFHEIV99
 19274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19275        GO TO 6630-END-OF-FILE.
 19276
 19277     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19278        NEXT SENTENCE
 19279      ELSE
 19280        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19281
 19282*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19283*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19284*
 19285     MOVE +2                     TO WS-SUB1.
 19286
 19287     IF PB-ISSUE
 19288     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19289        MOVE +1                  TO WS-SUB1.
 19290
 19291     IF PB-CANCELLATION
 19292     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19293        MOVE +1                  TO WS-SUB1.
 19294*
 19295*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19296*
 19297***  Y2K PROJ 7744
 19298     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19299***  Y2K PROJ 7744
 19300
 19301*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19302* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19303* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19304
 19305     ADD 1                    TO WS-YEAR-YY.
 19306
 19307     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19308         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19309                              TO WS-RES-STATE-TAX
 19310         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 352
* EL050.cbl
 19311                              TO WS-RES-MUNI-TAX
 19312     ELSE
 19313         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19314                              TO WS-RES-STATE-TAX
 19315         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19316                              TO WS-RES-MUNI-TAX.
 19317
 19318*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19319
 19320     IF PB-CANCELLATION
 19321         GO TO 6640-CANCEL-TAX.
 19322
 19323     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19324         COMPUTE PB-I-STATE-TAX ROUNDED =
 19325                                   PB-I-LF-PREMIUM-AMT
 19326                                 * WS-RES-STATE-TAX
 19327         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19328                                   PB-I-LF-PREMIUM-AMT
 19329                                 * WS-RES-MUNI-TAX
 19330     ELSE
 19331     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19332         COMPUTE PB-I-STATE-TAX ROUNDED =
 19333                                   PB-I-AH-PREMIUM-AMT
 19334                                 * WS-RES-STATE-TAX
 19335         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19336                                   PB-I-AH-PREMIUM-AMT
 19337                                 * WS-RES-MUNI-TAX.
 19338
 19339
 19340* EXEC CICS ENDBR
 19341*         DATASET (FILE-ID-ERRESS)
 19342*    END-EXEC.
 19343     MOVE 0
 19344       TO DFHEIV11
 19345*    MOVE '&2                    $   #00019257' TO DFHEIV0
 19346     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19347     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19348     MOVE X'2020233030303139323537' TO DFHEIV0(25:11)
 19349     CALL 'kxdfhei1' USING DFHEIV0,
 19350           FILE-ID-ERRESS,
 19351           DFHEIV11,
 19352           DFHEIV99
 19353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19354
 19355
 19356     GO TO 6640-EXIT.
 19357
 19358 6640-CANCEL-TAX.
 19359     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19360
 19361     IF PB-C-LF-CANCEL-AMT > ZEROS
 19362         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19363                                   PB-C-LF-CANCEL-AMT
 19364                                 * WS-RES-STATE-TAX
 19365         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19366                                   PB-C-LF-CANCEL-AMT
 19367                                *  WS-RES-MUNI-TAX
 19368     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 353
* EL050.cbl
 19369     IF PB-C-AH-CANCEL-AMT > ZEROS
 19370         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19371                                   PB-C-AH-CANCEL-AMT
 19372                                 * WS-RES-STATE-TAX
 19373         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19374                                   PB-C-AH-CANCEL-AMT
 19375                                *  WS-RES-MUNI-TAX.
 19376
 19377
 19378* EXEC CICS ENDBR
 19379*         DATASET (FILE-ID-ERRESS)
 19380*    END-EXEC.
 19381     MOVE 0
 19382       TO DFHEIV11
 19383*    MOVE '&2                    $   #00019282' TO DFHEIV0
 19384     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19385     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19386     MOVE X'2020233030303139323832' TO DFHEIV0(25:11)
 19387     CALL 'kxdfhei1' USING DFHEIV0,
 19388           FILE-ID-ERRESS,
 19389           DFHEIV11,
 19390           DFHEIV99
 19391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19392
 19393
 19394     GO TO 6640-EXIT.
 19395
 19396 6630-END-OF-FILE.
 19397     MOVE ER-8002              TO WS-ERROR.
 19398     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19399
 19400     GO TO 6640-EXIT.
 19401
 19402 6630-ERRESS-PROBLEM.
 19403     MOVE ER-8044              TO WS-ERROR.
 19404     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19405
 19406 6640-EXIT.
 19407     EXIT.
 19408
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 354
* EL050.cbl
 19410 6650-GET-RES-STATE-COMM.
 19411
 19412     IF PB-COMPANY-ID NOT = 'DMD'
 19413         GO TO 6700-COMM-EXIT.
 19414
 19415     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19416     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19417     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19418     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19419     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19420     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19421     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19422
 19423*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19424*
 19425***  Y2K PROJ 7744
 19426     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19427     SET BIN-TO-GREG          TO TRUE.
 19428     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19429
 19430     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19431***  Y2K PROJ 7744
 19432
 19433     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19434
 19435
 19436* EXEC CICS HANDLE CONDITION
 19437*        INVREQ    (6660-START-BROWSE)
 19438*        DISABLED  (6690-ERRESC-PROBLEM)
 19439*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19440*        NOTFND    (6690-END-OF-FILE)
 19441*    END-EXEC.
 19442*    MOVE '"$8cJI                ! & #00019327' TO DFHEIV0
 19443     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19445     MOVE X'2620233030303139333237' TO DFHEIV0(25:11)
 19446     CALL 'kxdfhei1' USING DFHEIV0
 19447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19448
 19449
 19450
 19451* EXEC CICS RESETBR
 19452*        DATASET (FILE-ID-ERRESC)
 19453*        RIDFLD  (WS-ERRESC-KEY)
 19454*    END-EXEC.
 19455     MOVE 0
 19456       TO DFHEIV11
 19457*    MOVE '&4         G          &   #00019334' TO DFHEIV0
 19458     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19459     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19460     MOVE X'2020233030303139333334' TO DFHEIV0(25:11)
 19461     CALL 'kxdfhei1' USING DFHEIV0,
 19462           FILE-ID-ERRESC,
 19463           WS-ERRESC-KEY,
 19464           DFHEIV99,
 19465           DFHEIV11,
 19466           DFHEIV99
 19467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 355
* EL050.cbl
 19468
 19469
 19470 6660-START-BROWSE.
 19471
 19472
 19473* EXEC CICS HANDLE CONDITION
 19474*        NOTFND    (6690-END-OF-FILE)
 19475*        DISABLED  (6690-ERRESC-PROBLEM)
 19476*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19477*        ENDFILE   (6690-END-OF-FILE)
 19478*    END-EXEC.
 19479*    MOVE '"$IcJ''                ! '' #00019341' TO DFHEIV0
 19480     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19482     MOVE X'2720233030303139333431' TO DFHEIV0(25:11)
 19483     CALL 'kxdfhei1' USING DFHEIV0
 19484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19485
 19486
 19487
 19488* EXEC CICS STARTBR
 19489*        DATASET (FILE-ID-ERRESC)
 19490*        RIDFLD  (WS-ERRESC-KEY)
 19491*        GTEQ
 19492*    END-EXEC.
 19493     MOVE 0
 19494       TO DFHEIV11
 19495*    MOVE '&,         G          &   #00019348' TO DFHEIV0
 19496     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19497     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19498     MOVE X'2020233030303139333438' TO DFHEIV0(25:11)
 19499     CALL 'kxdfhei1' USING DFHEIV0,
 19500           FILE-ID-ERRESC,
 19501           WS-ERRESC-KEY,
 19502           DFHEIV99,
 19503           DFHEIV11,
 19504           DFHEIV99
 19505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19506
 19507
 19508     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19509
 19510 6670-READ-NEXT-ERRESC-MASTER.
 19511
 19512
 19513* EXEC CICS HANDLE CONDITION
 19514*        NOTFND    (6690-END-OF-FILE)
 19515*        DISABLED  (6690-ERRESC-PROBLEM)
 19516*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19517*        ENDFILE   (6690-END-OF-FILE)
 19518*    END-EXEC.
 19519*    MOVE '"$IcJ''                ! ( #00019358' TO DFHEIV0
 19520     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19522     MOVE X'2820233030303139333538' TO DFHEIV0(25:11)
 19523     CALL 'kxdfhei1' USING DFHEIV0
 19524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19525
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 356
* EL050.cbl
 19526
 19527
 19528* EXEC CICS READNEXT
 19529*        DATASET (FILE-ID-ERRESC)
 19530*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19531*        RIDFLD  (ERRESC-RECORD-KEY)
 19532*    END-EXEC.
 19533     MOVE LENGTH OF
 19534      ACCOUNT-RESIDENT-ST-COMMISSION
 19535       TO DFHEIV12
 19536     MOVE 0
 19537       TO DFHEIV11
 19538*    MOVE '&.IL                  )   #00019365' TO DFHEIV0
 19539     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19540     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19541     MOVE X'2020233030303139333635' TO DFHEIV0(25:11)
 19542     CALL 'kxdfhei1' USING DFHEIV0,
 19543           FILE-ID-ERRESC,
 19544           ACCOUNT-RESIDENT-ST-COMMISSION,
 19545           DFHEIV12,
 19546           ERRESC-RECORD-KEY,
 19547           DFHEIV99,
 19548           DFHEIV11,
 19549           DFHEIV99,
 19550           DFHEIV99
 19551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19552
 19553
 19554     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19555        NEXT SENTENCE
 19556     ELSE
 19557
 19558* EXEC CICS ENDBR
 19559*            DATASET (FILE-ID-ERRESC)
 19560*       END-EXEC
 19561     MOVE 0
 19562       TO DFHEIV11
 19563*    MOVE '&2                    $   #00019374' TO DFHEIV0
 19564     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19565     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19566     MOVE X'2020233030303139333734' TO DFHEIV0(25:11)
 19567     CALL 'kxdfhei1' USING DFHEIV0,
 19568           FILE-ID-ERRESC,
 19569           DFHEIV11,
 19570           DFHEIV99
 19571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19572        GO TO 6690-END-OF-FILE.
 19573
 19574     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19575
 19576* EXEC CICS ENDBR
 19577*            DATASET (FILE-ID-ERRESC)
 19578*       END-EXEC
 19579     MOVE 0
 19580       TO DFHEIV11
 19581*    MOVE '&2                    $   #00019380' TO DFHEIV0
 19582     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19583     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 357
* EL050.cbl
 19584     MOVE X'2020233030303139333830' TO DFHEIV0(25:11)
 19585     CALL 'kxdfhei1' USING DFHEIV0,
 19586           FILE-ID-ERRESC,
 19587           DFHEIV11,
 19588           DFHEIV99
 19589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19590        GO TO 6690-END-OF-FILE.
 19591
 19592     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19593        NEXT SENTENCE
 19594      ELSE
 19595        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19596
 19597* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19598*
 19599     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19600
 19601     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19602
 19603     IF WS-SUB1 > ZERO
 19604         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19605             PERFORM 6680-SET-COMMISSION
 19606         ELSE
 19607             PERFORM 6680-SET-TABLE-CODE.
 19608
 19609
 19610* EXEC CICS ENDBR
 19611*         DATASET (FILE-ID-ERRESC)
 19612*    END-EXEC.
 19613     MOVE 0
 19614       TO DFHEIV11
 19615*    MOVE '&2                    $   #00019402' TO DFHEIV0
 19616     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19617     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19618     MOVE X'2020233030303139343032' TO DFHEIV0(25:11)
 19619     CALL 'kxdfhei1' USING DFHEIV0,
 19620           FILE-ID-ERRESC,
 19621           DFHEIV11,
 19622           DFHEIV99
 19623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19624
 19625
 19626     GO TO 6700-COMM-EXIT.
 19627
 19628 6680-SET-TABLE-CODE.
 19629     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19630        MOVE ZEROS             TO WS-SUB1
 19631     ELSE
 19632* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19633* TO COMPUTE AH COMMISSION.
 19634        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19635        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19636        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19637        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19638        PERFORM 6680-READ-CTBL-TABLE
 19639        IF WS-CTBL-READ-SW NOT = 'Y'
 19640           MOVE ZEROS          TO WS-SUB1.
 19641
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 358
* EL050.cbl
 19642 6680-READ-CTBL-TABLE.
 19643*
 19644* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19645* TO COMPUTE LIFE COMMISSION
 19646
 19647     IF CTBL-SW = '0540'
 19648        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19649        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19650        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19651
 19652     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19653
 19654     IF CTBL-TABLE-FOUND
 19655        IF CTBL-SW = '0530'
 19656             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19657                                    * PB-I-AH-TERM
 19658             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19659             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19660        ELSE
 19661             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19662             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19663             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19664     ELSE
 19665        IF FIRST-TIME-THROUGH
 19666            GO TO 6680-READ-CTBL-TABLE
 19667        ELSE
 19668            MOVE ZEROS         TO WS-SUB1.
 19669
 19670 6680-SET-COMMISSION.
 19671     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19672           MOVE ZEROS          TO WS-SUB1
 19673       ELSE
 19674           MOVE RESC-COMMISSION-PER (WS-SUB)
 19675                               TO WS-COMMISSION
 19676           IF CTBL-SW = '0530'
 19677               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19678           ELSE
 19679               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19680
 19681 6680-SEARCH-CATEGORY.
 19682     ADD +1                   TO WS-SUB.
 19683     IF WS-SUB > +12
 19684         GO TO 6680-EXIT.
 19685
 19686     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19687          MOVE WS-SUB         TO WS-SUB1
 19688          GO TO 6680-EXIT.
 19689
 19690     GO TO 6680-SEARCH-CATEGORY.
 19691
 19692 6680-EXIT.
 19693     EXIT.
 19694
 19695 6690-END-OF-FILE.
 19696     GO TO 6700-COMM-EXIT.
 19697
 19698 6690-ERRESC-PROBLEM.
 19699      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 359
* EL050.cbl
 19700      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19701
 19702      GO TO 6700-COMM-EXIT.
 19703
 19704 6700-COMM-EXIT.
 19705     EXIT.
 19706
 19707 7000-GET-RATE.
 19708
 19709* EXEC CICS LINK
 19710*        PROGRAM    ('ELRATE')
 19711*        COMMAREA   (CALCULATION-PASS-AREA)
 19712*        LENGTH     (CP-COMM-LENGTH)
 19713*    END-EXEC.
 19714     MOVE 'ELRATE' TO DFHEIV1
 19715*    MOVE '."C                   (   #00019488' TO DFHEIV0
 19716     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19718     MOVE X'2020233030303139343838' TO DFHEIV0(25:11)
 19719     CALL 'kxdfhei1' USING DFHEIV0,
 19720           DFHEIV1,
 19721           CALCULATION-PASS-AREA,
 19722           CP-COMM-LENGTH,
 19723           DFHEIV99,
 19724           DFHEIV99,
 19725           DFHEIV99,
 19726           DFHEIV99
 19727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19728
 19729
 19730 7000-EXIT.
 19731     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 360
* EL050.cbl
 19733 7100-FIND-BENEFIT-IN-STATE.
 19734     MOVE 'N'                    TO BEN-SEARCH-SW.
 19735
 19736     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19737         VARYING SUB3 FROM 1 BY 1 UNTIL
 19738            ((SUB3 GREATER 50) OR
 19739              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19740               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19741
 19742     IF SUB3 NOT = 51
 19743         MOVE 'Y'                TO BEN-SEARCH-SW.
 19744
 19745     GO TO 7199-EXIT.
 19746
 19747 7100-BENEFIT-DUMMY.
 19748
 19749 7100-DUMMY-EXIT.
 19750     EXIT.
 19751
 19752 7199-EXIT.
 19753     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 361
* EL050.cbl
 19755 7200-FIND-BENEFIT.
 19756     MOVE 'N'                    TO BEN-SEARCH-SW.
 19757
 19758     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19759         VARYING SUB3 FROM 1 BY 1 UNTIL
 19760            ((SUB3 GREATER 8) OR
 19761            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19762
 19763     IF SUB3 NOT = 9
 19764         MOVE 'Y'                TO BEN-SEARCH-SW.
 19765
 19766     GO TO 7200-EXIT.
 19767
 19768 7200-BENEFIT-DUMMY.
 19769
 19770 7200-DUMMY-EXIT.
 19771     EXIT.
 19772
 19773 7200-EXIT.
 19774     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 362
* EL050.cbl
 19776 7250-LOOK-FOR-RESCINDED-CLAIM.
 19777     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19778                                    W-CL-COMP-CD.
 19779     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19780                                    W-CL-CERT-NO.
 19781
 19782
 19783* EXEC CICS HANDLE CONDITION
 19784*        NOTFND  (7250-CONTINUE)
 19785*        ENDFILE (7250-CONTINUE)
 19786*    END-EXEC.
 19787*    MOVE '"$I''                  ! ) #00019546' TO DFHEIV0
 19788     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19790     MOVE X'2920233030303139353436' TO DFHEIV0(25:11)
 19791     CALL 'kxdfhei1' USING DFHEIV0
 19792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19793
 19794
 19795
 19796* EXEC CICS IGNORE CONDITION
 19797*        DUPKEY
 19798*    END-EXEC.
 19799*    MOVE '"*$                   !   #00019551' TO DFHEIV0
 19800     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19802     MOVE X'2020233030303139353531' TO DFHEIV0(25:11)
 19803     CALL 'kxdfhei1' USING DFHEIV0
 19804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19805
 19806
 19807
 19808* EXEC CICS STARTBR
 19809*        DATASET   (CLMS-ID)
 19810*        RIDFLD    (ELMSTR-KEY)
 19811*        GENERIC   EQUAL
 19812*        KEYLENGTH (ELMSTR-LENGTH)
 19813*    END-EXEC.
 19814     MOVE 0
 19815       TO DFHEIV11
 19816*    MOVE '&,   KG    E          &   #00019555' TO DFHEIV0
 19817     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19818     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19819     MOVE X'2020233030303139353535' TO DFHEIV0(25:11)
 19820     CALL 'kxdfhei1' USING DFHEIV0,
 19821           CLMS-ID,
 19822           ELMSTR-KEY,
 19823           ELMSTR-LENGTH,
 19824           DFHEIV11,
 19825           DFHEIV99
 19826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19827
 19828
 19829     MOVE 'Y'                    TO W-BROWSE-SW.
 19830
 19831 7250-NEXT-CLAIM.
 19832
 19833
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 363
* EL050.cbl
 19834* EXEC CICS READNEXT
 19835*        DATASET   (CLMS-ID)
 19836*        RIDFLD    (ELMSTR-KEY)
 19837*        SET       (ADDRESS OF CLAIM-MASTER)
 19838*    END-EXEC.
 19839     MOVE 0
 19840       TO DFHEIV11
 19841*    MOVE '&.S                   )   #00019566' TO DFHEIV0
 19842     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19843     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19844     MOVE X'2020233030303139353636' TO DFHEIV0(25:11)
 19845     CALL 'kxdfhei1' USING DFHEIV0,
 19846           CLMS-ID,
 19847           DFHEIV20,
 19848           DFHEIV99,
 19849           ELMSTR-KEY,
 19850           DFHEIV99,
 19851           DFHEIV11,
 19852           DFHEIV99,
 19853           DFHEIV99
 19854     SET ADDRESS OF CLAIM-MASTER TO
 19855         DFHEIV20
 19856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19857
 19858
 19859     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19860        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19861         GO TO 7250-CONTINUE
 19862     END-IF.
 19863
 19864     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19865        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19866        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19867        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19868        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19869         GO TO 7250-NEXT-CLAIM
 19870     END-IF.
 19871
 19872     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19873        OR (CL-CLAIM-TYPE = 'I')
 19874        OR (CL-CLAIM-TYPE = 'G')
 19875        OR (CL-CLAIM-TYPE = 'F')
 19876          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19877              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19878              GO TO 7250-CONTINUE
 19879          END-IF
 19880     END-IF.
 19881
 19882     GO TO 7250-NEXT-CLAIM.
 19883
 19884 7250-CONTINUE.
 19885
 19886     IF W-BROWSE-SW = 'Y'
 19887
 19888* EXEC CICS ENDBR
 19889*            DATASET   (CLMS-ID)
 19890*        END-EXEC
 19891     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 364
* EL050.cbl
 19892       TO DFHEIV11
 19893*    MOVE '&2                    $   #00019600' TO DFHEIV0
 19894     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19895     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19896     MOVE X'2020233030303139363030' TO DFHEIV0(25:11)
 19897     CALL 'kxdfhei1' USING DFHEIV0,
 19898           CLMS-ID,
 19899           DFHEIV11,
 19900           DFHEIV99
 19901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19902         MOVE 'N' TO W-BROWSE-SW
 19903     END-IF.
 19904
 19905 7250-EXIT.
 19906     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 365
* EL050.cbl
 19908 7300-CHECK-FOR-OPEN-CLMS.
 19909
 19910*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19911*    MOVE SPACES                 TO CNTL-ACCESS.
 19912*    MOVE '1'                    TO CNTL-REC-TYPE.
 19913*    MOVE +0                     TO CNTL-SEQ-NO.
 19914
 19915*    MOVE '3'                    TO RC-SW-1.
 19916*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19917
 19918*    IF NOT CF-COMPANY-MASTER
 19919*         PERFORM 0099-COMPANY-NOT-FOUND
 19920*         GO TO 7300-EXIT.
 19921
 19922     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19923                                    W-CL-COMP-CD.
 19924     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19925                                    W-CL-CERT-NO.
 19926
 19927
 19928* EXEC CICS HANDLE CONDITION
 19929*        NOTFND  (7300-CONTINUE)
 19930*        ENDFILE (7300-CONTINUE)
 19931*    END-EXEC.
 19932*    MOVE '"$I''                  ! * #00019628' TO DFHEIV0
 19933     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19935     MOVE X'2A20233030303139363238' TO DFHEIV0(25:11)
 19936     CALL 'kxdfhei1' USING DFHEIV0
 19937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19938
 19939
 19940
 19941* EXEC CICS IGNORE CONDITION
 19942*        DUPKEY
 19943*    END-EXEC.
 19944*    MOVE '"*$                   !   #00019633' TO DFHEIV0
 19945     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19946     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19947     MOVE X'2020233030303139363333' TO DFHEIV0(25:11)
 19948     CALL 'kxdfhei1' USING DFHEIV0
 19949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19950
 19951
 19952
 19953* EXEC CICS STARTBR
 19954*        DATASET   (CLMS-ID)
 19955*        RIDFLD    (ELMSTR-KEY)
 19956*        GENERIC   EQUAL
 19957*        KEYLENGTH (ELMSTR-LENGTH)
 19958*    END-EXEC.
 19959     MOVE 0
 19960       TO DFHEIV11
 19961*    MOVE '&,   KG    E          &   #00019637' TO DFHEIV0
 19962     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19963     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19964     MOVE X'2020233030303139363337' TO DFHEIV0(25:11)
 19965     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 366
* EL050.cbl
 19966           CLMS-ID,
 19967           ELMSTR-KEY,
 19968           ELMSTR-LENGTH,
 19969           DFHEIV11,
 19970           DFHEIV99
 19971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19972
 19973
 19974     MOVE 'Y'                    TO W-BROWSE-SW.
 19975
 19976 7300-NEXT-CLAIM.
 19977
 19978
 19979* EXEC CICS READNEXT
 19980*        DATASET   (CLMS-ID)
 19981*        RIDFLD    (ELMSTR-KEY)
 19982*        SET       (ADDRESS OF CLAIM-MASTER)
 19983*    END-EXEC.
 19984     MOVE 0
 19985       TO DFHEIV11
 19986*    MOVE '&.S                   )   #00019648' TO DFHEIV0
 19987     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19988     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19989     MOVE X'2020233030303139363438' TO DFHEIV0(25:11)
 19990     CALL 'kxdfhei1' USING DFHEIV0,
 19991           CLMS-ID,
 19992           DFHEIV20,
 19993           DFHEIV99,
 19994           ELMSTR-KEY,
 19995           DFHEIV99,
 19996           DFHEIV11,
 19997           DFHEIV99,
 19998           DFHEIV99
 19999     SET ADDRESS OF CLAIM-MASTER TO
 20000         DFHEIV20
 20001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20002
 20003
 20004     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20005        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20006         GO TO 7300-CONTINUE.
 20007
 20008     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20009        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20010        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20011        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20012        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20013         GO TO 7300-NEXT-CLAIM.
 20014
 20015*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 20016     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20017        OR (CL-CLAIM-TYPE = 'I')
 20018        OR (CL-CLAIM-TYPE = 'G')
 20019        OR (CL-CLAIM-TYPE = 'F')
 20020        IF CLAIM-IS-OPEN
 20021           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20022             AND PB-C-AH-CANCEL-DT > SPACES
 20023              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 367
* EL050.cbl
 20024              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20025           END-IF
 20026           EVALUATE TRUE
 20027             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20028                 MOVE ER-2884      TO WS-ERROR
 20029             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20030                 MOVE ER-2887      TO WS-ERROR
 20031             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20032                 MOVE ER-2886      TO WS-ERROR
 20033             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20034                 MOVE ER-2888      TO WS-ERROR
 20035             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20036                 MOVE ER-2885      TO WS-ERROR
 20037             WHEN OTHER
 20038                 MOVE ER-2768      TO WS-ERROR
 20039           END-EVALUATE
 20040           IF PB-C-AH-CANCEL-VOIDED OR
 20041              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20042                NOT AH-COVERAGE-CANCELLED)
 20043               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20044               MOVE ER-2768      TO WS-ERROR
 20045           END-IF
 20046           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20047           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20048              PB-FORCE-CODE NOT EQUAL '8'
 20049               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20050           END-IF
 20051           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20052           GO TO 7300-NEXT-CLAIM
 20053        ELSE
 20054           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20055*****THIS IS A RESCISSION OR REFORMATION
 20056              IF AH-COVERAGE-CANCELLED
 20057                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 20058                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 20059                    MOVE 1                   TO DC-ELAPSED-DAYS
 20060                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 20061                    SET BIN-PLUS-ELAPSED     TO TRUE
 20062                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 20063                    IF NO-CONVERSION-ERROR
 20064                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 20065                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 20066                          MOVE ER-2897 TO WS-ERROR
 20067                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20068                          GO TO 7300-NEXT-CLAIM
 20069                       END-IF
 20070                    END-IF
 20071                 ELSE
 20072                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 20073                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20074                         MOVE ER-2890 TO WS-ERROR
 20075                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20076                         GO TO 7300-NEXT-CLAIM
 20077                      ELSE
 20078                         MOVE ER-2898 TO WS-ERROR
 20079                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20080                         GO TO 7300-NEXT-CLAIM
 20081                      END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 368
* EL050.cbl
 20082                   END-IF
 20083                 END-IF
 20084              END-IF
 20085           ELSE
 20086              IF CL-DENIAL-TYPE = '1'  AND
 20087                 CL-TOTAL-PAID-AMT = 0
 20088                    GO TO 7300-NEXT-CLAIM
 20089              END-IF
 20090              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20091               AND PB-C-AH-CANCEL-DT > SPACES
 20092                 MOVE ER-2756        TO WS-ERROR
 20093                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20094                 GO TO 7300-NEXT-CLAIM
 20095              END-IF
 20096           END-IF
 20097        END-IF
 20098     ELSE
 20099*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 20100        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 20101          OR (CL-CLAIM-TYPE = 'O')
 20102           IF (CLAIM-IS-OPEN)
 20103              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 20104                 <> zeros
 20105              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 20106                 <> zeros)
 20107              MOVE ER-2889      TO WS-ERROR
 20108              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20109              GO TO 7300-NEXT-CLAIM
 20110           ELSE
 20111              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20112*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 20113                 IF (LF-COVERAGE-CANCELLED AND
 20114                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20115                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20116                         MOVE ER-2890 TO WS-ERROR
 20117                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20118                         GO TO 7300-NEXT-CLAIM
 20119                      ELSE
 20120                         MOVE ER-2898 TO WS-ERROR
 20121                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20122                         GO TO 7300-NEXT-CLAIM
 20123                      END-IF
 20124                 END-IF
 20125              ELSE
 20126                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 20127                    and (CL-TOTAL-PAID-AMT = 0)
 20128                    GO TO 7300-NEXT-CLAIM
 20129                 END-IF
 20130                 IF (
 20131                      (AH-COVERAGE-CANCELLED)
 20132                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 20133                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 20134                      and (pb-ci-ah-cancel-amt +
 20135                         pb-c-ah-cancel-amt) <> zeros
 20136                    )
 20137                               OR
 20138                    (
 20139                      (LF-COVERAGE-CANCELLED)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 369
* EL050.cbl
 20140                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
 20141                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 20142                      and (pb-ci-lf-cancel-amt +
 20143                         pb-c-lf-cancel-amt) <> zeros
 20144                    )
 20145                       IF CL-CLAIM-TYPE = 'O'
 20146                          MOVE ER-2998 TO WS-ERROR
 20147                       ELSE
 20148                          MOVE ER-2965 TO WS-ERROR
 20149                       END-IF
 20150                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20151                       GO TO 7300-NEXT-CLAIM
 20152                 END-IF
 20153                 IF LF-COVERAGE-CANCELLED
 20154                  IF CL-TOTAL-PAID-AMT > 0
 20155                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20156                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20157                        MOVE ER-2891 TO WS-ERROR
 20158                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20159                        GO TO 7300-NEXT-CLAIM
 20160                      END-IF
 20161                    ELSE
 20162****only show this error if cert num matches exactly
 20163                      IF PB-CERT-NO = CL-CERT-NO
 20164                         IF CL-CLAIM-TYPE = 'O'
 20165                            MOVE ER-2895 TO WS-ERROR
 20166                         ELSE
 20167                            MOVE ER-2892 TO WS-ERROR
 20168                         END-IF
 20169                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20170                         GO TO 7300-NEXT-CLAIM
 20171                      END-IF
 20172                    END-IF
 20173                  END-IF
 20174                 END-IF
 20175              END-IF
 20176           END-IF
 20177        END-IF
 20178     END-IF
 20179
 20180     GO TO 7300-NEXT-CLAIM.
 20181
 20182 7300-CONTINUE.
 20183
 20184     IF W-BROWSE-SW = 'Y'
 20185
 20186* EXEC CICS ENDBR
 20187*            DATASET   (CLMS-ID)
 20188*        END-EXEC.
 20189     MOVE 0
 20190       TO DFHEIV11
 20191*    MOVE '&2                    $   #00019835' TO DFHEIV0
 20192     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20193     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20194     MOVE X'2020233030303139383335' TO DFHEIV0(25:11)
 20195     CALL 'kxdfhei1' USING DFHEIV0,
 20196           CLMS-ID,
 20197           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 370
* EL050.cbl
 20198           DFHEIV99
 20199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20200
 20201
 20202 7300-EXIT.
 20203     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 371
* EL050.cbl
 20205
 20206 7400-GET-REMAIN-TERM.
 20207
 20208* EXEC CICS LINK
 20209*        PROGRAM    ('ELRTRM')
 20210*        COMMAREA   (CALCULATION-PASS-AREA)
 20211*        LENGTH     (CP-COMM-LENGTH)
 20212*    END-EXEC.
 20213     MOVE 'ELRTRM' TO DFHEIV1
 20214*    MOVE '."C                   (   #00019844' TO DFHEIV0
 20215     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20216     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20217     MOVE X'2020233030303139383434' TO DFHEIV0(25:11)
 20218     CALL 'kxdfhei1' USING DFHEIV0,
 20219           DFHEIV1,
 20220           CALCULATION-PASS-AREA,
 20221           CP-COMM-LENGTH,
 20222           DFHEIV99,
 20223           DFHEIV99,
 20224           DFHEIV99,
 20225           DFHEIV99
 20226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20227
 20228
 20229 7400-EXIT.
 20230     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 372
* EL050.cbl
 20232
 20233 7500-GET-REMAIN-AMOUNT.
 20234
 20235* EXEC CICS LINK
 20236*        PROGRAM    ('ELRAMT')
 20237*        COMMAREA   (CALCULATION-PASS-AREA)
 20238*        LENGTH     (CP-COMM-LENGTH)
 20239*    END-EXEC.
 20240     MOVE 'ELRAMT' TO DFHEIV1
 20241*    MOVE '."C                   (   #00019855' TO DFHEIV0
 20242     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20244     MOVE X'2020233030303139383535' TO DFHEIV0(25:11)
 20245     CALL 'kxdfhei1' USING DFHEIV0,
 20246           DFHEIV1,
 20247           CALCULATION-PASS-AREA,
 20248           CP-COMM-LENGTH,
 20249           DFHEIV99,
 20250           DFHEIV99,
 20251           DFHEIV99,
 20252           DFHEIV99
 20253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20254
 20255
 20256 7500-EXIT.
 20257     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 373
* EL050.cbl
 20259
 20260 7600-GET-REFUND.
 20261
 20262* EXEC CICS LINK
 20263*        PROGRAM    ('ELRFND')
 20264*        COMMAREA   (CALCULATION-PASS-AREA)
 20265*        LENGTH     (CP-COMM-LENGTH)
 20266*    END-EXEC.
 20267     MOVE 'ELRFND' TO DFHEIV1
 20268*    MOVE '."C                   (   #00019866' TO DFHEIV0
 20269     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20270     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20271     MOVE X'2020233030303139383636' TO DFHEIV0(25:11)
 20272     CALL 'kxdfhei1' USING DFHEIV0,
 20273           DFHEIV1,
 20274           CALCULATION-PASS-AREA,
 20275           CP-COMM-LENGTH,
 20276           DFHEIV99,
 20277           DFHEIV99,
 20278           DFHEIV99,
 20279           DFHEIV99
 20280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20281
 20282
 20283 7600-EXIT.
 20284     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 374
* EL050.cbl
 20286 7700-CALL-DL1.
 20287
 20288* EXEC CICS LINK
 20289*        PROGRAM    ('DLO001')
 20290*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20291*        LENGTH     (DLO001-COMM-LENGTH)
 20292*    END-EXEC.
 20293     MOVE 'DLO001' TO DFHEIV1
 20294*    MOVE '."C                   (   #00019876' TO DFHEIV0
 20295     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20296     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20297     MOVE X'2020233030303139383736' TO DFHEIV0(25:11)
 20298     CALL 'kxdfhei1' USING DFHEIV0,
 20299           DFHEIV1,
 20300           WS-DLO-MASTER-POLICY-FORM,
 20301           DLO001-COMM-LENGTH,
 20302           DFHEIV99,
 20303           DFHEIV99,
 20304           DFHEIV99,
 20305           DFHEIV99
 20306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20307
 20308
 20309 7700-EXIT.
 20310     EXIT.
 20311
 20312 7710-CALL-DL2.
 20313
 20314* EXEC CICS LINK
 20315*        PROGRAM    ('DLO002')
 20316*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20317*        LENGTH     (DLO002-COMM-LENGTH)
 20318*    END-EXEC.
 20319     MOVE 'DLO002' TO DFHEIV1
 20320*    MOVE '."C                   (   #00019886' TO DFHEIV0
 20321     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20323     MOVE X'2020233030303139383836' TO DFHEIV0(25:11)
 20324     CALL 'kxdfhei1' USING DFHEIV0,
 20325           DFHEIV1,
 20326           WS-DLO-INTERNAL-POLICY-FORM,
 20327           DLO002-COMM-LENGTH,
 20328           DFHEIV99,
 20329           DFHEIV99,
 20330           DFHEIV99,
 20331           DFHEIV99
 20332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20333
 20334
 20335 7710-EXIT.
 20336     EXIT.
 20337
 20338 7720-CALL-DL3.
 20339
 20340* EXEC CICS LINK
 20341*        PROGRAM    ('DLO003')
 20342*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20343*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 375
* EL050.cbl
 20344*    END-EXEC.
 20345     MOVE 'DLO003' TO DFHEIV1
 20346*    MOVE '."C                   (   #00019896' TO DFHEIV0
 20347     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20349     MOVE X'2020233030303139383936' TO DFHEIV0(25:11)
 20350     CALL 'kxdfhei1' USING DFHEIV0,
 20351           DFHEIV1,
 20352           WS-DLO-VALID-BANK-ID,
 20353           DLO003-COMM-LENGTH,
 20354           DFHEIV99,
 20355           DFHEIV99,
 20356           DFHEIV99,
 20357           DFHEIV99
 20358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20359
 20360
 20361 7720-EXIT.
 20362     EXIT.
 20363
 20364 7730-CALL-DL7.
 20365
 20366* EXEC CICS LINK
 20367*        PROGRAM    ('DLO007')
 20368*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20369*        LENGTH     (DLO007-COMM-LENGTH)
 20370*    END-EXEC.
 20371     MOVE 'DLO007' TO DFHEIV1
 20372*    MOVE '."C                   (   #00019906' TO DFHEIV0
 20373     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20374     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20375     MOVE X'2020233030303139393036' TO DFHEIV0(25:11)
 20376     CALL 'kxdfhei1' USING DFHEIV0,
 20377           DFHEIV1,
 20378           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20379           DLO007-COMM-LENGTH,
 20380           DFHEIV99,
 20381           DFHEIV99,
 20382           DFHEIV99,
 20383           DFHEIV99
 20384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20385
 20386
 20387 7730-EXIT.
 20388     EXIT.
 20389
 20390 7740-CALL-DL11.
 20391
 20392* EXEC CICS LINK
 20393*        PROGRAM    ('DLO011')
 20394*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20395*        LENGTH     (DLO011-COMM-LENGTH)
 20396*    END-EXEC.
 20397     MOVE 'DLO011' TO DFHEIV1
 20398*    MOVE '."C                   (   #00019916' TO DFHEIV0
 20399     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20400     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20401     MOVE X'2020233030303139393136' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 376
* EL050.cbl
 20402     CALL 'kxdfhei1' USING DFHEIV0,
 20403           DFHEIV1,
 20404           WS-DLO-PREM-RATES-BEN-TYPE,
 20405           DLO011-COMM-LENGTH,
 20406           DFHEIV99,
 20407           DFHEIV99,
 20408           DFHEIV99,
 20409           DFHEIV99
 20410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20411
 20412
 20413 7740-EXIT.
 20414     EXIT.
 20415
 20416 7750-CALL-DL17.
 20417
 20418* EXEC CICS LINK
 20419*        PROGRAM    ('DLO017')
 20420*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20421*        LENGTH     (DLO017-COMM-LENGTH)
 20422*    END-EXEC.
 20423     MOVE 'DLO017' TO DFHEIV1
 20424*    MOVE '."C                   (   #00019926' TO DFHEIV0
 20425     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20427     MOVE X'2020233030303139393236' TO DFHEIV0(25:11)
 20428     CALL 'kxdfhei1' USING DFHEIV0,
 20429           DFHEIV1,
 20430           WS-DLO-VALID-RATE-CODE,
 20431           DLO017-COMM-LENGTH,
 20432           DFHEIV99,
 20433           DFHEIV99,
 20434           DFHEIV99,
 20435           DFHEIV99
 20436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20437
 20438
 20439 7750-EXIT.
 20440     EXIT.
 20441
 20442 7755-CALL-DL19.
 20443
 20444* EXEC CICS LINK
 20445*        PROGRAM    ('DLO019')
 20446*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20447*        LENGTH     (DLO019-COMM-LENGTH)
 20448*    END-EXEC.
 20449     MOVE 'DLO019' TO DFHEIV1
 20450*    MOVE '."C                   (   #00019936' TO DFHEIV0
 20451     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20452     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20453     MOVE X'2020233030303139393336' TO DFHEIV0(25:11)
 20454     CALL 'kxdfhei1' USING DFHEIV0,
 20455           DFHEIV1,
 20456           WS-DLO-ORIG-COV-CAT,
 20457           DLO019-COMM-LENGTH,
 20458           DFHEIV99,
 20459           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 377
* EL050.cbl
 20460           DFHEIV99,
 20461           DFHEIV99
 20462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20463
 20464
 20465 7755-EXIT.
 20466     EXIT.
 20467
 20468 7760-CALL-DL21.
 20469
 20470* EXEC CICS LINK
 20471*        PROGRAM    ('DLO021')
 20472*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20473*        LENGTH     (DLO021-COMM-LENGTH)
 20474*    END-EXEC.
 20475     MOVE 'DLO021' TO DFHEIV1
 20476*    MOVE '."C                   (   #00019946' TO DFHEIV0
 20477     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20479     MOVE X'2020233030303139393436' TO DFHEIV0(25:11)
 20480     CALL 'kxdfhei1' USING DFHEIV0,
 20481           DFHEIV1,
 20482           WS-DLO-VALID-LOAN-OFFICER,
 20483           DLO021-COMM-LENGTH,
 20484           DFHEIV99,
 20485           DFHEIV99,
 20486           DFHEIV99,
 20487           DFHEIV99
 20488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20489
 20490
 20491 7760-EXIT.
 20492     EXIT.
 20493
 20494 7770-CALL-DL22.
 20495
 20496* EXEC CICS LINK
 20497*        PROGRAM    ('DLO022')
 20498*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20499*        LENGTH     (DLO022-COMM-LENGTH)
 20500*    END-EXEC.
 20501     MOVE 'DLO022' TO DFHEIV1
 20502*    MOVE '."C                   (   #00019956' TO DFHEIV0
 20503     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20505     MOVE X'2020233030303139393536' TO DFHEIV0(25:11)
 20506     CALL 'kxdfhei1' USING DFHEIV0,
 20507           DFHEIV1,
 20508           WS-DLO-VALID-STATE-CODE,
 20509           DLO022-COMM-LENGTH,
 20510           DFHEIV99,
 20511           DFHEIV99,
 20512           DFHEIV99,
 20513           DFHEIV99
 20514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20515
 20516
 20517 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 378
* EL050.cbl
 20518     EXIT.
 20519
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 379
* EL050.cbl
 20521
 20522 7780-CALL-AGG.
 20523
 20524* EXEC CICS LINK
 20525*        PROGRAM    ('ELAGGO')
 20526*        COMMAREA   (WS-PASS-to-pemaggo)
 20527*        LENGTH     (ws-passed-key-LENGTH)
 20528*    END-EXEC.
 20529     MOVE 'ELAGGO' TO DFHEIV1
 20530*    MOVE '."C                   (   #00019968' TO DFHEIV0
 20531     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20532     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20533     MOVE X'2020233030303139393638' TO DFHEIV0(25:11)
 20534     CALL 'kxdfhei1' USING DFHEIV0,
 20535           DFHEIV1,
 20536           WS-PASS-to-pemaggo,
 20537           ws-passed-key-LENGTH,
 20538           DFHEIV99,
 20539           DFHEIV99,
 20540           DFHEIV99,
 20541           DFHEIV99
 20542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20543
 20544 7780-EXIT.
 20545     EXIT.
 20546 7785-CALL-HLDI.
 20547
 20548* EXEC CICS LINK
 20549*        PROGRAM    ('ELHLDI')
 20550*        COMMAREA   (HLDI-PASS-AREA)
 20551*        LENGTH     (HLDI-PASS-AREA-LEN)
 20552*    END-EXEC.
 20553     MOVE 'ELHLDI' TO DFHEIV1
 20554*    MOVE '."C                   (   #00019976' TO DFHEIV0
 20555     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20557     MOVE X'2020233030303139393736' TO DFHEIV0(25:11)
 20558     CALL 'kxdfhei1' USING DFHEIV0,
 20559           DFHEIV1,
 20560           HLDI-PASS-AREA,
 20561           HLDI-PASS-AREA-LEN,
 20562           DFHEIV99,
 20563           DFHEIV99,
 20564           DFHEIV99,
 20565           DFHEIV99
 20566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20567
 20568 7785-EXIT.
 20569     EXIT.
 20570 7786-CALL-HLDIM.
 20571
 20572* EXEC CICS LINK
 20573*        PROGRAM    ('ELHLDIM')
 20574*        COMMAREA   (HLDI-PASS-AREA)
 20575*        LENGTH     (HLDI-PASS-AREA-LEN)
 20576*    END-EXEC.
 20577     MOVE 'ELHLDIM' TO DFHEIV1
 20578*    MOVE '."C                   (   #00019984' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 380
* EL050.cbl
 20579     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20580     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20581     MOVE X'2020233030303139393834' TO DFHEIV0(25:11)
 20582     CALL 'kxdfhei1' USING DFHEIV0,
 20583           DFHEIV1,
 20584           HLDI-PASS-AREA,
 20585           HLDI-PASS-AREA-LEN,
 20586           DFHEIV99,
 20587           DFHEIV99,
 20588           DFHEIV99,
 20589           DFHEIV99
 20590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20591
 20592 7786-EXIT.
 20593     EXIT.
 20594 7790-CALL-ZIP-VERIFY.
 20595
 20596
 20597* EXEC CICS LINK
 20598*        PROGRAM    ('WSZIPCD')
 20599*        COMMAREA   (ZIPCD-PASS-AREA)
 20600*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20601*    END-EXEC.
 20602     MOVE 'WSZIPCD' TO DFHEIV1
 20603*    MOVE '."C                   (   #00019993' TO DFHEIV0
 20604     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20605     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20606     MOVE X'2020233030303139393933' TO DFHEIV0(25:11)
 20607     CALL 'kxdfhei1' USING DFHEIV0,
 20608           DFHEIV1,
 20609           ZIPCD-PASS-AREA,
 20610           ZIPCD-PASS-AREA-LEN,
 20611           DFHEIV99,
 20612           DFHEIV99,
 20613           DFHEIV99,
 20614           DFHEIV99
 20615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20616
 20617
 20618 7790-EXIT.
 20619     EXIT.
 20620 7795-call-sqlclmhs.
 20621
 20622
 20623* EXEC CICS LINK
 20624*        PROGRAM    ('SQLCLMHS')
 20625*        COMMAREA   (clmhs-PASS-AREA)
 20626*        LENGTH     (clmhs-PASS-AREA-LEN)
 20627*    END-EXEC.
 20628     MOVE 'SQLCLMHS' TO DFHEIV1
 20629*    MOVE '."C                   (   #00020003' TO DFHEIV0
 20630     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20632     MOVE X'2020233030303230303033' TO DFHEIV0(25:11)
 20633     CALL 'kxdfhei1' USING DFHEIV0,
 20634           DFHEIV1,
 20635           clmhs-PASS-AREA,
 20636           clmhs-PASS-AREA-LEN,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 381
* EL050.cbl
 20637           DFHEIV99,
 20638           DFHEIV99,
 20639           DFHEIV99,
 20640           DFHEIV99
 20641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20642
 20643
 20644 7795-EXIT.
 20645     EXIT.
 20646 7800-REWRITE-CERT.
 20647******************************************************************
 20648*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20649*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20650******************************************************************
 20651
 20652     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20653        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20654        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20655        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20656
 20657* EXEC CICS REWRITE
 20658*                  DATASET (CERT-ID)
 20659*                  FROM    (CERTIFICATE-MASTER)
 20660*              END-EXEC
 20661     MOVE LENGTH OF
 20662      CERTIFICATE-MASTER
 20663       TO DFHEIV11
 20664*    MOVE '&& L                  %   #00020021' TO DFHEIV0
 20665     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20666     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20667     MOVE X'2020233030303230303231' TO DFHEIV0(25:11)
 20668     CALL 'kxdfhei1' USING DFHEIV0,
 20669           CERT-ID,
 20670           CERTIFICATE-MASTER,
 20671           DFHEIV11,
 20672           DFHEIV99
 20673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20674        GO TO 7800-EXIT.
 20675
 20676       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20677       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20678
 20679 7800-EXIT.
 20680      EXIT.
 20681
 20682 7900-DELETE-CERT.
 20683
 20684* EXEC CICS DELETE
 20685*        DATASET (CERT-ID)
 20686*    END-EXEC.
 20687*    MOVE '&(                    &   #00020034' TO DFHEIV0
 20688     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20689     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20690     MOVE X'2020233030303230303334' TO DFHEIV0(25:11)
 20691     CALL 'kxdfhei1' USING DFHEIV0,
 20692           CERT-ID,
 20693           DFHEIV99,
 20694           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 382
* EL050.cbl
 20695           DFHEIV99,
 20696           DFHEIV99
 20697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20698
 20699
 20700 7900-EXIT.
 20701     EXIT.
 20702
 20703 8000-WRITE-CERT.
 20704
 20705* EXEC CICS HANDLE CONDITION
 20706*        DUPKEY    (8000-FREE-MAIN)
 20707*    END-EXEC.
 20708*    MOVE '"$$                   ! + #00020042' TO DFHEIV0
 20709     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20711     MOVE X'2B20233030303230303432' TO DFHEIV0(25:11)
 20712     CALL 'kxdfhei1' USING DFHEIV0
 20713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20714
 20715
 20716
 20717* EXEC CICS WRITE
 20718*        DATASET     (CERT-ID)
 20719*        FROM        (CERTIFICATE-MASTER)
 20720*        RIDFLD      (ELCERT-KEY)
 20721*    END-EXEC.
 20722     MOVE LENGTH OF
 20723      CERTIFICATE-MASTER
 20724       TO DFHEIV11
 20725*    MOVE '&$ L                  ''   #00020046' TO DFHEIV0
 20726     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20727     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20728     MOVE X'2020233030303230303436' TO DFHEIV0(25:11)
 20729     CALL 'kxdfhei1' USING DFHEIV0,
 20730           CERT-ID,
 20731           CERTIFICATE-MASTER,
 20732           DFHEIV11,
 20733           ELCERT-KEY,
 20734           DFHEIV99,
 20735           DFHEIV99
 20736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20737
 20738
 20739 8000-FREE-MAIN.
 20740
 20741 8000-EXIT.
 20742      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 383
* EL050.cbl
 20744
 20745 8100-READ-ERPNDM.
 20746
 20747* EXEC CICS HANDLE CONDITION
 20748*         NOTFND     (8100-NOTFND)
 20749*         ENDFILE    (8100-NOTFND)
 20750*    END-EXEC.
 20751*    MOVE '"$I''                  ! , #00020059' TO DFHEIV0
 20752     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20754     MOVE X'2C20233030303230303539' TO DFHEIV0(25:11)
 20755     CALL 'kxdfhei1' USING DFHEIV0
 20756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20757
 20758
 20759     MOVE SPACES                 TO ERPNDM-FOUND.
 20760     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20761
 20762
 20763* EXEC CICS READ UPDATE
 20764*         DATASET   (FILE-ERPNDM)
 20765*         RIDFLD    (PM-CONTROL-PRIMARY)
 20766*         INTO      (PENDING-MAILING-DATA)
 20767*    END-EXEC.
 20768     MOVE LENGTH OF
 20769      PENDING-MAILING-DATA
 20770       TO DFHEIV11
 20771*    MOVE '&"IL       EU         (   #00020067' TO DFHEIV0
 20772     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20773     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20774     MOVE X'2020233030303230303637' TO DFHEIV0(25:11)
 20775     CALL 'kxdfhei1' USING DFHEIV0,
 20776           FILE-ERPNDM,
 20777           PENDING-MAILING-DATA,
 20778           DFHEIV11,
 20779           PM-CONTROL-PRIMARY,
 20780           DFHEIV99,
 20781           DFHEIV99,
 20782           DFHEIV99
 20783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20784
 20785
 20786     GO TO 8100-EXIT.
 20787
 20788 8100-NOTFND.
 20789
 20790     MOVE 'X'                    TO ERPNDM-FOUND.
 20791     MOVE ER-2694                TO WS-ERROR.
 20792     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20793     MOVE ER-2883                TO WS-ERROR
 20794     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20795     .
 20796 8100-EXIT.
 20797     EXIT.
 20798 8102-REWRITE-ERPNDM.
 20799
 20800
 20801* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 384
* EL050.cbl
 20802*         DATASET    (FILE-ERPNDM)
 20803*         FROM       (PENDING-MAILING-DATA)
 20804*    END-EXEC
 20805     MOVE LENGTH OF
 20806      PENDING-MAILING-DATA
 20807       TO DFHEIV11
 20808*    MOVE '&& L                  %   #00020087' TO DFHEIV0
 20809     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20810     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20811     MOVE X'2020233030303230303837' TO DFHEIV0(25:11)
 20812     CALL 'kxdfhei1' USING DFHEIV0,
 20813           FILE-ERPNDM,
 20814           PENDING-MAILING-DATA,
 20815           DFHEIV11,
 20816           DFHEIV99
 20817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20818
 20819     .
 20820 8102-EXIT.
 20821     EXIT.
 20822 8104-UNLOCK-ERPNDM.
 20823
 20824
 20825* EXEC CICS UNLOCK
 20826*         DATASET   (FILE-ERPNDM)
 20827*    END-EXEC
 20828*    MOVE '&*                    #   #00020097' TO DFHEIV0
 20829     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20830     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20831     MOVE X'2020233030303230303937' TO DFHEIV0(25:11)
 20832     CALL 'kxdfhei1' USING DFHEIV0,
 20833           FILE-ERPNDM,
 20834           DFHEIV99
 20835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20836
 20837     .
 20838 8104-EXIT.
 20839     EXIT.
 20840 8110-READ-ERMAIL.
 20841
 20842* EXEC CICS HANDLE CONDITION
 20843*         NOTFND     (8110-NOTFND)
 20844*         ENDFILE    (8110-NOTFND)
 20845*    END-EXEC.
 20846*    MOVE '"$I''                  ! - #00020105' TO DFHEIV0
 20847     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20848     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20849     MOVE X'2D20233030303230313035' TO DFHEIV0(25:11)
 20850     CALL 'kxdfhei1' USING DFHEIV0
 20851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20852
 20853
 20854     MOVE SPACES                 TO ERMAIL-FOUND.
 20855     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20856     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20857     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20858     MOVE PB-SV-STATE            TO MA-STATE.
 20859
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 385
* EL050.cbl
 20860
 20861* EXEC CICS READ
 20862*         UPDATE
 20863*         DATASET   (FILE-ERMAIL)
 20864*         RIDFLD    (MA-CONTROL-PRIMARY)
 20865*         INTO      (MAILING-DATA)
 20866*    END-EXEC.
 20867     MOVE LENGTH OF
 20868      MAILING-DATA
 20869       TO DFHEIV11
 20870*    MOVE '&"IL       EU         (   #00020116' TO DFHEIV0
 20871     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20872     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20873     MOVE X'2020233030303230313136' TO DFHEIV0(25:11)
 20874     CALL 'kxdfhei1' USING DFHEIV0,
 20875           FILE-ERMAIL,
 20876           MAILING-DATA,
 20877           DFHEIV11,
 20878           MA-CONTROL-PRIMARY,
 20879           DFHEIV99,
 20880           DFHEIV99,
 20881           DFHEIV99
 20882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20883
 20884
 20885     GO TO 8110-EXIT.
 20886
 20887 8110-NOTFND.
 20888     MOVE 'X'                    TO ERMAIL-FOUND.
 20889
 20890 8110-EXIT.
 20891     EXIT.
 20892
 20893 8120-REWRITE-ERMAIL.
 20894
 20895* EXEC CICS REWRITE
 20896*         DATASET    (FILE-ERMAIL)
 20897*         FROM       (MAILING-DATA)
 20898*    END-EXEC.
 20899     MOVE LENGTH OF
 20900      MAILING-DATA
 20901       TO DFHEIV11
 20902*    MOVE '&& L                  %   #00020132' TO DFHEIV0
 20903     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20904     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20905     MOVE X'2020233030303230313332' TO DFHEIV0(25:11)
 20906     CALL 'kxdfhei1' USING DFHEIV0,
 20907           FILE-ERMAIL,
 20908           MAILING-DATA,
 20909           DFHEIV11,
 20910           DFHEIV99
 20911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20912
 20913
 20914 8120-EXIT.
 20915     EXIT.
 20916
 20917 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 386
* EL050.cbl
 20918
 20919* EXEC CICS HANDLE CONDITION
 20920*         DUPKEY   (8130-EXIT)
 20921*    END-EXEC.
 20922*    MOVE '"$$                   ! . #00020141' TO DFHEIV0
 20923     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20924     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20925     MOVE X'2E20233030303230313431' TO DFHEIV0(25:11)
 20926     CALL 'kxdfhei1' USING DFHEIV0
 20927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20928
 20929
 20930
 20931* EXEC CICS WRITE
 20932*         DATASET     (FILE-ERMAIL)
 20933*         RIDFLD      (MA-CONTROL-PRIMARY)
 20934*         FROM        (MAILING-DATA)
 20935*    END-EXEC.
 20936     MOVE LENGTH OF
 20937      MAILING-DATA
 20938       TO DFHEIV11
 20939*    MOVE '&$ L                  ''   #00020145' TO DFHEIV0
 20940     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20941     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20942     MOVE X'2020233030303230313435' TO DFHEIV0(25:11)
 20943     CALL 'kxdfhei1' USING DFHEIV0,
 20944           FILE-ERMAIL,
 20945           MAILING-DATA,
 20946           DFHEIV11,
 20947           MA-CONTROL-PRIMARY,
 20948           DFHEIV99,
 20949           DFHEIV99
 20950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20951
 20952
 20953 8130-EXIT.
 20954     EXIT.
 20955
 20956 8140-UNLOCK-ERMAIL.
 20957
 20958* EXEC CICS UNLOCK
 20959*         DATASET   (FILE-ERMAIL)
 20960*    END-EXEC.
 20961*    MOVE '&*                    #   #00020155' TO DFHEIV0
 20962     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20963     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20964     MOVE X'2020233030303230313535' TO DFHEIV0(25:11)
 20965     CALL 'kxdfhei1' USING DFHEIV0,
 20966           FILE-ERMAIL,
 20967           DFHEIV99
 20968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20969
 20970
 20971 8140-EXIT.
 20972     EXIT.
 20973
 20974 8145-read-elcrtt-upd.
 20975
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 387
* EL050.cbl
 20976     move ' '                    to elcrtt-found-sw
 20977                                    elcrtt-update-sw
 20978
 20979* EXEC CICS HANDLE CONDITION
 20980*        NOTFND   (8145-exit)
 20981*    END-EXEC
 20982*    MOVE '"$I                   ! / #00020166' TO DFHEIV0
 20983     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20984     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20985     MOVE X'2F20233030303230313636' TO DFHEIV0(25:11)
 20986     CALL 'kxdfhei1' USING DFHEIV0
 20987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20988
 20989     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20990     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20991
 20992
 20993* EXEC CICS READ UPDATE
 20994*        DATASET  (CRTT-ID)
 20995*        RIDFLD   (WS-ELCRTT-KEY)
 20996*        INTO     (CERTIFICATE-TRAILERS)
 20997*    END-EXEC
 20998     MOVE LENGTH OF
 20999      CERTIFICATE-TRAILERS
 21000       TO DFHEIV11
 21001*    MOVE '&"IL       EU         (   #00020173' TO DFHEIV0
 21002     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21003     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21004     MOVE X'2020233030303230313733' TO DFHEIV0(25:11)
 21005     CALL 'kxdfhei1' USING DFHEIV0,
 21006           CRTT-ID,
 21007           CERTIFICATE-TRAILERS,
 21008           DFHEIV11,
 21009           WS-ELCRTT-KEY,
 21010           DFHEIV99,
 21011           DFHEIV99,
 21012           DFHEIV99
 21013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21014
 21015     set elcrtt-found to true
 21016
 21017     .
 21018 8145-exit.
 21019     exit.
 21020 8150-UPDATE-ELCRTT.
 21021
 21022     if elcrtt-found
 21023
 21024* EXEC CICS REWRITE
 21025*           DATASET  (CRTT-ID)
 21026*           FROM     (CERTIFICATE-TRAILERS)
 21027*        END-EXEC
 21028     MOVE LENGTH OF
 21029      CERTIFICATE-TRAILERS
 21030       TO DFHEIV11
 21031*    MOVE '&& L                  %   #00020187' TO DFHEIV0
 21032     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21033     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 388
* EL050.cbl
 21034     MOVE X'2020233030303230313837' TO DFHEIV0(25:11)
 21035     CALL 'kxdfhei1' USING DFHEIV0,
 21036           CRTT-ID,
 21037           CERTIFICATE-TRAILERS,
 21038           DFHEIV11,
 21039           DFHEIV99
 21040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21041     ELSE
 21042
 21043* EXEC CICS WRITE
 21044*          DATASET  (CRTT-ID)
 21045*          RIDFLD   (WS-ELCRTT-KEY)
 21046*          FROM     (CERTIFICATE-TRAILERS)
 21047*       END-EXEC
 21048     MOVE LENGTH OF
 21049      CERTIFICATE-TRAILERS
 21050       TO DFHEIV11
 21051*    MOVE '&$ L                  ''   #00020192' TO DFHEIV0
 21052     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21053     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21054     MOVE X'2020233030303230313932' TO DFHEIV0(25:11)
 21055     CALL 'kxdfhei1' USING DFHEIV0,
 21056           CRTT-ID,
 21057           CERTIFICATE-TRAILERS,
 21058           DFHEIV11,
 21059           WS-ELCRTT-KEY,
 21060           DFHEIV99,
 21061           DFHEIV99
 21062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21063     end-if
 21064
 21065     .
 21066 8150-EXIT.
 21067     EXIT.
 21068
 21069 8155-unlock-elcrtt.
 21070
 21071
 21072* EXEC CICS UNLOCK
 21073*       DATASET  (CRTT-ID)
 21074*    END-EXEC
 21075*    MOVE '&*                    #   #00020205' TO DFHEIV0
 21076     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21077     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21078     MOVE X'2020233030303230323035' TO DFHEIV0(25:11)
 21079     CALL 'kxdfhei1' USING DFHEIV0,
 21080           CRTT-ID,
 21081           DFHEIV99
 21082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21083
 21084     .
 21085 8155-exit.
 21086     exit.
 21087
 21088 8190-UPDATE-REFUND-CLAIM-FLAG.
 21089
 21090* EXEC CICS HANDLE CONDITION
 21091*        NOTFND   (8190-NOTFND)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 389
* EL050.cbl
 21092*    END-EXEC.
 21093*    MOVE '"$I                   ! 0 #00020214' TO DFHEIV0
 21094     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21096     MOVE X'3020233030303230323134' TO DFHEIV0(25:11)
 21097     CALL 'kxdfhei1' USING DFHEIV0
 21098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21099
 21100
 21101     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21102     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21103
 21104
 21105* EXEC CICS READ
 21106*        UPDATE
 21107*        DATASET  (CRTT-ID)
 21108*        RIDFLD   (WS-ELCRTT-KEY)
 21109*        INTO     (CERTIFICATE-TRAILERS)
 21110*    END-EXEC.
 21111     MOVE LENGTH OF
 21112      CERTIFICATE-TRAILERS
 21113       TO DFHEIV11
 21114*    MOVE '&"IL       EU         (   #00020221' TO DFHEIV0
 21115     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21117     MOVE X'2020233030303230323231' TO DFHEIV0(25:11)
 21118     CALL 'kxdfhei1' USING DFHEIV0,
 21119           CRTT-ID,
 21120           CERTIFICATE-TRAILERS,
 21121           DFHEIV11,
 21122           WS-ELCRTT-KEY,
 21123           DFHEIV99,
 21124           DFHEIV99,
 21125           DFHEIV99
 21126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21127
 21128
 21129     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21130
 21131* EXEC CICS REWRITE
 21132*       DATASET  (CRTT-ID)
 21133*       FROM     (CERTIFICATE-TRAILERS)
 21134*    END-EXEC.
 21135     MOVE LENGTH OF
 21136      CERTIFICATE-TRAILERS
 21137       TO DFHEIV11
 21138*    MOVE '&& L                  %   #00020229' TO DFHEIV0
 21139     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21140     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21141     MOVE X'2020233030303230323239' TO DFHEIV0(25:11)
 21142     CALL 'kxdfhei1' USING DFHEIV0,
 21143           CRTT-ID,
 21144           CERTIFICATE-TRAILERS,
 21145           DFHEIV11,
 21146           DFHEIV99
 21147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21148
 21149
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 390
* EL050.cbl
 21150     GO TO 8190-EXIT.
 21151
 21152 8190-NOTFND.
 21153
 21154     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21155     MOVE 'CS'         TO CS-RECORD-ID.
 21156     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21157     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21158     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21159     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21160
 21161* EXEC CICS WRITE
 21162*       DATASET  (CRTT-ID)
 21163*       RIDFLD   (WS-ELCRTT-KEY)
 21164*       FROM     (CERTIFICATE-TRAILERS)
 21165*    END-EXEC.
 21166     MOVE LENGTH OF
 21167      CERTIFICATE-TRAILERS
 21168       TO DFHEIV11
 21169*    MOVE '&$ L                  ''   #00020244' TO DFHEIV0
 21170     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21171     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21172     MOVE X'2020233030303230323434' TO DFHEIV0(25:11)
 21173     CALL 'kxdfhei1' USING DFHEIV0,
 21174           CRTT-ID,
 21175           CERTIFICATE-TRAILERS,
 21176           DFHEIV11,
 21177           WS-ELCRTT-KEY,
 21178           DFHEIV99,
 21179           DFHEIV99
 21180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21181
 21182
 21183 8190-EXIT.
 21184     EXIT.
 21185
 21186 8195-UPDATE-AGE-FLAGS.
 21187
 21188* EXEC CICS HANDLE CONDITION
 21189*        NOTFND   (8195-NOTFND)
 21190*    END-EXEC.
 21191*    MOVE '"$I                   ! 1 #00020254' TO DFHEIV0
 21192     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21194     MOVE X'3120233030303230323534' TO DFHEIV0(25:11)
 21195     CALL 'kxdfhei1' USING DFHEIV0
 21196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21197
 21198
 21199     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21200     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21201
 21202
 21203* EXEC CICS READ
 21204*        UPDATE
 21205*        DATASET  (CRTT-ID)
 21206*        RIDFLD   (WS-ELCRTT-KEY)
 21207*        INTO     (CERTIFICATE-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 391
* EL050.cbl
 21208*    END-EXEC.
 21209     MOVE LENGTH OF
 21210      CERTIFICATE-TRAILERS
 21211       TO DFHEIV11
 21212*    MOVE '&"IL       EU         (   #00020261' TO DFHEIV0
 21213     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21214     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21215     MOVE X'2020233030303230323631' TO DFHEIV0(25:11)
 21216     CALL 'kxdfhei1' USING DFHEIV0,
 21217           CRTT-ID,
 21218           CERTIFICATE-TRAILERS,
 21219           DFHEIV11,
 21220           WS-ELCRTT-KEY,
 21221           DFHEIV99,
 21222           DFHEIV99,
 21223           DFHEIV99
 21224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21225
 21226
 21227     IF WS-INS-AGE-SET = 'Y'
 21228        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21229     END-IF
 21230     IF WS-JNT-AGE-SET = 'Y'
 21231        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21232     END-IF
 21233
 21234
 21235* EXEC CICS REWRITE
 21236*       DATASET  (CRTT-ID)
 21237*       FROM     (CERTIFICATE-TRAILERS)
 21238*    END-EXEC.
 21239     MOVE LENGTH OF
 21240      CERTIFICATE-TRAILERS
 21241       TO DFHEIV11
 21242*    MOVE '&& L                  %   #00020275' TO DFHEIV0
 21243     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21244     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21245     MOVE X'2020233030303230323735' TO DFHEIV0(25:11)
 21246     CALL 'kxdfhei1' USING DFHEIV0,
 21247           CRTT-ID,
 21248           CERTIFICATE-TRAILERS,
 21249           DFHEIV11,
 21250           DFHEIV99
 21251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21252
 21253
 21254     GO TO 8195-EXIT.
 21255
 21256 8195-NOTFND.
 21257
 21258     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21259     MOVE 'CS'         TO CS-RECORD-ID.
 21260     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21261     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21262     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21263     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21264     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21265
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 392
* EL050.cbl
 21266* EXEC CICS WRITE
 21267*       DATASET  (CRTT-ID)
 21268*       RIDFLD   (WS-ELCRTT-KEY)
 21269*       FROM     (CERTIFICATE-TRAILERS)
 21270*    END-EXEC.
 21271     MOVE LENGTH OF
 21272      CERTIFICATE-TRAILERS
 21273       TO DFHEIV11
 21274*    MOVE '&$ L                  ''   #00020291' TO DFHEIV0
 21275     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21276     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21277     MOVE X'2020233030303230323931' TO DFHEIV0(25:11)
 21278     CALL 'kxdfhei1' USING DFHEIV0,
 21279           CRTT-ID,
 21280           CERTIFICATE-TRAILERS,
 21281           DFHEIV11,
 21282           WS-ELCRTT-KEY,
 21283           DFHEIV99,
 21284           DFHEIV99
 21285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21286
 21287
 21288 8195-EXIT.
 21289     EXIT.
 21290
 21291 8200-READ-REIN-TABLE.
 21292
 21293* EXEC CICS HANDLE CONDITION
 21294*         NOTFND   (8200-NOTFND)
 21295*    END-EXEC.
 21296*    MOVE '"$I                   ! 2 #00020301' TO DFHEIV0
 21297     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21298     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21299     MOVE X'3220233030303230333031' TO DFHEIV0(25:11)
 21300     CALL 'kxdfhei1' USING DFHEIV0
 21301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21302
 21303
 21304
 21305* EXEC CICS READ
 21306*        DATASET     (REIN-ID)
 21307*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21308*        RIDFLD      (ERREIN-KEY)
 21309*    END-EXEC.
 21310*    MOVE '&"S        E          (   #00020305' TO DFHEIV0
 21311     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21312     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21313     MOVE X'2020233030303230333035' TO DFHEIV0(25:11)
 21314     CALL 'kxdfhei1' USING DFHEIV0,
 21315           REIN-ID,
 21316           DFHEIV20,
 21317           DFHEIV99,
 21318           ERREIN-KEY,
 21319           DFHEIV99,
 21320           DFHEIV99,
 21321           DFHEIV99
 21322     SET ADDRESS OF REINSURANCE-RECORD TO
 21323         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 393
* EL050.cbl
 21324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21325
 21326
 21327     GO TO 8200-EXIT.
 21328
 21329 8200-NOTFND.
 21330     MOVE 'N'             TO WS-REIN-READ-SW.
 21331
 21332 8200-EXIT.
 21333      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 394
* EL050.cbl
 21335
 21336 8300-READ-CTBL-TABLE.
 21337
 21338* EXEC CICS HANDLE CONDITION
 21339*        NOTFND    (8300-NOTFND)
 21340*        DISABLED  (8300-ERRESS-PROBLEM)
 21341*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21342*        ENDFILE   (8300-NOTFND)
 21343*    END-EXEC.
 21344*    MOVE '"$IcJ''                ! 3 #00020321' TO DFHEIV0
 21345     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21346     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21347     MOVE X'3320233030303230333231' TO DFHEIV0(25:11)
 21348     CALL 'kxdfhei1' USING DFHEIV0
 21349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21350
 21351
 21352
 21353* EXEC CICS READ
 21354*        DATASET     (CTBL-ID)
 21355*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21356*        RIDFLD      (ERCTBL-KEY)
 21357*    END-EXEC.
 21358*    MOVE '&"S        E          (   #00020328' TO DFHEIV0
 21359     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21361     MOVE X'2020233030303230333238' TO DFHEIV0(25:11)
 21362     CALL 'kxdfhei1' USING DFHEIV0,
 21363           CTBL-ID,
 21364           DFHEIV20,
 21365           DFHEIV99,
 21366           ERCTBL-KEY,
 21367           DFHEIV99,
 21368           DFHEIV99,
 21369           DFHEIV99
 21370     SET ADDRESS OF COMM-TABLE-RECORD TO
 21371         DFHEIV20
 21372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21373
 21374
 21375     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21376
 21377     GO TO 8300-EXIT.
 21378
 21379 8300-NOTFND.
 21380
 21381     IF CTBL-SW = '0530'
 21382         MOVE 'AA'                     TO WS-AH-COMP-CD
 21383         MOVE '0550'                   TO CTBL-SW
 21384         MOVE '1'                      TO WS-CTBL-READ-SW
 21385         GO TO 8300-EXIT.
 21386
 21387     IF CTBL-SW = '0540'
 21388         MOVE 'AA'                     TO WS-LF-COMP-CD
 21389         MOVE '0550'                   TO CTBL-SW
 21390         MOVE '1'                      TO WS-CTBL-READ-SW
 21391         GO TO 8300-EXIT.
 21392
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 395
* EL050.cbl
 21393     IF CTBL-SW = '0550'
 21394         MOVE '2'                      TO WS-CTBL-READ-SW
 21395         GO TO 8300-EXIT.
 21396
 21397     GO TO 8300-EXIT.
 21398
 21399 8300-ERRESS-PROBLEM.
 21400
 21401      MOVE ER-8050              TO WS-ERROR.
 21402      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21403
 21404     GO TO 8300-EXIT.
 21405
 21406 8300-EXIT.
 21407      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 396
* EL050.cbl
 21409
 21410
 21411 8400-GETMAIN-ERFORM.
 21412
 21413
 21414* EXEC CICS   GETMAIN
 21415*        LENGTH  (500)
 21416*        SET     (ADDRESS OF FORM-MASTER)
 21417*    END-EXEC.
 21418     MOVE 500
 21419       TO DFHEIV11
 21420*    MOVE '," L                  $   #00020372' TO DFHEIV0
 21421     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21422     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21423     MOVE X'2020233030303230333732' TO DFHEIV0(25:11)
 21424     CALL 'kxdfhei1' USING DFHEIV0,
 21425           DFHEIV20,
 21426           DFHEIV11,
 21427           DFHEIV99
 21428     SET ADDRESS OF FORM-MASTER TO
 21429         DFHEIV20
 21430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21431
 21432
 21433     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21434
 21435 8400-EXIT.
 21436      EXIT.
 21437
 21438 8450-READ-FORM-MASTER.
 21439
 21440
 21441* EXEC CICS  HANDLE CONDITION
 21442*        NOTFND   (8450-FORM-NOT-FOUND)
 21443*        ENDFILE  (8450-FORM-NOT-FOUND)
 21444*    END-EXEC.
 21445*    MOVE '"$I''                  ! 4 #00020384' TO DFHEIV0
 21446     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21447     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21448     MOVE X'3420233030303230333834' TO DFHEIV0(25:11)
 21449     CALL 'kxdfhei1' USING DFHEIV0
 21450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21451
 21452
 21453
 21454* EXEC CICS   READ
 21455*        DATASET   (FORM-ID)
 21456*        RIDFLD    (ERFORM-KEY)
 21457*        INTO      (FORM-MASTER)
 21458*        GTEQ
 21459*    END-EXEC.
 21460     MOVE LENGTH OF
 21461      FORM-MASTER
 21462       TO DFHEIV11
 21463*    MOVE '&"IL       G          (   #00020389' TO DFHEIV0
 21464     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21465     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21466     MOVE X'2020233030303230333839' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 397
* EL050.cbl
 21467     CALL 'kxdfhei1' USING DFHEIV0,
 21468           FORM-ID,
 21469           FORM-MASTER,
 21470           DFHEIV11,
 21471           ERFORM-KEY,
 21472           DFHEIV99,
 21473           DFHEIV99,
 21474           DFHEIV99
 21475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21476
 21477
 21478     MOVE  'Y'           TO  FORM-MASTER-SW.
 21479
 21480     GO TO  8450-EXIT.
 21481
 21482 8450-FORM-NOT-FOUND.
 21483
 21484     MOVE  'N'           TO  FORM-MASTER-SW.
 21485
 21486 8450-EXIT.
 21487      EXIT.
 21488
 21489 8500-DATE-CONVERT.
 21490
 21491* EXEC CICS LINK
 21492*        PROGRAM    ('ELDATCV')
 21493*        COMMAREA   (DATE-CONVERSION-DATA)
 21494*        LENGTH     (DC-COMM-LENGTH)
 21495*    END-EXEC.
 21496     MOVE 'ELDATCV' TO DFHEIV1
 21497*    MOVE '."C                   (   #00020408' TO DFHEIV0
 21498     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21499     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21500     MOVE X'2020233030303230343038' TO DFHEIV0(25:11)
 21501     CALL 'kxdfhei1' USING DFHEIV0,
 21502           DFHEIV1,
 21503           DATE-CONVERSION-DATA,
 21504           DC-COMM-LENGTH,
 21505           DFHEIV99,
 21506           DFHEIV99,
 21507           DFHEIV99,
 21508           DFHEIV99
 21509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21510
 21511
 21512 8500-EXIT.
 21513     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 398
* EL050.cbl
 21515
 21516 8555-RELOAD-CONTROL-FILE.
 21517     CONTINUE.
 21518
 21519 8555-EXIT.
 21520     EXIT.
 21521
 21522 8557-GETMAIN-ERPLAN.
 21523
 21524
 21525* EXEC CICS GETMAIN
 21526*        LENGTH    (840)
 21527*        SET       (ADDRESS OF PLAN-RECORDS)
 21528*    END-EXEC.
 21529     MOVE 840
 21530       TO DFHEIV11
 21531*    MOVE '," L                  $   #00020426' TO DFHEIV0
 21532     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21533     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21534     MOVE X'2020233030303230343236' TO DFHEIV0(25:11)
 21535     CALL 'kxdfhei1' USING DFHEIV0,
 21536           DFHEIV20,
 21537           DFHEIV11,
 21538           DFHEIV99
 21539     SET ADDRESS OF PLAN-RECORDS TO
 21540         DFHEIV20
 21541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21542
 21543
 21544     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21545
 21546 8557-EXIT.
 21547     EXIT.
 21548
 21549 8560-GETMAIN.
 21550
 21551* EXEC CICS GETMAIN
 21552*        LENGTH    (2000)
 21553*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21554*    END-EXEC.
 21555     MOVE 2000
 21556       TO DFHEIV11
 21557*    MOVE '," L                  $   #00020437' TO DFHEIV0
 21558     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21559     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21560     MOVE X'2020233030303230343337' TO DFHEIV0(25:11)
 21561     CALL 'kxdfhei1' USING DFHEIV0,
 21562           DFHEIV20,
 21563           DFHEIV11,
 21564           DFHEIV99
 21565     SET ADDRESS OF ACCOUNT-MASTER TO
 21566         DFHEIV20
 21567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21568
 21569
 21570     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21571
 21572 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 399
* EL050.cbl
 21573     EXIT.
 21574
 21575 8570-START-ACCOUNT-MASTER.
 21576
 21577* EXEC CICS HANDLE CONDITION
 21578*        NOTFND    (0199-ACCT-NOT-FOUND)
 21579*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21580*    END-EXEC.
 21581*    MOVE '"$I''                  ! 5 #00020448' TO DFHEIV0
 21582     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21583     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21584     MOVE X'3520233030303230343438' TO DFHEIV0(25:11)
 21585     CALL 'kxdfhei1' USING DFHEIV0
 21586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21587
 21588
 21589
 21590* EXEC CICS STARTBR
 21591*        DATASET    (ACCT-ID)
 21592*        RIDFLD     (ERACCT-KEY)
 21593*        GTEQ
 21594*    END-EXEC.
 21595     MOVE 0
 21596       TO DFHEIV11
 21597*    MOVE '&,         G          &   #00020453' TO DFHEIV0
 21598     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21599     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21600     MOVE X'2020233030303230343533' TO DFHEIV0(25:11)
 21601     CALL 'kxdfhei1' USING DFHEIV0,
 21602           ACCT-ID,
 21603           ERACCT-KEY,
 21604           DFHEIV99,
 21605           DFHEIV11,
 21606           DFHEIV99
 21607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21608
 21609
 21610 8570-EXIT.
 21611     EXIT.
 21612
 21613 8580-READ-ACCOUNT-MASTER.
 21614
 21615* EXEC CICS HANDLE CONDITION
 21616*        NOTFND    (0199-ACCT-NOT-FOUND)
 21617*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21618*    END-EXEC.
 21619*    MOVE '"$I''                  ! 6 #00020463' TO DFHEIV0
 21620     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21622     MOVE X'3620233030303230343633' TO DFHEIV0(25:11)
 21623     CALL 'kxdfhei1' USING DFHEIV0
 21624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21625
 21626
 21627
 21628* EXEC CICS READNEXT
 21629*        DATASET     (ACCT-ID)
 21630*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 400
* EL050.cbl
 21631*        RIDFLD      (ERACCT-KEY)
 21632*    END-EXEC.
 21633     MOVE LENGTH OF
 21634      ACCOUNT-MASTER
 21635       TO DFHEIV12
 21636     MOVE 0
 21637       TO DFHEIV11
 21638*    MOVE '&.IL                  )   #00020468' TO DFHEIV0
 21639     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21640     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21641     MOVE X'2020233030303230343638' TO DFHEIV0(25:11)
 21642     CALL 'kxdfhei1' USING DFHEIV0,
 21643           ACCT-ID,
 21644           ACCOUNT-MASTER,
 21645           DFHEIV12,
 21646           ERACCT-KEY,
 21647           DFHEIV99,
 21648           DFHEIV11,
 21649           DFHEIV99,
 21650           DFHEIV99
 21651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21652
 21653
 21654 8580-EXIT.
 21655     EXIT.
 21656
 21657 8582-READ-COMPENSATION-MASTER.
 21658
 21659* EXEC CICS HANDLE CONDITION
 21660*        NOTFND    (8582-COMP-NOT-FOUND)
 21661*        ENDFILE   (8582-COMP-NOT-FOUND)
 21662*    END-EXEC.
 21663*    MOVE '"$I''                  ! 7 #00020478' TO DFHEIV0
 21664     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21666     MOVE X'3720233030303230343738' TO DFHEIV0(25:11)
 21667     CALL 'kxdfhei1' USING DFHEIV0
 21668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21669
 21670
 21671
 21672* EXEC CICS READ
 21673*        DATASET     (COMP-ID)
 21674*        INTO        (COMPENSATION-MASTER)
 21675*        RIDFLD      (ERCOMP-KEY)
 21676*    END-EXEC.
 21677     MOVE LENGTH OF
 21678      COMPENSATION-MASTER
 21679       TO DFHEIV11
 21680*    MOVE '&"IL       E          (   #00020483' TO DFHEIV0
 21681     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21682     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21683     MOVE X'2020233030303230343833' TO DFHEIV0(25:11)
 21684     CALL 'kxdfhei1' USING DFHEIV0,
 21685           COMP-ID,
 21686           COMPENSATION-MASTER,
 21687           DFHEIV11,
 21688           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 401
* EL050.cbl
 21689           DFHEIV99,
 21690           DFHEIV99,
 21691           DFHEIV99
 21692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21693
 21694
 21695     MOVE 'Y'                    TO COMP-MASTER-SW
 21696
 21697     GO TO 8582-EXIT
 21698     .
 21699 8582-COMP-NOT-FOUND.
 21700
 21701     MOVE 'N'                    TO COMP-MASTER-SW.
 21702
 21703 8582-EXIT.
 21704     EXIT.
 21705
 21706 8583-READ-ERAGTC.
 21707
 21708* EXEC CICS HANDLE CONDITION
 21709*        NOTFND    (8583-AGTC-NOT-FOUND)
 21710*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21711*    END-EXEC.
 21712*    MOVE '"$I''                  ! 8 #00020501' TO DFHEIV0
 21713     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21715     MOVE X'3820233030303230353031' TO DFHEIV0(25:11)
 21716     CALL 'kxdfhei1' USING DFHEIV0
 21717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21718
 21719
 21720
 21721* EXEC CICS STARTBR
 21722*        DATASET    (AGTC-ID)
 21723*        RIDFLD     (ERAGTC-KEY)
 21724*        GTEQ
 21725*    END-EXEC.
 21726     MOVE 0
 21727       TO DFHEIV11
 21728*    MOVE '&,         G          &   #00020506' TO DFHEIV0
 21729     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21730     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21731     MOVE X'2020233030303230353036' TO DFHEIV0(25:11)
 21732     CALL 'kxdfhei1' USING DFHEIV0,
 21733           AGTC-ID,
 21734           ERAGTC-KEY,
 21735           DFHEIV99,
 21736           DFHEIV11,
 21737           DFHEIV99
 21738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21739
 21740
 21741 8583-READ-ERAGTC-NEXT.
 21742
 21743* EXEC CICS READNEXT
 21744*        DATASET     (AGTC-ID)
 21745*        INTO        (AGENT-COMMISSIONS)
 21746*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 402
* EL050.cbl
 21747*    END-EXEC.
 21748     MOVE LENGTH OF
 21749      AGENT-COMMISSIONS
 21750       TO DFHEIV12
 21751     MOVE 0
 21752       TO DFHEIV11
 21753*    MOVE '&.IL                  )   #00020513' TO DFHEIV0
 21754     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21755     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21756     MOVE X'2020233030303230353133' TO DFHEIV0(25:11)
 21757     CALL 'kxdfhei1' USING DFHEIV0,
 21758           AGTC-ID,
 21759           AGENT-COMMISSIONS,
 21760           DFHEIV12,
 21761           ERAGTC-KEY,
 21762           DFHEIV99,
 21763           DFHEIV11,
 21764           DFHEIV99,
 21765           DFHEIV99
 21766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21767
 21768
 21769*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21770
 21771     GO TO 8583-EXIT
 21772     .
 21773 8583-AGTC-NOT-FOUND.
 21774
 21775     MOVE 'N'                    TO AGTC-MASTER-SW.
 21776
 21777 8583-EXIT.
 21778     EXIT.
 21779
 21780 8584-READ-BANK-CROSS-REF.
 21781
 21782* EXEC CICS HANDLE CONDITION
 21783*        NOTFND    (8584-BXRF-NOT-FOUND)
 21784*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21785*    END-EXEC.
 21786*    MOVE '"$I''                  ! 9 #00020531' TO DFHEIV0
 21787     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21788     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21789     MOVE X'3920233030303230353331' TO DFHEIV0(25:11)
 21790     CALL 'kxdfhei1' USING DFHEIV0
 21791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21792
 21793
 21794
 21795* EXEC CICS READ
 21796*        DATASET     (BXRF-ID)
 21797*        INTO        (BANK-CROSS-REFERENCE)
 21798*        RIDFLD      (ERBXRF-KEY)
 21799*        LENGTH      (BXRF-REC-LENGTH)
 21800*    END-EXEC.
 21801*    MOVE '&"IL       E          (   #00020536' TO DFHEIV0
 21802     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21803     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21804     MOVE X'2020233030303230353336' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 403
* EL050.cbl
 21805     CALL 'kxdfhei1' USING DFHEIV0,
 21806           BXRF-ID,
 21807           BANK-CROSS-REFERENCE,
 21808           BXRF-REC-LENGTH,
 21809           ERBXRF-KEY,
 21810           DFHEIV99,
 21811           DFHEIV99,
 21812           DFHEIV99
 21813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21814
 21815
 21816     MOVE 'Y'                    TO BXRF-MASTER-SW
 21817
 21818     GO TO 8584-EXIT
 21819     .
 21820 8584-BXRF-NOT-FOUND.
 21821
 21822     MOVE 'N'                    TO BXRF-MASTER-SW.
 21823
 21824 8584-EXIT.
 21825     EXIT.
 21826
 21827 8585-READ-PLAN-MASTER.
 21828
 21829
 21830* EXEC CICS HANDLE CONDITION
 21831*        NOTFND    (8585-PLAN-NOT-FOUND)
 21832*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21833*    END-EXEC.
 21834*    MOVE '"$I''                  ! : #00020556' TO DFHEIV0
 21835     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21836     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21837     MOVE X'3A20233030303230353536' TO DFHEIV0(25:11)
 21838     CALL 'kxdfhei1' USING DFHEIV0
 21839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21840
 21841
 21842
 21843* EXEC CICS READ
 21844*        DATASET     (PLAN-ID)
 21845*        INTO        (PLAN-MASTER)
 21846*        RIDFLD      (ERPLAN-KEY)
 21847*    END-EXEC.
 21848     MOVE LENGTH OF
 21849      PLAN-MASTER
 21850       TO DFHEIV11
 21851*    MOVE '&"IL       E          (   #00020561' TO DFHEIV0
 21852     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21853     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21854     MOVE X'2020233030303230353631' TO DFHEIV0(25:11)
 21855     CALL 'kxdfhei1' USING DFHEIV0,
 21856           PLAN-ID,
 21857           PLAN-MASTER,
 21858           DFHEIV11,
 21859           ERPLAN-KEY,
 21860           DFHEIV99,
 21861           DFHEIV99,
 21862           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 404
* EL050.cbl
 21863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21864
 21865
 21866     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21867
 21868     GO TO 8585-EXIT.
 21869
 21870 8585-PLAN-NOT-FOUND.
 21871
 21872     MOVE 'N'                    TO PLAN-MASTER-SW.
 21873
 21874 8585-EXIT.
 21875     EXIT.
 21876
 21877 8586-READ-LOAN-OFFICER.
 21878
 21879* EXEC CICS READ
 21880*        DATASET     (LOFC-ID)
 21881*        INTO        (LOAN-OFFICER-MASTER)
 21882*        RIDFLD      (ERLOFC-KEY)
 21883*        RESP        (WS-RESPONSE)
 21884*    END-EXEC
 21885     MOVE LENGTH OF
 21886      LOAN-OFFICER-MASTER
 21887       TO DFHEIV11
 21888*    MOVE '&"IL       E          (  N#00020579' TO DFHEIV0
 21889     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21890     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21891     MOVE X'204E233030303230353739' TO DFHEIV0(25:11)
 21892     CALL 'kxdfhei1' USING DFHEIV0,
 21893           LOFC-ID,
 21894           LOAN-OFFICER-MASTER,
 21895           DFHEIV11,
 21896           ERLOFC-KEY,
 21897           DFHEIV99,
 21898           DFHEIV99,
 21899           DFHEIV99
 21900     MOVE EIBRESP  TO WS-RESPONSE
 21901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21902
 21903     IF WS-RESP-NORMAL
 21904        MOVE 'Y'                 TO LOFC-MASTER-SW
 21905     ELSE
 21906        MOVE 'N'                 TO LOFC-MASTER-SW
 21907     END-IF
 21908     .
 21909 8586-EXIT.
 21910     EXIT.
 21911 8587-START-ERPDEF.
 21912
 21913* EXEC CICS STARTBR
 21914*       DATASET   (PDEF-ID)
 21915*       RIDFLD    (ERPDEF-KEY)
 21916*       GTEQ
 21917*       RESP      (WS-RESPONSE)
 21918*    END-EXEC
 21919     MOVE 0
 21920       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 405
* EL050.cbl
 21921*    MOVE '&,         G          &  N#00020595' TO DFHEIV0
 21922     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21923     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21924     MOVE X'204E233030303230353935' TO DFHEIV0(25:11)
 21925     CALL 'kxdfhei1' USING DFHEIV0,
 21926           PDEF-ID,
 21927           ERPDEF-KEY,
 21928           DFHEIV99,
 21929           DFHEIV11,
 21930           DFHEIV99
 21931     MOVE EIBRESP  TO WS-RESPONSE
 21932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21933     IF WS-RESP-NORMAL
 21934        MOVE 'Y'                 TO PDEF-MASTER-SW
 21935     ELSE
 21936        MOVE 'N'                 TO PDEF-MASTER-SW
 21937     END-IF
 21938     .
 21939 8587-EXIT.
 21940     EXIT.
 21941 8588-READ-ERPDEF.
 21942
 21943* EXEC CICS READNEXT
 21944*       DATASET   (PDEF-ID)
 21945*       RIDFLD    (ERPDEF-KEY)
 21946*       INTO      (PRODUCT-MASTER)
 21947*       RESP      (WS-RESPONSE)
 21948*    END-EXEC
 21949     MOVE LENGTH OF
 21950      PRODUCT-MASTER
 21951       TO DFHEIV12
 21952     MOVE 0
 21953       TO DFHEIV11
 21954*    MOVE '&.IL                  )  N#00020610' TO DFHEIV0
 21955     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21956     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21957     MOVE X'204E233030303230363130' TO DFHEIV0(25:11)
 21958     CALL 'kxdfhei1' USING DFHEIV0,
 21959           PDEF-ID,
 21960           PRODUCT-MASTER,
 21961           DFHEIV12,
 21962           ERPDEF-KEY,
 21963           DFHEIV99,
 21964           DFHEIV11,
 21965           DFHEIV99,
 21966           DFHEIV99
 21967     MOVE EIBRESP  TO WS-RESPONSE
 21968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21969     IF WS-RESP-NORMAL
 21970        MOVE 'Y'                 TO PDEF-MASTER-SW
 21971     ELSE
 21972        MOVE 'N'                 TO PDEF-MASTER-SW
 21973     END-IF
 21974     .
 21975 8588-EXIT.
 21976     EXIT.
 21977 8589-ENDBR-ERPDEF.
 21978
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 406
* EL050.cbl
 21979* EXEC CICS ENDBR
 21980*       DATASET   (PDEF-ID)
 21981*    END-EXEC
 21982     MOVE 0
 21983       TO DFHEIV11
 21984*    MOVE '&2                    $   #00020625' TO DFHEIV0
 21985     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21986     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21987     MOVE X'2020233030303230363235' TO DFHEIV0(25:11)
 21988     CALL 'kxdfhei1' USING DFHEIV0,
 21989           PDEF-ID,
 21990           DFHEIV11,
 21991           DFHEIV99
 21992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21993     .
 21994 8589-EXIT.
 21995     EXIT.
 21996 8590-READ-CERT-MASTER.
 21997     IF PB-COMPANY-ID = 'UCL'
 21998         GO TO 8690-READ-CERT-MASTER-UCL.
 21999
 22000
 22001* EXEC CICS HANDLE CONDITION
 22002*         NOTFND    (0299-CERT-NOT-FOUND)
 22003*    END-EXEC.
 22004*    MOVE '"$I                   ! ; #00020635' TO DFHEIV0
 22005     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22007     MOVE X'3B20233030303230363335' TO DFHEIV0(25:11)
 22008     CALL 'kxdfhei1' USING DFHEIV0
 22009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22010
 22011
 22012
 22013* EXEC CICS READ
 22014*        DATASET     (CERT-ID)
 22015*        INTO        (CERTIFICATE-MASTER)
 22016*        RIDFLD      (ELCERT-KEY)
 22017*        UPDATE
 22018*    END-EXEC.
 22019     MOVE LENGTH OF
 22020      CERTIFICATE-MASTER
 22021       TO DFHEIV11
 22022*    MOVE '&"IL       EU         (   #00020639' TO DFHEIV0
 22023     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22024     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22025     MOVE X'2020233030303230363339' TO DFHEIV0(25:11)
 22026     CALL 'kxdfhei1' USING DFHEIV0,
 22027           CERT-ID,
 22028           CERTIFICATE-MASTER,
 22029           DFHEIV11,
 22030           ELCERT-KEY,
 22031           DFHEIV99,
 22032           DFHEIV99,
 22033           DFHEIV99
 22034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22035
 22036
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 407
* EL050.cbl
 22037 8590-EXIT.
 22038     EXIT.
 22039
 22040 8690-READ-CERT-MASTER-UCL.
 22041
 22042* EXEC CICS HANDLE CONDITION
 22043*         NOTFND    (8700-READ-CERT-MASTER)
 22044*    END-EXEC.
 22045*    MOVE '"$I                   ! < #00020650' TO DFHEIV0
 22046     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22047     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22048     MOVE X'3C20233030303230363530' TO DFHEIV0(25:11)
 22049     CALL 'kxdfhei1' USING DFHEIV0
 22050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22051
 22052
 22053 8690-READ-CERT-CONT.
 22054
 22055* EXEC CICS READ
 22056*        DATASET     (CERT-ID)
 22057*        INTO        (CERTIFICATE-MASTER)
 22058*        RIDFLD      (ELCERT-KEY)
 22059*        UPDATE
 22060*    END-EXEC.
 22061     MOVE LENGTH OF
 22062      CERTIFICATE-MASTER
 22063       TO DFHEIV11
 22064*    MOVE '&"IL       EU         (   #00020655' TO DFHEIV0
 22065     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22066     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22067     MOVE X'2020233030303230363535' TO DFHEIV0(25:11)
 22068     CALL 'kxdfhei1' USING DFHEIV0,
 22069           CERT-ID,
 22070           CERTIFICATE-MASTER,
 22071           DFHEIV11,
 22072           ELCERT-KEY,
 22073           DFHEIV99,
 22074           DFHEIV99,
 22075           DFHEIV99
 22076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22077
 22078
 22079     GO TO 8590-EXIT.
 22080
 22081 8700-READ-CERT-MASTER.
 22082     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 22083     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 22084
 22085* EXEC CICS HANDLE CONDITION
 22086*         DUPKEY    (8720-COMP-ACCOUNTS)
 22087*         ENDFILE   (8730-END-BROWSE)
 22088*         NOTFND    (8740-NOT-FOUND)
 22089*    END-EXEC.
 22090*    MOVE '"$$''I                 ! = #00020667' TO DFHEIV0
 22091     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 22092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22093     MOVE X'3D20233030303230363637' TO DFHEIV0(25:11)
 22094     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 408
* EL050.cbl
 22095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22096
 22097
 22098
 22099* EXEC CICS STARTBR
 22100*        DATASET     ('ELCERT5')
 22101*        RIDFLD      (ELCERT2-KEY)
 22102*        EQUAL
 22103*    END-EXEC.
 22104     MOVE 'ELCERT5' TO DFHEIV1
 22105     MOVE 0
 22106       TO DFHEIV11
 22107*    MOVE '&,         E          &   #00020673' TO DFHEIV0
 22108     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 22109     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22110     MOVE X'2020233030303230363733' TO DFHEIV0(25:11)
 22111     CALL 'kxdfhei1' USING DFHEIV0,
 22112           DFHEIV1,
 22113           ELCERT2-KEY,
 22114           DFHEIV99,
 22115           DFHEIV11,
 22116           DFHEIV99
 22117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22118
 22119
 22120 8710-READ-NEXT.
 22121
 22122* EXEC CICS READNEXT
 22123*        DATASET     ('ELCERT5')
 22124*        INTO        (CERTIFICATE-MASTER)
 22125*        RIDFLD      (ELCERT2-KEY)
 22126*    END-EXEC.
 22127     MOVE LENGTH OF
 22128      CERTIFICATE-MASTER
 22129       TO DFHEIV12
 22130     MOVE 'ELCERT5' TO DFHEIV1
 22131     MOVE 0
 22132       TO DFHEIV11
 22133*    MOVE '&.IL                  )   #00020680' TO DFHEIV0
 22134     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22135     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22136     MOVE X'2020233030303230363830' TO DFHEIV0(25:11)
 22137     CALL 'kxdfhei1' USING DFHEIV0,
 22138           DFHEIV1,
 22139           CERTIFICATE-MASTER,
 22140           DFHEIV12,
 22141           ELCERT2-KEY,
 22142           DFHEIV99,
 22143           DFHEIV11,
 22144           DFHEIV99,
 22145           DFHEIV99
 22146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22147
 22148
 22149 8720-COMP-ACCOUNTS.
 22150
 22151* EXEC CICS ENTER
 22152*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 409
* EL050.cbl
 22153*         FROM (PB-C-LAST-NAME)
 22154*    END-EXEC.
 22155     MOVE 001
 22156       TO DFHEIV11
 22157*    MOVE ':$F                   %   #00020687' TO DFHEIV0
 22158     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22159     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22160     MOVE X'2020233030303230363837' TO DFHEIV0(25:11)
 22161     CALL 'kxdfhei1' USING DFHEIV0,
 22162           DFHEIV11,
 22163           PB-C-LAST-NAME,
 22164           DFHEIV99,
 22165           DFHEIV99
 22166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22167
 22168
 22169
 22170* EXEC CICS ENTER
 22171*         TRACEID (002)
 22172*         FROM (CM-INSURED-LAST-NAME)
 22173*    END-EXEC.
 22174     MOVE 002
 22175       TO DFHEIV11
 22176*    MOVE ':$F                   %   #00020692' TO DFHEIV0
 22177     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22178     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22179     MOVE X'2020233030303230363932' TO DFHEIV0(25:11)
 22180     CALL 'kxdfhei1' USING DFHEIV0,
 22181           DFHEIV11,
 22182           CM-INSURED-LAST-NAME,
 22183           DFHEIV99,
 22184           DFHEIV99
 22185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22186
 22187
 22188     IF PB-CERT-NO NOT = CM-CERT-NO
 22189         GO TO 8730-END-BROWSE.
 22190
 22191     IF PB-ACCOUNT = CM-ACCOUNT
 22192         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22193             MOVE ER-2799        TO WS-ERROR
 22194             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22195             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22196             GO TO 8730-END-BROWSE.
 22197
 22198     GO TO 8710-READ-NEXT.
 22199
 22200 8730-END-BROWSE.
 22201
 22202* EXEC CICS ENDBR
 22203*         DATASET    ('ELCERT5')
 22204*    END-EXEC.
 22205     MOVE 'ELCERT5' TO DFHEIV1
 22206     MOVE 0
 22207       TO DFHEIV11
 22208*    MOVE '&2                    $   #00020710' TO DFHEIV0
 22209     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22210     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 410
* EL050.cbl
 22211     MOVE X'2020233030303230373130' TO DFHEIV0(25:11)
 22212     CALL 'kxdfhei1' USING DFHEIV0,
 22213           DFHEIV1,
 22214           DFHEIV11,
 22215           DFHEIV99
 22216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22217
 22218
 22219 8740-NOT-FOUND.
 22220     GO TO 0299-CERT-NOT-FOUND.
 22221
 22222 8750-START-ELSTAT.
 22223
 22224* EXEC CICS STARTBR
 22225*       DATASET   (STAT-ID)
 22226*       RIDFLD    (ELSTAT-KEY)
 22227*       GTEQ
 22228*       RESP      (WS-RESPONSE)
 22229*    END-EXEC
 22230     MOVE 0
 22231       TO DFHEIV11
 22232*    MOVE '&,         G          &  N#00020718' TO DFHEIV0
 22233     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22234     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22235     MOVE X'204E233030303230373138' TO DFHEIV0(25:11)
 22236     CALL 'kxdfhei1' USING DFHEIV0,
 22237           STAT-ID,
 22238           ELSTAT-KEY,
 22239           DFHEIV99,
 22240           DFHEIV11,
 22241           DFHEIV99
 22242     MOVE EIBRESP  TO WS-RESPONSE
 22243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22244     IF WS-RESP-NORMAL
 22245        MOVE 'Y'                 TO STAT-MASTER-SW
 22246     ELSE
 22247        MOVE 'N'                 TO STAT-MASTER-SW
 22248     END-IF
 22249     .
 22250 8750-EXIT.
 22251     EXIT.
 22252 8752-READ-ELSTAT.
 22253
 22254* EXEC CICS READNEXT
 22255*       DATASET   (STAT-ID)
 22256*       RIDFLD    (ELSTAT-KEY)
 22257*       INTO      (STATE-FILE)
 22258*       RESP      (WS-RESPONSE)
 22259*    END-EXEC
 22260     MOVE LENGTH OF
 22261      STATE-FILE
 22262       TO DFHEIV12
 22263     MOVE 0
 22264       TO DFHEIV11
 22265*    MOVE '&.IL                  )  N#00020733' TO DFHEIV0
 22266     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22267     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22268     MOVE X'204E233030303230373333' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 411
* EL050.cbl
 22269     CALL 'kxdfhei1' USING DFHEIV0,
 22270           STAT-ID,
 22271           STATE-FILE,
 22272           DFHEIV12,
 22273           ELSTAT-KEY,
 22274           DFHEIV99,
 22275           DFHEIV11,
 22276           DFHEIV99,
 22277           DFHEIV99
 22278     MOVE EIBRESP  TO WS-RESPONSE
 22279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22280     IF WS-RESP-NORMAL
 22281        MOVE 'Y'                 TO STAT-MASTER-SW
 22282     ELSE
 22283        MOVE 'N'                 TO STAT-MASTER-SW
 22284     END-IF
 22285     .
 22286 8752-EXIT.
 22287     EXIT.
 22288 8800-GET-COMP-RATE.
 22289     MOVE +1 TO IB.
 22290     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22291         ADD +9 TO IB
 22292         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22293             ADD +9 TO IB
 22294             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22295                MOVE ZEROS       TO WS-WK-RATE
 22296                GO TO 8800-EXIT.
 22297
 22298     IF PB-I-AGE GREATER CT-AGE (1)
 22299         ADD +3 TO IB
 22300         IF PB-I-AGE GREATER CT-AGE (2)
 22301             ADD +3 TO IB
 22302             IF PB-I-AGE GREATER CT-AGE (3)
 22303                MOVE ZEROS       TO WS-WK-RATE
 22304                GO TO 8800-EXIT.
 22305
 22306     IF WS-WORK-TERM GREATER CT-TRM (1)
 22307         ADD +1 TO IB
 22308         IF WS-WORK-TERM GREATER CT-TRM (2)
 22309             ADD +1 TO IB
 22310             IF WS-WORK-TERM GREATER CT-TRM (3)
 22311                MOVE ZEROS       TO WS-WK-RATE
 22312                GO TO 8800-EXIT.
 22313
 22314     IF CT-RT (IB) NOT NUMERIC
 22315         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22316         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22317         GO TO 8800-GET-COMP-RATE.
 22318
 22319     MOVE CT-RT (IB) TO WS-WK-RATE.
 22320
 22321 8800-EXIT.
 22322     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 412
* EL050.cbl
 22324 8900-ADDRESS-FILE.
 22325     IF ERACCT-FILE-ADDRESSED
 22326         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22327         GO TO 8900-ADDRESS-EXIT.
 22328
 22329     IF ELCNTL-FILE-ADDRESSED
 22330         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22331         GO TO 8900-ADDRESS-EXIT.
 22332
 22333     IF ERPLAN-FILE-ADDRESSED
 22334         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22335         GO TO 8900-ADDRESS-EXIT.
 22336
 22337     IF ERFORM-FILE-ADDRESSED
 22338         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22339         GO TO 8900-ADDRESS-EXIT.
 22340
 22341 8900-ADDRESS-EXIT.
 22342     EXIT.
 22343
 22344 9000-READ-CONTROL.
 22345
 22346* EXEC CICS HANDLE CONDITION
 22347*        NOTFND    (9000-NOTFND)
 22348*    END-EXEC.
 22349*    MOVE '"$I                   ! > #00020804' TO DFHEIV0
 22350     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22352     MOVE X'3E20233030303230383034' TO DFHEIV0(25:11)
 22353     CALL 'kxdfhei1' USING DFHEIV0
 22354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22355
 22356
 22357
 22358* EXEC CICS READ
 22359*        DATASET     (CNTL-ID)
 22360*        SET         (ADDRESS OF CONTROL-FILE)
 22361*        RIDFLD      (ELCNTL-KEY)
 22362*        GTEQ
 22363*    END-EXEC.
 22364*    MOVE '&"S        G          (   #00020808' TO DFHEIV0
 22365     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22367     MOVE X'2020233030303230383038' TO DFHEIV0(25:11)
 22368     CALL 'kxdfhei1' USING DFHEIV0,
 22369           CNTL-ID,
 22370           DFHEIV20,
 22371           DFHEIV99,
 22372           ELCNTL-KEY,
 22373           DFHEIV99,
 22374           DFHEIV99,
 22375           DFHEIV99
 22376     SET ADDRESS OF CONTROL-FILE TO
 22377         DFHEIV20
 22378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22379
 22380
 22381     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 413
* EL050.cbl
 22382
 22383 9000-NOTFND.
 22384     IF RC-SW-1 = '1'
 22385        MOVE ER-2616              TO WS-ERROR
 22386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22387        GO TO 9000-EXIT.
 22388
 22389     IF RC-SW-1 = '2'
 22390        MOVE ER-2602              TO WS-ERROR
 22391        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22392
 22393 9000-EXIT.
 22394      EXIT.
 22395
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 414
* EL050.cbl
 22397 9100-READ-CONTROL.
 22398
 22399* EXEC CICS HANDLE CONDITION
 22400*        NOTFND  (9100-NOTFND)
 22401*        ENDFILE (9100-NOTFND)
 22402*    END-EXEC.
 22403*    MOVE '"$I''                  ! ? #00020832' TO DFHEIV0
 22404     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22406     MOVE X'3F20233030303230383332' TO DFHEIV0(25:11)
 22407     CALL 'kxdfhei1' USING DFHEIV0
 22408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22409
 22410
 22411
 22412* EXEC CICS READ
 22413*        DATASET     (CNTL-ID)
 22414*        INTO        (CONTROL-FILE)
 22415*        RIDFLD      (ELCNTL-KEY)
 22416*        GTEQ
 22417*    END-EXEC.
 22418     MOVE LENGTH OF
 22419      CONTROL-FILE
 22420       TO DFHEIV11
 22421*    MOVE '&"IL       G          (   #00020837' TO DFHEIV0
 22422     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22423     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22424     MOVE X'2020233030303230383337' TO DFHEIV0(25:11)
 22425     CALL 'kxdfhei1' USING DFHEIV0,
 22426           CNTL-ID,
 22427           CONTROL-FILE,
 22428           DFHEIV11,
 22429           ELCNTL-KEY,
 22430           DFHEIV99,
 22431           DFHEIV99,
 22432           DFHEIV99
 22433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22434
 22435
 22436     GO TO 9100-EXIT.
 22437
 22438 9100-NOTFND.
 22439     IF RC-SW-2 = '0'
 22440        MOVE '1'                  TO STATE-RECORD-ERROR
 22441        GO TO 9100-EXIT
 22442     END-IF
 22443     IF RC-SW-2 = '1'
 22444        MOVE '1'                  TO LF-BENEFIT-ERROR
 22445        MOVE ER-2604              TO WS-ERROR
 22446        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22447        GO TO 9100-EXIT.
 22448
 22449     IF RC-SW-2 = '2'
 22450        MOVE '1'                  TO AH-BENEFIT-ERROR
 22451        MOVE ER-2605              TO WS-ERROR
 22452        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22453        GO TO 9100-EXIT.
 22454
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 415
* EL050.cbl
 22455     IF RC-SW-2 = '3'
 22456         MOVE ER-2603           TO WS-ERROR
 22457         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22458         GO TO 9100-EXIT.
 22459
 22460     IF RC-SW-2 = '4'
 22461         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22462         GO TO 9100-EXIT.
 22463
 22464     IF RC-SW-2 = '5'
 22465         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22466         IF WS-AH-INPUT-CD-1 = SPACE
 22467             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22468         ELSE
 22469             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22470
 22471 9100-EXIT.
 22472      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 416
* EL050.cbl
 22474 9200-CONTROL-GETMAIN.
 22475
 22476* EXEC CICS GETMAIN
 22477*         LENGTH   (750)
 22478*         SET      (ADDRESS OF CONTROL-FILE)
 22479*    END-EXEC.
 22480     MOVE 750
 22481       TO DFHEIV11
 22482*    MOVE '," L                  $   #00020883' TO DFHEIV0
 22483     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22484     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22485     MOVE X'2020233030303230383833' TO DFHEIV0(25:11)
 22486     CALL 'kxdfhei1' USING DFHEIV0,
 22487           DFHEIV20,
 22488           DFHEIV11,
 22489           DFHEIV99
 22490     SET ADDRESS OF CONTROL-FILE TO
 22491         DFHEIV20
 22492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22493
 22494
 22495     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22496
 22497 9200-EXIT.
 22498     EXIT.
 22499
 22500 9250-UNLOCK-RETURN.
 22501
 22502* EXEC CICS UNLOCK
 22503*        DATASET   (CERT-ID)
 22504*    END-EXEC.
 22505*    MOVE '&*                    #   #00020894' TO DFHEIV0
 22506     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22507     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22508     MOVE X'2020233030303230383934' TO DFHEIV0(25:11)
 22509     CALL 'kxdfhei1' USING DFHEIV0,
 22510           CERT-ID,
 22511           DFHEIV99
 22512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22513
 22514
 22515 9300-ABEND.
 22516     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22517
 22518
 22519* EXEC CICS LINK
 22520*        PROGRAM   ('EL004')
 22521*        COMMAREA  (WS-ERROR-LINE)
 22522*        LENGTH    (72)
 22523*    END-EXEC.
 22524     MOVE 'EL004' TO DFHEIV1
 22525     MOVE 72
 22526       TO DFHEIV11
 22527*    MOVE '."C                   (   #00020901' TO DFHEIV0
 22528     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22530     MOVE X'2020233030303230393031' TO DFHEIV0(25:11)
 22531     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 417
* EL050.cbl
 22532           DFHEIV1,
 22533           WS-ERROR-LINE,
 22534           DFHEIV11,
 22535           DFHEIV99,
 22536           DFHEIV99,
 22537           DFHEIV99,
 22538           DFHEIV99
 22539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22540
 22541
 22542     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22543
 22544
 22545* EXEC CICS ABEND
 22546*        ABCODE ('EL50')
 22547*    END-EXEC.
 22548     MOVE 'EL50' TO DFHEIV5
 22549*    MOVE '.,A                   "   #00020909' TO DFHEIV0
 22550     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22551     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22552     MOVE X'2020233030303230393039' TO DFHEIV0(25:11)
 22553     CALL 'kxdfhei1' USING DFHEIV0,
 22554           DFHEIV5
 22555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22556
 22557
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 418
* EL050.cbl
 22559
 22560******************************************************************
 22561*                                                                *
 22562*            E R R O R   F O R M A T   R O U T I N E             *
 22563*                                                                *
 22564******************************************************************
 22565
 22566 9900-ERROR-FORMAT.
 22567
 22568     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22569                    PB-COMMON-ERROR (2) OR
 22570                    PB-COMMON-ERROR (3) OR
 22571                    PB-COMMON-ERROR (4) OR
 22572                    PB-COMMON-ERROR (5) OR
 22573                    PB-COMMON-ERROR (6) OR
 22574                    PB-COMMON-ERROR (7) OR
 22575                    PB-COMMON-ERROR (8) OR
 22576                    PB-COMMON-ERROR (9) OR
 22577                    PB-COMMON-ERROR (10)
 22578        GO TO 9900-EXIT.
 22579
 22580     IF PB-NO-OF-ERRORS = +10
 22581        GO TO 9900-EXIT.
 22582
 22583     ADD +1  TO PB-NO-OF-ERRORS.
 22584     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22585                                       (PB-NO-OF-ERRORS).
 22586 9900-EXIT.
 22587     EXIT.
 22588
 22589 9990-RETURN.
 22590     IF BROWSE-STARTED
 22591
 22592* EXEC CICS ENDBR
 22593*            DATASET  (ACCT-ID)
 22594*       END-EXEC.
 22595     MOVE 0
 22596       TO DFHEIV11
 22597*    MOVE '&2                    $   #00020946' TO DFHEIV0
 22598     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22599     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22600     MOVE X'2020233030303230393436' TO DFHEIV0(25:11)
 22601     CALL 'kxdfhei1' USING DFHEIV0,
 22602           ACCT-ID,
 22603           DFHEIV11,
 22604           DFHEIV99
 22605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22606
 22607
 22608 9990-EXIT.
 22609     EXIT.
 22610
 22611
 22612****Check for CRTO record, add one if not found.
 22613 9991-CHECK-FOR-ELCRTO.
 22614
 22615* EXEC CICS HANDLE CONDITION
 22616*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 419
* EL050.cbl
 22617*         ENDFILE (9991-CRTO-NOT-FOUND)
 22618*     END-EXEC.
 22619*    MOVE '"$I''                  ! @ #00020956' TO DFHEIV0
 22620     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22622     MOVE X'4020233030303230393536' TO DFHEIV0(25:11)
 22623     CALL 'kxdfhei1' USING DFHEIV0
 22624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22625
 22626     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22627     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22628     MOVE +0                     TO ELCRTO-SEQ-NO
 22629
 22630
 22631* EXEC CICS READ
 22632*       DATASET   ('ELCRTO')
 22633*       INTO      (ORIGINAL-CERTIFICATE)
 22634*       RIDFLD    (ELCRTO-KEY)
 22635*       GTEQ
 22636*       RESP      (WS-RESPONSE)
 22637*    END-EXEC
 22638     MOVE LENGTH OF
 22639      ORIGINAL-CERTIFICATE
 22640       TO DFHEIV11
 22641     MOVE 'ELCRTO' TO DFHEIV1
 22642*    MOVE '&"IL       G          (  N#00020964' TO DFHEIV0
 22643     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22644     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22645     MOVE X'204E233030303230393634' TO DFHEIV0(25:11)
 22646     CALL 'kxdfhei1' USING DFHEIV0,
 22647           DFHEIV1,
 22648           ORIGINAL-CERTIFICATE,
 22649           DFHEIV11,
 22650           ELCRTO-KEY,
 22651           DFHEIV99,
 22652           DFHEIV99,
 22653           DFHEIV99
 22654     MOVE EIBRESP  TO WS-RESPONSE
 22655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22656
 22657     IF WS-RESP-NORMAL
 22658        AND (OC-CONTROL-PRIMARY (1:33) =
 22659                 PB-CONTROL-BY-ACCOUNT (1:33))
 22660        AND (OC-RECORD-TYPE =  'I')
 22661           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22662               GO TO 9991-CHECK-INDICATORS
 22663           ELSE
 22664               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22665               GO TO 9991-CRTO-ADD-REC
 22666           END-IF
 22667     END-IF.
 22668
 22669 9991-CRTO-NOT-FOUND.
 22670
 22671     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22672     MOVE 'OC'                TO OC-RECORD-ID
 22673     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22674                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 420
* EL050.cbl
 22675     MOVE +4096               TO OC-KEY-SEQ-NO.
 22676
 22677 9991-CRTO-ADD-REC.
 22678
 22679     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22680     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22681     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22682     MOVE 'I'                 TO OC-RECORD-TYPE
 22683     IF PB-ISSUE
 22684         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22685         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22686         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22687         MOVE PB-I-AGE               TO OC-INS-AGE
 22688         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22689         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22690         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22691         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22692         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22693         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22694         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22695         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22696         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22697         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22698         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22699         IF PB-I-JOINT-COMMISSION > +0
 22700             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22701         ELSE
 22702             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22703         END-IF
 22704         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22705         MOVE +0                     TO OC-LF-CANCEL-AMT
 22706                                        OC-LF-ITD-CANCEL-AMT
 22707         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22708         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22709         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22710         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22711         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22712         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22713         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22714         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22715         MOVE +0                     TO OC-AH-CANCEL-AMT
 22716                                        OC-AH-ITD-CANCEL-AMT
 22717         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22718         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22719         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22720     ELSE
 22721         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22722         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22723         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22724         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22725         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22726         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22727         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22728         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22729         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22730          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22731             MOVE SPACES             TO OC-LF-BENCD
 22732             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 421
* EL050.cbl
 22733                                        OC-LF-BEN-AMT
 22734                                        OC-LF-PRM-AMT
 22735                                        OC-LF-ALT-BEN-AMT
 22736                                        OC-LF-ALT-PRM-AMT
 22737                                        OC-LF-COMM-PCT
 22738                                        OC-LF-CANCEL-AMT
 22739             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22740             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22741         ELSE
 22742             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22743             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22744             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22745             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22746             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22747             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22748             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22749             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22750             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22751             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22752         END-IF
 22753         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22754         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22755          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22756             MOVE SPACES             TO OC-AH-BENCD
 22757             MOVE ZEROS              TO OC-AH-TERM
 22758                                        OC-AH-BEN-AMT
 22759                                        OC-AH-PRM-AMT
 22760                                        OC-AH-COMM-PCT
 22761                                        OC-AH-CANCEL-AMT
 22762                                        OC-AH-CP
 22763             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22764             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22765         ELSE
 22766             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22767             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22768             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22769             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22770             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22771             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22772             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22773             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22774             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22775         END-IF
 22776         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22777         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22778         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22779         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22780     END-IF
 22781     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22782
 22783     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22784
 22785
 22786* EXEC CICS READ
 22787*         DATASET   (FILE-ERMAIL)
 22788*         RIDFLD    (MA-CONTROL-PRIMARY)
 22789*         INTO      (MAILING-DATA)
 22790*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 422
* EL050.cbl
 22791*    END-EXEC
 22792     MOVE LENGTH OF
 22793      MAILING-DATA
 22794       TO DFHEIV11
 22795*    MOVE '&"IL       E          (  N#00021100' TO DFHEIV0
 22796     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22797     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22798     MOVE X'204E233030303231313030' TO DFHEIV0(25:11)
 22799     CALL 'kxdfhei1' USING DFHEIV0,
 22800           FILE-ERMAIL,
 22801           MAILING-DATA,
 22802           DFHEIV11,
 22803           MA-CONTROL-PRIMARY,
 22804           DFHEIV99,
 22805           DFHEIV99,
 22806           DFHEIV99
 22807     MOVE EIBRESP  TO WS-RESPONSE
 22808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22809
 22810     IF WS-RESP-NORMAL
 22811         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22812     END-IF.
 22813
 22814     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22815     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22816
 22817
 22818* EXEC CICS READ
 22819*         DATASET  (CRTT-ID)
 22820*         RIDFLD   (WS-ELCRTT-KEY)
 22821*         INTO     (CERTIFICATE-TRAILERS)
 22822*         RESP     (WS-RESPONSE)
 22823*    END-EXEC
 22824     MOVE LENGTH OF
 22825      CERTIFICATE-TRAILERS
 22826       TO DFHEIV11
 22827*    MOVE '&"IL       E          (  N#00021114' TO DFHEIV0
 22828     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22829     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22830     MOVE X'204E233030303231313134' TO DFHEIV0(25:11)
 22831     CALL 'kxdfhei1' USING DFHEIV0,
 22832           CRTT-ID,
 22833           CERTIFICATE-TRAILERS,
 22834           DFHEIV11,
 22835           WS-ELCRTT-KEY,
 22836           DFHEIV99,
 22837           DFHEIV99,
 22838           DFHEIV99
 22839     MOVE EIBRESP  TO WS-RESPONSE
 22840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22841
 22842     IF WS-RESP-NORMAL
 22843         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22844         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22845     END-IF.
 22846
 22847
 22848* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 423
* EL050.cbl
 22849*       DATASET   ('ELCRTO')
 22850*       FROM      (ORIGINAL-CERTIFICATE)
 22851*       RIDFLD    (OC-CONTROL-PRIMARY)
 22852*       RESP      (WS-RESPONSE)
 22853*    END-EXEC.
 22854     MOVE LENGTH OF
 22855      ORIGINAL-CERTIFICATE
 22856       TO DFHEIV11
 22857     MOVE 'ELCRTO' TO DFHEIV1
 22858*    MOVE '&$ L                  ''  N#00021126' TO DFHEIV0
 22859     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22860     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22861     MOVE X'204E233030303231313236' TO DFHEIV0(25:11)
 22862     CALL 'kxdfhei1' USING DFHEIV0,
 22863           DFHEIV1,
 22864           ORIGINAL-CERTIFICATE,
 22865           DFHEIV11,
 22866           OC-CONTROL-PRIMARY,
 22867           DFHEIV99,
 22868           DFHEIV99
 22869     MOVE EIBRESP  TO WS-RESPONSE
 22870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22871
 22872
 22873     GO TO 9991-EXIT.
 22874
 22875 9991-CHECK-INDICATORS.
 22876
 22877     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22878         GO TO 9991-EXIT
 22879     END-IF.
 22880
 22881     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22882         GO TO 9991-EXIT
 22883     END-IF.
 22884
 22885
 22886* EXEC CICS READ
 22887*       DATASET   ('ELCRTO')
 22888*       INTO      (ORIGINAL-CERTIFICATE)
 22889*       RIDFLD    (OC-CONTROL-PRIMARY)
 22890*       UPDATE
 22891*       RESP      (WS-RESPONSE)
 22892*    END-EXEC
 22893     MOVE LENGTH OF
 22894      ORIGINAL-CERTIFICATE
 22895       TO DFHEIV11
 22896     MOVE 'ELCRTO' TO DFHEIV1
 22897*    MOVE '&"IL       EU         (  N#00021145' TO DFHEIV0
 22898     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22899     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22900     MOVE X'204E233030303231313435' TO DFHEIV0(25:11)
 22901     CALL 'kxdfhei1' USING DFHEIV0,
 22902           DFHEIV1,
 22903           ORIGINAL-CERTIFICATE,
 22904           DFHEIV11,
 22905           OC-CONTROL-PRIMARY,
 22906           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 424
* EL050.cbl
 22907           DFHEIV99,
 22908           DFHEIV99
 22909     MOVE EIBRESP  TO WS-RESPONSE
 22910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22911     IF WS-RESP-NORMAL
 22912        IF PB-ISSUE
 22913          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22914          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22915          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22916          MOVE PB-I-AGE               TO OC-INS-AGE
 22917          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22918          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22919          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22920          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22921          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22922          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22923          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22924          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22925          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22926          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22927          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22928          IF PB-I-JOINT-COMMISSION > +0
 22929              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22930          ELSE
 22931              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22932          END-IF
 22933          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22934          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22935          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22936          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22937          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22938          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22939          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22940          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22941          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22942
 22943          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22944
 22945* EXEC CICS READ
 22946*             DATASET   (FILE-ERMAIL)
 22947*             RIDFLD    (MA-CONTROL-PRIMARY)
 22948*             INTO      (MAILING-DATA)
 22949*             RESP      (WS-RESPONSE)
 22950*         END-EXEC
 22951     MOVE LENGTH OF
 22952      MAILING-DATA
 22953       TO DFHEIV11
 22954*    MOVE '&"IL       E          (  N#00021185' TO DFHEIV0
 22955     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22956     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22957     MOVE X'204E233030303231313835' TO DFHEIV0(25:11)
 22958     CALL 'kxdfhei1' USING DFHEIV0,
 22959           FILE-ERMAIL,
 22960           MAILING-DATA,
 22961           DFHEIV11,
 22962           MA-CONTROL-PRIMARY,
 22963           DFHEIV99,
 22964           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 425
* EL050.cbl
 22965           DFHEIV99
 22966     MOVE EIBRESP  TO WS-RESPONSE
 22967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22968          IF WS-RESP-NORMAL
 22969             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22970          END-IF
 22971
 22972          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22973          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22974
 22975* EXEC CICS READ
 22976*             DATASET  (CRTT-ID)
 22977*             RIDFLD   (WS-ELCRTT-KEY)
 22978*             INTO     (CERTIFICATE-TRAILERS)
 22979*             RESP     (WS-RESPONSE)
 22980*         END-EXEC
 22981     MOVE LENGTH OF
 22982      CERTIFICATE-TRAILERS
 22983       TO DFHEIV11
 22984*    MOVE '&"IL       E          (  N#00021197' TO DFHEIV0
 22985     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22986     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22987     MOVE X'204E233030303231313937' TO DFHEIV0(25:11)
 22988     CALL 'kxdfhei1' USING DFHEIV0,
 22989           CRTT-ID,
 22990           CERTIFICATE-TRAILERS,
 22991           DFHEIV11,
 22992           WS-ELCRTT-KEY,
 22993           DFHEIV99,
 22994           DFHEIV99,
 22995           DFHEIV99
 22996     MOVE EIBRESP  TO WS-RESPONSE
 22997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22998          IF WS-RESP-NORMAL
 22999             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 23000                               OC-INS-AGE-DEFAULT-FLAG
 23001             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 23002                               OC-JNT-AGE-DEFAULT-FLAG
 23003          END-IF
 23004
 23005        ELSE
 23006          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23007             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 23008             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 23009             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 23010          END-IF
 23011          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23012             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 23013             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 23014             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 23015          END-IF
 23016          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 23017        END-IF
 23018
 23019* EXEC CICS REWRITE
 23020*          DATASET   ('ELCRTO')
 23021*          FROM      (ORIGINAL-CERTIFICATE)
 23022*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 426
* EL050.cbl
 23023*       END-EXEC
 23024     MOVE LENGTH OF
 23025      ORIGINAL-CERTIFICATE
 23026       TO DFHEIV11
 23027     MOVE 'ELCRTO' TO DFHEIV1
 23028*    MOVE '&& L                  %  N#00021223' TO DFHEIV0
 23029     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23030     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23031     MOVE X'204E233030303231323233' TO DFHEIV0(25:11)
 23032     CALL 'kxdfhei1' USING DFHEIV0,
 23033           DFHEIV1,
 23034           ORIGINAL-CERTIFICATE,
 23035           DFHEIV11,
 23036           DFHEIV99
 23037     MOVE EIBRESP  TO WS-RESPONSE
 23038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23039     END-IF.
 23040
 23041 9991-EXIT.
 23042     EXIT.
 23043
 23044
 23045 9999-RETURN.
 23046     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 23047
 23048
 23049* EXEC CICS RETURN
 23050*    END-EXEC.
 23051*    MOVE '.(                    ''   #00021237' TO DFHEIV0
 23052     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23053     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23054     MOVE X'2020233030303231323337' TO DFHEIV0(25:11)
 23055     CALL 'kxdfhei1' USING DFHEIV0,
 23056           DFHEIV99,
 23057           DFHEIV99,
 23058           DFHEIV99,
 23059           DFHEIV99,
 23060           DFHEIV99,
 23061           DFHEIV99
 23062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23063
 23064
 23065
 23066* GOBACK.
 23067     MOVE '9%                    "   ' TO DFHEIV0
 23068     MOVE 'EL050' TO DFHEIV1
 23069     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23070     GOBACK.
 23071
 23072 9999-DFHBACK SECTION.
 23073     MOVE '9%                    "   ' TO DFHEIV0
 23074     MOVE 'EL050' TO DFHEIV1
 23075     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23076     GOBACK.
 23077 9999-DFHEXIT.
 23078     IF DFHEIGDJ EQUAL 0001
 23079         NEXT SENTENCE
 23080     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 427
* EL050.cbl
 23081         GO TO 9300-ABEND,
 23082               3990-FILES-NOT-OPEN
 23083         DEPENDING ON DFHEIGDI
 23084     ELSE IF DFHEIGDJ EQUAL 3
 23085         GO TO 6610-START-BROWSE,
 23086               6630-ERRESS-PROBLEM,
 23087               6630-END-OF-FILE
 23088         DEPENDING ON DFHEIGDI
 23089     ELSE IF DFHEIGDJ EQUAL 4
 23090         GO TO 6630-END-OF-FILE,
 23091               6630-ERRESS-PROBLEM,
 23092               6630-ERRESS-PROBLEM,
 23093               6630-END-OF-FILE
 23094         DEPENDING ON DFHEIGDI
 23095     ELSE IF DFHEIGDJ EQUAL 5
 23096         GO TO 6630-END-OF-FILE,
 23097               6630-END-OF-FILE,
 23098               6630-ERRESS-PROBLEM,
 23099               6630-ERRESS-PROBLEM
 23100         DEPENDING ON DFHEIGDI
 23101     ELSE IF DFHEIGDJ EQUAL 6
 23102         GO TO 6660-START-BROWSE,
 23103               6690-ERRESC-PROBLEM,
 23104               6690-ERRESC-PROBLEM,
 23105               6690-END-OF-FILE
 23106         DEPENDING ON DFHEIGDI
 23107     ELSE IF DFHEIGDJ EQUAL 7
 23108         GO TO 6690-END-OF-FILE,
 23109               6690-ERRESC-PROBLEM,
 23110               6690-ERRESC-PROBLEM,
 23111               6690-END-OF-FILE
 23112         DEPENDING ON DFHEIGDI
 23113     ELSE IF DFHEIGDJ EQUAL 8
 23114         GO TO 6690-END-OF-FILE,
 23115               6690-ERRESC-PROBLEM,
 23116               6690-ERRESC-PROBLEM,
 23117               6690-END-OF-FILE
 23118         DEPENDING ON DFHEIGDI
 23119     ELSE IF DFHEIGDJ EQUAL 9
 23120         GO TO 7250-CONTINUE,
 23121               7250-CONTINUE
 23122         DEPENDING ON DFHEIGDI
 23123     ELSE IF DFHEIGDJ EQUAL 10
 23124         GO TO 7300-CONTINUE,
 23125               7300-CONTINUE
 23126         DEPENDING ON DFHEIGDI
 23127     ELSE IF DFHEIGDJ EQUAL 11
 23128         GO TO 8000-FREE-MAIN
 23129         DEPENDING ON DFHEIGDI
 23130     ELSE IF DFHEIGDJ EQUAL 12
 23131         GO TO 8100-NOTFND,
 23132               8100-NOTFND
 23133         DEPENDING ON DFHEIGDI
 23134     ELSE IF DFHEIGDJ EQUAL 13
 23135         GO TO 8110-NOTFND,
 23136               8110-NOTFND
 23137         DEPENDING ON DFHEIGDI
 23138     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 428
* EL050.cbl
 23139         GO TO 8130-EXIT
 23140         DEPENDING ON DFHEIGDI
 23141     ELSE IF DFHEIGDJ EQUAL 15
 23142         GO TO 8145-exit
 23143         DEPENDING ON DFHEIGDI
 23144     ELSE IF DFHEIGDJ EQUAL 16
 23145         GO TO 8190-NOTFND
 23146         DEPENDING ON DFHEIGDI
 23147     ELSE IF DFHEIGDJ EQUAL 17
 23148         GO TO 8195-NOTFND
 23149         DEPENDING ON DFHEIGDI
 23150     ELSE IF DFHEIGDJ EQUAL 18
 23151         GO TO 8200-NOTFND
 23152         DEPENDING ON DFHEIGDI
 23153     ELSE IF DFHEIGDJ EQUAL 19
 23154         GO TO 8300-NOTFND,
 23155               8300-ERRESS-PROBLEM,
 23156               8300-ERRESS-PROBLEM,
 23157               8300-NOTFND
 23158         DEPENDING ON DFHEIGDI
 23159     ELSE IF DFHEIGDJ EQUAL 20
 23160         GO TO 8450-FORM-NOT-FOUND,
 23161               8450-FORM-NOT-FOUND
 23162         DEPENDING ON DFHEIGDI
 23163     ELSE IF DFHEIGDJ EQUAL 21
 23164         GO TO 0199-ACCT-NOT-FOUND,
 23165               0199-ACCT-NOT-FOUND
 23166         DEPENDING ON DFHEIGDI
 23167     ELSE IF DFHEIGDJ EQUAL 22
 23168         GO TO 0199-ACCT-NOT-FOUND,
 23169               0199-ACCT-NOT-FOUND
 23170         DEPENDING ON DFHEIGDI
 23171     ELSE IF DFHEIGDJ EQUAL 23
 23172         GO TO 8582-COMP-NOT-FOUND,
 23173               8582-COMP-NOT-FOUND
 23174         DEPENDING ON DFHEIGDI
 23175     ELSE IF DFHEIGDJ EQUAL 24
 23176         GO TO 8583-AGTC-NOT-FOUND,
 23177               8583-AGTC-NOT-FOUND
 23178         DEPENDING ON DFHEIGDI
 23179     ELSE IF DFHEIGDJ EQUAL 25
 23180         GO TO 8584-BXRF-NOT-FOUND,
 23181               8584-BXRF-NOT-FOUND
 23182         DEPENDING ON DFHEIGDI
 23183     ELSE IF DFHEIGDJ EQUAL 26
 23184         GO TO 8585-PLAN-NOT-FOUND,
 23185               8585-PLAN-NOT-FOUND
 23186         DEPENDING ON DFHEIGDI
 23187     ELSE IF DFHEIGDJ EQUAL 27
 23188         GO TO 0299-CERT-NOT-FOUND
 23189         DEPENDING ON DFHEIGDI
 23190     ELSE IF DFHEIGDJ EQUAL 28
 23191         GO TO 8700-READ-CERT-MASTER
 23192         DEPENDING ON DFHEIGDI
 23193     ELSE IF DFHEIGDJ EQUAL 29
 23194         GO TO 8720-COMP-ACCOUNTS,
 23195               8730-END-BROWSE,
 23196               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 10:54 Page 429
* EL050.cbl
 23197         DEPENDING ON DFHEIGDI
 23198     ELSE IF DFHEIGDJ EQUAL 30
 23199         GO TO 9000-NOTFND
 23200         DEPENDING ON DFHEIGDI
 23201     ELSE IF DFHEIGDJ EQUAL 31
 23202         GO TO 9100-NOTFND,
 23203               9100-NOTFND
 23204         DEPENDING ON DFHEIGDI
 23205     ELSE IF DFHEIGDJ EQUAL 32
 23206         GO TO 9991-CRTO-NOT-FOUND,
 23207               9991-CRTO-NOT-FOUND
 23208         DEPENDING ON DFHEIGDI.
 23209     MOVE '9%                    "   ' TO DFHEIV0
 23210     MOVE 'EL050' TO DFHEIV1
 23211     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23212     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41824     Code:       95073
