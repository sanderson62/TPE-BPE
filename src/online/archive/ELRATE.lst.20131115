* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   1
* ELRATE.cbl
* Options: int("ELRATE.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRATE.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATE.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   2
* ELRATE.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192******************************************************************
   193
   194 01  NET-PAY-WORK-AREA.
   195     12  OPTION-SW               PIC X   VALUE 'X'.
   196        88  NPO-STD         VALUE SPACE.
   197        88  NPO-ALT         VALUE 'A'.
   198        88  NPO-SIMPLE      VALUE 'S'.
   199        88  NPO-2MO         VALUE 'I'.
   200        88  NPO-3MO         VALUE 'J'.
   201        88  NPO-4MO         VALUE 'K'.
   202        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   203        88  NPO-TRUNC-0     VALUE 'T'.
   204        88  NPO-TRUNC-1     VALUE 'U'.
   205        88  NPO-TRUNC-2     VALUE 'V'.
   206        88  NPO-TRUNC-3     VALUE 'W'.
   207        88  NPO-TRUNC-4     VALUE 'X'.
   208        88  NPO-REFUND      VALUE 'R'.
   209        88  NPO-PRUDENTIAL  VALUE 'P'.
   210
   211     12  TYPE-SW             PIC X   VALUE 'N'.
   212        88  NET-STD             VALUE 'N'.
   213        88  NET-SMP             VALUE 'S'.
   214
   215     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   216        88  NP-RATING           VALUE '1'.
   217        88  NP-REFUND           VALUE '2'.
   218        88  NP-REMAIN-AMT       VALUE '3'.
   219
   220     12  COMP-3-WORK-AREA         COMP-3.
   221         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   222         16  V               PIC SV9(13)       VALUE +.0.
   223         16  J               PIC SV9(9)        VALUE +0.
   224         16  K               PIC SV9(9)        VALUE +0.
   225         16  I               PIC SV9(10)       VALUE +.0.
   226         16  D               PIC S9(5)         VALUE +.0.
   227         16  APR100          PIC SV9(9)        VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   6
* ELRATE.cbl
   228         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   229         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   230         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   232         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   233         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   234         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   235         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   236         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   237         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   238         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   239         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   240         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   241         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   242         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   243         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   244         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   246         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   247         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   248         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   251         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   252         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   253         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   254         16  K1              PIC S999          VALUE +1.
   255         16  K12             PIC S999          VALUE +12.
   256         16  K100            PIC S999          VALUE +100.
   257         16  K1000           PIC S9(7)         VALUE +1000.
   258         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   259         16  Y REDEFINES NC-LR
   260                             PIC S99V9(5).
   261         16  TI              PIC S999V9(5)     VALUE +0.
   262         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   263         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   264         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   265         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   266         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   267         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   268         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   269         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   270
   271         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   272         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   273         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   274         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   275         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   276         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   277         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   278         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   279         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   280         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   281         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   282         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   283         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   284
   285         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   7
* ELRATE.cbl
   286
   287         16  ORIGINAL-TERM   PIC S999.
   288         16  M              REDEFINES ORIGINAL-TERM
   289                             PIC S999.
   290
   291         16  REMAINING-TERM  PIC S999.
   292         16  R              REDEFINES REMAINING-TERM
   293                             PIC S999.
   294
   295         16  LOAN-TERM       PIC S999.
   296         16  N              REDEFINES LOAN-TERM
   297                             PIC S999.
   298
   299         16  EXPIRED-TERM    PIC S999.
   300         16  E              REDEFINES EXPIRED-TERM
   301                             PIC S999.
   302
   303         16  PRUDENTIAL-WORK-AMT
   304                             PIC S9(7)V9(8).
   305         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   306                             PIC S9(7)V9(8).
   307
   308         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   309         16  VX              PIC S9V9(13)      VALUE +0.0.
   310         16  SV              PIC S9V9(13)      VALUE +0.0.
   311         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   312         16  SX              PIC S9V9(13)      VALUE +0.0.
   313         16  SE              PIC S9V9(10)      VALUE +0.0.
   314         16  N2              PIC S9(7)         VALUE +0.
   315         16  N3              PIC S9(7)         VALUE +0.
   316         16  K-I             PIC S9V9(8)       VALUE +0.0.
   317
   318     12  BINARY-WORK-AREA        COMP.
   319         16  X1              PIC S999        VALUE +0.
   320         16  X2              PIC S999        VALUE +0.
   321         16  MAX-X           PIC S9(5)       VALUE +0.
   322         16  B1              PIC S9(5)       VALUE +1.
   323         16  LINDX           PIC S999        VALUE ZEROS.
   324         16  AHNDX           PIC S999        VALUE ZEROS.
   325
   326     12  CSO-RATE-WORK-AREAS.
   327         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   328         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   329         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   330     12  WS-WORK-MISC.
   331         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   332         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   333*        16  WS-AGE              PIC 99           VALUE ZEROS.
   334         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   335         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   336         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   337         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   338         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   339         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   340         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   341         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   342         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   343         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   8
* ELRATE.cbl
   344         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   345         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   346******************************************************************
   347
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page   9
* ELRATE.cbl
   349*                            COPY ELCDATE.
   350******************************************************************
   351*                                                                *
   352*                                                                *
   353*                            ELCDATE.                            *
   354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   355*                            VMOD=2.003
   356*                                                                *
   357*                                                                *
   358*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   359*                 LENGTH = 200                                   *
   360******************************************************************
   361
   362 01  DATE-CONVERSION-DATA.
   363     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   364     12  DC-OPTION-CODE                PIC X.
   365         88  BIN-TO-GREG                VALUE ' '.
   366         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   367         88  EDIT-GREG-TO-BIN           VALUE '2'.
   368         88  YMD-GREG-TO-BIN            VALUE '3'.
   369         88  MDY-GREG-TO-BIN            VALUE '4'.
   370         88  JULIAN-TO-BIN              VALUE '5'.
   371         88  BIN-PLUS-ELAPSED           VALUE '6'.
   372         88  FIND-CENTURY               VALUE '7'.
   373         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   374         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   375         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   376         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   377         88  JULIAN-TO-BIN-3            VALUE 'C'.
   378         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   379         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   380         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   381         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   382         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   383         88  CHECK-LEAP-YEAR            VALUE 'H'.
   384         88  BIN-3-TO-GREG              VALUE 'I'.
   385         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   386         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   387         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   388         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   389         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   390         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   391         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   392         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   393         88  THREE-CHARACTER-BIN
   394                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   395         88  GREGORIAN-TO-BIN
   396                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   397         88  BIN-TO-GREGORIAN
   398                  VALUES ' ' '1' 'I' '8' 'G'.
   399         88  JULIAN-TO-BINARY
   400                  VALUES '5' 'C' 'E' 'F'.
   401     12  DC-ERROR-CODE                 PIC X.
   402         88  NO-CONVERSION-ERROR        VALUE ' '.
   403         88  DATE-CONVERSION-ERROR
   404                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   405         88  DATE-IS-ZERO               VALUE '1'.
   406         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  10
* ELRATE.cbl
   407         88  DATE-IS-INVALID            VALUE '3'.
   408         88  DATE1-GREATER-DATE2        VALUE '4'.
   409         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   410         88  DATE-INVALID-OPTION        VALUE '9'.
   411         88  INVALID-CENTURY            VALUE 'A'.
   412         88  ONLY-CENTURY               VALUE 'B'.
   413         88  ONLY-LEAP-YEAR             VALUE 'C'.
   414         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   415     12  DC-END-OF-MONTH               PIC X.
   416         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   417     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   418         88  USE-NORMAL-PROCESS         VALUE ' '.
   419         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   420         88  ADJUST-UP-100-YRS          VALUE '2'.
   421     12  FILLER                        PIC X.
   422     12  DC-CONVERSION-DATES.
   423         16  DC-BIN-DATE-1             PIC XX.
   424         16  DC-BIN-DATE-2             PIC XX.
   425         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   426         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   427                       DC-GREG-DATE-1-EDIT.
   428             20  DC-EDIT1-MONTH        PIC 99.
   429             20  SLASH1-1              PIC X.
   430             20  DC-EDIT1-DAY          PIC 99.
   431             20  SLASH1-2              PIC X.
   432             20  DC-EDIT1-YEAR         PIC 99.
   433         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   434         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   435                     DC-GREG-DATE-2-EDIT.
   436             20  DC-EDIT2-MONTH        PIC 99.
   437             20  SLASH2-1              PIC X.
   438             20  DC-EDIT2-DAY          PIC 99.
   439             20  SLASH2-2              PIC X.
   440             20  DC-EDIT2-YEAR         PIC 99.
   441         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   442         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   443                     DC-GREG-DATE-1-YMD.
   444             20  DC-YMD-YEAR           PIC 99.
   445             20  DC-YMD-MONTH          PIC 99.
   446             20  DC-YMD-DAY            PIC 99.
   447         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   448         16  DC-GREG-DATE-1-MDY-R REDEFINES
   449                      DC-GREG-DATE-1-MDY.
   450             20  DC-MDY-MONTH          PIC 99.
   451             20  DC-MDY-DAY            PIC 99.
   452             20  DC-MDY-YEAR           PIC 99.
   453         16  DC-GREG-DATE-1-ALPHA.
   454             20  DC-ALPHA-MONTH        PIC X(10).
   455             20  DC-ALPHA-DAY          PIC 99.
   456             20  FILLER                PIC XX.
   457             20  DC-ALPHA-CENTURY.
   458                 24 DC-ALPHA-CEN-N     PIC 99.
   459             20  DC-ALPHA-YEAR         PIC 99.
   460         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   461         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   462         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   463         16  DC-JULIAN-DATE            PIC 9(05).
   464         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  11
* ELRATE.cbl
   465                                       PIC 9(05).
   466         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   467             20  DC-JULIAN-YEAR        PIC 99.
   468             20  DC-JULIAN-DAYS        PIC 999.
   469         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   470         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   471         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   472     12  DATE-CONVERSION-VARIBLES.
   473         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   474         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   475             20  FILLER                PIC 9(3).
   476             20  HOLD-CEN-1-CCYY.
   477                 24  HOLD-CEN-1-CC     PIC 99.
   478                 24  HOLD-CEN-1-YY     PIC 99.
   479             20  HOLD-CEN-1-MO         PIC 99.
   480             20  HOLD-CEN-1-DA         PIC 99.
   481         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   482             20  HOLD-CEN-1-R-MO       PIC 99.
   483             20  HOLD-CEN-1-R-DA       PIC 99.
   484             20  HOLD-CEN-1-R-CCYY.
   485                 24  HOLD-CEN-1-R-CC   PIC 99.
   486                 24  HOLD-CEN-1-R-YY   PIC 99.
   487             20  FILLER                PIC 9(3).
   488         16  HOLD-CENTURY-1-X.
   489             20  FILLER                PIC X(3)  VALUE SPACES.
   490             20  HOLD-CEN-1-X-CCYY.
   491                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   492                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   493             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   494             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   495         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   496             20  HOLD-CEN-1-R-X-MO     PIC XX.
   497             20  HOLD-CEN-1-R-X-DA     PIC XX.
   498             20  HOLD-CEN-1-R-X-CCYY.
   499                 24  HOLD-CEN-1-R-X-CC PIC XX.
   500                 24  HOLD-CEN-1-R-X-YY PIC XX.
   501             20  FILLER                PIC XXX.
   502         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   503         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   504         16  DC-JULIAN-DATE-1          PIC 9(07).
   505         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   506             20  DC-JULIAN-1-CCYY.
   507                 24  DC-JULIAN-1-CC    PIC 99.
   508                 24  DC-JULIAN-1-YR    PIC 99.
   509             20  DC-JULIAN-DA-1        PIC 999.
   510         16  DC-JULIAN-DATE-2          PIC 9(07).
   511         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   512             20  DC-JULIAN-2-CCYY.
   513                 24  DC-JULIAN-2-CC    PIC 99.
   514                 24  DC-JULIAN-2-YR    PIC 99.
   515             20  DC-JULIAN-DA-2        PIC 999.
   516         16  DC-GREG-DATE-A-EDIT.
   517             20  DC-EDITA-MONTH        PIC 99.
   518             20  SLASHA-1              PIC X VALUE '/'.
   519             20  DC-EDITA-DAY          PIC 99.
   520             20  SLASHA-2              PIC X VALUE '/'.
   521             20  DC-EDITA-CCYY.
   522                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  12
* ELRATE.cbl
   523                 24  DC-EDITA-YEAR     PIC 99.
   524         16  DC-GREG-DATE-B-EDIT.
   525             20  DC-EDITB-MONTH        PIC 99.
   526             20  SLASHB-1              PIC X VALUE '/'.
   527             20  DC-EDITB-DAY          PIC 99.
   528             20  SLASHB-2              PIC X VALUE '/'.
   529             20  DC-EDITB-CCYY.
   530                 24  DC-EDITB-CENT     PIC 99.
   531                 24  DC-EDITB-YEAR     PIC 99.
   532         16  DC-GREG-DATE-CYMD         PIC 9(08).
   533         16  DC-GREG-DATE-CYMD-R REDEFINES
   534                              DC-GREG-DATE-CYMD.
   535             20  DC-CYMD-CEN           PIC 99.
   536             20  DC-CYMD-YEAR          PIC 99.
   537             20  DC-CYMD-MONTH         PIC 99.
   538             20  DC-CYMD-DAY           PIC 99.
   539         16  DC-GREG-DATE-MDCY         PIC 9(08).
   540         16  DC-GREG-DATE-MDCY-R REDEFINES
   541                              DC-GREG-DATE-MDCY.
   542             20  DC-MDCY-MONTH         PIC 99.
   543             20  DC-MDCY-DAY           PIC 99.
   544             20  DC-MDCY-CEN           PIC 99.
   545             20  DC-MDCY-YEAR          PIC 99.
   546    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   547        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   548    12  DC-EL310-DATE                  PIC X(21).
   549    12  FILLER                         PIC X(28).
   550
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  13
* ELRATE.cbl
   552*                            COPY ELCCALC.
   553******************************************************************
   554*                                                                *
   555*                           ELCCALC.                            *
   556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   557*                            VMOD=2.025                          *
   558*                                                                *
   559*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   560*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   561*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   562*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   563*                                                                *
   564*  PASSED TO ELRTRM                                              *
   565*  -----------------                                             *
   566*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   567*  ORIGINAL TERM                                                 *
   568*  BEGINNING DATE                                                *
   569*  ENDING DATE                                                   *
   570*  COMPANY I.D.                                                  *
   571*  ACCOUNT MASTER USER FIELD                                     *
   572*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   573*  FREE LOOK DAYS                                                *
   574*                                                                *
   575*  RETURNED FROM ELRTRM                                          *
   576*  ---------------------                                         *
   577*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   578*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   579*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   580*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   581*----------------------------------------------------------------*
   582*  PASSED TO ELRAMT                                              *
   583*  ----------------                                              *
   584*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   585*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   586*  ORIGINAL AMOUNT                                               *
   587*  ALTERNATE BENEFIT (BALLON)                                    *
   588*  A.P.R. - NET PAY ONLY                                         *
   589*  METHOD
   590*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   591*  COMPANY I.D.                                                  *
   592*  BENEFIT TYPE                                                  *
   593*                                                                *
   594*  RETURNED FROM ELRAMT                                          *
   595*  --------------------                                          *
   596*  REMAINING AMOUNT 1 - CURRENT                                  *
   597*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   598*  REMAINING AMOUNT FACTOR
   599*----------------------------------------------------------------*
   600*  PASSED TO ELRESV                                              *
   601*  -----------------                                             *
   602*  CERTIFICATE EFFECTIVE DATE                                    *
   603*  VALUATION DATE                                                *
   604*  PAID THRU DATE                                                *
   605*  BENEFIT                                                       *
   606*  INCURRED DATE                                                 *
   607*  REPORTED DATE                                                 *
   608*  ISSUE AGE                                                     *
   609*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  14
* ELRATE.cbl
   610*  CDT PERCENT                                                   *
   611*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   612* *CLAIM TYPE (LIFE, A/H)                                        *
   613* *REMAINING BENEFIT (FROM ELRAMT)                               *
   614* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   615*                                                                *
   616*  RETURNED FROM ELRESV                                          *
   617*  --------------------                                          *
   618*  CDT TABLE USED                                                *
   619*  CDT FACTOR USED                                               *
   620*  PAY TO CURRENT RESERVE                                        *
   621*  I.B.N.R. - A/H ONLY                                           *
   622*  FUTURE (ACCRUED) AH ONLY                                      *
   623*----------------------------------------------------------------*
   624*  PASSED TO ELRATE                                              *
   625*  ----------------                                              *
   626*  CERT ISSUE DATE                                               *
   627*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   628*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   629*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   630*  STATE CODE (CLIENT DEFINED)                                   *
   631*  STATE CODE (STANDARD P.O. ABBRV)                              *
   632*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   633*  DEVIATION CODE                                                *
   634*  ISSUE AGE                                                     *
   635*  ORIGINAL BENEFIT AMOUNT                                       *
   636*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   637*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   638*  BENEFIT KIND (LIFE OR A/H)                                    *
   639*  A.P.R.                                                        *
   640*  METHOD
   641*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   642*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   643*  COMPANY I.D. (3 CHARACTER)                                    *
   644*  BENEFIT CODE                                                  *
   645*  BENEFIT OVERRIDE CODE                                         *
   646*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   647*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   648*  JOINT INDICATOR (CSL ONLY)                                    *
   649*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   650*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   651*                                                                *
   652*  RETURNED FROM ELRATE                                          *
   653*  --------------------                                          *
   654*  CALCULATED PREMIUM                                            *
   655*  PREMIUM RATE                                                  *
   656*  MORTALITY CODE                                                *
   657*  MAX ATTAINED AGE                                              *
   658*  MAX AGE                                                       *
   659*  MAX TERM                                                      *
   660*  MAX MONTHLY BENEFIT                                           *
   661*  MAX TOTAL BENIFIT                                             *
   662*  COMPOSITE RATE (OPEN-END ONLY)                                *
   663*----------------------------------------------------------------*
   664*  PASSED TO ELRFND                                              *
   665*  ----------------                                              *
   666*  CERT ISSUE DATE                                               *
   667*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  15
* ELRATE.cbl
   668*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   669*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   670*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   671*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   672*  STATE CODE (CLIENT DEFINED)                                   *
   673*  STATE CODE (STANDARD P.O. ABBRV)                              *
   674*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   675*  DEVIATION CODE                                                *
   676*  ISSUE AGE                                                     *
   677*  ORIGINAL BENEFIT AMOUNT                                       *
   678*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   679*  PROCESS TYPE (CANCEL)                                         *
   680*  BENEFIT KIND (LIFE OR A/H)                                    *
   681*  A.P.R.                                                        *
   682*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   683*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   684*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   685*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   686*  COMPANY I.D. (3 CHARACTER)                                    *
   687*  BENEFIT CODE                                                  *
   688*  BENEFIT OVERRIDE CODE                                         *
   689*                                                                *
   690*  RETURNED FROM ELRFND                                          *
   691*  --------------------                                          *
   692*  CALCULATED REFUND                                             *
   693*----------------------------------------------------------------*
   694*  PASSED TO ELEARN                                              *
   695*  ----------------                                              *
   696*  CERT ISSUE DATE                                               *
   697*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   698*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   699*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   700*  STATE CODE (CLIENT DEFINED)                                   *
   701*  STATE CODE (STANDARD P.O. ABBRV)                              *
   702*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   703*  DEVIATION CODE                                                *
   704*  ISSUE AGE                                                     *
   705*  ORIGINAL BENEFIT AMOUNT                                       *
   706*  BENEFIT KIND (LIFE OR A/H)                                    *
   707*  A.P.R.                                                        *
   708*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   709*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   710*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   711*  COMPANY I.D. (3 CHARACTER)                                    *
   712*  BENEFIT CODE                                                  *
   713*  BENEFIT OVERRIDE CODE                                         *
   714*                                                                *
   715*  RETURNED FROM ELEARN                                          *
   716*  --------------------                                          *
   717*  INDICATED  EARNINGS                                           *
   718*----------------------------------------------------------------*
   719*                 LENGTH = 450                                   *
   720*                                                                *
   721******************************************************************
   722******************************************************************
   723*                   C H A N G E   L O G
   724*
   725* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  16
* ELRATE.cbl
   726*-----------------------------------------------------------------
   727*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   728* EFFECTIVE    NUMBER
   729*-----------------------------------------------------------------
   730* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   731* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   732* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   733* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   734* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   735* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   736* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   737* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   738* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   739******************************************************************
   740
   741 01  CALCULATION-PASS-AREA.
   742     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   743                                     COMP.
   744
   745     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   746       88  NO-CP-ERROR                             VALUE ZERO.
   747       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   748                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   749       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   750       88  CP-ERROR-IN-DATES                       VALUE '2'.
   751       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   752       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   753       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   754       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   755       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   756       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   757       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   758       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   759       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   760       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   761       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   762       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   763       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   764       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   765       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   766
   767     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   768       88  NO-CP-ERROR-2                           VALUE ZERO.
   769***********************  INPUT AREAS ****************************
   770
   771     12  CP-CALCULATION-AREA.
   772         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   773         16  CP-CERT-EFF-DT        PIC XX.
   774         16  CP-VALUATION-DT       PIC XX.
   775         16  CP-PAID-THRU-DT       PIC XX.
   776         16  CP-BENEFIT-TYPE       PIC X.
   777           88  CP-AH                               VALUE 'A' 'D'
   778                                                   'I' 'U'.
   779           88  CP-REDUCING-LIFE                    VALUE 'R'.
   780           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   781         16  CP-INCURRED-DT        PIC XX.
   782         16  CP-REPORTED-DT        PIC XX.
   783         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  17
* ELRATE.cbl
   784         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   785         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   786                                     COMP-3.
   787         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   788                                     COMP-3.
   789         16  CP-CDT-METHOD         PIC X.
   790           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   791           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   792           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   793         16  CP-CLAIM-TYPE         PIC X.
   794           88  CP-AH-CLAIM                         VALUE 'A'.
   795           88  CP-LIFE-CLAIM                       VALUE 'L'.
   796         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   797                                     COMP-3.
   798         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   799                                     COMP-3.
   800         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   801                                     COMP-3.
   802         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   803                                     COMP-3.
   804         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   805                                     COMP-3.
   806         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   807                                     COMP-3.
   808         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   809                                     COMP-3.
   810         16  CP-REM-TERM-METHOD    PIC X.
   811           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   812           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   813           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   814           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   815           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   816           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   817           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   818         16  CP-EARNING-METHOD     PIC X.
   819           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   820           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   821           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   822           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   823           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   824           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   825           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   826           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   827           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   828           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   829           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   830           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   831           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   832           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   833         16  CP-PROCESS-TYPE       PIC X.
   834           88  CP-CLAIM                            VALUE '1'.
   835           88  CP-CANCEL                           VALUE '2'.
   836           88  CP-ISSUE                            VALUE '3'.
   837         16  CP-SPECIAL-CALC-CD    PIC X.
   838           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   839           88  CP-1-MTH-INTEREST               VALUE ' '.
   840           88  CP-0-MTH-INTEREST               VALUE 'A'.
   841           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  18
* ELRATE.cbl
   842           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   843           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   844           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   845           88  CP-FARM-PLAN                    VALUE 'F'.
   846           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   847           88  CP-2-MTH-INTEREST               VALUE 'I'.
   848           88  CP-3-MTH-INTEREST               VALUE 'J'.
   849           88  CP-4-MTH-INTEREST               VALUE 'K'.
   850           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   851           88  CP-MORTGAGE-REC                 VALUE 'M'.
   852           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   853           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   854           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   855           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   856                                                     'W' 'X'.
   857           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   858           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   859           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   860           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   861           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   862           88  CP-SUMMARY-REC                  VALUE 'Z'.
   863           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   864           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   865           88  CP-AD-D-BENEFIT                 VALUE '4'.
   866           88  CP-CSL-METH-1                   VALUE '5'.
   867           88  CP-CSL-METH-2                   VALUE '6'.
   868           88  CP-CSL-METH-3                   VALUE '7'.
   869           88  CP-CSL-METH-4                   VALUE '8'.
   870
   871         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   872                                     COMP-3.
   873         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   874         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   875         16  CP-STATE              PIC XX          VALUE SPACE.
   876         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   877         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   878           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   879               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   880         16  CP-R78-OPTION         PIC X.
   881           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   882           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   883
   884         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   885         16  CP-IBNR-RESERVE-SW    PIC X.
   886         16  CP-CLAIM-STATUS       PIC X.
   887         16  CP-RATE-FILE          PIC X.
   888         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   889                                     COMP-3.
   890
   891         16  CP-LIFE-OVERRIDE-CODE PIC X.
   892         16  CP-AH-OVERRIDE-CODE   PIC X.
   893
   894         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   895                                     COMP-3.
   896         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   897                                   PIC S9(5)V99 COMP-3.
   898         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   899                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  19
* ELRATE.cbl
   900         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   901                                     COMP-3.
   902         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   903                                     COMP-3.
   904         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   905                                  PIC S9(7)V99 COMP-3.
   906
   907         16  CP-PAID-FROM-DATE     PIC X(02).
   908         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   909         16  CP-EXT-DAYS-CALC      PIC X.
   910           88  CP-EXT-NO-CHG                   VALUE ' '.
   911           88  CP-EXT-CHG-LF                   VALUE '1'.
   912           88  CP-EXT-CHG-AH                   VALUE '2'.
   913           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   914         16  CP-DOMICILE-STATE     PIC XX.
   915         16  CP-CARRIER            PIC X.
   916         16  CP-REIN-FLAG          PIC X.
   917         16  CP-REM-TRM-CALC-OPTION PIC X.
   918           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   919                      '2' '3' '4' '5'.
   920           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   921           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   922           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   923           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   924           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   925           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   926           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   927           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   928         16  CP-SIG-SWITCH         PIC X.
   929         16  CP-RATING-METHOD      PIC X.
   930           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   931           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   932           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   933           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   934           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   935           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   936           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   937           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   938           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   939         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   940                                     COMP-3.
   941         16  CP-BEN-CATEGORY       PIC X.
   942         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   943         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   944                                   PIC S99V9(5) COMP-3.
   945         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   946         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   947                                   PIC S99V9(5) COMP-3.
   948         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   949         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   950         16  CP-EXPIRE-DT          PIC XX.
   951         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   952         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   953         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   954         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   955         16  CP-DDF-SPEC-CALC      PIC X.
   956             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   957             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  20
* ELRATE.cbl
   958         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   959         16  CP-CANCEL-REASON      PIC X.
   960         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   961         16  CP-PMT-MODE           PIC X.
   962         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   963         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   964         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   965         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   966         16  FILLER                PIC X.
   967
   968***************    OUTPUT FROM ELRESV   ************************
   969
   970         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   971
   972         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   973                                     COMP-3.
   974         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   975                                     COMP-3.
   976         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   977                                     COMP-3.
   978         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   979                                     COMP-3.
   980         16  FILLER                PIC X(09).
   981***************    OUTPUT FROM ELRTRM   *************************
   982
   983         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   984                                     COMP-3.
   985         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   986                                     COMP-3.
   987         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   988                                     COMP-3.
   989         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   990                                     COMP-3.
   991         16  FILLER                PIC X(12).
   992
   993***************    OUTPUT FROM ELRAMT   *************************
   994
   995         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   996                                     COMP-3.
   997         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   998                                     COMP-3.
   999         16  FILLER                PIC X(12).
  1000
  1001***************    OUTPUT FROM ELRATE   *************************
  1002
  1003         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1004                                     COMP-3.
  1005         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1006                                     COMP-3.
  1007         16  CP-MORTALITY-CODE     PIC X(4).
  1008         16  CP-RATE-EDIT-FLAG     PIC X.
  1009             88  CP-RATES-NEED-APR                  VALUE '1'.
  1010         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1011                                     COMP-3.
  1012         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1013         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1014         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1015                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  21
* ELRATE.cbl
  1016         16  FILLER                PIC X(07).
  1017
  1018***************    OUTPUT FROM ELRFND   *************************
  1019
  1020         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1021                                     COMP-3.
  1022         16  CP-REFUND-TYPE-USED   PIC X.
  1023           88  CP-R-AS-R78                         VALUE '1'.
  1024           88  CP-R-AS-PRORATA                     VALUE '2'.
  1025           88  CP-R-AS-CALIF                       VALUE '3'.
  1026           88  CP-R-AS-TEXAS                       VALUE '4'.
  1027           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1028           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1029           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1030           88  CP-R-AS-MEAN                        VALUE '8'.
  1031           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1032           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1033           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1034           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1035           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1036           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1037         16  FILLER                PIC X(12).
  1038
  1039***************    OUTPUT FROM ELEARN   *************************
  1040
  1041         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1042                                     COMP-3.
  1043         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1044                                     COMP-3.
  1045         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1046                                     COMP-3.
  1047         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1048                                     COMP-3.
  1049         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1050                                     COMP-3.
  1051         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1052                                     COMP-3.
  1053         16  CP-EARNING-TYPE-USED  PIC X.
  1054           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1055           88  CP-E-AS-R78                         VALUE '1'.
  1056           88  CP-E-AS-PRORATA                     VALUE '2'.
  1057           88  CP-E-AS-TEXAS                       VALUE '4'.
  1058           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1059           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1060           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1061           88  CP-E-AS-MEAN                        VALUE '8'.
  1062           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1063         16  FILLER                PIC X(12).
  1064
  1065***************    OUTPUT FROM ELPMNT   *************************
  1066
  1067         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1068                                     COMP-3.
  1069         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1070                                     COMP-3.
  1071         16  FILLER                PIC X(12).
  1072
  1073***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  22
* ELRATE.cbl
  1074         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1075                                     COMP-3.
  1076         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1077                                     COMP-3.
  1078         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1079                                     COMP-3.
  1080         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1081                                     COMP-3.
  1082         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1083                                     COMP-3.
  1084         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1085                                     COMP-3.
  1086         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1087             88  OPEN-RATE-FILE                   VALUE 'O'.
  1088             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1089             88  IO-ERROR                         VALUE 'E'.
  1090
  1091         16  CP-FIRST-PAY-DATE     PIC XX.
  1092
  1093         16  CP-JOINT-INDICATOR    PIC X.
  1094
  1095         16  CP-RESERVE-REMAINING-TERM
  1096                                   PIC S9(4)V9    VALUE ZERO
  1097                                     COMP-3.
  1098
  1099         16  CP-INSURED-BIRTH-DT   PIC XX.
  1100
  1101         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1102                                     COMP-3.
  1103
  1104         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1105                                     COMP-3.
  1106
  1107         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1108                                     COMP-3.
  1109
  1110         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1111                                     COMP-3.
  1112
  1113         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1114                                     COMP-3.
  1115
  1116         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1117                                     COMP-3.
  1118
  1119         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1120                                     COMP-3.
  1121
  1122         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1123             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1124
  1125         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1126                                     COMP-3.
  1127         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1128                                     COMP-3.
  1129         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1130         16  FILLER                PIC X(15).
  1131******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  23
* ELRATE.cbl
  1132
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  24
* ELRATE.cbl
  1134****************************************************************
  1135*
  1136* Copyright (c) 2007 by Clerity Solutions, Inc.
  1137* All rights reserved.
  1138*
  1139****************************************************************
  1140 01  DFHEIV.
  1141   02  DFHEIV0               PIC X(35).
  1142   02  DFHEIV1               PIC X(08).
  1143   02  DFHEIV2               PIC X(08).
  1144   02  DFHEIV3               PIC X(08).
  1145   02  DFHEIV4               PIC X(06).
  1146   02  DFHEIV5               PIC X(04).
  1147   02  DFHEIV6               PIC X(04).
  1148   02  DFHEIV7               PIC X(02).
  1149   02  DFHEIV8               PIC X(02).
  1150   02  DFHEIV9               PIC X(01).
  1151   02  DFHEIV10              PIC S9(7) COMP-3.
  1152   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1153   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1154   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1155   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1156   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1157   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1158   02  DFHEIV17              PIC X(04).
  1159   02  DFHEIV18              PIC X(04).
  1160   02  DFHEIV19              PIC X(04).
  1161   02  DFHEIV20              USAGE IS POINTER.
  1162   02  DFHEIV21              USAGE IS POINTER.
  1163   02  DFHEIV22              USAGE IS POINTER.
  1164   02  DFHEIV23              USAGE IS POINTER.
  1165   02  DFHEIV24              USAGE IS POINTER.
  1166   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1167   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1168   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1169   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1170   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1171   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1172   02  FILLER                PIC X(02).
  1173   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1174   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1175   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1176   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1177   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1178 LINKAGE  SECTION.
  1179*****************************************************************
  1180*                                                               *
  1181* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1182* All rights reserved.                                          *
  1183*                                                               *
  1184*****************************************************************
  1185 01  dfheiblk.
  1186     02  eibtime          pic s9(7) comp-3.
  1187     02  eibdate          pic s9(7) comp-3.
  1188     02  eibtrnid         pic x(4).
  1189     02  eibtaskn         pic s9(7) comp-3.
  1190     02  eibtrmid         pic x(4).
  1191     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  25
* ELRATE.cbl
  1192     02  eibcposn         pic s9(4) comp.
  1193     02  eibcalen         pic s9(4) comp.
  1194     02  eibaid           pic x(1).
  1195     02  eibfiller1       pic x(1).
  1196     02  eibfn            pic x(2).
  1197     02  eibfiller2       pic x(2).
  1198     02  eibrcode         pic x(6).
  1199     02  eibfiller3       pic x(2).
  1200     02  eibds            pic x(8).
  1201     02  eibreqid         pic x(8).
  1202     02  eibrsrce         pic x(8).
  1203     02  eibsync          pic x(1).
  1204     02  eibfree          pic x(1).
  1205     02  eibrecv          pic x(1).
  1206     02  eibsend          pic x(1).
  1207     02  eibatt           pic x(1).
  1208     02  eibeoc           pic x(1).
  1209     02  eibfmh           pic x(1).
  1210     02  eibcompl         pic x(1).
  1211     02  eibsig           pic x(1).
  1212     02  eibconf          pic x(1).
  1213     02  eiberr           pic x(1).
  1214     02  eibrldbk         pic x(1).
  1215     02  eiberrcd         pic x(4).
  1216     02  eibsynrb         pic x(1).
  1217     02  eibnodat         pic x(1).
  1218     02  eibfiller5       pic x(2).
  1219     02  eibresp          pic 9(09) comp.
  1220     02  eibresp2         pic 9(09) comp.
  1221     02  dfheigdj         pic s9(4) comp.
  1222     02  dfheigdk         pic s9(4) comp.
  1223 01  DFHCOMMAREA             PIC X(450).
  1224
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  26
* ELRATE.cbl
  1226*01 PARMLIST              COMP.
  1227*    02  FILLER              PIC S9(8).
  1228*    02  ERRATE-POINTER      PIC S9(8).
  1229
  1230*                                COPY ERCRATE.
  1231******************************************************************
  1232*                                                                *
  1233*                                                                *
  1234*                            ERCRATE                             *
  1235*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1236*                            VMOD=2.008                          *
  1237*                                                                *
  1238*   ONLINE CREDIT SYSTEM                                         *
  1239*                                                                *
  1240*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1241*                                                                *
  1242*   FILE TYPE = VSAM,KSDS                                        *
  1243*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1244*                                                                *
  1245*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1246*       ALTERNATE PATH = NONE                                    *
  1247*                                                                *
  1248*   LOG = NO                                                     *
  1249*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1250*                                                                *
  1251******************************************************************
  1252
  1253 01  RATE-RECORD.
  1254     12  RT-RECORD-ID                      PIC XX.
  1255         88  VALID-RT-ID                      VALUE 'RT'.
  1256
  1257     12  RT-CONTROL-PRIMARY.
  1258         16  RT-COMPANY-CD                 PIC X.
  1259         16  RT-STATE-CODE.
  1260             20  RT-ST-CODE                PIC XX.
  1261             20  RT-ST-CLASS               PIC XX.
  1262             20  RT-ST-DEV                 PIC XXX.
  1263         16  RT-L-AH-CODE.
  1264             20  RT-L-AH                   PIC X.
  1265             20  RT-LAH-NUM                PIC XX.
  1266         16  RT-LIMITS.
  1267             20  RT-HIGH-AGE               PIC 99.
  1268             20  RT-HIGH-AMT               PIC 9(6).
  1269             20  RT-FUTURE                 PIC XX.
  1270             20  RT-SEX                    PIC X.
  1271         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1272
  1273     12  RT-MAINT-INFORMATION.
  1274         16  RT-LAST-MAINT-DT              PIC XX.
  1275         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1276         16  RT-LAST-MAINT-USER            PIC X(4).
  1277         16  FILLER                        PIC X(10).
  1278
  1279     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1280     12  RT-RATE-COMMENT                   PIC X(50).
  1281
  1282     12  CSL-RESERVED                      PIC X(10).
  1283     12  FILLER                            PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  27
* ELRATE.cbl
  1284
  1285     12  RT-MAX-AGE                        PIC 99.
  1286
  1287     12  RT-LIFE-LIMS-FLDS.
  1288         16  RT-LIFE-MORT-CODE             PIC X(4).
  1289         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1290             20  RT-L-EX-AGE               PIC 99.
  1291             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1292             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1293         16  FILLER                        PIC X(20).
  1294
  1295     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1296         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1297             20  RT-AH-AGE                 PIC 99.
  1298             20  RT-AH-TERM                PIC S999       COMP-3.
  1299             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1300             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1301
  1302     12  RT-LIFE-RATES.
  1303         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1304
  1305     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1306         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1307
  1308     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1309
  1310     12  RT-DISCOUNT-OPTION                PIC X.
  1311         88  RT-DO-NOT-USE                     VALUE ' '.
  1312         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1313         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1314
  1315     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1316     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1317
  1318     12  RT-COMPOSITE-OPTION               PIC X.
  1319         88  RT-NO-COMPOSITE                   VALUE ' '.
  1320         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1321
  1322     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1323
  1324     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.
  1325     12  FILLER                            PIC X(13).
  1326
  1327     12  RT-TYPE-RATE                      PIC X.
  1328         88  RT-IS-STND                        VALUE ' ' 'S'.
  1329         88  RT-IS-OB                          VALUE 'O'.
  1330
  1331     12  RT-SRT-ALPHA                      PIC X.
  1332
  1333     12  RT-CONTROL-2.
  1334         16  RTC-1                         PIC X(7).
  1335         16  RTC-3                         PIC X(11).
  1336         16  RTC-4                         PIC 9(11) COMP-3.
  1337         16  RTC-2                         PIC X(3).
  1338******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  28
* ELRATE.cbl
  1340 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1341 0000-DFHEXIT SECTION.
  1342     MOVE '9#                    $   ' TO DFHEIV0.
  1343     MOVE 'ELRATE' TO DFHEIV1.
  1344     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1345
  1346     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1347
  1348 000-START-PREMIUM-CALC.
  1349     MOVE ZERO                   TO CP-RETURN-CODE
  1350                                    CP-CALC-PREMIUM
  1351                                    CP-PREMIUM-RATE
  1352                                    CP-POLICY-FEE.
  1353
  1354     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1355     MOVE ALL '9'                TO ERRATE-KEY.
  1356
  1357*    IF CP-RATE-FILE = 'O'
  1358*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1359
  1360     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1361     MOVE CP-STATE               TO RATE-ST-CODE.
  1362     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1363     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1364     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1365
  1366     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1367        CP-RATING-BENEFIT-AMT = ZEROS
  1368         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1369     ELSE
  1370         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1371
  1372     IF CP-AH
  1373         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1374     ELSE
  1375         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1376
  1377     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1378     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1379     MOVE SPACE                  TO DC-OPTION-CODE.
  1380
  1381     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1382
  1383*** Y2K, PROJ 7744
  1384     IF NO-CONVERSION-ERROR
  1385         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1386                                       WS-HOLD-RATE-EXP-DT
  1387         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1388         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1389         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1390     ELSE
  1391         MOVE '2'                   TO CP-RETURN-CODE
  1392         GO TO 9999-CALC-RATE-PREM-X
  1393     END-IF.
  1394*** Y2K, PROJ 7744
  1395
  1396
  1397* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  29
* ELRATE.cbl
  1398*        NOTFND   (9999-RATE-NOTFND)
  1399*        NOTOPEN  (9999-RATE-NOTOPEN)
  1400*        ENDFILE  (9999-RATE-NOTFND)
  1401*    END-EXEC.
  1402*    MOVE '"$IJ''                 ! " #00001392' TO DFHEIV0
  1403     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1405     MOVE X'2220233030303031333932' TO DFHEIV0(25:11)
  1406     CALL 'kxdfhei1' USING DFHEIV0
  1407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1408
  1409
  1410 0050-RATE-START-BROWSE.
  1411
  1412* EXEC CICS STARTBR
  1413*        DATASET  (ERRATE-FILE-ID)
  1414*        RIDFLD   (ERRATE-KEY)
  1415*        GTEQ
  1416*    END-EXEC.
  1417     MOVE 0
  1418       TO DFHEIV11
  1419*    MOVE '&,         G          &   #00001399' TO DFHEIV0
  1420     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1422     MOVE X'2020233030303031333939' TO DFHEIV0(25:11)
  1423     CALL 'kxdfhei1' USING DFHEIV0,
  1424           ERRATE-FILE-ID,
  1425           ERRATE-KEY,
  1426           DFHEIV99,
  1427           DFHEIV11,
  1428           DFHEIV99
  1429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1430
  1431
  1432     MOVE 'Y'                  TO WS-BROWSE-SW.
  1433
  1434 0100-READ-RATE-LOOP.
  1435
  1436* EXEC CICS READNEXT
  1437*        DATASET  (ERRATE-FILE-ID)
  1438*        SET      (ADDRESS OF RATE-RECORD)
  1439*        RIDFLD   (ERRATE-KEY)
  1440*    END-EXEC.
  1441     MOVE 0
  1442       TO DFHEIV11
  1443*    MOVE '&.S                   )   #00001408' TO DFHEIV0
  1444     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1445     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1446     MOVE X'2020233030303031343038' TO DFHEIV0(25:11)
  1447     CALL 'kxdfhei1' USING DFHEIV0,
  1448           ERRATE-FILE-ID,
  1449           DFHEIV20,
  1450           DFHEIV99,
  1451           ERRATE-KEY,
  1452           DFHEIV99,
  1453           DFHEIV11,
  1454           DFHEIV99,
  1455           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  30
* ELRATE.cbl
  1456     SET ADDRESS OF RATE-RECORD TO
  1457         DFHEIV20
  1458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1459
  1460
  1461 0110-CHECK-KEYS.
  1462*                            COPY ELCRATPD.
  1463******************************************************************
  1464*                                                                *
  1465*                                                                *
  1466*                            ELCRATPD                            *
  1467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1468*                            VMOD=2.061                          *
  1469*                                                                *
  1470******************************************************************
  1471******************************************************************
  1472*                   C H A N G E   L O G
  1473*
  1474* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1475*-----------------------------------------------------------------
  1476*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1477* EFFECTIVE    NUMBER
  1478*-----------------------------------------------------------------
  1479* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1480* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1481* 032603                   PEMA  ADD SPECIAL AZ CALC
  1482* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1483* 120403                   PEMA  ADD SPECIAL TX CALC
  1484* 092205                   PEMA  FIX CRIT PER FOR DCC
  1485* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1486* 021207                   PEMA  ADD PA NP
  1487* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1488* 032807                   PEMA  ADD VT NP PLUS 2
  1489* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1490* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1491* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1492* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1493* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1494* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1495* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1496* 071211    2010012700001  PEMA  ADD SPPDD
  1497* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1498* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1499* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1500* 032612  CR2011110200001  PEMA  AHL CHANGES
  1501* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  1502* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  1503******************************************************************
  1504
  1505 0110-CHECK-KEY.
  1506     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1507        SVRT-ST-CODE    = RT-ST-CODE     AND
  1508        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1509        SVRT-ST-DEV     = RT-ST-DEV      AND
  1510        SVRT-L-AH       = RT-L-AH        AND
  1511        SVRT-LAH-NUM    = RT-LAH-NUM
  1512         NEXT SENTENCE
  1513     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  31
* ELRATE.cbl
  1514         GO TO 9999-RATE-NOTFND.
  1515
  1516     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1517         GO TO 9999-RATE-NOTFND.
  1518
  1519     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1520        GO TO 0100-READ-RATE-LOOP.
  1521
  1522     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1523         GO TO 0100-READ-RATE-LOOP.
  1524
  1525     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1526         GO TO 0100-READ-RATE-LOOP.
  1527
  1528     IF RT-MAX-AGE = ZEROS
  1529         NEXT SENTENCE
  1530     ELSE
  1531         COMPUTE WS-AGE =
  1532             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1533         IF WS-AGE >= RT-MAX-AGE
  1534             MOVE 'B'               TO CP-RETURN-CODE.
  1535
  1536     IF CP-LOAN-TERM NOT NUMERIC
  1537         MOVE +0                    TO CP-LOAN-TERM.
  1538
  1539     IF CP-LOAN-TERM = ZERO
  1540         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1541
  1542     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1543         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1544
  1545     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1546     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1547
  1548     IF CP-AH
  1549         GO TO 2000-TYPE-IS-AH.
  1550
  1551     evaluate true
  1552        when (rt-is-ob)
  1553           and (cp-company-id not = 'CID')
  1554              move cp-loan-term  to ws-rate-term
  1555        when (cp-company-id = 'DCC')
  1556           and (cp-benefit-cd (1:1) = 'P')
  1557           move cp-loan-term     to ws-rate-term
  1558        when other
  1559           move cp-original-term to ws-rate-term
  1560     end-evaluate
  1561
  1562*    IF ((RT-IS-OB)
  1563*       AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1564*                     OR
  1565*       ((CP-COMPANY-ID = 'DCC')
  1566*       AND (CP-BENEFIT-CD (1:1) = 'P'))
  1567*       MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1568*    ELSE
  1569*       MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1570*    END-IF
  1571
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  32
* ELRATE.cbl
  1572     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1573     MOVE SPACE                     TO DC-OPTION-CODE.
  1574
  1575     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1576
  1577 1000-TYPE-IS-LIFE.
  1578     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1579
  1580     MOVE ZERO                      TO CP-R-MAX-AGE
  1581                                       CP-R-MAX-TERM
  1582                                       CP-R-MAX-MON-BEN
  1583                                       CP-R-MAX-TOT-BEN.
  1584
  1585     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1586
  1587     IF RT-POLICY-FEE NUMERIC
  1588        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  1589
  1590     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1591
  1592     IF (RT-DISCOUNT-OPTION EQUAL
  1593                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1594        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1595        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1596         NEXT SENTENCE
  1597     ELSE
  1598         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1599            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1600             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1601                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1602                 GO TO 1050-REGULAR-RATES
  1603             ELSE
  1604                 GO TO 1050-REGULAR-RATES
  1605         ELSE
  1606             GO TO 1050-REGULAR-RATES.
  1607
  1608*    display ' discount option ' rt-discount-option
  1609     IF RT-DISCOUNT-RATE NOT NUMERIC
  1610        MOVE +0                  TO RT-DISCOUNT-RATE.
  1611
  1612     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1613        NEXT SENTENCE
  1614     ELSE
  1615        MOVE +0                  TO CP-PREMIUM-RATE
  1616                                    CP-COMPOSITE-RATE
  1617                                    CP-CALC-PREMIUM
  1618         MOVE '4'                TO CP-RETURN-CODE
  1619         GO TO 9999-CALC-RATE-PREM-X.
  1620
  1621     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1622        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1623     ELSE
  1624        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1625
  1626*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1627*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1628*       GO TO 1075-BYPASS-REGULAR-RATE.
  1629
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  33
* ELRATE.cbl
  1630     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1631        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1632        COMPUTE WS-WORK-DIS-RATE EQUAL
  1633                WS-WORK-DIS-RATE / +100
  1634        GO TO 1075-BYPASS-REGULAR-RATE.
  1635
  1636     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1637        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1638        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1639        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1640        GO TO 1075-BYPASS-REGULAR-RATE.
  1641
  1642     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1643        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1644        (CP-TRUNCATED-LIFE)
  1645        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1646        GO TO 1075-BYPASS-REGULAR-RATE.
  1647
  1648     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1649        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1650        (CP-EARN-AS-NET-PAY)
  1651*       (CP-TRUNCATED-LIFE)
  1652        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1653        GO TO 1075-BYPASS-REGULAR-RATE.
  1654
  1655     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1656        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1657                   AND
  1658        ((CP-EARN-AS-NET-PAY)
  1659               OR
  1660        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1661        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1662        GO TO 1075-BYPASS-REGULAR-RATE.
  1663
  1664     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1665        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1666        (CP-EARN-AS-NET-PAY) AND
  1667        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1668        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1669        GO TO 1075-BYPASS-REGULAR-RATE.
  1670
  1671     IF (CP-COMPANY-ID = 'CID')
  1672        AND (CP-STATE-STD-ABBRV = 'MN')
  1673        AND (RT-DISCOUNT-OPTION = '1')
  1674        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1675                     OR
  1676            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
  1677            AND (CP-CERT-EFF-DT > X'A4FF'))
  1678        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1679        GO TO 1075-BYPASS-REGULAR-RATE
  1680     END-IF
  1681     IF (CP-COMPANY-ID EQUAL 'CID')
  1682        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1683                      OR
  1684            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1685        AND (CP-EARN-AS-NET-PAY)
  1686        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1687        GO TO 1075-BYPASS-REGULAR-RATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  34
* ELRATE.cbl
  1688     END-IF
  1689     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1690        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1691        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1692         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1693         GO TO 1075-BYPASS-REGULAR-RATE.
  1694
  1695     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1696        CONTINUE
  1697     ELSE
  1698        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1699           (CP-EARN-AS-NET-PAY ) AND
  1700           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1701            GO TO 1075-BYPASS-REGULAR-RATE
  1702        END-IF
  1703     END-IF
  1704     IF (CP-COMPANY-ID = 'CID') AND
  1705        (CP-EARN-AS-NET-PAY) AND
  1706        (CP-LEVEL-LIFE) AND
  1707        (CP-STATE-STD-ABBRV = 'CA') AND
  1708        (CP-STATE-STD-ABBRV = CP-STATE)
  1709        COMPUTE WS-WORK-DIS-RATE =
  1710             RT-DISCOUNT-RATE / +100
  1711        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1712        GO TO 1075-BYPASS-REGULAR-RATE
  1713     END-IF
  1714
  1715     IF (CP-COMPANY-ID = 'CID')
  1716        AND (CP-EARN-AS-NET-PAY)
  1717        AND (CP-STATE-STD-ABBRV = 'ME')
  1718        COMPUTE WS-WORK-DIS-RATE =
  1719             RT-DISCOUNT-RATE / +100
  1720        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1721        GO TO 1075-BYPASS-REGULAR-RATE
  1722     END-IF
  1723     IF (CP-COMPANY-ID = 'CID')
  1724        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1725           OR 'IN' OR 'AZ' OR 'WA')
  1726        AND (CP-FARM-PLAN)
  1727        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1728        GO TO 1075-BYPASS-REGULAR-RATE
  1729     END-IF
  1730     IF (CP-COMPANY-ID = 'DCC')
  1731        AND (CP-BEN-CATEGORY = 'D')
  1732        AND (CP-EARN-AS-NET-PAY)
  1733        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1734        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1735           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1736*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1737*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1738*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1739*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1740        GO TO 1075-BYPASS-REGULAR-RATE
  1741     END-IF
  1742     IF (CP-COMPANY-ID = 'CID') AND
  1743        (CP-EARN-AS-NET-PAY) AND
  1744        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1745                            OR 'VT')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  35
* ELRATE.cbl
  1746                   OR
  1747        ((CP-STATE-STD-ABBRV = 'IN') AND
  1748        (CP-CERT-EFF-DT > X'9A7F'))
  1749                   OR
  1750        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1751        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1752        (CP-STATE-STD-ABBRV = CP-STATE)
  1753        COMPUTE WS-WORK-DIS-RATE =
  1754             RT-DISCOUNT-RATE / +100
  1755        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1756        GO TO 1075-BYPASS-REGULAR-RATE
  1757     END-IF
  1758
  1759     IF (CP-COMPANY-ID = 'CID') AND
  1760        (CP-EARN-AS-NET-PAY) AND
  1761        (CP-STATE-STD-ABBRV = 'TX') AND
  1762        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1763        (WS-DISCOUNT-OPTION NOT = ' ')
  1764        COMPUTE WS-WORK-DIS-RATE =
  1765             RT-DISCOUNT-RATE / +100
  1766        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1767        GO TO 1075-BYPASS-REGULAR-RATE
  1768     END-IF
  1769
  1770     IF (CP-COMPANY-ID = 'CID') AND
  1771        (CP-EARN-AS-NET-PAY) AND
  1772        (CP-TRUNCATED-LIFE) AND
  1773        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1774        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1775        (WS-DISCOUNT-OPTION NOT = ' ')
  1776        COMPUTE WS-WORK-DIS-RATE =
  1777             RT-DISCOUNT-RATE / +100
  1778        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1779        GO TO 1075-BYPASS-REGULAR-RATE
  1780     END-IF
  1781
  1782     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1783        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1784           COMPUTE WS-WORK-DIS-RATE EQUAL
  1785                   WS-WORK-DIS-RATE / +100.
  1786
  1787     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1788        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1789           IF CP-MONTHLY-PAYMENT EQUAL +0
  1790            IF CP-LOAN-APR GREATER THAN +2
  1791              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1792              CP-ORIGINAL-BENEFIT /
  1793               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1794               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1795            ELSE
  1796             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1797               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1798
  1799     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1800        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1801          IF WS-WORK-DIS-RATE GREATER THAN +0
  1802           COMPUTE WK1 ROUNDED EQUAL
  1803           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  36
* ELRATE.cbl
  1804                              (WS-RATE-TERM - +1)) /
  1805                        (WS-WORK-DIS-RATE / +12)
  1806           COMPUTE WK2 ROUNDED EQUAL
  1807           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1808                              (WS-RATE-TERM)) /
  1809                        (WS-WORK-DIS-RATE / +12)
  1810           COMPUTE WK3 EQUAL
  1811                RT-DISCOUNT-OB-RATE *
  1812                (1 + WS-WORK-DIS-RATE / +12)
  1813                MOVE WK3 TO CP-PREMIUM-RATE
  1814                COMPUTE WK5 EQUAL WK3 / +1000
  1815           GO TO 1075-BYPASS-REGULAR-RATE.
  1816*               (RT-DISCOUNT-OB-RATE / +1000) *
  1817*               (1 + WS-WORK-DIS-RATE / +12)
  1818*          GO TO 1075-BYPASS-REGULAR-RATE.
  1819
  1820     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1821        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1822           COMPUTE WK3 EQUAL
  1823           RT-DISCOUNT-OB-RATE *
  1824           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1825           MOVE WK3 TO CP-PREMIUM-RATE
  1826           COMPUTE WK5 EQUAL WK3 / +1000
  1827           GO TO 1075-BYPASS-REGULAR-RATE.
  1828
  1829     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1830        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1831        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1832        GO TO 1075-BYPASS-REGULAR-RATE.
  1833
  1834     COMPUTE WS-SIN-PREM-RATE =
  1835             (RT-DISCOUNT-OB-RATE / +1000) *
  1836             ((WS-RATE-TERM + +1) / +2).
  1837
  1838     COMPUTE CP-PREMIUM-RATE =
  1839             WS-SIN-PREM-RATE /
  1840             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1841             WS-RATE-TERM) / +24)).
  1842
  1843     IF CP-PREMIUM-RATE NOT = +0
  1844        MULTIPLY +100 BY CP-PREMIUM-RATE
  1845        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1846        GO TO 1075-BYPASS-REGULAR-RATE.
  1847
  1848 1050-REGULAR-RATES.
  1849
  1850     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1851        COMPUTE WK5 EQUAL
  1852        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1853        (6 * (WS-RATE-TERM + 1))
  1854        MOVE WK5 TO CP-PREMIUM-RATE
  1855        GO TO 1075-BYPASS-REGULAR-RATE.
  1856
  1857     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1858        (CP-CSL-VALID-NP-BENEFIT-CD)
  1859        IF CP-JOINT-INDICATOR EQUAL 'J'
  1860           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1861           GO TO 1075-BYPASS-REGULAR-RATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  37
* ELRATE.cbl
  1862        ELSE
  1863           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1864           GO TO 1075-BYPASS-REGULAR-RATE.
  1865
  1866     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1867        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1868        (CP-EARN-AS-NET-PAY )
  1869        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1870        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1871        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1872        MOVE '1'                 TO DC-OPTION-CODE
  1873        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1874        IF DATE-CONVERSION-ERROR
  1875            MOVE '2'                TO CP-RETURN-CODE
  1876            GO TO 9999-CALC-RATE-PREM-X
  1877        ELSE
  1878            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1879                                         DC-ODD-DAYS-OVER
  1880            GO TO 1075-BYPASS-REGULAR-RATE.
  1881
  1882     IF RT-COMPOSITE-RATE NOT NUMERIC
  1883         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1884
  1885*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1886     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1887         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1888                                              WS-PREMIUM-RATE
  1889         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1890     ELSE
  1891         MOVE +0                           TO CP-PREMIUM-RATE
  1892                                              CP-COMPOSITE-RATE
  1893                                              CP-CALC-PREMIUM
  1894         GO TO 9999-CALC-RATE-PREM-X.
  1895     IF (CP-COMPANY-ID EQUAL 'CID')
  1896        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1897        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1898        AND (CP-EARN-AS-NET-PAY)
  1899        GO TO 1075-BYPASS-REGULAR-RATE
  1900     END-IF
  1901******************************************************
  1902*    IF CP-COMPANY-ID NOT = 'LBL'
  1903     IF CP-COMPANY-ID NOT = 'LBL' AND 'CID'
  1904         GO TO 1075-BYPASS-REGULAR-RATE.
  1905
  1906     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1907     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1908     MOVE '1'                    TO DC-OPTION-CODE.
  1909     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1910     IF DATE-CONVERSION-ERROR
  1911         MOVE '2'                TO CP-RETURN-CODE
  1912         GO TO 9999-CALC-RATE-PREM-X
  1913       ELSE
  1914         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1915         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1916
  1917     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1918        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1919        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  38
* ELRATE.cbl
  1920
  1921     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1922        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1923           NEXT SENTENCE
  1924         ELSE
  1925           GO TO 1075-BYPASS-REGULAR-RATE
  1926       ELSE
  1927        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1928           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1929           NEXT SENTENCE
  1930         ELSE
  1931           GO TO 1075-BYPASS-REGULAR-RATE.
  1932
  1933     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1934        COMPUTE CP-PREMIUM-RATE =
  1935        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1936         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1937         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1938
  1939     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1940        COMPUTE CP-PREMIUM-RATE =
  1941        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1942        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1943        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1944        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1945         * (CP-ORIGINAL-TERM - 1)).
  1946******************************************************
  1947
  1948 1075-BYPASS-REGULAR-RATE.
  1949
  1950     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1951
  1952     MOVE +1 TO LINDX.
  1953
  1954     IF CP-COMPANY-ID EQUAL 'CRI'
  1955        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  1956           MOVE +5               TO LINDX
  1957           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1958              MOVE 'F'           TO CP-RETURN-CODE
  1959              GO TO 1200-CALCULATE-PREMIUMS.
  1960
  1961     IF RT-L-EX-AGE (LINDX) = ZERO
  1962          GO TO 1200-CALCULATE-PREMIUMS.
  1963
  1964 1100-SEARCH-LIFE-LIMITS.
  1965
  1966     IF CP-COMPANY-ID EQUAL 'CRI'
  1967        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  1968           IF LINDX GREATER THAN +4
  1969              MOVE 'A'           TO CP-RETURN-CODE
  1970              GO TO 1200-CALCULATE-PREMIUMS.
  1971
  1972     IF LINDX GREATER +8
  1973         MOVE 'A'                TO CP-RETURN-CODE
  1974         GO TO 1200-CALCULATE-PREMIUMS.
  1975
  1976     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  1977         IF RT-L-EX-AGE (LINDX) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  39
* ELRATE.cbl
  1978             ADD +1              TO LINDX
  1979             GO TO 1100-SEARCH-LIFE-LIMITS
  1980         ELSE
  1981             MOVE RT-L-EX-AGE (LINDX)
  1982                                 TO CP-R-MAX-AGE
  1983             MOVE RT-L-EX-TERM (LINDX)
  1984                                 TO CP-R-MAX-TERM
  1985             MOVE RT-L-EX-FACE (LINDX)
  1986                                 TO CP-R-MAX-TOT-BEN
  1987             ADD +1              TO LINDX
  1988             GO TO 1100-SEARCH-LIFE-LIMITS
  1989     ELSE
  1990         MOVE RT-L-EX-AGE (LINDX)
  1991                                 TO CP-R-MAX-AGE
  1992         MOVE RT-L-EX-TERM (LINDX)
  1993                                 TO CP-R-MAX-TERM
  1994         MOVE RT-L-EX-FACE (LINDX)
  1995                                 TO CP-R-MAX-TOT-BEN.
  1996
  1997     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  1998         MOVE '9'                TO CP-RETURN-CODE.
  1999
  2000     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  2001         MOVE '8'                TO CP-RETURN-CODE.
  2002
  2003 1200-CALCULATE-PREMIUMS.
  2004
  2005     IF CP-COMPANY-ID = 'CSL'
  2006        IF CP-CSL-VALID-NP-BENEFIT-CD
  2007           GO TO 1240-NET-PAY-CONT
  2008        ELSE
  2009           GO TO 1250-CSL-CALC.
  2010
  2011     IF CP-COMPANY-ID = 'WDS'
  2012        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  2013           IF CP-EARN-AS-REG-BALLOON
  2014              GO TO 1240-NET-PAY-CONT.
  2015
  2016     IF (CP-COMPANY-ID = 'CID')
  2017        AND (CP-STATE-STD-ABBRV = 'MN')
  2018        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  2019        AND (CP-CERT-EFF-DT > X'A4FF')
  2020        GO TO 1240-NET-PAY-CONT
  2021     END-IF
  2022     IF (CP-COMPANY-ID = 'CID')
  2023        AND (CP-STATE-STD-ABBRV = 'WA')
  2024        AND (CP-FARM-PLAN)
  2025        GO TO 1240-NET-PAY-CONT
  2026     END-IF
  2027     IF (CP-COMPANY-ID = 'CID')
  2028        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2029           OR 'IN' OR 'AZ')
  2030        AND (CP-FARM-PLAN)
  2031***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  2032***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2033        MOVE +1.0                TO CP-LOAN-APR
  2034        GO TO 1240-NET-PAY-CONT
  2035     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  40
* ELRATE.cbl
  2036     IF CP-RATE-AS-STANDARD
  2037         GO TO 1210-REGULAR-RATE.
  2038
  2039     IF CP-CRITICAL-PERIOD
  2040         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2041
  2042     IF CP-EARN-AS-TEXAS
  2043         GO TO 1230-TEXAS-CONT.
  2044
  2045     IF CP-EARN-AS-NET-PAY
  2046        IF CP-STATE-STD-ABBRV = 'MD'
  2047          IF CP-COMPANY-ID = 'MON'
  2048            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2049                               '14' OR '26' OR '47'
  2050              GO TO 1210-REGULAR-RATE.
  2051
  2052     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2053        IF CP-MONTHLY-PAYMENT EQUAL +0
  2054           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2055                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2056
  2057     IF CP-COMPANY-ID EQUAL 'GTL'
  2058        NEXT SENTENCE
  2059     ELSE
  2060     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2061        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2062           COMPUTE WK3 ROUNDED EQUAL
  2063           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2064           CP-MONTHLY-PAYMENT
  2065           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2066           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2067           CP-ALTERNATE-BENEFIT)
  2068           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2069           WK3 * WK5
  2070           GO TO 9999-CALC-RATE-PREM-X
  2071        ELSE
  2072           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2073           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2074           (WS-WORK-DIS-RATE / +12)
  2075           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2076           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2077                               WK5
  2078           GO TO 9999-CALC-RATE-PREM-X.
  2079
  2080     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2081        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2082        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2083        CP-ORIGINAL-TERM LESS THAN +61
  2084        COMPUTE CP-CALC-PREMIUM EQUAL
  2085                        (CP-ORIGINAL-BENEFIT *
  2086           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2087           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2088        COMPUTE CP-CALC-PREMIUM EQUAL
  2089                CP-CALC-PREMIUM +
  2090              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2091        (CP-ORIGINAL-TERM + 1)) /
  2092        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2093        GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  41
* ELRATE.cbl
  2094
  2095     IF CP-COMPANY-ID = 'GTL'     AND
  2096        CP-STATE-STD-ABBRV = 'PA' AND
  2097        CP-SPECIAL-CALC-CD = 'H'
  2098         GO TO 1260-GTL-PA-LEASE.
  2099
  2100     IF (CP-EARN-AS-NET-PAY)
  2101        AND (CP-LOAN-APR > ZEROS)
  2102        GO TO 1240-NET-PAY-CONT
  2103     END-IF
  2104
  2105     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2106         GO TO 1210-REGULAR-RATE.
  2107
  2108**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2109**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2110****
  2111     IF CP-DEVIATION-CODE = 'LEV' AND
  2112        CP-LOAN-APR = ZEROS
  2113         GO TO 1210-REGULAR-RATE.
  2114
  2115     IF (CP-STATE-STD-ABBRV = 'OH')
  2116        AND (CP-CLASS-CODE NOT = 'L ')
  2117        AND (CP-ORIGINAL-TERM > 60)
  2118        AND (DC-GREG-DATE-CYMD > 19831031)
  2119        AND (CP-LOAN-APR > ZEROS)
  2120        GO TO 1240-NET-PAY-CONT
  2121     END-IF
  2122
  2123     IF (CP-STATE-STD-ABBRV = 'UT')
  2124        AND (CP-ORIGINAL-TERM > 62)
  2125        AND (DC-GREG-DATE-CYMD > 19810831)
  2126        AND (DC-GREG-DATE-CYMD < 19830901)
  2127        AND (CP-LOAN-APR > ZEROS)
  2128        GO TO 1240-NET-PAY-CONT
  2129     END-IF
  2130
  2131     IF (CP-STATE-STD-ABBRV = 'RI')
  2132        AND (CP-ORIGINAL-TERM > 60)
  2133        AND (DC-GREG-DATE-CYMD > 19831231)
  2134        AND (CP-LOAN-APR > ZEROS)
  2135        GO TO 1240-NET-PAY-CONT
  2136     END-IF
  2137     .
  2138 1210-REGULAR-RATE.
  2139
  2140     IF (CP-COMPANY-ID = 'CID')
  2141        AND (CP-EARN-AS-NET-PAY)
  2142        AND (CP-LOAN-APR = 0)
  2143        IF RT-L-RATE (WS-RATE-TERM) = 0
  2144           COMPUTE WS-SIN-PREM-RATE =
  2145              (RT-DISCOUNT-OB-RATE / +1000) *
  2146              ((WS-RATE-TERM + +1) / +2)
  2147           COMPUTE CP-PREMIUM-RATE =
  2148              WS-SIN-PREM-RATE /
  2149              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2150              WS-RATE-TERM) / +24))
  2151        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  42
* ELRATE.cbl
  2152           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2153        END-IF
  2154     END-IF
  2155*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2156*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2157*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2158*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2159*
  2160*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2161*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2162*          COMPUTE WK3 ROUNDED EQUAL
  2163*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2164*          CP-MONTHLY-PAYMENT
  2165*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2166*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2167*          CP-ALTERNATE-BENEFIT)
  2168*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2169*          WK3 * WK5
  2170*          GO TO 9999-CALC-RATE-PREM-X
  2171*       ELSE
  2172*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2173*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2174*          (WS-WORK-DIS-RATE / +12)
  2175*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2176*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2177*                              WK5
  2178*          GO TO 9999-CALC-RATE-PREM-X.
  2179
  2180     IF CP-TERM-IS-DAYS
  2181         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2182             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2183         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2184             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2185                          * CP-TERM-OR-EXT-DAYS
  2186           GO TO 9999-CALC-RATE-PREM-X.
  2187
  2188     if (cp-company-id = 'AHL')
  2189        and (cp-loan-term > cp-original-term)
  2190        continue
  2191     else
  2192        IF NOT CP-TRUNCATED-LIFE
  2193           GO TO 1212-GROSS-NOT-TRUNCATED
  2194        end-if
  2195     end-if
  2196
  2197****  GROSS TRUNCATED CALCULATION
  2198
  2199     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2200         MOVE 'H'                TO  CP-RETURN-CODE
  2201         GO TO 9999-CALC-RATE-PREM-X.
  2202     if cp-company-id = 'AHL'
  2203        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2204           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2205           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2206           cp-original-term) * (cp-loan-term - cp-original-term
  2207            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2208            cp-premium-rate / 100 * cp-original-term /
  2209            cp-loan-term * cp-original-benefit
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  43
* ELRATE.cbl
  2210        else
  2211           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2212           cp-original-term) * (cp-loan-term - cp-original-term
  2213            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2214            cp-premium-rate * cp-original-benefit / 100
  2215        end-if
  2216        go to 9999-calc-rate-prem-x
  2217     end-if
  2218
  2219     IF CP-COMPANY-ID = 'NCL'
  2220         COMPUTE WK-MONTHLY-RATE =
  2221               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2222                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2223                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2224                                 /
  2225                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2226                                 *
  2227                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2228         COMPUTE CP-CALC-PREMIUM =
  2229                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2230     ELSE
  2231         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2232                                 CP-ORIGINAL-TERM
  2233         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2234                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2235                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2236                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2237     END-IF
  2238     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2239        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2240           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2241           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2242     END-IF
  2243     GO TO 9999-CALC-RATE-PREM-X
  2244     .
  2245 1212-GROSS-NOT-TRUNCATED.
  2246*    DISPLAY ' ELCRATPD '
  2247*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2248*    display ' premium rate ' cp-premium-rate
  2249
  2250     IF (CP-COMPANY-ID = 'CID')
  2251        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2252           OR 'IN')
  2253        AND (CP-BENEFIT-CD = '55' OR '56')
  2254        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2255          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2256          (CP-ORIGINAL-TERM) *
  2257          ((CP-ORIGINAL-TERM) / 12) *
  2258          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2259          GO TO 9999-CALC-RATE-PREM-X
  2260     END-IF
  2261     IF (CP-COMPANY-ID = 'CID')
  2262        AND (CP-STATE-STD-ABBRV = 'GA')
  2263        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2264        COMPUTE WK3 ROUNDED =
  2265          CP-ORIGINAL-BENEFIT *
  2266          ((CP-ORIGINAL-TERM + 1) / 2) *
  2267          (RT-DISCOUNT-OB-RATE / 1000)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  44
* ELRATE.cbl
  2268          MOVE WK3 TO CP-CALC-PREMIUM
  2269          GO TO 9999-CALC-RATE-PREM-X
  2270     END-IF
  2271     IF (CP-COMPANY-ID EQUAL 'CID')
  2272        AND (CP-STATE-STD-ABBRV = 'MN')
  2273        AND (CP-LEVEL-LIFE)
  2274        AND (CP-CERT-EFF-DT > X'A4FF')
  2275        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2276        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2277        MOVE '1'                 TO DC-OPTION-CODE
  2278        PERFORM 9100-CONVERT-DATE
  2279                                 THRU 9100-EXIT
  2280        IF DATE-CONVERSION-ERROR
  2281           MOVE '2'              TO CP-RETURN-CODE
  2282           MOVE ZEROS            TO FACTOR
  2283                                 CP-CALC-PREMIUM
  2284           GO TO 9999-CALC-RATE-PREM-X
  2285        END-IF
  2286        MOVE DC-ELAPSED-DAYS     TO D
  2287        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2288           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2289           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2290        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2291           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2292        GO TO 9999-CALC-RATE-PREM-X
  2293     END-IF
  2294     IF (CP-COMPANY-ID = 'CID')
  2295        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2296        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2297           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2298     ELSE
  2299        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2300                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2301     END-IF
  2302*    display ' calc premium ' cp-calc-premium
  2303
  2304*    IF CP-COMPANY-ID = 'LBL'
  2305     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2306        AND (NOT CP-EARN-AS-NET-PAY)
  2307        GO TO 9999-CALC-RATE-PREM-X
  2308     END-IF
  2309
  2310*    display ' fell through to ext days '
  2311     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2312         GO TO 9999-CALC-RATE-PREM-X.
  2313
  2314     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2315         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2316            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2317               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2318
  2319     GO TO 9999-CALC-RATE-PREM-X.
  2320
  2321 1220-CRITICAL-PERIOD-LF-CONT.
  2322     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2323               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2324
  2325     GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  45
* ELRATE.cbl
  2326
  2327 1230-TEXAS-CONT.
  2328     IF CP-FARM-PLAN
  2329         GO TO 1235-TEXAS-FARM-CONT.
  2330
  2331     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2332               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2333
  2334     COMPUTE TEX-FACT-9 =
  2335                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2336                 (CP-ORIGINAL-TERM + 1).
  2337
  2338     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2339                 CP-CALC-PREMIUM * TEX-FACT-9.
  2340
  2341     GO TO 9999-CALC-RATE-PREM-X.
  2342
  2343 1235-TEXAS-FARM-CONT.
  2344     COMPUTE WS-FARM-TERM =
  2345               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2346
  2347     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2348     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2349
  2350
  2351     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2352              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2353
  2354     GO TO 9999-CALC-RATE-PREM-X.
  2355
  2356 1240-NET-PAY-CONT.
  2357
  2358     MOVE CP-LOAN-APR             TO N-P-APR.
  2359     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2360                                     N-P-REM
  2361                                     N-P-LOAN.
  2362
  2363     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2364
  2365     IF CP-TRUNCATED-LIFE
  2366         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2367
  2368     IF CP-COMPANY-ID EQUAL 'NCL'
  2369        NEXT SENTENCE
  2370     ELSE
  2371        GO TO 1241-NET-PAY-CONT.
  2372
  2373     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2374     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2375     MOVE '1'                    TO DC-OPTION-CODE
  2376     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2377     IF DATE-CONVERSION-ERROR
  2378         MOVE '2'                TO CP-RETURN-CODE
  2379         GO TO 9999-CALC-RATE-PREM-X
  2380     ELSE
  2381        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2382        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2383
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  46
* ELRATE.cbl
  2384     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2385        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2386        NEXT SENTENCE
  2387     ELSE
  2388        MOVE +1                  TO ODF
  2389        GO TO 1241-NET-PAY-CONT.
  2390
  2391     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2392        COMPUTE CP-PREMIUM-RATE EQUAL
  2393        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2394        CP-PREMIUM-RATE) *
  2395        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2396
  2397     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2398        COMPUTE CP-PREMIUM-RATE EQUAL
  2399        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2400        N-P-LOAN * (N-P-LOAN - 1))) *
  2401        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2402        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2403
  2404     COMPUTE ODF EQUAL
  2405     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2406     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2407
  2408 1241-NET-PAY-CONT.
  2409
  2410     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2411
  2412*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2413     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2414        NEXT SENTENCE
  2415     ELSE
  2416        GO TO 9999-CALC-RATE-PREM-X.
  2417
  2418     IF RT-DISCOUNT-OPTION EQUAL '6'
  2419         GO TO 9999-CALC-RATE-PREM-X.
  2420
  2421     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2422        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2423        GO TO 9999-CALC-RATE-PREM-X.
  2424
  2425     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2426
  2427     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2428        GO TO 9999-CALC-RATE-PREM-X.
  2429
  2430     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2431        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2432        (CP-TRUNCATED-LIFE)
  2433        GO TO 9999-CALC-RATE-PREM-X.
  2434
  2435     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2436        (CP-CSL-VALID-NP-BENEFIT-CD)
  2437        GO TO 9999-CALC-RATE-PREM-X.
  2438
  2439     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2440        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2441        (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  47
* ELRATE.cbl
  2442        GO TO 9999-CALC-RATE-PREM-X.
  2443
  2444*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2445*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2446*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2447*       GO TO 9999-CALC-RATE-PREM-X.
  2448
  2449     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2450        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2451        (CP-EARN-AS-NET-PAY)
  2452        GO TO 9999-CALC-RATE-PREM-X.
  2453
  2454     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2455        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2456        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2457        GO TO 9999-CALC-RATE-PREM-X.
  2458
  2459     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2460        (CP-EARN-AS-NET-PAY)
  2461        GO TO 9999-CALC-RATE-PREM-X.
  2462
  2463     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2464        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2465        (CP-TRUNCATED-LIFE)
  2466        GO TO 9999-CALC-RATE-PREM-X.
  2467
  2468     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2469        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2470        (CP-EARN-AS-NET-PAY)
  2471*       (CP-TRUNCATED-LIFE)
  2472        GO TO 9999-CALC-RATE-PREM-X.
  2473
  2474     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2475        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2476                   AND
  2477        ((CP-EARN-AS-NET-PAY)
  2478               OR
  2479        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2480        GO TO 9999-CALC-RATE-PREM-X.
  2481
  2482     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2483        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2484        (CP-EARN-AS-NET-PAY) AND
  2485        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2486        GO TO 9999-CALC-RATE-PREM-X.
  2487
  2488     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2489        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2490        (CP-EARN-AS-NET-PAY)
  2491        GO TO 9999-CALC-RATE-PREM-X.
  2492
  2493     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2494        CONTINUE
  2495     ELSE
  2496        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2497           (CP-EARN-AS-NET-PAY) AND
  2498           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2499           GO TO 9999-CALC-RATE-PREM-X
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  48
* ELRATE.cbl
  2500        END-IF
  2501     END-IF
  2502
  2503     IF (CP-COMPANY-ID = 'CID')
  2504        AND (CP-EARN-AS-NET-PAY)
  2505        AND (CP-STATE-STD-ABBRV = 'ME')
  2506        GO TO 9999-CALC-RATE-PREM-X
  2507     END-IF
  2508     IF (CP-COMPANY-ID = 'DCC')
  2509        AND (CP-BEN-CATEGORY = 'D')
  2510        AND (CP-EARN-AS-NET-PAY)
  2511        GO TO 9999-CALC-RATE-PREM-X
  2512     END-IF
  2513     IF (CP-COMPANY-ID = 'CID')
  2514        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2515           OR 'IN' OR 'AZ' OR 'WA')
  2516        AND (CP-FARM-PLAN)
  2517        GO TO 9999-CALC-RATE-PREM-X
  2518     END-IF
  2519     IF (CP-COMPANY-ID = 'CID') AND
  2520        (CP-EARN-AS-NET-PAY) AND
  2521        (CP-LEVEL-LIFE) AND
  2522        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2523        (CP-STATE-STD-ABBRV = CP-STATE)
  2524        GO TO 9999-CALC-RATE-PREM-X
  2525     END-IF
  2526
  2527     IF (CP-COMPANY-ID = 'CID') AND
  2528        (CP-EARN-AS-NET-PAY) AND
  2529        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2530                            OR 'VT')
  2531                   OR
  2532        ((CP-STATE-STD-ABBRV = 'IN') AND
  2533        (CP-CERT-EFF-DT > X'9A7F'))
  2534                   OR
  2535        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2536        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2537        (CP-STATE-STD-ABBRV = CP-STATE)
  2538        GO TO 9999-CALC-RATE-PREM-X
  2539     END-IF
  2540
  2541     IF (CP-COMPANY-ID = 'CID') AND
  2542        (CP-EARN-AS-NET-PAY) AND
  2543        (CP-STATE-STD-ABBRV = 'TX') AND
  2544        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2545        (WS-DISCOUNT-OPTION NOT = ' ')
  2546        GO TO 9999-CALC-RATE-PREM-X
  2547     END-IF
  2548
  2549     IF (CP-COMPANY-ID = 'CID')
  2550        AND (CP-STATE-STD-ABBRV = 'MN')
  2551        AND (RT-DISCOUNT-OPTION = '1')
  2552        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2553           CP-EARN-AS-FARM-PLAN)
  2554        GO TO 9999-CALC-RATE-PREM-X
  2555     END-IF
  2556     IF (CP-COMPANY-ID = 'CID')
  2557        AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  49
* ELRATE.cbl
  2558        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2559                      OR
  2560            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2561        GO TO 9999-CALC-RATE-PREM-X
  2562     END-IF
  2563     IF (CP-COMPANY-ID = 'CID')
  2564        AND (CP-EARN-AS-NET-PAY)
  2565        AND (CP-STATE-STD-ABBRV = 'SC')
  2566        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2567        GO TO 9999-CALC-RATE-PREM-X
  2568     END-IF
  2569     IF (CP-COMPANY-ID = 'CID') AND
  2570        (CP-EARN-AS-NET-PAY) AND
  2571        (CP-TRUNCATED-LIFE) AND
  2572        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2573        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2574        (WS-DISCOUNT-OPTION NOT = ' ')
  2575        GO TO 9999-CALC-RATE-PREM-X
  2576     END-IF
  2577
  2578     IF (CP-COMPANY-ID EQUAL 'DCC') AND
  2579        (CP-EARN-AS-NET-PAY)
  2580        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2581        GO TO 9999-CALC-RATE-PREM-X
  2582     END-IF
  2583
  2584     IF (CP-COMPANY-ID EQUAL 'CID')
  2585        AND (CP-EARN-AS-NET-PAY)
  2586        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2587        GO TO 9999-CALC-RATE-PREM-X
  2588     END-IF
  2589
  2590     IF (RT-IS-OB) AND
  2591        (CP-COMPANY-ID NOT EQUAL 'CID')
  2592        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2593               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2594      ELSE
  2595         IF (CP-COMPANY-ID = 'DCC')
  2596            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2597            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2598*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2599             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2600               CP-ORIGINAL-TERM
  2601             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2602             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2603        ELSE
  2604           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2605               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2606        END-IF
  2607     END-IF
  2608
  2609     IF CP-ROA-PREM-AT-REFUND
  2610         COMPUTE NET-BEN ROUNDED =
  2611             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2612     ELSE
  2613         COMPUTE NET-BEN ROUNDED =
  2614              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2615
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  50
* ELRATE.cbl
  2616     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2617        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2618          COMPUTE NET-BEN ROUNDED =
  2619              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2620                         (CP-TERM-OR-EXT-DAYS / 30)).
  2621
  2622     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2623*       OR 'DCC'
  2624*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2625     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2626       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2627       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2628                        * CP-ORIGINAL-TERM / 1200))
  2629     ELSE
  2630     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2631       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2632       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2633
  2634****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2635****** INTEREST IS CHARGED ON PREMIUM.
  2636
  2637*    IF CP-STATE-STD-ABBRV = 'MI'
  2638*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2639*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2640
  2641     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2642
  2643     GO TO 9999-CALC-RATE-PREM-X.
  2644
  2645******
  2646****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2647******
  2648
  2649 1250-CSL-CALC.
  2650     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2651     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2652     MOVE '1' TO DC-OPTION-CODE.
  2653     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2654
  2655     IF DATE-CONVERSION-ERROR
  2656         MOVE '2' TO CP-RETURN-CODE
  2657         GO TO 9999-CALC-RATE-PREM-X.
  2658
  2659     IF CP-JOINT-INDICATOR = 'J'
  2660         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2661     ELSE
  2662         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2663
  2664     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2665     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2666
  2667     IF CP-PAY-FREQUENCY = 12
  2668         MOVE 01               TO WS-PAY-SCH.
  2669     IF CP-PAY-FREQUENCY = 04
  2670         MOVE 03               TO WS-PAY-SCH.
  2671     IF CP-PAY-FREQUENCY = 02
  2672         MOVE 06               TO WS-PAY-SCH.
  2673     IF CP-PAY-FREQUENCY = 01
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  51
* ELRATE.cbl
  2674         MOVE 12               TO WS-PAY-SCH.
  2675
  2676     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2677     IF CP-PAY-FREQUENCY NOT = 12
  2678         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2679                                WS-NUM-PAYMTS.
  2680
  2681     IF CP-STATE = 'SC'  AND
  2682       (CP-BENEFIT-CD = '07'  OR  '08')
  2683         GO TO 1250-CSL-CALC-LIFE-6.
  2684
  2685     IF CP-CSL-METH-1
  2686         GO TO 1250-CSL-CALC-LIFE-1.
  2687
  2688     IF CP-CSL-METH-2
  2689         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2690                          WS-MAX-TOT-BEN
  2691             GO TO 1250-CSL-CALC-LIFE-2
  2692         ELSE
  2693             GO TO 1250-CSL-CALC-LIFE-1.
  2694
  2695     IF CP-CSL-METH-3
  2696         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2697             GO TO 1250-CSL-CALC-LIFE-2
  2698         ELSE
  2699             GO TO 1250-CSL-CALC-LIFE-3.
  2700
  2701     IF CP-CSL-METH-4
  2702         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2703                          WS-MAX-TOT-BEN
  2704             GO TO 1250-CSL-CALC-LIFE-5
  2705         ELSE
  2706             GO TO 1250-CSL-CALC-LIFE-4.
  2707
  2708 1250-CSL-CALC-LIFE-1.
  2709     IF CP-JOINT-INDICATOR = 'J'
  2710         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2711     ELSE
  2712         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2713
  2714     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2715                    365) - 1) * 365 / 12.
  2716     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2717                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2718                    4380.
  2719     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2720                    WS-NUM-PAYMTS * WK-S.
  2721
  2722     GO TO 9999-CALC-RATE-PREM-X.
  2723
  2724 1250-CSL-CALC-LIFE-2.
  2725     IF CP-JOINT-INDICATOR = 'J'
  2726         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2727     ELSE
  2728         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2729
  2730     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2731     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  52
* ELRATE.cbl
  2732     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2733                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2734                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2735     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2736                    WK-S) + WK-D.
  2737
  2738     GO TO 9999-CALC-RATE-PREM-X.
  2739
  2740 1250-CSL-CALC-LIFE-3.
  2741     IF CP-JOINT-INDICATOR = 'J'
  2742         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2743     ELSE
  2744         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2745
  2746     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2747     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2748     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2749                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2750                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2751     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2752                    WK-S) + WK-D.
  2753
  2754     GO TO 9999-CALC-RATE-PREM-X.
  2755
  2756 1250-CSL-CALC-LIFE-4.
  2757     IF CP-JOINT-INDICATOR = 'J'
  2758         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2759     ELSE
  2760         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2761
  2762     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2763     COMPUTE WK-S ROUNDED =
  2764                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2765                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2766                    CP-PAY-FREQUENCY.
  2767     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2768                    WS-NUM-PAYMTS * WK-S.
  2769
  2770     GO TO 9999-CALC-RATE-PREM-X.
  2771
  2772 1250-CSL-CALC-LIFE-5.
  2773     IF CP-JOINT-INDICATOR = 'J'
  2774         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2775     ELSE
  2776         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2777
  2778     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2779     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2780                    CP-PAY-FREQUENCY.
  2781     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2782                    - 1) + WS-NUM-PAYMTS) * 12) /
  2783                    CP-PAY-FREQUENCY.
  2784     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2785     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2786                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2787
  2788     GO TO 9999-CALC-RATE-PREM-X.
  2789
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  53
* ELRATE.cbl
  2790 1250-CSL-CALC-LIFE-6.
  2791
  2792     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2793                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2794
  2795     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2796                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2797
  2798     GO TO 9999-CALC-RATE-PREM-X.
  2799
  2800******
  2801****** END OF PREMIUM CALCULATIONS FOR CSL
  2802******
  2803
  2804 1260-GTL-PA-LEASE.
  2805
  2806     IF CP-REDUCING-LIFE
  2807         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2808                                 TO  CP-PREMIUM-RATE
  2809         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2810                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2811     ELSE
  2812         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2813                                 TO  CP-PREMIUM-RATE
  2814         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2815                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2816                 (+1 + CP-SALES-TAX) / +100.
  2817
  2818     GO TO 9999-CALC-RATE-PREM-X.
  2819
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  54
* ELRATE.cbl
  2821******************************************************************
  2822 2000-TYPE-IS-AH.
  2823     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2824
  2825     MOVE ZERO                      TO CP-R-MAX-AGE
  2826                                       CP-R-MAX-TERM
  2827                                       CP-R-MAX-MON-BEN
  2828                                       CP-R-MAX-TOT-BEN.
  2829
  2830     IF RT-POLICY-FEE NUMERIC
  2831        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  2832
  2833     IF RT-COMPOSITE-RATE NOT NUMERIC
  2834        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2835
  2836     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2837        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2838                                 TO CP-PREMIUM-RATE
  2839                                    WS-PREMIUM-RATE
  2840        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2841     ELSE
  2842         MOVE +0                 TO CP-PREMIUM-RATE
  2843                                    CP-CALC-PREMIUM
  2844         GO TO 9999-CALC-RATE-PREM-X
  2845     END-IF
  2846
  2847     IF (CP-COMPANY-ID = 'DCC')
  2848        AND (CP-DDF-SPEC-CALC = 'T')
  2849        AND (CP-LOAN-TERM > ZERO AND < 361)
  2850        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2851                                 TO CP-PREMIUM-RATE
  2852                                    WS-PREMIUM-RATE
  2853     END-IF
  2854*    IF (CP-COMPANY-ID = 'DCC')
  2855*       AND ((CP-BENEFIT-CD (1:1) = 'P')
  2856*       OR (CP-DDF-SPEC-CALC = 'T'))
  2857*       AND (CP-LOAN-TERM > ZERO AND < 361)
  2858*       MOVE RT-AH-RATE (CP-LOAN-TERM)
  2859*                                TO CP-PREMIUM-RATE
  2860*                                   WS-PREMIUM-RATE
  2861*    END-IF
  2862     MOVE +1 TO AHNDX.
  2863
  2864     IF CP-COMPANY-ID EQUAL 'CRI'
  2865        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2866           MOVE +5               TO AHNDX
  2867           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2868              MOVE 'F'           TO CP-RETURN-CODE
  2869              GO TO 2200-CALCULATE-PREMIUMS.
  2870
  2871     IF RT-AH-AGE (AHNDX) = ZERO
  2872          GO TO 2200-CALCULATE-PREMIUMS.
  2873
  2874 2100-SEARCH-AH-LIMITS.
  2875
  2876     IF CP-COMPANY-ID EQUAL 'CRI'
  2877        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2878           IF AHNDX GREATER THAN +4
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  55
* ELRATE.cbl
  2879              MOVE 'A'             TO CP-RETURN-CODE
  2880              GO TO 2200-CALCULATE-PREMIUMS.
  2881
  2882     IF AHNDX GREATER +8
  2883         MOVE 'A'                TO CP-RETURN-CODE
  2884         GO TO 2200-CALCULATE-PREMIUMS.
  2885
  2886     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2887         IF RT-AH-AGE (AHNDX) = ZEROS
  2888             ADD +1               TO AHNDX
  2889             GO TO 2100-SEARCH-AH-LIMITS
  2890         ELSE
  2891             MOVE RT-AH-AGE (AHNDX)
  2892                                 TO CP-R-MAX-AGE
  2893             MOVE RT-AH-TERM (AHNDX)
  2894                                 TO CP-R-MAX-TERM
  2895             MOVE RT-AH-BEN-M (AHNDX)
  2896                                 TO CP-R-MAX-MON-BEN
  2897             ADD +1               TO AHNDX
  2898             GO TO 2100-SEARCH-AH-LIMITS
  2899     ELSE
  2900         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2901         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2902         MOVE RT-AH-BEN-M (AHNDX)
  2903                                 TO CP-R-MAX-MON-BEN.
  2904
  2905     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2906         MOVE '9'                 TO CP-RETURN-CODE.
  2907
  2908     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2909         MOVE '8'                 TO CP-RETURN-CODE.
  2910
  2911     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2912         GIVING WS-AH-FACE-BENEFIT.
  2913
  2914     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2915         MOVE 'C'                 TO CP-RETURN-CODE.
  2916
  2917 2200-CALCULATE-PREMIUMS.
  2918
  2919     IF CP-COMPANY-ID = 'CSL'
  2920         GO TO 2250-CSL-CALC.
  2921
  2922*    IF CP-CRITICAL-PERIOD
  2923*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  2924
  2925     IF CP-CRITICAL-PERIOD
  2926        IF (CP-COMPANY-ID = 'DCC')
  2927           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  2928               OR 'S' OR 'P')
  2929                          OR
  2930                (CP-BEN-CATEGORY = 'G' OR 'L'))
  2931           CONTINUE
  2932        ELSE
  2933           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  2934        END-IF
  2935     END-IF
  2936
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  56
* ELRATE.cbl
  2937     IF (CP-COMPANY-ID = 'DCC')
  2938        AND (CP-BEN-CATEGORY = 'D')
  2939        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  2940           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  2941     END-IF
  2942     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2943        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  2944        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  2945                                     CP-PREMIUM-RATE
  2946        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2947        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  2948        CP-PREMIUM-RATE) / +100
  2949     ELSE
  2950        IF (CP-COMPANY-ID = 'DCC')
  2951           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  2952           MOVE CP-PREMIUM-RATE  TO WK-S
  2953*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  2954           IF CP-RATE-DEV-PCT NOT = ZEROS
  2955              COMPUTE WK-S ROUNDED =
  2956                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  2957           END-IF
  2958           IF CP-BENEFIT-CD (1:1) = 'M'
  2959              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2960              CP-ORIGINAL-BENEFIT * WK-S / 100
  2961           ELSE
  2962              IF CP-BENEFIT-CD (1:1) = 'H'
  2963                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2964                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2965                    WK-S) / 1000
  2966              ELSE
  2967                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  2968                    GO TO 2300-CALC-DCC-MOB-NET-AH
  2969                 ELSE
  2970                    IF CP-BEN-CATEGORY = 'D'
  2971                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2972                        CP-ORIGINAL-BENEFIT *
  2973                        CP-ORIGINAL-TERM * WK-S / 100
  2974                    ELSE
  2975                      IF CP-BENEFIT-CD (1:1) = 'P'
  2976                         GO TO 2300-CALC-DCC-BEN-P-AH
  2977                      ELSE
  2978                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2979                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2980                        WK-S) / 100
  2981                      END-IF
  2982                    END-IF
  2983                 END-IF
  2984              END-IF
  2985           END-IF
  2986           MOVE ZEROS            TO CP-RATE-DEV-PCT
  2987        ELSE
  2988           IF CP-BENEFIT-CD (1:1) = 'M'
  2989              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2990                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  2991           ELSE
  2992              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  2993                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2994                    (CP-NET-BENEFIT-AMT *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  57
* ELRATE.cbl
  2995                    CP-PREMIUM-RATE) / 1000
  2996              ELSE
  2997                 IF CP-AH-BALLOON-SW = 'Y'
  2998                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  2999                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  3000                      CP-PREMIUM-RATE) / 100
  3001                 ELSE
  3002                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  3003                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  3004                    CP-PREMIUM-RATE) / 100
  3005                 END-IF
  3006              END-IF
  3007           END-IF
  3008        END-IF
  3009     END-IF
  3010
  3011     IF (CP-COMPANY-ID = 'DCC')
  3012        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  3013        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  3014     END-IF
  3015     IF CP-TERM-OR-EXT-DAYS = ZEROS
  3016         GO TO 9999-CALC-RATE-PREM-X.
  3017
  3018     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  3019         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3020             CP-CALC-PREMIUM +
  3021                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  3022                                       * CP-TERM-OR-EXT-DAYS).
  3023
  3024     GO TO 9999-CALC-RATE-PREM-X.
  3025
  3026 2200-CRITICAL-PERIOD-AH-CONT.
  3027
  3028     IF CP-COMPANY-ID = 'WDS'
  3029         IF CP-ORIGINAL-TERM GREATER THAN 60
  3030             MOVE 60              TO CP-LOAN-TERM.
  3031
  3032     IF CP-COMPANY-ID EQUAL 'CVL'
  3033         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3034           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3035                                       * CP-PREMIUM-RATE
  3036         GO TO 9999-CALC-RATE-PREM-X.
  3037
  3038     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3039           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3040                                       * CP-PREMIUM-RATE.
  3041
  3042     GO TO 9999-CALC-RATE-PREM-X.
  3043
  3044 2250-CSL-CALC.
  3045
  3046     IF RT-DAILY-RATE NOT NUMERIC OR
  3047        RT-DAILY-RATE = ZEROS
  3048            MOVE ZEROS TO CP-CALC-PREMIUM
  3049            MOVE '7' TO CP-RETURN-CODE
  3050            GO TO 9999-CALC-RATE-PREM-X.
  3051
  3052     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  58
* ELRATE.cbl
  3053     COMPUTE WK-MONTHLY-RATE =
  3054          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3055
  3056     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3057     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3058     MOVE '1' TO DC-OPTION-CODE.
  3059     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3060     IF DATE-CONVERSION-ERROR
  3061         MOVE '2' TO CP-RETURN-CODE
  3062         GO TO 9999-CALC-RATE-PREM-X.
  3063
  3064     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3065     IF CP-CSL-METH-1
  3066         GO TO 2250-CSL-CALC-AH-1.
  3067     IF CP-CSL-METH-2
  3068         GO TO 2250-CSL-CALC-AH-2.
  3069     IF CP-CSL-METH-3
  3070         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3071             GO TO 2250-CSL-CALC-AH-4
  3072         ELSE
  3073             GO TO 2250-CSL-CALC-AH-3.
  3074
  3075 2250-CSL-CALC-AH-1.
  3076
  3077     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3078     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3079                    + WK-MONTHLY-RATE.
  3080     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3081                    CP-ORIGINAL-TERM * WK-D.
  3082
  3083     GO TO 9999-CALC-RATE-PREM-X.
  3084
  3085
  3086 2250-CSL-CALC-AH-2.
  3087     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3088     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3089                    + WK-MONTHLY-RATE.
  3090     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3091                    CP-ORIGINAL-TERM * WK-D.
  3092
  3093     GO TO 9999-CALC-RATE-PREM-X.
  3094
  3095 2250-CSL-CALC-AH-3.
  3096
  3097     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3098     COMPUTE WK-T = WK-K + 1.
  3099     COMPUTE WK-MONTHLY-RATE-T =
  3100          RT-AH-RATE (WK-T) / 100.
  3101     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3102
  3103     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3104     IF WK-T1 EQUAL ZEROS
  3105         MOVE ZEROS TO CP-CALC-PREMIUM
  3106         MOVE 'G' TO CP-RETURN-CODE
  3107         GO TO 9999-CALC-RATE-PREM-X.
  3108
  3109     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3110                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  59
* ELRATE.cbl
  3111                    - WK-T)).
  3112     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3113     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3114                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3115                       WS-MAX-TOT-BEN).
  3116     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3117                    WK-MONTHLY-RATE-T) + WK-PREM.
  3118
  3119     GO TO 9999-CALC-RATE-PREM-X.
  3120
  3121 2250-CSL-CALC-AH-4.
  3122     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3123     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3124     COMPUTE WK-MONTHLY-RATE-J =
  3125          RT-AH-RATE (WK-J) / 100.
  3126     COMPUTE WK-T = WK-J + 1.
  3127     COMPUTE WK-MONTHLY-RATE-T =
  3128          RT-AH-RATE (WK-T) / 100.
  3129     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3130     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3131                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3132                    (CP-ORIGINAL-TERM - WK-T)).
  3133     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3134     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3135                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3136                       WS-MAX-TOT-BEN).
  3137     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3138                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3139
  3140     GO TO 9999-CALC-RATE-PREM-X.
  3141
  3142 2300-CALC-DCC-BEN-P-AH.
  3143     IF CP-NO-OF-PMTS NOT NUMERIC
  3144        MOVE +0                  TO CP-NO-OF-PMTS
  3145     END-IF
  3146     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3147        AND ' ' AND 'M'
  3148        MOVE ' '                 TO CP-PMT-MODE
  3149     END-IF
  3150******************************************************************
  3151***   Default is monthly, use loan term for rate and amort     ***
  3152******************************************************************
  3153     move cp-loan-term         to c-tot-pmts
  3154     MOVE +30                  TO C-DAYS-IN-PMT-PER
  3155     MOVE +12                  TO C-PMTS-PER-YEAR
  3156******************************************************************
  3157
  3158     evaluate true
  3159        when cp-pmt-mode = 'W'
  3160           MOVE +52              TO C-PMTS-PER-YEAR
  3161           compute c-tot-pmts = cp-loan-term /
  3162              12 * c-pmts-per-year
  3163           MOVE +7               TO C-DAYS-IN-PMT-PER
  3164        when cp-pmt-mode = 'B'
  3165           MOVE +26              TO C-PMTS-PER-YEAR
  3166           compute c-tot-pmts = cp-loan-term /
  3167              12 * c-pmts-per-year
  3168           MOVE +14              TO C-DAYS-IN-PMT-PER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  60
* ELRATE.cbl
  3169     end-evaluate
  3170     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3171     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3172        C-DAYS-IN-PMT-PER)) / (1 + I)
  3173     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3174     COMPUTE ANGLEN-1 = ANGLEN / Y
  3175     COMPUTE WK3 = (CP-NET-BENEFIT-AMT - CP-ORIGINAL-PREMIUM)
  3176        / ANGLEN-1
  3177     if cp-net-benefit-amt = zeros
  3178        compute wk3 = cp-original-benefit - cp-original-premium
  3179     end-if
  3180     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3181     GO TO 9999-CALC-RATE-PREM-X
  3182     .
  3183 2300-CALC-DCC-MOB-NET-AH.
  3184     IF CP-ALTERNATE-BENEFIT = ZEROS
  3185        CONTINUE
  3186     ELSE
  3187        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3188     END-IF
  3189     MOVE CP-ORIGINAL-TERM       TO M
  3190     MOVE CP-LOAN-TERM           TO N
  3191     IF N = ZEROS
  3192        MOVE M                   TO N
  3193     END-IF
  3194     COMPUTE I = CP-LOAN-APR / +1200
  3195     IF CP-BENEFIT-CD (1:1) = 'S'
  3196        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3197        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3198        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3199          (WK-S / 1000)
  3200          * 1
  3201        MOVE WK3                 TO CP-CALC-PREMIUM
  3202        GO TO 9999-CALC-RATE-PREM-X
  3203     END-IF
  3204     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3205        / (1 + I)
  3206     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3207          ** ((N - M) * -1))) / I)
  3208     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3209     COMPUTE J = I + (WK-S / +1000)
  3210     COMPUTE WK2 = (1 + J) ** (M * -1)
  3211     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3212     COMPUTE ANGLEM = ((1 - ((1 + J)
  3213          ** (M * -1))) / J) / OD
  3214     IF CP-NET-BENEFIT-AMT = ZEROS
  3215        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3216           * ANGLEM
  3217     END-IF
  3218     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3219     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3220          ** ((N - M) * -1))) / I)
  3221     MOVE +0                     TO WK3
  3222     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3223        (WS-COUNTER > M)
  3224        COMPUTE ANGLEM = (1 - ((1 + J)
  3225          ** ((M - WS-COUNTER + 1) * -1))) / J
  3226        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  61
* ELRATE.cbl
  3227        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3228        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3229     END-PERFORM
  3230     MOVE WK3                    TO CP-CALC-PREMIUM
  3231     GO TO 9999-CALC-RATE-PREM-X
  3232     .
  3233 2300-CALC-DCC-MOB-BAL-AH.
  3234     IF CP-BENEFIT-CD (1:1) = 'S'
  3235        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3236     END-IF
  3237     MOVE CP-ORIGINAL-TERM       TO M
  3238     MOVE CP-LOAN-TERM           TO N
  3239     IF N = ZEROS
  3240        MOVE M                   TO N
  3241     END-IF
  3242     COMPUTE I = CP-LOAN-APR / +1200
  3243     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3244        / (1 + I)
  3245     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3246     COMPUTE J = I + (WK-S / +1000)
  3247     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3248     MOVE I TO K
  3249     COMPUTE WK2 = (1 + J) ** (M * -1)
  3250     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3251     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3252          ** ((M - 1) * -1))) / J)
  3253     COMPUTE ANGLEM = ((1 - ((1 + J)
  3254          ** (M * -1))) / J) / OD
  3255     IF CP-NET-BENEFIT-AMT = ZEROS
  3256        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3257           * ANGLEM
  3258     END-IF
  3259     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3260        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3261        / ANGLEM-1
  3262     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3263          ** ((N - M) * -1))) / I)
  3264     MOVE +0                     TO WK3
  3265     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3266        (WS-COUNTER > M)
  3267        COMPUTE ANGLEM = (1 - ((1 + J)
  3268          ** ((M - WS-COUNTER) * -1))) / J
  3269        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3270        COMPUTE WK5-CSL = (RA * ANGLEM)
  3271        + (CP-ALTERNATE-BENEFIT * WK2)
  3272        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3273          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3274          (WK-S / 1000)
  3275     END-PERFORM
  3276     MOVE WK3                    TO CP-CALC-PREMIUM
  3277     GO TO 9999-CALC-RATE-PREM-X
  3278     .
  3279 2300-CALC-DCC-MOB-BAL-AHSUM.
  3280     MOVE CP-ORIGINAL-TERM       TO M
  3281     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3282        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3283        * WK-S / 1000
  3284*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  62
* ELRATE.cbl
  3285*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3286*       * WK-S / 1000
  3287     MOVE WK3                    TO CP-CALC-PREMIUM
  3288     GO TO 9999-CALC-RATE-PREM-X
  3289     .
  3290 9999-RATE-NOTFND.
  3291     MOVE '6'                    TO CP-RETURN-CODE.
  3292     GO TO 9999-CALC-RATE-PREM-X.
  3293
  3294 9999-RATE-NOTOPEN.
  3295     MOVE 'D'                    TO CP-RETURN-CODE.
  3296     GO TO 9999-CALC-RATE-PREM-X.
  3297
  3298 9999-CALC-RATE-PREM-X.
  3299     IF (CP-COMPANY-ID = 'DCC')
  3300        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3301        CONTINUE
  3302     ELSE
  3303        IF CP-RATE-DEV-PCT NOT = ZERO
  3304           COMPUTE CP-CALC-PREMIUM =
  3305              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3306
  3307
  3308     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3309
  3310     IF WS-BROWSE-STARTED
  3311
  3312* EXEC CICS ENDBR
  3313*            DATASET  (ERRATE-FILE-ID)
  3314*       END-EXEC.
  3315     MOVE 0
  3316       TO DFHEIV11
  3317*    MOVE '&2                    $   #00003264' TO DFHEIV0
  3318     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3319     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3320     MOVE X'2020233030303033323634' TO DFHEIV0(25:11)
  3321     CALL 'kxdfhei1' USING DFHEIV0,
  3322           ERRATE-FILE-ID,
  3323           DFHEIV11,
  3324           DFHEIV99
  3325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3326
  3327
  3328
  3329* EXEC CICS RETURN
  3330*    END-EXEC.
  3331*    MOVE '.(                    ''   #00003268' TO DFHEIV0
  3332     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3333     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3334     MOVE X'2020233030303033323638' TO DFHEIV0(25:11)
  3335     CALL 'kxdfhei1' USING DFHEIV0,
  3336           DFHEIV99,
  3337           DFHEIV99,
  3338           DFHEIV99,
  3339           DFHEIV99,
  3340           DFHEIV99,
  3341           DFHEIV99
  3342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  63
* ELRATE.cbl
  3343
  3344
  3345 9100-CONVERT-DATE.
  3346
  3347* EXEC CICS LINK
  3348*        PROGRAM  ('ELDATCV')
  3349*        COMMAREA (DATE-CONVERSION-DATA)
  3350*        LENGTH   (DC-COMM-LENGTH)
  3351*    END-EXEC.
  3352     MOVE 'ELDATCV' TO DFHEIV1
  3353*    MOVE '."C                   (   #00003272' TO DFHEIV0
  3354     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3355     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3356     MOVE X'2020233030303033323732' TO DFHEIV0(25:11)
  3357     CALL 'kxdfhei1' USING DFHEIV0,
  3358           DFHEIV1,
  3359           DATE-CONVERSION-DATA,
  3360           DC-COMM-LENGTH,
  3361           DFHEIV99,
  3362           DFHEIV99,
  3363           DFHEIV99,
  3364           DFHEIV99
  3365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3366
  3367
  3368 9100-EXIT.
  3369     EXIT.
  3370
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  64
* ELRATE.cbl
  3372 10000-NET-TERM SECTION.
  3373*                         COPY ERCNETP.
  3374*****************************************************************
  3375*                                                               *
  3376*                            ERCNETP                            *
  3377*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3378*                            VMOD=2.029                         *
  3379*                                                               *
  3380*****************************************************************.
  3381*
  3382*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3383*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3384*                                   ORIGINAL TERM (S999)
  3385*                                   REMAINING TERM (S999)
  3386*                                   NET PAY OPTION (X)
  3387*                                   LOAN TERM (S999)
  3388*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3389*
  3390*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3391*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3392*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3393*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3394*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3395*    CHARGED.
  3396*
  3397*    OPTIONS - S = NET SIMPLE
  3398*          SPACE = NET PAY  (1 MO. INTEREST)
  3399*              A = NET PAY  (0 MO. INTEREST)
  3400*              I = NET PAY  (2 MO. INTEREST)
  3401*              J = NET PAY  (3 MO. INTEREST)
  3402*              K = NET PAY  (4 MO. INTEREST)
  3403*              T = TRUNCATED  (0 MO. INTEREST)
  3404*              U = TRUNCATED  (1 MO. INTEREST)
  3405*              V = TRUNCATED  (2 MO. INTEREST)
  3406*              W = TRUNCATED  (3 MO. INTEREST)
  3407*              X = TRUNCATED  (4 MO. INTEREST)
  3408*              R = REFUNDS (REGULAR OR TRUNCATED)
  3409******************************************************************
  3410*                   C H A N G E   L O G
  3411*
  3412* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3413*-----------------------------------------------------------------
  3414*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3415* EFFECTIVE    NUMBER
  3416*-----------------------------------------------------------------
  3417* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3418* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3419* 120403                   PEMA  ADD SPECIAL TX CALC
  3420* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3421* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3422* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3423* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3424* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3425* 021207                   PEMA  ADD PA NP
  3426* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3427* 032807                   PEMA  ADD VT NP PLUS 2
  3428* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3429* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  65
* ELRATE.cbl
  3430* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3431* 110207      TO 'AL' NET PAY CALC
  3432* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3433* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3434* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3435* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3436* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3437* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3438* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3439* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3440* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3441* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3442* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3443* 032612  CR2011110200001  PEMA  AHL CHANGES
  3444* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3445* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  3446******************************************************************
  3447
  3448     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3449     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3450     MOVE N-P-LOAN    TO LOAN-TERM.
  3451     MOVE N-P-REM     TO REMAINING-TERM.
  3452     MOVE N-P-OPT     TO OPTION-SW.
  3453
  3454     MOVE +0 TO FACTOR.
  3455
  3456     IF ANNUAL-INT-RATE = ZERO
  3457         GO TO 99000-ERROR.
  3458     IF ORIGINAL-TERM = ZERO
  3459         GO TO 99999-RETURN.
  3460     IF REMAINING-TERM = ZERO
  3461         GO TO 99999-RETURN.
  3462     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3463         GO TO 99000-ERROR.
  3464     IF LOAN-TERM = ZERO
  3465         GO TO 99999-RETURN.
  3466     IF LOAN-TERM LESS ORIGINAL-TERM
  3467         GO TO 99000-ERROR.
  3468
  3469*    IF ANNUAL-INT-RATE LESS +2
  3470*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3471*    IF ANNUAL-INT-RATE LESS +2
  3472*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3473*    IF ANNUAL-INT-RATE LESS +2
  3474*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3475
  3476     IF NPO-REFUND
  3477         MOVE '2' TO NP-PROCESS-SW
  3478       ELSE
  3479         IF ORIGINAL-TERM = REMAINING-TERM
  3480            MOVE '1'   TO NP-PROCESS-SW
  3481           ELSE
  3482            MOVE '3'   TO NP-PROCESS-SW.
  3483
  3484     IF NPO-SIMPLE
  3485         MOVE 'S' TO TYPE-SW
  3486     ELSE
  3487         MOVE 'N' TO TYPE-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  66
* ELRATE.cbl
  3488
  3489     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3490
  3491     COMPUTE V ROUNDED = K1 / (K1 + I).
  3492
  3493     MOVE V     TO VX
  3494                   SV.
  3495
  3496     MOVE +1    TO X1
  3497                   SX.
  3498
  3499     MOVE LOAN-TERM TO MAX-X.
  3500
  3501     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3502
  3503     IF MAX-X = +1
  3504        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3505
  3506     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3507
  3508     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3509         OR 'DCC'        OR 'NCL') AND
  3510        (NOT NP-REFUND)
  3511        NEXT SENTENCE
  3512     ELSE
  3513     IF LOAN-TERM NOT = ORIGINAL-TERM
  3514        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3515
  3516     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3517
  3518 10500-VX-LOOP.
  3519
  3520***  VX = AMORT. LOAN TERM.
  3521***  SV = AMORT. INSURANCE TERM.
  3522***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3523***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3524***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3525
  3526     IF X2 = 1
  3527        MOVE V         TO SX
  3528     END-IF
  3529     COMPUTE VX ROUNDED = VX * V.
  3530
  3531     ADD B1 TO X1.
  3532
  3533     IF X1 = REMAINING-TERM
  3534          MOVE VX    TO SV.
  3535
  3536     IF X1 EQUAL SV-MINUS-ONE
  3537        MOVE VX      TO SV-MINUS-ONE.
  3538
  3539     IF X1 = X2
  3540          MOVE VX    TO SX.
  3541
  3542     IF X1 NOT = MAX-X
  3543          GO TO 10500-VX-LOOP.
  3544
  3545 10700-COMPUTE-REMAINING-FACTOR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  67
* ELRATE.cbl
  3546*****  WK1 = LOAN TERM AMORT
  3547     COMPUTE WK1 = K1 - VX.
  3548*****  WK2 = INS TERM AMORT
  3549     COMPUTE WK2 = K1 - SV.
  3550*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3551     COMPUTE WK5 = K1 - SX.
  3552*****  WK6 = INS TERM - 1
  3553     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3554
  3555     IF NP-RATING
  3556         GO TO 12000-PREMIUM-RATE.
  3557
  3558     IF NP-REFUND
  3559         GO TO 11000-REFUND-CALC.
  3560
  3561     IF NET-STD
  3562         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3563
  3564     IF NET-SMP
  3565         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3566         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3567         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3568         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3569
  3570     IF REMAINING-TERM LESS THAN X2
  3571         MOVE +0 TO WK3.
  3572
  3573     MOVE WK3 TO FACTOR.
  3574
  3575     GO TO 99999-RETURN.
  3576
  3577 11000-REFUND-CALC.
  3578     IF REMAINING-TERM NOT LESS MAX-X
  3579        MOVE +1 TO FACTOR
  3580        GO TO 99999-RETURN.
  3581
  3582     IF REMAINING-TERM LESS +1
  3583        MOVE 0 TO FACTOR
  3584        GO TO 99999-RETURN.
  3585
  3586     COMPUTE WK2 ROUNDED = WK2 / I.
  3587     COMPUTE WK5 ROUNDED = WK5 / I.
  3588     COMPUTE WK1 ROUNDED = WK1 / I.
  3589
  3590     IF (CP-COMPANY-ID EQUAL 'CID')
  3591        AND (CP-STATE-STD-ABBRV = 'MN')
  3592        AND (CP-CERT-EFF-DT > X'A4FF')
  3593        AND (CP-RATE-AS-REG-BALLOON)
  3594        AND (CP-EARN-AS-NET-PAY)
  3595        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3596        CONTINUE
  3597     ELSE
  3598        GO TO 11000-CHECK-MN-LEV-BALLOON
  3599     END-IF
  3600
  3601     COMPUTE R = M - E
  3602     COMPUTE FACTOR = (R - WK2 + WK5) /
  3603        (M - WK1 + WK5)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  68
* ELRATE.cbl
  3604
  3605     GO TO 99999-RETURN
  3606
  3607      .
  3608 11000-CHECK-MN-LEV-BALLOON.
  3609
  3610     IF (CP-COMPANY-ID EQUAL 'CID')
  3611        AND (CP-STATE-STD-ABBRV = 'MN')
  3612        AND (CP-CERT-EFF-DT > X'A4FF')
  3613        AND (CP-RATE-AS-REG-BALLOON)
  3614        AND (CP-EARN-AS-NET-PAY)
  3615        AND (CP-DEVIATION-CODE = 'LEV')
  3616        CONTINUE
  3617     ELSE
  3618        GO TO 11000-CONTINUE-REFUND
  3619     END-IF
  3620
  3621     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3622     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3623        ** (M - E)) / I
  3624
  3625     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3626
  3627     GO TO 99999-RETURN
  3628
  3629     .
  3630 11000-CONTINUE-REFUND.
  3631*    IF CP-GAP-ACTUARIAL
  3632*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3633*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3634*       COMPUTE WK3 = WK2 / ANGLEN
  3635*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3636     IF CP-GAP-ACTUARIAL
  3637        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3638           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3639        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3640     ELSE
  3641        COMPUTE WK3 ROUNDED =
  3642          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3643     END-IF
  3644
  3645     MOVE WK3  TO FACTOR.
  3646
  3647     GO TO 99999-RETURN.
  3648
  3649 12000-PREMIUM-RATE.
  3650*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3651*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3652*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3653*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3654*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3655*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3656
  3657     COMPUTE K-I = K1 + I.
  3658     MOVE K-I TO ONE-PLUS-I.
  3659
  3660     IF NPO-ALT OR NPO-TRUNC-0
  3661         MOVE K1 TO K-I.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  69
* ELRATE.cbl
  3662
  3663     IF NPO-2MO OR NPO-TRUNC-2
  3664         COMPUTE K-I = K1 + (2 * I).
  3665
  3666     IF NPO-3MO OR NPO-TRUNC-3
  3667         COMPUTE K-I = K1 + (3 * I).
  3668
  3669     IF NPO-4MO OR NPO-TRUNC-4
  3670         COMPUTE K-I = K1 + (4 * I).
  3671
  3672     COMPUTE RA ROUNDED = 1 -
  3673             ((X2 * (X2 + 1)) /
  3674              (N *  (N  + 1))).
  3675
  3676     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3677        (CP-CSL-VALID-NP-BENEFIT-CD)
  3678        NEXT SENTENCE
  3679     ELSE
  3680        GO TO XXXX-CHECK-DISCOUNT-5.
  3681
  3682     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3683     MOVE ' ' TO DC-OPTION-CODE.
  3684     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3685
  3686     IF DATE-CONVERSION-ERROR
  3687        MOVE '2'                 TO CP-RETURN-CODE
  3688        MOVE ZEROS               TO FACTOR
  3689                                    CP-CALC-PREMIUM
  3690         GO TO 99999-RETURN.
  3691
  3692     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3693     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3694     MOVE ' ' TO DC-OPTION-CODE
  3695     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3696
  3697     IF DATE-CONVERSION-ERROR
  3698        MOVE '2'                 TO CP-RETURN-CODE
  3699        MOVE ZEROS               TO FACTOR
  3700                                    CP-CALC-PREMIUM
  3701         GO TO 99999-RETURN.
  3702
  3703     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  3704
  3705     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  3706
  3707     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3708        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3709        CP-PAY-FREQUENCY / 365) * I
  3710     ELSE
  3711        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3712        CP-PAY-FREQUENCY / 365) * I.
  3713
  3714     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3715     13).
  3716
  3717     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3718     (N - ( ANGLEN-1 / WK3)).
  3719
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  70
* ELRATE.cbl
  3720     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3721
  3722     COMPUTE WS-CALC-FREQ-RATE EQUAL
  3723       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3724
  3725     COMPUTE WS-Y-X-FACTOR EQUAL
  3726       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3727       WS-CALC-FREQ-RATE).
  3728
  3729     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3730       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3731
  3732     COMPUTE WS-X-Y-FACTOR EQUAL
  3733       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3734
  3735     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3736       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3737       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3738
  3739     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3740
  3741     GO TO 99999-RETURN.
  3742
  3743 XXXX-CHECK-DISCOUNT-5.
  3744
  3745     IF WS-DISCOUNT-OPTION EQUAL '5'
  3746        NEXT SENTENCE
  3747     ELSE
  3748        GO TO 12000-CHECK-CLIENT.
  3749
  3750      COMPUTE ANGLEN EQUAL WK1 / I.
  3751
  3752      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3753
  3754      COMPUTE WK3 EQUAL
  3755        (12 *
  3756        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3757        CP-ORIGINAL-BENEFIT)) /
  3758        APR100.
  3759
  3760     COMPUTE WK3 EQUAL
  3761        (WK3 * CP-PREMIUM-RATE) / +1000.
  3762
  3763     COMPUTE WK3 EQUAL
  3764        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3765
  3766      MOVE WK3 TO CP-CALC-PREMIUM.
  3767
  3768     GO TO 99999-RETURN.
  3769
  3770 12000-CHECK-CLIENT.
  3771
  3772     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3773        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3774        (CP-TRUNCATED-LIFE)
  3775        NEXT SENTENCE
  3776     ELSE
  3777        GO TO 12000-CHECK-NEXT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  71
* ELRATE.cbl
  3778
  3779     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3780
  3781     COMPUTE ANGLEN EQUAL WK1 / I.
  3782     COMPUTE ANGLEM EQUAL WK2 / I.
  3783
  3784     COMPUTE FM EQUAL
  3785                    (((ONE-PLUS-I ** M) * I * M) /
  3786                    ((ONE-PLUS-I ** M) - 1))
  3787                    - 1.
  3788
  3789     COMPUTE FN EQUAL
  3790                    (((ONE-PLUS-I ** N) * I * N) /
  3791                    ((ONE-PLUS-I ** N) - 1))
  3792                    - 1.
  3793
  3794     COMPUTE FNM EQUAL
  3795                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3796                    ((ONE-PLUS-I ** (N - M)) - 1))
  3797                    - 1.
  3798
  3799     COMPUTE GR EQUAL
  3800                    (WS-WORK-RATE * ANGLEM * I) /
  3801                    (M - ANGLEM).
  3802
  3803     COMPUTE ODF EQUAL
  3804                     (1 +
  3805                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3806                     360)) /
  3807                     ONE-PLUS-I.
  3808
  3809     COMPUTE OD EQUAL
  3810                    (1 + (ODF * (FN / I - 1))) +
  3811                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3812
  3813     COMPUTE WK3 EQUAL
  3814*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3815                    ((1 + FN) * ODF *
  3816                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3817                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3818                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3819
  3820     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3821     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  3822
  3823     COMPUTE WK3 EQUAL
  3824                    (WK3 / (ODF * (1 + FN))) -
  3825*                   CP-ORIGINAL-BENEFIT.
  3826                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  3827
  3828      MOVE WK3 TO CP-CALC-PREMIUM.
  3829
  3830     GO TO 99999-RETURN.
  3831
  3832 12000-CHECK-NEXT.
  3833
  3834     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  3835        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  72
* ELRATE.cbl
  3836     ELSE
  3837        GO TO 12000-CHECK-PA-TRUNC.
  3838
  3839      IF WS-WORK-DIS-RATE EQUAL +0
  3840         MOVE '7'                TO CP-RETURN-CODE
  3841         MOVE ZEROS              TO FACTOR
  3842                                    CP-CALC-PREMIUM
  3843         GO TO 99999-RETURN.
  3844
  3845      COMPUTE ANGLEN EQUAL WK1 / I.
  3846
  3847      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3848
  3849      IF WS-WORK-DIS-RATE EQUAL APR100
  3850         ADD .00001 TO APR100.
  3851
  3852      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  3853      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  3854
  3855     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3856        / (1 + I)
  3857     COMPUTE ANGLEN-1 = ANGLEN / Y
  3858      IF CP-COMPANY-ID EQUAL 'CDL'
  3859         COMPUTE WK3 EQUAL
  3860
  3861          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  3862          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  3863
  3864          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3865
  3866          ((WK8 ** N) /
  3867          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3868
  3869          ((WK9 ** N) /
  3870          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  3871
  3872      ELSE
  3873         COMPUTE WK3 EQUAL
  3874
  3875          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3876          (12 + WS-WORK-DIS-RATE) * 12) *
  3877
  3878          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3879
  3880          ((WK8 ** N) /
  3881          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3882
  3883          ((WK9 ** N) /
  3884          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  3885
  3886      COMPUTE WK3 EQUAL
  3887          (WK3 * CP-PREMIUM-RATE) / +1000.
  3888
  3889      MOVE WK3 TO CP-CALC-PREMIUM.
  3890
  3891     GO TO 99999-RETURN.
  3892
  3893 12000-CHECK-PA-TRUNC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  73
* ELRATE.cbl
  3894
  3895     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3896        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  3897        (CP-EARN-AS-NET-PAY) AND
  3898        (CP-TRUNCATED-LIFE)
  3899        NEXT SENTENCE
  3900     ELSE
  3901        GO TO 12000-CHECK-MD-TRUNC.
  3902
  3903     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3904
  3905     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3906     COMPUTE ANGLEN EQUAL WK1 / I.
  3907
  3908     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3909
  3910     COMPUTE WK3 EQUAL
  3911        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  3912        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  3913
  3914     MOVE WK3 TO CP-CALC-PREMIUM.
  3915
  3916     GO TO 99999-RETURN.
  3917
  3918 12000-CHECK-MD-TRUNC.
  3919
  3920     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3921        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3922        (CP-EARN-AS-NET-PAY) AND
  3923        (CP-TRUNCATED-LIFE)
  3924        NEXT SENTENCE
  3925     ELSE
  3926        GO TO 12000-CHECK-MD.
  3927
  3928     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3929
  3930     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3931     COMPUTE ANGLEM EQUAL WK2 / I.
  3932     COMPUTE ANGLEN EQUAL WK1 / I.
  3933
  3934     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3935
  3936     COMPUTE WK3 EQUAL
  3937        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3938        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3939        (ANGLEN-1 * (M - ANGLEM))).
  3940
  3941     MOVE WK3 TO CP-CALC-PREMIUM.
  3942
  3943     GO TO 99999-RETURN.
  3944
  3945 12000-CHECK-MD.
  3946
  3947     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3948        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3949        (CP-EARN-AS-NET-PAY)
  3950        NEXT SENTENCE
  3951     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  74
* ELRATE.cbl
  3952        GO TO 12000-CHECK-ME-TRUNC.
  3953
  3954     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3955
  3956     COMPUTE WK3 EQUAL
  3957        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3958
  3959     MOVE WK3 TO CP-CALC-PREMIUM.
  3960
  3961     GO TO 99999-RETURN.
  3962
  3963 12000-CHECK-ME-TRUNC.
  3964
  3965     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3966        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3967        AND (CP-EARN-AS-NET-PAY)
  3968        AND (CP-TRUNCATED-LIFE)
  3969        CONTINUE
  3970     ELSE
  3971        GO TO 12000-CHECK-CID-WA-FARMPLAN
  3972     END-IF
  3973
  3974     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3975     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3976     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3977     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3978     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3979     COMPUTE ANGLEN-1 = ANGLEN / Y
  3980     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3981     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3982     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3983     COMPUTE WK3
  3984        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3985        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3986            * (1 / (1.0635 ** (M / 12))))
  3987*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3988*    COMPUTE WK9 EQUAL
  3989*       1 / (1 + (.045 * (N - M) / 24))
  3990*    COMPUTE WK7 EQUAL
  3991*       WS-WORK-RATE * 20 / (M + 1).
  3992*    COMPUTE WK3 EQUAL
  3993*       ((( N - ANGLEN) * WK7 * WK8) /
  3994*       (10 * ANGLEN-1 * I)) -
  3995*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3996*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3997*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3998*
  3999     MOVE WK3 TO CP-CALC-PREMIUM.
  4000
  4001     GO TO 99999-RETURN
  4002      .
  4003 12000-CHECK-CID-WA-FARMPLAN.
  4004
  4005     IF (CP-COMPANY-ID EQUAL 'CID')
  4006        AND (CP-STATE-STD-ABBRV = 'WA')
  4007        AND (CP-FARM-PLAN)
  4008        CONTINUE
  4009     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  75
* ELRATE.cbl
  4010        GO TO 12000-CHECK-CID-FARMPLAN
  4011     END-IF
  4012
  4013     move cp-original-term       to n
  4014     move cp-no-of-pmts          TO C-TOT-PMTS
  4015     compute c-pmts-per-year = 12 / cp-pay-frequency
  4016     move cp-pay-frequency       to m
  4017     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  4018     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4019     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4020
  4021     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4022        (m * 30))) / (1 + I)
  4023     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4024        ** CP-PAY-FREQUENCY) - 1
  4025     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  4026     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4027        ** TI) / WS-WORK-DIS-RATE
  4028     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  4029     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  4030     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4031        ** m) / WS-WORK-DIS-RATE
  4032     COMPUTE WK2 = WK2 * (1 + J)
  4033     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4034     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4035     COMPUTE WK3 = WK3 * (1 + J)
  4036     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  4037        ** (c-tot-pmts - 1))) / J
  4038     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4039        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4040        (CP-PREMIUM-RATE / 1000)
  4041     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4042     COMPUTE WK6 = (WK7 * GR)
  4043
  4044     MOVE WK6 TO CP-CALC-PREMIUM
  4045
  4046     GO TO 99999-RETURN
  4047
  4048     .
  4049 12000-CHECK-CID-FARMPLAN.
  4050     IF (CP-COMPANY-ID EQUAL 'CID')
  4051        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4052           OR 'IN' OR 'AZ')
  4053        AND (CP-FARM-PLAN)
  4054        CONTINUE
  4055     ELSE
  4056        GO TO 12000-CHECK-SC-CID
  4057     END-IF
  4058     COMPUTE N = M / CP-PAY-FREQUENCY
  4059     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4060     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4061        ** CP-PAY-FREQUENCY) - 1
  4062     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4063     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4064        ** TI) / WS-WORK-DIS-RATE
  4065     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4066     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4067     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  76
* ELRATE.cbl
  4068        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  4069     COMPUTE WK2 = WK2 * (1 + J)
  4070     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4071     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4072     COMPUTE WK3 = WK3 * (1 + J)
  4073     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4074        ** (N - 1))) / J
  4075     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4076        ((N * WK2) - WK5)) + (N * WK1)) *
  4077        (CP-PREMIUM-RATE / 1000)
  4078     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4079     COMPUTE WK6 = (WK7 * GR)
  4080     MOVE WK6 TO CP-CALC-PREMIUM
  4081     GO TO 99999-RETURN
  4082     .
  4083 12000-CHECK-SC-CID.
  4084     IF (CP-COMPANY-ID EQUAL 'CID')
  4085        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  4086        AND (CP-EARN-AS-NET-PAY)
  4087        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4088        CONTINUE
  4089     ELSE
  4090        GO TO 12000-CHECK-AL-CID
  4091     END-IF
  4092     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4093     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4094     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4095     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4096     COMPUTE ANGLEN-1 = ANGLEN / Y
  4097     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4098        / 12)) / ((M + 1) / 2)
  4099     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4100     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4101        + 6 * M) * (WK2 / 100) * (1 + I)
  4102     MOVE WK3 TO CP-CALC-PREMIUM
  4103     GO TO 99999-RETURN
  4104     .
  4105 12000-CHECK-AL-CID.
  4106     IF (CP-COMPANY-ID EQUAL 'CID')
  4107        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4108        AND (CP-EARN-AS-NET-PAY)
  4109        CONTINUE
  4110     ELSE
  4111        GO TO 12000-CHECK-NH-CID
  4112     END-IF
  4113     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4114     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4115     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4116     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4117                   / (1 + I)
  4118     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4119     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4120     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4121        (CP-PREMIUM-RATE / 1000)
  4122     MOVE WK3 TO CP-CALC-PREMIUM
  4123     GO TO 99999-RETURN
  4124     .
  4125 12000-CHECK-NH-CID.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  77
* ELRATE.cbl
  4126     IF (CP-COMPANY-ID EQUAL 'CID')
  4127        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4128        AND (CP-EARN-AS-NET-PAY)
  4129        CONTINUE
  4130     ELSE
  4131        GO TO 12000-CHECK-PA-CID
  4132     END-IF
  4133     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4134     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4135     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4136                   / (1 + I)
  4137     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4138     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4139     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4140        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4141     MOVE WK3 TO CP-CALC-PREMIUM
  4142     GO TO 99999-RETURN
  4143     .
  4144 12000-CHECK-PA-CID.
  4145     IF (CP-COMPANY-ID EQUAL 'CID')
  4146        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4147        AND (CP-EARN-AS-NET-PAY)
  4148        CONTINUE
  4149     ELSE
  4150        GO TO 12000-CHECK-ME-CID
  4151     END-IF
  4152
  4153     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4154     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4155     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4156     COMPUTE ANGLEN-1 = ANGLEN / Y
  4157     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4158     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4159     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4160     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4161        * WK5
  4162     MOVE WK3 TO CP-CALC-PREMIUM
  4163     GO TO 99999-RETURN
  4164     .
  4165 12000-CHECK-ME-CID.
  4166     IF (CP-COMPANY-ID EQUAL 'CID')
  4167        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4168        AND (CP-EARN-AS-NET-PAY)
  4169        CONTINUE
  4170     ELSE
  4171        GO TO 12000-CHECK-VT-TRUNC
  4172     END-IF
  4173     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4174     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4175     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4176     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4177     COMPUTE ANGLEN-1 = ANGLEN / Y
  4178     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4179     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4180     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4181        * WK5
  4182     MOVE WK3 TO CP-CALC-PREMIUM
  4183     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  78
* ELRATE.cbl
  4184     .
  4185 12000-CHECK-VT-TRUNC.
  4186
  4187     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4188        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4189        (CP-EARN-AS-NET-PAY) AND
  4190        (CP-TRUNCATED-LIFE)
  4191        NEXT SENTENCE
  4192     ELSE
  4193        GO TO 12000-CHECK-VT.
  4194
  4195      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4196
  4197      COMPUTE ANGLEN EQUAL WK1 / I.
  4198
  4199      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4200
  4201      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4202      COMPUTE WK9 EQUAL
  4203        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4204        ((.0054 - I) / (1 + I)).
  4205      COMPUTE WK7 EQUAL
  4206        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4207      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4208        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4209
  4210      MOVE WK3 TO CP-CALC-PREMIUM.
  4211
  4212     GO TO 99999-RETURN.
  4213
  4214 12000-CHECK-VT.
  4215
  4216     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4217        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4218        (CP-EARN-AS-NET-PAY)
  4219        NEXT SENTENCE
  4220     ELSE
  4221        GO TO 12000-CHECK-MINN-WDS.
  4222
  4223      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4224
  4225      COMPUTE ANGLEN EQUAL WK1 / I.
  4226
  4227      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4228
  4229      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4230                        (ANGLEN-1 * I)) *
  4231
  4232                        (((1.0054 ** N - 1) /
  4233                        (1.0054 ** (N - 1) * .0054)) -
  4234
  4235                        ((V * (1 - 1.0054 ** N * VX)) /
  4236                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4237
  4238      MOVE WK3 TO CP-CALC-PREMIUM.
  4239
  4240     GO TO 99999-RETURN.
  4241
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  79
* ELRATE.cbl
  4242 12000-CHECK-MINN-WDS.
  4243
  4244     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4245        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4246        (CP-EARN-AS-NET-PAY)
  4247        NEXT SENTENCE
  4248     ELSE
  4249        GO TO 12000-CHECK-MINN-BALL-LEV.
  4250
  4251     COMPUTE ANGLEN EQUAL WK1 / I.
  4252     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  4253              (N / +12) * (2 / (N + 1)).
  4254     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  4255         WK3 * ((N - ANGLEN) / I).
  4256
  4257      MOVE WK3 TO CP-CALC-PREMIUM.
  4258
  4259     GO TO 99999-RETURN.
  4260
  4261 12000-CHECK-MINN-BALL-LEV.
  4262
  4263     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4264        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4265        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4266        (CP-EARN-AS-REG-BALLOON)
  4267        NEXT SENTENCE
  4268     ELSE
  4269        GO TO 12000-CHECK-MINN-BALL.
  4270
  4271     COMPUTE ANGLEN EQUAL WK1 / I.
  4272
  4273     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4274
  4275     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4276        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4277
  4278     MOVE WK3 TO CP-CALC-PREMIUM.
  4279
  4280     GO TO 99999-RETURN.
  4281
  4282 12000-CHECK-MINN-BALL.
  4283
  4284     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4285        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4286        (CP-EARN-AS-REG-BALLOON)
  4287        NEXT SENTENCE
  4288     ELSE
  4289        GO TO 12000-CHECK-CID-MN-BALL.
  4290
  4291     COMPUTE ANGLEN EQUAL WK1 / I.
  4292     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4293
  4294     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4295     / +100 * (N - 1) / 12 * 2 / N *
  4296     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4297
  4298      MOVE WK3 TO CP-CALC-PREMIUM.
  4299
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  80
* ELRATE.cbl
  4300     GO TO 99999-RETURN.
  4301
  4302 12000-CHECK-CID-MN-BALL.
  4303     IF (CP-COMPANY-ID EQUAL 'CID')
  4304        AND (CP-STATE-STD-ABBRV = 'MN')
  4305        AND (CP-CERT-EFF-DT > X'A4FF')
  4306        AND (CP-EARN-AS-REG-BALLOON)
  4307        CONTINUE
  4308     ELSE
  4309        GO TO 12000-CHECK-CID-MN-FARM
  4310     END-IF
  4311     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4312     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4313     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4314     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4315     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4316     COMPUTE V = 1 / (1 + I)
  4317     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4318     COMPUTE Y = (1 + (D * I) / +30)
  4319        / (1 + I)
  4320     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4321        * CP-PREMIUM-RATE / 1000
  4322*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4323*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4324*    ELSE
  4325*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4326*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4327*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4328*       DISPLAY ' BALLOON TOP ' WK6
  4329*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4330*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4331*          / 100
  4332*       DISPLAY ' BALLOON BOTTOM ' WK7
  4333*       COMPUTE GR = WK6 / WK7
  4334*       DISPLAY ' BALLOON PAYMENT ' GR
  4335*    END-IF
  4336     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4337     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4338        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4339     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4340     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4341        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4342           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4343           * CP-PREMIUM-RATE / 1000
  4344     MOVE WK3                    TO CP-CALC-PREMIUM
  4345     GO TO 99999-RETURN.
  4346     .
  4347 12000-CHECK-CID-MN-FARM.
  4348
  4349     IF (CP-COMPANY-ID EQUAL 'CID')
  4350        AND (CP-STATE-STD-ABBRV = 'MN')
  4351        AND (CP-CERT-EFF-DT > X'A4FF')
  4352        AND (CP-EARN-AS-FARM-PLAN)
  4353        CONTINUE
  4354     ELSE
  4355        GO TO 12000-CHECK-NC-WDS
  4356     END-IF
  4357
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  81
* ELRATE.cbl
  4358     EVALUATE CP-PMT-MODE
  4359        WHEN 'B'
  4360           MOVE +14              TO C-DAYS-IN-PMT-PER
  4361           MOVE +26              TO C-PMTS-PER-YEAR
  4362           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4363        WHEN 'S'
  4364           MOVE +15              TO C-DAYS-IN-PMT-PER
  4365           MOVE +24              TO C-PMTS-PER-YEAR
  4366           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4367        WHEN 'T'
  4368           MOVE +360             TO C-DAYS-IN-PMT-PER
  4369           MOVE +1               TO C-PMTS-PER-YEAR
  4370           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4371        WHEN 'W'
  4372           MOVE +7               TO C-DAYS-IN-PMT-PER
  4373           MOVE +52              TO C-PMTS-PER-YEAR
  4374           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4375        WHEN 'B'
  4376           MOVE +14              TO C-DAYS-IN-PMT-PER
  4377           MOVE +26              TO C-PMTS-PER-YEAR
  4378           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4379        WHEN OTHER
  4380           move cp-no-of-pmts    to c-tot-pmts
  4381           if cp-pay-frequency > zeros
  4382              compute c-pmts-per-year =
  4383                 12 / cp-pay-frequency
  4384              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  4385           else
  4386              MOVE +30           TO C-DAYS-IN-PMT-PER
  4387              MOVE +12           TO C-PMTS-PER-YEAR
  4388              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4389           end-if
  4390     END-EVALUATE
  4391
  4392     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4393
  4394     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4395        C-DAYS-IN-PMT-PER)) / (1 + I)
  4396
  4397     compute cp-premium-rate =
  4398        cp-premium-rate * 12 / c-pmts-per-year
  4399     move c-tot-pmts to n m
  4400     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4401     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4402     COMPUTE ANGLEN-1 = ANGLEN / Y
  4403     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4404
  4405     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4406        (cp-premium-rate / 100)
  4407
  4408
  4409     MOVE WK3                    TO CP-CALC-PREMIUM
  4410
  4411     GO TO 99999-RETURN.
  4412
  4413     .
  4414 12000-CHECK-NC-WDS.
  4415
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  82
* ELRATE.cbl
  4416     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4417        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4418        (CP-EARN-AS-NET-PAY)
  4419        NEXT SENTENCE
  4420     ELSE
  4421        GO TO 12000-CHECK-NC-BALL-LEV.
  4422
  4423     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4424     COMPUTE ANGLEN EQUAL WK1 / I.
  4425     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4426              CP-PREMIUM-RATE / +100 *
  4427              N / +12 * 2 / (N + 1) *
  4428              (WK4 - ANGLEN) / (I * ANGLEN).
  4429
  4430      MOVE WK3 TO CP-CALC-PREMIUM.
  4431
  4432     GO TO 99999-RETURN.
  4433
  4434 12000-CHECK-NC-BALL-LEV.
  4435
  4436     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4437        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4438        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4439        (CP-EARN-AS-REG-BALLOON)
  4440        NEXT SENTENCE
  4441     ELSE
  4442        GO TO 12000-CHECK-NC-BALL.
  4443
  4444     COMPUTE ANGLEN EQUAL WK1 / I.
  4445
  4446**** VX = 1 / (1 + I)**N.
  4447
  4448     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4449        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4450
  4451     MOVE WK3 TO CP-CALC-PREMIUM.
  4452
  4453     GO TO 99999-RETURN.
  4454
  4455 12000-CHECK-NC-BALL.
  4456
  4457     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4458        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4459        (CP-EARN-AS-REG-BALLOON)
  4460        NEXT SENTENCE
  4461     ELSE
  4462        GO TO 12000-CHECK-MINN-TRUNC.
  4463
  4464     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4465     COMPUTE ANGLEN EQUAL WK1 / I.
  4466     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4467**** VX = 1 / (1 + I)**N.
  4468
  4469     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4470     / +100 * (N - 1) / 12 * 2 / N *
  4471     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4472
  4473      MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  83
* ELRATE.cbl
  4474
  4475     GO TO 99999-RETURN.
  4476
  4477 12000-CHECK-MINN-TRUNC.
  4478
  4479     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4480        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4481        (M GREATER THAN +63) AND
  4482        (CP-EARN-AS-NET-PAY) AND
  4483        (CP-TRUNCATED-LIFE)
  4484        NEXT SENTENCE
  4485     ELSE
  4486        GO TO 12000-CHECK-MINN.
  4487
  4488      COMPUTE ANGLEN EQUAL WK1 / I.
  4489      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4490
  4491      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4492
  4493      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4494       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4495       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4496
  4497      MOVE WK3 TO CP-CALC-PREMIUM.
  4498
  4499     GO TO 99999-RETURN.
  4500
  4501 12000-CHECK-MINN.
  4502
  4503     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4504        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4505        (M GREATER THAN +63) AND
  4506        (CP-EARN-AS-NET-PAY)
  4507        NEXT SENTENCE
  4508     ELSE
  4509        GO TO 12000-CHECK-MONTANA-TRUNC.
  4510
  4511      COMPUTE ANGLEN EQUAL WK1 / I.
  4512
  4513      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4514
  4515      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4516       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4517       (((N - ANGLEN) / I) + (2 * N)).
  4518
  4519      MOVE WK3 TO CP-CALC-PREMIUM.
  4520
  4521     GO TO 99999-RETURN.
  4522
  4523 12000-CHECK-MONTANA-TRUNC.
  4524
  4525     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4526        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4527        (M GREATER THAN +63) AND
  4528        (CP-EARN-AS-NET-PAY) AND
  4529        (CP-TRUNCATED-LIFE)
  4530        NEXT SENTENCE
  4531     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  84
* ELRATE.cbl
  4532        GO TO 12000-CHECK-MONTANA.
  4533
  4534      COMPUTE ANGLEN EQUAL WK1 / I.
  4535      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4536
  4537      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4538
  4539      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4540      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4541       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4542
  4543      MOVE WK3 TO CP-CALC-PREMIUM.
  4544
  4545     GO TO 99999-RETURN.
  4546
  4547 12000-CHECK-MONTANA.
  4548
  4549     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4550        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4551        (M GREATER THAN +63) AND
  4552        (CP-EARN-AS-NET-PAY)
  4553        NEXT SENTENCE
  4554     ELSE
  4555        GO TO 12001-CONTINUE-NCL-TRUNC.
  4556
  4557      COMPUTE ANGLEN EQUAL WK1 / I.
  4558
  4559      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4560
  4561      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4562       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4563       (((N - ANGLEN) / I) + (4 * N)).
  4564
  4565      MOVE WK3 TO CP-CALC-PREMIUM.
  4566
  4567     GO TO 99999-RETURN.
  4568
  4569 12001-CONTINUE-NCL-TRUNC.
  4570
  4571     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4572        (CP-EARN-AS-NET-PAY) AND
  4573        (CP-TRUNCATED-LIFE)
  4574        NEXT SENTENCE
  4575     ELSE
  4576        GO TO 12001-CONTINUE-NCL.
  4577
  4578      COMPUTE ANGLEN EQUAL WK1 / I.
  4579      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4580
  4581      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4582
  4583      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4584      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4585      (ANGLEN-1 * (N + 1) * I).
  4586
  4587      MOVE WK3 TO CP-CALC-PREMIUM.
  4588
  4589     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  85
* ELRATE.cbl
  4590
  4591 12001-CONTINUE-NCL.
  4592
  4593     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4594        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4595        (CP-EARN-AS-NET-PAY)
  4596        GO TO 12001-CHECK-NC-NET-PLUS3.
  4597
  4598     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4599        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4600        (CP-EARN-AS-NET-PAY)
  4601        GO TO 12001-CHECK-CA.
  4602
  4603     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4604        (CP-EARN-AS-NET-PAY)
  4605        NEXT SENTENCE
  4606     ELSE
  4607        GO TO 12000-CONTINUE-NET.
  4608
  4609      COMPUTE ANGLEN EQUAL WK1 / I.
  4610      MOVE ANGLEN                TO ANGLEN-1.
  4611
  4612      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4613
  4614      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4615       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4616       ((N - ANGLEN) / I).
  4617
  4618      MOVE WK3 TO CP-CALC-PREMIUM.
  4619
  4620     GO TO 99999-RETURN.
  4621
  4622 12000-CONTINUE-NET.
  4623
  4624     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4625        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4626        (CP-EARN-AS-NET-PAY)
  4627        NEXT SENTENCE
  4628     ELSE
  4629        GO TO 12001-CONTINUE-MINN.
  4630
  4631      COMPUTE ANGLEN EQUAL WK6 / I.
  4632      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  4633
  4634      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  4635      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  4636      COMPUTE WK3 EQUAL (WK3 / I) *
  4637       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  4638
  4639      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  4640         MOVE +0 TO CP-R-MAX-TOT-BEN.
  4641
  4642      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  4643
  4644      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  4645         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  4646         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  4647
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  86
* ELRATE.cbl
  4648      MOVE WK3 TO CP-CALC-PREMIUM.
  4649
  4650     GO TO 99999-RETURN.
  4651
  4652 12001-CONTINUE-MINN.
  4653
  4654     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4655        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  4656        (CP-TRUNCATED-LIFE)
  4657        NEXT SENTENCE
  4658     ELSE
  4659        GO TO 12001-CHECK-RI-GTL.
  4660
  4661      COMPUTE ANGLEN EQUAL WK1 / I.
  4662      COMPUTE ANGLEM EQUAL WK2 / I.
  4663
  4664      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  4665       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  4666       * M / 2400) * 1000 + .5) / 1000000.
  4667
  4668      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  4669       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  4670
  4671     GO TO 99999-RETURN.
  4672
  4673 12001-CHECK-RI-GTL.
  4674
  4675     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4676        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4677        (CP-EARN-AS-NET-PAY)
  4678        NEXT SENTENCE
  4679     ELSE
  4680        GO TO 12001-CHECK-RI-LEASE-GTL.
  4681
  4682      COMPUTE ANGLEN EQUAL WK1 / I.
  4683*     COMPUTE ANGLEM EQUAL WK2 / I.
  4684
  4685      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  4686               (1 + WS-WORK-DIS-RATE * N).
  4687      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  4688         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  4689
  4690
  4691     GO TO 99999-RETURN.
  4692
  4693 12001-CHECK-RI-LEASE-GTL.
  4694
  4695     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4696        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4697        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4698        NEXT SENTENCE
  4699     ELSE
  4700        GO TO 12001-CHECK-OR-GTL.
  4701
  4702     COMPUTE ANGLEN EQUAL WK1 / I.
  4703
  4704     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  4705        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  87
* ELRATE.cbl
  4706                        /
  4707        (1000 * I * (1 + .0021 * N)).
  4708     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  4709       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  4710                            /
  4711       (1000 * (1 + .0027 * (N + 1))).
  4712
  4713     GO TO 99999-RETURN.
  4714
  4715 12001-CHECK-OR-GTL.
  4716
  4717     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4718        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  4719        (CP-EARN-AS-NET-PAY)
  4720        NEXT SENTENCE
  4721     ELSE
  4722        GO TO 12001-CHECK-GA-GTL.
  4723
  4724     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4725     COMPUTE ANGLEN EQUAL WK1 / I.
  4726
  4727     IF M LESS THAN +64
  4728        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4729         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  4730                   /
  4731         (I * ANGLEN * (N - (N - M) + 1) * 600)
  4732        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  4733     ELSE
  4734        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4735        CP-PREMIUM-RATE * (1 + I))
  4736                  /
  4737        (+1000 * I * ANGLEN)
  4738        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4739*    MOVE WK3 TO CP-CALC-PREMIUM.
  4740     GO TO 99999-RETURN.
  4741
  4742 12001-CHECK-GA-GTL.
  4743
  4744     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4745        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  4746        (CP-EARN-AS-NET-PAY)
  4747*       (CP-TRUNCATED-LIFE)
  4748        NEXT SENTENCE
  4749     ELSE
  4750        GO TO 12001-CHECK-MA-GTL.
  4751
  4752     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4753     COMPUTE ANGLEN EQUAL WK1 / I.
  4754
  4755     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  4756     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  4757      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  4758     MOVE WK3 TO CP-CALC-PREMIUM.
  4759
  4760     GO TO 99999-RETURN.
  4761
  4762 12001-CHECK-MA-GTL.
  4763
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  88
* ELRATE.cbl
  4764     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4765        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  4766        (CP-EARN-AS-NET-PAY) AND
  4767        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4768        NEXT SENTENCE
  4769     ELSE
  4770        GO TO 12001-CHECK-NV-NET.
  4771
  4772     COMPUTE ANGLEN EQUAL WK1 / I.
  4773
  4774     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  4775      CP-ALTERNATE-BENEFIT * N.
  4776
  4777     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  4778     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  4779
  4780     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  4781     WK7 * (N - ANGLEN) / I.
  4782     MOVE WK3 TO CP-CALC-PREMIUM.
  4783
  4784     GO TO 99999-RETURN.
  4785
  4786 12001-CHECK-NV-NET.
  4787     IF (CP-COMPANY-ID EQUAL 'CID')
  4788        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4789        AND (CP-EARN-AS-NET-PAY)
  4790        CONTINUE
  4791     ELSE
  4792        GO TO 12001-CHECK-MN-NET
  4793     END-IF
  4794     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4795     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4796     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4797                   / (1 + I)
  4798     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4799     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4800     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4801        (CP-PREMIUM-RATE * K-I / 1000)
  4802     MOVE WK3                    TO CP-CALC-PREMIUM
  4803     GO TO 99999-RETURN
  4804      .
  4805 12001-CHECK-MN-NET.
  4806     IF (CP-COMPANY-ID EQUAL 'CID')
  4807        AND (CP-STATE-STD-ABBRV = 'MN')
  4808        AND (CP-EARN-AS-NET-PAY)
  4809        AND (NOT CP-LEVEL-LIFE)
  4810        AND (WS-DISCOUNT-OPTION = '1')
  4811        CONTINUE
  4812     ELSE
  4813        GO TO 12001-CHECK-NC-NET
  4814     END-IF
  4815     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4816     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4817     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4818                   / (1 + I)
  4819     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4820     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4821     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  89
* ELRATE.cbl
  4822        (CP-PREMIUM-RATE / 1000) * (1 + I)
  4823     MOVE WK3                    TO CP-CALC-PREMIUM
  4824     GO TO 99999-RETURN
  4825      .
  4826 12001-CHECK-NC-NET.
  4827
  4828     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  4829        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4830        (CP-EARN-AS-NET-PAY)
  4831        NEXT SENTENCE
  4832     ELSE
  4833        GO TO 12001-CHECK-NC-NET-PLUS3.
  4834
  4835      COMPUTE ANGLEN EQUAL WK1 / I.
  4836      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4837
  4838      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  4839          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  4840          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  4841          N * (CP-PREMIUM-RATE / 1000)).
  4842
  4843      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  4844          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  4845
  4846      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  4847          ((N - ANGLEN) / I + 3) / ANGLEN) /
  4848          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  4849          (ANGLEN * 2))
  4850
  4851      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  4852
  4853      IF ANGLEN IS NOT LESS THAN WK7
  4854          COMPUTE CP-PREMIUM-RATE ROUNDED =
  4855              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  4856          COMPUTE WK3 ROUNDED =
  4857              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  4858
  4859     MOVE WK3 TO CP-CALC-PREMIUM.
  4860
  4861     GO TO 99999-RETURN.
  4862
  4863 12001-CHECK-NC-NET-PLUS3.
  4864
  4865     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4866        (CP-EARN-AS-NET-PAY) AND
  4867        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  4868        NEXT SENTENCE
  4869     ELSE
  4870        GO TO 12001-CHECK-CA.
  4871
  4872     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  4873     MOVE ' ' TO DC-OPTION-CODE.
  4874     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  4875
  4876     IF DATE-CONVERSION-ERROR
  4877        MOVE '2'                 TO CP-RETURN-CODE
  4878        MOVE ZEROS               TO FACTOR
  4879                                    CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  90
* ELRATE.cbl
  4880         GO TO 99999-RETURN.
  4881
  4882     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  4883        NEXT SENTENCE
  4884     ELSE
  4885        GO TO 12001-CONTINUE-NET.
  4886
  4887     COMPUTE ANGLEN EQUAL WK1 / I.
  4888     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4889
  4890     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  4891
  4892     COMPUTE NC-R = 20 *
  4893                    ((NC-LR * ORIGINAL-TERM) / 12)
  4894                          / (ORIGINAL-TERM + 1).
  4895
  4896     COMPUTE NC-OB = NC-R / 1000.
  4897
  4898     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  4899                    (NC-OB * ORIGINAL-TERM * 3).
  4900
  4901     IF CP-EXT-CHG-LF
  4902         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  4903     ELSE
  4904         MOVE 30                 TO  NC-BIG-D.
  4905
  4906     COMPUTE NC-LITTLE-D = (1 + I) /
  4907             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  4908
  4909     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  4910             (ANGLEN * NC-LITTLE-D ).
  4911
  4912     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  4913
  4914     GO TO 99999-RETURN.
  4915
  4916 12001-CHECK-CA.
  4917
  4918     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4919        (WS-DISCOUNT-OPTION = '6')
  4920        NEXT SENTENCE
  4921     ELSE
  4922        GO TO 12001-CHECK-GTL-IA.
  4923
  4924     COMPUTE CA-J = CA-DISCOUNT / 12.
  4925     COMPUTE ANGLEN EQUAL WK1 / I.
  4926     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  4927     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  4928     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  4929     COMPUTE CA-VI = (1 + I)** -1.
  4930     COMPUTE CP-CALC-PREMIUM =
  4931         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  4932         ((1 + CA-J) / I) *
  4933         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  4934         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  4935         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  4936
  4937     GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  91
* ELRATE.cbl
  4938
  4939 12001-CHECK-GTL-IA.
  4940
  4941     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  4942        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  4943        (CP-EARN-AS-NET-PAY)
  4944        NEXT SENTENCE
  4945     ELSE
  4946        GO TO 12001-CHECK-CID-TRN-VA.
  4947
  4948***************************************************************
  4949
  4950     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  4951
  4952     IF GTL-IA-ODD-DAYS = ZEROS
  4953         MOVE ZERO               TO  GTL-IA-SGN
  4954     ELSE
  4955         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  4956             MOVE +1             TO  GTL-IA-SGN
  4957         ELSE
  4958             MOVE -1             TO  GTL-IA-SGN.
  4959
  4960     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  4961     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  4962
  4963     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  4964                          GTL-IA-SGN.
  4965
  4966     COMPUTE ANGLEN EQUAL WK1 / I.
  4967     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4968
  4969     IF GTL-IA-ODF NOT = ZERO
  4970         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  4971         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  4972
  4973     COMPUTE GTL-IA-DIVIDEND =
  4974           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  4975                             (ANGLEN - ANGLEN-M))) *
  4976           ((K1 + I) * CP-PREMIUM-RATE *
  4977                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  4978
  4979     COMPUTE GTL-IA-DIVISOR =
  4980      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  4981
  4982     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  4983
  4984     COMPUTE CP-CALC-PREMIUM =
  4985                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  4986     GO TO 99999-RETURN.
  4987
  4988
  4989 12001-CHECK-CID-TRN-VA.
  4990
  4991     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4992        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  4993        (CP-EARN-AS-NET-PAY) AND
  4994        (CP-TRUNCATED-LIFE) AND
  4995        (CP-STATE-STD-ABBRV = CP-STATE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  92
* ELRATE.cbl
  4996        CONTINUE
  4997     ELSE
  4998        GO TO 12001-CHECK-CID-TX
  4999     END-IF
  5000
  5001     COMPUTE ANGLEN EQUAL WK1 / I
  5002     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5003     IF WS-WORK-DIS-RATE = ZEROS
  5004        CONTINUE
  5005     ELSE
  5006        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5007        COMPUTE WK7 = (1 / I) *
  5008              (((WK4 ** M - 1) / (WK4 - 1)) -
  5009              ((WK4 ** M * SX - VX) /
  5010              (WK4 * (1 + I) - 1))) *
  5011              (CP-PREMIUM-RATE / 1000)
  5012        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5013        COMPUTE WK8 = WK7 * 100 / ANGLEN
  5014        COMPUTE CP-CALC-PREMIUM =
  5015           WK8 *  ((WK4 * ANGLEN) / 100)
  5016     END-IF
  5017
  5018     GO TO 99999-RETURN
  5019
  5020     .
  5021
  5022 12001-CHECK-CID-TX.
  5023     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5024        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  5025        (CP-EARN-AS-NET-PAY) AND
  5026        (WS-WORK-DIS-RATE > ZEROS) AND
  5027        (CP-STATE-STD-ABBRV = CP-STATE)
  5028        CONTINUE
  5029     ELSE
  5030        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5031     END-IF
  5032* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5033     COMPUTE K-I = 1 + (1 * I)
  5034     COMPUTE ANGLEN EQUAL WK1 / I
  5035     COMPUTE ANGLEM EQUAL WK2 / I
  5036     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5037     IF WS-WORK-DIS-RATE = ZEROS
  5038        CONTINUE
  5039     ELSE
  5040        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5041        COMPUTE WK7 = (K-I / I) *
  5042              (((WK4 ** M - 1) / (WK4 - 1)) -
  5043*             ((WK4 ** M * SX - VX) /
  5044              ((WK4 ** M * SX) - VX) /
  5045*             (WK4 * (1 + I) - 1))) *
  5046              (WK4 * (1 + I) - 1)) *
  5047              (CP-PREMIUM-RATE / 1000)
  5048        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5049        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  5050        COMPUTE CP-CALC-PREMIUM =
  5051           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  5052     END-IF
  5053
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  93
* ELRATE.cbl
  5054     GO TO 99999-RETURN
  5055     .
  5056 12001-CHECK-CID-LEV-MN-NEW.
  5057*    IF (CP-COMPANY-ID EQUAL 'CID')
  5058*       AND (CP-STATE-STD-ABBRV = 'MN')
  5059*       AND (CP-EARN-AS-NET-PAY)
  5060*       AND (CP-LEVEL-LIFE)
  5061*       AND (CP-CERT-EFF-DT > X'A4FF')
  5062*       CONTINUE
  5063*    ELSE
  5064*       GO TO 12001-CHECK-CID-LEV-MN
  5065*    END-IF
  5066*
  5067*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5068*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5069*    MOVE '1'                    TO DC-OPTION-CODE
  5070*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5071*
  5072*    IF DATE-CONVERSION-ERROR
  5073*       MOVE '2'                 TO CP-RETURN-CODE
  5074*       MOVE ZEROS               TO FACTOR
  5075*                                   CP-CALC-PREMIUM
  5076*       GO TO 99999-RETURN
  5077*    END-IF
  5078*
  5079*    COMPUTE I = CP-LOAN-APR / 100
  5080*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5081*
  5082*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5083*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5084*      * 12 / 360 * D)
  5085*
  5086*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5087*       * 12 / 360 * D
  5088*
  5089*    GO TO 99999-RETURN
  5090      .
  5091 12001-CHECK-CID-LEV-MN.
  5092
  5093     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5094        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  5095        (CP-EARN-AS-NET-PAY) AND
  5096        (CP-LEVEL-LIFE) AND
  5097        (CP-STATE-STD-ABBRV = CP-STATE)
  5098        CONTINUE
  5099     ELSE
  5100        GO TO 12001-CHECK-CID-LEV-CA
  5101     END-IF
  5102
  5103     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5104         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5105         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5106
  5107     GO TO 99999-RETURN
  5108
  5109      .
  5110 12001-CHECK-CID-LEV-CA.
  5111
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  94
* ELRATE.cbl
  5112     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5113        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5114        (CP-EARN-AS-NET-PAY) AND
  5115        (CP-LEVEL-LIFE) AND
  5116        (CP-STATE-STD-ABBRV = CP-STATE)
  5117        CONTINUE
  5118     ELSE
  5119        GO TO 12001-CHECK-CID-TRN-CA
  5120     END-IF
  5121
  5122     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5123     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5124     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5125     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5126     COMPUTE CP-CALC-PREMIUM =
  5127          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  5128          (CP-PREMIUM-RATE / 1000)) /
  5129          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5130
  5131     GO TO 99999-RETURN
  5132
  5133      .
  5134 12001-CHECK-CID-TRN-CA.
  5135
  5136     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5137        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5138        (CP-EARN-AS-NET-PAY) AND
  5139        (CP-TRUNCATED-LIFE) AND
  5140        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5141        (WS-DISCOUNT-OPTION NOT = ' ')
  5142        CONTINUE
  5143     ELSE
  5144        GO TO 12001-CHECK-CID-TRN-MT
  5145     END-IF
  5146
  5147     COMPUTE ANGLEN EQUAL WK1 / I
  5148     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5149     IF WS-WORK-DIS-RATE = ZEROS
  5150        CONTINUE
  5151     ELSE
  5152        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5153        COMPUTE WK7 = (1 / I) *
  5154              (((WK4 ** M - 1) / (WK4 - 1)) -
  5155              ((WK4 ** M * SX - VX) /
  5156              (WK4 * (1 + I) - 1))) *
  5157              (CP-PREMIUM-RATE / 1000)
  5158        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5159        COMPUTE CP-CALC-PREMIUM =
  5160           WK4 *  WK7
  5161     END-IF
  5162
  5163     GO TO 99999-RETURN
  5164
  5165      .
  5166 12001-CHECK-CID-TRN-MT.
  5167
  5168     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5169        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  95
* ELRATE.cbl
  5170                   OR
  5171        ((CP-STATE-STD-ABBRV = 'IN') AND
  5172        (CP-CERT-EFF-DT > X'9A7F'))
  5173                   OR
  5174        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5175        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5176        (CP-EARN-AS-NET-PAY) AND
  5177        (CP-TRUNCATED-LIFE) AND
  5178        (CP-STATE-STD-ABBRV = CP-STATE)
  5179        CONTINUE
  5180     ELSE
  5181        GO TO 12001-CHECK-CID-MT
  5182     END-IF
  5183
  5184* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5185     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5186        MOVE 0                   TO K-I
  5187     ELSE
  5188        MOVE 2                   TO K-I
  5189     END-IF
  5190     COMPUTE CP-TERM-OR-EXT-DAYS =
  5191           CP-TERM-OR-EXT-DAYS + 30
  5192
  5193     COMPUTE ANGLEN EQUAL WK1 / I
  5194     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5195     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5196                   / (1 + I)
  5197     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5198     IF WS-WORK-DIS-RATE = ZEROS
  5199        CONTINUE
  5200     ELSE
  5201        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5202*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5203        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5204              (((WK4 ** M - 1) / (WK4 - 1)) -
  5205              ((WK4 ** M * SX - VX) /
  5206              (WK4 * (1 + I) - 1))) *
  5207              (CP-PREMIUM-RATE / 1000)
  5208        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5209*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5210        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5211        COMPUTE CP-CALC-PREMIUM =
  5212           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5213*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5214     END-IF
  5215
  5216     GO TO 99999-RETURN
  5217
  5218     .
  5219 12001-CHECK-CID-MT.
  5220
  5221     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5222        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5223                                OR 'VT')
  5224                   OR
  5225        ((CP-STATE-STD-ABBRV = 'IN') AND
  5226        (CP-CERT-EFF-DT > X'9A7F'))
  5227                   OR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  96
* ELRATE.cbl
  5228        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5229        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5230        (CP-EARN-AS-NET-PAY) AND
  5231        (CP-STATE-STD-ABBRV = CP-STATE)
  5232        CONTINUE
  5233     ELSE
  5234        GO TO 12001-CHECK-DCC-DD
  5235     END-IF
  5236
  5237     COMPUTE CP-TERM-OR-EXT-DAYS =
  5238           CP-TERM-OR-EXT-DAYS + 30
  5239
  5240* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5241     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5242        MOVE 0                   TO K-I
  5243     ELSE
  5244        IF CP-STATE-STD-ABBRV = 'NJ'
  5245           MOVE 1                TO K-I
  5246        ELSE
  5247           MOVE 2                TO K-I
  5248        END-IF
  5249     END-IF
  5250     COMPUTE ANGLEN EQUAL WK1 / I
  5251     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5252     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5253                   / (1 + I)
  5254     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5255     IF WS-WORK-DIS-RATE = ZEROS
  5256        CONTINUE
  5257     ELSE
  5258        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5259*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5260        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5261              (((WK4 ** N - 1) / (WK4 - 1)) -
  5262              ((WK4 ** N - SV) /
  5263              (WK4 * (1 + I) - 1))) *
  5264              (CP-PREMIUM-RATE / 1000)
  5265        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5266*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5267        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5268        COMPUTE CP-CALC-PREMIUM =
  5269           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5270*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5271     END-IF
  5272
  5273     GO TO 99999-RETURN
  5274
  5275     .
  5276 12001-CHECK-DCC-DD.
  5277     IF (CP-COMPANY-ID EQUAL 'DCC')
  5278        AND (CP-EARN-AS-NET-PAY)
  5279        AND (CP-BEN-CATEGORY = 'D')
  5280        CONTINUE
  5281     ELSE
  5282        GO TO 12001-CHECK-DCC-NET
  5283     END-IF
  5284
  5285     COMPUTE CP-TERM-OR-EXT-DAYS =
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  97
* ELRATE.cbl
  5286           CP-TERM-OR-EXT-DAYS + 30
  5287
  5288     COMPUTE ANGLEN EQUAL WK1 / I.
  5289     COMPUTE ANGLEM EQUAL WK2 / I.
  5290     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5291
  5292     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5293           / (1 + I)
  5294     COMPUTE GR     = ANGLEN / ODF
  5295*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5296*      CP-RATE-DEV-PCT
  5297     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5298     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5299       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5300     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5301     MOVE WK3                    TO CP-CALC-PREMIUM
  5302
  5303     GO TO 99999-RETURN
  5304
  5305     .
  5306 12001-CHECK-DCC-NET.
  5307
  5308     IF (CP-COMPANY-ID EQUAL 'DCC')
  5309        AND (CP-EARN-AS-NET-PAY)
  5310        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5311             AND 'H' AND 'S' AND 'P')
  5312        CONTINUE
  5313     ELSE
  5314        GO TO 12001-CHECK-DCC-PNET
  5315     END-IF
  5316
  5317     COMPUTE CP-TERM-OR-EXT-DAYS =
  5318           CP-TERM-OR-EXT-DAYS + 30
  5319
  5320     COMPUTE ANGLEN EQUAL WK1 / I.
  5321     COMPUTE ANGLEM EQUAL WK2 / I.
  5322     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5323
  5324     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5325           / (1 + I)
  5326     COMPUTE GR     = ANGLEN / ODF
  5327     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5328     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5329       CP-RATE-DEV-PCT
  5330     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5331*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5332
  5333     COMPUTE WK8 = CP-PREMIUM-RATE *
  5334        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5335     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5336     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5337     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5338       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5339     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5340     MOVE WK3                    TO CP-CALC-PREMIUM
  5341
  5342     GO TO 99999-RETURN
  5343
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  98
* ELRATE.cbl
  5344     .
  5345 12001-CHECK-DCC-PNET.
  5346     IF (CP-COMPANY-ID EQUAL 'DCC')
  5347        AND (CP-EARN-AS-NET-PAY)
  5348        AND (CP-BENEFIT-CD (1:1) = 'P')
  5349        CONTINUE
  5350     ELSE
  5351        GO TO 12001-CHECK-DCC-MNET
  5352     END-IF
  5353     IF CP-NO-OF-PMTS NOT NUMERIC
  5354        MOVE +0                  TO CP-NO-OF-PMTS
  5355     END-IF
  5356     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5357        AND ' ' AND 'M'
  5358        MOVE ' '                 TO CP-PMT-MODE
  5359     END-IF
  5360******************************************************************
  5361***   Default is monthly, use loan term for rate and amort     ***
  5362******************************************************************
  5363     move cp-loan-term         to c-tot-pmts
  5364     MOVE +30                  TO C-DAYS-IN-PMT-PER
  5365     MOVE +12                  TO C-PMTS-PER-YEAR
  5366******************************************************************
  5367
  5368     evaluate true
  5369        when cp-pmt-mode = 'W'
  5370           MOVE +52              TO C-PMTS-PER-YEAR
  5371           compute c-tot-pmts = cp-loan-term /
  5372              12 * c-pmts-per-year
  5373           MOVE +7               TO C-DAYS-IN-PMT-PER
  5374        when cp-pmt-mode = 'B'
  5375           MOVE +26              TO C-PMTS-PER-YEAR
  5376           compute c-tot-pmts = cp-loan-term /
  5377              12 * c-pmts-per-year
  5378           MOVE +14              TO C-DAYS-IN-PMT-PER
  5379     end-evaluate
  5380     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5381     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5382        C-DAYS-IN-PMT-PER)) / (1 + I)
  5383     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  5384*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5385     COMPUTE ANGLEN-1 = ANGLEN / Y
  5386     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5387     IF CP-RATE-DEV-PCT NOT = ZEROS
  5388        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5389           CP-PREMIUM-RATE
  5390     END-IF
  5391     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5392     GO TO 99999-RETURN
  5393     .
  5394 12001-CHECK-DCC-MNET.
  5395
  5396     IF (CP-COMPANY-ID EQUAL 'DCC')
  5397        AND (CP-EARN-AS-NET-PAY)
  5398        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5399        CONTINUE
  5400     ELSE
  5401        GO TO 12001-CHECK-DCC-MNET-LF-BAL
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page  99
* ELRATE.cbl
  5402     END-IF
  5403
  5404*    COMPUTE ANGLEN EQUAL WK1 / I.
  5405*    COMPUTE ANGLEM EQUAL WK2 / I.
  5406*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5407
  5408     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5409     MOVE WK3                    TO CP-CALC-PREMIUM
  5410
  5411     GO TO 99999-RETURN
  5412
  5413     .
  5414 12001-CHECK-DCC-MNET-LF-BAL.
  5415
  5416     IF (CP-COMPANY-ID EQUAL 'DCC')
  5417        AND (CP-EARN-AS-NET-PAY)
  5418        AND (CP-BENEFIT-CD (1:1) = 'N')
  5419        AND (CP-BEN-CATEGORY NOT = 'N')
  5420        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5421        CONTINUE
  5422     ELSE
  5423        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5424     END-IF
  5425
  5426     IF CP-RATE-DEV-PCT NOT = ZEROS
  5427        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5428           CP-PREMIUM-RATE
  5429     END-IF
  5430*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5431     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5432        / (1 + I)
  5433     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5434     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5435     COMPUTE WK2 = (1 + J) ** (M * -1)
  5436     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5437     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5438          ** ((M - 1) * -1))) / J)
  5439     COMPUTE ANGLEM = ((1 - ((1 + J)
  5440          ** (M * -1))) / J) / OD
  5441     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5442        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5443        / ANGLEM-1
  5444     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5445          ** ((N - M) * -1))) / I)
  5446     MOVE +0                     TO WK3
  5447     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5448        (WS-COUNTER > M)
  5449        COMPUTE ANGLEM = (1 - ((1 + J)
  5450          ** ((M - WS-COUNTER) * -1))) / J
  5451        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5452        COMPUTE WK5-CSL = (RA * ANGLEM)
  5453        + (CP-ALTERNATE-BENEFIT * WK2)
  5454        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5455     END-PERFORM
  5456     MOVE WK3                    TO CP-CALC-PREMIUM
  5457
  5458     GO TO 99999-RETURN
  5459
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 100
* ELRATE.cbl
  5460     .
  5461 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5462
  5463     IF (CP-COMPANY-ID EQUAL 'DCC')
  5464        AND (CP-EARN-AS-NET-PAY)
  5465        AND (CP-BENEFIT-CD (1:1) = 'S')
  5466        AND (CP-BEN-CATEGORY NOT = 'N')
  5467        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5468        CONTINUE
  5469     ELSE
  5470        GO TO 12001-CHECK-DCC-MNET-LF
  5471     END-IF
  5472
  5473     IF CP-RATE-DEV-PCT NOT = ZEROS
  5474        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5475           CP-PREMIUM-RATE
  5476     END-IF
  5477     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5478     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5479          ** ((M - 1) * -1))) / K)
  5480     COMPUTE ANGLEM = ((1 - ((1 + K)
  5481          ** (M * -1))) / K)
  5482     MOVE CP-MONTHLY-PAYMENT     TO RA
  5483     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5484        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5485        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5486        CP-PREMIUM-RATE / 1000
  5487     MOVE WK3                    TO CP-CALC-PREMIUM
  5488
  5489     GO TO 99999-RETURN
  5490
  5491     .
  5492 12001-CHECK-DCC-MNET-LF.
  5493
  5494     IF (CP-COMPANY-ID EQUAL 'DCC')
  5495        AND (CP-EARN-AS-NET-PAY)
  5496        AND (CP-BENEFIT-CD (1:1) = 'N')
  5497        AND (CP-BEN-CATEGORY NOT = 'N')
  5498        CONTINUE
  5499     ELSE
  5500        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5501     END-IF
  5502
  5503     IF CP-RATE-DEV-PCT NOT = ZEROS
  5504        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5505           CP-PREMIUM-RATE
  5506     END-IF
  5507*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5508     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5509        / (1 + I)
  5510     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5511     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5512     COMPUTE WK2 = (1 + J) ** (M * -1)
  5513     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5514     COMPUTE ANGLEM = ((1 - ((1 + J)
  5515          ** (M * -1))) / J) / OD
  5516     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5517     COMPUTE ANGLEN-M = ((1 - ((1 + I)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 101
* ELRATE.cbl
  5518          ** ((N - M) * -1))) / I)
  5519     MOVE +0                     TO WK3
  5520     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5521        (WS-COUNTER > M)
  5522        COMPUTE ANGLEM = (1 - ((1 + J)
  5523          ** ((M - WS-COUNTER + 1) * -1))) / J
  5524        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5525        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5526        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5527     END-PERFORM
  5528     MOVE WK3                    TO CP-CALC-PREMIUM
  5529
  5530     GO TO 99999-RETURN
  5531
  5532     .
  5533 12001-CHECK-DCC-MNET-SUMLF.
  5534
  5535     IF (CP-COMPANY-ID EQUAL 'DCC')
  5536        AND (CP-EARN-AS-NET-PAY)
  5537        AND (CP-BENEFIT-CD (1:1) = 'S')
  5538        AND (CP-BEN-CATEGORY NOT = 'N')
  5539        CONTINUE
  5540     ELSE
  5541        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5542     END-IF
  5543
  5544     IF CP-RATE-DEV-PCT NOT = ZEROS
  5545        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5546           CP-PREMIUM-RATE
  5547     END-IF
  5548     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5549     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5550        / (1 + K)
  5551     COMPUTE ANGLEN-M = (WK5 / I)
  5552     COMPUTE WK2 = (1 + K) ** (M * -1)
  5553     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5554     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5555     COMPUTE ANGLEM = ((1 - ((1 + K)
  5556          ** (M * -1))) / K) / Y
  5557     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5558     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5559        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5560        - 1)) / K) * RA
  5561     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5562        + (CP-DAYS-TO-1ST-PMT - +30)
  5563        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5564        +0 / 1000 * 12 / 12)
  5565     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5566        * (12 / 12)
  5567     MOVE WK3                    TO CP-CALC-PREMIUM
  5568
  5569     GO TO 99999-RETURN
  5570
  5571     .
  5572 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5573
  5574     IF (CP-COMPANY-ID EQUAL 'DCC')
  5575        AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 102
* ELRATE.cbl
  5576        AND (CP-BENEFIT-CD (1:1) = 'N')
  5577        AND (CP-BEN-CATEGORY = 'N')
  5578        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5579        CONTINUE
  5580     ELSE
  5581        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5582     END-IF
  5583
  5584*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5585     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5586        / (1 + I)
  5587     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5588     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5589     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5590     COMPUTE WK2 = (1 + J) ** (M * -1)
  5591     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5592     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5593          ** ((M - 1) * -1))) / J)
  5594     COMPUTE ANGLEM = ((1 - ((1 + J)
  5595          ** (M * -1))) / J) / OD
  5596     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5597        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5598        / ANGLEM-1
  5599     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5600          ** ((N - M) * -1))) / I)
  5601     MOVE +0                     TO WK3
  5602     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5603        (WS-COUNTER > M)
  5604        COMPUTE ANGLEM = (1 - ((1 + J)
  5605          ** ((M - WS-COUNTER) * -1))) / J
  5606        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5607        COMPUTE WK5-CSL = (RA * ANGLEM)
  5608        + (CP-ALTERNATE-BENEFIT * WK2)
  5609        COMPUTE WK3 = WK3 +
  5610         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5611        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5612          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5613          (CP-DCC-AH-RATE / 1000)
  5614     END-PERFORM
  5615     MOVE WK3                    TO CP-CALC-PREMIUM
  5616
  5617     GO TO 99999-RETURN
  5618
  5619     .
  5620 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5621
  5622     IF (CP-COMPANY-ID EQUAL 'DCC')
  5623        AND (CP-EARN-AS-NET-PAY)
  5624        AND (CP-BENEFIT-CD (1:1) = 'S')
  5625        AND (CP-BEN-CATEGORY = 'N')
  5626        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5627        CONTINUE
  5628     ELSE
  5629        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5630     END-IF
  5631
  5632     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5633     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 103
* ELRATE.cbl
  5634          ** ((M - 1) * -1))) / K)
  5635     COMPUTE ANGLEM = ((1 - ((1 + K)
  5636          ** (M * -1))) / K)
  5637     MOVE CP-MONTHLY-PAYMENT     TO RA
  5638     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5639        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5640        * CP-DCC-AH-RATE / 1000))
  5641        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5642        CP-DCC-LF-RATE / 1000
  5643     MOVE WK3                    TO CP-LF-PREM
  5644     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5645        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5646        * CP-DCC-AH-RATE / 1000
  5647     COMPUTE WK3 = WK3 + WK5-CSL
  5648     MOVE WK3                    TO CP-CALC-PREMIUM
  5649
  5650     GO TO 99999-RETURN
  5651      .
  5652 12001-CHECK-DCC-MNET-TOT-N.
  5653
  5654     IF (CP-COMPANY-ID EQUAL 'DCC')
  5655        AND (CP-EARN-AS-NET-PAY)
  5656        AND (CP-BENEFIT-CD (1:1) = 'N')
  5657        AND (CP-BEN-CATEGORY = 'N')
  5658        CONTINUE
  5659     ELSE
  5660        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5661     END-IF
  5662
  5663*    I = APR/1200
  5664*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5665*    RA = PAYMENT AMOUNT
  5666*    WK5-CSL = THE BALANCE (PAY OFF )
  5667*    WK3 = THE ACCUMULATED PREMIUM
  5668*    WK2 = (1 + I) ^ (m * -1)
  5669*    OD  = GAMMA
  5670*
  5671*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5672     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5673        / (1 + I)
  5674     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5675     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5676        (CP-DCC-AH-RATE / +1000)
  5677     COMPUTE WK2 = (1 + J) ** (M * -1)
  5678     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5679     COMPUTE ANGLEM = ((1 - ((1 + J)
  5680          ** (M * -1))) / J) / OD
  5681     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5682     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5683          ** ((N - M) * -1))) / I)
  5684     MOVE +0                     TO WK3
  5685     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5686        (WS-COUNTER > M)
  5687        COMPUTE ANGLEM = (1 - ((1 + J)
  5688          ** ((M - WS-COUNTER + 1) * -1))) / J
  5689        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5690        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5691        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 104
* ELRATE.cbl
  5692           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5693     END-PERFORM
  5694     MOVE WK3                    TO CP-CALC-PREMIUM
  5695
  5696     GO TO 99999-RETURN
  5697
  5698     .
  5699 12001-CHECK-DCC-MNET-TOT-S.
  5700
  5701     IF (CP-COMPANY-ID EQUAL 'DCC')
  5702        AND (CP-EARN-AS-NET-PAY)
  5703        AND (CP-BENEFIT-CD (1:1) = 'S')
  5704        AND (CP-BEN-CATEGORY = 'N')
  5705        CONTINUE
  5706     ELSE
  5707        GO TO 12001-CONTINUE-NET
  5708     END-IF
  5709
  5710*    I = APR/1200
  5711*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5712*    RA = PAYMENT AMOUNT
  5713*    WK5-CSL = THE BALANCE (PAY OFF )
  5714*    WK3 = THE ACCUMULATED PREMIUM
  5715*    WK2 = (1 + I) ^ (m * -1)
  5716*    OD  = GAMMA
  5717*
  5718     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5719     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5720        / (1 + J)
  5721     COMPUTE ANGLEM = ((1 - ((1 + J)
  5722          ** (M * -1))) / J) / OD
  5723     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5724          ** ((N - M) * -1))) / I)
  5725          * (1 + J) ** (-1 * M)
  5726     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5727     MOVE CP-MONTHLY-PAYMENT     TO RA
  5728     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5729        / +30)
  5730     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5731        ** (WK1) - 1)) / J) * RA
  5732     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5733        + (CP-DAYS-TO-1ST-PMT - +30)
  5734        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5735        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5736     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5737        (12 / 12)
  5738     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5739        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5740        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5741     COMPUTE WK3 = WK3 + WK5-CSL
  5742     MOVE WK3                    TO CP-CALC-PREMIUM
  5743     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5744     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5745        / (1 + K)
  5746     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5747          ** ((N - M) * -1))) / I)
  5748     COMPUTE WK2 = (1 + K) ** (M * -1)
  5749     COMPUTE ANGLEN-M = ANGLEN-M * WK2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 105
* ELRATE.cbl
  5750     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5751     COMPUTE ANGLEM = ((1 - ((1 + K)
  5752          ** (M * -1))) / K) / Y
  5753*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5754     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5755        ((1 + K) ** (M + 1 / Y
  5756        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5757        - 1)) / K) * RA
  5758     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5759        + (CP-DAYS-TO-1ST-PMT - +30)
  5760        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5761        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5762     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5763        * (12 / 12)
  5764     MOVE WK3                    TO CP-LF-PREM
  5765
  5766     GO TO 99999-RETURN
  5767
  5768     .
  5769 12001-CONTINUE-NET.
  5770
  5771     IF NET-STD
  5772        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  5773*          OR 'DCC'
  5774         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5775         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5776         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5777         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5778                               * ((1 + N) / (1 + M))
  5779        ELSE
  5780         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5781         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5782         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5783         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  5784
  5785     IF NET-SMP
  5786         COMPUTE N2 = N * N
  5787         COMPUTE N3 = N2 * N
  5788         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  5789         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  5790         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  5791         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  5792         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  5793
  5794     IF NPO-PRUDENTIAL
  5795       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  5796           VARYING WS-COUNTER FROM 1 BY 1
  5797               UNTIL WS-COUNTER = N
  5798       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  5799       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  5800
  5801     MOVE WK3 TO FACTOR.
  5802
  5803     GO TO 99999-RETURN.
  5804
  5805 12100-PRU-CALC.
  5806     IF WS-COUNTER = 1
  5807         COMPUTE PWK = (I + 1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-13 12:25 Page 106
* ELRATE.cbl
  5808     ELSE
  5809         COMPUTE PWK = PWK * (I + 1).
  5810
  5811 12199-EXIT.
  5812      EXIT.
  5813
  5814 99000-ERROR.
  5815     MOVE +9999.999999999 TO N-P-FACTOR.
  5816     MOVE '4'             TO CP-RETURN-CODE.
  5817
  5818     GO TO 99999-EXIT.
  5819
  5820 99999-RETURN.
  5821     MOVE FACTOR          TO N-P-FACTOR.
  5822
  5823 99999-EXIT.
  5824      EXIT.
  5825 99999-DUMMY-STOP-RUN.
  5826
  5827* GOBACK.
  5828     MOVE '9%                    "   ' TO DFHEIV0
  5829     MOVE 'ELRATE' TO DFHEIV1
  5830     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5831     GOBACK.
  5832
  5833
  5834 9999-DFHBACK SECTION.
  5835     MOVE '9%                    "   ' TO DFHEIV0
  5836     MOVE 'ELRATE' TO DFHEIV1
  5837     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5838     GOBACK.
  5839 9999-DFHEXIT.
  5840     IF DFHEIGDJ EQUAL 0001
  5841         NEXT SENTENCE
  5842     ELSE IF DFHEIGDJ EQUAL 2
  5843         GO TO 9999-RATE-NOTFND,
  5844               9999-RATE-NOTOPEN,
  5845               9999-RATE-NOTFND
  5846         DEPENDING ON DFHEIGDI.
  5847     MOVE '9%                    "   ' TO DFHEIV0
  5848     MOVE 'ELRATE' TO DFHEIV1
  5849     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5850     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2556     Code:       51893
