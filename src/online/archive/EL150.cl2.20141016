00001  IDENTIFICATION DIVISION.
00002
00003  PROGRAM-ID.                 EL150 .
00004 *              PROGRAM CONVERTED BY
00005 *              COBOL CONVERSION AID PO 5785-ABJ
00006 *              CONVERSION DATE 05/09/95 16:19:31.
00007 *                            VMOD=2.053
00008 *
00009 *AUTHOR.     LOGIC,INC.
00010 *            DALLAS, TEXAS.

00024 *REMARKS.    TRANSACTION - EX23 - STATUS DISPLAY AND DISPOSITION
00023 *
101501******************************************************************
101501*                   C H A N G E   L O G
101501*
101501* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
101501*-----------------------------------------------------------------
101501*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
101501* EFFECTIVE    NUMBER
101501*-----------------------------------------------------------------
101501* 101501    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
101501*                              ADJUST REDEFINES EL150AI FILLER
062602* 062602    2002030700006  PEMA  Add note type of 'S'
062602*                                  (special review)
121802* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
022106* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
050107* 050107    2007041300002  AJRA  PREVENT CHECK FOR NON COVERED CLAIMANT
080106* 080106    2006052500001  AJRA  ADD NOTE TYPE N 
041807* 041807    2006032200004  AJRA  ADD NOTE TYPE R
082707* 082707    2007032100001  PEMA  ADDITIONAL INTEREST CHANGES
102809* 102809    2008100900003  AJRA  PF19 TO NEW CERT NOTES SCREEN
042110* 042110  CR2008100900001  PEMA  ADD DENIAL TYPE
113010* 113010    2009122800001  AJRA  DISPLAY STOP DATE
061511* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
030612* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
020613* 020613  CR2012092400007  AJRA  VERIFY CAUSAL STATE
041613* 041613  CR2013031200002  AJRA  ADD MAIL RECEIVED ACTION TYPE
061013* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
031714* 031714    2014031200001  AJRA  ALLOW LEVEL 4 & 5 TO UPDATE TOT INT
051414* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
052614* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
101501******************************************************************

00025
00026  ENVIRONMENT DIVISION.
00027
00028      EJECT
00029  DATA DIVISION.
00030  WORKING-STORAGE SECTION.
00031  77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
00032  77  FILLER  PIC X(32)  VALUE '********************************'.
00033  77  FILLER  PIC X(32)  VALUE '*    EL150 WORKING STORAGE     *'.
00034  77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.053 *********'.
061013 77  a1                          pic s999 comp-3 value +0.
061013 77  p1                          pic s999 comp-3 value +0.
00035
00036                              COPY ELCSCTM.
00037
00038                              COPY ELCSCRTY.
00039
CIDMOD 01  TS-AREA.
CIDMOD     05  TS-PI-AREA          PIC X(1024) VALUE LOW-VALUES.
CIDMOD     05  TS-PI-SAVE-CLOAN    PIC X(25)   VALUE LOW-VALUES.
00040  01  WS-DATE-AREA.
00041      05  SAVE-DATE           PIC X(8)    VALUE SPACES.
00042      05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
00043
061013 01  ws-save-error-interface-block pic x(400) value low-values.

00044  01  STANDARD-AREAS.
CIDMOD     12  TS-LENGTH           PIC S9(4)  COMP VALUE +1049.
00045      12  WS-EARNING-METHOD   PIC X      VALUE SPACES.
00046      12  WS-INDEX            PIC S9(04) COMP VALUE +0.
00047      12  GETMAIN-SPACE       PIC X       VALUE SPACE.
061013     12  crtt-map            pic x(8)    value 'EL150T'.
061013     12  SAD-MAP             PIC X(8)    VALUE 'EL150A'.
00048      12  MAP-NAME            PIC X(8)    VALUE 'EL150A'.
00049      12  MAPSET-NAME         PIC X(8)    VALUE 'EL150S'.
00050      12  TRANS-ID            PIC X(4)    VALUE 'EX23'.
00051      12  THIS-PGM            PIC X(8)    VALUE 'EL150'.
00052      12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
00053      12  PGM-NAME            PIC X(8).
00054      12  TIME-IN             PIC S9(7).
00055      12  TIME-OUT-R  REDEFINES TIME-IN.
00056          16  FILLER          PIC X.
00057          16  TIME-OUT        PIC 99V99.
00058          16  FILLER          PIC XX.
00059      12  XCTL-005            PIC X(8)    VALUE 'EL005'.
00060      12  XCTL-010            PIC X(8)    VALUE 'EL010'.
00061      12  XCTL-126            PIC X(8)    VALUE 'EL126'.
00062      12  XCTL-1273           PIC X(8)    VALUE 'EL1273'.
00063      12  XCTL-EM1273         PIC X(8)    VALUE 'EM1273'.
00064      12  XCTL-131            PIC X(8)    VALUE 'EL131'.
00065      12  XCTL-132            PIC X(8)    VALUE 'EL132'.
00066      12  XCTL-EM131          PIC X(8)    VALUE 'EM131'.
00067      12  XCTL-141            PIC X(8)    VALUE 'EL141'.
00068      12  XCTL-142            PIC X(8)    VALUE 'EL142'.
00069      12  XCTL-1501           PIC X(8)    VALUE 'EL1501'.
00070      12  XCTL-1502           PIC X(8)    VALUE 'EL1502'.
00071      12  XCTL-151            PIC X(8)    VALUE 'EL151'.
00072      12  XCTL-152            PIC X(8)    VALUE 'EL152'.
00073      12  XCTL-153            PIC X(8)    VALUE 'EL153'.
00074      12  XCTL-154            PIC X(8)    VALUE 'EL154'.
00075      12  XCTL-156            PIC X(8)    VALUE 'EL156'.
00076      12  XCTL-EM156          PIC X(8)    VALUE 'EM156'.
00077      12  XCTL-EM1561         PIC X(8)    VALUE 'EM1561'.
           12  XCTL-1503           PIC X(8)    VALUE 'EL1503'.
00078      12  XCTL-155            PIC X(8)    VALUE 'EL155'.
00079      12  XCTL-157            PIC X(8)    VALUE 'EL157'.
00080      12  XCTL-158            PIC X(8)    VALUE 'EL158'.
00081      12  XCTL-162            PIC X(8)    VALUE 'EL162'.
00082      12  XCTL-1276           PIC X(8)    VALUE 'EL1276'.
00083      12  XCTL-EM1276         PIC X(8)    VALUE 'EM1276'.
102809     12  XCTL-1279           PIC X(8)    VALUE 'EL1279'.
00084      12  LINK-001            PIC X(8)    VALUE 'EL001'.
00085      12  LINK-004            PIC X(8)    VALUE 'EL004'.
00086      12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
00087      12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
00088      12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
00089      12  FILE-ID             PIC X(8).
00090      12  EMPHST-FILE-ID      PIC X(8)    VALUE 'MPPHST'.
00091      12  SC-ITEM             PIC S9(4)   VALUE +0001   COMP.
00092
00093  01  WS-HISTORY-AREA                 PIC X(50).
00094  01  WS-FLD1            REDEFINES WS-HISTORY-AREA.
00095      12  FILLER                 PIC X(38).
00096      12  WS-NUMERIC-FLD1        PIC S9(10)V99.
00097  01  WS-FLD2            REDEFINES WS-HISTORY-AREA.
00098      12  FILLER                 PIC X(45).
00099      12  WS-NUMERIC-FLD2        PIC S99V999.
00100  01  WS-FLD3            REDEFINES WS-HISTORY-AREA.
00101      12  FILLER                 PIC X(35).
00102      12  WS-NUMERIC-FLD3        PIC S9(15).
00103  01  WS-FLD4            REDEFINES WS-HISTORY-AREA.
00104      12  FILLER                 PIC X(36).
00105      12  WS-NUMERIC-FLD4        PIC S9(10)V9999.
00106
00107  01  MISC-WORK-AREAS.
00108      12  QID.
00109          16  QID-TERM        PIC X(4).
00110          16  FILLER          PIC X(4)    VALUE '150A'.
00111      12  MAP-LENGTH          PIC S9(4)   VALUE +1920   COMP.
00112      12  PASS-SWITCH         PIC X       VALUE 'A'.
00113      12  SV-LAST-BY          PIC X(4)    VALUE SPACES.
00114      12  SV-LAST-HHMMSS      PIC S9(6)   VALUE +0      COMP-3.
00115      12  SUB-1               PIC S9(4)   VALUE +0    COMP.
00116      12  DISPLAY-CNT         PIC S9(4)   VALUE +1    COMP.
00117      12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
00118      12  WS-SUB              PIC 9       VALUE 0.
00119      12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
00120      12  DIRECTION-SWITCH    PIC X       VALUE 'N'.
00121      12  WS-STATUS           PIC X.
00122      12  WS-LF-COVERAGE-TYPE PIC X       VALUE SPACE.
00123      12  WS-REMAINING-AMT    PIC S9(9)V99 VALUE +0.
00124      12  W-REMAINDER         PIC S9(3)    VALUE +0.
00125      12  WS-TERMS.
00126          16  WST-ORIG        PIC ZZ9.
00127          16  WST-ORIG-DAYS-GRP.
00128              20  WST-SLASH1  PIC X       VALUE '/'.
00129              20  WST-EXT-DAYS
00130                              PIC Z9.
00131          16  FILLER          PIC X       VALUE '/'.
00132          16  WST-REM         PIC ZZ9.
00133          16  WST-REM-DAYS-GRP.
00134              20  WST-SLASH2  PIC X       VALUE '/'.
00135              20  WST-REM-DAYS
00136                              PIC Z9.
00137      12  W-DAYS-PAID-X       PIC ZZZZ9.
00138      12  W-TOTAL-PAID-AMT-X  PIC ZZZZ,ZZZ.99.
00139      12  W-PAID-MONTHS       PIC S9(03)  COMP-3.
00140      12  W-PAID-DAYS         PIC S9(03)  COMP-3.
00141
00142      12  W-REM               PIC S999    COMP-3.
00143      12  W-REM-DAYS          PIC S999    COMP-3.
00144      12  W-TERM-IN-DAYS      PIC S9(4)   COMP-3.
00145      12  W-REM-TERM-IN-DAYS  PIC S9(4)   COMP-3.
00146
00147      12  W-PAYMENTS.
00148          16  W-PYMTS         PIC ZZ9.
00149          16  FILLER          PIC X       VALUE '/'.
00150          16  W-ADD-DAYS      PIC ZZ9.
00151      12  WS-ACCESS.
00152          16  FILLER          PIC XX      VALUE SPACES.
00153          16  WS-BEN-CD       PIC XX.
00154      12  WS-STATE-ACCESS.
00155          16  WS-ST-ACCESS    PIC XX.
00156          16  FILLER          PIC XX      VALUE SPACES.
00157      12  WS-CLAIM-SEQUENCE.
00158          16  FILLER          PIC X       VALUE '('.
00159          16  WS-CUR-SEQU     PIC Z9      VALUE ZEROS.
00160          16  FILLER          PIC X(04)   VALUE ' OF '.
00161          16  WS-OF-SEQU      PIC Z9      VALUE ZEROS.
00162          16  FILLER          PIC X       VALUE ')'.
00163
00164      12  WS-PURGED-MESSAGE.
00165          16  WS-PURGED-MSG       PIC X(18)    VALUE SPACES.
00166          16  WS-PURGED-DATE      PIC X(08)    VALUE SPACES.
00167
00168      12  SAVE-CONTROL        PIC X(39).
00169      12  WS-ERACCT-SAVE-KEY      PIC X(20) VALUE SPACES.
00170      12  WS-ERACCT-HOLD-RECORD   PIC X(2000) VALUE SPACES.
00171
00172      12  SUB                 PIC 99      VALUE ZEROS.
00173
00174      12  WS-ACTIVITY-CODE    PIC 99      VALUE ZEROS.
00175          88  VALID-ACTIVITY-CODE         VALUE 00, 10 THRU 17.
00176
00177      12  WS-ACT-REC-FOUND-SW PIC X       VALUE 'N'.
00178      12  WS-LETTER-SW        PIC X       VALUE 'N'.
00179      12  WS-BROWSE-SW        PIC X       VALUE 'N'.
00180      12  WS-BROWSE-START-SW  PIC X       VALUE ' '.
00181      12  WS-UPDATE-SW        PIC X       VALUE 'N'.
00182
00183      12  WS-ACT-USER-DESC.
00184          16  WS-DESC-1-3     PIC X(03)   VALUE SPACES.
00185          16  FILLER          PIC X(17)   VALUE SPACES.
00186
00187      12  WS-CERT-READ-SW     PIC X       VALUE 'N'.
00188      12  WS-LOAN-EXPIRE-DT   PIC X(08)   VALUE SPACES.
00189      12  W-CLAIM-MASTER-SAVE PIC X(350)  VALUE SPACES.
00190
00191      12  WS-PMT-AMTD.
00192          16  WS-PMT-AMT      PIC Z(4).99-.
00193
00194      12  WS-RESPONSE         PIC S9(8)   COMP.
00195          88  WS-RESP-NORMAL              VALUE +00.
00196          88  WS-RESP-NOTFND              VALUE +13.
00197
061013 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
061013     88  PDEF-FOUND                   VALUE 'Y'.
061013 01  ERPDEF-KEY-SAVE             PIC X(18).
061013 01  ERPDEF-KEY.
061013     12  ERPDEF-COMPANY-CD       PIC X.
061013     12  ERPDEF-STATE            PIC XX.
061013     12  ERPDEF-PROD-CD          PIC XXX.
061013     12  F                       PIC X(7).
061013     12  ERPDEF-BEN-TYPE         PIC X.
061013     12  ERPDEF-BEN-CODE         PIC XX.
061013     12  ERPDEF-EXP-DT           PIC XX.
061013
061013 01  ELCRTT-KEY.                                              
061013     05  CTRLR-COMP-CD       PIC X.                               
061013     05  CTRLR-CARRIER       PIC X.                               
061013     05  CTRLR-GROUPING      PIC X(6).                            
061013     05  CTRLR-STATE         PIC X(2).                            
061013     05  CTRLR-ACCOUNT       PIC X(10).
061013     05  CTRLR-EFF-DT        PIC XX.                              
061013     05  CTRLR-CERT-NO       PIC X(11).  
061013     05  CTRLR-REC-TYPE      PIC X.

00198  01  ACCESS-KEYS.
00199      12  ERACCT-KEY.
00200          16  ERACCT-PARTIAL-KEY.
00201              20  ACCT-COMP-CD    PIC X.
00202              20  ACCT-CARRIER    PIC X.
00203              20  ACCT-GROUPING   PIC X(6).
00204              20  ACCT-STATE      PIC XX.
00205              20  ACCT-ACCOUNT    PIC X(10).
00206          16  ACCT-EXP-DT         PIC XX.
00207          16  FILLER              PIC X(04).
00208      12  ELMSTR-KEY.
00209          16  MSTR-COMP-CD    PIC X.
00210          16  MSTR-CARRIER    PIC X.
00211          16  MSTR-CLAIM-NO   PIC X(7).
00212          16  MSTR-CERT-NO.
00213              20  MSTR-CERT-NO-PRIME  PIC X(10).
00214              20  MSTR-CERT-NO-SUFX   PIC X.
00215      12  W-ELRETR-KEY.
00216          16  W-RET-COMP-CD       PIC  X.
00217          16  W-RET-CARRIER       PIC  X.
00218          16  W-RET-CLAIM-NO      PIC  X(07).
00219          16  W-RET-CERT-NO.
00220              20  W-RET-CERT-PRIME
00221                                  PIC  X(10).
00222              20  W-RET-CERT-SUFX PIC  X.
00223      12  ELCNTL-KEY.
00224          16  CNTL-COMP-ID    PIC X(3).
00225          16  CNTL-REC-TYPE   PIC X.
00226          16  CNTL-ACCESS.
00227              20  FILLER      PIC XX.
00228              20  CNTL-BEN-NO PIC XX.
00229          16  CNTL-SEQ-NO     PIC S9(4)    COMP.
00230      12  ELCERT-KEY.
00231          16  CERT-COMP-CD    PIC X.
00232          16  CERT-CARRIER    PIC X.
00233          16  CERT-GROUPING   PIC X(6).
00234          16  CERT-STATE      PIC XX.
00235          16  CERT-ACCOUNT    PIC X(10).
00236          16  CERT-EFF-DT     PIC XX.
00237          16  CERT-CERT-NO.
00238              20  CERT-CERT-NO-PRIME PIC X(10).
00239              20  CERT-CERT-NO-SUFX  PIC X.
00240      12  ELTRLR-KEY.
00241          16  TRLR-COMP-CD    PIC X.
00242          16  TRLR-CARRIER    PIC X.
00243          16  TRLR-CLAIM-NO   PIC X(7).
00244          16  TRLR-CERT-NO.
00245              20  TRLR-CERT-NO-PRIME PIC X(10).
00246              20  TRLR-CERT-NO-SUFX  PIC X.
00247          16  TRLR-SEQ-NO     PIC S9(4)   COMP.
00240      12  ws-ELTRLR-KEY.
00241          16  ws-TRLR-COMP-CD    PIC X.
00242          16  ws-TRLR-CARRIER    PIC X.
00243          16  ws-TRLR-CLAIM-NO   PIC X(7).
00244          16  ws-TRLR-CERT-NO.
00245              20  ws-TRLR-CERT-NO-PRIME PIC X(10).
00246              20  ws-TRLR-CERT-NO-SUFX  PIC X.
00247          16  ws-TRLR-SEQ-NO     PIC S9(4)   COMP.
00248      12  ELACTQ-KEY.
00249          16  ACTQ-COMP-CD    PIC X.
00250          16  ACTQ-CARRIER    PIC X.
00251          16  ACTQ-CLAIM-NO   PIC X(7).
00252          16  ACTQ-CERT-NO.
00253              20  ACTQ-CERT-NO-PRIME PIC X(10).
00254              20  ACTQ-CERT-NO-SUFX  PIC X.
00255      12  ELARCH-KEY.
00256          16  ARCH-COMP-CD        PIC X.
00257          16  ARCH-ARCHIVE-NO     PIC S9(08)  COMP.
00258          16  ARCH-RECORD-TYPE    PIC X.
00259          16  ARCH-SEQ-NO         PIC S9(04)  COMP.
00260
00261      12  EMPLCY-KEY.
00262          16  PLCY-COMP-CD            PIC X.
00263          16  PLCY-CARRIER            PIC X.
00264          16  PLCY-GROUPING           PIC X(06).
00265          16  PLCY-STATE              PIC XX.
00266          16  PLCY-PRODUCER           PIC X(10).
00267          16  PLCY-EFF-DT             PIC XX.
00268          16  PLCY-REFERENCE-NO.
00269              20  PLCY-REFNO-PRIME    PIC X(18).
00270              20  PLCY-REFNO-SFX      PIC XX.
00271
00272      12  EMPHST-KEY.
00273          16  EMPHST-COMPANY-CD       PIC X.
00274          16  EMPHST-CARRIER          PIC X.
00275          16  EMPHST-GROUPING         PIC X(06).
00276          16  EMPHST-STATE            PIC XX.
00277          16  EMPHST-PRODUCER         PIC X(10).
00278          16  EMPHST-POLICY-EFF-DT    PIC XX.
00279          16  EMPHST-REFERENCE-NUMBER.
00280              20  EMPHST-REFNO-PRIME  PIC X(18).
00281              20  EMPHST-REFNO-SFX    PIC XX.
00282          16  EMPHST-RECORD-TYPE      PIC XX.
00283          16  EMPHST-FIELD-TYPE       PIC XX.
00284          16  EMPHST-SEQUENCE-NO      PIC S9(04) COMP.
00285
00286      12  EMPLAN-KEY.
00287          16  PLAN-COMP-CD            PIC X.
00288          16  PLAN-CARRIER            PIC X.
00289          16  PLAN-GROUPING           PIC X(06).
00290          16  PLAN-STATE              PIC XX.
00291          16  PLAN-PRODUCER           PIC X(10).
00292          16  PLAN-PLAN-CODE          PIC XX.
00293          16  PLAN-REV-NO             PIC 9(03).
00294
00295      12  EMPROD-KEY.
00296          16  EMPROD-PARTIAL-KEY.
00297              20  PROD-COMP-CD        PIC X.
00298              20  PROD-CARRIER        PIC X.
00299              20  PROD-GROUPING       PIC X(06).
00300              20  PROD-STATE          PIC XX.
00301              20  PROD-PRODUCER       PIC X(10).
00302          16  PROD-EXP-DT             PIC XX.
00303
00304  01  TRAILER-DISPLAY-WORK-AREA.
00305      12  DISPLAY-ACTION.
00306          16  DISP-ACT-A      PIC X(10).
00307          16  DISP-ACT-B      PIC X(4).
00308      12  FILLER              PIC X.
00309      12  DISPLAY-BY          PIC X(4).
00310      12  FILLER              PIC X.
00311      12  DISPLAY-DATE        PIC X(8).
00312      12  FILLER              PIC X.
00313      12  DISPLAY-SEQ         PIC Z(4).
00314      12  FILLER              PIC X.
00315      12  DISPLAY-TEXT        PIC X(45).
00316      EJECT
00317  01  ERROR-MESSAGES.
00318      05  ER-0000                 PIC X(4) VALUE '0000'.
00319      05  ER-0004                 PIC X(4) VALUE '0004'.
00320      05  ER-0008                 PIC X(4) VALUE '0008'.
00321      05  ER-0029                 PIC X(4) VALUE '0029'.
00322      05  ER-0033                 PIC X(4) VALUE '0033'.
00323      05  ER-0042                 PIC X(4) VALUE '0042'.
00324      05  ER-0068                 PIC X(4) VALUE '0068'.
00325      05  ER-0070                 PIC X(4) VALUE '0070'.
00326      05  ER-0130                 PIC X(4) VALUE '0130'.
00327      05  ER-0154                 PIC X(4) VALUE '0154'.
00328      05  ER-0168                 PIC X(4) VALUE '0168'.
00329      05  ER-0169                 PIC X(4) VALUE '0169'.
00330      05  ER-0172                 PIC X(4) VALUE '0172'.
00331      05  ER-0190                 PIC X(4) VALUE '0190'.
00332      05  ER-0204                 PIC X(4) VALUE '0204'.
00333      05  ER-0206                 PIC X(4) VALUE '0206'.
00334      05  ER-0303                 PIC X(4) VALUE '0303'.
00335      05  ER-0334                 PIC X(4) VALUE '0334'.
00336      05  ER-0335                 PIC X(4) VALUE '0335'.
00337      05  ER-0336                 PIC X(4) VALUE '0336'.
00338      05  ER-0337                 PIC X(4) VALUE '0337'.
00339      05  ER-0338                 PIC X(4) VALUE '0338'.
00340      05  ER-0376                 PIC X(4) VALUE '0376'.
00341      05  ER-0412                 PIC X(4) VALUE '0412'.
00342      05  ER-0413                 PIC X(4) VALUE '0413'.
050107     05  ER-0433                 PIC X(4) VALUE '0433'.
050107     05  ER-0500                 PIC X(4) VALUE '0500'.
00343      05  ER-0802                 PIC X(4) VALUE '0802'.
00344      05  ER-0803                 PIC X(4) VALUE '0803'.
00345      05  ER-0804                 PIC X(4) VALUE '0804'.
00346      05  ER-0926                 PIC X(4) VALUE '0926'.
00347      05  ER-0927                 PIC X(4) VALUE '0927'.
00348      05  ER-0928                 PIC X(4) VALUE '0928'.
00349      05  ER-0929                 PIC X(4) VALUE '0929'.
00350      05  ER-0931                 PIC X(4) VALUE '0931'.
00351      05  ER-0932                 PIC X(4) VALUE '0932'.
00352      05  ER-0933                 PIC X(4) VALUE '0933'.
00353      05  ER-0934                 PIC X(4) VALUE '0934'.
00354      05  ER-0935                 PIC X(4) VALUE '0935'.
00355      05  ER-0936                 PIC X(4) VALUE '0936'.
00356      05  ER-0937                 PIC X(4) VALUE '0937'.
00357      05  ER-2378                 PIC X(4) VALUE '2378'.
00358      05  ER-2379                 PIC X(4) VALUE '2379'.
00359      05  ER-2848                 PIC X(4) VALUE '2848'.
00360      05  ER-3516                 PIC X(4) VALUE '3516'.
00361      05  ER-3526                 PIC X(4) VALUE '3526'.
00362      05  ER-3545                 PIC X(4) VALUE '3545'.
050107     05  ER-3550                 PIC X(4) VALUE '3550'.
00363      05  ER-9483                 PIC X(4) VALUE '9483'.
00364      05  ER-9808                 PIC X(4) VALUE '9808'.
00365      05  ER-9883                 PIC X(4) VALUE '9883'.
00366      05  ER-9886                 PIC X(4) VALUE '9886'.
00367
00368  01  TEXT-WORK-AREAS.
00369      12  PAYMENT-TEXT.
00370          16  PMT-VAR         PIC X(8).
00371          16  PMT-PD-THRU     PIC X(8).
00372          16  FILLER          PIC X(7)    VALUE ' CHECK='.
00373          16  PMT-CHECK-NO    PIC X(7).
00374          16  FILLER          PIC X(5)    VALUE ' AMT='.
00375          16  PMT-AMOUNT      PIC Z(6).99-.
00376
00377      12  AUTO-PMT-TEXT.
00378          16  FILLER          PIC X(6)    VALUE 'START='.
00379          16  AUTO-START      PIC X(8).
00380          16  FILLER          PIC X(5)    VALUE ' END='.
00381          16  AUTO-END        PIC X(8).
00382          16  FILLER          PIC X(8)    VALUE ' AMOUNT='.
00383          16  AUTO-AMOUNT     PIC Z(6).99-.
00384
00385      12  AUTO-TERM-TEXT.
00386          16  FILLER          PIC X(11)   VALUE 'TERMINATED='.
00387          16  AUTO-TERMINATED PIC X(8).
00388          16  FILLER          PIC X(8)    VALUE SPACES.
00389          16  FILLER          PIC X(8)    VALUE ' AMOUNT='.
00390          16  AUTO-TERM-AMT   PIC Z(6).99-.
00391
00392      12  CORRESPONDENCE-TEXT.
00393          16  FILLER          PIC X(3)    VALUE 'TO='.
00394          16  CORR-TO         PIC X(8).
113010         16  CORR-RECVD-LIT  PIC X(8)    VALUE '  RECVD='.
00396          16  CORR-RECVD      PIC X(8).
00397          16  CORR-VAR        PIC X(9).
00398          16  CORR-RESENT     PIC X(8).
00399          16  CORR-ARCH-NO REDEFINES CORR-RESENT PIC 9(8).
00400
00401      12  PROMPT-TEXT.
00402          16  FILLER          PIC X(4)    VALUE 'END='.
00403          16  PROMPT-END      PIC X(8).
00404          16  FILLER          PIC XX      VALUE SPACES.
00405          16  PROMPT-MSG      PIC X(31).
00406
00407      12  DENIAL-TEXT.
00408          16  FILLER          PIC X(5)    VALUE 'DATE='.
00409          16  DENIAL-DATE     PIC X(8).
00410          16  FILLER          PIC X(6)    VALUE ' CODE='.
00411          16  DENIAL-CODE     PIC X(4).
00412          16  FILLER          PIC XX      VALUE SPACES.
00413          16  DENIAL-MSG      PIC X(20).
00414
00415      12  RECONSIDERED-TEXT.
00416          16  FILLER          PIC X(7)    VALUE 'DENIED '.
00417          16  DENIED-DATE     PIC X(8).
00418          16  FILLER          PIC X(15)   VALUE '  RECONSIDERED '.
00419          16  RECONSIDERED-DATE  PIC X(8).
00420
00421      12  INCUR-TEXT.
00422          16  FILLER          PIC X(6)    VALUE 'INCUR='.
00423          16  INCUR-DT        PIC X(8).
00424          16  PDTHRU-HEAD     PIC X(9)    VALUE ' PD THRU='.
00425          16  INCUR-PDTHRU    PIC X(8).
00426          16  FILLER          PIC X(4)    VALUE ' PD='.
00427          16  INCUR-PAID      PIC Z(6).99-.
00428
00429      12  LOAN-TEXT.
00430          16  FILLER          PIC X(5)    VALUE 'LOAN='.
00431          16  LOAN-NUMBER     PIC X(8).
00432          16  FILLER          PIC X(5)    VALUE ' BAL='.
00433          16  LOAN-BALANCE    PIC Z(7).99-.
00434          16  FILLER          PIC X(4)    VALUE ' ME='.
00435          16  LOAN-MEMBER     PIC X(12).
00436
00437      12  ASSOC-LOAN-TEXT.
00438          16  FILLER          PIC X(11)   VALUE
00439                  'ORIG/CUR : '.
00440          16  ASSOC-ORIG-LOAN PIC X(08)   VALUE SPACES.
00441          16  FILLER          PIC X       VALUE SPACES.
00442          16  ASSOC-CUR-LOAN  PIC X(12)   VALUE SPACES.
00443          16  FILLER          PIC XX      VALUE SPACES.
00444          16  ASSOC-LOAN-TYPE PIC XX      VALUE SPACES.
00445          16  FILLER          PIC X(09)   VALUE SPACES.
00446
00447      12  ASSOC-CV-LOAN-TEXT.
00448          16  FILLER          PIC X(11)   VALUE
00449                  'LOAN NO. : '.
00450          16  ASSOC-CV-LOAN   PIC X(20)   VALUE SPACES.
00451          16  FILLER          PIC X(14)   VALUE SPACES.
00452
00453  01  PAYMENT-DESCRIPTION-TABLE.
00454      12  FILLER              PIC X(14)   VALUE 'PARTIAL PMT   '.
00455      12  FILLER              PIC X(14)   VALUE 'FINAL PMT     '.
00456      12  FILLER              PIC X(14)   VALUE 'LUMP SUM PMT  '.
00457      12  FILLER              PIC X(14)   VALUE 'ADDITIONAL PMT'.
00458      12  FILLER              PIC X(14)   VALUE 'CHARGEABLE EXP'.
00459      12  FILLER              PIC X(14)   VALUE 'NON-CHG EXP   '.
00460      12  FILLER              PIC X(14)   VALUE 'LIFE PRM RFND '.
00461      12  FILLER              PIC X(14)   VALUE 'A/H PRM RFND  '.
00462      12  FILLER              PIC X(14)   VALUE 'ENTRY CORRECT '.
00463  01  PAYMENT-DESC-R   REDEFINES PAYMENT-DESCRIPTION-TABLE.
022106     12  PAY-DESC            PIC X(14)   OCCURS 9.
00465
00466  01  CV-PAYMENT-DESCRIPTION-TABLE.
00467      12  FILLER              PIC X(14)   VALUE 'FULL DEATH    '.
00468      12  FILLER              PIC X(14)   VALUE 'HALF DEATH    '.
00469      12  FILLER              PIC X(14)   VALUE 'FULL AD&D     '.
00470      12  FILLER              PIC X(14)   VALUE 'HALF AD&D     '.
00471      12  FILLER              PIC X(14)   VALUE 'FULL RIDER    '.
00472      12  FILLER              PIC X(14)   VALUE 'HALF RIDER    '.
00473      12  FILLER              PIC X(14)   VALUE 'NON-CHG EXP   '.
00474      12  FILLER              PIC X(14)   VALUE 'ADDITIONAL    '.
00475  01  CV-PAYMENT-DESC-R REDEFINES CV-PAYMENT-DESCRIPTION-TABLE.
00476      12  CV-PAY-DESC         PIC X(14)   OCCURS 2.
00477
00478  01  CORRESPONDENCE-TO-DESCRIPTIONS.
00479      12  FILLER              PIC X(8)    VALUE 'INSURED '.
00480      12  FILLER              PIC X(8)    VALUE 'BENEF   '.
00481      12  FILLER              PIC X(8)    VALUE 'ACCOUNT '.
00482      12  FILLER              PIC X(8)    VALUE 'DOCTOR  '.
00483      12  FILLER              PIC X(8)    VALUE 'EMPLOYER'.
00484      12  FILLER              PIC X(8)    VALUE 'OTHER1  '.
00485      12  FILLER              PIC X(8)    VALUE 'OTHER2  '.
00486  01  CORR-TO-DESC   REDEFINES CORRESPONDENCE-TO-DESCRIPTIONS.
00487      12  CORR-DESC           PIC X(8)    OCCURS 2.
00488
00489  01  W-CONFIDENTIAL-TEXT.
00490      12  W-CONF-LENGTH       PIC S9(4)   VALUE +185   COMP.
00491      12  W-CONF-TEXT.
00492          16  FILLER.
00493              20  W-CONF-PGM  PIC X(8)    VALUE 'EL150'.
00494              20  FILLER      PIC X       VALUE SPACES.
00495              20  FILLER      PIC X(71)   VALUE
00496      '******THIS IS A CONFIDENTIAL CLAIM!!!!!*****'.
00497          16  FILLER          PIC X(8)    VALUE SPACES.
00498          16  FILLER          PIC X(71)   VALUE
00499       '******PRESS ENTER TO RETURN TO SCREEN.******'.
00500          16  FILLER          PIC X(26)   VALUE SPACES.
00501 *        16  FILLER          PIC X(7)    VALUE '* LOGIC'.
00502 *        16  FILLER          PIC X       VALUE QUOTE.
00503 *        16  W-CONF-SYS-MSG  PIC X(17)
00504 *          VALUE 'S CLAS-IC SYSTEM '.
00505
00506      EJECT
061013                             copy ERCPDEF.
00507                              COPY ELCNWA.
00508      EJECT
00509                              COPY ELCDATE.
00510      EJECT
00511                              COPY ELCCALC.
00512      EJECT
00513                              COPY ELCLOGOF.
00514      EJECT
00515                              COPY ELCATTR.
00516      EJECT
00517                              COPY ELCMSTR.
00518      EJECT
00519                              COPY ELCEMIB.
00520      EJECT
00521                              COPY ELCLNKLT.
00522      EJECT
00523                              COPY ELCINTF.
00524      12  PI-REDEF    REDEFINES PI-PROGRAM-WORK-AREA.
00525          16  PI-PASS-AREA        PIC  S9(4) COMP.
00526          16  PI-EL142-PRIORITY   PIC  X.
061013         16  pi-save-map         pic x(8).
061013         16  pi-max-benefit      pic s9(7)v99 comp-3.
031714         16  PI-APPROVAL-LEVEL   PIC X.
031714         16  f                   pic x(197).
061013*        16  FILLER              PIC  X(211).
00528          16  PI-CURRENT-FILE     PIC  X(08).
00529          16  PI-ORIGINAL-ASS-CERT
00530                                  PIC  X(20).
00531          16  PI-TOTAL-PAID       PIC S9(07)V99 COMP-3.
00532          16  PI-DAYS-PAID        PIC S9(05) COMP-3.
00533          16  PI-LAST-SEQ-NO      PIC S9(03) COMP-3.
00534          16  PI-LAST-PF-KEY-IND  PIC  X.
00535              88  PI-PF15-LAST            VALUE 'F'.
00536              88  PI-PF16-LAST            VALUE 'S'.
00537          16  PI-ASSOCIATED-PROCESS-IND
00538                                  PIC  X.
00539              88  PI-ASS-PROCESSING       VALUE 'Y'.
00540              88  PI-NOT-ASS-PROCESSING   VALUE SPACES LOW-VALUES.
00541          16  PI-ASS-NDX          PIC S9(04) COMP.
00542          16  PI-ASSOCIATED-CERTS-TABLE.
00543              20  PI-ASS-CERTS OCCURS 24 TIMES
00544                                  PIC  X(11).
050107*00545          16  FILLER              PIC  X(10).
050107         16  FILLER              PIC  X(05).
050107         16  PI-FORCE-COUNT      PIC  99.
050107         16  PI-PFKEY-USED       PIC  X.
050107         16  PI-JOINT-COV-IND    PIC  X.
050107             88  PI-JOINT-COVERAGE       VALUE 'J'.
050107             88  PI-SINGLE-COVERAGE      VALUE ' '.
050107         16  PI-JOINT-INSURED-IND PIC X.
050107             88  PI-JOINT-INSURED        VALUE 'Y'.
050107             88  PI-PRIMARY-INSURED      VALUE 'N'.
00546          16  PI-PRIORITY-CD      PIC  X.
00547              88  PI-PRIORITY-9           VALUE '9'.
00548          16  PI-STATUS-IND       PIC  X.
00549              88  PI-CLOSED               VALUE 'C'.
00550              88  PI-OPEN                 VALUE 'O'.
00551          16  PI-LAST-CLOSE-REASON-IND
00552                                  PIC  X.
00553              88  PI-BENEFIT-CHANGE       VALUE 'C'.
00554              88  PI-ERROR-CORRECTION     VALUE 'E'.
00555          16  PI-PRIORITY-IND     PIC  X.
00556              88  PI-SUPERVISOR-ONLY      VALUE 'S'.
00557              88  PI-CONFIDENTIAL-UP      VALUE 'C'.
00558          16  PI-RETRIEVED-DATA-IND
00559                                  PIC  X.
00560              88  PI-RETRIEVED-DATA       VALUE 'Y'.
00561 *        16  PI-SAVE             PIC  X(227).
00562          16  PI-SAVE-TYPE        PIC  X.
00563          16  PI-SAVE-FILETO      PIC  X(4).
00564          16  PI-SAVE-PRTOPT      PIC  X.
00565          16  PI-SAVE-FORMAT      PIC  X.
00566          16  PI-SAVE-FORM        PIC  X(12).
00567          16  PI-PREV-DISP        PIC  X.
00568          16  PI-PREV-DIR         PIC  X.
00569          16  PI-SAVE-CURSOR      PIC S9(04) COMP.
00570          16  PI-SAVE-CNT         PIC S9(04) COMP.
00571          16  PI-SAVE-LOW         PIC S9(04) COMP.
00572          16  PI-SAVE-HIGH        PIC S9(04) COMP.
00573          16  PI-PREV-CLAIM.
00574              20  PI-PREV-COMP-CD PIC X.
00575              20  PI-PREV-CARRIER PIC X.
00576              20  PI-PREV-CLAIM-NO PIC X(7).
00577              20  PI-PREV-CERT-NO.
00578                  24  PI-PREV-CERT-NO-PRIME
00579                                  PIC X(10).
00580                  24  PI-CERT-NO-SUFX   PIC X.
00581          16  PI-PREV-PRIME-CERT-NO
00582                                  PIC X(11).
00583          16  PI-PURGED-SW        PIC  X.
00584              88  CLAIM-IS-PURGED         VALUE 'Y'.
00585          16  PI-PREV-CLMNO       PIC  X(07).
00586          16  PI-SAVE-MCRFLM      PIC  X(10).
00587          16  PI-PREV-TRLR-KEY    PIC  X(22).
00588          16  PI-SAVE-ACT-CD      PIC  XX.
00589          16  PI-SAVE-ASSOC       PIC  X.
00590          16  PI-SAVE-SYS-ID      PIC  XX.
CIDMOD*        16  PI-SAVE-CLOAN       PIC  X(25).
00591      EJECT
00592                              COPY ELCJPFX.
00593                              PIC X(750).
00594      EJECT
00595                              COPY ELCAID.
00596  01  FILLER    REDEFINES DFHAID.
00597      12  FILLER              PIC X(8).
00598      12  PF-VALUES           PIC X       OCCURS 24 TIMES.
00599      EJECT
00600                              COPY EL150S.
00601  01  EL150AI-R REDEFINES EL150AI.
CIDMOD*    12  FILLER              PIC X(665).
101501*    12  FILLER              PIC X(706).
042110     12  FILLER              PIC X(738).
00603      12  EL150AI-OCCURS         OCCURS 4 TIMES.
00604          16  FILLER          PIC X(3).
00605          16  MAP-DISPLAY     PIC X(79).
00606      12  FILLER              PIC X(40).
00607
00608      EJECT
00609  LINKAGE SECTION.
00610  01  DFHCOMMAREA             PIC X(1024).
00611
00612  01  CLAIM-MASTER-L          PIC X(350).
00613      EJECT
00614                              COPY ELCCNTL.
00615      EJECT
00616                              COPY ELCCERT.
00617      EJECT
00618                              COPY ELCTRLR.
00619      EJECT
00620                              COPY ELCACTQ.
00621      EJECT
00622                              COPY ERCACCT.
00623      EJECT
00624                              COPY ELCARCH.
061013                             copy ELCCRTT.
00625      EJECT
00626                  COPY MTCPLCY REPLACING ==:TAG:== BY ==PM==.
00627      EJECT
00628                  COPY MTCPLAN REPLACING ==:TAG:== BY ==PP==.
00629      EJECT
061013                 COPY MTCPROD REPLACING ==:TAG:== BY ==PDM==.
00631      EJECT
00632                              COPY ELCRETR.
00633      EJECT
00634                  COPY MTCPHST REPLACING ==:TAG:== BY ==PH==.
00635      EJECT
00636  PROCEDURE DIVISION.
00637
00638      MOVE EIBDATE                TO DC-JULIAN-YYDDD.
00639      MOVE '5'                    TO DC-OPTION-CODE.
00640      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
00641      MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
00642      MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
00643
00644      IF EIBCALEN = 0
00645          GO TO 8800-UNAUTHORIZED-ACCESS.
00646
00647      MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
00648
00649      IF PI-COMPANY-ID NOT = 'DMD'
00650          MOVE SPACES             TO WST-REM-DAYS-GRP
00651                                     WST-ORIG-DAYS-GRP.
00652
00653      MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
00654      MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
00655
00656      MOVE EIBTRMID               TO QID-TERM.
00657
00658      EXEC CICS HANDLE CONDITION
00659          QIDERR   (1000-SHOW-CLAIM)
00660          MAPFAIL  (0100-FIRST-TIME-IN)
00661          NOTOPEN  (8500-FILE-NOTOPEN)
00662          PGMIDERR (9600-PGMID-ERROR)
00663          ERROR    (9990-ABEND)
00664      END-EXEC.
00665
00666      IF PI-RETURN-TO-PROGRAM = THIS-PGM
00667          MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
00668
00669      IF PI-CALLING-PROGRAM NOT = THIS-PGM
00670          IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
00671              MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
00672              MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
00673              MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
00674              MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
00675              MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
00676              MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
00677              MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
00678              MOVE THIS-PGM             TO PI-CALLING-PROGRAM
00679          ELSE
00680              MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
00681              MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
00682              MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
00683              MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
00684              MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
00685              MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
00686              MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
00687              MOVE SPACES               TO PI-SAVED-PROGRAM-6.
00688
00689      IF (RETURNED-FROM NOT = SPACES)
061013        and (pi-save-map not = crtt-map)
00690          GO TO 0600-RECOVER-TEMP-STORAGE.
00691
00692      IF EIBAID = DFHCLEAR
00693          GO TO 9400-CLEAR.
00694
00695      IF PI-PROCESSOR-ID = 'LGXX'
00696          NEXT SENTENCE
00697      ELSE
00698          EXEC CICS READQ TS
00699              QUEUE   (PI-SECURITY-TEMP-STORE-ID)
00700              INTO    (SECURITY-CONTROL)
00701              LENGTH  (SC-COMM-LENGTH)
00702              ITEM    (SC-ITEM)
00703          END-EXEC
00704          MOVE SC-CLAIMS-DISPLAY (16)  TO  PI-DISPLAY-CAP
00705          MOVE SC-CLAIMS-UPDATE  (16)  TO  PI-MODIFY-CAP
00706          IF NOT DISPLAY-CAP
00707              MOVE 'READ'              TO  SM-READ
00708              PERFORM 9995-SECURITY-VIOLATION
00709              MOVE ER-0070             TO  EMI-ERROR
00710              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00711              GO TO 8100-SEND-INITIAL-MAP.
00712
00713      IF EIBTRNID = TRANS-ID
00714          GO TO 0200-RECEIVE.
00715
00716  0100-FIRST-TIME-IN.
00717
00718      MOVE LOW-VALUES             TO EL150AO.
00719
00720      IF NOT PI-CONFIDENTIAL-UP
00721          MOVE LOW-VALUES         TO PI-REDEF.
00722
00723      MOVE 'ELMSTR'               TO PI-CURRENT-FILE.
00724      MOVE ZEROS                  TO PI-TOTAL-PAID
00725                                     PI-DAYS-PAID
00726                                     PI-LAST-SEQ-NO.
050107
050107     MOVE 0                      TO PI-FORCE-COUNT.
031714
031714     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
031714     MOVE '2'                    TO CNTL-REC-TYPE.
031714     MOVE +0                     TO CNTL-SEQ-NO.
031714     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
031714     MOVE 'CNTL'                 TO FILE-SWITCH.
031714
031714     EXEC CICS READ
031714          DATASET  ('ELCNTL')
031714          SET      (ADDRESS OF CONTROL-FILE)
031714          RIDFLD   (ELCNTL-KEY)
031714          RESP     (WS-RESPONSE)
031714     END-EXEC.
031714
031714     IF WS-RESP-NORMAL
031714        MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL
031714     END-IF.
031714
00727
00728      EXEC CICS DELETEQ TS
00729          QUEUE(QID)
00730      END-EXEC.
00731
00732      GO TO 1000-SHOW-CLAIM.
00733
00734      EJECT
00735  0200-RECEIVE.
00736      MOVE 'B'                    TO PASS-SWITCH.
00737
00738      MOVE LOW-VALUES             TO EL150AI.
00739
00740      IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
00741          MOVE ER-0008            TO EMI-ERROR
00742          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00743          MOVE -1                 TO FILETOL
00744          GO TO 8200-SEND-DATAONLY.
00745
061013     if pi-save-map = crtt-map
061013        move pi-save-map to map-name
061013     end-if

00746      EXEC CICS RECEIVE
00747          MAP      (MAP-NAME)
00748          MAPSET   (MAPSET-NAME)
00749          INTO     (EL150AI)
00750      END-EXEC.
00751
061013     if pi-save-map = crtt-map
061013        move spaces              to pi-save-map
061013        move sad-map             to map-name
061013        go to 0100-first-time-in
061013     end-if

00752      IF ENTERPFL = 0
00753          GO TO 0300-CHECK-PFKEYS.
00754
00755      IF EIBAID NOT = DFHENTER
00756          MOVE ER-0004            TO EMI-ERROR
00757          GO TO 0320-INPUT-ERROR.
00758
00759      IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
00760          MOVE PF-VALUES (ENTERPFI) TO EIBAID
00761      ELSE
00762          MOVE ER-0029            TO EMI-ERROR
00763          GO TO 0320-INPUT-ERROR.
00764
00765  0300-CHECK-PFKEYS.
00766      IF EIBAID = DFHPF23
00767          GO TO 8810-PF23.
00768
00769      IF EIBAID = DFHPF24
00770          GO TO 9200-RETURN-MAIN-MENU.
00771
00772      IF EIBAID = DFHPF12
00773          GO TO 9500-PF12.
00774
050107     IF (EIBAID = DFHPF22) AND (NOT FORCE-CAP) 
050107         MOVE ER-0433            TO EMI-ERROR 
050107         GO TO 0320-INPUT-ERROR.           
050107
050107     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF22)
050107         MOVE ER-0500            TO EMI-ERROR              
050107         GO TO 0320-INPUT-ERROR.                        
050107
00775      IF PI-RETRIEVED-DATA
00776          IF EIBAID = DFHPF1  OR DFHPF2 OR DFHPF15 OR
00777                      DFHPF16 OR DFHPF21
00778              NEXT SENTENCE
00779          ELSE
00780              MOVE ER-0926        TO EMI-ERROR
00781              GO TO 0320-INPUT-ERROR.
00782
00783      IF EIBAID = DFHPF21
00784          IF NOT PI-RETRIEVED-DATA
00785              PERFORM 7650-CREATE-ACTQ THRU 7650-EXIT
00786              MOVE ER-0927        TO EMI-ERROR
00787              GO TO 0320-INPUT-ERROR
00788          ELSE
00789              GO TO 7700-CREATE-CLAIM.
00790
00791      IF CLAIM-IS-PURGED
00792          IF EIBAID = DFHPF1  OR DFHPF2  OR DFHPF3  OR DFHPF4  OR
00793                      DFHPF6  OR DFHPF7  OR DFHPF8  OR DFHPF9  OR
00794                      DFHPF10 OR DFHPF11 OR DFHPF13 OR DFHPF14 OR
00795                      DFHPF17 OR DFHPF18 OR DFHPF20
00796                        MOVE -1            TO  ENTERPFL
00797                        MOVE 'CLAIM IS PURGED, PFKEYS ARE INVALID'
00798                                           TO  MAP-DISPLAY (1)
00799                          GO TO 8200-SEND-DATAONLY.
00800
00801      IF (PI-SUPERVISOR-ONLY)
062602        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
062602             AND 'AMWA')
062602*       NOT SYSTEM-MODIFY-CAP
062602*        IF EIBAID = DFHPF3  OR DFHPF6  OR DFHPF7  OR DFHPF8  OR
062602         IF EIBAID = DFHPF4  OR DFHPF6  OR DFHPF7  OR DFHPF8  OR
062602                     DFHPF9  or
00805                      DFHPF11 OR DFHPF13 OR DFHPF14 OR DFHPF17 OR
00806                      DFHPF21 OR DFHENTER
00807              MOVE -1             TO ENTERPFL
00808              MOVE ER-0931        TO EMI-ERROR
00809              GO TO 0320-INPUT-ERROR.
00810
00811      IF EIBAID = DFHPF13 OR DFHPF19 OR DFHPF20
00812          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
00813              MOVE ER-0029            TO  EMI-ERROR
00814              GO TO 0320-INPUT-ERROR.
00815
00816      IF EIBAID = DFHPF5 OR DFHPF18 OR DFHPF19 OR DFHPF20
00817          IF PI-COMPANY-ID = 'DMD'
00818              AND
00819             NOT SYSTEM-MODIFY-CAP
00820             IF PI-PRIORITY-9
00821                MOVE ER-0931            TO  EMI-ERROR
00822                GO TO 0320-INPUT-ERROR.
00823
050107     IF EIBAID = DFHPF7 OR DFHPF6
050107         IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
050107            AND PI-TOTAL-PAID NOT GREATER THAN +0
050107             MOVE EIBAID             TO PI-PFKEY-USED
050107             MOVE ER-3550            TO  EMI-ERROR
050107             GO TO 0320-INPUT-ERROR.
050107
050107     IF EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF7
050107                 GO TO 0500-CREATE-TEMP-STORAGE.
050107     IF EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF6
050107         IF PI-SAVE-TYPE = 'L'
050107             MOVE ER-0376        TO EMI-ERROR
050107             GO TO 0320-INPUT-ERROR
050107         ELSE
050107             GO TO 0500-CREATE-TEMP-STORAGE.
050107
00824      IF EIBAID = DFHPF3  OR DFHPF4  OR DFHPF5  OR DFHPF7  OR
00825                  DFHPF8  OR DFHPF9  OR DFHPF10 OR DFHPF13 OR
00826                  DFHPF14 OR DFHPF17 OR DFHPF18 OR DFHPF19 OR
                       DFHPF20 or dfhpf11
00828                  GO TO 0500-CREATE-TEMP-STORAGE.
00829
00830      IF EIBAID = DFHPF6
00831          IF PI-SAVE-TYPE = 'L'
00832              MOVE ER-0376        TO EMI-ERROR
00833              GO TO 0320-INPUT-ERROR
00834          ELSE
00835              GO TO 0500-CREATE-TEMP-STORAGE.
00836
00837      MOVE SPACES                 TO ERRMSG1O.
00838
00839      IF EIBAID = DFHPF15
00840          GO TO 7000-START-BROWSE.
00841
00842      IF EIBAID = DFHPF16
00843          GO TO 7500-START-BROWSE.
00844
00845      IF EIBAID = DFHPF1
00846          MOVE 'F'                TO DIRECTION-SWITCH
00847          GO TO 1600-ROLL-TRAILERS.
00848
00849      IF EIBAID = DFHPF2
00850          MOVE 'B'                TO DIRECTION-SWITCH
00851          GO TO 1600-ROLL-TRAILERS.
00852
00853      IF EIBAID = DFHENTER
00854          GO TO 0330-EDIT-DATA.
00855
      *      string "EIBAID = " eibaid into map-display (1)
      *      GO TO 8200-SEND-DATAONLY.
            
00856      MOVE ER-0029                TO EMI-ERROR.
00857
00858  0320-INPUT-ERROR.
00859      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
050107
050107     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT.
00860
00861      IF ENTERPFL = 0
00862          MOVE -1                 TO FILETOL
00863      ELSE
00864          MOVE AL-UNBON           TO ENTERPFA
00865          MOVE -1                 TO ENTERPFL.
00866
00867      GO TO 8200-SEND-DATAONLY.
00868
00869  0330-EDIT-DATA.
050107
050107     MOVE 0                      TO PI-FORCE-COUNT.
050107 
00870      IF NOT MODIFY-CAP
00871          MOVE 'UPDATE'           TO  SM-READ
00872          PERFORM 9995-SECURITY-VIOLATION
00873          MOVE ER-0070            TO  EMI-ERROR
00874          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00875          GO TO 8100-SEND-INITIAL-MAP.
00876
00877      IF CLMNOL  > 0 OR
00878         CARRL   > 0 OR
00879         CERTNOL > 0 OR
00880         SUFXL   > 0
00881             GO TO 1000-SHOW-CLAIM.
00882
CIDMOD     IF YESNOSWL > 0
CIDMOD         MOVE AL-UANON           TO YESNOSWA.
CIDMOD
082707*    IF MCRFLML > 0
082707*        MOVE AL-UANON           TO MCRFLMA.
00885
00886      IF FILETOL > 0
00887          MOVE AL-UANON           TO FILETOA.
00888
CIDMOD     IF CLOANL > 0
CIDMOD        MOVE AL-UANON            TO CLOANA
CIDMOD     END-IF
CIDMOD
031714     IF TOTINTL > 0
031714         MOVE AL-UNNON           TO TOTINTA
031714     END-IF
031714
00889      IF PRTOPTL > 0
00890         IF PRTOPTI NOT = 'N' AND 'L'
00891            MOVE AL-UABON         TO PRTOPTA
00892            MOVE -1               TO PRTOPTL
00893            MOVE ER-0334 TO EMI-ERROR
00894            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00895         ELSE
00896            MOVE AL-UANON         TO PRTOPTA.
00897
00898      IF PRTOPTL > 0
00899          IF (NOT PI-NO-CARRIER-SECURITY OR
00900              NOT PI-NO-ACCOUNT-SECURITY)
00901              IF PRTOPTI NOT = 'N'
00902                  MOVE AL-UABON   TO PRTOPTA
00903                  MOVE -1         TO PRTOPTL
00904                  MOVE ER-2378    TO EMI-ERROR
00905                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00906
00907      IF FORMATL > 0
00908          IF FORMATI NOT = 'F' AND 'P'
00909              MOVE AL-UABON       TO FORMATA
00910              MOVE -1             TO FORMATL
00911              MOVE ER-0335        TO EMI-ERROR
00912              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00913          ELSE
00914              MOVE AL-UANON       TO FORMATA.
00915
00916      IF PI-COMPANY-ID = 'AIG' OR 'AUK'
00917          IF ASSOCL > +0
00918              IF ASSOCI = 'A' OR 'I' OR 'N' OR 'M'
00919                  MOVE AL-UANON   TO  ASSOCA
00920              ELSE
00921                  MOVE AL-UABON   TO  ASSOCA
00922                  MOVE -1         TO  ASSOCL
00923                  MOVE ER-0804    TO  EMI-ERROR
00924                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00925
00926  0335-EDIT-ACTIVITY-CODE.
00927 ******************************************************************
00928 *    THIS PARAGRAPH DETERMINES IF THE COMPANY IS CURRENTLY USING *
00929 *    THE AUTOMATIC ACTIVITY FUNCTIONS OF THE SYSTEM AND, IF SO,  *
00930 *    WHAT FUNCTIONS ARE TO BE PERFORMED BASED ON THE CODES SET   *
00931 *    IN THE AUTOMATIC ACTIVITY RECORD.                           *
00932 ******************************************************************
00933
00934      IF ACTCDL = +0
00935          GO TO 0340-EDIT-DATA.
00936
00937      IF ACTCDI IS NOT NUMERIC
00938          MOVE ZEROS              TO  ACTCDI
00939          MOVE AL-UABON           TO  ACTCDA
00940          MOVE -1                 TO  ACTCDL
00941          MOVE ER-3526            TO  EMI-ERROR
00942          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00943          GO TO 0340-EDIT-DATA.
00944
00945      MOVE ACTCDI                 TO  WS-ACTIVITY-CODE.
00946      IF NOT VALID-ACTIVITY-CODE
00947          MOVE AL-UABON           TO  ACTCDA
00948          MOVE -1                 TO  ACTCDL
00949          MOVE ER-3526            TO  EMI-ERROR
00950          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00951          GO TO 0340-EDIT-DATA.
00952
00953      MOVE 'CNTL'                 TO  FILE-SWITCH.
00954      PERFORM 6000-CHECK-AUTO-ACTIVITY THRU 6000-EXIT.
00955
00956      IF WS-ACT-REC-FOUND-SW = 'N'
00957           MOVE +0                TO  ACTCDL
00958           GO TO 0340-EDIT-DATA.
00959
00960      IF ACTCDI = ZEROS
00961          NEXT SENTENCE
00962      ELSE
00963          MOVE ACTCDI             TO  SUB
00964          SUBTRACT +9 FROM SUB
00965          IF CF-USER-ACTIVE-SW (SUB) = ' ' OR 'N'
00966              MOVE AL-UABON       TO  ACTCDA
00967              MOVE -1             TO  ACTCDL
00968              MOVE ER-3545        TO  EMI-ERROR
00969              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00970              GO TO 0340-EDIT-DATA.
00971
00972      IF ACTCDI = ZEROS
00973          IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CIG' OR 'CUK'
00974              PERFORM 6100-RESET-AUTO-ACTIVITY THRU 6100-EXIT
00975              MOVE AL-UANOF       TO  ACTCDA
00976              GO TO 0340-EDIT-DATA.
00977
00978      MOVE 'Y'                    TO  WS-LETTER-SW.
00979      MOVE AL-UANOF               TO  ACTCDA.
00980
00981  0340-EDIT-DATA.
00982
00983      IF EMI-NO-ERRORS
00984          IF PRTOPTL NOT = FORMATL
00985              MOVE AL-UABON       TO PRTOPTA  FORMATA
00986              MOVE -1             TO PRTOPTL
00987              MOVE ER-0336 TO EMI-ERROR
00988              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00989
00990      IF PRTOPTL > 0
00991         IF (NOT PI-NO-CARRIER-SECURITY OR
00992             NOT PI-NO-ACCOUNT-SECURITY)
00993            IF ALTPRTL NOT > 0
00994               MOVE AL-UABON      TO ALTPRTA
00995               MOVE -1            TO ALTPRTL
00996               MOVE ER-2379       TO EMI-ERROR
00997               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00998
00999      IF NOT EMI-NO-ERRORS
01000          IF EMI-FORCABLE-CTR = ZEROS AND
01001             EMI-FATAL-CTR = ZEROS
01002              NEXT SENTENCE
01003          ELSE
01004              GO TO 8200-SEND-DATAONLY.
01005
01006      IF FILETOL NOT > 0        AND
082707*       MCRFLML NOT > 0        AND
01008         ACTCDL  NOT > 0        AND
CIDMOD        ASSOCL  NOT > 0        AND
CIDMOD        CLOANL  NOT > 0        AND
031714        TOTINTL NOT > 0        AND
CIDMOD        YESNOSWL NOT > 0
01010          GO TO 0350-PROCESS-OPTIONS.
01011
01012      EXEC CICS HANDLE CONDITION
01013          NOTFND   (0450-NOT-FOUND)
01014      END-EXEC.
01015
01016      MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
01017      MOVE PI-CARRIER             TO MSTR-CARRIER.
01018      MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
01019      MOVE PI-CERT-NO             TO MSTR-CERT-NO.
01020      MOVE 'MSTR'                 TO FILE-SWITCH.
01021
01022      EXEC CICS READ
01023          UPDATE
01024          DATASET   ('ELMSTR')
01025          RIDFLD    (ELMSTR-KEY)
01026          INTO      (CLAIM-MASTER)
01027      END-EXEC.
01028
01029      IF ACTCDL > +0
01030          IF CL-LAST-MAINT-USER NOT = PI-UPDATE-BY
01031              MOVE ER-0068        TO  EMI-ERROR
01032              MOVE -1             TO  ACTCDL
01033              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01034              GO TO 8200-SEND-DATAONLY
01035          ELSE
01036              NEXT SENTENCE
01037      ELSE
01038          IF (CL-LAST-MAINT-USER NOT = PI-UPDATE-BY) OR
01039             (CL-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS)
01040                MOVE ER-0068      TO EMI-ERROR
01041                MOVE -1           TO FILETOL
01042                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01043                GO TO 8200-SEND-DATAONLY.
01044
01045      MOVE 'ELMSTR  '             TO FILE-ID.
01046
082707*    IF MCRFLML > 0
082707*        MOVE MCRFLMI            TO CL-MICROFILM-NO.
01049
01050      IF FILETOL > 0
01051          IF FILETOI  = CL-FILE-LOCATION
01052              MOVE ZEROS          TO FILETOL
01053          ELSE
01054              MOVE FILETOI        TO CL-FILE-LOCATION.
01055
031714     IF TOTINTL > 0
031714         EXEC CICS BIF DEEDIT
031714             FIELD(TOTINTI)
031714             LENGTH(9)
031714         END-EXEC
031714         IF TOTINTI  = CL-TOTAL-INT-PAID
031714             MOVE ZEROS          TO TOTINTL
031714         ELSE
031714             MOVE TOTINTI        TO CL-TOTAL-INT-PAID
031714     END-IF.
031714
CIDMOD     IF CLOANL > 0
CIDMOD        IF CLOANI NOT = SPACES
CIDMOD           MOVE CL-CONTROL-PRIMARY
CIDMOD                                 TO ELTRLR-KEY
CIDMOD           MOVE +91              TO TRLR-SEQ-NO
CIDMOD           MOVE 'TRLR'           TO FILE-SWITCH
CIDMOD           EXEC CICS READ
CIDMOD              UPDATE
CIDMOD              DATASET   ('ELTRLR')
CIDMOD              RIDFLD    (ELTRLR-KEY)
CIDMOD              SET       (ADDRESS OF ACTIVITY-TRAILERS)
CIDMOD              RESP      (WS-RESPONSE)
CIDMOD           END-EXEC
CIDMOD           IF WS-RESP-NORMAL
CIDMOD              MOVE CLOANI        TO AT-INFO-LINE-1
CIDMOD              MOVE PI-PROCESSOR-ID
CIDMOD                                 TO AT-GEN-INFO-LAST-UPDATED-BY
CIDMOD              MOVE SAVE-BIN-DATE TO AT-GEN-INFO-LAST-MAINT-DT
CIDMOD              MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
CIDMOD              EXEC CICS REWRITE
CIDMOD                 DATASET   ('ELTRLR')
CIDMOD                 FROM      (ACTIVITY-TRAILERS)
CIDMOD              END-EXEC
CIDMOD           ELSE
CIDMOD              IF WS-RESP-NOTFND
01141                  EXEC CICS GETMAIN
01142                     SET       (ADDRESS OF ACTIVITY-TRAILERS)
01143                     LENGTH    (200)
01144                     INITIMG   (GETMAIN-SPACE)
01145                  END-EXEC
CIDMOD                 MOVE 'AT'       TO AT-RECORD-ID
CIDMOD                 MOVE CL-CONTROL-PRIMARY
CIDMOD                                 TO AT-CONTROL-PRIMARY
CIDMOD                 MOVE +91        TO AT-SEQUENCE-NO
CIDMOD                 MOVE CLOANI     TO AT-INFO-LINE-1
CIDMOD                 MOVE '6'        TO AT-TRAILER-TYPE
CIDMOD                 MOVE PI-PROCESSOR-ID
CIDMOD                                 TO AT-RECORDED-BY
CIDMOD                                    AT-GEN-INFO-LAST-UPDATED-BY
CIDMOD                 MOVE SAVE-BIN-DATE
CIDMOD                                 TO AT-RECORDED-DT
CIDMOD                                    AT-GEN-INFO-LAST-MAINT-DT
CIDMOD                 MOVE EIBTIME    TO AT-LAST-MAINT-HHMMSS
CIDMOD                 EXEC CICS WRITE
CIDMOD                    DATASET   ('ELTRLR')
CIDMOD                    FROM      (ACTIVITY-TRAILERS)
CIDMOD                    RIDFLD    (AT-CONTROL-PRIMARY)
CIDMOD                 END-EXEC
CIDMOD              END-IF
CIDMOD           END-IF
CIDMOD        END-IF
CIDMOD     END-IF
CIDMOD
CIDMOD     IF YESNOSWI EQUAL TO CL-YESNOSW
CIDMOD         MOVE ZEROS    TO YESNOSWL
CIDMOD     ELSE
CIDMOD         MOVE YESNOSWI TO CL-YESNOSW
CIDMOD     END-IF.
00800
01056      IF WS-ACT-REC-FOUND-SW = 'Y'
01057          IF ACTCDL > +0
01058              MOVE ACTCDI             TO  CL-ACTIVITY-CODE
01059              MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
01060                                          DC-BIN-DATE-1
01061              MOVE ' '                TO  DC-OPTION-CODE
01062              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01063              MOVE DC-GREG-DATE-1-EDIT    TO  ACTDTO.
01064
01065      IF WS-ACT-REC-FOUND-SW = 'Y'
01066          IF ACTCDL > +0
01067              IF ACTCDI = ZEROS
01068                  MOVE SPACES         TO  CL-ACTIVITY-MAINT-TYPE
01069                                          ACTTYPO
01070              ELSE
01071                  MOVE WS-ACTIVITY-CODE   TO  SUB
01072                  SUBTRACT 9 FROM SUB
01073                  MOVE CF-USER-ACTIVITY-DESC (SUB)
01074                                      TO  WS-ACT-USER-DESC
01075                  MOVE WS-DESC-1-3    TO  CL-ACTIVITY-MAINT-TYPE
01076                                          ACTTYPO.
01077
01078      IF WS-ACT-REC-FOUND-SW = 'Y'
01079          IF ACTCDL > +0
01080              IF WS-UPDATE-SW = 'Y'
01081                  MOVE LOW-VALUES     TO  CL-NEXT-RESEND-DT
01082                                          CL-NEXT-FOLLOWUP-DT.
01083
01084      IF PI-COMPANY-ID = 'AIG' OR 'AUK'
01085          IF ASSOCL > +0
01086              MOVE ASSOCI         TO  CL-ASSOCIATES.
01087
01088      IF PI-COMPANY-ID = 'FLA'
01089          NEXT SENTENCE
01090      ELSE
01091          MOVE '3'                TO  CL-LAST-MAINT-TYPE
01092          MOVE PI-PROCESSOR-ID    TO  CL-LAST-MAINT-USER
01093                                      SV-LAST-BY
01094          MOVE EIBTIME            TO  CL-LAST-MAINT-HHMMSS
01095                                      SV-LAST-HHMMSS
01096          MOVE SAVE-BIN-DATE      TO  CL-LAST-MAINT-DT.
01097
01098  0350-PROCESS-OPTIONS.
01099      IF PRTOPTL NOT > 0
01100          GO TO 0400-WRITE-CLAIM.
01101
01102      IF PRTOPTI = 'N'
01103          GO TO 0380-START-PRINTER.
01104
01105      EXEC CICS HANDLE CONDITION
01106          NOTFND(0360-CREATE-NEW-ACTQ)
01107      END-EXEC.
01108
01109      MOVE PI-COMPANY-CD          TO ACTQ-COMP-CD.
01110      MOVE PI-CARRIER             TO ACTQ-CARRIER.
01111      MOVE PI-CLAIM-NO            TO ACTQ-CLAIM-NO.
01112      MOVE PI-CERT-NO             TO ACTQ-CERT-NO.
01113
01114      MOVE 'ACTQ'                 TO FILE-SWITCH.
01115      MOVE 'ELACTQ  '             TO FILE-ID.
01116
01117      EXEC CICS READ
01118          UPDATE
01119          DATASET   ('ELACTQ')
01120          SET       (ADDRESS OF ACTIVITY-QUE)
01121          RIDFLD    (ELACTQ-KEY)
01122      END-EXEC.
01123
01124      IF FORMATI = 'F'
01125          MOVE '1'                TO AQ-PENDING-STATUS-FLAG
01126      ELSE
01127          MOVE '2'                TO AQ-PENDING-STATUS-FLAG.
01128
01129      MOVE +150                   TO AQ-LAST-UPDATED-BY.
01130
01131      MOVE 'ELACTQ  '             TO FILE-ID.
01132
01133      EXEC CICS REWRITE
01134          DATASET   ('ELACTQ')
01135          FROM      (ACTIVITY-QUE)
01136      END-EXEC.
01137
01138      GO TO 0400-WRITE-CLAIM.
01139
01140  0360-CREATE-NEW-ACTQ.
01141      EXEC CICS GETMAIN
01142          SET       (ADDRESS OF ACTIVITY-QUE)
01143          LENGTH    (60)
01144          INITIMG   (GETMAIN-SPACE)
01145      END-EXEC.
01146
01147      MOVE 'AQ'                   TO AQ-RECORD-ID.
01148      MOVE PI-COMPANY-CD          TO AQ-COMPANY-CD.
01149      MOVE PI-CARRIER             TO AQ-CARRIER.
01150      MOVE PI-CLAIM-NO            TO AQ-CLAIM-NO.
01151      MOVE PI-CERT-NO             TO AQ-CERT-NO.
01152
01153      IF FORMATI = 'F'
01154          MOVE '1'                TO AQ-PENDING-STATUS-FLAG
01155      ELSE
01156          MOVE '2'                TO AQ-PENDING-STATUS-FLAG.
01157
01158      MOVE +0                     TO AQ-PAYMENT-COUNTER
01159                                     AQ-PMT-UNAPPROVED-COUNT.
01160
01161      MOVE LOW-VALUES             TO AQ-RESEND-DATE
01162                                     AQ-FOLLOWUP-DATE.
01163
01164      MOVE +150                   TO AQ-LAST-UPDATED-BY.
01165
01166      MOVE 'ACTQ'                 TO FILE-SWITCH.
01167
01168      MOVE 'ELACTQ  '             TO FILE-ID.
01169
01170      EXEC CICS WRITE
01171          DATASET   ('ELACTQ')
01172          FROM      (ACTIVITY-QUE)
01173          RIDFLD    (AQ-CONTROL-PRIMARY)
01174      END-EXEC.
01175
01176      GO TO 0400-WRITE-CLAIM.
01177
01178  0380-START-PRINTER.
01179      EXEC CICS HANDLE CONDITION
01180           TERMIDERR    (0385-TERMID-ERROR)
01181           TRANSIDERR   (0390-TRANS-ERROR)
01182      END-EXEC.
01183
01184      MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
01185      MOVE '1'                    TO CNTL-REC-TYPE.
01186      MOVE SPACES                 TO CNTL-ACCESS.
01187      MOVE +0                     TO CNTL-SEQ-NO.
01188      MOVE 'CNTL'                 TO FILE-SWITCH.
01189
01190      EXEC CICS READ
01191          DATASET   ('ELCNTL')
01192          SET       (ADDRESS OF CONTROL-FILE)
01193          RIDFLD    (ELCNTL-KEY)
01194      END-EXEC.
01195
01196      IF CF-FORMS-PRINTER-ID = SPACES
01197          MOVE ER-0337            TO EMI-ERROR
01198          MOVE -1                 TO FILETOL
01199          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01200          GO TO 8200-SEND-DATAONLY.
01201
01202      IF FORMATI = 'F'
01203          MOVE '2'                TO PI-ENTRY-CD-1
01204      ELSE
01205          MOVE '1'                TO PI-ENTRY-CD-1.
01206
01207      IF PI-PROCESSOR-PRINTER NOT = SPACES
01208          MOVE PI-PROCESSOR-PRINTER  TO  CF-FORMS-PRINTER-ID.
01209
01210      MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
01211
01212      IF ALTPRTL > 0
01213         MOVE ALTPRTI             TO CF-FORMS-PRINTER-ID
01214                                     PI-ALT-DMD-PRT-ID.
01215
01216      IF PI-COMPANY-ID = 'DMD' OR 'XXX'
01217 *       MOVE EIBTRMID            TO CF-FORMS-PRINTER-ID
01218          EXEC CICS START
01219              TRANSID   (START-TRANS-ID)
01220              FROM      (PROGRAM-INTERFACE-BLOCK)
01221              LENGTH    (PI-COMM-LENGTH)
PEMMOD*            TERMID    ('A155')
PEMMOD*            TERMID    (CF-FORMS-PRINTER-ID)
01223          END-EXEC
01224      ELSE
01225          EXEC CICS START
01226              TRANSID   (START-TRANS-ID)
pemuni             TERMID    (CF-FORMS-PRINTER-ID)
pemuni*            TERMID    ('PRN1')
01228              FROM      (PROGRAM-INTERFACE-BLOCK)
01229              LENGTH    (PI-COMM-LENGTH)
01230          END-EXEC.
01231
01232       GO TO 0400-WRITE-CLAIM.
01233
01234  0385-TERMID-ERROR.
01235      MOVE ER-0412                TO EMI-ERROR.
01236      MOVE -1                     TO ALTPRTL.
01237      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01238      GO TO 8200-SEND-DATAONLY.
01239
01240  0390-TRANS-ERROR.
01241      MOVE ER-0413                TO EMI-ERROR.
01242      MOVE -1                     TO FILETOL.
01243      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01244      GO TO 8200-SEND-DATAONLY.
01245
01246  0400-WRITE-CLAIM.
01247      IF FILETOL = 0  AND
082707*       MCRFLML = 0  AND
01249         ACTCDL  = 0  AND
CIDMOD        ASSOCL  = 0  AND
CIDMOD        CLOANL  = 0  AND
031714        TOTINTL = 0  AND
CIDMOD        YESNOSWL = 0
01251          GO TO 0440-UPDATE-DONE.
01252
01253      EXEC CICS HANDLE CONDITION
01254          NOTFND (0450-NOT-FOUND)
01255          DUPKEY (0440-UPDATE-DONE)
01256      END-EXEC.
01257
01258      MOVE 'ELMSTR  '             TO FILE-ID.
01259
01260      EXEC CICS REWRITE
01261          DATASET   ('ELMSTR')
01262          FROM      (CLAIM-MASTER)
01263      END-EXEC.
01264
01265  0440-UPDATE-DONE.
01266      IF FILETOL  > 0 OR
082707*       MCRFLML  > 0 OR
01268         PRTOPTL  > 0 OR
01269         FORMATL  > 0 OR
CIDMOD        YESNOSWL > 0 OR
CIDMOD        CLOANL   > 0 OR
031714        TOTINTL  > 0 OR
01270         ACTCDL   > 0
01271             MOVE SV-LAST-BY             TO PI-UPDATE-BY
01272             MOVE SV-LAST-HHMMSS         TO PI-UPDATE-HHMMSS.
01273
01274      PERFORM 6050-AUTO-LETTER-WRITER THRU 6050-EXIT.
01275
01276      MOVE ER-0000                TO EMI-ERROR.
01277      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01278
01279      IF CLAIM-IS-PURGED
082707        CONTINUE
082707*        MOVE -1                 TO  MCRFLML
01281      ELSE
01282          MOVE -1                 TO  FILETOL
082707     END-IF
01283
01284      GO TO 8200-SEND-DATAONLY.
01285
01286  0450-NOT-FOUND.
01287      IF FILE-SWITCH = 'MSTR'
01288          MOVE ER-0204            TO EMI-ERROR
01289      ELSE
01290          MOVE ER-0190            TO EMI-ERROR.
01291
01292      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01293
01294      MOVE -1                     TO FILETOL.
01295      GO TO 8200-SEND-DATAONLY.
01296
01297      EJECT
01298  0500-CREATE-TEMP-STORAGE.
01299
01300      IF PI-SAVE-SYS-ID = 'CR'
01301         IF PI-CLOSED
01302            IF PI-BENEFIT-CHANGE OR PI-ERROR-CORRECTION
01303               IF EIBAID = DFHPF7
01304                  MOVE ER-0934            TO EMI-ERROR
01305                  MOVE -1                 TO FILETOL
01306                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01307                  GO TO 8200-SEND-DATAONLY
01308               ELSE
01309               IF EIBAID = DFHPF8
01310                  MOVE ER-0935            TO EMI-ERROR
01311                  MOVE -1                 TO FILETOL
01312                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01313                  GO TO 8200-SEND-DATAONLY.
01314
01315      MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
01316
01317      MOVE LOW-VALUES TO PI-SAVE-FILETO  PI-SAVE-PRTOPT
01318                         PI-SAVE-FORMAT  PI-SAVE-MCRFLM
01319                         PI-SAVE-ACT-CD  PI-SAVE-ASSOC
CIDMOD                        TS-PI-SAVE-CLOAN.
01320
01321      MOVE FILETOI                TO PI-SAVE-FILETO.
082707*    MOVE MCRFLMI                TO PI-SAVE-MCRFLM.
01323      MOVE PRTOPTI                TO PI-SAVE-PRTOPT.
01324      MOVE FORMATI                TO PI-SAVE-FORMAT.
01325      MOVE ACTCDI                 TO PI-SAVE-ACT-CD.
CIDMOD     MOVE CLOANI                 TO TS-PI-SAVE-CLOAN
01326
01327      IF PI-COMPANY-ID = 'AIG' OR 'AUK'
01328          MOVE ASSOCI             TO PI-SAVE-ASSOC.
01329
CIDMOD     MOVE PROGRAM-INTERFACE-BLOCK TO TS-PI-AREA
CIDMOD
01330      EXEC CICS WRITEQ TS
01331          QUEUE    (QID)
CIDMOD*        FROM     (PROGRAM-INTERFACE-BLOCK)
01332          FROM     (TS-AREA)
CIDMOD*        LENGTH   (PI-COMM-LENGTH)
01333          LENGTH   (TS-LENGTH)
01334      END-EXEC.
01335
01336  0500-PF-CHECKS.
01337
01338      IF EIBAID = DFHPF3
01339          IF PI-SAVE-SYS-ID = 'CV'
01340              MOVE XCTL-EM131     TO PGM-NAME
01341              GO TO 9300-XCTL
01342          ELSE
01343              MOVE XCTL-131       TO PGM-NAME
01344              GO TO 9300-XCTL.
01345
01346      IF EIBAID = DFHPF4
01347          MOVE XCTL-153           TO PGM-NAME
01348          GO TO 9300-XCTL.
01349
01350      IF EIBAID = DFHPF5
01351          IF PI-SAVE-SYS-ID = 'CV'
01352              MOVE THIS-PGM       TO PI-RETURN-TO-PROGRAM
01353              MOVE XCTL-EM1273    TO PGM-NAME
01354              GO TO 9300-XCTL
01355          ELSE
01356              MOVE XCTL-1273      TO PGM-NAME
01357              GO TO 9300-XCTL.
01358
01359      IF EIBAID = DFHPF6
050107       OR (EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF6)
01360          MOVE XCTL-154           TO PGM-NAME
01361          GO TO 9300-XCTL.
01362
01363      IF EIBAID = DFHPF7
050107       OR (EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF7)
01364          IF PI-SAVE-SYS-ID = 'CV'
01365              IF PI-SAVE-TYPE = PI-LIFE-OVERRIDE-L1
01366                  MOVE XCTL-EM156    TO  PGM-NAME
01367                  GO TO 9300-XCTL
01368              ELSE
01369                  MOVE XCTL-EM1561   TO  PGM-NAME
01370                  GO TO 9300-XCTL
01371          ELSE
01372              MOVE XCTL-156          TO PGM-NAME
01373              GO TO 9300-XCTL.
01374
01375      IF EIBAID = DFHPF8
01376          MOVE XCTL-151           TO PGM-NAME
01377          GO TO 9300-XCTL.
01378
01379      IF EIBAID = DFHPF9
01380          MOVE XCTL-152           TO PGM-NAME
01381          GO TO 9300-XCTL.
01382
01383      IF EIBAID = DFHPF10
01384          MOVE PI-SAVE-LOW        TO PI-PASS-AREA
01385          MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
01386          MOVE XCTL-142           TO PGM-NAME
01387          GO TO 9300-XCTL.
01388
01389      IF EIBAID = DFHPF11
01390         IF PI-COMPANY-ID = 'DMD'
01391            MOVE XCTL-155           TO PGM-NAME
01392            GO TO 9300-XCTL
01393          ELSE
                 MOVE XCTL-1503          TO PGM-NAME
01395            GO TO 9300-XCTL.
01396
01397      IF EIBAID = DFHPF13
01398          MOVE PI-SAVE-FORM       TO PI-PASS-AREA
CIDMOD         MOVE XCTL-155           TO PGM-NAME
01400          GO TO 9300-XCTL.
01401
01402      IF EIBAID = DFHPF14
01403          MOVE XCTL-141           TO PGM-NAME
01404          GO TO 9300-XCTL.
01405
01406      IF EIBAID = DFHPF17
01407          MOVE XCTL-162           TO PGM-NAME
01408          GO TO 9300-XCTL.
01409
01410      IF EIBAID = DFHPF18
062602         MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
01411          MOVE XCTL-1501          TO PGM-NAME
01412          GO TO 9300-XCTL.
01413
01414      IF EIBAID = DFHPF19
01415          IF PI-SAVE-SYS-ID = 'CV'
01416              MOVE THIS-PGM       TO PI-RETURN-TO-PROGRAM
01417              MOVE XCTL-EM1276    TO PGM-NAME
01418              GO TO 9300-XCTL
01419          ELSE
01420          IF PI-COMPANY-ID = 'DMD'
01421              MOVE 'EL401DMD'     TO PGM-NAME
01422              GO TO 9300-XCTL
01423           ELSE
102809             MOVE XCTL-1279      TO PGM-NAME
01425              GO TO 9300-XCTL.
01426
01427      IF EIBAID = DFHPF20
062602         MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
01428          MOVE XCTL-1502          TO PGM-NAME
01429          GO TO 9300-XCTL.
01430      EJECT
01431  0600-RECOVER-TEMP-STORAGE.

01432      MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
01433
01434      EXEC CICS HANDLE CONDITION
01435          QIDERR   (0690-QIDERR)
01436      END-EXEC
01437
01438      EXEC CICS READQ TS
01439          QUEUE    (QID)
CIDMOD*        INTO     (PROGRAM-INTERFACE-BLOCK)
01440          INTO     (TS-AREA)
CIDMOD*        LENGTH   (PI-COMM-LENGTH)
01441          LENGTH   (TS-LENGTH)
01442      END-EXEC
01443
CIDMOD     MOVE TS-PI-AREA        TO PROGRAM-INTERFACE-BLOCK
CIDMOD
01444      EXEC CICS DELETEQ TS
01445          QUEUE   (QID)
01446      END-EXEC.
01447
01448      IF RETURNED-FROM NOT = XCTL-EM1273
01449          MOVE SAVE-CONTROL       TO PI-CONTROL-IN-PROGRESS.
01450
01451      MOVE LOW-VALUES             TO EL150AO.
01452
082707*    IF PI-SAVE-MCRFLM NOT = LOW-VALUES
082707*        MOVE PI-SAVE-MCRFLM     TO MCRFLMO.
01455
01456      IF PI-SAVE-FILETO NOT = LOW-VALUES
01457          MOVE PI-SAVE-FILETO     TO FILETOO.
01458
CIDMOD     IF TS-PI-SAVE-CLOAN NOT = LOW-VALUES
CIDMOD        MOVE TS-PI-SAVE-CLOAN   TO CLOANO
CIDMOD     END-IF
01458
01459      IF PI-SAVE-PRTOPT NOT = LOW-VALUES
01460          MOVE PI-SAVE-PRTOPT     TO PRTOPTO
01461          MOVE AL-UANON           TO PRTOPTA.
01462
01463      IF PI-SAVE-FORMAT NOT = LOW-VALUES
01464          MOVE PI-SAVE-FORMAT     TO FORMATO
01465          MOVE AL-UANON           TO FORMATA.
01466
01467      IF PI-SAVE-ACT-CD NOT = LOW-VALUES
01468          MOVE PI-SAVE-ACT-CD     TO ACTCDO.
01469
01470      IF PI-SAVE-ASSOC  NOT = LOW-VALUES
01471          MOVE PI-SAVE-ASSOC      TO ASSOCO.
01472
01473      MOVE 'N'                    TO DIRECTION-SWITCH.
050107
050107     MOVE SPACES TO PI-PFKEY-USED.
050107     MOVE 0      TO PI-FORCE-COUNT.
01474
01475      GO TO 1000-SHOW-CLAIM.
01476
01477  0690-QIDERR.
01478      MOVE ER-0033                TO EMI-ERROR.
01479      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01480      MOVE LOW-VALUES             TO EL150AO.
01481      MOVE -1                     TO FILETOL.
01482      GO TO 8100-SEND-INITIAL-MAP.
01483
01484      EJECT
01485  1000-SHOW-CLAIM.
01486
01487      IF CLMNOL > 0
01488          MOVE CLMNOI             TO PI-CLAIM-NO.
01489
01490      IF CARRL > 0
01491          MOVE CARRI              TO PI-CARRIER.
01492
01493      IF CERTNOL > 0
01494          MOVE CERTNOI            TO PI-CERT-PRIME.
01495
01496      IF SUFXL > 0
01497          MOVE SUFXI              TO PI-CERT-SFX.
01498
01499      MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
01500      MOVE PI-CARRIER             TO MSTR-CARRIER.
01501      MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
01502      MOVE PI-CERT-NO             TO MSTR-CERT-NO.
01503      MOVE 'MSTR'                 TO FILE-SWITCH.
01504
01505  1000-READ-CLAIM.
01506
01507      EXEC CICS HANDLE CONDITION
01508          NOTFND   (1100-SHOW-RECORD-NOT-FOUND)
01509      END-EXEC.
01510
01511      EXEC CICS READ
01512          DATASET   (PI-CURRENT-FILE)
01513          RIDFLD    (ELMSTR-KEY)
01514          INTO      (CLAIM-MASTER)
01515      END-EXEC.
01516
01517  1000-CONTINUE-WITH-RETRIEVED.
01518
030612     if (pi-company-id = 'CID' OR 'DCC' OR 'AHL')
062602        and (cl-priority-cd = '8')
062602        move 'S'                 to pi-priority-ind
062602     end-if
062602
01519      IF PI-COMPANY-ID = 'DMD'
01520          IF HIGHEST-PRIORITY
01521              MOVE 'S'            TO PI-PRIORITY-IND
01522              MOVE ER-0933        TO EMI-ERROR
01523              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01524          ELSE
01525              IF NOT CONFIDENTIAL-DATA
01526                  MOVE LOW-VALUES TO PI-PRIORITY-IND.
01527
01528      IF PI-COMPANY-ID = 'DMD'
01529              AND
01530         PI-ASS-PROCESSING
01531              AND
01532         PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
01533          NEXT SENTENCE
01534      ELSE
01535          MOVE ELMSTR-KEY         TO PI-PREV-CLAIM
01536          MOVE CL-PRIME-CERT-NO   TO PI-PREV-PRIME-CERT-NO.
01537
01538      MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
01539      MOVE CL-PRIORITY-CD         TO PI-PRIORITY-CD.
01540
01541      IF CL-LAST-MAINT-HHMMSS IS NOT NUMERIC
01542          MOVE EIBTIME            TO PI-UPDATE-HHMMSS
01543      ELSE
01544          MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
01545
01546      MOVE CL-TRAILER-SEQ-CNT     TO PI-SAVE-CNT.
CIDMOD
CIDMOD     IF CL-YESNOSW = 'Y' OR 'N'
CIDMOD         MOVE CL-YESNOSW         TO YESNOSWO
CIDMOD     ELSE
CIDMOD         MOVE 'Y'                TO YESNOSWO
CIDMOD     END-IF.
CIDMOD
01547      MOVE CL-CLAIM-NO            TO CLMNOO
01548                                     PI-CLAIM-NO.
01549      MOVE CL-CARRIER             TO CARRO
01550                                     PI-CARRIER.
01551      MOVE CL-CERT-PRIME          TO CERTNOO
01552                                     PI-CERT-PRIME.
01553      MOVE CL-CERT-SFX            TO SUFXO
01554                                     PI-CERT-SFX.
01555      MOVE CL-CCN                 TO CRDCARDO
01556
01557      MOVE CL-SYSTEM-IDENTIFIER   TO PI-SAVE-SYS-ID.
01558
01559      IF CL-SYSTEM-IDENTIFIER = 'CV'
01560          MOVE CL-CV-REFERENCE-NO TO PI-MP-REFERENCE-NO.
01561
01562      IF CL-ASSOC-CERT-TOTAL = +0 OR +1
01563          MOVE SPACES                 TO PRIMCRTO
01564                                         PRIMSFXO
01565                                         PRIMHDGO
01566                                         SEQUO
01567          MOVE AL-SADOF               TO PRIMCRTA
01568                                         PRIMSFXA
01569                                         PRIMHDGA
01570                                         SEQUA
01571      ELSE
01572          MOVE CL-ASSOC-CERT-SEQU     TO WS-CUR-SEQU
01573          MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
01574          MOVE WS-CLAIM-SEQUENCE      TO SEQUO
01575          MOVE CL-PRIME-CERT-PRIME    TO PRIMCRTO
01576          MOVE CL-PRIME-CERT-SFX      TO PRIMSFXO
01577          MOVE 'PRIME CERT :'         TO PRIMHDGO
01578          MOVE AL-SABON               TO PRIMCRTA
01579                                         PRIMSFXA
01580                                         PRIMHDGA
01581                                         SEQUA.
01582
01583      MOVE CL-CLAIM-TYPE          TO PI-SAVE-TYPE.
01584      MOVE CL-CERT-GROUPING       TO PI-GROUPING.
01585      MOVE CL-CERT-STATE          TO PI-STATE.
01586
01587      IF PI-COMPANY-ID = 'AIG' OR 'AUK'
01588          MOVE CL-CERT-ACCOUNT    TO  PI-ACCOUNT
01589          MOVE CL-CURRENT-ACCOUNT TO  ACCTO
01590      ELSE
01591          MOVE CL-CERT-ACCOUNT    TO  PI-ACCOUNT
01592                                      ACCTO.
01593
01594      MOVE CL-CERT-EFF-DT         TO PI-CERT-EFF-DT.
01595
121802     EVALUATE TRUE

121802        WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
121802           MOVE PI-AH-OVERRIDE-L6
                                       TO CLMTYPO
121802
121802        WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
121802           MOVE PI-LIFE-OVERRIDE-L6
                                       TO CLMTYPO
121802
121802        WHEN CL-CLAIM-TYPE = 'I'
121802           MOVE '  IU  '         TO CLMTYPO
121802
121802        WHEN CL-CLAIM-TYPE = 'G'
121802           MOVE ' GAP  '         TO CLMTYPO
052614
052614        WHEN CL-CLAIM-TYPE = 'F'
052614           MOVE ' FAM  '         TO CLMTYPO
121802
121802     END-EVALUATE

01602      IF CLAIM-IS-OPEN
01603          MOVE ' OPEN'            TO CLMSTATO
01604      ELSE
01605          MOVE 'CLOSED'           TO CLMSTATO.
01606
121802*    IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CIG' OR 'CUK'
121802*        IF (CLAIM-IS-CLOSED)  AND
121802*           (CL-LAST-CLOSE-REASON = '2')
121802*            MOVE 'DENIED'       TO CLMSTATO.
01611
01612      MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
01613      MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
01614      MOVE CL-INSURED-MID-INIT    TO MINITO.
01615
01616      IF CL-NO-OF-PMTS-MADE = +0 AND
01617         CL-TOTAL-PAID-AMT = +0
01618          NEXT SENTENCE
01619      ELSE
01620          IF CL-PAID-THRU-DT NOT = LOW-VALUES
01621              MOVE CL-PAID-THRU-DT        TO  DC-BIN-DATE-1
01622              MOVE ' '                    TO  DC-OPTION-CODE
01623              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01624              MOVE DC-GREG-DATE-1-EDIT    TO  PDTHRUO
01625              IF PI-USES-PAID-TO
01626                  MOVE CL-PAID-THRU-DT    TO  DC-BIN-DATE-1
01627                  MOVE '6'                TO  DC-OPTION-CODE
01628                  MOVE +1                 TO  DC-ELAPSED-DAYS
01629                  MOVE +0                 TO  DC-ELAPSED-MONTHS
01630                  PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01631                  MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
01632
01633      IF CL-INCURRED-DT NOT = LOW-VALUES
01634          MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
01635          MOVE ' '                TO DC-OPTION-CODE
01636          MOVE +0                 TO DC-ELAPSED-DAYS
01637                                     DC-ELAPSED-MONTHS
01638          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01639          MOVE DC-GREG-DATE-1-EDIT TO INCURO.
01640
042110     IF CL-DENIAL-TYPE NOT = SPACES AND LOW-VALUES
042110        EVALUATE CL-DENIAL-TYPE
042110           WHEN '1'
042110              MOVE 'DENIAL STATUS - DENIAL       '
042110                                 TO DENTYPO
042110           WHEN '2'
042110              MOVE 'DENIAL STATUS - RESCISSION   '
042110                                 TO DENTYPO
042110           WHEN '3'
042110              MOVE 'DENIAL STATUS - REFORMATION  '
042110                                 TO DENTYPO
042110           WHEN '4'
042110              MOVE 'DENIAL STATUS - REF TO RESC  '
042110                                 TO DENTYPO
042110           WHEN '5'
042110              MOVE 'DENIAL STATUS - RECONSIDERED '
042110                                 TO DENTYPO
042110        END-EVALUATE
042110        MOVE AL-SANOF            TO DENTYPA
042110     END-IF
                    
01641      IF CL-NEXT-AUTO-PAY-DT NOT = LOW-VALUES
01642          MOVE CL-NEXT-AUTO-PAY-DT TO DC-BIN-DATE-1
01643          MOVE ' '                TO DC-OPTION-CODE
01644          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01645          MOVE DC-GREG-DATE-1-EDIT TO NXTAUTOO
01646          IF PI-USES-PAID-TO
01647              MOVE CL-NEXT-AUTO-PAY-DT   TO  DC-BIN-DATE-1
01648              MOVE '6'                   TO  DC-OPTION-CODE
01649              MOVE +1                    TO  DC-ELAPSED-DAYS
01650              MOVE +0                    TO  DC-ELAPSED-MONTHS
01651              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01652              IF NO-CONVERSION-ERROR
01653                  MOVE DC-GREG-DATE-1-EDIT   TO  NXTAUTOO
01654              ELSE
01655                  MOVE LOW-VALUES            TO  NXTAUTOO.
01656
01657      IF CL-FILE-ESTABLISH-DT NOT = LOW-VALUES
01658          MOVE CL-FILE-ESTABLISH-DT      TO  DC-BIN-DATE-1
01659          MOVE ' '                       TO  DC-OPTION-CODE
01660          MOVE +0                        TO  DC-ELAPSED-DAYS
01661                                             DC-ELAPSED-MONTHS
01662          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01663          IF NO-CONVERSION-ERROR
01664              MOVE DC-GREG-DATE-1-EDIT   TO  ESTABDTO
01665          ELSE
01666              MOVE SPACES                TO  ESTABDTO.
01667
082707*    MOVE CL-MICROFILM-NO        TO MCRFLMO.
01669      MOVE CL-FILE-LOCATION       TO FILETOO.
01670
01671      IF CL-CERT-EFF-DT NOT = LOW-VALUES
01672          MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
01673          MOVE ' '                TO DC-OPTION-CODE
01674          MOVE +0                 TO DC-ELAPSED-DAYS
01675                                     DC-ELAPSED-MONTHS
01676          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01677          MOVE DC-GREG-DATE-1-EDIT TO EFFECTO.
01678
082707     IF CL-TOTAL-INT-PAID NOT NUMERIC
082707        MOVE +0                  TO CL-TOTAL-INT-PAID
082707     END-IF
           MOVE CL-TOTAL-INT-PAID      TO TOTINTO
01679      MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
050107     MOVE CL-TOTAL-PAID-AMT      TO PI-TOTAL-PAID.
01680
01681      IF PI-COMPANY-ID = 'AIG' OR 'AUK'
01682          MOVE CL-CURRENT-STATE   TO  STATEO
01683      ELSE
01684      IF PI-COMPANY-ID = 'DMD'
01685          MOVE PI-COMPANY-CD          TO CERT-COMP-CD
01686          MOVE CL-CERT-CARRIER        TO CERT-CARRIER
01687          MOVE CL-CERT-GROUPING       TO CERT-GROUPING
01688          MOVE CL-CERT-STATE          TO CERT-STATE
01689          MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
01690          MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT
01691          MOVE CL-CERT-NO             TO CERT-CERT-NO
01692          MOVE 'CERT'                 TO FILE-SWITCH
01693          EXEC CICS READ
01694              DATASET   ('ELCERT')
01695              SET       (ADDRESS OF CERTIFICATE-MASTER)
01696              RIDFLD    (ELCERT-KEY)
01697          END-EXEC
01698          MOVE CM-RESIDENT-STATE  TO  STATEO
01699      ELSE
01700          MOVE CL-CERT-STATE      TO  STATEO.
01701
01702      MOVE CL-ACTIVITY-CODE       TO  ACTCDO.
01703      MOVE CL-ACTIVITY-MAINT-TYPE TO  ACTTYPO.
01704
01705      IF CL-ACTIVITY-MAINT-DT = SPACES OR LOW-VALUES
01706          MOVE SPACES                     TO  ACTDTO
01707      ELSE
01708          MOVE CL-ACTIVITY-MAINT-DT       TO  DC-BIN-DATE-1
01709          MOVE ' '                        TO  DC-OPTION-CODE
01710          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01711          IF NO-CONVERSION-ERROR
01712              MOVE DC-GREG-DATE-1-EDIT    TO  ACTDTO
01713          ELSE
01714              MOVE SPACES                 TO  ACTDTO.
01715
01716      IF PI-COMPANY-ID = 'AIG' OR 'AUK'
01717          MOVE 'ASSOC:'               TO  ASSHDGO
01718          MOVE AL-SABON               TO  ASSHDGA
01719          MOVE CL-ASSOCIATES          TO  ASSOCO
01720      ELSE
01721          MOVE SPACES                 TO  ASSHDGO
01722          MOVE AL-SADOF               TO  ASSOCA.
01723
01724      MOVE CL-CLAIM-STATUS        TO PI-STATUS-IND.
01725      MOVE CL-LAST-CLOSE-REASON   TO PI-LAST-CLOSE-REASON-IND.
01726
01727      IF PI-COMPANY-ID = 'DMD'
01728              AND
01729          ((PI-ASS-PROCESSING  AND
01730            PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO)
01731                  OR
01732          ((PI-CLOSED AND
01733           (PI-BENEFIT-CHANGE OR PI-ERROR-CORRECTION))
01734                  OR
01735            CL-CERT-NO NOT = CL-PRIME-CERT-NO))
01736          PERFORM 1200-GET-ASS-TOTALS THRU 1200-EXIT
01737      ELSE
01738          MOVE LOW-VALUES             TO PI-LAST-PF-KEY-IND
01739                                         PI-ASSOCIATED-CERTS-TABLE
01740                                         PI-ASSOCIATED-PROCESS-IND
01741          MOVE SPACES                 TO AMTPDO
01742                                         DAYSPDO
01743                                         CLMTOTHO
01744                                         DAYSPDHO
050107*01745          MOVE ZEROS                  TO PI-TOTAL-PAID
050107         MOVE ZEROS                  TO
01746                                         PI-DAYS-PAID
01747                                         PI-LAST-SEQ-NO
01748                                         PI-ASS-NDX.
01749
01750      EXEC CICS HANDLE CONDITION
01751          NOTFND    (1005-END-BUILD-DIAGNOSIS)
01752      END-EXEC.
01753
01754      MOVE CL-CONTROL-PRIMARY  TO ELTRLR-KEY.
01755      MOVE +90                 TO TRLR-SEQ-NO.
01756      MOVE 'TRLR'              TO FILE-SWITCH.
01757
01758      EXEC CICS READ
01759          DATASET   ('ELTRLR')
01760          RIDFLD    (ELTRLR-KEY)
01761          SET       (ADDRESS OF ACTIVITY-TRAILERS)
01762      END-EXEC.
01763
01764      MOVE AT-INFO-LINE-1         TO DIAGO.
01765
01766  1005-END-BUILD-DIAGNOSIS.
01767
CIDMOD     MOVE CL-CONTROL-PRIMARY  TO ELTRLR-KEY.
CIDMOD     MOVE +91                 TO TRLR-SEQ-NO.
CIDMOD     MOVE 'TRLR'              TO FILE-SWITCH.
CIDMOD
CIDMOD     EXEC CICS READ
CIDMOD         DATASET   ('ELTRLR')
CIDMOD         RIDFLD    (ELTRLR-KEY)
CIDMOD         SET       (ADDRESS OF ACTIVITY-TRAILERS)
CIDMOD         RESP      (WS-RESPONSE)
CIDMOD     END-EXEC.
CIDMOD
CIDMOD     IF WS-RESP-NORMAL
CIDMOD        MOVE AT-INFO-LINE-1      TO CLOANO
CIDMOD     ELSE
CIDMOD        MOVE SPACES              TO CLOANO
CIDMOD     END-IF
CIDMOD
01768      IF CL-SYSTEM-IDENTIFIER = 'CV'
01769          PERFORM 1500-READ-CONVENIENCE-FILES THRU 1500-EXIT
01770          GO TO 1050-SHOW-CONTINUE.
01771
01772      EXEC CICS HANDLE CONDITION
01773          NOTFND   (1100-SHOW-RECORD-NOT-FOUND)
01774      END-EXEC.
01775
01776      MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
01777      MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
01778      MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
01779      MOVE CL-CERT-STATE          TO CERT-STATE.
01780      MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
01781      MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
01782      MOVE CL-CERT-NO             TO CERT-CERT-NO.
01783      MOVE 'CERT'                 TO FILE-SWITCH.
01784
01785      EXEC CICS READ
01786          DATASET   ('ELCERT')
01787          SET       (ADDRESS OF CERTIFICATE-MASTER)
01788          RIDFLD    (ELCERT-KEY)
01789      END-EXEC.
01790
01791      MOVE 'Y'                    TO WS-CERT-READ-SW.
01792      MOVE LOW-VALUES             TO ERACCT-KEY.
01793      MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
01794      MOVE CL-CERT-CARRIER        TO ACCT-CARRIER.
01795      MOVE CL-CERT-GROUPING       TO ACCT-GROUPING.
01796      MOVE CL-CERT-STATE          TO ACCT-STATE.
01797      MOVE CL-CERT-ACCOUNT        TO ACCT-ACCOUNT.
01798      MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT.
01799      MOVE 'ACCT'                 TO FILE-SWITCH.
01800
01801      MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
01802      MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
01803
01804      EXEC CICS HANDLE CONDITION
01805           NOTFND   (1005-NO-ERACCT)
01806           ENDFILE  (1005-NO-ERACCT)
01807      END-EXEC.
01808
01809      EXEC CICS STARTBR
01810           DATASET   ('ERACCT')
01811           RIDFLD    (ERACCT-KEY)
01812           GTEQ
01813      END-EXEC.
01814
01815  1005-READ-NEXT-ACCOUNT.
01816
01817      EXEC CICS READNEXT
01818           DATASET   ('ERACCT')
01819           SET       (ADDRESS OF ACCOUNT-MASTER)
01820           RIDFLD    (ERACCT-KEY)
01821      END-EXEC.
01822
01823      IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
01824         IF WS-ERACCT-HOLD-RECORD = SPACES
01825            GO TO 1005-NO-ERACCT
01826         ELSE
01827            MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
01828            GO TO 1005-CONTINUE.
01829
01830      IF ACCT-EXP-DT = HIGH-VALUES
01831         NEXT SENTENCE
01832      ELSE
01833         MOVE ACCOUNT-MASTER      TO WS-ERACCT-HOLD-RECORD
01834         GO TO 1005-READ-NEXT-ACCOUNT.
01835
01836  1005-CONTINUE.
01837
01838      IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
01839         MOVE ZEROS               TO AM-3RD-PARTY-NOTIF-LEVEL.
01840
01841      IF AM-3RD-PARTY-NOTIF-LEVEL > ZERO
01842         MOVE 'THIRD PARTY'       TO NOTIFYO.
01843
01844  1005-NO-ERACCT.
01845
050107     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
050107        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
050107        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
050107            MOVE 'N' TO PI-JOINT-INSURED-IND
050107     ELSE
050107            MOVE 'Y' TO PI-JOINT-INSURED-IND
050107     END-IF.
050107
01846      IF CM-SING-PRM
01847          MOVE 'SING PRM'         TO PRMTYPEO
01848      ELSE
01849          IF CM-O-B-COVERAGE
01850              MOVE 'OUT BAL'      TO PRMTYPEO
01851          ELSE
01852              MOVE 'OPEN END'     TO PRMTYPEO.
01853
01854      IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
01855         GO TO 1006-CALC-LIFE.
01856
01857      MOVE 'MO. BENEFIT :'       TO BENECAPO.
01858      MOVE CM-CERT-EFF-DT        TO CP-CERT-EFF-DT.
01859      MOVE CM-LOAN-1ST-PMT-DT    TO CP-FIRST-PAY-DATE.
01860
01861      IF PI-COMPANY-ID = 'DMD'
01862          PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
01863          MOVE W-PAYMENTS         TO NOPMTSO
01864          GO TO 1005-RTRM-CONT
01865      ELSE
01866          MOVE SAVE-BIN-DATE      TO CP-VALUATION-DT
01867          MOVE SPACES             TO W-PAYMENTS
01868          MOVE CL-NO-OF-PMTS-MADE TO W-PYMTS
01869          MOVE W-PAYMENTS         TO NOPMTSO.
01870
01871      IF CM-AH-ORIG-TERM = +0
01872         MOVE +1                 TO CP-ORIGINAL-TERM
01873      ELSE
01874         MOVE CM-AH-ORIG-TERM    TO CP-ORIGINAL-TERM.
01875
01876      MOVE PI-REM-TRM-CALC-OPTION
01877                                 TO CP-REM-TRM-CALC-OPTION.
01878      MOVE '4'                   TO CP-REM-TERM-METHOD.
01879      MOVE PI-COMPANY-ID         TO CP-COMPANY-ID
01880      PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
01881      PERFORM 9800-LINK-REM-TERM.
01882      MOVE CP-REMAINING-TERM-3   TO WST-REM.
01883
01884  1005-RTRM-CONT.

061013     move zeros                  to pi-max-benefit
061013     if pi-company-id = 'DCC'
061013        and am-dcc-product-code not = '   '
061013        move ' '                 to ws-pdef-record-sw
061013        perform 3997-get-erpdef  thru 3997-exit
061013        if pdef-found
061013           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
061013              (P1 > +8)
061013              OR (PD-PROD-CODE (P1) = cl-claim-type)
061013           END-PERFORM
061013           IF P1 < +9
061013              MOVE PD-MAX-AMT (P1)
061013                                 TO pi-max-benefit
061013           END-IF
061013        end-if
061013     end-if
061013     if (pi-max-benefit not = zeros)
061013        and (cm-ah-benefit-amt > pi-max-benefit)
061013        move pi-max-benefit      to beneo
061013     else
061013        MOVE CM-AH-BENEFIT-AMT   TO BENEO
061013     end-if

01888      MOVE CM-POLICY-FORM-NO     TO PI-SAVE-FORM.
01889      MOVE CM-STATE              TO PI-CR-STATE.
01890      MOVE WS-TERMS              TO TERMSO.
01891      MOVE CM-AH-ORIG-TERM       TO WST-ORIG
01892                                    DC-ELAPSED-MONTHS
01893      MOVE WS-TERMS              TO TERMSO.
01894      MOVE CM-AH-CURRENT-STATUS TO WS-STATUS.
01895
01896      IF PI-COMPANY-ID = 'AIG' OR 'AUK'
01897          MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
01898          MOVE '6'                    TO  DC-OPTION-CODE
01899          MOVE '1'                    TO  DC-END-OF-MONTH
01900          MOVE +0                     TO  DC-ELAPSED-DAYS
01901                                          DC-ODD-DAYS-OVER
01902          COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1
01903          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01904          IF NO-CONVERSION-ERROR
01905              MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
01906          ELSE
01907              MOVE SPACES                 TO  EXPIREO
01908      ELSE
01909          MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
01910          MOVE ' '                    TO  DC-OPTION-CODE
01911          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01912          IF NO-CONVERSION-ERROR
01913              MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
01914          ELSE
01915              MOVE SPACES                 TO  EXPIREO.
01916
01917      GO TO 1009-CONTINUE-BUILD.
01918
01919  1006-CALC-LIFE.
01920
01921      MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
01922      MOVE '4'                    TO CNTL-REC-TYPE.
01923      MOVE SPACES                 TO CNTL-ACCESS.
01924      MOVE CM-LF-BENEFIT-CD       TO CNTL-BEN-NO.
01925      MOVE +0                     TO CNTL-SEQ-NO.
01926      MOVE 'CNTL'                 TO FILE-SWITCH.
01927
01928      EXEC CICS HANDLE CONDITION
01929           NOTFND    (1008-NOTFND)
01930           ENDFILE   (1008-NOTFND)
01931      END-EXEC.
01932
01933      EXEC CICS READ
01934          DATASET   ('ELCNTL')
01935          SET       (ADDRESS OF CONTROL-FILE)
01936          RIDFLD    (ELCNTL-KEY)
01937          GTEQ
01938      END-EXEC.
01939
01940      IF PI-COMPANY-ID NOT = CF-COMPANY-ID OR
01941         CF-RECORD-TYPE NOT = '4'
01942           GO TO 1008-NOTFND.
01943
01944      MOVE +1 TO WS-INDEX.
01945
01946  1007-TABLE-LOOKUP.
01947
01948      IF CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (WS-INDEX)
01949         MOVE CF-LF-COVERAGE-TYPE (WS-INDEX) TO CP-BENEFIT-TYPE
01950                                                WS-LF-COVERAGE-TYPE
01951         MOVE CF-CO-EARNINGS-CALC (WS-INDEX) TO WS-EARNING-METHOD
01952         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)  TO CP-SPECIAL-CALC-CD
01953         GO TO 1008-CONTINUE.
01954
01955      IF CF-BENEFIT-CODE (WS-INDEX) NOT < CF-HI-BEN-IN-REC
01956         GO TO 1008-NOTFND.
01957
01958      IF WS-INDEX < +8
01959         ADD +1 TO WS-INDEX
01960         GO TO 1007-TABLE-LOOKUP.
01961
01962  1008-NOTFND.
01963
01964      MOVE ZEROS TO BENEO.
01965      GO TO 1009-CONTINUE-BUILD.
01966
01967  1008-CONTINUE.
01968
01969      MOVE CM-CERT-EFF-DT        TO CP-CERT-EFF-DT.
01970      MOVE CM-LOAN-1ST-PMT-DT    TO CP-FIRST-PAY-DATE.
01971      MOVE CL-INCURRED-DT        TO CP-VALUATION-DT.
01972
01973      IF CM-LF-ORIG-TERM = +0
01974         MOVE +1                TO CP-ORIGINAL-TERM
01975      ELSE
01976         MOVE CM-LF-ORIG-TERM   TO CP-ORIGINAL-TERM.
01977
01978      MOVE CM-LF-ORIG-TERM      TO WST-ORIG
01979                                   DC-ELAPSED-MONTHS.
01980      MOVE CM-LF-CURRENT-STATUS TO WS-STATUS.
01981
01982      IF PI-COMPANY-ID = 'AIG' OR 'AUK'
01983          MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
01984          MOVE '6'                    TO  DC-OPTION-CODE
01985          MOVE '1'                    TO  DC-END-OF-MONTH
01986          MOVE +0                     TO  DC-ELAPSED-DAYS
01987                                          DC-ODD-DAYS-OVER
01988          COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
01989          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01990          IF NO-CONVERSION-ERROR
01991              MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
01992          ELSE
01993              MOVE SPACES                 TO  EXPIREO
01994      ELSE
01995          MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
01996          MOVE ' '                    TO  DC-OPTION-CODE
01997          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
01998          IF NO-CONVERSION-ERROR
01999              MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
02000          ELSE
02001              MOVE SPACES                 TO  EXPIREO.
02002
02003      MOVE PI-REM-TRM-CALC-OPTION
02004                                 TO CP-REM-TRM-CALC-OPTION.
02005      MOVE '4'                   TO CP-REM-TERM-METHOD.
02006      MOVE WS-EARNING-METHOD     TO CP-EARNING-METHOD.
02007      MOVE PI-COMPANY-ID         TO CP-COMPANY-ID.
02008      PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
02009      PERFORM 9800-LINK-REM-TERM.
02010
02011      MOVE CP-REMAINING-TERM-3    TO WST-REM.
02012      MOVE SPACES                 TO WST-REM-DAYS-GRP
02013                                     WST-ORIG-DAYS-GRP.
02014      MOVE WS-TERMS               TO TERMSO.
02015
02016      MOVE SPACES                 TO W-PAYMENTS
02017      MOVE CL-NO-OF-PMTS-MADE     TO W-PYMTS
02018      MOVE W-PAYMENTS             TO NOPMTSO.
02019
02020  1009-CALC-REM-AMT.
02021
02022      MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
02023      MOVE PI-STATE               TO WS-ST-ACCESS.
02024      MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
02025      MOVE '3'                    TO CNTL-REC-TYPE.
02026      MOVE +0                     TO CNTL-SEQ-NO.
02027      MOVE 'CNTL'                 TO  FILE-SWITCH.
02028
02029      EXEC CICS HANDLE CONDITION
02030          NOTFND   (1009-CONTINUE-BUILD)
02031          ENDFILE  (1009-CONTINUE-BUILD)
02032      END-EXEC.
02033
02034      EXEC CICS READ
02035          DATASET   ('ELCNTL')
02036          SET       (ADDRESS OF CONTROL-FILE)
02037          RIDFLD    (ELCNTL-KEY)
02038      END-EXEC.
02039
02040      MOVE CF-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
CIDMOD     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
02041
02042      IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
02043         MOVE ZEROS                 TO BENEO
02044      ELSE
02045         MOVE CP-REMAINING-TERM-3   TO CP-REMAINING-TERM
02046         MOVE CM-LF-BENEFIT-AMT     TO CP-ORIGINAL-BENEFIT
02047         MOVE CM-LF-ALT-BENEFIT-AMT TO CP-ALTERNATE-BENEFIT
02048         MOVE CM-LOAN-APR           TO CP-LOAN-APR
02049         MOVE CM-LOAN-TERM          TO CP-LOAN-TERM
02050         MOVE CM-PAY-FREQUENCY      TO CP-PAY-FREQUENCY
061013        if pi-company-id = 'DCC'
061013           and am-dcc-product-code not = '   '
061013           move ' '              to ws-pdef-record-sw
061013           perform 3997-get-erpdef
061013                                 thru 3997-exit
061013           if pdef-found
061013              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
061013                 (P1 > +8)
061013                 OR (PD-PROD-CODE (P1) = 'L')
061013              END-PERFORM
061013              IF P1 < +9
061013                 MOVE PD-MAX-AMT (P1)
061013                                 TO CP-R-MAX-TOT-BEN
061013              END-IF
061013           end-if
061013        end-if
02051         PERFORM 9850-LINK-REM-AMT THRU 9850-EXIT
02052         MOVE CP-REMAINING-AMT      TO BENEO.
02053
02054      IF PI-LIFE-OVERRIDE-L1 = 'P' OR
02055         WS-LF-COVERAGE-TYPE = 'P'
02056          COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
02057                                     CM-LF-ITD-DEATH-AMT
02058          MOVE WS-REMAINING-AMT    TO  BENEO.
02059
02060  1009-CONTINUE-BUILD.
02061
02062      MOVE CM-POLICY-FORM-NO  TO PI-SAVE-FORM.
02063
02064      IF WS-STATUS = '6' OR '7' OR '8'
02065         MOVE AL-SABOF              TO CRTSTATA.
02066
02067      IF WS-STATUS = '1' OR '4'
02068         IF CP-REMAINING-TERM-3 = ZEROS
02069            MOVE 'EXPIRED'        TO CRTSTATO
02070         ELSE
02071            MOVE 'ACTIVE  '       TO CRTSTATO.
02072
02073      IF WS-STATUS = '2'
02074          MOVE 'PEND    '         TO CRTSTATO.
02075
02076      IF WS-STATUS = '3'
02077          MOVE 'RESTORE '         TO CRTSTATO.
02078
02079      IF WS-STATUS = '5'
02080          MOVE 'REISSUE '         TO CRTSTATO.
02081
02082      IF WS-STATUS = '6'
02083          MOVE 'LMP DIS'          TO CRTSTATO.
02084
02085      IF WS-STATUS = '7'
02086          MOVE 'DEATH'            TO CRTSTATO.
02087
02088      IF WS-STATUS = '8'
02089          MOVE 'CANCEL'           TO CRTSTATO.
02090
02091      IF WS-STATUS = '9'
02092          MOVE 'RE-ONLY '         TO CRTSTATO.
02093
02094      IF WS-STATUS = 'D'
02095          MOVE 'DECLINE'          TO CRTSTATO.
02096
02097      IF WS-STATUS = 'V'
02098          MOVE 'VOID'             TO CRTSTATO.
02099
052614     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
02101         MOVE CM-AH-BENEFIT-CD    TO WS-BEN-CD
02102         MOVE '5'                 TO CNTL-REC-TYPE
           END-IF
02103
02104      IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
02105          MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
02106          MOVE '4'                TO CNTL-REC-TYPE.
02107
02108      MOVE '** NONE **'           TO COVERO.
02109
02110      IF WS-BEN-CD = ZERO
02111          MOVE AL-SABOF           TO COVERA
02112          MOVE SPACES             TO CRTSTATO
02113          GO TO 1050-SHOW-CONTINUE.
02114
02115  1010-SHOW-CONTINUE.
02116      MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
02117      MOVE WS-ACCESS              TO CNTL-ACCESS.
02118      MOVE +0                     TO CNTL-SEQ-NO.
02119      MOVE 'CNTL'                 TO FILE-SWITCH.
02120
02121      EXEC CICS HANDLE CONDITION
02122          ENDFILE   (1050-SHOW-CONTINUE)
02123          NOTFND    (1050-SHOW-CONTINUE)
02124      END-EXEC.
02125
02126      EXEC CICS READ
02127          DATASET   ('ELCNTL')
02128          SET       (ADDRESS OF CONTROL-FILE)
02129          RIDFLD    (ELCNTL-KEY)
02130          GTEQ
02131      END-EXEC.
02132
02133      IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID) OR
02134         (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
02135            GO TO 1050-SHOW-CONTINUE.
02136
02137      PERFORM 1030-BENEFIT-DUMMY THRU 1030-EXIT
02138          VARYING SUB-1 FROM 1 BY 1 UNTIL
02139             ((SUB-1 > 8) OR
02140             (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
02141
02142      IF SUB-1 NOT = 9
02143          MOVE CF-BENEFIT-DESCRIP (SUB-1) TO COVERO
050107         MOVE CF-JOINT-INDICATOR (SUB-1) TO PI-JOINT-COV-IND
02144        ELSE
02145          IF CRTSTATO = 'ACTIVE'
02146              MOVE SPACES         TO  CRTSTATO.
02147
02148      GO TO 1050-SHOW-CONTINUE.
02149
02150  1030-BENEFIT-DUMMY.
02151  1030-EXIT.
02152      EXIT.
02153
02154  1050-SHOW-CONTINUE.
02155
02156      IF CL-PURGED-DT NOT = LOW-VALUES
02157          MOVE 'Y'                        TO  PI-PURGED-SW
02158          MOVE AL-SANOF                   TO  FILETOA    PRTOPTA
02159                                              FORMATA    ALTPRTA
02160                                              ACTCDA     ASSOCA
CIDMOD                                             CLOANA
02161          MOVE 'CLAIM IS PURGED - '       TO  WS-PURGED-MSG
02162          MOVE CL-PURGED-DT               TO  DC-BIN-DATE-1
02163          MOVE ' '                        TO  DC-OPTION-CODE
02164          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
02165          IF NO-CONVERSION-ERROR
02166              MOVE DC-GREG-DATE-1-EDIT    TO  WS-PURGED-DATE
02167              MOVE WS-PURGED-MESSAGE      TO  MAP-DISPLAY (1)
02168          ELSE
02169              MOVE SPACES                 TO  WS-PURGED-DATE
02170              MOVE WS-PURGED-MESSAGE      TO  MAP-DISPLAY (1)
02171      ELSE
02172          MOVE 'N'                        TO  PI-PURGED-SW
02173          PERFORM 2000-BUILD-TRAILER-DISPLAY THRU 2999-EXIT.
02174
02175      IF PI-COMPANY-ID = 'DMD'
02176         MOVE COVERO                  TO  CRTSTATO
02177         IF CL-LAST-PMT-AMT NOT = ZERO
02178            MOVE CL-LAST-PMT-DT       TO  DC-BIN-DATE-1
02179            MOVE ' '                  TO  DC-OPTION-CODE
02180            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
02181            MOVE DC-GREG-DATE-1-EDIT  TO  PRMTYPEO
02182            MOVE CL-LAST-PMT-AMT      TO  WS-PMT-AMT
02183            MOVE WS-PMT-AMTD          TO  COVERO
02184          ELSE
02185            MOVE SPACES               TO  COVERO
02186                                          PRMTYPEO.
02187
02188      IF RETURNED-FROM NOT = SPACES
02189          GO TO 8250-SEND-WITH-CURSOR.
02190
02191      IF CLAIM-IS-PURGED
082707        CONTINUE 
082707*        MOVE -1                 TO  MCRFLML
02193      ELSE
02194          MOVE -1                 TO  FILETOL
082707     END-IF
02195
02196      IF PI-COMPANY-ID = 'DMD'
02197          IF CONFIDENTIAL-DATA
02198              IF PI-CONFIDENTIAL-UP
02199                  MOVE LOW-VALUE  TO PI-PRIORITY-IND
02200                  MOVE ER-0932    TO EMI-ERROR
02201                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02202              ELSE
02203                  MOVE 'C'        TO PI-PRIORITY-IND
02204                  EXEC CICS SEND TEXT
02205                      FROM     (W-CONF-TEXT)
02206                      LENGTH   (W-CONF-LENGTH)
02207                      ERASE
02208                      FREEKB
02209                  END-EXEC
02210                  GO TO 9100-RETURN-TRAN.
02211
02212      GO TO 8100-SEND-INITIAL-MAP.
02213
02214  1100-SHOW-RECORD-NOT-FOUND.
02215
02216      IF FILE-SWITCH = 'MSTR'
02217          IF PI-CURRENT-FILE = 'ELRETR'
02218              MOVE ER-0204        TO EMI-ERROR
02219          ELSE
02220              MOVE 'Y'            TO PI-RETRIEVED-DATA-IND
02221              MOVE 'ELRETR'       TO PI-CURRENT-FILE
02222              GO TO 1000-READ-CLAIM
02223      ELSE
02224          MOVE ER-0206            TO EMI-ERROR.
02225
02226      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02227
030612     IF FILE-SWITCH = 'CERT' AND 
030612      (PI-COMPANY-ID = 'CID' OR 'AHL')
02229         GO TO 1050-SHOW-CONTINUE.
02230
02231      MOVE -1                     TO CLMNOL.
02232
02233      MOVE PI-CARRIER             TO CARRO.
02234      MOVE PI-CLAIM-NO            TO CLMNOO.
02235      MOVE PI-CERT-PRIME          TO CERTNOO.
02236      MOVE PI-CERT-SFX            TO SUFXO.
02237
02238      MOVE AL-UABON               TO CLMNOA   CARRA
CIDMOD                                    YESNOSWA
02239                                     CERTNOA  SUFXA.
02240
02241      GO TO 8100-SEND-INITIAL-MAP.
02242      EJECT
02243  1200-GET-ASS-TOTALS.
02244
02245      MOVE CL-ASSOC-CERT-SEQU     TO PI-ASS-NDX.
02246
02247      IF RETURNED-FROM NOT = 'EL156' AND 'EL1501' AND 'EL1502'
02248          IF PI-ASS-PROCESSING
02249                  AND
02250             PI-ASS-CERTS (PI-ASS-NDX) = CL-CERT-NO
02251                  AND
02252             PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
02253              GO TO 1200-SET-UP-FIELDS.
02254
02255      MOVE CL-ASSOC-CERT-SEQU      TO PI-LAST-SEQ-NO.
02256
02257      IF EIBAID = DFHPF15 OR DFHPF16
02258          EXEC CICS ENDBR
02259              DATASET   (PI-CURRENT-FILE)
02260          END-EXEC.
02261
02262      MOVE CLAIM-MASTER           TO W-CLAIM-MASTER-SAVE.
02263      MOVE ZEROS                  TO PI-DAYS-PAID
02264                                     PI-TOTAL-PAID.
02265      MOVE LOW-VALUES             TO PI-ASSOCIATED-CERTS-TABLE
02266                                     PI-LAST-PF-KEY-IND
02267                                     PI-ASSOCIATED-PROCESS-IND
02268      MOVE SPACES                 TO MSTR-CERT-NO.
02269
02270      IF RETURNED-FROM = 'EL156'
02271              AND
02272         PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
02273          MOVE SPACES             TO RETURNED-FROM
02274      ELSE
02275          MOVE SPACES             TO RETURNED-FROM
02276          MOVE CL-CONTROL-PRIMARY TO PI-ORIGINAL-ASS-CERT.
02277
02278      EXEC CICS HANDLE CONDITION
02279          NOTFND   (1220-NO-CLAIM-RECORD-FND)
02280          ENDFILE  (1200-ENDBR)
02281      END-EXEC.
02282
02283      EXEC CICS STARTBR
02284           DATASET   (PI-CURRENT-FILE)
02285           RIDFLD    (ELMSTR-KEY)
02286      END-EXEC.
02287
02288  1200-GET-NEXT-RECORD.
02289
02290      EXEC CICS READNEXT
02291           DATASET   (PI-CURRENT-FILE)
02292           RIDFLD    (ELMSTR-KEY)
02293           INTO      (CLAIM-MASTER)
02294      END-EXEC.
02295
02296      IF PI-PREV-COMP-CD  NOT = CL-COMPANY-CD  OR
02297         PI-PREV-CARRIER  NOT = CL-CARRIER     OR
02298         PI-PREV-CLAIM-NO NOT = CL-CLAIM-NO
02299          GO TO 1200-ENDBR.
02300
02301      IF CL-PRIME-CERT-NO NOT = PI-PREV-PRIME-CERT-NO
02302          GO TO 1200-GET-NEXT-RECORD.
02303
02304      ADD CL-TOTAL-PAID-AMT       TO PI-TOTAL-PAID.
02305      ADD CL-NO-OF-DAYS-PAID      TO PI-DAYS-PAID.
02306
02307      MOVE CL-ASSOC-CERT-SEQU     TO PI-ASS-NDX.
02308      MOVE CL-CERT-NO             TO PI-ASS-CERTS (PI-ASS-NDX).
02309
02310      GO TO 1200-GET-NEXT-RECORD.
02311
02312  1200-ENDBR.
02313
02314      EXEC CICS ENDBR
02315          DATASET   (PI-CURRENT-FILE)
02316      END-EXEC.
02317
02318      MOVE W-CLAIM-MASTER-SAVE    TO CLAIM-MASTER.
02319      MOVE PI-LAST-SEQ-NO         TO PI-ASS-NDX.
02320
02321  1200-SET-UP-FIELDS.
02322
02323      MOVE 'Y'                    TO PI-ASSOCIATED-PROCESS-IND.
02324      MOVE PI-DAYS-PAID           TO W-DAYS-PAID-X.
02325      MOVE PI-TOTAL-PAID          TO W-TOTAL-PAID-AMT-X.
02326      MOVE W-TOTAL-PAID-AMT-X     TO AMTPDO.
02327      MOVE W-DAYS-PAID-X          TO DAYSPDO.
02328      MOVE 'CLAIM TOTALS...AMOUNT PD:'
02329                                  TO CLMTOTHO.
02330      MOVE 'DAYS PAID:'           TO DAYSPDHO.
02331
02332  1200-EXIT.
02333      EXIT.
02334
02335  1220-NO-CLAIM-RECORD-FND.
02336
02337      MOVE ER-0204                TO EMI-ERROR.
02338
02339      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02340
030612     IF FILE-SWITCH = 'CERT' AND 
030612       (PI-COMPANY-ID = 'CID' OR 'AHL')
02342          GO TO 1050-SHOW-CONTINUE.
02343
02344      MOVE -1                     TO CLMNOL.
02345
02346      MOVE PI-CARRIER             TO CARRO.
02347      MOVE PI-CLAIM-NO            TO CLMNOO.
02348      MOVE PI-CERT-PRIME          TO CERTNOO.
02349      MOVE PI-CERT-SFX            TO SUFXO.
02350
02351      MOVE AL-UABON               TO CLMNOA   CARRA
02352                                     CERTNOA  SUFXA.
02353
02354      GO TO 8100-SEND-INITIAL-MAP.
02355      EJECT
02356  1500-READ-CONVENIENCE-FILES.
02357
02358      EXEC CICS HANDLE CONDITION
02359          NOTFND   (1500-SHOW-RECORD-NOT-FOUND)
02360      END-EXEC.
02361
02362      MOVE PI-COMPANY-CD              TO  PLCY-COMP-CD.
02363      MOVE CL-CERT-CARRIER            TO  PLCY-CARRIER.
02364      MOVE CL-CERT-GROUPING           TO  PLCY-GROUPING.
02365      MOVE CL-CERT-STATE              TO  PLCY-STATE.
02366      MOVE CL-CERT-ACCOUNT            TO  PLCY-PRODUCER.
02367      MOVE CL-CERT-EFF-DT             TO  PLCY-EFF-DT.
02368      MOVE CL-CV-REFERENCE-NO         TO  PLCY-REFERENCE-NO.
02369      MOVE 'PLCY'                     TO  FILE-SWITCH.
02370
02371      EXEC CICS READ
02372          DATASET   ('MPPLCY')
02373          SET       (ADDRESS OF POLICY-MASTER)
02374          RIDFLD    (EMPLCY-KEY)
02375      END-EXEC.
02376
02377      MOVE 'Y'                        TO  WS-CERT-READ-SW.
02378
02379      PERFORM 1700-READ-EMPHST THRU 1700-EXIT.
02380
02381  1500-READ-EMPLAN.
02382
02383      MOVE PM-COMPANY-CD              TO  PLAN-COMP-CD.
02384      MOVE PM-CARRIER                 TO  PLAN-CARRIER.
02385      MOVE PM-GROUPING                TO  PLAN-GROUPING.
02386      MOVE PM-STATE                   TO  PLAN-STATE.
02387      MOVE PM-PRODUCER                TO  PLAN-PRODUCER.
02388      MOVE PM-INS-PLAN-CD             TO  PLAN-PLAN-CODE.
02389      MOVE PM-INS-PLAN-REVISION       TO  PLAN-REV-NO.
02390      MOVE 'PLAN'                     TO  FILE-SWITCH.
02391
02392      EXEC CICS HANDLE CONDITION
02393          NOTFND   (1500-NO-PLAN-RECORD)
02394      END-EXEC.
02395
02396      EXEC CICS READ
02397          DATASET   ('MPPLAN')
02398          RIDFLD    (EMPLAN-KEY)
02399          SET       (ADDRESS OF PRODUCER-PLANS)
02400      END-EXEC.
02401
02402      MOVE PP-PLAN-ABBREV             TO  COVERO.
02403      MOVE PP-REFUND-CALC             TO  CP-EARNING-METHOD
02404                                          CP-RATING-METHOD.
02405      IF PP-BENEFIT-IS-LEVEL
02406          MOVE 'L'                    TO  CP-BENEFIT-TYPE
02407      ELSE
02408          MOVE 'R'                    TO  CP-BENEFIT-TYPE.
02409
02410      MOVE PM-LOAN-TERM               TO  CP-ORIGINAL-TERM
02411                                          CP-LOAN-TERM.
02412      MOVE SAVE-BIN-DATE              TO  CP-VALUATION-DT.
02413      MOVE PM-POLICY-EFF-DT           TO  CP-CERT-EFF-DT.
02414      MOVE PM-STATE                   TO  CP-STATE.
02415      MOVE 'A'                        TO  CP-SPECIAL-CALC-CD.
02416      MOVE '2'                        TO  CP-PROCESS-TYPE.
02417      MOVE PI-COMPANY-ID              TO  CP-COMPANY-ID.
02418      MOVE PI-COMPANY-CD              TO  CP-COMPANY-CD.
02419      MOVE '1'                        TO  CP-REM-TRM-CALC-OPTION.
02420
02421      IF PM-AH-MORT-PLAN
02422          MOVE '3'                    TO  CP-REM-TERM-METHOD
02423          MOVE PM-LOAN-DT             TO  CP-FIRST-PAY-DATE
02424      ELSE
02425          MOVE '2'                    TO  CP-REM-TERM-METHOD
02426          MOVE PM-POLICY-EFF-DT       TO  CP-FIRST-PAY-DATE.
02427
02428      PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
02429      PERFORM 9800-LINK-REM-TERM.
02430
02431      IF PM-AH-MORT-PLAN
02432        MOVE CP-REMAINING-TERM-1    TO  WST-REM
02433      ELSE
02434        IF PI-COMPANY-ID = 'CIG' OR 'CUK'
02435          COMPUTE CP-REMAINING-TERM-3 = CP-REMAINING-TERM-3 + 1
02436          MOVE CP-REMAINING-TERM-3    TO  WST-REM
02437        ELSE
02438          MOVE CP-REMAINING-TERM-3    TO  WST-REM.
02439
02440      GO TO 1500-SHOW-CONTINUE.
02441
02442  1500-NO-PLAN-RECORD.
02443
02444      MOVE ZEROS                      TO  WST-REM.
02445      MOVE '** NONE **'               TO  COVERO.
02446
02447  1500-SHOW-CONTINUE.
02448
02449      MOVE PM-LOAN-TERM               TO  WST-ORIG.
02450      MOVE WS-TERMS                   TO  TERMSO.
02451
02452      IF PM-AH-MORT-PLAN
02453          MOVE 'MO. BENEFIT :'        TO  BENECAPO
02454          MOVE PM-INS-MONTH-BENEFIT   TO  BENEO
02455      ELSE
02456          MOVE PM-INS-TOTAL-BENEFIT   TO  BENEO.
02457
02458      IF PM-ANNUAL
02459          MOVE 'ANNUAL'              TO  PRMTYPEO
02460        ELSE
02461      IF PM-SEMI-ANNUAL
02462          MOVE 'SEMI ANL'            TO  PRMTYPEO
02463        ELSE
02464      IF PM-QUARTERLY
02465          MOVE 'QTRLY'               TO  PRMTYPEO
02466        ELSE
02467      IF PM-BI-MONTHLY
02468          MOVE 'BI MONTH'            TO  PRMTYPEO
02469        ELSE
02470      IF PM-SINGLE-PREM
02471          MOVE 'SING PRM'            TO  PRMTYPEO.
02472
02473      MOVE PM-POLICY-EFF-DT           TO  DC-BIN-DATE-1.
02474      MOVE '6'                        TO  DC-OPTION-CODE.
02475      MOVE PM-LOAN-TERM               TO  DC-ELAPSED-MONTHS.
02476      MOVE +0                         TO  DC-ELAPSED-DAYS.
02477      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
02478      IF NO-CONVERSION-ERROR
02479          MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
02480      ELSE
02481          MOVE SPACES                 TO  EXPIREO.
02482
02483      IF PM-CURRENT-STATUS = '0'
02484          MOVE 'LAPSED'               TO  CRTSTATO.
02485      IF PM-CURRENT-STATUS = '1'
02486          MOVE 'ACTIVE'               TO  CRTSTATO.
02487      IF PM-CURRENT-STATUS = '2'
02488          MOVE 'PENDING'              TO  CRTSTATO.
02489      IF PM-CURRENT-STATUS = '3'
02490          MOVE 'DECLINE'              TO  CRTSTATO.
02491      IF PM-CURRENT-STATUS = '4' OR '9'
02492          MOVE 'PND CANC'             TO  CRTSTATO.
02493      IF PM-CURRENT-STATUS = '5'
02494          MOVE 'PND ISS'              TO  CRTSTATO.
02495      IF PM-CURRENT-STATUS = '6'
02496          MOVE 'CLAIM'                TO  CRTSTATO.
02497      IF PM-CURRENT-STATUS = '7'
02498          MOVE 'CANCEL'               TO  CRTSTATO.
02499      IF PM-CURRENT-STATUS = '8'
02500          MOVE 'PND UNDW'             TO  CRTSTATO.
02501      IF PM-CURRENT-STATUS = 'C'
02502          MOVE 'TRANSFER'             TO  CRTSTATO.
02503      IF PM-CURRENT-STATUS = 'F'
02504          MOVE 'SETTLE'               TO  CRTSTATO.
02505      IF PM-CURRENT-STATUS = 'T'
02506          MOVE 'TRMNAT'               TO  CRTSTATO.
02507
02508      GO TO 1500-EXIT.
02509
02510  1500-SHOW-RECORD-NOT-FOUND.
02511
02512      IF FILE-SWITCH = 'PLCY'
02513          MOVE ER-9483            TO  EMI-ERROR.
02514
02515      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02516      MOVE -1                     TO  CLMNOL.
02517      MOVE PI-CARRIER             TO  CARRO.
02518      MOVE PI-CLAIM-NO            TO  CLMNOL.
02519      MOVE PI-CERT-PRIME          TO  CERTNOO.
02520      MOVE PI-CERT-SFX            TO  SUFXO.
02521
02522      MOVE AL-UABON               TO  CLMNOA    CARRA
02523                                      CERTNOA   SUFXA.
02524      GO TO 8100-SEND-INITIAL-MAP.
02525
02526  1500-EXIT.
02527      EXIT.
02528
02529      EJECT
02530  1600-ROLL-TRAILERS.
02531      MOVE SPACES                 TO MAP-DISPLAY (1)
02532                                     MAP-DISPLAY (2)
02533                                     MAP-DISPLAY (3)
02534                                     MAP-DISPLAY (4).
02535
02536      PERFORM 2000-BUILD-TRAILER-DISPLAY THRU 2999-EXIT.
02537
02538      MOVE -1                     TO FILETOL.
02539      GO TO 8200-SEND-DATAONLY.
02540
02541      EJECT
02542 ***************************************************************
02543 *    I/O REQUESTS AGAINST THE CONVENIENCE POLICY HISTORY FILE *
02544 ***************************************************************
02545  1700-READ-EMPHST.
02546
02547      EXEC CICS HANDLE CONDITION
02548          ENDFILE  (1700-ENDBROWSE)
02549          NOTFND   (1700-ENDBROWSE)
02550      END-EXEC.
02551
02552      MOVE PM-COMPANY-CD          TO  EMPHST-COMPANY-CD.
02553      MOVE PM-CARRIER             TO  EMPHST-CARRIER.
02554      MOVE PM-GROUPING            TO  EMPHST-GROUPING.
02555      MOVE PM-STATE               TO  EMPHST-STATE.
02556      MOVE PM-PRODUCER            TO  EMPHST-PRODUCER.
02557      MOVE PM-POLICY-EFF-DT       TO  EMPHST-POLICY-EFF-DT.
02558      MOVE PM-REFERENCE-NUMBER    TO  EMPHST-REFERENCE-NUMBER.
02559      MOVE ZEROS                  TO  EMPHST-SEQUENCE-NO.
02560
02561      IF PM-LIFE-MORT-PLAN
02562          MOVE '02'                   TO  EMPHST-RECORD-TYPE
02563          MOVE '21'                   TO  EMPHST-FIELD-TYPE
02564      ELSE
02565          MOVE '04'                   TO  EMPHST-RECORD-TYPE
02566          MOVE '07'                   TO  EMPHST-FIELD-TYPE.
02567
02568      EXEC CICS STARTBR
02569          DATASET   (EMPHST-FILE-ID)
02570          RIDFLD    (EMPHST-KEY)
02571          GTEQ
02572      END-EXEC.
02573
02574      MOVE 'Y'                    TO  WS-BROWSE-START-SW.
02575
02576  1700-READ-NEXT.
02577
02578      EXEC CICS READNEXT
02579          DATASET   (EMPHST-FILE-ID)
02580          SET       (ADDRESS OF POLICY-HISTORY)
02581          RIDFLD    (EMPHST-KEY)
02582      END-EXEC.
02583
02584      IF PM-COMPANY-CD       = PH-COMPANY-CD         AND
02585         PM-CARRIER          = PH-CARRIER            AND
02586         PM-GROUPING         = EMPHST-GROUPING       AND
02587         PM-STATE            = EMPHST-STATE          AND
02588         PM-PRODUCER         = EMPHST-PRODUCER       AND
02589         PM-POLICY-EFF-DT    = EMPHST-POLICY-EFF-DT  AND
02590         PM-REFERENCE-NUMBER = EMPHST-REFERENCE-NUMBER
02591          NEXT SENTENCE
02592      ELSE
02593          GO TO 1700-ENDBROWSE.
02594
02595      IF PM-LIFE-MORT-PLAN
02596          IF PH-RECORD-TYPE = '02' AND
02597             PH-FIELD-TYPE  = '21'
02598              NEXT SENTENCE
02599          ELSE
02600              GO TO 1700-ENDBROWSE.
02601
02602      IF NOT PM-LIFE-MORT-PLAN
02603          IF PH-RECORD-TYPE = '04' AND
02604             PH-FIELD-TYPE  = '07'
02605              NEXT SENTENCE
02606          ELSE
02607              GO TO 1700-ENDBROWSE.
02608
02609      IF PH-CHANGE-DT > CL-INCURRED-DT
02610          GO TO 1700-READ-NEXT.
02611
02612      MOVE PH-RECORD-BODY         TO  WS-HISTORY-AREA.
02613
02614      EXEC CICS BIF
02615          DEEDIT
02616          FIELD (WS-HISTORY-AREA)
02617          LENGTH ('50')
02618      END-EXEC.
02619
02620      IF PM-LIFE-MORT-PLAN
02621          MOVE WS-NUMERIC-FLD1    TO  PM-INSURED-TOT-BENEFIT
02622      ELSE
02623          MOVE WS-NUMERIC-FLD1    TO  PM-INS-MONTH-BENEFIT.
02624
02625  1700-ENDBROWSE.
02626
02627      EXEC CICS ENDBR
02628          DATASET   (EMPHST-FILE-ID)
02629      END-EXEC.
02630
02631  1700-EXIT.
02632       EXIT.
02633
02634      EJECT
02635  2000-BUILD-TRAILER-DISPLAY.
02636
02637      IF DIRECTION-SWITCH = 'F'
02638         IF PI-PREV-DIR = 'B' AND PI-PREV-DISP = 'N'
02639            MOVE PI-SAVE-LOW    TO TRLR-SEQ-NO
02640         ELSE
02641            MOVE PI-SAVE-HIGH   TO TRLR-SEQ-NO
02642            ADD +1              TO TRLR-SEQ-NO
02643      ELSE
02644         IF DIRECTION-SWITCH = 'B'
02645            IF PI-PREV-DIR = 'F' AND PI-PREV-DISP = 'N'
02646               MOVE PI-SAVE-HIGH TO TRLR-SEQ-NO
02647            ELSE
02648               MOVE PI-SAVE-LOW TO TRLR-SEQ-NO
02649         ELSE
02650            IF DIRECTION-SWITCH = 'R'
02651               MOVE PI-SAVE-LOW TO TRLR-SEQ-NO
02652               MOVE 'F'        TO DIRECTION-SWITCH
02653            ELSE
02654               IF PI-COMPANY-ID = 'AIG' OR 'AUK'
02655                   MOVE +95     TO  TRLR-SEQ-NO
02656                   MOVE +0      TO  PI-SAVE-LOW
02657                                    PI-SAVE-HIGH
02658                   MOVE 'N'     TO  PI-PREV-DISP
02659                   MOVE 'F'     TO  DIRECTION-SWITCH
02660               ELSE
02661                   MOVE +93     TO  TRLR-SEQ-NO
02662                   MOVE +0      TO  PI-SAVE-LOW
02663                                    PI-SAVE-HIGH
02664                   MOVE 'N'     TO  PI-PREV-DISP
02665                   MOVE 'F'     TO  DIRECTION-SWITCH.
02666
02667      IF DIRECTION-SWITCH = 'F'
02668          MOVE +1                 TO DISPLAY-CNT
02669      ELSE
02670          MOVE +4                 TO DISPLAY-CNT.
02671
02672      MOVE PI-COMPANY-CD          TO TRLR-COMP-CD.
02673      MOVE PI-CARRIER             TO TRLR-CARRIER.
02674      MOVE PI-CLAIM-NO            TO TRLR-CLAIM-NO.
02675      MOVE PI-CERT-NO             TO TRLR-CERT-NO.
02676      MOVE 'TRLR'                 TO FILE-SWITCH.
02677
02678      IF PI-SAVE-SYS-ID = 'CV'
02679          NEXT SENTENCE
02680      ELSE
02681          GO TO 2005-BUILD-CR-LOAN-DATA.
02682
02683      IF WS-CERT-READ-SW = 'Y'
02684        IF PI-COMPANY-ID = 'CIG' OR 'CUK'
02685          IF CL-SYSTEM-IDENTIFIER = 'CV'
02686            MOVE PM-INS-TERMINATION-DT    TO  DC-BIN-DATE-1
02687            MOVE ' '                      TO  DC-OPTION-CODE
02688            MOVE +0                       TO  DC-ELAPSED-MONTHS
02689                                              DC-ELAPSED-DAYS
02690            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
02691            IF NO-CONVERSION-ERROR
02692                MOVE DC-GREG-DATE-1-EDIT  TO  WS-LOAN-EXPIRE-DT
02693            ELSE
02694                MOVE SPACES               TO  WS-LOAN-EXPIRE-DT.
02695
02696      IF WS-CERT-READ-SW = 'Y'
02697        IF PI-COMPANY-ID = 'CIG' OR 'CUK'
02698          MOVE SPACES                 TO  TRAILER-DISPLAY-WORK-AREA
02699          MOVE 'LOAN INFO'            TO  DISPLAY-ACTION
02700          MOVE ZEROS                  TO  DISPLAY-SEQ
02701          MOVE WS-LOAN-EXPIRE-DT      TO  DISPLAY-DATE
02702          MOVE PM-LOAN-NUMBER         TO  ASSOC-CV-LOAN
02703          MOVE ASSOC-CV-LOAN-TEXT     TO  DISPLAY-TEXT
02704          MOVE TRAILER-DISPLAY-WORK-AREA
02705                                      TO  MAP-DISPLAY (DISPLAY-CNT)
02706          ADD +1                      TO  DISPLAY-CNT.
02707
02708      GO TO 2010-CONTINUE-TRAILER-DISPLAY.
02709
02710  2005-BUILD-CR-LOAN-DATA.
02711
02712      IF WS-CERT-READ-SW = 'Y'
02713         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
02714           IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
02715             MOVE CM-LF-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
02716             MOVE ' '                     TO  DC-OPTION-CODE
02717             MOVE +0                      TO  DC-ELAPSED-MONTHS
02718                                              DC-ELAPSED-DAYS
02719             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
02720             IF NO-CONVERSION-ERROR
02721               MOVE DC-GREG-DATE-1-EDIT   TO  WS-LOAN-EXPIRE-DT
02722             ELSE
02723               MOVE SPACES                TO  WS-LOAN-EXPIRE-DT
02724           ELSE
02725             MOVE CM-AH-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
02726             MOVE ' '                     TO  DC-OPTION-CODE
02727             MOVE +0                      TO  DC-ELAPSED-MONTHS
02728                                              DC-ELAPSED-DAYS
02729             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
02730             IF NO-CONVERSION-ERROR
02731               MOVE DC-GREG-DATE-1-EDIT   TO  WS-LOAN-EXPIRE-DT
02732             ELSE
02733               MOVE SPACES                TO  WS-LOAN-EXPIRE-DT.
02734
02735      IF WS-CERT-READ-SW = 'Y'
02736        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
02737          MOVE SPACES             TO  TRAILER-DISPLAY-WORK-AREA
02738          MOVE ZEROS              TO  DISPLAY-SEQ
02739          MOVE 'LOAN DATA'        TO  DISPLAY-ACTION
02740          MOVE WS-LOAN-EXPIRE-DT  TO  DISPLAY-DATE
02741          MOVE CM-LOAN-NUMBER     TO  ASSOC-ORIG-LOAN
02742          MOVE CM-MEMBER-NO       TO  ASSOC-CUR-LOAN
02743          MOVE CL-LOAN-TYPE       TO  ASSOC-LOAN-TYPE
02744          MOVE ASSOC-LOAN-TEXT    TO  DISPLAY-TEXT
02745          MOVE TRAILER-DISPLAY-WORK-AREA
02746                                  TO  MAP-DISPLAY (DISPLAY-CNT)
02747          ADD +1                  TO  DISPLAY-CNT
02748        ELSE
02749          IF CM-OPEN-END
02750            MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
02751            MOVE 'LOAN INFO'      TO DISPLAY-ACTION
02752            MOVE CM-LOAN-NUMBER   TO LOAN-NUMBER
02753            MOVE CM-LOAN-BALANCE  TO LOAN-BALANCE
02754            MOVE CM-MEMBER-NO     TO LOAN-MEMBER
02755            MOVE LOAN-TEXT        TO DISPLAY-TEXT
02756            MOVE TRAILER-DISPLAY-WORK-AREA
02757                                  TO MAP-DISPLAY (DISPLAY-CNT)
02758            ADD +1                TO DISPLAY-CNT.
02759
030612     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
              PERFORM 6150-READ-TRLR92 THRU 6150-EXIT
              if ws-resp-normal
062602           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
03087            MOVE 'SPECIAL REVIEW' TO DISPLAY-ACTION
062602           move at-recorded-by   to display-by
                 move at-recorded-dt   to dc-bin-date-1
03091            MOVE ' '              TO DC-OPTION-CODE
03092            PERFORM 9700-LINK-DATE-CONVERT
                                       THRU 9700-EXIT
03093            MOVE DC-GREG-DATE-1-EDIT
                                       TO DISPLAY-DATE
03095            MOVE ws-TRLR-SEQ-NO   TO DISPLAY-SEQ
03096            MOVE AT-INFO-LINE-1   TO DISPLAY-TEXT
03097            MOVE TRAILER-DISPLAY-WORK-AREA
                                       TO MAP-DISPLAY (1)
                 if direction-switch = 'F'
02747               ADD +1             TO  DISPLAY-CNT
                 end-if
              end-if
061511        PERFORM 6160-READ-TRLR93 THRU 6160-EXIT
061511        if ws-resp-normal
061511           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
061511           MOVE 'VERIFY SSN    ' TO DISPLAY-ACTION
061511           move at-recorded-by   to display-by
061511           move at-recorded-dt   to dc-bin-date-1
061511           MOVE ' '              TO DC-OPTION-CODE
061511           PERFORM 9700-LINK-DATE-CONVERT
061511                                 THRU 9700-EXIT
061511           MOVE DC-GREG-DATE-1-EDIT
061511                                 TO DISPLAY-DATE
061511           MOVE ws-TRLR-SEQ-NO   TO DISPLAY-SEQ
061511           MOVE AT-INFO-LINE-1   TO DISPLAY-TEXT
061511           IF MAP-DISPLAY (1) (1:14) = 'SPECIAL REVIEW'
061511               MOVE TRAILER-DISPLAY-WORK-AREA
061511                                 TO MAP-DISPLAY (2)
061511           ELSE
061511               MOVE TRAILER-DISPLAY-WORK-AREA
061511                                 TO MAP-DISPLAY (1)
061511           END-IF
061511           if direction-switch = 'F'
061511              ADD +1             TO  DISPLAY-CNT
061511           end-if
061511        end-if
020613        PERFORM 6170-READ-TRLR94 THRU 6170-EXIT
020613        if ws-resp-normal
020613           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
020613           MOVE 'CAUSAL STATE  ' TO DISPLAY-ACTION
020613           MOVE AT-RECORDED-BY   TO DISPLAY-BY
020613           MOVE AT-RECORDED-DT   TO DC-BIN-DATE-1
020613           MOVE ' '              TO DC-OPTION-CODE
020613           PERFORM 9700-LINK-DATE-CONVERT
020613                                 THRU 9700-EXIT
020613           MOVE DC-GREG-DATE-1-EDIT
020613                                 TO DISPLAY-DATE
020613           MOVE WS-TRLR-SEQ-NO   TO DISPLAY-SEQ
020613           MOVE AT-INFO-LINE-1   TO DISPLAY-TEXT
020613           IF MAP-DISPLAY (1) (1:14) = 'SPECIAL REVIEW'
020613            OR 'VERIFY SSN    '
020613               IF MAP-DISPLAY (2) (1:14) = 'VERIFY SSN    '
020613                   MOVE TRAILER-DISPLAY-WORK-AREA
020613                                 TO MAP-DISPLAY (3)
020613               ELSE 
020613                  MOVE TRAILER-DISPLAY-WORK-AREA
020613                                 TO MAP-DISPLAY (2)
020613               END-IF
020613           ELSE
020613               MOVE TRAILER-DISPLAY-WORK-AREA
020613                                 TO MAP-DISPLAY (1)
020613           END-IF
020613           IF DIRECTION-SWITCH = 'F'
020613              ADD +1             TO  DISPLAY-CNT
020613           END-IF
020613        END-IF
           end-if

061013     IF PI-COMPANY-ID = 'DCC'
061013        PERFORM 6180-READ-TRLR95 THRU 6180-EXIT
061013        if ws-resp-normal
061013           move error-message-interface-block
061013                                 to ws-save-error-interface-block
061013           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
061013           MOVE 'NOTE'           TO DISPLAY-ACTION
061013           move at-recorded-by   to display-by
061013           move at-recorded-dt   to dc-bin-date-1
061013           MOVE ' '              TO DC-OPTION-CODE
061013           PERFORM 9700-LINK-DATE-CONVERT
061013                                 THRU 9700-EXIT
061013           MOVE DC-GREG-DATE-1-EDIT
061013                                 TO DISPLAY-DATE
061013           MOVE ws-TRLR-SEQ-NO   TO DISPLAY-SEQ
061013           perform varying a1 from +1 by +1 until
061013              at-note-error-no (a1) = spaces
061013              or display-cnt > +4
061013              move at-note-error-no (a1)
061013                                 to emi-error
061013              if at-note-error-no (a1) = '1653'
061013                 evaluate true
061013                    when pi-save-type = 'L'
061013                       move '  LF  '
061013                              to emi-claim-type
061013                    when pi-save-type = 'I'
061013                       move '  IU  '
061013                              to emi-claim-type
052614                    when pi-save-type = 'F'
052614                       move '  FL  '
052614                              to emi-claim-type
061013                    when other
061013                       move '  AH  '
061013                              to emi-claim-type
061013                 end-evaluate
061013              end-if
061013              PERFORM 9900-ERROR-FORMAT
061013                                 THRU 9900-EXIT
061013              move emi-line1 (8:64)
061013                             to TRAILER-DISPLAY-WORK-AREA (16:64)
061013              move trailer-display-work-area
061013                                 to map-display (display-cnt)
061013              if direction-switch = 'F'
061013                 ADD +1          TO  DISPLAY-CNT
061013              end-if
061013              move ws-save-error-interface-block
061013                                 to error-message-interface-block
061013           end-perform
061013        end-if
061013     end-if

           .
02760  2010-CONTINUE-TRAILER-DISPLAY.
02761
02762      EXEC CICS HANDLE CONDITION
02763          ENDFILE   (2950-NO-MORE-TRAILERS)
02764          NOTFND    (2950-NO-MORE-TRAILERS)
02765      END-EXEC.
02766
02767      EXEC CICS STARTBR
02768          DATASET   ('ELTRLR')
02769          GTEQ
02770          RIDFLD    (ELTRLR-KEY)
02771      END-EXEC.
02772
02773      IF DIRECTION-SWITCH = 'B'
02774          IF (PI-PREV-DISP = 'Y') OR (PI-PREV-DIR = 'B')
02775              EXEC CICS READPREV
02776                  DATASET ('ELTRLR')
02777                  RIDFLD  (ELTRLR-KEY)
02778                  SET     (ADDRESS OF ACTIVITY-TRAILERS)
02779              END-EXEC.
02780
02781      MOVE 'N'                    TO PI-PREV-DISP.
02782
02783      MOVE DIRECTION-SWITCH       TO PI-PREV-DIR.
02784
02785  2020-READ-TRAILER-LOOP.
02786      IF DIRECTION-SWITCH = 'F'
02787          EXEC CICS READNEXT
02788              DATASET   ('ELTRLR')
02789              SET       (ADDRESS OF ACTIVITY-TRAILERS)
02790              RIDFLD    (ELTRLR-KEY)
02791          END-EXEC
02792      ELSE
02793          EXEC CICS READPREV
02794              DATASET   ('ELTRLR')
02795              SET       (ADDRESS OF ACTIVITY-TRAILERS)
02796              RIDFLD    (ELTRLR-KEY)
02797          END-EXEC.
02798
02799      IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)  OR
02800         (PI-CARRIER    NOT = TRLR-CARRIER)  OR
02801         (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO) OR
02802         (PI-CERT-NO    NOT = TRLR-CERT-NO)
02803             GO TO 2950-NO-MORE-TRAILERS.
02804
062602*    IF TRLR-SEQ-NO = 90
061511     IF TRLR-SEQ-NO = 90 or 91 or 92 or 93
020613       OR 94 or 95
02806          GO TO 2020-READ-TRAILER-LOOP.
02807
02808      IF PI-COMPANY-ID = 'LAP'
02809          IF TRLR-SEQ-NO > +100 AND < +301
02810              GO TO 2020-READ-TRAILER-LOOP.
02811
02812      IF RESERVE-EXPENSE-TR OR ADDRESS-TR
02813          GO TO 2020-READ-TRAILER-LOOP.
02814
02815      IF PAYMENT-TR
02816          GO TO 2100-PAYMENT-TRAILER.
02817
02818      IF AUTO-PAY-TR
02819         GO TO 2200-AUTO-PAYMENT-TRAILER.
02820
02821      IF CORRESPONDENCE-TR
02822          GO TO 2300-CORRESPONDENCE-TRAILER.
02823
02824      IF GENERAL-INFO-TR
02825          GO TO 2400-GENERAL-INFO-TRAILER.
02826
02827      IF AUTO-PROMPT-TR
02828          GO TO 2500-AUTO-PROMPT-TRAILER.
02829
02830      IF DENIAL-TR
02831          GO TO 2600-DENIAL-TRAILER.
02832
02833      IF INCURRED-CHG-TR
02834          GO TO 2700-INCURRED-CHANGE-TRAILER.
02835
02836      IF FORM-CONTROL-TR
02837          GO TO 2710-FORM-CONTROL-TRAILER.
02838
02839      GO TO 2020-READ-TRAILER-LOOP.
02840
02841      EJECT
02842  2100-PAYMENT-TRAILER.
02843
02844      IF AT-PAYMENT-NOTE
02845          GO TO 2020-READ-TRAILER-LOOP.
02846
02847      MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
02848
02849      IF AT-PAYMENT-TYPE = 'T'
02850          MOVE 'TRANSFER PMT'     TO DISPLAY-ACTION
02851          GO TO 2100-CONT.
02852
02853      IF PI-SAVE-SYS-ID = 'CV'
02854          IF AT-CLAIM-TYPE = 'L'
02855              MOVE AT-CV-PMT-CODE             TO  WS-SUB
02856              IF WS-SUB < 1 OR > 8
02857                  MOVE 1                      TO  WS-SUB
02858                  MOVE CV-PAY-DESC (WS-SUB)   TO  DISPLAY-ACTION
02859              ELSE
02860                  MOVE CV-PAY-DESC (WS-SUB)   TO  DISPLAY-ACTION.
02861
022106     IF AT-PAYMENT-TYPE = 'I'
022106        MOVE 'INTEREST PMT'      TO DISPLAY-ACTION
022106     ELSE
02862      IF (PI-SAVE-SYS-ID = 'CV' AND AT-CLAIM-TYPE = 'A')
02863                   OR
02864          PI-SAVE-SYS-ID NOT = 'CV'
02865          MOVE AT-PAYMENT-TYPE           TO  WS-SUB
02866          IF WS-SUB < 1 OR > 6
02867              MOVE 2                     TO  WS-SUB
02868              MOVE PAY-DESC (WS-SUB)     TO  DISPLAY-ACTION
02869          ELSE
02870              MOVE PAY-DESC (WS-SUB)     TO  DISPLAY-ACTION.
02871
02872  2100-CONT.
02873
02874      MOVE AT-RECORDED-BY         TO DISPLAY-BY.
02875      MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
02876      MOVE ' '                    TO DC-OPTION-CODE.
02877      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
02878      MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
02879      MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
02880
02881      IF AT-VOID-DT NOT = LOW-VALUES
02882         MOVE AT-VOID-DT         TO DC-BIN-DATE-1
02883         MOVE ' '                TO DC-OPTION-CODE
02884         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
02885         MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
02886         IF AT-VOID-TYPE = 'S'
02887             MOVE 'STOP DT='     TO PMT-VAR
02888         ELSE
02889             MOVE 'VOIDED ='     TO PMT-VAR
02890      ELSE
02891         IF AT-PAID-THRU-DT NOT = LOW-VALUES
02892            MOVE AT-PAID-THRU-DT TO DC-BIN-DATE-1
02893            MOVE ' '             TO DC-OPTION-CODE
02894            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
02895            MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
02896            MOVE 'PD THRU='     TO PMT-VAR
02897            IF PI-USES-PAID-TO
02898               MOVE AT-PAID-THRU-DT TO DC-BIN-DATE-1
02899               MOVE '6'             TO DC-OPTION-CODE
02900               MOVE +1              TO DC-ELAPSED-DAYS
02901               MOVE +0              TO DC-ELAPSED-MONTHS
02902               PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
02903               MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
02904               MOVE 'PAID TO='      TO PMT-VAR
02905            ELSE
02906               NEXT SENTENCE
02907         ELSE
02908            IF CHARGEABLE-EXPENSE OR NON-CHARGEABLE-EXPENSE
02909               MOVE 'EXP TYP='       TO PMT-VAR
02910               MOVE AT-EXPENSE-TYPE  TO PMT-PD-THRU
02911            ELSE
02912               MOVE SPACES      TO PMT-VAR  PMT-PD-THRU.
02913
02914      MOVE AT-CHECK-NO               TO PMT-CHECK-NO.
02915      MOVE AT-AMOUNT-PAID            TO PMT-AMOUNT.
02916      MOVE PAYMENT-TEXT              TO DISPLAY-TEXT.
02917      MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
02918
02919      GO TO 2800-INCR-DISPLAY-CNT.
02920
02921      EJECT
02922  2200-AUTO-PAYMENT-TRAILER.
02923      MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
02924      MOVE 'AUTO PMT SETUP'       TO DISPLAY-ACTION.
02925      MOVE AT-RECORDED-BY         TO DISPLAY-BY.
02926
02927      MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
02928      MOVE ' '                    TO DC-OPTION-CODE.
02929      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
02930      MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
02931
02932      MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
02933
02934      IF PI-COMPANY-ID = 'DMD'
02935         IF AT-TERMINATED-DT NOT = SPACES AND ZEROS
02936                                          AND LOW-VALUES
02937            MOVE AT-TERMINATED-DT          TO DC-BIN-DATE-1
02938            MOVE ' '                       TO DC-OPTION-CODE
02939            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
02940            MOVE DC-GREG-DATE-1-EDIT       TO AUTO-TERMINATED
02941            MOVE AT-REGULAR-PMT-AMT        TO AUTO-TERM-AMT
02942            MOVE AUTO-TERM-TEXT            TO DISPLAY-TEXT
02943            MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY
02944                                             (DISPLAY-CNT)
02945            GO TO 2800-INCR-DISPLAY-CNT.
02946
02947      MOVE AT-SCHEDULE-START-DT   TO DC-BIN-DATE-1.
02948      MOVE ' '                    TO DC-OPTION-CODE.
02949      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
02950      MOVE DC-GREG-DATE-1-EDIT    TO AUTO-START.
02951
02952      IF PI-USES-PAID-TO
02953          MOVE AT-SCHEDULE-END-DT        TO  DC-BIN-DATE-1
02954          MOVE '6'                       TO  DC-OPTION-CODE
02955          MOVE +1                        TO  DC-ELAPSED-DAYS
02956          MOVE +0                        TO  DC-ELAPSED-MONTHS
02957          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
02958          IF NO-CONVERSION-ERROR
02959              MOVE DC-GREG-DATE-1-EDIT   TO  AUTO-END
02960          ELSE
02961              MOVE SPACES                TO  AUTO-END
02962      ELSE
02963          MOVE AT-SCHEDULE-END-DT        TO  DC-BIN-DATE-1
02964          MOVE ' '                       TO  DC-OPTION-CODE
02965          MOVE +0                        TO  DC-ELAPSED-DAYS
02966                                             DC-ELAPSED-MONTHS
02967          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
02968          IF NO-CONVERSION-ERROR
02969              MOVE DC-GREG-DATE-1-EDIT   TO  AUTO-END
02970          ELSE
02971              MOVE SPACES                TO  AUTO-END.
02972
02973      MOVE AT-REGULAR-PMT-AMT        TO AUTO-AMOUNT.
02974      MOVE AUTO-PMT-TEXT             TO DISPLAY-TEXT.
02975      MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
02976
02977      GO TO 2800-INCR-DISPLAY-CNT.
02978
02979      EJECT
02980  2300-CORRESPONDENCE-TRAILER.
02981      MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
02982      MOVE 'LETTER'               TO DISP-ACT-A.
02983      MOVE AT-STD-LETTER-FORM     TO DISP-ACT-B.
02984      MOVE AT-RECORDED-BY         TO DISPLAY-BY.
02985
02986      MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
02987      MOVE ' '                    TO DC-OPTION-CODE.
02988      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
02989      MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
02990
02991      MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
02992
02993      IF AT-ADDRESEE-TYPE = 'I'
02994          MOVE 1                  TO WS-SUB
02995       ELSE
02996      IF AT-ADDRESEE-TYPE = 'B'
02997          MOVE 2                  TO WS-SUB
02998       ELSE
02999      IF AT-ADDRESEE-TYPE = 'A'
03000          MOVE 3                  TO WS-SUB
03001       ELSE
03002      IF AT-ADDRESEE-TYPE = 'P'
03003          MOVE 4                  TO WS-SUB
03004       ELSE
03005      IF AT-ADDRESEE-TYPE = 'E'
03006          MOVE 5                  TO WS-SUB
03007       ELSE
03008      IF AT-ADDRESEE-TYPE = 'O'
03009          MOVE 6                  TO WS-SUB
03010       ELSE
03011      IF AT-ADDRESEE-TYPE = 'Q'
03012          MOVE 7                  TO WS-SUB
03013       ELSE
03014          MOVE 0                  TO WS-SUB.
03015
03016      IF WS-SUB = 0
03017          MOVE SPACES             TO  CORR-TO
03018      ELSE
03019          MOVE CORR-DESC (WS-SUB) TO  CORR-TO.
03020
113010     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
113010        AND (AT-LETTER-ANSWERED-DT = LOW-VALUES  OR
113010             AT-LETTER-ANSWERED-DT > AT-STOP-LETTER-DT)
113010          MOVE '   STOP='         TO CORR-RECVD-LIT
113010          MOVE AT-STOP-LETTER-DT  TO DC-BIN-DATE-1
113010          MOVE ' '                TO DC-OPTION-CODE
113010          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
113010          MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
113010     ELSE
041613        IF AT-LETTER-SENT-DT = LOW-VALUES OR SPACES
041613            MOVE 'MAIL RCVD'    TO DISP-ACT-A
041613        END-IF
113010        MOVE '  RECVD='         TO CORR-RECVD-LIT
113010        IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES
113010            MOVE AT-LETTER-ANSWERED-DT TO DC-BIN-DATE-1
113010            MOVE ' '                TO DC-OPTION-CODE
113010            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
113010            MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
113010        ELSE
113010            MOVE SPACES             TO CORR-RECVD
113010        END-IF
113010     END-IF.
03028
03029      IF AT-RESEND-PRINT-DATE NOT = LOW-VALUES
03030          MOVE '  RESENT='          TO CORR-VAR
03031          MOVE AT-RESEND-PRINT-DATE TO DC-BIN-DATE-1
03032          MOVE ' '                  TO DC-OPTION-CODE
03033          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03034          MOVE DC-GREG-DATE-1-EDIT  TO CORR-RESENT
03035      ELSE
03036          IF AT-AUTO-RE-SEND-DT NOT = LOW-VALUES
03037              MOVE '  RESEND='         TO CORR-VAR
03038              MOVE AT-AUTO-RE-SEND-DT  TO DC-BIN-DATE-1
03039              MOVE ' '                 TO DC-OPTION-CODE
03040              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03041              MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
03042          ELSE
03043             IF AT-LETTER-ARCHIVE-NO NOT = ZEROS
03044                MOVE 'ARCH. NO='          TO CORR-VAR
03045                MOVE AT-LETTER-ARCHIVE-NO TO CORR-ARCH-NO
03046             ELSE
03047                MOVE SPACES       TO CORR-RESENT  CORR-VAR.
03048
CIDMOD*    IF PI-COMPANY-ID = 'DMD'
CIDMOD*        IF AT-DMD-LETTER-PURGE-DT NOT = SPACES AND LOW-VALUES
CIDMOD*            MOVE '  PURGED='             TO CORR-VAR
CIDMOD*            MOVE AT-DMD-LETTER-PURGE-DT  TO DC-BIN-DATE-1
CIDMOD*            MOVE ' '                     TO DC-OPTION-CODE
CIDMOD*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
CIDMOD*            MOVE DC-GREG-DATE-1-EDIT     TO CORR-RESENT.
03056
03057      MOVE CORRESPONDENCE-TEXT       TO DISPLAY-TEXT.
03058      MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
03059
03060      GO TO 2800-INCR-DISPLAY-CNT.
03061
03062      EJECT
03063  2400-GENERAL-INFO-TRAILER.
03064
03065      IF AT-PAYMENT-NOTE
03066          GO TO 2020-READ-TRAILER-LOOP.
03067
03068      IF AT-CONTINUED-NOTE
03069          GO TO 2020-READ-TRAILER-LOOP.
03070
03071      MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
03072
03073      IF AT-MAINT-NOTE
03074          MOVE 'MAINT NOTES'      TO DISPLAY-ACTION
03075      ELSE
03076          IF AT-CALL-NOTE
03077              MOVE 'CALL'         TO DISP-ACT-A
03078              IF AT-PHONE-CALL-IN
03079                  MOVE 'IN'       TO DISP-ACT-B
03080              ELSE
03081                  MOVE 'OUT'      TO DISP-ACT-B
03082          ELSE
03083              IF AT-CERT-CHANGE
03084                  MOVE 'CERT CHANGE'
03085                                  TO DISPLAY-ACTION
041807             ELSE IF AT-APPROVAL-NOTE
041807                 MOVE 'APPROVL REVIEW' TO DISPLAY-ACTION
080106             ELSE IF AT-NOTE-FILE-NOTE
080106                 MOVE 'NOTE & FILE' TO DISPLAY-ACTION
03086              ELSE
03087                  MOVE 'NOTE'     TO DISPLAY-ACTION.
03088
03089      MOVE AT-RECORDED-BY         TO DISPLAY-BY.
03090      MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
03091      MOVE ' '                    TO DC-OPTION-CODE.
03092      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
03093      MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
03094
03095      MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
03096      MOVE AT-INFO-LINE-1         TO DISPLAY-TEXT.
03097      MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
03098      GO TO 2800-INCR-DISPLAY-CNT.
03099
03100      EJECT
03101  2500-AUTO-PROMPT-TRAILER.
03102      MOVE EIBDATE                TO DC-JULIAN-YYDDD.
03103      MOVE '5'                    TO DC-OPTION-CODE.
03104      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
03105
03106      IF DC-BIN-DATE-1 > AT-PROMPT-END-DT
03107          GO TO 2020-READ-TRAILER-LOOP.
03108
03109      MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
03110      MOVE 'REMINDER'             TO DISPLAY-ACTION.
03111      MOVE AT-RECORDED-BY         TO DISPLAY-BY.
03112
03113      MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
03114      MOVE ' '                    TO DC-OPTION-CODE.
03115      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
03116      MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
03117
03118      MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
03119
03120      MOVE AT-PROMPT-END-DT       TO DC-BIN-DATE-1.
03121      MOVE ' '                    TO DC-OPTION-CODE.
03122      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
03123      MOVE DC-GREG-DATE-1-EDIT    TO PROMPT-END.
03124
03125      MOVE AT-PROMPT-LINE-1       TO PROMPT-MSG.
03126      MOVE PROMPT-TEXT            TO DISPLAY-TEXT.
03127      MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
03128      GO TO 2800-INCR-DISPLAY-CNT.
03129
03130      EJECT
03131  2600-DENIAL-TRAILER.
03132      MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
03133      MOVE 'DENIAL'               TO DISPLAY-ACTION.
03134      MOVE AT-RECORDED-BY         TO DISPLAY-BY.
03135
03136      MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
03137      MOVE ' '                    TO DC-OPTION-CODE.
03138      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
03139      MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
03140
03141      MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
03142
03143      IF AT-RETRACTION-DT NOT = LOW-VALUES
03144          MOVE AT-DENIAL-DT       TO DC-BIN-DATE-1
03145          MOVE ' '                TO DC-OPTION-CODE
03146          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03147          MOVE DC-GREG-DATE-1-EDIT TO DENIED-DATE
03148          MOVE AT-RETRACTION-DT   TO DC-BIN-DATE-1
03149          MOVE ' '                TO DC-OPTION-CODE
03150          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03151          MOVE DC-GREG-DATE-1-EDIT TO RECONSIDERED-DATE
03152          MOVE RECONSIDERED-TEXT   TO DISPLAY-TEXT
03153          MOVE TRAILER-DISPLAY-WORK-AREA
03154                                  TO MAP-DISPLAY (DISPLAY-CNT)
03155          GO TO 2800-INCR-DISPLAY-CNT.
03156
03157      MOVE AT-DENIAL-DT           TO DC-BIN-DATE-1.
03158      MOVE ' '                    TO DC-OPTION-CODE.
03159      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
03160      MOVE DC-GREG-DATE-1-EDIT    TO DENIAL-DATE.
03161
03162      MOVE AT-DENIAL-REASON-CODE  TO DENIAL-CODE.
03163      MOVE AT-DENIAL-INFO-1       TO DENIAL-MSG.

042110     IF CL-DENIAL-TYPE NOT = SPACES AND LOW-VALUES
042110        EVALUATE CL-DENIAL-TYPE
042110           WHEN '1'
042110              MOVE 'DENIAL STATUS - DENIAL       '
042110                                 TO DENTYPO
042110           WHEN '2'
042110              MOVE 'DENIAL STATUS - RESCISSION   '
042110                                 TO DENTYPO
042110           WHEN '3'
042110              MOVE 'DENIAL STATUS - REFORMATION  '
042110                                 TO DENTYPO
042110           WHEN '4'
042110              MOVE 'DENIAL STATUS - REF TO RESC  '
042110                                 TO DENTYPO
042110           WHEN '5'
042110              MOVE 'DENIAL STATUS - RECONSIDERED '
042110                                 TO DENTYPO
042110        END-EVALUATE
042110        MOVE AL-SANOF            TO DENTYPA
042110     END-IF
                    
03164      MOVE DENIAL-TEXT            TO DISPLAY-TEXT.
03165      MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
03166      GO TO 2800-INCR-DISPLAY-CNT.
03167
03168      EJECT
03169  2700-INCURRED-CHANGE-TRAILER.
03170      MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
03171      MOVE 'INCUR DATE CHG'       TO DISPLAY-ACTION.
03172      MOVE AT-RECORDED-BY         TO DISPLAY-BY.
03173
03174      MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
03175      MOVE ' '                    TO DC-OPTION-CODE.
03176      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
03177      MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
03178
03179      MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
03180
03181      IF AT-OLD-INCURRED-DT NOT = LOW-VALUES
03182         MOVE AT-OLD-INCURRED-DT  TO DC-BIN-DATE-1
03183         MOVE ' '                 TO DC-OPTION-CODE
03184         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03185         IF DATE-CONVERSION-ERROR
03186            MOVE SPACES           TO INCUR-DT
03187         ELSE
03188            MOVE DC-GREG-DATE-1-EDIT  TO INCUR-DT
03189      ELSE
03190         MOVE SPACES              TO INCUR-DT.
03191
03192      IF PI-USES-PAID-TO
03193         MOVE ' PD  TO ='         TO PDTHRU-HEAD.
03194
03195      IF AT-OLD-PAID-THRU-DT NOT = LOW-VALUES
03196         MOVE AT-OLD-PAID-THRU-DT TO DC-BIN-DATE-1
03197         MOVE ' '                 TO DC-OPTION-CODE
03198         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03199         IF DATE-CONVERSION-ERROR
03200            MOVE SPACES           TO INCUR-PDTHRU
03201         ELSE
03202            MOVE DC-GREG-DATE-1-EDIT  TO INCUR-PDTHRU
03203            IF PI-USES-PAID-TO
03204               MOVE AT-OLD-PAID-THRU-DT TO DC-BIN-DATE-1
03205               MOVE '6'                 TO DC-OPTION-CODE
03206               MOVE +1                  TO DC-ELAPSED-DAYS
03207               MOVE +0                  TO DC-ELAPSED-MONTHS
03208               PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03209               IF NO-CONVERSION-ERROR
03210                  MOVE DC-GREG-DATE-1-EDIT  TO INCUR-PDTHRU
03211               ELSE
03212                  NEXT SENTENCE
03213            ELSE
03214               NEXT SENTENCE
03215      ELSE
03216         MOVE SPACES              TO INCUR-PDTHRU.
03217
03218      MOVE AT-OLD-TOTAL-PAID      TO INCUR-PAID.
03219      MOVE INCUR-TEXT             TO DISPLAY-TEXT.
03220      MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
03221      GO TO 2800-INCR-DISPLAY-CNT.
03222
03223      EJECT
03224  2710-FORM-CONTROL-TRAILER.
03225      MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
03226      MOVE 'FORM CTL'             TO DISP-ACT-A.
03227      IF INITIAL-FORM
03228         MOVE 'INIT'              TO DISP-ACT-B
03229      ELSE
03230         MOVE 'PROG'              TO DISP-ACT-B.
03231
03232      MOVE AT-RECORDED-BY         TO DISPLAY-BY.
03233
03234      MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
03235      MOVE ' '                    TO DC-OPTION-CODE.
03236      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
03237      MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
03238
03239      MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
03240
03241      IF AT-FORM-ADDRESS = 'I'
03242          MOVE 1                  TO WS-SUB
03243       ELSE
03244      IF AT-FORM-ADDRESS = 'A'
03245          MOVE 3                  TO WS-SUB
03246       ELSE
03247      IF AT-FORM-ADDRESS = 'O'
03248          MOVE 6                  TO WS-SUB
03249       ELSE
03250      IF AT-FORM-ADDRESS = 'Q'
03251          MOVE 7                  TO WS-SUB
03252       ELSE
03253          MOVE 0                  TO WS-SUB.
03254
03255      IF WS-SUB = 0
03256          MOVE SPACES             TO  CORR-TO
03257      ELSE
03258          MOVE CORR-DESC (WS-SUB) TO  CORR-TO.
03259
03260      IF AT-FORM-ANSWERED-DT NOT = LOW-VALUES
03261          MOVE AT-FORM-ANSWERED-DT TO DC-BIN-DATE-1
03262          MOVE ' '                 TO DC-OPTION-CODE
03263          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03264          MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
03265      ELSE
03266          MOVE SPACES              TO CORR-RECVD.
03267
03268      IF AT-FORM-PRINTED-DT  = LOW-VALUES
03269          MOVE '    SEND='         TO CORR-VAR
03270          MOVE AT-FORM-SEND-ON-DT  TO DC-BIN-DATE-1
03271          MOVE ' '                 TO DC-OPTION-CODE
03272          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03273          MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
03274      ELSE
03275          MOVE '    SENT='        TO CORR-VAR
03276          IF AT-FORM-REPRINT-DT  = LOW-VALUES
03277             MOVE AT-FORM-PRINTED-DT TO DC-BIN-DATE-1
03278             MOVE ' '                TO DC-OPTION-CODE
03279             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03280             MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
03281          ELSE
03282             MOVE AT-FORM-REPRINT-DT TO DC-BIN-DATE-1
03283             MOVE ' '                TO DC-OPTION-CODE
03284             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03285             MOVE DC-GREG-DATE-1-EDIT    TO CORR-RESENT.
03286
03287      MOVE CORRESPONDENCE-TEXT       TO DISPLAY-TEXT.
03288      MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
03289
03290      GO TO 2800-INCR-DISPLAY-CNT.
03291
03292  2800-INCR-DISPLAY-CNT.
03293      IF LCP-ONCTR-01 =  0
03294          ADD 1 TO LCP-ONCTR-01
03295          MOVE 'Y'                TO PI-PREV-DISP
03296          MOVE TRLR-SEQ-NO        TO PI-SAVE-LOW  PI-SAVE-HIGH.
03297
03298      IF DIRECTION-SWITCH = 'F'
03299          MOVE TRLR-SEQ-NO        TO PI-SAVE-HIGH
03300          ADD +1                  TO DISPLAY-CNT
03301          IF DISPLAY-CNT > +4
03302              GO TO 2999-EXIT
03303          ELSE
03304              NEXT SENTENCE
03305      ELSE
03306          MOVE TRLR-SEQ-NO        TO PI-SAVE-LOW
03307          SUBTRACT +1 FROM DISPLAY-CNT
062602         if map-display (1) (1:14) = 'SPECIAL REVIEW'
061511           OR MAP-DISPLAY (1) (1:14) = 'VERIFY SSN    '
020613           OR MAP-DISPLAY (1) (1:14) = 'CAUSAL STATE  '
061511            IF MAP-DISPLAY (2) (1:14) = 'VERIFY SSN    '
020613              OR MAP-DISPLAY (2) (1:14) = 'CAUSAL STATE  '
020613                 IF MAP-DISPLAY (3) (1:14) = 'CAUSAL STATE  '
020613                     IF DISPLAY-CNT < +4
020613                        GO TO 2999-EXIT
020613                     END-IF
020613                 END-IF
061511                 IF DISPLAY-CNT < +3
061511                   GO TO 2999-EXIT
061511                 END-IF
061511            END-IF
062602            IF DISPLAY-CNT < +2
062602               GO TO 2999-EXIT
062602            END-IF
062602         ELSE
03308             IF DISPLAY-CNT < +1
03309                GO TO 2999-EXIT.
03310
03311      GO TO 2020-READ-TRAILER-LOOP.
03312
03313  2950-NO-MORE-TRAILERS.
03314      MOVE ER-0303                TO EMI-ERROR.
03315      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03316
03317  2999-EXIT.
03318      EXIT.
03319
03320      EJECT

061013 3997-GET-ERPDEF.
061013
061013     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
061013     MOVE CM-STATE               TO ERPDEF-STATE
061013     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
061013     MOVE 'A'                    TO ERPDEF-BEN-TYPE
061013     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
061013     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
061013     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
061013
061013     EXEC CICS STARTBR
061013         DATASET  ('ERPDEF')
061013         RIDFLD   (ERPDEF-KEY)
061013         GTEQ
061013         RESP     (WS-RESPONSE)
061013     END-EXEC
061013
061013     IF NOT WS-RESP-NORMAL
061013        GO TO 3997-EXIT
061013     END-IF
061013
061013     IF WS-RESP-NORMAL
061013        EXEC CICS READNEXT
061013           DATASET  ('ERPDEF')
061013           INTO     (PRODUCT-MASTER)
061013           RIDFLD   (ERPDEF-KEY)
061013           RESP     (WS-RESPONSE)
061013        END-EXEC
061013        IF WS-RESP-NORMAL
061013           IF (ERPDEF-KEY-SAVE (1:16) =
061013              PD-CONTROL-PRIMARY (1:16))
061013              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
061013              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
061013                 (A1 > +8)
061013                 OR (PD-PROD-CODE (A1) = cl-claim-type)
061013              END-PERFORM
061013              IF A1 < +9
061013                 SET PDEF-FOUND TO TRUE
061013              end-if
061013           END-IF
061013        END-IF
061013     END-IF
061013
061013     .
061013 3997-ENDBR.
061013
061013     EXEC CICS ENDBR
061013        DATASET  ('ERPDEF')
061013     END-EXEC
061013
061013     .
061013 3997-EXIT.
061013     EXIT.

03321  6000-CHECK-AUTO-ACTIVITY.
03322 ******************************************************************
03323 *    READ THE CONTROL FILE TO VERIFY THAT AN AUTOMATIC           *
03324 *    ACTIVITY RECORD EXISTS.                                     *
03325 ******************************************************************
03326
03327      EXEC CICS HANDLE CONDITION
03328          NOTFND   (6000-NOT-FOUND)
03329      END-EXEC.
03330
03331      MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
03332      MOVE 'T'                    TO  CNTL-REC-TYPE
03333      MOVE SPACES                 TO  CNTL-ACCESS
03334      MOVE +0                     TO  CNTL-SEQ-NO
03335      MOVE 'CNTL'                 TO  FILE-SWITCH.
03336
03337      EXEC CICS READ
03338          DATASET   ('ELCNTL')
03339          RIDFLD    (ELCNTL-KEY)
03340          SET       (ADDRESS OF CONTROL-FILE)
03341      END-EXEC.
03342
03343      MOVE 'Y'                    TO  WS-ACT-REC-FOUND-SW.
03344      GO TO 6000-EXIT.
03345
03346  6000-NOT-FOUND.
03347      MOVE 'N'                    TO  WS-ACT-REC-FOUND-SW.
03348      MOVE AL-UABON               TO  ACTCDA.
03349      MOVE -1                     TO  ACTCDL.
03350      MOVE ER-3516                TO  EMI-ERROR
03351      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03352
03353  6000-EXIT.
03354      EXIT.
03355
03356      EJECT
03357  6050-AUTO-LETTER-WRITER.
03358 ******************************************************************
03359 *    THE FOLLOWING ACTIVITIES WILL BE PERFORMED BASED ON THE     *
03360 *    CODES ENTERED IN THE AUTOMATIC ACTIVITY RECORD.             *
03361 *       1.  IF SPECIFIED, THE AUTOMATIC LETTER WRITER PROGRAM    *
03362 *           WILL BE LINKED TO AND A LETTER WILL BE GENERATED.    *
03363 *           A.  ANY RESEND OR FOLLOW UP DATES SPECIFIED IN THE   *
03364 *               ACTIVITY RECORD WILL BE STORED IN THE LETTER     *
03365 ******************************************************************
03366
03367      IF WS-ACTIVITY-CODE = ZERO
03368          GO TO 6050-EXIT.
03369
03370      MOVE WS-ACTIVITY-CODE       TO  SUB.
03371      SUBTRACT 9 FROM SUB.
03372
03373  6050-EDIT-USER-ACTIVITY-LOOP.
03374
03375      IF (CF-USER-ACTIVE-SW (SUB) = ' ' OR 'N') OR
03376         (CF-USER-LETTER-ID (SUB) = SPACES OR LOW-VALUES)
03377              GO TO 6050-EXIT.
03378
03379  6050-START-AUTO-LETTER-WRITER.
03380
03381      MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
03382      MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
03383
03384      MOVE CF-USER-LETTER-ID (SUB)    TO W-1523-FORM-NUMBER.
03385
03386      IF CF-USER-RESEND-DAYS (SUB) NOT = ZEROS
03387          MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
03388          MOVE '6'                    TO  DC-OPTION-CODE
03389          MOVE CF-USER-RESEND-DAYS (SUB)  TO  DC-ELAPSED-DAYS
03390          MOVE +0                     TO  DC-ELAPSED-MONTHS
03391          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03392          IF NO-CONVERSION-ERROR
03393              MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
03394          ELSE
03395              MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
03396
03397      IF CF-USER-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
03398          MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
03399          MOVE '6'                    TO  DC-OPTION-CODE
03400          MOVE CF-USER-FOLLOW-UP-DAYS (SUB)   TO  DC-ELAPSED-DAYS
03401          MOVE +0                     TO  DC-ELAPSED-MONTHS
03402          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
03403          IF NO-CONVERSION-ERROR
03404              MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
03405          ELSE
03406              MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
03407
03408 ******************************************************************
03409 *    LINK TO THE AUTOMATIC LETTER WRITER PROGRAM.                *
03410 ******************************************************************
03411
03412      EXEC CICS LINK
03413          PROGRAM    (LINK-1523)
03414          COMMAREA   (W-1523-LINKDATA)
03415          LENGTH     (W-1523-COMM-LENGTH)
03416      END-EXEC.
03417
03418 ******************************************************************
03419 *    CHECK THE ERROR CODES FROM THE AUTOMATIC LETTER WRITER      *
03420 *    PROGRAM.                                                    *
03421 *        1.  IF FATAL ERRORS ARE DETECTED BY THE AUTO LETTER     *
03422 *            WRITER PROGRAM, THE LETTER IS NOT CREATED AND AN    *
03423 *            ERROR MESSAGE (#0802) IS DISPLAYED INDICATING THAT  *
03424 *            THE LETTER WAS NOT CREATED.                         *
03425 *        2.  IF THE AUTO LETTER WRITER PROGRAM IS UNABLE TO      *
03426 *            RESOLVE A VARIABLE, THE LETTER IS CREATED AND AN    *
03427 *            ERROR MESSAGE (#0803) INDICATING THAT THE LETTER    *
03428 *            WAS CREATED WITH ERRORS IS DISPLAYED.               *
03429 ******************************************************************
03430
03431      IF W-1523-ERROR-CODE = ZEROS
03432          GO TO 6050-EXIT.
03433
03434      IF W-1523-FATAL-ERROR
03435          MOVE ER-0802                TO  EMI-ERROR
03436          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03437
03438      IF W-1523-ERROR-CODE = 0191
03439          MOVE ER-0803                TO  EMI-ERROR
03440          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03441
03442  6050-EXIT.
03443      EXIT.
03444
03445      EJECT
03446  6100-RESET-AUTO-ACTIVITY.
03447 ******************************************************************
03448 *    RESET ALL LETTER ACTIVITY AWAITING FURTHER ACTION (RESEND,  *
03449 *    FOLLOW-UP, ETC) IF THE AUTOMATIC ACTIVITY CODE IS SET       *
03450 *    TO ZEROS.                                                   *
03451 ******************************************************************
03452
03453      MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
03454      MOVE PI-CARRIER             TO  TRLR-CARRIER.
03455      MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
03456      MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
03457      MOVE +100                   TO  TRLR-SEQ-NO.
03458      MOVE 'TRLR'                 TO  FILE-SWITCH.
03459
03460  6100-STARTBR-TRLR.
03461
03462      EXEC CICS HANDLE CONDITION
03463          ENDFILE  (6100-END-RESET)
03464          NOTFND   (6100-END-RESET)
03465      END-EXEC.
03466
03467      EXEC CICS STARTBR
03468          DATASET   ('ELTRLR')
03469          RIDFLD    (ELTRLR-KEY)
03470          GTEQ
03471      END-EXEC.
03472
03473      MOVE 'Y'                        TO  WS-BROWSE-SW.
03474
03475  6100-READ-NEXT.
03476
03477      EXEC CICS READNEXT
03478          DATASET   ('ELTRLR')
03479          RIDFLD    (ELTRLR-KEY)
03480          SET       (ADDRESS OF ACTIVITY-TRAILERS)
03481      END-EXEC.
03482
03483      IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)   OR
03484         (PI-CARRIER    NOT = TRLR-CARRIER)   OR
03485         (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO)  OR
03486         (PI-CERT-NO    NOT = TRLR-CERT-NO)
03487          GO TO 6100-END-RESET.
03488
03489      IF ELTRLR-KEY = PI-PREV-TRLR-KEY
03490          GO TO 6100-READ-NEXT.
03491
03492      IF AT-TRAILER-TYPE NOT = '4'
03493          GO TO 6100-READ-NEXT.
03494
03495      IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
03496          GO TO 6100-READ-NEXT.
03497
03498      IF (AT-AUTO-RE-SEND-DT = LOW-VALUES OR SPACES)
03499        AND
03500         (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
03501          GO TO 6100-READ-NEXT.
03502
03503      IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
03504         AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
03505         AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
03506          GO TO 6100-READ-NEXT.
03507
03508      IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
03509        AND
03510         (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
03511        AND
03512         (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
03513          GO TO 6100-READ-NEXT.
03514
03515  6100-END-BROWSE.
03516
03517      MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
03518
03519      EXEC CICS ENDBR
03520          DATASET   ('ELTRLR')
03521      END-EXEC.
03522
03523      MOVE 'N'                        TO  WS-BROWSE-SW.
03524
03525  6100-READ-TRLR-UPDATE.
03526
03527      EXEC CICS READ
03528          DATASET   ('ELTRLR')
03529          RIDFLD    (ELTRLR-KEY)
03530          SET       (ADDRESS OF ACTIVITY-TRAILERS)
03531          UPDATE
03532      END-EXEC.
03533
03534      MOVE 'Y'                        TO  WS-UPDATE-SW.
03535
03536      IF AT-AUTO-RE-SEND-DT IS NOT < SAVE-BIN-DATE
03537          MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
03538          MOVE PI-COMPANY-CD          TO  ARCH-COMP-CD
03539          MOVE AT-LETTER-ARCHIVE-NO   TO  ARCH-ARCHIVE-NO
03540          MOVE '1'                    TO  ARCH-RECORD-TYPE
03541          MOVE +0                     TO  ARCH-SEQ-NO
03542          PERFORM 6200-READ-ARCH-UPDATE THRU 6200-EXIT.
03543
03544      IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
03545          MOVE LOW-VALUES             TO  AT-RECEIPT-FOLLOW-UP.
03546
03547  6100-REWRITE-TRLR.
03548
03549      EXEC CICS REWRITE
03550          DATASET   ('ELTRLR')
03551          FROM      (ACTIVITY-TRAILERS)
03552      END-EXEC.
03553
03554      GO TO 6100-STARTBR-TRLR.
03555
03556  6100-END-RESET.
03557
03558      IF WS-BROWSE-SW = 'Y'
03559          MOVE 'N'                    TO  WS-BROWSE-SW
03560          EXEC CICS ENDBR
03561              DATASET   ('ELTRLR')
03562          END-EXEC.
03563
03564  6100-EXIT.
03565      EXIT.
03566
03567      EJECT
062602 6150-READ-TRLR92.
062602
03453      MOVE PI-COMPANY-CD          TO  WS-TRLR-COMP-CD.
03454      MOVE PI-CARRIER             TO  WS-TRLR-CARRIER.
03455      MOVE PI-CLAIM-NO            TO  WS-TRLR-CLAIM-NO.
03456      MOVE PI-CERT-NO             TO  WS-TRLR-CERT-NO.
03457      MOVE +092                   TO  WS-TRLR-SEQ-NO.
03458      MOVE 'TRLR'                 TO  FILE-SWITCH.
03459
03477      EXEC CICS READ
03478          DATASET   ('ELTRLR')
03479          RIDFLD    (WS-ELTRLR-KEY)
03480          SET       (ADDRESS OF ACTIVITY-TRAILERS)
062602         RESP      (WS-RESPONSE)
03481      END-EXEC.
03482
           .
062602 6150-EXIT.
062602     EXIT.
03566
061511 6160-READ-TRLR93.
061511
061511     MOVE PI-COMPANY-CD          TO  WS-TRLR-COMP-CD.
061511     MOVE PI-CARRIER             TO  WS-TRLR-CARRIER.
061511     MOVE PI-CLAIM-NO            TO  WS-TRLR-CLAIM-NO.
061511     MOVE PI-CERT-NO             TO  WS-TRLR-CERT-NO.
061511     MOVE +093                   TO  WS-TRLR-SEQ-NO.
061511     MOVE 'TRLR'                 TO  FILE-SWITCH.
061511
061511     EXEC CICS READ
061511         DATASET   ('ELTRLR')
061511         RIDFLD    (WS-ELTRLR-KEY)
061511         SET       (ADDRESS OF ACTIVITY-TRAILERS)
061511         RESP      (WS-RESPONSE)
061511     END-EXEC.
061511
061511     .
061511 6160-EXIT.
061511     EXIT.
061511
020613 6170-READ-TRLR94.
020613
020613     MOVE PI-COMPANY-CD          TO  WS-TRLR-COMP-CD.
020613     MOVE PI-CARRIER             TO  WS-TRLR-CARRIER.
020613     MOVE PI-CLAIM-NO            TO  WS-TRLR-CLAIM-NO.
020613     MOVE PI-CERT-NO             TO  WS-TRLR-CERT-NO.
020613     MOVE +094                   TO  WS-TRLR-SEQ-NO.
020613     MOVE 'TRLR'                 TO  FILE-SWITCH.
020613
020613     EXEC CICS READ
020613         DATASET   ('ELTRLR')
020613         RIDFLD    (WS-ELTRLR-KEY)
020613         SET       (ADDRESS OF ACTIVITY-TRAILERS)
020613         RESP      (WS-RESPONSE)
020613     END-EXEC.
020613
020613     .
020613 6170-EXIT.
020613     EXIT.
020613
061013 6180-READ-TRLR95.
061013
061013     MOVE PI-COMPANY-CD          TO  WS-TRLR-COMP-CD.
061013     MOVE PI-CARRIER             TO  WS-TRLR-CARRIER.
061013     MOVE PI-CLAIM-NO            TO  WS-TRLR-CLAIM-NO.
061013     MOVE PI-CERT-NO             TO  WS-TRLR-CERT-NO.
061013     MOVE +095                   TO  WS-TRLR-SEQ-NO.
061013     MOVE 'TRLR'                 TO  FILE-SWITCH.
061013
061013     EXEC CICS READ
061013         DATASET   ('ELTRLR')
061013         RIDFLD    (WS-ELTRLR-KEY)
061013         SET       (ADDRESS OF ACTIVITY-TRAILERS)
061013         RESP      (WS-RESPONSE)
061013     END-EXEC.
061013
061013     .
061013 6180-EXIT.
061013     EXIT.
020613
03568  6200-READ-ARCH-UPDATE.
03569 ******************************************************************
03570 *  READ AND UPDATE THE RESEND DATE ON THE LETTER ARCHIVE RECORD  *
03571 ******************************************************************
03572
03573      EXEC CICS HANDLE CONDITION
03574          NOTFND   (6200-EXIT)
03575      END-EXEC.
03576
03577      EXEC CICS READ
03578          DATASET   ('ELARCH')
03579          RIDFLD    (ELARCH-KEY)
03580          SET       (ADDRESS OF LETTER-ARCHIVE)
03581          UPDATE
03582      END-EXEC.
03583
03584      MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
03585
03586  6200-REWRITE-ARCH.
03587      EXEC CICS REWRITE
03588          DATASET   ('ELARCH')
03589          FROM      (LETTER-ARCHIVE)
03590      END-EXEC.
03591
03592  6200-EXIT.
03593      EXIT.
03594
03595      EJECT
03596  7000-START-BROWSE.
03597
03598      IF PI-COMPANY-ID = 'DMD'
03599              AND
03600         PI-ASS-PROCESSING
03601          GO TO 7200-BROWSING-ASS-FWRD.
03602
03603      MOVE LOW-VALUES             TO  ELMSTR-KEY.
03604      MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
03605
03606      IF CLMNOL > 0
03607          MOVE CLMNOI             TO  MSTR-CLAIM-NO.
03608      IF CARRL > 0
03609          MOVE CARRI              TO  MSTR-CARRIER.
03610      IF CERTNOL > 0
03611          MOVE CERTNOI            TO  MSTR-CERT-NO-PRIME.
03612      IF SUFXL > 0
03613          MOVE SUFXI              TO  MSTR-CERT-NO-SUFX.
03614
03615      IF PI-PREV-CLAIM = LOW-VALUES
03616          NEXT SENTENCE
03617      ELSE
03618          IF CLMNOL  = 0 AND
03619             CARRL   = 0 AND
03620             CERTNOL = 0 AND
03621             SUFXL   = 0
03622                  MOVE PI-PREV-CLAIM  TO  ELMSTR-KEY.
03623
03624  7000-START-READING.
03625
03626      EXEC CICS HANDLE CONDITION
03627          ENDFILE  (8700-END-FILE)
03628          NOTFND   (8600-NOT-FOUND)
03629      END-EXEC.
03630
CIDMOD     IF YESNOSWL > 0
CIDMOD         MOVE YESNOSWI TO CL-YESNOSW
CIDMOD     END-IF.
CIDMOD
03631      MOVE 'MSTR'                 TO FILE-SWITCH.
03632
03633      EXEC CICS STARTBR
03634          DATASET   (PI-CURRENT-FILE)
03635          RIDFLD    (ELMSTR-KEY)
03636      END-EXEC.
03637
03638  7000-READ-NEXT.
03639
03640      EXEC CICS READNEXT
03641          DATASET   (PI-CURRENT-FILE)
03642          RIDFLD    (ELMSTR-KEY)
03643          INTO      (CLAIM-MASTER)
03644      END-EXEC.
03645
03646      IF ELMSTR-KEY = PI-PREV-CLAIM
03647          MOVE CL-CLAIM-NO        TO  PI-PREV-CLMNO
03648          GO TO 7000-READ-NEXT.
03649
03650      IF PI-COMPANY-CD NOT = CL-COMPANY-CD
03651          GO TO 8700-END-FILE.
03652
03653  7000-PICK-UP-LOGIC.
03654
03655      IF PI-COMPANY-ID  =  'CRI'
03656          IF CL-CLAIM-NO NOT = PI-PREV-CLMNO
03657              GO TO 8700-END-FILE.
03658
03659      IF PI-CARRIER-SECURITY > SPACES
03660          IF CL-CARRIER = PI-CARRIER-SECURITY
03661              NEXT SENTENCE
03662          ELSE
03663              GO TO 7000-READ-NEXT.
03664
03665      IF PI-ACCOUNT-SECURITY > SPACES
03666          IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
03667              NEXT SENTENCE
03668          ELSE
03669              GO TO 7000-READ-NEXT.
03670
03671      GO TO 1000-READ-CLAIM.
03672                                  EJECT
03673  7200-BROWSING-ASS-FWRD.
03674
03675      COMPUTE PI-ASS-NDX = PI-ASS-NDX + 1.
03676
03677      IF PI-ASS-NDX > +24
03678              OR
03679         PI-ASS-CERTS (PI-ASS-NDX) NOT > LOW-VALUE
03680          IF PI-PF15-LAST
03681              MOVE PI-ORIGINAL-ASS-CERT
03682                                  TO ELMSTR-KEY
03683              MOVE ZEROS          TO PI-DAYS-PAID
03684                                     PI-TOTAL-PAID
03685              MOVE LOW-VALUES     TO PI-ASSOCIATED-CERTS-TABLE
03686                                     PI-LAST-PF-KEY-IND
03687                                     PI-ASSOCIATED-PROCESS-IND
03688              GO TO 7000-START-READING
03689          ELSE
03690              COMPUTE PI-ASS-NDX = PI-ASS-NDX - 1
03691              MOVE 'F'            TO PI-LAST-PF-KEY-IND
03692              MOVE -1             TO ENTERPFL
03693              MOVE ER-0936        TO EMI-ERROR
03694              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03695              GO TO 8200-SEND-DATAONLY.
03696
03697      MOVE PI-PREV-CLAIM          TO ELMSTR-KEY.
03698      MOVE PI-ASS-CERTS (PI-ASS-NDX)
03699                                  TO MSTR-CERT-NO.
03700      MOVE 'MSTR'                 TO FILE-SWITCH.
03701
03702      EXEC CICS HANDLE CONDITION
03703          NOTFND   (0450-NOT-FOUND)
03704      END-EXEC.
03705
03706      EXEC CICS READ
03707          DATASET   (PI-CURRENT-FILE)
03708          RIDFLD    (ELMSTR-KEY)
03709          INTO      (CLAIM-MASTER)
03710      END-EXEC.
03711
03712      GO TO 7000-PICK-UP-LOGIC.
03713
03714  7200-EXIT.
03715      EXIT.
03716
03717      EJECT
03718  7500-START-BROWSE.
03719
03720      IF PI-COMPANY-ID = 'DMD'
03721              AND
03722         PI-ASS-PROCESSING
03723          GO TO 7600-BROWSING-ASS-BWRD.
03724
03725      MOVE LOW-VALUES             TO  ELMSTR-KEY.
03726      MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
03727
03728      IF CLMNOL > 0
03729          MOVE CLMNOI             TO  MSTR-CLAIM-NO.
03730      IF CARRL > 0
03731          MOVE CARRI              TO  MSTR-CARRIER.
03732      IF CERTNOL > 0
03733          MOVE CERTNOI            TO  MSTR-CERT-NO-PRIME.
03734      IF SUFXL > 0
03735          MOVE SUFXI              TO  MSTR-CERT-NO-SUFX.
03736
03737      IF PI-PREV-CLAIM = LOW-VALUES
03738          NEXT SENTENCE
03739      ELSE
03740          IF CLMNOL  = 0 AND
03741             CARRL   = 0 AND
03742             CERTNOL = 0 AND
03743             SUFXL   = 0
03744                  MOVE PI-PREV-CLAIM  TO  ELMSTR-KEY.
03745
03746  7500-START-READING.
03747
03748      EXEC CICS HANDLE CONDITION
03749          ENDFILE  (8700-END-FILE)
03750          NOTFND   (8600-NOT-FOUND)
03751      END-EXEC.
03752
03753      MOVE 'MSTR'                 TO  FILE-SWITCH.
03754
03755      EXEC CICS STARTBR
03756          DATASET   (PI-CURRENT-FILE)
03757          RIDFLD    (ELMSTR-KEY)
03758      END-EXEC.
03759
03760  7500-READ-PREV.
03761
03762      EXEC CICS READPREV
03763          DATASET   (PI-CURRENT-FILE)
03764          RIDFLD    (ELMSTR-KEY)
03765          INTO      (CLAIM-MASTER)
03766      END-EXEC.
03767
03768      IF ELMSTR-KEY = PI-PREV-CLAIM
03769          MOVE CL-CLAIM-NO        TO  PI-PREV-CLMNO
03770          GO TO 7500-READ-PREV.
03771
03772      IF PI-COMPANY-CD NOT = CL-COMPANY-CD
03773          GO TO 8700-END-FILE.
03774
03775  7500-PICK-UP-LOGIC.
03776
03777      IF PI-COMPANY-ID  =  'CRI'
03778          IF CL-CLAIM-NO NOT = PI-PREV-CLMNO
03779              GO TO 8700-END-FILE.
03780
03781      IF PI-CARRIER-SECURITY > SPACES
03782          IF CL-CARRIER = PI-CARRIER-SECURITY
03783              NEXT SENTENCE
03784          ELSE
03785              GO TO 7500-READ-PREV.
03786
03787      IF PI-ACCOUNT-SECURITY > SPACES
03788          IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
03789              NEXT SENTENCE
03790          ELSE
03791              GO TO 7500-READ-PREV.
03792
03793      GO TO 1000-READ-CLAIM.
03794                                  EJECT
03795  7600-BROWSING-ASS-BWRD.
03796
03797      COMPUTE PI-ASS-NDX = PI-ASS-NDX - 1.
03798
03799      IF PI-ASS-NDX < +1
03800          IF PI-PF16-LAST
03801              MOVE PI-ORIGINAL-ASS-CERT
03802                                  TO ELMSTR-KEY
03803              MOVE ZEROS          TO PI-DAYS-PAID
03804                                     PI-TOTAL-PAID
03805              MOVE LOW-VALUES     TO PI-ASSOCIATED-CERTS-TABLE
03806                                     PI-LAST-PF-KEY-IND
03807                                     PI-ASSOCIATED-PROCESS-IND
03808              GO TO 7500-START-READING
03809          ELSE
03810              COMPUTE PI-ASS-NDX = PI-ASS-NDX + 1
03811              MOVE 'S'            TO PI-LAST-PF-KEY-IND
03812              MOVE -1             TO ENTERPFL
03813              MOVE ER-0937        TO EMI-ERROR
03814              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03815              GO TO 8200-SEND-DATAONLY.
03816
03817      MOVE PI-PREV-CLAIM          TO ELMSTR-KEY.
03818      MOVE PI-ASS-CERTS (PI-ASS-NDX)
03819                                  TO MSTR-CERT-NO.
03820      MOVE 'MSTR'                 TO FILE-SWITCH.
03821
03822      EXEC CICS HANDLE CONDITION
03823          NOTFND   (0450-NOT-FOUND)
03824      END-EXEC.
03825
03826      EXEC CICS READ
03827          DATASET   (PI-CURRENT-FILE)
03828          RIDFLD    (ELMSTR-KEY)
03829          INTO      (CLAIM-MASTER)
03830      END-EXEC.
03831
03832      GO TO 7500-PICK-UP-LOGIC.
03833
03834  7600-EXIT.
03835      EXIT.
03836                                  EJECT
03837  7650-CREATE-ACTQ.
03838
03839      EXEC CICS HANDLE CONDITION
03840          NOTFND(7650-CREATE-NEW-ACTQ)
03841      END-EXEC.
03842
03843      MOVE PI-COMPANY-CD          TO ACTQ-COMP-CD.
03844      MOVE PI-CARRIER             TO ACTQ-CARRIER.
03845      MOVE PI-CLAIM-NO            TO ACTQ-CLAIM-NO.
03846      MOVE PI-CERT-NO             TO ACTQ-CERT-NO.
03847
03848      MOVE 'ACTQ'                 TO FILE-SWITCH.
03849      MOVE 'ELACTQ  '             TO FILE-ID.
03850
03851      EXEC CICS READ
03852          UPDATE
03853          DATASET   ('ELACTQ')
03854          SET       (ADDRESS OF ACTIVITY-QUE)
03855          RIDFLD    (ELACTQ-KEY)
03856      END-EXEC.
03857
03858      MOVE 'L'                    TO AQ-PENDING-CLAIM-RESTORE.
03859
03860      MOVE +150                   TO AQ-LAST-UPDATED-BY.
03861
03862      MOVE 'ELACTQ  '             TO FILE-ID.
03863
03864      EXEC CICS REWRITE
03865          DATASET   ('ELACTQ')
03866          FROM      (ACTIVITY-QUE)
03867      END-EXEC.
03868
03869      GO TO 7650-EXIT.
03870
03871  7650-CREATE-NEW-ACTQ.
03872
03873      EXEC CICS GETMAIN
03874          SET       (ADDRESS OF ACTIVITY-QUE)
03875          LENGTH    (60)
03876          INITIMG   (GETMAIN-SPACE)
03877      END-EXEC.
03878
03879      MOVE 'AQ'                   TO AQ-RECORD-ID.
03880      MOVE PI-COMPANY-CD          TO AQ-COMPANY-CD.
03881      MOVE PI-CARRIER             TO AQ-CARRIER.
03882      MOVE PI-CLAIM-NO            TO AQ-CLAIM-NO.
03883      MOVE PI-CERT-NO             TO AQ-CERT-NO.
03884
03885      MOVE 'L'                    TO AQ-PENDING-CLAIM-RESTORE.
03886
03887      MOVE +0                     TO AQ-PAYMENT-COUNTER
03888                                     AQ-PMT-UNAPPROVED-COUNT.
03889
03890      MOVE LOW-VALUES             TO AQ-RESEND-DATE
03891                                     AQ-FOLLOWUP-DATE.
03892
03893      MOVE +150                   TO AQ-LAST-UPDATED-BY.
03894
03895      MOVE 'ACTQ'                 TO FILE-SWITCH.
03896
03897      MOVE 'ELACTQ  '             TO FILE-ID.
03898
03899      EXEC CICS WRITE
03900          DATASET   ('ELACTQ')
03901          FROM      (ACTIVITY-QUE)
03902          RIDFLD    (AQ-CONTROL-PRIMARY)
03903      END-EXEC.
03904
03905  7650-EXIT.
03906      EXIT.
03907                                   EJECT
03908  7700-CREATE-CLAIM.
03909
03910      EXEC CICS HANDLE CONDITION
03911          NOTFND   (7700-RETR-RECORD-NOT-FOUND)
03912          DUPREC   (7700-DUPLICATE-CLAIM)
03913      END-EXEC.
03914
03915      IF CLMNOL > 0
03916          MOVE CLMNOI             TO PI-CLAIM-NO.
03917
03918      IF CARRL > 0
03919          MOVE CARRI              TO PI-CARRIER.
03920
03921      IF CERTNOL > 0
03922          MOVE CERTNOI            TO PI-CERT-PRIME.
03923
03924      IF SUFXL > 0
03925          MOVE SUFXI              TO PI-CERT-SFX.
03926
03927      MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
03928      MOVE PI-CARRIER             TO MSTR-CARRIER.
03929      MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
03930      MOVE PI-CERT-NO             TO MSTR-CERT-NO.
03931      MOVE +1                     TO PI-ASS-NDX.
03932
03933  7700-CONT-MOVE.
03934
03935      IF PI-ASS-PROCESSING
03936          MOVE PI-ASS-CERTS (PI-ASS-NDX)
03937                                  TO MSTR-CERT-NO.
03938
03939      MOVE ELMSTR-KEY             TO W-ELRETR-KEY.
03940
03941      EXEC CICS READ
03942          DATASET   ('ELRETR')
03943          SET       (ADDRESS OF RETRIEVE-MASTER)
03944          RIDFLD    (W-ELRETR-KEY)
03945      END-EXEC.
03946
03947      EXEC CICS GETMAIN
03948          SET       (ADDRESS OF CLAIM-MASTER-L)
03949          LENGTH    (350)
03950          INITIMG   (GETMAIN-SPACE)
03951      END-EXEC.
03952
03953      MOVE RETRIEVE-MASTER        TO CLAIM-MASTER.
03954      MOVE 'CL'                   TO CL-RECORD-ID.
03955      MOVE SAVE-BIN-DATE          TO CL-RESTORED-DT.
03956
03957      EXEC CICS WRITE
03958          DATASET   ('ELMSTR')
03959          FROM      (CLAIM-MASTER)
03960          RIDFLD    (CL-CONTROL-PRIMARY)
03961      END-EXEC.
03962
03963      EXEC CICS DELETE
03964          FILE      ('ELRETR')
03965          RIDFLD    (RL-CONTROL-PRIMARY)
03966      END-EXEC.
03967
03968      IF PI-ASS-PROCESSING
03969          ADD +1                  TO PI-ASS-NDX
03970          IF PI-ASS-NDX < +25
03971                  AND
03972             PI-ASS-CERTS (PI-ASS-NDX) > SPACES
03973              GO TO 7700-CONT-MOVE.
03974
03975      MOVE 'MSTR'                 TO FILE-SWITCH.
03976      MOVE 'ELMSTR'               TO PI-CURRENT-FILE.
03977      MOVE LOW-VALUES             TO PI-RETRIEVED-DATA-IND.
03978      MOVE XCTL-126               TO PI-CALLING-PROGRAM.
03979      MOVE XCTL-132               TO PGM-NAME.
03980      GO TO 9300-XCTL.
03981
03982  7700-RETR-RECORD-NOT-FOUND.
03983
03984      MOVE ER-0929                TO EMI-ERROR.
03985      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03986      MOVE -1                     TO CLMNOL.
03987      MOVE PI-CARRIER             TO CARRO.
03988      MOVE PI-CLAIM-NO            TO CLMNOO.
03989      MOVE PI-CERT-PRIME          TO CERTNOO.
03990      MOVE PI-CERT-SFX            TO SUFXO.
03991      MOVE AL-UABON               TO CLMNOA   CARRA
03992                                     CERTNOA  SUFXA.
03993      GO TO 8100-SEND-INITIAL-MAP.
03994
03995  7700-DUPLICATE-CLAIM.
03996
03997      MOVE ER-0928                TO EMI-ERROR.
03998      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03999      MOVE -1                     TO CLMNOL.
04000      MOVE PI-CARRIER             TO CARRO.
04001      MOVE PI-CLAIM-NO            TO CLMNOO.
04002      MOVE PI-CERT-PRIME          TO CERTNOO.
04003      MOVE PI-CERT-SFX            TO SUFXO.
04004      MOVE AL-UABON               TO CLMNOA   CARRA
04005                                     CERTNOA  SUFXA.
04006      GO TO 8100-SEND-INITIAL-MAP.
04007
04008  7700-EXIT.
04009      EXIT.
04010                                   EJECT
04011  8000-LOAD-ERROR-MESSAGES.
04012      IF EMI-NO-ERRORS
04013          GO TO 8000-EXIT.
04014
04015      IF EMI-NUMBER-OF-LINES = 1
04016          MOVE EMI-LINE1          TO ERRMSG1O
04017          GO TO 8000-EXIT.
04018
04019      MOVE EMI-LINE1              TO ERRMSG1O.
04020
04021  8000-EXIT.
04022      EXIT.
04023
04024  8100-SEND-INITIAL-MAP.
04025
04026      MOVE SAVE-DATE              TO RUNDTEO.
04027      MOVE EIBTIME                TO TIME-IN.
04028      MOVE TIME-OUT               TO RUNTIMEO.
101501     MOVE PI-COMPANY-ID          TO CMPNYIDO.
101501     MOVE PI-PROCESSOR-ID        TO USERIDO.
04029      PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
04030
04031      IF PI-USES-PAID-TO
04032         MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
04033
04034      IF PI-RETRIEVED-DATA
04035          MOVE 'RETRIEVE MASTER'  TO RETMSTO.
04036
04037      IF PI-COMPANY-ID = 'DMD'
04038          MOVE 'PF11=FORM REF'    TO PFKEY11O
04039          MOVE 'LST PMT AMT:'     TO COVERDO
04040          MOVE 'LST PMT DT :'     TO PRMTYPDO
04041          MOVE 'COVERAGE   :'     TO CRTSTADO.
031714
031714     IF PI-APPROVAL-LEVEL = '4' OR '5'
031714         MOVE AL-UNNOF         TO TOTINTA
031714     END-IF
04042
04043      EXEC CICS SEND
04044          MAP      (MAP-NAME)
04045          MAPSET   (MAPSET-NAME)
04046          FROM     (EL150AO)
04047          ERASE
04048          CURSOR
04049      END-EXEC.
04050
04051      GO TO 9100-RETURN-TRAN.
04052
           .
04053  8200-SEND-DATAONLY.
04054      MOVE SAVE-DATE              TO RUNDTEO.
04055      MOVE EIBTIME                TO TIME-IN.
04056      MOVE TIME-OUT               TO RUNTIMEO.
101501     MOVE PI-COMPANY-ID          TO CMPNYIDO.
101501     MOVE PI-PROCESSOR-ID        TO USERIDO.
04057      PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
04058
04059      MOVE PI-CARRIER             TO CARRO.
04060      MOVE PI-CLAIM-NO            TO CLMNOO.
04061      MOVE PI-CERT-PRIME          TO CERTNOO.
04062      MOVE PI-CERT-SFX            TO SUFXO.
04063
04064      IF PI-USES-PAID-TO
04065         MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
04066
04067      IF PI-RETRIEVED-DATA
04068          MOVE 'RETRIEVE MASTER'  TO RETMSTO.
04069
04070      IF PI-COMPANY-ID = 'DMD'
04071          MOVE 'PF11=FORM REF'    TO PFKEY11O
04072          MOVE 'LST PMT AMT:'     TO COVERDO
04073          MOVE 'LST PMT DT :'     TO PRMTYPDO
04074          MOVE 'COVERAGE   :'     TO CRTSTADO.
031714
031714     IF PI-APPROVAL-LEVEL = '4' OR '5'
031714         MOVE AL-UNNOF         TO TOTINTA
031714     END-IF
04075
04076      EXEC CICS SEND
04077          MAP      (MAP-NAME)
04078          MAPSET   (MAPSET-NAME)
04079          FROM     (EL150AO)
04080          DATAONLY
04081          CURSOR
04082      END-EXEC.
04083
04084      GO TO 9100-RETURN-TRAN.
04085
04086  8250-SEND-WITH-CURSOR.
04087      MOVE SAVE-DATE              TO RUNDTEO.
04088      MOVE EIBTIME                TO TIME-IN.
04089      MOVE TIME-OUT               TO RUNTIMEO.
101501     MOVE PI-COMPANY-ID          TO CMPNYIDO.
101501     MOVE PI-PROCESSOR-ID        TO USERIDO.
04090      PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
04091
04092      IF PI-USES-PAID-TO
04093         MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
04094
04095      IF PI-COMPANY-ID = 'DMD'
04096          MOVE 'PF11=FORM REF'    TO PFKEY11O
04097          MOVE 'LST PMT AMT:'     TO COVERDO
04098          MOVE 'LST PMT DT :'     TO PRMTYPDO
04099          MOVE 'COVERAGE   :'     TO CRTSTADO.
031714
031714     IF PI-APPROVAL-LEVEL = '4' OR '5'
031714         MOVE AL-UNNOF         TO TOTINTA
031714     END-IF
04100
04101      EXEC CICS SEND
04102          MAP      (MAP-NAME)
04103          MAPSET   (MAPSET-NAME)
04104          FROM     (EL150AO)
04105          ERASE
04106          CURSOR   (PI-SAVE-CURSOR)
04107      END-EXEC.
04108
04109      GO TO 9100-RETURN-TRAN.
04110
04111  8300-SEND-TEXT.
04112      EXEC CICS SEND TEXT
04113          FROM     (LOGOFF-TEXT)
04114          LENGTH   (LOGOFF-LENGTH)
04115          ERASE
04116          FREEKB
04117      END-EXEC.
04118
04119      EXEC CICS RETURN
04120      END-EXEC.
04121
04122  8500-FILE-NOTOPEN.
04123      IF FILE-SWITCH = 'MSTR'
04124          MOVE ER-0154            TO EMI-ERROR.
04125
04126      IF FILE-SWITCH = 'TRLR'
04127          MOVE ER-0172            TO EMI-ERROR.
04128
04129      IF FILE-SWITCH = 'CERT'
04130          MOVE ER-0169            TO EMI-ERROR.
04131
04132      IF FILE-SWITCH = 'CNTL'
04133          MOVE ER-0042            TO EMI-ERROR.
04134
04135      IF FILE-SWITCH = 'ACTQ'
04136          MOVE ER-0338            TO EMI-ERROR.
04137
04138      IF FILE-SWITCH = 'ACCT'
04139          MOVE ER-0168            TO EMI-ERROR.
04140
04141      IF FILE-SWITCH = 'PLCY'
04142          MOVE ER-9883            TO EMI-ERROR.
04143
04144      IF FILE-SWITCH = 'PLAN'
04145          MOVE ER-9808            TO EMI-ERROR.
04146
04147      IF FILE-SWITCH = 'PROD'
04148          MOVE ER-9886            TO EMI-ERROR.
04149
04150      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04151
030612     IF FILE-SWITCH = 'CERT' AND 
030612       (PI-COMPANY-ID = 'CID' OR 'AHL')
04153         GO TO 1050-SHOW-CONTINUE.
04154
04155      MOVE -1                     TO FILETOL.
04156
04157      IF PASS-SWITCH = 'A'
04158          GO TO 8100-SEND-INITIAL-MAP
04159      ELSE
04160          GO TO 8200-SEND-DATAONLY.
04161
04162  8600-NOT-FOUND.
04163      MOVE AL-UABON               TO CLMNOA    CARRA
04164                                     CERTNOA   SUFXA.
04165      MOVE -1                     TO ENTERPFL.
04166      MOVE ER-0204                TO EMI-ERROR.
04167      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04168      GO TO 8200-SEND-DATAONLY.
04169
04170  8700-END-FILE.
04171
04172      MOVE -1                     TO ENTERPFL.
04173      MOVE ER-0130                TO EMI-ERROR.
04174      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04175      GO TO 8200-SEND-DATAONLY.
04176
04177  8800-UNAUTHORIZED-ACCESS.
04178      MOVE UNACCESS-MSG           TO LOGOFF-MSG.
04179      GO TO 8300-SEND-TEXT.
04180
04181  8810-PF23.
04182      MOVE EIBAID                 TO PI-ENTRY-CD-1.
04183      MOVE XCTL-005               TO PGM-NAME.
04184      GO TO 9300-XCTL.
04185
04186  8900-GET-FREE-LOOK.
04187      MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
04188      MOVE SPACES                 TO CNTL-ACCESS.
04189      MOVE PI-STATE               TO CNTL-ACCESS.
04190      MOVE '3'                    TO CNTL-REC-TYPE.
04191      MOVE +0                     TO CNTL-SEQ-NO.
04192
04193      EXEC CICS READ
04194          DATASET   ('ELCNTL')
04195          SET       (ADDRESS OF CONTROL-FILE)
04196          RIDFLD    (ELCNTL-KEY)
04197          RESP      (WS-RESPONSE)
04198      END-EXEC.
04199
04200      IF WS-RESP-NOTFND
04201         MOVE ER-2848             TO EMI-ERROR
04202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04203         GO TO 8100-SEND-INITIAL-MAP
04204      ELSE
04205         MOVE CF-ST-FREE-LOOK-PERIOD
04206                                  TO CP-FREE-LOOK.
04207
04208  8900-EXIT.
04209      EXIT.
04210
04211  9100-RETURN-TRAN.
04212      MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
04213      MOVE '150A'                 TO PI-CURRENT-SCREEN-NO.
04214
04215      EXEC CICS RETURN
04216          TRANSID    (TRANS-ID)
04217          COMMAREA   (PROGRAM-INTERFACE-BLOCK)
04218          LENGTH     (PI-COMM-LENGTH)
04219      END-EXEC.
04220
04221  9200-RETURN-MAIN-MENU.
04222      MOVE XCTL-126               TO PGM-NAME.
04223      GO TO 9300-XCTL.
04224
04225  9300-XCTL.
04226      EXEC CICS XCTL
04227          PROGRAM    (PGM-NAME)
04228          COMMAREA   (PROGRAM-INTERFACE-BLOCK)
04229          LENGTH     (PI-COMM-LENGTH)
04230      END-EXEC.
04231
04232  9400-CLEAR.
04233      MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
04234      GO TO 9300-XCTL.
04235
04236  9500-PF12.
04237      MOVE XCTL-010               TO PGM-NAME.
04238      GO TO 9300-XCTL.
04239
04240  9600-PGMID-ERROR.
04241      EXEC CICS HANDLE CONDITION
04242          PGMIDERR   (8300-SEND-TEXT)
04243      END-EXEC.
04244
04245      MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
04246      MOVE ' '                    TO PI-ENTRY-CD-1.
04247      MOVE XCTL-005               TO PGM-NAME.
04248      MOVE PGM-NAME               TO LOGOFF-PGM.
04249      MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
04250      GO TO 9300-XCTL.
04251
04252  9700-LINK-DATE-CONVERT.
04253      MOVE LINK-ELDATCV           TO PGM-NAME.
04254
04255      EXEC CICS LINK
04256          PROGRAM    (PGM-NAME)
04257          COMMAREA   (DATE-CONVERSION-DATA)
04258          LENGTH     (DC-COMM-LENGTH)
04259      END-EXEC.
04260
04261  9700-EXIT.
04262      EXIT.
04263
04264  9800-LINK-REM-TERM.
04265      MOVE LINK-ELRTRM            TO PGM-NAME.
04266
04267      EXEC CICS LINK
04268          PROGRAM    (PGM-NAME)
04269          COMMAREA   (CALCULATION-PASS-AREA)
04270          LENGTH     (CP-COMM-LENGTH)
04271      END-EXEC.
04272
04273  9800-EXIT.
04274      EXIT.
04275                                  EJECT
04276  9830-DMD-REMAINING-TERM.
04277
04278      DIVIDE CL-NO-OF-DAYS-PAID BY +30
04279          GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
04280
04281      MOVE W-PAID-MONTHS          TO W-PYMTS.
04282      MOVE W-PAID-DAYS            TO W-ADD-DAYS.
04283
04284      COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30
04285                             + CM-PMT-EXTENSION-DAYS.
04286
04287      COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS
04288                                 - CL-NO-OF-DAYS-PAID.
04289
04290      DIVIDE W-REM-TERM-IN-DAYS BY +30
04291          GIVING W-REM REMAINDER W-REM-DAYS.
04292
04293      MOVE W-REM                  TO WST-REM.
04294
04295      IF CM-PMT-EXTENSION-DAYS > ZEROS
04296          MOVE '/'                TO WST-SLASH1
04297          MOVE CM-PMT-EXTENSION-DAYS TO WST-EXT-DAYS
04298      ELSE
04299          MOVE SPACES             TO WST-ORIG-DAYS-GRP.
04300
04301      IF W-REM-DAYS > ZEROS
04302          MOVE '/'                TO WST-SLASH2
04303          MOVE W-REM-DAYS         TO WST-REM-DAYS
04304      ELSE
04305          MOVE SPACES             TO WST-REM-DAYS-GRP.
04306
04307  9830-EXIT.
04308      EXIT.
04309
04310  9850-LINK-REM-AMT.
04311      MOVE 'ELRAMT  '             TO PGM-NAME.
04312
04313      EXEC CICS LINK
04314          PROGRAM    (PGM-NAME)
04315          COMMAREA   (CALCULATION-PASS-AREA)
04316          LENGTH     (CP-COMM-LENGTH)
04317      END-EXEC.
04318
04319  9850-EXIT.
04320      EXIT.
04321
04322  9900-ERROR-FORMAT.
04323      IF NOT EMI-ERRORS-COMPLETE
04324          MOVE LINK-001           TO PGM-NAME
04325          EXEC CICS LINK
04326              PROGRAM    (PGM-NAME)
04327              COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
04328              LENGTH     (EMI-COMM-LENGTH)
04329          END-EXEC.
04330
04331  9900-EXIT.
04332      EXIT.
04333
04334  9990-ABEND.
04335      MOVE -1 TO FILETOL.
04336      MOVE LINK-004 TO PGM-NAME.
04337
04338      MOVE DFHEIBLK               TO EMI-LINE1
04339      EXEC CICS LINK
04340          PROGRAM   (PGM-NAME)
04341          COMMAREA  (EMI-LINE1)
04342          LENGTH    (72)
04343      END-EXEC.
04344
04345      MOVE EMI-LINE1              TO ERRMSG1O.
04346      GO TO 8200-SEND-DATAONLY.
04347
04348  EJECT
04349  9995-SECURITY-VIOLATION.
04350                              COPY ELCSCTP.
04351
