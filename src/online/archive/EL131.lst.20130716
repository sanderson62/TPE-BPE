* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32******************************************************************
    33
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page   3
* EL131.cbl
    35 ENVIRONMENT DIVISION.
    36
    37 DATA DIVISION.
    38
    39 WORKING-STORAGE SECTION.
    40 01  DFH-START PIC X(04).
    41
    42 77  FILLER  PIC X(32)  VALUE '********************************'.
    43 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    44 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    45 77  s1                          pic s999 comp-3 value+0.
    46 77  s2                          pic s999 comp-3 value+0.
    47 77  a1                          pic s999 comp-3 value+0.
    48 77  WS-CRIT-PER-RECURRENT       PIC X     VALUE ' '.
    49 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    50 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    51 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    52 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    53 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    54 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    55 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    56     88  ERPDEF-FOUND                 VALUE 'Y'.
    57
    58 01  LCP-TIME-OF-DAY-XX.
    59     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    60     05  FILLER                    PIC 99.
    61 01  LCP-CICS-TIME                 PIC 9(15).
    62*                            COPY ELCSCTM.
    63******************************************************************
    64*                                                                *
    65*                                                                *
    66*                            ELCSCTM                             *
    67*                            VMOD=2.001                          *
    68*                                                                *
    69*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    70*                                                                *
    71******************************************************************
    72 01  SECURITY-MESSAGE.
    73     12  FILLER                          PIC X(30)
    74            VALUE '** LOGIC SECURITY VIOLATION -'.
    75     12  SM-READ                         PIC X(6).
    76     12  FILLER                          PIC X(5)
    77            VALUE ' PGM='.
    78     12  SM-PGM                          PIC X(6).
    79     12  FILLER                          PIC X(5)
    80            VALUE ' OPR='.
    81     12  SM-PROCESSOR-ID                 PIC X(4).
    82     12  FILLER                          PIC X(6)
    83            VALUE ' TERM='.
    84     12  SM-TERMID                       PIC X(4).
    85     12  FILLER                          PIC XX   VALUE SPACE.
    86     12  SM-JUL-DATE                     PIC 9(5).
    87     12  FILLER                          PIC X    VALUE SPACE.
    88     12  SM-TIME                         PIC 99.99.
    89
    90
    91*                            COPY ELCSCRTY.
    92******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page   4
* EL131.cbl
    93*                                                                *
    94*                                                                *
    95*                            ELCSCRTY                            *
    96*                            VMOD=2.001                          *
    97*                                                                *
    98*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    99*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   100*        SAVED IN PI-SECURITY-ADDRESS.                           *
   101*                                                                *
   102******************************************************************
   103 01  SECURITY-CONTROL.
   104     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   105     12  FILLER                       PIC XX    VALUE 'SC'.
   106     12  SC-CREDIT-CODES.
   107         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   108             20  SC-CREDIT-DISPLAY    PIC X.
   109             20  SC-CREDIT-UPDATE     PIC X.
   110     12  SC-CLAIMS-CODES.
   111         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   112             20  SC-CLAIMS-DISPLAY    PIC X.
   113             20  SC-CLAIMS-UPDATE     PIC X.
   114
   115*                            COPY ELCNWA.
   116*****************************************************************
   117*                                                               *
   118*                                                               *
   119*                            ELCNWA.                            *
   120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   121*                            VMOD=2.003                         *
   122*                                                               *
   123*            M O V E   N A M E   W O R K   A R E A.             *
   124*                                                               *
   125*****************************************************************.
   126
   127 01  WS-NAME-WORK-AREA.
   128     05  WS-INSURED-LAST-NAME        PIC X(15).
   129     05  WS-INSURED-1ST-NAME         PIC X(12).
   130     05  WS-INSURED-MID-INIT         PIC X.
   131
   132     05  WS-NAME-WORK.
   133         10  WS-NW                   PIC X
   134             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   135
   136     05  WS-NAME-WORK2.
   137         10  WS-NW2                  PIC X
   138             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   139                                        NWA-INDEX0.
   140
   141     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   142                                     COMP-3.
   143
   144
   145 01  ws-dcc-error-line.
   146     05  filler occurs 15.
   147         10  ws-error-no        pic x(4).
   148 01  WS-DATE-AREA.
   149     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   150     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page   5
* EL131.cbl
   151     12  SAVE-DATE-CCYYMMDD.
   152         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   153         16  SAVE-DATE-YMD.
   154             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   155             20  FILLER         PIC X(4)    VALUE SPACES.
   156
   157 01  WS-BLANK                   PIC X       VALUE ' '.
   158
   159 01  CSO-WORK-FIELDS.
   160     05  WS-HOLD-CLAIM-STATUS    PIC X.
   161
   162 01  LITERALS-NUMBERS.
   163     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   164     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   165     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   166     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   167     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   168     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   169     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   170
   171     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   172     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   173     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   174     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   175     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   176     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   177     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   178     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   179     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   180
   181     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   182
   183     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   184
   185     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   186     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   187     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   188     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   189     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   190     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   191     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   192     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   193     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   194     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   195     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   196
   197     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   198     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   199     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   200     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   201         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   202     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   203     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   204     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   205     12  WS-CLAIM-SEQU.
   206         16  FILLER              PIC X VALUE '('.
   207         16  WS-CURRENT-SEQU     PIC Z9.
   208         16  FILLER              PIC X(04) VALUE ' OF '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page   6
* EL131.cbl
   209         16  WS-OF-SEQU          PIC Z9.
   210         16  FILLER              PIC X VALUE ')'.
   211     12  WS-EDIT-BEN-CODE        PIC XX.
   212         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   213                                          '90' THRU '99'.
   214
   215     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   216     12  WS-EDIT-NUMBER          PIC ZZZ9.
   217
   218     12  WS-RESPONSE             PIC S9(8)   COMP.
   219         88  WS-RESP-NORMAL              VALUE +00.
   220         88  WS-RESP-ERROR               VALUE +01.
   221         88  WS-RESP-NOTFND              VALUE +13.
   222         88  WS-RESP-DUPKEY              VALUE +15.
   223         88  WS-RESP-NOTOPEN             VALUE +19.
   224         88  WS-RESP-ENDFILE             VALUE +20.
   225
   226     12  WS-MOS-PAID             PIC 999.
   227     12  WS-ODD-DAYS             PIC 99.
   228     12  WS-REM-MOS              PIC 999.
   229     12  WS-REM-DAYS             PIC 99.
   230     12  WS-TERM-IN-DAYS         PIC 9(4).
   231     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   232
   233     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   234     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   235     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   236     12  WS-RESET-SW             PIC X       VALUE 'N'.
   237     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   238     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   239     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   240
   241 01  DMD-DATE-YYYYMMDD.
   242     12  DMD-DECADE          PIC XX      VALUE SPACES.
   243     12  DMD-YYMMDD.
   244         16  DMD-YY          PIC XX      VALUE SPACES.
   245         16  DMD-MM          PIC XX      VALUE SPACES.
   246         16  DMD-DD          PIC XX      VALUE SPACES.
   247
   248 01  DMD-DATE-MMDDYYYY.
   249     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   250     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   251     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   252     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   253     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   254     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   255
   256 01  WS-MAIL-CODE.
   257     12  FILLER              PIC X.
   258     12  DMD-MAIL-CODE.
   259         16  WS-MAIL-4       PIC X(4).
   260         16  WS-MAIL-5       PIC X.
   261     12  FILLER              PIC X(4).
   262
   263     12  W-NAME-LAST             PIC  X(15).
   264     12  W-NAME-FIRST            PIC  X(15).
   265     12  W-NAME-MIDDLE.
   266         16  FILLER              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page   7
* EL131.cbl
   267         16  W-NAME-MIDDLE-2     PIC  X.
   268         16  FILLER              PIC  X(13).
   269
   270*    COPY ELCDCTB.
   271******************************************************************
   272*                                                                *
   273*                                                                *
   274*                            ELCDCTB.                            *
   275*                            VMOD=2.002                          *
   276*                                                                *
   277*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   278*       COMMUNICATIONS AREA                                      *
   279*                                                                *
   280******************************************************************
   281 01  DCT-COMMUNICATION-AREA.
   282     12  DCT-BILLING-BANK-ID      PIC  X(05).
   283     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   284     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   285     12  DCT-PRODUCT-CODE         PIC  X(02).
   286     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   287     12  DCT-RETURN-CODE          PIC  X(02).
   288     12  DCT-MAIL-CODE            PIC  X(05).
   289     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   290     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page   8
* EL131.cbl
   292 01  ERROR-SWITCHES.
   293     12  ERROR-SWITCH            PIC X.
   294         88  SCREEN-ERROR                    VALUE 'X'.
   295     12  MSTR-KEY-SWITCH         PIC X.
   296         88  MSTR-KEY-CHANGED                VALUE 'X'.
   297     12  CERT-KEY-SWITCH         PIC X.
   298*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   299         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   300*********SET TO Y IF PRIMARY KEY WILL CHANGE
   301         88  CERT-KEY-CHANGED                VALUE 'Y'.
   302     12  MSTR-SWITCH             PIC X.
   303         88  MSTR-UPDATES                    VALUE 'X'.
   304     12  CERT-SWITCH             PIC X.
   305         88  CERT-UPDATES                    VALUE 'X'.
   306     12  UPDATE-SWITCH           PIC X.
   307         88  UPDATES-PRESENT                 VALUE 'X'.
   308     12  TRLR-SWITCH             PIC X.
   309         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   310         88  UPDATE-MADE                     VALUE 'Y'.
   311     12  NINETY-TRLR-SWITCH      PIC X.
   312         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   313     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   314         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   315     12  EARNINGS-CALC-SWITCH    PIC X.
   316         88  TEX-REG                         VALUE '4'.
   317         88  NET-PAY                         VALUE '5'.
   318     12  DLYACTV-SW              PIC X       VALUE 'N'.
   319         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page   9
* EL131.cbl
   321 01  EDIT-WORK-AREA.
   322     12  COUNT-2                 PIC 9.
   323     12  CALL-PGM                PIC X(8).
   324     12  TRANS-ID                PIC X(4).
   325     12  CHECK-PFKEYS            PIC 99.
   326     12  CHECK-MAINT             PIC X.
   327         88  ADD-ALPHA-RECORD                VALUE 'A'.
   328         88  CHANGE-CLAIM                    VALUE 'C'.
   329         88  DELETE-CLAIM                    VALUE 'D'.
   330         88  CHANGE-NAME                     VALUE 'N'.
   331         88  VALID-OPTIONS                   VALUE 'A' 'C'
   332                                                   'D' 'N'.
   333
   334     12  HOLD-BENEFIT            PIC XX.
   335     12  HOLD-FREQ               PIC XX.
   336     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   337     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   338     12  HOLD-PDTHRU             PIC XX.
   339     12  HOLD-ADDON              PIC XX.
   340     12  HOLD-NODAYS             PIC 9(4).
   341     12  HOLD-NOPMTS             PIC 9(3).
   342     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   343     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   344     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   345     12  HOLD-BIRTH              PIC XX.
   346     12  HOLD-END                PIC XX.
   347     12  HOLD-EFF                PIC XX.
   348     12  HOLD-ENTRY              PIC XX.
   349     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   350     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   351     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   352     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   353     12  HOLD-LF-CV-CAN          PIC XX.
   354     12  HOLD-AH-CV-CAN          PIC XX.
   355     12  DIVIDE-QUOT             PIC 9(3).
   356     12  DIVIDE-REM              PIC 9(3).
   357
   358     12  WS-ALPHA-DATE.
   359         16  WS-ALPHA-YEAR.
   360             20  WS-ALPHA-YY-1   PIC 99.
   361             20  WS-ALPHA-YY-2   PIC 99.
   362         16  WS-ALPHA-MM         PIC 99.
   363         16  WS-ALPHA-DD         PIC 99.
   364
   365     12  BUILD-VALID-DATE.
   366         16  BUILD-MONTH         PIC 99.
   367         16  BUILD-DAY           PIC 99.
   368         16  BUILD-YEAR          PIC 99.
   369     12  DEEDIT-MMYY-INPUT.
   370         16  FILLER              PIC X.
   371         16  DEEDIT-MONTH        PIC XX.
   372         16  DEEDIT-YEAR         PIC XX.
   373     12  DEEDIT-BEN              PIC 9(9)V99.
   374     12  DEEDIT-DATE-INPUT.
   375         16  FILLER              PIC XX.
   376         16  DEEDIT-DATE         PIC X(6).
   377     12  WORK-DATE-MDY.
   378         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  10
* EL131.cbl
   379         16  FILLER              PIC X(4).
   380         16  YEAR-WORK           PIC XX.
   381     12  WORK-DATE-MY.
   382         16  WORK-MONTH          PIC XX.
   383         16  WORK-SLASH          PIC X       VALUE '/'.
   384         16  WORK-YEAR           PIC XX.
   385     12  HOLD-DATE.
   386         16  HOLD-MONTH          PIC 99.
   387         16  FILLER              PIC X(4).
   388         16  HOLD-YEAR           PIC 99.
   389     12  SPLIT-INFO-LINE-1.
   390         16  SPLIT-INFO-DESC     PIC X(15).
   391         16  FILLER              PIC X(5)    VALUE ' OLD='.
   392         16  SPLIT-INFO-OLD      PIC X(40).
   393     12  EFF-TERM-MO             PIC 9(4).
   394     12  CURR-MO                 PIC 9(4).
   395     12  WS-BIN-CURRENT-DT       PIC XX.
   396     12  WS-CALC-METHOD          PIC X.
   397     12  WS-INITIALS.
   398         16  WS-INIT-1           PIC X.
   399         16  WS-INIT-2           PIC X.
   400     12  WS-REIN-TABLE.
   401         16  WS-REIN-1           PIC X.
   402         16  WS-REIN-2           PIC X.
   403         16  WS-REIN-3           PIC X.
   404     12  PI-KEY.
   405         16  PI-TERM             PIC X(4).
   406         16  PI-QUAL             PIC X(4).
   407     12  CHECK-KEY               PIC X(20).
   408     12  SAVE-ACCT-KEY           PIC X(20).
   409     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   410     12  WS-SOC-SEC-NUMBER.
   411         16  WS-SOC-SEC-NO       PIC 9(9).
   412         16  WS-SOC-SEC-BLANK    PIC X(2).
   413     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   414         16  WS-SSN-1-3          PIC 9(3).
   415         16  WS-SSN-DASH1        PIC X(1).
   416         16  WS-SSN-4-5          PIC 9(2).
   417         16  WS-SSN-DASH2        PIC X(1).
   418         16  WS-SSN-6-9          PIC 9(4).
   419     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   420
   421 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   422     12  M                   PIC S9(7)V99           VALUE ZEROS.
   423     12  L                   PIC S9(7)V99           VALUE ZEROS.
   424     12  N                   PIC S9(3)              VALUE ZEROS.
   425     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   426     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   427     12  I                   PIC S99V9(5)           VALUE ZEROS.
   428     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   429     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   430     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   431     12  R                   PIC S9(3)              VALUE ZEROS.
   432     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   433     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   434     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   435     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   436     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  11
* EL131.cbl
   437     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   438     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   439     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   440     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   441
   442 01  TERM-CALC-WORK-AREA.
   443     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   444     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   445     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   446     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   447     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   448     12  V-EXPONENTS.
   449        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   450     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   451
   452 01  TIME-IN.
   453     12  UN-HOURS                PIC XX.
   454     12  UN-MINUTES              PIC XX.
   455     12  FILLER                  PIC XX.
   456
   457 01  TIME-OUT.
   458     12  FOR-HOURS               PIC XX.
   459     12  FILLER                  PIC X       VALUE '.'.
   460     12  FOR-MINUTES             PIC XX.
   461
   462 01  ERROR-NUMBERS.
   463     12  ER-0000                 PIC X(4)    VALUE '0000'.
   464     12  ER-0004                 PIC X(4)    VALUE '0004'.
   465     12  ER-0008                 PIC X(4)    VALUE '0008'.
   466     12  ER-0023                 PIC X(4)    VALUE '0023'.
   467     12  ER-0029                 PIC X(4)    VALUE '0029'.
   468     12  ER-0068                 PIC X(4)    VALUE '0068'.
   469     12  ER-0070                 PIC X(4)    VALUE '0070'.
   470     12  ER-0149                 PIC X(4)    VALUE '0149'.
   471     12  ER-0154                 PIC X(4)    VALUE '0154'.
   472     12  ER-0169                 PIC X(4)    VALUE '0169'.
   473     12  ER-0192                 PIC X(4)    VALUE '0192'.
   474     12  ER-0199                 PIC X(4)    VALUE '0199'.
   475     12  ER-0203                 PIC X(4)    VALUE '0203'.
   476     12  ER-0204                 PIC X(4)    VALUE '0204'.
   477     12  ER-0205                 PIC X(4)    VALUE '0205'.
   478     12  ER-0206                 PIC X(4)    VALUE '0206'.
   479     12  ER-0208                 PIC X(4)    VALUE '0208'.
   480     12  ER-0210                 PIC X(4)    VALUE '0210'.
   481     12  ER-0215                 PIC X(4)    VALUE '0215'.
   482     12  ER-0219                 PIC X(4)    VALUE '0219'.
   483     12  ER-0220                 PIC X(4)    VALUE '0220'.
   484     12  ER-0222                 PIC X(4)    VALUE '0222'.
   485     12  ER-0223                 PIC X(4)    VALUE '0223'.
   486     12  ER-0224                 PIC X(4)    VALUE '0224'.
   487     12  ER-0227                 PIC X(4)    VALUE '0227'.
   488     12  ER-0230                 PIC X(4)    VALUE '0230'.
   489     12  ER-0232                 PIC X(4)    VALUE '0232'.
   490     12  ER-0233                 PIC X(4)    VALUE '0233'.
   491     12  ER-0236                 PIC X(4)    VALUE '0236'.
   492     12  ER-0237                 PIC X(4)    VALUE '0237'.
   493     12  ER-0238                 PIC X(4)    VALUE '0238'.
   494     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  12
* EL131.cbl
   495     12  ER-0241                 PIC X(4)    VALUE '0241'.
   496     12  ER-0243                 PIC X(4)    VALUE '0243'.
   497     12  ER-0244                 PIC X(4)    VALUE '0244'.
   498     12  ER-0246                 PIC X(4)    VALUE '0246'.
   499     12  ER-0247                 PIC X(4)    VALUE '0247'.
   500     12  ER-0248                 PIC X(4)    VALUE '0248'.
   501     12  ER-0250                 PIC X(4)    VALUE '0250'.
   502     12  ER-0251                 PIC X(4)    VALUE '0251'.
   503     12  ER-0253                 PIC X(4)    VALUE '0253'.
   504     12  ER-0256                 PIC X(4)    VALUE '0256'.
   505     12  ER-0257                 PIC X(4)    VALUE '0257'.
   506     12  ER-0258                 PIC X(4)    VALUE '0258'.
   507     12  ER-0259                 PIC X(4)    VALUE '0259'.
   508     12  ER-0260                 PIC X(4)    VALUE '0260'.
   509     12  ER-0261                 PIC X(4)    VALUE '0261'.
   510     12  ER-0262                 PIC X(4)    VALUE '0262'.
   511     12  ER-0263                 PIC X(4)    VALUE '0263'.
   512     12  ER-0273                 PIC X(4)    VALUE '0273'.
   513     12  ER-0274                 PIC X(4)    VALUE '0274'.
   514     12  ER-0276                 PIC X(4)    VALUE '0276'.
   515     12  ER-0282                 PIC X(4)    VALUE '0282'.
   516     12  ER-0283                 PIC X(4)    VALUE '0283'.
   517     12  ER-0309                 PIC X(4)    VALUE '0309'.
   518     12  ER-0310                 PIC X(4)    VALUE '0310'.
   519     12  ER-0311                 PIC X(4)    VALUE '0311'.
   520     12  ER-0333                 PIC X(4)    VALUE '0333'.
   521     12  ER-0360                 PIC X(4)    VALUE '0360'.
   522     12  ER-0377                 PIC X(4)    VALUE '0377'.
   523     12  ER-0402                 PIC X(4)    VALUE '0402'.
   524     12  ER-0416                 PIC X(4)    VALUE '0416'.
   525     12  ER-0426                 PIC X(4)    VALUE '0426'.
   526     12  ER-0427                 PIC X(4)    VALUE '0427'.
   527     12  ER-0428                 PIC X(4)    VALUE '0428'.
   528     12  ER-0429                 PIC X(4)    VALUE '0429'.
   529     12  ER-0430                 PIC X(4)    VALUE '0430'.
   530     12  ER-0458                 PIC X(4)    VALUE '0458'.
   531     12  ER-0475                 PIC X(4)    VALUE '0475'.
   532     12  ER-0491                 PIC X(4)    VALUE '0491'.
   533     12  ER-0509                 PIC X(4)    VALUE '0509'.
   534     12  ER-0510                 PIC X(4)    VALUE '0510'.
   535     12  ER-0511                 PIC X(4)    VALUE '0511'.
   536     12  ER-0512                 PIC X(4)    VALUE '0512'.
   537     12  ER-0519                 PIC X(4)    VALUE '0519'.
   538     12  ER-0520                 PIC X(4)    VALUE '0520'.
   539     12  ER-0521                 PIC X(4)    VALUE '0521'.
   540     12  ER-0547                 PIC X(4)    VALUE '0547'.
   541     12  ER-0548                 PIC X(4)    VALUE '0548'.
   542     12  ER-0549                 PIC X(4)    VALUE '0549'.
   543     12  ER-0565                 PIC X(4)    VALUE '0565'.
   544     12  ER-0598                 PIC X(4)    VALUE '0598'.
   545     12  ER-0639                 PIC X(4)    VALUE '0639'.
   546     12  ER-0797                 PIC X(4)    VALUE '0797'.
   547     12  ER-0802                 PIC X(4)    VALUE '0802'.
   548     12  ER-0803                 PIC X(4)    VALUE '0803'.
   549     12  ER-0849                 PIC X(4)    VALUE '0849'.
   550     12  ER-0885                 PIC X(4)    VALUE '0885'.
   551     12  ER-0887                 PIC X(4)    VALUE '0887'.
   552     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  13
* EL131.cbl
   553     12  ER-0921                 PIC X(4)    VALUE '0921'.
   554     12  ER-0938                 PIC X(4)    VALUE '0938'.
   555     12  ER-0946                 PIC X(4)    VALUE '0946'.
   556     12  ER-0947                 PIC X(4)    VALUE '0947'.
   557     12  ER-0948                 PIC X(4)    VALUE '0948'.
   558     12  ER-0949                 PIC X(4)    VALUE '0949'.
   559     12  ER-0950                 PIC X(4)    VALUE '0950'.
   560     12  ER-0951                 PIC X(4)    VALUE '0951'.
   561     12  ER-0954                 PIC X(4)    VALUE '0954'.
   562     12  ER-0974                 PIC X(4)    VALUE '0974'.
   563     12  ER-0975                 PIC X(4)    VALUE '0975'.
   564     12  ER-1651                 PIC X(4)    VALUE '1651'.
   565     12  ER-1652                 PIC X(4)    VALUE '1652'.
   566     12  ER-1653                 PIC X(4)    VALUE '1653'.
   567     12  ER-1654                 PIC X(4)    VALUE '1654'.
   568     12  ER-1655                 PIC X(4)    VALUE '1655'.
   569     12  er-1656                 pic x(4)    value '1656'.
   570     12  ER-1661                 PIC X(4)    VALUE '1661'.
   571     12  ER-1662                 PIC X(4)    VALUE '1662'.
   572     12  ER-1773                 PIC X(4)    VALUE '1773'.
   573     12  ER-2280                 PIC X(4)    VALUE '2280'.
   574     12  ER-2878                 PIC X(4)    VALUE '2878'.
   575     12  ER-7641                 PIC X(4)    VALUE '7641'.
   576     12  ER-7642                 PIC X(4)    VALUE '7642'.
   577     12  ER-7650                 PIC X(4)    VALUE '7650'.
   578     12  ER-7651                 PIC X(4)    VALUE '7651'.
   579     12  ER-7687                 PIC X(4)    VALUE '7687'.
   580     12  ER-7689                 PIC X(4)    VALUE '7689'.
   581     12  ER-7690                 PIC X(4)    VALUE '7690'.
   582     12  ER-7691                 PIC X(4)    VALUE '7691'.
   583     12  ER-8003                 PIC X(4)    VALUE '8003'.
   584     12  ER-8051                 PIC X(4)    VALUE '8051'.
   585     12  ER-8052                 PIC X(4)    VALUE '8052'.
   586     12  ER-8053                 PIC X(4)    VALUE '8053'.
   587     12  ER-8054                 PIC X(4)    VALUE '8054'.
   588     12  ER-8055                 PIC X(4)    VALUE '8055'.
   589     12  ER-8056                 PIC X(4)    VALUE '8056'.
   590     12  ER-8057                 PIC X(4)    VALUE '8057'.
   591     12  ER-8058                 PIC X(4)    VALUE '8058'.
   592     12  ER-8059                 PIC X(4)    VALUE '8059'.
   593     12  ER-8060                 PIC X(4)    VALUE '8060'.
   594     12  ER-8061                 PIC X(4)    VALUE '8061'.
   595     12  ER-8062                 PIC X(4)    VALUE '8062'.
   596     12  ER-8063                 PIC X(4)    VALUE '8063'.
   597     12  ER-8064                 PIC X(4)    VALUE '8064'.
   598     12  ER-8065                 PIC X(4)    VALUE '8065'.
   599     12  ER-8066                 PIC X(4)    VALUE '8066'.
   600     12  ER-8152                 PIC X(4)    VALUE '8152'.
   601     12  ER-8153                 PIC X(4)    VALUE '8153'.
   602     12  ER-8154                 PIC X(4)    VALUE '8154'.
   603     12  ER-8155                 PIC X(4)    VALUE '8155'.
   604 01  ERPDEF-KEY-SAVE             PIC X(18).
   605 01  ERPDEF-KEY.
   606     12  ERPDEF-COMPANY-CD       PIC X.
   607     12  ERPDEF-STATE            PIC XX.
   608     12  ERPDEF-PROD-CD          PIC XXX.
   609     12  F                       PIC X(7).
   610     12  ERPDEF-BEN-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  14
* EL131.cbl
   611     12  ERPDEF-BEN-CODE         PIC XX.
   612     12  ERPDEF-EXP-DT           PIC XX.
   613 01  MSTR-KEY.
   614     12  COMPANY-CODE            PIC X.
   615     12  CARRIER-CODE            PIC X.
   616     12  CLAIM-NO                PIC X(7).
   617     12  CERT-NO.
   618         16  CERT-NO-PRIME       PIC X(10).
   619         16  CERT-NO-SUFX        PIC X.
   620
   621 01  WS-SAVE-CLAIM-KEY.
   622     12  WS-SAVE-COMPANY-CD      PIC X.
   623     12  WS-SAVE-CARRIER         PIC X.
   624     12  WS-SAVE-CLAIM-NO        PIC X(7).
   625     12  WS-SAVE-CERT-NO.
   626         16  WS-CERT-NO-PRIME    PIC X(10).
   627         16  WS-CERT-NO-SUFX     PIC X.
   628
   629 01  CERT-KEY.
   630     12  CERT-COMPANY-CODE       PIC X.
   631     12  CERT-CARRIER            PIC X.
   632     12  CERT-GROUP              PIC X(6).
   633     12  CERT-STATE              PIC XX.
   634     12  CERT-ACCOUNT            PIC X(10).
   635     12  CERT-DATE               PIC XX.
   636     12  CERT-CERT.
   637         16  CERT-CERT-PRIME     PIC X(10).
   638         16  CERT-CERT-SUFX      PIC X.
   639
   640 01  ELCRTT-KEY.
   641     05  CTRLR-COMP-CD       PIC X.
   642     05  CTRLR-CARRIER       PIC X.
   643     05  CTRLR-GROUPING      PIC X(6).
   644     05  CTRLR-STATE         PIC X(2).
   645     05  CTRLR-ACCOUNT       PIC X(10).
   646     05  CTRLR-EFF-DT        PIC XX.
   647     05  CTRLR-CERT-NO       PIC X(11).
   648     05  CTRLR-REC-TYPE      PIC X.
   649 01  NOTE-KEY.
   650     12  NOTE-COMP-CD            PIC X.
   651     12  NOTE-CERT-KEY.
   652         16  NOTE-CARRIER        PIC X.
   653         16  NOTE-GROUP          PIC X(6).
   654         16  NOTE-STATE          PIC XX.
   655         16  NOTE-ACCOUNT        PIC X(10).
   656         16  NOTE-DATE           PIC XX.
   657         16  NOTE-CERT-NO        PIC X(11).
   658
   659 01  TRLR-KEY.
   660     12  TRLR-MAIN-KEY.
   661         16  TRLR-COMPANY-CD     PIC X.
   662         16  TRLR-CARRIER        PIC X.
   663         16  TRLR-CLAIM-NO       PIC X(07).
   664         16  TRLR-CERT-NO        PIC X(11).
   665     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   666
   667 01  BENEFIT-KEY.
   668     12  BEN-CO-ID               PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  15
* EL131.cbl
   669     12  BEN-REC-TYPE            PIC X.
   670     12  FILLER                  PIC XX.
   671     12  BEN-ACC-CD              PIC XX.
   672     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   673
   674 01  CNTL-KEY.
   675     12  CNTL-CO-ID              PIC X(3).
   676     12  CNTL-REC-TYPE           PIC X.
   677     12  CNTL-PROC-ID            PIC X(4).
   678     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   679         16  CNTL-STATE-NUMBER   PIC XX.
   680         16  FILLER              PIC XX.
   681     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   682         16  FILLER              PIC X(3).
   683         16  CNTL-CARRIER        PIC X.
   684     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   685
   686 01  ACTQ-KEY                    PIC X(20).
   687
   688 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   689
   690 01  CHKQ-KEY.
   691     12  CHKQ-COMPANY-CODE       PIC X.
   692     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   693     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   694
   695 01  ARCH-KEY.
   696     12  ARCH-COMPANY-CODE       PIC X.
   697     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   698     12  ARCH-RECORD-TYPE        PIC X.
   699     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   700
   701 01  ACCT-KEY.
   702     05  ACCT-PARTIAL-KEY.
   703         12  ACCT-COMPANY-CODE   PIC X.
   704         12  ACCT-CARRIER        PIC X.
   705         12  ACCT-GROUP          PIC X(6).
   706         12  ACCT-STATE          PIC XX.
   707         12  ACCT-ACCOUNT        PIC X(10).
   708     05  ACCT-DATE               PIC XX.
   709
   710 01  WS-ELBENE-KEY.
   711     12  WS-ELBENE-COMPANY-CD    PIC X.
   712     12  WS-ELBENE-RECORD-TYPE   PIC X.
   713     12  WS-ELBENE-ID            PIC X(10).
   714
   715 01  ELALPH-KEY.
   716     12  ELALPH-COMPANY-CD       PIC X.
   717     12  ELALPH-SOURCE           PIC X.
   718     12  ELALPH-NAME.
   719         16  ELALPH-LAST-NAME    PIC X(15).
   720         16  ELALPH-FIRST-NAME.
   721             20  ELALPH-FIRST-INIT   PIC X.
   722             20  FILLER              PIC X(11).
   723         16  ELALPH-MIDDLE-INIT  PIC X.
   724     12  ELALPH-DATE             PIC X(08).
   725     12  ELALPH-TIME             PIC S9(04)    COMP.
   726
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  16
* EL131.cbl
   727 01  COMP-LENGTHS.
   728     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   729     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   730     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   731     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   732     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   733     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   734     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   735     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   736     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   737     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   738     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   739     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   740     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   741     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  17
* EL131.cbl
   743*                                COPY ELCLNKLT.
   744******************************************************************
   745*                                                                *
   746*                                                                *
   747*                           ELCLNKLT                             *
   748*                            VMOD=2.003                          *
   749*                                                                *
   750*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   751*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   752*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   753*                                                                *
   754*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   755*   COMPLETING THE REQUIRED FIELDS.                              *
   756*                                                                *
   757*   THE CALLING PROGRAM SHOULD CHECK:                            *
   758*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   759*                              9999 INDICATES AN UNKNOWN ABEND   *
   760*                                   WAS DETECTED.                *
   761*                              ALL OTHER VALUES ARE NORMAL ERROR *
   762*                              CODES FOUND IN THE ERROR FILE.    *
   763******************************************************************
   764 01  W-1523-LINKDATA.
   765     12  W-1523-COMMON-PI-DATA.
   766         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   767         16  FILLER              PIC  X(67).
   768         16  W-1523-COMPANY-CD   PIC  X(01).
   769         16  FILLER              PIC  X(10).
   770         16  W-1523-CONTROL-IN-PROGRESS.
   771             20  W-1523-CARRIER  PIC  X(01).
   772             20  W-1523-GROUPING PIC  X(06).
   773             20  W-1523-STATE    PIC  X(02).
   774             20  W-1523-ACCOUNT  PIC  X(10).
   775             20  W-1523-CLAIM-CERT-GRP.
   776                 24  W-1523-CLAIM-NO
   777                                 PIC  X(07).
   778                 24  W-1523-CERT-NO.
   779                     28  W-1523-CERT-PRIME
   780                                 PIC  X(10).
   781                     28  W-1523-CERT-SFX
   782                                 PIC  X(01).
   783                 24  W-1523-CERT-EFF-DT
   784                                 PIC  X(02).
   785         16  FILLER              PIC X(265).
   786
   787     12  W-1523-WORK-AREA.
   788         16  W-1523-FORM-NUMBER  PIC  X(04).
   789         16  W-1523-NUMBER-COPIES
   790                                 PIC  9(01).
   791         16  W-1523-ADDR-TYPE    PIC  X(02).
   792         16  W-1523-FOLLOW-UP-DATE
   793                                 PIC  X(02).
   794         16  W-1523-RESEND-DATE  PIC  X(02).
   795         16  W-1523-ERROR-CODE   PIC  9(04).
   796             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   797             88  W-1523-FATAL-ERROR
   798                                    VALUES  0006 0013 0042
   799                                            0154 0168 0169
   800                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  18
* EL131.cbl
   801                                            0179 0186 0281
   802                                            0332 2055 3697
   803                                            3698 3699 3770
   804                                            3771 3772 7675
   805                                            9106 9808 9883
   806                                            9887.
   807             88  W-1523-STOP-ERRORS
   808                                    VALUES  0013 0042 0154
   809                                            0168 0169 0172
   810                                            0281 0332 2055
   811                                            3698 3699 7675
   812                                            9106 9808 9883
   813                                            9999.
   814         16  W-1523-REASON       PIC  X(70).
   815         16  W-1523-ARCHIVE-NUMBER
   816                                 PIC  9(08).
   817     12  W-1523-POINTER-AREA.
   818         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   819         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   820         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   821         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   822         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  19
* EL131.cbl
   824*                                COPY ELCINTF.
   825******************************************************************
   826*                                                                *
   827*                                                                *
   828*                            ELCINTF.                            *
   829*                            VMOD=2.017                          *
   830*                                                                *
   831*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   832*                                                                *
   833*       LENGTH = 1024                                            *
   834*                                                                *
   835******************************************************************
   836*                   C H A N G E   L O G
   837*
   838* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   839*-----------------------------------------------------------------
   840*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   841* EFFECTIVE    NUMBER
   842*-----------------------------------------------------------------
   843* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   844******************************************************************
   845 01  PROGRAM-INTERFACE-BLOCK.
   846     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   847     12  PI-CALLING-PROGRAM              PIC X(8).
   848     12  PI-SAVED-PROGRAM-1              PIC X(8).
   849     12  PI-SAVED-PROGRAM-2              PIC X(8).
   850     12  PI-SAVED-PROGRAM-3              PIC X(8).
   851     12  PI-SAVED-PROGRAM-4              PIC X(8).
   852     12  PI-SAVED-PROGRAM-5              PIC X(8).
   853     12  PI-SAVED-PROGRAM-6              PIC X(8).
   854     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   855     12  PI-COMPANY-ID                   PIC XXX.
   856     12  PI-COMPANY-CD                   PIC X.
   857
   858     12  PI-COMPANY-PASSWORD             PIC X(8).
   859
   860     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   861
   862     12  PI-CONTROL-IN-PROGRESS.
   863         16  PI-CARRIER                  PIC X.
   864         16  PI-GROUPING                 PIC X(6).
   865         16  PI-STATE                    PIC XX.
   866         16  PI-ACCOUNT                  PIC X(10).
   867         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   868                                         PIC X(10).
   869         16  PI-CLAIM-CERT-GRP.
   870             20  PI-CLAIM-NO             PIC X(7).
   871             20  PI-CERT-NO.
   872                 25  PI-CERT-PRIME       PIC X(10).
   873                 25  PI-CERT-SFX         PIC X.
   874             20  PI-CERT-EFF-DT          PIC XX.
   875         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   876             20  PI-PLAN-CODE            PIC X(2).
   877             20  PI-REVISION-NUMBER      PIC X(3).
   878             20  PI-PLAN-EFF-DT          PIC X(2).
   879             20  PI-PLAN-EXP-DT          PIC X(2).
   880             20  FILLER                  PIC X(11).
   881         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  20
* EL131.cbl
   882             20  PI-OE-REFERENCE-1.
   883                 25  PI-OE-REF-1-PRIME   PIC X(18).
   884                 25  PI-OE-REF-1-SUFF    PIC XX.
   885
   886     12  PI-SESSION-IN-PROGRESS          PIC X.
   887         88  CLAIM-SESSION                   VALUE '1'.
   888         88  CREDIT-SESSION                  VALUE '2'.
   889         88  WARRANTY-SESSION                VALUE '3'.
   890         88  MORTGAGE-SESSION                VALUE '4'.
   891         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   892
   893
   894*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   895
   896     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   897     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   898
   899     12  PI-CREDIT-USER                  PIC X.
   900         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   901         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   902
   903     12  PI-CLAIM-USER                   PIC X.
   904         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   905         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   906
   907     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   908         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   909         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   910         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   911         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   912         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   913
   914     12  PI-PROCESSOR-ID                 PIC X(4).
   915
   916     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   917
   918     12  PI-MEMBER-CAPTION               PIC X(10).
   919
   920     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   921         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   922
   923     12  PI-LIFE-OVERRIDE-L1             PIC X.
   924     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   925     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   926     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   927
   928     12  PI-AH-OVERRIDE-L1               PIC X.
   929     12  PI-AH-OVERRIDE-L2               PIC XX.
   930     12  PI-AH-OVERRIDE-L6               PIC X(6).
   931     12  PI-AH-OVERRIDE-L12              PIC X(12).
   932
   933     12  PI-NEW-SYSTEM                   PIC X(2).
   934
   935     12  PI-PRIMARY-CERT-NO              PIC X(11).
   936     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   937         88  PI-USES-PAID-TO                 VALUE '1'.
   938     12  PI-CRDTCRD-SYSTEM.
   939         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  21
* EL131.cbl
   940             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   941             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   942         16  PI-CC-MONTH-END-DT          PIC XX.
   943     12  PI-PROCESSOR-PRINTER            PIC X(4).
   944
   945     12  PI-OE-REFERENCE-2.
   946         16  PI-OE-REF-2-PRIME           PIC X(10).
   947         16  PI-OE-REF-2-SUFF            PIC X.
   948
   949     12  PI-REM-TRM-CALC-OPTION          PIC X.
   950
   951     12  PI-LANGUAGE-TYPE                PIC X.
   952             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   953             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   954             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   955
   956     12  PI-POLICY-LINKAGE-IND           PIC X.
   957         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   958         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   959                                                   LOW-VALUES.
   960
   961     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   962     12  PI-CLAIM-PW-SESSION             PIC X(1).
   963         88  PI-CLAIM-CREDIT                 VALUE '1'.
   964         88  PI-CLAIM-CONVEN                 VALUE '2'.
   965
   966     12  PI-PROCESSOR-CSR-IND            PIC X.
   967         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   968         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   969
   970     12  FILLER                          PIC X(3).
   971
   972     12  PI-SYSTEM-LEVEL                 PIC X(145).
   973
   974     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   975         PI-SYSTEM-LEVEL.
   976
   977         16  PI-ENTRY-CODES.
   978             20  PI-ENTRY-CD-1           PIC X.
   979             20  PI-ENTRY-CD-2           PIC X.
   980
   981         16  PI-RETURN-CODES.
   982             20  PI-RETURN-CD-1          PIC X.
   983             20  PI-RETURN-CD-2          PIC X.
   984
   985         16  PI-UPDATE-STATUS-SAVE.
   986             20  PI-UPDATE-BY            PIC X(4).
   987             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   988
   989         16  PI-LOWER-CASE-LETTERS       PIC X.
   990             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   991
   992*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   993*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   994*            88  CARRIER-CLM-CNTL            VALUE '2'.
   995
   996         16  PI-CERT-ACCESS-CONTROL      PIC X.
   997             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  22
* EL131.cbl
   998             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   999             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1000             88  ACCNT-CNTL                  VALUE '3'.
  1001             88  CARR-ACCNT-CNTL             VALUE '4'.
  1002
  1003         16  PI-PROCESSOR-CAP-LIST.
  1004             20  PI-SYSTEM-CONTROLS.
  1005                24 PI-SYSTEM-DISPLAY     PIC X.
  1006                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1007                24 PI-SYSTEM-MODIFY      PIC X.
  1008                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1009             20  FILLER                  PIC XX.
  1010             20  PI-DISPLAY-CAP          PIC X.
  1011                 88  DISPLAY-CAP             VALUE 'Y'.
  1012             20  PI-MODIFY-CAP           PIC X.
  1013                 88  MODIFY-CAP              VALUE 'Y'.
  1014             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1015                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1016             20  PI-FORCE-CAP            PIC X.
  1017                 88  FORCE-CAP               VALUE 'Y'.
  1018
  1019         16  PI-PROGRAM-CONTROLS.
  1020             20  PI-PGM-PRINT-OPT        PIC X.
  1021             20  PI-PGM-FORMAT-OPT       PIC X.
  1022             20  PI-PGM-PROCESS-OPT      PIC X.
  1023             20  PI-PGM-TOTALS-OPT       PIC X.
  1024
  1025         16  PI-HELP-INTERFACE.
  1026             20  PI-LAST-ERROR-NO        PIC X(4).
  1027             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1028
  1029         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1030             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1031
  1032         16  PI-CR-CONTROL-IN-PROGRESS.
  1033             20  PI-CR-CARRIER           PIC X.
  1034             20  PI-CR-GROUPING          PIC X(6).
  1035             20  PI-CR-STATE             PIC XX.
  1036             20  PI-CR-ACCOUNT           PIC X(10).
  1037             20  PI-CR-FIN-RESP          PIC X(10).
  1038             20  PI-CR-TYPE              PIC X.
  1039
  1040         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1041
  1042         16  PI-CR-MONTH-END-DT          PIC XX.
  1043
  1044         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1045             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1046             88  PI-ZERO-CARRIER             VALUE '1'.
  1047             88  PI-ZERO-GROUPING            VALUE '2'.
  1048             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1049
  1050         16  PI-CARRIER-SECURITY         PIC X.
  1051             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1052
  1053         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1054             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1055             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  23
* EL131.cbl
  1056
  1057         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1058             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1059                                         INDEXED BY PI-ACCESS-NDX
  1060                                         PIC X.
  1061
  1062         16  PI-GA-BILLING-CONTROL       PIC X.
  1063             88  PI-GA-BILLING               VALUE '1'.
  1064
  1065         16  PI-MAIL-PROCESSING          PIC X.
  1066             88  PI-MAIL-YES                 VALUE 'Y'.
  1067
  1068         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1069
  1070         16  PI-AR-SYSTEM.
  1071             20  PI-AR-PROCESSING-CNTL   PIC X.
  1072                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1073             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1074             20  PI-AR-MONTH-END-DT      PIC XX.
  1075
  1076         16  PI-MP-SYSTEM.
  1077             20  PI-MORTGAGE-USER            PIC X.
  1078                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1079                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1080             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1081                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1082                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1083                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1084                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1085                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1086             20  PI-MP-MONTH-END-DT          PIC XX.
  1087             20  PI-MP-REFERENCE-NO.
  1088                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1089                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1090
  1091         16  PI-LABEL-CONTROL            PIC X(01).
  1092             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1093             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1094
  1095         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1096             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1097
  1098         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1099             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1100             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1101
  1102         16  FILLER                      PIC X(14).
  1103
  1104     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1105******************************************************************
  1106     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1107         16  PI-NO-PMTS                    PIC 9(4).
  1108         16  PI-CERT-SWITCH                PIC X.
  1109             88  CREATED-CERT              VALUE '2'.
  1110         16  PI-PREM-TYPE                  PIC X.
  1111         16  PI-SAVE-CERT-NO.
  1112             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1113             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  24
* EL131.cbl
  1114         16  FILLER                        PIC X(46).
  1115         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1116         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1117         16  PI-REC-FOUND-SW               PIC X.
  1118         16  PI-LETTER-SW                  PIC X.
  1119         16  PI-PREV-TRLR-KEY              PIC X(22).
  1120         16  pi-claim-type                 pic x.
  1121         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1122         16  FILLER                        PIC X(544).
  1123
  1124 01  SAVE-RECORD                 PIC X(450).
  1125
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  25
* EL131.cbl
  1127*                                COPY ELCLOGOF SUPPRESS.
  1128******************************************************************
  1129*                                                                *
  1130*                                                                *
  1131*                            ELCLOGOF.                           *
  1132*                            VMOD=2.001                          *
  1133*                                                                *
  1134*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1135*                                                                *
  1136******************************************************************
  1137 01  CLASIC-LOGOFF.
  1138     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1139     12  LOGOFF-TEXT.
  1140         16  FILLER          PIC X(5)    VALUE SPACES.
  1141         16  LOGOFF-MSG.
  1142             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1143             20  FILLER      PIC X       VALUE SPACES.
  1144             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1145         16  FILLER          PIC X(80)
  1146           VALUE '* YOU ARE NOW LOGGED OFF'.
  1147         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1148         16  FILLER          PIC X       VALUE QUOTE.
  1149         16  LOGOFF-SYS-MSG  PIC X(17)
  1150           VALUE 'S CLAS-IC SYSTEM '.
  1151     12  TEXT-MESSAGES.
  1152         16  UNACCESS-MSG    PIC X(29)
  1153             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1154         16  PGMIDERR-MSG    PIC X(17)
  1155             VALUE 'PROGRAM NOT FOUND'.
  1156
  1157*                                COPY ELCATTR SUPPRESS.
  1158******************************************************************
  1159*                                                                *
  1160*                            ELCATTR.                            *
  1161*                            VMOD=2.001                          *
  1162*                                                                *
  1163*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1164*                                                                *
  1165*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1166*                                                                *
  1167*                   POS 1   P=PROTECTED                          *
  1168*                           U=UNPROTECTED                        *
  1169*                           S=ASKIP                              *
  1170*                   POS 2   A=ALPHA/NUMERIC                      *
  1171*                           N=NUMERIC                            *
  1172*                   POS 3   N=NORMAL                             *
  1173*                           B=BRIGHT                             *
  1174*                           D=DARK                               *
  1175*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1176*                           OF=MODIFIED DATA TAG OFF             *
  1177*                                                                *
  1178*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1179******************************************************************
  1180 01  ATTRIBUTE-LIST.
  1181     12  AL-PABOF            PIC X       VALUE 'Y'.
  1182     12  AL-PABON            PIC X       VALUE 'Z'.
  1183     12  AL-PADOF            PIC X       VALUE '%'.
  1184     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  26
* EL131.cbl
  1185     12  AL-PANOF            PIC X       VALUE '-'.
  1186     12  AL-PANON            PIC X       VALUE '/'.
  1187     12  AL-SABOF            PIC X       VALUE '8'.
  1188     12  AL-SABON            PIC X       VALUE '9'.
  1189     12  AL-SADOF            PIC X       VALUE '@'.
  1190     12  AL-SADON            PIC X       VALUE QUOTE.
  1191     12  AL-SANOF            PIC X       VALUE '0'.
  1192     12  AL-SANON            PIC X       VALUE '1'.
  1193     12  AL-UABOF            PIC X       VALUE 'H'.
  1194     12  AL-UABON            PIC X       VALUE 'I'.
  1195     12  AL-UADOF            PIC X       VALUE '<'.
  1196     12  AL-UADON            PIC X       VALUE '('.
  1197     12  AL-UANOF            PIC X       VALUE ' '.
  1198     12  AL-UANON            PIC X       VALUE 'A'.
  1199     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1200     12  AL-UNBON            PIC X       VALUE 'R'.
  1201     12  AL-UNDOF            PIC X       VALUE '*'.
  1202     12  AL-UNDON            PIC X       VALUE ')'.
  1203     12  AL-UNNOF            PIC X       VALUE '&'.
  1204     12  AL-UNNON            PIC X       VALUE 'J'.
  1205
  1206*                                COPY ELCAID SUPPRESS.
  1207******************************************************************
  1208*                                                                *
  1209*                            ELCAID.                             *
  1210*                            VMOD=2.001                          *
  1211*                                                                *
  1212*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1213*                                                                *
  1214*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1215*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1216******************************************************************
  1217
  1218 01  DFHAID.
  1219   02  DFHNULL   PIC  X  VALUE  ' '.
  1220   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1221   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1222   02  DFHPEN    PIC  X  VALUE  '='.
  1223   02  DFHOPID   PIC  X  VALUE  'W'.
  1224   02  DFHPA1    PIC  X  VALUE  '%'.
  1225   02  DFHPA2    PIC  X  VALUE  '>'.
  1226   02  DFHPA3    PIC  X  VALUE  ','.
  1227   02  DFHPF1    PIC  X  VALUE  '1'.
  1228   02  DFHPF2    PIC  X  VALUE  '2'.
  1229   02  DFHPF3    PIC  X  VALUE  '3'.
  1230   02  DFHPF4    PIC  X  VALUE  '4'.
  1231   02  DFHPF5    PIC  X  VALUE  '5'.
  1232   02  DFHPF6    PIC  X  VALUE  '6'.
  1233   02  DFHPF7    PIC  X  VALUE  '7'.
  1234   02  DFHPF8    PIC  X  VALUE  '8'.
  1235   02  DFHPF9    PIC  X  VALUE  '9'.
  1236   02  DFHPF10   PIC  X  VALUE  ':'.
  1237   02  DFHPF11   PIC  X  VALUE  '#'.
  1238   02  DFHPF12   PIC  X  VALUE  '@'.
  1239   02  DFHPF13   PIC  X  VALUE  'A'.
  1240   02  DFHPF14   PIC  X  VALUE  'B'.
  1241   02  DFHPF15   PIC  X  VALUE  'C'.
  1242   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  27
* EL131.cbl
  1243   02  DFHPF17   PIC  X  VALUE  'E'.
  1244   02  DFHPF18   PIC  X  VALUE  'F'.
  1245   02  DFHPF19   PIC  X  VALUE  'G'.
  1246   02  DFHPF20   PIC  X  VALUE  'H'.
  1247   02  DFHPF21   PIC  X  VALUE  'I'.
  1248*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1249   02  DFHPF22   PIC  X  VALUE  '['.
  1250   02  DFHPF23   PIC  X  VALUE  '.'.
  1251   02  DFHPF24   PIC  X  VALUE  '<'.
  1252   02  DFHMSRE   PIC  X  VALUE  'X'.
  1253   02  DFHSTRF   PIC  X  VALUE  'h'.
  1254   02  DFHTRIG   PIC  X  VALUE  '"'.
  1255 01  FILLER REDEFINES DFHAID.
  1256     12  FILLER                  PIC X(8).
  1257     12  AID-KEYS OCCURS 24 TIMES.
  1258         16  FILLER              PIC X.
  1259
  1260*                                COPY EL131S.
  1261 01  EL131AI.
  1262     05  FILLER            PIC  X(0012).
  1263*    -------------------------------
  1264     05  DATEL PIC S9(0004) COMP.
  1265     05  DATEF PIC  X(0001).
  1266     05  FILLER REDEFINES DATEF.
  1267         10  DATEA PIC  X(0001).
  1268     05  DATEI PIC  X(0008).
  1269*    -------------------------------
  1270     05  TIMEL PIC S9(0004) COMP.
  1271     05  TIMEF PIC  X(0001).
  1272     05  FILLER REDEFINES TIMEF.
  1273         10  TIMEA PIC  X(0001).
  1274     05  TIMEI PIC  X(0005).
  1275*    -------------------------------
  1276     05  SEQUL PIC S9(0004) COMP.
  1277     05  SEQUF PIC  X(0001).
  1278     05  FILLER REDEFINES SEQUF.
  1279         10  SEQUA PIC  X(0001).
  1280     05  SEQUI PIC  X(0010).
  1281*    -------------------------------
  1282     05  COMPL PIC S9(0004) COMP.
  1283     05  COMPF PIC  X(0001).
  1284     05  FILLER REDEFINES COMPF.
  1285         10  COMPA PIC  X(0001).
  1286     05  COMPI PIC  X(0003).
  1287*    -------------------------------
  1288     05  USERIDL PIC S9(0004) COMP.
  1289     05  USERIDF PIC  X(0001).
  1290     05  FILLER REDEFINES USERIDF.
  1291         10  USERIDA PIC  X(0001).
  1292     05  USERIDI PIC  X(0004).
  1293*    -------------------------------
  1294     05  CCNOL PIC S9(0004) COMP.
  1295     05  CCNOF PIC  X(0001).
  1296     05  FILLER REDEFINES CCNOF.
  1297         10  CCNOA PIC  X(0001).
  1298     05  CCNOI PIC  X(0016).
  1299*    -------------------------------
  1300     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  28
* EL131.cbl
  1301     05  MAINTF PIC  X(0001).
  1302     05  FILLER REDEFINES MAINTF.
  1303         10  MAINTA PIC  X(0001).
  1304     05  MAINTI PIC  X(0001).
  1305*    -------------------------------
  1306     05  CLAIML PIC S9(0004) COMP.
  1307     05  CLAIMF PIC  X(0001).
  1308     05  FILLER REDEFINES CLAIMF.
  1309         10  CLAIMA PIC  X(0001).
  1310     05  CLAIMI PIC  X(0007).
  1311*    -------------------------------
  1312     05  CARRL PIC S9(0004) COMP.
  1313     05  CARRF PIC  X(0001).
  1314     05  FILLER REDEFINES CARRF.
  1315         10  CARRA PIC  X(0001).
  1316     05  CARRI PIC  X(0001).
  1317*    -------------------------------
  1318     05  CERTL PIC S9(0004) COMP.
  1319     05  CERTF PIC  X(0001).
  1320     05  FILLER REDEFINES CERTF.
  1321         10  CERTA PIC  X(0001).
  1322     05  CERTI PIC  X(0010).
  1323*    -------------------------------
  1324     05  SUFXL PIC S9(0004) COMP.
  1325     05  SUFXF PIC  X(0001).
  1326     05  FILLER REDEFINES SUFXF.
  1327         10  SUFXA PIC  X(0001).
  1328     05  SUFXI PIC  X(0001).
  1329*    -------------------------------
  1330     05  TYPEL PIC S9(0004) COMP.
  1331     05  TYPEF PIC  X(0001).
  1332     05  FILLER REDEFINES TYPEF.
  1333         10  TYPEA PIC  X(0001).
  1334     05  TYPEI PIC  X(0001).
  1335*    -------------------------------
  1336     05  LABEL1L PIC S9(0004) COMP.
  1337     05  LABEL1F PIC  X(0001).
  1338     05  FILLER REDEFINES LABEL1F.
  1339         10  LABEL1A PIC  X(0001).
  1340     05  LABEL1I PIC  X(0011).
  1341*    -------------------------------
  1342     05  PCERTNOL PIC S9(0004) COMP.
  1343     05  PCERTNOF PIC  X(0001).
  1344     05  FILLER REDEFINES PCERTNOF.
  1345         10  PCERTNOA PIC  X(0001).
  1346     05  PCERTNOI PIC  X(0010).
  1347*    -------------------------------
  1348     05  PSUFXL PIC S9(0004) COMP.
  1349     05  PSUFXF PIC  X(0001).
  1350     05  FILLER REDEFINES PSUFXF.
  1351         10  PSUFXA PIC  X(0001).
  1352     05  PSUFXI PIC  X(0001).
  1353*    -------------------------------
  1354     05  STATUSL PIC S9(0004) COMP.
  1355     05  STATUSF PIC  X(0001).
  1356     05  FILLER REDEFINES STATUSF.
  1357         10  STATUSA PIC  X(0001).
  1358     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  29
* EL131.cbl
  1359*    -------------------------------
  1360     05  INCL PIC S9(0004) COMP.
  1361     05  INCF PIC  X(0001).
  1362     05  FILLER REDEFINES INCF.
  1363         10  INCA PIC  X(0001).
  1364     05  INCI PIC  X(0008).
  1365*    -------------------------------
  1366     05  REPL PIC S9(0004) COMP.
  1367     05  REPF PIC  X(0001).
  1368     05  FILLER REDEFINES REPF.
  1369         10  REPA PIC  X(0001).
  1370     05  REPI PIC  X(0008).
  1371*    -------------------------------
  1372     05  CAUSEL PIC S9(0004) COMP.
  1373     05  CAUSEF PIC  X(0001).
  1374     05  FILLER REDEFINES CAUSEF.
  1375         10  CAUSEA PIC  X(0001).
  1376     05  CAUSEI PIC  X(0006).
  1377*    -------------------------------
  1378     05  ENDL PIC S9(0004) COMP.
  1379     05  ENDF PIC  X(0001).
  1380     05  FILLER REDEFINES ENDF.
  1381         10  ENDA PIC  X(0001).
  1382     05  ENDI PIC  X(0008).
  1383*    -------------------------------
  1384     05  DIAGL PIC S9(0004) COMP.
  1385     05  DIAGF PIC  X(0001).
  1386     05  FILLER REDEFINES DIAGF.
  1387         10  DIAGA PIC  X(0001).
  1388     05  DIAGI PIC  X(0060).
  1389*    -------------------------------
  1390     05  ACCSWL PIC S9(0004) COMP.
  1391     05  ACCSWF PIC  X(0001).
  1392     05  FILLER REDEFINES ACCSWF.
  1393         10  ACCSWA PIC  X(0001).
  1394     05  ACCSWI PIC  X(0001).
  1395*    -------------------------------
  1396     05  BENEL PIC S9(0004) COMP.
  1397     05  BENEF PIC  X(0001).
  1398     05  FILLER REDEFINES BENEF.
  1399         10  BENEA PIC  X(0001).
  1400     05  BENEI PIC  X(0010).
  1401*    -------------------------------
  1402     05  BIRTHL PIC S9(0004) COMP.
  1403     05  BIRTHF PIC  X(0001).
  1404     05  FILLER REDEFINES BIRTHF.
  1405         10  BIRTHA PIC  X(0001).
  1406     05  BIRTHI PIC  X(0008).
  1407*    -------------------------------
  1408     05  SOCIALL PIC S9(0004) COMP.
  1409     05  SOCIALF PIC  X(0001).
  1410     05  FILLER REDEFINES SOCIALF.
  1411         10  SOCIALA PIC  X(0001).
  1412     05  SOCIALI PIC  X(0011).
  1413*    -------------------------------
  1414     05  SEXL PIC S9(0004) COMP.
  1415     05  SEXF PIC  X(0001).
  1416     05  FILLER REDEFINES SEXF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  30
* EL131.cbl
  1417         10  SEXA PIC  X(0001).
  1418     05  SEXI PIC  X(0001).
  1419*    -------------------------------
  1420     05  MLNAMEL PIC S9(0004) COMP.
  1421     05  MLNAMEF PIC  X(0001).
  1422     05  FILLER REDEFINES MLNAMEF.
  1423         10  MLNAMEA PIC  X(0001).
  1424     05  MLNAMEI PIC  X(0015).
  1425*    -------------------------------
  1426     05  MFNAMEL PIC S9(0004) COMP.
  1427     05  MFNAMEF PIC  X(0001).
  1428     05  FILLER REDEFINES MFNAMEF.
  1429         10  MFNAMEA PIC  X(0001).
  1430     05  MFNAMEI PIC  X(0012).
  1431*    -------------------------------
  1432     05  MMINITL PIC S9(0004) COMP.
  1433     05  MMINITF PIC  X(0001).
  1434     05  FILLER REDEFINES MMINITF.
  1435         10  MMINITA PIC  X(0001).
  1436     05  MMINITI PIC  X(0001).
  1437*    -------------------------------
  1438     05  LOANNOL PIC S9(0004) COMP.
  1439     05  LOANNOF PIC  X(0001).
  1440     05  FILLER REDEFINES LOANNOF.
  1441         10  LOANNOA PIC  X(0001).
  1442     05  LOANNOI PIC  X(0008).
  1443*    -------------------------------
  1444     05  CRTLNMEL PIC S9(0004) COMP.
  1445     05  CRTLNMEF PIC  X(0001).
  1446     05  FILLER REDEFINES CRTLNMEF.
  1447         10  CRTLNMEA PIC  X(0001).
  1448     05  CRTLNMEI PIC  X(0015).
  1449*    -------------------------------
  1450     05  CRTFNMEL PIC S9(0004) COMP.
  1451     05  CRTFNMEF PIC  X(0001).
  1452     05  FILLER REDEFINES CRTFNMEF.
  1453         10  CRTFNMEA PIC  X(0001).
  1454     05  CRTFNMEI PIC  X(0012).
  1455*    -------------------------------
  1456     05  CRTINITL PIC S9(0004) COMP.
  1457     05  CRTINITF PIC  X(0001).
  1458     05  FILLER REDEFINES CRTINITF.
  1459         10  CRTINITA PIC  X(0001).
  1460     05  CRTINITI PIC  X(0001).
  1461*    -------------------------------
  1462     05  LOANBALL PIC S9(0004) COMP.
  1463     05  LOANBALF PIC  X(0001).
  1464     05  FILLER REDEFINES LOANBALF.
  1465         10  LOANBALA PIC  X(0001).
  1466     05  LOANBALI PIC  9(7)V99.
  1467*    -------------------------------
  1468     05  PROCL PIC S9(0004) COMP.
  1469     05  PROCF PIC  X(0001).
  1470     05  FILLER REDEFINES PROCF.
  1471         10  PROCA PIC  X(0001).
  1472     05  PROCI PIC  X(0004).
  1473*    -------------------------------
  1474     05  SUPVL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  31
* EL131.cbl
  1475     05  SUPVF PIC  X(0001).
  1476     05  FILLER REDEFINES SUPVF.
  1477         10  SUPVA PIC  X(0001).
  1478     05  SUPVI PIC  X(0001).
  1479*    -------------------------------
  1480     05  PRICDL PIC S9(0004) COMP.
  1481     05  PRICDF PIC  X(0001).
  1482     05  FILLER REDEFINES PRICDF.
  1483         10  PRICDA PIC  X(0001).
  1484     05  PRICDI PIC  X(0001).
  1485*    -------------------------------
  1486     05  CRITPL PIC S9(0004) COMP.
  1487     05  CRITPF PIC  X(0001).
  1488     05  FILLER REDEFINES CRITPF.
  1489         10  CRITPA PIC  X(0001).
  1490     05  CRITPI PIC  X(0002).
  1491*    -------------------------------
  1492     05  CRITPTL PIC S9(0004) COMP.
  1493     05  CRITPTF PIC  X(0001).
  1494     05  FILLER REDEFINES CRITPTF.
  1495         10  CRITPTA PIC  X(0001).
  1496     05  CRITPTI PIC  X(0001).
  1497*    -------------------------------
  1498     05  RTWMOSL PIC S9(0004) COMP.
  1499     05  RTWMOSF PIC  X(0001).
  1500     05  FILLER REDEFINES RTWMOSF.
  1501         10  RTWMOSA PIC  X(0001).
  1502     05  RTWMOSI PIC  X(0002).
  1503*    -------------------------------
  1504     05  FILETOL PIC S9(0004) COMP.
  1505     05  FILETOF PIC  X(0001).
  1506     05  FILLER REDEFINES FILETOF.
  1507         10  FILETOA PIC  X(0001).
  1508     05  FILETOI PIC  X(0004).
  1509*    -------------------------------
  1510     05  PTHRHDGL PIC S9(0004) COMP.
  1511     05  PTHRHDGF PIC  X(0001).
  1512     05  FILLER REDEFINES PTHRHDGF.
  1513         10  PTHRHDGA PIC  X(0001).
  1514     05  PTHRHDGI PIC  X(0010).
  1515*    -------------------------------
  1516     05  PDTHRUL PIC S9(0004) COMP.
  1517     05  PDTHRUF PIC  X(0001).
  1518     05  FILLER REDEFINES PDTHRUF.
  1519         10  PDTHRUA PIC  X(0001).
  1520     05  PDTHRUI PIC  X(0008).
  1521*    -------------------------------
  1522     05  PDAMTL PIC S9(0004) COMP.
  1523     05  PDAMTF PIC  X(0001).
  1524     05  FILLER REDEFINES PDAMTF.
  1525         10  PDAMTA PIC  X(0001).
  1526     05  PDAMTI PIC  9(7)V99.
  1527*    -------------------------------
  1528     05  NODAYSL PIC S9(0004) COMP.
  1529     05  NODAYSF PIC  X(0001).
  1530     05  FILLER REDEFINES NODAYSF.
  1531         10  NODAYSA PIC  X(0001).
  1532     05  NODAYSI PIC  9(5).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  32
* EL131.cbl
  1533*    -------------------------------
  1534     05  NOPMTSL PIC S9(0004) COMP.
  1535     05  NOPMTSF PIC  X(0001).
  1536     05  FILLER REDEFINES NOPMTSF.
  1537         10  NOPMTSA PIC  X(0001).
  1538     05  NOPMTSI PIC  9(4).
  1539*    -------------------------------
  1540     05  FORMTYPL PIC S9(0004) COMP.
  1541     05  FORMTYPF PIC  X(0001).
  1542     05  FILLER REDEFINES FORMTYPF.
  1543         10  FORMTYPA PIC  X(0001).
  1544     05  FORMTYPI PIC  X(0001).
  1545*    -------------------------------
  1546     05  ESTL PIC S9(0004) COMP.
  1547     05  ESTF PIC  X(0001).
  1548     05  FILLER REDEFINES ESTF.
  1549         10  ESTA PIC  X(0001).
  1550     05  ESTI PIC  X(0008).
  1551*    -------------------------------
  1552     05  AUIDL PIC S9(0004) COMP.
  1553     05  AUIDF PIC  X(0001).
  1554     05  FILLER REDEFINES AUIDF.
  1555         10  AUIDA PIC  X(0001).
  1556     05  AUIDI PIC  X(0004).
  1557*    -------------------------------
  1558     05  OCCL PIC S9(0004) COMP.
  1559     05  OCCF PIC  X(0001).
  1560     05  FILLER REDEFINES OCCF.
  1561         10  OCCA PIC  X(0001).
  1562     05  OCCI PIC  X(0006).
  1563*    -------------------------------
  1564     05  MNTDTL PIC S9(0004) COMP.
  1565     05  MNTDTF PIC  X(0001).
  1566     05  FILLER REDEFINES MNTDTF.
  1567         10  MNTDTA PIC  X(0001).
  1568     05  MNTDTI PIC  X(0008).
  1569*    -------------------------------
  1570     05  MNTTYPEL PIC S9(0004) COMP.
  1571     05  MNTTYPEF PIC  X(0001).
  1572     05  FILLER REDEFINES MNTTYPEF.
  1573         10  MNTTYPEA PIC  X(0001).
  1574     05  MNTTYPEI PIC  X(0006).
  1575*    -------------------------------
  1576     05  CERTCARL PIC S9(0004) COMP.
  1577     05  CERTCARF PIC  X(0001).
  1578     05  FILLER REDEFINES CERTCARF.
  1579         10  CERTCARA PIC  X(0001).
  1580     05  CERTCARI PIC  X(0001).
  1581*    -------------------------------
  1582     05  CERTGRPL PIC S9(0004) COMP.
  1583     05  CERTGRPF PIC  X(0001).
  1584     05  FILLER REDEFINES CERTGRPF.
  1585         10  CERTGRPA PIC  X(0001).
  1586     05  CERTGRPI PIC  X(0006).
  1587*    -------------------------------
  1588     05  CERTSTL PIC S9(0004) COMP.
  1589     05  CERTSTF PIC  X(0001).
  1590     05  FILLER REDEFINES CERTSTF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  33
* EL131.cbl
  1591         10  CERTSTA PIC  X(0001).
  1592     05  CERTSTI PIC  X(0002).
  1593*    -------------------------------
  1594     05  CERTACTL PIC S9(0004) COMP.
  1595     05  CERTACTF PIC  X(0001).
  1596     05  FILLER REDEFINES CERTACTF.
  1597         10  CERTACTA PIC  X(0001).
  1598     05  CERTACTI PIC  X(0010).
  1599*    -------------------------------
  1600     05  CERTEFFL PIC S9(0004) COMP.
  1601     05  CERTEFFF PIC  X(0001).
  1602     05  FILLER REDEFINES CERTEFFF.
  1603         10  CERTEFFA PIC  X(0001).
  1604     05  CERTEFFI PIC  X(0008).
  1605*    -------------------------------
  1606     05  ISSAGEL PIC S9(0004) COMP.
  1607     05  ISSAGEF PIC  X(0001).
  1608     05  FILLER REDEFINES ISSAGEF.
  1609         10  ISSAGEA PIC  X(0001).
  1610     05  ISSAGEI PIC  X(0002).
  1611*    -------------------------------
  1612     05  APRL PIC S9(0004) COMP.
  1613     05  APRF PIC  X(0001).
  1614     05  FILLER REDEFINES APRF.
  1615         10  APRA PIC  X(0001).
  1616     05  APRI PIC  9(4)V9(4).
  1617*    -------------------------------
  1618     05  PMTFREQL PIC S9(0004) COMP.
  1619     05  PMTFREQF PIC  X(0001).
  1620     05  FILLER REDEFINES PMTFREQF.
  1621         10  PMTFREQA PIC  X(0001).
  1622     05  PMTFREQI PIC  99.
  1623*    -------------------------------
  1624     05  INDGRPL PIC S9(0004) COMP.
  1625     05  INDGRPF PIC  X(0001).
  1626     05  FILLER REDEFINES INDGRPF.
  1627         10  INDGRPA PIC  X(0001).
  1628     05  INDGRPI PIC  X(0001).
  1629*    -------------------------------
  1630     05  PREMTYPL PIC S9(0004) COMP.
  1631     05  PREMTYPF PIC  X(0001).
  1632     05  FILLER REDEFINES PREMTYPF.
  1633         10  PREMTYPA PIC  X(0001).
  1634     05  PREMTYPI PIC  X(0001).
  1635*    -------------------------------
  1636     05  REINCDL PIC S9(0004) COMP.
  1637     05  REINCDF PIC  X(0001).
  1638     05  FILLER REDEFINES REINCDF.
  1639         10  REINCDA PIC  X(0001).
  1640     05  REINCDI PIC  X(0001).
  1641*    -------------------------------
  1642     05  JNTLNMEL PIC S9(0004) COMP.
  1643     05  JNTLNMEF PIC  X(0001).
  1644     05  FILLER REDEFINES JNTLNMEF.
  1645         10  JNTLNMEA PIC  X(0001).
  1646     05  JNTLNMEI PIC  X(0015).
  1647*    -------------------------------
  1648     05  JNTFNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  34
* EL131.cbl
  1649     05  JNTFNMEF PIC  X(0001).
  1650     05  FILLER REDEFINES JNTFNMEF.
  1651         10  JNTFNMEA PIC  X(0001).
  1652     05  JNTFNMEI PIC  X(0012).
  1653*    -------------------------------
  1654     05  JNTINITL PIC S9(0004) COMP.
  1655     05  JNTINITF PIC  X(0001).
  1656     05  FILLER REDEFINES JNTINITF.
  1657         10  JNTINITA PIC  X(0001).
  1658     05  JNTINITI PIC  X(0001).
  1659*    -------------------------------
  1660     05  JNTAGEL PIC S9(0004) COMP.
  1661     05  JNTAGEF PIC  X(0001).
  1662     05  FILLER REDEFINES JNTAGEF.
  1663         10  JNTAGEA PIC  X(0001).
  1664     05  JNTAGEI PIC  X(0002).
  1665*    -------------------------------
  1666     05  ADDONDTL PIC S9(0004) COMP.
  1667     05  ADDONDTF PIC  X(0001).
  1668     05  FILLER REDEFINES ADDONDTF.
  1669         10  ADDONDTA PIC  X(0001).
  1670     05  ADDONDTI PIC  X(0008).
  1671*    -------------------------------
  1672     05  LCVDSCRL PIC S9(0004) COMP.
  1673     05  LCVDSCRF PIC  X(0001).
  1674     05  FILLER REDEFINES LCVDSCRF.
  1675         10  LCVDSCRA PIC  X(0001).
  1676     05  LCVDSCRI PIC  X(0006).
  1677*    -------------------------------
  1678     05  LCVKINDL PIC S9(0004) COMP.
  1679     05  LCVKINDF PIC  X(0001).
  1680     05  FILLER REDEFINES LCVKINDF.
  1681         10  LCVKINDA PIC  X(0001).
  1682     05  LCVKINDI PIC  X(0003).
  1683*    -------------------------------
  1684     05  LCVCDL PIC S9(0004) COMP.
  1685     05  LCVCDF PIC  X(0001).
  1686     05  FILLER REDEFINES LCVCDF.
  1687         10  LCVCDA PIC  X(0001).
  1688     05  LCVCDI PIC  X(0002).
  1689*    -------------------------------
  1690     05  LCVOTRML PIC S9(0004) COMP.
  1691     05  LCVOTRMF PIC  X(0001).
  1692     05  FILLER REDEFINES LCVOTRMF.
  1693         10  LCVOTRMA PIC  X(0001).
  1694     05  LCVOTRMI PIC  999.
  1695*    -------------------------------
  1696     05  LCVRTRML PIC S9(0004) COMP.
  1697     05  LCVRTRMF PIC  X(0001).
  1698     05  FILLER REDEFINES LCVRTRMF.
  1699         10  LCVRTRMA PIC  X(0001).
  1700     05  LCVRTRMI PIC  X(0003).
  1701*    -------------------------------
  1702     05  LCVRATEL PIC S9(0004) COMP.
  1703     05  LCVRATEF PIC  X(0001).
  1704     05  FILLER REDEFINES LCVRATEF.
  1705         10  LCVRATEA PIC  X(0001).
  1706     05  LCVRATEI PIC  9999V99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  35
* EL131.cbl
  1707*    -------------------------------
  1708     05  LCVBENEL PIC S9(0004) COMP.
  1709     05  LCVBENEF PIC  X(0001).
  1710     05  FILLER REDEFINES LCVBENEF.
  1711         10  LCVBENEA PIC  X(0001).
  1712     05  LCVBENEI PIC  9(9)V99.
  1713*    -------------------------------
  1714     05  LCVFORML PIC S9(0004) COMP.
  1715     05  LCVFORMF PIC  X(0001).
  1716     05  FILLER REDEFINES LCVFORMF.
  1717         10  LCVFORMA PIC  X(0001).
  1718     05  LCVFORMI PIC  X(0012).
  1719*    -------------------------------
  1720     05  LCVCNDTL PIC S9(0004) COMP.
  1721     05  LCVCNDTF PIC  X(0001).
  1722     05  FILLER REDEFINES LCVCNDTF.
  1723         10  LCVCNDTA PIC  X(0001).
  1724     05  LCVCNDTI PIC  X(0008).
  1725*    -------------------------------
  1726     05  LCVEXITL PIC S9(0004) COMP.
  1727     05  LCVEXITF PIC  X(0001).
  1728     05  FILLER REDEFINES LCVEXITF.
  1729         10  LCVEXITA PIC  X(0001).
  1730     05  LCVEXITI PIC  X(0008).
  1731*    -------------------------------
  1732     05  LCVSTATL PIC S9(0004) COMP.
  1733     05  LCVSTATF PIC  X(0001).
  1734     05  FILLER REDEFINES LCVSTATF.
  1735         10  LCVSTATA PIC  X(0001).
  1736     05  LCVSTATI PIC  X(0006).
  1737*    -------------------------------
  1738     05  ACVDSCRL PIC S9(0004) COMP.
  1739     05  ACVDSCRF PIC  X(0001).
  1740     05  FILLER REDEFINES ACVDSCRF.
  1741         10  ACVDSCRA PIC  X(0001).
  1742     05  ACVDSCRI PIC  X(0006).
  1743*    -------------------------------
  1744     05  ACVKINDL PIC S9(0004) COMP.
  1745     05  ACVKINDF PIC  X(0001).
  1746     05  FILLER REDEFINES ACVKINDF.
  1747         10  ACVKINDA PIC  X(0001).
  1748     05  ACVKINDI PIC  X(0003).
  1749*    -------------------------------
  1750     05  ACVCDL PIC S9(0004) COMP.
  1751     05  ACVCDF PIC  X(0001).
  1752     05  FILLER REDEFINES ACVCDF.
  1753         10  ACVCDA PIC  X(0001).
  1754     05  ACVCDI PIC  X(0002).
  1755*    -------------------------------
  1756     05  ACVOTRML PIC S9(0004) COMP.
  1757     05  ACVOTRMF PIC  X(0001).
  1758     05  FILLER REDEFINES ACVOTRMF.
  1759         10  ACVOTRMA PIC  X(0001).
  1760     05  ACVOTRMI PIC  999.
  1761*    -------------------------------
  1762     05  ACVRTRML PIC S9(0004) COMP.
  1763     05  ACVRTRMF PIC  X(0001).
  1764     05  FILLER REDEFINES ACVRTRMF.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  36
* EL131.cbl
  1765         10  ACVRTRMA PIC  X(0001).
  1766     05  ACVRTRMI PIC  X(0003).
  1767*    -------------------------------
  1768     05  ACVRATEL PIC S9(0004) COMP.
  1769     05  ACVRATEF PIC  X(0001).
  1770     05  FILLER REDEFINES ACVRATEF.
  1771         10  ACVRATEA PIC  X(0001).
  1772     05  ACVRATEI PIC  9999V99.
  1773*    -------------------------------
  1774     05  ACVBENEL PIC S9(0004) COMP.
  1775     05  ACVBENEF PIC  X(0001).
  1776     05  FILLER REDEFINES ACVBENEF.
  1777         10  ACVBENEA PIC  X(0001).
  1778     05  ACVBENEI PIC  9(9)V99.
  1779*    -------------------------------
  1780     05  ACVFORML PIC S9(0004) COMP.
  1781     05  ACVFORMF PIC  X(0001).
  1782     05  FILLER REDEFINES ACVFORMF.
  1783         10  ACVFORMA PIC  X(0001).
  1784     05  ACVFORMI PIC  X(0012).
  1785*    -------------------------------
  1786     05  ACVCNDTL PIC S9(0004) COMP.
  1787     05  ACVCNDTF PIC  X(0001).
  1788     05  FILLER REDEFINES ACVCNDTF.
  1789         10  ACVCNDTA PIC  X(0001).
  1790     05  ACVCNDTI PIC  X(0008).
  1791*    -------------------------------
  1792     05  ACVEXITL PIC S9(0004) COMP.
  1793     05  ACVEXITF PIC  X(0001).
  1794     05  FILLER REDEFINES ACVEXITF.
  1795         10  ACVEXITA PIC  X(0001).
  1796     05  ACVEXITI PIC  X(0008).
  1797*    -------------------------------
  1798     05  ACVSTATL PIC S9(0004) COMP.
  1799     05  ACVSTATF PIC  X(0001).
  1800     05  FILLER REDEFINES ACVSTATF.
  1801         10  ACVSTATA PIC  X(0001).
  1802     05  ACVSTATI PIC  X(0006).
  1803*    -------------------------------
  1804     05  LABEL2L PIC S9(0004) COMP.
  1805     05  LABEL2F PIC  X(0001).
  1806     05  FILLER REDEFINES LABEL2F.
  1807         10  LABEL2A PIC  X(0001).
  1808     05  LABEL2I PIC  X(0014).
  1809*    -------------------------------
  1810     05  BCERT1L PIC S9(0004) COMP.
  1811     05  BCERT1F PIC  X(0001).
  1812     05  FILLER REDEFINES BCERT1F.
  1813         10  BCERT1A PIC  X(0001).
  1814     05  BCERT1I PIC  X(0010).
  1815*    -------------------------------
  1816     05  BSUFX1L PIC S9(0004) COMP.
  1817     05  BSUFX1F PIC  X(0001).
  1818     05  FILLER REDEFINES BSUFX1F.
  1819         10  BSUFX1A PIC  X(0001).
  1820     05  BSUFX1I PIC  X(0001).
  1821*    -------------------------------
  1822     05  BCERT2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  37
* EL131.cbl
  1823     05  BCERT2F PIC  X(0001).
  1824     05  FILLER REDEFINES BCERT2F.
  1825         10  BCERT2A PIC  X(0001).
  1826     05  BCERT2I PIC  X(0010).
  1827*    -------------------------------
  1828     05  BSUFX2L PIC S9(0004) COMP.
  1829     05  BSUFX2F PIC  X(0001).
  1830     05  FILLER REDEFINES BSUFX2F.
  1831         10  BSUFX2A PIC  X(0001).
  1832     05  BSUFX2I PIC  X(0001).
  1833*    -------------------------------
  1834     05  BCERT3L PIC S9(0004) COMP.
  1835     05  BCERT3F PIC  X(0001).
  1836     05  FILLER REDEFINES BCERT3F.
  1837         10  BCERT3A PIC  X(0001).
  1838     05  BCERT3I PIC  X(0010).
  1839*    -------------------------------
  1840     05  BSUFX3L PIC S9(0004) COMP.
  1841     05  BSUFX3F PIC  X(0001).
  1842     05  FILLER REDEFINES BSUFX3F.
  1843         10  BSUFX3A PIC  X(0001).
  1844     05  BSUFX3I PIC  X(0001).
  1845*    -------------------------------
  1846     05  BCERT4L PIC S9(0004) COMP.
  1847     05  BCERT4F PIC  X(0001).
  1848     05  FILLER REDEFINES BCERT4F.
  1849         10  BCERT4A PIC  X(0001).
  1850     05  BCERT4I PIC  X(0010).
  1851*    -------------------------------
  1852     05  BSUFX4L PIC S9(0004) COMP.
  1853     05  BSUFX4F PIC  X(0001).
  1854     05  FILLER REDEFINES BSUFX4F.
  1855         10  BSUFX4A PIC  X(0001).
  1856     05  BSUFX4I PIC  X(0001).
  1857*    -------------------------------
  1858     05  BCERT5L PIC S9(0004) COMP.
  1859     05  BCERT5F PIC  X(0001).
  1860     05  FILLER REDEFINES BCERT5F.
  1861         10  BCERT5A PIC  X(0001).
  1862     05  BCERT5I PIC  X(0010).
  1863*    -------------------------------
  1864     05  BSUFX5L PIC S9(0004) COMP.
  1865     05  BSUFX5F PIC  X(0001).
  1866     05  FILLER REDEFINES BSUFX5F.
  1867         10  BSUFX5A PIC  X(0001).
  1868     05  BSUFX5I PIC  X(0001).
  1869*    -------------------------------
  1870     05  MSG1L PIC S9(0004) COMP.
  1871     05  MSG1F PIC  X(0001).
  1872     05  FILLER REDEFINES MSG1F.
  1873         10  MSG1A PIC  X(0001).
  1874     05  MSG1I PIC  X(0072).
  1875*    -------------------------------
  1876     05  MSG2L PIC S9(0004) COMP.
  1877     05  MSG2F PIC  X(0001).
  1878     05  FILLER REDEFINES MSG2F.
  1879         10  MSG2A PIC  X(0001).
  1880     05  MSG2I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  38
* EL131.cbl
  1881*    -------------------------------
  1882     05  PFKEYL PIC S9(0004) COMP.
  1883     05  PFKEYF PIC  X(0001).
  1884     05  FILLER REDEFINES PFKEYF.
  1885         10  PFKEYA PIC  X(0001).
  1886     05  PFKEYI PIC  99.
  1887*    -------------------------------
  1888     05  PFKEY6L PIC S9(0004) COMP.
  1889     05  PFKEY6F PIC  X(0001).
  1890     05  FILLER REDEFINES PFKEY6F.
  1891         10  PFKEY6A PIC  X(0001).
  1892     05  PFKEY6I PIC  X(0016).
  1893 01  EL131AO REDEFINES EL131AI.
  1894     05  FILLER            PIC  X(0012).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  DATEO PIC  X(0008).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  TIMEO PIC  99.99.
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  SEQUO PIC  X(0010).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  COMPO PIC  X(0003).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  USERIDO PIC  X(0004).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  CCNOO PIC  X(0016).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  MAINTO PIC  X(0001).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  CLAIMO PIC  X(0007).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  CARRO PIC  X(0001).
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  CERTO PIC  X(0010).
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  SUFXO PIC  X(0001).
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  TYPEO PIC  X(0001).
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  LABEL1O PIC  X(0011).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  PCERTNOO PIC  X(0010).
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  39
* EL131.cbl
  1939     05  PSUFXO PIC  X(0001).
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  STATUSO PIC  X(0006).
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  INCO PIC  X(0008).
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  REPO PIC  X(0008).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  CAUSEO PIC  X(0006).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  ENDO PIC  X(0008).
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  DIAGO PIC  X(0060).
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  ACCSWO PIC  X(0001).
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  BENEO PIC  X(0010).
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  BIRTHO PIC  X(0008).
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  SOCIALO PIC  X(0011).
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  SEXO PIC  X(0001).
  1973*    -------------------------------
  1974     05  FILLER            PIC  X(0003).
  1975     05  MLNAMEO PIC  X(0015).
  1976*    -------------------------------
  1977     05  FILLER            PIC  X(0003).
  1978     05  MFNAMEO PIC  X(0012).
  1979*    -------------------------------
  1980     05  FILLER            PIC  X(0003).
  1981     05  MMINITO PIC  X(0001).
  1982*    -------------------------------
  1983     05  FILLER            PIC  X(0003).
  1984     05  LOANNOO PIC  X(0008).
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  CRTLNMEO PIC  X(0015).
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  CRTFNMEO PIC  X(0012).
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  CRTINITO PIC  X(0001).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  LOANBALO PIC  ZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  40
* EL131.cbl
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  PROCO PIC  X(0004).
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
  2002     05  SUPVO PIC  X(0001).
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  PRICDO PIC  X(0001).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  CRITPO PIC  X(0002).
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  CRITPTO PIC  X(0001).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  RTWMOSO PIC  X(0002).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  FILETOO PIC  X(0004).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  PTHRHDGO PIC  X(0010).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  PDTHRUO PIC  X(0008).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  PDAMTO PIC  Z(06).99.
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  NODAYSO PIC  ZZZ99.
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  NOPMTSO PIC  ZZ99.
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  FORMTYPO PIC  X(0001).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  ESTO PIC  X(0008).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  AUIDO PIC  X(0004).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  OCCO PIC  X(0006).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  MNTDTO PIC  X(0008).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  MNTTYPEO PIC  X(0006).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  CERTCARO PIC  X(0001).
  2054*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  41
* EL131.cbl
  2055     05  FILLER            PIC  X(0003).
  2056     05  CERTGRPO PIC  X(0006).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  CERTSTO PIC  X(0002).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  CERTACTO PIC  X(0010).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  CERTEFFO PIC  X(0008).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  ISSAGEO PIC  X(0002).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  APRO PIC  9(3).9(4).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  PMTFREQO PIC  99.
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  INDGRPO PIC  X(0001).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  PREMTYPO PIC  X(0001).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  REINCDO PIC  X(0001).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  JNTLNMEO PIC  X(0015).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  JNTFNMEO PIC  X(0012).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  JNTINITO PIC  X(0001).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  JNTAGEO PIC  X(0002).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  ADDONDTO PIC  X(0008).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  LCVDSCRO PIC  X(0006).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  LCVKINDO PIC  X(0003).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  LCVCDO PIC  X(0002).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  LCVOTRMO PIC  999.
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  42
* EL131.cbl
  2113     05  LCVRTRMO PIC  999.
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  LCVRATEO PIC  ZZZ.ZZ.
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  LCVFORMO PIC  X(0012).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  LCVCNDTO PIC  X(0008).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  LCVEXITO PIC  X(0008).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  LCVSTATO PIC  X(0006).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  ACVDSCRO PIC  X(0006).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  ACVKINDO PIC  X(0003).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  ACVCDO PIC  X(0002).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  ACVOTRMO PIC  999.
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  ACVRTRMO PIC  999.
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  ACVRATEO PIC  ZZZ.ZZ.
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  ACVFORMO PIC  X(0012).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  ACVCNDTO PIC  X(0008).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  ACVEXITO PIC  X(0008).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  ACVSTATO PIC  X(0006).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  LABEL2O PIC  X(0014).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  BCERT1O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  43
* EL131.cbl
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  BSUFX1O PIC  X(0001).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  BCERT2O PIC  X(0010).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  BSUFX2O PIC  X(0001).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  BCERT3O PIC  X(0010).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  BSUFX3O PIC  X(0001).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  BCERT4O PIC  X(0010).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  BSUFX4O PIC  X(0001).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  BCERT5O PIC  X(0010).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  BSUFX5O PIC  X(0001).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  MSG1O PIC  X(0072).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  MSG2O PIC  X(0072).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  PFKEYO PIC  X(0002).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  PFKEY6O PIC  X(0016).
  2210*    -------------------------------
  2211
  2212*                                COPY ELCEMIB SUPPRESS.
  2213******************************************************************
  2214*                                                                *
  2215*                                                                *
  2216*                            ELCEMIB.                            *
  2217*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2218*                            VMOD=2.005                          *
  2219*                                                                *
  2220*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2221*                                                                *
  2222******************************************************************
  2223 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2224     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2225     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2226     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2227     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2228     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  44
* EL131.cbl
  2229     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2230     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2231     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2232     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2233         88  EMI-NO-ERRORS                    VALUE '1'.
  2234         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2235         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2236     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2237         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2238     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2239         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2240         88  EMI-AREA1-FULL                   VALUE '2'.
  2241     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2242         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2243         88  EMI-AREA2-FULL                   VALUE '2'.
  2244     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2245         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2246         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2247         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2248         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2249         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2250     12  EMI-ERROR-LINES.
  2251         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2252         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2253         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2254         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2255             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2256                 24  EMI-ERR-NUM         PIC X(4).
  2257                 24  EMI-FILLER          PIC X.
  2258                 24  EMI-SEV             PIC X.
  2259                 24  FILLER              PIC X.
  2260             20  FILLER                  PIC X(02).
  2261     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2262         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2263             20  EMI-ERROR-NUMBER    PIC X(4).
  2264             20  EMI-FILL            PIC X.
  2265             20  EMI-SEVERITY        PIC X.
  2266             20  FILLER              PIC X.
  2267             20  EMI-ERROR-TEXT.
  2268                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2269                 24  FILLER          PIC X(55).
  2270     12  EMI-SEVERITY-SAVE           PIC X.
  2271         88  EMI-NOTE                    VALUE 'N'.
  2272         88  EMI-WARNING                 VALUE 'W'.
  2273         88  EMI-FORCABLE                VALUE 'F'.
  2274         88  EMI-FATAL                   VALUE 'X'.
  2275     12  EMI-MESSAGE-FLAG            PIC X.
  2276         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2277         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2278     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2279     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2280         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2281         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2282         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2283     12  emi-claim-no                pic x(7).
  2284     12  emi-claim-type              pic x(6).
  2285     12  FILLER                      PIC X(124)  VALUE SPACES.
  2286     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  45
* EL131.cbl
  2287     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2288     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2289     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2290
  2291*                                COPY ELCJPFX SUPPRESS.
  2292******************************************************************
  2293*                                                                *
  2294*                                                                *
  2295*                            ELCJPFX.                            *
  2296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2297*                            VMOD=2.002                          *
  2298*                                                                *
  2299*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2300*                                                                *
  2301*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2302*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2303*        ELCNTL - CONTROL FILE                                   *
  2304*        ELMSTR - CLAIM MASTERS                                  *
  2305*        ELTRLR - ACTIVITY TRAILERS                              *
  2306*        ELCHKQ - CHECK QUE                                      *
  2307******************************************************************
  2308 01  JOURNAL-RECORD.
  2309     12  JP-USER-ID                  PIC X(4).
  2310     12  JP-FILE-ID                  PIC X(8).
  2311     12  JP-PROGRAM-ID               PIC X(8).
  2312     12  JP-RECORD-TYPE              PIC X.
  2313         88 JP-ADD              VALUE 'A'.
  2314         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2315         88 JP-AFTER-CHANGE     VALUE 'C'.
  2316         88 JP-DELETE           VALUE 'D'.
  2317         88 JP-GENERIC-DELETE   VALUE 'G'.
  2318         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2319         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2320     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2321     12  JP-RECORD-AREA
  2322
  2323
  2324                                 PIC X(750).
  2325
  2326*                                COPY ELCCALC.
  2327******************************************************************
  2328*                                                                *
  2329*                           ELCCALC.                            *
  2330*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2331*                            VMOD=2.025                          *
  2332*                                                                *
  2333*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2334*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2335*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2336*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2337*                                                                *
  2338*  PASSED TO ELRTRM                                              *
  2339*  -----------------                                             *
  2340*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2341*  ORIGINAL TERM                                                 *
  2342*  BEGINNING DATE                                                *
  2343*  ENDING DATE                                                   *
  2344*  COMPANY I.D.                                                  *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  46
* EL131.cbl
  2345*  ACCOUNT MASTER USER FIELD                                     *
  2346*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2347*  FREE LOOK DAYS                                                *
  2348*                                                                *
  2349*  RETURNED FROM ELRTRM                                          *
  2350*  ---------------------                                         *
  2351*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2352*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2353*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2354*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2355*----------------------------------------------------------------*
  2356*  PASSED TO ELRAMT                                              *
  2357*  ----------------                                              *
  2358*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2359*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2360*  ORIGINAL AMOUNT                                               *
  2361*  ALTERNATE BENEFIT (BALLON)                                    *
  2362*  A.P.R. - NET PAY ONLY                                         *
  2363*  METHOD
  2364*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2365*  COMPANY I.D.                                                  *
  2366*  BENEFIT TYPE                                                  *
  2367*                                                                *
  2368*  RETURNED FROM ELRAMT                                          *
  2369*  --------------------                                          *
  2370*  REMAINING AMOUNT 1 - CURRENT                                  *
  2371*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2372*  REMAINING AMOUNT FACTOR
  2373*----------------------------------------------------------------*
  2374*  PASSED TO ELRESV                                              *
  2375*  -----------------                                             *
  2376*  CERTIFICATE EFFECTIVE DATE                                    *
  2377*  VALUATION DATE                                                *
  2378*  PAID THRU DATE                                                *
  2379*  BENEFIT                                                       *
  2380*  INCURRED DATE                                                 *
  2381*  REPORTED DATE                                                 *
  2382*  ISSUE AGE                                                     *
  2383*  TERM                                                          *
  2384*  CDT PERCENT                                                   *
  2385*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2386* *CLAIM TYPE (LIFE, A/H)                                        *
  2387* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2388* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2389*                                                                *
  2390*  RETURNED FROM ELRESV                                          *
  2391*  --------------------                                          *
  2392*  CDT TABLE USED                                                *
  2393*  CDT FACTOR USED                                               *
  2394*  PAY TO CURRENT RESERVE                                        *
  2395*  I.B.N.R. - A/H ONLY                                           *
  2396*  FUTURE (ACCRUED) AH ONLY                                      *
  2397*----------------------------------------------------------------*
  2398*  PASSED TO ELRATE                                              *
  2399*  ----------------                                              *
  2400*  CERT ISSUE DATE                                               *
  2401*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2402*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  47
* EL131.cbl
  2403*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2404*  STATE CODE (CLIENT DEFINED)                                   *
  2405*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2406*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2407*  DEVIATION CODE                                                *
  2408*  ISSUE AGE                                                     *
  2409*  ORIGINAL BENEFIT AMOUNT                                       *
  2410*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2411*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2412*  BENEFIT KIND (LIFE OR A/H)                                    *
  2413*  A.P.R.                                                        *
  2414*  METHOD
  2415*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2416*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2417*  COMPANY I.D. (3 CHARACTER)                                    *
  2418*  BENEFIT CODE                                                  *
  2419*  BENEFIT OVERRIDE CODE                                         *
  2420*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2421*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2422*  JOINT INDICATOR (CSL ONLY)                                    *
  2423*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2424*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2425*                                                                *
  2426*  RETURNED FROM ELRATE                                          *
  2427*  --------------------                                          *
  2428*  CALCULATED PREMIUM                                            *
  2429*  PREMIUM RATE                                                  *
  2430*  MORTALITY CODE                                                *
  2431*  MAX ATTAINED AGE                                              *
  2432*  MAX AGE                                                       *
  2433*  MAX TERM                                                      *
  2434*  MAX MONTHLY BENEFIT                                           *
  2435*  MAX TOTAL BENIFIT                                             *
  2436*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2437*----------------------------------------------------------------*
  2438*  PASSED TO ELRFND                                              *
  2439*  ----------------                                              *
  2440*  CERT ISSUE DATE                                               *
  2441*  REFUND DATE                                                   *
  2442*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2443*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2444*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2445*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2446*  STATE CODE (CLIENT DEFINED)                                   *
  2447*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2448*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2449*  DEVIATION CODE                                                *
  2450*  ISSUE AGE                                                     *
  2451*  ORIGINAL BENEFIT AMOUNT                                       *
  2452*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2453*  PROCESS TYPE (CANCEL)                                         *
  2454*  BENEFIT KIND (LIFE OR A/H)                                    *
  2455*  A.P.R.                                                        *
  2456*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2457*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2458*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2459*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2460*  COMPANY I.D. (3 CHARACTER)                                    *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  48
* EL131.cbl
  2461*  BENEFIT CODE                                                  *
  2462*  BENEFIT OVERRIDE CODE                                         *
  2463*                                                                *
  2464*  RETURNED FROM ELRFND                                          *
  2465*  --------------------                                          *
  2466*  CALCULATED REFUND                                             *
  2467*----------------------------------------------------------------*
  2468*  PASSED TO ELEARN                                              *
  2469*  ----------------                                              *
  2470*  CERT ISSUE DATE                                               *
  2471*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2472*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2473*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2474*  STATE CODE (CLIENT DEFINED)                                   *
  2475*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2476*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2477*  DEVIATION CODE                                                *
  2478*  ISSUE AGE                                                     *
  2479*  ORIGINAL BENEFIT AMOUNT                                       *
  2480*  BENEFIT KIND (LIFE OR A/H)                                    *
  2481*  A.P.R.                                                        *
  2482*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2483*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2484*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2485*  COMPANY I.D. (3 CHARACTER)                                    *
  2486*  BENEFIT CODE                                                  *
  2487*  BENEFIT OVERRIDE CODE                                         *
  2488*                                                                *
  2489*  RETURNED FROM ELEARN                                          *
  2490*  --------------------                                          *
  2491*  INDICATED  EARNINGS                                           *
  2492*----------------------------------------------------------------*
  2493*                 LENGTH = 450                                   *
  2494*                                                                *
  2495******************************************************************
  2496******************************************************************
  2497*                   C H A N G E   L O G
  2498*
  2499* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2500*-----------------------------------------------------------------
  2501*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2502* EFFECTIVE    NUMBER
  2503*-----------------------------------------------------------------
  2504* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2505* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2506* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2507* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2508* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2509* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2510* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2511* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2512* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2513******************************************************************
  2514
  2515 01  CALCULATION-PASS-AREA.
  2516     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2517                                     COMP.
  2518
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  49
* EL131.cbl
  2519     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2520       88  NO-CP-ERROR                             VALUE ZERO.
  2521       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2522                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2523       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2524       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2525       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2526       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2527       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2528       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2529       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2530       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2531       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2532       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2533       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2534       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2535       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2536       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2537       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2538       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2539       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2540
  2541     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2542       88  NO-CP-ERROR-2                           VALUE ZERO.
  2543***********************  INPUT AREAS ****************************
  2544
  2545     12  CP-CALCULATION-AREA.
  2546         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2547         16  CP-CERT-EFF-DT        PIC XX.
  2548         16  CP-VALUATION-DT       PIC XX.
  2549         16  CP-PAID-THRU-DT       PIC XX.
  2550         16  CP-BENEFIT-TYPE       PIC X.
  2551           88  CP-AH                               VALUE 'A' 'D'
  2552                                                   'I' 'U'.
  2553           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2554           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2555         16  CP-INCURRED-DT        PIC XX.
  2556         16  CP-REPORTED-DT        PIC XX.
  2557         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2558         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2559         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2560                                     COMP-3.
  2561         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2562                                     COMP-3.
  2563         16  CP-CDT-METHOD         PIC X.
  2564           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2565           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2566           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2567         16  CP-CLAIM-TYPE         PIC X.
  2568           88  CP-AH-CLAIM                         VALUE 'A'.
  2569           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2570         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2571                                     COMP-3.
  2572         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2573                                     COMP-3.
  2574         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2575                                     COMP-3.
  2576         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  50
* EL131.cbl
  2577                                     COMP-3.
  2578         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2579                                     COMP-3.
  2580         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2581                                     COMP-3.
  2582         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2583                                     COMP-3.
  2584         16  CP-REM-TERM-METHOD    PIC X.
  2585           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2586           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2587           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2588           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2589           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2590           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2591           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2592         16  CP-EARNING-METHOD     PIC X.
  2593           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2594           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2595           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2596           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2597           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2598           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2599           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2600           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2601           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2602           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2603           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2604           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2605           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2606           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2607         16  CP-PROCESS-TYPE       PIC X.
  2608           88  CP-CLAIM                            VALUE '1'.
  2609           88  CP-CANCEL                           VALUE '2'.
  2610           88  CP-ISSUE                            VALUE '3'.
  2611         16  CP-SPECIAL-CALC-CD    PIC X.
  2612           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2613           88  CP-1-MTH-INTEREST               VALUE ' '.
  2614           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2615           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2616           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2617           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2618           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2619           88  CP-FARM-PLAN                    VALUE 'F'.
  2620           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2621           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2622           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2623           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2624           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2625           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2626           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2627           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2628           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2629           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2630                                                     'W' 'X'.
  2631           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2632           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2633           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2634           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  51
* EL131.cbl
  2635           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2636           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2637           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2638           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2639           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2640           88  CP-CSL-METH-1                   VALUE '5'.
  2641           88  CP-CSL-METH-2                   VALUE '6'.
  2642           88  CP-CSL-METH-3                   VALUE '7'.
  2643           88  CP-CSL-METH-4                   VALUE '8'.
  2644
  2645         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2646                                     COMP-3.
  2647         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2648         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2649         16  CP-STATE              PIC XX          VALUE SPACE.
  2650         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2651         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2652           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2653               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2654         16  CP-R78-OPTION         PIC X.
  2655           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2656           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2657
  2658         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2659         16  CP-IBNR-RESERVE-SW    PIC X.
  2660         16  CP-CLAIM-STATUS       PIC X.
  2661         16  CP-RATE-FILE          PIC X.
  2662         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2663                                     COMP-3.
  2664
  2665         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2666         16  CP-AH-OVERRIDE-CODE   PIC X.
  2667
  2668         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2669                                     COMP-3.
  2670         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2671                                   PIC S9(5)V99 COMP-3.
  2672         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2673                                     COMP-3.
  2674         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2675                                     COMP-3.
  2676         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2677                                     COMP-3.
  2678         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2679                                  PIC S9(7)V99 COMP-3.
  2680
  2681         16  CP-PAID-FROM-DATE     PIC X(02).
  2682         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2683         16  CP-EXT-DAYS-CALC      PIC X.
  2684           88  CP-EXT-NO-CHG                   VALUE ' '.
  2685           88  CP-EXT-CHG-LF                   VALUE '1'.
  2686           88  CP-EXT-CHG-AH                   VALUE '2'.
  2687           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2688         16  CP-DOMICILE-STATE     PIC XX.
  2689         16  CP-CARRIER            PIC X.
  2690         16  CP-REIN-FLAG          PIC X.
  2691         16  CP-REM-TRM-CALC-OPTION PIC X.
  2692           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  52
* EL131.cbl
  2693                      '2' '3' '4' '5'.
  2694           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2695           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2696           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2697           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2698           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2699           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2700           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2701           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2702         16  CP-SIG-SWITCH         PIC X.
  2703         16  CP-RATING-METHOD      PIC X.
  2704           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2705           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2706           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2707           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2708           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2709           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2710           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2711           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2712           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2713         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2714                                     COMP-3.
  2715         16  CP-BEN-CATEGORY       PIC X.
  2716         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2717         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2718                                   PIC S99V9(5) COMP-3.
  2719         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2720         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2721                                   PIC S99V9(5) COMP-3.
  2722         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2723         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2724         16  CP-EXPIRE-DT          PIC XX.
  2725         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2726         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2727         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2728         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2729         16  CP-DDF-SPEC-CALC      PIC X.
  2730             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2731             88  CP-CALC-CLP              VALUE 'C'.
  2732         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2733         16  CP-CANCEL-REASON      PIC X.
  2734         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2735         16  CP-PMT-MODE           PIC X.
  2736         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2737         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2738         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2739         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2740         16  FILLER                PIC X.
  2741
  2742***************    OUTPUT FROM ELRESV   ************************
  2743
  2744         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2745
  2746         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2747                                     COMP-3.
  2748         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2749                                     COMP-3.
  2750         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  53
* EL131.cbl
  2751                                     COMP-3.
  2752         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2753                                     COMP-3.
  2754         16  FILLER                PIC X(09).
  2755***************    OUTPUT FROM ELRTRM   *************************
  2756
  2757         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2758                                     COMP-3.
  2759         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2760                                     COMP-3.
  2761         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2762                                     COMP-3.
  2763         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2764                                     COMP-3.
  2765         16  FILLER                PIC X(12).
  2766
  2767***************    OUTPUT FROM ELRAMT   *************************
  2768
  2769         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2770                                     COMP-3.
  2771         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2772                                     COMP-3.
  2773         16  FILLER                PIC X(12).
  2774
  2775***************    OUTPUT FROM ELRATE   *************************
  2776
  2777         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2778                                     COMP-3.
  2779         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2780                                     COMP-3.
  2781         16  CP-MORTALITY-CODE     PIC X(4).
  2782         16  CP-RATE-EDIT-FLAG     PIC X.
  2783             88  CP-RATES-NEED-APR                  VALUE '1'.
  2784         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2785                                     COMP-3.
  2786         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2787         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2788         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2789                                   PIC S9(7)V99 COMP-3.
  2790         16  FILLER                PIC X(07).
  2791
  2792***************    OUTPUT FROM ELRFND   *************************
  2793
  2794         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2795                                     COMP-3.
  2796         16  CP-REFUND-TYPE-USED   PIC X.
  2797           88  CP-R-AS-R78                         VALUE '1'.
  2798           88  CP-R-AS-PRORATA                     VALUE '2'.
  2799           88  CP-R-AS-CALIF                       VALUE '3'.
  2800           88  CP-R-AS-TEXAS                       VALUE '4'.
  2801           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2802           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2803           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2804           88  CP-R-AS-MEAN                        VALUE '8'.
  2805           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2806           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2807           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2808           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  54
* EL131.cbl
  2809           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2810           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2811         16  FILLER                PIC X(12).
  2812
  2813***************    OUTPUT FROM ELEARN   *************************
  2814
  2815         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2816                                     COMP-3.
  2817         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2818                                     COMP-3.
  2819         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2820                                     COMP-3.
  2821         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2822                                     COMP-3.
  2823         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2824                                     COMP-3.
  2825         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2826                                     COMP-3.
  2827         16  CP-EARNING-TYPE-USED  PIC X.
  2828           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2829           88  CP-E-AS-R78                         VALUE '1'.
  2830           88  CP-E-AS-PRORATA                     VALUE '2'.
  2831           88  CP-E-AS-TEXAS                       VALUE '4'.
  2832           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2833           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2834           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2835           88  CP-E-AS-MEAN                        VALUE '8'.
  2836           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2837         16  FILLER                PIC X(12).
  2838
  2839***************    OUTPUT FROM ELPMNT   *************************
  2840
  2841         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2842                                     COMP-3.
  2843         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2844                                     COMP-3.
  2845         16  FILLER                PIC X(12).
  2846
  2847***************   MISC WORK AREAS    *****************************
  2848         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2849                                     COMP-3.
  2850         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2851                                     COMP-3.
  2852         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2853                                     COMP-3.
  2854         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2855                                     COMP-3.
  2856         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2857                                     COMP-3.
  2858         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2859                                     COMP-3.
  2860         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2861             88  OPEN-RATE-FILE                   VALUE 'O'.
  2862             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2863             88  IO-ERROR                         VALUE 'E'.
  2864
  2865         16  CP-FIRST-PAY-DATE     PIC XX.
  2866
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  55
* EL131.cbl
  2867         16  CP-JOINT-INDICATOR    PIC X.
  2868
  2869         16  CP-RESERVE-REMAINING-TERM
  2870                                   PIC S9(4)V9    VALUE ZERO
  2871                                     COMP-3.
  2872
  2873         16  CP-INSURED-BIRTH-DT   PIC XX.
  2874
  2875         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2876                                     COMP-3.
  2877
  2878         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2879                                     COMP-3.
  2880
  2881         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2882                                     COMP-3.
  2883
  2884         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2885                                     COMP-3.
  2886
  2887         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2888                                     COMP-3.
  2889
  2890         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2891                                     COMP-3.
  2892
  2893         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2894                                     COMP-3.
  2895
  2896         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2897             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2898
  2899         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2900                                     COMP-3.
  2901         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2902                                     COMP-3.
  2903         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2904         16  FILLER                PIC X(15).
  2905******************************************************************
  2906
  2907*                                COPY ELCDATE.
  2908******************************************************************
  2909*                                                                *
  2910*                                                                *
  2911*                            ELCDATE.                            *
  2912*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2913*                            VMOD=2.003
  2914*                                                                *
  2915*                                                                *
  2916*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2917*                 LENGTH = 200                                   *
  2918******************************************************************
  2919
  2920 01  DATE-CONVERSION-DATA.
  2921     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2922     12  DC-OPTION-CODE                PIC X.
  2923         88  BIN-TO-GREG                VALUE ' '.
  2924         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  56
* EL131.cbl
  2925         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2926         88  YMD-GREG-TO-BIN            VALUE '3'.
  2927         88  MDY-GREG-TO-BIN            VALUE '4'.
  2928         88  JULIAN-TO-BIN              VALUE '5'.
  2929         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2930         88  FIND-CENTURY               VALUE '7'.
  2931         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2932         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2933         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2934         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2935         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2936         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2937         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2938         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2939         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2940         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2941         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2942         88  BIN-3-TO-GREG              VALUE 'I'.
  2943         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2944         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2945         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2946         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2947         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2948         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2949         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2950         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2951         88  THREE-CHARACTER-BIN
  2952                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2953         88  GREGORIAN-TO-BIN
  2954                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2955         88  BIN-TO-GREGORIAN
  2956                  VALUES ' ' '1' 'I' '8' 'G'.
  2957         88  JULIAN-TO-BINARY
  2958                  VALUES '5' 'C' 'E' 'F'.
  2959     12  DC-ERROR-CODE                 PIC X.
  2960         88  NO-CONVERSION-ERROR        VALUE ' '.
  2961         88  DATE-CONVERSION-ERROR
  2962                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2963         88  DATE-IS-ZERO               VALUE '1'.
  2964         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2965         88  DATE-IS-INVALID            VALUE '3'.
  2966         88  DATE1-GREATER-DATE2        VALUE '4'.
  2967         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2968         88  DATE-INVALID-OPTION        VALUE '9'.
  2969         88  INVALID-CENTURY            VALUE 'A'.
  2970         88  ONLY-CENTURY               VALUE 'B'.
  2971         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2972         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2973     12  DC-END-OF-MONTH               PIC X.
  2974         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2975     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2976         88  USE-NORMAL-PROCESS         VALUE ' '.
  2977         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2978         88  ADJUST-UP-100-YRS          VALUE '2'.
  2979     12  FILLER                        PIC X.
  2980     12  DC-CONVERSION-DATES.
  2981         16  DC-BIN-DATE-1             PIC XX.
  2982         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  57
* EL131.cbl
  2983         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2984         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2985                       DC-GREG-DATE-1-EDIT.
  2986             20  DC-EDIT1-MONTH        PIC 99.
  2987             20  SLASH1-1              PIC X.
  2988             20  DC-EDIT1-DAY          PIC 99.
  2989             20  SLASH1-2              PIC X.
  2990             20  DC-EDIT1-YEAR         PIC 99.
  2991         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2992         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2993                     DC-GREG-DATE-2-EDIT.
  2994             20  DC-EDIT2-MONTH        PIC 99.
  2995             20  SLASH2-1              PIC X.
  2996             20  DC-EDIT2-DAY          PIC 99.
  2997             20  SLASH2-2              PIC X.
  2998             20  DC-EDIT2-YEAR         PIC 99.
  2999         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3000         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3001                     DC-GREG-DATE-1-YMD.
  3002             20  DC-YMD-YEAR           PIC 99.
  3003             20  DC-YMD-MONTH          PIC 99.
  3004             20  DC-YMD-DAY            PIC 99.
  3005         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3006         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3007                      DC-GREG-DATE-1-MDY.
  3008             20  DC-MDY-MONTH          PIC 99.
  3009             20  DC-MDY-DAY            PIC 99.
  3010             20  DC-MDY-YEAR           PIC 99.
  3011         16  DC-GREG-DATE-1-ALPHA.
  3012             20  DC-ALPHA-MONTH        PIC X(10).
  3013             20  DC-ALPHA-DAY          PIC 99.
  3014             20  FILLER                PIC XX.
  3015             20  DC-ALPHA-CENTURY.
  3016                 24 DC-ALPHA-CEN-N     PIC 99.
  3017             20  DC-ALPHA-YEAR         PIC 99.
  3018         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3019         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3020         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3021         16  DC-JULIAN-DATE            PIC 9(05).
  3022         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3023                                       PIC 9(05).
  3024         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3025             20  DC-JULIAN-YEAR        PIC 99.
  3026             20  DC-JULIAN-DAYS        PIC 999.
  3027         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3028         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3029         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3030     12  DATE-CONVERSION-VARIBLES.
  3031         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3032         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3033             20  FILLER                PIC 9(3).
  3034             20  HOLD-CEN-1-CCYY.
  3035                 24  HOLD-CEN-1-CC     PIC 99.
  3036                 24  HOLD-CEN-1-YY     PIC 99.
  3037             20  HOLD-CEN-1-MO         PIC 99.
  3038             20  HOLD-CEN-1-DA         PIC 99.
  3039         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3040             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  58
* EL131.cbl
  3041             20  HOLD-CEN-1-R-DA       PIC 99.
  3042             20  HOLD-CEN-1-R-CCYY.
  3043                 24  HOLD-CEN-1-R-CC   PIC 99.
  3044                 24  HOLD-CEN-1-R-YY   PIC 99.
  3045             20  FILLER                PIC 9(3).
  3046         16  HOLD-CENTURY-1-X.
  3047             20  FILLER                PIC X(3)  VALUE SPACES.
  3048             20  HOLD-CEN-1-X-CCYY.
  3049                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3050                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3051             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3052             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3053         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3054             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3055             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3056             20  HOLD-CEN-1-R-X-CCYY.
  3057                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3058                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3059             20  FILLER                PIC XXX.
  3060         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3061         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3062         16  DC-JULIAN-DATE-1          PIC 9(07).
  3063         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3064             20  DC-JULIAN-1-CCYY.
  3065                 24  DC-JULIAN-1-CC    PIC 99.
  3066                 24  DC-JULIAN-1-YR    PIC 99.
  3067             20  DC-JULIAN-DA-1        PIC 999.
  3068         16  DC-JULIAN-DATE-2          PIC 9(07).
  3069         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3070             20  DC-JULIAN-2-CCYY.
  3071                 24  DC-JULIAN-2-CC    PIC 99.
  3072                 24  DC-JULIAN-2-YR    PIC 99.
  3073             20  DC-JULIAN-DA-2        PIC 999.
  3074         16  DC-GREG-DATE-A-EDIT.
  3075             20  DC-EDITA-MONTH        PIC 99.
  3076             20  SLASHA-1              PIC X VALUE '/'.
  3077             20  DC-EDITA-DAY          PIC 99.
  3078             20  SLASHA-2              PIC X VALUE '/'.
  3079             20  DC-EDITA-CCYY.
  3080                 24  DC-EDITA-CENT     PIC 99.
  3081                 24  DC-EDITA-YEAR     PIC 99.
  3082         16  DC-GREG-DATE-B-EDIT.
  3083             20  DC-EDITB-MONTH        PIC 99.
  3084             20  SLASHB-1              PIC X VALUE '/'.
  3085             20  DC-EDITB-DAY          PIC 99.
  3086             20  SLASHB-2              PIC X VALUE '/'.
  3087             20  DC-EDITB-CCYY.
  3088                 24  DC-EDITB-CENT     PIC 99.
  3089                 24  DC-EDITB-YEAR     PIC 99.
  3090         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3091         16  DC-GREG-DATE-CYMD-R REDEFINES
  3092                              DC-GREG-DATE-CYMD.
  3093             20  DC-CYMD-CEN           PIC 99.
  3094             20  DC-CYMD-YEAR          PIC 99.
  3095             20  DC-CYMD-MONTH         PIC 99.
  3096             20  DC-CYMD-DAY           PIC 99.
  3097         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3098         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  59
* EL131.cbl
  3099                              DC-GREG-DATE-MDCY.
  3100             20  DC-MDCY-MONTH         PIC 99.
  3101             20  DC-MDCY-DAY           PIC 99.
  3102             20  DC-MDCY-CEN           PIC 99.
  3103             20  DC-MDCY-YEAR          PIC 99.
  3104    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3105        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3106    12  DC-EL310-DATE                  PIC X(21).
  3107    12  FILLER                         PIC X(28).
  3108
  3109*                                COPY ELCDMO.
  3110******************************************************************
  3111*                                                                *
  3112*                                                                *
  3113*                            ELCDMO.                             *
  3114*                            VMOD=2.004                          *
  3115*                                                                *
  3116*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3117*        COMMUNICATION AREA                                      *
  3118*   FILE TYPE = NA                                               *
  3119*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3120*                                                                *
  3121******************************************************************
  3122 01  DMO-COMMUNICATION-AREA.
  3123     12  DM-RECORD-TYPE                  PIC  X(02).
  3124             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3125             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3126             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3127     12  DM-DIST-CODE                    PIC  X(04).
  3128     12  DM-MAIL-CODE                    PIC  X(05).
  3129     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3130     12  DM-INSURED-NAME                 PIC  X(30).
  3131     12  DM-CLAIM-NO                     PIC  X(07).
  3132     12  DM-CLAIM-TYPE                   PIC  X.
  3133
  3134     12  DM-STATUS-DATA-AREA.
  3135         16  DM-CLAIM-STATUS             PIC  X.
  3136             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3137             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3138             88  DM-CLOSED                        VALUE '3'.
  3139             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3140             88  DM-DEFAULT                       VALUE '9'.
  3141         16  DM-STATUS-DATE              PIC  X(08).
  3142******YYYYMMDD
  3143         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3144             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3145             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3146             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3147             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3148             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3149             88  DM-RE-OPENED                     VALUE 'R'.
  3150             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3151             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3152             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3153         16  DM-STAT-CARRIER             PIC X.
  3154
  3155     12  DM-DRAFT-DATA-AREA.
  3156         16  DM-PAYMENT-TYPE             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  60
* EL131.cbl
  3157             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3158         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3159         16  DM-PAYMENT-DATE             PIC  X(08).
  3160******YYYYMMDD
  3161         16  DM-CERT-NO                  PIC  X(11).
  3162         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3163         16  DM-CARRIER                  PIC  X.
  3164
  3165     12  DM-RETURN-CODE                  PIC  XX.
  3166*                                COPY ERCPDEF.
  3167******************************************************************
  3168*                                                                *
  3169*                                                                *
  3170*                            ERCPDEF.                            *
  3171*                                                                *
  3172*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3173*                                                                *
  3174*    FILE TYPE = VSAM,KSDS                                       *
  3175*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3176*                                                                *
  3177*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3178*                                                                *
  3179*    LOG = YES                                                   *
  3180*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3181******************************************************************
  3182 01  PRODUCT-MASTER.
  3183    12  PD-RECORD-ID                 PIC X(02).
  3184        88  VALID-PD-ID                  VALUE 'PD'.
  3185    12  PD-CONTROL-PRIMARY.
  3186        16  PD-COMPANY-CD            PIC X.
  3187        16  PD-STATE                 PIC XX.
  3188        16  PD-PRODUCT-CD            PIC XXX.
  3189        16  PD-FILLER                PIC X(7).
  3190        16  PD-BEN-TYPE              PIC X.
  3191        16  PD-BEN-CODE              PIC XX.
  3192        16  PD-PROD-EXP-DT           PIC XX.
  3193    12  FILLER                       PIC X(50).
  3194    12  PD-PRODUCT-DATA OCCURS 8.
  3195        16  PD-PROD-CODE             PIC X.
  3196            88  PD-PROD-LIFE           VALUE 'L'.
  3197            88  PD-PROD-PROP           VALUE 'P'.
  3198            88  PD-PROD-AH             VALUE 'A'.
  3199            88  PD-PROD-IU             VALUE 'I'.
  3200            88  PD-PROD-GAP            VALUE 'G'.
  3201        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3202        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3203        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3204        16  PD-MAX-TERM              PIC S999        COMP-3.
  3205        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3206        16  FILLER                   PIC X.
  3207        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3208        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3209        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3210        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3211        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3212        16  PD-REC-CRIT-PERIOD       PIC X.
  3213        16  PD-RTW-MOS               PIC 99.
  3214        16  FILLER                   PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  61
* EL131.cbl
  3215    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3216    12  PD-TERM-LIMITS OCCURS 15.
  3217        16  PD-LOW-TERM              PIC S999        COMP-3.
  3218        16  PD-HI-TERM               PIC S999        COMP-3.
  3219*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3220    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3221        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3222        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3223    12  PD-EARN-FACTORS.
  3224        16  FILLER OCCURS 15.
  3225            20  FILLER OCCURS 15.
  3226                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3227    12  PD-PRODUCT-DESC              PIC X(80).
  3228    12  PD-TRUNCATED                 PIC X.
  3229    12  FILLER                       PIC X(59).
  3230    12  PD-MAINT-INFORMATION.
  3231        16  PD-LAST-MAINT-DT         PIC X(02).
  3232        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3233        16  PD-LAST-MAINT-BY         PIC X(04).
  3234*                                COPY ELCCRTT.
  3235******************************************************************
  3236*                                                                *
  3237*                            ELCCRTT.                            *
  3238*                                                                *
  3239*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3240*                                                                *
  3241*   FILE TYPE = VSAM,KSDS                                        *
  3242*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3243*                                                                *
  3244*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3245*                                                                *
  3246*   LOG = YES                                                    *
  3247*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3248******************************************************************
  3249*                   C H A N G E   L O G
  3250*
  3251* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3252*-----------------------------------------------------------------
  3253*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3254* EFFECTIVE    NUMBER
  3255*-----------------------------------------------------------------
  3256* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3257* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3258* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3259* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3260* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3261******************************************************************
  3262
  3263 01  CERTIFICATE-TRAILERS.
  3264     12  CS-RECORD-ID                      PIC XX.
  3265         88  VALID-CS-ID                      VALUE 'CS'.
  3266
  3267     12  CS-CONTROL-PRIMARY.
  3268         16  CS-COMPANY-CD                 PIC X.
  3269         16  CS-CARRIER                    PIC X.
  3270         16  CS-GROUPING                   PIC X(6).
  3271         16  CS-STATE                      PIC XX.
  3272         16  CS-ACCOUNT                    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  62
* EL131.cbl
  3273         16  CS-CERT-EFF-DT                PIC XX.
  3274         16  CS-CERT-NO.
  3275             20  CS-CERT-PRIME             PIC X(10).
  3276             20  CS-CERT-SFX               PIC X.
  3277         16  CS-TRAILER-TYPE               PIC X.
  3278             88  COMM-TRLR           VALUE 'A'.
  3279             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3280             88  CERT-DATA-TRLR      VALUE 'C'.
  3281
  3282     12  CS-DATA-AREA                      PIC X(516).
  3283
  3284     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3285         16  CS-BANK-COMMISSION-AREA.
  3286             20  CS-BANK-COMMS       OCCURS 10.
  3287                 24  CS-AGT                PIC X(10).
  3288                 24  CS-COM-TYP            PIC X.
  3289                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3290                 24  CS-RECALC-LV-INDIC    PIC X.
  3291                 24  FILLER                PIC X(10).
  3292         16  FILLER                        PIC X(256).
  3293
  3294     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3295****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3296****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  3297         16  CS-MB-CLAIM-DATA OCCURS 2.
  3298             20  FILLER OCCURS 10.
  3299                 24  CS-CLAIM-TYPE         PIC X.
  3300                     88  CS-AH-CLM           VALUE 'A'.
  3301                     88  CS-IU-CLM           VALUE 'I'.
  3302                     88  CS-GP-CLM           VALUE 'G'.
  3303                     88  CS-LF-CLM           VALUE 'L'.
  3304                     88  CS-PR-CLM           VALUE 'P'.
  3305                 24  CS-BANK               PIC S999 COMP-3.
  3306                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  3307                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  3308                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  3309         16  FILLER                        PIC X(216).
  3310     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3311         16  CS-VIN-NUMBER                 PIC X(17).
  3312         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3313         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3314         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3315         16  FILLER                        PIC X(496).
  3316******************************************************************
  3317
  3318****************************************************************
  3319*
  3320* Copyright (c) 2007 by Clerity Solutions, Inc.
  3321* All rights reserved.
  3322*
  3323****************************************************************
  3324 01  DFHEIV.
  3325   02  DFHEIV0               PIC X(35).
  3326   02  DFHEIV1               PIC X(08).
  3327   02  DFHEIV2               PIC X(08).
  3328   02  DFHEIV3               PIC X(08).
  3329   02  DFHEIV4               PIC X(06).
  3330   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  63
* EL131.cbl
  3331   02  DFHEIV6               PIC X(04).
  3332   02  DFHEIV7               PIC X(02).
  3333   02  DFHEIV8               PIC X(02).
  3334   02  DFHEIV9               PIC X(01).
  3335   02  DFHEIV10              PIC S9(7) COMP-3.
  3336   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3337   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3338   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3339   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3340   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3341   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3342   02  DFHEIV17              PIC X(04).
  3343   02  DFHEIV18              PIC X(04).
  3344   02  DFHEIV19              PIC X(04).
  3345   02  DFHEIV20              USAGE IS POINTER.
  3346   02  DFHEIV21              USAGE IS POINTER.
  3347   02  DFHEIV22              USAGE IS POINTER.
  3348   02  DFHEIV23              USAGE IS POINTER.
  3349   02  DFHEIV24              USAGE IS POINTER.
  3350   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3351   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3352   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3353   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3354   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3355   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3356   02  FILLER                PIC X(02).
  3357   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3358   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3359   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3360   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3361   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3362 LINKAGE  SECTION.
  3363*****************************************************************
  3364*                                                               *
  3365* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3366* All rights reserved.                                          *
  3367*                                                               *
  3368*****************************************************************
  3369 01  dfheiblk.
  3370     02  eibtime          pic s9(7) comp-3.
  3371     02  eibdate          pic s9(7) comp-3.
  3372     02  eibtrnid         pic x(4).
  3373     02  eibtaskn         pic s9(7) comp-3.
  3374     02  eibtrmid         pic x(4).
  3375     02  dfheigdi         pic s9(4) comp.
  3376     02  eibcposn         pic s9(4) comp.
  3377     02  eibcalen         pic s9(4) comp.
  3378     02  eibaid           pic x(1).
  3379     02  eibfiller1       pic x(1).
  3380     02  eibfn            pic x(2).
  3381     02  eibfiller2       pic x(2).
  3382     02  eibrcode         pic x(6).
  3383     02  eibfiller3       pic x(2).
  3384     02  eibds            pic x(8).
  3385     02  eibreqid         pic x(8).
  3386     02  eibrsrce         pic x(8).
  3387     02  eibsync          pic x(1).
  3388     02  eibfree          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  64
* EL131.cbl
  3389     02  eibrecv          pic x(1).
  3390     02  eibsend          pic x(1).
  3391     02  eibatt           pic x(1).
  3392     02  eibeoc           pic x(1).
  3393     02  eibfmh           pic x(1).
  3394     02  eibcompl         pic x(1).
  3395     02  eibsig           pic x(1).
  3396     02  eibconf          pic x(1).
  3397     02  eiberr           pic x(1).
  3398     02  eibrldbk         pic x(1).
  3399     02  eiberrcd         pic x(4).
  3400     02  eibsynrb         pic x(1).
  3401     02  eibnodat         pic x(1).
  3402     02  eibfiller5       pic x(2).
  3403     02  eibresp          pic 9(09) comp.
  3404     02  eibresp2         pic 9(09) comp.
  3405     02  dfheigdj         pic s9(4) comp.
  3406     02  dfheigdk         pic s9(4) comp.
  3407 01  DFHCOMMAREA                 PIC X(1024).
  3408
  3409*                                COPY ELCMSTR.
  3410******************************************************************
  3411*                                                                *
  3412*                            ELCMSTR.                            *
  3413*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3414*                            VMOD=2.012                          *
  3415*                                                                *
  3416*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3417*                                                                *
  3418*   FILE TYPE = VSAM,KSDS                                        *
  3419*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3420*                                                                *
  3421*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3422*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3423*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3424*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3425*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3426*                                                 RKP=75,LEN=21  *
  3427*                                                                *
  3428*   **** NOTE ****                                               *
  3429*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3430*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3431*                                                                *
  3432*   LOG = YES                                                    *
  3433*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3434******************************************************************
  3435*                   C H A N G E   L O G
  3436*
  3437* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3438*-----------------------------------------------------------------
  3439*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3440* EFFECTIVE    NUMBER
  3441*-----------------------------------------------------------------
  3442* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3443* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3444* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3445******************************************************************
  3446 01  CLAIM-MASTER.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  65
* EL131.cbl
  3447     12  CL-RECORD-ID                PIC XX.
  3448         88  VALID-CL-ID         VALUE 'CL'.
  3449
  3450     12  CL-CONTROL-PRIMARY.
  3451         16  CL-COMPANY-CD           PIC X.
  3452         16  CL-CARRIER              PIC X.
  3453         16  CL-CLAIM-NO             PIC X(7).
  3454         16  CL-CERT-NO.
  3455             20  CL-CERT-PRIME       PIC X(10).
  3456             20  CL-CERT-SFX         PIC X.
  3457
  3458     12  CL-CONTROL-BY-NAME.
  3459         16  CL-COMPANY-CD-A1        PIC X.
  3460         16  CL-INSURED-LAST-NAME    PIC X(15).
  3461         16  CL-INSURED-NAME.
  3462             20  CL-INSURED-1ST-NAME PIC X(12).
  3463             20  CL-INSURED-MID-INIT PIC X.
  3464
  3465     12  CL-CONTROL-BY-SSN.
  3466         16  CL-COMPANY-CD-A2        PIC X.
  3467         16  CL-SOC-SEC-NO.
  3468             20  CL-SSN-STATE        PIC XX.
  3469             20  CL-SSN-ACCOUNT      PIC X(6).
  3470             20  CL-SSN-LN3          PIC X(3).
  3471
  3472     12  CL-CONTROL-BY-CERT-NO.
  3473         16  CL-COMPANY-CD-A4        PIC X.
  3474         16  CL-CERT-NO-A4.
  3475             20  CL-CERT-A4-PRIME    PIC X(10).
  3476             20  CL-CERT-A4-SFX      PIC X.
  3477
  3478     12  CL-CONTROL-BY-CCN.
  3479         16  CL-COMPANY-CD-A5        PIC X.
  3480         16  CL-CCN-A5.
  3481             20  CL-CCN.
  3482                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3483                 24  CL-CCN-PRIME-A5 PIC X(12).
  3484             20  CL-CCN-FILLER-A5    PIC X(4).
  3485
  3486     12  CL-INSURED-PROFILE-DATA.
  3487         16  CL-INSURED-BIRTH-DT     PIC XX.
  3488         16  CL-INSURED-SEX-CD       PIC X.
  3489             88  INSURED-IS-MALE        VALUE 'M'.
  3490             88  INSURED-IS-FEMALE      VALUE 'F'.
  3491             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3492         16  CL-INSURED-OCC-CD       PIC X(6).
  3493         16  FILLER                  PIC X(5).
  3494
  3495     12  CL-PROCESSING-INFO.
  3496         16  CL-PROCESSOR-ID         PIC X(4).
  3497         16  CL-CLAIM-STATUS         PIC X.
  3498             88  CLAIM-IS-OPEN          VALUE 'O'.
  3499             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3500         16  CL-CLAIM-TYPE           PIC X.
  3501*            88  AH-CLAIM               VALUE 'A'.
  3502*            88  LIFE-CLAIM             VALUE 'L'.
  3503*            88  PROPERTY-CLAIM         VALUE 'P'.
  3504*            88  IUI-CLAIM              VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  66
* EL131.cbl
  3505*            88  GAP-CLAIM              VALUE 'G'.
  3506         16  CL-CLAIM-PREM-TYPE      PIC X.
  3507             88  SINGLE-PREMIUM         VALUE '1'.
  3508             88  O-B-COVERAGE           VALUE '2'.
  3509             88  OPEN-END-COVERAGE      VALUE '3'.
  3510         16  CL-INCURRED-DT          PIC XX.
  3511         16  CL-REPORTED-DT          PIC XX.
  3512         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3513         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3514         16  CL-LAST-PMT-DT          PIC XX.
  3515         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3516         16  CL-PAID-THRU-DT         PIC XX.
  3517         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3518         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3519         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3520         16  CL-PMT-CALC-METHOD      PIC X.
  3521             88  CL-360-DAY-YR          VALUE '1'.
  3522             88  CL-365-DAY-YR          VALUE '2'.
  3523             88  CL-FULL-MONTHS         VALUE '3'.
  3524         16  CL-CAUSE-CD             PIC X(6).
  3525
  3526         16  CL-PRIME-CERT-NO.
  3527             20  CL-PRIME-CERT-PRIME PIC X(10).
  3528             20  CL-PRIME-CERT-SFX   PIC X.
  3529
  3530         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3531             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3532             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3533
  3534         16  CL-MICROFILM-NO         PIC X(10).
  3535         16  CL-PROG-FORM-TYPE       PIC X.
  3536         16  CL-LAST-ADD-ON-DT       PIC XX.
  3537
  3538         16  CL-LAST-REOPEN-DT       PIC XX.
  3539         16  CL-LAST-CLOSE-DT        PIC XX.
  3540         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3541             88  FINAL-PAID             VALUE '1'.
  3542             88  CLAIM-DENIED           VALUE '2'.
  3543             88  AUTO-CLOSE             VALUE '3'.
  3544             88  MANUAL-CLOSE           VALUE '4'.
  3545             88  BENEFITS-CHANGED       VALUE 'C'.
  3546             88  SETUP-ERRORS           VALUE 'E'.
  3547         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3548         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3549         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3550             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3551         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3552         16  FILLER                  PIC X.
  3553
  3554     12  CL-CERTIFICATE-DATA.
  3555         16  CL-CERT-ORIGIN          PIC X.
  3556             88  CERT-WAS-ONLINE        VALUE '1'.
  3557             88  CERT-WAS-CREATED       VALUE '2'.
  3558             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3559         16  CL-CERT-KEY-DATA.
  3560             20  CL-CERT-CARRIER     PIC X.
  3561             20  CL-CERT-GROUPING    PIC X(6).
  3562             20  CL-CERT-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  67
* EL131.cbl
  3563             20  CL-CERT-ACCOUNT.
  3564                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3565                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3566             20  CL-CERT-EFF-DT      PIC XX.
  3567
  3568     12  CL-STATUS-CONTROLS.
  3569         16  CL-PRIORITY-CD          PIC X.
  3570             88  CONFIDENTIAL-DATA      VALUE '8'.
  3571             88  HIGHEST-PRIORITY       VALUE '9'.
  3572         16  CL-SUPV-ATTN-CD         PIC X.
  3573             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3574             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3575         16  CL-PURGED-DT            PIC XX.
  3576         16  CL-RESTORED-DT          PIC XX.
  3577         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3578         16  CL-NEXT-RESEND-DT       PIC XX.
  3579         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3580         16  CL-CRITICAL-PERIOD      PIC 99.
  3581*        16  FILLER                  PIC XX.
  3582         16  CL-LAST-MAINT-DT        PIC XX.
  3583         16  CL-LAST-MAINT-USER      PIC X(4).
  3584         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3585         16  CL-LAST-MAINT-TYPE      PIC X.
  3586             88  CLAIM-SET-UP           VALUE ' '.
  3587             88  PAYMENT-MADE           VALUE '1'.
  3588             88  LETTER-SENT            VALUE '2'.
  3589             88  MASTER-WAS-ALTERED     VALUE '3'.
  3590             88  MASTER-WAS-RESTORED    VALUE '4'.
  3591             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3592             88  FILE-CONVERTED         VALUE '6'.
  3593             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3594             88  ERROR-CORRECTION       VALUE 'E'.
  3595         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3596         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3597         16  CL-BENEFICIARY          PIC X(10).
  3598         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3599         16  CL-DENIAL-TYPE          PIC X.
  3600             88  CL-TYPE-DENIAL          VALUE '1'.
  3601             88  CL-TYPE-RESCISSION      VALUE '2'.
  3602             88  CL-TYPE-REFORMATION     VALUE '3'.
  3603             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3604             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3605         16  CL-CRIT-PER-RECURRENT   PIC X.
  3606         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3607         16  CL-RTW-DT               PIC XX.
  3608
  3609     12  CL-TRAILER-CONTROLS.
  3610         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3611             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3612             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3613             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3614         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3615         16  FILLER                  PIC XX.
  3616         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3617         16  CL-ADDRESS-TRAILER-CNT.
  3618             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3619                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3620             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  68
* EL131.cbl
  3621                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3622             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3623                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3624             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3625                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3626             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3627                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3628             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3629                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3630             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3631                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3632
  3633     12  CL-CV-REFERENCE-NO.
  3634         16  CL-CV-REFNO-PRIME       PIC X(18).
  3635         16  CL-CV-REFNO-SFX         PIC XX.
  3636
  3637     12  CL-FILE-LOCATION            PIC X(4).
  3638
  3639     12  CL-PROCESS-ERRORS.
  3640         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3641             88  NO-FATAL-ERRORS        VALUE ZERO.
  3642         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3643             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3644
  3645     12  CL-PRODUCT-CD               PIC X.
  3646
  3647     12  CL-CURRENT-KEY-DATA.
  3648         16  CL-CURRENT-CARRIER      PIC X.
  3649         16  CL-CURRENT-GROUPING     PIC X(6).
  3650         16  CL-CURRENT-STATE        PIC XX.
  3651         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3652
  3653     12  CL-ASSOCIATES               PIC X.
  3654         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3655         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3656         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3657         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3658
  3659     12  CL-ACTIVITY-CODE            PIC 99.
  3660     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3661     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3662
  3663     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3664     12  CL-LAG-REPORT-CODE          PIC 9.
  3665     12  CL-LOAN-TYPE                PIC XX.
  3666     12  CL-LEGAL-STATE              PIC XX.
  3667
  3668     12  CL-YESNOSW                  PIC X.
  3669     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3670         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3671         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3672         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3673     12  cl-insured-claim            pic x.
  3674         88  cl-claim-on-primary         value 'P'.
  3675         88  cl-claim-on-secondary       value 'S'.
  3676     12  cl-benefit-expiration-dt    PIC XX.
  3677
  3678*                                COPY ELCCERT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  69
* EL131.cbl
  3679******************************************************************
  3680*                                                                *
  3681*                            ELCCERT.                            *
  3682*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3683*                            VMOD=2.013                          *
  3684*                                                                *
  3685*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3686*                                                                *
  3687*   FILE TYPE = VSAM,KSDS                                        *
  3688*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3689*                                                                *
  3690*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3691*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3692*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3693*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3694*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3695*                                                                *
  3696*   LOG = YES                                                    *
  3697*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3698******************************************************************
  3699*                   C H A N G E   L O G
  3700*
  3701* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3702*-----------------------------------------------------------------
  3703*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3704* EFFECTIVE    NUMBER
  3705*-----------------------------------------------------------------
  3706* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3707* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3708* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3709* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3710* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3711* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3712* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3713* 032612  CR2011110200001  PEMA  AHL CHANGES
  3714******************************************************************
  3715
  3716 01  CERTIFICATE-MASTER.
  3717     12  CM-RECORD-ID                      PIC XX.
  3718         88  VALID-CM-ID                      VALUE 'CM'.
  3719
  3720     12  CM-CONTROL-PRIMARY.
  3721         16  CM-COMPANY-CD                 PIC X.
  3722         16  CM-CARRIER                    PIC X.
  3723         16  CM-GROUPING.
  3724             20  CM-GROUPING-PREFIX        PIC X(3).
  3725             20  CM-GROUPING-PRIME         PIC X(3).
  3726         16  CM-STATE                      PIC XX.
  3727         16  CM-ACCOUNT.
  3728             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3729             20  CM-ACCOUNT-PRIME          PIC X(6).
  3730         16  CM-CERT-EFF-DT                PIC XX.
  3731         16  CM-CERT-NO.
  3732             20  CM-CERT-PRIME             PIC X(10).
  3733             20  CM-CERT-SFX               PIC X.
  3734
  3735     12  CM-CONTROL-BY-NAME.
  3736         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  70
* EL131.cbl
  3737         16  CM-INSURED-LAST-NAME          PIC X(15).
  3738         16  CM-INSURED-INITIALS.
  3739             20  CM-INSURED-INITIAL1       PIC X.
  3740             20  CM-INSURED-INITIAL2       PIC X.
  3741
  3742     12  CM-CONTROL-BY-SSN.
  3743         16  CM-COMPANY-CD-A2              PIC X.
  3744         16  CM-SOC-SEC-NO.
  3745             20  CM-SSN-STATE              PIC XX.
  3746             20  CM-SSN-ACCOUNT            PIC X(6).
  3747             20  CM-SSN-LN3.
  3748                 25  CM-INSURED-INITIALS-A2.
  3749                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3750                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3751                 25 CM-PART-LAST-NAME-A2         PIC X.
  3752
  3753     12  CM-CONTROL-BY-CERT-NO.
  3754         16  CM-COMPANY-CD-A4              PIC X.
  3755         16  CM-CERT-NO-A4                 PIC X(11).
  3756
  3757     12  CM-CONTROL-BY-MEMB.
  3758         16  CM-COMPANY-CD-A5              PIC X.
  3759         16  CM-MEMBER-NO.
  3760             20  CM-MEMB-STATE             PIC XX.
  3761             20  CM-MEMB-ACCOUNT           PIC X(6).
  3762             20  CM-MEMB-LN4.
  3763                 25  CM-INSURED-INITIALS-A5.
  3764                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3765                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3766                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3767
  3768     12  CM-INSURED-PROFILE-DATA.
  3769         16  CM-INSURED-FIRST-NAME.
  3770             20  CM-INSURED-1ST-INIT       PIC X.
  3771             20  FILLER                    PIC X(9).
  3772         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3773         16  CM-INSURED-SEX                PIC X.
  3774             88  CM-SEX-MALE                  VALUE 'M'.
  3775             88  CM-SEX-FEMAL                 VALUE 'F'.
  3776         16  CM-INSURED-JOINT-AGE          PIC 99.
  3777         16  CM-JOINT-INSURED-NAME.
  3778             20  CM-JT-LAST-NAME           PIC X(15).
  3779             20  CM-JT-FIRST-NAME.
  3780                 24  CM-JT-1ST-INIT        PIC X.
  3781                 24  FILLER                PIC X(9).
  3782             20  CM-JT-INITIAL             PIC X.
  3783
  3784     12  CM-LIFE-DATA.
  3785         16  CM-LF-BENEFIT-CD              PIC XX.
  3786         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3787         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3788         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3789         16  CM-LF-DEV-CODE                PIC XXX.
  3790         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3791         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3792         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3793         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3794         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  71
* EL131.cbl
  3795         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3796         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3797         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3798         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3799         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3800         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3801         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3802         16  FILLER                        PIC XX.
  3803
  3804     12  CM-AH-DATA.
  3805         16  CM-AH-BENEFIT-CD              PIC XX.
  3806         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3807         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3808         16  CM-AH-DEV-CODE                PIC XXX.
  3809         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3810         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3811         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3812         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3813         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3814         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3815         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3816         16  CM-AH-PAID-THRU-DT            PIC XX.
  3817             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3818         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3819         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3820         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3821         16  FILLER                        PIC X.
  3822
  3823     12  CM-LOAN-INFORMATION.
  3824         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3825         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3826                                           PIC S9(5)V99  COMP-3.
  3827         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3828         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3829         16  CM-PAY-FREQUENCY              PIC S99.
  3830         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3831         16  CM-RATE-CLASS                 PIC XX.
  3832         16  CM-BENEFICIARY                PIC X(25).
  3833         16  CM-POLICY-FORM-NO             PIC X(12).
  3834         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3835         16  CM-LAST-ADD-ON-DT             PIC XX.
  3836         16  CM-DEDUCTIBLE-AMOUNTS.
  3837             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3838             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3839         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3840             20  CM-RESIDENT-STATE         PIC XX.
  3841             20  CM-RATE-CODE              PIC X(4).
  3842             20  FILLER                    PIC XX.
  3843         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3844             20  CM-LOAN-OFFICER           PIC X(5).
  3845             20  FILLER                    PIC XXX.
  3846         16  CM-CSR-CODE                   PIC XXX.
  3847         16  CM-UNDERWRITING-CODE          PIC X.
  3848             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3849         16  CM-POST-CARD-IND              PIC X.
  3850         16  CM-NH-INTERFACE-SW            PIC X.
  3851         16  CM-PREMIUM-TYPE               PIC X.
  3852             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  72
* EL131.cbl
  3853             88  CM-O-B-COVERAGE              VALUE '2'.
  3854             88  CM-OPEN-END                  VALUE '3'.
  3855         16  CM-IND-GRP-TYPE               PIC X.
  3856             88  CM-INDIVIDUAL                VALUE 'I'.
  3857             88  CM-GROUP                     VALUE 'G'.
  3858         16  CM-SKIP-CODE                  PIC X.
  3859             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3860             88  SKIP-JULY                    VALUE '1'.
  3861             88  SKIP-AUGUST                  VALUE '2'.
  3862             88  SKIP-SEPTEMBER               VALUE '3'.
  3863             88  SKIP-JULY-AUG                VALUE '4'.
  3864             88  SKIP-AUG-SEPT                VALUE '5'.
  3865             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3866             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3867             88  SKIP-JUNE                    VALUE '8'.
  3868             88  SKIP-JUNE-JULY               VALUE '9'.
  3869             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3870             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3871         16  CM-PAYMENT-MODE               PIC X.
  3872             88  PAY-MONTHLY                  VALUE SPACE.
  3873             88  PAY-WEEKLY                   VALUE '1'.
  3874             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3875             88  PAY-BI-WEEKLY                VALUE '3'.
  3876             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3877         16  CM-LOAN-NUMBER                PIC X(8).
  3878         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3879         16  CM-OLD-LOF                    PIC XXX.
  3880*        16  CM-LOAN-OFFICER               PIC XXX.
  3881         16  CM-REIN-TABLE                 PIC XXX.
  3882         16  CM-SPECIAL-REIN-CODE          PIC X.
  3883         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3884         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3885         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3886
  3887     12  CM-STATUS-DATA.
  3888         16  CM-ENTRY-STATUS               PIC X.
  3889         16  CM-ENTRY-DT                   PIC XX.
  3890
  3891         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3892         16  CM-LF-CANCEL-DT               PIC XX.
  3893         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3894
  3895         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3896         16  CM-LF-DEATH-DT                PIC XX.
  3897         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3898
  3899         16  CM-LF-CURRENT-STATUS          PIC X.
  3900             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3901                                                'M' '4' '5' '9'.
  3902             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3903             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3904             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3905             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3906             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3907             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3908             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3909             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3910             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  73
* EL131.cbl
  3911             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3912             88  CM-LF-DECLINED               VALUE 'D'.
  3913             88  CM-LF-VOIDED                 VALUE 'V'.
  3914
  3915         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3916         16  CM-AH-CANCEL-DT               PIC XX.
  3917         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3918
  3919         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3920         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3921         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3922
  3923         16  CM-AH-CURRENT-STATUS          PIC X.
  3924             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3925                                                'M' '4' '5' '9'.
  3926             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3927             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3928             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3929             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3930             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3931             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3932             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3933             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3934             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3935             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  3936             88  CM-AH-DECLINED               VALUE 'D'.
  3937             88  CM-AH-VOIDED                 VALUE 'V'.
  3938
  3939         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3940             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3941             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3942             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3943         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3944
  3945         16  CM-ENTRY-BATCH                PIC X(6).
  3946         16  CM-LF-EXIT-BATCH              PIC X(6).
  3947         16  CM-AH-EXIT-BATCH              PIC X(6).
  3948         16  CM-LAST-MONTH-END             PIC XX.
  3949
  3950     12  CM-NOTE-SW                        PIC X.
  3951         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3952         88  CERT-NOTES-PRESENT               VALUE '1'.
  3953         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3954         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3955         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3956         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3957         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3958         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3959     12  CM-COMP-EXCP-SW                   PIC X.
  3960         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3961         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3962     12  CM-INSURED-ADDRESS-SW             PIC X.
  3963         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  3964         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3965
  3966*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3967     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  3968     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  74
* EL131.cbl
  3969
  3970*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  3971     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3972     12  FILLER                            PIC X.
  3973*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3974     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3975
  3976     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3977         88  CERT-ADDED-BATCH                 VALUE ' '.
  3978         88  CERT-ADDED-ONLINE                VALUE '1'.
  3979         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3980         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3981         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3982     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3983         88  CERT-AS-LOADED                   VALUE ' '.
  3984         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3985         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3986         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3987         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3988         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3989         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3990         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3991
  3992     12  CM-ACCOUNT-COMM-PCTS.
  3993         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  3994         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3995
  3996     12  CM-USER-FIELD                     PIC X.
  3997     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  3998     12  CM-CLP-STATE                      PIC XX.
  3999     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4000     12  CM-USER-RESERVED                  PIC XXX.
  4001     12  FILLER REDEFINES CM-USER-RESERVED.
  4002         16  CM-AH-CLASS-CD                PIC XX.
  4003         16  F                             PIC X.
  4004******************************************************************
  4005
  4006*                                COPY ELCTRLR.
  4007******************************************************************
  4008*                                                                *
  4009*                            ELCTRLR.                            *
  4010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4011*                            VMOD=2.014                          *
  4012*                                                                *
  4013*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4014*                                                                *
  4015*   FILE TYPE = VSAM,KSDS                                        *
  4016*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4017*                                                                *
  4018*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4019*       ALTERNATE INDEX = NONE                                   *
  4020*                                                                *
  4021*   LOG = YES                                                    *
  4022*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4023******************************************************************
  4024*                   C H A N G E   L O G
  4025*
  4026* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  75
* EL131.cbl
  4027*-----------------------------------------------------------------
  4028*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4029* EFFECTIVE    NUMBER
  4030*-----------------------------------------------------------------
  4031* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4032* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4033* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4034* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4035* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4036* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4037* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4038* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4039* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4040* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4041* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4042* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4043* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4044* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4045* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4046* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4047******************************************************************
  4048 01  ACTIVITY-TRAILERS.
  4049     12  AT-RECORD-ID                    PIC XX.
  4050         88  VALID-AT-ID                       VALUE 'AT'.
  4051
  4052     12  AT-CONTROL-PRIMARY.
  4053         16  AT-COMPANY-CD               PIC X.
  4054         16  AT-CARRIER                  PIC X.
  4055         16  AT-CLAIM-NO                 PIC X(7).
  4056         16  AT-CERT-NO.
  4057             20  AT-CERT-PRIME           PIC X(10).
  4058             20  AT-CERT-SFX             PIC X.
  4059         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4060             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4061             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4062             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4063             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4064             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4065             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4066             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4067             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4068             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4069             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4070             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4071             88  AT-BENEFICIARY-TRL           VALUE +91.
  4072             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4073             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4074             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4075             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4076
  4077     12  AT-TRAILER-TYPE                 PIC X.
  4078         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4079         88  PAYMENT-TR                       VALUE '2'.
  4080         88  AUTO-PAY-TR                      VALUE '3'.
  4081         88  CORRESPONDENCE-TR                VALUE '4'.
  4082         88  ADDRESS-TR                       VALUE '5'.
  4083         88  GENERAL-INFO-TR                  VALUE '6'.
  4084         88  AUTO-PROMPT-TR                   VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  76
* EL131.cbl
  4085         88  DENIAL-TR                        VALUE '8'.
  4086         88  INCURRED-CHG-TR                  VALUE '9'.
  4087         88  FORM-CONTROL-TR                  VALUE 'A'.
  4088
  4089     12  AT-RECORDED-DT                  PIC XX.
  4090     12  AT-RECORDED-BY                  PIC X(4).
  4091     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4092
  4093     12  AT-TRAILER-BODY                 PIC X(165).
  4094
  4095     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4096         16  AT-RESERVE-CONTROLS.
  4097             20  AT-MANUAL-SW            PIC X.
  4098                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4099             20  AT-FUTURE-SW            PIC X.
  4100                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4101             20  AT-PTC-SW               PIC X.
  4102                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4103             20  AT-IBNR-SW              PIC X.
  4104                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4105             20  AT-PTC-LF-SW            PIC X.
  4106                 88  AT-LF-PTC-USED          VALUE '1'.
  4107             20  AT-CDT-ACCESS-METHOD    PIC X.
  4108                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4109                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4110                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4111             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4112         16  AT-LAST-COMPUTED-DT         PIC XX.
  4113         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4114         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4115         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4116         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4117         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4118         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4119         16  AT-EXPENSE-CONTROLS.
  4120             20  AT-EXPENSE-METHOD       PIC X.
  4121                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4122                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4123                 88  PERCENT-OF-PMT           VALUE '3'.
  4124                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4125             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4126             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4127         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4128         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4129
  4130         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4131         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4132
  4133*        16  FILLER                      PIC X(53).
  4134         16  FILLER                      PIC X(47).
  4135
  4136         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4137         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4138
  4139         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4140             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4141             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4142*                    C = CLOSED
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  77
* EL131.cbl
  4143*                    O = OPEN
  4144             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4145*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4146
  4147     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4148         16  AT-PAYMENT-TYPE             PIC X.
  4149             88  PARTIAL-PAYMENT                VALUE '1'.
  4150             88  FINAL-PAYMENT                  VALUE '2'.
  4151             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4152             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4153             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4154             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4155             88  VOIDED-PAYMENT                 VALUE '9'.
  4156             88  TRANSFER                       VALUE 'T'.
  4157             88  LIFE-INTEREST                  VALUE 'I'.
  4158
  4159         16  AT-CLAIM-TYPE               PIC X.
  4160             88  PAID-FOR-AH                    VALUE 'A'.
  4161             88  PAID-FOR-LIFE                  VALUE 'L'.
  4162             88  PAID-FOR-IUI                   VALUE 'I'.
  4163             88  PAID-FOR-GAP                   VALUE 'G'.
  4164         16  AT-CLAIM-PREM-TYPE          PIC X.
  4165             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4166             88  AT-O-B-COVERAGE                VALUE '2'.
  4167             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4168         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4169         16  AT-CHECK-NO                 PIC X(7).
  4170         16  AT-PAID-FROM-DT             PIC XX.
  4171         16  AT-PAID-THRU-DT             PIC XX.
  4172         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4173         16  FILLER                      PIC X.
  4174         16  AT-PAYEES-NAME              PIC X(30).
  4175         16  AT-PAYMENT-ORIGIN           PIC X.
  4176             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4177             88  ONLINE-AUTO-PMT                VALUE '2'.
  4178             88  OFFLINE-PMT                    VALUE '3'.
  4179         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4180         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4181         16  AT-VOID-DATA.
  4182             20  AT-VOID-DT              PIC XX.
  4183*00144       20  AT-VOID-REASON          PIC X(30).
  4184             20  AT-VOID-REASON          PIC X(26).
  4185         16  AT-PMT-APPROVED-BY          PIC X(04).
  4186         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4187         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4188         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4189                                         PIC S99V9(5)  COMP-3.
  4190         16  AT-CREDIT-INTERFACE.
  4191             20  AT-PMT-SELECT-DT        PIC XX.
  4192                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4193             20  AT-PMT-ACCEPT-DT        PIC XX.
  4194                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4195             20  AT-VOID-SELECT-DT       PIC XX.
  4196                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4197             20  AT-VOID-ACCEPT-DT       PIC XX.
  4198                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4199
  4200         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  78
* EL131.cbl
  4201                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4202                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4203         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4204
  4205         16  AT-FORCE-CONTROL            PIC X.
  4206             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4207         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4208         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4209         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4210         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4211         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4212         16  AT-BENEFIT-TYPE             PIC X.
  4213
  4214         16  AT-EXPENSE-TYPE             PIC X.
  4215         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4216
  4217         16  AT-PAYEE-TYPE-CD.
  4218             20  AT-PAYEE-TYPE           PIC X.
  4219                 88  INSURED-PAID           VALUE 'I'.
  4220                 88  BENEFICIARY-PAID       VALUE 'B'.
  4221                 88  ACCOUNT-PAID           VALUE 'A'.
  4222                 88  OTHER-1-PAID           VALUE 'O'.
  4223                 88  OTHER-2-PAID           VALUE 'Q'.
  4224                 88  DOCTOR-PAID            VALUE 'P'.
  4225                 88  EMPLOYER-PAID          VALUE 'E'.
  4226             20  AT-PAYEE-SEQ            PIC X.
  4227
  4228         16  AT-CASH-PAYMENT             PIC X.
  4229         16  AT-GROUPED-PAYMENT          PIC X.
  4230         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4231         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4232         16  AT-APPROVED-LEVEL           PIC X.
  4233         16  AT-VOID-TYPE                PIC X.
  4234             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4235             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4236         16  AT-AIG-UNEMP-IND            PIC X.
  4237             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4238         16  AT-ASSOCIATES               PIC X.
  4239             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4240             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4241
  4242         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4243         16  AT-CV-PMT-CODE              PIC X.
  4244             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4245             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4246             88  FULL-ADD-PAYMENT           VALUE '3'.
  4247             88  HALF-ADD-PAYMENT           VALUE '4'.
  4248             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4249             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4250             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4251             88  ADDL-PAYMENT               VALUE '8'.
  4252
  4253         16  AT-EOB-CODE1                PIC XXX.
  4254         16  AT-EOB-CODE2                PIC XXX.
  4255         16  AT-EOB-CODE3                PIC XXX.
  4256         16  FILLER REDEFINES AT-EOB-CODE3.
  4257             20  AT-PRINT-CLM-FORM       PIC X.
  4258             20  AT-PRINT-SURVEY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  79
* EL131.cbl
  4259             20  FILLER                  PIC X.
  4260         16  AT-EOB-CODE4                PIC XXX.
  4261         16  FILLER REDEFINES AT-EOB-CODE4.
  4262             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4263             20  FILLER                  PIC X.
  4264         16  AT-EOB-CODE5                PIC XXX.
  4265         16  FILLER REDEFINES AT-EOB-CODE5.
  4266             20  AT-PMT-PROOF-DT         PIC XX.
  4267             20  FILLER                  PIC X.
  4268
  4269         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4270             88  AT-PRINT-EOB            VALUE 'Y'.
  4271
  4272         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4273         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4274
  4275     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4276         16  AT-SCHEDULE-START-DT        PIC XX.
  4277         16  AT-SCHEDULE-END-DT          PIC XX.
  4278         16  AT-TERMINATED-DT            PIC XX.
  4279         16  AT-LAST-PMT-TYPE            PIC X.
  4280             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4281             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4282         16  AT-FIRST-PMT-DATA.
  4283             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4284             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4285             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4286         16  AT-REGULAR-PMT-DATA.
  4287             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4288             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4289             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4290         16  AT-AUTO-PAYEE-CD.
  4291             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4292                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4293                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4294                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4295                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4296                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4297             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4298         16  AT-AUTO-PAY-DAY             PIC 99.
  4299         16  AT-AUTO-CASH                PIC X.
  4300             88  AT-CASH                      VALUE 'Y'.
  4301             88  AT-NON-CASH                  VALUE 'N'.
  4302*        16  FILLER                      PIC X(129).
  4303         16  AT-AUTO-END-LETTER          PIC X(4).
  4304         16  FILLER                      PIC X(125).
  4305
  4306         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4307         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4308
  4309     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4310         16  AT-LETTER-SENT-DT           PIC XX.
  4311         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4312         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4313         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4314         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4315         16  AT-LETTER-ORIGIN            PIC X.
  4316             88  ONLINE-CREATION              VALUE '1' '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  80
* EL131.cbl
  4317             88  OFFLINE-CREATION             VALUE '2' '4'.
  4318             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4319             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4320         16  AT-STD-LETTER-FORM          PIC X(4).
  4321         16  AT-REASON-TEXT              PIC X(70).
  4322         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4323         16  AT-ADDRESEE-TYPE            PIC X.
  4324              88  INSURED-ADDRESEE            VALUE 'I'.
  4325              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4326              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4327              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4328              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4329              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4330              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4331         16  AT-ADDRESSEE-NAME           PIC X(30).
  4332         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4333         16  AT-RESEND-PRINT-DATE        PIC XX.
  4334         16  AT-CORR-SOL-UNSOL           PIC X.
  4335         16  AT-LETTER-PURGED-DT         PIC XX.
  4336*
  4337*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4338*
  4339         16  AT-CSO-REDEFINITION.
  4340             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4341             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4342             20  AT-LETTER-TO-BENE       PIC X(1).
  4343             20  AT-STOP-LETTER-DT       PIC X(2).
  4344             20  FILLER                  PIC X(19).
  4345*             20  FILLER                  PIC X(27).
  4346             20  AT-CSO-LETTER-STATUS    PIC X.
  4347                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4348                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4349                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4350             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4351             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4352*
  4353*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4354*
  4355*        16  FILLER                      PIC X(26).
  4356*
  4357*        16  AT-DMD-BSR-CODE             PIC X.
  4358*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4359*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4360*
  4361*        16  AT-DMD-LETTER-STATUS        PIC X.
  4362*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4363*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4364*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4365*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4366*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4367
  4368         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4369         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4370
  4371     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4372         16  AT-ADDRESS-TYPE             PIC X.
  4373             88  INSURED-ADDRESS               VALUE 'I'.
  4374             88  BENEFICIARY-ADDRESS           VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  81
* EL131.cbl
  4375             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4376             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4377             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4378             88  OTHER-ADDRESS-1               VALUE 'O'.
  4379             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4380         16  AT-MAIL-TO-NAME             PIC X(30).
  4381         16  AT-ADDRESS-LINE-1           PIC X(30).
  4382         16  AT-ADDRESS-LINE-2           PIC X(30).
  4383         16  AT-CITY-STATE.
  4384             20  AT-CITY                 PIC X(28).
  4385             20  AT-STATE                PIC XX.
  4386         16  AT-ZIP.
  4387             20  AT-ZIP-CODE.
  4388                 24  AT-ZIP-1ST          PIC X.
  4389                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4390                 24  FILLER              PIC X(4).
  4391             20  AT-ZIP-PLUS4            PIC X(4).
  4392         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4393             20  AT-CAN-POSTAL-1         PIC XXX.
  4394             20  AT-CAN-POSTAL-2         PIC XXX.
  4395             20  FILLER                  PIC XXX.
  4396         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4397*         16  FILLER                      PIC X(23).
  4398         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4399         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4400         16  FILLER                      PIC X(13).
  4401         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4402         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4403
  4404     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4405         16  AT-INFO-LINE-1              PIC X(60).
  4406         16  FILLER REDEFINES AT-INFO-LINE-1.
  4407             20  AT-NOTE-ERROR-NO OCCURS 15
  4408                                         PIC X(4).
  4409         16  AT-INFO-LINE-2              PIC X(60).
  4410         16  AT-INFO-TRAILER-TYPE        PIC X.
  4411             88  AT-ERRORS-NOTE          VALUE 'E'.
  4412             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4413             88  AT-CALL-NOTE            VALUE 'C'.
  4414             88  AT-MAINT-NOTE           VALUE 'M'.
  4415             88  AT-CERT-CHANGE          VALUE 'X'.
  4416             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4417             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4418         16  AT-CALL-TYPE                PIC X.
  4419             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4420             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4421         16  AT-NOTE-CONTINUATION        PIC X.
  4422             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4423         16  AT-EOB-CODES-EXIST          PIC X.
  4424             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4425         16  FILLER                      PIC X(35).
  4426         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4427         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4428
  4429     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4430         16  AT-PROMPT-LINE-1            PIC X(60).
  4431         16  AT-PROMPT-LINE-2            PIC X(60).
  4432         16  AT-PROMPT-START-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  82
* EL131.cbl
  4433         16  AT-PROMPT-END-DT            PIC XX.
  4434         16  FILLER                      PIC X(35).
  4435         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4436         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4437
  4438     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4439         16  AT-DENIAL-INFO-1            PIC X(60).
  4440         16  AT-DENIAL-INFO-2            PIC X(60).
  4441         16  AT-DENIAL-DT                PIC XX.
  4442         16  AT-RETRACTION-DT            PIC XX.
  4443         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4444*         16  FILLER                      PIC X(31).
  4445         16  AT-DENIAL-PROOF-DT          PIC XX.
  4446         16  FILLER                      PIC X(29).
  4447         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4448         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4449
  4450     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4451         16  AT-OLD-INCURRED-DT          PIC XX.
  4452         16  AT-OLD-REPORTED-DT          PIC XX.
  4453         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4454         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4455         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4456         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4457         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4458         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4459         16  FILLER                      PIC X(26).
  4460         16  AT-OLD-DIAG-CODE            PIC X(6).
  4461         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4462         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4463         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4464         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4465         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4466         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4467         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4468         16  FILLER                      PIC X(25).
  4469         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4470
  4471     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4472         16  AT-FORM-SEND-ON-DT          PIC XX.
  4473         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4474         16  AT-FORM-RE-SEND-DT          PIC XX.
  4475         16  AT-FORM-ANSWERED-DT         PIC XX.
  4476         16  AT-FORM-PRINTED-DT          PIC XX.
  4477         16  AT-FORM-REPRINT-DT          PIC XX.
  4478         16  AT-FORM-TYPE                PIC X.
  4479             88  INITIAL-FORM                  VALUE '1'.
  4480             88  PROGRESS-FORM                 VALUE '2'.
  4481         16  AT-INSTRUCT-LN-1            PIC X(28).
  4482         16  AT-INSTRUCT-LN-2            PIC X(28).
  4483         16  AT-INSTRUCT-LN-3            PIC X(28).
  4484         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4485         16  AT-FORM-ADDRESS             PIC X.
  4486             88  FORM-TO-INSURED              VALUE 'I'.
  4487             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4488             88  FORM-TO-OTHER-1              VALUE 'O'.
  4489             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4490         16  AT-RELATED-1.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  83
* EL131.cbl
  4491             20 AT-REL-CARR-1            PIC X.
  4492             20 AT-REL-CLAIM-1           PIC X(7).
  4493             20 AT-REL-CERT-1            PIC X(11).
  4494         16  AT-RELATED-2.
  4495             20 AT-REL-CARR-2            PIC X.
  4496             20 AT-REL-CLAIM-2           PIC X(7).
  4497             20 AT-REL-CERT-2            PIC X(11).
  4498         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4499         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4500         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4501         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4502         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4503         16  AT-STOP-FORM-DT             PIC X(2).
  4504
  4505         16  FILLER                      PIC X(09).
  4506         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4507         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4508******************************************************************
  4509
  4510*                                COPY ELCCNTL.
  4511******************************************************************
  4512*                                                                *
  4513*                                                                *
  4514*                            ELCCNTL.                            *
  4515*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4516*                            VMOD=2.059                          *
  4517*                                                                *
  4518*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4519*                                                                *
  4520*   FILE TYPE = VSAM,KSDS                                        *
  4521*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4522*                                                                *
  4523*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4524*       ALTERNATE INDEX = NONE                                   *
  4525*                                                                *
  4526*   LOG = YES                                                    *
  4527*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4528******************************************************************
  4529*                   C H A N G E   L O G
  4530*
  4531* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4532*-----------------------------------------------------------------
  4533*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4534* EFFECTIVE    NUMBER
  4535*-----------------------------------------------------------------
  4536* 082503                   PEMA  ADD BENEFIT GROUP
  4537* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4538* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4539* 092705    2005050300006  PEMA  ADD SPP LEASES
  4540* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4541* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4542* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4543* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4544* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4545* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4546* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4547* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4548******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  84
* EL131.cbl
  4549*
  4550 01  CONTROL-FILE.
  4551     12  CF-RECORD-ID                       PIC XX.
  4552         88  VALID-CF-ID                        VALUE 'CF'.
  4553
  4554     12  CF-CONTROL-PRIMARY.
  4555         16  CF-COMPANY-ID                  PIC XXX.
  4556         16  CF-RECORD-TYPE                 PIC X.
  4557             88  CF-COMPANY-MASTER              VALUE '1'.
  4558             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4559             88  CF-STATE-MASTER                VALUE '3'.
  4560             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4561             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4562             88  CF-CARRIER-MASTER              VALUE '6'.
  4563             88  CF-MORTALITY-MASTER            VALUE '7'.
  4564             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4565             88  CF-TERMINAL-MASTER             VALUE '9'.
  4566             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4567             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4568             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4569             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4570             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4571             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4572             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4573             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4574             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4575         16  CF-ACCESS-CD-GENL              PIC X(4).
  4576         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4577             20  CF-PROCESSOR               PIC X(4).
  4578         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4579             20  CF-STATE-CODE              PIC XX.
  4580             20  FILLER                     PIC XX.
  4581         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4582             20  FILLER                     PIC XX.
  4583             20  CF-HI-BEN-IN-REC           PIC XX.
  4584         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4585             20  FILLER                     PIC XXX.
  4586             20  CF-CARRIER-CNTL            PIC X.
  4587         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4588             20  FILLER                     PIC XX.
  4589             20  CF-HI-TYPE-IN-REC          PIC 99.
  4590         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4591             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4592                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4593             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4594             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4595         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4596             20  FILLER                     PIC X.
  4597             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4598         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4599             20  FILLER                     PIC XX.
  4600             20  CF-MORTGAGE-PLAN           PIC XX.
  4601         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4602
  4603     12  CF-LAST-MAINT-DT                   PIC XX.
  4604     12  CF-LAST-MAINT-BY                   PIC X(4).
  4605     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4606
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  85
* EL131.cbl
  4607     12  CF-RECORD-BODY                     PIC X(728).
  4608
  4609
  4610****************************************************************
  4611*             COMPANY MASTER RECORD                            *
  4612****************************************************************
  4613
  4614     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4615         16  CF-COMPANY-ADDRESS.
  4616             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4617             20  CF-CL-IN-CARE-OF           PIC X(30).
  4618             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4619             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4620             20  CF-CL-CITY-STATE           PIC X(30).
  4621             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4622             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4623         16  CF-COMPANY-CD                  PIC X.
  4624         16  CF-COMPANY-PASSWORD            PIC X(8).
  4625         16  CF-SECURITY-OPTION             PIC X.
  4626             88  ALL-SECURITY                   VALUE '1'.
  4627             88  COMPANY-VERIFY                 VALUE '2'.
  4628             88  PROCESSOR-VERIFY               VALUE '3'.
  4629             88  NO-SECURITY                    VALUE '4'.
  4630             88  ALL-BUT-TERM                   VALUE '5'.
  4631         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4632             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4633         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4634             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4635         16  CF-INFORCE-LOCATION            PIC X.
  4636             88  CERTS-ARE-ONLINE               VALUE '1'.
  4637             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4638             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4639         16  CF-LOWER-CASE-LETTERS          PIC X.
  4640         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4641             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4642             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4643             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4644             88  CF-ACCNT-CNTL                  VALUE '3'.
  4645             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4646
  4647         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4648         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4649
  4650         16  CF-LGX-CREDIT-USER             PIC X.
  4651             88  CO-IS-NOT-USER                 VALUE 'N'.
  4652             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4653
  4654         16 CF-CREDIT-CALC-CODES.
  4655             20  CF-CR-REM-TERM-CALC PIC X.
  4656               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4657               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4658               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4659               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4660               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4661               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4662               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4663             20  CF-CR-R78-METHOD           PIC X.
  4664               88  USE-TERM-PLUS-ONE            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  86
* EL131.cbl
  4665               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4666
  4667         16  CF-CLAIM-CONTROL-COUNTS.
  4668             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4669                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4670
  4671             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4672                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4673
  4674             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4675                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4676
  4677             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4678                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4679
  4680         16  CF-CURRENT-MONTH-END           PIC XX.
  4681
  4682         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4683             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4684             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4685             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4686             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4687                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4688                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4689             20  CF-CO-PREM-REJECT-SW       PIC X.
  4690                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4691                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4692             20  CF-CO-REF-REJECT-SW        PIC X.
  4693                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4694                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4695
  4696         16  CF-CO-REPORTING-DT             PIC XX.
  4697         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4698         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4699           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4700           88  CF-CO-MONTH-END                  VALUE '1'.
  4701
  4702         16  CF-LGX-CLAIM-USER              PIC X.
  4703             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4704             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4705
  4706         16  CF-CREDIT-EDIT-CONTROLS.
  4707             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4708             20  CF-MIN-AGE                 PIC 99.
  4709             20  CF-DEFAULT-AGE             PIC 99.
  4710             20  CF-MIN-TERM                PIC S999      COMP-3.
  4711             20  CF-MAX-TERM                PIC S999      COMP-3.
  4712             20  CF-DEFAULT-SEX             PIC X.
  4713             20  CF-JOINT-AGE-INPUT         PIC X.
  4714                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4715             20  CF-BIRTH-DATE-INPUT        PIC X.
  4716                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4717             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4718                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4719                 88  CF-ZERO-CARRIER            VALUE '1'.
  4720                 88  CF-ZERO-GROUPING           VALUE '2'.
  4721                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4722             20  CF-EDIT-SW                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  87
* EL131.cbl
  4723                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4724             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4725             20  CF-CR-PR-METHOD            PIC X.
  4726               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4727               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4728             20  FILLER                     PIC X.
  4729
  4730         16  CF-CREDIT-MISC-CONTROLS.
  4731             20  CF-REIN-TABLE-SW           PIC X.
  4732                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4733             20  CF-COMP-TABLE-SW           PIC X.
  4734                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4735             20  CF-EXPERIENCE-RETENTION-AGE
  4736                                            PIC S9        COMP-3.
  4737             20  CF-CONVERSION-DT           PIC XX.
  4738             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4739             20  CF-RUN-FREQUENCY-SW        PIC X.
  4740                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4741                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4742
  4743             20  CF-CR-CHECK-NO-CONTROL.
  4744                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4745                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4746                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4747                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4748                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4749                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4750
  4751                 24  CF-CR-CHECK-COUNT       REDEFINES
  4752                     CF-CR-CHECK-COUNTER      PIC X(4).
  4753
  4754                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4755                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4756
  4757                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4758                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4759                 24  CF-MAIL-PROCESSING       PIC X.
  4760                     88  MAIL-PROCESSING          VALUE 'Y'.
  4761
  4762         16  CF-MISC-SYSTEM-CONTROL.
  4763             20  CF-SYSTEM-C                 PIC X.
  4764                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4765             20  CF-SYSTEM-D                 PIC X.
  4766                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4767             20  CF-SOC-SEC-NO-SW            PIC X.
  4768                 88  SOC-SEC-NO-USED             VALUE '1'.
  4769             20  CF-MEMBER-NO-SW             PIC X.
  4770                 88  MEMBER-NO-USED              VALUE '1'.
  4771             20  CF-TAX-ID-NUMBER            PIC X(11).
  4772             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4773             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4774                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4775                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4776                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4777                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4778             20  CF-SYSTEM-E                 PIC X.
  4779                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4780
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  88
* EL131.cbl
  4781         16  CF-LGX-LIFE-USER               PIC X.
  4782             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4783             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4784
  4785         16  CF-CR-MONTH-END-DT             PIC XX.
  4786
  4787         16  CF-FILE-MAINT-DATES.
  4788             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4789                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4790             20  CF-LAST-BATCH       REDEFINES
  4791                 CF-LAST-BATCH-NO               PIC X(4).
  4792             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4793             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4794             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4795             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4796             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4797             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4798             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4799             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4800             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4801             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4802
  4803         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4804         16  FILLER                         PIC X.
  4805
  4806         16  CF-ALT-MORT-CODE               PIC X(4).
  4807         16  CF-MEMBER-CAPTION              PIC X(10).
  4808
  4809         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4810             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4811             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4812             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4813             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4814             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4815
  4816         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4817
  4818         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4819         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4820         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4821         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4822
  4823         16  CF-AH-OVERRIDE-L1              PIC X.
  4824         16  CF-AH-OVERRIDE-L2              PIC XX.
  4825         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4826         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4827
  4828         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4829         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4830
  4831         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4832         16  CF-AR-LAST-EL860-DT            PIC XX.
  4833         16  CF-MP-MONTH-END-DT             PIC XX.
  4834
  4835         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4836         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4837             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4838
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  89
* EL131.cbl
  4839         16  CF-AR-MONTH-END-DT             PIC XX.
  4840
  4841         16  CF-CRDTCRD-USER                PIC X.
  4842             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4843             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4844
  4845         16  CF-CC-MONTH-END-DT             PIC XX.
  4846
  4847         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4848
  4849         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4850             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4851             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4852             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4853         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4854         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4855         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4856         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4857             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4858             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4859         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4860         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4861         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4862             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4863         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4864
  4865         16  CF-CL-ZIP-CODE.
  4866             20  CF-CL-ZIP-PRIME.
  4867                 24  CF-CL-ZIP-1ST          PIC X.
  4868                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4869                 24  FILLER                 PIC X(4).
  4870             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4871         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4872             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4873             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4874             20  FILLER                     PIC XXX.
  4875
  4876         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4877         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4878         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4879         16  CF-CO-OPTION-START-DATE        PIC XX.
  4880         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4881           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4882                                                      '3' '4'.
  4883           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4884           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4885           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4886           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4887           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4888           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4889
  4890         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4891
  4892         16  CF-PAYMENT-APPROVAL-LEVELS.
  4893             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4894             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4895             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4896             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  90
* EL131.cbl
  4897             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4898             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4899
  4900         16  CF-END-USER-REPORTING-USER     PIC X.
  4901             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4902             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4903
  4904         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4905             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4906             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4907
  4908         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4909
  4910         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4911         16  FILLER                         PIC X.
  4912
  4913         16  CF-CREDIT-ARCHIVE-CNTL.
  4914             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4915             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4916             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4917
  4918         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4919
  4920         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4921             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4922             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4923
  4924         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4925             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4926             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4927
  4928         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4929
  4930         16  CF-CO-ACH-ID-CODE              PIC  X.
  4931             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4932             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4933             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4934         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4935         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4936         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4937         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4938         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4939         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4940         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4941         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4942         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4943                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4944         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4945                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4946
  4947         16  CF-CO-OVER-SHORT.
  4948             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4949             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4950
  4951*         16  FILLER                         PIC X(102).
  4952         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4953             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4954             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  91
* EL131.cbl
  4955
  4956         16  CF-AH-APPROVAL-DAYS.
  4957             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4958             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4959             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4960             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4961
  4962         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4963
  4964         16  FILLER                         PIC X(79).
  4965****************************************************************
  4966*             PROCESSOR/USER RECORD                            *
  4967****************************************************************
  4968
  4969     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4970         16  CF-PROCESSOR-NAME              PIC X(30).
  4971         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4972         16  CF-PROCESSOR-TITLE             PIC X(26).
  4973         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4974                 88  MESSAGE-YES                VALUE 'Y'.
  4975                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4976
  4977*****************************************************
  4978****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4979****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4980****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4981****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4982*****************************************************
  4983
  4984         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4985             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4986             20  CF-APPLICATION-FORCE       PIC X.
  4987             20  CF-INDIVIDUAL-APP.
  4988                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4989                     28  CF-BROWSE-APP      PIC X.
  4990                     28  CF-UPDATE-APP      PIC X.
  4991
  4992         16  CF-CURRENT-TERM-ON             PIC X(4).
  4993         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4994             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4995             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4996             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4997             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4998             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4999             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5000             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5001         16  CF-PROCESSOR-CARRIER           PIC X.
  5002             88  NO-CARRIER-SECURITY            VALUE ' '.
  5003         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5004             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5005         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5006             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5007         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5008             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5009
  5010         16  CF-PROC-SYS-ACCESS-SW.
  5011             20  CF-PROC-CREDIT-CLAIMS-SW.
  5012                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  92
* EL131.cbl
  5013                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5014                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5015                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5016             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5017                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5018                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5019             20  CF-PROC-LIFE-GNRLDGR-SW.
  5020                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5021                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5022                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5023                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5024             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5025                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5026                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5027         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5028             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5029             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5030         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5031
  5032         16  CF-APPROVAL-LEVEL                  PIC X.
  5033             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5034             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5035             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5036             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5037
  5038         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5039
  5040         16  CF-LANGUAGE-TYPE                   PIC X.
  5041             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5042             88  CF-LANG-IS-FR                      VALUE 'F'.
  5043
  5044         16  CF-CSR-IND                         PIC X.
  5045         16  FILLER                             PIC X(239).
  5046
  5047****************************************************************
  5048*             PROCESSOR/REMINDERS RECORD                       *
  5049****************************************************************
  5050
  5051     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5052         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5053             20  CF-START-REMIND-DT         PIC XX.
  5054             20  CF-END-REMIND-DT           PIC XX.
  5055             20  CF-REMINDER-TEXT           PIC X(50).
  5056         16  FILLER                         PIC X(296).
  5057
  5058
  5059****************************************************************
  5060*             STATE MASTER RECORD                              *
  5061****************************************************************
  5062
  5063     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5064         16  CF-STATE-ABBREVIATION          PIC XX.
  5065         16  CF-STATE-NAME                  PIC X(25).
  5066         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5067         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5068             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5069             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5070             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  93
* EL131.cbl
  5071             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5072                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5073                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5074             20  CF-ST-PREM-REJECT-SW       PIC X.
  5075                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5076                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5077             20  CF-ST-REF-REJECT-SW        PIC X.
  5078                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5079                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5080         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5081         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5082         16  CF-ST-REFUND-RULES.
  5083             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5084             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5085             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5086         16  CF-ST-FST-PMT-EXTENSION.
  5087             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5088             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5089                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5090                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5091                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5092                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5093         16  CF-ST-STATE-CALL.
  5094             20  CF-ST-CALL-UNEARNED        PIC X.
  5095             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5096             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5097         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5098             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5099             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5100         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5101         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5102         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5103         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5104         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5105         16  FILLER                         PIC X.
  5106         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5107             20  CF-ST-BENEFIT-CD           PIC XX.
  5108             20  CF-ST-BENEFIT-KIND         PIC X.
  5109                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5110                 88  CF-ST-AH-KIND              VALUE 'A'.
  5111             20  CF-ST-REM-TERM-CALC        PIC X.
  5112                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5113                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5114                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5115                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5116                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5117                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5118                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5119                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5120
  5121             20  CF-ST-REFUND-CALC          PIC X.
  5122                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5123                 88  ST-REFD-BY-R78             VALUE '1'.
  5124                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5125                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5126                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5127                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5128                 88  ST-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  94
* EL131.cbl
  5129                 88  ST-REFD-UTAH               VALUE '7'.
  5130                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5131                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5132                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5133
  5134             20  CF-ST-EARNING-CALC         PIC X.
  5135                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5136                 88  ST-EARN-BY-R78             VALUE '1'.
  5137                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5138                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5139                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5140                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5141                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5142                 88  ST-EARN-MEAN               VALUE '8'.
  5143                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5144
  5145             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5146                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5147                 88  ST-OVRD-BY-R78             VALUE '1'.
  5148                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5149                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5150                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5151                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5152                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5153                 88  ST-OVRD-MEAN               VALUE '8'.
  5154                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5155             20  FILLER                     PIC X.
  5156
  5157         16  CF-ST-COMMISSION-CAPS.
  5158             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5159             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5160             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5161             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5162         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5163                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5164
  5165         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5166
  5167         16  CF-ST-STATUTORY-INTEREST.
  5168             20  CF-ST-STAT-DATE-FROM       PIC X.
  5169                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5170                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5171             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5172             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5173             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5174             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5175             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5176
  5177         16  CF-ST-OVER-SHORT.
  5178             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5179             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5180
  5181         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5182
  5183         16  CF-ST-RT-CALC                  PIC X.
  5184
  5185         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5186         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  95
* EL131.cbl
  5187         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5188         16  CF-ST-RF-LR-CALC               PIC X.
  5189         16  CF-ST-RF-LL-CALC               PIC X.
  5190         16  CF-ST-RF-LN-CALC               PIC X.
  5191         16  CF-ST-RF-AH-CALC               PIC X.
  5192         16  CF-ST-RF-CP-CALC               PIC X.
  5193*        16  FILLER                         PIC X(206).
  5194*CIDMOD         16  FILLER                         PIC X(192).
  5195         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5196             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5197         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5198         16  CF-ST-VFY-2ND-BENE             PIC X.
  5199         16  CF-ST-CAUSAL-STATE             PIC X.
  5200         16  FILLER                         PIC X(185).
  5201
  5202****************************************************************
  5203*             BENEFIT MASTER RECORD                            *
  5204****************************************************************
  5205
  5206     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5207         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5208             20  CF-BENEFIT-CODE            PIC XX.
  5209             20  CF-BENEFIT-NUMERIC  REDEFINES
  5210                 CF-BENEFIT-CODE            PIC XX.
  5211             20  CF-BENEFIT-ALPHA           PIC XXX.
  5212             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5213             20  CF-BENEFIT-COMMENT         PIC X(10).
  5214
  5215             20  CF-LF-COVERAGE-TYPE        PIC X.
  5216                 88  CF-REDUCING                VALUE 'R'.
  5217                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5218
  5219             20  CF-SPECIAL-CALC-CD         PIC X.
  5220                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5221                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5222                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5223                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5224                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5225                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5226                 88  CF-FARM-PLAN               VALUE 'F'.
  5227                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5228                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5229                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5230                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5231                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5232                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5233                 88  CF-PRUDENTIAL              VALUE 'P'.
  5234                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5235                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5236                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5237                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5238                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5239                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5240
  5241             20  CF-JOINT-INDICATOR         PIC X.
  5242                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5243
  5244*            20  FILLER                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  96
* EL131.cbl
  5245             20  FILLER                     PIC X(11).
  5246             20  CF-BENEFIT-CATEGORY        PIC X.
  5247             20  CF-LOAN-TYPE               PIC X(8).
  5248
  5249             20  CF-CO-REM-TERM-CALC        PIC X.
  5250                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5251                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5252                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5253                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5254                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5255
  5256             20  CF-CO-EARNINGS-CALC        PIC X.
  5257                 88  CO-EARN-BY-R78             VALUE '1'.
  5258                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5259                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5260                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5261                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5262                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5263                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5264                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5265
  5266             20  CF-CO-REFUND-CALC          PIC X.
  5267                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5268                 88  CO-REFD-BY-R78             VALUE '1'.
  5269                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5270                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5271                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5272                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5273                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5274                 88  CO-REFD-MEAN               VALUE '8'.
  5275                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5276                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5277                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5278
  5279             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5280                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5281                 88  CO-OVRD-BY-R78             VALUE '1'.
  5282                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5283                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5284                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5285                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5286                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5287                 88  CO-OVRD-MEAN               VALUE '8'.
  5288                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5289
  5290             20  CF-CO-BEN-I-G-CD           PIC X.
  5291                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5292                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5293                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5294
  5295         16  FILLER                         PIC X(304).
  5296
  5297
  5298****************************************************************
  5299*             CARRIER MASTER RECORD                            *
  5300****************************************************************
  5301
  5302     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  97
* EL131.cbl
  5303         16  CF-ADDRESS-DATA.
  5304             20  CF-MAIL-TO-NAME            PIC X(30).
  5305             20  CF-IN-CARE-OF              PIC X(30).
  5306             20  CF-ADDRESS-LINE-1          PIC X(30).
  5307             20  CF-ADDRESS-LINE-2          PIC X(30).
  5308             20  CF-CITY-STATE              PIC X(30).
  5309             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5310             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5311
  5312         16  CF-CLAIM-NO-CONTROL.
  5313             20  CF-CLAIM-NO-METHOD         PIC X.
  5314                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5315                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5316                 88  CLAIM-NO-SEQ               VALUE '3'.
  5317                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5318             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5319                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5320                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5321                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5322
  5323         16  CF-CHECK-NO-CONTROL.
  5324             20  CF-CHECK-NO-METHOD         PIC X.
  5325                 88  CHECK-NO-MANUAL            VALUE '1'.
  5326                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5327                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5328                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5329             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5330                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5331
  5332         16  CF-DOMICILE-STATE              PIC XX.
  5333
  5334         16  CF-EXPENSE-CONTROLS.
  5335             20  CF-EXPENSE-METHOD          PIC X.
  5336                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5337                 88  DOLLARS-PER-PMT            VALUE '2'.
  5338                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5339                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5340             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5341             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5342
  5343         16  CF-CORRESPONDENCE-CONTROL.
  5344             20  CF-LETTER-RESEND-OPT       PIC X.
  5345                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5346                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5347             20  FILLER                     PIC X(4).
  5348
  5349         16  CF-RESERVE-CONTROLS.
  5350             20  CF-MANUAL-SW               PIC X.
  5351                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5352             20  CF-FUTURE-SW               PIC X.
  5353                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5354             20  CF-PTC-SW                  PIC X.
  5355                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5356             20  CF-IBNR-SW                 PIC X.
  5357                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5358             20  CF-PTC-LF-SW               PIC X.
  5359                 88  CF-LF-PTC-USED             VALUE '1'.
  5360             20  CF-CDT-ACCESS-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  98
* EL131.cbl
  5361                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5362                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5363                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5364             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5365
  5366         16  CF-CLAIM-CALC-METHOD           PIC X.
  5367             88  360-PLUS-MONTHS                VALUE '1'.
  5368             88  365-PLUS-MONTHS                VALUE '2'.
  5369             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5370             88  360-DAILY                      VALUE '4'.
  5371             88  365-DAILY                      VALUE '5'.
  5372
  5373         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5374         16  FILLER                         PIC X(11).
  5375
  5376         16  CF-LIMIT-AMOUNTS.
  5377             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5378             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5379             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5380             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5381             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5382             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5383             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5384             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5385             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5386             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5387
  5388         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5389         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5390         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5391
  5392         16  CF-ZIP-CODE.
  5393             20  CF-ZIP-PRIME.
  5394                 24  CF-ZIP-1ST             PIC X.
  5395                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5396                 24  FILLER                 PIC X(4).
  5397             20  CF-ZIP-PLUS4               PIC X(4).
  5398         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5399             20  CF-CAN-POSTAL-1            PIC XXX.
  5400             20  CF-CAN-POSTAL-2            PIC XXX.
  5401             20  FILLER                     PIC XXX.
  5402
  5403         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5404         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5405         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5406
  5407         16  CF-RATING-SWITCH               PIC X.
  5408             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5409             88  CF-NO-RATING                   VALUE 'N'.
  5410
  5411         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5412
  5413         16  CF-CARRIER-OVER-SHORT.
  5414             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5415             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5416
  5417         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5418         16  CF-SECPAY-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page  99
* EL131.cbl
  5419             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5420             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5421         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5422         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5423         16  FILLER                         PIC X(444).
  5424*        16  FILLER                         PIC X(452).
  5425
  5426
  5427****************************************************************
  5428*             MORTALITY MASTER RECORD                          *
  5429****************************************************************
  5430
  5431     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5432         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5433                                INDEXED BY CF-MORT-NDX.
  5434             20  CF-MORT-TABLE              PIC X(5).
  5435             20  CF-MORT-TABLE-TYPE         PIC X.
  5436                 88  CF-MORT-JOINT              VALUE 'J'.
  5437                 88  CF-MORT-SINGLE             VALUE 'S'.
  5438                 88  CF-MORT-COMBINED           VALUE 'C'.
  5439                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5440                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5441             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5442             20  CF-MORT-AGE-METHOD         PIC XX.
  5443                 88  CF-AGE-LAST                VALUE 'AL'.
  5444                 88  CF-AGE-NEAR                VALUE 'AN'.
  5445             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5446             20  CF-MORT-ADJUSTMENT-DIRECTION
  5447                                            PIC X.
  5448                 88  CF-MINUS                   VALUE '-'.
  5449                 88  CF-PLUS                    VALUE '+'.
  5450             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5451             20  CF-MORT-JOINT-CODE         PIC X.
  5452                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5453             20  CF-MORT-PC-Q               PIC X.
  5454                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5455             20  CF-MORT-TABLE-CODE         PIC X(4).
  5456             20  CF-MORT-COMMENTS           PIC X(15).
  5457             20  FILLER                     PIC X(14).
  5458
  5459         16  FILLER                         PIC X(251).
  5460
  5461
  5462****************************************************************
  5463*             BUSSINESS TYPE MASTER RECORD                     *
  5464****************************************************************
  5465
  5466     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5467* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5468* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5469* AND RECORD 05 IS TYPES 81-99
  5470         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5471             20  CF-BUSINESS-TITLE          PIC  X(19).
  5472             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5473                                            PIC S9V9(4) COMP-3.
  5474             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5475             20  FILLER                     PIC  X.
  5476         16  FILLER                         PIC  X(248).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 100
* EL131.cbl
  5477
  5478
  5479****************************************************************
  5480*             TERMINAL MASTER RECORD                           *
  5481****************************************************************
  5482
  5483     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5484
  5485         16  CF-COMPANY-TERMINALS.
  5486             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5487                                  PIC X(4).
  5488         16  FILLER               PIC X(248).
  5489
  5490
  5491****************************************************************
  5492*             LIFE EDIT MASTER RECORD                          *
  5493****************************************************************
  5494
  5495     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5496         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5497             20  CF-LIFE-CODE-IN            PIC XX.
  5498             20  CF-LIFE-CODE-OUT           PIC XX.
  5499         16  FILLER                         PIC X(248).
  5500
  5501
  5502****************************************************************
  5503*             AH EDIT MASTER RECORD                            *
  5504****************************************************************
  5505
  5506     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5507         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5508             20  CF-AH-CODE-IN              PIC XXX.
  5509             20  CF-AH-CODE-OUT             PIC XX.
  5510         16  FILLER                         PIC X(248).
  5511
  5512
  5513****************************************************************
  5514*             CREDIBILITY TABLES                               *
  5515****************************************************************
  5516
  5517     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5518         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5519                             INDEXED BY CF-CRDB-NDX.
  5520             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5521             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5522             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5523         16  FILLER                         PIC  X(332).
  5524
  5525
  5526****************************************************************
  5527*             REPORT CUSTOMIZATION RECORD                      *
  5528****************************************************************
  5529
  5530     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5531         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5532             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5533             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5534             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 101
* EL131.cbl
  5535**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5536****       A T-TRANSFER.                                   ****
  5537             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5538
  5539         16  FILLER                         PIC XX.
  5540
  5541         16  CF-CARRIER-CNTL-OPT.
  5542             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5543                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5544                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5545             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5546                                            PIC X.
  5547         16  CF-GROUP-CNTL-OPT.
  5548             20  CF-GROUP-OPT-SEQ           PIC 9.
  5549                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5550                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5551             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5552                                            PIC X(6).
  5553         16  CF-STATE-CNTL-OPT.
  5554             20  CF-STATE-OPT-SEQ           PIC 9.
  5555                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5556                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5557             20  CF-STATE-SELECT OCCURS 3 TIMES
  5558                                            PIC XX.
  5559         16  CF-ACCOUNT-CNTL-OPT.
  5560             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5561                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5562                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5563             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5564                                            PIC X(10).
  5565         16  CF-BUS-TYP-CNTL-OPT.
  5566             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5567                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5568                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5569             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5570                                            PIC XX.
  5571         16  CF-LF-TYP-CNTL-OPT.
  5572             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5573                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5574                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5575             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5576                                            PIC XX.
  5577         16  CF-AH-TYP-CNTL-OPT.
  5578             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5579                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5580                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5581             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5582                                            PIC XX.
  5583         16  CF-REPTCD1-CNTL-OPT.
  5584             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5585                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5586                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5587             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5588                                            PIC X(10).
  5589         16  CF-REPTCD2-CNTL-OPT.
  5590             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5591                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5592                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 102
* EL131.cbl
  5593             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5594                                            PIC X(10).
  5595         16  CF-USER1-CNTL-OPT.
  5596             20  CF-USER1-OPT-SEQ           PIC 9.
  5597                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5598                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5599             20  CF-USER1-SELECT OCCURS 3 TIMES
  5600                                            PIC X(10).
  5601         16  CF-USER2-CNTL-OPT.
  5602             20  CF-USER2-OPT-SEQ           PIC 9.
  5603                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5604                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5605             20  CF-USER2-SELECT OCCURS 3 TIMES
  5606                                            PIC X(10).
  5607         16  CF-USER3-CNTL-OPT.
  5608             20  CF-USER3-OPT-SEQ           PIC 9.
  5609                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5610                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5611             20  CF-USER3-SELECT OCCURS 3 TIMES
  5612                                            PIC X(10).
  5613         16  CF-USER4-CNTL-OPT.
  5614             20  CF-USER4-OPT-SEQ           PIC 9.
  5615                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5616                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5617             20  CF-USER4-SELECT OCCURS 3 TIMES
  5618                                            PIC X(10).
  5619         16  CF-USER5-CNTL-OPT.
  5620             20  CF-USER5-OPT-SEQ           PIC 9.
  5621                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5622                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5623             20  CF-USER5-SELECT OCCURS 3 TIMES
  5624                                            PIC X(10).
  5625         16  CF-REINS-CNTL-OPT.
  5626             20  CF-REINS-OPT-SEQ           PIC 9.
  5627                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5628                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5629             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5630                 24  CF-REINS-PRIME         PIC XXX.
  5631                 24  CF-REINS-SUB           PIC XXX.
  5632
  5633         16  CF-AGENT-CNTL-OPT.
  5634             20  CF-AGENT-OPT-SEQ           PIC 9.
  5635                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5636                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5637             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5638                                            PIC X(10).
  5639
  5640         16  FILLER                         PIC X(43).
  5641
  5642         16  CF-LOSS-RATIO-SELECT.
  5643             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5644             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5645         16  CF-ENTRY-DATE-SELECT.
  5646             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5647             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5648         16  CF-EFFECTIVE-DATE-SELECT.
  5649             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5650             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 103
* EL131.cbl
  5651
  5652         16  CF-EXCEPTION-LIST-IND          PIC X.
  5653             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5654
  5655         16  FILLER                         PIC X(318).
  5656
  5657****************************************************************
  5658*                  EXCEPTION REPORTING RECORD                  *
  5659****************************************************************
  5660
  5661     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5662         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5663             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5664
  5665         16  CF-COMBINED-LIFE-AH-OPT.
  5666             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5667             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5668             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5669             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5670
  5671         16  CF-LIFE-OPT.
  5672             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5673             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5674             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5675             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5676             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5677             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5678             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5679             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5680             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5681             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5682
  5683         16  CF-AH-OPT.
  5684             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5685             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5686             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5687             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5688             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5689             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5690             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5691             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5692             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5693             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5694
  5695         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5696             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5697             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5698             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5699
  5700         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5701
  5702         16  FILLER                         PIC X(673).
  5703
  5704
  5705****************************************************************
  5706*             MORTGAGE SYSTEM PLAN RECORD                      *
  5707****************************************************************
  5708
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 104
* EL131.cbl
  5709     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5710         16  CF-PLAN-TYPE                   PIC X.
  5711             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5712             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5713             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5714         16  CF-PLAN-ABBREV                 PIC XXX.
  5715         16  CF-PLAN-DESCRIPT               PIC X(10).
  5716         16  CF-PLAN-NOTES                  PIC X(20).
  5717         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5718         16  CF-PLAN-UNDERWRITING.
  5719             20  CF-PLAN-TERM-DATA.
  5720                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5721                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5722             20  CF-PLAN-AGE-DATA.
  5723                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5724                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5725                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5726             20  CF-PLAN-BENEFIT-DATA.
  5727                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5728                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5729                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5730                                            PIC S9(7)V99  COMP-3.
  5731         16  CF-PLAN-POLICY-FORMS.
  5732             20  CF-POLICY-FORM             PIC X(12).
  5733             20  CF-MASTER-APPLICATION      PIC X(12).
  5734             20  CF-MASTER-POLICY           PIC X(12).
  5735         16  CF-PLAN-RATING.
  5736             20  CF-RATE-CODE               PIC X(5).
  5737             20  CF-SEX-RATING              PIC X.
  5738                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5739                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5740             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5741             20  CF-SUB-STD-TYPE            PIC X.
  5742                 88  CF-PCT-OF-PREM            VALUE '1'.
  5743                 88  CF-PCT-OF-BENE            VALUE '2'.
  5744         16  CF-PLAN-PREM-TOLERANCES.
  5745             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5746             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5747         16  CF-PLAN-PYMT-TOLERANCES.
  5748             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5749             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5750         16  CF-PLAN-MISC-DATA.
  5751             20  FILLER                     PIC X.
  5752             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5753             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5754         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5755         16  CF-PLAN-IND-GRP                PIC X.
  5756             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5757                                                     '1'.
  5758             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5759                                                     '2'.
  5760         16  CF-MIB-SEARCH-SW               PIC X.
  5761             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5762             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5763             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5764             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5765         16  CF-ALPHA-SEARCH-SW             PIC X.
  5766             88  CF-MIB-ALPHA-ALL              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 105
* EL131.cbl
  5767             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5768             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5769             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5770             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5771             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5772             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5773             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5774             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5775             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5776                                                     'A' 'B' 'C'
  5777                                                     'X' 'Y' 'Z'.
  5778         16  CF-EFF-DT-RULE-SW              PIC X.
  5779             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5780             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5781             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5782             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5783             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5784         16  FILLER                         PIC X(4).
  5785         16  CF-HEALTH-QUESTIONS            PIC X.
  5786             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5787         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5788         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5789         16  CF-PLAN-SNGL-JNT               PIC X.
  5790             88  CF-COMBINED-PLAN              VALUE 'C'.
  5791             88  CF-JNT-PLAN                   VALUE 'J'.
  5792             88  CF-SNGL-PLAN                  VALUE 'S'.
  5793         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5794         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5795         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5796         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5797         16  CF-RERATE-CNTL                 PIC  X.
  5798             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5799             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5800             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5801             88  CF-AUTO-RECALC                 VALUE '4'.
  5802         16  CF-BENEFIT-TYPE                PIC  X.
  5803             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5804             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5805         16  CF-POLICY-FEE                  PIC S999V99
  5806                                                    COMP-3.
  5807         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5808         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5809         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5810         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5811         16  FILLER                         PIC  X(32).
  5812         16  CF-TERMINATION-FORM            PIC  X(04).
  5813         16  FILLER                         PIC  X(08).
  5814         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5815                                                       COMP-3.
  5816         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5817         16  CF-ISSUE-LETTER                PIC  X(4).
  5818         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5819         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5820             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5821             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5822         16  CF-MP-REFUND-CALC              PIC X.
  5823             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5824             88  CF-MP-REFD-BY-R78              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 106
* EL131.cbl
  5825             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5826             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5827             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5828             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5829             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5830             88  CF-MP-REFD-MEAN                VALUE '8'.
  5831         16  CF-ALT-RATE-CODE               PIC  X(5).
  5832
  5833
  5834         16  FILLER                         PIC X(498).
  5835****************************************************************
  5836*             MORTGAGE COMPANY MASTER RECORD                   *
  5837****************************************************************
  5838
  5839     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5840         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5841         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5842             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5843             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5844             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5845             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5846             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5847
  5848         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5849         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5850         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5851         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5852         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5853
  5854         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5855             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5856         16  CF-MP-RECON-USE-IND            PIC X(1).
  5857             88  CF-MP-USE-RECON             VALUE 'Y'.
  5858         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5859             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5860         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5861             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5862             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5863         16  FILLER                         PIC X(1).
  5864         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5865             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5866         16  CF-MORTG-MIB-VERSION           PIC X.
  5867             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5868             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5869             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5870         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5871             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5872                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5873             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5874                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5875             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5876                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5877             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5878                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5879             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5880                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5881             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5882                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 107
* EL131.cbl
  5883         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5884         16  FILLER                         PIC X(7).
  5885         16  CF-MORTG-DESTINATION-SYMBOL.
  5886             20  CF-MORTG-MIB-COMM          PIC X(5).
  5887             20  CF-MORTG-MIB-TERM          PIC X(5).
  5888         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5889             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5890         16  FILLER                         PIC X(03).
  5891         16  CF-MP-CHECK-NO-CONTROL.
  5892             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5893                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5894                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5895                                                ' ' LOW-VALUES.
  5896                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5897                                               VALUE '3'.
  5898         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5899         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5900         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5901             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5902                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5903             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5904                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5905             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5906                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5907             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5908                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5909             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5910                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5911             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5912                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5913         16  CF-MORTG-BILLING-AREA.
  5914             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5915                                            PIC X.
  5916         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5917         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5918         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5919         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5920             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5921             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5922         16  FILLER                         PIC X.
  5923         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5924             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5925             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5926         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5927         16  FILLER                         PIC X(8).
  5928         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5929         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5930         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5931         16  CF-ACH-COMPANY-ID.
  5932             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5933                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5934                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5935                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5936             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5937         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5938             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5939         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5940             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 108
* EL131.cbl
  5941             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5942         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5943         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5944         16  FILLER                         PIC X(536).
  5945
  5946****************************************************************
  5947*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5948****************************************************************
  5949
  5950     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5951         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5952             20  CF-FEMALE-HEIGHT.
  5953                 24  CF-FEMALE-FT           PIC 99.
  5954                 24  CF-FEMALE-IN           PIC 99.
  5955             20  CF-FEMALE-MIN-WT           PIC 999.
  5956             20  CF-FEMALE-MAX-WT           PIC 999.
  5957         16  FILLER                         PIC X(428).
  5958
  5959     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5960         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5961             20  CF-MALE-HEIGHT.
  5962                 24  CF-MALE-FT             PIC 99.
  5963                 24  CF-MALE-IN             PIC 99.
  5964             20  CF-MALE-MIN-WT             PIC 999.
  5965             20  CF-MALE-MAX-WT             PIC 999.
  5966         16  FILLER                         PIC X(428).
  5967******************************************************************
  5968*             AUTOMATIC ACTIVITY RECORD                          *
  5969******************************************************************
  5970     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5971         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5972             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5973             20  CF-SYS-LETTER-ID           PIC X(04).
  5974             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5975             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5976             20  CF-SYS-RESET-SW            PIC X(01).
  5977             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5978             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5979
  5980         16  FILLER                         PIC X(50).
  5981
  5982         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5983             20  CF-USER-ACTIVE-SW          PIC X(01).
  5984             20  CF-USER-LETTER-ID          PIC X(04).
  5985             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5986             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5987             20  CF-USER-RESET-SW           PIC X(01).
  5988             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5989             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5990             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5991
  5992         16  FILLER                         PIC X(246).
  5993
  5994*                                COPY ELCACTQ.
  5995******************************************************************
  5996*                                                                *
  5997*                            ELCACTQ.                            *
  5998*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 109
* EL131.cbl
  5999*                            VMOD=2.004                          *
  6000*                                                                *
  6001*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6002*                                                                *
  6003*   FILE TYPE = VSAM,KSDS                                        *
  6004*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6005*                                                                *
  6006*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6007*       ALTERNATE INDEX = NONE                                   *
  6008*                                                                *
  6009*   LOG = YES                                                    *
  6010*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6011*                                                                *
  6012*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6013******************************************************************
  6014
  6015 01  ACTIVITY-QUE.
  6016     12  AQ-RECORD-ID                PIC XX.
  6017         88  VALID-AQ-ID                VALUE 'AQ'.
  6018
  6019     12  AQ-CONTROL-PRIMARY.
  6020         16  AQ-COMPANY-CD           PIC X.
  6021         16  AQ-CARRIER              PIC X.
  6022         16  AQ-CLAIM-NO             PIC X(7).
  6023         16  AQ-CERT-NO.
  6024             20  AQ-CERT-PRIME       PIC X(10).
  6025             20  AQ-CERT-SFX         PIC X.
  6026
  6027     12  AQ-PENDING-ACTIVITY-FLAGS.
  6028         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6029         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6030             88  PENDING-PAYMENTS       VALUE '1'.
  6031         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6032             88  PENDING-FULL-PRINT     VALUE '1'.
  6033             88  PENDING-PART-PRINT     VALUE '2'.
  6034         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6035             88  PENDING-LETTERS        VALUE '1'.
  6036         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6037             88  PENDING-RESTORE        VALUE 'C'.
  6038             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6039
  6040     12  FILLER                      PIC X(20).
  6041
  6042     12  AQ-RESEND-DATE              PIC XX.
  6043     12  AQ-FOLLOWUP-DATE            PIC XX.
  6044     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6045     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6046     12  AQ-AUTO-LETTER              PIC X(4).
  6047     12  FILLER                      PIC XX.
  6048     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6049*****************************************************************
  6050
  6051*                                COPY ERCACCT.
  6052******************************************************************
  6053*                                                                *
  6054*                                                                *
  6055*                            ERCACCT                             *
  6056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 110
* EL131.cbl
  6057*                            VMOD=2.031                          *
  6058*                                                                *
  6059*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6060*                                                                *
  6061*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6062*   VSAM ACCOUNT MASTER FILES.                                   *
  6063*                                                                *
  6064*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6065*                                                                *
  6066*   FILE TYPE = VSAM,KSDS                                        *
  6067*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6068*                                                                *
  6069*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6070*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6071*                                                                *
  6072*   LOG = NO                                                     *
  6073*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6074*                                                                *
  6075*                                                                *
  6076******************************************************************
  6077*                   C H A N G E   L O G
  6078*
  6079* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6080*-----------------------------------------------------------------
  6081*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6082* EFFECTIVE    NUMBER
  6083*-----------------------------------------------------------------
  6084* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6085* 092705    2005050300006  PEMA  ADD SPP LEASES
  6086* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6087* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6088* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6089* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6090* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6091******************************************************************
  6092
  6093 01  ACCOUNT-MASTER.
  6094     12  AM-RECORD-ID                      PIC XX.
  6095         88  VALID-AM-ID                      VALUE 'AM'.
  6096
  6097     12  AM-CONTROL-PRIMARY.
  6098         16  AM-COMPANY-CD                 PIC X.
  6099         16  AM-MSTR-CNTRL.
  6100             20  AM-CONTROL-A.
  6101                 24  AM-CARRIER            PIC X.
  6102                 24  AM-GROUPING.
  6103                     28 AM-GROUPING-PREFIX PIC XXX.
  6104                     28 AM-GROUPING-PRIME  PIC XXX.
  6105                 24  AM-STATE              PIC XX.
  6106                 24  AM-ACCOUNT.
  6107                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6108                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6109             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6110                                           PIC X(19).
  6111             20  AM-CNTRL-B.
  6112                 24  AM-EXPIRATION-DT      PIC XX.
  6113                 24  FILLER                PIC X(4).
  6114             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 111
* EL131.cbl
  6115                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6116
  6117     12  AM-CONTROL-BY-VAR-GRP.
  6118         16  AM-COMPANY-CD-A1              PIC X.
  6119         16  AM-VG-CARRIER                 PIC X.
  6120         16  AM-VG-GROUPING                PIC X(6).
  6121         16  AM-VG-STATE                   PIC XX.
  6122         16  AM-VG-ACCOUNT                 PIC X(10).
  6123         16  AM-VG-DATE.
  6124             20  AM-VG-EXPIRATION-DT       PIC XX.
  6125             20  FILLER                    PIC X(4).
  6126         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6127                                           PIC 9(11)      COMP-3.
  6128     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6129         16  FILLER                        PIC X(10).
  6130         16  AM-VG-KEY3.
  6131             20  AM-VG3-ACCOUNT            PIC X(10).
  6132             20  AM-VG3-EXP-DT             PIC XX.
  6133         16  FILLER                        PIC X(4).
  6134     12  AM-MAINT-INFORMATION.
  6135         16  AM-LAST-MAINT-DT              PIC XX.
  6136         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6137         16  AM-LAST-MAINT-USER            PIC X(4).
  6138         16  FILLER                        PIC XX.
  6139
  6140     12  AM-EFFECTIVE-DT                   PIC XX.
  6141     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6142
  6143     12  AM-PREV-DATES  COMP-3.
  6144         16  AM-PREV-EXP-DT                PIC 9(11).
  6145         16  AM-PREV-EFF-DT                PIC 9(11).
  6146
  6147     12  AM-REPORT-CODE-1                  PIC X(10).
  6148     12  AM-REPORT-CODE-2                  PIC X(10).
  6149
  6150     12  AM-CITY-CODE                      PIC X(4).
  6151     12  AM-COUNTY-PARISH                  PIC X(6).
  6152
  6153     12  AM-NAME                           PIC X(30).
  6154     12  AM-PERSON                         PIC X(30).
  6155     12  AM-ADDRS                          PIC X(30).
  6156     12  AM-CITY.
  6157         16  AM-ADDR-CITY                  PIC X(28).
  6158         16  AM-ADDR-STATE                 PIC XX.
  6159     12  AM-ZIP.
  6160         16  AM-ZIP-PRIME.
  6161             20  AM-ZIP-PRI-1ST            PIC X.
  6162                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6163             20  FILLER                    PIC X(4).
  6164         16  AM-ZIP-PLUS4                  PIC X(4).
  6165     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6166         16  AM-CAN-POSTAL-1               PIC XXX.
  6167         16  AM-CAN-POSTAL-2               PIC XXX.
  6168         16  FILLER                        PIC XXX.
  6169     12  AM-TEL-NO.
  6170         16  AM-AREA-CODE                  PIC 999.
  6171         16  AM-TEL-PRE                    PIC 999.
  6172         16  AM-TEL-NBR                    PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 112
* EL131.cbl
  6173     12  AM-TEL-LOC                        PIC X.
  6174         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6175         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6176
  6177     12  AM-COMM-STRUCTURE.
  6178         16  AM-DEFN-1.
  6179             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6180                 24  AM-AGT.
  6181                     28  AM-AGT-PREFIX     PIC X(4).
  6182                     28  AM-AGT-PRIME      PIC X(6).
  6183                 24  AM-COM-TYP            PIC X.
  6184                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6185                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6186                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6187                 24  AM-RECALC-LV-INDIC    PIC X.
  6188                 24  AM-RETRO-LV-INDIC     PIC X.
  6189                 24  AM-GL-CODES           PIC X.
  6190                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6191                 24  FILLER                PIC X(01).
  6192         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6193             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6194                 24  FILLER                PIC X(11).
  6195                 24  AM-L-COMA             PIC XXX.
  6196                 24  AM-J-COMA             PIC XXX.
  6197                 24  AM-A-COMA             PIC XXX.
  6198                 24  FILLER                PIC X(6).
  6199
  6200     12  AM-COMM-CHANGE-STATUS             PIC X.
  6201         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6202
  6203     12  AM-CSR-CODE                       PIC X(4).
  6204
  6205     12  AM-BILLING-STATUS                 PIC X.
  6206         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6207         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6208     12  AM-AUTO-REFUND-SW                 PIC X.
  6209         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6210         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6211     12  AM-GPCD                           PIC 99.
  6212     12  AM-IG                             PIC X.
  6213         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6214         88  AM-HAS-GROUP                     VALUE '2'.
  6215     12  AM-STATUS                         PIC X.
  6216         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6217         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6218         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6219         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6220         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6221         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6222     12  AM-REMIT-TO                       PIC 99.
  6223     12  AM-ID-NO                          PIC X(11).
  6224
  6225     12  AM-CAL-TABLE                      PIC XX.
  6226     12  AM-LF-DEVIATION                   PIC XXX.
  6227     12  AM-AH-DEVIATION                   PIC XXX.
  6228     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6229     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6230     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 113
* EL131.cbl
  6231     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6232     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6233     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6234
  6235     12  AM-USER-FIELDS.
  6236         16  AM-FLD-1                      PIC XX.
  6237         16  AM-FLD-2                      PIC XX.
  6238         16  AM-FLD-3                      PIC XX.
  6239         16  AM-FLD-4                      PIC XX.
  6240         16  AM-FLD-5                      PIC XX.
  6241
  6242     12  AM-1ST-PROD-DATE.
  6243         16  AM-1ST-PROD-YR                PIC XX.
  6244         16  AM-1ST-PROD-MO                PIC XX.
  6245         16  AM-1ST-PROD-DA                PIC XX.
  6246     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6247     12  AM-CERTS-PURGED-DATE.
  6248         16  AM-PUR-YR                     PIC XX.
  6249         16  AM-PUR-MO                     PIC XX.
  6250         16  AM-PUR-DA                     PIC XX.
  6251     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6252     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6253     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6254     12  AM-INACTIVE-DATE.
  6255         16  AM-INA-MO                     PIC 99.
  6256         16  AM-INA-DA                     PIC 99.
  6257         16  AM-INA-YR                     PIC 99.
  6258     12  AM-AR-HI-CERT-DATE                PIC XX.
  6259
  6260     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6261     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6262
  6263     12  AM-OB-PAYMENT-MODE                PIC X.
  6264         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6265         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6266         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6267         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6268
  6269     12  AM-AH-ONLY-INDICATOR              PIC X.
  6270         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6271         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6272
  6273     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6274
  6275     12  AM-OVER-SHORT.
  6276         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6277         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6278
  6279     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6280     12  AM-DCC-CLP-STATE                  PIC XX.
  6281
  6282     12  AM-RECALC-COMM                    PIC X.
  6283     12  AM-RECALC-REIN                    PIC X.
  6284
  6285     12  AM-REI-TABLE                      PIC XXX.
  6286     12  AM-REI-ET-LF                      PIC X.
  6287     12  AM-REI-ET-AH                      PIC X.
  6288     12  AM-REI-PE-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 114
* EL131.cbl
  6289     12  AM-REI-PE-AH                      PIC X.
  6290     12  AM-REI-PRT-ST                     PIC X.
  6291     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6292     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6293     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6294     12  AM-REI-GROUP-A                    PIC X(6).
  6295     12  AM-REI-MORT                       PIC X(4).
  6296     12  AM-REI-PRT-OW                     PIC X.
  6297     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6298     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6299     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6300     12  AM-REI-GROUP-B                    PIC X(6).
  6301
  6302     12  AM-TRUST-TYPE                     PIC X(2).
  6303
  6304     12  AM-EMPLOYER-STMT-USED             PIC X.
  6305     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6306
  6307     12  AM-STD-AH-TYPE                    PIC XX.
  6308     12  AM-EARN-METHODS.
  6309         16  AM-EARN-METHOD-R              PIC X.
  6310             88 AM-REF-RL-R78                 VALUE 'R'.
  6311             88 AM-REF-RL-PR                  VALUE 'P'.
  6312             88 AM-REF-RL-MEAN                VALUE 'M'.
  6313             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6314         16  AM-EARN-METHOD-L              PIC X.
  6315             88 AM-REF-LL-R78                 VALUE 'R'.
  6316             88 AM-REF-LL-PR                  VALUE 'P'.
  6317             88 AM-REF-LL-MEAN                VALUE 'M'.
  6318             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6319         16  AM-EARN-METHOD-A              PIC X.
  6320             88 AM-REF-AH-R78                 VALUE 'R'.
  6321             88 AM-REF-AH-PR                  VALUE 'P'.
  6322             88 AM-REF-AH-MEAN                VALUE 'M'.
  6323             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6324             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6325             88 AM-REF-AH-NET                 VALUE 'N'.
  6326
  6327     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6328     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6329     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6330
  6331     12  AM-RET-Y-N                        PIC X.
  6332     12  AM-RET-P-E                        PIC X.
  6333     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6334     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6335     12  AM-RET-GRP                        PIC X(6).
  6336     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6337         16  AM-POOL-PRIME                 PIC XXX.
  6338         16  AM-POOL-SUB                   PIC XXX.
  6339     12  AM-RETRO-EARNINGS.
  6340         16  AM-RET-EARN-R                 PIC X.
  6341         16  AM-RET-EARN-L                 PIC X.
  6342         16  AM-RET-EARN-A                 PIC X.
  6343     12  AM-RET-ST-TAX-USE                 PIC X.
  6344         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6345         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6346     12  AM-RETRO-BEG-EARNINGS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 115
* EL131.cbl
  6347         16  AM-RET-BEG-EARN-R             PIC X.
  6348         16  AM-RET-BEG-EARN-L             PIC X.
  6349         16  AM-RET-BEG-EARN-A             PIC X.
  6350     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6351     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6352
  6353     12  AM-USER-SELECT-OPTIONS.
  6354         16  AM-USER-SELECT-1              PIC X(10).
  6355         16  AM-USER-SELECT-2              PIC X(10).
  6356         16  AM-USER-SELECT-3              PIC X(10).
  6357         16  AM-USER-SELECT-4              PIC X(10).
  6358         16  AM-USER-SELECT-5              PIC X(10).
  6359
  6360     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6361
  6362     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6363
  6364     12  AM-RPT045A-SWITCH                 PIC X.
  6365         88  RPT045A-OFF                   VALUE 'N'.
  6366
  6367     12  AM-INSURANCE-LIMITS.
  6368         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6369         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6370
  6371     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6372         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6373
  6374     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6375         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6376         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6377
  6378     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6379
  6380     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6381     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6382     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6383     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6384     12  AM-DCC-UEF-STATE                  PIC XX.
  6385     12  FILLER                            PIC XXX.
  6386     12  AM-REPORT-CODE-3                  PIC X(10).
  6387*    12  FILLER                            PIC X(22).
  6388
  6389     12  AM-RESERVE-DATE.
  6390         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6391         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6392         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6393
  6394     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6395     12  AM-NOTIFICATION-TYPES.
  6396         16  AM-NOTIF-OF-LETTERS           PIC X.
  6397         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6398         16  AM-NOTIF-OF-REPORTS           PIC X.
  6399         16  AM-NOTIF-OF-STATUS            PIC X.
  6400
  6401     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6402         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6403         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6404         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 116
* EL131.cbl
  6405         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6406
  6407     12  AM-BENEFIT-CONTROLS.
  6408         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6409             20  AM-BENEFIT-CODE           PIC XX.
  6410             20  AM-BENEFIT-TYPE           PIC X.
  6411             20  AM-BENEFIT-REVISION       PIC XXX.
  6412             20  AM-BENEFIT-REM-TERM       PIC X.
  6413             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6414             20  FILLER                    PIC XX.
  6415         16  FILLER                        PIC X(80).
  6416
  6417     12  AM-TRANSFER-DATA.
  6418         16  AM-TRANSFERRED-FROM.
  6419             20  AM-TRNFROM-CARRIER        PIC X.
  6420             20  AM-TRNFROM-GROUPING.
  6421                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6422                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6423             20  AM-TRNFROM-STATE          PIC XX.
  6424             20  AM-TRNFROM-ACCOUNT.
  6425                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6426                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6427             20  AM-TRNFROM-DTE            PIC XX.
  6428         16  AM-TRANSFERRED-TO.
  6429             20  AM-TRNTO-CARRIER          PIC X.
  6430             20  AM-TRNTO-GROUPING.
  6431                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6432                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6433             20  AM-TRNTO-STATE            PIC XX.
  6434             20  AM-TRNTO-ACCOUNT.
  6435                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6436                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6437             20  AM-TRNTO-DTE              PIC XX.
  6438         16  FILLER                        PIC X(10).
  6439
  6440     12  AM-SAVED-REMIT-TO                 PIC 99.
  6441
  6442     12  AM-COMM-STRUCTURE-SAVED.
  6443         16  AM-DEFN-1-SAVED.
  6444             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6445                 24  AM-AGT-SV             PIC X(10).
  6446                 24  AM-COM-TYP-SV         PIC X.
  6447                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6448                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6449                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6450                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6451                 24  FILLER                PIC X.
  6452                 24  AM-GL-CODES-SV        PIC X.
  6453                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6454                 24  FILLER                PIC X.
  6455         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6456             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6457                 24  FILLER                PIC X(11).
  6458                 24  AM-L-COMA-SV          PIC XXX.
  6459                 24  AM-J-COMA-SV          PIC XXX.
  6460                 24  AM-A-COMA-SV          PIC XXX.
  6461                 24  FILLER                PIC X(6).
  6462
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 117
* EL131.cbl
  6463     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6464         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6465            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6466            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6467            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6468
  6469     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6470     12  FILLER                            PIC X(120).
  6471
  6472     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6473         16  AM-CONTROL-NAME               PIC X(30).
  6474         16  AM-EXECUTIVE-ONE.
  6475             20  AM-EXEC1-NAME             PIC X(15).
  6476             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6477                                                          COMP-3.
  6478             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6479                                                          COMP-3.
  6480         16  AM-EXECUTIVE-TWO.
  6481             20  AM-EXEC2-NAME             PIC X(15).
  6482             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6483                                                          COMP-3.
  6484             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6485                                                          COMP-3.
  6486
  6487     12  AM-RETRO-ADDITIONAL-DATA.
  6488         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6489         16  AM-RETRO-PREM-P-E             PIC X.
  6490         16  AM-RETRO-CLMS-P-I             PIC X.
  6491         16  AM-RETRO-RET-BRACKET-LF.
  6492             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6493                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6494                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6495             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6496                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6497                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6498             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6499                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6500                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6501         16  AM-RETRO-RET-BRACKET-AH.
  6502             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6503                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6504                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6505                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6506             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6507                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6508                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6509             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6510                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6511                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6512
  6513     12  AM-COMMENTS.
  6514         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6515
  6516     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6517         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6518         16  AM-FLI-BILLING-CODE           PIC X.
  6519         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6520         16  AM-FLI-UNITED-IDENT           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 118
* EL131.cbl
  6521         16  AM-FLI-INTEREST-LOST-DATA.
  6522             20  AM-FLI-BANK-NO            PIC X(5).
  6523             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6524             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6525             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6526         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6527             20  AM-FLI-AGT                PIC X(9).
  6528             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6529             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6530         16  FILLER                        PIC X(102).
  6531
  6532     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6533         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6534             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6535             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6536             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6537             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6538             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6539         16  FILLER                          PIC X(10).
  6540******************************************************************
  6541
  6542*                                COPY ELCCHKQ.
  6543******************************************************************
  6544*                                                                *
  6545*                                                                *
  6546*                            ELCCHKQ.                            *
  6547*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6548*                            VMOD=2.007                          *
  6549*                                                                *
  6550*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6551*                                                                *
  6552*   FILE TYPE = VSAM,KSDS                                        *
  6553*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6554*                                                                *
  6555*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6556*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6557*                                                                *
  6558*   LOG = YES                                                    *
  6559*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6560******************************************************************
  6561 01  CHECK-QUE.
  6562     12  CQ-RECORD-ID                PIC XX.
  6563         88  VALID-CQ-ID         VALUE 'CQ'.
  6564
  6565     12  CQ-CONTROL-PRIMARY.
  6566         16  CQ-COMPANY-CD           PIC X.
  6567         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6568         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6569
  6570     12  CQ-CONTROL-BY-PAYEE.
  6571         16  CQ-CONTROL-BY-NUMBER.
  6572             20  CQ-COMPANY-CD-A1     PIC X.
  6573             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6574         16  CQ-PAYEE-CARRIER        PIC X.
  6575         16  CQ-PAYEE-GROUPING       PIC X(6).
  6576         16  CQ-PAYEE-STATE          PIC XX.
  6577         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6578         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 119
* EL131.cbl
  6579
  6580     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6581         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6582         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6583         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6584         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6585         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6586         16  FILLER                  PIC X(3).
  6587
  6588     12  CQ-ENTRY-TYPE               PIC X.
  6589             88  CHECK-ON-QUE           VALUE 'Q'.
  6590             88  ALIGNMENT-CHECK        VALUE 'A'.
  6591             88  SPOILED-CHECK          VALUE 'S'.
  6592             88  PAYMENT-ABORTED        VALUE 'X'.
  6593
  6594     12  CQ-CLAIM-MAST-CNTL.
  6595         16  CQ-CARRIER              PIC X.
  6596         16  CQ-CLAIM-NO             PIC X(7).
  6597         16  CQ-CERT-NO.
  6598             20  CQ-CERT-PRIME       PIC X(10).
  6599             20  CQ-CERT-SFX         PIC X.
  6600         16  CQ-CLAIM-TYPE           PIC X.
  6601             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6602             88  CQ-AH-CLAIM            VALUE 'A'.
  6603         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6604             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6605             88  CQ-O-B-COVERAGE        VALUE '2'.
  6606             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6607
  6608     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6609     12  CQ-CHECK-NUMBER             PIC X(7).
  6610     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6611     12  CQ-PAYMENT-TYPE             PIC X.
  6612             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6613             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6614             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6615             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6616             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6617             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6618             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6619             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6620     12  CQ-VOID-INDICATOR           PIC X.
  6621             88  CHECK-IS-STOPPED          VALUE 'S'.
  6622             88  CHECK-IS-VOID             VALUE 'V'.
  6623     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6624     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6625     12  CQ-CHECK-BY-USER            PIC X(4).
  6626     12  CQ-PRE-NUMBERING-SW         PIC X.
  6627       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6628       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6629
  6630     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6631     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6632     12  CQ-LEDGER-FLAG              PIC X(01).
  6633     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6634     12  CQ-LAST-UPDATED-DT          PIC XX.
  6635     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6636     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 120
* EL131.cbl
  6637
  6638     12  FILLER                      PIC X(04).
  6639
  6640******************************************************************
  6641
  6642*                                COPY ELCARCH.
  6643******************************************************************
  6644*                                                                *
  6645*                            ELCARCH.                            *
  6646*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6647*                            VMOD=2.007                          *
  6648*                                                                *
  6649*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6650*                                                                *
  6651*   FILE TYPE = VSAM,KSDS                                        *
  6652*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6653*                                                                *
  6654*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6655*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6656*                                                                *
  6657*   LOG = NO                                                     *
  6658*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6659*                                                                *
  6660*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6661******************************************************************
  6662 01  LETTER-ARCHIVE.
  6663     12  LA-RECORD-ID                PIC XX.
  6664         88  VALID-LA-ID                VALUE 'LA'.
  6665
  6666     12  LA-CONTROL-PRIMARY.
  6667         16  LA-COMPANY-CD           PIC X.
  6668         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6669         16  LA-RECORD-TYPE          PIC X.
  6670             88  LA-HEADER-DATA         VALUE '1'.
  6671             88  LA-ADDRESS-DATA        VALUE '2'.
  6672             88  LA-TEXT-DATA           VALUE '3'.
  6673             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6674         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6675
  6676     12  LA-CONTROL-BY-TYPE.
  6677         16  LA-COMPANY-CD-A1        PIC X.
  6678         16  LA-RECORD-TYPE-A1       PIC X.
  6679         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6680         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6681
  6682     12  LA-TEXT-RECORD.
  6683         16  LA-SKIP-CONTROL         PIC XX.
  6684             88  NO-LINES-SKIPPED       VALUE SPACES.
  6685             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6686         16  LA-TEXT-LINE            PIC X(70).
  6687
  6688     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6689         16  FILLER                  PIC XX.
  6690         16  LA-ADDRESS-LINE         PIC X(30).
  6691         16  FILLER                  PIC X(40).
  6692
  6693     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6694         16  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 121
* EL131.cbl
  6695         16  LA-CARRIER              PIC X.
  6696         16  LA-CLAIM-NO             PIC X(7).
  6697         16  LA-CERT-NO.
  6698             20  LA-CERT-PRIME       PIC X(10).
  6699             20  LA-CERT-SFX         PIC X.
  6700         16  LA-NO-OF-COPIES         PIC S9.
  6701         16  LA-RESEND-DATE          PIC XX.
  6702         16  LA-PROCESSOR-CD         PIC X(4).
  6703         16  LA-CREATION-DT          PIC XX.
  6704         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6705         16  LA-RESEND-PRINT-DATE    PIC XX.
  6706         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6707         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6708*
  6709* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6710*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6711*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6712*   I        20  LA-DMD-RES-ST           PIC XX.
  6713*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6714*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6715*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6716*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6717*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6718*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6719*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6720*   I        20  LA-DMD-UND-CODE         PIC XX.
  6721*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6722*   V    16  FILLER                  PIC X(15).
  6723* -----
  6724*
  6725* REINSERTED  CSO  MODS
  6726*
  6727         16  FILLER.
  6728             20  FILLER                  PIC X(29).
  6729             20  LA-CSO-LETTER-STATUS    PIC X.
  6730                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6731                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6732                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6733             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6734             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6735*
  6736
  6737     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6738         16  FILLER                  PIC XX.
  6739         16  LA4-CARRIER             PIC X.
  6740         16  LA4-CLAIM-NO            PIC X(7).
  6741         16  LA4-CERT-NO.
  6742             20  LA4-CERT-PRIME      PIC X(10).
  6743             20  LA4-CERT-SFX        PIC X.
  6744         16  LA4-NO-OF-COPIES        PIC S9.
  6745         16  LA4-RESEND-DATE         PIC XX.
  6746         16  LA4-PROCESSOR-CD        PIC X(4).
  6747         16  LA4-CREATION-DT         PIC XX.
  6748         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6749         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6750         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6751         16  LA4-FORM-TYPE           PIC X.
  6752             88  LA4-INITIAL-FORM    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 122
* EL131.cbl
  6753             88  LA4-PROGRESS-FORM   VALUE '2'.
  6754         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6755         16  LA4-STATE               PIC X(02).
  6756         16  FILLER                  PIC X(31).
  6757******************************************************************
  6758
  6759*                                COPY ELCBENE.
  6760******************************************************************
  6761*                                                                *
  6762*                            ELCBENE.                            *
  6763*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6764*                            VMOD=2.006                          *
  6765*                                                                *
  6766*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6767*                                                                *
  6768*   FILE TYPE = VSAM,KSDS                                        *
  6769*   RECORD SIZE = 500   RECFORM = FIX                            *
  6770*                                                                *
  6771*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6772*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6773*                                                                *
  6774*   LOG = YES                                                    *
  6775*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6776*                                                                *
  6777*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6778******************************************************************
  6779
  6780 01  BENEFICIARY-MASTER.
  6781     12  BE-RECORD-ID                PIC XX.
  6782         88  VALID-BE-ID                VALUE 'BE'.
  6783
  6784     12  BE-CONTROL-PRIMARY.
  6785         16  BE-COMPANY-CD           PIC X.
  6786         16  BE-RECORD-TYPE          PIC X.
  6787             88  BENEFICIARY-RECORD  VALUE 'B'.
  6788             88  ADJUSTOR-RECORD     VALUE 'A'.
  6789         16  BE-BENEFICIARY          PIC X(10).
  6790     12  BE-CONTROL-BY-NAME.
  6791         16  BE-COMPANY-CD-A1        PIC X.
  6792         16  BE-RECORD-TYPE-A1       PIC X.
  6793         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6794         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6795
  6796     12  BE-LAST-MAINT-DT            PIC XX.
  6797     12  BE-LAST-MAINT-BY            PIC X(4).
  6798     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6799
  6800     12  BE-ADDRESS-DATA.
  6801         16  BE-MAIL-TO-NAME         PIC X(30).
  6802         16  BE-ADDRESS-LINE-1       PIC X(30).
  6803         16  BE-ADDRESS-LINE-2       PIC X(30).
  6804         16  BE-ADDRESS-LINE-3       PIC X(30).
  6805         16  BE-CITY-STATE.
  6806             20  BE-CITY             PIC X(28).
  6807             20  BE-STATE            PIC XX.
  6808         16  BE-ZIP-CODE.
  6809             20  BE-ZIP-PRIME.
  6810                 24  BE-ZIP-1ST      PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 123
* EL131.cbl
  6811                     88  BE-CANADIAN-POST-CODE
  6812                                         VALUE 'A' THRU 'Z'.
  6813                 24  FILLER          PIC X(4).
  6814             20  BE-ZIP-PLUS4        PIC X(4).
  6815         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6816             20  BE-CAN-POSTAL-1     PIC XXX.
  6817             20  BE-CAN-POSTAL-2     PIC XXX.
  6818             20  FILLER              PIC XXX.
  6819         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6820         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6821
  6822******************************************************************
  6823*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6824*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6825******************************************************************
  6826     12  BE-CARRIER                  PIC X.
  6827
  6828     12  BE-ADDRESS-DATA2.
  6829         16  BE-MAIL-TO-NAME2        PIC X(30).
  6830         16  BE-ADDRESS-LINE-12      PIC X(30).
  6831         16  BE-ADDRESS-LINE-22      PIC X(30).
  6832         16  BE-ADDRESS-LINE-32      PIC X(30).
  6833         16  BE-CITY-STATE2.
  6834             20  BE-CITY2            PIC X(28).
  6835             20  BE-STATE2           PIC XX.
  6836         16  BE-ZIP-CODE2.
  6837             20  BE-ZIP-PRIME2.
  6838                 24  BE-ZIP-1ST2     PIC X.
  6839                     88  BE-CANADIAN-POST-CODE2
  6840                                         VALUE 'A' THRU 'Z'.
  6841                 24  FILLER          PIC X(4).
  6842             20  BE-ZIP-PLUS42       PIC X(4).
  6843         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6844             20  BE-CAN-POSTAL-12    PIC XXX.
  6845             20  BE-CAN-POSTAL-22    PIC XXX.
  6846             20  FILLER              PIC XXX.
  6847         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6848         16  BE-BILLING-STMT-DATA.
  6849             20  BE-BSR              PIC X.
  6850                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6851                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6852             20  BE-BSR-FROM         PIC X(30).
  6853             20  BE-BSR-DEPT         PIC X(30).
  6854             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6855             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6856             20  BE-OUTPUT-TYPE      PIC X.
  6857                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6858                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6859
  6860     12  FILLER                      PIC X(28).
  6861******************************************************************
  6862
  6863*                                COPY ELCDAR.
  6864******************************************************************
  6865*                                                                *
  6866*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6867*   FILE TYPE = VSAM,KSDS                                        *
  6868*   RECORD SIZE = 25   RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 124
* EL131.cbl
  6869*   BASE CLUSTER = DLYACTV                                       *
  6870*   LOG = YES                                                    *
  6871*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6872*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6873*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6874*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6875*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6876*               BY PROGRAM "LGINFCE".                            *
  6877*                                                                *
  6878******************************************************************
  6879 01  DAILY-ACTIVITY-RECORD.
  6880     05  DA-KEY.
  6881         10  DA-COMP-CD          PIC X.
  6882         10  DA-CARRIER          PIC X.
  6883         10  DA-CLAIM-NO         PIC X(7).
  6884         10  DA-CERT-NO.
  6885             15  DA-CERT-PRIME   PIC X(10).
  6886             15  DA-CERT-SFX     PIC X.
  6887     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6888     05  DA-RECORD-TYPE          PIC X.
  6889     05  FILLER                  PIC X(2).
  6890******************************************************************
  6891
  6892*                                COPY ELCALPH.
  6893******************************************************************
  6894*                                                                *
  6895*                            ELCALPH.                            *
  6896*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6897*                            VMOD=2.003                          *
  6898*                                                                *
  6899*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  6900*                                                                *
  6901*   FILE TYPE = VSAM,KSDS                                        *
  6902*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6903*                                                                *
  6904*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6905*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6906*                                                                *
  6907*   LOG = YES                                                    *
  6908*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6909*                                                                *
  6910*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  6911******************************************************************
  6912
  6913 01  ALPHA-INDEX.
  6914     12  AI-RECORD-ID                         PIC XX.
  6915         88  VALID-AI-ID                  VALUE 'AI'.
  6916     12  AI-CONTROL-PRIMARY.
  6917         16  AI-COMPANY-CD                     PIC X.
  6918         16  AI-SOURCE                         PIC X.
  6919             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  6920             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  6921         16  AI-NAME.
  6922             20  AI-LAST-NAME                  PIC X(15).
  6923             20  AI-FIRST-NAME.
  6924                 24  AI-FIRST-INITIAL          PIC X.
  6925                 24  FILLER                    PIC X(11).
  6926             20  AI-MIDDLE-INIT                PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 125
* EL131.cbl
  6927         16  AI-DATE                           PIC X(8).
  6928         16  AI-TIME                           PIC S9(07) COMP-3.
  6929
  6930     12  AI-CONTROL-BY-ADMIN-KEY.
  6931         16  AI-CM-COMPANY-CD                  PIC X.
  6932         16  AI-CM-SOURCE                      PIC X.
  6933         16  AI-CM-CARRIER                     PIC X.
  6934         16  AI-CM-GROUPING.
  6935             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  6936             20  AI-CM-GROUPING-PRIME          PIC X(3).
  6937         16  AI-CM-STATE                       PIC XX.
  6938         16  AI-CM-PRODUCER.
  6939             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  6940             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  6941         16  AI-CM-CERT-EFF-DT                 PIC XX.
  6942         16  AI-CM-CERTIFICATE-NUMBER.
  6943             20  AI-CM-CERT-PRIME              PIC X(10).
  6944             20  AI-CM-CERT-SFX                PIC X.
  6945         16  AI-CM-DATE                        PIC X(8).
  6946         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  6947         16  FILLER                            PIC X(11).
  6948
  6949     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  6950         AI-CONTROL-BY-ADMIN-KEY.
  6951         16  AI-CL-COMPANY-CD                  PIC X.
  6952         16  AI-CL-SOURCE                      PIC X.
  6953         16  AI-CL-CARRIER                     PIC X.
  6954         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  6955         16  AI-CL-CERTIFICATE-NUMBER.
  6956             20  AI-CL-CERT-PRIME              PIC X(10).
  6957             20  AI-CL-CERT-SFX                PIC X.
  6958         16  AI-CL-DATE                        PIC X(8).
  6959         16  AI-CL-INCURRED-DATE               PIC XX.
  6960         16  AI-CL-CLOSE-DATE                  PIC XX.
  6961         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  6962         16  AI-CREDIT-CARD-NUMBER.
  6963             20  AI-CCN.
  6964                 24  AI-CCN-PREFIX             PIC X(4).
  6965                 24  AI-CCN-PRIME              PIC X(12).
  6966             20  AI-CCN-FILLER                 PIC X(4).
  6967
  6968     12  AI-MAINT-INFO.
  6969         16  AI-LAST-MAINT-BY                  PIC X(4).
  6970         16  AI-LAST-MAINT-DT                  PIC XX.
  6971         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6972
  6973     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  6974
  6975     12  FILLER                                PIC X(15).
  6976
  6977
  6978*                                COPY ERCDMDNT.
  6979******************************************************************
  6980*                                                                *
  6981*                            ERCDMDNT                            *
  6982*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6983*                            VMOD=2.005                          *
  6984*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 126
* EL131.cbl
  6985*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  6986*                                                                *
  6987*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  6988*                                                                *
  6989*        FILE TYPE= VSAM,KSDS                                    *
  6990*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6991*                                                                *
  6992*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6993*                                                                *
  6994*        LOG = YES                                               *
  6995*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6996*                                                                *
  6997******************************************************************
  6998
  6999 01  CERTIFICATE-NOTE.
  7000     12  CN-RECORD-ID                     PIC  XX.
  7001         88  VALID-CN-ID                      VALUE 'CN'.
  7002
  7003     12  CN-CONTROL-PRIMARY.
  7004         16  CN-COMPANY-CD                PIC X.
  7005         16  CN-CERT-KEY.
  7006             20  CN-CARRIER               PIC X.
  7007             20  CN-GROUPING.
  7008                 24  CN-GROUPING-PREFIX   PIC XXX.
  7009                 24  CN-GROUPING-PRIME    PIC XXX.
  7010             20  CN-STATE                 PIC XX.
  7011             20  CN-ACCOUNT.
  7012                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7013                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7014             20  CN-CERT-EFF-DT           PIC XX.
  7015             20  CN-CERT-NO.
  7016                 24  CN-CERT-PRIME        PIC X(10).
  7017                 24  CN-CERT-SFX          PIC X.
  7018
  7019     12  CN-BILLING-START-LINE-NO         PIC 99.
  7020     12  CN-BILLING-END-LINE-NO           PIC 99.
  7021
  7022     12  CN-LINES.
  7023         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7024
  7025     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7026         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7027         16  CN-CSI-GENERAL-DATA-AREA.
  7028             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7029
  7030         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7031             CN-CSI-GENERAL-DATA-AREA.
  7032             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7033             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7034             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7035             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7036             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7037             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7038             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7039             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7040             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7041             20  FILLER                       PIC XX.
  7042             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 127
* EL131.cbl
  7043             20  FILLER                       PIC X(38).
  7044
  7045         16  CN-CSI-PRODUCT-DATA-AREA.
  7046             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7047
  7048         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7049             CN-CSI-PRODUCT-DATA-AREA.
  7050             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7051             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7052             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7053             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7054             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7055             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7056             20  FILLER                   PIC XX.
  7057             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7058             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7059             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7060             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7061             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7062             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7063             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7064             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7065             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7066             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7067             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7068             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7069             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7070             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7071             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7072             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7073             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7074             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7075             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7076             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7077             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7078             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7079             20  FILLER                   PIC X(25).
  7080
  7081         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7082             CN-CSI-CREDIT-CARD-DATA.
  7083             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7084             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7085             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7086             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7087             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7088             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7089             20  FILLER                   PIC XX.
  7090             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7091             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7092             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7093             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7094             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7095             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7096             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7097             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7098             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7099             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7100             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 128
* EL131.cbl
  7101             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7102             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7103             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7104             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7105             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7106             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7107             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7108             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7109             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7110             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7111             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7112             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7113             20  FILLER                   PIC X(17).
  7114
  7115         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7116             CN-CSI-FAMILY-LEAVE-DATA.
  7117             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7118             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7119             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7120             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7121             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7122             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7123             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7124             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7125             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7126             20  CN-CSI-SL-INT-ON-PROCEEDS
  7127                                          PIC S9(5)V99  COMP-3.
  7128             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7129             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7130             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7131             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7132             20  CN-CSI-SL-POLICY-BENEFITS
  7133                                          PIC S9(5)V99  COMP-3.
  7134             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7135             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7136             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7137             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7138             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7139             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7140             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7141             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7142             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7143             20  CN-CSI-SL-STATE-NOT      PIC X.
  7144             20  FILLER                   PIC XX.
  7145
  7146         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7147             CN-CSI-SENIOR-LIFE-DATA.
  7148             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7149             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7150             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7151                                          PIC S9(5)V99  COMP-3.
  7152             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7153             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7154             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7155             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7156             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7157             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7158             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 129
* EL131.cbl
  7159             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7160             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7161             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7162             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7163             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7164             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7165             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7166             20  CN-CSI-PP-REPAIR         PIC X.
  7167             20  CN-CSI-PP-REPLACE        PIC X.
  7168             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7169             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7170             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7171             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7172             20  FILLER                   PIC X(5).
  7173
  7174         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7175             CN-CSI-PURCH-PROP-DATA.
  7176             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7177             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7178             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7179             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7180             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7181             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7182             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7183             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7184             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7185             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7186             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7187             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7188             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7189             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7190             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7191             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7192             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7193             20  CN-CSI-EW-REPLACE        PIC X.
  7194             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7195             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7196             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7197             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7198             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7199             20  FILLER                   PIC X(4).
  7200
  7201     12  CN-LAST-MAINT-DT                 PIC XX.
  7202     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7203     12  CN-LAST-MAINT-USER               PIC X(4).
  7204     12  FILLER                           PIC X(6).
  7205
  7206******************************************************************
  7207
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 130
* EL131.cbl
  7209 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7210                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7211                          CONTROL-FILE ACTIVITY-QUE
  7212                          ACCOUNT-MASTER CHECK-QUE
  7213                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7214                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7215                          CERTIFICATE-NOTE.
  7216 0000-DFHEXIT SECTION.
  7217     MOVE '9#                    $   ' TO DFHEIV0.
  7218     MOVE 'EL131' TO DFHEIV1.
  7219     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7220
  7221     IF EIBCALEN = ZERO
  7222         GO TO 8800-UNAUTHORIZED-ACCESS.
  7223
  7224     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7225     MOVE '5'                    TO DC-OPTION-CODE.
  7226     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7227     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7228     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7229     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7230
  7231     IF SAVE-DATE-YY GREATER 70
  7232         MOVE 19                 TO SAVE-DATE-CC
  7233      ELSE
  7234         MOVE 20                 TO SAVE-DATE-CC.
  7235
  7236
  7237* EXEC CICS HANDLE CONDITION
  7238*        PGMIDERR (8820-XCTL-ERROR)
  7239*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7240*        ERROR    (9990-ABEND)
  7241*    END-EXEC.
  7242*    MOVE '"$LI.                 ! " #00007232' TO DFHEIV0
  7243     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7245     MOVE X'2220233030303037323332' TO DFHEIV0(25:11)
  7246     CALL 'kxdfhei1' USING DFHEIV0
  7247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7248
  7249
  7250     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7251     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7252     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7253
  7254     INITIALIZE    EDIT-WORK-AREA.
  7255     MOVE '/'                    TO WORK-SLASH.
  7256     MOVE SPACES                 TO ERROR-SWITCHES.
  7257
  7258     MOVE TRAN-ID                TO TRANS-ID.
  7259     MOVE EIBTRMID               TO PI-TERM.
  7260     MOVE MAP-ID                 TO PI-QUAL.
  7261
  7262     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7263
  7264     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7265         MOVE LOW-VALUES         TO EL131AO
  7266         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 131
* EL131.cbl
  7267         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7268         MOVE -1                 TO MAINTL
  7269         GO TO 8110-SEND-DATA.
  7270
  7271     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7272         MOVE LOW-VALUES         TO EL131AO
  7273         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7274         MOVE 'X'                TO PI-RETURN-CD-1
  7275         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7276         MOVE -1                 TO MAINTL
  7277         GO TO 8100-SEND-MAP.
  7278
  7279     IF EIBAID = DFHCLEAR
  7280         GO TO 8200-RETURN-PRIOR.
  7281
  7282     IF PI-PROCESSOR-ID = 'LGXX'
  7283         NEXT SENTENCE
  7284     ELSE
  7285
  7286* EXEC CICS READQ TS
  7287*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7288*            INTO    (SECURITY-CONTROL)
  7289*            LENGTH  (SC-COMM-LENGTH)
  7290*            ITEM    (SC-ITEM)
  7291*        END-EXEC
  7292*    MOVE '*$II   L              ''   #00007273' TO DFHEIV0
  7293     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7294     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7295     MOVE X'2020233030303037323733' TO DFHEIV0(25:11)
  7296     CALL 'kxdfhei1' USING DFHEIV0,
  7297           PI-SECURITY-TEMP-STORE-ID,
  7298           SECURITY-CONTROL,
  7299           SC-COMM-LENGTH,
  7300           SC-ITEM,
  7301           DFHEIV99,
  7302           DFHEIV99
  7303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7304         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7305         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7306         IF NOT DISPLAY-CAP
  7307             MOVE 'READ'               TO  SM-READ
  7308             PERFORM 9995-SECURITY-VIOLATION
  7309             MOVE ER-0070              TO  EMI-ERROR
  7310             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7311             GO TO 8100-SEND-MAP.
  7312
  7313
  7314* EXEC CICS RECEIVE
  7315*        MAP    ('EL131A')
  7316*        MAPSET ('EL131S')
  7317*    END-EXEC.
  7318     MOVE 'EL131A' TO DFHEIV1
  7319     MOVE 'EL131S' TO DFHEIV2
  7320*    MOVE '8"T                   ''   #00007288' TO DFHEIV0
  7321     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7322     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7323     MOVE X'2020233030303037323838' TO DFHEIV0(25:11)
  7324     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 132
* EL131.cbl
  7325           DFHEIV1,
  7326           EL131AI,
  7327           DFHEIV99,
  7328           DFHEIV2,
  7329           DFHEIV99,
  7330           DFHEIV99
  7331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7332
  7333
  7334     IF PFKEYL GREATER THAN ZERO
  7335         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7336
  7337     IF SCREEN-ERROR
  7338         MOVE ER-0004 TO EMI-ERROR
  7339         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7340         MOVE -1 TO MAINTL
  7341         GO TO 8110-SEND-DATA.
  7342
  7343     IF EIBAID = DFHPF3
  7344         GO TO 8500-TRLR-MNT.
  7345
  7346     IF EIBAID = DFHPF4
  7347         GO TO 8600-ADDR-MNT.
  7348
  7349     IF EIBAID = DFHPF5
  7350         GO TO 8700-CERT-MNT.
  7351
  7352     IF PI-COMPANY-ID = 'DMD'
  7353       IF EIBAID = DFHPF6
  7354         GO TO 8750-DMD-CLM-FIX.
  7355
  7356     IF EIBAID = DFHPF7
  7357         GO TO 4000-FORCE-ERRORS.
  7358
  7359     IF EIBAID = DFHPF12
  7360         GO TO 8300-GET-HELP.
  7361
  7362     IF EIBAID = DFHPF23
  7363         GO TO 8810-PF23-ENTERED.
  7364
  7365     IF EIBAID = DFHPF24
  7366         GO TO 8400-RETURN-MASTER.
  7367
  7368     IF EIBAID NOT = DFHENTER
  7369         MOVE ER-0029            TO EMI-ERROR
  7370         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7371         MOVE -1                 TO MAINTL
  7372         GO TO 8110-SEND-DATA.
  7373
  7374     IF PI-RETURN-CD-1 =  'X'
  7375         MOVE ER-0311            TO EMI-ERROR
  7376         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7377         MOVE -1                 TO MAINTL
  7378         GO TO 8110-SEND-DATA.
  7379
  7380     IF MAINTI = 'A'
  7381         GO TO 0500-ADD-ALPHA-ONLY.
  7382
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 133
* EL131.cbl
  7383     IF MAINTI = 'N'
  7384         GO TO 0600-CHANGE-NAME.
  7385
  7386     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7387
  7388     IF SCREEN-ERROR
  7389         GO TO 8110-SEND-DATA.
  7390
  7391     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7392         MOVE ER-0276            TO EMI-ERROR
  7393         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7394         MOVE -1                 TO MAINTL
  7395         GO TO 8110-SEND-DATA.
  7396
  7397     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7398
  7399     IF SCREEN-ERROR
  7400         GO TO 8110-SEND-DATA.
  7401
  7402     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7403
  7404     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7405
  7406     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7407         GO TO 8110-SEND-DATA.
  7408
  7409     IF EMI-FATAL-CTR GREATER THAN ZERO
  7410         GO TO 8110-SEND-DATA.
  7411
  7412     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7413
  7414     IF WS-OPEN-CLOSE-SW = 'Y'
  7415         IF PI-LETTER-SW = 'Y'
  7416             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7417             MOVE 'T'            TO  CNTL-REC-TYPE
  7418             MOVE SPACES         TO  CNTL-PROC-ID
  7419             MOVE +0             TO  CNTL-SEQ-NO
  7420
  7421* EXEC CICS READ
  7422*                DATASET   (CNTL-FILE-ID)
  7423*                RIDFLD    (CNTL-KEY)
  7424*                SET       (ADDRESS OF CONTROL-FILE)
  7425*            END-EXEC
  7426*    MOVE '&"S        E          (   #00007379' TO DFHEIV0
  7427     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7428     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7429     MOVE X'2020233030303037333739' TO DFHEIV0(25:11)
  7430     CALL 'kxdfhei1' USING DFHEIV0,
  7431           CNTL-FILE-ID,
  7432           DFHEIV20,
  7433           DFHEIV99,
  7434           CNTL-KEY,
  7435           DFHEIV99,
  7436           DFHEIV99,
  7437           DFHEIV99
  7438     SET ADDRESS OF CONTROL-FILE TO
  7439         DFHEIV20
  7440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 134
* EL131.cbl
  7441             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7442
  7443     MOVE ER-0000                TO EMI-ERROR.
  7444     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7445
  7446     MOVE SPACE                  TO MAINTO.
  7447     MOVE -1                     TO MAINTL.
  7448     GO TO 8100-SEND-MAP.
  7449
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 135
* EL131.cbl
  7451 0100-UPDATE-PI.
  7452     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7453         GO TO 0110-UPDATE-UP.
  7454
  7455     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7456     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7457     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7458     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7459     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7460     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7461     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7462     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7463     GO TO 0120-UPDATE-PI-EXIT.
  7464
  7465 0110-UPDATE-UP.
  7466     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7467     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7468     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7469     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7470     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7471     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7472     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7473     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7474
  7475
  7476* EXEC CICS HANDLE CONDITION
  7477*         QIDERR    (0130-TS-ERROR)
  7478*         ITEMERR   (0130-TS-ERROR)
  7479*    END-EXEC.
  7480*    MOVE '"$N<                  ! # #00007418' TO DFHEIV0
  7481     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7482     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7483     MOVE X'2320233030303037343138' TO DFHEIV0(25:11)
  7484     CALL 'kxdfhei1' USING DFHEIV0
  7485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7486
  7487
  7488
  7489* EXEC CICS READQ TS
  7490*         QUEUE    (PI-KEY)
  7491*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7492*         LENGTH   (PI-COMM-LENGTH)
  7493*    END-EXEC.
  7494*    MOVE '*$I    L              ''   #00007423' TO DFHEIV0
  7495     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7496     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7497     MOVE X'2020233030303037343233' TO DFHEIV0(25:11)
  7498     CALL 'kxdfhei1' USING DFHEIV0,
  7499           PI-KEY,
  7500           PROGRAM-INTERFACE-BLOCK,
  7501           PI-COMM-LENGTH,
  7502           DFHEIV99,
  7503           DFHEIV99,
  7504           DFHEIV99
  7505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7506
  7507
  7508
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 136
* EL131.cbl
  7509* EXEC CICS DELETEQ TS
  7510*         QUEUE    (PI-KEY)
  7511*    END-EXEC.
  7512*    MOVE '*&                    #   #00007429' TO DFHEIV0
  7513     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7514     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7515     MOVE X'2020233030303037343239' TO DFHEIV0(25:11)
  7516     CALL 'kxdfhei1' USING DFHEIV0,
  7517           PI-KEY,
  7518           DFHEIV99
  7519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7520
  7521
  7522 0120-UPDATE-PI-EXIT.
  7523     EXIT.
  7524
  7525 0130-TS-ERROR.
  7526     MOVE LOW-VALUES             TO EL131AO.
  7527     MOVE ER-0192                TO EMI-ERROR.
  7528
  7529     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7530
  7531     GO TO 8100-SEND-MAP.
  7532
  7533 0200-TRANS-PF.
  7534     IF EIBAID NOT = DFHENTER
  7535         MOVE 'X'                TO ERROR-SWITCH
  7536         GO TO 0210-EXIT.
  7537
  7538     IF PFKEYI NOT NUMERIC
  7539         MOVE 'X'                TO ERROR-SWITCH
  7540         GO TO 0210-EXIT.
  7541
  7542     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7543
  7544     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7545         MOVE 'X' TO ERROR-SWITCH
  7546         GO TO 0210-EXIT.
  7547
  7548     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7549
  7550 0210-EXIT.
  7551     EXIT.
  7552
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 137
* EL131.cbl
  7554 0500-ADD-ALPHA-ONLY.
  7555******************************************************************
  7556*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7557*    RECORD.                                                     *
  7558******************************************************************
  7559
  7560     IF MLNAMEL = +0 AND
  7561        MFNAMEL = +0 AND
  7562        MMINITL = +0
  7563         MOVE ER-0797                TO  EMI-ERROR
  7564         MOVE -1                     TO  MAINTL
  7565         MOVE AL-UABON               TO  MAINTA
  7566         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7567         GO TO 8110-SEND-DATA.
  7568
  7569     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7570     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7571     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7572     MOVE PI-CERT-NO                 TO  CERT-NO.
  7573
  7574
  7575* EXEC CICS READ
  7576*        DATASET   (CLMS-FILE-ID)
  7577*        RIDFLD    (MSTR-KEY)
  7578*        SET       (ADDRESS OF CLAIM-MASTER)
  7579*    END-EXEC.
  7580*    MOVE '&"S        E          (   #00007485' TO DFHEIV0
  7581     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7582     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7583     MOVE X'2020233030303037343835' TO DFHEIV0(25:11)
  7584     CALL 'kxdfhei1' USING DFHEIV0,
  7585           CLMS-FILE-ID,
  7586           DFHEIV20,
  7587           DFHEIV99,
  7588           MSTR-KEY,
  7589           DFHEIV99,
  7590           DFHEIV99,
  7591           DFHEIV99
  7592     SET ADDRESS OF CLAIM-MASTER TO
  7593         DFHEIV20
  7594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7595
  7596
  7597
  7598* EXEC CICS GETMAIN
  7599*        SET       (ADDRESS OF ALPHA-INDEX)
  7600*        LENGTH    (ALPH-LENGTH)
  7601*        INITIMG   (GETMAIN-SPACE)
  7602*    END-EXEC.
  7603*    MOVE ',"IL                  $   #00007491' TO DFHEIV0
  7604     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7605     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7606     MOVE X'2020233030303037343931' TO DFHEIV0(25:11)
  7607     CALL 'kxdfhei1' USING DFHEIV0,
  7608           DFHEIV20,
  7609           ALPH-LENGTH,
  7610           GETMAIN-SPACE
  7611     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 138
* EL131.cbl
  7612         DFHEIV20
  7613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7614
  7615
  7616     MOVE 'AI'                       TO  AI-RECORD-ID.
  7617     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7618                                         AI-CL-COMPANY-CD.
  7619     MOVE 'C'                        TO  AI-SOURCE
  7620                                         AI-CL-SOURCE.
  7621
  7622     IF MLNAMEL IS GREATER THAN +0
  7623         MOVE MLNAMEI                TO  AI-LAST-NAME
  7624     ELSE
  7625         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7626
  7627     IF MFNAMEL IS GREATER THAN +0
  7628         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7629     ELSE
  7630         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7631
  7632     IF MMINITL IS GREATER THAN +0
  7633         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7634     ELSE
  7635         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7636
  7637     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7638     MOVE '5'                        TO  DC-OPTION-CODE.
  7639     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7640     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7641     IF BUILD-YEAR IS GREATER THAN 50
  7642         MOVE '19'                   TO  WS-ALPHA-YY-1
  7643         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7644         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7645         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7646     ELSE
  7647         MOVE '20'                   TO  WS-ALPHA-YY-1
  7648         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7649         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7650         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7651
  7652     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7653                                         AI-CL-DATE.
  7654
  7655     MOVE EIBTIME                    TO  AI-TIME
  7656                                         AI-CL-TIME.
  7657
  7658     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7659     MOVE 'C'                        TO  AI-CL-SOURCE.
  7660     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7661     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7662     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7663     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7664     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7665
  7666     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7667     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7668     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7669
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 139
* EL131.cbl
  7670
  7671* EXEC CICS WRITE
  7672*        DATASET   (ALPH-FILE-ID)
  7673*        RIDFLD    (AI-CONTROL-PRIMARY)
  7674*        FROM      (ALPHA-INDEX)
  7675*    END-EXEC.
  7676     MOVE LENGTH OF
  7677      ALPHA-INDEX
  7678       TO DFHEIV11
  7679*    MOVE '&$ L                  ''   #00007551' TO DFHEIV0
  7680     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7681     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7682     MOVE X'2020233030303037353531' TO DFHEIV0(25:11)
  7683     CALL 'kxdfhei1' USING DFHEIV0,
  7684           ALPH-FILE-ID,
  7685           ALPHA-INDEX,
  7686           DFHEIV11,
  7687           AI-CONTROL-PRIMARY,
  7688           DFHEIV99,
  7689           DFHEIV99
  7690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7691
  7692
  7693     MOVE LOW-VALUES                 TO  EL131AO.
  7694     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7695     MOVE ER-0000                    TO  EMI-ERROR.
  7696     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7697     MOVE -1                         TO  MAINTL.
  7698     GO TO 8100-SEND-MAP.
  7699
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 140
* EL131.cbl
  7701 0600-CHANGE-NAME.
  7702******************************************************************
  7703*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7704*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7705******************************************************************
  7706
  7707     IF MLNAMEL = +0 AND
  7708        MFNAMEL = +0 AND
  7709        MMINITL = +0
  7710         MOVE ER-0276                TO  EMI-ERROR
  7711         MOVE -1                     TO  MAINTL
  7712         MOVE AL-UABON               TO  MAINTA
  7713         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7714         GO TO 8110-SEND-DATA.
  7715
  7716     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7717     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7718     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7719     MOVE PI-CERT-NO                 TO  CERT-NO.
  7720
  7721
  7722* EXEC CICS READ
  7723*        DATASET   (CLMS-FILE-ID)
  7724*        RIDFLD    (MSTR-KEY)
  7725*        SET       (ADDRESS OF CLAIM-MASTER)
  7726*    END-EXEC.
  7727*    MOVE '&"S        E          (   #00007585' TO DFHEIV0
  7728     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7729     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7730     MOVE X'2020233030303037353835' TO DFHEIV0(25:11)
  7731     CALL 'kxdfhei1' USING DFHEIV0,
  7732           CLMS-FILE-ID,
  7733           DFHEIV20,
  7734           DFHEIV99,
  7735           MSTR-KEY,
  7736           DFHEIV99,
  7737           DFHEIV99,
  7738           DFHEIV99
  7739     SET ADDRESS OF CLAIM-MASTER TO
  7740         DFHEIV20
  7741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7742
  7743
  7744
  7745* EXEC CICS GETMAIN
  7746*        SET       (ADDRESS OF ALPHA-INDEX)
  7747*        LENGTH    (ALPH-LENGTH)
  7748*        INITIMG   (GETMAIN-SPACE)
  7749*    END-EXEC.
  7750*    MOVE ',"IL                  $   #00007591' TO DFHEIV0
  7751     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7752     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7753     MOVE X'2020233030303037353931' TO DFHEIV0(25:11)
  7754     CALL 'kxdfhei1' USING DFHEIV0,
  7755           DFHEIV20,
  7756           ALPH-LENGTH,
  7757           GETMAIN-SPACE
  7758     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 141
* EL131.cbl
  7759         DFHEIV20
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7761
  7762
  7763     MOVE 'AI'                       TO  AI-RECORD-ID.
  7764     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7765                                         AI-CL-COMPANY-CD.
  7766     MOVE 'C'                        TO  AI-SOURCE
  7767                                         AI-CL-SOURCE.
  7768
  7769     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7770     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7771     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7772
  7773     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7774     MOVE '5'                        TO  DC-OPTION-CODE.
  7775     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7776     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7777     IF BUILD-YEAR IS GREATER THAN 50
  7778         MOVE '19'                   TO  WS-ALPHA-YY-1
  7779         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7780         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7781         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7782     ELSE
  7783         MOVE '20'                   TO  WS-ALPHA-YY-1
  7784         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7785         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7786         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7787
  7788     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7789                                         AI-CL-DATE.
  7790
  7791     MOVE EIBTIME                    TO  AI-TIME
  7792                                         AI-CL-TIME.
  7793
  7794     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7795     MOVE 'C'                        TO  AI-CL-SOURCE.
  7796     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7797     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7798     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7799     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7800     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7801
  7802     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7803     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7804     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7805
  7806     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7807         MOVE 'Y'                TO CL-YESNOSW
  7808     END-IF.
  7809
  7810
  7811* EXEC CICS WRITE
  7812*        DATASET   (ALPH-FILE-ID)
  7813*        RIDFLD    (AI-CONTROL-PRIMARY)
  7814*        FROM      (ALPHA-INDEX)
  7815*    END-EXEC.
  7816     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 142
* EL131.cbl
  7817      ALPHA-INDEX
  7818       TO DFHEIV11
  7819*    MOVE '&$ L                  ''   #00007644' TO DFHEIV0
  7820     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7821     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7822     MOVE X'2020233030303037363434' TO DFHEIV0(25:11)
  7823     CALL 'kxdfhei1' USING DFHEIV0,
  7824           ALPH-FILE-ID,
  7825           ALPHA-INDEX,
  7826           DFHEIV11,
  7827           AI-CONTROL-PRIMARY,
  7828           DFHEIV99,
  7829           DFHEIV99
  7830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7831
  7832
  7833
  7834* EXEC CICS READ
  7835*        DATASET   (CLMS-FILE-ID)
  7836*        RIDFLD    (MSTR-KEY)
  7837*        SET       (ADDRESS OF CLAIM-MASTER)
  7838*        UPDATE
  7839*    END-EXEC.
  7840*    MOVE '&"S        EU         (   #00007650' TO DFHEIV0
  7841     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7842     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7843     MOVE X'2020233030303037363530' TO DFHEIV0(25:11)
  7844     CALL 'kxdfhei1' USING DFHEIV0,
  7845           CLMS-FILE-ID,
  7846           DFHEIV20,
  7847           DFHEIV99,
  7848           MSTR-KEY,
  7849           DFHEIV99,
  7850           DFHEIV99,
  7851           DFHEIV99
  7852     SET ADDRESS OF CLAIM-MASTER TO
  7853         DFHEIV20
  7854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7855
  7856
  7857     if (cl-priority-cd = '8')
  7858        and (pi-processor-id not = 'PEMA'and 'JMS '
  7859             AND 'AMWA' AND 'KMSB')
  7860        MOVE ER-8003             TO EMI-ERROR
  7861        PERFORM 9900-ERROR-FORMAT
  7862                                 THRU 9900-EXIT
  7863        MOVE -1                  TO MAINTL
  7864        GO TO 8110-SEND-DATA
  7865     end-if
  7866
  7867     IF MLNAMEL IS GREATER THAN +0
  7868         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  7869
  7870     IF MFNAMEL IS GREATER THAN +0
  7871         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  7872
  7873     IF MMINITL IS GREATER THAN +0
  7874         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 143
* EL131.cbl
  7875
  7876     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  7877     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  7878     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  7879     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  7880
  7881     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7882         MOVE 'Y'                TO CL-YESNOSW
  7883     END-IF.
  7884
  7885
  7886* EXEC CICS HANDLE CONDITION
  7887*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  7888*    END-EXEC.
  7889*    MOVE '"$$                   ! $ #00007685' TO DFHEIV0
  7890     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  7891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7892     MOVE X'2420233030303037363835' TO DFHEIV0(25:11)
  7893     CALL 'kxdfhei1' USING DFHEIV0
  7894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7895
  7896
  7897
  7898* EXEC CICS REWRITE
  7899*        DATASET   (CLMS-FILE-ID)
  7900*        FROM      (CLAIM-MASTER)
  7901*    END-EXEC.
  7902     MOVE LENGTH OF
  7903      CLAIM-MASTER
  7904       TO DFHEIV11
  7905*    MOVE '&& L                  %   #00007689' TO DFHEIV0
  7906     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7907     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7908     MOVE X'2020233030303037363839' TO DFHEIV0(25:11)
  7909     CALL 'kxdfhei1' USING DFHEIV0,
  7910           CLMS-FILE-ID,
  7911           CLAIM-MASTER,
  7912           DFHEIV11,
  7913           DFHEIV99
  7914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7915
  7916
  7917 0600-CONTINUE-NAME-UPDATE.
  7918
  7919     MOVE LOW-VALUES                 TO  EL131AO.
  7920     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7921     MOVE ER-0000                    TO  EMI-ERROR.
  7922     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7923     MOVE -1                         TO  MAINTL.
  7924     GO TO 8100-SEND-MAP.
  7925
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 144
* EL131.cbl
  7927 1000-EDIT-SCREEN.
  7928
  7929     MOVE MAINTI                 TO CHECK-MAINT.
  7930
  7931     IF NOT VALID-OPTIONS
  7932         MOVE 'X'                TO ERROR-SWITCH
  7933         MOVE -1                 TO MAINTL
  7934         MOVE AL-UABON           TO MAINTA
  7935         MOVE ER-0023            TO EMI-ERROR
  7936         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7937         GO TO 1010-EXIT.
  7938
  7939     IF NOT MODIFY-CAP
  7940         MOVE 'UPDATE'           TO  SM-READ
  7941         PERFORM 9995-SECURITY-VIOLATION
  7942         MOVE ER-0070               TO  EMI-ERROR
  7943         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7944         GO TO 8100-SEND-MAP.
  7945
  7946     IF DELETE-CLAIM
  7947         MOVE AL-UANON TO MAINTA
  7948         GO TO 1010-EXIT.
  7949
  7950     MOVE AL-UANON               TO MAINTA.
  7951
  7952     IF CCNOI GREATER THAN LOW-VALUES
  7953         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7954
  7955     IF PI-COMPANY-ID = 'CSL'
  7956        CONTINUE
  7957     ELSE
  7958        IF TYPEL > ZERO
  7959           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  7960              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7961                    PI-LIFE-OVERRIDE-L1))
  7962                       OR
  7963              ((PI-COMPANY-ID = 'DCC')
  7964              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7965                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  7966              MOVE AL-UANON      TO TYPEA
  7967              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  7968           ELSE
  7969              MOVE ER-0199       TO EMI-ERROR
  7970              PERFORM 9900-ERROR-FORMAT
  7971                                 THRU 9900-EXIT
  7972              MOVE AL-UABON      TO TYPEA
  7973              MOVE -1            TO TYPEL
  7974              MOVE 'X'           TO ERROR-SWITCH
  7975           END-IF
  7976        ELSE
  7977           MOVE AL-UANOF         TO TYPEA
  7978        END-IF
  7979     END-IF
  7980     IF STATUSI GREATER THAN LOW-VALUES
  7981         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  7982             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  7983             MOVE AL-UANON       TO STATUSA
  7984             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 145
* EL131.cbl
  7985             MOVE 'Y'            TO DLYACTV-SW
  7986         ELSE
  7987             MOVE ER-0333        TO EMI-ERROR
  7988             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7989             MOVE AL-UABON       TO STATUSA
  7990             MOVE -1             TO STATUSL
  7991             MOVE 'X'            TO ERROR-SWITCH
  7992         END-IF
  7993     ELSE
  7994         MOVE SPACE              TO TRLR-SWITCH
  7995         MOVE 'N'                TO DLYACTV-SW
  7996         MOVE AL-UANOF           TO STATUSA.
  7997
  7998     IF PROCI GREATER THAN LOW-VALUES
  7999         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8000     ELSE
  8001         MOVE AL-UANOF TO PROCA.
  8002
  8003     IF SEXI GREATER THAN LOW-VALUES
  8004         IF SEXI = 'F' OR 'M'
  8005             MOVE AL-UANON       TO SEXA
  8006             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8007           ELSE
  8008             MOVE ER-0219        TO EMI-ERROR
  8009             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8010             MOVE AL-UABON       TO SEXA
  8011             MOVE -1             TO SEXL
  8012             MOVE 'X'            TO ERROR-SWITCH
  8013       ELSE
  8014         MOVE AL-UANOF           TO SEXA.
  8015
  8016     IF BIRTHL = +0
  8017         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8018         MOVE AL-UANOF           TO  BIRTHA
  8019         GO TO 1000-CONTINUE-EDITS.
  8020
  8021     IF BIRTHI = SPACES
  8022         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8023         MOVE 'X'                TO  UPDATE-SWITCH
  8024                                     MSTR-SWITCH
  8025         GO TO 1000-CONTINUE-EDITS.
  8026
  8027     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8028     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8029     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8030     MOVE '4'                    TO  DC-OPTION-CODE.
  8031     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8032     IF DATE-CONVERSION-ERROR
  8033         MOVE ER-0220            TO  EMI-ERROR
  8034         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8035         MOVE AL-UABON           TO  BIRTHA
  8036         MOVE -1                 TO  BIRTHL
  8037         MOVE 'X'                TO  ERROR-SWITCH
  8038         GO TO 1000-CONTINUE-EDITS.
  8039
  8040******************************************************************
  8041**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8042**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 146
* EL131.cbl
  8043**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8044******************************************************************
  8045     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8046         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8047         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8048         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8049         MOVE '4'                TO  DC-OPTION-CODE
  8050         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8051         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8052                                     DC-ELAPSED-DAYS
  8053         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8054         IF DATE-CONVERSION-ERROR
  8055             MOVE ER-0220        TO  EMI-ERROR
  8056             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8057             MOVE AL-UABON       TO  BIRTHA
  8058             MOVE -1             TO  BIRTHL
  8059             MOVE 'X'            TO  ERROR-SWITCH
  8060             GO TO 1000-CONTINUE-EDITS.
  8061
  8062     MOVE AL-UANON               TO  BIRTHA.
  8063     MOVE 'X'                    TO  UPDATE-SWITCH
  8064                                     MSTR-SWITCH.
  8065     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8066     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8067     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8068
  8069 1000-CONTINUE-EDITS.
  8070
  8071     IF SOCIALI GREATER THAN LOW-VALUES
  8072         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8073         IF WS-SOC-SEC-NO NUMERIC AND
  8074           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8075             NEXT SENTENCE
  8076         ELSE
  8077            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8078               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8079               WS-SSN-DASH2 = '-'
  8080                 NEXT SENTENCE
  8081            ELSE
  8082                 MOVE ER-0887        TO  EMI-ERROR
  8083                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8084                 MOVE AL-UABON       TO  SOCIALA
  8085                 MOVE -1             TO  SOCIALL
  8086                 MOVE 'X'            TO  ERROR-SWITCH
  8087            END-IF
  8088        END-IF
  8089     END-IF.
  8090
  8091     IF SOCIALI GREATER THAN LOW-VALUES
  8092         MOVE AL-UANON           TO SOCIALA
  8093         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8094     ELSE
  8095         MOVE AL-UANOF           TO SOCIALA.
  8096
  8097     IF OCCI GREATER THAN LOW-VALUES
  8098         MOVE AL-UANON           TO OCCA
  8099         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8100     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 147
* EL131.cbl
  8101         MOVE AL-UANOF           TO OCCA.
  8102
  8103     IF BENEL NOT GREATER THAN ZERO
  8104            GO TO 1005-CONTINUE-EDITS.
  8105
  8106     IF BENEI = SPACES
  8107        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8108           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8109           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8110           IF AUTO-PAY-TO-BENE = 'Y'
  8111               MOVE ER-1773      TO  EMI-ERROR
  8112               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8113               MOVE 'X'          TO ERROR-SWITCH
  8114               MOVE AL-UABON     TO BENEA
  8115               MOVE -1           TO BENEL
  8116           ELSE
  8117               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8118           END-IF
  8119        ELSE
  8120           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8121        END-IF
  8122        GO TO 1005-CONTINUE-EDITS.
  8123
  8124
  8125* EXEC CICS HANDLE CONDITION
  8126*        NOTFND (1004-BENE-NOT-FOUND)
  8127*    END-EXEC.
  8128*    MOVE '"$I                   ! % #00007901' TO DFHEIV0
  8129     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8130     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8131     MOVE X'2520233030303037393031' TO DFHEIV0(25:11)
  8132     CALL 'kxdfhei1' USING DFHEIV0
  8133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8134
  8135
  8136     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8137     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8138     MOVE BENEI                  TO  WS-ELBENE-ID.
  8139
  8140
  8141* EXEC CICS READ
  8142*        DATASET ('ELBENE')
  8143*        RIDFLD  (WS-ELBENE-KEY)
  8144*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8145*    END-EXEC.
  8146     MOVE 'ELBENE' TO DFHEIV1
  8147*    MOVE '&"S        E          (   #00007909' TO DFHEIV0
  8148     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8150     MOVE X'2020233030303037393039' TO DFHEIV0(25:11)
  8151     CALL 'kxdfhei1' USING DFHEIV0,
  8152           DFHEIV1,
  8153           DFHEIV20,
  8154           DFHEIV99,
  8155           WS-ELBENE-KEY,
  8156           DFHEIV99,
  8157           DFHEIV99,
  8158           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 148
* EL131.cbl
  8159     SET ADDRESS OF BENEFICIARY-MASTER TO
  8160         DFHEIV20
  8161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8162
  8163
  8164     MOVE AL-UANON               TO  BENEA.
  8165     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8166
  8167     GO TO 1005-CONTINUE-EDITS.
  8168
  8169 1004-BENE-NOT-FOUND.
  8170     MOVE ER-0565                TO  EMI-ERROR.
  8171
  8172     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8173     MOVE 'X'                    TO ERROR-SWITCH.
  8174     MOVE AL-UABON               TO BENEA.
  8175     MOVE -1                     TO BENEL.
  8176
  8177 1005-CONTINUE-EDITS.
  8178
  8179     IF DIAGI GREATER THAN LOW-VALUES
  8180         MOVE AL-UANON           TO DIAGA
  8181         MOVE 'X'                TO UPDATE-SWITCH
  8182                                    NINETY-TRLR-SWITCH
  8183     ELSE
  8184         MOVE AL-UANOF           TO DIAGA.
  8185
  8186     IF CAUSEI GREATER THAN LOW-VALUES
  8187         MOVE AL-UANON           TO CAUSEA
  8188         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8189     ELSE
  8190         MOVE AL-UANOF           TO CAUSEA.
  8191
  8192     IF ENDL GREATER THAN ZERO
  8193         MOVE LOW-VALUES         TO HOLD-END
  8194         IF ENDI = SPACES
  8195             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8196         ELSE
  8197             MOVE ENDI           TO DEEDIT-DATE-INPUT
  8198
  8199* EXEC CICS BIF DEEDIT
  8200*                FIELD    (DEEDIT-DATE-INPUT)
  8201*                LENGTH   (DATE-LENGTH)
  8202*            END-EXEC
  8203*    MOVE '@"L                   #   #00007949' TO DFHEIV0
  8204     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8205     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8206     MOVE X'2020233030303037393439' TO DFHEIV0(25:11)
  8207     CALL 'kxdfhei1' USING DFHEIV0,
  8208           DEEDIT-DATE-INPUT,
  8209           DATE-LENGTH
  8210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8211             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8212             MOVE '4'            TO DC-OPTION-CODE
  8213             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8214             IF NOT DATE-CONVERSION-ERROR
  8215                 MOVE DC-BIN-DATE-1      TO HOLD-END
  8216                 MOVE AL-UANON   TO ENDA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 149
* EL131.cbl
  8217                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8218                 MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8219             ELSE
  8220                 MOVE ER-0224    TO EMI-ERROR
  8221                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8222                 MOVE AL-UABON   TO ENDA
  8223                 MOVE -1         TO ENDL
  8224                 MOVE 'X'        TO ERROR-SWITCH
  8225       ELSE
  8226           MOVE AL-UANOF         TO ENDA.
  8227
  8228     IF INCL GREATER THAN ZERO
  8229        MOVE LOW-VALUES          TO HOLD-INCUR
  8230        IF INCI = SPACES
  8231           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8232        ELSE
  8233           MOVE INCI             TO DEEDIT-DATE-INPUT
  8234
  8235* EXEC CICS BIF DEEDIT
  8236*             FIELD    (DEEDIT-DATE-INPUT)
  8237*             LENGTH   (DATE-LENGTH)
  8238*          END-EXEC
  8239*    MOVE '@"L                   #   #00007976' TO DFHEIV0
  8240     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8241     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8242     MOVE X'2020233030303037393736' TO DFHEIV0(25:11)
  8243     CALL 'kxdfhei1' USING DFHEIV0,
  8244           DEEDIT-DATE-INPUT,
  8245           DATE-LENGTH
  8246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8247           MOVE DEEDIT-DATE      TO DC-GREG-DATE-1-MDY
  8248           MOVE '4'              TO DC-OPTION-CODE
  8249           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8250           IF NOT DATE-CONVERSION-ERROR
  8251              MOVE DC-BIN-DATE-1 TO HOLD-INCUR
  8252              IF HOLD-INCUR > SAVE-BIN-DATE
  8253                 MOVE ER-0511    TO EMI-ERROR
  8254                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8255                 MOVE AL-UABON   TO INCA
  8256                 MOVE -1         TO INCL
  8257                 MOVE 'X'        TO ERROR-SWITCH
  8258              ELSE
  8259                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8260                 MOVE AL-UANON   TO INCA
  8261                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8262              END-IF
  8263           ELSE
  8264              MOVE ER-0222       TO EMI-ERROR
  8265              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8266              MOVE AL-UABON      TO INCA
  8267              MOVE -1            TO INCL
  8268              MOVE 'X'           TO ERROR-SWITCH
  8269           END-IF
  8270        END-IF
  8271     ELSE
  8272        IF PI-NO-PMTS = ZEROS
  8273           MOVE AL-UANOF         TO INCA
  8274        END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 150
* EL131.cbl
  8275     END-IF
  8276     IF REPL GREATER THAN ZERO
  8277         MOVE LOW-VALUES         TO HOLD-REPORTED
  8278         IF REPI = SPACES
  8279             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8280         ELSE
  8281             MOVE REPI           TO DEEDIT-DATE-INPUT
  8282
  8283* EXEC CICS BIF DEEDIT
  8284*                FIELD    (DEEDIT-DATE-INPUT)
  8285*                LENGTH   (DATE-LENGTH)
  8286*            END-EXEC
  8287*    MOVE '@"L                   #   #00008015' TO DFHEIV0
  8288     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8289     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8290     MOVE X'2020233030303038303135' TO DFHEIV0(25:11)
  8291     CALL 'kxdfhei1' USING DFHEIV0,
  8292           DEEDIT-DATE-INPUT,
  8293           DATE-LENGTH
  8294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8295             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8296             MOVE '4'            TO DC-OPTION-CODE
  8297             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8298             IF NOT DATE-CONVERSION-ERROR
  8299                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8300                 IF HOLD-REPORTED > SAVE-BIN-DATE
  8301                    MOVE ER-0512 TO EMI-ERROR
  8302                    MOVE AL-UABON TO REPA
  8303                    MOVE -1       TO REPL
  8304                    MOVE 'X'      TO ERROR-SWITCH
  8305                 ELSE
  8306                   MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8307                   MOVE AL-UANON   TO REPA
  8308                   MOVE DC-GREG-DATE-1-EDIT TO REPO
  8309             ELSE
  8310                 MOVE ER-0223    TO EMI-ERROR
  8311                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8312                 MOVE AL-UABON   TO REPA
  8313                 MOVE -1         TO REPL
  8314                 MOVE 'X'        TO ERROR-SWITCH
  8315       ELSE
  8316         MOVE AL-UANOF TO REPA.
  8317
  8318     IF PDTHRUI GREATER THAN LOW-VALUES
  8319        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8320        IF PDTHRUI = SPACES
  8321           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8322        ELSE
  8323           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8324
  8325* EXEC CICS BIF DEEDIT
  8326*               FIELD    (DEEDIT-DATE-INPUT)
  8327*               LENGTH   (DATE-LENGTH)
  8328*          END-EXEC
  8329*    MOVE '@"L                   #   #00008048' TO DFHEIV0
  8330     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8331     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8332     MOVE X'2020233030303038303438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 151
* EL131.cbl
  8333     CALL 'kxdfhei1' USING DFHEIV0,
  8334           DEEDIT-DATE-INPUT,
  8335           DATE-LENGTH
  8336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8337           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8338           MOVE '4'            TO DC-OPTION-CODE
  8339           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8340           IF NOT DATE-CONVERSION-ERROR
  8341              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8342              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8343              MOVE AL-UANON   TO PDTHRUA
  8344              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8345              IF PI-USES-PAID-TO
  8346                 MOVE '6'            TO DC-OPTION-CODE
  8347                 MOVE -1             TO DC-ELAPSED-DAYS
  8348                 MOVE +0             TO DC-ELAPSED-MONTHS
  8349                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8350                 IF NO-CONVERSION-ERROR
  8351                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8352                 ELSE
  8353                    NEXT SENTENCE
  8354              ELSE
  8355                 NEXT SENTENCE
  8356           ELSE
  8357              MOVE ER-0475    TO EMI-ERROR
  8358              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8359              MOVE AL-UABON   TO PDTHRUA
  8360              MOVE -1         TO PDTHRUL
  8361              MOVE 'X'        TO ERROR-SWITCH
  8362     ELSE
  8363        IF MODIFY-CAP
  8364           MOVE AL-UANOF        TO PDTHRUA.
  8365
  8366     IF PDAMTL GREATER THAN +0
  8367         MOVE ZEROS              TO HOLD-PDAMT
  8368
  8369* EXEC CICS BIF DEEDIT
  8370*            FIELD    (PDAMTI)
  8371*            LENGTH   (9)
  8372*        END-EXEC
  8373     MOVE 9
  8374       TO DFHEIV11
  8375*    MOVE '@"L                   #   #00008083' TO DFHEIV0
  8376     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8377     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8378     MOVE X'2020233030303038303833' TO DFHEIV0(25:11)
  8379     CALL 'kxdfhei1' USING DFHEIV0,
  8380           PDAMTI,
  8381           DFHEIV11
  8382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8383         IF PDAMTI NUMERIC
  8384             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8385             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8386             MOVE AL-UNNON       TO PDAMTA
  8387         ELSE
  8388             MOVE ER-0547        TO EMI-ERROR
  8389             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8390             MOVE AL-UNBON       TO PDAMTA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 152
* EL131.cbl
  8391             MOVE -1             TO PDAMTL
  8392             MOVE 'X'            TO ERROR-SWITCH
  8393     ELSE
  8394         IF MODIFY-CAP
  8395            MOVE AL-UNNOF        TO PDAMTA.
  8396
  8397     IF NODAYSI GREATER THAN LOW-VALUES
  8398         MOVE ZEROS              TO HOLD-NODAYS
  8399
  8400* EXEC CICS BIF DEEDIT
  8401*            FIELD (NODAYSI)
  8402*            LENGTH (5)
  8403*        END-EXEC
  8404     MOVE 5
  8405       TO DFHEIV11
  8406*    MOVE '@"L                   #   #00008103' TO DFHEIV0
  8407     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8408     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8409     MOVE X'2020233030303038313033' TO DFHEIV0(25:11)
  8410     CALL 'kxdfhei1' USING DFHEIV0,
  8411           NODAYSI,
  8412           DFHEIV11
  8413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8414         IF NODAYSI NUMERIC
  8415             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8416             MOVE AL-UNNON       TO NODAYSA
  8417             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8418         ELSE
  8419             MOVE ER-0491        TO EMI-ERROR
  8420             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8421             MOVE AL-UNBON       TO NODAYSA
  8422             MOVE -1             TO NODAYSL
  8423             MOVE 'X'            TO ERROR-SWITCH
  8424     ELSE
  8425         IF MODIFY-CAP
  8426            MOVE AL-UNNOF        TO NODAYSA.
  8427
  8428     IF NOPMTSI GREATER THAN LOW-VALUES
  8429         MOVE ZEROS              TO HOLD-NOPMTS
  8430
  8431* EXEC CICS BIF DEEDIT
  8432*            FIELD (NOPMTSI)
  8433*            LENGTH (4)
  8434*        END-EXEC
  8435     MOVE 4
  8436       TO DFHEIV11
  8437*    MOVE '@"L                   #   #00008123' TO DFHEIV0
  8438     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8439     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8440     MOVE X'2020233030303038313233' TO DFHEIV0(25:11)
  8441     CALL 'kxdfhei1' USING DFHEIV0,
  8442           NOPMTSI,
  8443           DFHEIV11
  8444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8445         IF NOPMTSI NUMERIC
  8446             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8447             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8448             MOVE AL-UNNON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 153
* EL131.cbl
  8449           ELSE
  8450             MOVE ER-0548        TO EMI-ERROR
  8451             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8452             MOVE AL-UNBON       TO NOPMTSA
  8453             MOVE -1             TO NOPMTSL
  8454             MOVE 'X'            TO ERROR-SWITCH
  8455       ELSE
  8456         IF MODIFY-CAP
  8457            MOVE AL-UNNOF        TO NOPMTSA.
  8458
  8459     IF FORMTYPI GREATER THAN LOW-VALUES
  8460         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8461             MOVE AL-UANON       TO FORMTYPA
  8462             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8463           ELSE
  8464             MOVE ER-7650        TO EMI-ERROR
  8465             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8466             MOVE AL-UABON       TO FORMTYPA
  8467             MOVE -1             TO FORMTYPL
  8468             MOVE 'X'            TO ERROR-SWITCH
  8469       ELSE
  8470         MOVE AL-UANOF           TO FORMTYPA.
  8471
  8472     IF PRICDL GREATER THAN ZERO
  8473         IF (PRICDI = ' ') OR
  8474            (PRICDI GREATER THAN ZERO   AND
  8475             PRICDI NOT GREATER THAN '9')
  8476             MOVE AL-UANON       TO PRICDA
  8477             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8478         ELSE
  8479             MOVE ER-0274        TO EMI-ERROR
  8480             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8481             MOVE AL-UABON       TO PRICDA
  8482             MOVE -1             TO PRICDL
  8483             MOVE 'X'            TO ERROR-SWITCH
  8484     ELSE
  8485         MOVE AL-UANOF TO PRICDA.
  8486
  8487     IF PI-COMPANY-ID = 'DMD'
  8488     IF PRICDL GREATER THAN ZERO
  8489       IF SYSTEM-MODIFY-CAP  OR
  8490          PI-PROCESSOR-ID = 'LGXX'
  8491             NEXT SENTENCE
  8492           ELSE
  8493            IF CL-PRIORITY-CD = '9'  OR
  8494               PRICDI         = '9'
  8495                  MOVE ER-0938        TO EMI-ERROR
  8496                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8497                  MOVE AL-UABON       TO PRICDA
  8498                  MOVE -1             TO PRICDL
  8499                  MOVE 'X'            TO ERROR-SWITCH.
  8500
  8501     IF FILETOL GREATER THAN ZERO
  8502         MOVE AL-UANON           TO FILETOA
  8503         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8504     ELSE
  8505         MOVE AL-UANOF TO FILETOA.
  8506
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 154
* EL131.cbl
  8507     IF SUPVL GREATER THAN ZERO
  8508         IF SUPVI = 'Y' OR 'N' OR SPACE
  8509             MOVE AL-UANON       TO SUPVA
  8510             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8511         ELSE
  8512             MOVE ER-0230        TO EMI-ERROR
  8513             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8514             MOVE AL-UABON       TO SUPVA
  8515             MOVE -1             TO SUPVL
  8516             MOVE 'X'            TO ERROR-SWITCH
  8517     ELSE
  8518         MOVE AL-UANOF           TO SUPVA.
  8519
  8520     IF MLNAMEL GREATER THAN ZERO
  8521         IF MLNAMEI GREATER THAN SPACES
  8522            MOVE AL-UANON        TO MLNAMEA
  8523            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8524                                     MSTR-KEY-SWITCH
  8525         ELSE
  8526            MOVE ER-0236         TO EMI-ERROR
  8527            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8528            MOVE AL-UABON        TO MLNAMEA
  8529            MOVE -1              TO MLNAMEL
  8530            MOVE 'X'             TO ERROR-SWITCH
  8531     ELSE
  8532         MOVE AL-UANOF           TO MLNAMEA.
  8533
  8534     IF MFNAMEI GREATER THAN LOW-VALUES
  8535         MOVE AL-UANON           TO MFNAMEA
  8536         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8537     ELSE
  8538         MOVE AL-UANOF           TO MFNAMEA.
  8539
  8540     IF MMINITI GREATER THAN LOW-VALUES
  8541         MOVE AL-UANON           TO MMINITA
  8542         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8543     ELSE
  8544         MOVE AL-UANOF           TO MMINITA.
  8545
  8546     IF CRTLNMEI GREATER THAN LOW-VALUES
  8547         IF CRTLNMEI NOT = SPACES
  8548            MOVE AL-UANON        TO CRTLNMEA
  8549            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8550                                     CERT-KEY-SWITCH
  8551        ELSE
  8552            MOVE ER-0236         TO EMI-ERROR
  8553            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8554            MOVE AL-UABON        TO CRTLNMEA
  8555            MOVE -1              TO CRTLNMEL
  8556            MOVE 'X'             TO ERROR-SWITCH
  8557     ELSE
  8558         MOVE AL-UANOF           TO CRTLNMEA.
  8559
  8560     IF CRTFNMEI GREATER THAN LOW-VALUES
  8561         MOVE AL-UANON           TO CRTFNMEA
  8562         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8563     ELSE
  8564         MOVE AL-UANOF           TO CRTFNMEA.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 155
* EL131.cbl
  8565
  8566     IF CRTINITI GREATER THAN LOW-VALUES
  8567         MOVE AL-UANON           TO CRTINITA
  8568         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8569     ELSE
  8570         MOVE AL-UANOF           TO CRTINITA.
  8571
  8572     IF ISSAGEL GREATER THAN ZERO
  8573         IF ISSAGEI NUMERIC
  8574            MOVE AL-UANON        TO ISSAGEA
  8575            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8576         ELSE
  8577            MOVE ER-0237         TO EMI-ERROR
  8578            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8579            MOVE AL-UABON        TO ISSAGEA
  8580            MOVE -1              TO ISSAGEL
  8581            MOVE 'X'             TO ERROR-SWITCH
  8582     ELSE
  8583         MOVE AL-UANOF           TO ISSAGEA.
  8584
  8585     IF JNTFNMEI GREATER THAN LOW-VALUES
  8586         MOVE AL-UANON           TO JNTFNMEA
  8587         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8588     ELSE
  8589         MOVE AL-UANOF           TO JNTFNMEA.
  8590
  8591     IF JNTLNMEI GREATER THAN LOW-VALUES
  8592         MOVE AL-UANON           TO JNTLNMEA
  8593         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8594     ELSE
  8595         MOVE AL-UANOF           TO JNTLNMEA.
  8596
  8597     IF JNTINITI GREATER THAN LOW-VALUES
  8598         MOVE AL-UANON           TO JNTINITA
  8599         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8600     ELSE
  8601         MOVE AL-UANOF           TO JNTINITA.
  8602
  8603     IF JNTAGEL GREATER THAN ZERO
  8604         IF JNTAGEI NUMERIC
  8605            MOVE AL-UANON        TO JNTAGEA
  8606            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8607         ELSE
  8608            MOVE ER-0238         TO EMI-ERROR
  8609            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8610            MOVE AL-UABON        TO JNTAGEA
  8611            MOVE -1              TO JNTAGEL
  8612            MOVE 'X'             TO ERROR-SWITCH
  8613     ELSE
  8614         MOVE AL-UANOF           TO JNTAGEA.
  8615
  8616     IF ADDONDTI GREATER THAN LOW-VALUES
  8617         MOVE LOW-VALUES         TO HOLD-ADDON
  8618         IF ADDONDTI = SPACES
  8619             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8620         ELSE
  8621             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8622
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 156
* EL131.cbl
  8623* EXEC CICS BIF DEEDIT
  8624*                FIELD    (DEEDIT-DATE-INPUT)
  8625*                LENGTH   (DATE-LENGTH)
  8626*            END-EXEC
  8627*    MOVE '@"L                   #   #00008304' TO DFHEIV0
  8628     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8629     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8630     MOVE X'2020233030303038333034' TO DFHEIV0(25:11)
  8631     CALL 'kxdfhei1' USING DFHEIV0,
  8632           DEEDIT-DATE-INPUT,
  8633           DATE-LENGTH
  8634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8635             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8636             MOVE '4'            TO DC-OPTION-CODE
  8637             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8638             IF NOT DATE-CONVERSION-ERROR
  8639                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8640                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8641                                                  CERT-SWITCH
  8642                 MOVE AL-UANON   TO ADDONDTA
  8643                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8644             ELSE
  8645                 MOVE ER-7651    TO EMI-ERROR
  8646                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8647                 MOVE AL-UABON   TO ADDONDTA
  8648                 MOVE -1         TO ADDONDTL
  8649                 MOVE 'X'        TO ERROR-SWITCH
  8650       ELSE
  8651         MOVE AL-UANOF TO ADDONDTA.
  8652
  8653     IF LCVCDI GREATER THAN LOW-VALUES
  8654         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8655         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8656     ELSE
  8657         MOVE AL-UANOF           TO LCVCDA.
  8658
  8659     IF ACVCDI GREATER THAN LOW-VALUES
  8660         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8661         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8662     ELSE
  8663         MOVE AL-UANOF           TO ACVCDA.
  8664
  8665     IF LCVOTRMI GREATER THAN LOW-VALUES
  8666
  8667* EXEC CICS BIF DEEDIT
  8668*            FIELD (LCVOTRMI)
  8669*            LENGTH(3)
  8670*        END-EXEC
  8671     MOVE 3
  8672       TO DFHEIV11
  8673*    MOVE '@"L                   #   #00008339' TO DFHEIV0
  8674     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8675     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8676     MOVE X'2020233030303038333339' TO DFHEIV0(25:11)
  8677     CALL 'kxdfhei1' USING DFHEIV0,
  8678           LCVOTRMI,
  8679           DFHEIV11
  8680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 157
* EL131.cbl
  8681         IF LCVOTRMI IS NUMERIC
  8682             MOVE LCVOTRMI       TO LCVOTRMO
  8683             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8684             MOVE AL-UANON       TO LCVOTRMA
  8685         ELSE
  8686             MOVE ER-0241        TO EMI-ERROR
  8687             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8688             MOVE AL-UNBON       TO LCVOTRMA
  8689             MOVE 'X'            TO ERROR-SWITCH
  8690             MOVE -1             TO LCVOTRML
  8691     ELSE
  8692         MOVE AL-UANOF           TO LCVOTRMA.
  8693
  8694     IF ACVOTRMI GREATER THAN LOW-VALUES
  8695
  8696* EXEC CICS BIF DEEDIT
  8697*            FIELD (ACVOTRMI)
  8698*            LENGTH(3)
  8699*        END-EXEC
  8700     MOVE 3
  8701       TO DFHEIV11
  8702*    MOVE '@"L                   #   #00008357' TO DFHEIV0
  8703     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8704     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8705     MOVE X'2020233030303038333537' TO DFHEIV0(25:11)
  8706     CALL 'kxdfhei1' USING DFHEIV0,
  8707           ACVOTRMI,
  8708           DFHEIV11
  8709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8710         IF ACVOTRMI IS NUMERIC
  8711             MOVE ACVOTRMI       TO ACVOTRMO
  8712             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8713             MOVE AL-UANON       TO ACVOTRMA
  8714         ELSE
  8715             MOVE ER-0241        TO EMI-ERROR
  8716             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8717             MOVE AL-UNBON       TO ACVOTRMA
  8718             MOVE 'X'            TO ERROR-SWITCH
  8719             MOVE -1             TO ACVOTRML
  8720     ELSE
  8721         MOVE AL-UANOF           TO ACVOTRMA.
  8722
  8723     IF LCVRATEL GREATER THAN +0
  8724
  8725* EXEC CICS BIF DEEDIT
  8726*            FIELD (LCVRATEI)
  8727*            LENGTH(6)
  8728*        END-EXEC
  8729     MOVE 6
  8730       TO DFHEIV11
  8731*    MOVE '@"L                   #   #00008375' TO DFHEIV0
  8732     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8733     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8734     MOVE X'2020233030303038333735' TO DFHEIV0(25:11)
  8735     CALL 'kxdfhei1' USING DFHEIV0,
  8736           LCVRATEI,
  8737           DFHEIV11
  8738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 158
* EL131.cbl
  8739         IF LCVRATEI IS NUMERIC
  8740             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8741             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8742             MOVE AL-UNNON       TO LCVRATEA
  8743         ELSE
  8744             MOVE ER-2280        TO EMI-ERROR
  8745             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8746             MOVE AL-UNBON       TO LCVRATEA
  8747             MOVE 'X'            TO ERROR-SWITCH
  8748             MOVE -1             TO LCVRATEL
  8749     ELSE
  8750         MOVE AL-UNNOF           TO LCVRATEA.
  8751
  8752     IF ACVRATEL GREATER THAN +0
  8753
  8754* EXEC CICS BIF DEEDIT
  8755*            FIELD (ACVRATEI)
  8756*            LENGTH(6)
  8757*        END-EXEC
  8758     MOVE 6
  8759       TO DFHEIV11
  8760*    MOVE '@"L                   #   #00008393' TO DFHEIV0
  8761     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8762     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8763     MOVE X'2020233030303038333933' TO DFHEIV0(25:11)
  8764     CALL 'kxdfhei1' USING DFHEIV0,
  8765           ACVRATEI,
  8766           DFHEIV11
  8767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8768         IF ACVRATEI IS NUMERIC
  8769             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  8770             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8771             MOVE AL-UNNON       TO ACVRATEA
  8772         ELSE
  8773             MOVE ER-2280        TO EMI-ERROR
  8774             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8775             MOVE AL-UNBON       TO ACVRATEA
  8776             MOVE 'X'            TO ERROR-SWITCH
  8777             MOVE -1             TO ACVRATEL
  8778     ELSE
  8779         MOVE AL-UNNOF           TO ACVRATEA.
  8780
  8781     IF LCVBENEL GREATER THAN ZERO
  8782
  8783* EXEC CICS BIF DEEDIT
  8784*            FIELD (LCVBENEI)
  8785*            LENGTH (11)
  8786*        END-EXEC
  8787     MOVE 11
  8788       TO DFHEIV11
  8789*    MOVE '@"L                   #   #00008411' TO DFHEIV0
  8790     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8791     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8792     MOVE X'2020233030303038343131' TO DFHEIV0(25:11)
  8793     CALL 'kxdfhei1' USING DFHEIV0,
  8794           LCVBENEI,
  8795           DFHEIV11
  8796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 159
* EL131.cbl
  8797         IF LCVBENEI IS NUMERIC
  8798            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8799            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8800            MOVE AL-UNNON        TO LCVBENEA
  8801         ELSE
  8802            MOVE ER-0243         TO EMI-ERROR
  8803            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8804            MOVE AL-UNBON        TO LCVBENEA
  8805            MOVE -1              TO LCVBENEL
  8806            MOVE 'X'             TO ERROR-SWITCH
  8807     ELSE
  8808         MOVE AL-UANOF           TO LCVBENEA.
  8809
  8810     IF ACVBENEL GREATER THAN ZERO
  8811
  8812* EXEC CICS BIF DEEDIT
  8813*            FIELD (ACVBENEI)
  8814*            LENGTH (11)
  8815*        END-EXEC
  8816     MOVE 11
  8817       TO DFHEIV11
  8818*    MOVE '@"L                   #   #00008429' TO DFHEIV0
  8819     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8820     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8821     MOVE X'2020233030303038343239' TO DFHEIV0(25:11)
  8822     CALL 'kxdfhei1' USING DFHEIV0,
  8823           ACVBENEI,
  8824           DFHEIV11
  8825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8826         IF ACVBENEI IS NUMERIC
  8827            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  8828            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8829            MOVE AL-UNNON        TO ACVBENEA
  8830         ELSE
  8831            MOVE ER-0243         TO EMI-ERROR
  8832            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8833            MOVE AL-UNBON        TO ACVBENEA
  8834            MOVE -1              TO ACVBENEL
  8835            MOVE 'X'             TO ERROR-SWITCH
  8836     ELSE
  8837         MOVE AL-UANOF           TO ACVBENEA.
  8838
  8839     IF LCVFORMI GREATER THAN LOW-VALUES
  8840        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8841        MOVE AL-UANON            TO LCVFORMA
  8842     ELSE
  8843        MOVE AL-UANOF            TO LCVFORMA.
  8844
  8845     IF ACVFORMI GREATER THAN LOW-VALUES
  8846        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8847        MOVE AL-UANON            TO ACVFORMA
  8848     ELSE
  8849        MOVE AL-UANOF            TO ACVFORMA.
  8850
  8851     IF LCVCNDTL GREATER THAN ZERO
  8852         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8853         IF LCVCNDTI = SPACES
  8854             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 160
* EL131.cbl
  8855         ELSE
  8856             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  8857             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8858             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8859             MOVE '4'            TO DC-OPTION-CODE
  8860             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8861             IF NOT DATE-CONVERSION-ERROR
  8862                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  8863                 MOVE AL-UANON   TO LCVCNDTA
  8864                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8865                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  8866             ELSE
  8867                 MOVE ER-0246    TO EMI-ERROR
  8868                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8869                 MOVE AL-UABON   TO LCVCNDTA
  8870                 MOVE -1         TO LCVCNDTL
  8871                 MOVE 'X'        TO ERROR-SWITCH
  8872     ELSE
  8873         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8874         MOVE AL-UANOF           TO LCVCNDTA.
  8875
  8876     IF ACVCNDTL GREATER THAN ZERO
  8877         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8878         IF ACVCNDTI = SPACES
  8879             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8880         ELSE
  8881             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  8882             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8883             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8884             MOVE '4'            TO DC-OPTION-CODE
  8885             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8886             IF NOT DATE-CONVERSION-ERROR
  8887                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  8888                 MOVE AL-UANON   TO ACVCNDTA
  8889                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8890                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  8891             ELSE
  8892                 MOVE ER-0246    TO EMI-ERROR
  8893                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8894                 MOVE AL-UABON   TO ACVCNDTA
  8895                 MOVE -1         TO ACVCNDTL
  8896                 MOVE 'X'        TO ERROR-SWITCH
  8897     ELSE
  8898         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8899         MOVE AL-UANOF           TO ACVCNDTA.
  8900
  8901     IF APRL GREATER THAN +0
  8902
  8903* EXEC CICS BIF DEEDIT
  8904*            FIELD    (APRI)
  8905*            LENGTH   (8)
  8906*        END-EXEC
  8907     MOVE 8
  8908       TO DFHEIV11
  8909*    MOVE '@"L                   #   #00008509' TO DFHEIV0
  8910     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8911     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8912     MOVE X'2020233030303038353039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 161
* EL131.cbl
  8913     CALL 'kxdfhei1' USING DFHEIV0,
  8914           APRI,
  8915           DFHEIV11
  8916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8917         IF APRI NUMERIC
  8918            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8919            MOVE APRI            TO HOLD-APR APRO
  8920            MOVE AL-UANON        TO APRA
  8921          ELSE
  8922            MOVE ER-0259         TO EMI-ERROR
  8923            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8924            MOVE AL-UABON        TO APRA
  8925            MOVE -1              TO APRL
  8926            MOVE 'X'             TO ERROR-SWITCH
  8927     ELSE
  8928         MOVE AL-UANOF           TO APRA.
  8929
  8930     IF PMTFREQL GREATER THAN ZERO
  8931
  8932* EXEC CICS BIF DEEDIT
  8933*            FIELD    (PMTFREQI)
  8934*            LENGTH   (2)
  8935*        END-EXEC
  8936     MOVE 2
  8937       TO DFHEIV11
  8938*    MOVE '@"L                   #   #00008527' TO DFHEIV0
  8939     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8940     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8941     MOVE X'2020233030303038353237' TO DFHEIV0(25:11)
  8942     CALL 'kxdfhei1' USING DFHEIV0,
  8943           PMTFREQI,
  8944           DFHEIV11
  8945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8946         IF PMTFREQI NUMERIC
  8947            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  8948            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8949            MOVE AL-UANON        TO PMTFREQA
  8950          ELSE
  8951            MOVE ER-0427         TO EMI-ERROR
  8952            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8953            MOVE AL-UABON        TO PMTFREQA
  8954            MOVE -1              TO PMTFREQL
  8955            MOVE 'X'             TO ERROR-SWITCH
  8956     ELSE
  8957         MOVE AL-UANOF           TO PMTFREQA.
  8958
  8959     IF INDGRPL GREATER THAN ZERO
  8960         IF INDGRPI = 'I' OR 'G' OR SPACE
  8961             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8962             MOVE AL-UANON       TO INDGRPA
  8963          ELSE
  8964             MOVE ER-0260        TO EMI-ERROR
  8965             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8966             MOVE AL-UABON       TO INDGRPA
  8967             MOVE -1             TO INDGRPL
  8968             MOVE 'X'            TO ERROR-SWITCH
  8969     ELSE
  8970         MOVE AL-UANOF           TO INDGRPA.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 162
* EL131.cbl
  8971
  8972     IF PREMTYPL GREATER THAN ZERO
  8973         IF PREMTYPI = '1' OR '2' OR '3'
  8974            MOVE PREMTYPI        TO PI-PREM-TYPE
  8975            MOVE AL-UNNON        TO PREMTYPA
  8976            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8977          ELSE
  8978            MOVE ER-0227         TO EMI-ERROR
  8979            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8980            MOVE AL-UNBON        TO PREMTYPA
  8981            MOVE -1              TO PREMTYPL
  8982            MOVE 'X'             TO ERROR-SWITCH
  8983     ELSE
  8984         MOVE AL-UANOF           TO PREMTYPA.
  8985
  8986     IF LOANBALL GREATER THAN ZERO
  8987
  8988* EXEC CICS BIF DEEDIT
  8989*             FIELD    (LOANBALI)
  8990*             LENGTH   (9)
  8991*        END-EXEC
  8992     MOVE 9
  8993       TO DFHEIV11
  8994*    MOVE '@"L                   #   #00008572' TO DFHEIV0
  8995     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8996     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8997     MOVE X'2020233030303038353732' TO DFHEIV0(25:11)
  8998     CALL 'kxdfhei1' USING DFHEIV0,
  8999           LOANBALI,
  9000           DFHEIV11
  9001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9002         IF LOANBALI NUMERIC
  9003             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9004             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9005             MOVE AL-UNNON TO LOANBALA
  9006         ELSE
  9007             MOVE ER-0639        TO EMI-ERROR
  9008             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9009             MOVE AL-UNBON       TO LOANBALA
  9010             MOVE -1             TO LOANBALL
  9011             MOVE 'X'            TO ERROR-SWITCH
  9012     ELSE
  9013         MOVE AL-UNNOF           TO LOANBALA.
  9014
  9015     IF LOANNOL GREATER THAN ZERO
  9016        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9017        MOVE AL-UANON            TO LOANNOA
  9018     ELSE
  9019        MOVE AL-UANOF            TO LOANNOA.
  9020
  9021     IF REINCDI GREATER THAN LOW-VALUES
  9022        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9023        MOVE AL-UANON            TO REINCDA
  9024     ELSE
  9025        MOVE AL-UANOF            TO REINCDA.
  9026
  9027     IF CERTI GREATER THAN LOW-VALUES
  9028         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 163
* EL131.cbl
  9029     ELSE
  9030         MOVE AL-UANOF           TO CERTA.
  9031
  9032     IF CERTEFFI GREATER THAN LOW-VALUES
  9033         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9034     ELSE
  9035         MOVE AL-UANOF           TO CERTEFFA.
  9036
  9037     IF CERTACTI GREATER THAN LOW-VALUES
  9038         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9039     ELSE
  9040         MOVE AL-UANOF           TO CERTACTA.
  9041
  9042     IF CERTSTI GREATER THAN LOW-VALUES
  9043         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9044     ELSE
  9045         MOVE AL-UANOF           TO CERTSTA.
  9046
  9047     IF CERTCARI GREATER THAN LOW-VALUES
  9048         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9049     ELSE
  9050         MOVE AL-UANOF           TO CERTCARA.
  9051
  9052     IF DLYACTV-RECORD-NEEDED
  9053         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9054                 1150-EXIT
  9055     END-IF.
  9056
  9057     IF CERTEFFI GREATER LOW-VALUES OR
  9058        CERTACTI GREATER LOW-VALUES OR
  9059        CERTSTI  GREATER LOW-VALUES OR
  9060        CERTCARI GREATER LOW-VALUES OR
  9061        CERTGRPI GREATER LOW-VALUES
  9062        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9063
  9064*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9065*      IF PI-PREM-TYPE NOT = '1'  AND
  9066*         PI-NO-PMTS = ZEROS
  9067*          IF LOANBALL GREATER +0 OR
  9068*             ACVBENEL GREATER +0
  9069*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9070
  9071     if accswl > zeros
  9072        if accswi = 'Y' OR 'N'
  9073           MOVE 'X'              TO UPDATE-SWITCH
  9074                                    MSTR-SWITCH
  9075           MOVE AL-UANON         TO accswa
  9076        else
  9077           move er-1656          to emi-error
  9078           PERFORM 9900-ERROR-FORMAT
  9079                                 THRU 9900-EXIT
  9080           move al-uabon         to accswa
  9081           move -1               to accswl
  9082           move 'X'              to error-switch
  9083           move al-uanof         to accswa
  9084        end-if
  9085     end-if
  9086     IF CERTL = ZEROS AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 164
* EL131.cbl
  9087        SUFXL = ZEROS
  9088          GO TO 1010-EXIT.
  9089
  9090     IF CERTL GREATER THAN ZEROS
  9091         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9092             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9093             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9094             MOVE 'X'            TO ERROR-SWITCH
  9095             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9096
  9097     IF SUFXL GREATER THAN ZEROS
  9098         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9099             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9100             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9101             MOVE 'X'            TO ERROR-SWITCH
  9102             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9103
  9104 1010-EXIT.
  9105     EXIT.
  9106
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 165
* EL131.cbl
  9108 1120-EDIT-PROC.
  9109     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9110     MOVE '2'                    TO CNTL-REC-TYPE.
  9111     MOVE PROCI                  TO CNTL-PROC-ID.
  9112     MOVE ZERO                   TO CNTL-SEQ-NO.
  9113
  9114
  9115* EXEC CICS HANDLE CONDITION
  9116*         NOTFND    (1120-CNTL-NOTFND)
  9117*    END-EXEC.
  9118*    MOVE '"$I                   ! & #00008688' TO DFHEIV0
  9119     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9121     MOVE X'2620233030303038363838' TO DFHEIV0(25:11)
  9122     CALL 'kxdfhei1' USING DFHEIV0
  9123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9124
  9125
  9126
  9127* EXEC CICS READ
  9128*         SET      (ADDRESS OF CONTROL-FILE)
  9129*         DATASET  (CNTL-FILE-ID)
  9130*         RIDFLD   (CNTL-KEY)
  9131*    END-EXEC.
  9132*    MOVE '&"S        E          (   #00008692' TO DFHEIV0
  9133     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9135     MOVE X'2020233030303038363932' TO DFHEIV0(25:11)
  9136     CALL 'kxdfhei1' USING DFHEIV0,
  9137           CNTL-FILE-ID,
  9138           DFHEIV20,
  9139           DFHEIV99,
  9140           CNTL-KEY,
  9141           DFHEIV99,
  9142           DFHEIV99,
  9143           DFHEIV99
  9144     SET ADDRESS OF CONTROL-FILE TO
  9145         DFHEIV20
  9146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9147
  9148
  9149     MOVE AL-UANON               TO PROCA.
  9150     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9151     GO TO 1120-EXIT.
  9152
  9153 1120-CNTL-NOTFND.
  9154     MOVE ER-0273                TO EMI-ERROR.
  9155     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9156     MOVE AL-UABON               TO PROCA.
  9157     MOVE -1                     TO PROCL.
  9158     MOVE 'X'                    TO ERROR-SWITCH.
  9159
  9160 1120-EXIT.
  9161     EXIT.
  9162
  9163*************************************************************
  9164*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9165*************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 166
* EL131.cbl
  9166
  9167 1150-OUTPUT-ACTIVITY-RECORD.
  9168
  9169
  9170* EXEC CICS GETMAIN
  9171*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9172*        LENGTH (25)
  9173*        INITIMG (WS-BLANK)
  9174*    END-EXEC.
  9175     MOVE 25
  9176       TO DFHEIV11
  9177*    MOVE ',"IL                  $   #00008718' TO DFHEIV0
  9178     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9179     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9180     MOVE X'2020233030303038373138' TO DFHEIV0(25:11)
  9181     CALL 'kxdfhei1' USING DFHEIV0,
  9182           DFHEIV20,
  9183           DFHEIV11,
  9184           WS-BLANK
  9185     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9186         DFHEIV20
  9187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9188
  9189
  9190     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9191     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9192     MOVE PI-CARRIER             TO DA-CARRIER.
  9193     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9194     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9195     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9196     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9197
  9198
  9199* EXEC CICS HANDLE CONDITION
  9200*        NOTOPEN (1150-NOTOPEN-ERROR)
  9201*        DUPREC (1150-EXIT)
  9202*    END-EXEC.
  9203*    MOVE '"$J%                  ! '' #00008732' TO DFHEIV0
  9204     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9206     MOVE X'2720233030303038373332' TO DFHEIV0(25:11)
  9207     CALL 'kxdfhei1' USING DFHEIV0
  9208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9209
  9210     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9211     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9212     MOVE 'A'                    TO JP-RECORD-TYPE.
  9213     MOVE +48                    TO JOURNAL-LENGTH.
  9214
  9215
  9216* EXEC CICS WRITE
  9217*        DATASET ('DLYACTV')
  9218*        RIDFLD (DA-KEY)
  9219*        FROM (DAILY-ACTIVITY-RECORD)
  9220*        LENGTH (25)
  9221*    END-EXEC.
  9222     MOVE 'DLYACTV' TO DFHEIV1
  9223     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 167
* EL131.cbl
  9224       TO DFHEIV11
  9225*    MOVE '&$ L                  ''   #00008741' TO DFHEIV0
  9226     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9227     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9228     MOVE X'2020233030303038373431' TO DFHEIV0(25:11)
  9229     CALL 'kxdfhei1' USING DFHEIV0,
  9230           DFHEIV1,
  9231           DAILY-ACTIVITY-RECORD,
  9232           DFHEIV11,
  9233           DA-KEY,
  9234           DFHEIV99,
  9235           DFHEIV99
  9236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9237
  9238
  9239     GO TO 1150-EXIT.
  9240
  9241 1150-NOTOPEN-ERROR.
  9242
  9243     MOVE '2955'                 TO EMI-ERROR.
  9244     MOVE -1                     TO MAINTL.
  9245     MOVE AL-UANON               TO MAINTA.
  9246     MOVE 'X'                    TO ERROR-SWITCH.
  9247     PERFORM 9900-ERROR-FORMAT THRU
  9248             9900-EXIT.
  9249
  9250 1150-EXIT.
  9251     EXIT.
  9252
  9253*************************************************************
  9254*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9255*************************************************************
  9256
  9257 1240-EDIT-LIFE-CODE.
  9258
  9259     IF INVALID-BENEFIT-CODE
  9260         GO TO 1240-SET-ERROR.
  9261
  9262     MOVE SPACES                 TO BENEFIT-KEY.
  9263     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9264     MOVE '4'                    TO BEN-REC-TYPE.
  9265     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9266     MOVE ZERO                   TO BEN-SEQ-NO.
  9267
  9268
  9269* EXEC CICS READ GTEQ
  9270*         DATASET  (CNTL-FILE-ID)
  9271*         RIDFLD   (BENEFIT-KEY)
  9272*         SET      (ADDRESS OF CONTROL-FILE)
  9273*    END-EXEC.
  9274*    MOVE '&"S        G          (   #00008777' TO DFHEIV0
  9275     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9277     MOVE X'2020233030303038373737' TO DFHEIV0(25:11)
  9278     CALL 'kxdfhei1' USING DFHEIV0,
  9279           CNTL-FILE-ID,
  9280           DFHEIV20,
  9281           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 168
* EL131.cbl
  9282           BENEFIT-KEY,
  9283           DFHEIV99,
  9284           DFHEIV99,
  9285           DFHEIV99
  9286     SET ADDRESS OF CONTROL-FILE TO
  9287         DFHEIV20
  9288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9289
  9290
  9291     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9292        CF-RECORD-TYPE NOT = '4'
  9293         GO TO 1240-SET-ERROR.
  9294
  9295     MOVE ZERO                   TO COUNT-2.
  9296     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9297
  9298     IF SCREEN-ERROR
  9299         GO TO 1240-SET-ERROR.
  9300
  9301 1240-SET-CODE-SWITCHES.
  9302     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9303     MOVE AL-UANON               TO LCVCDA.
  9304     GO TO 1240-EXIT.
  9305
  9306 1240-SET-ERROR.
  9307     MOVE ER-0240                TO EMI-ERROR.
  9308     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9309     MOVE 'X'                    TO ERROR-SWITCH.
  9310     MOVE AL-UABON               TO LCVCDA.
  9311     MOVE -1                     TO LCVCDL.
  9312
  9313 1240-EXIT.
  9314     EXIT.
  9315
  9316 1310-EDIT-AH-CODE.
  9317     IF INVALID-BENEFIT-CODE
  9318         GO TO 1310-SET-ERROR.
  9319
  9320     MOVE SPACES                 TO BENEFIT-KEY.
  9321     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9322     MOVE '5'                    TO BEN-REC-TYPE.
  9323     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9324     MOVE ZERO                   TO BEN-SEQ-NO.
  9325
  9326
  9327* EXEC CICS READ GTEQ
  9328*         DATASET  (CNTL-FILE-ID)
  9329*         RIDFLD   (BENEFIT-KEY)
  9330*         SET      (ADDRESS OF CONTROL-FILE)
  9331*    END-EXEC.
  9332*    MOVE '&"S        G          (   #00008818' TO DFHEIV0
  9333     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9335     MOVE X'2020233030303038383138' TO DFHEIV0(25:11)
  9336     CALL 'kxdfhei1' USING DFHEIV0,
  9337           CNTL-FILE-ID,
  9338           DFHEIV20,
  9339           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 169
* EL131.cbl
  9340           BENEFIT-KEY,
  9341           DFHEIV99,
  9342           DFHEIV99,
  9343           DFHEIV99
  9344     SET ADDRESS OF CONTROL-FILE TO
  9345         DFHEIV20
  9346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9347
  9348
  9349     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9350        CF-RECORD-TYPE NOT = '5'
  9351         GO TO 1310-SET-ERROR.
  9352
  9353     MOVE ZERO                   TO COUNT-2.
  9354     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9355     IF SCREEN-ERROR
  9356         GO TO 1310-SET-ERROR.
  9357
  9358 1310-SET-CODE-SWITCHES.
  9359     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9360     MOVE AL-UANON               TO ACVCDA.
  9361     GO TO 1310-EXIT.
  9362
  9363 1310-SET-ERROR.
  9364     MOVE ER-0250                TO EMI-ERROR.
  9365     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9366     MOVE AL-UABON               TO ACVCDA.
  9367     MOVE 'X'                    TO ERROR-SWITCH.
  9368     MOVE -1                     TO ACVCDL.
  9369
  9370 1310-EXIT.
  9371     EXIT.
  9372
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 170
* EL131.cbl
  9374 1460-EDIT-CERT-NO.
  9375     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9376     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9377
  9378     IF WS-SAVE-CERT-NO = SPACES
  9379         MOVE ER-0203            TO EMI-ERROR
  9380         GO TO 1460-CERT-NO-ERROR.
  9381
  9382     IF WS-CERT-NO-PRIME = SPACES AND
  9383        WS-CERT-NO-SUFX GREATER THAN SPACE
  9384            MOVE ER-0210         TO EMI-ERROR
  9385            GO TO 1460-CERT-NO-ERROR.
  9386
  9387     MOVE 'X'                    TO UPDATE-SWITCH.
  9388     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9389     MOVE AL-UANON               TO CERTA.
  9390
  9391     IF SUFXL IS GREATER THAN 0
  9392         MOVE AL-UANON           TO SUFXA.
  9393
  9394     GO TO 1460-EXIT.
  9395
  9396 1460-CERT-NO-ERROR.
  9397     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9398     MOVE AL-UABON               TO SUFXA.
  9399     MOVE AL-UABON               TO CERTA.
  9400     MOVE -1                     TO CERTL.
  9401     MOVE 'X'                    TO ERROR-SWITCH.
  9402
  9403 1460-EXIT.
  9404     EXIT.
  9405
  9406 1470-EDIT-EFF.
  9407     IF CERTEFFI = SPACES
  9408         GO TO 1470-DATE-ERROR.
  9409
  9410     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9411     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9412     IF DEEDIT-DATE = ZERO
  9413         GO TO 1470-DATE-ERROR.
  9414
  9415     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9416     MOVE '4'                    TO DC-OPTION-CODE.
  9417     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9418     IF NOT DATE-CONVERSION-ERROR
  9419         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9420         MOVE AL-UANON           TO CERTEFFA
  9421         MOVE 'X'                TO UPDATE-SWITCH
  9422         MOVE 'Y'                TO CERT-KEY-SWITCH
  9423         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9424         GO TO 1470-EXIT.
  9425
  9426 1470-DATE-ERROR.
  9427     MOVE ER-0215                TO EMI-ERROR.
  9428     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9429     MOVE AL-UABON               TO CERTEFFA.
  9430     MOVE -1                     TO CERTEFFL.
  9431     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 171
* EL131.cbl
  9432
  9433 1470-EXIT.
  9434     EXIT.
  9435
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 172
* EL131.cbl
  9437 1480-EDIT-ACCT.
  9438     IF CERTACTI = SPACES
  9439         MOVE ER-0232            TO EMI-ERROR
  9440         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9441         MOVE AL-UABON           TO CERTACTA
  9442         MOVE -1                 TO CERTACTL
  9443         MOVE 'X'                TO ERROR-SWITCH
  9444     ELSE
  9445         MOVE 'X'                TO UPDATE-SWITCH
  9446         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9447
  9448 1480-EXIT.
  9449     EXIT.
  9450
  9451 1490-EDIT-STATE.
  9452     IF CERTSTI = SPACES
  9453         MOVE ER-0233            TO EMI-ERROR
  9454         GO TO 1490-STATE-ERROR.
  9455
  9456     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9457     MOVE '3'                    TO CNTL-REC-TYPE.
  9458     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9459     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9460     MOVE ZERO                   TO CNTL-SEQ-NO.
  9461
  9462
  9463* EXEC CICS HANDLE CONDITION
  9464*         NOTFND (1490-STATE-NOTFND)
  9465*    END-EXEC.
  9466*    MOVE '"$I                   ! ( #00008937' TO DFHEIV0
  9467     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9468     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9469     MOVE X'2820233030303038393337' TO DFHEIV0(25:11)
  9470     CALL 'kxdfhei1' USING DFHEIV0
  9471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9472
  9473
  9474
  9475* EXEC CICS READ
  9476*         SET        (ADDRESS OF CONTROL-FILE)
  9477*         DATASET    ('ELCNTL')
  9478*         RIDFLD     (CNTL-KEY)
  9479*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9480*         GENERIC
  9481*    END-EXEC.
  9482     MOVE 'ELCNTL' TO DFHEIV1
  9483*    MOVE '&"S  KG    E          (   #00008941' TO DFHEIV0
  9484     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9485     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9486     MOVE X'2020233030303038393431' TO DFHEIV0(25:11)
  9487     CALL 'kxdfhei1' USING DFHEIV0,
  9488           DFHEIV1,
  9489           DFHEIV20,
  9490           DFHEIV99,
  9491           CNTL-KEY,
  9492           CNTL-GENERIC-LENGTH,
  9493           DFHEIV99,
  9494           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 173
* EL131.cbl
  9495     SET ADDRESS OF CONTROL-FILE TO
  9496         DFHEIV20
  9497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9498
  9499
  9500     MOVE AL-UANON               TO CERTSTA.
  9501     MOVE 'X'                    TO UPDATE-SWITCH.
  9502     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9503     GO TO 1490-EXIT.
  9504
  9505 1490-STATE-NOTFND.
  9506     MOVE ER-0149                TO EMI-ERROR.
  9507
  9508 1490-STATE-ERROR.
  9509     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9510     MOVE AL-UABON               TO CERTSTA.
  9511     MOVE -1                     TO CERTSTL.
  9512     MOVE 'X'                    TO ERROR-SWITCH.
  9513
  9514 1490-EXIT.
  9515     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 174
* EL131.cbl
  9517 1500-EDIT-CARR.
  9518     IF CERTCARI = SPACES
  9519         GO TO 1500-CARR-NOTFND.
  9520
  9521     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9522     MOVE '6'                    TO CNTL-REC-TYPE.
  9523     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9524     MOVE CERTCARI               TO CNTL-CARRIER.
  9525     MOVE ZERO                   TO CNTL-SEQ-NO.
  9526
  9527
  9528* EXEC CICS HANDLE CONDITION
  9529*         NOTFND   (1500-CARR-NOTFND)
  9530*    END-EXEC.
  9531*    MOVE '"$I                   ! ) #00008976' TO DFHEIV0
  9532     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9534     MOVE X'2920233030303038393736' TO DFHEIV0(25:11)
  9535     CALL 'kxdfhei1' USING DFHEIV0
  9536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9537
  9538
  9539
  9540* EXEC CICS READ
  9541*         SET        (ADDRESS OF CONTROL-FILE)
  9542*         DATASET    ('ELCNTL')
  9543*         RIDFLD     (CNTL-KEY)
  9544*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9545*         GENERIC
  9546*    END-EXEC.
  9547     MOVE 'ELCNTL' TO DFHEIV1
  9548*    MOVE '&"S  KG    E          (   #00008980' TO DFHEIV0
  9549     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9550     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9551     MOVE X'2020233030303038393830' TO DFHEIV0(25:11)
  9552     CALL 'kxdfhei1' USING DFHEIV0,
  9553           DFHEIV1,
  9554           DFHEIV20,
  9555           DFHEIV99,
  9556           CNTL-KEY,
  9557           CNTL-GENERIC-LENGTH,
  9558           DFHEIV99,
  9559           DFHEIV99
  9560     SET ADDRESS OF CONTROL-FILE TO
  9561         DFHEIV20
  9562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9563
  9564
  9565     MOVE AL-UANON               TO CERTCARA.
  9566     MOVE 'X'                    TO UPDATE-SWITCH.
  9567     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9568     GO TO 1500-EXIT.
  9569
  9570 1500-CARR-NOTFND.
  9571     MOVE ER-0360                TO EMI-ERROR.
  9572     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9573     MOVE AL-UABON               TO CERTCARA.
  9574     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 175
* EL131.cbl
  9575     MOVE 'X'                    TO ERROR-SWITCH.
  9576
  9577 1500-EXIT.
  9578     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 176
* EL131.cbl
  9580 1510-DEEDIT-DATE.
  9581
  9582* EXEC CICS BIF DEEDIT
  9583*         FIELD    (DEEDIT-DATE-INPUT)
  9584*         LENGTH   (DATE-LENGTH)
  9585*    END-EXEC.
  9586*    MOVE '@"L                   #   #00009004' TO DFHEIV0
  9587     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9588     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9589     MOVE X'2020233030303039303034' TO DFHEIV0(25:11)
  9590     CALL 'kxdfhei1' USING DFHEIV0,
  9591           DEEDIT-DATE-INPUT,
  9592           DATE-LENGTH
  9593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9594
  9595
  9596 1510-EXIT.
  9597     EXIT.
  9598
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 177
* EL131.cbl
  9600 1620-VERIFY-ACCT.
  9601
  9602     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9603     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9604     MOVE PI-GROUPING            TO ACCT-GROUP.
  9605     MOVE PI-STATE               TO ACCT-STATE.
  9606     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9607
  9608     IF CERTEFFI GREATER THAN LOW-VALUES
  9609         MOVE HOLD-EFF           TO ACCT-DATE
  9610     ELSE
  9611         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9612
  9613     IF CERTACTI GREATER THAN LOW-VALUES
  9614         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9615     IF CERTSTI GREATER THAN LOW-VALUES
  9616         MOVE CERTSTI            TO  ACCT-STATE.
  9617     IF CERTCARI GREATER THAN LOW-VALUES
  9618         MOVE CERTCARI           TO  ACCT-CARRIER.
  9619     IF CERTGRPI GREATER THAN LOW-VALUES
  9620         MOVE CERTGRPI           TO ACCT-GROUP.
  9621
  9622     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9623
  9624
  9625* EXEC CICS HANDLE CONDITION
  9626*         NOTFND  (1620-ACCT-NOTFND)
  9627*    END-EXEC.
  9628*    MOVE '"$I                   ! * #00009037' TO DFHEIV0
  9629     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9630     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9631     MOVE X'2A20233030303039303337' TO DFHEIV0(25:11)
  9632     CALL 'kxdfhei1' USING DFHEIV0
  9633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9634
  9635
  9636
  9637* EXEC CICS STARTBR
  9638*         DATASET   (ACCT-FILE-ID)
  9639*         RIDFLD    (ACCT-KEY)
  9640*    END-EXEC.
  9641     MOVE 0
  9642       TO DFHEIV11
  9643*    MOVE '&,         G          &   #00009041' TO DFHEIV0
  9644     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9645     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9646     MOVE X'2020233030303039303431' TO DFHEIV0(25:11)
  9647     CALL 'kxdfhei1' USING DFHEIV0,
  9648           ACCT-FILE-ID,
  9649           ACCT-KEY,
  9650           DFHEIV99,
  9651           DFHEIV11,
  9652           DFHEIV99
  9653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9654
  9655
  9656 1620-ACCT-LOOP.
  9657
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 178
* EL131.cbl
  9658
  9659* EXEC CICS READNEXT
  9660*         DATASET  (ACCT-FILE-ID)
  9661*         RIDFLD   (ACCT-KEY)
  9662*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9663*    END-EXEC.
  9664     MOVE 0
  9665       TO DFHEIV11
  9666*    MOVE '&.S                   )   #00009048' TO DFHEIV0
  9667     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9668     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9669     MOVE X'2020233030303039303438' TO DFHEIV0(25:11)
  9670     CALL 'kxdfhei1' USING DFHEIV0,
  9671           ACCT-FILE-ID,
  9672           DFHEIV20,
  9673           DFHEIV99,
  9674           ACCT-KEY,
  9675           DFHEIV99,
  9676           DFHEIV11,
  9677           DFHEIV99,
  9678           DFHEIV99
  9679     SET ADDRESS OF ACCOUNT-MASTER TO
  9680         DFHEIV20
  9681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9682
  9683
  9684     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9685         GO TO 1620-ACCT-NOTFND.
  9686
  9687     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9688        HOLD-EFF     LESS AM-EXPIRATION-DT
  9689         NEXT SENTENCE
  9690     ELSE
  9691         GO TO 1620-ACCT-LOOP.
  9692
  9693     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9694         GO TO 1620-ACCT-END-BROWSE.
  9695
  9696     IF LOANBALL GREATER THAN +0
  9697         IF AM-MAX-TOT-BEN NUMERIC  AND
  9698            AM-MAX-TOT-BEN GREATER THAN ZERO
  9699             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9700                 MOVE AL-UNBON     TO LOANBALA
  9701                 MOVE -1           TO LOANBALL
  9702                 MOVE 'X'          TO ERROR-SWITCH
  9703                 MOVE ER-7641      TO EMI-ERROR
  9704                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9705
  9706     IF ACVBENEL GREATER THAN +0
  9707         IF AM-MAX-MON-BEN NUMERIC  AND
  9708            AM-MAX-MON-BEN GREATER THAN ZERO
  9709             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9710                 MOVE AL-UNBON     TO ACVBENEA
  9711                 MOVE -1           TO ACVBENEL
  9712                 MOVE 'X'          TO ERROR-SWITCH
  9713                 MOVE ER-7642      TO EMI-ERROR
  9714                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9715
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 179
* EL131.cbl
  9716 1620-ACCT-END-BROWSE.
  9717
  9718
  9719* EXEC CICS ENDBR
  9720*         DATASET (ACCT-FILE-ID)
  9721*    END-EXEC.
  9722     MOVE 0
  9723       TO DFHEIV11
  9724*    MOVE '&2                    $   #00009088' TO DFHEIV0
  9725     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9726     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9727     MOVE X'2020233030303039303838' TO DFHEIV0(25:11)
  9728     CALL 'kxdfhei1' USING DFHEIV0,
  9729           ACCT-FILE-ID,
  9730           DFHEIV11,
  9731           DFHEIV99
  9732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9733
  9734
  9735     GO TO 1620-EXIT.
  9736
  9737 1620-ACCT-NOTFND.
  9738
  9739     MOVE -1                     TO MAINTL.
  9740     MOVE 'X'                    TO ERROR-SWITCH.
  9741     MOVE ER-0426                TO EMI-ERROR.
  9742     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9743
  9744 1620-EXIT.
  9745     EXIT.
  9746
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 180
* EL131.cbl
  9748 2000-UPDATE-CLAIM.
  9749
  9750     MOVE SPACES                 TO ERROR-SWITCH.
  9751     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9752     MOVE PI-CARRIER             TO CARRIER-CODE.
  9753     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9754     MOVE PI-CERT-NO             TO CERT-NO.
  9755
  9756     IF DELETE-CLAIM
  9757         GO TO 3000-DELETE-CLAIM.
  9758
  9759     IF  NOT MODIFY-CAP
  9760         MOVE ER-0070            TO EMI-ERROR
  9761         MOVE 'X'                TO ERROR-SWITCH
  9762         MOVE -1                 TO MAINTL
  9763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9764         GO TO 2000-EXIT.
  9765
  9766     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9767     MOVE ZERO                   TO TRLR-SEQ-NO.
  9768
  9769
  9770* EXEC CICS READ UPDATE
  9771*         SET       (ADDRESS OF CLAIM-MASTER)
  9772*         DATASET   (CLMS-FILE-ID)
  9773*         RIDFLD    (MSTR-KEY)
  9774*    END-EXEC.
  9775*    MOVE '&"S        EU         (   #00009126' TO DFHEIV0
  9776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9777     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9778     MOVE X'2020233030303039313236' TO DFHEIV0(25:11)
  9779     CALL 'kxdfhei1' USING DFHEIV0,
  9780           CLMS-FILE-ID,
  9781           DFHEIV20,
  9782           DFHEIV99,
  9783           MSTR-KEY,
  9784           DFHEIV99,
  9785           DFHEIV99,
  9786           DFHEIV99
  9787     SET ADDRESS OF CLAIM-MASTER TO
  9788         DFHEIV20
  9789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9790
  9791
  9792     IF HOLD-INCUR NOT = LOW-VALUES AND SPACES
  9793        EVALUATE TRUE
  9794           WHEN HOLD-INCUR < CL-CERT-EFF-DT
  9795              MOVE ER-0458       TO EMI-ERROR
  9796              PERFORM 9900-ERROR-FORMAT
  9797                                 THRU 9900-EXIT
  9798              MOVE AL-UABON      TO INCA
  9799              MOVE -1            TO INCL
  9800              GO TO 8110-SEND-DATA
  9801           WHEN HOLD-INCUR > CL-REPORTED-DT
  9802              MOVE ER-0509       TO EMI-ERROR
  9803              PERFORM 9900-ERROR-FORMAT
  9804                                 THRU 9900-EXIT
  9805              MOVE AL-UABON      TO INCA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 181
* EL131.cbl
  9806              MOVE -1            TO INCL
  9807              GO TO 8110-SEND-DATA
  9808        END-EVALUATE
  9809     END-IF
  9810     IF (CL-PRIORITY-CD = '8')
  9811        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  9812             AND 'AMWA' AND 'KMSB')
  9813        MOVE ER-8003             TO EMI-ERROR
  9814        PERFORM 9900-ERROR-FORMAT
  9815                                 THRU 9900-EXIT
  9816        MOVE -1                  TO MAINTL
  9817        GO TO 8110-SEND-DATA
  9818     END-IF
  9819
  9820     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
  9821         MOVE ER-0068            TO EMI-ERROR
  9822         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9823         GO TO 2000-EXIT.
  9824
  9825     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
  9826         MOVE ER-0068            TO EMI-ERROR
  9827         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9828         GO TO 2000-EXIT.
  9829
  9830     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  9831         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
  9832
  9833     IF CL-PURGED-DT NOT = LOW-VALUES
  9834         MOVE ER-7691            TO EMI-ERROR
  9835         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9836         GO TO 2000-EXIT.
  9837
  9838     IF CERT-KEY-CHANGED
  9839         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
  9840
  9841     IF SCREEN-ERROR
  9842         MOVE ER-0068            TO EMI-ERROR
  9843         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9844         GO TO 2000-EXIT.
  9845
  9846     IF NINETY-TRLR-UPDATED
  9847         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
  9848
  9849     IF MSTR-KEY-CHANGED
  9850         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
  9851        ELSE
  9852         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
  9853
  9854     IF TRLR-UPDATE-REQUIRED
  9855         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
  9856
  9857 2000-CHECK-CERT.
  9858     IF NOT CERT-UPDATES
  9859         GO TO 2000-EXIT.
  9860
  9861     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9862     MOVE PI-CARRIER             TO CERT-CARRIER.
  9863     MOVE PI-GROUPING            TO CERT-GROUP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 182
* EL131.cbl
  9864     MOVE PI-STATE               TO CERT-STATE.
  9865     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9866     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9867     MOVE PI-CERT-NO             TO CERT-CERT.
  9868
  9869     IF CERT-ALT-KEY-CHANGED
  9870         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
  9871     ELSE
  9872         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
  9873
  9874 2000-EXIT.
  9875     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 183
* EL131.cbl
  9877 2010-RELEASE-REC.
  9878
  9879* EXEC CICS UNLOCK
  9880*         DATASET  (CLMS-FILE-ID)
  9881*    END-EXEC
  9882*    MOVE '&*                    #   #00009218' TO DFHEIV0
  9883     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9884     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9885     MOVE X'2020233030303039323138' TO DFHEIV0(25:11)
  9886     CALL 'kxdfhei1' USING DFHEIV0,
  9887           CLMS-FILE-ID,
  9888           DFHEIV99
  9889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9890
  9891     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9892     MOVE 'X'                    TO ERROR-SWITCH.
  9893
  9894 2010-EXIT.
  9895     EXIT.
  9896
  9897 2020-NORMAL-UPDATE.
  9898     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9899
  9900     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9901
  9902     IF WS-OPEN-CLOSE-SW = 'Y'
  9903       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9904       IF PI-REC-FOUND-SW = 'Y'
  9905         IF CL-ACTIVITY-CODE = 09
  9906           NEXT SENTENCE
  9907         ELSE
  9908           IF WS-RESET-SW = 'Y'
  9909             IF CL-CLAIM-STATUS = 'C'
  9910               MOVE 07               TO  CL-ACTIVITY-CODE
  9911               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9912               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
  9913             ELSE
  9914               MOVE 08               TO  CL-ACTIVITY-CODE
  9915               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9916               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
  9917
  9918     IF PI-COMPANY-ID = 'CID' or 'AHL'
  9919         MOVE 'Y'                TO CL-YESNOSW
  9920     END-IF.
  9921
  9922     if pi-company-id = 'DCC'
  9923        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9924        perform 2120-check-pdef  thru 2120-exit
  9925     end-if
  9926
  9927* EXEC CICS HANDLE CONDITION
  9928*         DUPKEY   (2020-EXIT)
  9929*    END-EXEC.
  9930*    MOVE '"$$                   ! + #00009257' TO DFHEIV0
  9931     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9933     MOVE X'2B20233030303039323537' TO DFHEIV0(25:11)
  9934     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 184
* EL131.cbl
  9935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9936
  9937
  9938
  9939* EXEC CICS REWRITE
  9940*         DATASET   (CLMS-FILE-ID)
  9941*         FROM      (CLAIM-MASTER)
  9942*    END-EXEC.
  9943     MOVE LENGTH OF
  9944      CLAIM-MASTER
  9945       TO DFHEIV11
  9946*    MOVE '&& L                  %   #00009261' TO DFHEIV0
  9947     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9948     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9949     MOVE X'2020233030303039323631' TO DFHEIV0(25:11)
  9950     CALL 'kxdfhei1' USING DFHEIV0,
  9951           CLMS-FILE-ID,
  9952           CLAIM-MASTER,
  9953           DFHEIV11,
  9954           DFHEIV99
  9955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9956
  9957
  9958 2020-EXIT.
  9959     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 185
* EL131.cbl
  9961 2030-KEY-UPDATE.
  9962     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
  9963
  9964
  9965* EXEC CICS DELETE
  9966*        DATASET  (CLMS-FILE-ID)
  9967*    END-EXEC.
  9968*    MOVE '&(                    &   #00009272' TO DFHEIV0
  9969     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9971     MOVE X'2020233030303039323732' TO DFHEIV0(25:11)
  9972     CALL 'kxdfhei1' USING DFHEIV0,
  9973           CLMS-FILE-ID,
  9974           DFHEIV99,
  9975           DFHEIV99,
  9976           DFHEIV99,
  9977           DFHEIV99
  9978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9979
  9980
  9981
  9982* EXEC CICS GETMAIN
  9983*         SET      (ADDRESS OF CLAIM-MASTER)
  9984*         LENGTH   (MSTR-LENGTH)
  9985*         INITIMG  (GETMAIN-SPACE)
  9986*    END-EXEC.
  9987*    MOVE ',"IL                  $   #00009276' TO DFHEIV0
  9988     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9989     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9990     MOVE X'2020233030303039323736' TO DFHEIV0(25:11)
  9991     CALL 'kxdfhei1' USING DFHEIV0,
  9992           DFHEIV20,
  9993           MSTR-LENGTH,
  9994           GETMAIN-SPACE
  9995     SET ADDRESS OF CLAIM-MASTER TO
  9996         DFHEIV20
  9997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9998
  9999
 10000     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10001
 10002     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10003
 10004     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10005
 10006     IF WS-OPEN-CLOSE-SW = 'Y'
 10007       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10008         IF PI-REC-FOUND-SW = 'Y'
 10009           IF CL-ACTIVITY-CODE = 09
 10010             NEXT SENTENCE
 10011           ELSE
 10012             IF WS-RESET-SW = 'Y'
 10013               IF CL-CLAIM-STATUS = 'C'
 10014                 MOVE 07             TO  CL-ACTIVITY-CODE
 10015                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10016                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10017               ELSE
 10018                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 186
* EL131.cbl
 10019                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10020                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10021
 10022
 10023* EXEC CICS HANDLE CONDITION
 10024*         DUPKEY    (2030-EXIT)
 10025*    END-EXEC.
 10026*    MOVE '"$$                   ! , #00009304' TO DFHEIV0
 10027     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10028     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10029     MOVE X'2C20233030303039333034' TO DFHEIV0(25:11)
 10030     CALL 'kxdfhei1' USING DFHEIV0
 10031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10032
 10033
 10034** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10035*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10036
 10037     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10038         MOVE 'Y'                TO CL-YESNOSW
 10039     END-IF.
 10040
 10041
 10042* EXEC CICS WRITE
 10043*         DATASET   (CLMS-FILE-ID)
 10044*         RIDFLD    (MSTR-KEY)
 10045*         FROM      (CLAIM-MASTER)
 10046*    END-EXEC.
 10047     MOVE LENGTH OF
 10048      CLAIM-MASTER
 10049       TO DFHEIV11
 10050*    MOVE '&$ L                  ''   #00009315' TO DFHEIV0
 10051     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10052     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10053     MOVE X'2020233030303039333135' TO DFHEIV0(25:11)
 10054     CALL 'kxdfhei1' USING DFHEIV0,
 10055           CLMS-FILE-ID,
 10056           CLAIM-MASTER,
 10057           DFHEIV11,
 10058           MSTR-KEY,
 10059           DFHEIV99,
 10060           DFHEIV99
 10061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10062
 10063
 10064 2030-EXIT.
 10065     EXIT.
 10066
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 187
* EL131.cbl
 10068 2040-NORMAL-UPDATE.
 10069
 10070* EXEC CICS READ UPDATE
 10071*         DATASET  (CERT-FILE-ID)
 10072*         RIDFLD   (CERT-KEY)
 10073*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10074*    END-EXEC.
 10075*    MOVE '&"S        EU         (   #00009326' TO DFHEIV0
 10076     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10077     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10078     MOVE X'2020233030303039333236' TO DFHEIV0(25:11)
 10079     CALL 'kxdfhei1' USING DFHEIV0,
 10080           CERT-FILE-ID,
 10081           DFHEIV20,
 10082           DFHEIV99,
 10083           CERT-KEY,
 10084           DFHEIV99,
 10085           DFHEIV99,
 10086           DFHEIV99
 10087     SET ADDRESS OF CERTIFICATE-MASTER TO
 10088         DFHEIV20
 10089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10090
 10091
 10092     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10093
 10094
 10095* EXEC CICS HANDLE CONDITION
 10096*         DUPKEY   (2040-EXIT)
 10097*    END-EXEC.
 10098*    MOVE '"$$                   ! - #00009334' TO DFHEIV0
 10099     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10101     MOVE X'2D20233030303039333334' TO DFHEIV0(25:11)
 10102     CALL 'kxdfhei1' USING DFHEIV0
 10103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10104
 10105
 10106
 10107* EXEC CICS REWRITE
 10108*         DATASET  (CERT-FILE-ID)
 10109*         FROM     (CERTIFICATE-MASTER)
 10110*    END-EXEC.
 10111     MOVE LENGTH OF
 10112      CERTIFICATE-MASTER
 10113       TO DFHEIV11
 10114*    MOVE '&& L                  %   #00009338' TO DFHEIV0
 10115     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10116     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10117     MOVE X'2020233030303039333338' TO DFHEIV0(25:11)
 10118     CALL 'kxdfhei1' USING DFHEIV0,
 10119           CERT-FILE-ID,
 10120           CERTIFICATE-MASTER,
 10121           DFHEIV11,
 10122           DFHEIV99
 10123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10124
 10125
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 188
* EL131.cbl
 10126 2040-EXIT.
 10127     EXIT.
 10128
 10129 2050-KEY-UPDATE.
 10130
 10131* EXEC CICS READ UPDATE
 10132*         DATASET  (CERT-FILE-ID)
 10133*         RIDFLD   (CERT-KEY)
 10134*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10135*    END-EXEC.
 10136*    MOVE '&"S        EU         (   #00009347' TO DFHEIV0
 10137     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10138     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10139     MOVE X'2020233030303039333437' TO DFHEIV0(25:11)
 10140     CALL 'kxdfhei1' USING DFHEIV0,
 10141           CERT-FILE-ID,
 10142           DFHEIV20,
 10143           DFHEIV99,
 10144           CERT-KEY,
 10145           DFHEIV99,
 10146           DFHEIV99,
 10147           DFHEIV99
 10148     SET ADDRESS OF CERTIFICATE-MASTER TO
 10149         DFHEIV20
 10150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10151
 10152
 10153     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10154
 10155
 10156* EXEC CICS DELETE
 10157*         DATASET   (CERT-FILE-ID)
 10158*    END-EXEC.
 10159*    MOVE '&(                    &   #00009355' TO DFHEIV0
 10160     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10161     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10162     MOVE X'2020233030303039333535' TO DFHEIV0(25:11)
 10163     CALL 'kxdfhei1' USING DFHEIV0,
 10164           CERT-FILE-ID,
 10165           DFHEIV99,
 10166           DFHEIV99,
 10167           DFHEIV99,
 10168           DFHEIV99
 10169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10170
 10171
 10172
 10173* EXEC CICS GETMAIN
 10174*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10175*         LENGTH    (CERT-LENGTH)
 10176*         INITIMG   (GETMAIN-SPACE)
 10177*    END-EXEC.
 10178*    MOVE ',"IL                  $   #00009359' TO DFHEIV0
 10179     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10180     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10181     MOVE X'2020233030303039333539' TO DFHEIV0(25:11)
 10182     CALL 'kxdfhei1' USING DFHEIV0,
 10183           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 189
* EL131.cbl
 10184           CERT-LENGTH,
 10185           GETMAIN-SPACE
 10186     SET ADDRESS OF CERTIFICATE-MASTER TO
 10187         DFHEIV20
 10188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10189
 10190
 10191     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10192
 10193     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10194
 10195
 10196* EXEC CICS HANDLE CONDITION
 10197*         DUPKEY (2050-EXIT)
 10198*    END-EXEC.
 10199*    MOVE '"$$                   ! . #00009369' TO DFHEIV0
 10200     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10202     MOVE X'2E20233030303039333639' TO DFHEIV0(25:11)
 10203     CALL 'kxdfhei1' USING DFHEIV0
 10204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10205
 10206
 10207
 10208* EXEC CICS WRITE
 10209*         DATASET  (CERT-FILE-ID)
 10210*         RIDFLD   (CERT-KEY)
 10211*         FROM     (CERTIFICATE-MASTER)
 10212*    END-EXEC.
 10213     MOVE LENGTH OF
 10214      CERTIFICATE-MASTER
 10215       TO DFHEIV11
 10216*    MOVE '&$ L                  ''   #00009373' TO DFHEIV0
 10217     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10218     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10219     MOVE X'2020233030303039333733' TO DFHEIV0(25:11)
 10220     CALL 'kxdfhei1' USING DFHEIV0,
 10221           CERT-FILE-ID,
 10222           CERTIFICATE-MASTER,
 10223           DFHEIV11,
 10224           CERT-KEY,
 10225           DFHEIV99,
 10226           DFHEIV99
 10227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10228
 10229
 10230 2050-EXIT.
 10231     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 190
* EL131.cbl
 10233 2060-CHANGE-CERT.
 10234     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10235     MOVE PI-CARRIER             TO CERT-CARRIER.
 10236     MOVE PI-GROUPING            TO CERT-GROUP.
 10237     MOVE PI-STATE               TO CERT-STATE.
 10238     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10239     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10240     MOVE PI-CERT-NO             TO CERT-CERT.
 10241     IF CERTEFFI GREATER THAN LOW-VALUES
 10242         MOVE HOLD-EFF           TO CERT-DATE.
 10243     IF CERTACTI GREATER THAN LOW-VALUES
 10244         MOVE CERTACTI           TO CERT-ACCOUNT.
 10245     IF CERTSTI GREATER THAN LOW-VALUES
 10246         MOVE CERTSTI            TO CERT-STATE.
 10247     IF CERTCARI GREATER THAN LOW-VALUES
 10248         MOVE CERTCARI           TO CERT-CARRIER.
 10249     IF CERTGRPI GREATER THAN LOW-VALUES
 10250         MOVE CERTGRPI           TO CERT-GROUP.
 10251     IF CERTI GREATER THAN LOW-VALUES
 10252         MOVE CERTI              TO CERT-CERT-PRIME.
 10253     IF SUFXI GREATER THAN LOW-VALUES
 10254         MOVE SUFXI              TO CERT-CERT-SUFX.
 10255
 10256
 10257* EXEC CICS HANDLE CONDITION
 10258*         NOTFND   (2060-CERT-NOTFND)
 10259*    END-EXEC.
 10260*    MOVE '"$I                   ! / #00009405' TO DFHEIV0
 10261     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10263     MOVE X'2F20233030303039343035' TO DFHEIV0(25:11)
 10264     CALL 'kxdfhei1' USING DFHEIV0
 10265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10266
 10267
 10268
 10269* EXEC CICS READ UPDATE
 10270*         DATASET  (CERT-FILE-ID)
 10271*         RIDFLD   (CERT-KEY)
 10272*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10273*    END-EXEC.
 10274*    MOVE '&"S        EU         (   #00009409' TO DFHEIV0
 10275     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10276     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10277     MOVE X'2020233030303039343039' TO DFHEIV0(25:11)
 10278     CALL 'kxdfhei1' USING DFHEIV0,
 10279           CERT-FILE-ID,
 10280           DFHEIV20,
 10281           DFHEIV99,
 10282           CERT-KEY,
 10283           DFHEIV99,
 10284           DFHEIV99,
 10285           DFHEIV99
 10286     SET ADDRESS OF CERTIFICATE-MASTER TO
 10287         DFHEIV20
 10288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10289
 10290
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 191
* EL131.cbl
 10291     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10292
 10293     IF CM-CLAIM-INTERFACE-SW = SPACES
 10294        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10295
 10296
 10297* EXEC CICS HANDLE CONDITION
 10298*         DUPKEY   (2060-DUPKEY)
 10299*    END-EXEC.
 10300*    MOVE '"$$                   ! 0 #00009420' TO DFHEIV0
 10301     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10302     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10303     MOVE X'3020233030303039343230' TO DFHEIV0(25:11)
 10304     CALL 'kxdfhei1' USING DFHEIV0
 10305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10306
 10307
 10308
 10309* EXEC CICS REWRITE
 10310*         DATASET  (CERT-FILE-ID)
 10311*         FROM     (CERTIFICATE-MASTER)
 10312*    END-EXEC.
 10313     MOVE LENGTH OF
 10314      CERTIFICATE-MASTER
 10315       TO DFHEIV11
 10316*    MOVE '&& L                  %   #00009424' TO DFHEIV0
 10317     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10318     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10319     MOVE X'2020233030303039343234' TO DFHEIV0(25:11)
 10320     CALL 'kxdfhei1' USING DFHEIV0,
 10321           CERT-FILE-ID,
 10322           CERTIFICATE-MASTER,
 10323           DFHEIV11,
 10324           DFHEIV99
 10325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10326
 10327
 10328 2060-DUPKEY.
 10329
 10330     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10331
 10332 2060-CHANGE-TRLR-ACTQ.
 10333     IF SCREEN-ERROR
 10334         GO TO 2060-EXIT.
 10335
 10336     IF CERTI    GREATER LOW-VALUES OR
 10337        SUFXI    GREATER LOW-VALUES OR
 10338        CERTCARI GREATER LOW-VALUES
 10339         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10340         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10341
 10342     MOVE SPACES                 TO CERT-KEY-SWITCH
 10343                                    CERT-SWITCH
 10344                                    TRLR-SWITCH
 10345                                    NINETY-TRLR-SWITCH.
 10346     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10347     GO TO 2060-EXIT.
 10348
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 192
* EL131.cbl
 10349 2060-CERT-NOTFND.
 10350     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10351
 10352     IF WS-REC-FOUND-SW = 'N'
 10353         MOVE ER-0206            TO  EMI-ERROR
 10354         MOVE -1                 TO  MAINTL
 10355         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10356
 10357* EXEC CICS UNLOCK
 10358*            DATASET   (CLMS-FILE-ID)
 10359*        END-EXEC
 10360*    MOVE '&*                    #   #00009457' TO DFHEIV0
 10361     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10362     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10363     MOVE X'2020233030303039343537' TO DFHEIV0(25:11)
 10364     CALL 'kxdfhei1' USING DFHEIV0,
 10365           CLMS-FILE-ID,
 10366           DFHEIV99
 10367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10368         GO TO 8110-SEND-DATA.
 10369
 10370     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10371
 10372     GO TO 2060-CHANGE-TRLR-ACTQ.
 10373
 10374 2060-EXIT.
 10375     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 193
* EL131.cbl
 10377 2070-CHECK-OLD.
 10378
 10379
 10380* EXEC CICS HANDLE CONDITION
 10381*        NOTFND   (2070-NOT-FOUND)
 10382*    END-EXEC.
 10383*    MOVE '"$I                   ! 1 #00009471' TO DFHEIV0
 10384     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10386     MOVE X'3120233030303039343731' TO DFHEIV0(25:11)
 10387     CALL 'kxdfhei1' USING DFHEIV0
 10388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10389
 10390
 10391     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10392     MOVE PI-CARRIER             TO CERT-CARRIER.
 10393     MOVE PI-GROUPING            TO CERT-GROUP.
 10394     MOVE PI-STATE               TO CERT-STATE.
 10395     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10396     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10397     MOVE PI-CERT-NO             TO CERT-CERT.
 10398
 10399
 10400* EXEC CICS READ UPDATE
 10401*         DATASET  (CERT-FILE-ID)
 10402*         RIDFLD   (CERT-KEY)
 10403*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10404*    END-EXEC.
 10405*    MOVE '&"S        EU         (   #00009483' TO DFHEIV0
 10406     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10407     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10408     MOVE X'2020233030303039343833' TO DFHEIV0(25:11)
 10409     CALL 'kxdfhei1' USING DFHEIV0,
 10410           CERT-FILE-ID,
 10411           DFHEIV20,
 10412           DFHEIV99,
 10413           CERT-KEY,
 10414           DFHEIV99,
 10415           DFHEIV99,
 10416           DFHEIV99
 10417     SET ADDRESS OF CERTIFICATE-MASTER TO
 10418         DFHEIV20
 10419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10420
 10421
 10422     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10423     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10424     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10425
 10426     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10427         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10428
 10429     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10430       AND
 10431        CERT-WAS-CREATED-FOR-CLAIM
 10432         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10433
 10434* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 194
* EL131.cbl
 10435*             DATASET   (CERT-FILE-ID)
 10436*        END-EXEC
 10437*    MOVE '&(                    &   #00009500' TO DFHEIV0
 10438     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10439     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10440     MOVE X'2020233030303039353030' TO DFHEIV0(25:11)
 10441     CALL 'kxdfhei1' USING DFHEIV0,
 10442           CERT-FILE-ID,
 10443           DFHEIV99,
 10444           DFHEIV99,
 10445           DFHEIV99,
 10446           DFHEIV99
 10447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10448         GO TO 2070-EXIT.
 10449
 10450     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10451         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10452
 10453
 10454* EXEC CICS HANDLE CONDITION
 10455*         DUPKEY   (2070-EXIT)
 10456*    END-EXEC.
 10457*    MOVE '"$$                   ! 2 #00009508' TO DFHEIV0
 10458     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10460     MOVE X'3220233030303039353038' TO DFHEIV0(25:11)
 10461     CALL 'kxdfhei1' USING DFHEIV0
 10462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10463
 10464
 10465
 10466* EXEC CICS REWRITE
 10467*         DATASET  (CERT-FILE-ID)
 10468*         FROM     (CERTIFICATE-MASTER)
 10469*    END-EXEC.
 10470     MOVE LENGTH OF
 10471      CERTIFICATE-MASTER
 10472       TO DFHEIV11
 10473*    MOVE '&& L                  %   #00009512' TO DFHEIV0
 10474     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10475     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10476     MOVE X'2020233030303039353132' TO DFHEIV0(25:11)
 10477     CALL 'kxdfhei1' USING DFHEIV0,
 10478           CERT-FILE-ID,
 10479           CERTIFICATE-MASTER,
 10480           DFHEIV11,
 10481           DFHEIV99
 10482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10483
 10484
 10485     GO TO 2070-EXIT.
 10486
 10487 2070-NOT-FOUND.
 10488     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10489
 10490 2070-EXIT.
 10491     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 195
* EL131.cbl
 10493 2080-CREATE-CERT.
 10494
 10495* EXEC CICS GETMAIN
 10496*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10497*         LENGTH    (CERT-LENGTH)
 10498*         INITIMG   (GETMAIN-SPACE)
 10499*    END-EXEC.
 10500*    MOVE ',"IL                  $   #00009526' TO DFHEIV0
 10501     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10502     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10503     MOVE X'2020233030303039353236' TO DFHEIV0(25:11)
 10504     CALL 'kxdfhei1' USING DFHEIV0,
 10505           DFHEIV20,
 10506           CERT-LENGTH,
 10507           GETMAIN-SPACE
 10508     SET ADDRESS OF CERTIFICATE-MASTER TO
 10509         DFHEIV20
 10510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10511
 10512
 10513     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10514
 10515     IF CERTEFFI GREATER THAN LOW-VALUES
 10516         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10517                                    DC-BIN-DATE-1
 10518         MOVE '6'                TO DC-OPTION-CODE
 10519         MOVE +1                 TO DC-ELAPSED-MONTHS
 10520         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10521         IF NO-CONVERSION-ERROR
 10522             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10523
 10524     IF CERTACTI GREATER THAN LOW-VALUES
 10525         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10526     IF CERTSTI GREATER THAN LOW-VALUES
 10527         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10528     IF CERTCARI GREATER THAN LOW-VALUES
 10529         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10530     IF CERTGRPI GREATER THAN LOW-VALUES
 10531         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10532     IF CERTI GREATER THAN LOW-VALUES
 10533         MOVE CERTI              TO CERT-CERT-PRIME
 10534                                    CM-CERT-PRIME
 10535         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10536
 10537     IF SUFXI GREATER THAN LOW-VALUES
 10538         MOVE SUFXI              TO CERT-CERT-SUFX
 10539                                    CM-CERT-SFX
 10540         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10541
 10542     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10543
 10544     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10545
 10546     MOVE SPACES                 TO CM-ENTRY-BATCH
 10547                                    CM-LF-EXIT-BATCH
 10548                                    CM-AH-EXIT-BATCH
 10549                                    CM-CREDIT-INTERFACE-SW-1
 10550                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 196
* EL131.cbl
 10551
 10552     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10553                               '9' OR 'D' OR 'V'
 10554         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10555
 10556     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10557                               '9' OR 'D' OR 'V'
 10558         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10559
 10560     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10561                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10562     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10563
 10564
 10565* EXEC CICS HANDLE CONDITION
 10566*         DUPKEY (2080-EXIT)
 10567*    END-EXEC.
 10568*    MOVE '"$$                   ! 3 #00009583' TO DFHEIV0
 10569     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10571     MOVE X'3320233030303039353833' TO DFHEIV0(25:11)
 10572     CALL 'kxdfhei1' USING DFHEIV0
 10573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10574
 10575
 10576
 10577* EXEC CICS WRITE
 10578*         DATASET  (CERT-FILE-ID)
 10579*         RIDFLD   (CERT-KEY)
 10580*         FROM     (CERTIFICATE-MASTER)
 10581*    END-EXEC.
 10582     MOVE LENGTH OF
 10583      CERTIFICATE-MASTER
 10584       TO DFHEIV11
 10585*    MOVE '&$ L                  ''   #00009587' TO DFHEIV0
 10586     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10587     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10588     MOVE X'2020233030303039353837' TO DFHEIV0(25:11)
 10589     CALL 'kxdfhei1' USING DFHEIV0,
 10590           CERT-FILE-ID,
 10591           CERTIFICATE-MASTER,
 10592           DFHEIV11,
 10593           CERT-KEY,
 10594           DFHEIV99,
 10595           DFHEIV99
 10596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10597
 10598
 10599 2080-EXIT.
 10600     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 197
* EL131.cbl
 10602 2100-MOVE-MSTR.
 10603     IF TYPEI GREATER THAN LOW-VALUES
 10604         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10605
 10606     IF STATUSI = LOW-VALUES
 10607         GO TO 2100-NO-STATUS-CHANGE.
 10608
 10609     IF STATUSI = 'OPEN' OR 'O'
 10610         IF CL-CLAIM-STATUS = 'O'
 10611             MOVE SPACES         TO TRLR-SWITCH
 10612                 GO TO 2100-NO-STATUS-CHANGE.
 10613
 10614     IF STATUSI = 'CLOSED' OR 'C'
 10615         IF CL-CLAIM-STATUS = 'C'
 10616             MOVE SPACES         TO TRLR-SWITCH
 10617                 GO TO 2100-NO-STATUS-CHANGE.
 10618
 10619     IF PI-COMPANY-ID = 'DMD'
 10620        IF STATUSI = 'OPEN' OR 'O'
 10621           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10622              MOVE ZERO       TO STATUSL
 10623              MOVE LOW-VALUES TO STATUSI
 10624              GO TO 2100-NO-STATUS-CHANGE.
 10625
 10626     IF PI-COMPANY-ID = 'DMD'
 10627         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10628
 10629     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10630
 10631 2100-NO-STATUS-CHANGE.
 10632
 10633     IF CCNOI GREATER THAN LOW-VALUES
 10634         MOVE CCNOI              TO CL-CCN.
 10635
 10636     IF PROCI GREATER THAN LOW-VALUES
 10637         MOVE PROCI              TO CL-PROCESSOR-ID.
 10638
 10639     if accswi > low-values
 10640        and accswi = 'Y' OR 'N'
 10641        move accswi              to cl-accident-claim-sw
 10642     end-if
 10643     IF SEXI GREATER THAN LOW-VALUES
 10644         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10645
 10646     IF BIRTHI GREATER THAN LOW-VALUES
 10647         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10648
 10649     IF SOCIALI GREATER THAN LOW-VALUES
 10650       AND
 10651        SOCIALI = SPACES
 10652         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10653         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10654         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10655     ELSE
 10656         IF SOCIALI GREATER THAN LOW-VALUES
 10657             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10658
 10659     IF OCCI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 198
* EL131.cbl
 10660         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10661
 10662     IF BENEL GREATER THAN ZERO
 10663         MOVE BENEI              TO CL-BENEFICIARY.
 10664
 10665     IF DIAGI GREATER THAN LOW-VALUES
 10666         MOVE DIAGI              TO WS-DIAGNOSIS.
 10667
 10668     IF PREMTYPI GREATER THAN LOW-VALUES
 10669         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10670
 10671     IF CAUSEI GREATER THAN LOW-VALUES
 10672         MOVE CAUSEI             TO CL-CAUSE-CD.
 10673
 10674     IF ENDI GREATER THAN LOW-VALUES
 10675         MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10676
 10677     IF PDTHRUI GREATER THAN LOW-VALUES
 10678        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10679
 10680     IF PDAMTL GREATER THAN +0
 10681        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10682
 10683     IF NODAYSI GREATER THAN LOW-VALUES
 10684        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10685
 10686     IF NOPMTSI GREATER THAN LOW-VALUES
 10687        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10688
 10689     IF FORMTYPI GREATER THAN LOW-VALUES
 10690        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10691
 10692     IF INCI GREATER THAN LOW-VALUES
 10693        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10694
 10695     IF REPI GREATER THAN LOW-VALUES
 10696        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10697
 10698     IF ADDONDTI GREATER THAN LOW-VALUES
 10699        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10700
 10701     IF PRICDI GREATER THAN LOW-VALUES
 10702         MOVE PRICDI             TO CL-PRIORITY-CD.
 10703
 10704     IF CRITPTL > ZEROS
 10705        MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 10706     END-IF
 10707
 10708     IF RTWMOSL > ZEROS
 10709        MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 10710     END-IF
 10711     IF FILETOI GREATER THAN LOW-VALUES
 10712         MOVE FILETOI            TO CL-FILE-LOCATION.
 10713
 10714     IF SUPVI GREATER THAN LOW-VALUES
 10715         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10716
 10717     IF MLNAMEI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 199
* EL131.cbl
 10718         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10719
 10720     IF MFNAMEI GREATER THAN LOW-VALUES
 10721         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10722
 10723     IF MMINITI GREATER THAN LOW-VALUES
 10724         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10725
 10726     IF CERTEFFI GREATER THAN LOW-VALUES
 10727         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10728
 10729     IF CERTACTI GREATER THAN LOW-VALUES
 10730         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10731
 10732     IF CERTSTI GREATER THAN LOW-VALUES
 10733         MOVE CERTSTI            TO CL-CERT-STATE.
 10734
 10735     IF CERTCARI GREATER THAN LOW-VALUES
 10736         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10737                                    CL-CARRIER.
 10738
 10739     IF CERTGRPI GREATER THAN LOW-VALUES
 10740         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10741
 10742     IF CERTI GREATER THAN LOW-VALUES
 10743         MOVE CERTI              TO CERT-NO-PRIME.
 10744
 10745     IF SUFXI GREATER THAN LOW-VALUES
 10746         MOVE SUFXI              TO CERT-NO-SUFX.
 10747
 10748     MOVE CERT-NO                TO CL-CERT-NO
 10749                                    CL-CERT-NO-A4.
 10750
 10751     IF PI-COMPANY-ID = 'FLA'
 10752          NEXT SENTENCE
 10753     ELSE
 10754         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10755         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10756         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10757         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10758
 10759     IF TRLR-UPDATE-REQUIRED
 10760        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10761        MOVE ZEROS              TO TRLR-SEQ-NO
 10762
 10763* EXEC CICS READ
 10764*            DATASET   (TRLR-FILE-ID)
 10765*            RIDFLD    (TRLR-KEY)
 10766*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10767*       END-EXEC
 10768*    MOVE '&"S        E          (   #00009756' TO DFHEIV0
 10769     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10770     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10771     MOVE X'2020233030303039373536' TO DFHEIV0(25:11)
 10772     CALL 'kxdfhei1' USING DFHEIV0,
 10773           TRLR-FILE-ID,
 10774           DFHEIV20,
 10775           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 200
* EL131.cbl
 10776           TRLR-KEY,
 10777           DFHEIV99,
 10778           DFHEIV99,
 10779           DFHEIV99
 10780     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10781         DFHEIV20
 10782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10783        IF AT-TRAILER-TYPE = '1'
 10784           MOVE +1 TO MISC-SUB
 10785           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10786           MISC-SUB GREATER THAN +6 OR
 10787           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10788           IF MISC-SUB GREATER THAN +1
 10789              SUBTRACT +1 FROM MISC-SUB
 10790              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10791                 GO TO 2100-BYPASS-LAST-UPDATE.
 10792
 10793     IF TRLR-UPDATE-REQUIRED AND
 10794        CLAIM-IS-OPEN
 10795         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10796     ELSE
 10797         IF TRLR-UPDATE-REQUIRED AND
 10798            CLAIM-IS-CLOSED
 10799             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10800             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10801
 10802 2100-BYPASS-LAST-UPDATE.
 10803     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10804     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10805
 10806     GO TO 2100-EXIT.
 10807
 10808 2100-BUMP-OPEN-CLOSE-HIST.
 10809     ADD +1                      TO MISC-SUB.
 10810
 10811 2100-EXIT.
 10812     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 201
* EL131.cbl
 10814 2120-check-pdef.
 10815
 10816
 10817     move +0                     to s1
 10818     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 10819     move spaces                 to ws-dcc-error-line
 10820     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 10821     IF ERPDEF-FOUND
 10822        perform 2130-check-trlr  thru 2130-exit
 10823        move +1                  to s1
 10824*       if cl-accident-claim-sw = ' '
 10825*          move er-1655             to ws-error-no (s1)
 10826*          add +1 to s1
 10827*       end-if
 10828        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 10829        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 10830        MOVE '1'                 TO DC-OPTION-CODE
 10831        MOVE +0                  TO DC-ELAPSED-MONTHS
 10832                                    DC-ELAPSED-DAYS
 10833        PERFORM 9800-CONVERT-DATE
 10834                                 THRU 9800-EXIT
 10835        IF NO-CONVERSION-ERROR
 10836           MOVE DC-ELAPSED-MONTHS
 10837                                 TO WS-MONTHS-BETWEEN
 10838           IF DC-ELAPSED-DAYS > 1
 10839              ADD 1 TO WS-MONTHS-BETWEEN
 10840           END-IF
 10841        ELSE
 10842           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 10843        END-IF
 10844        IF (WS-EXCL-PERIOD = ZEROS)
 10845           OR (WS-MONTHS-BETWEEN = ZEROS)
 10846           CONTINUE
 10847        ELSE
 10848           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 10849              MOVE ER-1651       TO ws-error-no (s1)
 10850              add +1             to s1
 10851           END-IF
 10852        END-IF
 10853        IF (WS-COV-ENDS = ZEROS)
 10854           OR (WS-MONTHS-BETWEEN = ZEROS)
 10855           CONTINUE
 10856        ELSE
 10857           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 10858              MOVE -1            TO MAINTL
 10859              MOVE ER-1653       TO ws-error-no (s1)
 10860              add +1 to s1
 10861           END-IF
 10862        END-IF
 10863        IF (WS-ACC-PERIOD = ZEROS)
 10864           OR (WS-MONTHS-BETWEEN = ZEROS)
 10865           CONTINUE
 10866        ELSE
 10867           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
 10868              and (cl-accident-claim-sw = ' ')
 10869              move er-1655       to ws-error-no (s1)
 10870              add +1             to s1
 10871           end-if
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 202
* EL131.cbl
 10872           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 10873              if cl-accident-claim-sw not = 'Y'
 10874                 MOVE ER-1652    TO ws-error-no (s1)
 10875              else
 10876                 move er-1662    to ws-error-no (s1)
 10877              end-if
 10878              MOVE -1            TO MAINTL
 10879              add +1             to s1
 10880           END-IF
 10881        END-IF
 10882        if cl-claim-type  = 'I'
 10883           move er-1661          to ws-error-no (s1)
 10884           add +1                to s1
 10885        end-if
 10886        perform 2130-check-trlr  thru 2130-exit
 10887     END-IF
 10888
 10889     .
 10890 2120-exit.
 10891     exit.
 10892
 10893 2130-check-trlr.
 10894
 10895     evaluate true
 10896        when s1 = +0
 10897           move cl-control-primary
 10898                                 to trlr-key
 10899           MOVE +95              TO TRLR-SEQ-NO
 10900
 10901* EXEC CICS READ
 10902*             update
 10903*             DATASET  ('ELTRLR')
 10904*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10905*             RIDFLD   (TRLR-KEY)
 10906*             RESP     (WS-RESPONSE)
 10907*          END-EXEC
 10908     MOVE 'ELTRLR' TO DFHEIV1
 10909*    MOVE '&"S        EU         (  N#00009878' TO DFHEIV0
 10910     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10911     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10912     MOVE X'204E233030303039383738' TO DFHEIV0(25:11)
 10913     CALL 'kxdfhei1' USING DFHEIV0,
 10914           DFHEIV1,
 10915           DFHEIV20,
 10916           DFHEIV99,
 10917           TRLR-KEY,
 10918           DFHEIV99,
 10919           DFHEIV99,
 10920           DFHEIV99
 10921     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10922         DFHEIV20
 10923     MOVE EIBRESP  TO WS-RESPONSE
 10924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10925           if ws-resp-normal
 10926              move spaces        to at-info-line-1
 10927           end-if
 10928        when s1 = +1
 10929           if ws-resp-normal
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 203
* EL131.cbl
 10930
 10931* exec cics rewrite
 10932*                dataset   ('ELTRLR')
 10933*                from      (activity-trailers)
 10934*             end-exec
 10935     MOVE LENGTH OF
 10936      activity-trailers
 10937       TO DFHEIV11
 10938     MOVE 'ELTRLR' TO DFHEIV1
 10939*    MOVE '&& L                  %   #00009890' TO DFHEIV0
 10940     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10941     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10942     MOVE X'2020233030303039383930' TO DFHEIV0(25:11)
 10943     CALL 'kxdfhei1' USING DFHEIV0,
 10944           DFHEIV1,
 10945           activity-trailers,
 10946           DFHEIV11,
 10947           DFHEIV99
 10948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10949           end-if
 10950        when s1 > +1
 10951           if ws-resp-normal
 10952              move ws-dcc-error-line
 10953                                 to at-info-line-1
 10954
 10955* exec cics rewrite
 10956*                dataset   ('ELTRLR')
 10957*                from      (activity-trailers)
 10958*             end-exec
 10959     MOVE LENGTH OF
 10960      activity-trailers
 10961       TO DFHEIV11
 10962     MOVE 'ELTRLR' TO DFHEIV1
 10963*    MOVE '&& L                  %   #00009899' TO DFHEIV0
 10964     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10965     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10966     MOVE X'2020233030303039383939' TO DFHEIV0(25:11)
 10967     CALL 'kxdfhei1' USING DFHEIV0,
 10968           DFHEIV1,
 10969           activity-trailers,
 10970           DFHEIV11,
 10971           DFHEIV99
 10972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10973           else
 10974
 10975* EXEC CICS GETMAIN
 10976*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10977*                LENGTH   (TRLR-LENGTH)
 10978*                INITIMG  (GETMAIN-SPACE)
 10979*             END-EXEC
 10980*    MOVE ',"IL                  $   #00009904' TO DFHEIV0
 10981     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10982     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10983     MOVE X'2020233030303039393034' TO DFHEIV0(25:11)
 10984     CALL 'kxdfhei1' USING DFHEIV0,
 10985           DFHEIV20,
 10986           TRLR-LENGTH,
 10987           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 204
* EL131.cbl
 10988     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10989         DFHEIV20
 10990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10991              move 'AT'          to at-record-id
 10992              move cl-control-primary
 10993                                 to at-control-primary
 10994              move +95           to at-sequence-no
 10995              move '6'           to at-trailer-type
 10996              move ws-dcc-error-line
 10997                                 to at-info-line-1
 10998              move 'E'           to at-info-trailer-type
 10999              move save-bin-date to at-recorded-dt
 11000                                    at-gen-info-last-maint-dt
 11001              move pi-processor-id
 11002                                 to at-recorded-by
 11003                                    at-gen-info-last-updated-by
 11004              move eibtime       to at-last-maint-hhmmss
 11005
 11006* exec cics write
 11007*                dataset   ('ELTRLR')
 11008*                from      (activity-trailers)
 11009*                ridfld    (trlr-key)
 11010*             end-exec
 11011     MOVE LENGTH OF
 11012      activity-trailers
 11013       TO DFHEIV11
 11014     MOVE 'ELTRLR' TO DFHEIV1
 11015*    MOVE '&$ L                  ''   #00009923' TO DFHEIV0
 11016     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11017     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11018     MOVE X'2020233030303039393233' TO DFHEIV0(25:11)
 11019     CALL 'kxdfhei1' USING DFHEIV0,
 11020           DFHEIV1,
 11021           activity-trailers,
 11022           DFHEIV11,
 11023           trlr-key,
 11024           DFHEIV99,
 11025           DFHEIV99
 11026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11027              perform varying s1 from +1 by +1 until
 11028                 ws-error-no (s1) = spaces
 11029                 move ws-error-no (s1)
 11030                                 to emi-error
 11031                 PERFORM 9900-ERROR-FORMAT
 11032                                 THRU 9900-EXIT
 11033              end-perform
 11034           end-if
 11035     end-evaluate
 11036
 11037     .
 11038 2130-exit.
 11039     exit.
 11040 2200-MOVE-CERT.
 11041     IF CRTLNMEI GREATER THAN LOW-VALUES
 11042         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11043
 11044     IF CRTFNMEI GREATER THAN LOW-VALUES
 11045         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 205
* EL131.cbl
 11046         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11047
 11048     IF CRTINITI GREATER THAN LOW-VALUES
 11049         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11050
 11051     IF CM-INSURED-INITIALS = SPACES
 11052         MOVE '**'               TO CM-INSURED-INITIALS.
 11053
 11054     IF ISSAGEI GREATER THAN LOW-VALUES
 11055         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11056
 11057     IF JNTFNMEI GREATER THAN LOW-VALUES
 11058         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11059
 11060     IF JNTLNMEI GREATER THAN LOW-VALUES
 11061         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11062
 11063     IF JNTINITI GREATER THAN LOW-VALUES
 11064         MOVE JNTINITI           TO CM-JT-INITIAL.
 11065
 11066     IF JNTAGEI GREATER THAN LOW-VALUES
 11067         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11068
 11069     IF ADDONDTI GREATER THAN LOW-VALUES
 11070        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11071
 11072     IF LCVCDI GREATER THAN LOW-VALUES
 11073        IF LCVCDI = SPACES OR ZEROS
 11074           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11075        ELSE
 11076           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11077
 11078     IF LCVOTRMI GREATER THAN LOW-VALUES
 11079         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11080
 11081     IF LCVRATEL GREATER THAN +0
 11082         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11083
 11084     IF LCVBENEL GREATER THAN +0
 11085         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11086
 11087     IF LCVFORMI GREATER THAN LOW-VALUES
 11088         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11089
 11090     IF LCVCNDTI = LOW-VALUES
 11091        GO TO 2210-SET-STATUS.
 11092
 11093     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11094        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11095        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11096        GO TO 2210-SET-STATUS.
 11097
 11098     IF CM-LF-CURRENT-STATUS = '7'
 11099        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11100        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11101        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11102                                    CM-LF-DEATH-DT
 11103        GO TO 2210-SET-STATUS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 206
* EL131.cbl
 11104
 11105     IF CM-LF-CURRENT-STATUS = '8'
 11106        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11107        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11108                                    CM-LF-CANCEL-DT.
 11109
 11110 2210-SET-STATUS.
 11111
 11112     IF CM-LF-CURRENT-STATUS = SPACES
 11113         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11114
 11115     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11116         MOVE '6'                TO DC-OPTION-CODE
 11117         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11118         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11119         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11120         IF NO-CONVERSION-ERROR
 11121             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11122         ELSE
 11123             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11124     ELSE
 11125         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11126
 11127 2215-PROCESS-AH-SIDE.
 11128
 11129     IF ACVCDI GREATER THAN LOW-VALUES
 11130        IF ACVCDI = SPACES OR ZEROS
 11131           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11132        ELSE
 11133           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11134
 11135     IF ACVOTRMI GREATER THAN LOW-VALUES
 11136         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11137
 11138     IF ACVRATEL GREATER THAN +0
 11139         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11140
 11141     IF ACVBENEL GREATER THAN +0
 11142         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 11143                                    PI-PAYMENT-AMT.
 11144
 11145     IF ACVFORMI GREATER THAN LOW-VALUES
 11146         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11147
 11148     IF ACVCNDTI = LOW-VALUES
 11149        GO TO 2220-SET-STATUS.
 11150
 11151     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11152        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11153        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11154        GO TO 2220-SET-STATUS.
 11155
 11156     IF CM-AH-CURRENT-STATUS = '6'
 11157        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11158                                 TO CM-AH-CURRENT-STATUS
 11159        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11160        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11161                                    CM-AH-SETTLEMENT-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 207
* EL131.cbl
 11162        GO TO 2220-SET-STATUS.
 11163
 11164     IF CM-AH-CURRENT-STATUS = '8'
 11165        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11166        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11167                                    CM-AH-CANCEL-DT.
 11168
 11169 2220-SET-STATUS.
 11170     IF CM-AH-CURRENT-STATUS = SPACES
 11171         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11172
 11173     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11174         MOVE '6'                TO DC-OPTION-CODE
 11175         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11176         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11177         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11178         IF NO-CONVERSION-ERROR
 11179             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 11180         ELSE
 11181             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 11182     ELSE
 11183         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 11184
 11185 2225-FINISH-CERT.
 11186     IF APRL GREATER THAN +0
 11187         MOVE HOLD-APR           TO CM-LOAN-APR.
 11188
 11189     IF PMTFREQI GREATER THAN LOW-VALUES
 11190         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 11191
 11192     IF INDGRPI GREATER THAN LOW-VALUES
 11193         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 11194
 11195     IF LOANNOI GREATER THAN LOW-VALUES
 11196        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 11197
 11198     IF LOANBALL GREATER THAN +0
 11199        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 11200
 11201     IF PREMTYPI GREATER THAN LOW-VALUES
 11202         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 11203
 11204     IF REINCDI GREATER THAN LOW-VALUES
 11205         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 11206                                    WS-REIN-1
 11207                                    WS-REIN-2
 11208                                    WS-REIN-3
 11209         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 11210
 11211     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 11212
 11213     MOVE ZEROS                  TO CM-LOAN-TERM
 11214                                    CM-LIFE-COMM-PCT
 11215                                    CM-AH-COMM-PCT.
 11216
 11217*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 11218*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 11219*         PI-NO-PMTS = ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 208
* EL131.cbl
 11220*          IF LOANBALL GREATER THAN +0          OR
 11221*             ACVBENEL GREATER THAN +0          OR
 11222*             APRL     GREATER THAN +0          OR
 11223*             LCVRATEL GREATER THAN +0          OR
 11224*             ACVRATEL GREATER THAN +0
 11225*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 11226
 11227 2200-EXIT.
 11228     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 209
* EL131.cbl
 11230 2300-UPDATE-TRLR.
 11231     MOVE ZERO                   TO TRLR-SEQ-NO.
 11232
 11233* EXEC CICS READ UPDATE
 11234*         DATASET  (TRLR-FILE-ID)
 11235*         RIDFLD   (TRLR-KEY)
 11236*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11237*    END-EXEC.
 11238*    MOVE '&"S        EU         (   #00010133' TO DFHEIV0
 11239     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11240     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11241     MOVE X'2020233030303130313333' TO DFHEIV0(25:11)
 11242     CALL 'kxdfhei1' USING DFHEIV0,
 11243           TRLR-FILE-ID,
 11244           DFHEIV20,
 11245           DFHEIV99,
 11246           TRLR-KEY,
 11247           DFHEIV99,
 11248           DFHEIV99,
 11249           DFHEIV99
 11250     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11251         DFHEIV20
 11252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11253
 11254
 11255     MOVE ZERO                   TO COUNT-2.
 11256
 11257     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11258         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11259
 11260     IF NOT UPDATE-MADE
 11261         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11262
 11263
 11264* EXEC CICS REWRITE
 11265*         DATASET  (TRLR-FILE-ID)
 11266*         FROM     (ACTIVITY-TRAILERS)
 11267*    END-EXEC.
 11268     MOVE LENGTH OF
 11269      ACTIVITY-TRAILERS
 11270       TO DFHEIV11
 11271*    MOVE '&& L                  %   #00010147' TO DFHEIV0
 11272     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11273     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11274     MOVE X'2020233030303130313437' TO DFHEIV0(25:11)
 11275     CALL 'kxdfhei1' USING DFHEIV0,
 11276           TRLR-FILE-ID,
 11277           ACTIVITY-TRAILERS,
 11278           DFHEIV11,
 11279           DFHEIV99
 11280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11281
 11282
 11283 2300-EXIT.
 11284     EXIT.
 11285
 11286 2310-INS-STATUS.
 11287     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 210
* EL131.cbl
 11288     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 11289         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 11290         MOVE 'Y'                TO TRLR-SWITCH.
 11291
 11292 2310-EXIT.
 11293     EXIT.
 11294
 11295 2320-SHIFT-STATUS.
 11296     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 11297        MOVE 6                   TO COUNT-2
 11298        GO TO 2320-EXIT.
 11299
 11300     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 11301     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 11302     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 11303     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 11304     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 11305     MOVE 6       TO COUNT-2.
 11306     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 11307
 11308 2320-EXIT.
 11309     EXIT.
 11310
 11311 2330-ADD-UPDATE.
 11312
 11313     IF COUNT-2 GREATER THAN 1
 11314        COMPUTE MISC-SUB = (COUNT-2 - 1)
 11315        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11316           GO TO 2330-EXIT.
 11317
 11318     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 11319                                   AT-RESERVES-LAST-MAINT-DT
 11320
 11321     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 11322     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 11323     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 11324     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 11325
 11326 2330-EXIT.
 11327     EXIT.
 11328
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 211
* EL131.cbl
 11330 2400-UPDATE-TRLR.
 11331
 11332* EXEC CICS HANDLE CONDITION
 11333*         NOTFND    (2400-TRLR-NOTFND)
 11334*         ENDFILE   (2410-EXIT)
 11335*    END-EXEC.
 11336*    MOVE '"$I''                  ! 4 #00010200' TO DFHEIV0
 11337     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11338     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11339     MOVE X'3420233030303130323030' TO DFHEIV0(25:11)
 11340     CALL 'kxdfhei1' USING DFHEIV0
 11341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11342
 11343
 11344
 11345* EXEC CICS STARTBR
 11346*        DATASET (TRLR-FILE-ID)
 11347*        RIDFLD  (TRLR-KEY)
 11348*    END-EXEC.
 11349     MOVE 0
 11350       TO DFHEIV11
 11351*    MOVE '&,         G          &   #00010205' TO DFHEIV0
 11352     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11353     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11354     MOVE X'2020233030303130323035' TO DFHEIV0(25:11)
 11355     CALL 'kxdfhei1' USING DFHEIV0,
 11356           TRLR-FILE-ID,
 11357           TRLR-KEY,
 11358           DFHEIV99,
 11359           DFHEIV11,
 11360           DFHEIV99
 11361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11362
 11363
 11364
 11365* EXEC CICS GETMAIN
 11366*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11367*         LENGTH    (TRLR-LENGTH)
 11368*         INITIMG   (GETMAIN-SPACE)
 11369*    END-EXEC.
 11370*    MOVE ',"IL                  $   #00010210' TO DFHEIV0
 11371     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11372     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11373     MOVE X'2020233030303130323130' TO DFHEIV0(25:11)
 11374     CALL 'kxdfhei1' USING DFHEIV0,
 11375           DFHEIV20,
 11376           TRLR-LENGTH,
 11377           GETMAIN-SPACE
 11378     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11379         DFHEIV20
 11380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11381
 11382
 11383     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 11384
 11385
 11386* EXEC CICS ENDBR
 11387*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 212
* EL131.cbl
 11388*    END-EXEC.
 11389     MOVE 0
 11390       TO DFHEIV11
 11391*    MOVE '&2                    $   #00010218' TO DFHEIV0
 11392     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11393     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11394     MOVE X'2020233030303130323138' TO DFHEIV0(25:11)
 11395     CALL 'kxdfhei1' USING DFHEIV0,
 11396           TRLR-FILE-ID,
 11397           DFHEIV11,
 11398           DFHEIV99
 11399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11400
 11401
 11402     GO TO 2400-EXIT.
 11403
 11404 2400-TRLR-NOTFND.
 11405     MOVE ER-0205                TO EMI-ERROR.
 11406     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11407     MOVE 'X'                    TO ERROR-SWITCH.
 11408
 11409 2400-EXIT.
 11410     EXIT.
 11411
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 213
* EL131.cbl
 11413 2410-CHANGE-TRLR.
 11414
 11415* EXEC CICS READNEXT
 11416*        DATASET (TRLR-FILE-ID)
 11417*        RIDFLD  (TRLR-KEY)
 11418*        INTO    (ACTIVITY-TRAILERS)
 11419*    END-EXEC.
 11420     MOVE LENGTH OF
 11421      ACTIVITY-TRAILERS
 11422       TO DFHEIV12
 11423     MOVE 0
 11424       TO DFHEIV11
 11425*    MOVE '&.IL                  )   #00010234' TO DFHEIV0
 11426     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11427     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11428     MOVE X'2020233030303130323334' TO DFHEIV0(25:11)
 11429     CALL 'kxdfhei1' USING DFHEIV0,
 11430           TRLR-FILE-ID,
 11431           ACTIVITY-TRAILERS,
 11432           DFHEIV12,
 11433           TRLR-KEY,
 11434           DFHEIV99,
 11435           DFHEIV11,
 11436           DFHEIV99,
 11437           DFHEIV99
 11438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11439
 11440
 11441     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 11442        GO TO 2410-CHANGE-TRLR.
 11443
 11444     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 11445                                    CHECK-KEY.
 11446
 11447     IF CHECK-KEY NOT = MSTR-KEY
 11448         GO TO 2410-EXIT.
 11449
 11450
 11451* EXEC CICS ENDBR
 11452*        DATASET (TRLR-FILE-ID)
 11453*    END-EXEC.
 11454     MOVE 0
 11455       TO DFHEIV11
 11456*    MOVE '&2                    $   #00010249' TO DFHEIV0
 11457     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11458     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11459     MOVE X'2020233030303130323439' TO DFHEIV0(25:11)
 11460     CALL 'kxdfhei1' USING DFHEIV0,
 11461           TRLR-FILE-ID,
 11462           DFHEIV11,
 11463           DFHEIV99
 11464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11465
 11466
 11467
 11468* EXEC CICS READ UPDATE
 11469*        DATASET (TRLR-FILE-ID)
 11470*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 214
* EL131.cbl
 11471*        INTO    (ACTIVITY-TRAILERS)
 11472*    END-EXEC.
 11473     MOVE LENGTH OF
 11474      ACTIVITY-TRAILERS
 11475       TO DFHEIV11
 11476*    MOVE '&"IL       EU         (   #00010253' TO DFHEIV0
 11477     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11478     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11479     MOVE X'2020233030303130323533' TO DFHEIV0(25:11)
 11480     CALL 'kxdfhei1' USING DFHEIV0,
 11481           TRLR-FILE-ID,
 11482           ACTIVITY-TRAILERS,
 11483           DFHEIV11,
 11484           TRLR-KEY,
 11485           DFHEIV99,
 11486           DFHEIV99,
 11487           DFHEIV99
 11488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11489
 11490
 11491
 11492* EXEC CICS DELETE
 11493*        DATASET (TRLR-FILE-ID)
 11494*    END-EXEC.
 11495*    MOVE '&(                    &   #00010259' TO DFHEIV0
 11496     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11497     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11498     MOVE X'2020233030303130323539' TO DFHEIV0(25:11)
 11499     CALL 'kxdfhei1' USING DFHEIV0,
 11500           TRLR-FILE-ID,
 11501           DFHEIV99,
 11502           DFHEIV99,
 11503           DFHEIV99,
 11504           DFHEIV99
 11505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11506
 11507
 11508     IF AT-SEQUENCE-NO = ZERO AND
 11509        TRLR-UPDATE-REQUIRED
 11510         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 11511
 11512     IF CERTI GREATER THAN LOW-VALUES
 11513        MOVE CERTI               TO AT-CERT-PRIME.
 11514
 11515     IF SUFXI GREATER THAN LOW-VALUES
 11516        MOVE SUFXI               TO AT-CERT-SFX.
 11517
 11518     IF CERTCARI GREATER THAN LOW-VALUES
 11519        MOVE CERTCARI            TO AT-CARRIER.
 11520
 11521     IF PAYMENT-TR
 11522        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 11523           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 11524              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 11525
 11526     IF CORRESPONDENCE-TR
 11527        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 11528           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 215
* EL131.cbl
 11529
 11530
 11531* EXEC CICS WRITE
 11532*         DATASET  (TRLR-FILE-ID)
 11533*         RIDFLD   (AT-CONTROL-PRIMARY)
 11534*         FROM     (ACTIVITY-TRAILERS)
 11535*    END-EXEC.
 11536     MOVE LENGTH OF
 11537      ACTIVITY-TRAILERS
 11538       TO DFHEIV11
 11539*    MOVE '&$ L                  ''   #00010285' TO DFHEIV0
 11540     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11541     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11542     MOVE X'2020233030303130323835' TO DFHEIV0(25:11)
 11543     CALL 'kxdfhei1' USING DFHEIV0,
 11544           TRLR-FILE-ID,
 11545           ACTIVITY-TRAILERS,
 11546           DFHEIV11,
 11547           AT-CONTROL-PRIMARY,
 11548           DFHEIV99,
 11549           DFHEIV99
 11550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11551
 11552
 11553
 11554* EXEC CICS STARTBR
 11555*         DATASET  (TRLR-FILE-ID)
 11556*         RIDFLD   (TRLR-KEY)
 11557*    END-EXEC.
 11558     MOVE 0
 11559       TO DFHEIV11
 11560*    MOVE '&,         G          &   #00010291' TO DFHEIV0
 11561     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11562     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11563     MOVE X'2020233030303130323931' TO DFHEIV0(25:11)
 11564     CALL 'kxdfhei1' USING DFHEIV0,
 11565           TRLR-FILE-ID,
 11566           TRLR-KEY,
 11567           DFHEIV99,
 11568           DFHEIV11,
 11569           DFHEIV99
 11570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11571
 11572
 11573     GO TO 2410-CHANGE-TRLR.
 11574
 11575 2410-EXIT.
 11576     EXIT.
 11577
 11578 2420-UPDATE-TRLR.
 11579     MOVE ZERO TO COUNT-2.
 11580     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11581         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11582
 11583     IF NOT UPDATE-MADE
 11584         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11585
 11586 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 216
* EL131.cbl
 11587     EXIT.
 11588
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 217
* EL131.cbl
 11590 2425-UPDATE-NINETY-TRLR.
 11591
 11592     MOVE +90                    TO TRLR-SEQ-NO.
 11593
 11594
 11595* EXEC CICS HANDLE CONDITION
 11596*         NOTFND    (2425-NINETY-NOTFND)
 11597*         ENDFILE   (2425-NINETY-NOTFND)
 11598*    END-EXEC.
 11599*    MOVE '"$I''                  ! 5 #00010317' TO DFHEIV0
 11600     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11602     MOVE X'3520233030303130333137' TO DFHEIV0(25:11)
 11603     CALL 'kxdfhei1' USING DFHEIV0
 11604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11605
 11606
 11607
 11608* EXEC CICS READ UPDATE
 11609*        DATASET (TRLR-FILE-ID)
 11610*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11611*        RIDFLD  (TRLR-KEY)
 11612*    END-EXEC.
 11613*    MOVE '&"S        EU         (   #00010322' TO DFHEIV0
 11614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11615     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11616     MOVE X'2020233030303130333232' TO DFHEIV0(25:11)
 11617     CALL 'kxdfhei1' USING DFHEIV0,
 11618           TRLR-FILE-ID,
 11619           DFHEIV20,
 11620           DFHEIV99,
 11621           TRLR-KEY,
 11622           DFHEIV99,
 11623           DFHEIV99,
 11624           DFHEIV99
 11625     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11626         DFHEIV20
 11627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11628
 11629
 11630     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 11631
 11632     MOVE DIAGI                 TO AT-INFO-LINE-1.
 11633
 11634
 11635* EXEC CICS REWRITE
 11636*        DATASET (TRLR-FILE-ID)
 11637*        FROM    (ACTIVITY-TRAILERS)
 11638*    END-EXEC.
 11639     MOVE LENGTH OF
 11640      ACTIVITY-TRAILERS
 11641       TO DFHEIV11
 11642*    MOVE '&& L                  %   #00010332' TO DFHEIV0
 11643     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11644     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11645     MOVE X'2020233030303130333332' TO DFHEIV0(25:11)
 11646     CALL 'kxdfhei1' USING DFHEIV0,
 11647           TRLR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 218
* EL131.cbl
 11648           ACTIVITY-TRAILERS,
 11649           DFHEIV11,
 11650           DFHEIV99
 11651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11652
 11653
 11654     IF DIAGI NOT = WS-DIAGNOSIS
 11655         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11656         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11657         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11658
 11659     GO TO 2425-EXIT.
 11660
 11661 2425-NINETY-NOTFND.
 11662
 11663
 11664* EXEC CICS GETMAIN
 11665*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11666*         LENGTH    (TRLR-LENGTH)
 11667*         INITIMG   (GETMAIN-SPACE)
 11668*    END-EXEC.
 11669*    MOVE ',"IL                  $   #00010346' TO DFHEIV0
 11670     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11671     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11672     MOVE X'2020233030303130333436' TO DFHEIV0(25:11)
 11673     CALL 'kxdfhei1' USING DFHEIV0,
 11674           DFHEIV20,
 11675           TRLR-LENGTH,
 11676           GETMAIN-SPACE
 11677     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11678         DFHEIV20
 11679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11680
 11681
 11682     MOVE +90                  TO TRLR-SEQ-NO.
 11683     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11684
 11685     MOVE 'AT'                 TO AT-RECORD-ID
 11686     MOVE '6'                  TO AT-TRAILER-TYPE
 11687     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11688                                  AT-GEN-INFO-LAST-MAINT-DT
 11689     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11690                                  AT-GEN-INFO-LAST-UPDATED-BY
 11691     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11692     MOVE DIAGI                TO AT-INFO-LINE-1.
 11693
 11694
 11695* EXEC CICS WRITE
 11696*        DATASET (TRLR-FILE-ID)
 11697*        FROM    (ACTIVITY-TRAILERS)
 11698*        RIDFLD  (TRLR-KEY)
 11699*    END-EXEC.
 11700     MOVE LENGTH OF
 11701      ACTIVITY-TRAILERS
 11702       TO DFHEIV11
 11703*    MOVE '&$ L                  ''   #00010364' TO DFHEIV0
 11704     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11705     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 219
* EL131.cbl
 11706     MOVE X'2020233030303130333634' TO DFHEIV0(25:11)
 11707     CALL 'kxdfhei1' USING DFHEIV0,
 11708           TRLR-FILE-ID,
 11709           ACTIVITY-TRAILERS,
 11710           DFHEIV11,
 11711           TRLR-KEY,
 11712           DFHEIV99,
 11713           DFHEIV99
 11714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11715
 11716
 11717 2425-EXIT.
 11718     EXIT.
 11719
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 220
* EL131.cbl
 11721 2430-UPDATE-ACTQ.
 11722
 11723* EXEC CICS HANDLE CONDITION
 11724*         NOTFND    (2430-EXIT)
 11725*         ENDFILE   (2440-EXIT)
 11726*    END-EXEC.
 11727*    MOVE '"$I''                  ! 6 #00010375' TO DFHEIV0
 11728     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11730     MOVE X'3620233030303130333735' TO DFHEIV0(25:11)
 11731     CALL 'kxdfhei1' USING DFHEIV0
 11732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11733
 11734
 11735
 11736* EXEC CICS STARTBR
 11737*         DATASET  (ACTQ-FILE-ID)
 11738*         RIDFLD   (ACTQ-KEY)
 11739*    END-EXEC.
 11740     MOVE 0
 11741       TO DFHEIV11
 11742*    MOVE '&,         G          &   #00010380' TO DFHEIV0
 11743     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11744     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11745     MOVE X'2020233030303130333830' TO DFHEIV0(25:11)
 11746     CALL 'kxdfhei1' USING DFHEIV0,
 11747           ACTQ-FILE-ID,
 11748           ACTQ-KEY,
 11749           DFHEIV99,
 11750           DFHEIV11,
 11751           DFHEIV99
 11752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11753
 11754
 11755
 11756* EXEC CICS GETMAIN
 11757*         SET      (ADDRESS OF ACTIVITY-QUE)
 11758*         LENGTH   (ACTQ-LENGTH)
 11759*         INITIMG  (GETMAIN-SPACE)
 11760*    END-EXEC.
 11761*    MOVE ',"IL                  $   #00010385' TO DFHEIV0
 11762     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11763     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11764     MOVE X'2020233030303130333835' TO DFHEIV0(25:11)
 11765     CALL 'kxdfhei1' USING DFHEIV0,
 11766           DFHEIV20,
 11767           ACTQ-LENGTH,
 11768           GETMAIN-SPACE
 11769     SET ADDRESS OF ACTIVITY-QUE TO
 11770         DFHEIV20
 11771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11772
 11773
 11774     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11775
 11776 2430-EXIT.
 11777     EXIT.
 11778
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 221
* EL131.cbl
 11779 2440-CHANGE-ACTQ.
 11780
 11781
 11782* EXEC CICS READNEXT
 11783*         DATASET  (ACTQ-FILE-ID)
 11784*         RIDFLD   (ACTQ-KEY)
 11785*         INTO     (ACTIVITY-QUE)
 11786*    END-EXEC.
 11787     MOVE LENGTH OF
 11788      ACTIVITY-QUE
 11789       TO DFHEIV12
 11790     MOVE 0
 11791       TO DFHEIV11
 11792*    MOVE '&.IL                  )   #00010398' TO DFHEIV0
 11793     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11794     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11795     MOVE X'2020233030303130333938' TO DFHEIV0(25:11)
 11796     CALL 'kxdfhei1' USING DFHEIV0,
 11797           ACTQ-FILE-ID,
 11798           ACTIVITY-QUE,
 11799           DFHEIV12,
 11800           ACTQ-KEY,
 11801           DFHEIV99,
 11802           DFHEIV11,
 11803           DFHEIV99,
 11804           DFHEIV99
 11805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11806
 11807
 11808
 11809* EXEC CICS ENDBR
 11810*         DATASET (ACTQ-FILE-ID)
 11811*    END-EXEC.
 11812     MOVE 0
 11813       TO DFHEIV11
 11814*    MOVE '&2                    $   #00010404' TO DFHEIV0
 11815     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11816     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11817     MOVE X'2020233030303130343034' TO DFHEIV0(25:11)
 11818     CALL 'kxdfhei1' USING DFHEIV0,
 11819           ACTQ-FILE-ID,
 11820           DFHEIV11,
 11821           DFHEIV99
 11822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11823
 11824
 11825     IF ACTQ-KEY NOT = MSTR-KEY
 11826         GO TO 2440-EXIT.
 11827
 11828
 11829* EXEC CICS READ UPDATE
 11830*         DATASET  (ACTQ-FILE-ID)
 11831*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11832*         SET      (ADDRESS OF ACTIVITY-QUE)
 11833*    END-EXEC.
 11834*    MOVE '&"S        EU         (   #00010411' TO DFHEIV0
 11835     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11836     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 222
* EL131.cbl
 11837     MOVE X'2020233030303130343131' TO DFHEIV0(25:11)
 11838     CALL 'kxdfhei1' USING DFHEIV0,
 11839           ACTQ-FILE-ID,
 11840           DFHEIV20,
 11841           DFHEIV99,
 11842           AQ-CONTROL-PRIMARY,
 11843           DFHEIV99,
 11844           DFHEIV99,
 11845           DFHEIV99
 11846     SET ADDRESS OF ACTIVITY-QUE TO
 11847         DFHEIV20
 11848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11849
 11850
 11851     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 11852
 11853
 11854* EXEC CICS DELETE
 11855*         DATASET (ACTQ-FILE-ID)
 11856*    END-EXEC.
 11857*    MOVE '&(                    &   #00010419' TO DFHEIV0
 11858     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11859     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11860     MOVE X'2020233030303130343139' TO DFHEIV0(25:11)
 11861     CALL 'kxdfhei1' USING DFHEIV0,
 11862           ACTQ-FILE-ID,
 11863           DFHEIV99,
 11864           DFHEIV99,
 11865           DFHEIV99,
 11866           DFHEIV99
 11867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11868
 11869
 11870     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 11871     IF CERTI GREATER THAN LOW-VALUES
 11872        MOVE CERTI               TO AQ-CERT-PRIME.
 11873     IF SUFXI GREATER THAN LOW-VALUES
 11874        MOVE SUFXI               TO AQ-CERT-SFX.
 11875     IF CERTCARI GREATER THAN LOW-VALUES
 11876        MOVE CERTCARI            TO AQ-CARRIER.
 11877
 11878
 11879* EXEC CICS HANDLE CONDITION
 11880*         DUPREC   (2440-EXIT)
 11881*    END-EXEC.
 11882*    MOVE '"$%                   ! 7 #00010431' TO DFHEIV0
 11883     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11885     MOVE X'3720233030303130343331' TO DFHEIV0(25:11)
 11886     CALL 'kxdfhei1' USING DFHEIV0
 11887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11888
 11889
 11890
 11891* EXEC CICS WRITE
 11892*         DATASET  (ACTQ-FILE-ID)
 11893*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11894*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 223
* EL131.cbl
 11895*    END-EXEC.
 11896     MOVE LENGTH OF
 11897      ACTIVITY-QUE
 11898       TO DFHEIV11
 11899*    MOVE '&$ L                  ''   #00010435' TO DFHEIV0
 11900     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11901     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11902     MOVE X'2020233030303130343335' TO DFHEIV0(25:11)
 11903     CALL 'kxdfhei1' USING DFHEIV0,
 11904           ACTQ-FILE-ID,
 11905           ACTIVITY-QUE,
 11906           DFHEIV11,
 11907           AQ-CONTROL-PRIMARY,
 11908           DFHEIV99,
 11909           DFHEIV99
 11910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11911
 11912
 11913 2440-EXIT.
 11914     EXIT.
 11915
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 224
* EL131.cbl
 11917 2460-UPDATE-CHECKQ.
 11918
 11919* EXEC CICS HANDLE CONDITION
 11920*         NOTFND   (2460-EXIT)
 11921*    END-EXEC.
 11922*    MOVE '"$I                   ! 8 #00010446' TO DFHEIV0
 11923     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11924     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11925     MOVE X'3820233030303130343436' TO DFHEIV0(25:11)
 11926     CALL 'kxdfhei1' USING DFHEIV0
 11927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11928
 11929
 11930     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 11931     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 11932     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 11933
 11934
 11935* EXEC CICS READ UPDATE
 11936*         DATASET   (CHKQ-FILE-ID)
 11937*         RIDFLD    (CHKQ-KEY)
 11938*         SET       (ADDRESS OF CHECK-QUE)
 11939*    END-EXEC.
 11940*    MOVE '&"S        EU         (   #00010454' TO DFHEIV0
 11941     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11942     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11943     MOVE X'2020233030303130343534' TO DFHEIV0(25:11)
 11944     CALL 'kxdfhei1' USING DFHEIV0,
 11945           CHKQ-FILE-ID,
 11946           DFHEIV20,
 11947           DFHEIV99,
 11948           CHKQ-KEY,
 11949           DFHEIV99,
 11950           DFHEIV99,
 11951           DFHEIV99
 11952     SET ADDRESS OF CHECK-QUE TO
 11953         DFHEIV20
 11954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11955
 11956
 11957     IF CERTI GREATER THAN LOW-VALUES
 11958        MOVE CERTI               TO CQ-CERT-PRIME.
 11959     IF SUFXI GREATER THAN LOW-VALUES
 11960        MOVE SUFXI               TO CQ-CERT-SFX.
 11961     IF CERTCARI GREATER THAN LOW-VALUES
 11962        MOVE CERTCARI            TO CQ-CARRIER.
 11963
 11964
 11965* EXEC CICS REWRITE
 11966*         DATASET  (CHKQ-FILE-ID)
 11967*         FROM     (CHECK-QUE)
 11968*    END-EXEC.
 11969     MOVE LENGTH OF
 11970      CHECK-QUE
 11971       TO DFHEIV11
 11972*    MOVE '&& L                  %   #00010467' TO DFHEIV0
 11973     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11974     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 225
* EL131.cbl
 11975     MOVE X'2020233030303130343637' TO DFHEIV0(25:11)
 11976     CALL 'kxdfhei1' USING DFHEIV0,
 11977           CHKQ-FILE-ID,
 11978           CHECK-QUE,
 11979           DFHEIV11,
 11980           DFHEIV99
 11981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11982
 11983
 11984 2460-EXIT.
 11985     EXIT.
 11986
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 226
* EL131.cbl
 11988 2475-UPDATE-LETTER.
 11989
 11990* EXEC CICS HANDLE CONDITION
 11991*         NOTFND   (2475-EXIT)
 11992*    END-EXEC.
 11993*    MOVE '"$I                   ! 9 #00010477' TO DFHEIV0
 11994     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11996     MOVE X'3920233030303130343737' TO DFHEIV0(25:11)
 11997     CALL 'kxdfhei1' USING DFHEIV0
 11998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11999
 12000
 12001     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12002     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12003     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12004     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12005
 12006
 12007* EXEC CICS READ UPDATE
 12008*         DATASET   (ARCH-FILE-ID)
 12009*         RIDFLD    (ARCH-KEY)
 12010*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12011*    END-EXEC.
 12012*    MOVE '&"S        EU         (   #00010486' TO DFHEIV0
 12013     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12014     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12015     MOVE X'2020233030303130343836' TO DFHEIV0(25:11)
 12016     CALL 'kxdfhei1' USING DFHEIV0,
 12017           ARCH-FILE-ID,
 12018           DFHEIV20,
 12019           DFHEIV99,
 12020           ARCH-KEY,
 12021           DFHEIV99,
 12022           DFHEIV99,
 12023           DFHEIV99
 12024     SET ADDRESS OF LETTER-ARCHIVE TO
 12025         DFHEIV20
 12026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12027
 12028
 12029* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12030* TO THIS MASTER-KEY INFORMATION.
 12031
 12032     IF LA-CARRIER  = CARRIER-CODE AND
 12033        LA-CLAIM-NO = CLAIM-NO     AND
 12034        LA-CERT-NO  = CERT-NO
 12035        NEXT SENTENCE
 12036     ELSE
 12037        GO TO 2475-UNLOCK.
 12038
 12039     IF CERTI GREATER THAN LOW-VALUES
 12040        MOVE CERTI               TO LA-CERT-PRIME.
 12041     IF SUFXI GREATER THAN LOW-VALUES
 12042        MOVE SUFXI               TO LA-CERT-SFX.
 12043     IF CERTCARI GREATER THAN LOW-VALUES
 12044        MOVE CERTCARI            TO LA-CARRIER.
 12045
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 227
* EL131.cbl
 12046
 12047* EXEC CICS REWRITE
 12048*         DATASET  (ARCH-FILE-ID)
 12049*         FROM     (LETTER-ARCHIVE)
 12050*    END-EXEC.
 12051     MOVE LENGTH OF
 12052      LETTER-ARCHIVE
 12053       TO DFHEIV11
 12054*    MOVE '&& L                  %   #00010509' TO DFHEIV0
 12055     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12056     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12057     MOVE X'2020233030303130353039' TO DFHEIV0(25:11)
 12058     CALL 'kxdfhei1' USING DFHEIV0,
 12059           ARCH-FILE-ID,
 12060           LETTER-ARCHIVE,
 12061           DFHEIV11,
 12062           DFHEIV99
 12063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12064
 12065
 12066     GO TO 2475-EXIT.
 12067
 12068 2475-UNLOCK.
 12069
 12070* EXEC CICS UNLOCK
 12071*         DATASET  (ARCH-FILE-ID)
 12072*    END-EXEC.
 12073*    MOVE '&*                    #   #00010517' TO DFHEIV0
 12074     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12075     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12076     MOVE X'2020233030303130353137' TO DFHEIV0(25:11)
 12077     CALL 'kxdfhei1' USING DFHEIV0,
 12078           ARCH-FILE-ID,
 12079           DFHEIV99
 12080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12081
 12082
 12083 2475-EXIT.
 12084     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 228
* EL131.cbl
 12086 2600-CREATE-MAINT-NOTE.
 12087     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12088     MOVE '1'                    TO CNTL-REC-TYPE.
 12089     MOVE SPACES                 TO CNTL-PROC-ID.
 12090     MOVE ZERO                   TO CNTL-SEQ-NO.
 12091
 12092
 12093* EXEC CICS READ
 12094*         SET        (ADDRESS OF CONTROL-FILE)
 12095*         DATASET    ('ELCNTL')
 12096*         RIDFLD     (CNTL-KEY)
 12097*    END-EXEC.
 12098     MOVE 'ELCNTL' TO DFHEIV1
 12099*    MOVE '&"S        E          (   #00010530' TO DFHEIV0
 12100     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12102     MOVE X'2020233030303130353330' TO DFHEIV0(25:11)
 12103     CALL 'kxdfhei1' USING DFHEIV0,
 12104           DFHEIV1,
 12105           DFHEIV20,
 12106           DFHEIV99,
 12107           CNTL-KEY,
 12108           DFHEIV99,
 12109           DFHEIV99,
 12110           DFHEIV99
 12111     SET ADDRESS OF CONTROL-FILE TO
 12112         DFHEIV20
 12113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12114
 12115
 12116     IF CO-NO-USE-AUDIT-CHANGES
 12117         GO TO 2600-EXIT.
 12118
 12119     IF PROCL GREATER ZERO
 12120     IF PROCI NOT = LOW-VALUES
 12121     IF PROCI NOT = CL-PROCESSOR-ID
 12122         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12123         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12124         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12125
 12126     IF SEXL GREATER ZERO
 12127     IF SEXI NOT = LOW-VALUES
 12128     IF SEXI NOT = CL-INSURED-SEX-CD
 12129         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12130         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 12131         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12132
 12133     IF BIRTHL GREATER ZERO
 12134     IF HOLD-BIRTH NOT = LOW-VALUES
 12135     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 12136         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 12137         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 12138         MOVE SPACES               TO DC-OPTION-CODE
 12139         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12140         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12141         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12142
 12143     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 229
* EL131.cbl
 12144     IF SOCIALI NOT = LOW-VALUES
 12145     IF SOCIALI NOT = CL-SOC-SEC-NO
 12146         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 12147         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 12148         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12149
 12150     IF OCCL GREATER ZERO
 12151     IF OCCI NOT = LOW-VALUES
 12152     IF OCCI NOT = CL-INSURED-OCC-CD
 12153         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 12154         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 12155         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12156
 12157     IF BENEL GREATER ZERO
 12158     IF BENEI NOT = LOW-VALUES
 12159     IF BENEI NOT = CL-BENEFICIARY
 12160         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 12161         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 12162         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12163
 12164     IF PREMTYPL GREATER ZERO
 12165     IF PREMTYPI NOT = LOW-VALUES
 12166     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 12167         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 12168         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 12169         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12170
 12171     IF CAUSEL GREATER ZERO
 12172     IF CAUSEI NOT = LOW-VALUES
 12173     IF CAUSEI NOT = CL-CAUSE-CD
 12174         MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 12175         MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 12176         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12177
 12178     IF ENDL GREATER ZERO
 12179     IF HOLD-END NOT = LOW-VALUES
 12180     IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 12181         MOVE 'END DT'             TO SPLIT-INFO-DESC
 12182         MOVE CL-EST-END-OF-DISAB-DT
 12183                                   TO DC-BIN-DATE-1
 12184         MOVE SPACES               TO DC-OPTION-CODE
 12185         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12186         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12187         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12188
 12189     IF PDTHRUL GREATER ZERO
 12190     IF HOLD-PDTHRU NOT = LOW-VALUES
 12191     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 12192         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 12193         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 12194         MOVE SPACES               TO DC-OPTION-CODE
 12195         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12196         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12197         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12198
 12199     IF PDAMTL GREATER ZERO
 12200     IF HOLD-PDAMT NOT = ZEROS
 12201     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 230
* EL131.cbl
 12202         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 12203         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 12204         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 12205         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12206
 12207     IF NODAYSL GREATER ZERO
 12208     IF HOLD-NODAYS NOT = ZEROS
 12209     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 12210         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 12211         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 12212         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12213         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12214
 12215     IF NOPMTSL GREATER ZERO
 12216     IF HOLD-NOPMTS NOT = ZEROS
 12217     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 12218         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 12219         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 12220         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12221         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12222
 12223     IF FORMTYPL GREATER ZERO
 12224     IF FORMTYPI NOT = LOW-VALUES
 12225     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 12226         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 12227         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 12228         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12229
 12230     IF REPL GREATER ZERO
 12231     IF HOLD-REPORTED NOT = LOW-VALUES
 12232     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 12233         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 12234         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 12235         MOVE SPACES               TO DC-OPTION-CODE
 12236         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12237         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12238         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12239
 12240     IF ADDONDTL GREATER ZERO
 12241     IF HOLD-ADDON NOT = LOW-VALUES
 12242     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 12243         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 12244         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 12245         MOVE SPACES               TO DC-OPTION-CODE
 12246         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12247         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12248         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12249
 12250     IF PRICDL GREATER ZERO
 12251     IF PRICDI NOT = LOW-VALUES
 12252     IF PRICDI NOT = CL-PRIORITY-CD
 12253         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 12254         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 12255         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12256
 12257     IF FILETOL GREATER ZERO
 12258     IF FILETOI NOT = LOW-VALUES
 12259     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 231
* EL131.cbl
 12260         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 12261         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 12262         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12263
 12264     IF SUPVL GREATER ZERO
 12265     IF SUPVI NOT = LOW-VALUES
 12266     IF SUPVI NOT = CL-SUPV-ATTN-CD
 12267         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 12268         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 12269         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12270     IF (CRITPTL > ZERO)
 12271        AND (CRITPTI NOT = LOW-VALUES)
 12272        AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 12273        MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 12274        MOVE CL-CRIT-PER-RECURRENT
 12275                                 TO SPLIT-INFO-OLD
 12276        PERFORM 2650-WRITE-MAINT-NOTE
 12277                                 THRU 2650-EXIT
 12278     END-IF
 12279
 12280     IF (RTWMOSL > ZERO)
 12281        AND (RTWMOSI NOT = LOW-VALUES)
 12282        AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 12283        MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 12284        MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 12285        PERFORM 2650-WRITE-MAINT-NOTE
 12286                                 THRU 2650-EXIT
 12287     END-IF
 12288     IF MLNAMEL GREATER ZERO
 12289     IF MLNAMEI NOT = LOW-VALUES
 12290     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 12291         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 12292         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 12293         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12294
 12295     IF MFNAMEL GREATER ZERO
 12296     IF MFNAMEI NOT = LOW-VALUES
 12297     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 12298         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 12299         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 12300         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12301
 12302     IF MMINITL GREATER ZERO
 12303     IF MMINITI NOT = LOW-VALUES
 12304     IF MMINITI NOT = CL-INSURED-MID-INIT
 12305         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 12306         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 12307         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12308
 12309     IF CERTEFFL GREATER ZERO
 12310     IF HOLD-EFF NOT = LOW-VALUES
 12311     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 12312         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 12313         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 12314         MOVE SPACES               TO DC-OPTION-CODE
 12315         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12316         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12317         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 232
* EL131.cbl
 12318
 12319     IF CERTACTL GREATER ZERO
 12320     IF CERTACTI NOT = LOW-VALUES
 12321     IF CERTACTI NOT = CL-CERT-ACCOUNT
 12322         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 12323         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 12324         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12325
 12326     IF CERTSTL GREATER ZERO
 12327     IF CERTSTI NOT = LOW-VALUES
 12328     IF CERTSTI NOT = CL-CERT-STATE
 12329         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 12330         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 12331         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12332
 12333     IF CERTCARL GREATER ZERO
 12334     IF CERTCARI NOT = LOW-VALUES
 12335     IF CERTCARI NOT = CL-CERT-CARRIER
 12336         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 12337         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 12338         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12339
 12340     IF CERTGRPL GREATER ZERO
 12341     IF CERTGRPI NOT = LOW-VALUES
 12342     IF CERTGRPI NOT = CL-CERT-GROUPING
 12343         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 12344         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 12345         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12346
 12347     IF CERTL GREATER ZERO OR
 12348        SUFXL GREATER ZERO
 12349     IF (CERTI NOT = LOW-VALUES AND
 12350                     CL-CERT-PRIME)
 12351                OR
 12352        (SUFXI NOT = LOW-VALUES AND
 12353                     CL-CERT-SFX)
 12354         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 12355         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 12356         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12357
 12358 2600-EXIT.
 12359      EXIT.
 12360
 12361 2650-WRITE-MAINT-NOTE.
 12362
 12363* EXEC CICS GETMAIN
 12364*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12365*         LENGTH   (TRLR-LENGTH)
 12366*         INITIMG  (GETMAIN-SPACE)
 12367*    END-EXEC.
 12368*    MOVE ',"IL                  $   #00010782' TO DFHEIV0
 12369     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12370     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12371     MOVE X'2020233030303130373832' TO DFHEIV0(25:11)
 12372     CALL 'kxdfhei1' USING DFHEIV0,
 12373           DFHEIV20,
 12374           TRLR-LENGTH,
 12375           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 233
* EL131.cbl
 12376     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12377         DFHEIV20
 12378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12379
 12380
 12381
 12382* EXEC CICS HANDLE CONDITION
 12383*         DUPREC   (2650-EXIT)
 12384*    END-EXEC.
 12385*    MOVE '"$%                   ! : #00010788' TO DFHEIV0
 12386     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12388     MOVE X'3A20233030303130373838' TO DFHEIV0(25:11)
 12389     CALL 'kxdfhei1' USING DFHEIV0
 12390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12391
 12392
 12393     MOVE SPACES             TO ACTIVITY-TRAILERS.
 12394
 12395     IF CERTL GREATER ZERO
 12396         MOVE CERTI          TO CL-CERT-PRIME.
 12397
 12398     IF SUFXL GREATER ZERO
 12399         MOVE SUFXI          TO CL-CERT-SFX.
 12400
 12401     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 12402
 12403     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 12404     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 12405
 12406     MOVE 'AT'               TO AT-RECORD-ID.
 12407
 12408     MOVE '6'                TO AT-TRAILER-TYPE.
 12409     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 12410                                AT-GEN-INFO-LAST-MAINT-DT.
 12411     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 12412                                AT-GEN-INFO-LAST-UPDATED-BY.
 12413     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 12414     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 12415     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 12416
 12417
 12418* EXEC CICS WRITE
 12419*         DATASET  (TRLR-FILE-ID)
 12420*         RIDFLD   (AT-CONTROL-PRIMARY)
 12421*         FROM     (ACTIVITY-TRAILERS)
 12422*    END-EXEC.
 12423     MOVE LENGTH OF
 12424      ACTIVITY-TRAILERS
 12425       TO DFHEIV11
 12426*    MOVE '&$ L                  ''   #00010816' TO DFHEIV0
 12427     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12428     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12429     MOVE X'2020233030303130383136' TO DFHEIV0(25:11)
 12430     CALL 'kxdfhei1' USING DFHEIV0,
 12431           TRLR-FILE-ID,
 12432           ACTIVITY-TRAILERS,
 12433           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 234
* EL131.cbl
 12434           AT-CONTROL-PRIMARY,
 12435           DFHEIV99,
 12436           DFHEIV99
 12437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12438
 12439
 12440 2650-EXIT.
 12441      EXIT.
 12442
 12443 2800-CHECK-AUTO-PAY.
 12444
 12445     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 12446     MOVE PI-CARRIER         TO TRLR-CARRIER.
 12447     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 12448     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 12449     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 12450
 12451
 12452* EXEC CICS HANDLE CONDITION
 12453*         NOTFND    (2800-EXIT)
 12454*         ENDFILE   (2800-EXIT)
 12455*    END-EXEC.
 12456*    MOVE '"$I''                  ! ; #00010833' TO DFHEIV0
 12457     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12459     MOVE X'3B20233030303130383333' TO DFHEIV0(25:11)
 12460     CALL 'kxdfhei1' USING DFHEIV0
 12461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12462
 12463
 12464
 12465* EXEC CICS READ
 12466*        DATASET (TRLR-FILE-ID)
 12467*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12468*        RIDFLD  (TRLR-KEY)
 12469*    END-EXEC.
 12470*    MOVE '&"S        E          (   #00010838' TO DFHEIV0
 12471     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12472     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12473     MOVE X'2020233030303130383338' TO DFHEIV0(25:11)
 12474     CALL 'kxdfhei1' USING DFHEIV0,
 12475           TRLR-FILE-ID,
 12476           DFHEIV20,
 12477           DFHEIV99,
 12478           TRLR-KEY,
 12479           DFHEIV99,
 12480           DFHEIV99,
 12481           DFHEIV99
 12482     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12483         DFHEIV20
 12484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12485
 12486
 12487     IF BENEFICIARY-PAID-AUTO
 12488         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 12489     END-IF.
 12490
 12491 2800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 235
* EL131.cbl
 12492      EXIT.
 12493
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 236
* EL131.cbl
 12495 3000-DELETE-CLAIM.
 12496     IF  NOT MODIFY-CAP
 12497         MOVE ER-0070            TO EMI-ERROR
 12498         MOVE -1                 TO MAINTL
 12499         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12500         GO TO 8110-SEND-DATA.
 12501
 12502
 12503* EXEC CICS READ
 12504*         SET      (ADDRESS OF CLAIM-MASTER)
 12505*         DATASET  (CLMS-FILE-ID)
 12506*         RIDFLD   (MSTR-KEY)
 12507*    END-EXEC.
 12508*    MOVE '&"S        E          (   #00010859' TO DFHEIV0
 12509     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12510     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12511     MOVE X'2020233030303130383539' TO DFHEIV0(25:11)
 12512     CALL 'kxdfhei1' USING DFHEIV0,
 12513           CLMS-FILE-ID,
 12514           DFHEIV20,
 12515           DFHEIV99,
 12516           MSTR-KEY,
 12517           DFHEIV99,
 12518           DFHEIV99,
 12519           DFHEIV99
 12520     SET ADDRESS OF CLAIM-MASTER TO
 12521         DFHEIV20
 12522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12523
 12524
 12525     IF CL-1ST-TRL-AVAIL
 12526         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 12527     ELSE
 12528        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 12529        MOVE 0                   TO TRLR-SEQ-NO
 12530
 12531* EXEC CICS STARTBR
 12532*            DATASET (TRLR-FILE-ID)
 12533*            RIDFLD  (TRLR-KEY)
 12534*        END-EXEC
 12535     MOVE 0
 12536       TO DFHEIV11
 12537*    MOVE '&,         G          &   #00010870' TO DFHEIV0
 12538     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12539     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12540     MOVE X'2020233030303130383730' TO DFHEIV0(25:11)
 12541     CALL 'kxdfhei1' USING DFHEIV0,
 12542           TRLR-FILE-ID,
 12543           TRLR-KEY,
 12544           DFHEIV99,
 12545           DFHEIV11,
 12546           DFHEIV99
 12547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12548         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 12549
 12550* EXEC CICS ENDBR
 12551*            DATASET (TRLR-FILE-ID)
 12552*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 237
* EL131.cbl
 12553     MOVE 0
 12554       TO DFHEIV11
 12555*    MOVE '&2                    $   #00010875' TO DFHEIV0
 12556     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12557     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12558     MOVE X'2020233030303130383735' TO DFHEIV0(25:11)
 12559     CALL 'kxdfhei1' USING DFHEIV0,
 12560           TRLR-FILE-ID,
 12561           DFHEIV11,
 12562           DFHEIV99
 12563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12564        IF SCREEN-ERROR
 12565            MOVE ER-0208         TO EMI-ERROR
 12566            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12567            MOVE -1              TO MAINTL
 12568            GO TO 8110-SEND-DATA
 12569        ELSE
 12570            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 12571
 12572     IF SCREEN-ERROR
 12573         MOVE -1                 TO MAINTL
 12574         GO TO 8110-SEND-DATA.
 12575
 12576     MOVE -1                     TO ONE-OR-MIN1.
 12577     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 12578
 12579     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 12580         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 12581                                    WS-SAVE-CLAIM-KEY
 12582         MOVE +1                 TO ONE-OR-MIN1
 12583         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 12584
 12585     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 12586
 12587     MOVE LOW-VALUES             TO EL131AO.
 12588     MOVE ER-0000                TO EMI-ERROR.
 12589     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12590     MOVE 'X'                    TO PI-RETURN-CD-1.
 12591     MOVE -1                     TO MAINTL.
 12592     GO TO 8100-SEND-MAP.
 12593
 12594 3010-DEL-MSTR-TRLR.
 12595
 12596* EXEC CICS READ UPDATE
 12597*         SET       (ADDRESS OF CLAIM-MASTER)
 12598*         DATASET   (CLMS-FILE-ID)
 12599*         RIDFLD    (MSTR-KEY)
 12600*    END-EXEC.
 12601*    MOVE '&"S        EU         (   #00010909' TO DFHEIV0
 12602     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12603     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12604     MOVE X'2020233030303130393039' TO DFHEIV0(25:11)
 12605     CALL 'kxdfhei1' USING DFHEIV0,
 12606           CLMS-FILE-ID,
 12607           DFHEIV20,
 12608           DFHEIV99,
 12609           MSTR-KEY,
 12610           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 238
* EL131.cbl
 12611           DFHEIV99,
 12612           DFHEIV99
 12613     SET ADDRESS OF CLAIM-MASTER TO
 12614         DFHEIV20
 12615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12616
 12617
 12618     if (cl-priority-cd = '8')
 12619        and (pi-processor-id not = 'PEMA' and 'JMS '
 12620             AND 'AMWA')
 12621        MOVE ER-8003             TO EMI-ERROR
 12622        PERFORM 9900-ERROR-FORMAT
 12623                                 THRU 9900-EXIT
 12624        MOVE -1                  TO MAINTL
 12625        GO TO 8110-SEND-DATA
 12626     end-if
 12627
 12628     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 12629     MOVE ZERO                   TO TRLR-SEQ-NO.
 12630
 12631
 12632* EXEC CICS HANDLE CONDITION
 12633*         NOTFND    (3010-DEL-ACTQ)
 12634*         ENDFILE   (3040-EXIT)
 12635*    END-EXEC.
 12636*    MOVE '"$I''                  ! < #00010928' TO DFHEIV0
 12637     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12638     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12639     MOVE X'3C20233030303130393238' TO DFHEIV0(25:11)
 12640     CALL 'kxdfhei1' USING DFHEIV0
 12641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12642
 12643
 12644     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 12645
 12646 3010-DEL-ACTQ.
 12647
 12648
 12649* EXEC CICS HANDLE CONDITION
 12650*         NOTFND    (3010-NO-ACTIVITY)
 12651*         ENDFILE   (3050-EXIT)
 12652*    END-EXEC.
 12653*    MOVE '"$I''                  ! = #00010937' TO DFHEIV0
 12654     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12655     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12656     MOVE X'3D20233030303130393337' TO DFHEIV0(25:11)
 12657     CALL 'kxdfhei1' USING DFHEIV0
 12658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12659
 12660
 12661
 12662* EXEC CICS STARTBR
 12663*         DATASET  (ACTQ-FILE-ID)
 12664*         RIDFLD   (ACTQ-KEY)
 12665*    END-EXEC.
 12666     MOVE 0
 12667       TO DFHEIV11
 12668*    MOVE '&,         G          &   #00010942' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 239
* EL131.cbl
 12669     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12670     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12671     MOVE X'2020233030303130393432' TO DFHEIV0(25:11)
 12672     CALL 'kxdfhei1' USING DFHEIV0,
 12673           ACTQ-FILE-ID,
 12674           ACTQ-KEY,
 12675           DFHEIV99,
 12676           DFHEIV11,
 12677           DFHEIV99
 12678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12679
 12680
 12681
 12682* EXEC CICS GETMAIN
 12683*         SET      (ADDRESS OF ACTIVITY-QUE)
 12684*         LENGTH   (ACTQ-LENGTH)
 12685*         INITIMG  (GETMAIN-SPACE)
 12686*    END-EXEC.
 12687*    MOVE ',"IL                  $   #00010947' TO DFHEIV0
 12688     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12689     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12690     MOVE X'2020233030303130393437' TO DFHEIV0(25:11)
 12691     CALL 'kxdfhei1' USING DFHEIV0,
 12692           DFHEIV20,
 12693           ACTQ-LENGTH,
 12694           GETMAIN-SPACE
 12695     SET ADDRESS OF ACTIVITY-QUE TO
 12696         DFHEIV20
 12697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12698
 12699
 12700     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 12701
 12702
 12703* EXEC CICS ENDBR
 12704*         DATASET (ACTQ-FILE-ID)
 12705*    END-EXEC.
 12706     MOVE 0
 12707       TO DFHEIV11
 12708*    MOVE '&2                    $   #00010955' TO DFHEIV0
 12709     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12710     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12711     MOVE X'2020233030303130393535' TO DFHEIV0(25:11)
 12712     CALL 'kxdfhei1' USING DFHEIV0,
 12713           ACTQ-FILE-ID,
 12714           DFHEIV11,
 12715           DFHEIV99
 12716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12717
 12718
 12719 3010-NO-ACTIVITY.
 12720
 12721
 12722* EXEC CICS HANDLE CONDITION
 12723*        NOTFND   (3010-CERT-NOT-FOUND)
 12724*    END-EXEC.
 12725*    MOVE '"$I                   ! > #00010961' TO DFHEIV0
 12726     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 240
* EL131.cbl
 12727     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12728     MOVE X'3E20233030303130393631' TO DFHEIV0(25:11)
 12729     CALL 'kxdfhei1' USING DFHEIV0
 12730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12731
 12732
 12733     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12734     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12735     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12736     MOVE CL-CERT-STATE          TO CERT-STATE.
 12737     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12738     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12739     MOVE CL-CERT-NO             TO CERT-CERT.
 12740
 12741
 12742* EXEC CICS READ
 12743*        DATASET   (CERT-FILE-ID)
 12744*        RIDFLD    (CERT-KEY)
 12745*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12746*    END-EXEC.
 12747*    MOVE '&"S        E          (   #00010973' TO DFHEIV0
 12748     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12750     MOVE X'2020233030303130393733' TO DFHEIV0(25:11)
 12751     CALL 'kxdfhei1' USING DFHEIV0,
 12752           CERT-FILE-ID,
 12753           DFHEIV20,
 12754           DFHEIV99,
 12755           CERT-KEY,
 12756           DFHEIV99,
 12757           DFHEIV99,
 12758           DFHEIV99
 12759     SET ADDRESS OF CERTIFICATE-MASTER TO
 12760         DFHEIV20
 12761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12762
 12763
 12764     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12765       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 12766         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12767     ELSE
 12768         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 12769
 12770  3010-UPDATE-CERT-TRLR.
 12771
 12772      MOVE CERT-KEY              TO ELCRTT-KEY
 12773      MOVE 'B'                   TO CTRLR-REC-TYPE
 12774
 12775* EXEC CICS READ
 12776*        UPDATE
 12777*        DATASET   ('ELCRTT')
 12778*        RIDFLD    (ELCRTT-KEY)
 12779*        INTO      (CERTIFICATE-TRAILERS)
 12780*        RESP      (WS-RESPONSE)
 12781*     END-EXEC
 12782     MOVE LENGTH OF
 12783      CERTIFICATE-TRAILERS
 12784       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 241
* EL131.cbl
 12785     MOVE 'ELCRTT' TO DFHEIV1
 12786*    MOVE '&"IL       EU         (  N#00010989' TO DFHEIV0
 12787     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12788     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12789     MOVE X'204E233030303130393839' TO DFHEIV0(25:11)
 12790     CALL 'kxdfhei1' USING DFHEIV0,
 12791           DFHEIV1,
 12792           CERTIFICATE-TRAILERS,
 12793           DFHEIV11,
 12794           ELCRTT-KEY,
 12795           DFHEIV99,
 12796           DFHEIV99,
 12797           DFHEIV99
 12798     MOVE EIBRESP  TO WS-RESPONSE
 12799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12800      IF WS-RESP-NORMAL
 12801*    if cl-insured-claim = 'S'
 12802*       move +2 to s1
 12803*    else
 12804*       MOVE +1 to s1
 12805*    end-if
 12806
 12807     move +1 to s1
 12808     evaluate cl-claim-type
 12809        when 'A'
 12810           move +1 to s2
 12811        when 'I'
 12812           move +2 to s2
 12813        when 'G'
 12814           move +3 to s2
 12815        when 'L'
 12816           move +4 to s2
 12817        when 'P'
 12818           move +5 to s2
 12819     end-evaluate
 12820     SUBTRACT +1 FROM CS-NO-OF-CLAIMS (S1 S2)
 12821     IF CS-NO-OF-CLAIMS (S1 S2) < ZEROS
 12822        MOVE ZEROS               TO CS-NO-OF-CLAIMS (S1 S2)
 12823     END-IF
 12824     if cs-no-of-claims (s1 s2) = zeros
 12825        move spaces              to cs-claim-type (s1 s2)
 12826     end-if
 12827
 12828
 12829* EXEC CICS REWRITE
 12830*       DATASET   ('ELCRTT')
 12831*       FROM      (CERTIFICATE-TRAILERS)
 12832*    END-EXEC
 12833     MOVE LENGTH OF
 12834      CERTIFICATE-TRAILERS
 12835       TO DFHEIV11
 12836     MOVE 'ELCRTT' TO DFHEIV1
 12837*    MOVE '&& L                  %   #00011024' TO DFHEIV0
 12838     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12839     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12840     MOVE X'2020233030303131303234' TO DFHEIV0(25:11)
 12841     CALL 'kxdfhei1' USING DFHEIV0,
 12842           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 242
* EL131.cbl
 12843           CERTIFICATE-TRAILERS,
 12844           DFHEIV11,
 12845           DFHEIV99
 12846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12847     .
 12848 3010-CERT-NOT-FOUND.
 12849
 12850
 12851* EXEC CICS DELETE
 12852*        DATASET  (CLMS-FILE-ID)
 12853*    END-EXEC.
 12854*    MOVE '&(                    &   #00011031' TO DFHEIV0
 12855     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12856     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12857     MOVE X'2020233030303131303331' TO DFHEIV0(25:11)
 12858     CALL 'kxdfhei1' USING DFHEIV0,
 12859           CLMS-FILE-ID,
 12860           DFHEIV99,
 12861           DFHEIV99,
 12862           DFHEIV99,
 12863           DFHEIV99
 12864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12865
 12866
 12867 3010-EXIT.
 12868      EXIT.
 12869
 12870 3020-UPDATE-CERT.
 12871
 12872* EXEC CICS READ UPDATE
 12873*         DATASET  (CERT-FILE-ID)
 12874*         RIDFLD   (CERT-KEY)
 12875*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12876*    END-EXEC.
 12877*    MOVE '&"S        EU         (   #00011039' TO DFHEIV0
 12878     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12879     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12880     MOVE X'2020233030303131303339' TO DFHEIV0(25:11)
 12881     CALL 'kxdfhei1' USING DFHEIV0,
 12882           CERT-FILE-ID,
 12883           DFHEIV20,
 12884           DFHEIV99,
 12885           CERT-KEY,
 12886           DFHEIV99,
 12887           DFHEIV99,
 12888           DFHEIV99
 12889     SET ADDRESS OF CERTIFICATE-MASTER TO
 12890         DFHEIV20
 12891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12892
 12893
 12894     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 12895
 12896
 12897* EXEC CICS HANDLE CONDITION
 12898*         DUPKEY   (3020-EXIT)
 12899*    END-EXEC.
 12900*    MOVE '"$$                   ! ? #00011047' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 243
* EL131.cbl
 12901     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12903     MOVE X'3F20233030303131303437' TO DFHEIV0(25:11)
 12904     CALL 'kxdfhei1' USING DFHEIV0
 12905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12906
 12907
 12908
 12909* EXEC CICS REWRITE
 12910*         DATASET  (CERT-FILE-ID)
 12911*         FROM     (CERTIFICATE-MASTER)
 12912*    END-EXEC.
 12913     MOVE LENGTH OF
 12914      CERTIFICATE-MASTER
 12915       TO DFHEIV11
 12916*    MOVE '&& L                  %   #00011051' TO DFHEIV0
 12917     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12918     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12919     MOVE X'2020233030303131303531' TO DFHEIV0(25:11)
 12920     CALL 'kxdfhei1' USING DFHEIV0,
 12921           CERT-FILE-ID,
 12922           CERTIFICATE-MASTER,
 12923           DFHEIV11,
 12924           DFHEIV99
 12925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12926
 12927
 12928 3020-EXIT.
 12929     EXIT.
 12930
 12931 3030-DELETE-CERT.
 12932
 12933* EXEC CICS READ UPDATE
 12934*         DATASET  (CERT-FILE-ID)
 12935*         RIDFLD   (CERT-KEY)
 12936*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12937*    END-EXEC.
 12938*    MOVE '&"S        EU         (   #00011060' TO DFHEIV0
 12939     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12940     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12941     MOVE X'2020233030303131303630' TO DFHEIV0(25:11)
 12942     CALL 'kxdfhei1' USING DFHEIV0,
 12943           CERT-FILE-ID,
 12944           DFHEIV20,
 12945           DFHEIV99,
 12946           CERT-KEY,
 12947           DFHEIV99,
 12948           DFHEIV99,
 12949           DFHEIV99
 12950     SET ADDRESS OF CERTIFICATE-MASTER TO
 12951         DFHEIV20
 12952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12953
 12954
 12955
 12956* EXEC CICS DELETE
 12957*         DATASET   (CERT-FILE-ID)
 12958*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 244
* EL131.cbl
 12959*    MOVE '&(                    &   #00011066' TO DFHEIV0
 12960     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12961     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12962     MOVE X'2020233030303131303636' TO DFHEIV0(25:11)
 12963     CALL 'kxdfhei1' USING DFHEIV0,
 12964           CERT-FILE-ID,
 12965           DFHEIV99,
 12966           DFHEIV99,
 12967           DFHEIV99,
 12968           DFHEIV99
 12969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12970
 12971
 12972 3030-EXIT.
 12973     EXIT.
 12974
 12975 3040-DELETE-TRLR.
 12976
 12977* EXEC CICS READ
 12978*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12979*         DATASET  (TRLR-FILE-ID)
 12980*         RIDFLD   (TRLR-KEY)
 12981*         GTEQ
 12982*    END-EXEC.
 12983*    MOVE '&"S        G          (   #00011074' TO DFHEIV0
 12984     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12986     MOVE X'2020233030303131303734' TO DFHEIV0(25:11)
 12987     CALL 'kxdfhei1' USING DFHEIV0,
 12988           TRLR-FILE-ID,
 12989           DFHEIV20,
 12990           DFHEIV99,
 12991           TRLR-KEY,
 12992           DFHEIV99,
 12993           DFHEIV99,
 12994           DFHEIV99
 12995     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12996         DFHEIV20
 12997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12998
 12999
 13000     IF PI-COMPANY-CD = AT-COMPANY-CD
 13001        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13002        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13003           GO TO 3040-EXIT
 13004        ELSE
 13005           NEXT SENTENCE
 13006     ELSE
 13007        GO TO 3040-EXIT.
 13008
 13009
 13010* EXEC CICS DELETE
 13011*         DATASET  (TRLR-FILE-ID)
 13012*         RIDFLD   (TRLR-KEY)
 13013*    END-EXEC.
 13014*    MOVE '&(  R                 &   #00011090' TO DFHEIV0
 13015     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13016     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 245
* EL131.cbl
 13017     MOVE X'2020233030303131303930' TO DFHEIV0(25:11)
 13018     CALL 'kxdfhei1' USING DFHEIV0,
 13019           TRLR-FILE-ID,
 13020           TRLR-KEY,
 13021           DFHEIV99,
 13022           DFHEIV99,
 13023           DFHEIV99
 13024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13025
 13026
 13027     GO TO 3040-DELETE-TRLR.
 13028
 13029 3040-EXIT.
 13030     EXIT.
 13031
 13032 3050-DELETE-ACTQ.
 13033
 13034* EXEC CICS READNEXT
 13035*         DATASET  (ACTQ-FILE-ID)
 13036*         RIDFLD   (ACTQ-KEY)
 13037*         INTO     (ACTIVITY-QUE)
 13038*    END-EXEC.
 13039     MOVE LENGTH OF
 13040      ACTIVITY-QUE
 13041       TO DFHEIV12
 13042     MOVE 0
 13043       TO DFHEIV11
 13044*    MOVE '&.IL                  )   #00011101' TO DFHEIV0
 13045     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13046     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13047     MOVE X'2020233030303131313031' TO DFHEIV0(25:11)
 13048     CALL 'kxdfhei1' USING DFHEIV0,
 13049           ACTQ-FILE-ID,
 13050           ACTIVITY-QUE,
 13051           DFHEIV12,
 13052           ACTQ-KEY,
 13053           DFHEIV99,
 13054           DFHEIV11,
 13055           DFHEIV99,
 13056           DFHEIV99
 13057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13058
 13059
 13060     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13061         GO TO 3050-EXIT.
 13062
 13063
 13064* EXEC CICS ENDBR
 13065*         DATASET  (ACTQ-FILE-ID)
 13066*    END-EXEC.
 13067     MOVE 0
 13068       TO DFHEIV11
 13069*    MOVE '&2                    $   #00011110' TO DFHEIV0
 13070     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13071     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13072     MOVE X'2020233030303131313130' TO DFHEIV0(25:11)
 13073     CALL 'kxdfhei1' USING DFHEIV0,
 13074           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 246
* EL131.cbl
 13075           DFHEIV11,
 13076           DFHEIV99
 13077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13078
 13079
 13080
 13081* EXEC CICS DELETE
 13082*         DATASET   (ACTQ-FILE-ID)
 13083*         RIDFLD    (ACTQ-KEY)
 13084*    END-EXEC.
 13085*    MOVE '&(  R                 &   #00011114' TO DFHEIV0
 13086     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13087     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13088     MOVE X'2020233030303131313134' TO DFHEIV0(25:11)
 13089     CALL 'kxdfhei1' USING DFHEIV0,
 13090           ACTQ-FILE-ID,
 13091           ACTQ-KEY,
 13092           DFHEIV99,
 13093           DFHEIV99,
 13094           DFHEIV99
 13095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13096
 13097
 13098
 13099* EXEC CICS STARTBR
 13100*         DATASET   (ACTQ-FILE-ID)
 13101*         RIDFLD    (ACTQ-KEY)
 13102*    END-EXEC.
 13103     MOVE 0
 13104       TO DFHEIV11
 13105*    MOVE '&,         G          &   #00011119' TO DFHEIV0
 13106     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13107     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13108     MOVE X'2020233030303131313139' TO DFHEIV0(25:11)
 13109     CALL 'kxdfhei1' USING DFHEIV0,
 13110           ACTQ-FILE-ID,
 13111           ACTQ-KEY,
 13112           DFHEIV99,
 13113           DFHEIV11,
 13114           DFHEIV99
 13115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13116
 13117
 13118     GO TO 3050-DELETE-ACTQ.
 13119
 13120 3050-EXIT.
 13121     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 247
* EL131.cbl
 13123 3060-READ-TRLR.
 13124
 13125* EXEC CICS HANDLE CONDITION
 13126*         NOTFND    (3060-EXIT)
 13127*         ENDFILE   (3060-EXIT)
 13128*    END-EXEC.
 13129*    MOVE '"$I''                  ! @ #00011130' TO DFHEIV0
 13130     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13132     MOVE X'4020233030303131313330' TO DFHEIV0(25:11)
 13133     CALL 'kxdfhei1' USING DFHEIV0
 13134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13135
 13136
 13137 3060-LOOP.
 13138
 13139* EXEC CICS READNEXT
 13140*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13141*         DATASET  (TRLR-FILE-ID)
 13142*         RIDFLD   (TRLR-KEY)
 13143*    END-EXEC.
 13144     MOVE 0
 13145       TO DFHEIV11
 13146*    MOVE '&.S                   )   #00011136' TO DFHEIV0
 13147     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13148     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13149     MOVE X'2020233030303131313336' TO DFHEIV0(25:11)
 13150     CALL 'kxdfhei1' USING DFHEIV0,
 13151           TRLR-FILE-ID,
 13152           DFHEIV20,
 13153           DFHEIV99,
 13154           TRLR-KEY,
 13155           DFHEIV99,
 13156           DFHEIV11,
 13157           DFHEIV99,
 13158           DFHEIV99
 13159     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13160         DFHEIV20
 13161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13162
 13163
 13164     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13165         GO TO 3060-EXIT.
 13166
 13167     IF FORM-CONTROL-TR
 13168         IF AT-RECORDED-DT = SAVE-BIN-DATE
 13169             NEXT SENTENCE
 13170         ELSE
 13171             MOVE 'X'            TO ERROR-SWITCH
 13172             GO TO 3060-EXIT
 13173     ELSE
 13174         IF PAYMENT-TR OR CORRESPONDENCE-TR
 13175            MOVE 'X'                 TO ERROR-SWITCH
 13176            GO TO 3060-EXIT.
 13177
 13178     GO TO 3060-LOOP.
 13179
 13180 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 248
* EL131.cbl
 13181     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 249
* EL131.cbl
 13183 3997-GET-ERPDEF.
 13184
 13185     move cl-company-cd          to cert-company-code
 13186     move cl-cert-key-data       to cert-key (2:21)
 13187     move cl-cert-no             to cert-cert
 13188
 13189
 13190* EXEC CICS READ
 13191*        DATASET   (CERT-FILE-ID)
 13192*        RIDFLD    (CERT-KEY)
 13193*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13194*        resp      (ws-response)
 13195*    END-EXEC
 13196*    MOVE '&"S        E          (  N#00011167' TO DFHEIV0
 13197     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13198     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13199     MOVE X'204E233030303131313637' TO DFHEIV0(25:11)
 13200     CALL 'kxdfhei1' USING DFHEIV0,
 13201           CERT-FILE-ID,
 13202           DFHEIV20,
 13203           DFHEIV99,
 13204           CERT-KEY,
 13205           DFHEIV99,
 13206           DFHEIV99,
 13207           DFHEIV99
 13208     SET ADDRESS OF CERTIFICATE-MASTER TO
 13209         DFHEIV20
 13210     MOVE EIBRESP  TO ws-response
 13211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13212
 13213     MOVE SPACES                 TO WS-CRIT-PER-RECURRENT
 13214                                    WS-ERPDEF-SW
 13215     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 13216                                    WS-CRIT-PER-RTW-MOS
 13217
 13218     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 13219     MOVE CM-STATE               TO ERPDEF-STATE
 13220     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 13221     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 13222     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
 13223     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 13224     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 13225
 13226
 13227* EXEC CICS STARTBR
 13228*        DATASET  ('ERPDEF')
 13229*        RIDFLD   (ERPDEF-KEY)
 13230*        GTEQ
 13231*        RESP     (WS-RESPONSE)
 13232*    END-EXEC
 13233     MOVE 'ERPDEF' TO DFHEIV1
 13234     MOVE 0
 13235       TO DFHEIV11
 13236*    MOVE '&,         G          &  N#00011187' TO DFHEIV0
 13237     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13238     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13239     MOVE X'204E233030303131313837' TO DFHEIV0(25:11)
 13240     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 250
* EL131.cbl
 13241           DFHEIV1,
 13242           ERPDEF-KEY,
 13243           DFHEIV99,
 13244           DFHEIV11,
 13245           DFHEIV99
 13246     MOVE EIBRESP  TO WS-RESPONSE
 13247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13248
 13249     IF WS-RESP-NORMAL
 13250
 13251* EXEC CICS READNEXT
 13252*          DATASET  ('ERPDEF')
 13253*          INTO     (PRODUCT-MASTER)
 13254*          RIDFLD   (ERPDEF-KEY)
 13255*          RESP     (WS-RESPONSE)
 13256*       END-EXEC
 13257     MOVE LENGTH OF
 13258      PRODUCT-MASTER
 13259       TO DFHEIV12
 13260     MOVE 'ERPDEF' TO DFHEIV1
 13261     MOVE 0
 13262       TO DFHEIV11
 13263*    MOVE '&.IL                  )  N#00011195' TO DFHEIV0
 13264     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13265     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13266     MOVE X'204E233030303131313935' TO DFHEIV0(25:11)
 13267     CALL 'kxdfhei1' USING DFHEIV0,
 13268           DFHEIV1,
 13269           PRODUCT-MASTER,
 13270           DFHEIV12,
 13271           ERPDEF-KEY,
 13272           DFHEIV99,
 13273           DFHEIV11,
 13274           DFHEIV99,
 13275           DFHEIV99
 13276     MOVE EIBRESP  TO WS-RESPONSE
 13277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13278        IF WS-RESP-NORMAL
 13279           IF (ERPDEF-KEY-SAVE (1:16) =
 13280              PD-CONTROL-PRIMARY (1:16))
 13281              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 13282              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 13283                 (A1 > +8)
 13284                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 13285              END-PERFORM
 13286              IF A1 < +9
 13287                 SET ERPDEF-FOUND TO TRUE
 13288                 MOVE PD-CRIT-PERIOD (A1)
 13289                              TO WS-CRITICAL-PERIOD
 13290                 MOVE PD-REC-CRIT-PERIOD (A1)
 13291                              TO WS-CRIT-PER-RECURRENT
 13292                 IF PD-RTW-MOS (A1) NUMERIC
 13293                    MOVE PD-RTW-MOS (A1)
 13294                              TO WS-CRIT-PER-RTW-MOS
 13295                 ELSE
 13296                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 13297                 END-IF
 13298                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 251
* EL131.cbl
 13299                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 13300                                 TO WS-EXCL-PERIOD
 13301                 END-IF
 13302                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 13303                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 13304                                 TO WS-COV-ENDS
 13305                 END-IF
 13306                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 13307                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 13308                                 TO WS-ACC-PERIOD
 13309                 END-IF
 13310              END-IF
 13311           END-IF
 13312        END-IF
 13313     END-IF
 13314
 13315     .
 13316 3997-EXIT.
 13317     EXIT.
 13318 4000-FORCE-ERRORS.
 13319     IF PI-RETURN-CD-1 = 'X'
 13320         MOVE ER-0311            TO EMI-ERROR
 13321         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13322         MOVE -1                 TO MAINTL
 13323         GO TO 8110-SEND-DATA.
 13324
 13325     IF NOT FORCE-CAP
 13326         MOVE ER-0416            TO EMI-ERROR
 13327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13328         MOVE -1                 TO MAINTL
 13329         GO TO 8110-SEND-DATA.
 13330
 13331     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 13332     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 13333     IF EMI-FATAL-CTR GREATER THAN ZERO
 13334         GO TO 4000-FATAL-ERRORS.
 13335
 13336     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 13337
 13338     IF EMI-FATAL-CTR GREATER THAN ZERO
 13339         GO TO 4000-FATAL-ERRORS.
 13340
 13341     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 13342
 13343     IF EMI-FATAL-CTR GREATER THAN ZERO
 13344         GO TO 4000-FATAL-ERRORS.
 13345
 13346     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 13347     MOVE AL-UANOF               TO CERTA.
 13348     MOVE ER-0000 TO EMI-ERROR.
 13349     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13350
 13351 4000-FATAL-ERRORS.
 13352     MOVE -1                     TO MAINTL.
 13353     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 252
* EL131.cbl
 13355 5000-BUILD-MAP.
 13356     IF PI-RETURN-CD-1 = SPACE
 13357         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 13358
 13359     MOVE SPACE                  TO PI-RETURN-CD-1.
 13360
 13361     MOVE LOW-VALUES             TO EL131AI.
 13362
 13363     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 13364     MOVE PI-CARRIER             TO CARRIER-CODE.
 13365     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 13366     MOVE PI-CERT-NO             TO CERT-NO.
 13367
 13368 5000-READ-CLAIM-MASTER.
 13369
 13370
 13371* EXEC CICS READ
 13372*         SET      (ADDRESS OF CLAIM-MASTER)
 13373*         DATASET  (CLMS-FILE-ID)
 13374*         RIDFLD   (MSTR-KEY)
 13375*    END-EXEC.
 13376*    MOVE '&"S        E          (   #00011293' TO DFHEIV0
 13377     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13379     MOVE X'2020233030303131323933' TO DFHEIV0(25:11)
 13380     CALL 'kxdfhei1' USING DFHEIV0,
 13381           CLMS-FILE-ID,
 13382           DFHEIV20,
 13383           DFHEIV99,
 13384           MSTR-KEY,
 13385           DFHEIV99,
 13386           DFHEIV99,
 13387           DFHEIV99
 13388     SET ADDRESS OF CLAIM-MASTER TO
 13389         DFHEIV20
 13390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13391
 13392
 13393     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 13394
 13395 5000-READ-DIAGNOSIS-TRAILER.
 13396
 13397
 13398* EXEC CICS HANDLE CONDITION
 13399*         NOTFND (5000-TRLR-NOT-FOUND)
 13400*    END-EXEC.
 13401*    MOVE '"$I                   ! A #00011303' TO DFHEIV0
 13402     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13404     MOVE X'4120233030303131333033' TO DFHEIV0(25:11)
 13405     CALL 'kxdfhei1' USING DFHEIV0
 13406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13407
 13408
 13409     MOVE MSTR-KEY               TO TRLR-KEY.
 13410     MOVE NINETY                 TO TRLR-SEQ-NO.
 13411
 13412
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 253
* EL131.cbl
 13413* EXEC CICS READ
 13414*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13415*         DATASET  (TRLR-FILE-ID)
 13416*         RIDFLD   (TRLR-KEY)
 13417*    END-EXEC.
 13418*    MOVE '&"S        E          (   #00011310' TO DFHEIV0
 13419     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13421     MOVE X'2020233030303131333130' TO DFHEIV0(25:11)
 13422     CALL 'kxdfhei1' USING DFHEIV0,
 13423           TRLR-FILE-ID,
 13424           DFHEIV20,
 13425           DFHEIV99,
 13426           TRLR-KEY,
 13427           DFHEIV99,
 13428           DFHEIV99,
 13429           DFHEIV99
 13430     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13431         DFHEIV20
 13432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13433
 13434
 13435     MOVE AT-INFO-LINE-1         TO DIAGO.
 13436
 13437 5000-READ-CERTIFICATE-MASTER.
 13438
 13439     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 13440     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 13441     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 13442     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 13443     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 13444     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 13445     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 13446
 13447
 13448* EXEC CICS HANDLE CONDITION
 13449*         NOTFND (5000-CERT-NOT-FOUND)
 13450*    END-EXEC.
 13451*    MOVE '"$I                   ! B #00011328' TO DFHEIV0
 13452     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13453     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13454     MOVE X'4220233030303131333238' TO DFHEIV0(25:11)
 13455     CALL 'kxdfhei1' USING DFHEIV0
 13456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13457
 13458
 13459
 13460* EXEC CICS READ
 13461*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13462*         DATASET  (CERT-FILE-ID)
 13463*         RIDFLD   (CERT-KEY)
 13464*    END-EXEC.
 13465*    MOVE '&"S        E          (   #00011332' TO DFHEIV0
 13466     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13468     MOVE X'2020233030303131333332' TO DFHEIV0(25:11)
 13469     CALL 'kxdfhei1' USING DFHEIV0,
 13470           CERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 254
* EL131.cbl
 13471           DFHEIV20,
 13472           DFHEIV99,
 13473           CERT-KEY,
 13474           DFHEIV99,
 13475           DFHEIV99,
 13476           DFHEIV99
 13477     SET ADDRESS OF CERTIFICATE-MASTER TO
 13478         DFHEIV20
 13479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13480
 13481
 13482     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 13483     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 13484
 13485     GO TO 5000-EXIT.
 13486
 13487 5000-TRLR-NOT-FOUND.
 13488     MOVE ER-7687                TO EMI-ERROR.
 13489     MOVE -1                     TO DIAGL.
 13490     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13491     GO TO 5000-EXIT.
 13492
 13493 5000-CERT-NOT-FOUND.
 13494     MOVE ER-0206                TO EMI-ERROR.
 13495     MOVE -1                     TO CERTL.
 13496     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13497
 13498 5000-EXIT.
 13499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 255
* EL131.cbl
 13501 5010-RESET-PI-AREA.
 13502     IF CERTI GREATER THAN LOW-VALUES
 13503         MOVE CERTI              TO PI-CERT-PRIME.
 13504
 13505     IF SUFXI GREATER THAN LOW-VALUES
 13506         MOVE SUFXI              TO PI-CERT-SFX.
 13507
 13508     IF CERTEFFI GREATER THAN LOW-VALUES
 13509         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 13510
 13511     IF CERTACTI GREATER THAN LOW-VALUES
 13512         MOVE CERTACTI           TO PI-ACCOUNT.
 13513
 13514     IF CERTSTI GREATER THAN LOW-VALUES
 13515         MOVE CERTSTI            TO PI-STATE.
 13516
 13517     IF CERTCARI GREATER THAN LOW-VALUES
 13518         MOVE CERTCARI           TO PI-CARRIER.
 13519
 13520     IF CERTGRPI GREATER THAN LOW-VALUES
 13521         MOVE CERTGRPI           TO PI-GROUPING.
 13522
 13523 5010-EXIT.
 13524     EXIT.
 13525
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 256
* EL131.cbl
 13527 5020-MOVE-MSTR.
 13528
 13529     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 13530     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 13531     MOVE WS-CLAIM-SEQU          TO SEQUO.
 13532     MOVE AL-SABON               TO SEQUA.
 13533     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 13534     MOVE CL-CLAIM-TYPE          TO TYPEO
 13535                                    pi-claim-type
 13536
 13537     IF CL-TOTAL-PAID-AMT  = +0 AND
 13538        CL-LAST-PMT-AMT    = +0 AND
 13539        CL-NO-OF-PMTS-MADE = +0
 13540          MOVE AL-UANON          TO TYPEA.
 13541
 13542     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13543     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13544     MOVE CL-CERT-PRIME          TO CERTO.
 13545     MOVE CL-CERT-SFX            TO SUFXO.
 13546     MOVE CL-CERT-CARRIER        TO CARRO.
 13547
 13548     IF CL-CLAIM-STATUS = 'C'
 13549         MOVE 'CLOSED'           TO STATUSO
 13550     ELSE
 13551         MOVE 'OPEN  '           TO STATUSO.
 13552
 13553     move cl-accident-claim-sw   to accswo
 13554     MOVE CL-PROCESSOR-ID        TO PROCO.
 13555
 13556     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 13557     MOVE CL-CCN                 TO CCNOO.
 13558
 13559     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 13560     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 13561     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 13562     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13563
 13564     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 13565         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13566         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13567         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13568         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 13569     ELSE
 13570         MOVE SPACES             TO BIRTHO.
 13571
 13572     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 13573        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 13574         NEXT SENTENCE
 13575       ELSE
 13576         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 13577
 13578     IF PI-COMPANY-ID = 'DMD'
 13579       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 13580          IF SOCIALO = SPACES OR LOW-VALUES
 13581            MOVE ER-0885         TO EMI-ERROR
 13582            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13583
 13584     MOVE CL-INSURED-OCC-CD      TO OCCO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 257
* EL131.cbl
 13585     MOVE CL-CAUSE-CD            TO CAUSEO.
 13586
 13587     IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 13588         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13589         MOVE SPACES                 TO DC-OPTION-CODE
 13590         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13591         MOVE DC-GREG-DATE-1-EDIT TO ENDO
 13592     ELSE
 13593         MOVE SPACES             TO ENDO.
 13594
 13595     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 13596        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13597        MOVE SPACES             TO DC-OPTION-CODE
 13598        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13599        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13600        IF PI-USES-PAID-TO
 13601           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13602           MOVE '6'                TO DC-OPTION-CODE
 13603           MOVE +1                 TO DC-ELAPSED-DAYS
 13604           MOVE +0                 TO DC-ELAPSED-MONTHS
 13605           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13606           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13607        ELSE
 13608           NEXT SENTENCE
 13609     ELSE
 13610        MOVE SPACES             TO PDTHRUO.
 13611
 13612     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 13613     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 13614     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 13615     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 13616
 13617     IF MODIFY-CAP
 13618        MOVE AL-UNNOF            TO PDAMTA
 13619                                    NODAYSA
 13620                                    NOPMTSA
 13621        MOVE AL-UANOF            TO PDTHRUA.
 13622
 13623     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 13624         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13625         MOVE SPACES             TO DC-OPTION-CODE
 13626         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13627         MOVE DC-GREG-DATE-1-EDIT TO INCO
 13628     ELSE
 13629         MOVE SPACES             TO INCO.
 13630
 13631     IF CL-NO-OF-PMTS-MADE = ZEROS
 13632        MOVE AL-UANOF            TO INCA.
 13633
 13634     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 13635
 13636     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 13637         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 13638         MOVE SPACES             TO DC-OPTION-CODE
 13639         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13640         MOVE DC-GREG-DATE-1-EDIT TO REPO
 13641     ELSE
 13642         MOVE SPACES             TO REPO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 258
* EL131.cbl
 13643
 13644     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 13645         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 13646         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13647         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13648         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 13649     ELSE
 13650         MOVE SPACES             TO ESTO.
 13651
 13652     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 13653         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 13654         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13655         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13656         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 13657     ELSE
 13658         MOVE SPACES             TO MNTDTO.
 13659
 13660
 13661     IF CL-LAST-MAINT-TYPE = SPACE
 13662         MOVE 'SET-UP'           TO MNTTYPEO
 13663     ELSE
 13664     IF CL-LAST-MAINT-TYPE = '1'
 13665         MOVE 'PAYMNT'           TO MNTTYPEO
 13666     ELSE
 13667     IF CL-LAST-MAINT-TYPE = '2'
 13668         MOVE 'LETTER'           TO MNTTYPEO
 13669     ELSE
 13670     IF CL-LAST-MAINT-TYPE = '3'
 13671         MOVE 'UPDATE'           TO MNTTYPEO
 13672     ELSE
 13673     IF CL-LAST-MAINT-TYPE = '4'
 13674         MOVE 'RESTOR'           TO MNTTYPEO
 13675     ELSE
 13676     IF CL-LAST-MAINT-TYPE = '5'
 13677         MOVE 'INC DT'           TO MNTTYPEO
 13678     ELSE
 13679     IF CL-LAST-MAINT-TYPE = '6'
 13680         MOVE ' CONV'            TO MNTTYPEO
 13681     ELSE
 13682     IF CL-LAST-MAINT-TYPE = 'C'
 13683         MOVE 'CHGBEN'           TO MNTTYPEO
 13684     ELSE
 13685     IF CL-LAST-MAINT-TYPE = 'E'
 13686         MOVE 'ERRCOR'           TO MNTTYPEO
 13687     ELSE
 13688         MOVE SPACES             TO MNTTYPEO.
 13689
 13690     MOVE CL-BENEFICIARY         TO BENEO.
 13691     MOVE CL-FILE-LOCATION       TO FILETOO.
 13692     IF CL-CRITICAL-PERIOD NOT NUMERIC
 13693        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 13694     END-IF
 13695     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 13696     MOVE CL-CRIT-PER-RECURRENT
 13697                                 TO CRITPTO
 13698     IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 13699        MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 13700     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 259
* EL131.cbl
 13701     MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 13702     MOVE CL-PRIORITY-CD         TO PRICDO.
 13703     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 13704     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 13705     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 13706     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 13707
 13708 5020-EXIT.
 13709     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 260
* EL131.cbl
 13711 5030-MOVE-CERT.
 13712
 13713     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 13714         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 13715         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13716         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13717         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 13718       ELSE
 13719         MOVE SPACES             TO CERTEFFO
 13720         MOVE ZERO               TO HOLD-DATE.
 13721
 13722     MOVE CM-ACCOUNT             TO CERTACTO.
 13723     MOVE CM-STATE               TO CERTSTO PI-STATE.
 13724     MOVE CM-GROUPING            TO CERTGRPO.
 13725     MOVE CM-CARRIER             TO CERTCARO.
 13726     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 13727     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 13728     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 13729     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 13730     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 13731     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 13732     MOVE CM-JT-INITIAL          TO JNTINITO.
 13733     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 13734
 13735*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 13736     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13737     MOVE '3'                    TO CNTL-REC-TYPE.
 13738     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 13739     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 13740     MOVE ZERO                   TO CNTL-SEQ-NO.
 13741
 13742
 13743* EXEC CICS READ
 13744*         SET        (ADDRESS OF CONTROL-FILE)
 13745*         DATASET    ('ELCNTL')
 13746*         RIDFLD     (CNTL-KEY)
 13747*         RESP       (WS-RESPONSE)
 13748*    END-EXEC.
 13749     MOVE 'ELCNTL' TO DFHEIV1
 13750*    MOVE '&"S        E          (  N#00011598' TO DFHEIV0
 13751     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13752     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13753     MOVE X'204E233030303131353938' TO DFHEIV0(25:11)
 13754     CALL 'kxdfhei1' USING DFHEIV0,
 13755           DFHEIV1,
 13756           DFHEIV20,
 13757           DFHEIV99,
 13758           CNTL-KEY,
 13759           DFHEIV99,
 13760           DFHEIV99,
 13761           DFHEIV99
 13762     SET ADDRESS OF CONTROL-FILE TO
 13763         DFHEIV20
 13764     MOVE EIBRESP  TO WS-RESPONSE
 13765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13766
 13767
 13768     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 261
* EL131.cbl
 13769        MOVE ZERO                TO CP-FREE-LOOK
 13770     ELSE
 13771        MOVE CF-ST-FREE-LOOK-PERIOD
 13772                                 TO CP-FREE-LOOK.
 13773
 13774     IF CM-LF-BENEFIT-CD = '00'
 13775        GO TO 5030-MOVE-CERT-AH.
 13776
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 262
* EL131.cbl
 13778     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 13779     MOVE '5'                    TO DC-OPTION-CODE
 13780     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13781     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 13782     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 13783     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 13784     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 13785     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 13786     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13787     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 13788     MOVE '4'                    TO CP-REM-TERM-METHOD
 13789     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 13790     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13791     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 13792
 13793     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 13794     IF CM-LF-PREMIUM-RATE NUMERIC
 13795         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 13796     ELSE
 13797         MOVE ZEROS              TO LCVRATEO.
 13798
 13799     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 13800         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 13801
 13802     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 13803
 13804     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 13805
 13806     IF CM-LF-CURRENT-STATUS = '8'
 13807        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 13808            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 13809            MOVE ' '             TO DC-OPTION-CODE
 13810            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13811            IF NOT DATE-CONVERSION-ERROR
 13812                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 13813
 13814     IF CM-LF-CURRENT-STATUS = '7'
 13815        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13816            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 13817            MOVE ' '             TO DC-OPTION-CODE
 13818            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13819            IF NOT DATE-CONVERSION-ERROR
 13820                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 13821
 13822     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 13823         MOVE ' '                TO DC-OPTION-CODE
 13824         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 13825         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13826         IF NOT DATE-CONVERSION-ERROR
 13827             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 13828             MOVE HOLD-MONTH     TO WORK-MONTH
 13829             MOVE HOLD-YEAR      TO WORK-YEAR
 13830             MOVE WORK-DATE-MY   TO LCVEXITO.
 13831
 13832     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 13833        IF CP-REMAINING-TERM-3 = ZEROS
 13834           MOVE 'EXPIRED'        TO LCVSTATO
 13835        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 263
* EL131.cbl
 13836           MOVE 'ACTIVE'         TO LCVSTATO.
 13837
 13838     IF CM-LF-CURRENT-STATUS = '2'
 13839        MOVE 'PEND   '           TO LCVSTATO.
 13840     IF CM-LF-CURRENT-STATUS = '3'
 13841        MOVE 'RESTORE'           TO LCVSTATO.
 13842     IF CM-LF-CURRENT-STATUS = '5'
 13843        MOVE 'REISSUE'           TO LCVSTATO.
 13844     IF CM-LF-CURRENT-STATUS = '6'
 13845        MOVE 'LMP DIS'           TO LCVSTATO.
 13846     IF CM-LF-CURRENT-STATUS = '7'
 13847        MOVE 'DEATH  '           TO LCVSTATO.
 13848     IF CM-LF-CURRENT-STATUS = '8'
 13849        MOVE 'CANCEL '           TO LCVSTATO.
 13850     IF CM-LF-CURRENT-STATUS = '9'
 13851        MOVE 'RE-ONLY'           TO LCVSTATO.
 13852     IF CM-LF-CURRENT-STATUS = 'V'
 13853        MOVE 'VOID   '           TO LCVSTATO.
 13854     IF CM-LF-CURRENT-STATUS = 'D'
 13855        MOVE 'DECLINE'           TO LCVSTATO.
 13856
 13857     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 13858     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 13859     MOVE '4'                    TO BEN-REC-TYPE.
 13860     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 13861     MOVE ZERO                   TO BEN-SEQ-NO.
 13862
 13863
 13864* EXEC CICS READ GTEQ
 13865*         DATASET  (CNTL-FILE-ID)
 13866*         RIDFLD   (BENEFIT-KEY)
 13867*         SET      (ADDRESS OF CONTROL-FILE)
 13868*    END-EXEC.
 13869*    MOVE '&"S        G          (   #00011700' TO DFHEIV0
 13870     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13871     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13872     MOVE X'2020233030303131373030' TO DFHEIV0(25:11)
 13873     CALL 'kxdfhei1' USING DFHEIV0,
 13874           CNTL-FILE-ID,
 13875           DFHEIV20,
 13876           DFHEIV99,
 13877           BENEFIT-KEY,
 13878           DFHEIV99,
 13879           DFHEIV99,
 13880           DFHEIV99
 13881     SET ADDRESS OF CONTROL-FILE TO
 13882         DFHEIV20
 13883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13884
 13885
 13886     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 13887        CF-RECORD-TYPE NOT = '4'
 13888         MOVE ER-0240            TO EMI-ERROR
 13889         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13890         GO TO 5030-MOVE-CERT-FINISH.
 13891
 13892     MOVE ZERO                   TO COUNT-2.
 13893     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 264
* EL131.cbl
 13894
 13895     IF SCREEN-ERROR
 13896         MOVE ER-0282            TO EMI-ERROR
 13897         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13898        ELSE
 13899         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 13900
 13901 5030-MOVE-CERT-AH.
 13902
 13903     IF CM-LF-BENEFIT-CD = '00'
 13904         IF CM-AH-BENEFIT-CD = '00'
 13905             GO TO 5030-MOVE-CERT-FINISH.
 13906
 13907     IF CM-AH-BENEFIT-CD = '00'
 13908        MOVE SPACES             TO ACVKINDO
 13909        COMPUTE PI-PAYMENT-AMT =
 13910                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 13911        GO TO 5030-MOVE-CERT-FINISH.
 13912
 13913     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13914     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 13915     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 13916     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 13917     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 13918     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13919     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13920     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 13921
 13922**DMD **********************************************
 13923     IF PI-COMPANY-ID = 'DMD'
 13924         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 13925                                   CM-PMT-EXTENSION-DAYS
 13926         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 13927                                      CL-NO-OF-DAYS-PAID
 13928         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 13929             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 13930         MOVE WS-REM-MOS         TO ACVRTRMO
 13931                                    CP-REMAINING-TERM-3
 13932*        MOVE WS-REM-DAYS        TO DAYSPO
 13933         GO TO 5030-SKIP-RTRM.
 13934**DMD **********************************************
 13935
 13936     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13937     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13938     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 13939     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13940
 13941 5030-SKIP-RTRM.
 13942     IF CM-AH-PREMIUM-RATE NUMERIC
 13943         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13944     ELSE
 13945         MOVE ZEROS              TO ACVRATEO.
 13946
 13947     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 13948     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 13949
 13950     IF CM-AH-CURRENT-STATUS = '8'
 13951        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 265
* EL131.cbl
 13952            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13953            MOVE ' '             TO DC-OPTION-CODE
 13954            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13955            IF NOT DATE-CONVERSION-ERROR
 13956                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13957
 13958     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13959        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13960            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 13961            MOVE ' '             TO DC-OPTION-CODE
 13962            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13963            IF NOT DATE-CONVERSION-ERROR
 13964                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13965
 13966     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13967        IF CP-REMAINING-TERM-3 = ZEROS
 13968           MOVE 'EXPIRED'        TO ACVSTATO
 13969        ELSE
 13970           MOVE 'ACTIVE'         TO ACVSTATO.
 13971
 13972     IF CM-AH-CURRENT-STATUS = '2'
 13973        MOVE 'PEND   '           TO ACVSTATO.
 13974     IF CM-AH-CURRENT-STATUS = '3'
 13975        MOVE 'RESTORE'           TO ACVSTATO.
 13976     IF CM-AH-CURRENT-STATUS = '5'
 13977        MOVE 'REISSUE'           TO ACVSTATO.
 13978     IF CM-AH-CURRENT-STATUS = '6'
 13979        MOVE 'LMP DIS'           TO ACVSTATO.
 13980     IF CM-AH-CURRENT-STATUS = '7'
 13981        MOVE 'DEATH  '           TO ACVSTATO.
 13982     IF CM-AH-CURRENT-STATUS = '8'
 13983        MOVE 'CANCEL '           TO ACVSTATO.
 13984     IF CM-AH-CURRENT-STATUS = '9'
 13985        MOVE 'RE-ONLY'           TO ACVSTATO.
 13986     IF CM-AH-CURRENT-STATUS = 'V'
 13987        MOVE 'VOID   '           TO ACVSTATO.
 13988     IF CM-AH-CURRENT-STATUS = '9'
 13989        MOVE 'DECLINE'           TO ACVSTATO.
 13990
 13991     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13992         MOVE ' '                TO DC-OPTION-CODE
 13993         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13994         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13995         IF NOT DATE-CONVERSION-ERROR
 13996             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 13997             MOVE HOLD-MONTH     TO WORK-MONTH
 13998             MOVE HOLD-YEAR      TO WORK-YEAR
 13999             MOVE WORK-DATE-MY   TO ACVEXITO.
 14000
 14001     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14002
 14003     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14004     MOVE '5'                    TO BEN-REC-TYPE.
 14005     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 14006     MOVE ZERO                   TO BEN-SEQ-NO.
 14007
 14008
 14009* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 266
* EL131.cbl
 14010*         DATASET  (CNTL-FILE-ID)
 14011*         RIDFLD   (BENEFIT-KEY)
 14012*         SET      (ADDRESS OF CONTROL-FILE)
 14013*    END-EXEC.
 14014*    MOVE '&"S        G          (   #00011828' TO DFHEIV0
 14015     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14016     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14017     MOVE X'2020233030303131383238' TO DFHEIV0(25:11)
 14018     CALL 'kxdfhei1' USING DFHEIV0,
 14019           CNTL-FILE-ID,
 14020           DFHEIV20,
 14021           DFHEIV99,
 14022           BENEFIT-KEY,
 14023           DFHEIV99,
 14024           DFHEIV99,
 14025           DFHEIV99
 14026     SET ADDRESS OF CONTROL-FILE TO
 14027         DFHEIV20
 14028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14029
 14030
 14031     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14032        CF-RECORD-TYPE NOT = '5'
 14033         MOVE ER-0250            TO EMI-ERROR
 14034         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14035         GO TO 5030-MOVE-CERT-FINISH.
 14036
 14037     MOVE ZERO                   TO COUNT-2.
 14038     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 14039
 14040     IF SCREEN-ERROR
 14041         MOVE ER-0283            TO EMI-ERROR
 14042         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14043       ELSE
 14044         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 14045
 14046 5030-MOVE-CERT-FINISH.
 14047
 14048     MOVE CM-LOAN-APR            TO APRO.
 14049     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14050     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14051     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 14052     MOVE CM-LOAN-NUMBER         TO LOANNOO
 14053     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 14054     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 14055
 14056     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 14057         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14058         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14059         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14060         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 14061     ELSE
 14062         MOVE SPACES               TO ADDONDTO.
 14063
 14064     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 14065
 14066 5030-EXIT.
 14067     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 267
* EL131.cbl
 14069 5040-FIND-BENEFIT.
 14070     ADD 1                       TO COUNT-2.
 14071     IF COUNT-2 GREATER THAN 8
 14072         GO TO 5050-BENEFIT-NOTFND.
 14073
 14074     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 14075         GO TO 5060-EXIT.
 14076
 14077     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 14078         GO TO 5050-BENEFIT-NOTFND.
 14079
 14080     GO TO 5040-FIND-BENEFIT.
 14081
 14082 5050-BENEFIT-NOTFND.
 14083     MOVE 'X'                    TO ERROR-SWITCH.
 14084
 14085 5060-EXIT.
 14086     EXIT.
 14087
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 268
* EL131.cbl
 14089 6000-CALCULATE-CERT-TERM.
 14090
 14091     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 14092         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 14093     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 14094         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 14095     IF CM-LOAN-APR NOT NUMERIC
 14096         MOVE ZEROS              TO CM-LOAN-APR.
 14097
 14098*    IF WS-CALC-METHOD  = 'G'
 14099         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 14100*     ELSE
 14101*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 14102
 14103     IF N GREATER 120
 14104         MOVE 120                TO N.
 14105
 14106     MOVE '6'                    TO DC-OPTION-CODE.
 14107     MOVE N                      TO DC-ELAPSED-MONTHS.
 14108     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14109     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 14110
 14111     IF CM-LF-BENEFIT-CD NOT = ZERO
 14112         MOVE N                  TO CM-LF-ORIG-TERM
 14113         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 14114         IF NO-CONVERSION-ERROR
 14115             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 14116
 14117     IF CM-AH-BENEFIT-CD NOT = ZERO
 14118         MOVE N                  TO CM-AH-ORIG-TERM
 14119         IF NO-CONVERSION-ERROR
 14120             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 14121
 14122 6000-EXIT.
 14123      EXIT.
 14124
 14125 6100-CALC-GROSS-TERM.
 14126     MOVE CM-LOAN-BALANCE         TO L.
 14127     MOVE PI-PAYMENT-AMT          TO M.
 14128
 14129     COMPUTE N = L / M.
 14130     IF N LESS 1
 14131         MOVE 1  TO N.
 14132
 14133     IF CM-LF-BENEFIT-CD NOT = ZERO
 14134         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 14135     ELSE
 14136         MOVE ZEROS               TO WS-LF-RATE.
 14137
 14138     IF CM-AH-BENEFIT-CD NOT = ZERO
 14139         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 14140     ELSE
 14141         MOVE ZEROS               TO WS-AH-RATE.
 14142
 14143     COMPUTE I = CM-LOAN-APR / +1200.
 14144
 14145 6105-LOOP.
 14146     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 269
* EL131.cbl
 14147         GO TO 6200-EXIT.
 14148     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 14149     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 14150         ADD 1 TO N
 14151         GO TO 6105-LOOP.
 14152
 14153 6200-EXIT.
 14154      EXIT.
 14155
 14156 6210-CALC-LEFT-RIGHTONE.
 14157      MOVE L         TO LEFT-TOT-1.
 14158      SUBTRACT 1 FROM N.
 14159      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14160      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 14161      ADD 1 TO N.
 14162 6211-CALC-TERM1.
 14163      MOVE N         TO TERM1.
 14164      MULTIPLY M BY TERM1.
 14165 6212-LOOP.
 14166      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 14167      ADD 1 TO A-N.
 14168      MULTIPLY A-N BY TERM1.
 14169      SUBTRACT 1 FROM A-N.
 14170      ADD TERM1 TO LEFT-TOT-1.
 14171 6213-CALC-TERM2.
 14172      MOVE M         TO TERM2.
 14173      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 14174      MULTIPLY IA-N BY TERM2.
 14175      SUBTRACT TERM2 FROM LEFT-TOT-1.
 14176 6215-CALC-RIGHTONE.
 14177      MOVE M         TO RIGHT-TOT-1.
 14178      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14179      MULTIPLY A-N BY RIGHT-TOT-1.
 14180 6220-EXIT.
 14181      EXIT.
 14182
 14183 6300-CALC-A-N.
 14184     IF N LESS 1
 14185         MOVE 0     TO A-N
 14186         GO TO 6300-EXIT.
 14187     IF I = 0
 14188         MOVE .00001 TO I.
 14189     ADD 1 TO I.
 14190     DIVIDE I INTO 1 GIVING V.
 14191     SUBTRACT 1 FROM I.
 14192     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14193     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 14194     DIVIDE I INTO TERM3 GIVING A-N.
 14195 6300-EXIT.
 14196      EXIT.
 14197
 14198 6350-CALC-IA-N.
 14199     IF N LESS 1
 14200         MOVE 0      TO IA-N
 14201         GO TO 6400-EXIT.
 14202     ADD 1 TO N.
 14203     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14204     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 270
* EL131.cbl
 14205     MULTIPLY N BY V-EX-N GIVING TERM3.
 14206     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 14207     SUBTRACT V FROM 1 GIVING TERM4.
 14208     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 14209 6400-EXIT.
 14210      EXIT.
 14211
 14212 6450-CALC-V-EX-N.
 14213     IF N LESS 1
 14214         MOVE 1    TO V-EX-N
 14215         GO TO 6490-EXIT.
 14216     MOVE N        TO NV-STORE.
 14217     IF V-EX-ONETIME = 1  OR
 14218        V NOT = V-EXPONENT (1)
 14219          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 14220 6460-LOOP.
 14221     IF N GREATER 248
 14222         MOVE 248 TO N.
 14223     IF N = 1
 14224         MOVE V               TO V-EX-N
 14225      ELSE
 14226         MOVE V-EXPONENT (N)  TO V-EX-N.
 14227     GO TO 6490-EXIT.
 14228
 14229 6470-BUILD-V-EX-TABLE.
 14230     MOVE 2      TO N.
 14231     MOVE V      TO V-EXPONENT (1)
 14232                    V-EX-N.
 14233 6471-LOOP.
 14234     MULTIPLY V BY V-EX-N.
 14235     MOVE V-EX-N   TO V-EXPONENT (N).
 14236     ADD 1 TO N.
 14237     IF N LESS 248
 14238         GO TO 6471-LOOP.
 14239     MOVE NV-STORE     TO N.
 14240     MOVE 0            TO V-EX-ONETIME.
 14241 6480-EXIT.
 14242      EXIT.
 14243
 14244 6490-EXIT.
 14245      EXIT.
 14246
 14247 6500-CALC-NET-TERM.
 14248     MOVE CM-LOAN-BALANCE         TO L.
 14249     MOVE PI-PAYMENT-AMT          TO M.
 14250
 14251     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 14252     IF WS-REMAIN GREATER ZERO
 14253         ADD 1 TO N.
 14254     IF N = 0
 14255         MOVE 1 TO N.
 14256
 14257 6700-EXIT.
 14258      EXIT.
 14259
 14260 6999-CALC-TERM-EXIT.
 14261     EXIT.
 14262
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 271
* EL131.cbl
 14264 7000-RESET-ATTRIBUTE.
 14265
 14266     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 14267                                    CERTSTA   CERTCARA
 14268                                    CERTGRPA.
 14269     MOVE -1                     TO CERTCARL.
 14270
 14271 7000-EXIT.
 14272     EXIT.
 14273
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 272
* EL131.cbl
 14275 7600-BROWSE-CLAIM.
 14276
 14277
 14278* EXEC CICS READ
 14279*        DATASET(CLMS-FILE-ID)
 14280*        SET    (ADDRESS OF CLAIM-MASTER)
 14281*        RIDFLD (MSTR-KEY)
 14282*        GENERIC
 14283*        EQUAL
 14284*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14285*    END-EXEC.
 14286*    MOVE '&"S  KG    E          (   #00012080' TO DFHEIV0
 14287     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14288     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14289     MOVE X'2020233030303132303830' TO DFHEIV0(25:11)
 14290     CALL 'kxdfhei1' USING DFHEIV0,
 14291           CLMS-FILE-ID,
 14292           DFHEIV20,
 14293           DFHEIV99,
 14294           MSTR-KEY,
 14295           ELMSTR-GENERIC-LENGTH,
 14296           DFHEIV99,
 14297           DFHEIV99
 14298     SET ADDRESS OF CLAIM-MASTER TO
 14299         DFHEIV20
 14300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14301
 14302
 14303     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 14304
 14305     if cl-assoc-cert-total = 0
 14306        move 1 to cl-assoc-cert-total
 14307     end-if
 14308     IF CL-ASSOC-CERT-SEQU = 0
 14309        MOVE 1 TO CL-ASSOC-CERT-SEQU
 14310     END-IF
 14311
 14312     IF CL-ASSOC-CERT-TOTAL = 1
 14313         MOVE AL-SADOF           TO BCERT1A
 14314                                    BSUFX1A
 14315                                    BCERT2A
 14316                                    BSUFX2A
 14317                                    BCERT3A
 14318                                    BSUFX3A
 14319                                    BCERT4A
 14320                                    BSUFX4A
 14321                                    BCERT5A
 14322                                    BSUFX5A
 14323                                    PCERTNOA
 14324                                    PSUFXA
 14325                                    LABEL1A
 14326                                    LABEL2A
 14327         GO TO 7699-EXIT.
 14328
 14329 7610-BROWSE-CLAIM-LOOP.
 14330
 14331     MOVE LOW-VALUES             TO BCERT1O
 14332                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 273
* EL131.cbl
 14333                                    BCERT2O
 14334                                    BSUFX2O
 14335                                    BCERT3O
 14336                                    BSUFX3O
 14337                                    BCERT4O
 14338                                    BSUFX4O
 14339                                    BCERT5O
 14340                                    BSUFX5O.
 14341
 14342
 14343* EXEC CICS HANDLE CONDITION
 14344*        ENDFILE  (7630-END-BROWSE)
 14345*    END-EXEC.
 14346*    MOVE '"$''                   ! C #00012128' TO DFHEIV0
 14347     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14348     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14349     MOVE X'4320233030303132313238' TO DFHEIV0(25:11)
 14350     CALL 'kxdfhei1' USING DFHEIV0
 14351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14352
 14353
 14354
 14355* EXEC CICS STARTBR
 14356*        DATASET    (CLMS-FILE-ID)
 14357*        RIDFLD     (MSTR-KEY)
 14358*    END-EXEC.
 14359     MOVE 0
 14360       TO DFHEIV11
 14361*    MOVE '&,         G          &   #00012132' TO DFHEIV0
 14362     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14363     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14364     MOVE X'2020233030303132313332' TO DFHEIV0(25:11)
 14365     CALL 'kxdfhei1' USING DFHEIV0,
 14366           CLMS-FILE-ID,
 14367           MSTR-KEY,
 14368           DFHEIV99,
 14369           DFHEIV11,
 14370           DFHEIV99
 14371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14372
 14373
 14374     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14375
 14376 7620-READ-CLAIM-LOOP.
 14377
 14378
 14379* EXEC CICS READNEXT
 14380*        DATASET   (CLMS-FILE-ID)
 14381*        SET       (ADDRESS OF CLAIM-MASTER)
 14382*        RIDFLD    (MSTR-KEY)
 14383*    END-EXEC.
 14384     MOVE 0
 14385       TO DFHEIV11
 14386*    MOVE '&.S                   )   #00012141' TO DFHEIV0
 14387     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14388     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14389     MOVE X'2020233030303132313431' TO DFHEIV0(25:11)
 14390     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 274
* EL131.cbl
 14391           CLMS-FILE-ID,
 14392           DFHEIV20,
 14393           DFHEIV99,
 14394           MSTR-KEY,
 14395           DFHEIV99,
 14396           DFHEIV11,
 14397           DFHEIV99,
 14398           DFHEIV99
 14399     SET ADDRESS OF CLAIM-MASTER TO
 14400         DFHEIV20
 14401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14402
 14403
 14404     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 14405        CL-CARRIER     NOT = CARRI           OR
 14406        CL-CLAIM-NO    NOT = CLAIMI
 14407        GO TO 7630-END-BROWSE.
 14408
 14409     IF WS-ASSOCIATED-CERTS = 1
 14410         MOVE CL-CERT-PRIME      TO BCERT1O
 14411         MOVE CL-CERT-SFX        TO BSUFX1O.
 14412
 14413     IF WS-ASSOCIATED-CERTS = 2
 14414         MOVE CL-CERT-PRIME      TO BCERT2O
 14415         MOVE CL-CERT-SFX        TO BSUFX2O.
 14416
 14417     IF WS-ASSOCIATED-CERTS = 3
 14418         MOVE CL-CERT-PRIME      TO BCERT3O
 14419         MOVE CL-CERT-SFX        TO BSUFX3O.
 14420
 14421     IF WS-ASSOCIATED-CERTS = 4
 14422         MOVE CL-CERT-PRIME      TO BCERT4O
 14423         MOVE CL-CERT-SFX        TO BSUFX4O.
 14424
 14425     IF WS-ASSOCIATED-CERTS = 5
 14426         MOVE CL-CERT-PRIME      TO BCERT5O
 14427         MOVE CL-CERT-SFX        TO BSUFX5O
 14428     ELSE
 14429         ADD +1                  TO WS-ASSOCIATED-CERTS
 14430         GO TO 7620-READ-CLAIM-LOOP.
 14431
 14432 7630-END-BROWSE.
 14433
 14434
 14435* EXEC CICS ENDBR
 14436*        DATASET   (CLMS-FILE-ID)
 14437*    END-EXEC.
 14438     MOVE 0
 14439       TO DFHEIV11
 14440*    MOVE '&2                    $   #00012177' TO DFHEIV0
 14441     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14442     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14443     MOVE X'2020233030303132313737' TO DFHEIV0(25:11)
 14444     CALL 'kxdfhei1' USING DFHEIV0,
 14445           CLMS-FILE-ID,
 14446           DFHEIV11,
 14447           DFHEIV99
 14448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 275
* EL131.cbl
 14449
 14450
 14451 7640-HIGHLIGHT-CERT-DISPLAYED.
 14452
 14453     MOVE AL-SANON               TO BCERT1A
 14454                                    BSUFX1A
 14455                                    BCERT2A
 14456                                    BSUFX2A
 14457                                    BCERT3A
 14458                                    BSUFX3A
 14459                                    BCERT4A
 14460                                    BSUFX4A
 14461                                    BCERT5A
 14462                                    BSUFX5A.
 14463
 14464     IF BCERT1O = CERTI AND
 14465        BSUFX1O = SUFXI
 14466            MOVE AL-SABON        TO BCERT1A
 14467                                    BSUFX1A.
 14468
 14469     IF BCERT2O = CERTI AND
 14470        BSUFX2O = SUFXI
 14471            MOVE AL-SABON        TO BCERT2A
 14472                                    BSUFX2A.
 14473
 14474     IF BCERT3O = CERTI AND
 14475        BSUFX3O = SUFXI
 14476            MOVE AL-SABON        TO BCERT3A
 14477                                    BSUFX3A.
 14478
 14479     IF BCERT4O = CERTI AND
 14480        BSUFX4O = SUFXI
 14481            MOVE AL-SABON        TO BCERT4A
 14482                                    BSUFX4A.
 14483
 14484     IF BCERT5O = CERTI AND
 14485        BSUFX5O = SUFXI
 14486            MOVE AL-SABON        TO BCERT5A
 14487                                    BSUFX5A.
 14488
 14489 7699-EXIT.
 14490     EXIT.
 14491
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 276
* EL131.cbl
 14493 7700-CHECK-SEQUENCE.
 14494
 14495
 14496* EXEC CICS HANDLE CONDITION
 14497*        ENDFILE  (7799-EXIT)
 14498*        NOTFND   (7799-EXIT)
 14499*    END-EXEC.
 14500*    MOVE '"$''I                  ! D #00012225' TO DFHEIV0
 14501     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14502     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14503     MOVE X'4420233030303132323235' TO DFHEIV0(25:11)
 14504     CALL 'kxdfhei1' USING DFHEIV0
 14505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14506
 14507
 14508
 14509* EXEC CICS READ
 14510*        DATASET(CLMS-FILE-ID)
 14511*        SET    (ADDRESS OF CLAIM-MASTER)
 14512*        RIDFLD (MSTR-KEY)
 14513*        GENERIC
 14514*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14515*    END-EXEC.
 14516*    MOVE '&"S  KG    E          (   #00012230' TO DFHEIV0
 14517     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14518     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14519     MOVE X'2020233030303132323330' TO DFHEIV0(25:11)
 14520     CALL 'kxdfhei1' USING DFHEIV0,
 14521           CLMS-FILE-ID,
 14522           DFHEIV20,
 14523           DFHEIV99,
 14524           MSTR-KEY,
 14525           ELMSTR-GENERIC-LENGTH,
 14526           DFHEIV99,
 14527           DFHEIV99
 14528     SET ADDRESS OF CLAIM-MASTER TO
 14529         DFHEIV20
 14530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14531
 14532
 14533     COMPUTE WS-ASSOC-CERT-TOTAL =
 14534             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14535
 14536     GO TO 7799-EXIT.
 14537
 14538 7710-RESEQUENCE-CLAIMS.
 14539
 14540
 14541* EXEC CICS HANDLE CONDITION
 14542*        ENDFILE  (7799-EXIT)
 14543*    END-EXEC.
 14544*    MOVE '"$''                   ! E #00012245' TO DFHEIV0
 14545     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14547     MOVE X'4520233030303132323435' TO DFHEIV0(25:11)
 14548     CALL 'kxdfhei1' USING DFHEIV0
 14549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14550
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 277
* EL131.cbl
 14551
 14552
 14553* EXEC CICS STARTBR
 14554*        DATASET(CLMS-FILE-ID)
 14555*        RIDFLD (MSTR-KEY)
 14556*    END-EXEC.
 14557     MOVE 0
 14558       TO DFHEIV11
 14559*    MOVE '&,         G          &   #00012249' TO DFHEIV0
 14560     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14561     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14562     MOVE X'2020233030303132323439' TO DFHEIV0(25:11)
 14563     CALL 'kxdfhei1' USING DFHEIV0,
 14564           CLMS-FILE-ID,
 14565           MSTR-KEY,
 14566           DFHEIV99,
 14567           DFHEIV11,
 14568           DFHEIV99
 14569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14570
 14571
 14572     COMPUTE WS-ASSOC-CERT-SEQU =
 14573             WS-ASSOC-CERT-SEQU + 1.
 14574
 14575     COMPUTE WS-READNEXT-SWITCH =
 14576             WS-READNEXT-SWITCH + 1.
 14577
 14578 7720-READ-CLAIM-LOOP.
 14579
 14580
 14581* EXEC CICS READNEXT
 14582*        DATASET(CLMS-FILE-ID)
 14583*        SET    (ADDRESS OF CLAIM-MASTER)
 14584*        RIDFLD (MSTR-KEY)
 14585*    END-EXEC.
 14586     MOVE 0
 14587       TO DFHEIV11
 14588*    MOVE '&.S                   )   #00012262' TO DFHEIV0
 14589     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14590     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14591     MOVE X'2020233030303132323632' TO DFHEIV0(25:11)
 14592     CALL 'kxdfhei1' USING DFHEIV0,
 14593           CLMS-FILE-ID,
 14594           DFHEIV20,
 14595           DFHEIV99,
 14596           MSTR-KEY,
 14597           DFHEIV99,
 14598           DFHEIV11,
 14599           DFHEIV99,
 14600           DFHEIV99
 14601     SET ADDRESS OF CLAIM-MASTER TO
 14602         DFHEIV20
 14603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14604
 14605
 14606     IF WS-READNEXT-SWITCH = 1
 14607         ADD 1                   TO WS-READNEXT-SWITCH
 14608         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 278
* EL131.cbl
 14609
 14610 7730-END-BROWSE.
 14611
 14612
 14613* EXEC CICS ENDBR
 14614*        DATASET(CLMS-FILE-ID)
 14615*    END-EXEC.
 14616     MOVE 0
 14617       TO DFHEIV11
 14618*    MOVE '&2                    $   #00012274' TO DFHEIV0
 14619     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14620     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14621     MOVE X'2020233030303132323734' TO DFHEIV0(25:11)
 14622     CALL 'kxdfhei1' USING DFHEIV0,
 14623           CLMS-FILE-ID,
 14624           DFHEIV11,
 14625           DFHEIV99
 14626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14627
 14628
 14629 7740-READ-CLAIM-UPDATE.
 14630
 14631     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 14632        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 14633        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 14634        GO TO 7799-EXIT
 14635     ELSE
 14636        MOVE ZERO                TO WS-READNEXT-SWITCH.
 14637
 14638
 14639* EXEC CICS READ
 14640*        DATASET(CLMS-FILE-ID)
 14641*        SET    (ADDRESS OF CLAIM-MASTER)
 14642*        RIDFLD (MSTR-KEY)
 14643*        UPDATE
 14644*    END-EXEC.
 14645*    MOVE '&"S        EU         (   #00012287' TO DFHEIV0
 14646     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14647     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14648     MOVE X'2020233030303132323837' TO DFHEIV0(25:11)
 14649     CALL 'kxdfhei1' USING DFHEIV0,
 14650           CLMS-FILE-ID,
 14651           DFHEIV20,
 14652           DFHEIV99,
 14653           MSTR-KEY,
 14654           DFHEIV99,
 14655           DFHEIV99,
 14656           DFHEIV99
 14657     SET ADDRESS OF CLAIM-MASTER TO
 14658         DFHEIV20
 14659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14660
 14661
 14662     if (cl-priority-cd = '8')
 14663        and (pi-processor-id not = 'PEMA' and 'JMS '
 14664             AND 'AMWA')
 14665        MOVE ER-8003             TO EMI-ERROR
 14666        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 279
* EL131.cbl
 14667                                 THRU 9900-EXIT
 14668        MOVE -1                  TO MAINTL
 14669        GO TO 8110-SEND-DATA
 14670     end-if
 14671
 14672     IF PI-COMPANY-ID = 'CID' or 'AHL'
 14673         MOVE 'Y'                TO CL-YESNOSW
 14674     END-IF.
 14675
 14676     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 14677     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 14678
 14679
 14680* EXEC CICS REWRITE
 14681*         DATASET(CLMS-FILE-ID)
 14682*         FROM   (CLAIM-MASTER)
 14683*    END-EXEC.
 14684     MOVE LENGTH OF
 14685      CLAIM-MASTER
 14686       TO DFHEIV11
 14687*    MOVE '&& L                  %   #00012311' TO DFHEIV0
 14688     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14689     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14690     MOVE X'2020233030303132333131' TO DFHEIV0(25:11)
 14691     CALL 'kxdfhei1' USING DFHEIV0,
 14692           CLMS-FILE-ID,
 14693           CLAIM-MASTER,
 14694           DFHEIV11,
 14695           DFHEIV99
 14696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14697
 14698
 14699     GO TO 7710-RESEQUENCE-CLAIMS.
 14700
 14701 7799-EXIT.
 14702     EXIT.
 14703
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 280
* EL131.cbl
 14705 7800-CHECK-AUTO-ACTIVITY.
 14706
 14707
 14708* EXEC CICS HANDLE CONDITION
 14709*        NOTFND   (7800-NOT-FOUND)
 14710*    END-EXEC.
 14711*    MOVE '"$I                   ! F #00012324' TO DFHEIV0
 14712     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14714     MOVE X'4620233030303132333234' TO DFHEIV0(25:11)
 14715     CALL 'kxdfhei1' USING DFHEIV0
 14716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14717
 14718
 14719     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 14720     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14721     MOVE SPACES                     TO  CNTL-PROC-ID.
 14722     MOVE +0                         TO  CNTL-SEQ-NO.
 14723
 14724
 14725* EXEC CICS READ
 14726*        DATASET   (CNTL-FILE-ID)
 14727*        RIDFLD    (CNTL-KEY)
 14728*        SET       (ADDRESS OF CONTROL-FILE)
 14729*    END-EXEC.
 14730*    MOVE '&"S        E          (   #00012333' TO DFHEIV0
 14731     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14732     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14733     MOVE X'2020233030303132333333' TO DFHEIV0(25:11)
 14734     CALL 'kxdfhei1' USING DFHEIV0,
 14735           CNTL-FILE-ID,
 14736           DFHEIV20,
 14737           DFHEIV99,
 14738           CNTL-KEY,
 14739           DFHEIV99,
 14740           DFHEIV99,
 14741           DFHEIV99
 14742     SET ADDRESS OF CONTROL-FILE TO
 14743         DFHEIV20
 14744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14745
 14746
 14747     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 14748         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 14749
 14750     IF CL-ACTIVITY-CODE NOT = ZEROS
 14751         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 14752         IF MISC-SUB IS GREATER THAN +9
 14753             SUBTRACT +9 FROM MISC-SUB
 14754             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 14755         ELSE
 14756             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 14757     ELSE
 14758         MOVE 'Y'                              TO  WS-RESET-SW.
 14759
 14760     IF STATUSI = 'C' OR 'CLOSED'
 14761         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 14762             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 281
* EL131.cbl
 14763                                         PI-LETTER-SW
 14764             GO TO 7800-EXIT.
 14765
 14766     IF STATUSI = 'C' OR 'CLOSED'
 14767         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 14768             MOVE 'N'                TO  PI-LETTER-SW
 14769         ELSE
 14770             MOVE 'Y'                TO  PI-LETTER-SW.
 14771
 14772     IF STATUSI = 'O' OR 'OPEN'
 14773         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 14774             MOVE 'N'                TO  PI-REC-FOUND-SW
 14775                                         PI-LETTER-SW
 14776             GO TO 7800-EXIT.
 14777
 14778     IF STATUSI = 'O' OR 'OPEN'
 14779         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 14780             MOVE 'N'                TO  PI-LETTER-SW
 14781         ELSE
 14782             MOVE 'Y'                TO  PI-LETTER-SW.
 14783
 14784     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 14785     GO TO 7800-EXIT.
 14786
 14787 7800-NOT-FOUND.
 14788
 14789     MOVE 'N'                        TO  PI-REC-FOUND-SW
 14790                                         PI-LETTER-SW.
 14791
 14792 7800-EXIT.
 14793     EXIT.
 14794
 14795 7850-AUTO-LETTER-WRITER.
 14796
 14797     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 14798     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 14799
 14800     IF STATUSI = 'C' OR 'CLOSED'
 14801         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 14802     ELSE
 14803         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 14804
 14805     IF STATUSI = 'C' OR 'CLOSED'
 14806         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 14807             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14808             MOVE '6'                TO  DC-OPTION-CODE
 14809             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 14810             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14811             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14812             IF NO-CONVERSION-ERROR
 14813                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 14814             ELSE
 14815                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 14816
 14817     IF STATUSI = 'C' OR 'CLOSED'
 14818         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 14819             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14820             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 282
* EL131.cbl
 14821             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 14822             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14823             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14824             IF NO-CONVERSION-ERROR
 14825                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 14826             ELSE
 14827                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 14828
 14829     IF STATUSI = 'O' OR 'OPEN'
 14830         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 14831             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14832             MOVE '6'                TO  DC-OPTION-CODE
 14833             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 14834             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14835             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14836             IF NO-CONVERSION-ERROR
 14837                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 14838             ELSE
 14839                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 14840
 14841     IF STATUSI = 'O' OR 'OPEN'
 14842         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 14843             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14844             MOVE '6'                TO  DC-OPTION-CODE
 14845             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 14846             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14847             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14848             IF NO-CONVERSION-ERROR
 14849                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 14850             ELSE
 14851                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 14852
 14853
 14854* EXEC CICS LINK
 14855*        PROGRAM    (LINK-1523)
 14856*        COMMAREA   (W-1523-LINKDATA)
 14857*        LENGTH     (W-1523-COMM-LENGTH)
 14858*    END-EXEC.
 14859*    MOVE '."C                   (   #00012445' TO DFHEIV0
 14860     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14861     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14862     MOVE X'2020233030303132343435' TO DFHEIV0(25:11)
 14863     CALL 'kxdfhei1' USING DFHEIV0,
 14864           LINK-1523,
 14865           W-1523-LINKDATA,
 14866           W-1523-COMM-LENGTH,
 14867           DFHEIV99,
 14868           DFHEIV99,
 14869           DFHEIV99,
 14870           DFHEIV99
 14871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14872
 14873
 14874     IF W-1523-ERROR-CODE = ZEROS
 14875         GO TO 7850-EXIT.
 14876
 14877     IF W-1523-FATAL-ERROR
 14878         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 283
* EL131.cbl
 14879         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14880
 14881     IF W-1523-ERROR-CODE = 0191
 14882         MOVE ER-0803                TO  EMI-ERROR
 14883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14884
 14885 7850-EXIT.
 14886     EXIT.
 14887
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 284
* EL131.cbl
 14889 8000-CREATE-DMO-REC.
 14890     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 14891     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 14892     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 14893
 14894
 14895* EXEC CICS HANDLE CONDITION
 14896*         NOTFND   (8000-NOTE-NOT-FOUND)
 14897*    END-EXEC.
 14898*    MOVE '"$I                   ! G #00012471' TO DFHEIV0
 14899     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14901     MOVE X'4720233030303132343731' TO DFHEIV0(25:11)
 14902     CALL 'kxdfhei1' USING DFHEIV0
 14903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14904
 14905
 14906
 14907* EXEC CICS READ
 14908*         DATASET(NOTE-FILE-ID)
 14909*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14910*         RIDFLD (NOTE-KEY)
 14911*    END-EXEC.
 14912*    MOVE '&"S        E          (   #00012475' TO DFHEIV0
 14913     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14914     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14915     MOVE X'2020233030303132343735' TO DFHEIV0(25:11)
 14916     CALL 'kxdfhei1' USING DFHEIV0,
 14917           NOTE-FILE-ID,
 14918           DFHEIV20,
 14919           DFHEIV99,
 14920           NOTE-KEY,
 14921           DFHEIV99,
 14922           DFHEIV99,
 14923           DFHEIV99
 14924     SET ADDRESS OF CERTIFICATE-NOTE TO
 14925         DFHEIV20
 14926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14927
 14928
 14929     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14930     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14931     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14932
 14933     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 14934         MOVE 'CC'               TO DCT-PRODUCT-CODE
 14935     ELSE
 14936         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14937
 14938     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14939     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14940
 14941
 14942* EXEC CICS LINK
 14943*        PROGRAM    ('DLO006')
 14944*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14945*        LENGTH     (WS-DCT-LENGTH)
 14946*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 285
* EL131.cbl
 14947     MOVE 'DLO006' TO DFHEIV1
 14948*    MOVE '."C                   (   #00012493' TO DFHEIV0
 14949     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14950     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14951     MOVE X'2020233030303132343933' TO DFHEIV0(25:11)
 14952     CALL 'kxdfhei1' USING DFHEIV0,
 14953           DFHEIV1,
 14954           DCT-COMMUNICATION-AREA,
 14955           WS-DCT-LENGTH,
 14956           DFHEIV99,
 14957           DFHEIV99,
 14958           DFHEIV99,
 14959           DFHEIV99
 14960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14961
 14962
 14963     IF  DCT-RETURN-CODE = 'OK'
 14964         GO TO 8000-CONT.
 14965
 14966     IF DCT-RETURN-CODE = '01' OR '02'
 14967         GO TO 8000-EXIT.
 14968
 14969     IF DCT-RETURN-CODE = '03'
 14970         MOVE ER-0951            TO EMI-ERROR
 14971         MOVE -1                 TO MAINTL
 14972         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14973         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14974         GO TO 8110-SEND-DATA.
 14975
 14976     IF DCT-RETURN-CODE = '04'
 14977         MOVE ER-0946            TO EMI-ERROR
 14978         MOVE -1                 TO MAINTL
 14979         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14980         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14981         GO TO 8110-SEND-DATA.
 14982
 14983     IF DCT-RETURN-CODE = '05'
 14984         MOVE ER-0947            TO EMI-ERROR
 14985         MOVE -1                 TO MAINTL
 14986         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14987         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14988         GO TO 8110-SEND-DATA.
 14989
 14990     IF DCT-RETURN-CODE = '06'
 14991         MOVE ER-0921            TO EMI-ERROR
 14992         MOVE -1                 TO MAINTL
 14993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14994         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14995         GO TO 8110-SEND-DATA.
 14996
 14997     IF DCT-RETURN-CODE = '07'
 14998         MOVE ER-0919            TO EMI-ERROR
 14999         MOVE -1                 TO MAINTL
 15000         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15001         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15002         GO TO 8110-SEND-DATA.
 15003
 15004     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 286
* EL131.cbl
 15005         MOVE ER-0948            TO EMI-ERROR
 15006         MOVE -1                 TO MAINTL
 15007         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15008         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15009         GO TO 8110-SEND-DATA.
 15010
 15011     IF DCT-RETURN-CODE = 'N1'
 15012         MOVE ER-0950            TO EMI-ERROR
 15013         MOVE -1                 TO MAINTL
 15014         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15015         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15016         GO TO 8110-SEND-DATA.
 15017
 15018     IF DCT-RETURN-CODE = 'E1'
 15019         MOVE ER-0974            TO EMI-ERROR
 15020         MOVE -1                 TO MAINTL
 15021         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15022         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15023         GO TO 8110-SEND-DATA.
 15024
 15025     IF DCT-RETURN-CODE = 'E2'
 15026         MOVE ER-0975            TO EMI-ERROR
 15027         MOVE -1                 TO MAINTL
 15028         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15029         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15030         GO TO 8110-SEND-DATA.
 15031
 15032     IF DCT-RETURN-CODE NOT = 'OK'
 15033         MOVE ER-0949            TO EMI-ERROR
 15034         MOVE -1                 TO MAINTL
 15035         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15036         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15037         GO TO 8110-SEND-DATA.
 15038
 15039 8000-CONT.
 15040
 15041     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 15042     MOVE 'CS'                   TO DM-RECORD-TYPE.
 15043     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 15044     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 15045     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 15046     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 15047     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 15048     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 15049
 15050     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 15051     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 15052     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 15053     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 15054     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 15055
 15056     IF STATUSI = 'OPEN' OR 'O'
 15057         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 15058      ELSE
 15059         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 15060
 15061     IF STATUSI = 'OPEN' OR 'O'
 15062        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 287
* EL131.cbl
 15063         MOVE '1'                TO DM-CLAIM-STATUS
 15064      ELSE
 15065         MOVE '2'                TO DM-CLAIM-STATUS.
 15066
 15067     IF STATUSI = 'CLOSED' OR 'C'
 15068        IF NOT FINAL-PAID
 15069         MOVE '3'                TO DM-CLAIM-STATUS
 15070      ELSE
 15071         MOVE '4'                TO DM-CLAIM-STATUS.
 15072
 15073     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 15074
 15075
 15076* EXEC CICS LINK
 15077*        PROGRAM    ('DLO025')
 15078*        COMMAREA   (DMO-COMMUNICATION-AREA)
 15079*        LENGTH     (WS-DMO-LENGTH)
 15080*    END-EXEC.
 15081     MOVE 'DLO025' TO DFHEIV1
 15082*    MOVE '."C                   (   #00012611' TO DFHEIV0
 15083     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15084     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15085     MOVE X'2020233030303132363131' TO DFHEIV0(25:11)
 15086     CALL 'kxdfhei1' USING DFHEIV0,
 15087           DFHEIV1,
 15088           DMO-COMMUNICATION-AREA,
 15089           WS-DMO-LENGTH,
 15090           DFHEIV99,
 15091           DFHEIV99,
 15092           DFHEIV99,
 15093           DFHEIV99
 15094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15095
 15096
 15097     IF  DM-RETURN-CODE = 'OK'
 15098         GO TO 8000-EXIT.
 15099
 15100     IF DM-RETURN-CODE = '01'
 15101         MOVE ER-8051            TO EMI-ERROR
 15102         MOVE -1                 TO MAINTL
 15103         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15104         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15105         GO TO 8110-SEND-DATA.
 15106
 15107     IF DM-RETURN-CODE = '02'
 15108         MOVE ER-8052            TO EMI-ERROR
 15109         MOVE -1                 TO MAINTL
 15110         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15111         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15112         GO TO 8110-SEND-DATA.
 15113
 15114     IF DM-RETURN-CODE = '03'
 15115         MOVE ER-8053            TO EMI-ERROR
 15116         MOVE -1                 TO MAINTL
 15117         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15118         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15119         GO TO 8110-SEND-DATA.
 15120
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 288
* EL131.cbl
 15121     IF DM-RETURN-CODE = '04'
 15122         MOVE ER-8054            TO EMI-ERROR
 15123         MOVE -1                 TO MAINTL
 15124         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15125         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15126         GO TO 8110-SEND-DATA.
 15127
 15128     IF DM-RETURN-CODE = '05'
 15129         MOVE ER-8055            TO EMI-ERROR
 15130         MOVE -1                 TO MAINTL
 15131         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15132         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15133         GO TO 8110-SEND-DATA.
 15134
 15135     IF DM-RETURN-CODE = '06'
 15136         MOVE ER-8056            TO EMI-ERROR
 15137         MOVE -1                 TO MAINTL
 15138         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15139         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15140         GO TO 8110-SEND-DATA.
 15141
 15142     IF DM-RETURN-CODE = '07'
 15143         MOVE ER-8057            TO EMI-ERROR
 15144         MOVE -1                 TO MAINTL
 15145         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15146         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15147         GO TO 8110-SEND-DATA.
 15148
 15149     IF DM-RETURN-CODE = '08'
 15150         MOVE ER-8058            TO EMI-ERROR
 15151         MOVE -1                 TO MAINTL
 15152         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15153         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15154         GO TO 8110-SEND-DATA.
 15155
 15156     IF DM-RETURN-CODE = '09'
 15157         MOVE ER-8059            TO EMI-ERROR
 15158         MOVE -1                 TO MAINTL
 15159         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15160         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15161         GO TO 8110-SEND-DATA.
 15162
 15163     IF DM-RETURN-CODE = '10'
 15164         MOVE ER-8060            TO EMI-ERROR
 15165         MOVE -1                 TO MAINTL
 15166         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15167         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15168         GO TO 8110-SEND-DATA.
 15169
 15170     IF DM-RETURN-CODE = '11'
 15171         MOVE ER-8061            TO EMI-ERROR
 15172         MOVE -1                 TO MAINTL
 15173         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15174         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15175         GO TO 8110-SEND-DATA.
 15176
 15177     IF DM-RETURN-CODE = '12'
 15178         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 289
* EL131.cbl
 15179         MOVE -1                 TO MAINTL
 15180         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15181         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15182         GO TO 8110-SEND-DATA.
 15183
 15184     IF DM-RETURN-CODE = '13'
 15185         MOVE ER-8063            TO EMI-ERROR
 15186         MOVE -1                 TO MAINTL
 15187         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15188         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15189         GO TO 8110-SEND-DATA.
 15190
 15191     IF DM-RETURN-CODE = '14'
 15192         MOVE ER-8064            TO EMI-ERROR
 15193         MOVE -1                 TO MAINTL
 15194         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15195         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15196         GO TO 8110-SEND-DATA.
 15197
 15198     IF DM-RETURN-CODE = '15'
 15199         MOVE ER-8065            TO EMI-ERROR
 15200         MOVE -1                 TO MAINTL
 15201         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15202         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15203         GO TO 8110-SEND-DATA.
 15204
 15205     IF DM-RETURN-CODE = '16'
 15206         MOVE ER-8154            TO EMI-ERROR
 15207         MOVE -1                 TO MAINTL
 15208         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15209         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15210         GO TO 8110-SEND-DATA.
 15211
 15212     IF DM-RETURN-CODE = '17'
 15213         MOVE ER-8155            TO EMI-ERROR
 15214         MOVE -1                 TO MAINTL
 15215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15216         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15217         GO TO 8110-SEND-DATA.
 15218
 15219     IF DM-RETURN-CODE = 'N1'
 15220         MOVE ER-8152            TO EMI-ERROR
 15221         MOVE -1                 TO MAINTL
 15222         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15223         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15224         GO TO 8110-SEND-DATA.
 15225
 15226     IF DM-RETURN-CODE = 'E1'
 15227         MOVE ER-8153            TO EMI-ERROR
 15228         MOVE -1                 TO MAINTL
 15229         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15230         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15231         GO TO 8110-SEND-DATA.
 15232
 15233     MOVE ER-8066                TO EMI-ERROR.
 15234     MOVE -1                     TO MAINTL.
 15235     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15236     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 290
* EL131.cbl
 15237     GO TO 8110-SEND-DATA.
 15238
 15239 8000-NOTE-NOT-FOUND.
 15240
 15241* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15242*    MOVE '6"R                   !   #00012760' TO DFHEIV0
 15243     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15245     MOVE X'2020233030303132373630' TO DFHEIV0(25:11)
 15246     CALL 'kxdfhei1' USING DFHEIV0
 15247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15248
 15249     MOVE ER-0954                TO EMI-ERROR.
 15250     MOVE -1                     TO MAINTL.
 15251     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15252     GO TO 8110-SEND-DATA.
 15253
 15254 8000-EXIT.
 15255     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 291
* EL131.cbl
 15257 8050-FORMAT-LAST-NAME-1ST.
 15258*****************************************************************
 15259*             M O V E   N A M E   R O U T I N E                 *
 15260*                                                               *
 15261*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15262*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15263*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 15264*                                                               *
 15265*                  FIELD               VALUE                    *
 15266*                  -----               -----                    *
 15267*           W-NAME-LAST    (CL15)      SMITH                    *
 15268*           W-NAME-FIRST   (CL15)      JOHN                     *
 15269*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15270*                                                               *
 15271*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 15272*                SMITH, JOHN ALLEN                              *
 15273*                     OR                                        *
 15274*                SMITH, JOHN A.                                 *
 15275*                                                               *
 15276*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 15277*     COPYBOOK, ELCNWA.                                         *
 15278*****************************************************************.
 15279
 15280     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15281     MOVE ZERO                   TO WS-NAME-SW.
 15282     SET NWA-INDEX               TO +1.
 15283
 15284     IF W-NAME-LAST   = SPACES  AND
 15285        W-NAME-MIDDLE = SPACES
 15286          MOVE +1                TO WS-NAME-SW.
 15287
 15288     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15289     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15290
 15291     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15292     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15293
 15294     SET NWA-INDEX UP BY +1.
 15295
 15296     IF W-NAME-MIDDLE NOT = SPACES
 15297         IF W-NAME-MIDDLE-2 = SPACES
 15298             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15299             SET NWA-INDEX UP BY +1
 15300             MOVE '.'            TO WS-NW (NWA-INDEX)
 15301             SET NWA-INDEX UP BY +2
 15302         ELSE
 15303             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15304             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15305
 15306 8050-EXIT.
 15307     EXIT.
 15308
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 292
* EL131.cbl
 15310 8060-MOVE-NAME.
 15311     IF WS-NAME-SW GREATER THAN +1
 15312         GO TO 8060-EXIT.
 15313
 15314     IF WS-NAME-WORK2 = SPACES
 15315         GO TO 8060-EXIT.
 15316
 15317     SET NWA-INDEX2            TO +1.
 15318     SET NWA-INDEX3            TO +2.
 15319
 15320 8060-MOVE-NAME-CYCLE.
 15321     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15322
 15323     IF NWA-INDEX LESS THAN +30
 15324         SET NWA-INDEX UP BY +1
 15325     ELSE
 15326         ADD +2 TO  WS-NAME-SW
 15327         GO TO 8060-EXIT.
 15328
 15329     IF NWA-INDEX2 LESS THAN +20
 15330         SET NWA-INDEX3 UP BY +1
 15331         SET NWA-INDEX2 UP BY +1.
 15332
 15333     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 15334        WS-NW2 (NWA-INDEX3) = SPACES
 15335         IF WS-NAME-SW = ZERO
 15336             MOVE ','            TO WS-NW (NWA-INDEX)
 15337             SET NWA-INDEX UP BY +2
 15338             MOVE +1             TO WS-NAME-SW
 15339             GO TO 8060-EXIT
 15340         ELSE
 15341             GO TO 8060-EXIT.
 15342
 15343     GO TO 8060-MOVE-NAME-CYCLE.
 15344
 15345 8060-EXIT.
 15346     EXIT.
 15347
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 293
* EL131.cbl
 15349
 15350 8070-UNLOCK-CLAIM-MSTR.
 15351
 15352* EXEC CICS UNLOCK
 15353*        DATASET   (CLMS-FILE-ID)
 15354*    END-EXEC.
 15355*    MOVE '&*                    #   #00012863' TO DFHEIV0
 15356     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15357     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15358     MOVE X'2020233030303132383633' TO DFHEIV0(25:11)
 15359     CALL 'kxdfhei1' USING DFHEIV0,
 15360           CLMS-FILE-ID,
 15361           DFHEIV99
 15362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15363
 15364
 15365 8070-EXIT.
 15366      EXIT.
 15367
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 294
* EL131.cbl
 15369 8100-SEND-MAP.
 15370     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15371
 15372     IF NOT PI-NO-CARRIER-SECURITY
 15373        MOVE AL-SANOF            TO CERTCARA.
 15374     IF NOT PI-NO-ACCOUNT-SECURITY
 15375        MOVE AL-SANOF            TO CERTACTA.
 15376
 15377     IF PI-PROCESSOR-ID = 'PEMA' OR 'KMSB' OR 'JMS'
 15378        MOVE AL-UANON TO INCA
 15379     END-IF
 15380     IF PI-PROCESSOR-ID = 'LGXX'
 15381        MOVE AL-UANON            TO CCNOA.
 15382
 15383     IF PI-COMPANY-ID = 'DMD'
 15384        NEXT SENTENCE
 15385     ELSE
 15386        MOVE AL-SADOF            TO PFKEY6A.
 15387
 15388     IF PI-USES-PAID-TO
 15389        MOVE 'PAID TO  :' TO PTHRHDGO.
 15390
 15391
 15392* EXEC CICS SEND
 15393*         MAP     ('EL131A')
 15394*         MAPSET  ('EL131S')
 15395*         ERASE
 15396*         FREEKB
 15397*         CURSOR
 15398*    END-EXEC.
 15399     MOVE 'EL131A' TO DFHEIV1
 15400     MOVE -1
 15401       TO DFHEIV11
 15402     MOVE 'EL131S' TO DFHEIV2
 15403*    MOVE '8$     CT  E F  H     ,   #00012893' TO DFHEIV0
 15404     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15405     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15406     MOVE X'2020233030303132383933' TO DFHEIV0(25:11)
 15407     CALL 'kxdfhei1' USING DFHEIV0,
 15408           DFHEIV1,
 15409           EL131AO,
 15410           DFHEIV99,
 15411           DFHEIV2,
 15412           DFHEIV99,
 15413           DFHEIV99,
 15414           DFHEIV99,
 15415           DFHEIV11,
 15416           DFHEIV99,
 15417           DFHEIV99,
 15418           DFHEIV99
 15419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15420
 15421
 15422     GO TO 9000-RETURN-TRANS.
 15423
 15424 8110-SEND-DATA.
 15425     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15426
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 295
* EL131.cbl
 15427     IF PI-USES-PAID-TO
 15428        MOVE 'PAID TO  :' TO PTHRHDGO.
 15429
 15430     IF PI-PROCESSOR-ID = 'LGXX'
 15431        MOVE AL-UANON            TO CCNOA.
 15432
 15433     IF PI-COMPANY-ID = 'DMD'
 15434        NEXT SENTENCE
 15435     ELSE
 15436        MOVE AL-SADOF            TO PFKEY6A.
 15437
 15438
 15439* EXEC CICS SEND
 15440*         MAP      ('EL131A')
 15441*         MAPSET   ('EL131S')
 15442*         DATAONLY
 15443*         FREEKB
 15444*         CURSOR
 15445*    END-EXEC.
 15446     MOVE 'EL131A' TO DFHEIV1
 15447     MOVE -1
 15448       TO DFHEIV11
 15449     MOVE 'EL131S' TO DFHEIV2
 15450*    MOVE '8$D    CT    F  H     ,   #00012917' TO DFHEIV0
 15451     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15452     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15453     MOVE X'2020233030303132393137' TO DFHEIV0(25:11)
 15454     CALL 'kxdfhei1' USING DFHEIV0,
 15455           DFHEIV1,
 15456           EL131AO,
 15457           DFHEIV99,
 15458           DFHEIV2,
 15459           DFHEIV99,
 15460           DFHEIV99,
 15461           DFHEIV99,
 15462           DFHEIV11,
 15463           DFHEIV99,
 15464           DFHEIV99,
 15465           DFHEIV99
 15466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15467
 15468
 15469     GO TO 9000-RETURN-TRANS.
 15470
 15471 8120-FORMAT-TIME-DATE.
 15472     perform 8140-check-for-prev-errors
 15473                                 thru 8140-exit
 15474     IF SKIP-ATTRIBUTE = 'Y'
 15475        MOVE SPACES              TO SKIP-ATTRIBUTE
 15476        MOVE ER-0598             TO EMI-ERROR
 15477        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15478        GO TO 8125-SKIP-ATTRIBUTE.
 15479
 15480*     IF PI-COMPANY-ID = 'DMD'
 15481      IF PI-PROCESSOR-ID <> 'EMER'
 15482         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 15483                                    CERTCARA  CERTGRPA CERTA SUFXA
 15484
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 296
* EL131.cbl
 15485     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 15486                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 15487                                    JNTINITA  JNTAGEA   APRA
 15488                                    LCVCDA    LCVOTRMA  LCVRTRMA
 15489                                    LCVBENEA  LCVFORMA  LCVCNDTA
 15490                                    LCVEXITA  LCVSTATA  LCVKINDA
 15491                                    ACVCDA    ACVOTRMA  ACVRTRMA
 15492                                    ACVBENEA  ACVFORMA  ACVCNDTA
 15493                                    ACVEXITA  ACVSTATA  ACVKINDA
 15494                                    PMTFREQA  INDGRPA   PREMTYPA
 15495                                    REINCDA   LCVRATEA  ACVRATEA
 15496                                    ADDONDTA.
 15497
 15498*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 15499*       IF PI-COMPANY-ID = 'DMD'
 15500*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 15501*                                   SUFXA
 15502*                                   PDAMTA    NODAYSA   NOPMTSA
 15503*                                   INCA      OCCA
 15504*          IF NOT SYSTEM-MODIFY-CAP
 15505*              MOVE AL-SANOF         TO PDTHRUA.
 15506
 15507     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 15508         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15509
 15510 8125-SKIP-ATTRIBUTE.
 15511
 15512     MOVE SAVE-DATE              TO DATEO.
 15513
 15514* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 15515*    END-EXEC
 15516*    MOVE '0"A                   "   #00012969' TO DFHEIV0
 15517     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 15518     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 15519     MOVE X'2020233030303132393639' TO DFHEIV0(25:11)
 15520     CALL 'kxdfhei1' USING DFHEIV0,
 15521           LCP-CICS-TIME
 15522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15523
 15524* EXEC CICS FORMATTIME
 15525*              ABSTIME(LCP-CICS-TIME)
 15526*              TIME(LCP-TIME-OF-DAY-XX)
 15527*    END-EXEC
 15528*    MOVE 'j$(     (             #   #00012971' TO DFHEIV0
 15529     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 15530     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15531     MOVE X'2020233030303132393731' TO DFHEIV0(25:11)
 15532     CALL 'kxdfhei1' USING DFHEIV0,
 15533           LCP-CICS-TIME,
 15534           LCP-TIME-OF-DAY-XX
 15535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15536     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 15537     MOVE UN-HOURS               TO FOR-HOURS.
 15538     MOVE UN-MINUTES             TO FOR-MINUTES.
 15539     MOVE TIME-OUT               TO TIMEO.
 15540     MOVE PI-COMPANY-ID          TO COMPO.
 15541     MOVE PI-PROCESSOR-ID        TO USERIDO.
 15542     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 297
* EL131.cbl
 15543     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15544     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 15545     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 15546
 15547 8130-EXIT.
 15548     EXIT.
 15549
 15550 8140-check-for-prev-errors.
 15551
 15552     MOVE PI-COMPANY-CD          TO trlr-company-cd
 15553     MOVE PI-CARRIER             TO trlr-carrier
 15554     MOVE PI-CLAIM-NO            TO trlr-claim-no
 15555     MOVE PI-CERT-NO             TO trlr-cert-no
 15556     MOVE +95                    TO TRLR-SEQ-NO
 15557
 15558
 15559* EXEC CICS READ
 15560*       DATASET  ('ELTRLR')
 15561*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15562*       RIDFLD   (TRLR-KEY)
 15563*       RESP     (WS-RESPONSE)
 15564*    END-EXEC
 15565     MOVE 'ELTRLR' TO DFHEIV1
 15566*    MOVE '&"S        E          (  N#00012997' TO DFHEIV0
 15567     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15568     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15569     MOVE X'204E233030303132393937' TO DFHEIV0(25:11)
 15570     CALL 'kxdfhei1' USING DFHEIV0,
 15571           DFHEIV1,
 15572           DFHEIV20,
 15573           DFHEIV99,
 15574           TRLR-KEY,
 15575           DFHEIV99,
 15576           DFHEIV99,
 15577           DFHEIV99
 15578     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15579         DFHEIV20
 15580     MOVE EIBRESP  TO WS-RESPONSE
 15581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15582
 15583     if ws-resp-normal
 15584        perform varying s1 from +1 by +1 until
 15585           at-note-error-no (s1) = spaces
 15586           if at-note-error-no (s1) = '1652'
 15587              continue
 15588           else
 15589              move at-note-error-no (s1)
 15590                                 to emi-error
 15591              move -1 to maintl
 15592              if at-note-error-no (s1) = '1653'
 15593                 evaluate true
 15594                    when pi-claim-type = 'L'
 15595                       move '  LF  '
 15596                        to emi-claim-type
 15597                    when pi-claim-type = 'I'
 15598                       move '  IU  '
 15599                        to emi-claim-type
 15600                    when other
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 298
* EL131.cbl
 15601                       move '  AH  '
 15602                        to emi-claim-type
 15603                 end-evaluate
 15604              end-if
 15605              PERFORM 9900-ERROR-FORMAT
 15606                                 THRU 9900-EXIT
 15607           end-if
 15608*          if at-note-error-no (s1) = '1653'
 15609*             perform varying emi-sub from 1 by 1 until
 15610*                emi-sub > 3
 15611*                if emi-error-number (emi-sub) = '1653'
 15612*                   evaluate true
 15613*                      when pi-claim-type = 'L'
 15614*                         move '  LF  '
 15615*                          to emi-claim-type
 15616*                      when pi-claim-type = 'I'
 15617*                         move '  IU  '
 15618*                          to emi-claim-type
 15619*                      when other
 15620*                         move '  AH  '
 15621*                          to emi-claim-type
 15622*                   end-evaluate
 15623*                end-if
 15624*             end-perform
 15625*          end-if
 15626        end-perform
 15627     else
 15628        display ' resp not normal ' ws-response ' '
 15629        trlr-key (2:19)
 15630     end-if
 15631
 15632     .
 15633 8140-exit.
 15634     exit.
 15635 8150-ENTERED-CLAIM-NOTFOUND.
 15636
 15637     MOVE ER-0204                TO EMI-ERROR.
 15638     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15639     MOVE -1                     TO MAINTL.
 15640     GO TO 8100-SEND-MAP.
 15641
 15642 8200-RETURN-PRIOR.
 15643     MOVE SPACE                  TO PI-RETURN-CD-1.
 15644     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 15645     GO TO 9200-XCTL.
 15646
 15647 8300-GET-HELP.
 15648     MOVE XCTL-EL010             TO CALL-PGM.
 15649     GO TO 9200-XCTL.
 15650
 15651 8400-RETURN-MASTER.
 15652     MOVE SPACE                  TO PI-RETURN-CD-1.
 15653     MOVE XCTL-EL126             TO CALL-PGM.
 15654     GO TO 9200-XCTL.
 15655
 15656 8500-TRLR-MNT.
 15657     IF PI-RETURN-CD-1 = 'X'
 15658         MOVE ER-0311            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 299
* EL131.cbl
 15659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15660         MOVE -1                 TO MAINTL
 15661         GO TO 8110-SEND-DATA.
 15662
 15663
 15664* EXEC CICS WRITEQ TS
 15665*         QUEUE     (PI-KEY)
 15666*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15667*         LENGTH    (PI-COMM-LENGTH)
 15668*    END-EXEC.
 15669*    MOVE '*"                    ''   #00013084' TO DFHEIV0
 15670     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15671     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15672     MOVE X'2020233030303133303834' TO DFHEIV0(25:11)
 15673     CALL 'kxdfhei1' USING DFHEIV0,
 15674           PI-KEY,
 15675           PROGRAM-INTERFACE-BLOCK,
 15676           PI-COMM-LENGTH,
 15677           DFHEIV99,
 15678           DFHEIV99,
 15679           DFHEIV99
 15680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15681
 15682
 15683     MOVE XCTL-EL142             TO CALL-PGM.
 15684     GO TO 9200-XCTL.
 15685
 15686 8600-ADDR-MNT.
 15687     IF PI-RETURN-CD-1 = 'X'
 15688         MOVE ER-0311            TO EMI-ERROR
 15689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15690         MOVE -1                 TO MAINTL
 15691         GO TO 8110-SEND-DATA.
 15692
 15693
 15694* EXEC CICS WRITEQ TS
 15695*         QUEUE     (PI-KEY)
 15696*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15697*         LENGTH    (PI-COMM-LENGTH)
 15698*    END-EXEC.
 15699*    MOVE '*"                    ''   #00013100' TO DFHEIV0
 15700     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15701     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15702     MOVE X'2020233030303133313030' TO DFHEIV0(25:11)
 15703     CALL 'kxdfhei1' USING DFHEIV0,
 15704           PI-KEY,
 15705           PROGRAM-INTERFACE-BLOCK,
 15706           PI-COMM-LENGTH,
 15707           DFHEIV99,
 15708           DFHEIV99,
 15709           DFHEIV99
 15710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15711
 15712
 15713     MOVE XCTL-EL141             TO CALL-PGM.
 15714     GO TO 9200-XCTL.
 15715
 15716 8700-CERT-MNT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 300
* EL131.cbl
 15717     IF PI-RETURN-CD-1 = 'X'
 15718         MOVE ER-7690            TO EMI-ERROR
 15719         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15720         MOVE -1                 TO MAINTL
 15721         GO TO 8110-SEND-DATA.
 15722
 15723
 15724* EXEC CICS WRITEQ TS
 15725*         QUEUE     (PI-KEY)
 15726*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15727*         LENGTH    (PI-COMM-LENGTH)
 15728*    END-EXEC.
 15729*    MOVE '*"                    ''   #00013116' TO DFHEIV0
 15730     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15731     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15732     MOVE X'2020233030303133313136' TO DFHEIV0(25:11)
 15733     CALL 'kxdfhei1' USING DFHEIV0,
 15734           PI-KEY,
 15735           PROGRAM-INTERFACE-BLOCK,
 15736           PI-COMM-LENGTH,
 15737           DFHEIV99,
 15738           DFHEIV99,
 15739           DFHEIV99
 15740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15741
 15742
 15743     MOVE XCTL-EL1273            TO CALL-PGM.
 15744     GO TO 9200-XCTL.
 15745
 15746 8750-DMD-CLM-FIX.
 15747
 15748* EXEC CICS WRITEQ TS
 15749*         QUEUE     (PI-KEY)
 15750*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15751*         LENGTH    (PI-COMM-LENGTH)
 15752*    END-EXEC.
 15753*    MOVE '*"                    ''   #00013126' TO DFHEIV0
 15754     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15755     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15756     MOVE X'2020233030303133313236' TO DFHEIV0(25:11)
 15757     CALL 'kxdfhei1' USING DFHEIV0,
 15758           PI-KEY,
 15759           PROGRAM-INTERFACE-BLOCK,
 15760           PI-COMM-LENGTH,
 15761           DFHEIV99,
 15762           DFHEIV99,
 15763           DFHEIV99
 15764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15765
 15766
 15767     MOVE XCTL-EL400DMD          TO CALL-PGM.
 15768     GO TO 9200-XCTL.
 15769
 15770 8800-UNAUTHORIZED-ACCESS.
 15771     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 15772     GO TO 8990-SEND-TEXT.
 15773
 15774 8810-PF23-ENTERED.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 301
* EL131.cbl
 15775     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 15776     MOVE XCTL-EL005             TO CALL-PGM.
 15777     GO TO 9200-XCTL.
 15778
 15779 8820-XCTL-ERROR.
 15780
 15781* EXEC CICS HANDLE CONDITION
 15782*        PGMIDERR (8990-SEND-TEXT)
 15783*    END-EXEC.
 15784*    MOVE '"$L                   ! H #00013145' TO DFHEIV0
 15785     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15786     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15787     MOVE X'4820233030303133313435' TO DFHEIV0(25:11)
 15788     CALL 'kxdfhei1' USING DFHEIV0
 15789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15790
 15791
 15792     MOVE SPACE                 TO PI-ENTRY-CD-1.
 15793     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 15794     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 15795     MOVE XCTL-EL005            TO CALL-PGM.
 15796     GO TO 9200-XCTL.
 15797
 15798 8990-SEND-TEXT.
 15799
 15800* EXEC CICS SEND TEXT
 15801*         FROM      (LOGOFF-TEXT)
 15802*         LENGTH    (LOGOFF-LENGTH)
 15803*         ERASE
 15804*         FREEKB
 15805*    END-EXEC.
 15806*    MOVE '8&      T  E F  H   F -   #00013156' TO DFHEIV0
 15807     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15808     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15809     MOVE X'2020233030303133313536' TO DFHEIV0(25:11)
 15810     CALL 'kxdfhei1' USING DFHEIV0,
 15811           LOGOFF-TEXT,
 15812           LOGOFF-LENGTH,
 15813           DFHEIV99,
 15814           DFHEIV99,
 15815           DFHEIV99,
 15816           DFHEIV99,
 15817           DFHEIV99,
 15818           DFHEIV99,
 15819           DFHEIV99,
 15820           DFHEIV99,
 15821           DFHEIV99,
 15822           DFHEIV99
 15823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15824
 15825
 15826     GO TO 9100-RETURN-CICS.
 15827
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 302
* EL131.cbl
 15829 9000-RETURN-TRANS.
 15830
 15831* EXEC CICS RETURN
 15832*         TRANSID   (TRANS-ID)
 15833*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15834*         LENGTH    (PI-COMM-LENGTH)
 15835*    END-EXEC.
 15836*    MOVE '.(CT                  ''   #00013167' TO DFHEIV0
 15837     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15838     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15839     MOVE X'2020233030303133313637' TO DFHEIV0(25:11)
 15840     CALL 'kxdfhei1' USING DFHEIV0,
 15841           TRANS-ID,
 15842           PROGRAM-INTERFACE-BLOCK,
 15843           PI-COMM-LENGTH,
 15844           DFHEIV99,
 15845           DFHEIV99,
 15846           DFHEIV99
 15847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15848
 15849
 15850
 15851* GOBACK.
 15852     MOVE '9%                    "   ' TO DFHEIV0
 15853     MOVE 'EL131' TO DFHEIV1
 15854     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15855     GOBACK.
 15856
 15857 9100-RETURN-CICS.
 15858
 15859* EXEC CICS RETURN
 15860*    END-EXEC.
 15861*    MOVE '.(                    ''   #00013176' TO DFHEIV0
 15862     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15863     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15864     MOVE X'2020233030303133313736' TO DFHEIV0(25:11)
 15865     CALL 'kxdfhei1' USING DFHEIV0,
 15866           DFHEIV99,
 15867           DFHEIV99,
 15868           DFHEIV99,
 15869           DFHEIV99,
 15870           DFHEIV99,
 15871           DFHEIV99
 15872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15873
 15874
 15875
 15876* GOBACK.
 15877     MOVE '9%                    "   ' TO DFHEIV0
 15878     MOVE 'EL131' TO DFHEIV1
 15879     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15880     GOBACK.
 15881
 15882 9200-XCTL.
 15883
 15884* EXEC CICS XCTL
 15885*         PROGRAM    (CALL-PGM)
 15886*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 303
* EL131.cbl
 15887*         LENGTH     (PI-COMM-LENGTH)
 15888*    END-EXEC.
 15889*    MOVE '.$C                   %   #00013182' TO DFHEIV0
 15890     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15891     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15892     MOVE X'2020233030303133313832' TO DFHEIV0(25:11)
 15893     CALL 'kxdfhei1' USING DFHEIV0,
 15894           CALL-PGM,
 15895           PROGRAM-INTERFACE-BLOCK,
 15896           PI-COMM-LENGTH,
 15897           DFHEIV99
 15898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15899
 15900
 15901 9700-LINK-RTRM-FILE-ID.
 15902
 15903* EXEC CICS LINK
 15904*        PROGRAM  (RTRM-FILE-ID)
 15905*        COMMAREA (CALCULATION-PASS-AREA)
 15906*        LENGTH   (CP-COMM-LENGTH)
 15907*    END-EXEC.
 15908*    MOVE '."C                   (   #00013189' TO DFHEIV0
 15909     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15911     MOVE X'2020233030303133313839' TO DFHEIV0(25:11)
 15912     CALL 'kxdfhei1' USING DFHEIV0,
 15913           RTRM-FILE-ID,
 15914           CALCULATION-PASS-AREA,
 15915           CP-COMM-LENGTH,
 15916           DFHEIV99,
 15917           DFHEIV99,
 15918           DFHEIV99,
 15919           DFHEIV99
 15920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15921
 15922
 15923 9700-EXIT.
 15924      EXIT.
 15925
 15926 9800-CONVERT-DATE.
 15927     MOVE SPACES TO DC-ERROR-CODE.
 15928
 15929* EXEC CICS LINK
 15930*         PROGRAM    (DATE-CONV)
 15931*         COMMAREA   (DATE-CONVERSION-DATA)
 15932*         LENGTH     (DC-COMM-LENGTH)
 15933*    END-EXEC.
 15934*    MOVE '."C                   (   #00013200' TO DFHEIV0
 15935     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15937     MOVE X'2020233030303133323030' TO DFHEIV0(25:11)
 15938     CALL 'kxdfhei1' USING DFHEIV0,
 15939           DATE-CONV,
 15940           DATE-CONVERSION-DATA,
 15941           DC-COMM-LENGTH,
 15942           DFHEIV99,
 15943           DFHEIV99,
 15944           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 304
* EL131.cbl
 15945           DFHEIV99
 15946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15947
 15948
 15949 9800-EXIT.
 15950     EXIT.
 15951
 15952 9900-ERROR-FORMAT.
 15953
 15954* EXEC CICS LINK
 15955*         PROGRAM    (XCTL-EL001)
 15956*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 15957*         LENGTH     (EMI-COMM-LENGTH)
 15958*    END-EXEC.
 15959*    MOVE '."C                   (   #00013210' TO DFHEIV0
 15960     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15961     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15962     MOVE X'2020233030303133323130' TO DFHEIV0(25:11)
 15963     CALL 'kxdfhei1' USING DFHEIV0,
 15964           XCTL-EL001,
 15965           ERROR-MESSAGE-INTERFACE-BLOCK,
 15966           EMI-COMM-LENGTH,
 15967           DFHEIV99,
 15968           DFHEIV99,
 15969           DFHEIV99,
 15970           DFHEIV99
 15971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15972
 15973
 15974 9900-EXIT.
 15975     EXIT.
 15976
 15977 9990-ABEND.
 15978     MOVE DFHEIBLK               TO EMI-LINE1.
 15979
 15980* EXEC CICS LINK
 15981*         PROGRAM   (XCTL-EL004)
 15982*         COMMAREA  (EMI-LINE1)
 15983*         LENGTH    (72)
 15984*     END-EXEC.
 15985     MOVE 72
 15986       TO DFHEIV11
 15987*    MOVE '."C                   (   #00013221' TO DFHEIV0
 15988     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15989     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15990     MOVE X'2020233030303133323231' TO DFHEIV0(25:11)
 15991     CALL 'kxdfhei1' USING DFHEIV0,
 15992           XCTL-EL004,
 15993           EMI-LINE1,
 15994           DFHEIV11,
 15995           DFHEIV99,
 15996           DFHEIV99,
 15997           DFHEIV99,
 15998           DFHEIV99
 15999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16000
 16001
 16002     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 305
* EL131.cbl
 16003
 16004     GO TO 8110-SEND-DATA.
 16005
 16006 9995-SECURITY-VIOLATION.
 16007*           COPY ELCSCTP.
 16008******************************************************************
 16009*                                                                *
 16010*                            ELCSCTP                             *
 16011*                            VMOD=2.001                          *
 16012*                                                                *
 16013*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16014******************************************************************
 16015
 16016
 16017     MOVE EIBDATE          TO SM-JUL-DATE.
 16018     MOVE EIBTRMID         TO SM-TERMID.
 16019     MOVE THIS-PGM         TO SM-PGM.
 16020     MOVE EIBTIME          TO TIME-IN.
 16021     MOVE TIME-OUT         TO SM-TIME.
 16022     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16023
 16024
 16025* EXEC CICS LINK
 16026*         PROGRAM  ('EL003')
 16027*         COMMAREA (SECURITY-MESSAGE)
 16028*         LENGTH   (80)
 16029*    END-EXEC.
 16030     MOVE 'EL003' TO DFHEIV1
 16031     MOVE 80
 16032       TO DFHEIV11
 16033*    MOVE '."C                   (   #00013249' TO DFHEIV0
 16034     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16036     MOVE X'2020233030303133323439' TO DFHEIV0(25:11)
 16037     CALL 'kxdfhei1' USING DFHEIV0,
 16038           DFHEIV1,
 16039           SECURITY-MESSAGE,
 16040           DFHEIV11,
 16041           DFHEIV99,
 16042           DFHEIV99,
 16043           DFHEIV99,
 16044           DFHEIV99
 16045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16046
 16047
 16048******************************************************************
 16049
 16050
 16051
 16052 9999-DFHBACK SECTION.
 16053     MOVE '9%                    "   ' TO DFHEIV0
 16054     MOVE 'EL131' TO DFHEIV1
 16055     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16056     GOBACK.
 16057 9999-DFHEXIT.
 16058     IF DFHEIGDJ EQUAL 0001
 16059         NEXT SENTENCE
 16060     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 306
* EL131.cbl
 16061         GO TO 8820-XCTL-ERROR,
 16062               8150-ENTERED-CLAIM-NOTFOUND,
 16063               9990-ABEND
 16064         DEPENDING ON DFHEIGDI
 16065     ELSE IF DFHEIGDJ EQUAL 3
 16066         GO TO 0130-TS-ERROR,
 16067               0130-TS-ERROR
 16068         DEPENDING ON DFHEIGDI
 16069     ELSE IF DFHEIGDJ EQUAL 4
 16070         GO TO 0600-CONTINUE-NAME-UPDATE
 16071         DEPENDING ON DFHEIGDI
 16072     ELSE IF DFHEIGDJ EQUAL 5
 16073         GO TO 1004-BENE-NOT-FOUND
 16074         DEPENDING ON DFHEIGDI
 16075     ELSE IF DFHEIGDJ EQUAL 6
 16076         GO TO 1120-CNTL-NOTFND
 16077         DEPENDING ON DFHEIGDI
 16078     ELSE IF DFHEIGDJ EQUAL 7
 16079         GO TO 1150-NOTOPEN-ERROR,
 16080               1150-EXIT
 16081         DEPENDING ON DFHEIGDI
 16082     ELSE IF DFHEIGDJ EQUAL 8
 16083         GO TO 1490-STATE-NOTFND
 16084         DEPENDING ON DFHEIGDI
 16085     ELSE IF DFHEIGDJ EQUAL 9
 16086         GO TO 1500-CARR-NOTFND
 16087         DEPENDING ON DFHEIGDI
 16088     ELSE IF DFHEIGDJ EQUAL 10
 16089         GO TO 1620-ACCT-NOTFND
 16090         DEPENDING ON DFHEIGDI
 16091     ELSE IF DFHEIGDJ EQUAL 11
 16092         GO TO 2020-EXIT
 16093         DEPENDING ON DFHEIGDI
 16094     ELSE IF DFHEIGDJ EQUAL 12
 16095         GO TO 2030-EXIT
 16096         DEPENDING ON DFHEIGDI
 16097     ELSE IF DFHEIGDJ EQUAL 13
 16098         GO TO 2040-EXIT
 16099         DEPENDING ON DFHEIGDI
 16100     ELSE IF DFHEIGDJ EQUAL 14
 16101         GO TO 2050-EXIT
 16102         DEPENDING ON DFHEIGDI
 16103     ELSE IF DFHEIGDJ EQUAL 15
 16104         GO TO 2060-CERT-NOTFND
 16105         DEPENDING ON DFHEIGDI
 16106     ELSE IF DFHEIGDJ EQUAL 16
 16107         GO TO 2060-DUPKEY
 16108         DEPENDING ON DFHEIGDI
 16109     ELSE IF DFHEIGDJ EQUAL 17
 16110         GO TO 2070-NOT-FOUND
 16111         DEPENDING ON DFHEIGDI
 16112     ELSE IF DFHEIGDJ EQUAL 18
 16113         GO TO 2070-EXIT
 16114         DEPENDING ON DFHEIGDI
 16115     ELSE IF DFHEIGDJ EQUAL 19
 16116         GO TO 2080-EXIT
 16117         DEPENDING ON DFHEIGDI
 16118     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 307
* EL131.cbl
 16119         GO TO 2400-TRLR-NOTFND,
 16120               2410-EXIT
 16121         DEPENDING ON DFHEIGDI
 16122     ELSE IF DFHEIGDJ EQUAL 21
 16123         GO TO 2425-NINETY-NOTFND,
 16124               2425-NINETY-NOTFND
 16125         DEPENDING ON DFHEIGDI
 16126     ELSE IF DFHEIGDJ EQUAL 22
 16127         GO TO 2430-EXIT,
 16128               2440-EXIT
 16129         DEPENDING ON DFHEIGDI
 16130     ELSE IF DFHEIGDJ EQUAL 23
 16131         GO TO 2440-EXIT
 16132         DEPENDING ON DFHEIGDI
 16133     ELSE IF DFHEIGDJ EQUAL 24
 16134         GO TO 2460-EXIT
 16135         DEPENDING ON DFHEIGDI
 16136     ELSE IF DFHEIGDJ EQUAL 25
 16137         GO TO 2475-EXIT
 16138         DEPENDING ON DFHEIGDI
 16139     ELSE IF DFHEIGDJ EQUAL 26
 16140         GO TO 2650-EXIT
 16141         DEPENDING ON DFHEIGDI
 16142     ELSE IF DFHEIGDJ EQUAL 27
 16143         GO TO 2800-EXIT,
 16144               2800-EXIT
 16145         DEPENDING ON DFHEIGDI
 16146     ELSE IF DFHEIGDJ EQUAL 28
 16147         GO TO 3010-DEL-ACTQ,
 16148               3040-EXIT
 16149         DEPENDING ON DFHEIGDI
 16150     ELSE IF DFHEIGDJ EQUAL 29
 16151         GO TO 3010-NO-ACTIVITY,
 16152               3050-EXIT
 16153         DEPENDING ON DFHEIGDI
 16154     ELSE IF DFHEIGDJ EQUAL 30
 16155         GO TO 3010-CERT-NOT-FOUND
 16156         DEPENDING ON DFHEIGDI
 16157     ELSE IF DFHEIGDJ EQUAL 31
 16158         GO TO 3020-EXIT
 16159         DEPENDING ON DFHEIGDI
 16160     ELSE IF DFHEIGDJ EQUAL 32
 16161         GO TO 3060-EXIT,
 16162               3060-EXIT
 16163         DEPENDING ON DFHEIGDI
 16164     ELSE IF DFHEIGDJ EQUAL 33
 16165         GO TO 5000-TRLR-NOT-FOUND
 16166         DEPENDING ON DFHEIGDI
 16167     ELSE IF DFHEIGDJ EQUAL 34
 16168         GO TO 5000-CERT-NOT-FOUND
 16169         DEPENDING ON DFHEIGDI
 16170     ELSE IF DFHEIGDJ EQUAL 35
 16171         GO TO 7630-END-BROWSE
 16172         DEPENDING ON DFHEIGDI
 16173     ELSE IF DFHEIGDJ EQUAL 36
 16174         GO TO 7799-EXIT,
 16175               7799-EXIT
 16176         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:08 Page 308
* EL131.cbl
 16177     ELSE IF DFHEIGDJ EQUAL 37
 16178         GO TO 7799-EXIT
 16179         DEPENDING ON DFHEIGDI
 16180     ELSE IF DFHEIGDJ EQUAL 38
 16181         GO TO 7800-NOT-FOUND
 16182         DEPENDING ON DFHEIGDI
 16183     ELSE IF DFHEIGDJ EQUAL 39
 16184         GO TO 8000-NOTE-NOT-FOUND
 16185         DEPENDING ON DFHEIGDI
 16186     ELSE IF DFHEIGDJ EQUAL 40
 16187         GO TO 8990-SEND-TEXT
 16188         DEPENDING ON DFHEIGDI.
 16189     MOVE '9%                    "   ' TO DFHEIV0
 16190     MOVE 'EL131' TO DFHEIV1
 16191     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16192     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13132     Code:       54623
