* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    50* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    51*071117   IR2017061900003  PEMA  ALLOW 0% APR ON REFUNDS
    52* 100417  CR2017051000002  PEMA  Add fields to interface
    53* 100418  CR2018073000001  PEMA  REWORD REFUND METHODS
    54* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    55* 052319  IR2019052300001  PEMA  VIN&BENE not being passed at time
    56* 062119  CR2019050800001  PEMA  Add option to search by VIN
    57* 080519  IR2019080200001  PEMA  Allow multiple quotes by VIN
    58* 080919  IR2019080900001  PEMA  Shorten allowed Linkage Section
    59* 041720  IR2020041700001  PEMA  Change to not drop cert suffix.
    60******************************************************************
    61 environment division.
    62 data division.
    63 working-storage section.
    64 01  DFH-START PIC X(04).
    65*
    66* program buffers
    67*
    68 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    69     88  ALREADY-SENT              VALUE 'Y'.
    70 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    71 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page   3
* SOCK03.cbl
    72     88  ELCERT-FINISHED            VALUE 'Y'.
    73 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    74 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    75     88  ERACCT-FOUND               VALUE 'Y'.
    76 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    77 77 ws-send-msg-size           pic s9(8) comp value 4096.
    78 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    79 77 ws-recv-buf                pic x(4096).
    80 77 ws-send-buf                pic x(4096) VALUE SPACES.
    81 77 ws-recv-total              pic s9(8) comp value 0.
    82 77 ws-recv-left               pic s9(8) comp value 0.
    83 77 ws-seq-num                 pic s9(8) comp value 0.
    84 77 ws-flags                   pic s9(8) comp value 0.
    85 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    86 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    87 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    88 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    89 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    90 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    91 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    92 77  ws-cancel-reason            pic x   value spaces.
    93 77  P1                          PIC S999 COMP-3 VALUE +0.
    94 77  P2                          PIC S999 COMP-3 VALUE +0.
    95 77  C0                          PIC S999 COMP-3 VALUE +0.
    96 77  C1                          PIC S999 COMP-3 VALUE +0.
    97 77  C2                          PIC S999 COMP-3 VALUE +0.
    98 77  C3                          PIC S999 COMP-3 VALUE +0.
    99 77 S1                           PIC S999 COMP-3 VALUE +0.
   100 77 S2                           PIC S999 COMP-3 VALUE +0.
   101 77 L1                           PIC S999 COMP-3 VALUE +0.
   102 77 L2                           PIC S999 COMP-3 VALUE +0.
   103 77 F1                           PIC S999 COMP-3 VALUE +0.
   104 77 WS-BUILD-SW                  PIC X.
   105    88  TIME-TO-BUILD               VALUE 'Y'.
   106 77 WS-SAVE-ERACCT               PIC X(2000).
   107 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
   108 77 WS-STOP-SW                   PIC X  VALUE ' '.
   109    88  TOLD-TO-STOP               VALUE 'Y'.
   110 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   111    88  GET-RATES                    VALUE 'R'.
   112    88  GET-ACT-ACCTS                VALUE 'A'.
   113 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   114 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   115 77 ws-disp-rate                 pic z9.99999.
   116 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   117     88  END-OF-ERCTBL                 VALUE 'Y'.
   118 77  WS-STATUS                   PIC X.
   119 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   120 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   121 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   122 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   123 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   124 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   125 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   126 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   127 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   128 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   129 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page   4
* SOCK03.cbl
   130 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   131     88  WS-ELCERT-FULL             VALUE '1'.
   132     88  WS-ELCERT-NAME             VALUE '2'.
   133     88  WS-ELCERT-CERT-NO          VALUE '3'.
   134     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   135     88  WS-ELCERT-VIN              value '5'.
   136 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   137 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   138     88  I-SAY-TO-STOP      VALUE 'Y'.
   139 77  WS-HEX-0A                   PIC X.
   140 77  WS-CALL-TYPE                PIC X(6).
   141 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   142 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   143 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   144 77  DD-IU-SW                    PIC X   VALUE ' '.
   145     88  DD-IU-PRESENT                 VALUE 'Y'.
   146 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   147 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   148 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   149 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   150 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   151 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   152 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   153 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   154 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   155     88  PDEF-FOUND                              VALUE 'Y'.
   156 77  ws-epiq-sw                  pic x  value ' '.
   157     88  ws-epiq-request           value 'Y'.
   158 77  ws-epiq-max                 pic s999 value +0 comp-3.
   159 01  WS-STRING-DATA.
   160     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   161     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   162     05  WS-CARRIER              PIC X        VALUE SPACES.
   163     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   164     05  WS-STATE                PIC XX       VALUE SPACES.
   165     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   166     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   167     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   168     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   169     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   170     05  WS-MID-INIT             PIC X        VALUE SPACES.
   171     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   172     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   173     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   174     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   175     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   176     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   177     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   178     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   179     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   180     05  WS-LF-METHOD            PIC X(15)    VALUE SPACES.
   181     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   182     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   183     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   184     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   185     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   186     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   187     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page   5
* SOCK03.cbl
   188     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   189     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   190     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   191     05  WS-AH-METHOD            PIC X(15)    VALUE SPACES.
   192     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   193     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   194     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   195     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   196     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   197     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   198     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   199     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   200     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   201     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   202     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   203     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   204     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   205     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   206     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   207     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   208     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   209     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   210     05  WS-LF-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   211     05  WS-AH-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   212     05  WS-VIN                  PIC X(17)  VALUE SPACES.
   213     05  WS-CRED-BENE-NAME       PIC X(30)  VALUE SPACES.
   214 01  ws-work-date.
   215     05  ws-work-ccyy            pic x(4).
   216     05  ws-work-mm              pic xx.
   217     05  ws-work-dd              pic xx.
   218 01  ws-work-date-num redefines ws-work-date
   219                                 pic 9(8).
   220 01  FILLER.
   221     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   222     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   223     12  WS-STATE-ABBREVIATION   PIC XX.
   224     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   225     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   226     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   227     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   228     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   229     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   230     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   231     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   232     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   233     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   234     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   235     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   236     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   237     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   238     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   239     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   240     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   241     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   242     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   243     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   244     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   245     12  WS-LF-OVERRIDE-L1       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page   6
* SOCK03.cbl
   246     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   247     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   248     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   249     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   250         88  WS-REDUCING                         VALUE 'R'.
   251         88  WS-LEVEL                            VALUE 'L'  'P'.
   252 01  ELMSTR-KEY.
   253     12  ELMSTR-COMP-CD          PIC X.
   254     12  ELMSTR-CERT-NO          PIC X(11).
   255 01  CTBL-KEY-SAVE               PIC X(5).
   256 01  CTBL-KEY.
   257     05  CTBL-COMPANY-CD         PIC X.
   258     05  CTBL-TABLE              PIC XXX.
   259     05  CTBL-BEN-TYPE           PIC X.
   260     05  CTBL-BEN-CODE           PIC XX.
   261 01  ERPDEF-KEY-SAVE             PIC X(18).
   262 01  ERPDEF-KEY.
   263     12  ERPDEF-COMPANY-CD       PIC X.
   264     12  ERPDEF-STATE            PIC XX.
   265     12  ERPDEF-PROD-CD          PIC XXX.
   266     12  F                       PIC X(7).
   267     12  ERPDEF-BEN-TYPE         PIC X.
   268     12  ERPDEF-BEN-CODE         PIC XX.
   269     12  ERPDEF-EXP-DT           PIC XX.
   270 01  WS-AM3-KEY.
   271     12  WS-AM3-ACCOUNT          PIC X(10).
   272     12  WS-AM3-EXP-DT           PIC XX.
   273 01  WS-AM-KEY.
   274     12  WS-AM-COMPANY-CD        PIC X.
   275     12  WS-AM-CARRIER           PIC X.
   276     12  WS-AM-GROUPING          PIC X(6).
   277     12  WS-AM-STATE             PIC XX.
   278     12  WS-AM-ACCOUNT           PIC X(10).
   279     12  WS-AM-EXPIRATION-DT     PIC XX.
   280     12  WS-AM-FILLER            PIC XXXX.
   281 01  WS-CO-DATA.
   282     05  WS-CO-NUM               PIC X(10).
   283     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   284     05  WS-CO-NAME              PIC X(30).
   285     05  WS-CO-MAIL-NAME         PIC X(30).
   286     05  WS-CO-ADDR1             PIC X(30).
   287     05  WS-CO-ADDR2             PIC X(30).
   288     05  WS-CO-ADDR3             PIC X(30).
   289     05  WS-CO-ZIP               PIC X(9).
   290     05  WS-CO-PHONE             PIC X(10).
   291 01  WS-CF-KEY.
   292     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   293     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   294*        88  COMPANY-MASTER                      VALUE '1'.
   295*        88  STATE-MASTER                        VALUE '3'.
   296*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   297*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   298     12  WS-CF-ACCESS.
   299         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   300         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   301             20  FILLER          PIC  X(01).
   302             20  WS-CF-CARRIER   PIC  X(01).
   303     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page   7
* SOCK03.cbl
   304 01  WS-CS-KEY.
   305     05  WS-CS-COMPANY-CD        PIC X.
   306     05  WS-CS-CARRIER           PIC X.
   307     05  WS-CS-GROUP             PIC X(6).
   308     05  WS-CS-STATE             PIC XX.
   309     05  WS-CS-ACCOUNT           PIC X(10).
   310     05  WS-CS-EFF-DT            PIC XX.
   311     05  WS-CS-CERT-NO           PIC X(11).
   312     05  WS-CS-TRLR-TYPE         PIC X.
   313 01  WS-MA-KEY.
   314     05  WS-MA-COMPANY-CD        PIC X.
   315     05  WS-MA-CARRIER           PIC X.
   316     05  WS-MA-GROUP             PIC X(6).
   317     05  WS-MA-STATE             PIC XX.
   318     05  WS-MA-ACCOUNT           PIC X(10).
   319     05  WS-MA-EFF-DT            PIC XX.
   320     05  WS-MA-CERT-NO           PIC X(11).
   321 01  WS-CM-KEY.
   322     05  WS-CM-COMPANY-CD        PIC X.
   323     05  WS-CM-CARRIER           PIC X.
   324     05  WS-CM-GROUP             PIC X(6).
   325     05  WS-CM-STATE             PIC XX.
   326     05  WS-CM-ACCOUNT           PIC X(10).
   327     05  WS-CM-EFF-DT            PIC XX.
   328     05  WS-CM-CERT-NO           PIC X(11).
   329 01  WS-CM-KEY-A1.
   330     05  WS-CM-COMPANY-CD-A1     PIC X.
   331     05  WS-CM-LAST-NAME         PIC X(15).
   332     05  WS-CM-INITIALS          PIC XX.
   333 01  WS-CM-KEY-A4.
   334     05  WS-CM-COMPANY-CD-A4     PIC X.
   335     05  WS-CM-CERT-NO-A4        PIC X(11).
   336 01  WS-CID-NO                   PIC X(8).
   337 01  soc-client-in-data.
   338     05  CLIENT-CAR              PIC X.
   339     05  CLIENT-GRP              PIC X(6).
   340     05  CLIENT-STATE            PIC XX.
   341     05  CLIENT-ACCOUNT          PIC X(10).
   342     05  CLIENT-EFF-DT           PIC X(8).  *> ccyymmdd
   343     05  CLIENT-CERT-NO          PIC X(11).
   344     05  CLIENT-LAST-NAME        PIC X(15).
   345     05  CLIENT-FIRST-NAME       PIC X(10).
   346     05  CLIENT-VAL-DT           PIC X(8).  *> ccyymmdd
   347     05  CLIENT-CAN-REASON       PIC X.
   348     05  client-vin              pic x(17).
   349 01  WS-DISP-RESP                PIC 9(5).
   350 01  WS-RESPONSE                 PIC S9(8)   COMP.
   351     88  RESP-NORMAL                  VALUE +00.
   352     88  RESP-NOTFND                  VALUE +13.
   353     88  RESP-DUPKEY                  VALUE +15.
   354     88  RESP-NOTOPEN                 VALUE +19.
   355     88  RESP-ENDFILE                 VALUE +20.
   356*                                 COPY ELCCERT.
   357******************************************************************
   358*                                                                *
   359*                            ELCCERT.                            *
   360*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   361*                            VMOD=2.013                          *
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page   8
* SOCK03.cbl
   362*                                                                *
   363*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   364*                                                                *
   365*   FILE TYPE = VSAM,KSDS                                        *
   366*   RECORD SIZE = 450  RECFORM = FIXED                           *
   367*                                                                *
   368*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   369*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   370*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   371*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   372*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   373*                                                                *
   374*   LOG = YES                                                    *
   375*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   376******************************************************************
   377*                   C H A N G E   L O G
   378*
   379* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   380*-----------------------------------------------------------------
   381*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   382* EFFECTIVE    NUMBER
   383*-----------------------------------------------------------------
   384* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   385* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   386* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   387* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   388* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   389* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   390* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   391* 032612  CR2011110200001  PEMA  AHL CHANGES
   392* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   393* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   394* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   395******************************************************************
   396
   397 01  CERTIFICATE-MASTER.
   398     12  CM-RECORD-ID                      PIC XX.
   399         88  VALID-CM-ID                      VALUE 'CM'.
   400
   401     12  CM-CONTROL-PRIMARY.
   402         16  CM-COMPANY-CD                 PIC X.
   403         16  CM-CARRIER                    PIC X.
   404         16  CM-GROUPING.
   405             20  CM-GROUPING-PREFIX        PIC X(3).
   406             20  CM-GROUPING-PRIME         PIC X(3).
   407         16  CM-STATE                      PIC XX.
   408         16  CM-ACCOUNT.
   409             20  CM-ACCOUNT-PREFIX         PIC X(4).
   410             20  CM-ACCOUNT-PRIME          PIC X(6).
   411         16  CM-CERT-EFF-DT                PIC XX.
   412         16  CM-CERT-NO.
   413             20  CM-CERT-PRIME             PIC X(10).
   414             20  CM-CERT-SFX               PIC X.
   415
   416     12  CM-CONTROL-BY-NAME.
   417         16  CM-COMPANY-CD-A1              PIC X.
   418         16  CM-INSURED-LAST-NAME          PIC X(15).
   419         16  CM-INSURED-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page   9
* SOCK03.cbl
   420             20  CM-INSURED-INITIAL1       PIC X.
   421             20  CM-INSURED-INITIAL2       PIC X.
   422
   423     12  CM-CONTROL-BY-SSN.
   424         16  CM-COMPANY-CD-A2              PIC X.
   425         16  CM-SOC-SEC-NO.
   426             20  CM-SSN-STATE              PIC XX.
   427             20  CM-SSN-ACCOUNT            PIC X(6).
   428             20  CM-SSN-LN3.
   429                 25  CM-INSURED-INITIALS-A2.
   430                     30 CM-INSURED-INITIAL1-A2   PIC X.
   431                     30 CM-INSURED-INITIAL2-A2   PIC X.
   432                 25 CM-PART-LAST-NAME-A2         PIC X.
   433
   434     12  CM-CONTROL-BY-CERT-NO.
   435         16  CM-COMPANY-CD-A4              PIC X.
   436         16  CM-CERT-NO-A4                 PIC X(11).
   437
   438     12  CM-CONTROL-BY-MEMB.
   439         16  CM-COMPANY-CD-A5              PIC X.
   440         16  CM-MEMBER-NO.
   441             20  CM-MEMB-STATE             PIC XX.
   442             20  CM-MEMB-ACCOUNT           PIC X(6).
   443             20  CM-MEMB-LN4.
   444                 25  CM-INSURED-INITIALS-A5.
   445                     30 CM-INSURED-INITIAL1-A5   PIC X.
   446                     30 CM-INSURED-INITIAL2-A5   PIC X.
   447                 25 CM-PART-LAST-NAME-A5         PIC XX.
   448
   449     12  CM-INSURED-PROFILE-DATA.
   450         16  CM-INSURED-FIRST-NAME.
   451             20  CM-INSURED-1ST-INIT       PIC X.
   452             20  FILLER                    PIC X(9).
   453         16  CM-INSURED-ISSUE-AGE          PIC 99.
   454         16  CM-INSURED-SEX                PIC X.
   455             88  CM-SEX-MALE                  VALUE 'M'.
   456             88  CM-SEX-FEMAL                 VALUE 'F'.
   457         16  CM-INSURED-JOINT-AGE          PIC 99.
   458         16  CM-JOINT-INSURED-NAME.
   459             20  CM-JT-LAST-NAME           PIC X(15).
   460             20  CM-JT-FIRST-NAME.
   461                 24  CM-JT-1ST-INIT        PIC X.
   462                 24  FILLER                PIC X(9).
   463             20  CM-JT-INITIAL             PIC X.
   464
   465     12  CM-LIFE-DATA.
   466         16  CM-LF-BENEFIT-CD              PIC XX.
   467         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   468         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   469         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   470         16  CM-LF-DEV-CODE                PIC XXX.
   471         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   472         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   473         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   474         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   475         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   476         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   477         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  10
* SOCK03.cbl
   478         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   479         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   480         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   481         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   482         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   483         16  cm-temp-epiq                  pic xx.
   484             88  EPIQ-CLASS                  value 'EQ'.
   485*        16  FILLER                        PIC XX.
   486
   487     12  CM-AH-DATA.
   488         16  CM-AH-BENEFIT-CD              PIC XX.
   489         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   490         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   491         16  CM-AH-DEV-CODE                PIC XXX.
   492         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   493         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   494         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   495         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   496         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   497         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   498         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   499         16  CM-AH-PAID-THRU-DT            PIC XX.
   500             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   501         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   502         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   503         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   504         16  FILLER                        PIC X.
   505
   506     12  CM-LOAN-INFORMATION.
   507         16  CM-LIVES                      PIC S9(7)     COMP-3.
   508         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   509                                           PIC S9(5)V99  COMP-3.
   510         16  CM-BILLED                     PIC S9(7)     COMP-3.
   511         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   512         16  CM-PAY-FREQUENCY              PIC S99.
   513         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   514         16  CM-RATE-CLASS                 PIC XX.
   515         16  CM-BENEFICIARY                PIC X(25).
   516         16  CM-POLICY-FORM-NO             PIC X(12).
   517         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   518         16  CM-LAST-ADD-ON-DT             PIC XX.
   519         16  CM-DEDUCTIBLE-AMOUNTS.
   520             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   521             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   522         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   523             20  CM-RESIDENT-STATE         PIC XX.
   524             20  CM-RATE-CODE              PIC X(4).
   525             20  FILLER                    PIC XX.
   526         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   527             20  CM-LOAN-OFFICER           PIC X(5).
   528             20  FILLER                    PIC XXX.
   529         16  CM-CSR-CODE                   PIC XXX.
   530         16  CM-UNDERWRITING-CODE          PIC X.
   531             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   532         16  CM-POST-CARD-IND              PIC X.
   533         16  CM-REF-INTERFACE-SW           PIC X.
   534         16  CM-PREMIUM-TYPE               PIC X.
   535             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  11
* SOCK03.cbl
   536             88  CM-O-B-COVERAGE              VALUE '2'.
   537             88  CM-OPEN-END                  VALUE '3'.
   538         16  CM-IND-GRP-TYPE               PIC X.
   539             88  CM-INDIVIDUAL                VALUE 'I'.
   540             88  CM-GROUP                     VALUE 'G'.
   541         16  CM-SKIP-CODE                  PIC X.
   542             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   543             88  SKIP-JULY                    VALUE '1'.
   544             88  SKIP-AUGUST                  VALUE '2'.
   545             88  SKIP-SEPTEMBER               VALUE '3'.
   546             88  SKIP-JULY-AUG                VALUE '4'.
   547             88  SKIP-AUG-SEPT                VALUE '5'.
   548             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   549             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   550             88  SKIP-JUNE                    VALUE '8'.
   551             88  SKIP-JUNE-JULY               VALUE '9'.
   552             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   553             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   554         16  CM-PAYMENT-MODE               PIC X.
   555             88  PAY-MONTHLY                  VALUE SPACE.
   556             88  PAY-WEEKLY                   VALUE '1'.
   557             88  PAY-SEMI-MONTHLY             VALUE '2'.
   558             88  PAY-BI-WEEKLY                VALUE '3'.
   559             88  PAY-SEMI-ANUALLY             VALUE '4'.
   560         16  CM-LOAN-NUMBER                PIC X(8).
   561         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   562         16  CM-OLD-LOF                    PIC XXX.
   563*        16  CM-LOAN-OFFICER               PIC XXX.
   564         16  CM-REIN-TABLE                 PIC XXX.
   565         16  CM-SPECIAL-REIN-CODE          PIC X.
   566         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   567         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   568         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   569
   570     12  CM-STATUS-DATA.
   571         16  CM-ENTRY-STATUS               PIC X.
   572         16  CM-ENTRY-DT                   PIC XX.
   573
   574         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   575         16  CM-LF-CANCEL-DT               PIC XX.
   576         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   577
   578         16  CM-LF-STATUS-AT-DEATH         PIC X.
   579         16  CM-LF-DEATH-DT                PIC XX.
   580         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   581
   582         16  CM-LF-CURRENT-STATUS          PIC X.
   583             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   584                                                'M' '4' '5' '9'.
   585             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   586             88  CM-LF-POLICY-PENDING         VALUE '2'.
   587             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   588             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   589             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   590             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   591             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   592             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   593             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  12
* SOCK03.cbl
   594             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   595             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   596             88  CM-LF-DECLINED               VALUE 'D'.
   597             88  CM-LF-VOIDED                 VALUE 'V'.
   598
   599         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   600         16  CM-AH-CANCEL-DT               PIC XX.
   601         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   602
   603         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   604         16  CM-AH-SETTLEMENT-DT           PIC XX.
   605         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   606
   607         16  CM-AH-CURRENT-STATUS          PIC X.
   608             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   609                                                'M' '4' '5' '9'.
   610             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   611             88  CM-AH-POLICY-PENDING         VALUE '2'.
   612             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   613             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   614             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   615             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   616             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   617             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   618             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   619             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   620             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   621             88  CM-AH-DECLINED               VALUE 'D'.
   622             88  CM-AH-VOIDED                 VALUE 'V'.
   623
   624         16  CM-CLAIM-INTERFACE-SW         PIC X.
   625             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   626             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   627             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   628         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   629
   630         16  CM-ENTRY-BATCH                PIC X(6).
   631         16  CM-LF-EXIT-BATCH              PIC X(6).
   632         16  CM-AH-EXIT-BATCH              PIC X(6).
   633         16  CM-LAST-MONTH-END             PIC XX.
   634
   635     12  CM-NOTE-SW                        PIC X.
   636         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   637         88  CERT-NOTES-PRESENT               VALUE '1'.
   638         88  BILLING-NOTES-PRESENT            VALUE '2'.
   639         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   640         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   641         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   642         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   643         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   644     12  CM-COMP-EXCP-SW                   PIC X.
   645         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   646         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   647     12  CM-INSURED-ADDRESS-SW             PIC X.
   648         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   649         88  INSURED-ADDR-PRESENT             VALUE '1'.
   650
   651*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  13
* SOCK03.cbl
   652     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   653     12  FILLER                            PIC X.
   654
   655*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   656     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   657     12  FILLER                            PIC X.
   658*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   659     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   660
   661     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   662         88  CERT-ADDED-BATCH                 VALUE ' '.
   663         88  CERT-ADDED-ONLINE                VALUE '1'.
   664         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   665         88  CERT-PURGED-OFFLINE              VALUE '3'.
   666         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   667     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   668         88  CERT-AS-LOADED                   VALUE ' '.
   669         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   670         88  CERT-CLAIM-ONLINE                VALUE '2'.
   671         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   672         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   673         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   674         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   675         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   676
   677     12  CM-ACCOUNT-COMM-PCTS.
   678         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   679         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   680
   681     12  CM-USER-FIELD                     PIC X.
   682     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   683     12  CM-CLP-STATE                      PIC XX.
   684     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   685     12  CM-USER-RESERVED                  PIC XXX.
   686     12  FILLER REDEFINES CM-USER-RESERVED.
   687         16  CM-AH-CLASS-CD                PIC XX.
   688         16  F                             PIC X.
   689******************************************************************
   690*                                 COPY ELCMSTR.
   691******************************************************************
   692*                                                                *
   693*                            ELCMSTR.                            *
   694*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   695*                            VMOD=2.012                          *
   696*                                                                *
   697*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   698*                                                                *
   699*   FILE TYPE = VSAM,KSDS                                        *
   700*   RECORD SIZE = 350  RECFORM = FIXED                           *
   701*                                                                *
   702*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   703*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   704*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   705*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   706*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   707*                                                 RKP=75,LEN=21  *
   708*                                                                *
   709*   **** NOTE ****                                               *
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  14
* SOCK03.cbl
   710*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   711*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   712*                                                                *
   713*   LOG = YES                                                    *
   714*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   715******************************************************************
   716*                   C H A N G E   L O G
   717*
   718* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   719*-----------------------------------------------------------------
   720*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   721* EFFECTIVE    NUMBER
   722*-----------------------------------------------------------------
   723* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   724* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   725* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   726* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   727* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   728* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   729* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   730******************************************************************
   731 01  CLAIM-MASTER.
   732     12  CL-RECORD-ID                PIC XX.
   733         88  VALID-CL-ID         VALUE 'CL'.
   734
   735     12  CL-CONTROL-PRIMARY.
   736         16  CL-COMPANY-CD           PIC X.
   737         16  CL-CARRIER              PIC X.
   738         16  CL-CLAIM-NO             PIC X(7).
   739         16  CL-CERT-NO.
   740             20  CL-CERT-PRIME       PIC X(10).
   741             20  CL-CERT-SFX         PIC X.
   742
   743     12  CL-CONTROL-BY-NAME.
   744         16  CL-COMPANY-CD-A1        PIC X.
   745         16  CL-INSURED-LAST-NAME    PIC X(15).
   746         16  CL-INSURED-NAME.
   747             20  CL-INSURED-1ST-NAME PIC X(12).
   748             20  CL-INSURED-MID-INIT PIC X.
   749
   750     12  CL-CONTROL-BY-SSN.
   751         16  CL-COMPANY-CD-A2        PIC X.
   752         16  CL-SOC-SEC-NO.
   753             20  CL-SSN-STATE        PIC XX.
   754             20  CL-SSN-ACCOUNT      PIC X(6).
   755             20  CL-SSN-LN3          PIC X(3).
   756
   757     12  CL-CONTROL-BY-CERT-NO.
   758         16  CL-COMPANY-CD-A4        PIC X.
   759         16  CL-CERT-NO-A4.
   760             20  CL-CERT-A4-PRIME    PIC X(10).
   761             20  CL-CERT-A4-SFX      PIC X.
   762
   763     12  CL-CONTROL-BY-CCN.
   764         16  CL-COMPANY-CD-A5        PIC X.
   765         16  CL-CCN-A5.
   766             20  CL-CCN.
   767                 24  CL-CCN-PREFIX-A5 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  15
* SOCK03.cbl
   768                 24  CL-CCN-PRIME-A5 PIC X(12).
   769             20  CL-CCN-FILLER-A5    PIC X(4).
   770
   771     12  CL-INSURED-PROFILE-DATA.
   772         16  CL-INSURED-BIRTH-DT     PIC XX.
   773         16  CL-INSURED-SEX-CD       PIC X.
   774             88  INSURED-IS-MALE        VALUE 'M'.
   775             88  INSURED-IS-FEMALE      VALUE 'F'.
   776             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   777         16  CL-INSURED-OCC-CD       PIC X(6).
   778         16  FILLER                  PIC X(5).
   779
   780     12  CL-PROCESSING-INFO.
   781         16  CL-PROCESSOR-ID         PIC X(4).
   782         16  CL-CLAIM-STATUS         PIC X.
   783             88  CLAIM-IS-OPEN          VALUE 'O'.
   784             88  CLAIM-IS-CLOSED        VALUE 'C'.
   785         16  CL-CLAIM-TYPE           PIC X.
   786*            88  AH-CLAIM               VALUE 'A'.
   787*            88  LIFE-CLAIM             VALUE 'L'.
   788*            88  PROPERTY-CLAIM         VALUE 'P'.
   789*            88  IUI-CLAIM              VALUE 'I'.
   790*            88  GAP-CLAIM              VALUE 'G'.
   791*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   792*            88  OTHER-CLAIM            VALUE 'O'.
   793         16  CL-CLAIM-PREM-TYPE      PIC X.
   794             88  SINGLE-PREMIUM         VALUE '1'.
   795             88  O-B-COVERAGE           VALUE '2'.
   796             88  OPEN-END-COVERAGE      VALUE '3'.
   797         16  CL-INCURRED-DT          PIC XX.
   798         16  CL-REPORTED-DT          PIC XX.
   799         16  CL-FILE-ESTABLISH-DT    PIC XX.
   800         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   801         16  CL-LAST-PMT-DT          PIC XX.
   802         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   803         16  CL-PAID-THRU-DT         PIC XX.
   804         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   805         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   806         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   807         16  CL-PMT-CALC-METHOD      PIC X.
   808             88  CL-360-DAY-YR          VALUE '1'.
   809             88  CL-365-DAY-YR          VALUE '2'.
   810             88  CL-FULL-MONTHS         VALUE '3'.
   811         16  CL-CAUSE-CD             PIC X(6).
   812
   813         16  CL-PRIME-CERT-NO.
   814             20  CL-PRIME-CERT-PRIME PIC X(10).
   815             20  CL-PRIME-CERT-SFX   PIC X.
   816
   817         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   818             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   819             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   820
   821         16  CL-MICROFILM-NO         PIC X(10).
   822         16  FILLER REDEFINES CL-MICROFILM-NO.
   823             20  CL-BENEFIT-PERIOD   PIC 99.
   824             20  FILLER              PIC X(8).
   825         16  CL-PROG-FORM-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  16
* SOCK03.cbl
   826         16  CL-LAST-ADD-ON-DT       PIC XX.
   827
   828         16  CL-LAST-REOPEN-DT       PIC XX.
   829         16  CL-LAST-CLOSE-DT        PIC XX.
   830         16  CL-LAST-CLOSE-REASON    PIC X(01).
   831             88  FINAL-PAID             VALUE '1'.
   832             88  CLAIM-DENIED           VALUE '2'.
   833             88  AUTO-CLOSE             VALUE '3'.
   834             88  MANUAL-CLOSE           VALUE '4'.
   835             88  BENEFITS-CHANGED       VALUE 'C'.
   836             88  SETUP-ERRORS           VALUE 'E'.
   837         16  CL-ASSOC-CERT-SEQU      PIC S99.
   838         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   839         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   840             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   841         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   842         16  FILLER                  PIC X.
   843
   844     12  CL-CERTIFICATE-DATA.
   845         16  CL-CERT-ORIGIN          PIC X.
   846             88  CERT-WAS-ONLINE        VALUE '1'.
   847             88  CERT-WAS-CREATED       VALUE '2'.
   848             88  COVERAGE-WAS-ADDED     VALUE '3'.
   849         16  CL-CERT-KEY-DATA.
   850             20  CL-CERT-CARRIER     PIC X.
   851             20  CL-CERT-GROUPING    PIC X(6).
   852             20  CL-CERT-STATE       PIC XX.
   853             20  CL-CERT-ACCOUNT.
   854                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   855                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   856             20  CL-CERT-EFF-DT      PIC XX.
   857
   858     12  CL-STATUS-CONTROLS.
   859         16  CL-PRIORITY-CD          PIC X.
   860             88  CONFIDENTIAL-DATA      VALUE '8'.
   861             88  HIGHEST-PRIORITY       VALUE '9'.
   862         16  CL-SUPV-ATTN-CD         PIC X.
   863             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   864             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   865         16  CL-PURGED-DT            PIC XX.
   866         16  CL-RESTORED-DT          PIC XX.
   867         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   868         16  CL-NEXT-RESEND-DT       PIC XX.
   869         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   870         16  CL-CRITICAL-PERIOD      PIC 99.
   871*        16  FILLER                  PIC XX.
   872         16  CL-LAST-MAINT-DT        PIC XX.
   873         16  CL-LAST-MAINT-USER      PIC X(4).
   874         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   875         16  CL-LAST-MAINT-TYPE      PIC X.
   876             88  CLAIM-SET-UP           VALUE ' '.
   877             88  PAYMENT-MADE           VALUE '1'.
   878             88  LETTER-SENT            VALUE '2'.
   879             88  MASTER-WAS-ALTERED     VALUE '3'.
   880             88  MASTER-WAS-RESTORED    VALUE '4'.
   881             88  INCURRED-DATE-CHANGED  VALUE '5'.
   882             88  FILE-CONVERTED         VALUE '6'.
   883             88  CHANGE-OF-BENEFITS     VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  17
* SOCK03.cbl
   884             88  ERROR-CORRECTION       VALUE 'E'.
   885         16  CL-RELATED-CLAIM-NO     PIC X(7).
   886         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   887         16  CL-BENEFICIARY          PIC X(10).
   888         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   889         16  CL-DENIAL-TYPE          PIC X.
   890             88  CL-TYPE-DENIAL          VALUE '1'.
   891             88  CL-TYPE-RESCISSION      VALUE '2'.
   892             88  CL-TYPE-REFORMATION     VALUE '3'.
   893             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   894             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   895         16  CL-NO-OF-EXTENSIONS     PIC 99.
   896         16  filler                  pic x(3).
   897*        16  CL-CRIT-PER-RECURRENT   PIC X.
   898*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   899*        16  CL-RTW-DT               PIC XX.
   900
   901     12  CL-TRAILER-CONTROLS.
   902         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   903             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   904             88  CL-LAST-TRL-AVAIL      VALUE +100.
   905             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   906         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   907         16  FILLER                  PIC XX.
   908         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   909         16  CL-ADDRESS-TRAILER-CNT.
   910             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   911                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   912             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   913                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   914             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   915                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   916             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   917                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   918             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   919                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   920             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   921                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   922             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   923                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   924
   925     12  CL-CV-REFERENCE-NO.
   926         16  CL-CV-REFNO-PRIME       PIC X(18).
   927         16  CL-CV-REFNO-SFX         PIC XX.
   928
   929     12  CL-FILE-LOCATION            PIC X(4).
   930
   931     12  CL-PROCESS-ERRORS.
   932         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   933             88  NO-FATAL-ERRORS        VALUE ZERO.
   934         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   935             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   936
   937     12  CL-PRODUCT-CD               PIC X.
   938
   939     12  CL-CURRENT-KEY-DATA.
   940         16  CL-CURRENT-CARRIER      PIC X.
   941         16  CL-CURRENT-GROUPING     PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  18
* SOCK03.cbl
   942         16  CL-CURRENT-STATE        PIC XX.
   943         16  CL-CURRENT-ACCOUNT      PIC X(10).
   944
   945     12  CL-ASSOCIATES               PIC X.
   946         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   947         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   948         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   949         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   950
   951     12  CL-ACTIVITY-CODE            PIC 99.
   952     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   953     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   954
   955     12  CL-LAPSE-REPORT-CODE        PIC 9.
   956     12  CL-LAG-REPORT-CODE          PIC 9.
   957     12  CL-LOAN-TYPE                PIC XX.
   958     12  CL-LEGAL-STATE              PIC XX.
   959
   960     12  CL-YESNOSW                  PIC X.
   961     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   962         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   963         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   964         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   965     12  cl-insured-type             pic x.
   966         88  cl-claim-on-primary         value 'P'.
   967         88  cl-claim-on-co-borrower     value 'C'.
   968     12  cl-benefit-expiration-dt    PIC XX.
   969*                                 COPY ERCPDEF.
   970******************************************************************
   971*                                                                *
   972*                                                                *
   973*                            ERCPDEF.                            *
   974*                                                                *
   975*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   976*                                                                *
   977*    FILE TYPE = VSAM,KSDS                                       *
   978*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   979*                                                                *
   980*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   981*                                                                *
   982*    LOG = YES                                                   *
   983*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   984******************************************************************
   985*                   C H A N G E   L O G
   986*
   987* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   988*-----------------------------------------------------------------
   989*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   990* EFFECTIVE    NUMBER
   991*-----------------------------------------------------------------
   992* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   993* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   994* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   995* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   996******************************************************************
   997 01  PRODUCT-MASTER.
   998    12  PD-RECORD-ID                 PIC X(02).
   999        88  VALID-PD-ID                  VALUE 'PD'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  19
* SOCK03.cbl
  1000    12  PD-CONTROL-PRIMARY.
  1001        16  PD-COMPANY-CD            PIC X.
  1002        16  PD-STATE                 PIC XX.
  1003        16  PD-PRODUCT-CD            PIC XXX.
  1004        16  PD-FILLER                PIC X(7).
  1005        16  PD-BEN-TYPE              PIC X.
  1006        16  PD-BEN-CODE              PIC XX.
  1007        16  PD-PROD-EXP-DT           PIC XX.
  1008    12  FILLER                       PIC X(50).
  1009    12  PD-PRODUCT-DATA OCCURS 8.
  1010        16  PD-PROD-CODE             PIC X.
  1011            88  PD-PROD-LIFE           VALUE 'L'.
  1012            88  PD-PROD-PROP           VALUE 'P'.
  1013            88  PD-PROD-AH             VALUE 'A'.
  1014            88  PD-PROD-IU             VALUE 'I'.
  1015            88  PD-PROD-GAP            VALUE 'G'.
  1016            88  PD-PROD-FAML           VALUE 'F'.
  1017            88  PD-PROD-OTH            VALUE 'O'.
  1018        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  1019        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  1020        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  1021        16  PD-MAX-TERM              PIC S999        COMP-3.
  1022        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  1023        16  FILLER                   PIC X.
  1024        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  1025        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  1026        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  1027        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  1028        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  1029        16  PD-REC-CRIT-PERIOD       PIC 99.
  1030        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  1031            20  PD-RECURRING-YN      PIC X.
  1032            20  FILLER               PIC X.
  1033        16  PD-RTW-MOS               PIC 99.
  1034        16  PD-MAX-EXTENSION         PIC 99.
  1035        16  pd-ben-pct               pic sv999 comp-3.
  1036*       16  FILLER                   PIC XX.
  1037    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  1038    12  PD-TERM-LIMITS OCCURS 15.
  1039        16  PD-LOW-TERM              PIC S999        COMP-3.
  1040        16  PD-HI-TERM               PIC S999        COMP-3.
  1041*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  1042    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  1043        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  1044        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  1045    12  PD-EARN-FACTORS.
  1046        16  FILLER OCCURS 15.
  1047            20  FILLER OCCURS 15.
  1048                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1049    12  PD-PRODUCT-DESC              PIC X(80).
  1050    12  PD-TRUNCATED                 PIC X.
  1051    12  FILLER                       PIC X(59).
  1052    12  PD-MAINT-INFORMATION.
  1053        16  PD-LAST-MAINT-DT         PIC X(02).
  1054        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1055        16  PD-LAST-MAINT-BY         PIC X(04).
  1056*                                 COPY ERCCTBL.
  1057******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  20
* SOCK03.cbl
  1058*                                                                *
  1059*                                                                *
  1060*                            ERCCTBL                             *
  1061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1062*                            VMOD=2.003
  1063*                                                                *
  1064*   ONLINE CREDIT SYSTEM                                         *
  1065*                                                                *
  1066*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1067*                                                                *
  1068*   FILE TYPE = VSAM,KSDS                                        *
  1069*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1070*                                                                *
  1071*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1072*       ALTERNATE PATH = NONE                                    *
  1073*                                                                *
  1074*   LOG = NO                                                     *
  1075*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1076*                                                                *
  1077*                                                                *
  1078******************************************************************
  1079
  1080 01  COMM-TABLE-RECORD.
  1081     12  CT-RECORD-ID                      PIC XX.
  1082         88  VALID-CT-ID                      VALUE 'CT'.
  1083
  1084     12  CT-CONTROL-PRIMARY.
  1085         16  CT-COMPANY-CD                 PIC X.
  1086         16  CT-TABLE                      PIC XXX.
  1087         16  CT-CNTRL-2.
  1088             20  CT-BEN-TYPE               PIC X.
  1089             20  CT-BEN-CODE               PIC XX.
  1090
  1091     12  CT-MAINT-INFORMATION.
  1092         16  CT-LAST-MAINT-DT              PIC XX.
  1093         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1094         16  CT-LAST-MAINT-USER            PIC X(4).
  1095         16  FILLER                        PIC X(31).
  1096
  1097     12  CT-LIMITS.
  1098         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1099
  1100         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1101
  1102         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1103
  1104     12  CT-RATES.
  1105         16  CT-RTX          OCCURS 27 TIMES.
  1106             20  CT-RT                     PIC SV9(5)     COMP-3.
  1107             20  CT-RT-R   REDEFINES
  1108                 CT-RT                     PIC XXX.
  1109
  1110     12  FILLER                            PIC  X(42).
  1111
  1112******************************************************************
  1113*                                 COPY ELCCNTL.
  1114******************************************************************
  1115*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  21
* SOCK03.cbl
  1116*                                                                *
  1117*                            ELCCNTL.                            *
  1118*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1119*                            VMOD=2.059                          *
  1120*                                                                *
  1121*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1122*                                                                *
  1123*   FILE TYPE = VSAM,KSDS                                        *
  1124*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1125*                                                                *
  1126*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1127*       ALTERNATE INDEX = NONE                                   *
  1128*                                                                *
  1129*   LOG = YES                                                    *
  1130*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1131******************************************************************
  1132*                   C H A N G E   L O G
  1133*
  1134* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1135*-----------------------------------------------------------------
  1136*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1137* EFFECTIVE    NUMBER
  1138*-----------------------------------------------------------------
  1139* 082503                   PEMA  ADD BENEFIT GROUP
  1140* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1141* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1142* 092705    2005050300006  PEMA  ADD SPP LEASES
  1143* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1144* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1145* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1146* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1147* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1148* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1149* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1150* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1151* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1152* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1153* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1154******************************************************************
  1155*
  1156 01  CONTROL-FILE.
  1157     12  CF-RECORD-ID                       PIC XX.
  1158         88  VALID-CF-ID                        VALUE 'CF'.
  1159
  1160     12  CF-CONTROL-PRIMARY.
  1161         16  CF-COMPANY-ID                  PIC XXX.
  1162         16  CF-RECORD-TYPE                 PIC X.
  1163             88  CF-COMPANY-MASTER              VALUE '1'.
  1164             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1165             88  CF-STATE-MASTER                VALUE '3'.
  1166             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1167             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1168             88  CF-CARRIER-MASTER              VALUE '6'.
  1169             88  CF-MORTALITY-MASTER            VALUE '7'.
  1170             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1171             88  CF-TERMINAL-MASTER             VALUE '9'.
  1172             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1173             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  22
* SOCK03.cbl
  1174             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1175             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1176             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1177             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1178             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1179             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1180             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1181         16  CF-ACCESS-CD-GENL              PIC X(4).
  1182         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1183             20  CF-PROCESSOR               PIC X(4).
  1184         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1185             20  CF-STATE-CODE              PIC XX.
  1186             20  FILLER                     PIC XX.
  1187         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1188             20  FILLER                     PIC XX.
  1189             20  CF-HI-BEN-IN-REC           PIC XX.
  1190         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1191             20  FILLER                     PIC XXX.
  1192             20  CF-CARRIER-CNTL            PIC X.
  1193         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1194             20  FILLER                     PIC XX.
  1195             20  CF-HI-TYPE-IN-REC          PIC 99.
  1196         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1197             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1198                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1199             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1200             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1201         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1202             20  FILLER                     PIC X.
  1203             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1204         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1205             20  FILLER                     PIC XX.
  1206             20  CF-MORTGAGE-PLAN           PIC XX.
  1207         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1208
  1209     12  CF-LAST-MAINT-DT                   PIC XX.
  1210     12  CF-LAST-MAINT-BY                   PIC X(4).
  1211     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1212
  1213     12  CF-RECORD-BODY                     PIC X(728).
  1214
  1215
  1216****************************************************************
  1217*             COMPANY MASTER RECORD                            *
  1218****************************************************************
  1219
  1220     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1221         16  CF-COMPANY-ADDRESS.
  1222             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1223             20  CF-CL-IN-CARE-OF           PIC X(30).
  1224             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1225             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1226             20  CF-CL-CITY-STATE           PIC X(30).
  1227             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1228             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1229         16  CF-COMPANY-CD                  PIC X.
  1230         16  CF-COMPANY-PASSWORD            PIC X(8).
  1231         16  CF-SECURITY-OPTION             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  23
* SOCK03.cbl
  1232             88  ALL-SECURITY                   VALUE '1'.
  1233             88  COMPANY-VERIFY                 VALUE '2'.
  1234             88  PROCESSOR-VERIFY               VALUE '3'.
  1235             88  NO-SECURITY                    VALUE '4'.
  1236             88  ALL-BUT-TERM                   VALUE '5'.
  1237         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1238             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1239         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1240             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1241         16  CF-INFORCE-LOCATION            PIC X.
  1242             88  CERTS-ARE-ONLINE               VALUE '1'.
  1243             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1244             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1245         16  CF-LOWER-CASE-LETTERS          PIC X.
  1246         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1247             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1248             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1249             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1250             88  CF-ACCNT-CNTL                  VALUE '3'.
  1251             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1252
  1253         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1254         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1255
  1256         16  CF-LGX-CREDIT-USER             PIC X.
  1257             88  CO-IS-NOT-USER                 VALUE 'N'.
  1258             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1259
  1260         16 CF-CREDIT-CALC-CODES.
  1261             20  CF-CR-REM-TERM-CALC PIC X.
  1262               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1263               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1264               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1265               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1266               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1267               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1268               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1269             20  CF-CR-R78-METHOD           PIC X.
  1270               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1271               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1272
  1273         16  CF-CLAIM-CONTROL-COUNTS.
  1274             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1275                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1276
  1277             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1278                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1279
  1280             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1281                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1282
  1283             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1284                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1285
  1286         16  CF-CURRENT-MONTH-END           PIC XX.
  1287
  1288         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1289             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  24
* SOCK03.cbl
  1290             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1291             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1292             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1293                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1294                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1295             20  CF-CO-PREM-REJECT-SW       PIC X.
  1296                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1297                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1298             20  CF-CO-REF-REJECT-SW        PIC X.
  1299                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1300                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1301
  1302         16  CF-CO-REPORTING-DT             PIC XX.
  1303         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1304         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1305           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1306           88  CF-CO-MONTH-END                  VALUE '1'.
  1307
  1308         16  CF-LGX-CLAIM-USER              PIC X.
  1309             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1310             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1311
  1312         16  CF-CREDIT-EDIT-CONTROLS.
  1313             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1314             20  CF-MIN-AGE                 PIC 99.
  1315             20  CF-DEFAULT-AGE             PIC 99.
  1316             20  CF-MIN-TERM                PIC S999      COMP-3.
  1317             20  CF-MAX-TERM                PIC S999      COMP-3.
  1318             20  CF-DEFAULT-SEX             PIC X.
  1319             20  CF-JOINT-AGE-INPUT         PIC X.
  1320                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1321             20  CF-BIRTH-DATE-INPUT        PIC X.
  1322                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1323             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1324                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1325                 88  CF-ZERO-CARRIER            VALUE '1'.
  1326                 88  CF-ZERO-GROUPING           VALUE '2'.
  1327                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1328             20  CF-EDIT-SW                 PIC X.
  1329                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1330             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1331             20  CF-CR-PR-METHOD            PIC X.
  1332               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1333               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1334             20  FILLER                     PIC X.
  1335
  1336         16  CF-CREDIT-MISC-CONTROLS.
  1337             20  CF-REIN-TABLE-SW           PIC X.
  1338                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1339             20  CF-COMP-TABLE-SW           PIC X.
  1340                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1341             20  CF-EXPERIENCE-RETENTION-AGE
  1342                                            PIC S9        COMP-3.
  1343             20  CF-CONVERSION-DT           PIC XX.
  1344             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1345             20  CF-RUN-FREQUENCY-SW        PIC X.
  1346                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1347                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  25
* SOCK03.cbl
  1348
  1349             20  CF-CR-CHECK-NO-CONTROL.
  1350                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1351                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1352                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1353                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1354                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1355                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1356
  1357                 24  CF-CR-CHECK-COUNT       REDEFINES
  1358                     CF-CR-CHECK-COUNTER      PIC X(4).
  1359
  1360                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1361                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1362
  1363                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1364                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1365                 24  CF-MAIL-PROCESSING       PIC X.
  1366                     88  MAIL-PROCESSING          VALUE 'Y'.
  1367
  1368         16  CF-MISC-SYSTEM-CONTROL.
  1369             20  CF-SYSTEM-C                 PIC X.
  1370                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1371             20  CF-SYSTEM-D                 PIC X.
  1372                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1373             20  CF-SOC-SEC-NO-SW            PIC X.
  1374                 88  SOC-SEC-NO-USED             VALUE '1'.
  1375             20  CF-MEMBER-NO-SW             PIC X.
  1376                 88  MEMBER-NO-USED              VALUE '1'.
  1377             20  CF-TAX-ID-NUMBER            PIC X(11).
  1378             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1379             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1380                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1381                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1382                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1383                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1384             20  CF-SYSTEM-E                 PIC X.
  1385                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1386
  1387         16  CF-LGX-LIFE-USER               PIC X.
  1388             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1389             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1390
  1391         16  CF-CR-MONTH-END-DT             PIC XX.
  1392
  1393         16  CF-FILE-MAINT-DATES.
  1394             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1395                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1396             20  CF-LAST-BATCH       REDEFINES
  1397                 CF-LAST-BATCH-NO               PIC X(4).
  1398             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1399             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1400             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1401             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1402             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1403             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1404             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1405             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  26
* SOCK03.cbl
  1406             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1407             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1408
  1409         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1410         16  FILLER                         PIC X.
  1411
  1412         16  CF-ALT-MORT-CODE               PIC X(4).
  1413         16  CF-MEMBER-CAPTION              PIC X(10).
  1414
  1415         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1416             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1417             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1418             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1419             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1420             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1421
  1422         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1423
  1424         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1425         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1426         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1427         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1428
  1429         16  CF-AH-OVERRIDE-L1              PIC X.
  1430         16  CF-AH-OVERRIDE-L2              PIC XX.
  1431         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1432         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1433
  1434         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1435         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1436
  1437         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1438         16  CF-AR-LAST-EL860-DT            PIC XX.
  1439         16  CF-MP-MONTH-END-DT             PIC XX.
  1440
  1441         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1442         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1443             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1444
  1445         16  CF-AR-MONTH-END-DT             PIC XX.
  1446
  1447         16  CF-CRDTCRD-USER                PIC X.
  1448             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1449             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1450
  1451         16  CF-CC-MONTH-END-DT             PIC XX.
  1452
  1453         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1454
  1455         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1456             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1457             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1458             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1459         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1460         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1461         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1462         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1463             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  27
* SOCK03.cbl
  1464             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1465         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1466         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1467         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1468             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1469         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1470
  1471         16  CF-CL-ZIP-CODE.
  1472             20  CF-CL-ZIP-PRIME.
  1473                 24  CF-CL-ZIP-1ST          PIC X.
  1474                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1475                 24  FILLER                 PIC X(4).
  1476             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1477         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1478             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1479             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1480             20  FILLER                     PIC XXX.
  1481
  1482         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1483         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1484         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1485         16  CF-CO-OPTION-START-DATE        PIC XX.
  1486         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1487           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1488                                                      '3' '4'.
  1489           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1490           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1491           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1492           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1493           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1494           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1495
  1496         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1497
  1498         16  CF-PAYMENT-APPROVAL-LEVELS.
  1499             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1500             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1501             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1502             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1503             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1504             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1505
  1506         16  CF-END-USER-REPORTING-USER     PIC X.
  1507             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1508             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1509
  1510         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1511             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1512             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1513
  1514         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1515
  1516         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1517         16  FILLER                         PIC X.
  1518
  1519         16  CF-CREDIT-ARCHIVE-CNTL.
  1520             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1521             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  28
* SOCK03.cbl
  1522             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1523
  1524         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1525
  1526         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1527             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1528             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1529
  1530         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1531             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1532             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1533
  1534         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1535
  1536         16  CF-CO-ACH-ID-CODE              PIC  X.
  1537             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1538             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1539             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1540         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1541         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1542         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1543         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1544         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1545         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1546         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1547         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1548         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1549                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1550         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1551                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1552
  1553         16  CF-CO-OVER-SHORT.
  1554             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1555             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1556
  1557*         16  FILLER                         PIC X(102).
  1558         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1559             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1560             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1561
  1562         16  CF-AH-APPROVAL-DAYS.
  1563             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1564             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1565             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1566             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1567
  1568         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1569
  1570         16  CF-APPROV-LEV-5.
  1571             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1572             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1573             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1574
  1575         16  FILLER                         PIC X(68).
  1576****************************************************************
  1577*             PROCESSOR/USER RECORD                            *
  1578****************************************************************
  1579
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  29
* SOCK03.cbl
  1580     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1581         16  CF-PROCESSOR-NAME              PIC X(30).
  1582         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1583         16  CF-PROCESSOR-TITLE             PIC X(26).
  1584         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1585                 88  MESSAGE-YES                VALUE 'Y'.
  1586                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1587
  1588*****************************************************
  1589****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1590****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1591****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1592****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1593*****************************************************
  1594
  1595         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1596             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1597             20  CF-APPLICATION-FORCE       PIC X.
  1598             20  CF-INDIVIDUAL-APP.
  1599                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1600                     28  CF-BROWSE-APP      PIC X.
  1601                     28  CF-UPDATE-APP      PIC X.
  1602
  1603         16  CF-CURRENT-TERM-ON             PIC X(4).
  1604         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1605             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1606             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1607             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1608             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1609             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1610             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1611             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1612         16  CF-PROCESSOR-CARRIER           PIC X.
  1613             88  NO-CARRIER-SECURITY            VALUE ' '.
  1614         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1615             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1616         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1617             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1618         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1619             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1620
  1621         16  CF-PROC-SYS-ACCESS-SW.
  1622             20  CF-PROC-CREDIT-CLAIMS-SW.
  1623                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1624                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1625                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1626                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1627             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1628                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1629                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1630             20  CF-PROC-LIFE-GNRLDGR-SW.
  1631                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1632                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1633                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1634                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1635             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1636                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1637                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  30
* SOCK03.cbl
  1638         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1639             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1640             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1641         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1642
  1643         16  CF-APPROVAL-LEVEL                  PIC X.
  1644             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1645             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1646             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1647             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1648             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1649
  1650         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1651
  1652         16  CF-LANGUAGE-TYPE                   PIC X.
  1653             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1654             88  CF-LANG-IS-FR                      VALUE 'F'.
  1655
  1656         16  CF-CSR-IND                         PIC X.
  1657         16  FILLER                             PIC X(239).
  1658
  1659****************************************************************
  1660*             PROCESSOR/REMINDERS RECORD                       *
  1661****************************************************************
  1662
  1663     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1664         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1665             20  CF-START-REMIND-DT         PIC XX.
  1666             20  CF-END-REMIND-DT           PIC XX.
  1667             20  CF-REMINDER-TEXT           PIC X(50).
  1668         16  FILLER                         PIC X(296).
  1669
  1670
  1671****************************************************************
  1672*             STATE MASTER RECORD                              *
  1673****************************************************************
  1674
  1675     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1676         16  CF-STATE-ABBREVIATION          PIC XX.
  1677         16  CF-STATE-NAME                  PIC X(25).
  1678         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1679         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1680             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1681             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1682             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1683             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1684                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1685                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1686             20  CF-ST-PREM-REJECT-SW       PIC X.
  1687                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1688                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1689             20  CF-ST-REF-REJECT-SW        PIC X.
  1690                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1691                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1692         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1693         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1694         16  CF-ST-REFUND-RULES.
  1695             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  31
* SOCK03.cbl
  1696             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1697             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1698         16  CF-ST-FST-PMT-EXTENSION.
  1699             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1700             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1701                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1702                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1703                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1704                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1705         16  CF-ST-STATE-CALL.
  1706             20  CF-ST-CALL-UNEARNED        PIC X.
  1707             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1708             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1709         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1710             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1711             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1712         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1713         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1714         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1715         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1716         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1717         16  FILLER                         PIC X.
  1718         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1719             20  CF-ST-BENEFIT-CD           PIC XX.
  1720             20  CF-ST-BENEFIT-KIND         PIC X.
  1721                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1722                 88  CF-ST-AH-KIND              VALUE 'A'.
  1723             20  CF-ST-REM-TERM-CALC        PIC X.
  1724                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1725                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1726                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1727                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1728                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1729                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1730                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1731                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1732
  1733             20  CF-ST-REFUND-CALC          PIC X.
  1734                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1735                 88  ST-REFD-BY-R78             VALUE '1'.
  1736                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1737                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1738                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1739                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1740                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1741                 88  ST-REFD-UTAH               VALUE '7'.
  1742                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1743                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1744                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1745
  1746             20  CF-ST-EARNING-CALC         PIC X.
  1747                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1748                 88  ST-EARN-BY-R78             VALUE '1'.
  1749                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1750                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1751                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1752                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1753                 88  ST-EARN-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  32
* SOCK03.cbl
  1754                 88  ST-EARN-MEAN               VALUE '8'.
  1755                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1756
  1757             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1758                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1759                 88  ST-OVRD-BY-R78             VALUE '1'.
  1760                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1761                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1762                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1763                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1764                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1765                 88  ST-OVRD-MEAN               VALUE '8'.
  1766                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1767             20  cf-st-extra-periods        pic 9.
  1768*            20  FILLER                     PIC X.
  1769
  1770         16  CF-ST-COMMISSION-CAPS.
  1771             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1772             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1773             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1774             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1775         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1776                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1777                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1778                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1779
  1780         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1781
  1782         16  CF-ST-STATUTORY-INTEREST.
  1783             20  CF-ST-STAT-DATE-FROM       PIC X.
  1784                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1785                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1786             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1787             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1788             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1789             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1790             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1791
  1792         16  CF-ST-OVER-SHORT.
  1793             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1794             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1795
  1796         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1797
  1798         16  CF-ST-RT-CALC                  PIC X.
  1799
  1800         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1801         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1802         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1803         16  CF-ST-RF-LR-CALC               PIC X.
  1804         16  CF-ST-RF-LL-CALC               PIC X.
  1805         16  CF-ST-RF-LN-CALC               PIC X.
  1806         16  CF-ST-RF-AH-CALC               PIC X.
  1807         16  CF-ST-RF-CP-CALC               PIC X.
  1808*        16  FILLER                         PIC X(206).
  1809*CIDMOD         16  FILLER                         PIC X(192).
  1810         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1811             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  33
* SOCK03.cbl
  1812         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1813         16  CF-ST-VFY-2ND-BENE             PIC X.
  1814         16  CF-ST-CAUSAL-STATE             PIC X.
  1815         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1816         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1817         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1818             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1819         16  CF-ST-NET-ONLY-STATE           PIC X.
  1820             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1821         16  cf-commission-cap-required     pic x.
  1822         16  CF-ST-GA-COMMISSION-CAPS.
  1823             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  1824             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  1825             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  1826             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  1827         16  CF-ST-TOT-COMMISSION-CAPS.
  1828             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  1829             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  1830             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  1831             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  1832         16  FILLER                         PIC X(156).
  1833
  1834****************************************************************
  1835*             BENEFIT MASTER RECORD                            *
  1836****************************************************************
  1837
  1838     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1839         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1840             20  CF-BENEFIT-CODE            PIC XX.
  1841             20  CF-BENEFIT-NUMERIC  REDEFINES
  1842                 CF-BENEFIT-CODE            PIC XX.
  1843             20  CF-BENEFIT-ALPHA           PIC XXX.
  1844             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1845             20  CF-BENEFIT-COMMENT         PIC X(10).
  1846
  1847             20  CF-LF-COVERAGE-TYPE        PIC X.
  1848                 88  CF-REDUCING                VALUE 'R'.
  1849                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1850
  1851             20  CF-SPECIAL-CALC-CD         PIC X.
  1852                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1853                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1854                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1855                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1856                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1857                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1858                 88  CF-FARM-PLAN               VALUE 'F'.
  1859                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1860                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1861                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1862                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1863                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1864                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1865                 88  CF-PRUDENTIAL              VALUE 'P'.
  1866                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1867                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1868                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1869                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  34
* SOCK03.cbl
  1870                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1871                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1872
  1873             20  CF-JOINT-INDICATOR         PIC X.
  1874                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1875
  1876*            20  FILLER                     PIC X(12).
  1877             20  cf-maximum-benefits        pic s999 comp-3.
  1878             20  FILLER                     PIC X(09).
  1879             20  CF-BENEFIT-CATEGORY        PIC X.
  1880             20  CF-LOAN-TYPE               PIC X(8).
  1881
  1882             20  CF-CO-REM-TERM-CALC        PIC X.
  1883                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1884                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1885                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1886                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1887                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1888
  1889             20  CF-CO-EARNINGS-CALC        PIC X.
  1890                 88  CO-EARN-BY-R78             VALUE '1'.
  1891                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1892                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1893                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1894                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1895                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1896                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1897                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1898
  1899             20  CF-CO-REFUND-CALC          PIC X.
  1900                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1901                 88  CO-REFD-BY-R78             VALUE '1'.
  1902                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1903                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1904                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1905                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1906                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1907                 88  CO-REFD-MEAN               VALUE '8'.
  1908                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1909                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1910                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1911
  1912             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1913                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1914                 88  CO-OVRD-BY-R78             VALUE '1'.
  1915                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1916                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1917                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1918                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1919                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1920                 88  CO-OVRD-MEAN               VALUE '8'.
  1921                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1922
  1923             20  CF-CO-BEN-I-G-CD           PIC X.
  1924                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1925                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1926                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1927
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  35
* SOCK03.cbl
  1928         16  FILLER                         PIC X(304).
  1929
  1930
  1931****************************************************************
  1932*             CARRIER MASTER RECORD                            *
  1933****************************************************************
  1934
  1935     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1936         16  CF-ADDRESS-DATA.
  1937             20  CF-MAIL-TO-NAME            PIC X(30).
  1938             20  CF-IN-CARE-OF              PIC X(30).
  1939             20  CF-ADDRESS-LINE-1          PIC X(30).
  1940             20  CF-ADDRESS-LINE-2          PIC X(30).
  1941             20  CF-CITY-STATE              PIC X(30).
  1942             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1943             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1944
  1945         16  CF-CLAIM-NO-CONTROL.
  1946             20  CF-CLAIM-NO-METHOD         PIC X.
  1947                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1948                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1949                 88  CLAIM-NO-SEQ               VALUE '3'.
  1950                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1951             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1952                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1953                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1954                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1955
  1956         16  CF-CHECK-NO-CONTROL.
  1957             20  CF-CHECK-NO-METHOD         PIC X.
  1958                 88  CHECK-NO-MANUAL            VALUE '1'.
  1959                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1960                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1961                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1962             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1963                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1964
  1965         16  CF-DOMICILE-STATE              PIC XX.
  1966
  1967         16  CF-EXPENSE-CONTROLS.
  1968             20  CF-EXPENSE-METHOD          PIC X.
  1969                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1970                 88  DOLLARS-PER-PMT            VALUE '2'.
  1971                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1972                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1973             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1974             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1975
  1976         16  CF-CORRESPONDENCE-CONTROL.
  1977             20  CF-LETTER-RESEND-OPT       PIC X.
  1978                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1979                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1980             20  FILLER                     PIC X(4).
  1981
  1982         16  CF-RESERVE-CONTROLS.
  1983             20  CF-MANUAL-SW               PIC X.
  1984                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1985             20  CF-FUTURE-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  36
* SOCK03.cbl
  1986                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1987             20  CF-PTC-SW                  PIC X.
  1988                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1989             20  CF-IBNR-SW                 PIC X.
  1990                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1991             20  CF-PTC-LF-SW               PIC X.
  1992                 88  CF-LF-PTC-USED             VALUE '1'.
  1993             20  CF-CDT-ACCESS-METHOD       PIC X.
  1994                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1995                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1996                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1997             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1998
  1999         16  CF-CLAIM-CALC-METHOD           PIC X.
  2000             88  360-PLUS-MONTHS                VALUE '1'.
  2001             88  365-PLUS-MONTHS                VALUE '2'.
  2002             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2003             88  360-DAILY                      VALUE '4'.
  2004             88  365-DAILY                      VALUE '5'.
  2005
  2006         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2007         16  FILLER                         PIC X(11).
  2008
  2009         16  CF-LIMIT-AMOUNTS.
  2010             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2011             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2012             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2013             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2014             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2015             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2016             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2017             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2018             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2019             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2020
  2021         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2022         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2023         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2024
  2025         16  CF-ZIP-CODE.
  2026             20  CF-ZIP-PRIME.
  2027                 24  CF-ZIP-1ST             PIC X.
  2028                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2029                 24  FILLER                 PIC X(4).
  2030             20  CF-ZIP-PLUS4               PIC X(4).
  2031         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2032             20  CF-CAN-POSTAL-1            PIC XXX.
  2033             20  CF-CAN-POSTAL-2            PIC XXX.
  2034             20  FILLER                     PIC XXX.
  2035
  2036         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2037         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2038         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2039
  2040         16  CF-RATING-SWITCH               PIC X.
  2041             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2042             88  CF-NO-RATING                   VALUE 'N'.
  2043
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  37
* SOCK03.cbl
  2044         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2045
  2046         16  CF-CARRIER-OVER-SHORT.
  2047             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2048             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2049
  2050         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2051         16  CF-SECPAY-SWITCH               PIC X.
  2052             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2053             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2054         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2055         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2056         16  FILLER                         PIC X(444).
  2057*        16  FILLER                         PIC X(452).
  2058
  2059
  2060****************************************************************
  2061*             MORTALITY MASTER RECORD                          *
  2062****************************************************************
  2063
  2064     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2065         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2066                                INDEXED BY CF-MORT-NDX.
  2067             20  CF-MORT-TABLE              PIC X(5).
  2068             20  CF-MORT-TABLE-TYPE         PIC X.
  2069                 88  CF-MORT-JOINT              VALUE 'J'.
  2070                 88  CF-MORT-SINGLE             VALUE 'S'.
  2071                 88  CF-MORT-COMBINED           VALUE 'C'.
  2072                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2073                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2074             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2075             20  CF-MORT-AGE-METHOD         PIC XX.
  2076                 88  CF-AGE-LAST                VALUE 'AL'.
  2077                 88  CF-AGE-NEAR                VALUE 'AN'.
  2078             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2079             20  CF-MORT-ADJUSTMENT-DIRECTION
  2080                                            PIC X.
  2081                 88  CF-MINUS                   VALUE '-'.
  2082                 88  CF-PLUS                    VALUE '+'.
  2083             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2084             20  CF-MORT-JOINT-CODE         PIC X.
  2085                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2086             20  CF-MORT-PC-Q               PIC X.
  2087                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2088             20  CF-MORT-TABLE-CODE         PIC X(4).
  2089             20  CF-MORT-COMMENTS           PIC X(15).
  2090             20  FILLER                     PIC X(14).
  2091
  2092         16  FILLER                         PIC X(251).
  2093
  2094
  2095****************************************************************
  2096*             BUSSINESS TYPE MASTER RECORD                     *
  2097****************************************************************
  2098
  2099     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2100* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2101* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  38
* SOCK03.cbl
  2102* AND RECORD 05 IS TYPES 81-99
  2103         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2104             20  CF-BUSINESS-TITLE          PIC  X(19).
  2105             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2106                                            PIC S9V9(4) COMP-3.
  2107             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2108             20  FILLER                     PIC  X.
  2109         16  FILLER                         PIC  X(248).
  2110
  2111
  2112****************************************************************
  2113*             TERMINAL MASTER RECORD                           *
  2114****************************************************************
  2115
  2116     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2117
  2118         16  CF-COMPANY-TERMINALS.
  2119             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2120                                  PIC X(4).
  2121         16  FILLER               PIC X(248).
  2122
  2123
  2124****************************************************************
  2125*             LIFE EDIT MASTER RECORD                          *
  2126****************************************************************
  2127
  2128     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2129         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2130             20  CF-LIFE-CODE-IN            PIC XX.
  2131             20  CF-LIFE-CODE-OUT           PIC XX.
  2132         16  FILLER                         PIC X(248).
  2133
  2134
  2135****************************************************************
  2136*             AH EDIT MASTER RECORD                            *
  2137****************************************************************
  2138
  2139     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2140         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2141             20  CF-AH-CODE-IN              PIC XXX.
  2142             20  CF-AH-CODE-OUT             PIC XX.
  2143         16  FILLER                         PIC X(248).
  2144
  2145
  2146****************************************************************
  2147*             CREDIBILITY TABLES                               *
  2148****************************************************************
  2149
  2150     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2151         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2152                             INDEXED BY CF-CRDB-NDX.
  2153             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2154             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2155             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2156         16  FILLER                         PIC  X(332).
  2157
  2158
  2159****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  39
* SOCK03.cbl
  2160*             REPORT CUSTOMIZATION RECORD                      *
  2161****************************************************************
  2162
  2163     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2164         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2165             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2166             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2167             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2168**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2169****       A T-TRANSFER.                                   ****
  2170             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2171
  2172         16  FILLER                         PIC XX.
  2173
  2174         16  CF-CARRIER-CNTL-OPT.
  2175             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2176                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2177                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2178             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2179                                            PIC X.
  2180         16  CF-GROUP-CNTL-OPT.
  2181             20  CF-GROUP-OPT-SEQ           PIC 9.
  2182                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2183                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2184             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2185                                            PIC X(6).
  2186         16  CF-STATE-CNTL-OPT.
  2187             20  CF-STATE-OPT-SEQ           PIC 9.
  2188                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2189                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2190             20  CF-STATE-SELECT OCCURS 3 TIMES
  2191                                            PIC XX.
  2192         16  CF-ACCOUNT-CNTL-OPT.
  2193             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2194                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2195                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2196             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2197                                            PIC X(10).
  2198         16  CF-BUS-TYP-CNTL-OPT.
  2199             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2200                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2201                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2202             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2203                                            PIC XX.
  2204         16  CF-LF-TYP-CNTL-OPT.
  2205             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2206                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2207                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2208             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2209                                            PIC XX.
  2210         16  CF-AH-TYP-CNTL-OPT.
  2211             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2212                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2213                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2214             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2215                                            PIC XX.
  2216         16  CF-REPTCD1-CNTL-OPT.
  2217             20  CF-REPTCD1-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  40
* SOCK03.cbl
  2218                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2219                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2220             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2221                                            PIC X(10).
  2222         16  CF-REPTCD2-CNTL-OPT.
  2223             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2224                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2225                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2226             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2227                                            PIC X(10).
  2228         16  CF-USER1-CNTL-OPT.
  2229             20  CF-USER1-OPT-SEQ           PIC 9.
  2230                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2231                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2232             20  CF-USER1-SELECT OCCURS 3 TIMES
  2233                                            PIC X(10).
  2234         16  CF-USER2-CNTL-OPT.
  2235             20  CF-USER2-OPT-SEQ           PIC 9.
  2236                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2237                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2238             20  CF-USER2-SELECT OCCURS 3 TIMES
  2239                                            PIC X(10).
  2240         16  CF-USER3-CNTL-OPT.
  2241             20  CF-USER3-OPT-SEQ           PIC 9.
  2242                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2243                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2244             20  CF-USER3-SELECT OCCURS 3 TIMES
  2245                                            PIC X(10).
  2246         16  CF-USER4-CNTL-OPT.
  2247             20  CF-USER4-OPT-SEQ           PIC 9.
  2248                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2249                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2250             20  CF-USER4-SELECT OCCURS 3 TIMES
  2251                                            PIC X(10).
  2252         16  CF-USER5-CNTL-OPT.
  2253             20  CF-USER5-OPT-SEQ           PIC 9.
  2254                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2255                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2256             20  CF-USER5-SELECT OCCURS 3 TIMES
  2257                                            PIC X(10).
  2258         16  CF-REINS-CNTL-OPT.
  2259             20  CF-REINS-OPT-SEQ           PIC 9.
  2260                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2261                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2262             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2263                 24  CF-REINS-PRIME         PIC XXX.
  2264                 24  CF-REINS-SUB           PIC XXX.
  2265
  2266         16  CF-AGENT-CNTL-OPT.
  2267             20  CF-AGENT-OPT-SEQ           PIC 9.
  2268                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2269                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2270             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2271                                            PIC X(10).
  2272
  2273         16  FILLER                         PIC X(43).
  2274
  2275         16  CF-LOSS-RATIO-SELECT.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  41
* SOCK03.cbl
  2276             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2277             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2278         16  CF-ENTRY-DATE-SELECT.
  2279             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2280             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2281         16  CF-EFFECTIVE-DATE-SELECT.
  2282             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2283             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2284
  2285         16  CF-EXCEPTION-LIST-IND          PIC X.
  2286             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2287
  2288         16  FILLER                         PIC X(318).
  2289
  2290****************************************************************
  2291*                  EXCEPTION REPORTING RECORD                  *
  2292****************************************************************
  2293
  2294     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2295         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2296             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2297
  2298         16  CF-COMBINED-LIFE-AH-OPT.
  2299             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2300             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2301             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2302             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2303
  2304         16  CF-LIFE-OPT.
  2305             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2306             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2307             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2308             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2309             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2310             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2311             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2312             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2313             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2314             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2315
  2316         16  CF-AH-OPT.
  2317             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2318             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2319             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2320             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2321             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2322             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2323             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2324             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2325             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2326             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2327
  2328         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2329             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2330             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2331             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2332
  2333         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  42
* SOCK03.cbl
  2334
  2335         16  FILLER                         PIC X(673).
  2336
  2337
  2338****************************************************************
  2339*             MORTGAGE SYSTEM PLAN RECORD                      *
  2340****************************************************************
  2341
  2342     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2343         16  CF-PLAN-TYPE                   PIC X.
  2344             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2345             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2346             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2347         16  CF-PLAN-ABBREV                 PIC XXX.
  2348         16  CF-PLAN-DESCRIPT               PIC X(10).
  2349         16  CF-PLAN-NOTES                  PIC X(20).
  2350         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2351         16  CF-PLAN-UNDERWRITING.
  2352             20  CF-PLAN-TERM-DATA.
  2353                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2354                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2355             20  CF-PLAN-AGE-DATA.
  2356                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2357                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2358                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2359             20  CF-PLAN-BENEFIT-DATA.
  2360                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2361                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2362                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2363                                            PIC S9(7)V99  COMP-3.
  2364         16  CF-PLAN-POLICY-FORMS.
  2365             20  CF-POLICY-FORM             PIC X(12).
  2366             20  CF-MASTER-APPLICATION      PIC X(12).
  2367             20  CF-MASTER-POLICY           PIC X(12).
  2368         16  CF-PLAN-RATING.
  2369             20  CF-RATE-CODE               PIC X(5).
  2370             20  CF-SEX-RATING              PIC X.
  2371                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2372                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2373             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2374             20  CF-SUB-STD-TYPE            PIC X.
  2375                 88  CF-PCT-OF-PREM            VALUE '1'.
  2376                 88  CF-PCT-OF-BENE            VALUE '2'.
  2377         16  CF-PLAN-PREM-TOLERANCES.
  2378             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2379             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2380         16  CF-PLAN-PYMT-TOLERANCES.
  2381             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2382             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2383         16  CF-PLAN-MISC-DATA.
  2384             20  FILLER                     PIC X.
  2385             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2386             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2387         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2388         16  CF-PLAN-IND-GRP                PIC X.
  2389             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2390                                                     '1'.
  2391             88  CF-MORT-GROUP-PLAN            VALUE 'G'
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  43
* SOCK03.cbl
  2392                                                     '2'.
  2393         16  CF-MIB-SEARCH-SW               PIC X.
  2394             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2395             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2396             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2397             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2398         16  CF-ALPHA-SEARCH-SW             PIC X.
  2399             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2400             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2401             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2402             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2403             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2404             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2405             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2406             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2407             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2408             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2409                                                     'A' 'B' 'C'
  2410                                                     'X' 'Y' 'Z'.
  2411         16  CF-EFF-DT-RULE-SW              PIC X.
  2412             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2413             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2414             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2415             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2416             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2417         16  FILLER                         PIC X(4).
  2418         16  CF-HEALTH-QUESTIONS            PIC X.
  2419             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2420         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2421         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2422         16  CF-PLAN-SNGL-JNT               PIC X.
  2423             88  CF-COMBINED-PLAN              VALUE 'C'.
  2424             88  CF-JNT-PLAN                   VALUE 'J'.
  2425             88  CF-SNGL-PLAN                  VALUE 'S'.
  2426         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2427         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2428         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2429         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2430         16  CF-RERATE-CNTL                 PIC  X.
  2431             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2432             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2433             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2434             88  CF-AUTO-RECALC                 VALUE '4'.
  2435         16  CF-BENEFIT-TYPE                PIC  X.
  2436             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2437             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2438         16  CF-POLICY-FEE                  PIC S999V99
  2439                                                    COMP-3.
  2440         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2441         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2442         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2443         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2444         16  FILLER                         PIC  X(32).
  2445         16  CF-TERMINATION-FORM            PIC  X(04).
  2446         16  FILLER                         PIC  X(08).
  2447         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2448                                                       COMP-3.
  2449         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  44
* SOCK03.cbl
  2450         16  CF-ISSUE-LETTER                PIC  X(4).
  2451         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2452         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2453             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2454             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2455         16  CF-MP-REFUND-CALC              PIC X.
  2456             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2457             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2458             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2459             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2460             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2461             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2462             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2463             88  CF-MP-REFD-MEAN                VALUE '8'.
  2464         16  CF-ALT-RATE-CODE               PIC  X(5).
  2465
  2466
  2467         16  FILLER                         PIC X(498).
  2468****************************************************************
  2469*             MORTGAGE COMPANY MASTER RECORD                   *
  2470****************************************************************
  2471
  2472     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2473         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2474         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2475             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2476             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2477             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2478             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2479             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2480
  2481         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2482         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2483         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2484         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2485         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2486
  2487         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2488             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2489         16  CF-MP-RECON-USE-IND            PIC X(1).
  2490             88  CF-MP-USE-RECON             VALUE 'Y'.
  2491         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2492             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2493         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2494             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2495             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2496         16  FILLER                         PIC X(1).
  2497         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2498             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2499         16  CF-MORTG-MIB-VERSION           PIC X.
  2500             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2501             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2502             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2503         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2504             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2505                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2506             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2507                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  45
* SOCK03.cbl
  2508             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2509                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2510             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2511                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2512             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2513                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2514             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2515                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2516         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2517         16  FILLER                         PIC X(7).
  2518         16  CF-MORTG-DESTINATION-SYMBOL.
  2519             20  CF-MORTG-MIB-COMM          PIC X(5).
  2520             20  CF-MORTG-MIB-TERM          PIC X(5).
  2521         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2522             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2523         16  FILLER                         PIC X(03).
  2524         16  CF-MP-CHECK-NO-CONTROL.
  2525             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2526                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2527                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2528                                                ' ' LOW-VALUES.
  2529                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2530                                               VALUE '3'.
  2531         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2532         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2533         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2534             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2535                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2536             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2537                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2538             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2539                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2540             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2541                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2542             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2543                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2544             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2545                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2546         16  CF-MORTG-BILLING-AREA.
  2547             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2548                                            PIC X.
  2549         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2550         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2551         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2552         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2553             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2554             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2555         16  FILLER                         PIC X.
  2556         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2557             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2558             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2559         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2560         16  FILLER                         PIC X(8).
  2561         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2562         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2563         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2564         16  CF-ACH-COMPANY-ID.
  2565             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  46
* SOCK03.cbl
  2566                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2567                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2568                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2569             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2570         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2571             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2572         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2573             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2574             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2575         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2576         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2577         16  FILLER                         PIC X(536).
  2578
  2579****************************************************************
  2580*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2581****************************************************************
  2582
  2583     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2584         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2585             20  CF-FEMALE-HEIGHT.
  2586                 24  CF-FEMALE-FT           PIC 99.
  2587                 24  CF-FEMALE-IN           PIC 99.
  2588             20  CF-FEMALE-MIN-WT           PIC 999.
  2589             20  CF-FEMALE-MAX-WT           PIC 999.
  2590         16  FILLER                         PIC X(428).
  2591
  2592     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2593         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2594             20  CF-MALE-HEIGHT.
  2595                 24  CF-MALE-FT             PIC 99.
  2596                 24  CF-MALE-IN             PIC 99.
  2597             20  CF-MALE-MIN-WT             PIC 999.
  2598             20  CF-MALE-MAX-WT             PIC 999.
  2599         16  FILLER                         PIC X(428).
  2600******************************************************************
  2601*             AUTOMATIC ACTIVITY RECORD                          *
  2602******************************************************************
  2603     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2604         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2605             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2606             20  CF-SYS-LETTER-ID           PIC X(04).
  2607             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2608             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2609             20  CF-SYS-RESET-SW            PIC X(01).
  2610             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2611             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2612
  2613         16  FILLER                         PIC X(50).
  2614
  2615         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2616             20  CF-USER-ACTIVE-SW          PIC X(01).
  2617             20  CF-USER-LETTER-ID          PIC X(04).
  2618             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2619             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2620             20  CF-USER-RESET-SW           PIC X(01).
  2621             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2622             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2623             20  CF-USER-ACTIVITY-DESC      PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  47
* SOCK03.cbl
  2624
  2625         16  FILLER                         PIC X(246).
  2626*                                 COPY ERCACCT.
  2627******************************************************************
  2628*                                                                *
  2629*                                                                *
  2630*                            ERCACCT                             *
  2631*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2632*                            VMOD=2.031                          *
  2633*                                                                *
  2634*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2635*                                                                *
  2636*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2637*   VSAM ACCOUNT MASTER FILES.                                   *
  2638*                                                                *
  2639*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2640*                                                                *
  2641*   FILE TYPE = VSAM,KSDS                                        *
  2642*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2643*                                                                *
  2644*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2645*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2646*                                                                *
  2647*   LOG = NO                                                     *
  2648*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2649*                                                                *
  2650*                                                                *
  2651******************************************************************
  2652*                   C H A N G E   L O G
  2653*
  2654* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2655*-----------------------------------------------------------------
  2656*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2657* EFFECTIVE    NUMBER
  2658*-----------------------------------------------------------------
  2659* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2660* 092705    2005050300006  PEMA  ADD SPP LEASES
  2661* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2662* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2663* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2664* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2665* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2666* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2667******************************************************************
  2668
  2669 01  ACCOUNT-MASTER.
  2670     12  AM-RECORD-ID                      PIC XX.
  2671         88  VALID-AM-ID                      VALUE 'AM'.
  2672
  2673     12  AM-CONTROL-PRIMARY.
  2674         16  AM-COMPANY-CD                 PIC X.
  2675         16  AM-MSTR-CNTRL.
  2676             20  AM-CONTROL-A.
  2677                 24  AM-CARRIER            PIC X.
  2678                 24  AM-GROUPING.
  2679                     28 AM-GROUPING-PREFIX PIC XXX.
  2680                     28 AM-GROUPING-PRIME  PIC XXX.
  2681                 24  AM-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  48
* SOCK03.cbl
  2682                 24  AM-ACCOUNT.
  2683                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2684                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2685             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2686                                           PIC X(19).
  2687             20  AM-CNTRL-B.
  2688                 24  AM-EXPIRATION-DT      PIC XX.
  2689                 24  FILLER                PIC X(4).
  2690             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2691                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2692
  2693     12  AM-CONTROL-BY-VAR-GRP.
  2694         16  AM-COMPANY-CD-A1              PIC X.
  2695         16  AM-VG-CARRIER                 PIC X.
  2696         16  AM-VG-GROUPING                PIC X(6).
  2697         16  AM-VG-STATE                   PIC XX.
  2698         16  AM-VG-ACCOUNT                 PIC X(10).
  2699         16  AM-VG-DATE.
  2700             20  AM-VG-EXPIRATION-DT       PIC XX.
  2701             20  FILLER                    PIC X(4).
  2702         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2703                                           PIC 9(11)      COMP-3.
  2704     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2705         16  FILLER                        PIC X(10).
  2706         16  AM-VG-KEY3.
  2707             20  AM-VG3-ACCOUNT            PIC X(10).
  2708             20  AM-VG3-EXP-DT             PIC XX.
  2709         16  FILLER                        PIC X(4).
  2710     12  AM-MAINT-INFORMATION.
  2711         16  AM-LAST-MAINT-DT              PIC XX.
  2712         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2713         16  AM-LAST-MAINT-USER            PIC X(4).
  2714         16  FILLER                        PIC XX.
  2715
  2716     12  AM-EFFECTIVE-DT                   PIC XX.
  2717     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2718
  2719     12  AM-PREV-DATES  COMP-3.
  2720         16  AM-PREV-EXP-DT                PIC 9(11).
  2721         16  AM-PREV-EFF-DT                PIC 9(11).
  2722
  2723     12  AM-REPORT-CODE-1                  PIC X(10).
  2724     12  AM-REPORT-CODE-2                  PIC X(10).
  2725
  2726     12  AM-CITY-CODE                      PIC X(4).
  2727     12  AM-COUNTY-PARISH                  PIC X(6).
  2728
  2729     12  AM-NAME                           PIC X(30).
  2730     12  AM-PERSON                         PIC X(30).
  2731     12  AM-ADDRS                          PIC X(30).
  2732     12  AM-CITY.
  2733         16  AM-ADDR-CITY                  PIC X(28).
  2734         16  AM-ADDR-STATE                 PIC XX.
  2735     12  AM-ZIP.
  2736         16  AM-ZIP-PRIME.
  2737             20  AM-ZIP-PRI-1ST            PIC X.
  2738                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2739             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  49
* SOCK03.cbl
  2740         16  AM-ZIP-PLUS4                  PIC X(4).
  2741     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2742         16  AM-CAN-POSTAL-1               PIC XXX.
  2743         16  AM-CAN-POSTAL-2               PIC XXX.
  2744         16  FILLER                        PIC XXX.
  2745     12  AM-TEL-NO.
  2746         16  AM-AREA-CODE                  PIC 999.
  2747         16  AM-TEL-PRE                    PIC 999.
  2748         16  AM-TEL-NBR                    PIC 9(4).
  2749     12  AM-TEL-LOC                        PIC X.
  2750         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2751         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2752
  2753     12  AM-COMM-STRUCTURE.
  2754         16  AM-DEFN-1.
  2755             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2756                 24  AM-AGT.
  2757                     28  AM-AGT-PREFIX     PIC X(4).
  2758                     28  AM-AGT-PRIME      PIC X(6).
  2759                 24  AM-COM-TYP            PIC X.
  2760                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2761                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2762                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2763                 24  AM-RECALC-LV-INDIC    PIC X.
  2764                 24  AM-RETRO-LV-INDIC     PIC X.
  2765                 24  AM-GL-CODES           PIC X.
  2766                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2767                 24  FILLER                PIC X(01).
  2768         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2769             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2770                 24  FILLER                PIC X(11).
  2771                 24  AM-L-COMA             PIC XXX.
  2772                 24  AM-J-COMA             PIC XXX.
  2773                 24  AM-A-COMA             PIC XXX.
  2774                 24  FILLER                PIC X(6).
  2775
  2776     12  AM-COMM-CHANGE-STATUS             PIC X.
  2777         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2778
  2779     12  AM-CSR-CODE                       PIC X(4).
  2780
  2781     12  AM-BILLING-STATUS                 PIC X.
  2782         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2783         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2784     12  AM-AUTO-REFUND-SW                 PIC X.
  2785         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2786         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2787     12  AM-GPCD                           PIC 99.
  2788     12  AM-IG                             PIC X.
  2789         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2790         88  AM-HAS-GROUP                     VALUE '2'.
  2791     12  AM-STATUS                         PIC X.
  2792         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2793         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2794         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2795         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2796         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2797         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  50
* SOCK03.cbl
  2798         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2799         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2800         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2801         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2802     12  AM-REMIT-TO                       PIC 99.
  2803     12  AM-ID-NO                          PIC X(11).
  2804
  2805     12  AM-CAL-TABLE                      PIC XX.
  2806     12  AM-LF-DEVIATION                   PIC XXX.
  2807     12  AM-AH-DEVIATION                   PIC XXX.
  2808     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2809     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2810     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2811     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2812     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2813     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2814
  2815     12  AM-USER-FIELDS.
  2816         16  AM-FLD-1                      PIC XX.
  2817         16  AM-FLD-2                      PIC XX.
  2818         16  AM-FLD-3                      PIC XX.
  2819         16  AM-FLD-4                      PIC XX.
  2820         16  AM-FLD-5                      PIC XX.
  2821
  2822     12  AM-1ST-PROD-DATE.
  2823         16  AM-1ST-PROD-YR                PIC XX.
  2824         16  AM-1ST-PROD-MO                PIC XX.
  2825         16  AM-1ST-PROD-DA                PIC XX.
  2826     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2827     12  AM-CERTS-PURGED-DATE.
  2828         16  AM-PUR-YR                     PIC XX.
  2829         16  AM-PUR-MO                     PIC XX.
  2830         16  AM-PUR-DA                     PIC XX.
  2831     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2832     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2833     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2834     12  AM-INACTIVE-DATE.
  2835         16  AM-INA-MO                     PIC 99.
  2836         16  AM-INA-DA                     PIC 99.
  2837         16  AM-INA-YR                     PIC 99.
  2838     12  AM-AR-HI-CERT-DATE                PIC XX.
  2839
  2840     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2841     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2842
  2843     12  AM-OB-PAYMENT-MODE                PIC X.
  2844         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2845         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2846         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2847         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2848
  2849     12  AM-AH-ONLY-INDICATOR              PIC X.
  2850         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2851         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2852
  2853     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2854
  2855     12  AM-OVER-SHORT.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  51
* SOCK03.cbl
  2856         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2857         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2858
  2859     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2860     12  AM-DCC-CLP-STATE                  PIC XX.
  2861
  2862     12  AM-RECALC-COMM                    PIC X.
  2863     12  AM-RECALC-REIN                    PIC X.
  2864
  2865     12  AM-REI-TABLE                      PIC XXX.
  2866     12  AM-REI-ET-LF                      PIC X.
  2867     12  AM-REI-ET-AH                      PIC X.
  2868     12  AM-REI-PE-LF                      PIC X.
  2869     12  AM-REI-PE-AH                      PIC X.
  2870     12  AM-REI-PRT-ST                     PIC X.
  2871     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2872     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2873     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2874     12  AM-REI-GROUP-A                    PIC X(6).
  2875     12  AM-REI-MORT                       PIC X(4).
  2876     12  AM-REI-PRT-OW                     PIC X.
  2877     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2878     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2879     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2880     12  AM-REI-GROUP-B                    PIC X(6).
  2881
  2882     12  AM-TRUST-TYPE                     PIC X(2).
  2883
  2884     12  AM-EMPLOYER-STMT-USED             PIC X.
  2885     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2886
  2887     12  AM-STD-AH-TYPE                    PIC XX.
  2888     12  AM-EARN-METHODS.
  2889         16  AM-EARN-METHOD-R              PIC X.
  2890             88 AM-REF-RL-R78                 VALUE 'R'.
  2891             88 AM-REF-RL-PR                  VALUE 'P'.
  2892             88 AM-REF-RL-MEAN                VALUE 'M'.
  2893             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2894         16  AM-EARN-METHOD-L              PIC X.
  2895             88 AM-REF-LL-R78                 VALUE 'R'.
  2896             88 AM-REF-LL-PR                  VALUE 'P'.
  2897             88 AM-REF-LL-MEAN                VALUE 'M'.
  2898             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2899         16  AM-EARN-METHOD-A              PIC X.
  2900             88 AM-REF-AH-R78                 VALUE 'R'.
  2901             88 AM-REF-AH-PR                  VALUE 'P'.
  2902             88 AM-REF-AH-MEAN                VALUE 'M'.
  2903             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2904             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2905             88 AM-REF-AH-NET                 VALUE 'N'.
  2906
  2907     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2908     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2909     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2910
  2911     12  AM-RET-Y-N                        PIC X.
  2912     12  AM-RET-P-E                        PIC X.
  2913     12  AM-LF-RET                         PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  52
* SOCK03.cbl
  2914     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2915     12  AM-RET-GRP                        PIC X(6).
  2916     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2917         16  AM-POOL-PRIME                 PIC XXX.
  2918         16  AM-POOL-SUB                   PIC XXX.
  2919     12  AM-RETRO-EARNINGS.
  2920         16  AM-RET-EARN-R                 PIC X.
  2921         16  AM-RET-EARN-L                 PIC X.
  2922         16  AM-RET-EARN-A                 PIC X.
  2923     12  AM-RET-ST-TAX-USE                 PIC X.
  2924         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2925         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2926     12  AM-RETRO-BEG-EARNINGS.
  2927         16  AM-RET-BEG-EARN-R             PIC X.
  2928         16  AM-RET-BEG-EARN-L             PIC X.
  2929         16  AM-RET-BEG-EARN-A             PIC X.
  2930     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2931     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2932
  2933     12  AM-USER-SELECT-OPTIONS.
  2934         16  AM-USER-SELECT-1              PIC X(10).
  2935         16  AM-USER-SELECT-2              PIC X(10).
  2936         16  AM-USER-SELECT-3              PIC X(10).
  2937         16  AM-USER-SELECT-4              PIC X(10).
  2938         16  AM-USER-SELECT-5              PIC X(10).
  2939
  2940     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2941
  2942     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2943
  2944     12  AM-RPT045A-SWITCH                 PIC X.
  2945         88  RPT045A-OFF                   VALUE 'N'.
  2946
  2947     12  AM-INSURANCE-LIMITS.
  2948         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2949         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2950
  2951     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2952         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2953
  2954     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2955         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2956         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2957
  2958     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2959
  2960     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2961     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2962     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2963     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2964     12  AM-DCC-UEF-STATE                  PIC XX.
  2965     12  FILLER                            PIC XXX.
  2966     12  AM-REPORT-CODE-3                  PIC X(10).
  2967*    12  FILLER                            PIC X(22).
  2968
  2969     12  AM-RESERVE-DATE.
  2970         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2971         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  53
* SOCK03.cbl
  2972         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2973
  2974     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2975     12  AM-NOTIFICATION-TYPES.
  2976         16  AM-NOTIF-OF-LETTERS           PIC X.
  2977         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2978         16  AM-NOTIF-OF-REPORTS           PIC X.
  2979         16  AM-NOTIF-OF-STATUS            PIC X.
  2980
  2981     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2982         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2983         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2984         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2985         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2986
  2987     12  AM-BENEFIT-CONTROLS.
  2988         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2989             20  AM-BENEFIT-CODE           PIC XX.
  2990             20  AM-BENEFIT-TYPE           PIC X.
  2991             20  AM-BENEFIT-REVISION       PIC XXX.
  2992             20  AM-BENEFIT-REM-TERM       PIC X.
  2993             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2994             20  FILLER                    PIC XX.
  2995         16  FILLER                        PIC X(80).
  2996
  2997     12  AM-TRANSFER-DATA.
  2998         16  AM-TRANSFERRED-FROM.
  2999             20  AM-TRNFROM-CARRIER        PIC X.
  3000             20  AM-TRNFROM-GROUPING.
  3001                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3002                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3003             20  AM-TRNFROM-STATE          PIC XX.
  3004             20  AM-TRNFROM-ACCOUNT.
  3005                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3006                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3007             20  AM-TRNFROM-DTE            PIC XX.
  3008         16  AM-TRANSFERRED-TO.
  3009             20  AM-TRNTO-CARRIER          PIC X.
  3010             20  AM-TRNTO-GROUPING.
  3011                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3012                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3013             20  AM-TRNTO-STATE            PIC XX.
  3014             20  AM-TRNTO-ACCOUNT.
  3015                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3016                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3017             20  AM-TRNTO-DTE              PIC XX.
  3018         16  FILLER                        PIC X(10).
  3019
  3020     12  AM-SAVED-REMIT-TO                 PIC 99.
  3021
  3022     12  AM-COMM-STRUCTURE-SAVED.
  3023         16  AM-DEFN-1-SAVED.
  3024             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3025                 24  AM-AGT-SV             PIC X(10).
  3026                 24  AM-COM-TYP-SV         PIC X.
  3027                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3028                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3029                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  54
* SOCK03.cbl
  3030                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3031                 24  FILLER                PIC X.
  3032                 24  AM-GL-CODES-SV        PIC X.
  3033                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3034                 24  FILLER                PIC X.
  3035         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3036             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3037                 24  FILLER                PIC X(11).
  3038                 24  AM-L-COMA-SV          PIC XXX.
  3039                 24  AM-J-COMA-SV          PIC XXX.
  3040                 24  AM-A-COMA-SV          PIC XXX.
  3041                 24  FILLER                PIC X(6).
  3042
  3043     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3044         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3045            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3046            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3047            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3048
  3049     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3050     12  FILLER                            PIC X(120).
  3051
  3052     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3053         16  AM-CONTROL-NAME               PIC X(30).
  3054         16  AM-EXECUTIVE-ONE.
  3055             20  AM-EXEC1-NAME             PIC X(15).
  3056             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3057                                                          COMP-3.
  3058             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3059                                                          COMP-3.
  3060         16  AM-EXECUTIVE-TWO.
  3061             20  AM-EXEC2-NAME             PIC X(15).
  3062             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3063                                                          COMP-3.
  3064             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3065                                                          COMP-3.
  3066
  3067     12  AM-RETRO-ADDITIONAL-DATA.
  3068         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3069         16  AM-RETRO-PREM-P-E             PIC X.
  3070         16  AM-RETRO-CLMS-P-I             PIC X.
  3071         16  AM-RETRO-RET-BRACKET-LF.
  3072             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3073                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3074                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3075             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3076                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3077                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3078             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3079                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3080                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3081         16  AM-RETRO-RET-BRACKET-AH.
  3082             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3083                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3084                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3085                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3086             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3087                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  55
* SOCK03.cbl
  3088                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3089             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3090                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3091                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3092
  3093     12  AM-COMMENTS.
  3094         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3095
  3096     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3097         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3098         16  AM-FLI-BILLING-CODE           PIC X.
  3099         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3100         16  AM-FLI-UNITED-IDENT           PIC X.
  3101         16  AM-FLI-INTEREST-LOST-DATA.
  3102             20  AM-FLI-BANK-NO            PIC X(5).
  3103             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3104             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3105             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3106         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3107             20  AM-FLI-AGT                PIC X(9).
  3108             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3109             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3110         16  FILLER                        PIC X(102).
  3111
  3112     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3113         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3114             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3115             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3116             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3117             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3118             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3119         16  FILLER                          PIC X(10).
  3120******************************************************************
  3121*                                 COPY ERCMAIL.
  3122******************************************************************
  3123*                                                                *
  3124*                                                                *
  3125*                            ERCMAIL                             *
  3126*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3127*                            VMOD=2.003                          *
  3128*                                                                *
  3129*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3130*                                                                *
  3131*   FILE TYPE = VSAM,KSDS                                        *
  3132*   RECORD SIZE = 374   RECFORM = FIX                            *
  3133*                                                                *
  3134*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3135*   ALTERNATE PATH    = NOT USED                                 *
  3136*                                                                *
  3137*   LOG = YES                                                    *
  3138*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3139******************************************************************
  3140*                   C H A N G E   L O G
  3141*
  3142* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3143*-----------------------------------------------------------------
  3144*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3145* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  56
* SOCK03.cbl
  3146*-----------------------------------------------------------------
  3147* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3148* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3149* 111108                   PEMA  ADD CRED BENE ADDR2
  3150******************************************************************
  3151
  3152 01  MAILING-DATA.
  3153     12  MA-RECORD-ID                      PIC XX.
  3154         88  VALID-MA-ID                       VALUE 'MA'.
  3155
  3156     12  MA-CONTROL-PRIMARY.
  3157         16  MA-COMPANY-CD                 PIC X.
  3158         16  MA-CARRIER                    PIC X.
  3159         16  MA-GROUPING.
  3160             20  MA-GROUPING-PREFIX        PIC XXX.
  3161             20  MA-GROUPING-PRIME         PIC XXX.
  3162         16  MA-STATE                      PIC XX.
  3163         16  MA-ACCOUNT.
  3164             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3165             20  MA-ACCOUNT-PRIME          PIC X(6).
  3166         16  MA-CERT-EFF-DT                PIC XX.
  3167         16  MA-CERT-NO.
  3168             20  MA-CERT-PRIME             PIC X(10).
  3169             20  MA-CERT-SFX               PIC X.
  3170
  3171     12  FILLER                            PIC XX.
  3172
  3173     12  MA-ACCESS-CONTROL.
  3174         16  MA-SOURCE-SYSTEM              PIC XX.
  3175             88  MA-FROM-CREDIT                VALUE 'CR'.
  3176             88  MA-FROM-VSI                   VALUE 'VS'.
  3177             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3178             88  MA-FROM-OTHER                 VALUE 'OT'.
  3179         16  MA-RECORD-ADD-DT              PIC XX.
  3180         16  MA-RECORD-ADDED-BY            PIC XXXX.
  3181         16  MA-LAST-MAINT-DT              PIC XX.
  3182         16  MA-LAST-MAINT-BY              PIC XXXX.
  3183         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3184
  3185     12  MA-PROFILE-INFO.
  3186         16  MA-QUALIFY-CODE-1             PIC XX.
  3187         16  MA-QUALIFY-CODE-2             PIC XX.
  3188         16  MA-QUALIFY-CODE-3             PIC XX.
  3189         16  MA-QUALIFY-CODE-4             PIC XX.
  3190         16  MA-QUALIFY-CODE-5             PIC XX.
  3191
  3192         16  MA-INSURED-LAST-NAME          PIC X(15).
  3193         16  MA-INSURED-FIRST-NAME         PIC X(10).
  3194         16  MA-INSURED-MIDDLE-INIT        PIC X.
  3195         16  MA-INSURED-ISSUE-AGE          PIC 99.
  3196         16  MA-INSURED-BIRTH-DT           PIC XX.
  3197         16  MA-INSURED-SEX                PIC X.
  3198             88  MA-SEX-MALE                   VALUE 'M'.
  3199             88  MA-SEX-FEMALE                 VALUE 'F'.
  3200         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  3201
  3202         16  MA-ADDRESS-CORRECTED          PIC X.
  3203         16  MA-JOINT-BIRTH-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  57
* SOCK03.cbl
  3204*        16  FILLER                        PIC X(12).
  3205
  3206         16  MA-ADDRESS-LINE-1             PIC X(30).
  3207         16  MA-ADDRESS-LINE-2             PIC X(30).
  3208         16  MA-CITY-STATE.
  3209             20  MA-CITY                   PIC X(28).
  3210             20  MA-ADDR-STATE             PIC XX.
  3211         16  MA-ZIP.
  3212             20  MA-ZIP-CODE.
  3213                 24  MA-ZIP-CODE-1ST       PIC X(1).
  3214                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3215                 24  FILLER                PIC X(4).
  3216             20  MA-ZIP-PLUS4              PIC X(4).
  3217         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  3218             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  3219             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  3220             20  FILLER                    PIC X(3).
  3221
  3222         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  3223
  3224         16  FILLER                        PIC XXX.
  3225*        16  FILLER                        PIC X(10).
  3226
  3227     12  MA-CRED-BENE-INFO.
  3228         16  MA-CRED-BENE-NAME                 PIC X(25).
  3229         16  MA-CRED-BENE-ADDR                 PIC X(30).
  3230         16  MA-CRED-BENE-ADDR2                PIC X(30).
  3231         16  MA-CRED-BENE-CTYST.
  3232             20  MA-CRED-BENE-CITY             PIC X(28).
  3233             20  MA-CRED-BENE-STATE            PIC XX.
  3234         16  MA-CRED-BENE-ZIP.
  3235             20  MA-CB-ZIP-CODE.
  3236                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  3237                     88  MA-CB-CANADIAN-POST-CODE
  3238                                           VALUE 'A' THRU 'Z'.
  3239                 24  FILLER                    PIC X(4).
  3240             20  MA-CB-ZIP-PLUS4               PIC X(4).
  3241         16  MA-CB-CANADIAN-POSTAL-CODE
  3242                            REDEFINES MA-CRED-BENE-ZIP.
  3243             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  3244             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  3245             20  FILLER                        PIC X(3).
  3246     12  MA-POST-CARD-MAIL-DATA.
  3247         16  MA-MAIL-DATA OCCURS 7.
  3248             20  MA-MAIL-TYPE              PIC X.
  3249                 88  MA-12MO-MAILING           VALUE '1'.
  3250                 88  MA-EXP-MAILING            VALUE '2'.
  3251             20  MA-MAIL-STATUS            PIC X.
  3252                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  3253                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  3254                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  3255             20  MA-MAIL-DATE              PIC XX.
  3256     12  FILLER                            PIC XX.
  3257     12  FILLER                            PIC XX.
  3258*    12  FILLER                            PIC X(30).
  3259******************************************************************
  3260*                                 COPY ELCCRTT.
  3261******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  58
* SOCK03.cbl
  3262*                                                                *
  3263*                            ELCCRTT.                            *
  3264*                                                                *
  3265*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3266*                                                                *
  3267*   FILE TYPE = VSAM,KSDS                                        *
  3268*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3269*                                                                *
  3270*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3271*                                                                *
  3272*   LOG = YES                                                    *
  3273*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3274******************************************************************
  3275*                   C H A N G E   L O G
  3276*
  3277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3278*-----------------------------------------------------------------
  3279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3280* EFFECTIVE    NUMBER
  3281*-----------------------------------------------------------------
  3282* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3283* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3284* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3285* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3286* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3287* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3288* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3289* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3290* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3291* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3292* 091318  CR2018073000001  PEMA  ADD Refund methods
  3293* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3294******************************************************************
  3295
  3296 01  CERTIFICATE-TRAILERS.
  3297     12  CS-RECORD-ID                      PIC XX.
  3298         88  VALID-CS-ID                      VALUE 'CS'.
  3299
  3300     12  CS-CONTROL-PRIMARY.
  3301         16  CS-COMPANY-CD                 PIC X.
  3302         16  CS-CARRIER                    PIC X.
  3303         16  CS-GROUPING                   PIC X(6).
  3304         16  CS-STATE                      PIC XX.
  3305         16  CS-ACCOUNT                    PIC X(10).
  3306         16  CS-CERT-EFF-DT                PIC XX.
  3307         16  CS-CERT-NO.
  3308             20  CS-CERT-PRIME             PIC X(10).
  3309             20  CS-CERT-SFX               PIC X.
  3310         16  CS-TRAILER-TYPE               PIC X.
  3311             88  COMM-TRLR           VALUE 'A'.
  3312             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3313             88  CERT-DATA-TRLR      VALUE 'C'.
  3314
  3315     12  CS-DATA-AREA                      PIC X(516).
  3316
  3317     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3318         16  CS-BANK-COMMISSION-AREA.
  3319             20  CS-BANK-COMMS       OCCURS 10.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  59
* SOCK03.cbl
  3320                 24  CS-AGT                PIC X(10).
  3321                 24  CS-COM-TYP            PIC X.
  3322                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3323                 24  CS-RECALC-LV-INDIC    PIC X.
  3324                 24  FILLER                PIC X(10).
  3325         16  FILLER                        PIC X(256).
  3326
  3327     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3328****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3329         16  CS-MB-CLAIM-DATA OCCURS 24.
  3330             20  CS-CLAIM-NO               PIC X(7).
  3331             20  CS-CLAIM-TYPE             PIC X.
  3332                 88  CS-AH-CLM               VALUE 'A'.
  3333                 88  CS-IU-CLM               VALUE 'I'.
  3334                 88  CS-GP-CLM               VALUE 'G'.
  3335                 88  CS-LF-CLM               VALUE 'L'.
  3336                 88  CS-PR-CLM               VALUE 'P'.
  3337                 88  CS-FL-CLM               VALUE 'F'.
  3338                 88  CS-OT-CLM               VALUE 'O'.
  3339             20  CS-INSURED-TYPE           PIC X.
  3340                 88  CS-PRIM-INSURED          VALUE 'P'.
  3341                 88  CS-CO-BORROWER           VALUE 'C'.
  3342             20  CS-BENEFIT-PERIOD         PIC 99.
  3343             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3344             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3345             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3346         16  FILLER                        PIC X(12).
  3347     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3348         16  CS-VIN-NUMBER                 PIC X(17).
  3349         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3350         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3351         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3352         16  cs-agent-name.
  3353             20  cs-agent-fname            pic x(20).
  3354             20  cs-agent-mi               pic x.
  3355             20  cs-agent-lname            pic x(25).
  3356         16  cs-license-no                 pic x(15).
  3357         16  cs-npn-number                 pic x(10).
  3358         16  cs-agent-edit-status          pic x.
  3359             88  cs-ae-refer-to-manager      value 'M'.
  3360             88  cs-ae-cover-sheet           value 'C'.
  3361             88  cs-ae-sig-form              value 'S'.
  3362             88  cs-ae-verified              value 'V'.
  3363             88  cs-unidentified-signature   value 'U'.
  3364             88  cs-cert-returned            value 'R'.
  3365             88  cs-accept-no-commission     value 'N'.
  3366         16  cs-year                       pic 9999.
  3367         16  cs-make                       pic x(20).
  3368         16  cs-model                      pic x(20).
  3369         16  cs-future                     pic x(20).
  3370         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3371         16  cs-claim-verification-status  pic x.
  3372             88  cs-clm-ver-eligible         value 'A'.
  3373             88  cs-clm-ver-partial-elig     value 'B'.
  3374             88  cs-clm-ver-not-eligible     value 'C'.
  3375             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3376             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3377             88  cs-clm-ver-ND-CERT          value 'F'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  60
* SOCK03.cbl
  3378             88  cs-clm-ver-spec-other       value 'G'.
  3379             88  cs-clam-ver-pratial-corrected
  3380                                             value 'H'.
  3381             88  cs-clm-ver-no-matches       value 'I'.
  3382             88  cs-clm-ver-not-elig-corrected
  3383                                             value 'J'.
  3384             88  cs-clm-ver-needs-review     value 'R'.
  3385             88  cs-clm-ver-sent-to-claims   value 'W'.
  3386         16  CS-LF-REFUND-METHOD           PIC X.
  3387         16  CS-AH-REFUND-METHOD           PIC X.
  3388         16  FILLER                        PIC X(353). *> was 420
  3389*        16  FILLER                        PIC X(496).
  3390*                                 COPY ELCDATE.
  3391******************************************************************
  3392*                                                                *
  3393*                                                                *
  3394*                            ELCDATE.                            *
  3395*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3396*                            VMOD=2.003
  3397*                                                                *
  3398*                                                                *
  3399*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3400*                 LENGTH = 200                                   *
  3401******************************************************************
  3402
  3403 01  DATE-CONVERSION-DATA.
  3404     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3405     12  DC-OPTION-CODE                PIC X.
  3406         88  BIN-TO-GREG                VALUE ' '.
  3407         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3408         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3409         88  YMD-GREG-TO-BIN            VALUE '3'.
  3410         88  MDY-GREG-TO-BIN            VALUE '4'.
  3411         88  JULIAN-TO-BIN              VALUE '5'.
  3412         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3413         88  FIND-CENTURY               VALUE '7'.
  3414         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3415         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3416         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3417         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3418         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3419         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3420         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3421         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3422         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3423         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3424         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3425         88  BIN-3-TO-GREG              VALUE 'I'.
  3426         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3427         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3428         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3429         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3430         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3431         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3432         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3433         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3434         88  THREE-CHARACTER-BIN
  3435                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  61
* SOCK03.cbl
  3436         88  GREGORIAN-TO-BIN
  3437                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3438         88  BIN-TO-GREGORIAN
  3439                  VALUES ' ' '1' 'I' '8' 'G'.
  3440         88  JULIAN-TO-BINARY
  3441                  VALUES '5' 'C' 'E' 'F'.
  3442     12  DC-ERROR-CODE                 PIC X.
  3443         88  NO-CONVERSION-ERROR        VALUE ' '.
  3444         88  DATE-CONVERSION-ERROR
  3445                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3446         88  DATE-IS-ZERO               VALUE '1'.
  3447         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3448         88  DATE-IS-INVALID            VALUE '3'.
  3449         88  DATE1-GREATER-DATE2        VALUE '4'.
  3450         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3451         88  DATE-INVALID-OPTION        VALUE '9'.
  3452         88  INVALID-CENTURY            VALUE 'A'.
  3453         88  ONLY-CENTURY               VALUE 'B'.
  3454         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3455         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3456     12  DC-END-OF-MONTH               PIC X.
  3457         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3458     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3459         88  USE-NORMAL-PROCESS         VALUE ' '.
  3460         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3461         88  ADJUST-UP-100-YRS          VALUE '2'.
  3462     12  FILLER                        PIC X.
  3463     12  DC-CONVERSION-DATES.
  3464         16  DC-BIN-DATE-1             PIC XX.
  3465         16  DC-BIN-DATE-2             PIC XX.
  3466         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3467         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3468                       DC-GREG-DATE-1-EDIT.
  3469             20  DC-EDIT1-MONTH        PIC 99.
  3470             20  SLASH1-1              PIC X.
  3471             20  DC-EDIT1-DAY          PIC 99.
  3472             20  SLASH1-2              PIC X.
  3473             20  DC-EDIT1-YEAR         PIC 99.
  3474         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3475         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3476                     DC-GREG-DATE-2-EDIT.
  3477             20  DC-EDIT2-MONTH        PIC 99.
  3478             20  SLASH2-1              PIC X.
  3479             20  DC-EDIT2-DAY          PIC 99.
  3480             20  SLASH2-2              PIC X.
  3481             20  DC-EDIT2-YEAR         PIC 99.
  3482         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3483         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3484                     DC-GREG-DATE-1-YMD.
  3485             20  DC-YMD-YEAR           PIC 99.
  3486             20  DC-YMD-MONTH          PIC 99.
  3487             20  DC-YMD-DAY            PIC 99.
  3488         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3489         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3490                      DC-GREG-DATE-1-MDY.
  3491             20  DC-MDY-MONTH          PIC 99.
  3492             20  DC-MDY-DAY            PIC 99.
  3493             20  DC-MDY-YEAR           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  62
* SOCK03.cbl
  3494         16  DC-GREG-DATE-1-ALPHA.
  3495             20  DC-ALPHA-MONTH        PIC X(10).
  3496             20  DC-ALPHA-DAY          PIC 99.
  3497             20  FILLER                PIC XX.
  3498             20  DC-ALPHA-CENTURY.
  3499                 24 DC-ALPHA-CEN-N     PIC 99.
  3500             20  DC-ALPHA-YEAR         PIC 99.
  3501         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3502         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3503         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3504         16  DC-JULIAN-DATE            PIC 9(05).
  3505         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3506                                       PIC 9(05).
  3507         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3508             20  DC-JULIAN-YEAR        PIC 99.
  3509             20  DC-JULIAN-DAYS        PIC 999.
  3510         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3511         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3512         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3513     12  DATE-CONVERSION-VARIBLES.
  3514         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3515         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3516             20  FILLER                PIC 9(3).
  3517             20  HOLD-CEN-1-CCYY.
  3518                 24  HOLD-CEN-1-CC     PIC 99.
  3519                 24  HOLD-CEN-1-YY     PIC 99.
  3520             20  HOLD-CEN-1-MO         PIC 99.
  3521             20  HOLD-CEN-1-DA         PIC 99.
  3522         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3523             20  HOLD-CEN-1-R-MO       PIC 99.
  3524             20  HOLD-CEN-1-R-DA       PIC 99.
  3525             20  HOLD-CEN-1-R-CCYY.
  3526                 24  HOLD-CEN-1-R-CC   PIC 99.
  3527                 24  HOLD-CEN-1-R-YY   PIC 99.
  3528             20  FILLER                PIC 9(3).
  3529         16  HOLD-CENTURY-1-X.
  3530             20  FILLER                PIC X(3)  VALUE SPACES.
  3531             20  HOLD-CEN-1-X-CCYY.
  3532                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3533                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3534             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3535             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3536         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3537             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3538             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3539             20  HOLD-CEN-1-R-X-CCYY.
  3540                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3541                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3542             20  FILLER                PIC XXX.
  3543         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3544         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3545         16  DC-JULIAN-DATE-1          PIC 9(07).
  3546         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3547             20  DC-JULIAN-1-CCYY.
  3548                 24  DC-JULIAN-1-CC    PIC 99.
  3549                 24  DC-JULIAN-1-YR    PIC 99.
  3550             20  DC-JULIAN-DA-1        PIC 999.
  3551         16  DC-JULIAN-DATE-2          PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  63
* SOCK03.cbl
  3552         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3553             20  DC-JULIAN-2-CCYY.
  3554                 24  DC-JULIAN-2-CC    PIC 99.
  3555                 24  DC-JULIAN-2-YR    PIC 99.
  3556             20  DC-JULIAN-DA-2        PIC 999.
  3557         16  DC-GREG-DATE-A-EDIT.
  3558             20  DC-EDITA-MONTH        PIC 99.
  3559             20  SLASHA-1              PIC X VALUE '/'.
  3560             20  DC-EDITA-DAY          PIC 99.
  3561             20  SLASHA-2              PIC X VALUE '/'.
  3562             20  DC-EDITA-CCYY.
  3563                 24  DC-EDITA-CENT     PIC 99.
  3564                 24  DC-EDITA-YEAR     PIC 99.
  3565         16  DC-GREG-DATE-B-EDIT.
  3566             20  DC-EDITB-MONTH        PIC 99.
  3567             20  SLASHB-1              PIC X VALUE '/'.
  3568             20  DC-EDITB-DAY          PIC 99.
  3569             20  SLASHB-2              PIC X VALUE '/'.
  3570             20  DC-EDITB-CCYY.
  3571                 24  DC-EDITB-CENT     PIC 99.
  3572                 24  DC-EDITB-YEAR     PIC 99.
  3573         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3574         16  DC-GREG-DATE-CYMD-R REDEFINES
  3575                              DC-GREG-DATE-CYMD.
  3576             20  DC-CYMD-CEN           PIC 99.
  3577             20  DC-CYMD-YEAR          PIC 99.
  3578             20  DC-CYMD-MONTH         PIC 99.
  3579             20  DC-CYMD-DAY           PIC 99.
  3580         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3581         16  DC-GREG-DATE-MDCY-R REDEFINES
  3582                              DC-GREG-DATE-MDCY.
  3583             20  DC-MDCY-MONTH         PIC 99.
  3584             20  DC-MDCY-DAY           PIC 99.
  3585             20  DC-MDCY-CEN           PIC 99.
  3586             20  DC-MDCY-YEAR          PIC 99.
  3587    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3588        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3589    12  DC-EL310-DATE                  PIC X(21).
  3590    12  FILLER                         PIC X(28).
  3591*                                 COPY ELCCALC.
  3592******************************************************************
  3593*                                                                *
  3594*                           ELCCALC.                            *
  3595*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3596*                            VMOD=2.025                          *
  3597*                                                                *
  3598*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3599*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3600*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3601*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3602*                                                                *
  3603*  PASSED TO ELRTRM                                              *
  3604*  -----------------                                             *
  3605*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3606*  ORIGINAL TERM                                                 *
  3607*  BEGINNING DATE                                                *
  3608*  ENDING DATE                                                   *
  3609*  COMPANY I.D.                                                  *
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  64
* SOCK03.cbl
  3610*  ACCOUNT MASTER USER FIELD                                     *
  3611*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3612*  FREE LOOK DAYS                                                *
  3613*                                                                *
  3614*  RETURNED FROM ELRTRM                                          *
  3615*  ---------------------                                         *
  3616*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3617*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3618*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3619*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3620*----------------------------------------------------------------*
  3621*  PASSED TO ELRAMT                                              *
  3622*  ----------------                                              *
  3623*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3624*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3625*  ORIGINAL AMOUNT                                               *
  3626*  ALTERNATE BENEFIT (BALLON)                                    *
  3627*  A.P.R. - NET PAY ONLY                                         *
  3628*  METHOD
  3629*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3630*  COMPANY I.D.                                                  *
  3631*  BENEFIT TYPE                                                  *
  3632*                                                                *
  3633*  RETURNED FROM ELRAMT                                          *
  3634*  --------------------                                          *
  3635*  REMAINING AMOUNT 1 - CURRENT                                  *
  3636*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3637*  REMAINING AMOUNT FACTOR
  3638*----------------------------------------------------------------*
  3639*  PASSED TO ELRESV                                              *
  3640*  -----------------                                             *
  3641*  CERTIFICATE EFFECTIVE DATE                                    *
  3642*  VALUATION DATE                                                *
  3643*  PAID THRU DATE                                                *
  3644*  BENEFIT                                                       *
  3645*  INCURRED DATE                                                 *
  3646*  REPORTED DATE                                                 *
  3647*  ISSUE AGE                                                     *
  3648*  TERM                                                          *
  3649*  CDT PERCENT                                                   *
  3650*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3651* *CLAIM TYPE (LIFE, A/H)                                        *
  3652* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3653* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3654*                                                                *
  3655*  RETURNED FROM ELRESV                                          *
  3656*  --------------------                                          *
  3657*  CDT TABLE USED                                                *
  3658*  CDT FACTOR USED                                               *
  3659*  PAY TO CURRENT RESERVE                                        *
  3660*  I.B.N.R. - A/H ONLY                                           *
  3661*  FUTURE (ACCRUED) AH ONLY                                      *
  3662*----------------------------------------------------------------*
  3663*  PASSED TO ELRATE                                              *
  3664*  ----------------                                              *
  3665*  CERT ISSUE DATE                                               *
  3666*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3667*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  65
* SOCK03.cbl
  3668*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3669*  STATE CODE (CLIENT DEFINED)                                   *
  3670*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3671*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3672*  DEVIATION CODE                                                *
  3673*  ISSUE AGE                                                     *
  3674*  ORIGINAL BENEFIT AMOUNT                                       *
  3675*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3676*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3677*  BENEFIT KIND (LIFE OR A/H)                                    *
  3678*  A.P.R.                                                        *
  3679*  METHOD
  3680*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3681*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3682*  COMPANY I.D. (3 CHARACTER)                                    *
  3683*  BENEFIT CODE                                                  *
  3684*  BENEFIT OVERRIDE CODE                                         *
  3685*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3686*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3687*  JOINT INDICATOR (CSL ONLY)                                    *
  3688*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3689*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3690*                                                                *
  3691*  RETURNED FROM ELRATE                                          *
  3692*  --------------------                                          *
  3693*  CALCULATED PREMIUM                                            *
  3694*  PREMIUM RATE                                                  *
  3695*  MORTALITY CODE                                                *
  3696*  MAX ATTAINED AGE                                              *
  3697*  MAX AGE                                                       *
  3698*  MAX TERM                                                      *
  3699*  MAX MONTHLY BENEFIT                                           *
  3700*  MAX TOTAL BENIFIT                                             *
  3701*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3702*----------------------------------------------------------------*
  3703*  PASSED TO ELRFND                                              *
  3704*  ----------------                                              *
  3705*  CERT ISSUE DATE                                               *
  3706*  REFUND DATE                                                   *
  3707*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3708*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3709*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3710*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3711*  STATE CODE (CLIENT DEFINED)                                   *
  3712*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3713*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3714*  DEVIATION CODE                                                *
  3715*  ISSUE AGE                                                     *
  3716*  ORIGINAL BENEFIT AMOUNT                                       *
  3717*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3718*  PROCESS TYPE (CANCEL)                                         *
  3719*  BENEFIT KIND (LIFE OR A/H)                                    *
  3720*  A.P.R.                                                        *
  3721*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3722*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3723*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3724*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3725*  COMPANY I.D. (3 CHARACTER)                                    *
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  66
* SOCK03.cbl
  3726*  BENEFIT CODE                                                  *
  3727*  BENEFIT OVERRIDE CODE                                         *
  3728*                                                                *
  3729*  RETURNED FROM ELRFND                                          *
  3730*  --------------------                                          *
  3731*  CALCULATED REFUND                                             *
  3732*----------------------------------------------------------------*
  3733*  PASSED TO ELEARN                                              *
  3734*  ----------------                                              *
  3735*  CERT ISSUE DATE                                               *
  3736*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3737*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3738*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3739*  STATE CODE (CLIENT DEFINED)                                   *
  3740*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3741*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3742*  DEVIATION CODE                                                *
  3743*  ISSUE AGE                                                     *
  3744*  ORIGINAL BENEFIT AMOUNT                                       *
  3745*  BENEFIT KIND (LIFE OR A/H)                                    *
  3746*  A.P.R.                                                        *
  3747*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3748*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3749*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3750*  COMPANY I.D. (3 CHARACTER)                                    *
  3751*  BENEFIT CODE                                                  *
  3752*  BENEFIT OVERRIDE CODE                                         *
  3753*                                                                *
  3754*  RETURNED FROM ELEARN                                          *
  3755*  --------------------                                          *
  3756*  INDICATED  EARNINGS                                           *
  3757*----------------------------------------------------------------*
  3758*                 LENGTH = 450                                   *
  3759*                                                                *
  3760******************************************************************
  3761******************************************************************
  3762*                   C H A N G E   L O G
  3763*
  3764* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3765*-----------------------------------------------------------------
  3766*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3767* EFFECTIVE    NUMBER
  3768*-----------------------------------------------------------------
  3769* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3770* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3771* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3772* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3773* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3774* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3775* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3776* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3777* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3778* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3779* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3780* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  3781******************************************************************
  3782
  3783 01  CALCULATION-PASS-AREA.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  67
* SOCK03.cbl
  3784     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3785                                     COMP.
  3786
  3787     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3788       88  NO-CP-ERROR                             VALUE ZERO.
  3789       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3790                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
  3791       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3792       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3793       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3794       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3795       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3796       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3797       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3798       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3799       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3800       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3801       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3802       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3803       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3804       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3805       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3806       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3807       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3808       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
  3809
  3810     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3811       88  NO-CP-ERROR-2                           VALUE ZERO.
  3812***********************  INPUT AREAS ****************************
  3813
  3814     12  CP-CALCULATION-AREA.
  3815         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3816         16  CP-CERT-EFF-DT        PIC XX.
  3817         16  CP-VALUATION-DT       PIC XX.
  3818         16  CP-PAID-THRU-DT       PIC XX.
  3819         16  CP-BENEFIT-TYPE       PIC X.
  3820           88  CP-AH                               VALUE 'A' 'D'
  3821                                                   'I' 'U'.
  3822           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3823           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3824         16  CP-INCURRED-DT        PIC XX.
  3825         16  CP-REPORTED-DT        PIC XX.
  3826         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3827         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3828         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-CDT-METHOD         PIC X.
  3833           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3834           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3835           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3836         16  CP-CLAIM-TYPE         PIC X.
  3837           88  CP-AH-CLAIM                         VALUE 'A'.
  3838           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3839         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3840                                     COMP-3.
  3841         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  68
* SOCK03.cbl
  3842                                     COMP-3.
  3843         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3844                                     COMP-3.
  3845         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3846                                     COMP-3.
  3847         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3848                                     COMP-3.
  3849         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3850                                     COMP-3.
  3851         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3852                                     COMP-3.
  3853         16  CP-REM-TERM-METHOD    PIC X.
  3854           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3855           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3856           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3857           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3858           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3859           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3860           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3861         16  CP-EARNING-METHOD     PIC X.
  3862           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3863           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3864           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3865           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3866           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3867           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3868           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3869           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3870           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3871           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3872           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3873           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3874           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3875           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3876         16  CP-PROCESS-TYPE       PIC X.
  3877           88  CP-CLAIM                            VALUE '1'.
  3878           88  CP-CANCEL                           VALUE '2'.
  3879           88  CP-ISSUE                            VALUE '3'.
  3880         16  CP-SPECIAL-CALC-CD    PIC X.
  3881           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3882           88  CP-1-MTH-INTEREST               VALUE ' '.
  3883           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3884           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3885           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3886           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3887           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3888           88  CP-FARM-PLAN                    VALUE 'F'.
  3889           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3890           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3891           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3892           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3893           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3894           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3895           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3896           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3897           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3898           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3899                                                     'W' 'X'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  69
* SOCK03.cbl
  3900           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3901           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3902           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3903           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3904           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3905           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3906           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3907           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3908           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3909           88  CP-CSL-METH-1                   VALUE '5'.
  3910           88  CP-CSL-METH-2                   VALUE '6'.
  3911           88  CP-CSL-METH-3                   VALUE '7'.
  3912           88  CP-CSL-METH-4                   VALUE '8'.
  3913
  3914         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3915                                     COMP-3.
  3916         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3917         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3918         16  CP-STATE              PIC XX          VALUE SPACE.
  3919         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3920         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3921           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3922               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3923         16  CP-R78-OPTION         PIC X.
  3924           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3925           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3926
  3927         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3928         16  CP-IBNR-RESERVE-SW    PIC X.
  3929         16  CP-CLAIM-STATUS       PIC X.
  3930         16  CP-RATE-FILE          PIC X.
  3931         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3932                                     COMP-3.
  3933
  3934         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3935         16  CP-AH-OVERRIDE-CODE   PIC X.
  3936
  3937         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3938                                     COMP-3.
  3939         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3940                                   PIC S9(5)V99 COMP-3.
  3941         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3942                                     COMP-3.
  3943         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3944                                     COMP-3.
  3945         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3946                                     COMP-3.
  3947         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3948                                  PIC S9(7)V99 COMP-3.
  3949
  3950         16  CP-PAID-FROM-DATE     PIC X(02).
  3951         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3952         16  CP-EXT-DAYS-CALC      PIC X.
  3953           88  CP-EXT-NO-CHG                   VALUE ' '.
  3954           88  CP-EXT-CHG-LF                   VALUE '1'.
  3955           88  CP-EXT-CHG-AH                   VALUE '2'.
  3956           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3957         16  CP-DOMICILE-STATE     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  70
* SOCK03.cbl
  3958         16  CP-CARRIER            PIC X.
  3959         16  CP-REIN-FLAG          PIC X.
  3960         16  CP-REM-TRM-CALC-OPTION PIC X.
  3961           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3962                      '2' '3' '4' '5'.
  3963           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3964           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3965           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3966           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3967           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3968           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3969           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3970           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3971         16  CP-SIG-SWITCH         PIC X.
  3972         16  CP-RATING-METHOD      PIC X.
  3973           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3974           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3975           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3976           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3977           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3978           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3979           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3980           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3981           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3982         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3983                                     COMP-3.
  3984         16  CP-BEN-CATEGORY       PIC X.
  3985         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3986         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3987                                   PIC S99V9(5) COMP-3.
  3988         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3989         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3990                                   PIC S99V9(5) COMP-3.
  3991         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3992         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3993         16  CP-EXPIRE-DT          PIC XX.
  3994         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3995         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3996         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3997         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3998         16  CP-DDF-SPEC-CALC      PIC X.
  3999             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  4000             88  CP-CALC-CLP              VALUE 'C'.
  4001         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  4002         16  CP-CANCEL-REASON      PIC X.
  4003         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  4004         16  CP-PMT-MODE           PIC X.
  4005         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  4006         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  4007         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  4008         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  4009         16  FILLER                PIC X.
  4010
  4011***************    OUTPUT FROM ELRESV   ************************
  4012
  4013         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  4014
  4015         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  71
* SOCK03.cbl
  4016                                     COMP-3.
  4017         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  4018                                     COMP-3.
  4019         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  4020                                     COMP-3.
  4021         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  4022                                     COMP-3.
  4023         16  FILLER                PIC X(09).
  4024***************    OUTPUT FROM ELRTRM   *************************
  4025
  4026         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  4027                                     COMP-3.
  4028         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  4029                                     COMP-3.
  4030         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  4031                                     COMP-3.
  4032         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  4033                                     COMP-3.
  4034         16  FILLER                PIC X(12).
  4035
  4036***************    OUTPUT FROM ELRAMT   *************************
  4037
  4038         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  4039                                     COMP-3.
  4040         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  4041                                     COMP-3.
  4042         16  FILLER                PIC X(12).
  4043
  4044***************    OUTPUT FROM ELRATE   *************************
  4045
  4046         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  4047                                     COMP-3.
  4048         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  4049                                     COMP-3.
  4050         16  CP-MORTALITY-CODE     PIC X(4).
  4051         16  CP-RATE-EDIT-FLAG     PIC X.
  4052             88  CP-RATES-NEED-APR                  VALUE '1'.
  4053         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  4054                                     COMP-3.
  4055         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  4056         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  4057         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  4058                                   PIC S9(7)V99 COMP-3.
  4059         16  FILLER                PIC X(07).
  4060
  4061***************    OUTPUT FROM ELRFND   *************************
  4062
  4063         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  4064                                     COMP-3.
  4065         16  CP-REFUND-TYPE-USED   PIC X.
  4066           88  CP-R-AS-R78                         VALUE '1'.
  4067           88  CP-R-AS-PRORATA                     VALUE '2'.
  4068           88  CP-R-AS-CALIF                       VALUE '3'.
  4069           88  CP-R-AS-TEXAS                       VALUE '4'.
  4070           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  4071           88  CP-R-AS-NET-PAY                     VALUE '5'.
  4072           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  4073           88  CP-R-AS-MEAN                        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  72
* SOCK03.cbl
  4074           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  4075           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  4076           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  4077           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  4078           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  4079           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  4080         16  FILLER                PIC X(12).
  4081
  4082***************    OUTPUT FROM ELEARN   *************************
  4083
  4084         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  4085                                     COMP-3.
  4086         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  4087                                     COMP-3.
  4088         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  4089                                     COMP-3.
  4090         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  4091                                     COMP-3.
  4092         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  4093                                     COMP-3.
  4094         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  4095                                     COMP-3.
  4096         16  CP-EARNING-TYPE-USED  PIC X.
  4097           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  4098           88  CP-E-AS-R78                         VALUE '1'.
  4099           88  CP-E-AS-PRORATA                     VALUE '2'.
  4100           88  CP-E-AS-TEXAS                       VALUE '4'.
  4101           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  4102           88  CP-E-AS-NET-PAY                     VALUE '5'.
  4103           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  4104           88  CP-E-AS-MEAN                        VALUE '8'.
  4105           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  4106         16  FILLER                PIC X(12).
  4107
  4108***************    OUTPUT FROM ELPMNT   *************************
  4109
  4110         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4111                                     COMP-3.
  4112         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  4113                                     COMP-3.
  4114         16  FILLER                PIC X(12).
  4115
  4116***************   MISC WORK AREAS    *****************************
  4117         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4118                                     COMP-3.
  4119         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4120                                     COMP-3.
  4121         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4122                                     COMP-3.
  4123         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4124                                     COMP-3.
  4125         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4126                                     COMP-3.
  4127         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4128                                     COMP-3.
  4129         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4130             88  OPEN-RATE-FILE                   VALUE 'O'.
  4131             88  CLOSE-RATE-FILE                  VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  73
* SOCK03.cbl
  4132             88  IO-ERROR                         VALUE 'E'.
  4133
  4134         16  CP-FIRST-PAY-DATE     PIC XX.
  4135
  4136         16  CP-JOINT-INDICATOR    PIC X.
  4137
  4138         16  CP-RESERVE-REMAINING-TERM
  4139                                   PIC S9(4)V9    VALUE ZERO
  4140                                     COMP-3.
  4141
  4142         16  CP-INSURED-BIRTH-DT   PIC XX.
  4143
  4144         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4145                                     COMP-3.
  4146
  4147         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4148                                     COMP-3.
  4149
  4150         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4151                                     COMP-3.
  4152
  4153         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4154                                     COMP-3.
  4155
  4156         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4157                                     COMP-3.
  4158
  4159         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4160                                     COMP-3.
  4161
  4162         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4163                                     COMP-3.
  4164
  4165         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4166             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4167
  4168         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4169                                     COMP-3.
  4170         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4171                                     COMP-3.
  4172         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4173         16  cp-extra-periods      pic 9 value zeros.
  4174         16  cp-net-only-state     pic x value spaces.
  4175         16  FILLER                PIC X(13).
  4176******************************************************************
  4177****************************************************************
  4178*
  4179* Copyright (c) 2007-2013 Dell Inc.
  4180* All rights reserved.
  4181*
  4182****************************************************************
  4183 01  DFHEIV.
  4184   02  DFHEIV0               PIC X(35).
  4185   02  DFHEIV1               PIC X(08).
  4186   02  DFHEIV2               PIC X(08).
  4187   02  DFHEIV3               PIC X(08).
  4188   02  DFHEIV4               PIC X(06).
  4189   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  74
* SOCK03.cbl
  4190   02  DFHEIV6               PIC X(04).
  4191   02  DFHEIV7               PIC X(02).
  4192   02  DFHEIV8               PIC X(02).
  4193   02  DFHEIV9               PIC X(01).
  4194   02  DFHEIV10              PIC S9(7) COMP-3.
  4195   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4196   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4197   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4198   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4199   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4200   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4201   02  DFHEIV17              PIC X(04).
  4202   02  DFHEIV18              PIC X(04).
  4203   02  DFHEIV19              PIC X(04).
  4204   02  DFHEIV20              USAGE IS POINTER.
  4205   02  DFHEIV21              USAGE IS POINTER.
  4206   02  DFHEIV22              USAGE IS POINTER.
  4207   02  DFHEIV23              USAGE IS POINTER.
  4208   02  DFHEIV24              USAGE IS POINTER.
  4209   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4210   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4211   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4212   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4213   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4214   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4215   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4216   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4217   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4218   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4219   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4220   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4221   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4222   02  FILLER                PIC X(02).
  4223   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4224   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4225   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4226   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4227   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4228   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4229   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4230 LINKAGE  SECTION.
  4231*****************************************************************
  4232*                                                               *
  4233* Copyright (c) 2007-2013 Dell Inc.                             *
  4234* All rights reserved.                                          *
  4235*                                                               *
  4236*****************************************************************
  4237 01  dfheiblk.
  4238     02  eibtime          pic s9(7) comp-3.
  4239     02  eibdate          pic s9(7) comp-3.
  4240     02  eibtrnid         pic x(4).
  4241     02  eibtaskn         pic s9(7) comp-3.
  4242     02  eibtrmid         pic x(4).
  4243     02  dfheigdi         pic s9(4) comp.
  4244     02  eibcposn         pic s9(4) comp.
  4245     02  eibcalen         pic s9(4) comp.
  4246     02  eibaid           pic x(1).
  4247     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  75
* SOCK03.cbl
  4248     02  eibfn            pic x(2).
  4249     02  eibfiller2       pic x(2).
  4250     02  eibrcode         pic x(6).
  4251     02  eibfiller3       pic x(2).
  4252     02  eibds            pic x(8).
  4253     02  eibreqid         pic x(8).
  4254     02  eibrsrce         pic x(8).
  4255     02  eibsync          pic x(1).
  4256     02  eibfree          pic x(1).
  4257     02  eibrecv          pic x(1).
  4258     02  eibsend          pic x(1).
  4259     02  eibatt           pic x(1).
  4260     02  eibeoc           pic x(1).
  4261     02  eibfmh           pic x(1).
  4262     02  eibcompl         pic x(1).
  4263     02  eibsig           pic x(1).
  4264     02  eibconf          pic x(1).
  4265     02  eiberr           pic x(1).
  4266     02  eibrldbk         pic x(1).
  4267     02  eiberrcd         pic x(4).
  4268     02  eibsynrb         pic x(1).
  4269     02  eibnodat         pic x(1).
  4270     02  eibfiller5       pic x(2).
  4271     02  eibresp          pic s9(8) comp.
  4272     02  eibresp2         pic s9(8) comp.
  4273     02  dfheigdj         pic s9(4) comp.
  4274     02  dfheigdk         pic s9(4) comp.
  4275 01  DFHCOMMAREA.
  4276   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  4277   05 LSTN-NAME                PIC X(8).
  4278   05 LSTN-SUBNAME             PIC X(8).
  4279**** client-in-data cannot be more than 36 characters ***
  4280   05 CLIENT-IN-DATA           pic x(36).
  4281   05 SOCKADDR-IN-PARM.
  4282     15 SIN-FAMILY             PIC 9(4) COMP.
  4283     15 SIN-PORT               PIC 9(4) COMP.
  4284     15 SIN-ADDRESS            PIC 9(8) COMP.
  4285     15 SIN-ZERO               PIC X(8).
  4286 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4287 0000-DFHEXIT SECTION.
  4288     MOVE '9#                    $   ' TO DFHEIV0.
  4289     MOVE 'SOCK03' TO DFHEIV1.
  4290     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4291     display '  BEGIN SOCK03 '
  4292     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  4293     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  4294     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  4295        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  4296        evaluate true
  4297           when client-in-data (8:3) = 'AHL'
  4298              MOVE X'06'         TO WS-COMP-CD
  4299              MOVE 'AHL'         TO WS-SEND-BUF (5:3)
  4300                                    WS-COMP-ID
  4301           when CLIENT-IN-DATA (8:3) = 'DCC'
  4302              MOVE X'05'         TO WS-COMP-CD
  4303              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  4304                                    WS-COMP-ID
  4305           when CLIENT-IN-DATA (8:3) = 'VPP'
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  76
* SOCK03.cbl
  4306              MOVE X'07'         TO WS-COMP-CD
  4307              MOVE 'VPP'         TO WS-SEND-BUF (5:3)
  4308                                    WS-COMP-ID
  4309           when other
  4310              MOVE X'04'         TO WS-COMP-CD
  4311              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  4312                                    WS-COMP-ID
  4313        end-evaluate
  4314        move 'CSO'               to ws-send-buf (1:3)
  4315        move +25                 to ws-send-msg-size
  4316     END-IF
  4317     display 'SOCK03:sequence number  =', ws-seq-num.
  4318     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  4319     call "send" using by value GIVE-TAKE-SOCKET,
  4320         by reference ws-send-buf,
  4321         by value ws-send-msg-size,
  4322         by value ws-flags.
  4323     if return-code <= zero
  4324         display 'SOCK03:send error ',
  4325         go to socket-error.
  4326     move low-values to ws-recv-buf.
  4327     set ws-recv-total to zero.
  4328     compute ws-recv-left = ws-recv-msg-size.
  4329     display 'SOCK03:About to recv '
  4330     call "recv" using by value GIVE-TAKE-SOCKET,
  4331         by reference ws-recv-buf
  4332         by value ws-recv-msg-size,
  4333         by value ws-flags.
  4334     if return-code < zero
  4335        display 'SOCK03:recv error ',
  4336        go to socket-error.
  4337     if return-code = zero
  4338        display 'SOCK03:client disconnected',
  4339        go to socket-error.
  4340*
  4341     display 'SOCK03:Good recv  '
  4342     display 'SOCK03:return code      = ', return-code
  4343     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:89)
  4344     move +4096                  to ws-send-msg-size
  4345*    move +750                   to ws-send-msg-size
  4346     move ws-recv-buf (1:89)     to soc-client-in-data
  4347     MOVE SPACES                 TO WS-ELCERT-SW
  4348     MOVE X'0A'                  TO WS-HEX-0A
  4349     if client-account = 'EPIQ000001'
  4350        set ws-epiq-request to true
  4351        move spaces              to client-account
  4352     end-if
  4353     move +0 to ws-epiq-max
  4354     if client-car = spaces
  4355        if client-state = 'KY'
  4356           move '8'              to client-car
  4357        else
  4358           move '9'              to client-car
  4359        end-if
  4360     end-if
  4361     if client-grp = spaces
  4362        move '000000'            to client-grp
  4363     end-if
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  77
* SOCK03.cbl
  4364     EVALUATE TRUE
  4365        WHEN (CLIENT-CAR NOT = SPACES)
  4366           AND (CLIENT-STATE NOT = SPACES)
  4367           AND (CLIENT-ACCOUNT NOT = SPACES)
  4368           AND (CLIENT-EFF-DT NOT = SPACES)
  4369           AND (CLIENT-CERT-NO NOT = SPACES)
  4370           SET WS-ELCERT-FULL    TO TRUE
  4371        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4372           SET WS-ELCERT-CERT-NO TO TRUE
  4373*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4374*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4375        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4376           AND (CLIENT-LAST-NAME NOT = SPACES)
  4377           SET WS-ELCERT-ACT-NAME TO TRUE
  4378        WHEN CLIENT-LAST-NAME NOT = SPACES
  4379           SET WS-ELCERT-NAME    TO TRUE
  4380        when (client-vin not = spaces)
  4381           and (client-state not = spaces)
  4382           and (client-account not = spaces)
  4383           set ws-elcert-vin to true
  4384*          display ' SETTING VIN '
  4385        WHEN OTHER
  4386           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4387           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4388           MOVE ZEROS            TO WS-RESP
  4389           PERFORM 0030-BUILD-BUFFER
  4390                                 THRU 0030-EXIT
  4391           PERFORM 0020-SEND-BUFFER
  4392                                 THRU 0020-EXIT
  4393           PERFORM 0025-CLOSE-SOCKET
  4394                                 THRU 0025-EXIT
  4395           GO TO 0010-RETURN
  4396     END-EVALUATE
  4397     IF CLIENT-CAN-REASON = 'R'
  4398        MOVE 'R'                 TO WS-CANCEL-REASON
  4399     ELSE
  4400        MOVE ' '                 TO WS-CANCEL-REASON
  4401     END-IF
  4402     IF WS-ELCERT-KEY-SW NOT = SPACES
  4403        PERFORM 0050-BEGIN-REFUND-PROCESS
  4404                                 THRU 0050-EXIT
  4405     END-IF
  4406     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4407     .
  4408 0010-RETURN.
  4409
  4410* exec cics return end-exec.
  4411*    MOVE '.(                    ''   #00004408' TO DFHEIV0
  4412     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4413     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4414     MOVE X'2020233030303034343038' TO DFHEIV0(25:11)
  4415     CALL 'kxdfhei1' USING DFHEIV0,
  4416           DFHEIV99,
  4417           DFHEIV99,
  4418           DFHEIV99,
  4419           DFHEIV99,
  4420           DFHEIV99,
  4421           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  78
* SOCK03.cbl
  4422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4423
  4424
  4425* goback.
  4426     MOVE '9%                    "   ' TO DFHEIV0
  4427     MOVE 'SOCK03' TO DFHEIV1
  4428     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4429     goback.
  4430*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4431     .
  4432 0020-SEND-BUFFER.
  4433*    display 'SOCK03:sequence number  =', ws-seq-num.
  4434     display 'SOCK03:send buffer      =', ws-send-buf(1:500).
  4435     call "send" using by value GIVE-TAKE-SOCKET,
  4436         by reference ws-send-buf,
  4437         by value ws-send-msg-size,
  4438         by value ws-flags.
  4439     if return-code <= zero
  4440         display 'SOCK03:send error ' return-code,
  4441         go to socket-error.
  4442 0020-EXIT.
  4443     EXIT.
  4444 0025-CLOSE-SOCKET.
  4445*    display 'SOCK03:closing socket'.
  4446*    call "close" using by value GIVE-TAKE-SOCKET .
  4447*    display 'SOCK03:done'.
  4448     .
  4449 0025-EXIT.
  4450     EXIT.
  4451*
  4452* set up the receive buffer
  4453*
  4454     move low-values to ws-recv-buf.
  4455     set ws-recv-total to zero.
  4456     compute ws-recv-left = ws-recv-msg-size.
  4457*
  4458* receive data
  4459*
  4460 recv-1.
  4461     call "recv" using by value GIVE-TAKE-SOCKET,
  4462         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4463         by value ws-recv-left,
  4464         by value ws-flags.
  4465*
  4466* test what was received and decide what we should do
  4467*
  4468     if return-code < zero
  4469        display 'SOCK03:recv error ',
  4470        go to socket-error.
  4471     if return-code = zero
  4472        display 'SOCK03:client disconnected',
  4473        go to socket-error.
  4474*
  4475* have we received all the data yet?
  4476*
  4477     compute ws-recv-total = ws-recv-total + return-code.
  4478     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4479*
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  79
* SOCK03.cbl
  4480* not yet
  4481*
  4482     if ws-recv-left > 0 go to recv-1.
  4483*
  4484* received all the data
  4485*
  4486*    display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4487*
  4488* make sure what we received was what we sent
  4489*
  4490*    if ws-recv-buf <> ws-send-buf
  4491*        display "SOCK03:data doesn't match",
  4492*        go to socket-error.
  4493*
  4494* end of pass
  4495*
  4496*loop-end.
  4497*    if ws-seq-num = 5 go to socket-error.
  4498*    go to loop-1.
  4499*
  4500* program end
  4501*
  4502 socket-error.
  4503     if ws-seq-num <> 0
  4504         display "SOCK03:did not complete".
  4505*
  4506* flush the send buffer and deallocate
  4507*
  4508*    display 'SOCK03:closing socket'.
  4509*    call "close" using by value GIVE-TAKE-SOCKET .
  4510*
  4511* finised return to cics
  4512*
  4513 socket-fin.
  4514*    display 'SOCK03:closing socket'.
  4515*    call "close" using by value GIVE-TAKE-SOCKET .
  4516*    display 'SOCK03:done'.
  4517
  4518* exec cics return end-exec.
  4519*    MOVE '.(                    ''   #00004498' TO DFHEIV0
  4520     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4521     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4522     MOVE X'2020233030303034343938' TO DFHEIV0(25:11)
  4523     CALL 'kxdfhei1' USING DFHEIV0,
  4524           DFHEIV99,
  4525           DFHEIV99,
  4526           DFHEIV99,
  4527           DFHEIV99,
  4528           DFHEIV99,
  4529           DFHEIV99
  4530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4531
  4532
  4533* goback.
  4534     MOVE '9%                    "   ' TO DFHEIV0
  4535     MOVE 'SOCK03' TO DFHEIV1
  4536     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4537     goback.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  80
* SOCK03.cbl
  4538 0030-BUILD-BUFFER.
  4539     MOVE SPACES                 TO WS-SEND-BUF
  4540     IF WS-CALL-TYPE = 'NEWBUS'
  4541        STRING
  4542           WS-COMMENT            ';'
  4543           WS-RESP               ';'
  4544           WS-CARRIER            ';'
  4545           WS-GROUPING           ';'
  4546           WS-STATE              ';'
  4547           WS-ACCOUNT            ';'
  4548           WS-CERT-EFF-DATE      ';'
  4549           WS-CERT-NO            ';'
  4550           WS-LAST-NAME          ';'
  4551           WS-FIRST-NAME         ';'
  4552           WS-MID-INIT           ';'
  4553           WS-LAST-JNAME         ';'
  4554           WS-FIRST-JNAME        ';'
  4555           WS-MID-JINIT          ';'
  4556           WS-POST-CARD-SW       ';'
  4557           ws-lf-coverage-type   ';'
  4558           WS-LF-STATUS          ';'
  4559           WS-LF-BEN-CODE        ';'
  4560           WS-LF-BEN-CODE-DESC   ';'
  4561           WS-LF-TERM            ';'
  4562           WS-LF-REM-TERM        ';'
  4563           WS-LF-PREM            ';'
  4564           WS-LF-REFUND          ';'
  4565           WS-LF-METHOD          ';'
  4566           WS-LF-ORIG-BENEFIT    ';'
  4567           WS-LF-REM-BEN         ';'
  4568           WS-LF-EXPIRE-DATE     ';'
  4569           WS-LF-COMM            ';'
  4570           WS-LF-UEC             ';'
  4571           WS-AH-COVERAGE-TYPE   ';'
  4572           WS-AH-STATUS          ';'
  4573           WS-AH-BEN-CODE        ';'
  4574           WS-AH-BEN-CODE-DESC   ';'
  4575           WS-AH-TERM            ';'
  4576           WS-AH-REM-TERM        ';'
  4577           WS-AH-PREM            ';'
  4578           WS-AH-REFUND          ';'
  4579           WS-AH-METHOD          ';'
  4580           WS-AH-ORIG-BENEFIT    ';'
  4581           WS-AH-REM-BEN         ';'
  4582           WS-AH-EXPIRE-DATE     ';'
  4583           WS-AH-COMM            ';'
  4584           WS-AH-UEC             ';'
  4585           WS-ACCOUNT-NAME       ';'
  4586           WS-REPORT-CODE-1      ';'
  4587           WS-REPORT-CODE-2      ';'
  4588           WS-REPORT-CODE-3      ';'
  4589           WS-CLM-PAID-THRU-DT   ';'
  4590           WS-LF-CANCEL-DATE     ';'
  4591           WS-AH-CANCEL-DATE     ';'
  4592           WS-VIN                ';'
  4593           WS-CRED-BENE-NAME     ';'
  4594           WS-HEX-0A
  4595            DELIMITED BY '  ' INTO WS-SEND-BUF
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  81
* SOCK03.cbl
  4596        END-STRING
  4597     ELSE
  4598        STRING
  4599           WS-COMMENT            ';'  *> 0
  4600           WS-RESP               ';'
  4601           WS-CARRIER            ';'
  4602           WS-GROUPING           ';'
  4603           WS-STATE              ';'
  4604           WS-ACCOUNT            ';'
  4605           WS-CERT-EFF-DATE      ';'
  4606           WS-CERT-NO            ';'
  4607           WS-LAST-NAME          ';'
  4608           WS-FIRST-NAME         ';'
  4609           WS-MID-INIT           ';'
  4610           WS-LAST-JNAME         ';'
  4611           WS-FIRST-JNAME        ';'
  4612           WS-MID-JINIT          ';'
  4613           WS-POST-CARD-SW       ';'
  4614           WS-LF-STATUS          ';'
  4615           WS-LF-BEN-CODE        ';'  *> 16
  4616           WS-LF-BEN-CODE-DESC   ';'
  4617           WS-LF-TERM            ';'
  4618           WS-LF-REM-TERM        ';'
  4619           WS-LF-PREM            ';'
  4620           WS-LF-REFUND          ';'
  4621           WS-LF-METHOD          ';'
  4622           WS-LF-ORIG-BENEFIT    ';'
  4623           WS-LF-REM-BEN         ';'
  4624           WS-LF-EXPIRE-DATE     ';'
  4625           WS-LF-COMM            ';'
  4626           WS-LF-UEC             ';'
  4627           WS-AH-STATUS          ';'
  4628           WS-AH-BEN-CODE        ';'   *> 29
  4629           WS-AH-BEN-CODE-DESC   ';'
  4630           WS-AH-TERM            ';'
  4631           WS-AH-REM-TERM        ';'
  4632           WS-AH-PREM            ';'   *> 32
  4633           WS-AH-REFUND          ';'   *> 33
  4634           WS-AH-METHOD          ';'
  4635           WS-AH-ORIG-BENEFIT    ';'   *> 36
  4636           WS-AH-REM-BEN         ';'
  4637           WS-AH-EXPIRE-DATE     ';'
  4638           WS-AH-COMM            ';'
  4639           WS-AH-UEC             ';'
  4640           WS-ACCOUNT-NAME       ';'
  4641           WS-REPORT-CODE-1      ';'
  4642           WS-REPORT-CODE-2      ';'
  4643           WS-REPORT-CODE-3      ';'
  4644           WS-CLM-PAID-THRU-DT   ';'
  4645           WS-LF-CANCEL-DATE     ';'
  4646           WS-AH-CANCEL-DATE     ';'
  4647           WS-VIN                ';'
  4648           WS-CRED-BENE-NAME     ';'
  4649           'E'                   ';'
  4650            DELIMITED BY '  ' INTO WS-SEND-BUF
  4651        END-STRING
  4652     END-IF
  4653     .
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  82
* SOCK03.cbl
  4654 0030-EXIT.
  4655     EXIT.
  4656 0050-BEGIN-REFUND-PROCESS.
  4657     IF WS-ELCERT-ACT-NAME
  4658        PERFORM 0060-FIND-FULL-KEY
  4659                                 THRU 0060-EXIT
  4660        MOVE AM-CARRIER          TO CLIENT-CAR
  4661        MOVE AM-GROUPING         TO CLIENT-GRP
  4662        MOVE AM-STATE            TO CLIENT-STATE
  4663     END-IF
  4664     PERFORM 0100-START-ELCERT   THRU 0100-EXIT
  4665     IF NOT RESP-NORMAL
  4666        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4667        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4668        MOVE WS-RESPONSE         TO WS-RESP
  4669        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4670        PERFORM 0020-SEND-BUFFER
  4671                                 THRU 0020-EXIT
  4672        PERFORM 0025-CLOSE-SOCKET
  4673                                 THRU 0025-EXIT
  4674        GO TO 0010-RETURN
  4675     END-IF
  4676     PERFORM 0150-READ-NEXT-ELCERT
  4677                                 THRU 0150-EXIT
  4678*    display ' came back from 0150 ' ws-response
  4679     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4680        DISPLAY ' CERT NOT FOUND '
  4681        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4682        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4683        MOVE WS-RESPONSE         TO WS-RESP
  4684        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4685        PERFORM 0020-SEND-BUFFER
  4686                                 THRU 0020-EXIT
  4687        PERFORM 0025-CLOSE-SOCKET
  4688                                 THRU 0025-EXIT
  4689        GO TO 0010-RETURN
  4690     END-IF
  4691     PERFORM 0200-BEGIN-REFUND-PROCESS
  4692                                 THRU 0200-EXIT UNTIL
  4693        ELCERT-FINISHED
  4694     .
  4695 0050-EXIT.
  4696     EXIT.
  4697 0060-FIND-FULL-KEY.
  4698     MOVE ' ' TO WS-STOP-SW
  4699     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4700     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4701
  4702* EXEC CICS STARTBR
  4703*       DATASET  ('ERACCT3')
  4704*       RIDFLD   (WS-AM3-KEY)
  4705*       GTEQ
  4706*       RESP (WS-RESPONSE)
  4707*    END-EXEC
  4708     MOVE 'ERACCT3' TO DFHEIV1
  4709     MOVE 0
  4710       TO DFHEIV11
  4711*    MOVE '&,         G          &  N#00004663' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  83
* SOCK03.cbl
  4712     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4713     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4714     MOVE X'204E233030303034363633' TO DFHEIV0(25:11)
  4715     CALL 'kxdfhei1' USING DFHEIV0,
  4716           DFHEIV1,
  4717           WS-AM3-KEY,
  4718           DFHEIV99,
  4719           DFHEIV11,
  4720           DFHEIV99
  4721     MOVE EIBRESP  TO WS-RESPONSE
  4722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4723     IF RESP-NORMAL
  4724        PERFORM UNTIL TOLD-TO-STOP
  4725
  4726* EXEC CICS READNEXT
  4727*             DATASET  ('ERACCT3')
  4728*             INTO     (ACCOUNT-MASTER)
  4729*             RIDFLD   (WS-AM3-KEY)
  4730*          END-EXEC
  4731     MOVE LENGTH OF
  4732      ACCOUNT-MASTER
  4733       TO DFHEIV12
  4734     MOVE 'ERACCT3' TO DFHEIV1
  4735     MOVE 0
  4736       TO DFHEIV11
  4737*    MOVE '&.IL                  )   #00004671' TO DFHEIV0
  4738     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4739     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4740     MOVE X'2020233030303034363731' TO DFHEIV0(25:11)
  4741     CALL 'kxdfhei1' USING DFHEIV0,
  4742           DFHEIV1,
  4743           ACCOUNT-MASTER,
  4744           DFHEIV12,
  4745           WS-AM3-KEY,
  4746           DFHEIV99,
  4747           DFHEIV11,
  4748           DFHEIV99,
  4749           DFHEIV99
  4750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4751           EVALUATE TRUE
  4752              WHEN (RESP-NORMAL)
  4753                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4754                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4755                 SET TOLD-TO-STOP TO TRUE
  4756              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4757                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4758                 CONTINUE
  4759              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4760                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4761                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4762                 MOVE ZEROS      TO WS-RESP
  4763                 PERFORM 0030-BUILD-BUFFER
  4764                                 THRU 0030-EXIT
  4765                 PERFORM 0020-SEND-BUFFER
  4766                                 THRU 0020-EXIT
  4767                 PERFORM 0025-CLOSE-SOCKET
  4768                                 THRU 0025-EXIT
  4769                 GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  84
* SOCK03.cbl
  4770           END-EVALUATE
  4771        END-PERFORM
  4772
  4773* EXEC CICS ENDBR
  4774*          DATASET   ('ERACCT3')
  4775*       END-EXEC
  4776     MOVE 'ERACCT3' TO DFHEIV1
  4777     MOVE 0
  4778       TO DFHEIV11
  4779*    MOVE '&2                    $   #00004697' TO DFHEIV0
  4780     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4781     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4782     MOVE X'2020233030303034363937' TO DFHEIV0(25:11)
  4783     CALL 'kxdfhei1' USING DFHEIV0,
  4784           DFHEIV1,
  4785           DFHEIV11,
  4786           DFHEIV99
  4787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4788     ELSE
  4789        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4790        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4791        MOVE ZEROS      TO WS-RESP
  4792        PERFORM 0030-BUILD-BUFFER
  4793                                 THRU 0030-EXIT
  4794        PERFORM 0020-SEND-BUFFER
  4795                                 THRU 0020-EXIT
  4796        PERFORM 0025-CLOSE-SOCKET
  4797                                 THRU 0025-EXIT
  4798        GO TO 0010-RETURN
  4799     END-IF
  4800     .
  4801 0060-EXIT.
  4802     EXIT.
  4803 0100-START-ELCERT.
  4804     MOVE SPACES                 TO WS-SEND-BUF
  4805     INITIALIZE WS-STRING-DATA
  4806     MOVE LOW-VALUES             TO WS-CM-KEY
  4807                                    WS-CM-KEY-A1
  4808                                    WS-CM-KEY-A4
  4809     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4810                                    WS-CM-COMPANY-CD-A1
  4811                                    WS-CM-COMPANY-CD-A4
  4812     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4813     MOVE 'L'                    TO DC-OPTION-CODE
  4814     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4815     IF NO-CONVERSION-ERROR
  4816        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4817     ELSE
  4818        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4819        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4820        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4821        PERFORM 0020-SEND-BUFFER
  4822                                 THRU 0020-EXIT
  4823        PERFORM 0025-CLOSE-SOCKET
  4824                                 THRU 0025-EXIT
  4825        GO TO 0010-RETURN
  4826     END-IF
  4827     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  85
* SOCK03.cbl
  4828        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4829        MOVE 'L'                 TO DC-OPTION-CODE
  4830        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4831        IF NO-CONVERSION-ERROR
  4832           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4833        ELSE
  4834           MOVE 'BAD EFF DT CONVERT '
  4835                                 TO WS-COMMENT
  4836           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4837           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4838           PERFORM 0020-SEND-BUFFER
  4839                                 THRU 0020-EXIT
  4840           PERFORM 0025-CLOSE-SOCKET
  4841                                 THRU 0025-EXIT
  4842           GO TO 0010-RETURN
  4843        END-IF
  4844     END-IF
  4845     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4846        (F1 > +10)
  4847        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4848     END-PERFORM
  4849     IF F1 > +1
  4850        SUBTRACT +1 FROM F1
  4851     END-IF
  4852     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4853        (L1 > +15)
  4854        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4855     END-PERFORM
  4856     IF L1 > +1
  4857        SUBTRACT +1 FROM L1
  4858     END-IF
  4859     EVALUATE TRUE
  4860        WHEN WS-ELCERT-FULL
  4861           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4862           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4863           MOVE CLIENT-STATE        TO WS-CM-STATE
  4864           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4865           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4866           MOVE CLIENT-CERT-NO      TO WS-CM-CERT-NO
  4867
  4868* EXEC CICS READ
  4869*             INTO    (CERTIFICATE-MASTER)
  4870*             DATASET ('ELCERT')
  4871*             RIDFLD  (WS-CM-KEY)
  4872*             RESP    (WS-RESPONSE)
  4873*          END-EXEC
  4874     MOVE LENGTH OF
  4875      CERTIFICATE-MASTER
  4876       TO DFHEIV11
  4877     MOVE 'ELCERT' TO DFHEIV1
  4878*    MOVE '&"IL       E          (  N#00004779' TO DFHEIV0
  4879     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4880     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4881     MOVE X'204E233030303034373739' TO DFHEIV0(25:11)
  4882     CALL 'kxdfhei1' USING DFHEIV0,
  4883           DFHEIV1,
  4884           CERTIFICATE-MASTER,
  4885           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  86
* SOCK03.cbl
  4886           WS-CM-KEY,
  4887           DFHEIV99,
  4888           DFHEIV99,
  4889           DFHEIV99
  4890     MOVE EIBRESP  TO WS-RESPONSE
  4891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4892        WHEN WS-ELCERT-ACT-NAME
  4893           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4894           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4895           MOVE CLIENT-STATE        TO WS-CM-STATE
  4896           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4897           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4898           MOVE ZEROS               TO WS-CM-CERT-NO
  4899
  4900* EXEC CICS STARTBR
  4901*             DATASET ('ELCERT')
  4902*             RIDFLD  (WS-CM-KEY)
  4903*             RESP    (WS-RESPONSE)
  4904*          END-EXEC
  4905     MOVE 'ELCERT' TO DFHEIV1
  4906     MOVE 0
  4907       TO DFHEIV11
  4908*    MOVE '&,         G          &  N#00004792' TO DFHEIV0
  4909     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4910     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4911     MOVE X'204E233030303034373932' TO DFHEIV0(25:11)
  4912     CALL 'kxdfhei1' USING DFHEIV0,
  4913           DFHEIV1,
  4914           WS-CM-KEY,
  4915           DFHEIV99,
  4916           DFHEIV11,
  4917           DFHEIV99
  4918     MOVE EIBRESP  TO WS-RESPONSE
  4919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4920        WHEN WS-ELCERT-NAME
  4921           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4922           MOVE SPACES           TO WS-CM-INITIALS
  4923           COMPUTE WS-LENGTH = L1 + +1
  4924
  4925* EXEC CICS STARTBR
  4926*             DATASET   ('ELCERT2')
  4927*             RIDFLD    (WS-CM-KEY-A1)
  4928*             GENERIC
  4929*             KEYLENGTH (WS-LENGTH)
  4930*             GTEQ
  4931*             RESP      (WS-RESPONSE)
  4932*          END-EXEC
  4933     MOVE 'ELCERT2' TO DFHEIV1
  4934     MOVE 0
  4935       TO DFHEIV11
  4936*    MOVE '&,   KG    G          &  N#00004801' TO DFHEIV0
  4937     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4938     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4939     MOVE X'204E233030303034383031' TO DFHEIV0(25:11)
  4940     CALL 'kxdfhei1' USING DFHEIV0,
  4941           DFHEIV1,
  4942           WS-CM-KEY-A1,
  4943           WS-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  87
* SOCK03.cbl
  4944           DFHEIV11,
  4945           DFHEIV99
  4946     MOVE EIBRESP  TO WS-RESPONSE
  4947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4948*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4949*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4950        WHEN WS-ELCERT-CERT-NO
  4951* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4952           MOVE +11 TO WS-LENGTH
  4953           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4954
  4955* EXEC CICS STARTBR
  4956*             DATASET   ('ELCERT5')
  4957*             RIDFLD    (WS-CM-KEY-A4)
  4958*             GENERIC
  4959*             KEYLENGTH (WS-LENGTH)
  4960*             GTEQ
  4961*             RESP      (WS-RESPONSE)
  4962*          END-EXEC
  4963     MOVE 'ELCERT5' TO DFHEIV1
  4964     MOVE 0
  4965       TO DFHEIV11
  4966*    MOVE '&,   KG    G          &  N#00004815' TO DFHEIV0
  4967     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4968     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4969     MOVE X'204E233030303034383135' TO DFHEIV0(25:11)
  4970     CALL 'kxdfhei1' USING DFHEIV0,
  4971           DFHEIV1,
  4972           WS-CM-KEY-A4,
  4973           WS-LENGTH,
  4974           DFHEIV11,
  4975           DFHEIV99
  4976     MOVE EIBRESP  TO WS-RESPONSE
  4977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4978        when ws-elcert-vin
  4979           move low-values       to ws-cs-key
  4980           move ws-comp-cd       to ws-cs-company-cd
  4981           move client-car       to ws-cs-carrier
  4982           move client-grp       to ws-cs-group
  4983           move client-state     to ws-cs-state
  4984           move client-account   to ws-cs-account
  4985
  4986* exec cics startbr
  4987*             dataset   ('ELCRTT')
  4988*             RIDFLD    (WS-CS-KEY)
  4989*             GTEQ
  4990*             RESP      (WS-RESPONSE)
  4991*          END-EXEC
  4992     MOVE 'ELCRTT' TO DFHEIV1
  4993     MOVE 0
  4994       TO DFHEIV11
  4995*    MOVE '&,         G          &  N#00004830' TO DFHEIV0
  4996     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4997     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4998     MOVE X'204E233030303034383330' TO DFHEIV0(25:11)
  4999     CALL 'kxdfhei1' USING DFHEIV0,
  5000           DFHEIV1,
  5001           WS-CS-KEY,
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  88
* SOCK03.cbl
  5002           DFHEIV99,
  5003           DFHEIV11,
  5004           DFHEIV99
  5005     MOVE EIBRESP  TO WS-RESPONSE
  5006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5007     END-EVALUATE
  5008     .
  5009 0100-EXIT.
  5010     EXIT.
  5011 0150-READ-NEXT-ELCERT.
  5012     EVALUATE TRUE
  5013        WHEN WS-ELCERT-ACT-NAME
  5014*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  5015
  5016* EXEC CICS READNEXT
  5017*             DATASET   ('ELCERT')
  5018*             RIDFLD    (WS-CM-KEY)
  5019*             INTO      (CERTIFICATE-MASTER)
  5020*             RESP      (WS-RESPONSE)
  5021*          END-EXEC
  5022     MOVE LENGTH OF
  5023      CERTIFICATE-MASTER
  5024       TO DFHEIV12
  5025     MOVE 'ELCERT' TO DFHEIV1
  5026     MOVE 0
  5027       TO DFHEIV11
  5028*    MOVE '&.IL                  )  N#00004844' TO DFHEIV0
  5029     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5030     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5031     MOVE X'204E233030303034383434' TO DFHEIV0(25:11)
  5032     CALL 'kxdfhei1' USING DFHEIV0,
  5033           DFHEIV1,
  5034           CERTIFICATE-MASTER,
  5035           DFHEIV12,
  5036           WS-CM-KEY,
  5037           DFHEIV99,
  5038           DFHEIV11,
  5039           DFHEIV99,
  5040           DFHEIV99
  5041     MOVE EIBRESP  TO WS-RESPONSE
  5042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5043        WHEN WS-ELCERT-NAME
  5044*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  5045
  5046* EXEC CICS READNEXT
  5047*             DATASET   ('ELCERT2')
  5048*             RIDFLD    (WS-CM-KEY-A1)
  5049*             INTO      (CERTIFICATE-MASTER)
  5050*             RESP      (WS-RESPONSE)
  5051*          END-EXEC
  5052     MOVE LENGTH OF
  5053      CERTIFICATE-MASTER
  5054       TO DFHEIV12
  5055     MOVE 'ELCERT2' TO DFHEIV1
  5056     MOVE 0
  5057       TO DFHEIV11
  5058*    MOVE '&.IL                  )  N#00004852' TO DFHEIV0
  5059     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  89
* SOCK03.cbl
  5060     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5061     MOVE X'204E233030303034383532' TO DFHEIV0(25:11)
  5062     CALL 'kxdfhei1' USING DFHEIV0,
  5063           DFHEIV1,
  5064           CERTIFICATE-MASTER,
  5065           DFHEIV12,
  5066           WS-CM-KEY-A1,
  5067           DFHEIV99,
  5068           DFHEIV11,
  5069           DFHEIV99,
  5070           DFHEIV99
  5071     MOVE EIBRESP  TO WS-RESPONSE
  5072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5073        WHEN WS-ELCERT-CERT-NO
  5074
  5075* EXEC CICS READNEXT
  5076*             DATASET   ('ELCERT5')
  5077*             RIDFLD    (WS-CM-KEY-A4)
  5078*             INTO      (CERTIFICATE-MASTER)
  5079*             RESP      (WS-RESPONSE)
  5080*          END-EXEC
  5081     MOVE LENGTH OF
  5082      CERTIFICATE-MASTER
  5083       TO DFHEIV12
  5084     MOVE 'ELCERT5' TO DFHEIV1
  5085     MOVE 0
  5086       TO DFHEIV11
  5087*    MOVE '&.IL                  )  N#00004859' TO DFHEIV0
  5088     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5089     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5090     MOVE X'204E233030303034383539' TO DFHEIV0(25:11)
  5091     CALL 'kxdfhei1' USING DFHEIV0,
  5092           DFHEIV1,
  5093           CERTIFICATE-MASTER,
  5094           DFHEIV12,
  5095           WS-CM-KEY-A4,
  5096           DFHEIV99,
  5097           DFHEIV11,
  5098           DFHEIV99,
  5099           DFHEIV99
  5100     MOVE EIBRESP  TO WS-RESPONSE
  5101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5102        WHEN WS-ELCERT-VIN
  5103
  5104* EXEC CICS READNEXT
  5105*             DATASET   ('ELCRTT')
  5106*             RIDFLD    (WS-CS-KEY)
  5107*             INTO      (CERTIFICATE-TRAILERS)
  5108*             RESP      (WS-RESPONSE)
  5109*          END-EXEC
  5110     MOVE LENGTH OF
  5111      CERTIFICATE-TRAILERS
  5112       TO DFHEIV12
  5113     MOVE 'ELCRTT' TO DFHEIV1
  5114     MOVE 0
  5115       TO DFHEIV11
  5116*    MOVE '&.IL                  )  N#00004866' TO DFHEIV0
  5117     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  90
* SOCK03.cbl
  5118     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5119     MOVE X'204E233030303034383636' TO DFHEIV0(25:11)
  5120     CALL 'kxdfhei1' USING DFHEIV0,
  5121           DFHEIV1,
  5122           CERTIFICATE-TRAILERS,
  5123           DFHEIV12,
  5124           WS-CS-KEY,
  5125           DFHEIV99,
  5126           DFHEIV11,
  5127           DFHEIV99,
  5128           DFHEIV99
  5129     MOVE EIBRESP  TO WS-RESPONSE
  5130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5131     END-EVALUATE
  5132     .
  5133 0150-EXIT.
  5134     EXIT.
  5135 0200-BEGIN-REFUND-PROCESS.
  5136     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5137                                    WS-ERACCT-SW
  5138     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  5139                                    WS-NCB-DIFF-ODD-DAYS
  5140     INITIALIZE WS-STRING-DATA
  5141     IF RESP-NORMAL OR RESP-DUPKEY
  5142        EVALUATE TRUE
  5143           WHEN WS-ELCERT-ACT-NAME
  5144              EVALUATE TRUE
  5145                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  5146                    OR (CM-CARRIER NOT = CLIENT-CAR)
  5147                    OR (CM-GROUPING NOT = CLIENT-GRP)
  5148                    OR (CM-STATE NOT = CLIENT-STATE)
  5149                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  5150                    SET ELCERT-FINISHED TO TRUE
  5151                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  5152                    CLIENT-LAST-NAME (1:L1))
  5153                    GO TO 0200-CONTINUE
  5154                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  5155                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5156                    GO TO 0200-CONTINUE
  5157                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  5158                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5159                     CLIENT-FIRST-NAME (1:F1)))
  5160                    GO TO 0200-CONTINUE
  5161                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  5162                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5163                    GO TO 0200-CONTINUE
  5164              END-EVALUATE
  5165           WHEN WS-ELCERT-CERT-NO
  5166              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5167                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  5168                 SET ELCERT-FINISHED TO TRUE
  5169              ELSE
  5170                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5171                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5172                              OR
  5173                    ((CLIENT-LAST-NAME NOT = SPACES)
  5174                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  5175                        CLIENT-LAST-NAME (1:L1)))
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  91
* SOCK03.cbl
  5176                              OR
  5177                    ((CLIENT-FIRST-NAME NOT = SPACES)
  5178                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5179                        CLIENT-FIRST-NAME (1:F1)))
  5180                              OR
  5181                    ((CLIENT-ACCOUNT NOT = SPACES)
  5182                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5183                     GO TO 0200-CONTINUE
  5184                 END-IF
  5185              END-IF
  5186           WHEN WS-ELCERT-NAME
  5187              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5188                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  5189                    CLIENT-LAST-NAME (1:L1))
  5190                  SET ELCERT-FINISHED TO TRUE
  5191              ELSE
  5192                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5193                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5194                           OR
  5195                 ((CLIENT-FIRST-NAME NOT = SPACES)
  5196                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5197                     CLIENT-FIRST-NAME (1:F1)))
  5198                           OR
  5199                 ((CLIENT-ACCOUNT NOT = SPACES)
  5200                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5201                  GO TO 0200-CONTINUE
  5202                 END-IF
  5203              END-IF
  5204           WHEN WS-ELCERT-VIN
  5205              evaluate true
  5206                 when (CS-COMPANY-CD NOT = WS-COMP-CD)
  5207                    OR (CS-STATE NOT = CLIENT-STATE)
  5208                    OR (CS-ACCOUNT NOT = CLIENT-ACCOUNT)
  5209                    SET ELCERT-FINISHED TO TRUE
  5210                 when (cs-trailer-type  = 'C')
  5211                    and (cs-vin-number = client-vin)
  5212                    continue
  5213                 when (cs-trailer-type  = 'C')
  5214                    and (cs-vin-number(10:8) = client-vin(1:8))
  5215                    continue
  5216                 when other
  5217                    go to 0200-continue
  5218              end-evaluate
  5219           WHEN OTHER
  5220              SET ELCERT-FINISHED   TO TRUE
  5221        END-EVALUATE
  5222     ELSE
  5223        SET ELCERT-FINISHED TO TRUE
  5224     END-IF
  5225     if ws-elcert-vin
  5226        move cs-control-primary(1:33)
  5227                                 to ws-cm-key
  5228
  5229* EXEC CICS READ
  5230*          INTO    (CERTIFICATE-MASTER)
  5231*          DATASET ('ELCERT')
  5232*          RIDFLD  (WS-CM-KEY)
  5233*          RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  92
* SOCK03.cbl
  5234*       END-EXEC
  5235     MOVE LENGTH OF
  5236      CERTIFICATE-MASTER
  5237       TO DFHEIV11
  5238     MOVE 'ELCERT' TO DFHEIV1
  5239*    MOVE '&"IL       E          (  N#00004969' TO DFHEIV0
  5240     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5241     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5242     MOVE X'204E233030303034393639' TO DFHEIV0(25:11)
  5243     CALL 'kxdfhei1' USING DFHEIV0,
  5244           DFHEIV1,
  5245           CERTIFICATE-MASTER,
  5246           DFHEIV11,
  5247           WS-CM-KEY,
  5248           DFHEIV99,
  5249           DFHEIV99,
  5250           DFHEIV99
  5251     MOVE EIBRESP  TO WS-RESPONSE
  5252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5253        if not resp-normal
  5254           set elcert-finished to true
  5255        end-if
  5256     end-if
  5257*       IF WS-ELCERT-CERT-NO
  5258*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5259*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  5260*                          OR
  5261*                ((CLIENT-EFF-DT NOT = SPACES)
  5262*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5263*                          OR
  5264*                ((CLIENT-LAST-NAME NOT = SPACES)
  5265*                 AND (CM-INSURED-LAST-NAME NOT =
  5266*                    CLIENT-LAST-NAME))
  5267*                 SET ELCERT-FINISHED TO TRUE
  5268*          END-IF
  5269*          IF WS-ELCERT-NAME
  5270*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5271*                OR (CM-INSURED-LAST-NAME NOT =
  5272*                   CLIENT-LAST-NAME)
  5273*                            OR
  5274*                ((CLIENT-EFF-DT NOT = SPACES)
  5275*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5276*                 SET ELCERT-FINISHED TO TRUE
  5277*             END-IF
  5278*          ELSE
  5279*             SET ELCERT-FINISHED   TO TRUE
  5280*          END-IF
  5281     IF NOT WS-ELCERT-FULL
  5282        IF ELCERT-FINISHED
  5283           GO TO 0200-EXIT
  5284        END-IF
  5285     END-IF
  5286     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  5287        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  5288        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5289        PERFORM 0030-BUILD-BUFFER
  5290                                 THRU 0030-EXIT
  5291        PERFORM 0020-SEND-BUFFER
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  93
* SOCK03.cbl
  5292                                 THRU 0020-EXIT
  5293        GO TO 0200-CONTINUE
  5294     END-IF
  5295     if (ws-epiq-request)
  5296        and (not EPIQ-CLASS)
  5297        go to 0200-continue
  5298     end-if
  5299
  5300     if ws-epiq-request
  5301        add +1 to ws-epiq-max
  5302        if ws-epiq-max > +100
  5303           go to 0200-continue
  5304        end-if
  5305     end-if
  5306     PERFORM 0300-GET-ELCNTL-RECORDS
  5307                                 THRU 0300-EXIT
  5308     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  5309     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  5310     MOVE +0                     TO DC-ELAPSED-MONTHS
  5311                                    DC-ELAPSED-DAYS
  5312     MOVE '1'                    TO DC-OPTION-CODE
  5313     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5314     IF NO-CONVERSION-ERROR
  5315        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  5316        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  5317     END-IF
  5318     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  5319     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  5320     perform 0610-get-ermail     thru 0610-exit
  5321     perform 0620-get-elcrtt     thru 0620-exit
  5322     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  5323     IF NOT ALREADY-SENT
  5324        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  5325     END-IF
  5326     .
  5327 0200-CONTINUE.
  5328     PERFORM 0150-READ-NEXT-ELCERT
  5329                                 THRU 0150-EXIT
  5330     .
  5331 0200-EXIT.
  5332     EXIT.
  5333 0300-GET-ELCNTL-RECORDS.
  5334     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  5335     IF NOT RESP-NORMAL
  5336        MOVE ' COMPANY RECORD NOT FOUND '
  5337                                 TO WS-COMMENT
  5338        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5339        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5340        PERFORM 0020-SEND-BUFFER
  5341                                 THRU 0020-EXIT
  5342        PERFORM 0025-CLOSE-SOCKET
  5343                                 THRU 0025-EXIT
  5344        GO TO 0010-RETURN
  5345     END-IF
  5346     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  5347        PERFORM 0320-GET-LIFE-RECORD
  5348                                 THRU 0320-EXIT
  5349        IF NOT RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  94
* SOCK03.cbl
  5350           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  5351                                 TO WS-COMMENT
  5352           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5353           PERFORM 0030-BUILD-BUFFER
  5354                                 THRU 0030-EXIT
  5355           PERFORM 0020-SEND-BUFFER
  5356                                 THRU 0020-EXIT
  5357           PERFORM 0025-CLOSE-SOCKET
  5358                                 THRU 0025-EXIT
  5359           GO TO 0010-RETURN
  5360        END-IF
  5361     END-IF
  5362     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5363        PERFORM 0330-GET-AH-RECORD
  5364                                 THRU 0330-EXIT
  5365        IF NOT RESP-NORMAL
  5366           MOVE ' AH BENEFIT RECORD NOT FOUND '
  5367                                 TO WS-COMMENT
  5368           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5369           PERFORM 0030-BUILD-BUFFER
  5370                                 THRU 0030-EXIT
  5371           PERFORM 0020-SEND-BUFFER
  5372                                 THRU 0020-EXIT
  5373           PERFORM 0025-CLOSE-SOCKET
  5374                                 THRU 0025-EXIT
  5375           GO TO 0010-RETURN
  5376        END-IF
  5377     END-IF
  5378     PERFORM 0340-GET-STATE-RECORD
  5379                                 THRU 0340-EXIT
  5380     IF NOT RESP-NORMAL
  5381        MOVE ' STATE RECORD NOT FOUND '
  5382                                 TO WS-COMMENT
  5383        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5384        PERFORM 0030-BUILD-BUFFER
  5385                                 THRU 0030-EXIT
  5386        PERFORM 0020-SEND-BUFFER
  5387                                 THRU 0020-EXIT
  5388        PERFORM 0025-CLOSE-SOCKET
  5389                                 THRU 0025-EXIT
  5390        GO TO 0010-RETURN
  5391     END-IF
  5392     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  5393     IF NOT ERACCT-FOUND
  5394        MOVE ' ACCOUNT NOT FOUND '
  5395                                 TO WS-COMMENT
  5396        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5397        PERFORM 0030-BUILD-BUFFER
  5398                                 THRU 0030-EXIT
  5399        PERFORM 0020-SEND-BUFFER
  5400                                 THRU 0020-EXIT
  5401        PERFORM 0025-CLOSE-SOCKET
  5402                                 THRU 0025-EXIT
  5403        GO TO 0010-RETURN
  5404     ELSE
  5405        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  5406        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  5407        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  95
* SOCK03.cbl
  5408        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  5409     END-IF
  5410     .
  5411 0300-EXIT.
  5412     EXIT.
  5413 0310-GET-COMPANY.
  5414     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  5415     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  5416     MOVE SPACES                 TO  WS-CF-ACCESS
  5417     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  5418
  5419* EXEC CICS READ
  5420*       INTO    (CONTROL-FILE)
  5421*       DATASET ('ELCNTL')
  5422*       RIDFLD  (WS-CF-KEY)
  5423*       RESP    (WS-RESPONSE)
  5424*    END-EXEC
  5425     MOVE LENGTH OF
  5426      CONTROL-FILE
  5427       TO DFHEIV11
  5428     MOVE 'ELCNTL' TO DFHEIV1
  5429*    MOVE '&"IL       E          (  N#00005140' TO DFHEIV0
  5430     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5432     MOVE X'204E233030303035313430' TO DFHEIV0(25:11)
  5433     CALL 'kxdfhei1' USING DFHEIV0,
  5434           DFHEIV1,
  5435           CONTROL-FILE,
  5436           DFHEIV11,
  5437           WS-CF-KEY,
  5438           DFHEIV99,
  5439           DFHEIV99,
  5440           DFHEIV99
  5441     MOVE EIBRESP  TO WS-RESPONSE
  5442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5443     IF (RESP-NORMAL)
  5444        AND (CF-COMPANY-ID = WS-COMP-ID)
  5445        AND (CF-RECORD-TYPE = '1')
  5446        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  5447        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  5448        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  5449        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  5450        IF CF-DEFAULT-APR NUMERIC
  5451           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  5452        ELSE
  5453           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  5454        END-IF
  5455        IF CF-VALID-REM-TRM-OPTION
  5456           MOVE CF-REM-TRM-CALC-OPTION
  5457                                 TO WS-CF-REM-TRM-CALC-OPTION
  5458        ELSE
  5459           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  5460        END-IF
  5461     END-IF
  5462     .
  5463 0310-EXIT.
  5464     EXIT.
  5465 0320-GET-LIFE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  96
* SOCK03.cbl
  5466     MOVE '4'                    TO WS-CF-RECORD-TYPE
  5467     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5468                                    WS-LF-BEN-CODE
  5469     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5470
  5471* EXEC CICS READ
  5472*       INTO    (CONTROL-FILE)
  5473*       DATASET ('ELCNTL')
  5474*       RIDFLD  (WS-CF-KEY)
  5475*       GTEQ
  5476*       RESP    (WS-RESPONSE)
  5477*    END-EXEC
  5478     MOVE LENGTH OF
  5479      CONTROL-FILE
  5480       TO DFHEIV11
  5481     MOVE 'ELCNTL' TO DFHEIV1
  5482*    MOVE '&"IL       G          (  N#00005173' TO DFHEIV0
  5483     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5484     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5485     MOVE X'204E233030303035313733' TO DFHEIV0(25:11)
  5486     CALL 'kxdfhei1' USING DFHEIV0,
  5487           DFHEIV1,
  5488           CONTROL-FILE,
  5489           DFHEIV11,
  5490           WS-CF-KEY,
  5491           DFHEIV99,
  5492           DFHEIV99,
  5493           DFHEIV99
  5494     MOVE EIBRESP  TO WS-RESPONSE
  5495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5496     IF RESP-NORMAL
  5497        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5498        AND (CF-RECORD-TYPE = '4')
  5499        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5500           (S1 > +8)
  5501           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5502        END-PERFORM
  5503        IF S1 > +8
  5504           CONTINUE
  5505        ELSE
  5506           MOVE CF-BENEFIT-DESCRIP (S1)
  5507                                 TO WS-LF-BEN-CODE-DESC
  5508           MOVE CF-LF-COVERAGE-TYPE (S1)
  5509                                 TO WS-CF-LF-COVERAGE-TYPE
  5510           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5511              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5512           ELSE
  5513              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5514           END-IF
  5515           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5516               MOVE CF-CO-REM-TERM-CALC (S1)
  5517                                 TO WS-LF-CO-REM-TERM-CALC
  5518           END-IF
  5519           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5520               MOVE CF-CO-EARNINGS-CALC (S1)
  5521                                 TO WS-LF-CO-EARNINGS-CALC
  5522                                    WS-LF-CO-REFUND-CALC
  5523           END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  97
* SOCK03.cbl
  5524           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5525               MOVE CF-SPECIAL-CALC-CD (S1)
  5526                                 TO WS-LF-SPECIAL-CALC-CD
  5527           END-IF
  5528           IF CF-CO-REFUND-CALC (S1) > '0'
  5529               MOVE CF-CO-REFUND-CALC (S1)
  5530                                 TO WS-LF-CO-REFUND-CALC
  5531        END-IF
  5532     END-IF
  5533     .
  5534 0320-EXIT.
  5535     EXIT.
  5536 0330-GET-AH-RECORD.
  5537     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5538     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5539     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5540
  5541* EXEC CICS READ
  5542*       INTO    (CONTROL-FILE)
  5543*       DATASET ('ELCNTL')
  5544*       RIDFLD  (WS-CF-KEY)
  5545*       GTEQ
  5546*       RESP    (WS-RESPONSE)
  5547*    END-EXEC
  5548     MOVE LENGTH OF
  5549      CONTROL-FILE
  5550       TO DFHEIV11
  5551     MOVE 'ELCNTL' TO DFHEIV1
  5552*    MOVE '&"IL       G          (  N#00005224' TO DFHEIV0
  5553     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5555     MOVE X'204E233030303035323234' TO DFHEIV0(25:11)
  5556     CALL 'kxdfhei1' USING DFHEIV0,
  5557           DFHEIV1,
  5558           CONTROL-FILE,
  5559           DFHEIV11,
  5560           WS-CF-KEY,
  5561           DFHEIV99,
  5562           DFHEIV99,
  5563           DFHEIV99
  5564     MOVE EIBRESP  TO WS-RESPONSE
  5565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5566     IF RESP-NORMAL
  5567        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5568        AND (CF-RECORD-TYPE = '5')
  5569        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5570           (S1 > +8)
  5571           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5572        END-PERFORM
  5573        IF S1 > +8
  5574           CONTINUE
  5575        ELSE
  5576           MOVE CF-BENEFIT-DESCRIP (S1)
  5577                                 TO WS-AH-BEN-CODE-DESC
  5578           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5579              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5580           ELSE
  5581              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  98
* SOCK03.cbl
  5582           END-IF
  5583           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5584              MOVE CF-CO-REM-TERM-CALC (S1)
  5585                                 TO WS-AH-CO-REM-TERM-CALC
  5586           END-IF
  5587           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5588              MOVE CF-CO-EARNINGS-CALC (S1)
  5589                                 TO WS-AH-CO-EARNINGS-CALC
  5590                                    WS-AH-CO-REFUND-CALC
  5591           END-IF
  5592           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5593              MOVE CF-SPECIAL-CALC-CD (S1)
  5594                                 TO WS-AH-SPECIAL-CALC-CD
  5595           END-IF
  5596           IF CF-CO-REFUND-CALC (S1) > '0'
  5597              MOVE CF-CO-REFUND-CALC (S1)
  5598                                 TO WS-AH-CO-REFUND-CALC
  5599           END-IF
  5600           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5601              MOVE CF-BENEFIT-CATEGORY (S1)
  5602                                 TO WS-AH-BEN-CATEGORY
  5603           END-IF
  5604        END-IF
  5605     END-IF
  5606     .
  5607 0330-EXIT.
  5608     EXIT.
  5609 0340-GET-STATE-RECORD.
  5610     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5611     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5612     MOVE CM-STATE               TO WS-CF-ACCESS
  5613     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5614
  5615* EXEC CICS READ
  5616*       INTO    (CONTROL-FILE)
  5617*       DATASET ('ELCNTL')
  5618*       RIDFLD  (WS-CF-KEY)
  5619*       RESP    (WS-RESPONSE)
  5620*    END-EXEC
  5621     MOVE LENGTH OF
  5622      CONTROL-FILE
  5623       TO DFHEIV11
  5624     MOVE 'ELCNTL' TO DFHEIV1
  5625*    MOVE '&"IL       E          (  N#00005279' TO DFHEIV0
  5626     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5627     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5628     MOVE X'204E233030303035323739' TO DFHEIV0(25:11)
  5629     CALL 'kxdfhei1' USING DFHEIV0,
  5630           DFHEIV1,
  5631           CONTROL-FILE,
  5632           DFHEIV11,
  5633           WS-CF-KEY,
  5634           DFHEIV99,
  5635           DFHEIV99,
  5636           DFHEIV99
  5637     MOVE EIBRESP  TO WS-RESPONSE
  5638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5639     IF (RESP-NORMAL)
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page  99
* SOCK03.cbl
  5640        AND (CF-COMPANY-ID = WS-COMP-ID)
  5641        AND (CF-RECORD-TYPE = '3')
  5642        AND (CF-STATE-CODE = CM-STATE)
  5643        MOVE CF-ST-FREE-LOOK-PERIOD
  5644                                 TO WS-FREE-LOOK
  5645        MOVE CF-STATE-ABBREVIATION
  5646                                 TO WS-STATE-ABBREVIATION
  5647        MOVE CF-ST-FST-PMT-DAYS-CHG
  5648                                 TO  WS-STATE-EXT-DAYS-CHG
  5649        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5650           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5651           IF CF-ST-RT-CALC NOT = SPACES
  5652              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5653           END-IF
  5654           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5655              IF CF-ST-RF-LR-CALC > '0'
  5656                 MOVE CF-ST-RF-LR-CALC
  5657                                 TO WS-LF-ST-REFUND-CALC
  5658              END-IF
  5659              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5660                 IF CF-ST-RF-LN-CALC > '0'
  5661                    MOVE CF-ST-RF-LN-CALC
  5662                                 TO WS-LF-ST-REFUND-CALC
  5663                 END-IF
  5664              END-IF
  5665           ELSE
  5666              IF CF-ST-RF-LL-CALC > '0'
  5667                 MOVE CF-ST-RF-LL-CALC
  5668                                 TO WS-LF-ST-REFUND-CALC
  5669              END-IF
  5670           END-IF
  5671           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5672              (S1 > 50)
  5673              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5674                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5675           END-PERFORM
  5676           IF S1 < +51
  5677              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5678                 MOVE CF-ST-REM-TERM-CALC (S1)
  5679                                 TO WS-LF-ST-REM-TERM-CALC
  5680              END-IF
  5681              IF CF-ST-REFUND-CALC (S1) > '0'
  5682                 MOVE CF-ST-REFUND-CALC (S1)
  5683                                 TO WS-LF-ST-REFUND-CALC
  5684              END-IF
  5685           END-IF
  5686        END-IF
  5687        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5688           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5689           IF CF-ST-RT-CALC NOT = SPACES
  5690              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5691           END-IF
  5692           IF CF-ST-RF-AH-CALC > '0'
  5693              MOVE CF-ST-RF-AH-CALC
  5694                                 TO WS-AH-ST-REFUND-CALC
  5695           END-IF
  5696           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5697              IF CF-ST-RF-CP-CALC > '0'
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 100
* SOCK03.cbl
  5698                 MOVE CF-ST-RF-CP-CALC
  5699                                 TO WS-AH-ST-REFUND-CALC
  5700              END-IF
  5701           END-IF
  5702           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5703              (S1 > 50)
  5704              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5705                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5706           END-PERFORM
  5707           IF S1 < +51
  5708              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5709                 MOVE CF-ST-REM-TERM-CALC (S1)
  5710                                 TO WS-AH-ST-REM-TERM-CALC
  5711              END-IF
  5712              IF CF-ST-REFUND-CALC (S1) > '0'
  5713                 MOVE CF-ST-REFUND-CALC (S1)
  5714                                 TO WS-AH-ST-REFUND-CALC
  5715              END-IF
  5716           END-IF
  5717        END-IF
  5718     END-IF
  5719     .
  5720 0340-EXIT.
  5721     EXIT.
  5722 0350-GET-ERACCT.
  5723     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5724                                    WS-AM-EARN-METHOD-R
  5725                                    WS-AM-EARN-METHOD-A
  5726                                    WS-LF-AM-REM-TERM-CALC
  5727                                    WS-AH-AM-REM-TERM-CALC
  5728     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5729     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5730     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5731     MOVE CM-STATE               TO WS-AM-STATE
  5732     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5733     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5734     MOVE LOW-VALUES             TO WS-AM-FILLER
  5735     MOVE ' '                    TO WS-STOP-SW
  5736
  5737* EXEC CICS STARTBR
  5738*       DATASET  ('ERACCT')
  5739*       RIDFLD   (WS-AM-KEY)
  5740*       GTEQ
  5741*       RESP (WS-RESPONSE)
  5742*    END-EXEC
  5743     MOVE 'ERACCT' TO DFHEIV1
  5744     MOVE 0
  5745       TO DFHEIV11
  5746*    MOVE '&,         G          &  N#00005382' TO DFHEIV0
  5747     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5748     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5749     MOVE X'204E233030303035333832' TO DFHEIV0(25:11)
  5750     CALL 'kxdfhei1' USING DFHEIV0,
  5751           DFHEIV1,
  5752           WS-AM-KEY,
  5753           DFHEIV99,
  5754           DFHEIV11,
  5755           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 101
* SOCK03.cbl
  5756     MOVE EIBRESP  TO WS-RESPONSE
  5757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5758     IF RESP-NORMAL
  5759        PERFORM UNTIL TOLD-TO-STOP
  5760
  5761* EXEC CICS READNEXT
  5762*             DATASET  ('ERACCT')
  5763*             INTO     (ACCOUNT-MASTER)
  5764*             RIDFLD   (WS-AM-KEY)
  5765*          END-EXEC
  5766     MOVE LENGTH OF
  5767      ACCOUNT-MASTER
  5768       TO DFHEIV12
  5769     MOVE 'ERACCT' TO DFHEIV1
  5770     MOVE 0
  5771       TO DFHEIV11
  5772*    MOVE '&.IL                  )   #00005390' TO DFHEIV0
  5773     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5774     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5775     MOVE X'2020233030303035333930' TO DFHEIV0(25:11)
  5776     CALL 'kxdfhei1' USING DFHEIV0,
  5777           DFHEIV1,
  5778           ACCOUNT-MASTER,
  5779           DFHEIV12,
  5780           WS-AM-KEY,
  5781           DFHEIV99,
  5782           DFHEIV11,
  5783           DFHEIV99,
  5784           DFHEIV99
  5785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5786           IF RESP-NORMAL
  5787              EVALUATE TRUE
  5788                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5789                    CM-CONTROL-PRIMARY (1:20)
  5790                    SET TOLD-TO-STOP TO TRUE
  5791                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5792                    CM-CONTROL-PRIMARY (1:20))
  5793                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5794                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5795                    SET ERACCT-FOUND      TO TRUE
  5796                    SET TOLD-TO-STOP TO TRUE
  5797              END-EVALUATE
  5798           ELSE
  5799              SET TOLD-TO-STOP TO TRUE
  5800           END-IF
  5801        END-PERFORM
  5802
  5803* EXEC CICS ENDBR
  5804*          DATASET   ('ERACCT')
  5805*       END-EXEC
  5806     MOVE 'ERACCT' TO DFHEIV1
  5807     MOVE 0
  5808       TO DFHEIV11
  5809*    MOVE '&2                    $   #00005411' TO DFHEIV0
  5810     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5811     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5812     MOVE X'2020233030303035343131' TO DFHEIV0(25:11)
  5813     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 102
* SOCK03.cbl
  5814           DFHEIV1,
  5815           DFHEIV11,
  5816           DFHEIV99
  5817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5818     END-IF
  5819     .
  5820 0350-EXIT.
  5821     EXIT.
  5822 0400-PROCESS-LIFE.
  5823     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5824     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5825     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5826     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5827     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5828     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5829     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5830     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5831     MOVE CM-CARRIER             TO WS-CARRIER
  5832     MOVE CM-GROUPING            TO WS-GROUPING
  5833     MOVE CM-STATE               TO WS-STATE
  5834     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5835     MOVE CM-CERT-NO             TO WS-CERT-NO
  5836     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5837     MOVE ' '                    TO  DC-OPTION-CODE.
  5838     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5839     IF NO-CONVERSION-ERROR
  5840        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5841     ELSE
  5842        MOVE 99999999            TO WS-CERT-EFF-DATE
  5843     END-IF
  5844     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5845        GO TO 0400-EXIT
  5846     END-IF
  5847     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5848                                    WS-TOT-LF-PREM
  5849                                    WS-TOT-LF-COMM
  5850                                    WS-LF-CANCEL-DATE
  5851     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5852     MOVE ' '                    TO  DC-OPTION-CODE
  5853     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5854     IF NO-CONVERSION-ERROR
  5855        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5856     ELSE
  5857        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5858     END-IF
  5859     IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5860        MOVE CM-LF-DEATH-DT      TO DC-BIN-DATE-1
  5861        MOVE ' '                 TO DC-OPTION-CODE
  5862
  5863        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5864        IF NO-CONVERSION-ERROR
  5865           MOVE DC-GREG-DATE-CYMD
  5866                                 TO WS-LF-CANCEL-DATE
  5867        ELSE
  5868           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5869        END-IF
  5870     END-IF
  5871     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 103
* SOCK03.cbl
  5872        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
  5873        MOVE ' '                 TO DC-OPTION-CODE
  5874
  5875        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5876        IF NO-CONVERSION-ERROR
  5877           MOVE DC-GREG-DATE-CYMD
  5878                                 TO WS-LF-CANCEL-DATE
  5879        ELSE
  5880           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5881        END-IF
  5882     END-IF
  5883     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5884     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5885     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5886     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5887     MOVE CM-STATE               TO CP-STATE
  5888     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5889     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5890     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5891     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5892     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5893     MOVE '2'                    TO CP-PROCESS-TYPE
  5894     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5895     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5896     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5897     MOVE WS-CF-REM-TRM-CALC-OPTION
  5898                                 TO CP-REM-TRM-CALC-OPTION
  5899     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5900     IF WS-LF-CO-REM-TERM-CALC > '0'
  5901        MOVE WS-LF-CO-REM-TERM-CALC
  5902                                 TO CP-REM-TERM-METHOD
  5903     END-IF
  5904     IF WS-LF-ST-REM-TERM-CALC > '0'
  5905         MOVE WS-LF-ST-REM-TERM-CALC
  5906                                 TO  CP-REM-TERM-METHOD.
  5907     IF WS-LF-AM-REM-TERM-CALC > '0'
  5908         MOVE WS-LF-AM-REM-TERM-CALC
  5909                                 TO  CP-REM-TERM-METHOD.
  5910     IF (WS-COMP-ID = 'CID')
  5911        AND (CP-STATE-STD-ABBRV = 'WI')
  5912        MOVE '7'                 TO CP-REM-TERM-METHOD
  5913        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5914     END-IF
  5915     IF (WS-COMP-ID = 'CID')
  5916        AND (CP-STATE-STD-ABBRV = 'MO')
  5917        AND (CM-CERT-EFF-DT >= X'9B41')
  5918        AND (CM-CERT-EFF-DT <= X'A2FB')
  5919        MOVE '7'                 TO CP-REM-TERM-METHOD
  5920        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5921     END-IF
  5922     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5923                                    CP-LOAN-TERM
  5924                                    WS-LF-TERM
  5925     IF CP-TRUNCATED-LIFE
  5926         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5927     IF CP-TERM-IS-DAYS
  5928        IF CM-LF-TERM-IN-DAYS NUMERIC
  5929           MOVE CM-LF-TERM-IN-DAYS
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 104
* SOCK03.cbl
  5930                                 TO CP-TERM-OR-EXT-DAYS
  5931        ELSE
  5932           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5933        END-IF
  5934     ELSE
  5935        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5936           MOVE CM-PMT-EXTENSION-DAYS
  5937                                 TO CP-TERM-OR-EXT-DAYS
  5938        ELSE
  5939           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5940        END-IF
  5941     END-IF
  5942     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5943     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5944        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5945        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5946     END-IF
  5947     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5948     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5949     MOVE ' '                    TO WS-CLM-STOP-SW
  5950     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5951     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5952
  5953* EXEC CICS STARTBR
  5954*       DATASET     ('ELMSTR5')
  5955*       RIDFLD      (ELMSTR-KEY)
  5956*       RESP        (WS-RESPONSE)
  5957*    END-EXEC
  5958     MOVE 'ELMSTR5' TO DFHEIV1
  5959     MOVE 0
  5960       TO DFHEIV11
  5961*    MOVE '&,         G          &  N#00005548' TO DFHEIV0
  5962     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5963     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5964     MOVE X'204E233030303035353438' TO DFHEIV0(25:11)
  5965     CALL 'kxdfhei1' USING DFHEIV0,
  5966           DFHEIV1,
  5967           ELMSTR-KEY,
  5968           DFHEIV99,
  5969           DFHEIV11,
  5970           DFHEIV99
  5971     MOVE EIBRESP  TO WS-RESPONSE
  5972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5973     DISPLAY ' AFTER START ' WS-RESPONSE
  5974     IF RESP-NORMAL
  5975        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5976
  5977* EXEC CICS READNEXT
  5978*             DATASET   ('ELMSTR5')
  5979*             RIDFLD    (ELMSTR-KEY)
  5980*             INTO      (CLAIM-MASTER)
  5981*             RESP      (WS-RESPONSE)
  5982*          END-EXEC
  5983     MOVE LENGTH OF
  5984      CLAIM-MASTER
  5985       TO DFHEIV12
  5986     MOVE 'ELMSTR5' TO DFHEIV1
  5987     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 105
* SOCK03.cbl
  5988       TO DFHEIV11
  5989*    MOVE '&.IL                  )  N#00005556' TO DFHEIV0
  5990     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5991     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5992     MOVE X'204E233030303035353536' TO DFHEIV0(25:11)
  5993     CALL 'kxdfhei1' USING DFHEIV0,
  5994           DFHEIV1,
  5995           CLAIM-MASTER,
  5996           DFHEIV12,
  5997           ELMSTR-KEY,
  5998           DFHEIV99,
  5999           DFHEIV11,
  6000           DFHEIV99,
  6001           DFHEIV99
  6002     MOVE EIBRESP  TO WS-RESPONSE
  6003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6004        IF (RESP-NORMAL OR RESP-DUPKEY)
  6005           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6006           AND (CM-CERT-NO = CL-CERT-NO)
  6007           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6008              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6009              IF CL-CLAIM-TYPE = 'L' OR 'O'
  6010                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  6011                    MOVE 'D'     TO WS-AH-STATUS
  6012                 END-IF
  6013                 IF CLAIM-IS-OPEN
  6014                    MOVE ' OPEN LIFE CLAIM '
  6015                                 TO WS-COMMENT
  6016                    MOVE 'L'     TO WS-LF-STATUS
  6017                    GO TO 0400-EXIT
  6018                 ELSE
  6019                    MOVE ' DEATH CLAIM APPLIED '
  6020                                 TO WS-COMMENT
  6021                    MOVE 'D'     TO WS-LF-STATUS
  6022*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  6023*                      MOVE CL-PAID-THRU-DT
  6024*                                TO WS-LF-BIN-PAID-THRU-DT
  6025*                   END-IF
  6026                 END-IF
  6027              END-IF
  6028           END-IF
  6029        ELSE
  6030           SET I-SAY-TO-STOP TO TRUE
  6031        END-IF
  6032        END-PERFORM
  6033
  6034* EXEC CICS ENDBR
  6035*          DATASET   ('ELMSTR5')
  6036*       END-EXEC
  6037     MOVE 'ELMSTR5' TO DFHEIV1
  6038     MOVE 0
  6039       TO DFHEIV11
  6040*    MOVE '&2                    $   #00005591' TO DFHEIV0
  6041     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6042     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6043     MOVE X'2020233030303035353931' TO DFHEIV0(25:11)
  6044     CALL 'kxdfhei1' USING DFHEIV0,
  6045           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 106
* SOCK03.cbl
  6046           DFHEIV11,
  6047           DFHEIV99
  6048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6049     END-IF
  6050     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6051*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  6052        MOVE WS-LF-BIN-PAID-THRU-DT
  6053                                 TO DC-BIN-DATE-1
  6054        MOVE ' '                 TO DC-OPTION-CODE
  6055        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6056        IF NO-CONVERSION-ERROR
  6057           MOVE DC-GREG-DATE-CYMD
  6058                                 TO WS-CLM-PAID-THRU-DT
  6059        ELSE
  6060           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6061        END-IF
  6062*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  6063*          MOVE 'CAN DT =< CLM PD THRU DT'
  6064*                                TO WS-COMMENT
  6065*          MOVE 'P'              TO WS-LF-STATUS
  6066*          GO TO 0400-EXIT
  6067*       END-IF
  6068        GO TO 0400-EXIT
  6069     END-IF
  6070     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6071     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6072        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6073        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  6074        COMPUTE CP-REMAINING-TERM-1 =
  6075                CP-REMAINING-TERM-1 - +1
  6076        COMPUTE CP-REMAINING-TERM-2 =
  6077                CP-REMAINING-TERM-2 - +1
  6078     END-IF
  6079     IF CP-REMAINING-TERM-1 NEGATIVE
  6080        MOVE ZEROS               TO CP-REMAINING-TERM-1
  6081     END-IF
  6082     IF CP-REMAINING-TERM-2 NEGATIVE
  6083        MOVE ZEROS               TO CP-REMAINING-TERM-2
  6084     END-IF
  6085     IF CM-LIFE-COMM-PCT NOT NUMERIC
  6086        MOVE ZERO                TO CM-LIFE-COMM-PCT
  6087     END-IF
  6088     IF CM-LIFE-COMM-PCT > ZEROS
  6089        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  6090           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  6091     END-IF
  6092     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  6093     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  6094     IF CM-LF-CURRENT-STATUS = '8'
  6095        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  6096           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  6097                                 TO WS-COMMENT
  6098           MOVE 'C'              TO WS-LF-STATUS
  6099           move cm-lf-itd-cancel-amt
  6100                                 to ws-lf-refund
  6101*          PERFORM 0030-BUILD-BUFFER
  6102*                                THRU 0030-EXIT
  6103*          PERFORM 0020-SEND-BUFFER
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 107
* SOCK03.cbl
  6104*                                THRU 0020-EXIT
  6105*          SET ALREADY-SENT      TO TRUE
  6106*          MOVE SPACES           TO WS-COMMENT
  6107           GO TO 0400-EXIT
  6108*          PERFORM 0025-CLOSE-SOCKET
  6109*                                THRU 0025-EXIT
  6110*          GO TO 0010-RETURN
  6111        END-IF
  6112     END-IF
  6113     IF CM-LF-CURRENT-STATUS = '7'
  6114        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  6115           MOVE ' DEATH CLAIM APPLIED '
  6116                                 TO WS-COMMENT
  6117           MOVE 'D'              TO WS-LF-STATUS
  6118*          PERFORM 0030-BUILD-BUFFER
  6119*                                THRU 0030-EXIT
  6120*          IF NOT ALREADY-SENT
  6121*             PERFORM 0020-SEND-BUFFER
  6122*                                THRU 0020-EXIT
  6123*             SET ALREADY-SENT   TO TRUE
  6124*          END-IF
  6125           GO TO 0400-EXIT
  6126*          PERFORM 0025-CLOSE-SOCKET
  6127*                                THRU 0025-EXIT
  6128*          GO TO 0010-RETURN
  6129        END-IF
  6130     END-IF
  6131     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6132        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  6133        MOVE 'LF COVERAGE EXPIRED '
  6134                                 TO WS-COMMENT
  6135        MOVE 'E'                 TO WS-LF-STATUS
  6136        GO TO 0400-EXIT
  6137     END-IF
  6138     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6139        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6140        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6141     ELSE
  6142        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  6143     END-IF
  6144     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  6145     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  6146*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  6147     if ws-comp-id = 'AHL'
  6148        move cm-lf-class-cd      to cp-class-code
  6149        if cp-class-code = spaces
  6150           move zeros            to cp-class-code
  6151        end-if
  6152     else
  6153        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6154     end-if
  6155     IF (ws-comp-id = 'DCC' or 'VPP')
  6156        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6157        MOVE ' '                 TO WS-PDEF-RECORD-SW
  6158        PERFORM 0730-GET-DDF-FACTORS
  6159                                 THRU 0730-EXIT
  6160        IF PDEF-FOUND
  6161           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 108
* SOCK03.cbl
  6162              (P1 > +8)
  6163              OR (PD-PROD-CODE (P1) = 'L')
  6164           END-PERFORM
  6165           IF P1 < +9
  6166              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  6167           END-IF
  6168        END-IF
  6169     END-IF
  6170     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  6171*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  6172     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  6173        CM-LF-ALT-BENEFIT-AMT
  6174*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  6175     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  6176                                    WS-LF-REM-BEN
  6177     move cm-lf-premium-amt      to ws-tot-lf-prem
  6178     if ws-lf-co-earnings-calc = 'B'
  6179        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  6180           + CM-LF-ALT-PREMIUM-AMT
  6181     end-if
  6182     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  6183     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6184        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6185        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6186     ELSE
  6187        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  6188     END-IF
  6189     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6190     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6191     IF WS-LF-ST-REFUND-CALC > ZERO
  6192         MOVE WS-LF-ST-REFUND-CALC
  6193                                 TO  CP-EARNING-METHOD.
  6194     IF WS-LF-FO-REFUND-CALC > ZERO
  6195         MOVE WS-LF-FO-REFUND-CALC
  6196                                 TO  CP-EARNING-METHOD.
  6197     IF CP-RATING-METHOD = '4'
  6198        MOVE '4'                 TO CP-EARNING-METHOD
  6199     END-IF
  6200*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6201     if ws-comp-id = 'AHL'
  6202        move cm-lf-class-cd      to cp-class-code
  6203        if cp-class-code = spaces
  6204           move zeros            to cp-class-code
  6205        end-if
  6206     else
  6207        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6208     end-if
  6209     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6210     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6211                                     CP-RATING-BENEFIT-AMT.
  6212     IF CP-STATE-STD-ABBRV = 'OR'
  6213         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6214                                         CM-LF-ALT-BENEFIT-AMT.
  6215****   N O T E   ****
  6216*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  6217*      THE OH HARD CODING IN ELCRFNDP
  6218     IF WS-COMP-ID = 'CID'
  6219        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 109
* SOCK03.cbl
  6220           MOVE WS-LF-CO-EARNINGS-CALC
  6221                                 TO CP-EARNING-METHOD
  6222        END-IF
  6223     END-IF
  6224****   N O T E   ****
  6225     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6226     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6227     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  6228     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6229     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6230*    IF CP-EARN-AS-NET-PAY
  6231*       IF CP-LOAN-APR <= ZEROS
  6232*          IF WS-CF-DEFAULT-APR > ZEROS
  6233*             MOVE WS-CF-DEFAULT-APR
  6234*                                TO  CP-LOAN-APR
  6235*          END-IF
  6236*       END-IF
  6237*    END-IF
  6238*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  6239*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  6240*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  6241*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  6242*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  6243*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  6244*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  6245*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  6246*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  6247*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  6248*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  6249*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  6250*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  6251*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  6252*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  6253*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  6254*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  6255*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  6256     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6257     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  6258     DISPLAY ' MADE IT BACK FROM ELRFND '
  6259     IF (CP-ERROR-RATE-IS-ZERO)
  6260        OR (CP-ERROR-RATE-NOT-FOUND)
  6261        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6262        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  6263          DELIMITED BY SIZE INTO WS-COMMENT
  6264        END-STRING
  6265        MOVE 'X'                 TO WS-LF-STATUS
  6266        GO TO 0400-EXIT
  6267*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6268*       IF NOT ALREADY-SENT
  6269*          PERFORM 0020-SEND-BUFFER
  6270*                                THRU 0020-EXIT
  6271*          SET ALREADY-SENT      TO TRUE
  6272*       END-IF
  6273*       PERFORM 0025-CLOSE-SOCKET
  6274*                                THRU 0025-EXIT
  6275*       GO TO 0010-RETURN
  6276     END-IF
  6277     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 110
* SOCK03.cbl
  6278                                    WS-TOT-LF-RFND
  6279     IF (WS-LF-STATUS = SPACES)
  6280        OR (CP-CALC-REFUND > ZEROS)
  6281        MOVE 'A'                 TO WS-LF-STATUS
  6282     END-IF
  6283     EVALUATE TRUE
  6284        WHEN CP-R-AS-R78
  6285           MOVE 'RULE 78'          TO  WS-LF-METHOD
  6286        WHEN  CP-R-AS-PRORATA
  6287           MOVE 'PRORATA'          TO  WS-LF-METHOD
  6288        WHEN CP-R-AS-CALIF
  6289           MOVE 'CALIF'            TO  WS-LF-METHOD
  6290        WHEN CP-R-AS-TEXAS
  6291           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6292        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  6293           MOVE 'UTAH'             TO  WS-LF-METHOD
  6294        WHEN CP-R-AS-FARM-PLAN
  6295           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6296        WHEN CP-R-AS-NET-PAY
  6297           MOVE 'NET PAY'          TO  WS-LF-METHOD
  6298        WHEN CP-R-AS-ANTICIPATION
  6299           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  6300        WHEN CP-R-AS-MEAN
  6301           MOVE 'MEAN'             TO  WS-LF-METHOD
  6302        WHEN CP-R-AS-SUM-OF-DIGITS
  6303           MOVE 'SUM OF DIGITS'    TO  WS-LF-METHOD
  6304        WHEN CP-R-AS-REPOSSESSION
  6305           MOVE 'REPOSSESSION'     TO  WS-LF-METHOD
  6306     END-EVALUATE
  6307     IF WS-TOT-LF-RFND > ZEROS
  6308        COMPUTE WS-WORK-FACTOR ROUNDED =
  6309           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  6310        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  6311           WS-TOT-LF-COMM
  6312     END-IF
  6313     IF ERACCT-FOUND
  6314        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6315           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6316        END-IF
  6317        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6318           IF (AM-COMM-CHARGEBACK (1) = 99)
  6319                     OR
  6320              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6321                     OR
  6322              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6323              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6324              MOVE ZEROS         TO WS-LF-UEC
  6325           END-IF
  6326        END-IF
  6327     END-IF
  6328     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  6329        GO TO 0400-EXIT
  6330     END-IF
  6331     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  6332     MOVE '2'                    TO  CP-EARNING-METHOD
  6333                                     CP-RATING-METHOD.
  6334     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  6335                                     CP-REMAINING-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 111
* SOCK03.cbl
  6336                                     CP-RATING-BENEFIT-AMT.
  6337     IF CP-STATE-STD-ABBRV = 'OR'
  6338         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6339                                         CM-LF-ALT-BENEFIT-AMT.
  6340     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  6341     IF ws-comp-id = 'CID'
  6342        IF (CP-STATE-STD-ABBRV = 'MN')
  6343           AND (CM-CERT-EFF-DT > X'A4FF')
  6344           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  6345           MOVE '5'              TO CP-EARNING-METHOD
  6346           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  6347        END-IF
  6348     END-IF
  6349     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  6350     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  6351     IF (CP-ERROR-RATE-IS-ZERO)
  6352        OR (CP-ERROR-RATE-NOT-FOUND)
  6353        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6354        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  6355          DELIMITED BY SIZE INTO WS-COMMENT
  6356        END-STRING
  6357        MOVE 'X'              TO WS-LF-STATUS
  6358        GO TO 0400-EXIT
  6359*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6360*       IF NOT ALREADY-SENT
  6361*          PERFORM 0020-SEND-BUFFER
  6362*                                THRU 0020-EXIT
  6363*          SET ALREADY-SENT      TO TRUE
  6364*       END-IF
  6365*       PERFORM 0025-CLOSE-SOCKET
  6366*                                THRU 0025-EXIT
  6367*       GO TO 0010-RETURN
  6368     END-IF
  6369     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  6370     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  6371     IF WS-TOT-LF-RFND > ZEROS
  6372        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  6373           WS-TOT-LF-COMM
  6374     END-IF
  6375     IF ERACCT-FOUND
  6376        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6377           IF (AM-COMM-CHARGEBACK (1) = 99)
  6378                     OR
  6379              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6380                     OR
  6381              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6382              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6383              MOVE ZEROS         TO WS-LF-UEC
  6384           END-IF
  6385        END-IF
  6386     END-IF
  6387     .
  6388 0400-EXIT.
  6389     EXIT.
  6390 0500-PROCESS-AH.
  6391     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  6392        GO TO 0500-EXIT
  6393     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 112
* SOCK03.cbl
  6394     MOVE ZEROS                  TO WS-TOT-AH-RFND
  6395                                    WS-TOT-AH-PREM
  6396                                    WS-TOT-AH-COMM
  6397                                    WS-AH-CANCEL-DATE
  6398     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  6399     MOVE ' '                    TO  DC-OPTION-CODE
  6400     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6401     IF NO-CONVERSION-ERROR
  6402        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  6403     ELSE
  6404        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  6405     END-IF
  6406     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6407        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
  6408        MOVE ' '                 TO DC-OPTION-CODE
  6409
  6410        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6411        IF NO-CONVERSION-ERROR
  6412           MOVE DC-GREG-DATE-CYMD TO WS-AH-CANCEL-DATE
  6413        ELSE
  6414           MOVE ZEROS            TO WS-AH-CANCEL-DATE
  6415        END-IF
  6416     END-IF
  6417     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  6418     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  6419     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  6420     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6421     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6422     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  6423     MOVE CM-STATE               TO  CP-STATE.
  6424     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6425     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  6426     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6427     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6428     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  6429     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6430     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6431     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  6432     MOVE WS-CF-CR-REM-TERM-CALC
  6433                                 TO  CP-REM-TERM-METHOD.
  6434     IF WS-AH-CO-REM-TERM-CALC > '0'
  6435         MOVE WS-AH-CO-REM-TERM-CALC
  6436                                 TO  CP-REM-TERM-METHOD.
  6437     IF WS-AH-ST-REM-TERM-CALC > '0'
  6438         MOVE WS-AH-ST-REM-TERM-CALC
  6439                                 TO  CP-REM-TERM-METHOD.
  6440     IF WS-AH-AM-REM-TERM-CALC > '0'
  6441         MOVE WS-AH-AM-REM-TERM-CALC
  6442                                 TO  CP-REM-TERM-METHOD.
  6443     IF (WS-COMP-ID = 'CID')
  6444        AND (CP-STATE-STD-ABBRV = 'WI')
  6445        MOVE '7'                 TO CP-REM-TERM-METHOD
  6446        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6447     END-IF
  6448     IF (WS-COMP-ID = 'CID')
  6449        AND (CP-STATE-STD-ABBRV = 'MO')
  6450        AND (CM-CERT-EFF-DT >= X'9B41')
  6451        AND (CM-CERT-EFF-DT <= X'A2FB')
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 113
* SOCK03.cbl
  6452        MOVE '7'                 TO CP-REM-TERM-METHOD
  6453        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6454     END-IF
  6455     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  6456                                     CP-LOAN-TERM.
  6457     IF  NOT  CP-TERM-IS-DAYS
  6458         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6459             MOVE CM-PMT-EXTENSION-DAYS
  6460                                 TO  CP-TERM-OR-EXT-DAYS
  6461         ELSE
  6462             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6463     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  6464     IF CM-AH-COMM-PCT > ZEROS
  6465        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  6466           CM-AH-PREMIUM-AMT
  6467     END-IF
  6468     IF (ws-comp-id = 'DCC' or 'VPP')
  6469        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6470        compute ws-tot-ah-comm = cm-ah-premium-amt -
  6471           (cm-ah-clp + cm-addl-clp)
  6472     end-if
  6473     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  6474     IF WS-AH-STATUS = 'D'
  6475        GO TO 0500-EXIT
  6476     END-IF
  6477     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  6478     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  6479     MOVE ' '                    TO WS-CLM-STOP-SW
  6480     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6481     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6482
  6483* EXEC CICS STARTBR
  6484*       DATASET     ('ELMSTR5')
  6485*       RIDFLD      (ELMSTR-KEY)
  6486*       RESP        (WS-RESPONSE)
  6487*    END-EXEC
  6488     MOVE 'ELMSTR5' TO DFHEIV1
  6489     MOVE 0
  6490       TO DFHEIV11
  6491*    MOVE '&,         G          &  N#00006027' TO DFHEIV0
  6492     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6493     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6494     MOVE X'204E233030303036303237' TO DFHEIV0(25:11)
  6495     CALL 'kxdfhei1' USING DFHEIV0,
  6496           DFHEIV1,
  6497           ELMSTR-KEY,
  6498           DFHEIV99,
  6499           DFHEIV11,
  6500           DFHEIV99
  6501     MOVE EIBRESP  TO WS-RESPONSE
  6502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6503     DISPLAY ' AFTER START ' WS-RESPONSE
  6504     IF RESP-NORMAL
  6505        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6506           DISPLAY ' AH READNEXT '
  6507
  6508* EXEC CICS READNEXT
  6509*             DATASET   ('ELMSTR5')
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 114
* SOCK03.cbl
  6510*             RIDFLD    (ELMSTR-KEY)
  6511*             INTO      (CLAIM-MASTER)
  6512*             RESP      (WS-RESPONSE)
  6513*          END-EXEC
  6514     MOVE LENGTH OF
  6515      CLAIM-MASTER
  6516       TO DFHEIV12
  6517     MOVE 'ELMSTR5' TO DFHEIV1
  6518     MOVE 0
  6519       TO DFHEIV11
  6520*    MOVE '&.IL                  )  N#00006036' TO DFHEIV0
  6521     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6522     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6523     MOVE X'204E233030303036303336' TO DFHEIV0(25:11)
  6524     CALL 'kxdfhei1' USING DFHEIV0,
  6525           DFHEIV1,
  6526           CLAIM-MASTER,
  6527           DFHEIV12,
  6528           ELMSTR-KEY,
  6529           DFHEIV99,
  6530           DFHEIV11,
  6531           DFHEIV99,
  6532           DFHEIV99
  6533     MOVE EIBRESP  TO WS-RESPONSE
  6534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6535        IF (RESP-NORMAL OR RESP-DUPKEY)
  6536           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6537           AND (CM-CERT-NO = CL-CERT-NO)
  6538           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6539              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6540              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6541                 IF CLAIM-IS-OPEN
  6542                    DISPLAY ' FOUND OPEN AH CLAIM '
  6543                    MOVE ' OPEN HEALTH CLAIM '
  6544                                 TO WS-COMMENT
  6545                    MOVE 'H'     TO WS-AH-STATUS
  6546                 ELSE
  6547                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6548                    MOVE ' CLOSED HEALTH CLAIM '
  6549                                 TO WS-COMMENT
  6550                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6551                       MOVE CL-PAID-THRU-DT
  6552                                 TO WS-AH-BIN-PAID-THRU-DT
  6553                    END-IF
  6554                 END-IF
  6555              END-IF
  6556           END-IF
  6557        ELSE
  6558           SET I-SAY-TO-STOP TO TRUE
  6559        END-IF
  6560        END-PERFORM
  6561
  6562* EXEC CICS ENDBR
  6563*          DATASET   ('ELMSTR5')
  6564*       END-EXEC
  6565     MOVE 'ELMSTR5' TO DFHEIV1
  6566     MOVE 0
  6567       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 115
* SOCK03.cbl
  6568*    MOVE '&2                    $   #00006068' TO DFHEIV0
  6569     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6570     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6571     MOVE X'2020233030303036303638' TO DFHEIV0(25:11)
  6572     CALL 'kxdfhei1' USING DFHEIV0,
  6573           DFHEIV1,
  6574           DFHEIV11,
  6575           DFHEIV99
  6576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6577     END-IF
  6578     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6579*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6580        MOVE WS-AH-BIN-PAID-THRU-DT
  6581                                 TO DC-BIN-DATE-1
  6582        MOVE ' '                 TO DC-OPTION-CODE
  6583        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6584        IF NO-CONVERSION-ERROR
  6585           MOVE DC-GREG-DATE-CYMD
  6586                                 TO WS-CLM-PAID-THRU-DT
  6587        ELSE
  6588           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6589        END-IF
  6590        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6591           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6592                                 TO WS-COMMENT
  6593           MOVE 'P'              TO WS-AH-STATUS
  6594           GO TO 0500-EXIT
  6595        END-IF
  6596     END-IF
  6597     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6598     IF CM-AH-CURRENT-STATUS = '8'
  6599        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6600           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6601                                 TO WS-COMMENT
  6602           MOVE 'C'              TO WS-AH-STATUS
  6603           move cm-ah-itd-cancel-amt
  6604                                 to ws-ah-refund
  6605           GO TO 0500-EXIT
  6606        END-IF
  6607     END-IF
  6608     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6609        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6610           MOVE ' SETTLEMENT CLAIM APPLIED '
  6611                                 TO WS-COMMENT
  6612           MOVE 'S'              TO WS-AH-STATUS
  6613*          PERFORM 0030-BUILD-BUFFER
  6614*                                THRU 0030-EXIT
  6615*          IF NOT ALREADY-SENT
  6616*             PERFORM 0020-SEND-BUFFER
  6617*                                THRU 0020-EXIT
  6618*             SET ALREADY-SENT   TO TRUE
  6619*          END-IF
  6620           GO TO 0500-EXIT
  6621*          PERFORM 0025-CLOSE-SOCKET
  6622*                                THRU 0025-EXIT
  6623*          GO TO 0010-RETURN
  6624        END-IF
  6625     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 116
* SOCK03.cbl
  6626     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6627        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6628        MOVE 'AH COVERAGE EXPIRED '
  6629                                 TO WS-COMMENT
  6630        MOVE 'E'                 TO WS-AH-STATUS
  6631        GO TO 0500-EXIT
  6632     END-IF
  6633     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6634                                    WS-AH-PREM
  6635     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6636     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6637        * CP-REMAINING-TERM-1
  6638     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6639                                     WS-AH-REM-TERM
  6640     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6641     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6642     IF WS-AH-ST-REFUND-CALC > ZERO
  6643         MOVE WS-AH-ST-REFUND-CALC
  6644                                 TO  CP-EARNING-METHOD.
  6645     IF WS-AH-FO-REFUND-CALC > ZERO
  6646         MOVE WS-AH-FO-REFUND-CALC
  6647                                 TO  CP-EARNING-METHOD.
  6648*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6649     if ws-comp-id = 'AHL'
  6650        move cm-ah-class-cd      to cp-class-code
  6651        if cp-class-code = spaces
  6652           move zeros            to cp-class-code
  6653        end-if
  6654     else
  6655        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6656     end-if
  6657     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6658     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6659                                     CP-RATING-BENEFIT-AMT.
  6660     IF CP-STATE-STD-ABBRV = 'OR'
  6661         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6662                                         CM-AH-ORIG-TERM.
  6663     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6664     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6665     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6666     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6667     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6668     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6669     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6670     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6671     MOVE ' '                    TO  DC-OPTION-CODE.
  6672     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6673     IF CP-STATE-STD-ABBRV = 'OH'
  6674        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6675         IF (CP-ORIGINAL-TERM > 60)
  6676           AND (DC-GREG-DATE-1-YMD > '831101')
  6677           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6678             MOVE '6'            TO  CP-EARNING-METHOD
  6679         END-IF
  6680        END-IF
  6681        IF WS-COMP-ID = 'CID'
  6682           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6683                           LOW-VALUES)
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 117
* SOCK03.cbl
  6684              IF CP-CRITICAL-PERIOD
  6685                 MOVE '2'       TO CP-EARNING-METHOD
  6686              ELSE
  6687                 MOVE '6'       TO CP-EARNING-METHOD
  6688              END-IF
  6689           ELSE
  6690              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6691                 MOVE '2'       TO CP-EARNING-METHOD
  6692              ELSE
  6693                 IF ((CM-LF-ORIG-TERM > 60) AND
  6694                    (CM-RATE-CLASS NOT = 'L '))
  6695                               OR
  6696                    (WS-LF-CO-EARNINGS-CALC = '5')
  6697                    IF CP-CRITICAL-PERIOD
  6698                       MOVE '2'  TO CP-EARNING-METHOD
  6699                    ELSE
  6700                       MOVE '6'  TO CP-EARNING-METHOD
  6701                    END-IF
  6702                 ELSE
  6703                    MOVE '1'     TO CP-EARNING-METHOD
  6704                 END-IF
  6705              END-IF
  6706           END-IF
  6707        END-IF
  6708     END-IF
  6709     IF CP-STATE-STD-ABBRV = 'VA'
  6710       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6711         IF DC-GREG-DATE-1-YMD > '921231'
  6712            IF CP-ORIGINAL-TERM > 61
  6713                MOVE '6'            TO  CP-EARNING-METHOD
  6714            ELSE
  6715                MOVE '1'            TO  CP-EARNING-METHOD.
  6716*    IF CP-EARN-AS-NET-PAY
  6717*       IF CP-LOAN-APR <= ZEROS
  6718*          IF WS-CF-DEFAULT-APR > ZEROS
  6719*             MOVE WS-CF-DEFAULT-APR
  6720*                                TO  CP-LOAN-APR
  6721*          END-IF
  6722*       END-IF
  6723*    END-IF
  6724     IF WS-COMP-ID = 'DCC' or 'VPP'
  6725        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6726           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6727           MOVE 'S'              TO CP-EARNING-METHOD
  6728        END-IF
  6729     END-IF
  6730     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6731     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6732        AND (CP-EARNING-METHOD = 'D')
  6733        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6734                                    WS-DDF-CSO-ADMIN-FEE
  6735                                    WS-DDF-1ST-YR-TOT-EXP
  6736                                    WS-DDF-COMM-AND-MFEE
  6737        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6738           S1 > +10
  6739           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6740              IF (AM-A-COM (S1) NUMERIC)
  6741                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 118
* SOCK03.cbl
  6742                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6743              ELSE
  6744                 MOVE +0         TO WS-COMM-PCT C0
  6745                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6746                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6747              END-IF
  6748              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6749                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6750                    + WS-COMM-PCT
  6751              END-IF
  6752              IF AM-COM-TYP (S1) = 'N'
  6753                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6754                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6755              END-IF
  6756              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6757                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6758                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6759              END-IF
  6760              IF AM-COM-TYP (S1) = 'I'
  6761                 COMPUTE WS-DDF-COMM-AND-MFEE
  6762                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6763              END-IF
  6764           END-IF
  6765        END-PERFORM
  6766        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6767        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6768        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6769           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6770     END-IF
  6771     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6772        AND (CP-EARNING-METHOD = 'D')
  6773        AND (ws-CANCEL-REASON NOT = 'R')
  6774        PERFORM 0730-GET-DDF-FACTORS
  6775                                 THRU 0730-EXIT
  6776        IF NOT PDEF-FOUND
  6777           MOVE ' DDF UE FACTORS  NOT FOUND '
  6778                                 TO WS-COMMENT
  6779           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6780           PERFORM 0030-BUILD-BUFFER
  6781                                 THRU 0030-EXIT
  6782           PERFORM 0020-SEND-BUFFER
  6783                                 THRU 0020-EXIT
  6784           PERFORM 0025-CLOSE-SOCKET
  6785                                 THRU 0025-EXIT
  6786           GO TO 0010-RETURN
  6787        END-IF
  6788*       IF NOT PDEF-FOUND
  6789*          MOVE ER-9999          TO EMI-ERROR
  6790*          PERFORM 9700-ERROR-FORMAT
  6791*                                THRU 9799-EXIT
  6792*          GO TO 8200-SEND-DATAONLY
  6793*       END-IF
  6794        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6795                                 TO CP-DDF-LO-FACT
  6796        MOVE PD-UEP-FACTOR (P1 P2)
  6797                                 TO CP-DDF-HI-FACT
  6798        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6799        MOVE CM-AH-CLP           TO CP-DDF-CLP
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 119
* SOCK03.cbl
  6800        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6801        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6802           + PD-1ST-YR-ADMIN-ALLOW
  6803        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6804*       IF PI-CLP-YN = 'Y'
  6805*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6806*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6807*                                   CP-DDF-CLP
  6808*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6809*       END-IF
  6810        IF DD-IU-PRESENT
  6811           MOVE 'I'              TO CP-EARNING-METHOD
  6812        END-IF
  6813        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6814                                    CP-CLP-RATE-UP
  6815        IF (CP-CALC-GROSS-FEE)
  6816           AND (CP-IU-RATE-UP NOT = ZEROS)
  6817           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6818              / CP-ORIGINAL-PREMIUM)
  6819           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6820              / (1 - TEX-FACT-8)
  6821        END-IF
  6822     END-IF
  6823     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6824     IF (CP-ERROR-RATE-IS-ZERO)
  6825        OR (CP-ERROR-RATE-NOT-FOUND)
  6826        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6827        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6828          DELIMITED BY SIZE INTO WS-COMMENT
  6829        END-STRING
  6830        IF WS-AH-STATUS NOT = 'H'
  6831           MOVE 'X'                 TO WS-AH-STATUS
  6832        END-IF
  6833        GO TO 0500-EXIT
  6834*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6835*       IF NOT ALREADY-SENT
  6836*          PERFORM 0020-SEND-BUFFER
  6837*                                THRU 0020-EXIT
  6838*          SET ALREADY-SENT      TO TRUE
  6839*       END-IF
  6840*       PERFORM 0025-CLOSE-SOCKET
  6841*                                THRU 0025-EXIT
  6842*       GO TO 0010-RETURN
  6843     END-IF
  6844     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6845                                    WS-TOT-AH-RFND
  6846     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6847     IF ((WS-AH-STATUS = SPACES)
  6848        OR (CP-CALC-REFUND > ZEROS))
  6849                  AND
  6850          (WS-AH-STATUS NOT = 'H')
  6851        MOVE 'A'                 TO WS-AH-STATUS
  6852     END-IF
  6853     IF WS-COMP-ID = 'DCC' or 'VPP'
  6854        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6855        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6856        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6857        MOVE 'C'                 TO CP-DDF-SPEC-CALC
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 120
* SOCK03.cbl
  6858        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6859        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6860        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6861        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6862        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6863     END-IF
  6864     EVALUATE TRUE
  6865        WHEN CP-R-AS-R78
  6866           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6867        WHEN CP-R-AS-PRORATA
  6868           MOVE 'PRORATA'          TO  WS-AH-METHOD
  6869        WHEN CP-REFUND-TYPE-USED = '3'
  6870           MOVE 'CALIF'            TO  WS-AH-METHOD
  6871        WHEN CP-R-AS-TEXAS
  6872           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6873        WHEN CP-R-AS-FARM-PLAN
  6874           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6875        WHEN CP-R-AS-NET-PAY
  6876           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6877        WHEN CP-R-AS-ANTICIPATION
  6878           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6879        WHEN CP-R-AS-MEAN
  6880           MOVE 'MEAN'             TO  WS-AH-METHOD
  6881        WHEN CP-R-AS-SUM-OF-DIGITS
  6882           MOVE 'SUM OF DIGITS'    TO  WS-AH-METHOD
  6883        WHEN CP-GAP-ACTUARIAL
  6884           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6885        WHEN CP-R-AS-REPOSSESSION
  6886           MOVE 'REPOSSESSION'     TO WS-AH-METHOD
  6887     END-EVALUATE
  6888     IF WS-TOT-AH-RFND > ZEROS
  6889        IF (ws-comp-id = 'DCC' or 'VPP')
  6890           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6891           compute ws-work-factor rounded =
  6892              ws-ah-rfnd-clp / cm-ah-clp
  6893        else
  6894           COMPUTE WS-WORK-FACTOR ROUNDED =
  6895              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6896        end-if
  6897        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6898           WS-TOT-AH-COMM
  6899     END-IF
  6900     IF ERACCT-FOUND
  6901        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6902           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6903        END-IF
  6904        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6905           IF (AM-COMM-CHARGEBACK (1) = 99)
  6906                     OR
  6907              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6908                     OR
  6909              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6910              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6911              MOVE ZEROS         TO WS-AH-UEC
  6912           END-IF
  6913        END-IF
  6914     END-IF
  6915     .
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 121
* SOCK03.cbl
  6916 0500-EXIT.
  6917     EXIT.
  6918 0610-GET-ERMAIL.
  6919
  6920     move cm-control-primary     to ws-ma-key
  6921*    MOVE WS-CM-KEY              TO WS-MA-KEY
  6922
  6923* EXEC CICS READ
  6924*       INTO    (MAILING-DATA)
  6925*       DATASET ('ERMAIL')
  6926*       RIDFLD  (WS-MA-KEY)
  6927*       RESP    (WS-RESPONSE)
  6928*    END-EXEC
  6929     MOVE LENGTH OF
  6930      MAILING-DATA
  6931       TO DFHEIV11
  6932     MOVE 'ERMAIL' TO DFHEIV1
  6933*    MOVE '&"IL       E          (  N#00006416' TO DFHEIV0
  6934     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6935     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6936     MOVE X'204E233030303036343136' TO DFHEIV0(25:11)
  6937     CALL 'kxdfhei1' USING DFHEIV0,
  6938           DFHEIV1,
  6939           MAILING-DATA,
  6940           DFHEIV11,
  6941           WS-MA-KEY,
  6942           DFHEIV99,
  6943           DFHEIV99,
  6944           DFHEIV99
  6945     MOVE EIBRESP  TO WS-RESPONSE
  6946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6947
  6948     IF RESP-NORMAL
  6949        MOVE MA-CRED-BENE-NAME   to ws-cred-bene-name
  6950     else
  6951        move spaces              to ws-cred-bene-name
  6952     end-if
  6953
  6954     .
  6955 0610-EXIT.
  6956     EXIT.
  6957 0620-GET-ELCRTT.
  6958
  6959     move cm-control-primary     to ws-cs-key
  6960*    MOVE WS-CM-KEY              TO WS-CS-KEY
  6961     move 'C'                    to WS-CS-TRLR-TYPE
  6962
  6963
  6964* EXEC CICS READ
  6965*       INTO    (CERTIFICATE-TRAILERS)
  6966*       DATASET ('ELCRTT')
  6967*       RIDFLD  (WS-CS-KEY)
  6968*       RESP    (WS-RESPONSE)
  6969*    END-EXEC
  6970     MOVE LENGTH OF
  6971      CERTIFICATE-TRAILERS
  6972       TO DFHEIV11
  6973     MOVE 'ELCRTT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 122
* SOCK03.cbl
  6974*    MOVE '&"IL       E          (  N#00006438' TO DFHEIV0
  6975     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6977     MOVE X'204E233030303036343338' TO DFHEIV0(25:11)
  6978     CALL 'kxdfhei1' USING DFHEIV0,
  6979           DFHEIV1,
  6980           CERTIFICATE-TRAILERS,
  6981           DFHEIV11,
  6982           WS-CS-KEY,
  6983           DFHEIV99,
  6984           DFHEIV99,
  6985           DFHEIV99
  6986     MOVE EIBRESP  TO WS-RESPONSE
  6987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6988
  6989     IF RESP-NORMAL
  6990        MOVE cs-vin-number       to ws-vin
  6991     else
  6992        move spaces              to ws-vin
  6993     end-if
  6994
  6995     .
  6996 0620-EXIT.
  6997     EXIT.
  6998 0700-LINK-REM-TERM.
  6999
  7000* EXEC CICS LINK
  7001*        PROGRAM   ('ELRTRM')
  7002*        COMMAREA  (CALCULATION-PASS-AREA)
  7003*        LENGTH    (CP-COMM-LENGTH)
  7004*    END-EXEC.
  7005     MOVE 'ELRTRM' TO DFHEIV1
  7006*    MOVE '."C                   (   #00006455' TO DFHEIV0
  7007     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7008     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7009     MOVE X'2020233030303036343535' TO DFHEIV0(25:11)
  7010     CALL 'kxdfhei1' USING DFHEIV0,
  7011           DFHEIV1,
  7012           CALCULATION-PASS-AREA,
  7013           CP-COMM-LENGTH,
  7014           DFHEIV99,
  7015           DFHEIV99,
  7016           DFHEIV99,
  7017           DFHEIV99
  7018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7019
  7020 0700-EXIT.
  7021     EXIT.
  7022 0710-LINK-REM-AMOUNT.
  7023
  7024* EXEC CICS LINK
  7025*        PROGRAM   ('ELRAMT')
  7026*        COMMAREA  (CALCULATION-PASS-AREA)
  7027*        LENGTH    (CP-COMM-LENGTH)
  7028*    END-EXEC
  7029     MOVE 'ELRAMT' TO DFHEIV1
  7030*    MOVE '."C                   (   #00006463' TO DFHEIV0
  7031     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 123
* SOCK03.cbl
  7032     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7033     MOVE X'2020233030303036343633' TO DFHEIV0(25:11)
  7034     CALL 'kxdfhei1' USING DFHEIV0,
  7035           DFHEIV1,
  7036           CALCULATION-PASS-AREA,
  7037           CP-COMM-LENGTH,
  7038           DFHEIV99,
  7039           DFHEIV99,
  7040           DFHEIV99,
  7041           DFHEIV99
  7042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7043     .
  7044 0710-EXIT.
  7045     EXIT.
  7046 0720-LINK-REFUND.
  7047
  7048* EXEC CICS LINK
  7049*        PROGRAM   ('ELRFND')
  7050*        COMMAREA  (CALCULATION-PASS-AREA)
  7051*        LENGTH    (CP-COMM-LENGTH)
  7052*    END-EXEC
  7053     MOVE 'ELRFND' TO DFHEIV1
  7054*    MOVE '."C                   (   #00006472' TO DFHEIV0
  7055     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7056     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7057     MOVE X'2020233030303036343732' TO DFHEIV0(25:11)
  7058     CALL 'kxdfhei1' USING DFHEIV0,
  7059           DFHEIV1,
  7060           CALCULATION-PASS-AREA,
  7061           CP-COMM-LENGTH,
  7062           DFHEIV99,
  7063           DFHEIV99,
  7064           DFHEIV99,
  7065           DFHEIV99
  7066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7067     .
  7068 0720-EXIT.
  7069     EXIT.
  7070 0730-GET-DDF-FACTORS.
  7071     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7072     MOVE WS-COMP-CD             TO ERPDEF-KEY
  7073     MOVE CM-STATE               TO ERPDEF-STATE
  7074     if cm-clp-state not = cm-state and spaces and zeros
  7075        move cm-clp-state        to erpdef-state
  7076     end-if
  7077     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7078     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7079     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7080     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7081     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7082
  7083* EXEC CICS STARTBR
  7084*        DATASET  ('ERPDEF')
  7085*        RIDFLD   (ERPDEF-KEY)
  7086*        GTEQ
  7087*        RESP     (WS-RESPONSE)
  7088*    END-EXEC
  7089     MOVE 'ERPDEF' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 124
* SOCK03.cbl
  7090     MOVE 0
  7091       TO DFHEIV11
  7092*    MOVE '&,         G          &  N#00006492' TO DFHEIV0
  7093     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7094     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7095     MOVE X'204E233030303036343932' TO DFHEIV0(25:11)
  7096     CALL 'kxdfhei1' USING DFHEIV0,
  7097           DFHEIV1,
  7098           ERPDEF-KEY,
  7099           DFHEIV99,
  7100           DFHEIV11,
  7101           DFHEIV99
  7102     MOVE EIBRESP  TO WS-RESPONSE
  7103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7104     IF NOT RESP-NORMAL
  7105        GO TO 0730-EXIT
  7106     END-IF
  7107     .
  7108 0730-READNEXT.
  7109
  7110* EXEC CICS READNEXT
  7111*       DATASET  ('ERPDEF')
  7112*       INTO     (PRODUCT-MASTER)
  7113*       RIDFLD   (ERPDEF-KEY)
  7114*       RESP     (WS-RESPONSE)
  7115*    END-EXEC
  7116     MOVE LENGTH OF
  7117      PRODUCT-MASTER
  7118       TO DFHEIV12
  7119     MOVE 'ERPDEF' TO DFHEIV1
  7120     MOVE 0
  7121       TO DFHEIV11
  7122*    MOVE '&.IL                  )  N#00006503' TO DFHEIV0
  7123     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7124     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7125     MOVE X'204E233030303036353033' TO DFHEIV0(25:11)
  7126     CALL 'kxdfhei1' USING DFHEIV0,
  7127           DFHEIV1,
  7128           PRODUCT-MASTER,
  7129           DFHEIV12,
  7130           ERPDEF-KEY,
  7131           DFHEIV99,
  7132           DFHEIV11,
  7133           DFHEIV99,
  7134           DFHEIV99
  7135     MOVE EIBRESP  TO WS-RESPONSE
  7136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7137     IF NOT RESP-NORMAL
  7138        GO TO 0730-ENDBR
  7139     END-IF
  7140     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7141        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7142           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7143        ELSE
  7144           GO TO 0730-READNEXT
  7145        END-IF
  7146     ELSE
  7147        GO TO 0730-ENDBR
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 125
* SOCK03.cbl
  7148     END-IF
  7149     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7150        (P1 > +8)
  7151        OR (PD-PROD-CODE (P1) = 'I')
  7152     END-PERFORM
  7153     IF P1 < +9
  7154        SET DD-IU-PRESENT        TO TRUE
  7155     END-IF
  7156     IF CM-LOAN-TERM = ZEROS
  7157        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7158     END-IF
  7159     IF PD-TRUNCATED = 'Y'
  7160        MOVE CM-LOAN-TERM        TO WS-TERM
  7161     ELSE
  7162        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7163     END-IF
  7164     EVALUATE TRUE
  7165        WHEN WS-TERM > +168
  7166           MOVE 15               TO P1
  7167        WHEN WS-TERM > +156
  7168           MOVE 14               TO P1
  7169        WHEN WS-TERM > +144
  7170           MOVE 13               TO P1
  7171        WHEN WS-TERM > +132
  7172           MOVE 12               TO P1
  7173        WHEN WS-TERM > +120
  7174           MOVE 11               TO P1
  7175        WHEN WS-TERM > +108
  7176           MOVE 10               TO P1
  7177        WHEN WS-TERM > +96
  7178           MOVE 9                TO P1
  7179        WHEN WS-TERM > +84
  7180           MOVE 8                TO P1
  7181        WHEN WS-TERM > +72
  7182           MOVE 7                TO P1
  7183        WHEN WS-TERM > +60
  7184           MOVE 6                TO P1
  7185        WHEN WS-TERM > +48
  7186           MOVE 5                TO P1
  7187        WHEN WS-TERM > +36
  7188           MOVE 4                TO P1
  7189        WHEN WS-TERM > +24
  7190           MOVE 3                TO P1
  7191        WHEN WS-TERM > +12
  7192           MOVE 2                TO P1
  7193        WHEN OTHER
  7194           MOVE 1                TO P1
  7195     END-EVALUATE
  7196     EVALUATE TRUE
  7197*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7198*          AND (DD-IU-PRESENT)
  7199*          MOVE 2                TO P2
  7200*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7201*          MOVE 1                TO P2
  7202        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7203           MOVE 2                TO P2
  7204        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7205           MOVE 3                TO P2
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 126
* SOCK03.cbl
  7206        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7207           MOVE 4                TO P2
  7208        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7209           MOVE 5                TO P2
  7210        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7211           MOVE 6                TO P2
  7212        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7213           MOVE 7                TO P2
  7214        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7215           MOVE 8                TO P2
  7216        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7217           MOVE 9                TO P2
  7218        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7219           MOVE 10               TO P2
  7220        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7221           MOVE 11               TO P2
  7222        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7223           MOVE 12               TO P2
  7224        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7225           MOVE 13               TO P2
  7226        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7227           MOVE 14               TO P2
  7228        WHEN OTHER
  7229           MOVE 15               TO P2
  7230     END-EVALUATE
  7231     .
  7232 0730-ENDBR.
  7233
  7234* EXEC CICS ENDBR
  7235*       DATASET  ('ERPDEF')
  7236*    END-EXEC
  7237     MOVE 'ERPDEF' TO DFHEIV1
  7238     MOVE 0
  7239       TO DFHEIV11
  7240*    MOVE '&2                    $   #00006605' TO DFHEIV0
  7241     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7242     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7243     MOVE X'2020233030303036363035' TO DFHEIV0(25:11)
  7244     CALL 'kxdfhei1' USING DFHEIV0,
  7245           DFHEIV1,
  7246           DFHEIV11,
  7247           DFHEIV99
  7248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7249     .
  7250 0730-EXIT.
  7251     EXIT.
  7252 0740-GET-ERCTBL.
  7253     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7254     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7255     MOVE 'A'                    TO CTBL-BEN-TYPE
  7256     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7257     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7258     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7259     IF RESP-NORMAL
  7260        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7261     ELSE
  7262        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7263        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 127
* SOCK03.cbl
  7264        MOVE 'A'                    TO CTBL-BEN-TYPE
  7265        MOVE 'AA'                   TO CTBL-BEN-CODE
  7266        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7267        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7268        IF RESP-NORMAL
  7269           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7270        END-IF
  7271     END-IF
  7272     .
  7273 0740-EXIT.
  7274     EXIT.
  7275 0750-READ-ERCTBL.
  7276
  7277* EXEC CICS READ
  7278*         INTO    (COMM-TABLE-RECORD)
  7279*         DATASET ('ERCTBL')
  7280*         RIDFLD  (CTBL-KEY)
  7281*         RESP    (WS-RESPONSE)
  7282*    END-EXEC
  7283     MOVE LENGTH OF
  7284      COMM-TABLE-RECORD
  7285       TO DFHEIV11
  7286     MOVE 'ERCTBL' TO DFHEIV1
  7287*    MOVE '&"IL       E          (  N#00006635' TO DFHEIV0
  7288     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7289     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7290     MOVE X'204E233030303036363335' TO DFHEIV0(25:11)
  7291     CALL 'kxdfhei1' USING DFHEIV0,
  7292           DFHEIV1,
  7293           COMM-TABLE-RECORD,
  7294           DFHEIV11,
  7295           CTBL-KEY,
  7296           DFHEIV99,
  7297           DFHEIV99,
  7298           DFHEIV99
  7299     MOVE EIBRESP  TO WS-RESPONSE
  7300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7301     .
  7302 0750-EXIT.
  7303     EXIT.
  7304 0760-FIND-COMM.
  7305     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7306        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7307        OR (C1 > +3)
  7308     END-PERFORM
  7309     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7310        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7311        OR (C2 > +3)
  7312     END-PERFORM
  7313     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7314        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7315        OR (C3 > +3)
  7316     END-PERFORM
  7317     IF C1 > +3
  7318        MOVE +1                  TO C1
  7319     END-IF
  7320     IF C2 > +3
  7321        MOVE +1                  TO C2
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 128
* SOCK03.cbl
  7322     END-IF
  7323     IF C3 > +3
  7324        MOVE +1                  TO C3
  7325     END-IF
  7326     IF C1 = +3
  7327        MOVE +18                 TO C0
  7328     ELSE
  7329        IF C1 = +2
  7330           MOVE +9               TO C0
  7331        END-IF
  7332     END-IF
  7333     IF C2 = +3
  7334        ADD +6                   TO C0
  7335     ELSE
  7336        IF C2 = +2
  7337           ADD +3                TO C0
  7338        END-IF
  7339     END-IF
  7340     ADD C3                      TO C0
  7341     MOVE CT-RT (C0)             TO WS-COMM-PCT
  7342     .
  7343 0760-EXIT.
  7344     EXIT.
  7345 9700-DATE-LINK.
  7346
  7347* EXEC CICS LINK
  7348*         PROGRAM  ('ELDATCV')
  7349*         COMMAREA (DATE-CONVERSION-DATA)
  7350*         LENGTH   (DC-COMM-LENGTH)
  7351*    END-EXEC.
  7352     MOVE 'ELDATCV' TO DFHEIV1
  7353*    MOVE '."C                   (   #00006686' TO DFHEIV0
  7354     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7355     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7356     MOVE X'2020233030303036363836' TO DFHEIV0(25:11)
  7357     CALL 'kxdfhei1' USING DFHEIV0,
  7358           DFHEIV1,
  7359           DATE-CONVERSION-DATA,
  7360           DC-COMM-LENGTH,
  7361           DFHEIV99,
  7362           DFHEIV99,
  7363           DFHEIV99,
  7364           DFHEIV99
  7365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7366
  7367 9700-EXIT.
  7368      EXIT.
  7369
  7370 9999-DFHBACK SECTION.
  7371     MOVE '9%                    "   ' TO DFHEIV0
  7372     MOVE 'SOCK03' TO DFHEIV1
  7373     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7374     GOBACK.
  7375 9999-DFHEXIT.
  7376     IF DFHEIGDJ EQUAL 0001
  7377         NEXT SENTENCE.
  7378     MOVE '9%                    "   ' TO DFHEIV0
  7379     MOVE 'SOCK03' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 27-Apr-20 14:42 Page 129
* SOCK03.cbl
  7380     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7381     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       20144     Code:       30600
