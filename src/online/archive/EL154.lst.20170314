* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   1
* EL154.cbl
* Options: int("EL154.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL154.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL154.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL154.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL154.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/21/94 15:39:26.
     7*                            VMOD=2.022
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   2
* EL154.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EX28 - SET-UP AUTOMATIC PAYMENTS.
    26*        USED TO CREATE NEW AUTOMATIC PAYMENT SCHEDULES AND/OR
    27*        SIGN-OFF CURRENT SCHEDULES.  ONCE A SCHEDULE HAS BEEN
    28*        CREATED IT MAY ONLY BY REPLACED - NOT CHANGED
    29*        OR DELETED.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 090108    2007041300006  AJRA  ENTER LETTER FORM NUMBER ON SET U
    39* 031809    2009031600001  AJRA  ALLOW IU PAYMENT PAST EXP DATE
    40* 070909    2009060400001  AJRA  ADD AUTO PAY STOP LETTER
    41* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    42* 100713  IR2013092400001  PEMA  USE EXP DT IF NO CRIT PER - DCC
    43* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    44* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    45* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    46* 030515  IR2015030300002  PEMA  FIX CRIT PERIOD EDITS
    47* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    48******************************************************************
    49
    50 ENVIRONMENT DIVISION.
    51
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   3
* EL154.cbl
    53 DATA DIVISION.
    54 WORKING-STORAGE SECTION.
    55 01  DFH-START PIC X(04).
    56 77  FILLER  PIC X(32)  VALUE '********************************'.
    57 77  FILLER  PIC X(32)  VALUE '*    EL154 WORKING STORAGE     *'.
    58 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.022 *********'.
    59 77  P1                          PIC S999 COMP-3 VALUE +0.
    60 77  P2                          PIC S999 COMP-3 VALUE +0.
    61 77  s1                          PIC S999 COMP-3 VALUE +0.
    62 77  s2                          PIC S999 COMP-3 VALUE +0.
    63 77  ws-benefit-expiration-dt    pic xx value low-values.
    64 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
    65 77  ws-proposed-benefits        pic s999 comp-3 value +0.
    66
    67*                            COPY ELCSCTM.
    68******************************************************************
    69*                                                                *
    70*                                                                *
    71*                            ELCSCTM                             *
    72*                            VMOD=2.001                          *
    73*                                                                *
    74*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    75*                                                                *
    76******************************************************************
    77 01  SECURITY-MESSAGE.
    78     12  FILLER                          PIC X(30)
    79            VALUE '** LOGIC SECURITY VIOLATION -'.
    80     12  SM-READ                         PIC X(6).
    81     12  FILLER                          PIC X(5)
    82            VALUE ' PGM='.
    83     12  SM-PGM                          PIC X(6).
    84     12  FILLER                          PIC X(5)
    85            VALUE ' OPR='.
    86     12  SM-PROCESSOR-ID                 PIC X(4).
    87     12  FILLER                          PIC X(6)
    88            VALUE ' TERM='.
    89     12  SM-TERMID                       PIC X(4).
    90     12  FILLER                          PIC XX   VALUE SPACE.
    91     12  SM-JUL-DATE                     PIC 9(5).
    92     12  FILLER                          PIC X    VALUE SPACE.
    93     12  SM-TIME                         PIC 99.99.
    94
    95
    96*                            COPY ELCSCRTY.
    97******************************************************************
    98*                                                                *
    99*                                                                *
   100*                            ELCSCRTY                            *
   101*                            VMOD=2.001                          *
   102*                                                                *
   103*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   104*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   105*        SAVED IN PI-SECURITY-ADDRESS.                           *
   106*                                                                *
   107******************************************************************
   108 01  SECURITY-CONTROL.
   109     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   110     12  FILLER                       PIC XX    VALUE 'SC'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   4
* EL154.cbl
   111     12  SC-CREDIT-CODES.
   112         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   113             20  SC-CREDIT-DISPLAY    PIC X.
   114             20  SC-CREDIT-UPDATE     PIC X.
   115     12  SC-CLAIMS-CODES.
   116         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   117             20  SC-CLAIMS-DISPLAY    PIC X.
   118             20  SC-CLAIMS-UPDATE     PIC X.
   119
   120 01  WS-DATE-AREA.
   121     05  CURRENT-GREG-DATE   PIC X(8)    VALUE SPACES.
   122     05  CURRENT-BIN-DATE    PIC X(2)    VALUE SPACES.
   123     05  RETRO-ELIM-DATE     PIC XX      VALUE LOW-VALUES.
   124
   125 01  ws-dcc-product-code         pic xxx value spaces.
   126 01  ws-clp-state                pic xx  value spaces.
   127 01  ws-ah-benefit-cd            pic xx  value '00'.
   128 01  ws-edit-1st-pmt-amt         pic s9(9)v99 comp-3 value +0.
   129 01  ws-monthly-benefit          pic s9(9)v99 comp-3 value +0.
   130 01  ws-max-benefit-amt          pic s9(9)v99 comp-3 value +0.
   131 01  ws-max-benefit-pmts         pic s999 comp-3 value +0.
   132 01  ws-benefits-prev-paid       pic s999 comp-3 value +0.
   133 01  ws-total-paid               pic s9(9)v99 comp-3 value +0.
   134 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   135     88  PDEF-FOUND                   VALUE 'Y'.
   136 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   137     88  ACCT-FOUND                   VALUE 'Y'.
   138 01  ws-cert-trlr-sw             PIC X  VALUE ' '.
   139     88  cert-trlr-found              VALUE 'Y'.
   140 01  STANDARD-AREAS.
   141     12  WS-RESPONSE             PIC S9(8)   COMP.
   142         88  WS-RESP-NORMAL        VALUE +00.
   143         88  WS-RESP-ERROR         VALUE +01.
   144         88  WS-RESP-NOTFND        VALUE +13.
   145         88  WS-RESP-DUPREC        VALUE +14.
   146         88  WS-RESP-ENDFILE       VALUE +20.
   147     12  SC-ITEM             PIC S9(4)   VALUE +1  COMP.
   148     12  SUB-1               PIC S9(4)   VALUE +0  COMP.
   149     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   150     12  MAP-NAME.
   151         16  MAP-PRE         PIC XX      VALUE 'EL'.
   152         16  MAP-NUMBER      PIC X(4)    VALUE '154A'.
   153         16  FILLER          PIC XX      VALUE SPACES.
   154     12  MAPSET-NAME         PIC X(8)    VALUE 'EL154S'.
   155     12  TRANS-ID            PIC X(4)    VALUE 'EX28'.
   156     12  LGXX-ID             PIC X(4)    VALUE 'LGXX'.
   157     12  PGM-NAME            PIC X(8).
   158     12  TIME-IN             PIC S9(7).
   159     12  TIME-OUT-R  REDEFINES TIME-IN.
   160         16  FILLER          PIC X.
   161         16  TIME-OUT        PIC 99V99.
   162         16  FILLER          PIC X(2).
   163     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   164     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   165     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   166
   167     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   168     12  LINK-004            PIC X(8)    VALUE 'EL004'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   5
* EL154.cbl
   169     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   170     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   171     12  THIS-PGM            PIC X(8)    VALUE 'EL154'.
   172
   173     12  DEEDIT-FIELD            PIC X(15).
   174     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   175
   176     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   177     12  NEFFDTE-SAVE            PIC XX       VALUE LOW-VALUES.
   178     12  NFSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   179     12  NLSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   180     12  NFSTAMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   181     12  NREGPMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   182     12  CURRENT-SAVE            PIC XX       VALUE LOW-VALUES.
   183     12  LETTDTE-SAVE            PIC X(10)    VALUE SPACES.
   184     12  WS-WORK                 PIC S9(5)    VALUE ZERO COMP-3.
   185     12  WS-REMAINDER            PIC S9(5)    VALUE ZERO COMP-3.
   186     12  WS-DAYS-MINUS-TOL       PIC S9(5)    VALUE ZERO COMP-3.
   187     12  WS-DAYS-PLUS-TOL        PIC S9(5)    VALUE ZERO COMP-3.
   188     12  WS-DAILY-BEN-AMT        PIC S9(5)V99 VALUE ZERO COMP-3.
   189     12  WS-AMT-MINUS-TOL        PIC S9(7)V99 VALUE ZERO COMP-3.
   190     12  WS-AMT-PLUS-TOL         PIC S9(7)V99 VALUE ZERO COMP-3.
   191     12  WS-AMT-TOL              PIC S9(5)V99 VALUE ZERO COMP-3.
   192     12  WS-DAY-TOL              PIC S9(05)   VALUE ZERO COMP-3.
   193     12  WS-MAX-AUTO-PMT         PIC S9(7)V99 VALUE ZERO COMP-3.
   194     12  WS-MAX-AUTO-MOS         PIC S999     VALUE ZERO COMP-3.
   195     12  WS-ELAPSED-DAYS         PIC S9(04)   VALUE +0   COMP.
   196     12  WS-REG-PMT              PIC S9(7)V99 VALUE ZERO COMP-3.
   197     12  WS-EXP-DT               PIC XX       VALUE LOW-VALUES.
   198     12  WS-EXP-DT-PLUS7         PIC XX       VALUE LOW-VALUES.
   199     12  WS-CALC-METHOD          PIC X.
   200     12  WS-DAILY-RATE           PIC S9(3)V99.
   201     12  WS-CONFIRM-NEEDED       PIC X.
   202     12  WS-ELIMINATION-SW       PIC X        VALUE SPACES.
   203         88  NO-EFFDTE-ENTERED   VALUE 'N'.
   204     12  WS-BENEFIT-FOUND-SW     PIC X        VALUE SPACES.
   205         88  BENEFIT-FOUND       VALUE 'Y'.
   206     12  WS-ACT-REC-FOUND-SW     PIC X(01)    VALUE 'N'.
   207     12  WS-LETTER-SW            PIC X(01)    VALUE 'N'.
   208     12  WS-LETTER-FORM-NUM      PIC X(04)    VALUE SPACES.
   209     12  WS-END-LETTER-FORM-NUM  PIC X(04)    VALUE SPACES.
   210     12  WS-RESET-SW             PIC X(01)    VALUE 'N'.
   211     12  WS-PAYEE-CODE.
   212         16  WS-PAYEE-CD         PIC X(01).
   213         16  WS-PAYEE-SEQ        PIC X(01).
   214         16  WS-PAYEE-SEQ-NUM REDEFINES
   215             WS-PAYEE-SEQ        PIC 9(01).
   216     12  WS-ACCESS.
   217         16  FILLER              PIC XX       VALUE SPACES.
   218         16  WS-BEN-CD           PIC XX.
   219
   220     12  MISC-HEADING-AREAS.
   221         16  FIRST-PMT-HD1       PIC X(23)    VALUE
   222             'FIRST PAY THRU DATE   :'.
   223         16  FIRST-PMT-HD2       PIC X(23)    VALUE
   224             'FIRST PAY-TO DATE     :'.
   225         16  FIRST-PMT-HD3       PIC X(26)    VALUE
   226             '   FIRST PAY-THRU DATE   :'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   6
* EL154.cbl
   227         16  FIRST-PMT-HD4       PIC X(26)    VALUE
   228             '   FIRST PAY-TO DATE     :'.
   229         16  LAST-PMT-HD1        PIC X(24)    VALUE
   230             'LAST PAY-THRU DATE     :'.
   231         16  LAST-PMT-HD2        PIC X(24)    VALUE
   232             'LAST PAY-TO DATE       :'.
   233         16  LAST-PMT-HD3        PIC X(23)    VALUE
   234             'LAST PAY-THRU DATE    :'.
   235         16  LAST-PMT-HD4        PIC X(23)    VALUE
   236             'LAST PAY-TO DATE      :'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   7
* EL154.cbl
   238 01  ERROR-MESSAGES.
   239     12  ER-0000                 PIC X(4)     VALUE '0000'.
   240     12  ER-0004                 PIC X(4)     VALUE '0004'.
   241     12  ER-0008                 PIC X(4)     VALUE '0008'.
   242     12  ER-0029                 PIC X(4)     VALUE '0029'.
   243     12  ER-0042                 PIC X(4)     VALUE '0042'.
   244     12  ER-0050                 PIC X(4)     VALUE '0050'.
   245     12  ER-0070                 PIC X(4)     VALUE '0070'.
   246     12  ER-0130                 PIC X(4)     VALUE '0130'.
   247     12  ER-0154                 PIC X(4)     VALUE '0154'.
   248     12  ER-0169                 PIC X(4)     VALUE '0169'.
   249     12  ER-0172                 PIC X(4)     VALUE '0172'.
   250     12  ER-0186                 PIC X(4)     VALUE '0186'.
   251     12  ER-0206                 PIC X(4)     VALUE '0206'.
   252     12  ER-0283                 PIC X(4)     VALUE '0283'.
   253     12  ER-0346                 PIC X(4)     VALUE '0346'.
   254     12  ER-0347                 PIC X(4)     VALUE '0347'.
   255     12  ER-0348                 PIC X(4)     VALUE '0348'.
   256     12  ER-0349                 PIC X(4)     VALUE '0349'.
   257     12  ER-0350                 PIC X(4)     VALUE '0350'.
   258     12  ER-0351                 PIC X(4)     VALUE '0351'.
   259     12  ER-0352                 PIC X(4)     VALUE '0352'.
   260     12  ER-0353                 PIC X(4)     VALUE '0353'.
   261     12  ER-0354                 PIC X(4)     VALUE '0354'.
   262     12  ER-0357                 PIC X(4)     VALUE '0357'.
   263     12  ER-0358                 PIC X(4)     VALUE '0358'.
   264     12  ER-0372                 PIC X(4)     VALUE '0372'.
   265     12  ER-0396                 PIC X(4)     VALUE '0396'.
   266     12  ER-0397                 PIC X(4)     VALUE '0397'.
   267     12  ER-0398                 PIC X(4)     VALUE '0398'.
   268     12  ER-0399                 PIC X(4)     VALUE '0399'.
   269     12  ER-0401                 PIC X(4)     VALUE '0401'.
   270     12  ER-0402                 PIC X(4)     VALUE '0402'.
   271     12  ER-0403                 PIC X(4)     VALUE '0403'.
   272     12  ER-0404                 PIC X(4)     VALUE '0404'.
   273     12  ER-0450                 PIC X(4)     VALUE '0450'.
   274     12  ER-0541                 PIC X(4)     VALUE '0541'.
   275     12  ER-0559                 PIC X(4)     VALUE '0559'.
   276     12  ER-0563                 PIC X(4)     VALUE '0563'.
   277     12  ER-0597                 PIC X(4)     VALUE '0597'.
   278     12  ER-0632                 PIC X(4)     VALUE '0632'.
   279     12  ER-0670                 PIC X(4)     VALUE '0670'.
   280     12  ER-0802                 PIC X(4)     VALUE '0802'.
   281     12  ER-0803                 PIC X(4)     VALUE '0803'.
   282     12  ER-0815                 PIC X(4)     VALUE '0815'.
   283     12  ER-0826                 PIC X(4)     VALUE '0826'.
   284     12  ER-0839                 PIC X(4)     VALUE '0839'.
   285     12  ER-1599                 PIC X(4)     VALUE '1599'.
   286     12  er-1657                 pic x(4)     value '1657'.
   287     12  er-1658                 pic x(4)     value '1658'.
   288     12  er-1672                 pic x(4)     value '1672'.
   289     12  er-1674                 pic x(4)     value '1674'.
   290     12  ER-3396                 PIC X(4)     VALUE '3396'.
   291     12  ER-3397                 PIC X(4)     VALUE '3397'.
   292     12  ER-3537                 PIC X(4)     VALUE '3537'.
   293     12  ER-3801                 PIC X(4)     VALUE '3801'.
   294     12  ER-8200                 PIC X(4)     VALUE '8200'.
   295     12  ER-9483                 PIC X(4)     VALUE '9483'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   8
* EL154.cbl
   296     12  ER-9883                 PIC X(4)     VALUE '9883'.
   297
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page   9
* EL154.cbl
   299 01  ACCESS-KEYS.
   300     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   301     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   302     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   303     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   304     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   305     12  EMPLCY-ID                PIC X(8)    VALUE 'MPPLCY'.
   306
   307     12  CNTL-KEY.
   308         16  CNTL-CO              PIC X(3).
   309         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   310         16  CNTL-GENL.
   311           18 CNTL-GEN1           PIC X(2)    VALUE SPACES.
   312           18 CNTL-GEN2.
   313             20 CNTL-GEN3         PIC X       VALUE SPACES.
   314             20 CNTL-GEN4         PIC X       VALUE SPACES.
   315         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   316
   317     12  ELTRLR-KEY.
   318         16  TRLR-COMP-CD        PIC X.
   319         16  TRLR-CARRIER        PIC X.
   320         16  TRLR-CLAIM-NO       PIC X(7).
   321         16  TRLR-CERT-NO        PIC X(11).
   322         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   323     12  CLAM-KEY.
   324         16  CLAM-CO              PIC X.
   325         16  CLAM-CARRIER         PIC X.
   326         16  CLAM-CLAIM           PIC X(7).
   327         16  CLAM-CERT-NUM        PIC X(11).
   328
   329     12  CLAIM-SAVE-KEY           PIC X(20).
   330
   331     12  ACTV-KEY.
   332         16  ACTV-PARTIAL-KEY.
   333             20  ACTV-CO          PIC X.
   334             20  ACTV-CARRIER     PIC X.
   335             20  ACTV-CLAIM       PIC X(7).
   336             20  ACTV-CERT-NUM    PIC X(11).
   337         16  ACTV-SEQ             PIC S9(4)  COMP.
   338
   339     12  CERT-KEY.
   340         16  CERT-CO             PIC X.
   341         16  CERT-CARRIER        PIC X.
   342         16  CERT-GROUPING       PIC X(6).
   343         16  CERT-STATE          PIC XX.
   344         16  CERT-ACCOUNT        PIC X(10).
   345         16  CERT-EFF-DT         PIC XX.
   346         16  CERT-CERT-NUM       PIC X(11).
   347
   348     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   349     12  ERACCT-KEY.
   350         16  ERACCT-PARTIAL-KEY.
   351             20  ACCT-COMP-CD    PIC X.
   352             20  ACCT-CARRIER    PIC X.
   353             20  ACCT-GROUPING   PIC X(6).
   354             20  ACCT-STATE      PIC XX.
   355             20  ACCT-ACCOUNT    PIC X(10).
   356         16  ACCT-EXP-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  10
* EL154.cbl
   357         16  FILLER              PIC X(4) VALUE SPACES.
   358     12  EMPLCY-KEY.
   359         16  EMPLCY-COMPANY-CD   PIC X(01).
   360         16  EMPLCY-CARRIER      PIC X(01).
   361         16  EMPLCY-GROUPING     PIC X(06).
   362         16  EMPLCY-STATE        PIC X(02).
   363         16  EMPLCY-PRODUCER     PIC X(10).
   364         16  EMPLCY-EFF-DT       PIC X(02).
   365         16  EMPLCY-REFERENCE-NO PIC X(20).
   366
   367     12  BENE-KEY.
   368         16  BENE-CO             PIC X(01).
   369         16  BENE-REC-TYPE       PIC X(01).
   370         16  BENE-CODE           PIC X(10).
   371 01  ERPDEF-KEY-SAVE             PIC X(18).
   372 01  ERPDEF-KEY.
   373     12  ERPDEF-COMPANY-CD       PIC X.
   374     12  ERPDEF-STATE            PIC XX.
   375     12  ERPDEF-PROD-CD          PIC XXX.
   376     12  F                       PIC X(7).
   377     12  ERPDEF-BEN-TYPE         PIC X.
   378     12  ERPDEF-BEN-CODE         PIC XX.
   379     12  ERPDEF-EXP-DT           PIC XX.
   380
   381 01  ELCRTT-KEY.
   382     05  CTRLR-COMP-CD       PIC X.
   383     05  CTRLR-CARRIER       PIC X.
   384     05  CTRLR-GROUPING      PIC X(6).
   385     05  CTRLR-STATE         PIC X(2).
   386     05  CTRLR-ACCOUNT       PIC X(10).
   387     05  CTRLR-EFF-DT        PIC XX.
   388     05  CTRLR-CERT-NO       PIC X(11).
   389     05  CTRLR-REC-TYPE      PIC X.
   390*                            COPY ELCCALC.
   391******************************************************************
   392*                                                                *
   393*                           ELCCALC.                            *
   394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   395*                            VMOD=2.025                          *
   396*                                                                *
   397*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   398*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   399*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   400*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   401*                                                                *
   402*  PASSED TO ELRTRM                                              *
   403*  -----------------                                             *
   404*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   405*  ORIGINAL TERM                                                 *
   406*  BEGINNING DATE                                                *
   407*  ENDING DATE                                                   *
   408*  COMPANY I.D.                                                  *
   409*  ACCOUNT MASTER USER FIELD                                     *
   410*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   411*  FREE LOOK DAYS                                                *
   412*                                                                *
   413*  RETURNED FROM ELRTRM                                          *
   414*  ---------------------                                         *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  11
* EL154.cbl
   415*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   416*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   417*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   418*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   419*----------------------------------------------------------------*
   420*  PASSED TO ELRAMT                                              *
   421*  ----------------                                              *
   422*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   423*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   424*  ORIGINAL AMOUNT                                               *
   425*  ALTERNATE BENEFIT (BALLON)                                    *
   426*  A.P.R. - NET PAY ONLY                                         *
   427*  METHOD
   428*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   429*  COMPANY I.D.                                                  *
   430*  BENEFIT TYPE                                                  *
   431*                                                                *
   432*  RETURNED FROM ELRAMT                                          *
   433*  --------------------                                          *
   434*  REMAINING AMOUNT 1 - CURRENT                                  *
   435*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   436*  REMAINING AMOUNT FACTOR
   437*----------------------------------------------------------------*
   438*  PASSED TO ELRESV                                              *
   439*  -----------------                                             *
   440*  CERTIFICATE EFFECTIVE DATE                                    *
   441*  VALUATION DATE                                                *
   442*  PAID THRU DATE                                                *
   443*  BENEFIT                                                       *
   444*  INCURRED DATE                                                 *
   445*  REPORTED DATE                                                 *
   446*  ISSUE AGE                                                     *
   447*  TERM                                                          *
   448*  CDT PERCENT                                                   *
   449*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   450* *CLAIM TYPE (LIFE, A/H)                                        *
   451* *REMAINING BENEFIT (FROM ELRAMT)                               *
   452* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   453*                                                                *
   454*  RETURNED FROM ELRESV                                          *
   455*  --------------------                                          *
   456*  CDT TABLE USED                                                *
   457*  CDT FACTOR USED                                               *
   458*  PAY TO CURRENT RESERVE                                        *
   459*  I.B.N.R. - A/H ONLY                                           *
   460*  FUTURE (ACCRUED) AH ONLY                                      *
   461*----------------------------------------------------------------*
   462*  PASSED TO ELRATE                                              *
   463*  ----------------                                              *
   464*  CERT ISSUE DATE                                               *
   465*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   466*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   467*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   468*  STATE CODE (CLIENT DEFINED)                                   *
   469*  STATE CODE (STANDARD P.O. ABBRV)                              *
   470*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   471*  DEVIATION CODE                                                *
   472*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  12
* EL154.cbl
   473*  ORIGINAL BENEFIT AMOUNT                                       *
   474*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   475*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   476*  BENEFIT KIND (LIFE OR A/H)                                    *
   477*  A.P.R.                                                        *
   478*  METHOD
   479*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   480*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   481*  COMPANY I.D. (3 CHARACTER)                                    *
   482*  BENEFIT CODE                                                  *
   483*  BENEFIT OVERRIDE CODE                                         *
   484*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   485*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   486*  JOINT INDICATOR (CSL ONLY)                                    *
   487*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   488*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   489*                                                                *
   490*  RETURNED FROM ELRATE                                          *
   491*  --------------------                                          *
   492*  CALCULATED PREMIUM                                            *
   493*  PREMIUM RATE                                                  *
   494*  MORTALITY CODE                                                *
   495*  MAX ATTAINED AGE                                              *
   496*  MAX AGE                                                       *
   497*  MAX TERM                                                      *
   498*  MAX MONTHLY BENEFIT                                           *
   499*  MAX TOTAL BENIFIT                                             *
   500*  COMPOSITE RATE (OPEN-END ONLY)                                *
   501*----------------------------------------------------------------*
   502*  PASSED TO ELRFND                                              *
   503*  ----------------                                              *
   504*  CERT ISSUE DATE                                               *
   505*  REFUND DATE                                                   *
   506*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   507*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   508*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   509*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   510*  STATE CODE (CLIENT DEFINED)                                   *
   511*  STATE CODE (STANDARD P.O. ABBRV)                              *
   512*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   513*  DEVIATION CODE                                                *
   514*  ISSUE AGE                                                     *
   515*  ORIGINAL BENEFIT AMOUNT                                       *
   516*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   517*  PROCESS TYPE (CANCEL)                                         *
   518*  BENEFIT KIND (LIFE OR A/H)                                    *
   519*  A.P.R.                                                        *
   520*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   521*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   522*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   523*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   524*  COMPANY I.D. (3 CHARACTER)                                    *
   525*  BENEFIT CODE                                                  *
   526*  BENEFIT OVERRIDE CODE                                         *
   527*                                                                *
   528*  RETURNED FROM ELRFND                                          *
   529*  --------------------                                          *
   530*  CALCULATED REFUND                                             *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  13
* EL154.cbl
   531*----------------------------------------------------------------*
   532*  PASSED TO ELEARN                                              *
   533*  ----------------                                              *
   534*  CERT ISSUE DATE                                               *
   535*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   536*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   537*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   538*  STATE CODE (CLIENT DEFINED)                                   *
   539*  STATE CODE (STANDARD P.O. ABBRV)                              *
   540*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   541*  DEVIATION CODE                                                *
   542*  ISSUE AGE                                                     *
   543*  ORIGINAL BENEFIT AMOUNT                                       *
   544*  BENEFIT KIND (LIFE OR A/H)                                    *
   545*  A.P.R.                                                        *
   546*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   547*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   548*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   549*  COMPANY I.D. (3 CHARACTER)                                    *
   550*  BENEFIT CODE                                                  *
   551*  BENEFIT OVERRIDE CODE                                         *
   552*                                                                *
   553*  RETURNED FROM ELEARN                                          *
   554*  --------------------                                          *
   555*  INDICATED  EARNINGS                                           *
   556*----------------------------------------------------------------*
   557*                 LENGTH = 450                                   *
   558*                                                                *
   559******************************************************************
   560******************************************************************
   561*                   C H A N G E   L O G
   562*
   563* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   564*-----------------------------------------------------------------
   565*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   566* EFFECTIVE    NUMBER
   567*-----------------------------------------------------------------
   568* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   569* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   570* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   571* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   572* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   573* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   574* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   575* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   576* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   577* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   578******************************************************************
   579
   580 01  CALCULATION-PASS-AREA.
   581     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   582                                     COMP.
   583
   584     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   585       88  NO-CP-ERROR                             VALUE ZERO.
   586       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   587                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   588       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  14
* EL154.cbl
   589       88  CP-ERROR-IN-DATES                       VALUE '2'.
   590       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   591       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   592       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   593       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   594       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   595       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   596       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   597       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   598       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   599       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   600       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   601       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   602       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   603       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   604       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   605
   606     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   607       88  NO-CP-ERROR-2                           VALUE ZERO.
   608***********************  INPUT AREAS ****************************
   609
   610     12  CP-CALCULATION-AREA.
   611         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   612         16  CP-CERT-EFF-DT        PIC XX.
   613         16  CP-VALUATION-DT       PIC XX.
   614         16  CP-PAID-THRU-DT       PIC XX.
   615         16  CP-BENEFIT-TYPE       PIC X.
   616           88  CP-AH                               VALUE 'A' 'D'
   617                                                   'I' 'U'.
   618           88  CP-REDUCING-LIFE                    VALUE 'R'.
   619           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   620         16  CP-INCURRED-DT        PIC XX.
   621         16  CP-REPORTED-DT        PIC XX.
   622         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   623         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   624         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   625                                     COMP-3.
   626         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   627                                     COMP-3.
   628         16  CP-CDT-METHOD         PIC X.
   629           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   630           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   631           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   632         16  CP-CLAIM-TYPE         PIC X.
   633           88  CP-AH-CLAIM                         VALUE 'A'.
   634           88  CP-LIFE-CLAIM                       VALUE 'L'.
   635         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   636                                     COMP-3.
   637         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   638                                     COMP-3.
   639         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   640                                     COMP-3.
   641         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   642                                     COMP-3.
   643         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   644                                     COMP-3.
   645         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   646                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  15
* EL154.cbl
   647         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   648                                     COMP-3.
   649         16  CP-REM-TERM-METHOD    PIC X.
   650           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   651           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   652           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   653           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   654           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   655           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   656           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   657         16  CP-EARNING-METHOD     PIC X.
   658           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   659           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   660           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   661           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   662           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   663           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   664           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   665           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   666           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   667           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   668           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   669           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   670           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   671           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   672         16  CP-PROCESS-TYPE       PIC X.
   673           88  CP-CLAIM                            VALUE '1'.
   674           88  CP-CANCEL                           VALUE '2'.
   675           88  CP-ISSUE                            VALUE '3'.
   676         16  CP-SPECIAL-CALC-CD    PIC X.
   677           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   678           88  CP-1-MTH-INTEREST               VALUE ' '.
   679           88  CP-0-MTH-INTEREST               VALUE 'A'.
   680           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   681           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   682           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   683           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   684           88  CP-FARM-PLAN                    VALUE 'F'.
   685           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   686           88  CP-2-MTH-INTEREST               VALUE 'I'.
   687           88  CP-3-MTH-INTEREST               VALUE 'J'.
   688           88  CP-4-MTH-INTEREST               VALUE 'K'.
   689           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   690           88  CP-MORTGAGE-REC                 VALUE 'M'.
   691           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   692           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   693           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   694           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   695                                                     'W' 'X'.
   696           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   697           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   698           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   699           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   700           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   701           88  CP-SUMMARY-REC                  VALUE 'Z'.
   702           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   703           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   704           88  CP-AD-D-BENEFIT                 VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  16
* EL154.cbl
   705           88  CP-CSL-METH-1                   VALUE '5'.
   706           88  CP-CSL-METH-2                   VALUE '6'.
   707           88  CP-CSL-METH-3                   VALUE '7'.
   708           88  CP-CSL-METH-4                   VALUE '8'.
   709
   710         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   711                                     COMP-3.
   712         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   713         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   714         16  CP-STATE              PIC XX          VALUE SPACE.
   715         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   716         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   717           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   718               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   719         16  CP-R78-OPTION         PIC X.
   720           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   721           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   722
   723         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   724         16  CP-IBNR-RESERVE-SW    PIC X.
   725         16  CP-CLAIM-STATUS       PIC X.
   726         16  CP-RATE-FILE          PIC X.
   727         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   728                                     COMP-3.
   729
   730         16  CP-LIFE-OVERRIDE-CODE PIC X.
   731         16  CP-AH-OVERRIDE-CODE   PIC X.
   732
   733         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   734                                     COMP-3.
   735         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   736                                   PIC S9(5)V99 COMP-3.
   737         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   738                                     COMP-3.
   739         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   740                                     COMP-3.
   741         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   742                                     COMP-3.
   743         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   744                                  PIC S9(7)V99 COMP-3.
   745
   746         16  CP-PAID-FROM-DATE     PIC X(02).
   747         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   748         16  CP-EXT-DAYS-CALC      PIC X.
   749           88  CP-EXT-NO-CHG                   VALUE ' '.
   750           88  CP-EXT-CHG-LF                   VALUE '1'.
   751           88  CP-EXT-CHG-AH                   VALUE '2'.
   752           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   753         16  CP-DOMICILE-STATE     PIC XX.
   754         16  CP-CARRIER            PIC X.
   755         16  CP-REIN-FLAG          PIC X.
   756         16  CP-REM-TRM-CALC-OPTION PIC X.
   757           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   758                      '2' '3' '4' '5'.
   759           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   760           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   761           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   762           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  17
* EL154.cbl
   763           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   764           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   765           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   766           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   767         16  CP-SIG-SWITCH         PIC X.
   768         16  CP-RATING-METHOD      PIC X.
   769           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   770           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   771           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   772           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   773           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   774           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   775           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   776           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   777           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   778         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   779                                     COMP-3.
   780         16  CP-BEN-CATEGORY       PIC X.
   781         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   782         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   783                                   PIC S99V9(5) COMP-3.
   784         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   785         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   786                                   PIC S99V9(5) COMP-3.
   787         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   788         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   789         16  CP-EXPIRE-DT          PIC XX.
   790         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   791         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   792         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   793         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   794         16  CP-DDF-SPEC-CALC      PIC X.
   795             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   796             88  CP-CALC-CLP              VALUE 'C'.
   797         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   798         16  CP-CANCEL-REASON      PIC X.
   799         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   800         16  CP-PMT-MODE           PIC X.
   801         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   802         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   803         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   804         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   805         16  FILLER                PIC X.
   806
   807***************    OUTPUT FROM ELRESV   ************************
   808
   809         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   810
   811         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   812                                     COMP-3.
   813         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   814                                     COMP-3.
   815         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   816                                     COMP-3.
   817         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   818                                     COMP-3.
   819         16  FILLER                PIC X(09).
   820***************    OUTPUT FROM ELRTRM   *************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  18
* EL154.cbl
   821
   822         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   823                                     COMP-3.
   824         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   825                                     COMP-3.
   826         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   827                                     COMP-3.
   828         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   829                                     COMP-3.
   830         16  FILLER                PIC X(12).
   831
   832***************    OUTPUT FROM ELRAMT   *************************
   833
   834         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   835                                     COMP-3.
   836         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   837                                     COMP-3.
   838         16  FILLER                PIC X(12).
   839
   840***************    OUTPUT FROM ELRATE   *************************
   841
   842         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   843                                     COMP-3.
   844         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   845                                     COMP-3.
   846         16  CP-MORTALITY-CODE     PIC X(4).
   847         16  CP-RATE-EDIT-FLAG     PIC X.
   848             88  CP-RATES-NEED-APR                  VALUE '1'.
   849         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   850                                     COMP-3.
   851         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   852         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   853         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   854                                   PIC S9(7)V99 COMP-3.
   855         16  FILLER                PIC X(07).
   856
   857***************    OUTPUT FROM ELRFND   *************************
   858
   859         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   860                                     COMP-3.
   861         16  CP-REFUND-TYPE-USED   PIC X.
   862           88  CP-R-AS-R78                         VALUE '1'.
   863           88  CP-R-AS-PRORATA                     VALUE '2'.
   864           88  CP-R-AS-CALIF                       VALUE '3'.
   865           88  CP-R-AS-TEXAS                       VALUE '4'.
   866           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   867           88  CP-R-AS-NET-PAY                     VALUE '5'.
   868           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   869           88  CP-R-AS-MEAN                        VALUE '8'.
   870           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   871           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   872           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   873           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   874           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   875           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   876         16  FILLER                PIC X(12).
   877
   878***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  19
* EL154.cbl
   879
   880         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   881                                     COMP-3.
   882         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   883                                     COMP-3.
   884         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   885                                     COMP-3.
   886         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   887                                     COMP-3.
   888         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   889                                     COMP-3.
   890         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   891                                     COMP-3.
   892         16  CP-EARNING-TYPE-USED  PIC X.
   893           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   894           88  CP-E-AS-R78                         VALUE '1'.
   895           88  CP-E-AS-PRORATA                     VALUE '2'.
   896           88  CP-E-AS-TEXAS                       VALUE '4'.
   897           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   898           88  CP-E-AS-NET-PAY                     VALUE '5'.
   899           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   900           88  CP-E-AS-MEAN                        VALUE '8'.
   901           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   902         16  FILLER                PIC X(12).
   903
   904***************    OUTPUT FROM ELPMNT   *************************
   905
   906         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   907                                     COMP-3.
   908         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   909                                     COMP-3.
   910         16  FILLER                PIC X(12).
   911
   912***************   MISC WORK AREAS    *****************************
   913         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   914                                     COMP-3.
   915         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   916                                     COMP-3.
   917         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   918                                     COMP-3.
   919         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   920                                     COMP-3.
   921         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   922                                     COMP-3.
   923         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   924                                     COMP-3.
   925         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   926             88  OPEN-RATE-FILE                   VALUE 'O'.
   927             88  CLOSE-RATE-FILE                  VALUE 'C'.
   928             88  IO-ERROR                         VALUE 'E'.
   929
   930         16  CP-FIRST-PAY-DATE     PIC XX.
   931
   932         16  CP-JOINT-INDICATOR    PIC X.
   933
   934         16  CP-RESERVE-REMAINING-TERM
   935                                   PIC S9(4)V9    VALUE ZERO
   936                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  20
* EL154.cbl
   937
   938         16  CP-INSURED-BIRTH-DT   PIC XX.
   939
   940         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   941                                     COMP-3.
   942
   943         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   944                                     COMP-3.
   945
   946         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   947                                     COMP-3.
   948
   949         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   950                                     COMP-3.
   951
   952         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   953                                     COMP-3.
   954
   955         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   956                                     COMP-3.
   957
   958         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   959                                     COMP-3.
   960
   961         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   962             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   963
   964         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   965                                     COMP-3.
   966         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   967                                     COMP-3.
   968         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
   969         16  cp-extra-periods      pic 9 value zeros.
   970         16  cp-net-only-state     pic x value spaces.
   971         16  FILLER                PIC X(13).
   972******************************************************************
   973
   974
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  21
* EL154.cbl
   976*                            COPY ELCDATE.
   977******************************************************************
   978*                                                                *
   979*                                                                *
   980*                            ELCDATE.                            *
   981*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   982*                            VMOD=2.003
   983*                                                                *
   984*                                                                *
   985*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   986*                 LENGTH = 200                                   *
   987******************************************************************
   988
   989 01  DATE-CONVERSION-DATA.
   990     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   991     12  DC-OPTION-CODE                PIC X.
   992         88  BIN-TO-GREG                VALUE ' '.
   993         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   994         88  EDIT-GREG-TO-BIN           VALUE '2'.
   995         88  YMD-GREG-TO-BIN            VALUE '3'.
   996         88  MDY-GREG-TO-BIN            VALUE '4'.
   997         88  JULIAN-TO-BIN              VALUE '5'.
   998         88  BIN-PLUS-ELAPSED           VALUE '6'.
   999         88  FIND-CENTURY               VALUE '7'.
  1000         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1001         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1002         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1003         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1004         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1005         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1006         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1007         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1008         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1009         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1010         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1011         88  BIN-3-TO-GREG              VALUE 'I'.
  1012         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1013         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1014         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1015         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1016         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1017         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1018         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1019         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1020         88  THREE-CHARACTER-BIN
  1021                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1022         88  GREGORIAN-TO-BIN
  1023                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1024         88  BIN-TO-GREGORIAN
  1025                  VALUES ' ' '1' 'I' '8' 'G'.
  1026         88  JULIAN-TO-BINARY
  1027                  VALUES '5' 'C' 'E' 'F'.
  1028     12  DC-ERROR-CODE                 PIC X.
  1029         88  NO-CONVERSION-ERROR        VALUE ' '.
  1030         88  DATE-CONVERSION-ERROR
  1031                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1032         88  DATE-IS-ZERO               VALUE '1'.
  1033         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  22
* EL154.cbl
  1034         88  DATE-IS-INVALID            VALUE '3'.
  1035         88  DATE1-GREATER-DATE2        VALUE '4'.
  1036         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1037         88  DATE-INVALID-OPTION        VALUE '9'.
  1038         88  INVALID-CENTURY            VALUE 'A'.
  1039         88  ONLY-CENTURY               VALUE 'B'.
  1040         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1041         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1042     12  DC-END-OF-MONTH               PIC X.
  1043         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1044     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1045         88  USE-NORMAL-PROCESS         VALUE ' '.
  1046         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1047         88  ADJUST-UP-100-YRS          VALUE '2'.
  1048     12  FILLER                        PIC X.
  1049     12  DC-CONVERSION-DATES.
  1050         16  DC-BIN-DATE-1             PIC XX.
  1051         16  DC-BIN-DATE-2             PIC XX.
  1052         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1053         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1054                       DC-GREG-DATE-1-EDIT.
  1055             20  DC-EDIT1-MONTH        PIC 99.
  1056             20  SLASH1-1              PIC X.
  1057             20  DC-EDIT1-DAY          PIC 99.
  1058             20  SLASH1-2              PIC X.
  1059             20  DC-EDIT1-YEAR         PIC 99.
  1060         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1061         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1062                     DC-GREG-DATE-2-EDIT.
  1063             20  DC-EDIT2-MONTH        PIC 99.
  1064             20  SLASH2-1              PIC X.
  1065             20  DC-EDIT2-DAY          PIC 99.
  1066             20  SLASH2-2              PIC X.
  1067             20  DC-EDIT2-YEAR         PIC 99.
  1068         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1069         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1070                     DC-GREG-DATE-1-YMD.
  1071             20  DC-YMD-YEAR           PIC 99.
  1072             20  DC-YMD-MONTH          PIC 99.
  1073             20  DC-YMD-DAY            PIC 99.
  1074         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1075         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1076                      DC-GREG-DATE-1-MDY.
  1077             20  DC-MDY-MONTH          PIC 99.
  1078             20  DC-MDY-DAY            PIC 99.
  1079             20  DC-MDY-YEAR           PIC 99.
  1080         16  DC-GREG-DATE-1-ALPHA.
  1081             20  DC-ALPHA-MONTH        PIC X(10).
  1082             20  DC-ALPHA-DAY          PIC 99.
  1083             20  FILLER                PIC XX.
  1084             20  DC-ALPHA-CENTURY.
  1085                 24 DC-ALPHA-CEN-N     PIC 99.
  1086             20  DC-ALPHA-YEAR         PIC 99.
  1087         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1088         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1089         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1090         16  DC-JULIAN-DATE            PIC 9(05).
  1091         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  23
* EL154.cbl
  1092                                       PIC 9(05).
  1093         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1094             20  DC-JULIAN-YEAR        PIC 99.
  1095             20  DC-JULIAN-DAYS        PIC 999.
  1096         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1097         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1098         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1099     12  DATE-CONVERSION-VARIBLES.
  1100         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1101         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1102             20  FILLER                PIC 9(3).
  1103             20  HOLD-CEN-1-CCYY.
  1104                 24  HOLD-CEN-1-CC     PIC 99.
  1105                 24  HOLD-CEN-1-YY     PIC 99.
  1106             20  HOLD-CEN-1-MO         PIC 99.
  1107             20  HOLD-CEN-1-DA         PIC 99.
  1108         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1109             20  HOLD-CEN-1-R-MO       PIC 99.
  1110             20  HOLD-CEN-1-R-DA       PIC 99.
  1111             20  HOLD-CEN-1-R-CCYY.
  1112                 24  HOLD-CEN-1-R-CC   PIC 99.
  1113                 24  HOLD-CEN-1-R-YY   PIC 99.
  1114             20  FILLER                PIC 9(3).
  1115         16  HOLD-CENTURY-1-X.
  1116             20  FILLER                PIC X(3)  VALUE SPACES.
  1117             20  HOLD-CEN-1-X-CCYY.
  1118                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1119                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1120             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1121             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1122         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1123             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1124             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1125             20  HOLD-CEN-1-R-X-CCYY.
  1126                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1127                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1128             20  FILLER                PIC XXX.
  1129         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1130         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1131         16  DC-JULIAN-DATE-1          PIC 9(07).
  1132         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1133             20  DC-JULIAN-1-CCYY.
  1134                 24  DC-JULIAN-1-CC    PIC 99.
  1135                 24  DC-JULIAN-1-YR    PIC 99.
  1136             20  DC-JULIAN-DA-1        PIC 999.
  1137         16  DC-JULIAN-DATE-2          PIC 9(07).
  1138         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1139             20  DC-JULIAN-2-CCYY.
  1140                 24  DC-JULIAN-2-CC    PIC 99.
  1141                 24  DC-JULIAN-2-YR    PIC 99.
  1142             20  DC-JULIAN-DA-2        PIC 999.
  1143         16  DC-GREG-DATE-A-EDIT.
  1144             20  DC-EDITA-MONTH        PIC 99.
  1145             20  SLASHA-1              PIC X VALUE '/'.
  1146             20  DC-EDITA-DAY          PIC 99.
  1147             20  SLASHA-2              PIC X VALUE '/'.
  1148             20  DC-EDITA-CCYY.
  1149                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  24
* EL154.cbl
  1150                 24  DC-EDITA-YEAR     PIC 99.
  1151         16  DC-GREG-DATE-B-EDIT.
  1152             20  DC-EDITB-MONTH        PIC 99.
  1153             20  SLASHB-1              PIC X VALUE '/'.
  1154             20  DC-EDITB-DAY          PIC 99.
  1155             20  SLASHB-2              PIC X VALUE '/'.
  1156             20  DC-EDITB-CCYY.
  1157                 24  DC-EDITB-CENT     PIC 99.
  1158                 24  DC-EDITB-YEAR     PIC 99.
  1159         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1160         16  DC-GREG-DATE-CYMD-R REDEFINES
  1161                              DC-GREG-DATE-CYMD.
  1162             20  DC-CYMD-CEN           PIC 99.
  1163             20  DC-CYMD-YEAR          PIC 99.
  1164             20  DC-CYMD-MONTH         PIC 99.
  1165             20  DC-CYMD-DAY           PIC 99.
  1166         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1167         16  DC-GREG-DATE-MDCY-R REDEFINES
  1168                              DC-GREG-DATE-MDCY.
  1169             20  DC-MDCY-MONTH         PIC 99.
  1170             20  DC-MDCY-DAY           PIC 99.
  1171             20  DC-MDCY-CEN           PIC 99.
  1172             20  DC-MDCY-YEAR          PIC 99.
  1173    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1174        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1175    12  DC-EL310-DATE                  PIC X(21).
  1176    12  FILLER                         PIC X(28).
  1177
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  25
* EL154.cbl
  1179*                            COPY ELCLOGOF.
  1180******************************************************************
  1181*                                                                *
  1182*                                                                *
  1183*                            ELCLOGOF.                           *
  1184*                            VMOD=2.001                          *
  1185*                                                                *
  1186*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1187*                                                                *
  1188******************************************************************
  1189 01  CLASIC-LOGOFF.
  1190     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1191     12  LOGOFF-TEXT.
  1192         16  FILLER          PIC X(5)    VALUE SPACES.
  1193         16  LOGOFF-MSG.
  1194             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1195             20  FILLER      PIC X       VALUE SPACES.
  1196             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1197         16  FILLER          PIC X(80)
  1198           VALUE '* YOU ARE NOW LOGGED OFF'.
  1199         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1200         16  FILLER          PIC X       VALUE QUOTE.
  1201         16  LOGOFF-SYS-MSG  PIC X(17)
  1202           VALUE 'S CLAS-IC SYSTEM '.
  1203     12  TEXT-MESSAGES.
  1204         16  UNACCESS-MSG    PIC X(29)
  1205             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1206         16  PGMIDERR-MSG    PIC X(17)
  1207             VALUE 'PROGRAM NOT FOUND'.
  1208
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  26
* EL154.cbl
  1210*                            COPY ELCATTR.
  1211******************************************************************
  1212*                                                                *
  1213*                            ELCATTR.                            *
  1214*                            VMOD=2.001                          *
  1215*                                                                *
  1216*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1217*                                                                *
  1218*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1219*                                                                *
  1220*                   POS 1   P=PROTECTED                          *
  1221*                           U=UNPROTECTED                        *
  1222*                           S=ASKIP                              *
  1223*                   POS 2   A=ALPHA/NUMERIC                      *
  1224*                           N=NUMERIC                            *
  1225*                   POS 3   N=NORMAL                             *
  1226*                           B=BRIGHT                             *
  1227*                           D=DARK                               *
  1228*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1229*                           OF=MODIFIED DATA TAG OFF             *
  1230*                                                                *
  1231*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1232******************************************************************
  1233 01  ATTRIBUTE-LIST.
  1234     12  AL-PABOF            PIC X       VALUE 'Y'.
  1235     12  AL-PABON            PIC X       VALUE 'Z'.
  1236     12  AL-PADOF            PIC X       VALUE '%'.
  1237     12  AL-PADON            PIC X       VALUE '_'.
  1238     12  AL-PANOF            PIC X       VALUE '-'.
  1239     12  AL-PANON            PIC X       VALUE '/'.
  1240     12  AL-SABOF            PIC X       VALUE '8'.
  1241     12  AL-SABON            PIC X       VALUE '9'.
  1242     12  AL-SADOF            PIC X       VALUE '@'.
  1243     12  AL-SADON            PIC X       VALUE QUOTE.
  1244     12  AL-SANOF            PIC X       VALUE '0'.
  1245     12  AL-SANON            PIC X       VALUE '1'.
  1246     12  AL-UABOF            PIC X       VALUE 'H'.
  1247     12  AL-UABON            PIC X       VALUE 'I'.
  1248     12  AL-UADOF            PIC X       VALUE '<'.
  1249     12  AL-UADON            PIC X       VALUE '('.
  1250     12  AL-UANOF            PIC X       VALUE ' '.
  1251     12  AL-UANON            PIC X       VALUE 'A'.
  1252     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1253     12  AL-UNBON            PIC X       VALUE 'R'.
  1254     12  AL-UNDOF            PIC X       VALUE '*'.
  1255     12  AL-UNDON            PIC X       VALUE ')'.
  1256     12  AL-UNNOF            PIC X       VALUE '&'.
  1257     12  AL-UNNON            PIC X       VALUE 'J'.
  1258
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  27
* EL154.cbl
  1260*                            COPY ELCEMIB.
  1261******************************************************************
  1262*                                                                *
  1263*                                                                *
  1264*                            ELCEMIB.                            *
  1265*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1266*                            VMOD=2.005                          *
  1267*                                                                *
  1268*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1269*                                                                *
  1270******************************************************************
  1271 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1272     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1273     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1274     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1275     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1276     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1277     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1278     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1279     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1280     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1281         88  EMI-NO-ERRORS                    VALUE '1'.
  1282         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1283         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1284     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1285         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1286     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1287         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1288         88  EMI-AREA1-FULL                   VALUE '2'.
  1289     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1290         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1291         88  EMI-AREA2-FULL                   VALUE '2'.
  1292     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1293         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1294         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1295         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1296         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1297         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1298     12  EMI-ERROR-LINES.
  1299         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1300         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1301         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1302         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1303             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1304                 24  EMI-ERR-NUM         PIC X(4).
  1305                 24  EMI-FILLER          PIC X.
  1306                 24  EMI-SEV             PIC X.
  1307                 24  FILLER              PIC X.
  1308             20  FILLER                  PIC X(02).
  1309     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1310         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1311             20  EMI-ERROR-NUMBER    PIC X(4).
  1312             20  EMI-FILL            PIC X.
  1313             20  EMI-SEVERITY        PIC X.
  1314             20  FILLER              PIC X.
  1315             20  EMI-ERROR-TEXT.
  1316                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1317                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  28
* EL154.cbl
  1318     12  EMI-SEVERITY-SAVE           PIC X.
  1319         88  EMI-NOTE                    VALUE 'N'.
  1320         88  EMI-WARNING                 VALUE 'W'.
  1321         88  EMI-FORCABLE                VALUE 'F'.
  1322         88  EMI-FATAL                   VALUE 'X'.
  1323     12  EMI-MESSAGE-FLAG            PIC X.
  1324         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1325         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1326     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1327     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1328         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1329         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1330         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1331     12  emi-claim-no                pic x(7).
  1332     12  emi-claim-type              pic x(6).
  1333     12  FILLER                      PIC X(124)  VALUE SPACES.
  1334     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1335     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1336     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1337     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  29
* EL154.cbl
  1339*                            COPY ELCLNKLT.
  1340******************************************************************
  1341*                                                                *
  1342*                                                                *
  1343*                           ELCLNKLT                             *
  1344*                            VMOD=2.003                          *
  1345*                                                                *
  1346*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1347*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1348*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1349*                                                                *
  1350*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1351*   COMPLETING THE REQUIRED FIELDS.                              *
  1352*                                                                *
  1353*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1354*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1355*                              9999 INDICATES AN UNKNOWN ABEND   *
  1356*                                   WAS DETECTED.                *
  1357*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1358*                              CODES FOUND IN THE ERROR FILE.    *
  1359******************************************************************
  1360 01  W-1523-LINKDATA.
  1361     12  W-1523-COMMON-PI-DATA.
  1362         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1363         16  FILLER              PIC  X(67).
  1364         16  W-1523-COMPANY-CD   PIC  X(01).
  1365         16  FILLER              PIC  X(10).
  1366         16  W-1523-CONTROL-IN-PROGRESS.
  1367             20  W-1523-CARRIER  PIC  X(01).
  1368             20  W-1523-GROUPING PIC  X(06).
  1369             20  W-1523-STATE    PIC  X(02).
  1370             20  W-1523-ACCOUNT  PIC  X(10).
  1371             20  W-1523-CLAIM-CERT-GRP.
  1372                 24  W-1523-CLAIM-NO
  1373                                 PIC  X(07).
  1374                 24  W-1523-CERT-NO.
  1375                     28  W-1523-CERT-PRIME
  1376                                 PIC  X(10).
  1377                     28  W-1523-CERT-SFX
  1378                                 PIC  X(01).
  1379                 24  W-1523-CERT-EFF-DT
  1380                                 PIC  X(02).
  1381         16  FILLER              PIC X(265).
  1382
  1383     12  W-1523-WORK-AREA.
  1384         16  W-1523-FORM-NUMBER  PIC  X(04).
  1385         16  W-1523-NUMBER-COPIES
  1386                                 PIC  9(01).
  1387         16  W-1523-ADDR-TYPE    PIC  X(02).
  1388         16  W-1523-FOLLOW-UP-DATE
  1389                                 PIC  X(02).
  1390         16  W-1523-RESEND-DATE  PIC  X(02).
  1391         16  W-1523-ERROR-CODE   PIC  9(04).
  1392             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1393             88  W-1523-FATAL-ERROR
  1394                                    VALUES  0006 0013 0042
  1395                                            0154 0168 0169
  1396                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  30
* EL154.cbl
  1397                                            0179 0186 0281
  1398                                            0332 2055 3697
  1399                                            3698 3699 3770
  1400                                            3771 3772 7675
  1401                                            9106 9808 9883
  1402                                            9887.
  1403             88  W-1523-STOP-ERRORS
  1404                                    VALUES  0013 0042 0154
  1405                                            0168 0169 0172
  1406                                            0281 0332 2055
  1407                                            3698 3699 7675
  1408                                            9106 9808 9883
  1409                                            9999.
  1410         16  W-1523-REASON       PIC  X(70).
  1411         16  W-1523-ARCHIVE-NUMBER
  1412                                 PIC  9(08).
  1413     12  W-1523-POINTER-AREA.
  1414         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1415         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1416         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1417         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1418         16  W-1523-PROD-POINTER PIC S9(08) COMP.
  1419
  1420     12  W-1523-LETTER-DATE       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  31
* EL154.cbl
  1422*                            COPY ELCINTF.
  1423******************************************************************
  1424*                                                                *
  1425*                                                                *
  1426*                            ELCINTF.                            *
  1427*                            VMOD=2.017                          *
  1428*                                                                *
  1429*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1430*                                                                *
  1431*       LENGTH = 1024                                            *
  1432*                                                                *
  1433******************************************************************
  1434*                   C H A N G E   L O G
  1435*
  1436* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1437*-----------------------------------------------------------------
  1438*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1439* EFFECTIVE    NUMBER
  1440*-----------------------------------------------------------------
  1441* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1442******************************************************************
  1443 01  PROGRAM-INTERFACE-BLOCK.
  1444     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1445     12  PI-CALLING-PROGRAM              PIC X(8).
  1446     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1447     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1448     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1449     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1450     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1451     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1452     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1453     12  PI-COMPANY-ID                   PIC XXX.
  1454     12  PI-COMPANY-CD                   PIC X.
  1455
  1456     12  PI-COMPANY-PASSWORD             PIC X(8).
  1457
  1458     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1459
  1460     12  PI-CONTROL-IN-PROGRESS.
  1461         16  PI-CARRIER                  PIC X.
  1462         16  PI-GROUPING                 PIC X(6).
  1463         16  PI-STATE                    PIC XX.
  1464         16  PI-ACCOUNT                  PIC X(10).
  1465         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1466                                         PIC X(10).
  1467         16  PI-CLAIM-CERT-GRP.
  1468             20  PI-CLAIM-NO             PIC X(7).
  1469             20  PI-CERT-NO.
  1470                 25  PI-CERT-PRIME       PIC X(10).
  1471                 25  PI-CERT-SFX         PIC X.
  1472             20  PI-CERT-EFF-DT          PIC XX.
  1473         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1474             20  PI-PLAN-CODE            PIC X(2).
  1475             20  PI-REVISION-NUMBER      PIC X(3).
  1476             20  PI-PLAN-EFF-DT          PIC X(2).
  1477             20  PI-PLAN-EXP-DT          PIC X(2).
  1478             20  FILLER                  PIC X(11).
  1479         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  32
* EL154.cbl
  1480             20  PI-OE-REFERENCE-1.
  1481                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1482                 25  PI-OE-REF-1-SUFF    PIC XX.
  1483
  1484     12  PI-SESSION-IN-PROGRESS          PIC X.
  1485         88  CLAIM-SESSION                   VALUE '1'.
  1486         88  CREDIT-SESSION                  VALUE '2'.
  1487         88  WARRANTY-SESSION                VALUE '3'.
  1488         88  MORTGAGE-SESSION                VALUE '4'.
  1489         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1490
  1491
  1492*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1493
  1494     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1495     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1496
  1497     12  PI-CREDIT-USER                  PIC X.
  1498         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1499         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1500
  1501     12  PI-CLAIM-USER                   PIC X.
  1502         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1503         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1504
  1505     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1506         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1507         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1508         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1509         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1510         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1511
  1512     12  PI-PROCESSOR-ID                 PIC X(4).
  1513
  1514     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1515
  1516     12  PI-MEMBER-CAPTION               PIC X(10).
  1517
  1518     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1519         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1520
  1521     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1522     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1523     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1524     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1525
  1526     12  PI-AH-OVERRIDE-L1               PIC X.
  1527     12  PI-AH-OVERRIDE-L2               PIC XX.
  1528     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1529     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1530
  1531     12  PI-NEW-SYSTEM                   PIC X(2).
  1532
  1533     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1534     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1535         88  PI-USES-PAID-TO                 VALUE '1'.
  1536     12  PI-CRDTCRD-SYSTEM.
  1537         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  33
* EL154.cbl
  1538             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1539             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1540         16  PI-CC-MONTH-END-DT          PIC XX.
  1541     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1542
  1543     12  PI-OE-REFERENCE-2.
  1544         16  PI-OE-REF-2-PRIME           PIC X(10).
  1545         16  PI-OE-REF-2-SUFF            PIC X.
  1546
  1547     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1548
  1549     12  PI-LANGUAGE-TYPE                PIC X.
  1550             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1551             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1552             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1553
  1554     12  PI-POLICY-LINKAGE-IND           PIC X.
  1555         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1556         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1557                                                   LOW-VALUES.
  1558
  1559     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1560     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1561         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1562         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1563
  1564     12  PI-PROCESSOR-CSR-IND            PIC X.
  1565         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1566         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1567
  1568     12  FILLER                          PIC X(3).
  1569
  1570     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1571
  1572     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1573         PI-SYSTEM-LEVEL.
  1574
  1575         16  PI-ENTRY-CODES.
  1576             20  PI-ENTRY-CD-1           PIC X.
  1577             20  PI-ENTRY-CD-2           PIC X.
  1578
  1579         16  PI-RETURN-CODES.
  1580             20  PI-RETURN-CD-1          PIC X.
  1581             20  PI-RETURN-CD-2          PIC X.
  1582
  1583         16  PI-UPDATE-STATUS-SAVE.
  1584             20  PI-UPDATE-BY            PIC X(4).
  1585             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1586
  1587         16  PI-LOWER-CASE-LETTERS       PIC X.
  1588             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1589
  1590*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1591*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1592*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1593
  1594         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1595             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  34
* EL154.cbl
  1596             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1597             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1598             88  ACCNT-CNTL                  VALUE '3'.
  1599             88  CARR-ACCNT-CNTL             VALUE '4'.
  1600
  1601         16  PI-PROCESSOR-CAP-LIST.
  1602             20  PI-SYSTEM-CONTROLS.
  1603                24 PI-SYSTEM-DISPLAY     PIC X.
  1604                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1605                24 PI-SYSTEM-MODIFY      PIC X.
  1606                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1607             20  FILLER                  PIC XX.
  1608             20  PI-DISPLAY-CAP          PIC X.
  1609                 88  DISPLAY-CAP             VALUE 'Y'.
  1610             20  PI-MODIFY-CAP           PIC X.
  1611                 88  MODIFY-CAP              VALUE 'Y'.
  1612             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1613                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1614             20  PI-FORCE-CAP            PIC X.
  1615                 88  FORCE-CAP               VALUE 'Y'.
  1616
  1617         16  PI-PROGRAM-CONTROLS.
  1618             20  PI-PGM-PRINT-OPT        PIC X.
  1619             20  PI-PGM-FORMAT-OPT       PIC X.
  1620             20  PI-PGM-PROCESS-OPT      PIC X.
  1621             20  PI-PGM-TOTALS-OPT       PIC X.
  1622
  1623         16  PI-HELP-INTERFACE.
  1624             20  PI-LAST-ERROR-NO        PIC X(4).
  1625             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1626
  1627         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1628             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1629
  1630         16  PI-CR-CONTROL-IN-PROGRESS.
  1631             20  PI-CR-CARRIER           PIC X.
  1632             20  PI-CR-GROUPING          PIC X(6).
  1633             20  PI-CR-STATE             PIC XX.
  1634             20  PI-CR-ACCOUNT           PIC X(10).
  1635             20  PI-CR-FIN-RESP          PIC X(10).
  1636             20  PI-CR-TYPE              PIC X.
  1637
  1638         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1639
  1640         16  PI-CR-MONTH-END-DT          PIC XX.
  1641
  1642         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1643             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1644             88  PI-ZERO-CARRIER             VALUE '1'.
  1645             88  PI-ZERO-GROUPING            VALUE '2'.
  1646             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1647
  1648         16  PI-CARRIER-SECURITY         PIC X.
  1649             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1650
  1651         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1652             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1653             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  35
* EL154.cbl
  1654
  1655         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1656             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1657                                         INDEXED BY PI-ACCESS-NDX
  1658                                         PIC X.
  1659
  1660         16  PI-GA-BILLING-CONTROL       PIC X.
  1661             88  PI-GA-BILLING               VALUE '1'.
  1662
  1663         16  PI-MAIL-PROCESSING          PIC X.
  1664             88  PI-MAIL-YES                 VALUE 'Y'.
  1665
  1666         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1667
  1668         16  PI-AR-SYSTEM.
  1669             20  PI-AR-PROCESSING-CNTL   PIC X.
  1670                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1671             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1672             20  PI-AR-MONTH-END-DT      PIC XX.
  1673
  1674         16  PI-MP-SYSTEM.
  1675             20  PI-MORTGAGE-USER            PIC X.
  1676                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1677                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1678             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1679                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1680                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1681                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1682                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1683                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1684             20  PI-MP-MONTH-END-DT          PIC XX.
  1685             20  PI-MP-REFERENCE-NO.
  1686                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1687                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1688
  1689         16  PI-LABEL-CONTROL            PIC X(01).
  1690             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1691             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1692
  1693         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1694             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1695
  1696         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1697             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1698             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1699
  1700         16  FILLER                      PIC X(14).
  1701
  1702     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1703******************************************************************
  1704     12  PI-REDEF       REDEFINES PI-PROGRAM-WORK-AREA.
  1705         16  PI-BENEFIT-SAVE.
  1706             18  PI-BEN-DAYS      PIC 99.
  1707             18  PI-BEN-TYPE      PIC X.
  1708*00269   16  FILLER               PIC X(637).
  1709         16  PI-AUTO-END-LETTER   PIC X(04).
  1710         16  FILLER               PIC X(633).
  1711
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  36
* EL154.cbl
  1713*                            COPY ELCAID.
  1714******************************************************************
  1715*                                                                *
  1716*                            ELCAID.                             *
  1717*                            VMOD=2.001                          *
  1718*                                                                *
  1719*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1720*                                                                *
  1721*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1722*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1723******************************************************************
  1724
  1725 01  DFHAID.
  1726   02  DFHNULL   PIC  X  VALUE  ' '.
  1727   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1728   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1729   02  DFHPEN    PIC  X  VALUE  '='.
  1730   02  DFHOPID   PIC  X  VALUE  'W'.
  1731   02  DFHPA1    PIC  X  VALUE  '%'.
  1732   02  DFHPA2    PIC  X  VALUE  '>'.
  1733   02  DFHPA3    PIC  X  VALUE  ','.
  1734   02  DFHPF1    PIC  X  VALUE  '1'.
  1735   02  DFHPF2    PIC  X  VALUE  '2'.
  1736   02  DFHPF3    PIC  X  VALUE  '3'.
  1737   02  DFHPF4    PIC  X  VALUE  '4'.
  1738   02  DFHPF5    PIC  X  VALUE  '5'.
  1739   02  DFHPF6    PIC  X  VALUE  '6'.
  1740   02  DFHPF7    PIC  X  VALUE  '7'.
  1741   02  DFHPF8    PIC  X  VALUE  '8'.
  1742   02  DFHPF9    PIC  X  VALUE  '9'.
  1743   02  DFHPF10   PIC  X  VALUE  ':'.
  1744   02  DFHPF11   PIC  X  VALUE  '#'.
  1745   02  DFHPF12   PIC  X  VALUE  '@'.
  1746   02  DFHPF13   PIC  X  VALUE  'A'.
  1747   02  DFHPF14   PIC  X  VALUE  'B'.
  1748   02  DFHPF15   PIC  X  VALUE  'C'.
  1749   02  DFHPF16   PIC  X  VALUE  'D'.
  1750   02  DFHPF17   PIC  X  VALUE  'E'.
  1751   02  DFHPF18   PIC  X  VALUE  'F'.
  1752   02  DFHPF19   PIC  X  VALUE  'G'.
  1753   02  DFHPF20   PIC  X  VALUE  'H'.
  1754   02  DFHPF21   PIC  X  VALUE  'I'.
  1755*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1756   02  DFHPF22   PIC  X  VALUE  '['.
  1757   02  DFHPF23   PIC  X  VALUE  '.'.
  1758   02  DFHPF24   PIC  X  VALUE  '<'.
  1759   02  DFHMSRE   PIC  X  VALUE  'X'.
  1760   02  DFHSTRF   PIC  X  VALUE  'h'.
  1761   02  DFHTRIG   PIC  X  VALUE  '"'.
  1762 01  FILLER    REDEFINES DFHAID.
  1763     12  FILLER              PIC X(8).
  1764     12  PF-VALUES           PIC X       OCCURS 2.
  1765
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  37
* EL154.cbl
  1767*                            COPY EL154S.
  1768 01  EL154AI.
  1769     05  FILLER            PIC  X(0012).
  1770*    -------------------------------
  1771     05  RUNDTEL PIC S9(0004) COMP.
  1772     05  RUNDTEF PIC  X(0001).
  1773     05  FILLER REDEFINES RUNDTEF.
  1774         10  RUNDTEA PIC  X(0001).
  1775     05  RUNDTEI PIC  X(0008).
  1776*    -------------------------------
  1777     05  RUNTIMEL PIC S9(0004) COMP.
  1778     05  RUNTIMEF PIC  X(0001).
  1779     05  FILLER REDEFINES RUNTIMEF.
  1780         10  RUNTIMEA PIC  X(0001).
  1781     05  RUNTIMEI PIC  X(0005).
  1782*    -------------------------------
  1783     05  CLAIML PIC S9(0004) COMP.
  1784     05  CLAIMF PIC  X(0001).
  1785     05  FILLER REDEFINES CLAIMF.
  1786         10  CLAIMA PIC  X(0001).
  1787     05  CLAIMI PIC  X(0007).
  1788*    -------------------------------
  1789     05  CARRL PIC S9(0004) COMP.
  1790     05  CARRF PIC  X(0001).
  1791     05  FILLER REDEFINES CARRF.
  1792         10  CARRA PIC  X(0001).
  1793     05  CARRI PIC  X(0001).
  1794*    -------------------------------
  1795     05  CERTL PIC S9(0004) COMP.
  1796     05  CERTF PIC  X(0001).
  1797     05  FILLER REDEFINES CERTF.
  1798         10  CERTA PIC  X(0001).
  1799     05  CERTI PIC  X(0010).
  1800*    -------------------------------
  1801     05  SUFFIXL PIC S9(0004) COMP.
  1802     05  SUFFIXF PIC  X(0001).
  1803     05  FILLER REDEFINES SUFFIXF.
  1804         10  SUFFIXA PIC  X(0001).
  1805     05  SUFFIXI PIC  X(0001).
  1806*    -------------------------------
  1807     05  CESTDTEL PIC S9(0004) COMP.
  1808     05  CESTDTEF PIC  X(0001).
  1809     05  FILLER REDEFINES CESTDTEF.
  1810         10  CESTDTEA PIC  X(0001).
  1811     05  CESTDTEI PIC  X(0008).
  1812*    -------------------------------
  1813     05  CESTBYL PIC S9(0004) COMP.
  1814     05  CESTBYF PIC  X(0001).
  1815     05  FILLER REDEFINES CESTBYF.
  1816         10  CESTBYA PIC  X(0001).
  1817     05  CESTBYI PIC  X(0004).
  1818*    -------------------------------
  1819     05  FSTHD1L PIC S9(0004) COMP.
  1820     05  FSTHD1F PIC  X(0001).
  1821     05  FILLER REDEFINES FSTHD1F.
  1822         10  FSTHD1A PIC  X(0001).
  1823     05  FSTHD1I PIC  X(0023).
  1824*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  38
* EL154.cbl
  1825     05  CFSTPMTL PIC S9(0004) COMP.
  1826     05  CFSTPMTF PIC  X(0001).
  1827     05  FILLER REDEFINES CFSTPMTF.
  1828         10  CFSTPMTA PIC  X(0001).
  1829     05  CFSTPMTI PIC  X(0008).
  1830*    -------------------------------
  1831     05  CMONTHSL PIC S9(0004) COMP.
  1832     05  CMONTHSF PIC  X(0001).
  1833     05  FILLER REDEFINES CMONTHSF.
  1834         10  CMONTHSA PIC  X(0001).
  1835     05  CMONTHSI PIC  X(0002).
  1836*    -------------------------------
  1837     05  CFSTAMTL PIC S9(0004) COMP.
  1838     05  CFSTAMTF PIC  X(0001).
  1839     05  FILLER REDEFINES CFSTAMTF.
  1840         10  CFSTAMTA PIC  X(0001).
  1841     05  CFSTAMTI PIC  X(0009).
  1842*    -------------------------------
  1843     05  LSTHD1L PIC S9(0004) COMP.
  1844     05  LSTHD1F PIC  X(0001).
  1845     05  FILLER REDEFINES LSTHD1F.
  1846         10  LSTHD1A PIC  X(0001).
  1847     05  LSTHD1I PIC  X(0024).
  1848*    -------------------------------
  1849     05  CLSTPMTL PIC S9(0004) COMP.
  1850     05  CLSTPMTF PIC  X(0001).
  1851     05  FILLER REDEFINES CLSTPMTF.
  1852         10  CLSTPMTA PIC  X(0001).
  1853     05  CLSTPMTI PIC  X(0008).
  1854*    -------------------------------
  1855     05  CLASTL PIC S9(0004) COMP.
  1856     05  CLASTF PIC  X(0001).
  1857     05  FILLER REDEFINES CLASTF.
  1858         10  CLASTA PIC  X(0001).
  1859     05  CLASTI PIC  X(0001).
  1860*    -------------------------------
  1861     05  CREGPMTL PIC S9(0004) COMP.
  1862     05  CREGPMTF PIC  X(0001).
  1863     05  FILLER REDEFINES CREGPMTF.
  1864         10  CREGPMTA PIC  X(0001).
  1865     05  CREGPMTI PIC  X(0009).
  1866*    -------------------------------
  1867     05  CDAYSFL PIC S9(0004) COMP.
  1868     05  CDAYSFF PIC  X(0001).
  1869     05  FILLER REDEFINES CDAYSFF.
  1870         10  CDAYSFA PIC  X(0001).
  1871     05  CDAYSFI PIC  X(0003).
  1872*    -------------------------------
  1873     05  CPAYEEL PIC S9(0004) COMP.
  1874     05  CPAYEEF PIC  X(0001).
  1875     05  FILLER REDEFINES CPAYEEF.
  1876         10  CPAYEEA PIC  X(0001).
  1877     05  CPAYEEI PIC  X(0008).
  1878*    -------------------------------
  1879     05  DAY2PAYL PIC S9(0004) COMP.
  1880     05  DAY2PAYF PIC  X(0001).
  1881     05  FILLER REDEFINES DAY2PAYF.
  1882         10  DAY2PAYA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  39
* EL154.cbl
  1883     05  DAY2PAYI PIC  99.
  1884*    -------------------------------
  1885     05  CEFFDTEL PIC S9(0004) COMP.
  1886     05  CEFFDTEF PIC  X(0001).
  1887     05  FILLER REDEFINES CEFFDTEF.
  1888         10  CEFFDTEA PIC  X(0001).
  1889     05  CEFFDTEI PIC  X(0008).
  1890*    -------------------------------
  1891     05  TERML PIC S9(0004) COMP.
  1892     05  TERMF PIC  X(0001).
  1893     05  FILLER REDEFINES TERMF.
  1894         10  TERMA PIC  X(0001).
  1895     05  TERMI PIC  X(0001).
  1896*    -------------------------------
  1897     05  CINDCTRL PIC S9(0004) COMP.
  1898     05  CINDCTRF PIC  X(0001).
  1899     05  FILLER REDEFINES CINDCTRF.
  1900         10  CINDCTRA PIC  X(0001).
  1901     05  CINDCTRI PIC  X(0001).
  1902*    -------------------------------
  1903     05  PRINTL PIC S9(0004) COMP.
  1904     05  PRINTF PIC  X(0001).
  1905     05  FILLER REDEFINES PRINTF.
  1906         10  PRINTA PIC  X(0001).
  1907     05  PRINTI PIC  X(0004).
  1908*    -------------------------------
  1909     05  FSTHD2L PIC S9(0004) COMP.
  1910     05  FSTHD2F PIC  X(0001).
  1911     05  FILLER REDEFINES FSTHD2F.
  1912         10  FSTHD2A PIC  X(0001).
  1913     05  FSTHD2I PIC  X(0023).
  1914*    -------------------------------
  1915     05  NFSTPMTL PIC S9(0004) COMP.
  1916     05  NFSTPMTF PIC  X(0001).
  1917     05  FILLER REDEFINES NFSTPMTF.
  1918         10  NFSTPMTA PIC  X(0001).
  1919     05  NFSTPMTI PIC  X(0008).
  1920*    -------------------------------
  1921     05  NFSTAMTL PIC S9(0004) COMP.
  1922     05  NFSTAMTF PIC  X(0001).
  1923     05  FILLER REDEFINES NFSTAMTF.
  1924         10  NFSTAMTA PIC  X(0001).
  1925     05  NFSTAMTI PIC  S9(8)V99.
  1926*    -------------------------------
  1927     05  LSTHD2L PIC S9(0004) COMP.
  1928     05  LSTHD2F PIC  X(0001).
  1929     05  FILLER REDEFINES LSTHD2F.
  1930         10  LSTHD2A PIC  X(0001).
  1931     05  LSTHD2I PIC  X(0023).
  1932*    -------------------------------
  1933     05  NLSTPMTL PIC S9(0004) COMP.
  1934     05  NLSTPMTF PIC  X(0001).
  1935     05  FILLER REDEFINES NLSTPMTF.
  1936         10  NLSTPMTA PIC  X(0001).
  1937     05  NLSTPMTI PIC  X(0008).
  1938*    -------------------------------
  1939     05  NEFFDTEL PIC S9(0004) COMP.
  1940     05  NEFFDTEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  40
* EL154.cbl
  1941     05  FILLER REDEFINES NEFFDTEF.
  1942         10  NEFFDTEA PIC  X(0001).
  1943     05  NEFFDTEI PIC  X(0008).
  1944*    -------------------------------
  1945     05  NMONTHSL PIC S9(0004) COMP.
  1946     05  NMONTHSF PIC  X(0001).
  1947     05  FILLER REDEFINES NMONTHSF.
  1948         10  NMONTHSA PIC  X(0001).
  1949     05  NMONTHSI PIC  99.
  1950*    -------------------------------
  1951     05  NDAYSFL PIC S9(0004) COMP.
  1952     05  NDAYSFF PIC  X(0001).
  1953     05  FILLER REDEFINES NDAYSFF.
  1954         10  NDAYSFA PIC  X(0001).
  1955     05  NDAYSFI PIC  999.
  1956*    -------------------------------
  1957     05  NPAYEEL PIC S9(0004) COMP.
  1958     05  NPAYEEF PIC  X(0001).
  1959     05  FILLER REDEFINES NPAYEEF.
  1960         10  NPAYEEA PIC  X(0001).
  1961     05  NPAYEEI PIC  X(0002).
  1962*    -------------------------------
  1963     05  NREGAMTL PIC S9(0004) COMP.
  1964     05  NREGAMTF PIC  X(0001).
  1965     05  FILLER REDEFINES NREGAMTF.
  1966         10  NREGAMTA PIC  X(0001).
  1967     05  NREGAMTI PIC  X(0010).
  1968*    -------------------------------
  1969     05  NLASTL PIC S9(0004) COMP.
  1970     05  NLASTF PIC  X(0001).
  1971     05  FILLER REDEFINES NLASTF.
  1972         10  NLASTA PIC  X(0001).
  1973     05  NLASTI PIC  X(0001).
  1974*    -------------------------------
  1975     05  NINDCTRL PIC S9(0004) COMP.
  1976     05  NINDCTRF PIC  X(0001).
  1977     05  FILLER REDEFINES NINDCTRF.
  1978         10  NINDCTRA PIC  X(0001).
  1979     05  NINDCTRI PIC  X(0001).
  1980*    -------------------------------
  1981     05  DAYPAYL PIC S9(0004) COMP.
  1982     05  DAYPAYF PIC  X(0001).
  1983     05  FILLER REDEFINES DAYPAYF.
  1984         10  DAYPAYA PIC  X(0001).
  1985     05  DAYPAYI PIC  99.
  1986*    -------------------------------
  1987     05  NPRINTL PIC S9(0004) COMP.
  1988     05  NPRINTF PIC  X(0001).
  1989     05  FILLER REDEFINES NPRINTF.
  1990         10  NPRINTA PIC  X(0001).
  1991     05  NPRINTI PIC  X(0004).
  1992*    -------------------------------
  1993     05  LETTDTEL PIC S9(0004) COMP.
  1994     05  LETTDTEF PIC  X(0001).
  1995     05  FILLER REDEFINES LETTDTEF.
  1996         10  LETTDTEA PIC  X(0001).
  1997     05  LETTDTEI PIC  X(0008).
  1998*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  41
* EL154.cbl
  1999     05  ENDLETTL PIC S9(0004) COMP.
  2000     05  ENDLETTF PIC  X(0001).
  2001     05  FILLER REDEFINES ENDLETTF.
  2002         10  ENDLETTA PIC  X(0001).
  2003     05  ENDLETTI PIC  X(0004).
  2004*    -------------------------------
  2005     05  ERRMSG1L PIC S9(0004) COMP.
  2006     05  ERRMSG1F PIC  X(0001).
  2007     05  FILLER REDEFINES ERRMSG1F.
  2008         10  ERRMSG1A PIC  X(0001).
  2009     05  ERRMSG1I PIC  X(0079).
  2010*    -------------------------------
  2011     05  ERRMSG2L PIC S9(0004) COMP.
  2012     05  ERRMSG2F PIC  X(0001).
  2013     05  FILLER REDEFINES ERRMSG2F.
  2014         10  ERRMSG2A PIC  X(0001).
  2015     05  ERRMSG2I PIC  X(0079).
  2016*    -------------------------------
  2017     05  ENTERPFL PIC S9(0004) COMP.
  2018     05  ENTERPFF PIC  X(0001).
  2019     05  FILLER REDEFINES ENTERPFF.
  2020         10  ENTERPFA PIC  X(0001).
  2021     05  ENTERPFI PIC  99.
  2022 01  EL154AO REDEFINES EL154AI.
  2023     05  FILLER            PIC  X(0012).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  RUNDTEO PIC  X(0008).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  RUNTIMEO PIC  99.99.
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  CLAIMO PIC  X(0007).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  CARRO PIC  X(0001).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  CERTO PIC  X(0010).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  SUFFIXO PIC  X(0001).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  CESTDTEO PIC  X(0008).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  CESTBYO PIC  X(0004).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  FSTHD1O PIC  X(0023).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  CFSTPMTO PIC  X(0008).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  CMONTHSO PIC  99.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  42
* EL154.cbl
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  CFSTAMTO PIC  ZZ,ZZ9.99.
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  LSTHD1O PIC  X(0024).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  CLSTPMTO PIC  X(0008).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  CLASTO PIC  X(0001).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  CREGPMTO PIC  ZZ,ZZ9.99.
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  CDAYSFO PIC  ZZ9.
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  CPAYEEO PIC  X(0008).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  DAY2PAYO PIC  X(0002).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  CEFFDTEO PIC  X(0008).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  TERMO PIC  X(0001).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  CINDCTRO PIC  X(0001).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  PRINTO PIC  X(0004).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  FSTHD2O PIC  X(0023).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  NFSTPMTO PIC  99B99B99.
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  NFSTAMTO PIC  ZZ,ZZZ.99-.
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  LSTHD2O PIC  X(0023).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  NLSTPMTO PIC  99B99B99.
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  NEFFDTEO PIC  99B99B99.
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  NMONTHSO PIC  X(0002).
  2114*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  43
* EL154.cbl
  2115     05  FILLER            PIC  X(0003).
  2116     05  NDAYSFO PIC  X(0003).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  NPAYEEO PIC  X(0002).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  NREGAMTO PIC  ZZ,ZZZ.99-.
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  NLASTO PIC  X(0001).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  NINDCTRO PIC  X(0001).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  DAYPAYO PIC  X(0002).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  NPRINTO PIC  X(0004).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  LETTDTEO PIC  99B99B99.
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  ENDLETTO PIC  X(0004).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  ERRMSG1O PIC  X(0079).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  ERRMSG2O PIC  X(0079).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  ENTERPFO PIC  X(0002).
  2150*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  44
* EL154.cbl
  2152****************************************************************
  2153*
  2154* Copyright (c) 2007 by Clerity Solutions, Inc.
  2155* All rights reserved.
  2156*
  2157****************************************************************
  2158 01  DFHEIV.
  2159   02  DFHEIV0               PIC X(35).
  2160   02  DFHEIV1               PIC X(08).
  2161   02  DFHEIV2               PIC X(08).
  2162   02  DFHEIV3               PIC X(08).
  2163   02  DFHEIV4               PIC X(06).
  2164   02  DFHEIV5               PIC X(04).
  2165   02  DFHEIV6               PIC X(04).
  2166   02  DFHEIV7               PIC X(02).
  2167   02  DFHEIV8               PIC X(02).
  2168   02  DFHEIV9               PIC X(01).
  2169   02  DFHEIV10              PIC S9(7) COMP-3.
  2170   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2171   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2172   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2173   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2174   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2175   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2176   02  DFHEIV17              PIC X(04).
  2177   02  DFHEIV18              PIC X(04).
  2178   02  DFHEIV19              PIC X(04).
  2179   02  DFHEIV20              USAGE IS POINTER.
  2180   02  DFHEIV21              USAGE IS POINTER.
  2181   02  DFHEIV22              USAGE IS POINTER.
  2182   02  DFHEIV23              USAGE IS POINTER.
  2183   02  DFHEIV24              USAGE IS POINTER.
  2184   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2185   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2186   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2187   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2188   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2189   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2190   02  FILLER                PIC X(02).
  2191   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2192   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2193   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2194   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2195   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2196 LINKAGE  SECTION.
  2197*****************************************************************
  2198*                                                               *
  2199* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2200* All rights reserved.                                          *
  2201*                                                               *
  2202*****************************************************************
  2203 01  dfheiblk.
  2204     02  eibtime          pic s9(7) comp-3.
  2205     02  eibdate          pic s9(7) comp-3.
  2206     02  eibtrnid         pic x(4).
  2207     02  eibtaskn         pic s9(7) comp-3.
  2208     02  eibtrmid         pic x(4).
  2209     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  45
* EL154.cbl
  2210     02  eibcposn         pic s9(4) comp.
  2211     02  eibcalen         pic s9(4) comp.
  2212     02  eibaid           pic x(1).
  2213     02  eibfiller1       pic x(1).
  2214     02  eibfn            pic x(2).
  2215     02  eibfiller2       pic x(2).
  2216     02  eibrcode         pic x(6).
  2217     02  eibfiller3       pic x(2).
  2218     02  eibds            pic x(8).
  2219     02  eibreqid         pic x(8).
  2220     02  eibrsrce         pic x(8).
  2221     02  eibsync          pic x(1).
  2222     02  eibfree          pic x(1).
  2223     02  eibrecv          pic x(1).
  2224     02  eibsend          pic x(1).
  2225     02  eibatt           pic x(1).
  2226     02  eibeoc           pic x(1).
  2227     02  eibfmh           pic x(1).
  2228     02  eibcompl         pic x(1).
  2229     02  eibsig           pic x(1).
  2230     02  eibconf          pic x(1).
  2231     02  eiberr           pic x(1).
  2232     02  eibrldbk         pic x(1).
  2233     02  eiberrcd         pic x(4).
  2234     02  eibsynrb         pic x(1).
  2235     02  eibnodat         pic x(1).
  2236     02  eibfiller5       pic x(2).
  2237     02  eibresp          pic 9(09) comp.
  2238     02  eibresp2         pic 9(09) comp.
  2239     02  dfheigdj         pic s9(4) comp.
  2240     02  dfheigdk         pic s9(4) comp.
  2241 01  DFHCOMMAREA             PIC X(1024).
  2242
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  46
* EL154.cbl
  2244*                            COPY ELCCNTL.
  2245******************************************************************
  2246*                                                                *
  2247*                                                                *
  2248*                            ELCCNTL.                            *
  2249*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2250*                            VMOD=2.059                          *
  2251*                                                                *
  2252*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2253*                                                                *
  2254*   FILE TYPE = VSAM,KSDS                                        *
  2255*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2256*                                                                *
  2257*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2258*       ALTERNATE INDEX = NONE                                   *
  2259*                                                                *
  2260*   LOG = YES                                                    *
  2261*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2262******************************************************************
  2263*                   C H A N G E   L O G
  2264*
  2265* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2266*-----------------------------------------------------------------
  2267*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2268* EFFECTIVE    NUMBER
  2269*-----------------------------------------------------------------
  2270* 082503                   PEMA  ADD BENEFIT GROUP
  2271* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2272* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2273* 092705    2005050300006  PEMA  ADD SPP LEASES
  2274* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2275* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2276* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2277* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2278* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2279* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2280* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2281* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2282* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2283* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2284******************************************************************
  2285*
  2286 01  CONTROL-FILE.
  2287     12  CF-RECORD-ID                       PIC XX.
  2288         88  VALID-CF-ID                        VALUE 'CF'.
  2289
  2290     12  CF-CONTROL-PRIMARY.
  2291         16  CF-COMPANY-ID                  PIC XXX.
  2292         16  CF-RECORD-TYPE                 PIC X.
  2293             88  CF-COMPANY-MASTER              VALUE '1'.
  2294             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2295             88  CF-STATE-MASTER                VALUE '3'.
  2296             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2297             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2298             88  CF-CARRIER-MASTER              VALUE '6'.
  2299             88  CF-MORTALITY-MASTER            VALUE '7'.
  2300             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2301             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  47
* EL154.cbl
  2302             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2303             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2304             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2305             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2306             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2307             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2308             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2309             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2310             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2311         16  CF-ACCESS-CD-GENL              PIC X(4).
  2312         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2313             20  CF-PROCESSOR               PIC X(4).
  2314         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2315             20  CF-STATE-CODE              PIC XX.
  2316             20  FILLER                     PIC XX.
  2317         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2318             20  FILLER                     PIC XX.
  2319             20  CF-HI-BEN-IN-REC           PIC XX.
  2320         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2321             20  FILLER                     PIC XXX.
  2322             20  CF-CARRIER-CNTL            PIC X.
  2323         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2324             20  FILLER                     PIC XX.
  2325             20  CF-HI-TYPE-IN-REC          PIC 99.
  2326         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2327             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2328                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2329             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2330             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2331         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2332             20  FILLER                     PIC X.
  2333             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2334         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2335             20  FILLER                     PIC XX.
  2336             20  CF-MORTGAGE-PLAN           PIC XX.
  2337         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2338
  2339     12  CF-LAST-MAINT-DT                   PIC XX.
  2340     12  CF-LAST-MAINT-BY                   PIC X(4).
  2341     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2342
  2343     12  CF-RECORD-BODY                     PIC X(728).
  2344
  2345
  2346****************************************************************
  2347*             COMPANY MASTER RECORD                            *
  2348****************************************************************
  2349
  2350     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2351         16  CF-COMPANY-ADDRESS.
  2352             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2353             20  CF-CL-IN-CARE-OF           PIC X(30).
  2354             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2355             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2356             20  CF-CL-CITY-STATE           PIC X(30).
  2357             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2358             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2359         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  48
* EL154.cbl
  2360         16  CF-COMPANY-PASSWORD            PIC X(8).
  2361         16  CF-SECURITY-OPTION             PIC X.
  2362             88  ALL-SECURITY                   VALUE '1'.
  2363             88  COMPANY-VERIFY                 VALUE '2'.
  2364             88  PROCESSOR-VERIFY               VALUE '3'.
  2365             88  NO-SECURITY                    VALUE '4'.
  2366             88  ALL-BUT-TERM                   VALUE '5'.
  2367         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2368             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2369         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2370             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2371         16  CF-INFORCE-LOCATION            PIC X.
  2372             88  CERTS-ARE-ONLINE               VALUE '1'.
  2373             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2374             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2375         16  CF-LOWER-CASE-LETTERS          PIC X.
  2376         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2377             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2378             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2379             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2380             88  CF-ACCNT-CNTL                  VALUE '3'.
  2381             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2382
  2383         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2384         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2385
  2386         16  CF-LGX-CREDIT-USER             PIC X.
  2387             88  CO-IS-NOT-USER                 VALUE 'N'.
  2388             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2389
  2390         16 CF-CREDIT-CALC-CODES.
  2391             20  CF-CR-REM-TERM-CALC PIC X.
  2392               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2393               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2394               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2395               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2396               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2397               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2398               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2399             20  CF-CR-R78-METHOD           PIC X.
  2400               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2401               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2402
  2403         16  CF-CLAIM-CONTROL-COUNTS.
  2404             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2405                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2406
  2407             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2408                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2409
  2410             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2411                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2412
  2413             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2414                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2415
  2416         16  CF-CURRENT-MONTH-END           PIC XX.
  2417
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  49
* EL154.cbl
  2418         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2419             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2420             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2421             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2422             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2423                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2424                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2425             20  CF-CO-PREM-REJECT-SW       PIC X.
  2426                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2427                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2428             20  CF-CO-REF-REJECT-SW        PIC X.
  2429                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2430                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2431
  2432         16  CF-CO-REPORTING-DT             PIC XX.
  2433         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2434         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2435           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2436           88  CF-CO-MONTH-END                  VALUE '1'.
  2437
  2438         16  CF-LGX-CLAIM-USER              PIC X.
  2439             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2440             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2441
  2442         16  CF-CREDIT-EDIT-CONTROLS.
  2443             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2444             20  CF-MIN-AGE                 PIC 99.
  2445             20  CF-DEFAULT-AGE             PIC 99.
  2446             20  CF-MIN-TERM                PIC S999      COMP-3.
  2447             20  CF-MAX-TERM                PIC S999      COMP-3.
  2448             20  CF-DEFAULT-SEX             PIC X.
  2449             20  CF-JOINT-AGE-INPUT         PIC X.
  2450                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2451             20  CF-BIRTH-DATE-INPUT        PIC X.
  2452                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2453             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2454                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2455                 88  CF-ZERO-CARRIER            VALUE '1'.
  2456                 88  CF-ZERO-GROUPING           VALUE '2'.
  2457                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2458             20  CF-EDIT-SW                 PIC X.
  2459                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2460             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2461             20  CF-CR-PR-METHOD            PIC X.
  2462               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2463               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2464             20  FILLER                     PIC X.
  2465
  2466         16  CF-CREDIT-MISC-CONTROLS.
  2467             20  CF-REIN-TABLE-SW           PIC X.
  2468                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2469             20  CF-COMP-TABLE-SW           PIC X.
  2470                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2471             20  CF-EXPERIENCE-RETENTION-AGE
  2472                                            PIC S9        COMP-3.
  2473             20  CF-CONVERSION-DT           PIC XX.
  2474             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2475             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  50
* EL154.cbl
  2476                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2477                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2478
  2479             20  CF-CR-CHECK-NO-CONTROL.
  2480                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2481                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2482                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2483                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2484                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2485                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2486
  2487                 24  CF-CR-CHECK-COUNT       REDEFINES
  2488                     CF-CR-CHECK-COUNTER      PIC X(4).
  2489
  2490                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2491                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2492
  2493                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2494                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2495                 24  CF-MAIL-PROCESSING       PIC X.
  2496                     88  MAIL-PROCESSING          VALUE 'Y'.
  2497
  2498         16  CF-MISC-SYSTEM-CONTROL.
  2499             20  CF-SYSTEM-C                 PIC X.
  2500                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2501             20  CF-SYSTEM-D                 PIC X.
  2502                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2503             20  CF-SOC-SEC-NO-SW            PIC X.
  2504                 88  SOC-SEC-NO-USED             VALUE '1'.
  2505             20  CF-MEMBER-NO-SW             PIC X.
  2506                 88  MEMBER-NO-USED              VALUE '1'.
  2507             20  CF-TAX-ID-NUMBER            PIC X(11).
  2508             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2509             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2510                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2511                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2512                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2513                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2514             20  CF-SYSTEM-E                 PIC X.
  2515                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2516
  2517         16  CF-LGX-LIFE-USER               PIC X.
  2518             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2519             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2520
  2521         16  CF-CR-MONTH-END-DT             PIC XX.
  2522
  2523         16  CF-FILE-MAINT-DATES.
  2524             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2525                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2526             20  CF-LAST-BATCH       REDEFINES
  2527                 CF-LAST-BATCH-NO               PIC X(4).
  2528             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2529             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2530             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2531             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2532             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2533             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  51
* EL154.cbl
  2534             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2535             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2536             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2537             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2538
  2539         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2540         16  FILLER                         PIC X.
  2541
  2542         16  CF-ALT-MORT-CODE               PIC X(4).
  2543         16  CF-MEMBER-CAPTION              PIC X(10).
  2544
  2545         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2546             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2547             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2548             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2549             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2550             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2551
  2552         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2553
  2554         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2555         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2556         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2557         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2558
  2559         16  CF-AH-OVERRIDE-L1              PIC X.
  2560         16  CF-AH-OVERRIDE-L2              PIC XX.
  2561         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2562         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2563
  2564         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2565         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2566
  2567         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2568         16  CF-AR-LAST-EL860-DT            PIC XX.
  2569         16  CF-MP-MONTH-END-DT             PIC XX.
  2570
  2571         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2572         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2573             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2574
  2575         16  CF-AR-MONTH-END-DT             PIC XX.
  2576
  2577         16  CF-CRDTCRD-USER                PIC X.
  2578             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2579             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2580
  2581         16  CF-CC-MONTH-END-DT             PIC XX.
  2582
  2583         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2584
  2585         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2586             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2587             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2588             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2589         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2590         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2591         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  52
* EL154.cbl
  2592         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2593             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2594             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2595         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2596         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2597         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2598             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2599         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2600
  2601         16  CF-CL-ZIP-CODE.
  2602             20  CF-CL-ZIP-PRIME.
  2603                 24  CF-CL-ZIP-1ST          PIC X.
  2604                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2605                 24  FILLER                 PIC X(4).
  2606             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2607         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2608             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2609             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2610             20  FILLER                     PIC XXX.
  2611
  2612         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2613         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2614         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2615         16  CF-CO-OPTION-START-DATE        PIC XX.
  2616         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2617           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2618                                                      '3' '4'.
  2619           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2620           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2621           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2622           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2623           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2624           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2625
  2626         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2627
  2628         16  CF-PAYMENT-APPROVAL-LEVELS.
  2629             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2630             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2631             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2632             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2633             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2634             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2635
  2636         16  CF-END-USER-REPORTING-USER     PIC X.
  2637             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2638             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2639
  2640         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2641             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2642             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2643
  2644         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2645
  2646         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2647         16  FILLER                         PIC X.
  2648
  2649         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  53
* EL154.cbl
  2650             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2651             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2652             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2653
  2654         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2655
  2656         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2657             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2658             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2659
  2660         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2661             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2662             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2663
  2664         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2665
  2666         16  CF-CO-ACH-ID-CODE              PIC  X.
  2667             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2668             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2669             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2670         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2671         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2672         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2673         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2674         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2675         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2676         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2677         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2678         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2679                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2680         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2681                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2682
  2683         16  CF-CO-OVER-SHORT.
  2684             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2685             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2686
  2687*         16  FILLER                         PIC X(102).
  2688         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2689             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2690             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2691
  2692         16  CF-AH-APPROVAL-DAYS.
  2693             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2694             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2695             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2696             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2697
  2698         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2699
  2700         16  CF-APPROV-LEV-5.
  2701             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2702             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2703             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2704
  2705         16  FILLER                         PIC X(68).
  2706****************************************************************
  2707*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  54
* EL154.cbl
  2708****************************************************************
  2709
  2710     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2711         16  CF-PROCESSOR-NAME              PIC X(30).
  2712         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2713         16  CF-PROCESSOR-TITLE             PIC X(26).
  2714         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2715                 88  MESSAGE-YES                VALUE 'Y'.
  2716                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2717
  2718*****************************************************
  2719****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2720****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2721****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2722****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2723*****************************************************
  2724
  2725         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2726             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2727             20  CF-APPLICATION-FORCE       PIC X.
  2728             20  CF-INDIVIDUAL-APP.
  2729                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2730                     28  CF-BROWSE-APP      PIC X.
  2731                     28  CF-UPDATE-APP      PIC X.
  2732
  2733         16  CF-CURRENT-TERM-ON             PIC X(4).
  2734         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2735             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2736             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2737             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2738             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2739             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2740             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2741             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2742         16  CF-PROCESSOR-CARRIER           PIC X.
  2743             88  NO-CARRIER-SECURITY            VALUE ' '.
  2744         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2745             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2746         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2747             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2748         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2749             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2750
  2751         16  CF-PROC-SYS-ACCESS-SW.
  2752             20  CF-PROC-CREDIT-CLAIMS-SW.
  2753                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2754                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2755                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2756                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2757             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2758                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2759                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2760             20  CF-PROC-LIFE-GNRLDGR-SW.
  2761                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2762                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2763                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2764                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2765             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  55
* EL154.cbl
  2766                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2767                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2768         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2769             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2770             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2771         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2772
  2773         16  CF-APPROVAL-LEVEL                  PIC X.
  2774             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2775             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2776             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2777             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2778             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2779
  2780         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2781
  2782         16  CF-LANGUAGE-TYPE                   PIC X.
  2783             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2784             88  CF-LANG-IS-FR                      VALUE 'F'.
  2785
  2786         16  CF-CSR-IND                         PIC X.
  2787         16  FILLER                             PIC X(239).
  2788
  2789****************************************************************
  2790*             PROCESSOR/REMINDERS RECORD                       *
  2791****************************************************************
  2792
  2793     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2794         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2795             20  CF-START-REMIND-DT         PIC XX.
  2796             20  CF-END-REMIND-DT           PIC XX.
  2797             20  CF-REMINDER-TEXT           PIC X(50).
  2798         16  FILLER                         PIC X(296).
  2799
  2800
  2801****************************************************************
  2802*             STATE MASTER RECORD                              *
  2803****************************************************************
  2804
  2805     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2806         16  CF-STATE-ABBREVIATION          PIC XX.
  2807         16  CF-STATE-NAME                  PIC X(25).
  2808         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2809         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2810             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2811             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2812             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2813             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2814                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2815                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2816             20  CF-ST-PREM-REJECT-SW       PIC X.
  2817                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2818                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2819             20  CF-ST-REF-REJECT-SW        PIC X.
  2820                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2821                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2822         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2823         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  56
* EL154.cbl
  2824         16  CF-ST-REFUND-RULES.
  2825             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2826             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2827             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2828         16  CF-ST-FST-PMT-EXTENSION.
  2829             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2830             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2831                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2832                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2833                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2834                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2835         16  CF-ST-STATE-CALL.
  2836             20  CF-ST-CALL-UNEARNED        PIC X.
  2837             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2838             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2839         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2840             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2841             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2842         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2843         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2844         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2845         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2846         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2847         16  FILLER                         PIC X.
  2848         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2849             20  CF-ST-BENEFIT-CD           PIC XX.
  2850             20  CF-ST-BENEFIT-KIND         PIC X.
  2851                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2852                 88  CF-ST-AH-KIND              VALUE 'A'.
  2853             20  CF-ST-REM-TERM-CALC        PIC X.
  2854                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2855                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2856                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2857                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2858                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2859                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2860                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2861                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2862
  2863             20  CF-ST-REFUND-CALC          PIC X.
  2864                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2865                 88  ST-REFD-BY-R78             VALUE '1'.
  2866                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2867                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2868                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2869                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2870                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2871                 88  ST-REFD-UTAH               VALUE '7'.
  2872                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2873                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2874                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2875
  2876             20  CF-ST-EARNING-CALC         PIC X.
  2877                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2878                 88  ST-EARN-BY-R78             VALUE '1'.
  2879                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2880                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2881                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  57
* EL154.cbl
  2882                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2883                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2884                 88  ST-EARN-MEAN               VALUE '8'.
  2885                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2886
  2887             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2888                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2889                 88  ST-OVRD-BY-R78             VALUE '1'.
  2890                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2891                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2892                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2893                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2894                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2895                 88  ST-OVRD-MEAN               VALUE '8'.
  2896                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2897             20  cf-st-extra-periods        pic 9.
  2898*            20  FILLER                     PIC X.
  2899
  2900         16  CF-ST-COMMISSION-CAPS.
  2901             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2902             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2903             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2904             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2905         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2906                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2907
  2908         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2909
  2910         16  CF-ST-STATUTORY-INTEREST.
  2911             20  CF-ST-STAT-DATE-FROM       PIC X.
  2912                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2913                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2914             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2915             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2916             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2917             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2918             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2919
  2920         16  CF-ST-OVER-SHORT.
  2921             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2922             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2923
  2924         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2925
  2926         16  CF-ST-RT-CALC                  PIC X.
  2927
  2928         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2929         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2930         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2931         16  CF-ST-RF-LR-CALC               PIC X.
  2932         16  CF-ST-RF-LL-CALC               PIC X.
  2933         16  CF-ST-RF-LN-CALC               PIC X.
  2934         16  CF-ST-RF-AH-CALC               PIC X.
  2935         16  CF-ST-RF-CP-CALC               PIC X.
  2936*        16  FILLER                         PIC X(206).
  2937*CIDMOD         16  FILLER                         PIC X(192).
  2938         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2939             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  58
* EL154.cbl
  2940         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2941         16  CF-ST-VFY-2ND-BENE             PIC X.
  2942         16  CF-ST-CAUSAL-STATE             PIC X.
  2943         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2944         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2945         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2946             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2947         16  CF-ST-NET-ONLY-STATE           PIC X.
  2948             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2949         16  FILLER                         PIC X(181).
  2950
  2951****************************************************************
  2952*             BENEFIT MASTER RECORD                            *
  2953****************************************************************
  2954
  2955     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2956         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2957             20  CF-BENEFIT-CODE            PIC XX.
  2958             20  CF-BENEFIT-NUMERIC  REDEFINES
  2959                 CF-BENEFIT-CODE            PIC XX.
  2960             20  CF-BENEFIT-ALPHA           PIC XXX.
  2961             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2962             20  CF-BENEFIT-COMMENT         PIC X(10).
  2963
  2964             20  CF-LF-COVERAGE-TYPE        PIC X.
  2965                 88  CF-REDUCING                VALUE 'R'.
  2966                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2967
  2968             20  CF-SPECIAL-CALC-CD         PIC X.
  2969                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2970                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2971                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2972                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2973                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2974                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2975                 88  CF-FARM-PLAN               VALUE 'F'.
  2976                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2977                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2978                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2979                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2980                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2981                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2982                 88  CF-PRUDENTIAL              VALUE 'P'.
  2983                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2984                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2985                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2986                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2987                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2988                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2989
  2990             20  CF-JOINT-INDICATOR         PIC X.
  2991                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2992
  2993*            20  FILLER                     PIC X(12).
  2994             20  cf-maximum-benefits        pic s999 comp-3.
  2995             20  FILLER                     PIC X(09).
  2996             20  CF-BENEFIT-CATEGORY        PIC X.
  2997             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  59
* EL154.cbl
  2998
  2999             20  CF-CO-REM-TERM-CALC        PIC X.
  3000                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3001                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3002                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3003                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3004                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3005
  3006             20  CF-CO-EARNINGS-CALC        PIC X.
  3007                 88  CO-EARN-BY-R78             VALUE '1'.
  3008                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3009                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3010                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3011                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3012                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3013                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3014                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3015
  3016             20  CF-CO-REFUND-CALC          PIC X.
  3017                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3018                 88  CO-REFD-BY-R78             VALUE '1'.
  3019                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3020                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3021                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3022                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3023                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3024                 88  CO-REFD-MEAN               VALUE '8'.
  3025                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3026                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3027                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3028
  3029             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3030                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3031                 88  CO-OVRD-BY-R78             VALUE '1'.
  3032                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3033                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3034                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3035                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3036                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3037                 88  CO-OVRD-MEAN               VALUE '8'.
  3038                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3039
  3040             20  CF-CO-BEN-I-G-CD           PIC X.
  3041                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3042                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3043                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3044
  3045         16  FILLER                         PIC X(304).
  3046
  3047
  3048****************************************************************
  3049*             CARRIER MASTER RECORD                            *
  3050****************************************************************
  3051
  3052     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3053         16  CF-ADDRESS-DATA.
  3054             20  CF-MAIL-TO-NAME            PIC X(30).
  3055             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  60
* EL154.cbl
  3056             20  CF-ADDRESS-LINE-1          PIC X(30).
  3057             20  CF-ADDRESS-LINE-2          PIC X(30).
  3058             20  CF-CITY-STATE              PIC X(30).
  3059             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3060             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3061
  3062         16  CF-CLAIM-NO-CONTROL.
  3063             20  CF-CLAIM-NO-METHOD         PIC X.
  3064                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3065                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3066                 88  CLAIM-NO-SEQ               VALUE '3'.
  3067                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3068             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3069                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3070                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3071                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3072
  3073         16  CF-CHECK-NO-CONTROL.
  3074             20  CF-CHECK-NO-METHOD         PIC X.
  3075                 88  CHECK-NO-MANUAL            VALUE '1'.
  3076                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3077                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3078                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3079             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3080                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3081
  3082         16  CF-DOMICILE-STATE              PIC XX.
  3083
  3084         16  CF-EXPENSE-CONTROLS.
  3085             20  CF-EXPENSE-METHOD          PIC X.
  3086                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3087                 88  DOLLARS-PER-PMT            VALUE '2'.
  3088                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3089                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3090             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3091             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3092
  3093         16  CF-CORRESPONDENCE-CONTROL.
  3094             20  CF-LETTER-RESEND-OPT       PIC X.
  3095                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3096                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3097             20  FILLER                     PIC X(4).
  3098
  3099         16  CF-RESERVE-CONTROLS.
  3100             20  CF-MANUAL-SW               PIC X.
  3101                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3102             20  CF-FUTURE-SW               PIC X.
  3103                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3104             20  CF-PTC-SW                  PIC X.
  3105                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3106             20  CF-IBNR-SW                 PIC X.
  3107                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3108             20  CF-PTC-LF-SW               PIC X.
  3109                 88  CF-LF-PTC-USED             VALUE '1'.
  3110             20  CF-CDT-ACCESS-METHOD       PIC X.
  3111                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3112                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3113                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  61
* EL154.cbl
  3114             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3115
  3116         16  CF-CLAIM-CALC-METHOD           PIC X.
  3117             88  360-PLUS-MONTHS                VALUE '1'.
  3118             88  365-PLUS-MONTHS                VALUE '2'.
  3119             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3120             88  360-DAILY                      VALUE '4'.
  3121             88  365-DAILY                      VALUE '5'.
  3122
  3123         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3124         16  FILLER                         PIC X(11).
  3125
  3126         16  CF-LIMIT-AMOUNTS.
  3127             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3128             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3129             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3130             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3131             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3132             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3133             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3134             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3135             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3136             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3137
  3138         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3139         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3140         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3141
  3142         16  CF-ZIP-CODE.
  3143             20  CF-ZIP-PRIME.
  3144                 24  CF-ZIP-1ST             PIC X.
  3145                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3146                 24  FILLER                 PIC X(4).
  3147             20  CF-ZIP-PLUS4               PIC X(4).
  3148         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3149             20  CF-CAN-POSTAL-1            PIC XXX.
  3150             20  CF-CAN-POSTAL-2            PIC XXX.
  3151             20  FILLER                     PIC XXX.
  3152
  3153         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3154         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3155         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3156
  3157         16  CF-RATING-SWITCH               PIC X.
  3158             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3159             88  CF-NO-RATING                   VALUE 'N'.
  3160
  3161         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3162
  3163         16  CF-CARRIER-OVER-SHORT.
  3164             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3165             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3166
  3167         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3168         16  CF-SECPAY-SWITCH               PIC X.
  3169             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3170             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3171         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  62
* EL154.cbl
  3172         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3173         16  FILLER                         PIC X(444).
  3174*        16  FILLER                         PIC X(452).
  3175
  3176
  3177****************************************************************
  3178*             MORTALITY MASTER RECORD                          *
  3179****************************************************************
  3180
  3181     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3182         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3183                                INDEXED BY CF-MORT-NDX.
  3184             20  CF-MORT-TABLE              PIC X(5).
  3185             20  CF-MORT-TABLE-TYPE         PIC X.
  3186                 88  CF-MORT-JOINT              VALUE 'J'.
  3187                 88  CF-MORT-SINGLE             VALUE 'S'.
  3188                 88  CF-MORT-COMBINED           VALUE 'C'.
  3189                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3190                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3191             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3192             20  CF-MORT-AGE-METHOD         PIC XX.
  3193                 88  CF-AGE-LAST                VALUE 'AL'.
  3194                 88  CF-AGE-NEAR                VALUE 'AN'.
  3195             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3196             20  CF-MORT-ADJUSTMENT-DIRECTION
  3197                                            PIC X.
  3198                 88  CF-MINUS                   VALUE '-'.
  3199                 88  CF-PLUS                    VALUE '+'.
  3200             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3201             20  CF-MORT-JOINT-CODE         PIC X.
  3202                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3203             20  CF-MORT-PC-Q               PIC X.
  3204                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3205             20  CF-MORT-TABLE-CODE         PIC X(4).
  3206             20  CF-MORT-COMMENTS           PIC X(15).
  3207             20  FILLER                     PIC X(14).
  3208
  3209         16  FILLER                         PIC X(251).
  3210
  3211
  3212****************************************************************
  3213*             BUSSINESS TYPE MASTER RECORD                     *
  3214****************************************************************
  3215
  3216     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3217* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3218* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3219* AND RECORD 05 IS TYPES 81-99
  3220         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3221             20  CF-BUSINESS-TITLE          PIC  X(19).
  3222             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3223                                            PIC S9V9(4) COMP-3.
  3224             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3225             20  FILLER                     PIC  X.
  3226         16  FILLER                         PIC  X(248).
  3227
  3228
  3229****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  63
* EL154.cbl
  3230*             TERMINAL MASTER RECORD                           *
  3231****************************************************************
  3232
  3233     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3234
  3235         16  CF-COMPANY-TERMINALS.
  3236             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3237                                  PIC X(4).
  3238         16  FILLER               PIC X(248).
  3239
  3240
  3241****************************************************************
  3242*             LIFE EDIT MASTER RECORD                          *
  3243****************************************************************
  3244
  3245     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3246         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3247             20  CF-LIFE-CODE-IN            PIC XX.
  3248             20  CF-LIFE-CODE-OUT           PIC XX.
  3249         16  FILLER                         PIC X(248).
  3250
  3251
  3252****************************************************************
  3253*             AH EDIT MASTER RECORD                            *
  3254****************************************************************
  3255
  3256     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3257         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3258             20  CF-AH-CODE-IN              PIC XXX.
  3259             20  CF-AH-CODE-OUT             PIC XX.
  3260         16  FILLER                         PIC X(248).
  3261
  3262
  3263****************************************************************
  3264*             CREDIBILITY TABLES                               *
  3265****************************************************************
  3266
  3267     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3268         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3269                             INDEXED BY CF-CRDB-NDX.
  3270             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3271             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3272             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3273         16  FILLER                         PIC  X(332).
  3274
  3275
  3276****************************************************************
  3277*             REPORT CUSTOMIZATION RECORD                      *
  3278****************************************************************
  3279
  3280     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3281         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3282             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3283             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3284             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3285**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3286****       A T-TRANSFER.                                   ****
  3287             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  64
* EL154.cbl
  3288
  3289         16  FILLER                         PIC XX.
  3290
  3291         16  CF-CARRIER-CNTL-OPT.
  3292             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3293                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3294                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3295             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3296                                            PIC X.
  3297         16  CF-GROUP-CNTL-OPT.
  3298             20  CF-GROUP-OPT-SEQ           PIC 9.
  3299                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3300                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3301             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3302                                            PIC X(6).
  3303         16  CF-STATE-CNTL-OPT.
  3304             20  CF-STATE-OPT-SEQ           PIC 9.
  3305                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3306                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3307             20  CF-STATE-SELECT OCCURS 3 TIMES
  3308                                            PIC XX.
  3309         16  CF-ACCOUNT-CNTL-OPT.
  3310             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3311                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3312                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3313             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3314                                            PIC X(10).
  3315         16  CF-BUS-TYP-CNTL-OPT.
  3316             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3317                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3318                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3319             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3320                                            PIC XX.
  3321         16  CF-LF-TYP-CNTL-OPT.
  3322             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3323                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3324                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3325             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3326                                            PIC XX.
  3327         16  CF-AH-TYP-CNTL-OPT.
  3328             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3329                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3330                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3331             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3332                                            PIC XX.
  3333         16  CF-REPTCD1-CNTL-OPT.
  3334             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3335                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3336                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3337             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3338                                            PIC X(10).
  3339         16  CF-REPTCD2-CNTL-OPT.
  3340             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3341                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3342                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3343             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3344                                            PIC X(10).
  3345         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  65
* EL154.cbl
  3346             20  CF-USER1-OPT-SEQ           PIC 9.
  3347                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3348                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3349             20  CF-USER1-SELECT OCCURS 3 TIMES
  3350                                            PIC X(10).
  3351         16  CF-USER2-CNTL-OPT.
  3352             20  CF-USER2-OPT-SEQ           PIC 9.
  3353                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3354                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3355             20  CF-USER2-SELECT OCCURS 3 TIMES
  3356                                            PIC X(10).
  3357         16  CF-USER3-CNTL-OPT.
  3358             20  CF-USER3-OPT-SEQ           PIC 9.
  3359                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3360                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3361             20  CF-USER3-SELECT OCCURS 3 TIMES
  3362                                            PIC X(10).
  3363         16  CF-USER4-CNTL-OPT.
  3364             20  CF-USER4-OPT-SEQ           PIC 9.
  3365                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3366                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3367             20  CF-USER4-SELECT OCCURS 3 TIMES
  3368                                            PIC X(10).
  3369         16  CF-USER5-CNTL-OPT.
  3370             20  CF-USER5-OPT-SEQ           PIC 9.
  3371                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3372                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3373             20  CF-USER5-SELECT OCCURS 3 TIMES
  3374                                            PIC X(10).
  3375         16  CF-REINS-CNTL-OPT.
  3376             20  CF-REINS-OPT-SEQ           PIC 9.
  3377                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3378                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3379             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3380                 24  CF-REINS-PRIME         PIC XXX.
  3381                 24  CF-REINS-SUB           PIC XXX.
  3382
  3383         16  CF-AGENT-CNTL-OPT.
  3384             20  CF-AGENT-OPT-SEQ           PIC 9.
  3385                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3386                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3387             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3388                                            PIC X(10).
  3389
  3390         16  FILLER                         PIC X(43).
  3391
  3392         16  CF-LOSS-RATIO-SELECT.
  3393             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3394             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3395         16  CF-ENTRY-DATE-SELECT.
  3396             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3397             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3398         16  CF-EFFECTIVE-DATE-SELECT.
  3399             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3400             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3401
  3402         16  CF-EXCEPTION-LIST-IND          PIC X.
  3403             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  66
* EL154.cbl
  3404
  3405         16  FILLER                         PIC X(318).
  3406
  3407****************************************************************
  3408*                  EXCEPTION REPORTING RECORD                  *
  3409****************************************************************
  3410
  3411     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3412         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3413             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3414
  3415         16  CF-COMBINED-LIFE-AH-OPT.
  3416             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3417             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3418             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3419             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3420
  3421         16  CF-LIFE-OPT.
  3422             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3423             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3424             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3425             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3426             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3427             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3428             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3429             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3430             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3431             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3432
  3433         16  CF-AH-OPT.
  3434             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3435             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3436             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3437             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3438             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3439             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3440             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3441             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3442             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3443             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3444
  3445         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3446             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3447             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3448             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3449
  3450         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3451
  3452         16  FILLER                         PIC X(673).
  3453
  3454
  3455****************************************************************
  3456*             MORTGAGE SYSTEM PLAN RECORD                      *
  3457****************************************************************
  3458
  3459     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3460         16  CF-PLAN-TYPE                   PIC X.
  3461             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  67
* EL154.cbl
  3462             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3463             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3464         16  CF-PLAN-ABBREV                 PIC XXX.
  3465         16  CF-PLAN-DESCRIPT               PIC X(10).
  3466         16  CF-PLAN-NOTES                  PIC X(20).
  3467         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3468         16  CF-PLAN-UNDERWRITING.
  3469             20  CF-PLAN-TERM-DATA.
  3470                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3471                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3472             20  CF-PLAN-AGE-DATA.
  3473                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3474                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3475                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3476             20  CF-PLAN-BENEFIT-DATA.
  3477                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3478                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3479                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3480                                            PIC S9(7)V99  COMP-3.
  3481         16  CF-PLAN-POLICY-FORMS.
  3482             20  CF-POLICY-FORM             PIC X(12).
  3483             20  CF-MASTER-APPLICATION      PIC X(12).
  3484             20  CF-MASTER-POLICY           PIC X(12).
  3485         16  CF-PLAN-RATING.
  3486             20  CF-RATE-CODE               PIC X(5).
  3487             20  CF-SEX-RATING              PIC X.
  3488                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3489                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3490             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3491             20  CF-SUB-STD-TYPE            PIC X.
  3492                 88  CF-PCT-OF-PREM            VALUE '1'.
  3493                 88  CF-PCT-OF-BENE            VALUE '2'.
  3494         16  CF-PLAN-PREM-TOLERANCES.
  3495             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3496             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3497         16  CF-PLAN-PYMT-TOLERANCES.
  3498             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3499             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3500         16  CF-PLAN-MISC-DATA.
  3501             20  FILLER                     PIC X.
  3502             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3503             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3504         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3505         16  CF-PLAN-IND-GRP                PIC X.
  3506             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3507                                                     '1'.
  3508             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3509                                                     '2'.
  3510         16  CF-MIB-SEARCH-SW               PIC X.
  3511             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3512             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3513             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3514             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3515         16  CF-ALPHA-SEARCH-SW             PIC X.
  3516             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3517             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3518             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3519             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  68
* EL154.cbl
  3520             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3521             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3522             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3523             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3524             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3525             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3526                                                     'A' 'B' 'C'
  3527                                                     'X' 'Y' 'Z'.
  3528         16  CF-EFF-DT-RULE-SW              PIC X.
  3529             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3530             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3531             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3532             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3533             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3534         16  FILLER                         PIC X(4).
  3535         16  CF-HEALTH-QUESTIONS            PIC X.
  3536             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3537         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3538         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3539         16  CF-PLAN-SNGL-JNT               PIC X.
  3540             88  CF-COMBINED-PLAN              VALUE 'C'.
  3541             88  CF-JNT-PLAN                   VALUE 'J'.
  3542             88  CF-SNGL-PLAN                  VALUE 'S'.
  3543         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3544         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3545         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3546         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3547         16  CF-RERATE-CNTL                 PIC  X.
  3548             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3549             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3550             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3551             88  CF-AUTO-RECALC                 VALUE '4'.
  3552         16  CF-BENEFIT-TYPE                PIC  X.
  3553             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3554             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3555         16  CF-POLICY-FEE                  PIC S999V99
  3556                                                    COMP-3.
  3557         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3558         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3559         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3560         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3561         16  FILLER                         PIC  X(32).
  3562         16  CF-TERMINATION-FORM            PIC  X(04).
  3563         16  FILLER                         PIC  X(08).
  3564         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3565                                                       COMP-3.
  3566         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3567         16  CF-ISSUE-LETTER                PIC  X(4).
  3568         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3569         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3570             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3571             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3572         16  CF-MP-REFUND-CALC              PIC X.
  3573             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3574             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3575             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3576             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3577             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  69
* EL154.cbl
  3578             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3579             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3580             88  CF-MP-REFD-MEAN                VALUE '8'.
  3581         16  CF-ALT-RATE-CODE               PIC  X(5).
  3582
  3583
  3584         16  FILLER                         PIC X(498).
  3585****************************************************************
  3586*             MORTGAGE COMPANY MASTER RECORD                   *
  3587****************************************************************
  3588
  3589     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3590         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3591         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3592             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3593             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3594             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3595             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3596             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3597
  3598         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3599         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3600         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3601         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3602         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3603
  3604         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3605             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3606         16  CF-MP-RECON-USE-IND            PIC X(1).
  3607             88  CF-MP-USE-RECON             VALUE 'Y'.
  3608         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3609             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3610         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3611             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3612             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3613         16  FILLER                         PIC X(1).
  3614         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3615             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3616         16  CF-MORTG-MIB-VERSION           PIC X.
  3617             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3618             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3619             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3620         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3621             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3622                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3623             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3624                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3625             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3626                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3627             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3628                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3629             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3630                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3631             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3632                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3633         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3634         16  FILLER                         PIC X(7).
  3635         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  70
* EL154.cbl
  3636             20  CF-MORTG-MIB-COMM          PIC X(5).
  3637             20  CF-MORTG-MIB-TERM          PIC X(5).
  3638         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3639             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3640         16  FILLER                         PIC X(03).
  3641         16  CF-MP-CHECK-NO-CONTROL.
  3642             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3643                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3644                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3645                                                ' ' LOW-VALUES.
  3646                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3647                                               VALUE '3'.
  3648         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3649         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3650         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3651             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3652                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3653             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3654                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3655             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3656                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3657             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3658                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3659             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3660                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3661             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3662                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3663         16  CF-MORTG-BILLING-AREA.
  3664             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3665                                            PIC X.
  3666         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3667         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3668         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3669         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3670             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3671             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3672         16  FILLER                         PIC X.
  3673         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3674             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3675             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3676         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3677         16  FILLER                         PIC X(8).
  3678         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3679         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3680         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3681         16  CF-ACH-COMPANY-ID.
  3682             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3683                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3684                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3685                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3686             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3687         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3688             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3689         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3690             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3691             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3692         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3693         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  71
* EL154.cbl
  3694         16  FILLER                         PIC X(536).
  3695
  3696****************************************************************
  3697*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3698****************************************************************
  3699
  3700     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3701         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3702             20  CF-FEMALE-HEIGHT.
  3703                 24  CF-FEMALE-FT           PIC 99.
  3704                 24  CF-FEMALE-IN           PIC 99.
  3705             20  CF-FEMALE-MIN-WT           PIC 999.
  3706             20  CF-FEMALE-MAX-WT           PIC 999.
  3707         16  FILLER                         PIC X(428).
  3708
  3709     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3710         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3711             20  CF-MALE-HEIGHT.
  3712                 24  CF-MALE-FT             PIC 99.
  3713                 24  CF-MALE-IN             PIC 99.
  3714             20  CF-MALE-MIN-WT             PIC 999.
  3715             20  CF-MALE-MAX-WT             PIC 999.
  3716         16  FILLER                         PIC X(428).
  3717******************************************************************
  3718*             AUTOMATIC ACTIVITY RECORD                          *
  3719******************************************************************
  3720     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3721         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3722             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3723             20  CF-SYS-LETTER-ID           PIC X(04).
  3724             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3725             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3726             20  CF-SYS-RESET-SW            PIC X(01).
  3727             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3728             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3729
  3730         16  FILLER                         PIC X(50).
  3731
  3732         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3733             20  CF-USER-ACTIVE-SW          PIC X(01).
  3734             20  CF-USER-LETTER-ID          PIC X(04).
  3735             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3736             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3737             20  CF-USER-RESET-SW           PIC X(01).
  3738             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3739             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3740             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3741
  3742         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  72
* EL154.cbl
  3744*                            COPY ELCMSTR.
  3745******************************************************************
  3746*                                                                *
  3747*                            ELCMSTR.                            *
  3748*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3749*                            VMOD=2.012                          *
  3750*                                                                *
  3751*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3752*                                                                *
  3753*   FILE TYPE = VSAM,KSDS                                        *
  3754*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3755*                                                                *
  3756*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3757*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3758*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3759*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3760*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3761*                                                 RKP=75,LEN=21  *
  3762*                                                                *
  3763*   **** NOTE ****                                               *
  3764*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3765*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3766*                                                                *
  3767*   LOG = YES                                                    *
  3768*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3769******************************************************************
  3770*                   C H A N G E   L O G
  3771*
  3772* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3773*-----------------------------------------------------------------
  3774*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3775* EFFECTIVE    NUMBER
  3776*-----------------------------------------------------------------
  3777* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3778* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3779* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3780* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3781* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3782******************************************************************
  3783 01  CLAIM-MASTER.
  3784     12  CL-RECORD-ID                PIC XX.
  3785         88  VALID-CL-ID         VALUE 'CL'.
  3786
  3787     12  CL-CONTROL-PRIMARY.
  3788         16  CL-COMPANY-CD           PIC X.
  3789         16  CL-CARRIER              PIC X.
  3790         16  CL-CLAIM-NO             PIC X(7).
  3791         16  CL-CERT-NO.
  3792             20  CL-CERT-PRIME       PIC X(10).
  3793             20  CL-CERT-SFX         PIC X.
  3794
  3795     12  CL-CONTROL-BY-NAME.
  3796         16  CL-COMPANY-CD-A1        PIC X.
  3797         16  CL-INSURED-LAST-NAME    PIC X(15).
  3798         16  CL-INSURED-NAME.
  3799             20  CL-INSURED-1ST-NAME PIC X(12).
  3800             20  CL-INSURED-MID-INIT PIC X.
  3801
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  73
* EL154.cbl
  3802     12  CL-CONTROL-BY-SSN.
  3803         16  CL-COMPANY-CD-A2        PIC X.
  3804         16  CL-SOC-SEC-NO.
  3805             20  CL-SSN-STATE        PIC XX.
  3806             20  CL-SSN-ACCOUNT      PIC X(6).
  3807             20  CL-SSN-LN3          PIC X(3).
  3808
  3809     12  CL-CONTROL-BY-CERT-NO.
  3810         16  CL-COMPANY-CD-A4        PIC X.
  3811         16  CL-CERT-NO-A4.
  3812             20  CL-CERT-A4-PRIME    PIC X(10).
  3813             20  CL-CERT-A4-SFX      PIC X.
  3814
  3815     12  CL-CONTROL-BY-CCN.
  3816         16  CL-COMPANY-CD-A5        PIC X.
  3817         16  CL-CCN-A5.
  3818             20  CL-CCN.
  3819                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3820                 24  CL-CCN-PRIME-A5 PIC X(12).
  3821             20  CL-CCN-FILLER-A5    PIC X(4).
  3822
  3823     12  CL-INSURED-PROFILE-DATA.
  3824         16  CL-INSURED-BIRTH-DT     PIC XX.
  3825         16  CL-INSURED-SEX-CD       PIC X.
  3826             88  INSURED-IS-MALE        VALUE 'M'.
  3827             88  INSURED-IS-FEMALE      VALUE 'F'.
  3828             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3829         16  CL-INSURED-OCC-CD       PIC X(6).
  3830         16  FILLER                  PIC X(5).
  3831
  3832     12  CL-PROCESSING-INFO.
  3833         16  CL-PROCESSOR-ID         PIC X(4).
  3834         16  CL-CLAIM-STATUS         PIC X.
  3835             88  CLAIM-IS-OPEN          VALUE 'O'.
  3836             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3837         16  CL-CLAIM-TYPE           PIC X.
  3838*            88  AH-CLAIM               VALUE 'A'.
  3839*            88  LIFE-CLAIM             VALUE 'L'.
  3840*            88  PROPERTY-CLAIM         VALUE 'P'.
  3841*            88  IUI-CLAIM              VALUE 'I'.
  3842*            88  GAP-CLAIM              VALUE 'G'.
  3843*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3844         16  CL-CLAIM-PREM-TYPE      PIC X.
  3845             88  SINGLE-PREMIUM         VALUE '1'.
  3846             88  O-B-COVERAGE           VALUE '2'.
  3847             88  OPEN-END-COVERAGE      VALUE '3'.
  3848         16  CL-INCURRED-DT          PIC XX.
  3849         16  CL-REPORTED-DT          PIC XX.
  3850         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3851         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3852         16  CL-LAST-PMT-DT          PIC XX.
  3853         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3854         16  CL-PAID-THRU-DT         PIC XX.
  3855         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3856         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3857         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3858         16  CL-PMT-CALC-METHOD      PIC X.
  3859             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  74
* EL154.cbl
  3860             88  CL-365-DAY-YR          VALUE '2'.
  3861             88  CL-FULL-MONTHS         VALUE '3'.
  3862         16  CL-CAUSE-CD             PIC X(6).
  3863
  3864         16  CL-PRIME-CERT-NO.
  3865             20  CL-PRIME-CERT-PRIME PIC X(10).
  3866             20  CL-PRIME-CERT-SFX   PIC X.
  3867
  3868         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3869             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3870             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3871
  3872         16  CL-MICROFILM-NO         PIC X(10).
  3873         16  FILLER REDEFINES CL-MICROFILM-NO.
  3874             20  CL-BENEFIT-PERIOD   PIC 99.
  3875             20  FILLER              PIC X(8).
  3876         16  CL-PROG-FORM-TYPE       PIC X.
  3877         16  CL-LAST-ADD-ON-DT       PIC XX.
  3878
  3879         16  CL-LAST-REOPEN-DT       PIC XX.
  3880         16  CL-LAST-CLOSE-DT        PIC XX.
  3881         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3882             88  FINAL-PAID             VALUE '1'.
  3883             88  CLAIM-DENIED           VALUE '2'.
  3884             88  AUTO-CLOSE             VALUE '3'.
  3885             88  MANUAL-CLOSE           VALUE '4'.
  3886             88  BENEFITS-CHANGED       VALUE 'C'.
  3887             88  SETUP-ERRORS           VALUE 'E'.
  3888         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3889         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3890         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3891             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3892         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3893         16  FILLER                  PIC X.
  3894
  3895     12  CL-CERTIFICATE-DATA.
  3896         16  CL-CERT-ORIGIN          PIC X.
  3897             88  CERT-WAS-ONLINE        VALUE '1'.
  3898             88  CERT-WAS-CREATED       VALUE '2'.
  3899             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3900         16  CL-CERT-KEY-DATA.
  3901             20  CL-CERT-CARRIER     PIC X.
  3902             20  CL-CERT-GROUPING    PIC X(6).
  3903             20  CL-CERT-STATE       PIC XX.
  3904             20  CL-CERT-ACCOUNT.
  3905                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3906                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3907             20  CL-CERT-EFF-DT      PIC XX.
  3908
  3909     12  CL-STATUS-CONTROLS.
  3910         16  CL-PRIORITY-CD          PIC X.
  3911             88  CONFIDENTIAL-DATA      VALUE '8'.
  3912             88  HIGHEST-PRIORITY       VALUE '9'.
  3913         16  CL-SUPV-ATTN-CD         PIC X.
  3914             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3915             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3916         16  CL-PURGED-DT            PIC XX.
  3917         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  75
* EL154.cbl
  3918         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3919         16  CL-NEXT-RESEND-DT       PIC XX.
  3920         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3921         16  CL-CRITICAL-PERIOD      PIC 99.
  3922*        16  FILLER                  PIC XX.
  3923         16  CL-LAST-MAINT-DT        PIC XX.
  3924         16  CL-LAST-MAINT-USER      PIC X(4).
  3925         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3926         16  CL-LAST-MAINT-TYPE      PIC X.
  3927             88  CLAIM-SET-UP           VALUE ' '.
  3928             88  PAYMENT-MADE           VALUE '1'.
  3929             88  LETTER-SENT            VALUE '2'.
  3930             88  MASTER-WAS-ALTERED     VALUE '3'.
  3931             88  MASTER-WAS-RESTORED    VALUE '4'.
  3932             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3933             88  FILE-CONVERTED         VALUE '6'.
  3934             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3935             88  ERROR-CORRECTION       VALUE 'E'.
  3936         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3937         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3938         16  CL-BENEFICIARY          PIC X(10).
  3939         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3940         16  CL-DENIAL-TYPE          PIC X.
  3941             88  CL-TYPE-DENIAL          VALUE '1'.
  3942             88  CL-TYPE-RESCISSION      VALUE '2'.
  3943             88  CL-TYPE-REFORMATION     VALUE '3'.
  3944             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3945             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3946         16  filler                  pic x(5).
  3947*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3948*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3949*        16  CL-RTW-DT               PIC XX.
  3950
  3951     12  CL-TRAILER-CONTROLS.
  3952         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3953             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3954             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3955             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3956         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3957         16  FILLER                  PIC XX.
  3958         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3959         16  CL-ADDRESS-TRAILER-CNT.
  3960             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3961                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3962             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3963                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3964             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3965                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3966             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3967                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3968             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3969                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3970             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3971                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3972             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3973                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3974
  3975     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  76
* EL154.cbl
  3976         16  CL-CV-REFNO-PRIME       PIC X(18).
  3977         16  CL-CV-REFNO-SFX         PIC XX.
  3978
  3979     12  CL-FILE-LOCATION            PIC X(4).
  3980
  3981     12  CL-PROCESS-ERRORS.
  3982         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3983             88  NO-FATAL-ERRORS        VALUE ZERO.
  3984         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3985             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3986
  3987     12  CL-PRODUCT-CD               PIC X.
  3988
  3989     12  CL-CURRENT-KEY-DATA.
  3990         16  CL-CURRENT-CARRIER      PIC X.
  3991         16  CL-CURRENT-GROUPING     PIC X(6).
  3992         16  CL-CURRENT-STATE        PIC XX.
  3993         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3994
  3995     12  CL-ASSOCIATES               PIC X.
  3996         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3997         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3998         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3999         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4000
  4001     12  CL-ACTIVITY-CODE            PIC 99.
  4002     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4003     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4004
  4005     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4006     12  CL-LAG-REPORT-CODE          PIC 9.
  4007     12  CL-LOAN-TYPE                PIC XX.
  4008     12  CL-LEGAL-STATE              PIC XX.
  4009
  4010     12  CL-YESNOSW                  PIC X.
  4011     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4012         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4013         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4014         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4015     12  cl-insured-type             pic x.
  4016         88  cl-claim-on-primary         value 'P'.
  4017         88  cl-claim-on-co-borrower     value 'C'.
  4018     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  77
* EL154.cbl
  4020*                            COPY ELCTRLR.
  4021******************************************************************
  4022*                                                                *
  4023*                            ELCTRLR.                            *
  4024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4025*                            VMOD=2.014                          *
  4026*                                                                *
  4027*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4028*                                                                *
  4029*   FILE TYPE = VSAM,KSDS                                        *
  4030*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4031*                                                                *
  4032*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4033*       ALTERNATE INDEX = NONE                                   *
  4034*                                                                *
  4035*   LOG = YES                                                    *
  4036*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4037******************************************************************
  4038*                   C H A N G E   L O G
  4039*
  4040* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4041*-----------------------------------------------------------------
  4042*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4043* EFFECTIVE    NUMBER
  4044*-----------------------------------------------------------------
  4045* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4046* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4047* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4048* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4049* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4050* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4051* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4052* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4053* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4054* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4055* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4056* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4057* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4058* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4059* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4060* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4061* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4062* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4063* 040814    2014030500002  AJRA  ADD ICD CODES
  4064* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4065******************************************************************
  4066 01  ACTIVITY-TRAILERS.
  4067     12  AT-RECORD-ID                    PIC XX.
  4068         88  VALID-AT-ID                       VALUE 'AT'.
  4069
  4070     12  AT-CONTROL-PRIMARY.
  4071         16  AT-COMPANY-CD               PIC X.
  4072         16  AT-CARRIER                  PIC X.
  4073         16  AT-CLAIM-NO                 PIC X(7).
  4074         16  AT-CERT-NO.
  4075             20  AT-CERT-PRIME           PIC X(10).
  4076             20  AT-CERT-SFX             PIC X.
  4077         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  78
* EL154.cbl
  4078             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4079             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4080             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4081             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4082             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4083             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4084             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4085             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4086             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4087             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4088             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4089             88  AT-BENEFICIARY-TRL           VALUE +91.
  4090             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4091             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4092             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4093             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4094
  4095     12  AT-TRAILER-TYPE                 PIC X.
  4096         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4097         88  PAYMENT-TR                       VALUE '2'.
  4098         88  AUTO-PAY-TR                      VALUE '3'.
  4099         88  CORRESPONDENCE-TR                VALUE '4'.
  4100         88  ADDRESS-TR                       VALUE '5'.
  4101         88  GENERAL-INFO-TR                  VALUE '6'.
  4102         88  AUTO-PROMPT-TR                   VALUE '7'.
  4103         88  DENIAL-TR                        VALUE '8'.
  4104         88  INCURRED-CHG-TR                  VALUE '9'.
  4105         88  FORM-CONTROL-TR                  VALUE 'A'.
  4106
  4107     12  AT-RECORDED-DT                  PIC XX.
  4108     12  AT-RECORDED-BY                  PIC X(4).
  4109     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4110
  4111     12  AT-TRAILER-BODY                 PIC X(165).
  4112
  4113     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4114         16  AT-RESERVE-CONTROLS.
  4115             20  AT-MANUAL-SW            PIC X.
  4116                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4117             20  AT-FUTURE-SW            PIC X.
  4118                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4119             20  AT-PTC-SW               PIC X.
  4120                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4121             20  AT-IBNR-SW              PIC X.
  4122                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4123             20  AT-PTC-LF-SW            PIC X.
  4124                 88  AT-LF-PTC-USED          VALUE '1'.
  4125             20  AT-CDT-ACCESS-METHOD    PIC X.
  4126                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4127                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4128                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4129             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4130         16  AT-LAST-COMPUTED-DT         PIC XX.
  4131         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4132         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4133         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4134         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4135         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  79
* EL154.cbl
  4136         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4137         16  AT-EXPENSE-CONTROLS.
  4138             20  AT-EXPENSE-METHOD       PIC X.
  4139                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4140                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4141                 88  PERCENT-OF-PMT           VALUE '3'.
  4142                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4143             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4144             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4145         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4146         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4147
  4148         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4149         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4150
  4151*        16  FILLER                      PIC X(53).
  4152         16  FILLER                      PIC X(47).
  4153
  4154         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4155         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4156
  4157         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4158             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4159             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4160*                    C = CLOSED
  4161*                    O = OPEN
  4162             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4163*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4164
  4165     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4166         16  AT-PAYMENT-TYPE             PIC X.
  4167             88  PARTIAL-PAYMENT                VALUE '1'.
  4168             88  FINAL-PAYMENT                  VALUE '2'.
  4169             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4170             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4171             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4172             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4173             88  VOIDED-PAYMENT                 VALUE '9'.
  4174             88  TRANSFER                       VALUE 'T'.
  4175             88  LIFE-INTEREST                  VALUE 'I'.
  4176
  4177         16  AT-CLAIM-TYPE               PIC X.
  4178             88  PAID-FOR-AH                    VALUE 'A'.
  4179             88  PAID-FOR-LIFE                  VALUE 'L'.
  4180             88  PAID-FOR-IUI                   VALUE 'I'.
  4181             88  PAID-FOR-GAP                   VALUE 'G'.
  4182             88  PAID-FOR-FAM                   VALUE 'F'.
  4183         16  AT-CLAIM-PREM-TYPE          PIC X.
  4184             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4185             88  AT-O-B-COVERAGE                VALUE '2'.
  4186             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4187         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4188         16  AT-CHECK-NO                 PIC X(7).
  4189         16  AT-PAID-FROM-DT             PIC XX.
  4190         16  AT-PAID-THRU-DT             PIC XX.
  4191         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4192         16  FILLER                      PIC X.
  4193         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  80
* EL154.cbl
  4194         16  AT-PAYMENT-ORIGIN           PIC X.
  4195             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4196             88  ONLINE-AUTO-PMT                VALUE '2'.
  4197             88  OFFLINE-PMT                    VALUE '3'.
  4198         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4199         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4200         16  AT-VOID-DATA.
  4201             20  AT-VOID-DT              PIC XX.
  4202*00144       20  AT-VOID-REASON          PIC X(30).
  4203             20  AT-VOID-REASON          PIC X(26).
  4204         16  AT-PMT-APPROVED-BY          PIC X(04).
  4205         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4206         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4207         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4208                                         PIC S99V9(5)  COMP-3.
  4209         16  AT-CREDIT-INTERFACE.
  4210             20  AT-PMT-SELECT-DT        PIC XX.
  4211                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4212             20  AT-PMT-ACCEPT-DT        PIC XX.
  4213                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4214             20  AT-VOID-SELECT-DT       PIC XX.
  4215                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4216             20  AT-VOID-ACCEPT-DT       PIC XX.
  4217                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4218
  4219         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4220                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4221                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4222         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4223
  4224         16  AT-FORCE-CONTROL            PIC X.
  4225             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4226         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4227         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4228         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4229         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4230         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4231         16  AT-BENEFIT-TYPE             PIC X.
  4232
  4233         16  AT-EXPENSE-TYPE             PIC X.
  4234         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4235
  4236         16  AT-PAYEE-TYPE-CD.
  4237             20  AT-PAYEE-TYPE           PIC X.
  4238                 88  INSURED-PAID           VALUE 'I'.
  4239                 88  BENEFICIARY-PAID       VALUE 'B'.
  4240                 88  ACCOUNT-PAID           VALUE 'A'.
  4241                 88  OTHER-1-PAID           VALUE 'O'.
  4242                 88  OTHER-2-PAID           VALUE 'Q'.
  4243                 88  DOCTOR-PAID            VALUE 'P'.
  4244                 88  EMPLOYER-PAID          VALUE 'E'.
  4245             20  AT-PAYEE-SEQ            PIC X.
  4246
  4247         16  AT-CASH-PAYMENT             PIC X.
  4248         16  AT-GROUPED-PAYMENT          PIC X.
  4249         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4250         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4251         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  81
* EL154.cbl
  4252         16  AT-VOID-TYPE                PIC X.
  4253             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4254             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4255         16  AT-AIG-UNEMP-IND            PIC X.
  4256             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4257         16  AT-ASSOCIATES               PIC X.
  4258             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4259             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4260
  4261         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4262         16  AT-CV-PMT-CODE              PIC X.
  4263             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4264             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4265             88  FULL-ADD-PAYMENT           VALUE '3'.
  4266             88  HALF-ADD-PAYMENT           VALUE '4'.
  4267             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4268             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4269             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4270             88  ADDL-PAYMENT               VALUE '8'.
  4271
  4272         16  AT-EOB-CODE1                PIC XXX.
  4273         16  AT-EOB-CODE2                PIC XXX.
  4274         16  AT-EOB-CODE3                PIC XXX.
  4275         16  FILLER REDEFINES AT-EOB-CODE3.
  4276             20  AT-PRINT-CLM-FORM       PIC X.
  4277             20  AT-PRINT-SURVEY         PIC X.
  4278             20  AT-SPECIAL-RELEASE      PIC X.
  4279         16  AT-EOB-CODE4                PIC XXX.
  4280         16  FILLER REDEFINES AT-EOB-CODE4.
  4281             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4282             20  FILLER                  PIC X.
  4283         16  AT-EOB-CODE5                PIC XXX.
  4284         16  FILLER REDEFINES AT-EOB-CODE5.
  4285             20  AT-PMT-PROOF-DT         PIC XX.
  4286             20  FILLER                  PIC X.
  4287
  4288         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4289             88  AT-PRINT-EOB            VALUE 'Y'.
  4290
  4291         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4292         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4293
  4294     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4295         16  AT-SCHEDULE-START-DT        PIC XX.
  4296         16  AT-SCHEDULE-END-DT          PIC XX.
  4297         16  AT-TERMINATED-DT            PIC XX.
  4298         16  AT-LAST-PMT-TYPE            PIC X.
  4299             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4300             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4301         16  AT-FIRST-PMT-DATA.
  4302             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4303             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4304             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4305         16  AT-REGULAR-PMT-DATA.
  4306             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4307             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4308             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4309         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  82
* EL154.cbl
  4310             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4311                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4312                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4313                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4314                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4315                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4316             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4317         16  AT-AUTO-PAY-DAY             PIC 99.
  4318         16  AT-AUTO-CASH                PIC X.
  4319             88  AT-CASH                      VALUE 'Y'.
  4320             88  AT-NON-CASH                  VALUE 'N'.
  4321*        16  FILLER                      PIC X(129).
  4322         16  AT-AUTO-END-LETTER          PIC X(4).
  4323         16  FILLER                      PIC X(125).
  4324
  4325         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4326         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4327
  4328     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4329         16  AT-LETTER-SENT-DT           PIC XX.
  4330         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4331         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4332         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4333         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4334         16  AT-LETTER-ORIGIN            PIC X.
  4335             88  ONLINE-CREATION              VALUE '1' '3'.
  4336             88  OFFLINE-CREATION             VALUE '2' '4'.
  4337             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4338             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4339         16  AT-STD-LETTER-FORM          PIC X(4).
  4340         16  AT-REASON-TEXT              PIC X(70).
  4341         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4342         16  AT-ADDRESEE-TYPE            PIC X.
  4343              88  INSURED-ADDRESEE            VALUE 'I'.
  4344              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4345              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4346              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4347              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4348              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4349              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4350         16  AT-ADDRESSEE-NAME           PIC X(30).
  4351         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4352         16  AT-RESEND-PRINT-DATE        PIC XX.
  4353         16  AT-CORR-SOL-UNSOL           PIC X.
  4354         16  AT-LETTER-PURGED-DT         PIC XX.
  4355*
  4356*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4357*
  4358         16  AT-CSO-REDEFINITION.
  4359             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4360             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4361             20  AT-LETTER-TO-BENE       PIC X(1).
  4362             20  AT-STOP-LETTER-DT       PIC X(2).
  4363             20  FILLER                  PIC X(19).
  4364*             20  FILLER                  PIC X(27).
  4365             20  AT-CSO-LETTER-STATUS    PIC X.
  4366                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4367                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  83
* EL154.cbl
  4368                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4369             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4370             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4371*
  4372*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4373*
  4374*        16  FILLER                      PIC X(26).
  4375*
  4376*        16  AT-DMD-BSR-CODE             PIC X.
  4377*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4378*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4379*
  4380*        16  AT-DMD-LETTER-STATUS        PIC X.
  4381*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4382*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4383*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4384*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4385*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4386
  4387         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4388         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4389
  4390     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4391         16  AT-ADDRESS-TYPE             PIC X.
  4392             88  INSURED-ADDRESS               VALUE 'I'.
  4393             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4394             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4395             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4396             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4397             88  OTHER-ADDRESS-1               VALUE 'O'.
  4398             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4399         16  AT-MAIL-TO-NAME             PIC X(30).
  4400         16  AT-ADDRESS-LINE-1           PIC X(30).
  4401         16  AT-ADDRESS-LINE-2           PIC X(30).
  4402         16  AT-CITY-STATE.
  4403             20  AT-CITY                 PIC X(28).
  4404             20  AT-STATE                PIC XX.
  4405         16  AT-ZIP.
  4406             20  AT-ZIP-CODE.
  4407                 24  AT-ZIP-1ST          PIC X.
  4408                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4409                 24  FILLER              PIC X(4).
  4410             20  AT-ZIP-PLUS4            PIC X(4).
  4411         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4412             20  AT-CAN-POSTAL-1         PIC XXX.
  4413             20  AT-CAN-POSTAL-2         PIC XXX.
  4414             20  FILLER                  PIC XXX.
  4415         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4416*         16  FILLER                      PIC X(23).
  4417         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4418         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4419         16  FILLER                      PIC X(13).
  4420         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4421         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4422
  4423     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4424         16  AT-INFO-LINE-1              PIC X(60).
  4425         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  84
* EL154.cbl
  4426             20  AT-NOTE-ERROR-NO OCCURS 15
  4427                                         PIC X(4).
  4428         16  AT-INFO-LINE-2              PIC X(60).
  4429         16  FILLER REDEFINES AT-INFO-LINE-2.
  4430             20  AT-ICD-CODE-1           PIC X(8).
  4431             20  AT-ICD-CODE-2           PIC X(8).
  4432             20  FILLER                  PIC X(44).
  4433         16  AT-INFO-TRAILER-TYPE        PIC X.
  4434             88  AT-ERRORS-NOTE          VALUE 'E'.
  4435             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4436             88  AT-CALL-NOTE            VALUE 'C'.
  4437             88  AT-MAINT-NOTE           VALUE 'M'.
  4438             88  AT-CERT-CHANGE          VALUE 'X'.
  4439             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4440             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4441             88  AT-CERT-CANCELLED       VALUE 'T'.
  4442         16  AT-CALL-TYPE                PIC X.
  4443             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4444             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4445         16  AT-NOTE-CONTINUATION        PIC X.
  4446             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4447         16  AT-EOB-CODES-EXIST          PIC X.
  4448             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4449         16  FILLER                      PIC X(35).
  4450         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4451         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4452
  4453     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4454         16  AT-PROMPT-LINE-1            PIC X(60).
  4455         16  AT-PROMPT-LINE-2            PIC X(60).
  4456         16  AT-PROMPT-START-DT          PIC XX.
  4457         16  AT-PROMPT-END-DT            PIC XX.
  4458         16  FILLER                      PIC X(35).
  4459         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4460         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4461
  4462     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4463         16  AT-DENIAL-INFO-1            PIC X(60).
  4464         16  AT-DENIAL-INFO-2            PIC X(60).
  4465         16  AT-DENIAL-DT                PIC XX.
  4466         16  AT-RETRACTION-DT            PIC XX.
  4467         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4468*         16  FILLER                      PIC X(31).
  4469         16  AT-DENIAL-PROOF-DT          PIC XX.
  4470         16  FILLER                      PIC X(29).
  4471         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4472         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4473
  4474     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4475         16  AT-OLD-INCURRED-DT          PIC XX.
  4476         16  AT-OLD-REPORTED-DT          PIC XX.
  4477         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4478         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4479         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4480         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4481         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4482         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4483         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  85
* EL154.cbl
  4484         16  AT-OLD-DIAG-CODE            PIC X(6).
  4485         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4486         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4487         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4488         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4489         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4490         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4491         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4492         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4493         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4494         16  FILLER                      PIC X(9).
  4495         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4496
  4497     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4498         16  AT-FORM-SEND-ON-DT          PIC XX.
  4499         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4500         16  AT-FORM-RE-SEND-DT          PIC XX.
  4501         16  AT-FORM-ANSWERED-DT         PIC XX.
  4502         16  AT-FORM-PRINTED-DT          PIC XX.
  4503         16  AT-FORM-REPRINT-DT          PIC XX.
  4504         16  AT-FORM-TYPE                PIC X.
  4505             88  INITIAL-FORM                  VALUE '1'.
  4506             88  PROGRESS-FORM                 VALUE '2'.
  4507         16  AT-INSTRUCT-LN-1            PIC X(28).
  4508         16  AT-INSTRUCT-LN-2            PIC X(28).
  4509         16  AT-INSTRUCT-LN-3            PIC X(28).
  4510         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4511         16  AT-FORM-ADDRESS             PIC X.
  4512             88  FORM-TO-INSURED              VALUE 'I'.
  4513             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4514             88  FORM-TO-OTHER-1              VALUE 'O'.
  4515             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4516         16  AT-RELATED-1.
  4517             20 AT-REL-CARR-1            PIC X.
  4518             20 AT-REL-CLAIM-1           PIC X(7).
  4519             20 AT-REL-CERT-1            PIC X(11).
  4520         16  AT-RELATED-2.
  4521             20 AT-REL-CARR-2            PIC X.
  4522             20 AT-REL-CLAIM-2           PIC X(7).
  4523             20 AT-REL-CERT-2            PIC X(11).
  4524         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4525         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4526         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4527         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4528         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4529         16  AT-STOP-FORM-DT             PIC X(2).
  4530
  4531         16  FILLER                      PIC X(09).
  4532         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4533         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4534******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  86
* EL154.cbl
  4536*                            COPY ELCCERT.
  4537******************************************************************
  4538*                                                                *
  4539*                            ELCCERT.                            *
  4540*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4541*                            VMOD=2.013                          *
  4542*                                                                *
  4543*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4544*                                                                *
  4545*   FILE TYPE = VSAM,KSDS                                        *
  4546*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4547*                                                                *
  4548*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4549*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4550*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4551*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4552*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4553*                                                                *
  4554*   LOG = YES                                                    *
  4555*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4556******************************************************************
  4557*                   C H A N G E   L O G
  4558*
  4559* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4560*-----------------------------------------------------------------
  4561*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4562* EFFECTIVE    NUMBER
  4563*-----------------------------------------------------------------
  4564* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4565* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4566* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4567* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4568* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4569* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4570* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4571* 032612  CR2011110200001  PEMA  AHL CHANGES
  4572* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4573******************************************************************
  4574
  4575 01  CERTIFICATE-MASTER.
  4576     12  CM-RECORD-ID                      PIC XX.
  4577         88  VALID-CM-ID                      VALUE 'CM'.
  4578
  4579     12  CM-CONTROL-PRIMARY.
  4580         16  CM-COMPANY-CD                 PIC X.
  4581         16  CM-CARRIER                    PIC X.
  4582         16  CM-GROUPING.
  4583             20  CM-GROUPING-PREFIX        PIC X(3).
  4584             20  CM-GROUPING-PRIME         PIC X(3).
  4585         16  CM-STATE                      PIC XX.
  4586         16  CM-ACCOUNT.
  4587             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4588             20  CM-ACCOUNT-PRIME          PIC X(6).
  4589         16  CM-CERT-EFF-DT                PIC XX.
  4590         16  CM-CERT-NO.
  4591             20  CM-CERT-PRIME             PIC X(10).
  4592             20  CM-CERT-SFX               PIC X.
  4593
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  87
* EL154.cbl
  4594     12  CM-CONTROL-BY-NAME.
  4595         16  CM-COMPANY-CD-A1              PIC X.
  4596         16  CM-INSURED-LAST-NAME          PIC X(15).
  4597         16  CM-INSURED-INITIALS.
  4598             20  CM-INSURED-INITIAL1       PIC X.
  4599             20  CM-INSURED-INITIAL2       PIC X.
  4600
  4601     12  CM-CONTROL-BY-SSN.
  4602         16  CM-COMPANY-CD-A2              PIC X.
  4603         16  CM-SOC-SEC-NO.
  4604             20  CM-SSN-STATE              PIC XX.
  4605             20  CM-SSN-ACCOUNT            PIC X(6).
  4606             20  CM-SSN-LN3.
  4607                 25  CM-INSURED-INITIALS-A2.
  4608                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4609                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4610                 25 CM-PART-LAST-NAME-A2         PIC X.
  4611
  4612     12  CM-CONTROL-BY-CERT-NO.
  4613         16  CM-COMPANY-CD-A4              PIC X.
  4614         16  CM-CERT-NO-A4                 PIC X(11).
  4615
  4616     12  CM-CONTROL-BY-MEMB.
  4617         16  CM-COMPANY-CD-A5              PIC X.
  4618         16  CM-MEMBER-NO.
  4619             20  CM-MEMB-STATE             PIC XX.
  4620             20  CM-MEMB-ACCOUNT           PIC X(6).
  4621             20  CM-MEMB-LN4.
  4622                 25  CM-INSURED-INITIALS-A5.
  4623                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4624                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4625                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4626
  4627     12  CM-INSURED-PROFILE-DATA.
  4628         16  CM-INSURED-FIRST-NAME.
  4629             20  CM-INSURED-1ST-INIT       PIC X.
  4630             20  FILLER                    PIC X(9).
  4631         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4632         16  CM-INSURED-SEX                PIC X.
  4633             88  CM-SEX-MALE                  VALUE 'M'.
  4634             88  CM-SEX-FEMAL                 VALUE 'F'.
  4635         16  CM-INSURED-JOINT-AGE          PIC 99.
  4636         16  CM-JOINT-INSURED-NAME.
  4637             20  CM-JT-LAST-NAME           PIC X(15).
  4638             20  CM-JT-FIRST-NAME.
  4639                 24  CM-JT-1ST-INIT        PIC X.
  4640                 24  FILLER                PIC X(9).
  4641             20  CM-JT-INITIAL             PIC X.
  4642
  4643     12  CM-LIFE-DATA.
  4644         16  CM-LF-BENEFIT-CD              PIC XX.
  4645         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4646         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4647         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4648         16  CM-LF-DEV-CODE                PIC XXX.
  4649         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4650         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4651         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  88
* EL154.cbl
  4652         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4653         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4654         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4655         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4656         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4657         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4658         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4659         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4660         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4661         16  cm-temp-epiq                  pic xx.
  4662             88  EPIQ-CLASS                  value 'EQ'.
  4663*        16  FILLER                        PIC XX.
  4664
  4665     12  CM-AH-DATA.
  4666         16  CM-AH-BENEFIT-CD              PIC XX.
  4667         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4668         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4669         16  CM-AH-DEV-CODE                PIC XXX.
  4670         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4671         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4672         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4673         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4674         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4675         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4676         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4677         16  CM-AH-PAID-THRU-DT            PIC XX.
  4678             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4679         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4680         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4681         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4682         16  FILLER                        PIC X.
  4683
  4684     12  CM-LOAN-INFORMATION.
  4685         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4686         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4687                                           PIC S9(5)V99  COMP-3.
  4688         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4689         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4690         16  CM-PAY-FREQUENCY              PIC S99.
  4691         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4692         16  CM-RATE-CLASS                 PIC XX.
  4693         16  CM-BENEFICIARY                PIC X(25).
  4694         16  CM-POLICY-FORM-NO             PIC X(12).
  4695         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4696         16  CM-LAST-ADD-ON-DT             PIC XX.
  4697         16  CM-DEDUCTIBLE-AMOUNTS.
  4698             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4699             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4700         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4701             20  CM-RESIDENT-STATE         PIC XX.
  4702             20  CM-RATE-CODE              PIC X(4).
  4703             20  FILLER                    PIC XX.
  4704         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4705             20  CM-LOAN-OFFICER           PIC X(5).
  4706             20  FILLER                    PIC XXX.
  4707         16  CM-CSR-CODE                   PIC XXX.
  4708         16  CM-UNDERWRITING-CODE          PIC X.
  4709             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  89
* EL154.cbl
  4710         16  CM-POST-CARD-IND              PIC X.
  4711         16  CM-NH-INTERFACE-SW            PIC X.
  4712         16  CM-PREMIUM-TYPE               PIC X.
  4713             88  CM-SING-PRM                  VALUE '1'.
  4714             88  CM-O-B-COVERAGE              VALUE '2'.
  4715             88  CM-OPEN-END                  VALUE '3'.
  4716         16  CM-IND-GRP-TYPE               PIC X.
  4717             88  CM-INDIVIDUAL                VALUE 'I'.
  4718             88  CM-GROUP                     VALUE 'G'.
  4719         16  CM-SKIP-CODE                  PIC X.
  4720             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4721             88  SKIP-JULY                    VALUE '1'.
  4722             88  SKIP-AUGUST                  VALUE '2'.
  4723             88  SKIP-SEPTEMBER               VALUE '3'.
  4724             88  SKIP-JULY-AUG                VALUE '4'.
  4725             88  SKIP-AUG-SEPT                VALUE '5'.
  4726             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4727             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4728             88  SKIP-JUNE                    VALUE '8'.
  4729             88  SKIP-JUNE-JULY               VALUE '9'.
  4730             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4731             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4732         16  CM-PAYMENT-MODE               PIC X.
  4733             88  PAY-MONTHLY                  VALUE SPACE.
  4734             88  PAY-WEEKLY                   VALUE '1'.
  4735             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4736             88  PAY-BI-WEEKLY                VALUE '3'.
  4737             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4738         16  CM-LOAN-NUMBER                PIC X(8).
  4739         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4740         16  CM-OLD-LOF                    PIC XXX.
  4741*        16  CM-LOAN-OFFICER               PIC XXX.
  4742         16  CM-REIN-TABLE                 PIC XXX.
  4743         16  CM-SPECIAL-REIN-CODE          PIC X.
  4744         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4745         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4746         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4747
  4748     12  CM-STATUS-DATA.
  4749         16  CM-ENTRY-STATUS               PIC X.
  4750         16  CM-ENTRY-DT                   PIC XX.
  4751
  4752         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4753         16  CM-LF-CANCEL-DT               PIC XX.
  4754         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4755
  4756         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4757         16  CM-LF-DEATH-DT                PIC XX.
  4758         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4759
  4760         16  CM-LF-CURRENT-STATUS          PIC X.
  4761             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4762                                                'M' '4' '5' '9'.
  4763             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4764             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4765             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4766             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4767             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  90
* EL154.cbl
  4768             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4769             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4770             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4771             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4772             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4773             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4774             88  CM-LF-DECLINED               VALUE 'D'.
  4775             88  CM-LF-VOIDED                 VALUE 'V'.
  4776
  4777         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4778         16  CM-AH-CANCEL-DT               PIC XX.
  4779         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4780
  4781         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4782         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4783         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4784
  4785         16  CM-AH-CURRENT-STATUS          PIC X.
  4786             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4787                                                'M' '4' '5' '9'.
  4788             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4789             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4790             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4791             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4792             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4793             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4794             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4795             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4796             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4797             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4798             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4799             88  CM-AH-DECLINED               VALUE 'D'.
  4800             88  CM-AH-VOIDED                 VALUE 'V'.
  4801
  4802         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4803             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4804             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4805             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4806         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4807
  4808         16  CM-ENTRY-BATCH                PIC X(6).
  4809         16  CM-LF-EXIT-BATCH              PIC X(6).
  4810         16  CM-AH-EXIT-BATCH              PIC X(6).
  4811         16  CM-LAST-MONTH-END             PIC XX.
  4812
  4813     12  CM-NOTE-SW                        PIC X.
  4814         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4815         88  CERT-NOTES-PRESENT               VALUE '1'.
  4816         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4817         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4818         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4819         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4820         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4821         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4822     12  CM-COMP-EXCP-SW                   PIC X.
  4823         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4824         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4825     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  91
* EL154.cbl
  4826         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4827         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4828
  4829*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4830     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4831     12  FILLER                            PIC X.
  4832
  4833*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4834     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4835     12  FILLER                            PIC X.
  4836*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4837     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4838
  4839     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4840         88  CERT-ADDED-BATCH                 VALUE ' '.
  4841         88  CERT-ADDED-ONLINE                VALUE '1'.
  4842         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4843         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4844         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4845     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4846         88  CERT-AS-LOADED                   VALUE ' '.
  4847         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4848         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4849         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4850         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4851         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4852         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4853         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4854
  4855     12  CM-ACCOUNT-COMM-PCTS.
  4856         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4857         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4858
  4859     12  CM-USER-FIELD                     PIC X.
  4860     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4861     12  CM-CLP-STATE                      PIC XX.
  4862     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4863     12  CM-USER-RESERVED                  PIC XXX.
  4864     12  FILLER REDEFINES CM-USER-RESERVED.
  4865         16  CM-AH-CLASS-CD                PIC XX.
  4866         16  F                             PIC X.
  4867******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  92
* EL154.cbl
  4869*                            COPY ELCBENE.
  4870******************************************************************
  4871*                                                                *
  4872*                            ELCBENE.                            *
  4873*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4874*                            VMOD=2.006                          *
  4875*                                                                *
  4876*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  4877*                                                                *
  4878*   FILE TYPE = VSAM,KSDS                                        *
  4879*   RECORD SIZE = 500   RECFORM = FIX                            *
  4880*                                                                *
  4881*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  4882*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  4883*                                                                *
  4884*   LOG = YES                                                    *
  4885*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4886*                                                                *
  4887*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  4888******************************************************************
  4889
  4890 01  BENEFICIARY-MASTER.
  4891     12  BE-RECORD-ID                PIC XX.
  4892         88  VALID-BE-ID                VALUE 'BE'.
  4893
  4894     12  BE-CONTROL-PRIMARY.
  4895         16  BE-COMPANY-CD           PIC X.
  4896         16  BE-RECORD-TYPE          PIC X.
  4897             88  BENEFICIARY-RECORD  VALUE 'B'.
  4898             88  ADJUSTOR-RECORD     VALUE 'A'.
  4899         16  BE-BENEFICIARY          PIC X(10).
  4900     12  BE-CONTROL-BY-NAME.
  4901         16  BE-COMPANY-CD-A1        PIC X.
  4902         16  BE-RECORD-TYPE-A1       PIC X.
  4903         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  4904         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  4905
  4906     12  BE-LAST-MAINT-DT            PIC XX.
  4907     12  BE-LAST-MAINT-BY            PIC X(4).
  4908     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4909
  4910     12  BE-ADDRESS-DATA.
  4911         16  BE-MAIL-TO-NAME         PIC X(30).
  4912         16  BE-ADDRESS-LINE-1       PIC X(30).
  4913         16  BE-ADDRESS-LINE-2       PIC X(30).
  4914         16  BE-ADDRESS-LINE-3       PIC X(30).
  4915         16  BE-CITY-STATE.
  4916             20  BE-CITY             PIC X(28).
  4917             20  BE-STATE            PIC XX.
  4918         16  BE-ZIP-CODE.
  4919             20  BE-ZIP-PRIME.
  4920                 24  BE-ZIP-1ST      PIC X.
  4921                     88  BE-CANADIAN-POST-CODE
  4922                                         VALUE 'A' THRU 'Z'.
  4923                 24  FILLER          PIC X(4).
  4924             20  BE-ZIP-PLUS4        PIC X(4).
  4925         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  4926             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  93
* EL154.cbl
  4927             20  BE-CAN-POSTAL-2     PIC XXX.
  4928             20  FILLER              PIC XXX.
  4929         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  4930         16  BE-GROUP-CHECKS-Y-N     PIC X.
  4931
  4932******************************************************************
  4933*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  4934*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  4935******************************************************************
  4936     12  BE-CARRIER                  PIC X.
  4937
  4938     12  BE-ADDRESS-DATA2.
  4939         16  BE-MAIL-TO-NAME2        PIC X(30).
  4940         16  BE-ADDRESS-LINE-12      PIC X(30).
  4941         16  BE-ADDRESS-LINE-22      PIC X(30).
  4942         16  BE-ADDRESS-LINE-32      PIC X(30).
  4943         16  BE-CITY-STATE2.
  4944             20  BE-CITY2            PIC X(28).
  4945             20  BE-STATE2           PIC XX.
  4946         16  BE-ZIP-CODE2.
  4947             20  BE-ZIP-PRIME2.
  4948                 24  BE-ZIP-1ST2     PIC X.
  4949                     88  BE-CANADIAN-POST-CODE2
  4950                                         VALUE 'A' THRU 'Z'.
  4951                 24  FILLER          PIC X(4).
  4952             20  BE-ZIP-PLUS42       PIC X(4).
  4953         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  4954             20  BE-CAN-POSTAL-12    PIC XXX.
  4955             20  BE-CAN-POSTAL-22    PIC XXX.
  4956             20  FILLER              PIC XXX.
  4957         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  4958         16  BE-BILLING-STMT-DATA.
  4959             20  BE-BSR              PIC X.
  4960                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  4961                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  4962             20  BE-BSR-FROM         PIC X(30).
  4963             20  BE-BSR-DEPT         PIC X(30).
  4964             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  4965             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  4966             20  BE-OUTPUT-TYPE      PIC X.
  4967                 88  BE-FAX-OUTPUT         VALUE 'F'.
  4968                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  4969
  4970     12  FILLER                      PIC X(28).
  4971******************************************************************
  4972*                            COPY ERCACCT.
  4973******************************************************************
  4974*                                                                *
  4975*                                                                *
  4976*                            ERCACCT                             *
  4977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4978*                            VMOD=2.031                          *
  4979*                                                                *
  4980*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4981*                                                                *
  4982*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4983*   VSAM ACCOUNT MASTER FILES.                                   *
  4984*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  94
* EL154.cbl
  4985*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4986*                                                                *
  4987*   FILE TYPE = VSAM,KSDS                                        *
  4988*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4989*                                                                *
  4990*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4991*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4992*                                                                *
  4993*   LOG = NO                                                     *
  4994*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4995*                                                                *
  4996*                                                                *
  4997******************************************************************
  4998*                   C H A N G E   L O G
  4999*
  5000* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5001*-----------------------------------------------------------------
  5002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5003* EFFECTIVE    NUMBER
  5004*-----------------------------------------------------------------
  5005* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5006* 092705    2005050300006  PEMA  ADD SPP LEASES
  5007* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5008* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5009* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5010* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5011* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5012******************************************************************
  5013
  5014 01  ACCOUNT-MASTER.
  5015     12  AM-RECORD-ID                      PIC XX.
  5016         88  VALID-AM-ID                      VALUE 'AM'.
  5017
  5018     12  AM-CONTROL-PRIMARY.
  5019         16  AM-COMPANY-CD                 PIC X.
  5020         16  AM-MSTR-CNTRL.
  5021             20  AM-CONTROL-A.
  5022                 24  AM-CARRIER            PIC X.
  5023                 24  AM-GROUPING.
  5024                     28 AM-GROUPING-PREFIX PIC XXX.
  5025                     28 AM-GROUPING-PRIME  PIC XXX.
  5026                 24  AM-STATE              PIC XX.
  5027                 24  AM-ACCOUNT.
  5028                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5029                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5030             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5031                                           PIC X(19).
  5032             20  AM-CNTRL-B.
  5033                 24  AM-EXPIRATION-DT      PIC XX.
  5034                 24  FILLER                PIC X(4).
  5035             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5036                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5037
  5038     12  AM-CONTROL-BY-VAR-GRP.
  5039         16  AM-COMPANY-CD-A1              PIC X.
  5040         16  AM-VG-CARRIER                 PIC X.
  5041         16  AM-VG-GROUPING                PIC X(6).
  5042         16  AM-VG-STATE                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  95
* EL154.cbl
  5043         16  AM-VG-ACCOUNT                 PIC X(10).
  5044         16  AM-VG-DATE.
  5045             20  AM-VG-EXPIRATION-DT       PIC XX.
  5046             20  FILLER                    PIC X(4).
  5047         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5048                                           PIC 9(11)      COMP-3.
  5049     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5050         16  FILLER                        PIC X(10).
  5051         16  AM-VG-KEY3.
  5052             20  AM-VG3-ACCOUNT            PIC X(10).
  5053             20  AM-VG3-EXP-DT             PIC XX.
  5054         16  FILLER                        PIC X(4).
  5055     12  AM-MAINT-INFORMATION.
  5056         16  AM-LAST-MAINT-DT              PIC XX.
  5057         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5058         16  AM-LAST-MAINT-USER            PIC X(4).
  5059         16  FILLER                        PIC XX.
  5060
  5061     12  AM-EFFECTIVE-DT                   PIC XX.
  5062     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5063
  5064     12  AM-PREV-DATES  COMP-3.
  5065         16  AM-PREV-EXP-DT                PIC 9(11).
  5066         16  AM-PREV-EFF-DT                PIC 9(11).
  5067
  5068     12  AM-REPORT-CODE-1                  PIC X(10).
  5069     12  AM-REPORT-CODE-2                  PIC X(10).
  5070
  5071     12  AM-CITY-CODE                      PIC X(4).
  5072     12  AM-COUNTY-PARISH                  PIC X(6).
  5073
  5074     12  AM-NAME                           PIC X(30).
  5075     12  AM-PERSON                         PIC X(30).
  5076     12  AM-ADDRS                          PIC X(30).
  5077     12  AM-CITY.
  5078         16  AM-ADDR-CITY                  PIC X(28).
  5079         16  AM-ADDR-STATE                 PIC XX.
  5080     12  AM-ZIP.
  5081         16  AM-ZIP-PRIME.
  5082             20  AM-ZIP-PRI-1ST            PIC X.
  5083                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5084             20  FILLER                    PIC X(4).
  5085         16  AM-ZIP-PLUS4                  PIC X(4).
  5086     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5087         16  AM-CAN-POSTAL-1               PIC XXX.
  5088         16  AM-CAN-POSTAL-2               PIC XXX.
  5089         16  FILLER                        PIC XXX.
  5090     12  AM-TEL-NO.
  5091         16  AM-AREA-CODE                  PIC 999.
  5092         16  AM-TEL-PRE                    PIC 999.
  5093         16  AM-TEL-NBR                    PIC 9(4).
  5094     12  AM-TEL-LOC                        PIC X.
  5095         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5096         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5097
  5098     12  AM-COMM-STRUCTURE.
  5099         16  AM-DEFN-1.
  5100             20  AM-AGT-COMMS       OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  96
* EL154.cbl
  5101                 24  AM-AGT.
  5102                     28  AM-AGT-PREFIX     PIC X(4).
  5103                     28  AM-AGT-PRIME      PIC X(6).
  5104                 24  AM-COM-TYP            PIC X.
  5105                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5106                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5107                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5108                 24  AM-RECALC-LV-INDIC    PIC X.
  5109                 24  AM-RETRO-LV-INDIC     PIC X.
  5110                 24  AM-GL-CODES           PIC X.
  5111                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5112                 24  FILLER                PIC X(01).
  5113         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5114             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5115                 24  FILLER                PIC X(11).
  5116                 24  AM-L-COMA             PIC XXX.
  5117                 24  AM-J-COMA             PIC XXX.
  5118                 24  AM-A-COMA             PIC XXX.
  5119                 24  FILLER                PIC X(6).
  5120
  5121     12  AM-COMM-CHANGE-STATUS             PIC X.
  5122         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5123
  5124     12  AM-CSR-CODE                       PIC X(4).
  5125
  5126     12  AM-BILLING-STATUS                 PIC X.
  5127         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5128         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5129     12  AM-AUTO-REFUND-SW                 PIC X.
  5130         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5131         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5132     12  AM-GPCD                           PIC 99.
  5133     12  AM-IG                             PIC X.
  5134         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5135         88  AM-HAS-GROUP                     VALUE '2'.
  5136     12  AM-STATUS                         PIC X.
  5137         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5138         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5139         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5140         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5141         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5142         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5143     12  AM-REMIT-TO                       PIC 99.
  5144     12  AM-ID-NO                          PIC X(11).
  5145
  5146     12  AM-CAL-TABLE                      PIC XX.
  5147     12  AM-LF-DEVIATION                   PIC XXX.
  5148     12  AM-AH-DEVIATION                   PIC XXX.
  5149     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5150     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5151     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5152     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5153     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5154     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5155
  5156     12  AM-USER-FIELDS.
  5157         16  AM-FLD-1                      PIC XX.
  5158         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  97
* EL154.cbl
  5159         16  AM-FLD-3                      PIC XX.
  5160         16  AM-FLD-4                      PIC XX.
  5161         16  AM-FLD-5                      PIC XX.
  5162
  5163     12  AM-1ST-PROD-DATE.
  5164         16  AM-1ST-PROD-YR                PIC XX.
  5165         16  AM-1ST-PROD-MO                PIC XX.
  5166         16  AM-1ST-PROD-DA                PIC XX.
  5167     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5168     12  AM-CERTS-PURGED-DATE.
  5169         16  AM-PUR-YR                     PIC XX.
  5170         16  AM-PUR-MO                     PIC XX.
  5171         16  AM-PUR-DA                     PIC XX.
  5172     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5173     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5174     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5175     12  AM-INACTIVE-DATE.
  5176         16  AM-INA-MO                     PIC 99.
  5177         16  AM-INA-DA                     PIC 99.
  5178         16  AM-INA-YR                     PIC 99.
  5179     12  AM-AR-HI-CERT-DATE                PIC XX.
  5180
  5181     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5182     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5183
  5184     12  AM-OB-PAYMENT-MODE                PIC X.
  5185         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5186         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5187         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5188         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5189
  5190     12  AM-AH-ONLY-INDICATOR              PIC X.
  5191         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5192         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5193
  5194     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5195
  5196     12  AM-OVER-SHORT.
  5197         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5198         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5199
  5200     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5201     12  AM-DCC-CLP-STATE                  PIC XX.
  5202
  5203     12  AM-RECALC-COMM                    PIC X.
  5204     12  AM-RECALC-REIN                    PIC X.
  5205
  5206     12  AM-REI-TABLE                      PIC XXX.
  5207     12  AM-REI-ET-LF                      PIC X.
  5208     12  AM-REI-ET-AH                      PIC X.
  5209     12  AM-REI-PE-LF                      PIC X.
  5210     12  AM-REI-PE-AH                      PIC X.
  5211     12  AM-REI-PRT-ST                     PIC X.
  5212     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5213     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5214     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5215     12  AM-REI-GROUP-A                    PIC X(6).
  5216     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  98
* EL154.cbl
  5217     12  AM-REI-PRT-OW                     PIC X.
  5218     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5219     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5220     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5221     12  AM-REI-GROUP-B                    PIC X(6).
  5222
  5223     12  AM-TRUST-TYPE                     PIC X(2).
  5224
  5225     12  AM-EMPLOYER-STMT-USED             PIC X.
  5226     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5227
  5228     12  AM-STD-AH-TYPE                    PIC XX.
  5229     12  AM-EARN-METHODS.
  5230         16  AM-EARN-METHOD-R              PIC X.
  5231             88 AM-REF-RL-R78                 VALUE 'R'.
  5232             88 AM-REF-RL-PR                  VALUE 'P'.
  5233             88 AM-REF-RL-MEAN                VALUE 'M'.
  5234             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5235         16  AM-EARN-METHOD-L              PIC X.
  5236             88 AM-REF-LL-R78                 VALUE 'R'.
  5237             88 AM-REF-LL-PR                  VALUE 'P'.
  5238             88 AM-REF-LL-MEAN                VALUE 'M'.
  5239             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5240         16  AM-EARN-METHOD-A              PIC X.
  5241             88 AM-REF-AH-R78                 VALUE 'R'.
  5242             88 AM-REF-AH-PR                  VALUE 'P'.
  5243             88 AM-REF-AH-MEAN                VALUE 'M'.
  5244             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5245             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5246             88 AM-REF-AH-NET                 VALUE 'N'.
  5247
  5248     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5249     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5250     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5251
  5252     12  AM-RET-Y-N                        PIC X.
  5253     12  AM-RET-P-E                        PIC X.
  5254     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5255     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5256     12  AM-RET-GRP                        PIC X(6).
  5257     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5258         16  AM-POOL-PRIME                 PIC XXX.
  5259         16  AM-POOL-SUB                   PIC XXX.
  5260     12  AM-RETRO-EARNINGS.
  5261         16  AM-RET-EARN-R                 PIC X.
  5262         16  AM-RET-EARN-L                 PIC X.
  5263         16  AM-RET-EARN-A                 PIC X.
  5264     12  AM-RET-ST-TAX-USE                 PIC X.
  5265         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5266         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5267     12  AM-RETRO-BEG-EARNINGS.
  5268         16  AM-RET-BEG-EARN-R             PIC X.
  5269         16  AM-RET-BEG-EARN-L             PIC X.
  5270         16  AM-RET-BEG-EARN-A             PIC X.
  5271     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5272     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5273
  5274     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page  99
* EL154.cbl
  5275         16  AM-USER-SELECT-1              PIC X(10).
  5276         16  AM-USER-SELECT-2              PIC X(10).
  5277         16  AM-USER-SELECT-3              PIC X(10).
  5278         16  AM-USER-SELECT-4              PIC X(10).
  5279         16  AM-USER-SELECT-5              PIC X(10).
  5280
  5281     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5282
  5283     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5284
  5285     12  AM-RPT045A-SWITCH                 PIC X.
  5286         88  RPT045A-OFF                   VALUE 'N'.
  5287
  5288     12  AM-INSURANCE-LIMITS.
  5289         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5290         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5291
  5292     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5293         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5294
  5295     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5296         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5297         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5298
  5299     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5300
  5301     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5302     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5303     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5304     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5305     12  AM-DCC-UEF-STATE                  PIC XX.
  5306     12  FILLER                            PIC XXX.
  5307     12  AM-REPORT-CODE-3                  PIC X(10).
  5308*    12  FILLER                            PIC X(22).
  5309
  5310     12  AM-RESERVE-DATE.
  5311         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5312         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5313         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5314
  5315     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5316     12  AM-NOTIFICATION-TYPES.
  5317         16  AM-NOTIF-OF-LETTERS           PIC X.
  5318         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5319         16  AM-NOTIF-OF-REPORTS           PIC X.
  5320         16  AM-NOTIF-OF-STATUS            PIC X.
  5321
  5322     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5323         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5324         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5325         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5326         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5327
  5328     12  AM-BENEFIT-CONTROLS.
  5329         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5330             20  AM-BENEFIT-CODE           PIC XX.
  5331             20  AM-BENEFIT-TYPE           PIC X.
  5332             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 100
* EL154.cbl
  5333             20  AM-BENEFIT-REM-TERM       PIC X.
  5334             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5335             20  FILLER                    PIC XX.
  5336         16  FILLER                        PIC X(80).
  5337
  5338     12  AM-TRANSFER-DATA.
  5339         16  AM-TRANSFERRED-FROM.
  5340             20  AM-TRNFROM-CARRIER        PIC X.
  5341             20  AM-TRNFROM-GROUPING.
  5342                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5343                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5344             20  AM-TRNFROM-STATE          PIC XX.
  5345             20  AM-TRNFROM-ACCOUNT.
  5346                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5347                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5348             20  AM-TRNFROM-DTE            PIC XX.
  5349         16  AM-TRANSFERRED-TO.
  5350             20  AM-TRNTO-CARRIER          PIC X.
  5351             20  AM-TRNTO-GROUPING.
  5352                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5353                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5354             20  AM-TRNTO-STATE            PIC XX.
  5355             20  AM-TRNTO-ACCOUNT.
  5356                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5357                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5358             20  AM-TRNTO-DTE              PIC XX.
  5359         16  FILLER                        PIC X(10).
  5360
  5361     12  AM-SAVED-REMIT-TO                 PIC 99.
  5362
  5363     12  AM-COMM-STRUCTURE-SAVED.
  5364         16  AM-DEFN-1-SAVED.
  5365             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5366                 24  AM-AGT-SV             PIC X(10).
  5367                 24  AM-COM-TYP-SV         PIC X.
  5368                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5369                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5370                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5371                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5372                 24  FILLER                PIC X.
  5373                 24  AM-GL-CODES-SV        PIC X.
  5374                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5375                 24  FILLER                PIC X.
  5376         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5377             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5378                 24  FILLER                PIC X(11).
  5379                 24  AM-L-COMA-SV          PIC XXX.
  5380                 24  AM-J-COMA-SV          PIC XXX.
  5381                 24  AM-A-COMA-SV          PIC XXX.
  5382                 24  FILLER                PIC X(6).
  5383
  5384     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5385         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5386            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5387            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5388            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5389
  5390     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 101
* EL154.cbl
  5391     12  FILLER                            PIC X(120).
  5392
  5393     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5394         16  AM-CONTROL-NAME               PIC X(30).
  5395         16  AM-EXECUTIVE-ONE.
  5396             20  AM-EXEC1-NAME             PIC X(15).
  5397             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5398                                                          COMP-3.
  5399             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5400                                                          COMP-3.
  5401         16  AM-EXECUTIVE-TWO.
  5402             20  AM-EXEC2-NAME             PIC X(15).
  5403             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5404                                                          COMP-3.
  5405             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5406                                                          COMP-3.
  5407
  5408     12  AM-RETRO-ADDITIONAL-DATA.
  5409         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5410         16  AM-RETRO-PREM-P-E             PIC X.
  5411         16  AM-RETRO-CLMS-P-I             PIC X.
  5412         16  AM-RETRO-RET-BRACKET-LF.
  5413             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5414                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5415                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5416             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5417                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5418                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5419             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5420                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5421                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5422         16  AM-RETRO-RET-BRACKET-AH.
  5423             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5424                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5425                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5426                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5427             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5428                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5429                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5430             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5431                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5432                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5433
  5434     12  AM-COMMENTS.
  5435         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5436
  5437     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5438         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5439         16  AM-FLI-BILLING-CODE           PIC X.
  5440         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5441         16  AM-FLI-UNITED-IDENT           PIC X.
  5442         16  AM-FLI-INTEREST-LOST-DATA.
  5443             20  AM-FLI-BANK-NO            PIC X(5).
  5444             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5445             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5446             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5447         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5448             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 102
* EL154.cbl
  5449             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5450             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5451         16  FILLER                        PIC X(102).
  5452
  5453     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5454         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5455             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5456             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5457             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5458             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5459             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5460         16  FILLER                          PIC X(10).
  5461******************************************************************
  5462*                            COPY ERCPDEF.
  5463******************************************************************
  5464*                                                                *
  5465*                                                                *
  5466*                            ERCPDEF.                            *
  5467*                                                                *
  5468*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5469*                                                                *
  5470*    FILE TYPE = VSAM,KSDS                                       *
  5471*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5472*                                                                *
  5473*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5474*                                                                *
  5475*    LOG = YES                                                   *
  5476*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5477******************************************************************
  5478*                   C H A N G E   L O G
  5479*
  5480* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5481*-----------------------------------------------------------------
  5482*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5483* EFFECTIVE    NUMBER
  5484*-----------------------------------------------------------------
  5485* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5486* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5487* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  5488******************************************************************
  5489 01  PRODUCT-MASTER.
  5490    12  PD-RECORD-ID                 PIC X(02).
  5491        88  VALID-PD-ID                  VALUE 'PD'.
  5492    12  PD-CONTROL-PRIMARY.
  5493        16  PD-COMPANY-CD            PIC X.
  5494        16  PD-STATE                 PIC XX.
  5495        16  PD-PRODUCT-CD            PIC XXX.
  5496        16  PD-FILLER                PIC X(7).
  5497        16  PD-BEN-TYPE              PIC X.
  5498        16  PD-BEN-CODE              PIC XX.
  5499        16  PD-PROD-EXP-DT           PIC XX.
  5500    12  FILLER                       PIC X(50).
  5501    12  PD-PRODUCT-DATA OCCURS 8.
  5502        16  PD-PROD-CODE             PIC X.
  5503            88  PD-PROD-LIFE           VALUE 'L'.
  5504            88  PD-PROD-PROP           VALUE 'P'.
  5505            88  PD-PROD-AH             VALUE 'A'.
  5506            88  PD-PROD-IU             VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 103
* EL154.cbl
  5507            88  PD-PROD-GAP            VALUE 'G'.
  5508            88  PD-PROD-FAML           VALUE 'F'.
  5509        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5510        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5511        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5512        16  PD-MAX-TERM              PIC S999        COMP-3.
  5513        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5514        16  FILLER                   PIC X.
  5515        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5516        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5517        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5518        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5519        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5520        16  PD-REC-CRIT-PERIOD       PIC 99.
  5521        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  5522            20  PD-RECURRING-YN      PIC X.
  5523            20  FILLER               PIC X.
  5524        16  PD-RTW-MOS               PIC 99.
  5525        16  PD-MAX-EXTENSION         PIC 99.
  5526        16  pd-ben-pct               pic sv999 comp-3.
  5527*       16  FILLER                   PIC XX.
  5528    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5529    12  PD-TERM-LIMITS OCCURS 15.
  5530        16  PD-LOW-TERM              PIC S999        COMP-3.
  5531        16  PD-HI-TERM               PIC S999        COMP-3.
  5532*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5533    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5534        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5535        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5536    12  PD-EARN-FACTORS.
  5537        16  FILLER OCCURS 15.
  5538            20  FILLER OCCURS 15.
  5539                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5540    12  PD-PRODUCT-DESC              PIC X(80).
  5541    12  PD-TRUNCATED                 PIC X.
  5542    12  FILLER                       PIC X(59).
  5543    12  PD-MAINT-INFORMATION.
  5544        16  PD-LAST-MAINT-DT         PIC X(02).
  5545        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5546        16  PD-LAST-MAINT-BY         PIC X(04).
  5547*                            copy ELCCRTT.
  5548******************************************************************
  5549*                                                                *
  5550*                            ELCCRTT.                            *
  5551*                                                                *
  5552*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5553*                                                                *
  5554*   FILE TYPE = VSAM,KSDS                                        *
  5555*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5556*                                                                *
  5557*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5558*                                                                *
  5559*   LOG = YES                                                    *
  5560*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5561******************************************************************
  5562*                   C H A N G E   L O G
  5563*
  5564* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 104
* EL154.cbl
  5565*-----------------------------------------------------------------
  5566*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5567* EFFECTIVE    NUMBER
  5568*-----------------------------------------------------------------
  5569* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5570* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5571* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5572* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5573* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5574* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5575* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5576* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5577******************************************************************
  5578
  5579 01  CERTIFICATE-TRAILERS.
  5580     12  CS-RECORD-ID                      PIC XX.
  5581         88  VALID-CS-ID                      VALUE 'CS'.
  5582
  5583     12  CS-CONTROL-PRIMARY.
  5584         16  CS-COMPANY-CD                 PIC X.
  5585         16  CS-CARRIER                    PIC X.
  5586         16  CS-GROUPING                   PIC X(6).
  5587         16  CS-STATE                      PIC XX.
  5588         16  CS-ACCOUNT                    PIC X(10).
  5589         16  CS-CERT-EFF-DT                PIC XX.
  5590         16  CS-CERT-NO.
  5591             20  CS-CERT-PRIME             PIC X(10).
  5592             20  CS-CERT-SFX               PIC X.
  5593         16  CS-TRAILER-TYPE               PIC X.
  5594             88  COMM-TRLR           VALUE 'A'.
  5595             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5596             88  CERT-DATA-TRLR      VALUE 'C'.
  5597
  5598     12  CS-DATA-AREA                      PIC X(516).
  5599
  5600     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5601         16  CS-BANK-COMMISSION-AREA.
  5602             20  CS-BANK-COMMS       OCCURS 10.
  5603                 24  CS-AGT                PIC X(10).
  5604                 24  CS-COM-TYP            PIC X.
  5605                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5606                 24  CS-RECALC-LV-INDIC    PIC X.
  5607                 24  FILLER                PIC X(10).
  5608         16  FILLER                        PIC X(256).
  5609
  5610     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5611****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5612         16  CS-MB-CLAIM-DATA OCCURS 24.
  5613             20  CS-CLAIM-NO               PIC X(7).
  5614             20  CS-CLAIM-TYPE             PIC X.
  5615                 88  CS-AH-CLM               VALUE 'A'.
  5616                 88  CS-IU-CLM               VALUE 'I'.
  5617                 88  CS-GP-CLM               VALUE 'G'.
  5618                 88  CS-LF-CLM               VALUE 'L'.
  5619                 88  CS-PR-CLM               VALUE 'P'.
  5620                 88  CS-FL-CLM               VALUE 'F'.
  5621             20  CS-INSURED-TYPE           PIC X.
  5622                 88  CS-PRIM-INSURED          VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 105
* EL154.cbl
  5623                 88  CS-CO-BORROWER           VALUE 'C'.
  5624             20  CS-BENEFIT-PERIOD         PIC 99.
  5625             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5626             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5627             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5628         16  FILLER                        PIC X(12).
  5629     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5630         16  CS-VIN-NUMBER                 PIC X(17).
  5631         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5632         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5633         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5634         16  cs-agent-name.
  5635             20  cs-agent-fname            pic x(20).
  5636             20  cs-agent-mi               pic x.
  5637             20  cs-agent-lname            pic x(25).
  5638         16  cs-license-no                 pic x(15).
  5639         16  cs-npn-number                 pic x(10).
  5640         16  cs-agent-edit-status          pic x.
  5641             88  cs-ae-refer-to-manager      value 'M'.
  5642             88  cs-ae-cover-sheet           value 'C'.
  5643             88  cs-ae-sig-form              value 'S'.
  5644             88  cs-ae-verified              value 'V'.
  5645             88  cs-unidentified-signature   value 'U'.
  5646             88  cs-cert-returned            value 'R'.
  5647             88  cs-accept-no-commission     value 'N'.
  5648         16  FILLER                        PIC X(424).
  5649*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 106
* EL154.cbl
  5651*                            COPY MPCPLCY.
  5652******************************************************************
  5653*                                                                *
  5654*                           MPCPLCY                              *
  5655*                            VMOD=1.024                          *
  5656*                                                                *
  5657*   FILE DESCRIPTION = POLICY MASTER                             *
  5658*                                                                *
  5659*   FILE TYPE = VSAM,KSDS                                        *
  5660*   RECORD SIZE = 1200 RECFORM = FIXED                           *
  5661*                                                                *
  5662*   BASE CLUSTER = MPPLCY                         RKP=2,LEN=42   *
  5663*       ALTERNATE PATH2 = ** NOT USED **                         *
  5664*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5665*       ALTERNATE PATH4 = MPPLCY4 (BY REF. NO.)   RKP=60,LEN=25  *
  5666*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT )   RKP=85,LEN=27  *
  5667*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT )   RKP=112,LEN=15 *
  5668*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO.)   RKP=127,LEN=27 *
  5669*                                                                *
  5670*   LOG = YES                                                    *
  5671*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5672******************************************************************
  5673**WARNING*********************************************************
  5674**ANY CHANGES TO THIS COPY BOOK MAY NEED CORRESPONDING CHANGES****
  5675**TO THE FOLLOWING COPY BOOKS: MPCPOLUP                          *
  5676**                             MPCPHSTD                          *
  5677**                             MPCPHSTC                          *
  5678**                             MPCPHSTT                          *
  5679**                                                               *
  5680******************************************************************
  5681
  5682 01  POLICY-MASTER.
  5683     12  PM-RECORD-ID                      PIC XX.
  5684         88  VALID-PM-ID                      VALUE 'PM'.
  5685
  5686******************************************************************
  5687*   BASE CLUSTER = MPPLCY         (BASE KEY)      RKP=2,LEN=42   *
  5688******************************************************************
  5689
  5690     12  PM-CONTROL-PRIMARY.
  5691         16  PM-PRODUCER-PRIMARY.
  5692             20  PM-PROD-PRIMARY.
  5693                 24  PM-COMPANY-CD         PIC X.
  5694                 24  PM-CGSP-KEY.
  5695                     28  PM-CARRIER        PIC X.
  5696                     28  PM-GROUPING.
  5697                         32  PM-GROUPING-PREFIX
  5698                                           PIC X(3).
  5699                         32  PM-GROUPING-PRIME
  5700                                           PIC X(3).
  5701                     28  PM-STATE          PIC X(2).
  5702                     28  PM-PRODUCER.
  5703                         32  PM-PRODUCER-PREFIX
  5704                                           PIC X(4).
  5705                         32  PM-PRODUCER-PRIME
  5706                                           PIC X(6).
  5707             20  PM-POLICY-EFF-DT              PIC XX.
  5708         16  PM-REFERENCE-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 107
* EL154.cbl
  5709             20  PM-REFNO-PRIME            PIC X(18).
  5710             20  PM-REFNO-SFX              PIC XX.
  5711
  5712******************************************************************
  5713*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5714******************************************************************
  5715
  5716     12  PM-CONTROL-BY-SSN.
  5717         16  PM-COMPANY-CD-A3              PIC X.
  5718         16  PM-SOC-SEC-NO.
  5719             20  PM-SSN-STATE              PIC XX.
  5720             20  PM-SSN-PRODUCER           PIC X(6).
  5721             20  PM-SSN-LN3.
  5722                 25  PM-INSURED-INITIALS-A3.
  5723                     30 PM-INSURED-INITIAL1-A3 PIC X.
  5724                     30 PM-INSURED-INITIAL2-A3 PIC X.
  5725                 25 PM-PART-LAST-NAME-A3         PIC X.
  5726         16  PM-DATE-A3                     PIC XX.
  5727         16  PM-TIME-A3                     PIC S9(04)   COMP.
  5728
  5729******************************************************************
  5730*       ALTERNATE PATH4 = MPPLCY4 (BY REFRENCE)   RKP=60,LEN=25  *
  5731******************************************************************
  5732
  5733     12  PM-CONTROL-BY-POLICY-NO.
  5734         16  PM-COMPANY-CD-A4              PIC X.
  5735         16  PM-POLICY-NO-A4.
  5736             20  PM-POLICY-PRIME-A4        PIC X(18).
  5737             20  PM-POLICY-SFX-A4          PIC XX.
  5738         16  PM-DATE-A4                    PIC XX.
  5739         16  PM-TIME-A4                    PIC S9(04)   COMP.
  5740
  5741******************************************************************
  5742*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT NO) RKP=85,LEN=27  *
  5743******************************************************************
  5744
  5745     12  PM-CONTROL-BY-ACCOUNT.
  5746         16  PM-COMPANY-CD-A5              PIC X.
  5747         16  PM-BANK-ACCOUNT-NUMBER        PIC X(20).
  5748         16  PM-DATE-A5                    PIC XX.
  5749         16  PM-TIME-A5                    PIC S9(07)   COMP.
  5750
  5751******************************************************************
  5752*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT NO) RKP=112,LEN=15 *
  5753******************************************************************
  5754
  5755     12  PM-CONTROL-BY-TRANSIT.
  5756         16  PM-COMPANY-CD-A6              PIC X.
  5757         16  PM-BANK-TRANSIT-NUMBER.
  5758             20  PM-FEDERAL-NUMBER         PIC X(4).
  5759             20  PM-BANK-NUMBER            PIC X(4).
  5760         16  PM-DATE-A6                    PIC XX.
  5761         16  PM-TIME-A6                    PIC S9(07)   COMP.
  5762
  5763******************************************************************
  5764*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO)    RKP=127,LEN=27 *
  5765******************************************************************
  5766
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 108
* EL154.cbl
  5767     12  PM-CONTROL-BY-LOAN-NO.
  5768         16  PM-COMPANY-CD-A7              PIC X.
  5769         16  PM-LOAN-NUMBER                PIC X(20).
  5770         16  PM-DATE-A7                    PIC XX.
  5771         16  PM-TIME-A7                    PIC S9(07)   COMP.
  5772
  5773******************************************************************
  5774*                 FILE SYNCHRONIZATION DATA                      *
  5775******************************************************************
  5776
  5777     12  FILLER                            PIC X(05).
  5778     12  PM-FILE-SYNCH-DATA.
  5779         16  PM-LAST-CHANGE-DT             PIC XX.
  5780         16  PM-LAST-CHANGE-TIME           PIC S9(7)    COMP.
  5781         16  PM-LAST-CHANGE-PROCESSOR      PIC X(4).
  5782     12  FILLER                            PIC X(05).
  5783
  5784******************************************************************
  5785*                    INSUREDS PROFILE DATA                       *
  5786******************************************************************
  5787
  5788     12  PM-INSURED-PROFILE-DATA.
  5789         16  PM-INSURED-NAME.
  5790             20  PM-INSURED-LAST-NAME     PIC X(15).
  5791             20  PM-INSURED-FIRST-NAME.
  5792                 24  PM-INSURED-1ST-INIT PIC X.
  5793                 24  FILLER               PIC X(9).
  5794             20  PM-INSURED-MIDDLE-INIT PIC X.
  5795         16  PM-INSURED-ADDRESS.
  5796             20  PM-ADDRESS-LINE-1         PIC X(30).
  5797             20  PM-ADDRESS-LINE-2         PIC X(30).
  5798             20  PM-CITY                   PIC X(25).
  5799             20  PM-RESIDENT-STATE         PIC XX.
  5800             20  PM-ZIP-CD.
  5801                 24  PM-ZIP-FIRST-FIVE     PIC X(5).
  5802                 24  PM-ZIP-PLUS-FOUR      PIC X(4).
  5803         16  PM-INSURED-PERSONAL.
  5804             20  PM-INSURED-OCC-CLASS      PIC X.
  5805                 88  PM-PREFERRED            VALUE '1'.
  5806                 88  PM-STANDARD             VALUE '2'.
  5807                 88  PM-HAZARDOUS            VALUE '3'.
  5808                 88  PM-VERY-HAZARDOUS       VALUE '4'.
  5809                 88  PM-EXTREME-HAZARDOUS VALUE '5'.
  5810                 88  PM-NOT-OCC              VALUE '6'.
  5811                 88  PM-OCC-UNKNOWN          VALUE '9'.
  5812             20  PM-INSURED-OCC-CD         PIC X(3).
  5813             20  PM-INSURED-OCC-CD-NUM REDEFINES
  5814                 PM-INSURED-OCC-CD         PIC 9(3).
  5815             20  PM-INSURED-SEX            PIC X.
  5816                 88  PM-INSURED-SEX-MALE      VALUE 'M'.
  5817                 88  PM-INSURED-SEX-FEMALE VALUE 'F'.
  5818             20  PM-INSURED-BIRTH-DT       PIC XX.
  5819             20  PM-INSURED-ISSUE-AGE      PIC S9(3)     COMP-3.
  5820             20  PM-INSURED-HEIGHT-FT      PIC S9(3)     COMP-3.
  5821             20  PM-INSURED-HEIGHT-IN      PIC S9(3)     COMP-3.
  5822             20  PM-INSURED-WEIGHT         PIC S9(3)     COMP-3.
  5823             20  PM-INSURED-BIRTH-STATE PIC XX.
  5824             20  PM-INSURED-PHONE-NO       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 109
* EL154.cbl
  5825             20  PM-INSURED-RATED-AGE      PIC S9(3)     COMP-3.
  5826         16  PM-INS-LANGUAGE-IND           PIC X(01).
  5827             88  PM-ENGLISH                           VALUE 'E'.
  5828             88  PM-FRENCH                            VALUE 'F'.
  5829             88  PM-SPANISH                           VALUE 'S'.
  5830         16  PM-INSURED-TOT-BENEFIT        PIC S9(7)V99  COMP-3.
  5831
  5832         16  PM-INSURED-AGE-IND            PIC X(01).
  5833             88  PM-INSURED-AGE-75-REACHED            VALUE 'Y'.
  5834     12  FILLER                            PIC X(13).
  5835
  5836******************************************************************
  5837*                JOINT INSUREDS PROFILE DATA                     *
  5838******************************************************************
  5839
  5840     12  PM-JOINT-PROFILE-DATA.
  5841         16  PM-JOINT-NAME.
  5842             20  PM-JOINT-LAST-NAME        PIC X(15).
  5843             20  PM-JOINT-FIRST-NAME.
  5844                 24  PM-JOINT-1ST-INIT     PIC X.
  5845                 24  FILLER                PIC X(9).
  5846             20  PM-JOINT-MIDDLE-INIT      PIC X.
  5847         16  PM-JOINT-SOC-SEC-NO.
  5848             20  PM-JT-SSN-STATE           PIC XX.
  5849             20  PM-JT-SSN-PRODUCER        PIC X(6).
  5850             20  PM-JT-SSN-LN3.
  5851                 25  PM-JT-INSURED-INITIALS-A3.
  5852                     30 PM-JT-INSURED-INITIAL1-A3 PIC X.
  5853                     30 PM-JT-INSURED-INITIAL2-A3 PIC X.
  5854                 25 PM-JT-PART-LAST-NAME-A3        PIC X.
  5855         16  PM-JOINT-PERSONAL.
  5856             20  PM-JOINT-OCC-CLASS        PIC X.
  5857                 88 PM-JNT-PREFERRED          VALUE '1'.
  5858                 88 PM-JNT-STANDARD           VALUE '2'.
  5859                 88 PM-JNT-HAZARDOUS          VALUE '3'.
  5860                 88 PM-JNT-VERY-HAZARDOUS     VALUE '4'.
  5861                 88 PM-JNT-EXTREME-HAZARDOUS VALUE '5'.
  5862                 88 PM-JNT-NOT-OCC            VALUE '6'.
  5863                 88 PM-JNT-OCC-UNKNOWN        VALUE '9'.
  5864             20  PM-JOINT-OCC-CD           PIC X(3).
  5865             20  PM-JOINT-SEX              PIC X.
  5866                 88  PM-JOINT-SEX-MALE        VALUE 'M'.
  5867                 88  PM-JOINT-SEX-FEMALE      VALUE 'F'.
  5868             20  PM-JOINT-BIRTH-DT         PIC XX.
  5869             20  PM-JOINT-ISSUE-AGE        PIC S9(3)     COMP-3.
  5870             20  PM-JOINT-HEIGHT-FT        PIC S9(3)     COMP-3.
  5871             20  PM-JOINT-HEIGHT-IN        PIC S9(3)     COMP-3.
  5872             20  PM-JOINT-WEIGHT           PIC S9(3)     COMP-3.
  5873             20  PM-JOINT-BIRTH-STATE      PIC XX.
  5874             20  PM-JOINT-RATED-AGE        PIC S9(3)     COMP-3.
  5875         16  PM-JOINT-TOT-BENEFIT          PIC S9(7)V99  COMP-3.
  5876         16  PM-JOINT-AGE-IND              PIC X(01).
  5877             88  PM-JOINT-AGE-75-REACHED              VALUE 'Y'.
  5878
  5879     12  FILLER                            PIC X(12).
  5880
  5881******************************************************************
  5882*                  INSURANCE COVERAGE DATA                       *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 110
* EL154.cbl
  5883******************************************************************
  5884
  5885     12  PM-INS-COVERAGE-DATA.
  5886         16  PM-FREE-PERIOD                PIC S9(03)    COMP-3.
  5887         16  PM-LOAN-TERM                  PIC S9(3)     COMP-3.
  5888         16  PM-LOAN-APR                   PIC S9V9999   COMP-3.
  5889         16  PM-LOAN-DT                    PIC XX.
  5890         16  PM-LOAN-PYMT                  PIC S9(5)V99  COMP-3.
  5891         16  PM-LOAN-BALC                  PIC S9(7)V99  COMP-3.
  5892         16  PM-INS-BENEFIT-MONTHS         PIC S9(3)     COMP-3.
  5893         16  PM-INS-MONTH-BENEFIT          PIC S9(7)V99  COMP-3.
  5894         16  PM-INS-TOTAL-BENEFIT          PIC S9(7)V99  COMP-3.
  5895         16  PM-INS-PLAN-TYPE              PIC X.
  5896             88  PM-AH-MORT-PLAN              VALUE 'A'.
  5897             88  PM-AD-D-MORT-PLAN            VALUE 'E'.
  5898             88  PM-DISMEM-MORT-PLAN          VALUE 'D'.
  5899             88  PM-LIFE-MORT-PLAN            VALUE 'L'.
  5900         16  PM-INS-PLAN-CD                PIC XX.
  5901         16  PM-INS-PLAN-REVISION          PIC X(3).
  5902         16  PM-INS-POLICY-FORM            PIC X(12).
  5903         16  PM-INS-MSTR-POLICY.
  5904             20  PM-FREE-TYPE              PIC X(04).
  5905             20  FILLER                    PIC X(08).
  5906         16  PM-INS-MSTR-APP.
  5907             20  FILLER                    PIC X(11).
  5908             20  PM-INS-B-C-TYPE           PIC X(01).
  5909         16  PM-INS-RATE-CD                PIC X(5).
  5910         16  PM-INS-SEX-RATING             PIC X.
  5911             88  PM-NOT-SEX-RATED              VALUE '1'.
  5912             88  PM-SEX-RATED                  VALUE '2'.
  5913         16  PM-INS-SUBSTANDARD-PCT        PIC S9V9999   COMP-3.
  5914         16  PM-INS-SUBSTANDARD-TYPE       PIC X.
  5915         16  PM-INS-TERMINATION-DT         PIC XX.
  5916         16  PM-INS-MONTH-PREMIUM      PIC S9(5)V999999  COMP-3.
  5917         16  PM-INS-CALC-MO-PREM       PIC S9(5)V999999  COMP-3.
  5918         16  PM-REINSURANCE-TABLE          PIC X(3).
  5919         16  PM-MORTALITY-CD               PIC X(4).
  5920         16  PM-INS-TYPE                   PIC X.
  5921             88  PM-INDIVIDUAL                VALUES ARE '1' 'I'.
  5922             88  PM-GROUP                     VALUES ARE '2' 'G'.
  5923         16  PM-LOAN-OFFICER               PIC X(5).
  5924         16  PM-POLICY-FEE                 PIC S9(3)V99 COMP-3.
  5925         16  PM-DEPENDENT-COUNT            PIC S99      COMP-3.
  5926         16  PM-CWA-AMOUNT                 PIC S9(5)V99  COMP-3.
  5927         16  PM-LAST-AUTO-RERATE-DT        PIC XX.
  5928         16  PM-PREM-FINANCED-SW           PIC X.
  5929             88  PM-PREM-FINANCED              VALUE 'Y'.
  5930             88  PM-PREM-NOT-FINANCED          VALUE 'N'.
  5931
  5932         16  PM-INS-TERM-LETTER-IND        PIC X.
  5933             88  PM-TERM-INITIALIZED           VALUE 'Y'.
  5934         16  PM-INS-UNDERWRITER-MAX-BEN PIC S9(7)V99     COMP-3.
  5935     12  FILLER                            PIC X(11).
  5936
  5937******************************************************************
  5938*                    POLICY BILLING DATA                         *
  5939******************************************************************
  5940
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 111
* EL154.cbl
  5941     12  PM-BILLING-DATA.
  5942         16  PM-BILLING-MODE               PIC X(1).
  5943             88  PM-ANNUAL                    VALUE '1'.
  5944             88  PM-SEMI-ANNUAL               VALUE '2'.
  5945             88  PM-QUARTERLY                 VALUE '3'.
  5946             88  PM-MONTHLY                   VALUE '4'.
  5947             88  PM-BI-MONTHLY                VALUE '5'.
  5948             88  PM-SINGLE-PREM               VALUE '6'.
  5949         16  PM-BILLING-SCHEDULE           PIC X(1).
  5950         16  PM-BILLING-SW                 PIC X(1).
  5951             88  PM-FIRST-BILLING             VALUE 'Y'.
  5952             88  PM-PAID-IN-ADVANCE           VALUE 'A'.
  5953             88  PM-POLICY-FEE-REFUNDED       VALUE 'F'.
  5954         16  PM-BILLING-TYPE               PIC X(1).
  5955             88  PM-LIST-BILL                 VALUE '1'.
  5956             88  PM-TAPE-BILL                 VALUE '2'.
  5957             88  PM-TAPE-LIST-BILL            VALUE '3'.
  5958             88  PM-GROUP-BILL          VALUE ARE '1' '2' '3'.
  5959             88  PM-DIRECT-BILL               VALUE '4'.
  5960             88  PM-PAC-BILL            VALUE ARE '5' 'C' 'S'.
  5961             88  PM-CHARGE-CARD-BILL          VALUE '6'.
  5962             88  PM-INDIV-BILL
  5963                                  VALUE ARE '4' '5' '6' 'C' 'S'.
  5964             88  PM-GRP-PLCY-BILL             VALUE '7'.
  5965             88  PM-GRP-PLCY-PAC              VALUE '8'.
  5966             88  PM-GRP-PLCY-CR-CRD           VALUE '9'.
  5967             88  PM-GRP-PLCY            VALUE ARE '7' '8' '9'.
  5968             88  PM-GRP-PROD                  VALUE 'A'.
  5969             88  PM-EFT-CHECKING              VALUE 'C'.
  5970             88  PM-EFT-SAVINGS               VALUE 'S'.
  5971         16  PM-PAYMENT-AMT                PIC S9(5)V99  COMP-3.
  5972         16  PM-OVER-SHORT-AMT             PIC S9(5)V99  COMP-3.
  5973         16  PM-LAST-BILL-DT               PIC XX.
  5974         16  PM-LAST-BILL-AMT              PIC S9(5)V99  COMP-3.
  5975         16  PM-BILL-TO-DT                 PIC XX.
  5976         16  PM-LAST-PYMT-DT               PIC XX.
  5977         16  PM-PAID-TO-DT                 PIC XX.
  5978         16  PM-PYMT-INVOICE-NUMBER        PIC X(6).
  5979         16  PM-MONTHS-PAID                PIC S9(3)     COMP-3.
  5980         16  PM-TOTAL-PREM-RECVD           PIC S9(7)V99  COMP-3.
  5981         16  PM-BILLING-GROUPING-CODE      PIC X(6).
  5982         16  PM-CHARGE-CARD-EXP-DT         PIC X(2).
  5983         16  PM-CHARGE-CARD-TYPE           PIC X(2).
  5984             88  PM-VISA                      VALUE 'VI'.
  5985             88  PM-MSTR-CARD                 VALUE 'MC'.
  5986             88  PM-DINERS-CLUB               VALUE 'DN'.
  5987             88  PM-DISCOVER                  VALUE 'DS'.
  5988             88  PM-CARTE-BLANCHE             VALUE 'CB'.
  5989             88  PM-AMERICAN-EXPRESS          VALUE 'AE'.
  5990         16  PM-BILL-INVOICE-NUMBER        PIC X(6).
  5991         16  PM-BILL-DAY                   PIC S99       COMP-3.
  5992         16  PM-RES-PREM-TAX           PIC S9(3)V999999  COMP-3.
  5993     12  FILLER                            PIC X(15).
  5994
  5995******************************************************************
  5996*                     CLAIM PAYMENT DATA                         *
  5997******************************************************************
  5998
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 112
* EL154.cbl
  5999     12  PM-CLAIM-PAYMENT-DATA.
  6000         16  PM-CLAIM-BENEFICIARY-NAME     PIC X(25).
  6001         16  PM-CLAIM-INTERFACE-SW         PIC X.
  6002             88  PM-NO-CLAIM-ATTACHED         VALUE SPACE.
  6003             88  PM-POLICY-AND-CLAIM-ONLINE VALUE '1'.
  6004             88  PM-POLICY-CREATED-FOR-CLAIM VALUE '2'.
  6005             88  PM-CLAIM-CLOSED              VALUE '3'.
  6006             88  PM-ACTIVE-CLAIM              VALUE '1' '2'.
  6007             88  PM-CLAIM-ATTACHED            VALUE '1' '2' '3'.
  6008         16  PM-CLAIM-INCURRED-DT          PIC XX.
  6009         16  PM-CLAIM-PAID-TO-DT           PIC XX.
  6010         16  PM-CLAIM-PAYMENT-CNT          PIC S9(3)     COMP-3.
  6011         16  PM-CLAIM-LAST-PAYMENT-AMT     PIC S9(7)V99  COMP-3.
  6012         16  PM-CLAIM-EXPENSES-ITD         PIC S9(7)V99  COMP-3.
  6013         16  PM-CLAIM-PAYMENTS-ITD         PIC S9(7)V99  COMP-3.
  6014         16  PM-CLAIM-ACCUMULATOR          PIC S9(7)V99  COMP-3.
  6015         16  PM-CLAIM-ATTACH-CNT           PIC S9(3)     COMP-3.
  6016         16  PM-CLAIM-LIFE-ITD             PIC S9(7)V99  COMP-3.
  6017         16  PM-CLAIM-AH-ITD               PIC S9(7)V99  COMP-3.
  6018         16  PM-CLAIM-RIDER-ITD            PIC S9(7)V99  COMP-3.
  6019
  6020     12  FILLER                            PIC X(03).
  6021
  6022******************************************************************
  6023*                POLICY STATUS AND DISPOSITION                   *
  6024******************************************************************
  6025
  6026     12  PM-STATUS-DISPOSITION-DATA.
  6027         16  PM-ISSUE-EOM-DT               PIC XX.
  6028         16  PM-REPLACEMENT-SWITCH         PIC X.
  6029         16  PM-APPL-SIGN-DT               PIC XX.
  6030         16  PM-UNDERWRITER                PIC X(3).
  6031         16  PM-ENTRY-PROCESSOR            PIC X(4).
  6032         16  PM-ENTRY-STATUS               PIC X.
  6033             88  PM-NORMAL                    VALUE '1'.
  6034             88  PM-TAKE-OVER                 VALUE '2'.
  6035             88  PM-CONVERSION                VALUE '4'.
  6036             88  PM-RE-ISSUE                  VALUE '5'.
  6037             88  PM-REINSURANCE-ONLY          VALUE '9'.
  6038         16  PM-ENTRY-DT                   PIC XX.
  6039         16  PM-ENTRY-TIME                 PIC S9(7) COMP-3.
  6040         16  PM-EXIT-DT                    PIC XX.
  6041         16  PM-CURRENT-STATUS             PIC X.
  6042             88  PM-LAPSE                     VALUE '0'.
  6043             88  PM-ACTIVE                    VALUE '1'.
  6044             88  PM-PENDING-ISSUE             VALUE '2'.
  6045             88  PM-DECLINED                  VALUE '3'.
  6046             88  PM-PENDING-CANCEL            VALUE '4'.
  6047             88  PM-PENDING-ISSUE-ERROR       VALUE '5'.
  6048             88  PM-CLAIM-APPLIED             VALUE '6'.
  6049             88  PM-CANCEL                    VALUE '7'.
  6050             88  PM-PENDING-UNWTR-REVW        VALUE '8'.
  6051             88  PM-PENDING-CANCEL-ERROR      VALUE '9'.
  6052             88  PM-CANCEL-TRANSFER           VALUE 'C'.
  6053             88  PM-CLAIM-SETTLEMENT          VALUE 'F'.
  6054             88  PM-TERMINATE                 VALUE 'T'.
  6055** NOTE TYPE 1 IS ANYTHING THAT IS OR HAS BEEN ACTIVE.  TYPE 2 IS
  6056** EVERYTHING ELSE.  IF YOU ADD A STATUS ADD THE VALUE TO ONE OF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 113
* EL154.cbl
  6057** THESE GROUPS.
  6058             88  PM-TYPE-STAT-1
  6059                     VALUES ARE '0' '1' '4' '6' '7' '9'
  6060                                'C' 'F' 'T'.
  6061             88  PM-TYPE-STAT-2
  6062                     VALUES ARE '2' '3' '5' '8'.
  6063             88  PM-BILLABLE-STATUS VALUES ARE '0' '1' '6'.
  6064             88  PM-PENDING-STATUS
  6065                                VALUES ARE '2' '4' '5' '8' '9'.
  6066             88  PM-PENDING-ISSUE-STATUS
  6067                                VALUES ARE '2' '5' '8'.
  6068             88  PM-CANCEL-STATUS
  6069                                VALUES ARE '4' '7' '9' 'C'.
  6070         16  PM-CANCEL-CAUSE-CD            PIC X(3).
  6071         16  PM-CANCEL-DT                  PIC XX.
  6072         16  PM-REFUND-AMT                 PIC S9(5)V99  COMP-3.
  6073         16  PM-CALC-REFUND-AMT            PIC S9(5)V99  COMP-3.
  6074         16  PM-DECLINE-CD                 PIC X(3).
  6075         16  PM-DECLINE-DT                 PIC XX.
  6076         16  PM-LAST-LAPSE-DT              PIC XX.
  6077         16  PM-LAST-REINSTATE-DT          PIC XX.
  6078         16  PM-SECURITY-ACCESS-CODE       PIC X.
  6079         16  PM-PREV-CONTROL-PRIMARY.
  6080             20  PM-PREV-COMPANY-CD             PIC X.
  6081             20  PM-PREV-CARRIER                PIC X.
  6082             20  PM-PREV-GROUPING.
  6083                 24  PM-PREV-GROUPING-PREFIX PIC X(3).
  6084                 24  PM-PREV-GROUPING-PRIME     PIC X(3).
  6085             20  PM-PREV-STATE                  PIC XX.
  6086             20  PM-PREV-PRODUCER.
  6087                 24  PM-PREV-PRODUCER-PREFIX PIC X(4).
  6088                 24  PM-PREV-PRODUCER-PRIME     PIC X(6).
  6089             20  PM-PREV-POLICY-EFF-DT          PIC XX.
  6090             20  PM-PREV-REFERENCE-NUMBER.
  6091                 24  PM-PREV-REFNO-PRIME        PIC X(18).
  6092                 24  PM-PREV-REFNO-SFX          PIC XX.
  6093         16  PM-ACTION-DT                  PIC XX.
  6094         16  PM-ACTION-CODE                PIC X(3).
  6095         16  PM-ACTION-DT-2                PIC XX.
  6096         16  PM-ACTION-CODE-2              PIC X(3).
  6097         16  PM-ACTION-DT-3                PIC XX.
  6098         16  PM-ACTION-CODE-3              PIC X(3).
  6099         16  PM-ACTION-DT-4                PIC XX.
  6100         16  PM-ACTION-CODE-4              PIC X(3).
  6101         16  PM-ACTION-DT-5                PIC XX.
  6102         16  PM-ACTION-CODE-5              PIC X(3).
  6103
  6104         16  PM-KEY-CHANGE                 PIC X.
  6105                 88  PM-NO-KEY-CHG      VALUES ARE ' ' 'N'.
  6106                 88  PM-KEY-CHG              VALUE 'Y'.
  6107         16  PM-KEY-CHANGE-DT              PIC XX.
  6108
  6109         16  PM-RTI-INDICATOR              PIC X.
  6110         16  PM-REASON-CODE                PIC X(3).
  6111         16  PM-IN-OUT-PROCESSING-IND      PIC X(1).
  6112             88  PM-IN-OUT-PROCESSING      VALUE 'Y'.
  6113             88  PM-NOT-IN-OUT-PROCESSING  VALUE SPACES.
  6114
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 114
* EL154.cbl
  6115     12  FILLER                            PIC X(12).
  6116
  6117******************************************************************
  6118*                 AGENT AND COMMISSION DATA                      *
  6119******************************************************************
  6120
  6121     12  PM-COMMISSION-DATA.
  6122         16  PM-REMIT-TO                   PIC S9(3) COMP-3.
  6123         16  PM-COMM-CHANGE-SW             PIC X.
  6124                 88  PM-COMMISSION-CHANGE     VALUE 'Y'.
  6125         16  PM-AGENT-INFORMATION OCCURS     5 TIMES.
  6126             20  PM-AGENT-NUMBER           PIC X(10).
  6127             20  PM-AGENT-TYPE             PIC X.
  6128                 88  PM-PRODUCER-LEVEL-AGENT
  6129                                              VALUES ARE 'C' 'D'.
  6130                 88  PM-AGENT-GROSS           VALUE 'C'.
  6131                 88  PM-AGENT-REINS           VALUE 'R'.
  6132                 88  PM-AGENT-GROSS-REINS     VALUE 'D'.
  6133                 88  PM-OVERWRITE-GROSS       VALUE 'O'.
  6134                 88  PM-OVERWRITE-GROSS-REINS VALUE 'P'.
  6135                 88  PM-OVERWRITE-REINS       VALUE 'T'.
  6136                 88  PM-REINS-ONLY            VALUE 'W'.
  6137             20  PM-COMMISSION-BILL-PAID PIC X(1).
  6138                 88  PM-GENERATE-BILL         VALUE 'B'.
  6139                 88  PM-GENERATE-PAID         VALUE 'P'.
  6140             20  PM-AGENT-COMP-1ST-YEAR PIC S99V999.
  6141             20  PM-COMP-1ST-YEAR-TYPE     PIC X(1).
  6142                 88  PM-COMP-1ST-YEAR-PERCENT VALUE '1'.
  6143                 88  PM-COMP-1ST-YEAR-DOLLARS VALUE '2'.
  6144                 88  PM-COMP-1ST-YEAR-NOT-USED VALUE '3'.
  6145             20  PM-RENEWAL-DATA.
  6146                 24  PM-AGENT-RENEWAL-DATA OCCURS 6 TIMES.
  6147                     28  PM-RENEW-MONTHS     PIC S999    COMP-3.
  6148                     28  PM-RENEW-COMMISSION
  6149                                             PIC S99V999 COMP-3.
  6150                     28  PM-RENEW-TYPE       PIC X(1).
  6151                         88  PM-COMP-RENEW-PERCENT      VALUE '1'.
  6152                         88  PM-COMP-RENEW-DOLLARS      VALUE '2'.
  6153                         88  PM-COMP-RENEW-NOT-USED     VALUE '3'.
  6154             20  PM-COMP-RECALC-FLAG       PIC X(1).
  6155                 88  PM-BYPASS-RECALC         VALUE 'N'.
  6156     12  FILLER                            PIC X(20).
  6157******************************************************************
  6158*             CUSTOMER DATA                                      *
  6159******************************************************************
  6160     12  PM-CUSTOMER-ID                    PIC X(20).
  6161******************************************************************
  6162     12  FILLER                            PIC X(43).
  6163******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 115
* EL154.cbl
  6165 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  6166                          CLAIM-MASTER ACTIVITY-TRAILERS
  6167                          CERTIFICATE-MASTER BENEFICIARY-MASTER
  6168                          ACCOUNT-MASTER PRODUCT-MASTER
  6169                          CERTIFICATE-TRAILERS POLICY-MASTER.
  6170 0000-DFHEXIT SECTION.
  6171     MOVE '9#                    $   ' TO DFHEIV0.
  6172     MOVE 'EL154' TO DFHEIV1.
  6173     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6174     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6175     MOVE '5'                   TO DC-OPTION-CODE.
  6176     PERFORM 9700-DATE-LINK.
  6177     MOVE DC-GREG-DATE-1-EDIT   TO  CURRENT-GREG-DATE.
  6178     MOVE DC-BIN-DATE-1         TO  CURRENT-BIN-DATE.
  6179
  6180
  6181     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6182     MOVE 2 TO EMI-NUMBER-OF-LINES.
  6183     IF EIBCALEN = 0
  6184         GO TO 8800-UNAUTHORIZED-ACCESS.
  6185
  6186     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6187         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6188             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6189             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6190             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6191             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6192             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6193             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6194             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6195             MOVE THIS-PGM  TO PI-CALLING-PROGRAM
  6196             MOVE LOW-VALUES TO EL154AO
  6197             GO TO 7000-BUILD-SCREEN.
  6198
  6199
  6200* EXEC CICS HANDLE CONDITION
  6201*        NOTOPEN(8860-CLAM-NOT-OPEN)
  6202*        PGMIDERR(9600-PGMID-ERROR)
  6203*        ERROR(9990-ABEND)
  6204*        END-EXEC.
  6205*    MOVE '"$JL.                 ! " #00006195' TO DFHEIV0
  6206     MOVE X'22244A4C2E20202020202020' TO DFHEIV0(1:12)
  6207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6208     MOVE X'2220233030303036313935' TO DFHEIV0(25:11)
  6209     CALL 'kxdfhei1' USING DFHEIV0
  6210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6211
  6212
  6213     IF EIBAID = DFHCLEAR
  6214         GO TO 9400-CLEAR.
  6215
  6216     IF PI-PROCESSOR-ID = 'LGXX'
  6217         GO TO 0200-RECEIVE.
  6218
  6219
  6220* EXEC CICS READQ TS
  6221*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6222*        INTO    (SECURITY-CONTROL)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 116
* EL154.cbl
  6223*        LENGTH  (SC-COMM-LENGTH)
  6224*        ITEM    (SC-ITEM)
  6225*    END-EXEC.
  6226*    MOVE '*$II   L              ''   #00006207' TO DFHEIV0
  6227     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6228     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6229     MOVE X'2020233030303036323037' TO DFHEIV0(25:11)
  6230     CALL 'kxdfhei1' USING DFHEIV0,
  6231           PI-SECURITY-TEMP-STORE-ID,
  6232           SECURITY-CONTROL,
  6233           SC-COMM-LENGTH,
  6234           SC-ITEM,
  6235           DFHEIV99,
  6236           DFHEIV99
  6237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6238
  6239
  6240     MOVE SC-CLAIMS-DISPLAY (9)   TO  PI-DISPLAY-CAP.
  6241     MOVE SC-CLAIMS-UPDATE  (9)   TO  PI-MODIFY-CAP.
  6242
  6243     IF NOT MODIFY-CAP
  6244         MOVE 'UPDATE'            TO  SM-READ
  6245         PERFORM 9995-SECURITY-VIOLATION
  6246         MOVE ER-0070             TO  EMI-ERROR
  6247         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6248         GO TO 8100-SEND-INITIAL-MAP.
  6249
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 117
* EL154.cbl
  6251 0200-RECEIVE.
  6252     MOVE LOW-VALUES TO EL154AI.
  6253     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6254         MOVE ER-0008 TO EMI-ERROR
  6255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6256         GO TO 8200-SEND-DATAONLY.
  6257
  6258
  6259* EXEC CICS RECEIVE
  6260*        MAP(MAP-NAME)
  6261*        MAPSET(MAPSET-NAME)
  6262*        INTO(EL154AI)
  6263*        END-EXEC.
  6264     MOVE LENGTH OF
  6265      EL154AI
  6266       TO DFHEIV11
  6267*    MOVE '8"T I  L              ''   #00006232' TO DFHEIV0
  6268     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6269     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6270     MOVE X'2020233030303036323332' TO DFHEIV0(25:11)
  6271     CALL 'kxdfhei1' USING DFHEIV0,
  6272           MAP-NAME,
  6273           EL154AI,
  6274           DFHEIV11,
  6275           MAPSET-NAME,
  6276           DFHEIV99,
  6277           DFHEIV99
  6278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6279
  6280
  6281     IF ENTERPFL = 0
  6282         GO TO 0300-CHECK-PFKEYS.
  6283     IF EIBAID NOT = DFHENTER
  6284         MOVE ER-0004 TO EMI-ERROR
  6285         GO TO 0320-INPUT-ERROR.
  6286
  6287     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  6288         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  6289     ELSE
  6290         MOVE ER-0029 TO EMI-ERROR
  6291         GO TO 0320-INPUT-ERROR.
  6292
  6293 0300-CHECK-PFKEYS.
  6294
  6295     IF EIBAID = DFHPF23
  6296         GO TO 8810-PF23.
  6297     IF EIBAID = DFHPF24
  6298         GO TO 9200-RETURN-MAIN-MENU.
  6299     IF EIBAID = DFHPF12
  6300         GO TO 9500-PF12.
  6301     IF EIBAID EQUAL DFHPF1
  6302        GO TO 0400-PAGE-FORWARD.
  6303     IF EIBAID EQUAL DFHPF2
  6304        GO TO 0700-PAGE-BACKWARD.
  6305     IF EIBAID EQUAL DFHPF3
  6306        MOVE CURRENT-BIN-DATE TO CURRENT-SAVE
  6307        IF TERMI = 'A'
  6308            GO TO 2000-ADD-ONLY
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 118
* EL154.cbl
  6309        ELSE
  6310        IF TERMI = 'N'
  6311            GO TO 3000-TERMINATE-AND-GENERATE.
  6312     IF (TERML NOT = 0) AND (EIBAID NOT = DFHENTER)
  6313         MOVE ER-0050 TO EMI-ERROR
  6314         GO TO 0320-INPUT-ERROR.
  6315     IF EIBAID = DFHENTER
  6316         GO TO 0330-EDIT-DATA.
  6317
  6318     MOVE ER-0029 TO EMI-ERROR.
  6319 0320-INPUT-ERROR.
  6320     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6321     MOVE AL-UNBON TO ENTERPFA.
  6322     IF ENTERPFL = 0
  6323         MOVE -1 TO TERML
  6324     ELSE
  6325         MOVE -1 TO ENTERPFL.
  6326
  6327     GO TO 8200-SEND-DATAONLY.
  6328
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 119
* EL154.cbl
  6330 0330-EDIT-DATA.
  6331     IF NOT MODIFY-CAP
  6332           MOVE ER-0070          TO EMI-ERROR
  6333           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6334           MOVE LOW-VALUES       TO EL154AO
  6335           GO TO 8100-SEND-INITIAL-MAP.
  6336
  6337     MOVE CURRENT-BIN-DATE       TO CURRENT-SAVE
  6338
  6339     IF TERMI = 'Y'
  6340         GO TO 1000-DELETE-CURRENT.
  6341     IF TERMI = 'A'
  6342         GO TO 2000-ADD-ONLY.
  6343     IF TERMI = 'N'
  6344         GO TO 3000-TERMINATE-AND-GENERATE.
  6345     MOVE ER-0347                TO EMI-ERROR.
  6346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6347     MOVE -1                     TO TERML.
  6348     MOVE AL-UABON               TO TERMA.
  6349     GO TO 8200-SEND-DATAONLY.
  6350
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 120
* EL154.cbl
  6352 0400-PAGE-FORWARD.
  6353
  6354* EXEC CICS HANDLE CONDITION
  6355*         NOTFND    (8850-CLAM-END-FILE)
  6356*         ENDFILE   (8850-CLAM-END-FILE)
  6357*    END-EXEC.
  6358*    MOVE '"$I''                  ! # #00006310' TO DFHEIV0
  6359     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6360     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6361     MOVE X'2320233030303036333130' TO DFHEIV0(25:11)
  6362     CALL 'kxdfhei1' USING DFHEIV0
  6363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6364
  6365
  6366     MOVE PI-CARRIER      TO CLAM-CARRIER
  6367     MOVE PI-COMPANY-CD   TO CLAM-CO
  6368     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6369     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6370     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6371
  6372
  6373* EXEC CICS STARTBR
  6374*         DATASET   ('ELMSTR')
  6375*         RIDFLD    (CLAM-KEY)
  6376*    END-EXEC.
  6377     MOVE 'ELMSTR' TO DFHEIV1
  6378     MOVE 0
  6379       TO DFHEIV11
  6380*    MOVE '&,         G          &   #00006321' TO DFHEIV0
  6381     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6382     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6383     MOVE X'2020233030303036333231' TO DFHEIV0(25:11)
  6384     CALL 'kxdfhei1' USING DFHEIV0,
  6385           DFHEIV1,
  6386           CLAM-KEY,
  6387           DFHEIV99,
  6388           DFHEIV11,
  6389           DFHEIV99
  6390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6391
  6392
  6393 0450-READ-NEXT-CLAIM.
  6394
  6395
  6396* EXEC CICS READNEXT
  6397*         DATASET   ('ELMSTR')
  6398*         RIDFLD    (CLAM-KEY)
  6399*         SET       (ADDRESS OF CLAIM-MASTER)
  6400*    END-EXEC.
  6401     MOVE 'ELMSTR' TO DFHEIV1
  6402     MOVE 0
  6403       TO DFHEIV11
  6404*    MOVE '&.S                   )   #00006328' TO DFHEIV0
  6405     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6406     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6407     MOVE X'2020233030303036333238' TO DFHEIV0(25:11)
  6408     CALL 'kxdfhei1' USING DFHEIV0,
  6409           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 121
* EL154.cbl
  6410           DFHEIV20,
  6411           DFHEIV99,
  6412           CLAM-KEY,
  6413           DFHEIV99,
  6414           DFHEIV11,
  6415           DFHEIV99,
  6416           DFHEIV99
  6417     SET ADDRESS OF CLAIM-MASTER TO
  6418         DFHEIV20
  6419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6420
  6421
  6422     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6423        GO TO 8850-CLAM-END-FILE.
  6424
  6425     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6426        GO TO 0450-READ-NEXT-CLAIM.
  6427
  6428     IF PI-CARRIER-SECURITY GREATER SPACES
  6429         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6430             GO TO 0450-READ-NEXT-CLAIM.
  6431
  6432     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6433         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6434             GO TO 0450-READ-NEXT-CLAIM.
  6435
  6436     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6437         GO TO 0450-READ-NEXT-CLAIM.
  6438
  6439     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6440     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6441     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6442     MOVE CL-CERT-STATE       TO PI-STATE
  6443     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6444     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6445     MOVE CL-CERT-NO          TO PI-CERT-NO
  6446
  6447     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6448         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6449
  6450
  6451* EXEC CICS ENDBR
  6452*         DATASET    ('ELMSTR')
  6453*    END-EXEC.
  6454     MOVE 'ELMSTR' TO DFHEIV1
  6455     MOVE 0
  6456       TO DFHEIV11
  6457*    MOVE '&2                    $   #00006362' TO DFHEIV0
  6458     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6459     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6460     MOVE X'2020233030303036333632' TO DFHEIV0(25:11)
  6461     CALL 'kxdfhei1' USING DFHEIV0,
  6462           DFHEIV1,
  6463           DFHEIV11,
  6464           DFHEIV99
  6465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6466
  6467
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 122
* EL154.cbl
  6468     MOVE LOW-VALUES TO EL154AO.
  6469     GO TO 7000-BUILD-SCREEN.
  6470
  6471 0700-PAGE-BACKWARD.
  6472
  6473
  6474* EXEC CICS HANDLE CONDITION
  6475*         NOTFND    (8850-CLAM-END-FILE)
  6476*         ENDFILE   (8850-CLAM-END-FILE)
  6477*    END-EXEC.
  6478*    MOVE '"$I''                  ! $ #00006371' TO DFHEIV0
  6479     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6481     MOVE X'2420233030303036333731' TO DFHEIV0(25:11)
  6482     CALL 'kxdfhei1' USING DFHEIV0
  6483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6484
  6485
  6486     MOVE PI-CARRIER      TO CLAM-CARRIER
  6487     MOVE PI-COMPANY-CD   TO CLAM-CO
  6488     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6489     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6490     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6491
  6492
  6493* EXEC CICS STARTBR
  6494*         DATASET   ('ELMSTR')
  6495*         RIDFLD    (CLAM-KEY)
  6496*    END-EXEC.
  6497     MOVE 'ELMSTR' TO DFHEIV1
  6498     MOVE 0
  6499       TO DFHEIV11
  6500*    MOVE '&,         G          &   #00006382' TO DFHEIV0
  6501     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6502     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6503     MOVE X'2020233030303036333832' TO DFHEIV0(25:11)
  6504     CALL 'kxdfhei1' USING DFHEIV0,
  6505           DFHEIV1,
  6506           CLAM-KEY,
  6507           DFHEIV99,
  6508           DFHEIV11,
  6509           DFHEIV99
  6510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6511
  6512
  6513 0750-READ-PREV-CLAIM.
  6514
  6515
  6516* EXEC CICS READPREV
  6517*         DATASET   ('ELMSTR')
  6518*         RIDFLD    (CLAM-KEY)
  6519*         SET       (ADDRESS OF CLAIM-MASTER)
  6520*    END-EXEC.
  6521     MOVE 'ELMSTR' TO DFHEIV1
  6522     MOVE 0
  6523       TO DFHEIV11
  6524*    MOVE '&0S                   )   #00006389' TO DFHEIV0
  6525     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 123
* EL154.cbl
  6526     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6527     MOVE X'2020233030303036333839' TO DFHEIV0(25:11)
  6528     CALL 'kxdfhei1' USING DFHEIV0,
  6529           DFHEIV1,
  6530           DFHEIV20,
  6531           DFHEIV99,
  6532           CLAM-KEY,
  6533           DFHEIV99,
  6534           DFHEIV11,
  6535           DFHEIV99,
  6536           DFHEIV99
  6537     SET ADDRESS OF CLAIM-MASTER TO
  6538         DFHEIV20
  6539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6540
  6541
  6542     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6543        GO TO 8850-CLAM-END-FILE.
  6544
  6545     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6546        GO TO 0750-READ-PREV-CLAIM.
  6547
  6548     IF PI-CARRIER-SECURITY GREATER SPACES
  6549         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6550             GO TO 0750-READ-PREV-CLAIM.
  6551
  6552     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6553         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6554             GO TO 0750-READ-PREV-CLAIM.
  6555
  6556     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6557         GO TO 0750-READ-PREV-CLAIM.
  6558
  6559     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6560     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6561     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6562     MOVE CL-CERT-STATE       TO PI-STATE
  6563     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6564     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6565     MOVE CL-CERT-NO          TO PI-CERT-NO
  6566
  6567     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6568         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6569
  6570
  6571* EXEC CICS ENDBR
  6572*         DATASET    ('ELMSTR')
  6573*    END-EXEC.
  6574     MOVE 'ELMSTR' TO DFHEIV1
  6575     MOVE 0
  6576       TO DFHEIV11
  6577*    MOVE '&2                    $   #00006423' TO DFHEIV0
  6578     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6579     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6580     MOVE X'2020233030303036343233' TO DFHEIV0(25:11)
  6581     CALL 'kxdfhei1' USING DFHEIV0,
  6582           DFHEIV1,
  6583           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 124
* EL154.cbl
  6584           DFHEIV99
  6585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6586
  6587
  6588     MOVE LOW-VALUES TO EL154AO.
  6589     GO TO 7000-BUILD-SCREEN.
  6590
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 125
* EL154.cbl
  6592 1000-DELETE-CURRENT.
  6593     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6594     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6595
  6596     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6597     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6598     MOVE ZEROS                  TO CL-AUTO-PAY-SEQ.
  6599     MOVE LOW-VALUES             TO CL-NEXT-AUTO-PAY-DT.
  6600
  6601     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6602
  6603     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6604
  6605     MOVE SPACES TO WS-END-LETTER-FORM-NUM.
  6606*    IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6607     IF PRINTL IS GREATER THAN +0
  6608         MOVE PRINTI   TO PI-AUTO-END-LETTER
  6609     END-IF.
  6610     IF PI-AUTO-END-LETTER IS GREATER THAN SPACES
  6611         IF PI-AUTO-END-LETTER IS EQUAL TO 'N   '
  6612             GO TO 1000-FINISH-DELETE
  6613         ELSE
  6614             MOVE PI-AUTO-END-LETTER TO WS-END-LETTER-FORM-NUM
  6615             MOVE 'Y'    TO WS-ACT-REC-FOUND-SW
  6616                            WS-LETTER-SW
  6617         END-IF
  6618     END-IF.
  6619
  6620     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6621         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6622             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6623
  6624 1000-FINISH-DELETE.
  6625
  6626     IF EMI-NO-ERRORS
  6627         GO TO 8200-SEND-DATAONLY.
  6628
  6629     MOVE LOW-VALUES             TO EL154AO.
  6630     MOVE -1                     TO TERML.
  6631     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 126
* EL154.cbl
  6633 2000-ADD-ONLY.
  6634     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6635     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6636     IF NOT EMI-NO-ERRORS
  6637        GO TO 8200-SEND-DATAONLY.
  6638
  6639     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6640     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6641     IF NOT EMI-NO-ERRORS
  6642         GO TO 8200-SEND-DATAONLY.
  6643
  6644     IF CL-AUTO-PAY-SEQ  NOT = ZEROS
  6645        MOVE ER-0372             TO EMI-ERROR
  6646        MOVE -1                  TO NEFFDTEL
  6647        MOVE AL-UABON            TO NEFFDTEA
  6648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6649        GO TO 8200-SEND-DATAONLY.
  6650
  6651     PERFORM 6400-PAYMENT-CALCULATION  THRU 6499-EXIT.
  6652
  6653     IF NFSTAMT-SAVE IS EQUAL TO +0
  6654         MOVE ER-0350            TO  EMI-ERROR
  6655         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6656         MOVE -1                 TO  NFSTAMTL
  6657         MOVE AL-UNBON           TO  NFSTAMTA
  6658         GO TO 8200-SEND-DATAONLY.
  6659
  6660     IF EIBAID NOT = DFHPF3
  6661         GO TO 3500-CONFIRM-DATA.
  6662
  6663
  6664* EXEC CICS HANDLE CONDITION
  6665*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6666*        END-EXEC.
  6667*    MOVE '"$J                   ! % #00006502' TO DFHEIV0
  6668     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  6669     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6670     MOVE X'2520233030303036353032' TO DFHEIV0(25:11)
  6671     CALL 'kxdfhei1' USING DFHEIV0
  6672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6673
  6674
  6675     PERFORM 4100-BUILD-AUTO-PAY THRU 4199-EXIT.
  6676
  6677     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6678
  6679     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6680
  6681     MOVE SPACES TO WS-LETTER-FORM-NUM.
  6682*     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6683         IF NPRINTL IS GREATER THAN +0
  6684            IF NPRINTI IS EQUAL TO 'N   '
  6685                GO TO 2000-FINISH-ADD
  6686            ELSE
  6687                MOVE NPRINTI TO WS-LETTER-FORM-NUM
  6688                MOVE 'Y' TO WS-ACT-REC-FOUND-SW
  6689                            WS-LETTER-SW.
  6690
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 127
* EL154.cbl
  6691     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6692         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6693             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6694
  6695 2000-FINISH-ADD.
  6696
  6697     IF EMI-NO-ERRORS
  6698         GO TO 8200-SEND-DATAONLY.
  6699
  6700     MOVE LOW-VALUES             TO EL154AO.
  6701     GO TO 7000-BUILD-SCREEN.
  6702
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 128
* EL154.cbl
  6704 3000-TERMINATE-AND-GENERATE.
  6705     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6706     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6707     IF NOT EMI-NO-ERRORS
  6708         GO TO 8200-SEND-DATAONLY.
  6709
  6710     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6711     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6712     IF NOT EMI-NO-ERRORS
  6713         GO TO 8200-SEND-DATAONLY.
  6714
  6715     PERFORM 6400-PAYMENT-CALCULATION THRU 6499-EXIT.
  6716
  6717     IF EIBAID NOT = DFHPF3
  6718         GO TO 3500-CONFIRM-DATA.
  6719
  6720     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6721     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6722
  6723     PERFORM 4100-BUILD-AUTO-PAY  THRU 4199-EXIT.
  6724
  6725     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6726
  6727     IF EMI-NO-ERRORS
  6728         GO TO 8200-SEND-DATAONLY.
  6729
  6730     MOVE LOW-VALUES TO EL154AO.
  6731     GO TO 7000-BUILD-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 129
* EL154.cbl
  6733 3500-CONFIRM-DATA.
  6734
  6735     MOVE -1                     TO  ENTERPFL.
  6736     MOVE ER-0670                TO  EMI-ERROR.
  6737     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6738     GO TO 8200-SEND-DATAONLY.
  6739
  6740 4000-DELETE-AUTO-PAY.
  6741
  6742* EXEC CICS HANDLE CONDITION
  6743*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6744*        NOTFND(4099-EXIT)
  6745*        END-EXEC.
  6746*    MOVE '"$JI                  ! & #00006572' TO DFHEIV0
  6747     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  6748     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6749     MOVE X'2620233030303036353732' TO DFHEIV0(25:11)
  6750     CALL 'kxdfhei1' USING DFHEIV0
  6751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6752
  6753
  6754
  6755* EXEC CICS READ
  6756*        UPDATE
  6757*        DATASET(ACTV-ID)
  6758*        SET(ADDRESS OF ACTIVITY-TRAILERS)
  6759*        RIDFLD(ACTV-KEY)
  6760*        END-EXEC.
  6761*    MOVE '&"S        EU         (   #00006577' TO DFHEIV0
  6762     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6763     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6764     MOVE X'2020233030303036353737' TO DFHEIV0(25:11)
  6765     CALL 'kxdfhei1' USING DFHEIV0,
  6766           ACTV-ID,
  6767           DFHEIV20,
  6768           DFHEIV99,
  6769           ACTV-KEY,
  6770           DFHEIV99,
  6771           DFHEIV99,
  6772           DFHEIV99
  6773     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6774         DFHEIV20
  6775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6776
  6777
  6778     IF PRINTL > ZEROS
  6779         MOVE PRINTI             TO AT-AUTO-END-LETTER
  6780     END-IF.
  6781
  6782     MOVE CURRENT-SAVE           TO AT-TERMINATED-DT
  6783                                    AT-AUTO-PAY-LAST-MAINT-DT
  6784     MOVE PI-PROCESSOR-ID        TO AT-AUTO-PAY-LAST-UPDATED-BY
  6785     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  6786
  6787* EXEC CICS REWRITE
  6788*        DATASET(ACTV-ID)
  6789*        FROM(ACTIVITY-TRAILERS)
  6790*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 130
* EL154.cbl
  6791     MOVE LENGTH OF
  6792      ACTIVITY-TRAILERS
  6793       TO DFHEIV11
  6794*    MOVE '&& L                  %   #00006592' TO DFHEIV0
  6795     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6796     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6797     MOVE X'2020233030303036353932' TO DFHEIV0(25:11)
  6798     CALL 'kxdfhei1' USING DFHEIV0,
  6799           ACTV-ID,
  6800           ACTIVITY-TRAILERS,
  6801           DFHEIV11,
  6802           DFHEIV99
  6803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6804
  6805
  6806 4099-EXIT.
  6807      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 131
* EL154.cbl
  6809 4100-BUILD-AUTO-PAY.
  6810******************************************************************
  6811*               CREATE AUTO PAY TRAILER
  6812******************************************************************
  6813
  6814     SUBTRACT 1                  FROM CL-TRAILER-SEQ-CNT.
  6815     MOVE CL-TRAILER-SEQ-CNT     TO ACTV-SEQ
  6816                                    CL-AUTO-PAY-SEQ.
  6817
  6818* EXEC CICS GETMAIN
  6819*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  6820*         LENGTH    (TRLR-LENGTH)
  6821*         INITIMG   (GETMAIN-SPACE)
  6822*    END-EXEC.
  6823*    MOVE ',"IL                  $   #00006608' TO DFHEIV0
  6824     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6825     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6826     MOVE X'2020233030303036363038' TO DFHEIV0(25:11)
  6827     CALL 'kxdfhei1' USING DFHEIV0,
  6828           DFHEIV20,
  6829           TRLR-LENGTH,
  6830           GETMAIN-SPACE
  6831     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6832         DFHEIV20
  6833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6834
  6835
  6836     MOVE ZEROS                  TO AT-DAYS-IN-REG-PMT.
  6837     MOVE NEFFDTE-SAVE           TO AT-SCHEDULE-START-DT.
  6838     MOVE NFSTPMT-SAVE           TO AT-1ST-PAY-THRU-DT
  6839                                    CL-NEXT-AUTO-PAY-DT.
  6840     MOVE DAYPAYI                TO AT-AUTO-PAY-DAY.
  6841     MOVE NLSTPMT-SAVE           TO AT-SCHEDULE-END-DT.
  6842     MOVE NFSTAMT-SAVE           TO AT-FIRST-PMT-AMT.
  6843     MOVE NDAYSFI                TO AT-DAYS-IN-1ST-PMT.
  6844
  6845*    IF PI-USES-PAID-TO
  6846*        MOVE NFSTPMT-SAVE       TO  DC-BIN-DATE-1
  6847*        MOVE '6'                TO  DC-OPTION-CODE
  6848*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6849*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6850*        PERFORM 9700-DATE-LINK
  6851*        IF NO-CONVERSION-ERROR
  6852*            MOVE DC-BIN-DATE-2  TO  AT-1ST-PAY-THRU-DT
  6853*                                    CL-NEXT-AUTO-PAY-DT
  6854*        ELSE
  6855*            MOVE LOW-VALUES     TO  AT-1ST-PAY-THRU-DT
  6856*                                    CL-NEXT-AUTO-PAY-DT
  6857*    ELSE
  6858*        MOVE NFSTPMT-SAVE       TO  AT-1ST-PAY-THRU-DT
  6859*                                    CL-NEXT-AUTO-PAY-DT.
  6860
  6861*    IF PI-USES-PAID-TO
  6862*        MOVE NLSTPMT-SAVE       TO  DC-BIN-DATE-1
  6863*        MOVE '6'                TO  DC-OPTION-CODE
  6864*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6865*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6866*        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 132
* EL154.cbl
  6867*        IF NO-CONVERSION-ERROR
  6868*            MOVE DC-BIN-DATE-2  TO  AT-SCHEDULE-END-DT
  6869*        ELSE
  6870*            MOVE LOW-VALUES     TO  AT-SCHEDULE-END-DT
  6871*    ELSE
  6872*        MOVE NLSTPMT-SAVE       TO  AT-SCHEDULE-END-DT.
  6873
  6874     IF NLASTI = 'Y'
  6875        MOVE 'F'                 TO AT-LAST-PMT-TYPE
  6876     ELSE
  6877        MOVE 'P'                 TO AT-LAST-PMT-TYPE.
  6878
  6879     MOVE NMONTHSI               TO AT-INTERVAL-MONTHS.
  6880     MOVE NREGPMT-SAVE           TO AT-REGULAR-PMT-AMT.
  6881
  6882     MOVE WS-PAYEE-CODE          TO AT-AUTO-PAYEE-CD.
  6883
  6884     IF NINDCTRI    IS EQUAL TO  'N'
  6885         MOVE 'N'                TO AT-AUTO-CASH
  6886     ELSE
  6887         MOVE 'Y'                TO AT-AUTO-CASH.
  6888
  6889     MOVE ENDLETTI               TO AT-AUTO-END-LETTER.
  6890
  6891     IF PI-COMPANY-ID = 'CSL'
  6892        IF PI-CARRIER = 'A' OR 'B' OR 'C' OR '1' OR '2' OR
  6893                        '3' OR '4'
  6894         INSPECT AT-AUTO-PAYEE-CD CONVERTING 'IBA' TO 'IOA'.
  6895
  6896     MOVE LOW-VALUE              TO AT-TERMINATED-DT.
  6897     MOVE 'AT'                   TO AT-RECORD-ID.
  6898     MOVE  3                     TO AT-TRAILER-TYPE.
  6899     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  6900                                    AT-AUTO-PAY-LAST-MAINT-DT
  6901     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  6902                                    AT-AUTO-PAY-LAST-UPDATED-BY
  6903     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  6904     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  6905
  6906
  6907* EXEC CICS WRITE
  6908*         DATASET(ACTV-ID)
  6909*         FROM   (ACTIVITY-TRAILERS)
  6910*         RIDFLD (AT-CONTROL-PRIMARY)
  6911*         END-EXEC.
  6912     MOVE LENGTH OF
  6913      ACTIVITY-TRAILERS
  6914       TO DFHEIV11
  6915*    MOVE '&$ L                  ''   #00006684' TO DFHEIV0
  6916     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6917     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6918     MOVE X'2020233030303036363834' TO DFHEIV0(25:11)
  6919     CALL 'kxdfhei1' USING DFHEIV0,
  6920           ACTV-ID,
  6921           ACTIVITY-TRAILERS,
  6922           DFHEIV11,
  6923           AT-CONTROL-PRIMARY,
  6924           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 133
* EL154.cbl
  6925           DFHEIV99
  6926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6927
  6928
  6929 4199-EXIT.
  6930      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 134
* EL154.cbl
  6932 5000-READ-CLAIM.
  6933
  6934* EXEC CICS READ
  6935*        UPDATE
  6936*        DATASET(CLAM-ID)
  6937*        SET    (ADDRESS OF CLAIM-MASTER)
  6938*        RIDFLD (CLAM-KEY)
  6939*        END-EXEC.
  6940*    MOVE '&"S        EU         (   #00006694' TO DFHEIV0
  6941     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6942     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6943     MOVE X'2020233030303036363934' TO DFHEIV0(25:11)
  6944     CALL 'kxdfhei1' USING DFHEIV0,
  6945           CLAM-ID,
  6946           DFHEIV20,
  6947           DFHEIV99,
  6948           CLAM-KEY,
  6949           DFHEIV99,
  6950           DFHEIV99,
  6951           DFHEIV99
  6952     SET ADDRESS OF CLAIM-MASTER TO
  6953         DFHEIV20
  6954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6955
  6956
  6957 5099-EXIT.
  6958      EXIT.
  6959
  6960 5200-REWRITE.
  6961
  6962* EXEC CICS HANDLE CONDITION
  6963*        DUPKEY
  6964*        END-EXEC.
  6965*    MOVE '"$                   ! '' #00006705' TO DFHEIV0
  6966     MOVE X'222494202020202020202020' TO DFHEIV0(1:12)
  6967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6968     MOVE X'2720233030303036373035' TO DFHEIV0(25:11)
  6969     CALL 'kxdfhei1' USING DFHEIV0
  6970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6971
  6972
  6973     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
  6974     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
  6975     MOVE CURRENT-SAVE           TO CL-LAST-MAINT-DT.
  6976
  6977* EXEC CICS REWRITE
  6978*        DATASET(CLAM-ID)
  6979*        FROM   (CLAIM-MASTER)
  6980*        END-EXEC.
  6981     MOVE LENGTH OF
  6982      CLAIM-MASTER
  6983       TO DFHEIV11
  6984*    MOVE '&& L                  %   #00006712' TO DFHEIV0
  6985     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6986     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6987     MOVE X'2020233030303036373132' TO DFHEIV0(25:11)
  6988     CALL 'kxdfhei1' USING DFHEIV0,
  6989           CLAM-ID,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 135
* EL154.cbl
  6990           CLAIM-MASTER,
  6991           DFHEIV11,
  6992           DFHEIV99
  6993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6994
  6995
  6996*    MOVE 1                      TO EMI-NUMBER-OF-LINES.
  6997     MOVE ER-0000                TO EMI-ERROR.
  6998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6999
  7000 5299-EXIT.
  7001      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 136
* EL154.cbl
  7003 5900-VERIFY-ALL-FIELDS.
  7004******************************************************************
  7005*       PRELIMINARY EDITS TO VERIFY THAT THE REQUIRED FIELDS     *
  7006*       HAVE DATA ENTERED IN THEM                                *
  7007******************************************************************
  7008
  7009     IF DAYPAYL EQUAL +0
  7010        MOVE ZEROS TO DAYPAYI.
  7011
  7012     IF NEFFDTEL EQUAL +0
  7013        MOVE LOW-VALUES TO NEFFDTEI.
  7014
  7015     IF NFSTAMTL EQUAL +0
  7016        MOVE ZEROS TO NFSTAMTI
  7017                      NFSTAMTO.
  7018
  7019     IF NDAYSFL EQUAL +0
  7020        MOVE ZEROS TO NDAYSFI.
  7021
  7022     IF NFSTAMTL EQUAL +0
  7023        IF NDAYSFL NOT EQUAL +0
  7024           MOVE +0        TO NDAYSFL
  7025           MOVE ZEROS     TO NDAYSFI.
  7026
  7027     IF NMONTHSL = ZEROS
  7028        MOVE -1                  TO NMONTHSL
  7029        GO TO 5910-REQUIRED-ERROR.
  7030
  7031     IF NFSTPMTL = ZEROS
  7032        MOVE -1                  TO NFSTPMTL
  7033        GO TO 5910-REQUIRED-ERROR.
  7034
  7035     IF NLSTPMTL = ZEROS
  7036        MOVE -1                  TO NLSTPMTL
  7037        GO TO 5910-REQUIRED-ERROR.
  7038
  7039     IF NLASTL = ZEROS
  7040        MOVE -1                  TO NLASTL
  7041        GO TO 5910-REQUIRED-ERROR.
  7042
  7043     IF NPAYEEL = ZEROS
  7044        MOVE -1                  TO NPAYEEL
  7045        GO TO 5910-REQUIRED-ERROR.
  7046
  7047     IF LETTDTEL EQUAL +0
  7048        MOVE LOW-VALUES TO LETTDTEI.
  7049
  7050     IF (PI-COMPANY-ID  =  'AIG' OR  'AUK') AND
  7051        (NINDCTRL =  ZEROS)
  7052           MOVE -1               TO NINDCTRL
  7053           GO TO 5910-REQUIRED-ERROR.
  7054
  7055     GO TO 5999-EXIT.
  7056
  7057 5910-REQUIRED-ERROR.
  7058     MOVE ER-0358                TO EMI-ERROR.
  7059     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7060
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 137
* EL154.cbl
  7061 5999-EXIT.
  7062      EXIT.
  7063
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 138
* EL154.cbl
  7065 6000-EDIT-INPUT-DATA.
  7066******************************************************
  7067*    IF THE EFFECTIVE OR "PAID FROM" WAS NOT         *
  7068*    ENTERED, THEN USE THE INCURRED OR LAST PAID     *
  7069*    THRU DATE                                       *
  7070******************************************************
  7071
  7072     MOVE SPACES TO WS-ELIMINATION-SW.
  7073
  7074     IF NEFFDTEL NOT = ZEROS
  7075        MOVE NEFFDTEI            TO DEEDIT-FIELD
  7076        PERFORM 8600-DEEDIT
  7077        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7078        MOVE '4'                 TO DC-OPTION-CODE
  7079        PERFORM 9700-DATE-LINK
  7080        IF DATE-CONVERSION-ERROR
  7081           MOVE ER-0348          TO EMI-ERROR
  7082           MOVE -1               TO NEFFDTEL
  7083           MOVE AL-UABON         TO NEFFDTEA
  7084           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7085        ELSE
  7086           MOVE DEEDIT-FIELD-V0  TO NEFFDTEO
  7087           INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7088           MOVE AL-UANON         TO NEFFDTEA
  7089           MOVE DC-BIN-DATE-1    TO NEFFDTE-SAVE
  7090     ELSE
  7091        IF CL-PAID-THRU-DT EQUAL LOW-VALUES
  7092           MOVE 'N' TO WS-ELIMINATION-SW
  7093           MOVE CL-INCURRED-DT TO NEFFDTE-SAVE
  7094                                  DC-BIN-DATE-1
  7095           MOVE ' ' TO DC-OPTION-CODE
  7096           PERFORM 9700-DATE-LINK
  7097           IF NO-CONVERSION-ERROR
  7098              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7099              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7100           ELSE
  7101              MOVE LOW-VALUES TO NEFFDTE-SAVE
  7102        ELSE
  7103           MOVE CL-PAID-THRU-DT TO DC-BIN-DATE-1
  7104           MOVE +1 TO DC-ELAPSED-DAYS
  7105           MOVE +0 TO DC-ELAPSED-MONTHS
  7106           MOVE '6' TO DC-OPTION-CODE
  7107           PERFORM 9700-DATE-LINK
  7108           IF NO-CONVERSION-ERROR
  7109              MOVE DC-BIN-DATE-2 TO NEFFDTE-SAVE
  7110              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7111              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7112           ELSE
  7113              MOVE LOW-VALUES TO NEFFDTE-SAVE.
  7114
  7115******************************************************************
  7116*       EDIT FIRST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7117*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7118*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7119******************************************************************
  7120
  7121     IF NFSTPMTL NOT = ZEROS
  7122        MOVE NFSTPMTI            TO DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 139
* EL154.cbl
  7123        PERFORM 8600-DEEDIT
  7124        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7125        MOVE '4'                 TO DC-OPTION-CODE
  7126        PERFORM 9700-DATE-LINK
  7127        IF DATE-CONVERSION-ERROR
  7128           MOVE ER-0349          TO EMI-ERROR
  7129           MOVE -1               TO NFSTPMTL
  7130           MOVE AL-UABON         TO NFSTPMTA
  7131           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7132          ELSE
  7133           MOVE DEEDIT-FIELD-V0  TO NFSTPMTO
  7134           INSPECT NFSTPMTI CONVERTING SPACES TO '/'
  7135           MOVE AL-UANON         TO NFSTPMTA.
  7136*          MOVE DC-BIN-DATE-1    TO NFSTPMT-SAVE.
  7137
  7138     IF PI-USES-PAID-TO
  7139         MOVE '6'                TO  DC-OPTION-CODE
  7140         MOVE -1                 TO  DC-ELAPSED-DAYS
  7141         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7142         PERFORM 9700-DATE-LINK
  7143         IF NO-CONVERSION-ERROR
  7144             MOVE DC-BIN-DATE-2  TO  NFSTPMT-SAVE
  7145         ELSE
  7146             MOVE ER-0349        TO  EMI-ERROR
  7147             MOVE -1             TO  NFSTPMTL
  7148             MOVE AL-UABON       TO  NFSTPMTA
  7149             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7150     ELSE
  7151         MOVE DC-BIN-DATE-1      TO  NFSTPMT-SAVE.
  7152
  7153******************************************************************
  7154*       EDIT LAST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7155*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7156*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7157******************************************************************
  7158
  7159     IF NLSTPMTL NOT = ZEROS
  7160        MOVE NLSTPMTI            TO DEEDIT-FIELD
  7161        PERFORM 8600-DEEDIT
  7162        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7163        MOVE '4'                 TO DC-OPTION-CODE
  7164        PERFORM 9700-DATE-LINK
  7165        IF DATE-CONVERSION-ERROR
  7166           MOVE ER-0354          TO EMI-ERROR
  7167           MOVE -1               TO NLSTPMTL
  7168           MOVE AL-UABON         TO NLSTPMTA
  7169           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7170          ELSE
  7171           MOVE DEEDIT-FIELD-V0  TO NLSTPMTO
  7172           INSPECT NLSTPMTI CONVERTING SPACES TO '/'
  7173           MOVE AL-UANON         TO NLSTPMTA.
  7174
  7175     IF PI-USES-PAID-TO
  7176         MOVE '6'                TO  DC-OPTION-CODE
  7177         MOVE -1                 TO  DC-ELAPSED-DAYS
  7178         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7179         PERFORM 9700-DATE-LINK
  7180         IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 140
* EL154.cbl
  7181             MOVE DC-BIN-DATE-2  TO  NLSTPMT-SAVE
  7182         ELSE
  7183             MOVE ER-0354        TO  EMI-ERROR
  7184             MOVE -1             TO  NLSTPMTL
  7185             MOVE AL-UABON       TO  NLSTPMTA
  7186             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7187     ELSE
  7188         MOVE DC-BIN-DATE-1      TO  NLSTPMT-SAVE.
  7189
  7190******************************************************************
  7191*       EDIT FIRST PAYMENT AMOUNT
  7192******************************************************************
  7193
  7194     IF NFSTAMTL NOT = ZEROS
  7195
  7196* EXEC CICS BIF DEEDIT
  7197*          FIELD (NFSTAMTI)
  7198*          LENGTH(10)
  7199*       END-EXEC
  7200     MOVE 10
  7201       TO DFHEIV11
  7202*    MOVE '@"L                   #   #00006916' TO DFHEIV0
  7203     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7204     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7205     MOVE X'2020233030303036393136' TO DFHEIV0(25:11)
  7206     CALL 'kxdfhei1' USING DFHEIV0,
  7207           NFSTAMTI,
  7208           DFHEIV11
  7209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7210        IF NFSTAMTI NOT NUMERIC
  7211           MOVE ER-0350          TO EMI-ERROR
  7212           MOVE -1               TO NFSTAMTL
  7213           MOVE AL-UNBON         TO NFSTAMTA
  7214           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7215        ELSE
  7216           MOVE NFSTAMTI         TO NFSTAMT-SAVE
  7217                                    NFSTAMTO
  7218           MOVE AL-UNNON         TO NFSTAMTA
  7219        end-if
  7220     end-if
  7221******************************************************************
  7222*       EDIT DAY TO PAY
  7223******************************************************************
  7224
  7225     IF DAYPAYL NOT EQUAL +0
  7226        IF DAYPAYI NUMERIC AND
  7227           DAYPAYI LESS THAN 32
  7228           MOVE AL-UNNON         TO DAYPAYA
  7229        ELSE
  7230           MOVE ER-0632          TO EMI-ERROR
  7231           MOVE -1               TO DAYPAYL
  7232           MOVE AL-UNBON         TO DAYPAYA
  7233           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7234
  7235******************************************************************
  7236*       EDIT NUMBER OF DAYS IN FIRST PAYMENT PERIOD
  7237******************************************************************
  7238
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 141
* EL154.cbl
  7239     IF NDAYSFL NOT = ZEROS
  7240        IF NDAYSFI NOT NUMERIC
  7241           MOVE ER-0351          TO EMI-ERROR
  7242           MOVE -1               TO NDAYSFL
  7243           MOVE AL-UNBON         TO NDAYSFA
  7244           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7245        ELSE
  7246           MOVE AL-UNNON         TO NDAYSFA.
  7247
  7248******************************************************************
  7249*       EDIT NUMBER OF MONTHS BETWEEN PAYMENTS
  7250******************************************************************
  7251
  7252     IF NMONTHSL EQUAL +0
  7253        MOVE +1                  TO NMONTHSL
  7254        MOVE 1                   TO NMONTHSI.
  7255
  7256     IF NMONTHSL NOT = ZEROS
  7257        IF NMONTHSI NOT NUMERIC
  7258           MOVE ER-0353          TO EMI-ERROR
  7259           MOVE -1               TO NMONTHSL
  7260           MOVE AL-UNBON         TO NMONTHSA
  7261           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7262        ELSE
  7263           IF NMONTHSI NOT GREATER THAN ZERO
  7264              MOVE ER-0353          TO EMI-ERROR
  7265              MOVE -1               TO NMONTHSL
  7266              MOVE AL-UNBON         TO NMONTHSA
  7267              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7268              ELSE
  7269              MOVE AL-UNNON         TO NMONTHSA.
  7270
  7271******************************************************************
  7272*       EDIT PAYEE CODE
  7273******************************************************************
  7274
  7275     MOVE NPAYEEI TO WS-PAYEE-CODE.
  7276
  7277     IF WS-PAYEE-SEQ NOT NUMERIC
  7278        MOVE ER-0357          TO EMI-ERROR
  7279        MOVE -1               TO NPAYEEL
  7280        MOVE AL-UNBON         TO NPAYEEA
  7281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7282        GO TO 6300-EXIT.
  7283
  7284     IF WS-PAYEE-CD EQUAL 'I' AND
  7285        WS-PAYEE-SEQ-NUM EQUAL 0
  7286        MOVE ER-0357          TO EMI-ERROR
  7287        MOVE -1               TO NPAYEEL
  7288        MOVE AL-UNBON         TO NPAYEEA
  7289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7290
  7291     IF WS-PAYEE-SEQ-NUM GREATER THAN 9
  7292        MOVE ER-0357          TO EMI-ERROR
  7293        MOVE -1               TO NPAYEEL
  7294        MOVE AL-UNBON         TO NPAYEEA
  7295        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7296
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 142
* EL154.cbl
  7297     IF NPAYEEL NOT EQUAL +0
  7298        IF WS-PAYEE-CD = ('I' OR 'B' OR 'A')
  7299           MOVE AL-UNNON         TO NPAYEEA
  7300        ELSE
  7301           MOVE ER-0357          TO EMI-ERROR
  7302           MOVE -1               TO NPAYEEL
  7303           MOVE AL-UNBON         TO NPAYEEA
  7304           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7305
  7306******************************************************************
  7307*       EDIT LAST PAYMENT TYPE
  7308******************************************************************
  7309
  7310     IF NLASTL NOT = ZEROS
  7311        IF NLASTI = 'Y' OR 'N'
  7312           MOVE AL-UANON         TO NLASTA
  7313        ELSE
  7314           MOVE ER-0352          TO EMI-ERROR
  7315           MOVE -1               TO NLASTL
  7316           MOVE AL-UABON         TO NLASTA
  7317           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7318
  7319******************************************************************
  7320*       EDIT CASH / NON CASH INDICATOR
  7321******************************************************************
  7322
  7323     IF NINDCTRL NOT =  ZEROS
  7324        IF NINDCTRI  = 'Y' OR 'N'
  7325           MOVE AL-UANON         TO NINDCTRA
  7326        ELSE
  7327           MOVE ER-0815          TO EMI-ERROR
  7328           MOVE -1               TO NINDCTRL
  7329           MOVE AL-UABON         TO NINDCTRA
  7330           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7331
  7332     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7333         IF (CL-ASSOCIATES IS EQUAL TO 'A' OR 'N')
  7334             IF NINDCTRI IS EQUAL TO 'N'
  7335                 MOVE ER-3537    TO  EMI-ERROR
  7336                 MOVE -1         TO  NINDCTRL
  7337                 MOVE AL-UABON   TO  NINDCTRA
  7338                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7339
  7340******************************************************************
  7341*       EDIT LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7342******************************************************************
  7343
  7344     IF NPRINTL IS NOT EQUAL TO +0
  7345*01157         IF NPRINTI IS EQUAL TO 'N'
  7346           MOVE AL-UANON         TO  NPRINTA
  7347*01159         ELSE
  7348*01160            MOVE ER-0826          TO  EMI-ERROR
  7349*01161            MOVE -1               TO  NPRINTL
  7350*01162            MOVE AL-UABON         TO  NPRINTA
  7351*01163            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7352     END-IF.
  7353
  7354******************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 143
* EL154.cbl
  7355*    IF THE AUTO LETTER DATE IS ENTERED IT IS USED   *
  7356*    TO RESOLVE VAIABLE @@AUTOPYDT IN THE LETTER     *
  7357*    FORM THAT IS ENTERED IN THE PRINT LETTER FIELD. *
  7358******************************************************
  7359
  7360     IF LETTDTEL NOT = ZEROS
  7361        MOVE LETTDTEI            TO DEEDIT-FIELD
  7362        PERFORM 8600-DEEDIT
  7363        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7364        MOVE '4'                 TO DC-OPTION-CODE
  7365        PERFORM 9700-DATE-LINK
  7366        IF DATE-CONVERSION-ERROR
  7367           MOVE ER-3801          TO EMI-ERROR
  7368           MOVE -1               TO LETTDTEL
  7369           MOVE AL-UABON         TO LETTDTEA
  7370           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7371        ELSE
  7372           MOVE DEEDIT-FIELD-V0  TO LETTDTEO
  7373           INSPECT LETTDTEI CONVERTING SPACES TO '/'
  7374           MOVE AL-UANON         TO LETTDTEA
  7375           MOVE DC-GREG-DATE-A-EDIT TO LETTDTE-SAVE
  7376        END-IF
  7377     ELSE
  7378         MOVE SPACES TO LETTDTE-SAVE
  7379     END-IF.
  7380
  7381******************************************************************
  7382*       EDIT END LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7383******************************************************************
  7384     IF ENDLETTL NOT = ZEROS
  7385             MOVE AL-UANON          TO ENDLETTA
  7386     ELSE
  7387         IF NPRINTL NOT = ZEROS
  7388             IF NPRINTI NOT = 'N   '
  7389                 MOVE ER-3397    TO EMI-ERROR
  7390                 MOVE -1         TO ENDLETTL
  7391                 MOVE AL-UABON   TO ENDLETTA
  7392                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7393             END-IF
  7394         END-IF
  7395     END-IF.
  7396
  7397     IF NOT EMI-NO-ERRORS
  7398        GO TO 6300-EXIT.
  7399
  7400     IF PI-PROCESSOR-ID  =  LGXX-ID
  7401        GO TO 6150-READ-CARRIER.
  7402
  7403******************************************************************
  7404*       READ PROCESSOR RECORD ON THE CONTROL FILE TO GET THE
  7405*       PROCESSOR LIMITS
  7406******************************************************************
  7407
  7408
  7409* EXEC CICS HANDLE CONDITION
  7410*         NOTFND (6150-READ-CARRIER)
  7411*         NOTOPEN(8890-CNTL-NOT-OPEN)
  7412*         END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 144
* EL154.cbl
  7413*    MOVE '"$IJ                  ! ( #00007118' TO DFHEIV0
  7414     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  7415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7416     MOVE X'2820233030303037313138' TO DFHEIV0(25:11)
  7417     CALL 'kxdfhei1' USING DFHEIV0
  7418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7419
  7420
  7421
  7422* EXEC CICS READ
  7423*         DATASET(CNTL-ID)
  7424*         RIDFLD (CNTL-KEY)
  7425*         SET    (ADDRESS OF CONTROL-FILE)
  7426*         END-EXEC.
  7427*    MOVE '&"S        E          (   #00007123' TO DFHEIV0
  7428     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7430     MOVE X'2020233030303037313233' TO DFHEIV0(25:11)
  7431     CALL 'kxdfhei1' USING DFHEIV0,
  7432           CNTL-ID,
  7433           DFHEIV20,
  7434           DFHEIV99,
  7435           CNTL-KEY,
  7436           DFHEIV99,
  7437           DFHEIV99,
  7438           DFHEIV99
  7439     SET ADDRESS OF CONTROL-FILE TO
  7440         DFHEIV20
  7441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7442
  7443
  7444     MOVE CF-PROC-CALC-AMT-TOL       TO WS-AMT-TOL.
  7445     MOVE CF-PROC-CALC-DAYS-TOL      TO WS-DAY-TOL.
  7446     MOVE CF-PROC-MAX-AUTO-PMT       TO WS-MAX-AUTO-PMT.
  7447     MOVE CF-PROC-MAX-AUTO-MOS       TO WS-MAX-AUTO-MOS.
  7448     MOVE CF-PROC-MAX-REG-PMT        TO WS-REG-PMT.
  7449
  7450  6150-READ-CARRIER.
  7451******************************************************************
  7452*       READ THE CARRIER RECORD TO GET PAYMENT TOLERANCES
  7453******************************************************************
  7454
  7455     MOVE '6'                    TO CNTL-RECORD-TYPE.
  7456     MOVE SPACES                 TO CNTL-GENL.
  7457
  7458     IF CONTROL-IS-ACTUAL-CARRIER
  7459         MOVE PI-CARRIER                 TO CNTL-GEN4
  7460     ELSE
  7461         MOVE PI-CARRIER-CONTROL-LEVEL   TO CNTL-GEN4.
  7462
  7463
  7464* EXEC CICS HANDLE CONDITION
  7465*         NOTFND(6180-READ-CERT)
  7466*         END-EXEC.
  7467*    MOVE '"$I                   ! ) #00007148' TO DFHEIV0
  7468     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7469     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7470     MOVE X'2920233030303037313438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 145
* EL154.cbl
  7471     CALL 'kxdfhei1' USING DFHEIV0
  7472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7473
  7474
  7475
  7476* EXEC CICS READ
  7477*         DATASET(CNTL-ID)
  7478*         RIDFLD (CNTL-KEY)
  7479*         SET    (ADDRESS OF CONTROL-FILE)
  7480*         END-EXEC.
  7481*    MOVE '&"S        E          (   #00007152' TO DFHEIV0
  7482     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7483     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7484     MOVE X'2020233030303037313532' TO DFHEIV0(25:11)
  7485     CALL 'kxdfhei1' USING DFHEIV0,
  7486           CNTL-ID,
  7487           DFHEIV20,
  7488           DFHEIV99,
  7489           CNTL-KEY,
  7490           DFHEIV99,
  7491           DFHEIV99,
  7492           DFHEIV99
  7493     SET ADDRESS OF CONTROL-FILE TO
  7494         DFHEIV20
  7495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7496
  7497
  7498     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
  7499
  7500     IF WS-AMT-TOL = ZERO
  7501        MOVE CF-CALC-AMT-TOL     TO WS-AMT-TOL.
  7502
  7503     IF WS-DAY-TOL = ZEROS
  7504        MOVE CF-CALC-DAYS-TOL    TO WS-DAY-TOL.
  7505
  7506     IF WS-MAX-AUTO-PMT = ZEROS
  7507        MOVE CF-MAX-AUTO-PMT     TO WS-MAX-AUTO-PMT.
  7508
  7509     IF WS-MAX-AUTO-MOS = ZEROS
  7510        MOVE CF-MAX-AUTO-MOS     TO WS-MAX-AUTO-MOS.
  7511
  7512     IF WS-REG-PMT = ZEROS
  7513        MOVE CF-MAX-REG-PMT      TO WS-REG-PMT.
  7514
  7515 6180-READ-CERT.
  7516
  7517     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7518         GO TO 6190-READ-EMPLCY.
  7519
  7520
  7521* EXEC CICS HANDLE CONDITION
  7522*         NOTOPEN   (8880-CERT-NOT-OPEN)
  7523*         NOTFND    (6185-CERT-NOT-FOUND)
  7524*         END-EXEC.
  7525*    MOVE '"$JI                  ! * #00007180' TO DFHEIV0
  7526     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7527     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7528     MOVE X'2A20233030303037313830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 146
* EL154.cbl
  7529     CALL 'kxdfhei1' USING DFHEIV0
  7530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7531
  7532
  7533
  7534* EXEC CICS READ
  7535*         DATASET(CERT-ID)
  7536*         RIDFLD (CERT-KEY)
  7537*         SET    (ADDRESS OF CERTIFICATE-MASTER)
  7538*         END-EXEC.
  7539*    MOVE '&"S        E          (   #00007185' TO DFHEIV0
  7540     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7542     MOVE X'2020233030303037313835' TO DFHEIV0(25:11)
  7543     CALL 'kxdfhei1' USING DFHEIV0,
  7544           CERT-ID,
  7545           DFHEIV20,
  7546           DFHEIV99,
  7547           CERT-KEY,
  7548           DFHEIV99,
  7549           DFHEIV99,
  7550           DFHEIV99
  7551     SET ADDRESS OF CERTIFICATE-MASTER TO
  7552         DFHEIV20
  7553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7554
  7555
  7556     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7557         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
  7558         MOVE '6'                    TO  DC-OPTION-CODE
  7559         MOVE '1'                    TO  DC-END-OF-MONTH
  7560         MOVE +0                     TO  DC-ELAPSED-DAYS
  7561                                         DC-ODD-DAYS-OVER
  7562         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1
  7563         PERFORM 9700-DATE-LINK
  7564         IF NO-CONVERSION-ERROR
  7565             MOVE DC-BIN-DATE-2      TO  WS-EXP-DT
  7566         ELSE
  7567             MOVE LOW-VALUES         TO  WS-EXP-DT
  7568     ELSE
  7569         MOVE CM-AH-LOAN-EXPIRE-DT   TO  WS-EXP-DT.
  7570
  7571     move cm-ah-benefit-amt      to ws-monthly-benefit
  7572     move cm-ah-benefit-cd       to ws-ah-benefit-cd
  7573     GO TO 6200-START-FINAL-EDITS.
  7574
  7575 6185-CERT-NOT-FOUND.
  7576     MOVE ER-0206                TO EMI-ERROR.
  7577     MOVE -1                     TO NEFFDTEL.
  7578     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7579     GO TO 6300-EXIT.
  7580
  7581 6190-READ-EMPLCY.
  7582
  7583
  7584* EXEC CICS HANDLE CONDITION
  7585*        NOTOPEN   (8885-EMPLCY-NOT-OPEN)
  7586*        NOTFND    (6195-EMPLCY-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 147
* EL154.cbl
  7587*    END-EXEC.
  7588*    MOVE '"$JI                  ! + #00007218' TO DFHEIV0
  7589     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7591     MOVE X'2B20233030303037323138' TO DFHEIV0(25:11)
  7592     CALL 'kxdfhei1' USING DFHEIV0
  7593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7594
  7595
  7596     MOVE CL-CV-REFERENCE-NO     TO  EMPLCY-REFERENCE-NO.
  7597
  7598
  7599* EXEC CICS READ
  7600*        DATASET   (EMPLCY-ID)
  7601*        RIDFLD    (EMPLCY-KEY)
  7602*        SET       (ADDRESS OF POLICY-MASTER)
  7603*    END-EXEC.
  7604*    MOVE '&"S        E          (   #00007225' TO DFHEIV0
  7605     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7606     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7607     MOVE X'2020233030303037323235' TO DFHEIV0(25:11)
  7608     CALL 'kxdfhei1' USING DFHEIV0,
  7609           EMPLCY-ID,
  7610           DFHEIV20,
  7611           DFHEIV99,
  7612           EMPLCY-KEY,
  7613           DFHEIV99,
  7614           DFHEIV99,
  7615           DFHEIV99
  7616     SET ADDRESS OF POLICY-MASTER TO
  7617         DFHEIV20
  7618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7619
  7620
  7621     MOVE PM-INS-TERMINATION-DT  TO  WS-EXP-DT.
  7622     GO TO 6200-START-FINAL-EDITS.
  7623
  7624 6195-EMPLCY-NOT-FOUND.
  7625
  7626     MOVE ER-9483                TO  EMI-ERROR.
  7627     MOVE -1                     TO  NEFFDTEL.
  7628     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7629     GO TO 6300-EXIT.
  7630
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 148
* EL154.cbl
  7632 6200-START-FINAL-EDITS.
  7633
  7634******************************************************************
  7635****** VERIFY ELIMINATION PERIOD
  7636******************************************************************
  7637
  7638     IF CL-PAID-THRU-DT NOT EQUAL LOW-VALUES
  7639          GO TO 6225-CONTINUE-EDIT.
  7640
  7641     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7642         GO TO 6225-CONTINUE-EDIT.
  7643
  7644     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  7645     MOVE WS-ACCESS              TO CNTL-GENL.
  7646     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7647     MOVE '5'                    TO CNTL-RECORD-TYPE.
  7648     MOVE ZEROS                  TO CNTL-SEQ.
  7649
  7650     IF WS-BEN-CD = ZEROS
  7651         MOVE ER-0283            TO EMI-ERROR
  7652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7653         MOVE -1                 TO NFSTPMTL
  7654         MOVE AL-UNBON           TO NFSTPMTA
  7655         GO TO 6300-EXIT.
  7656
  7657     PERFORM 7200-LOCATE-BENEFIT THRU 7200-EXIT.
  7658
  7659     IF NOT BENEFIT-FOUND
  7660         MOVE ER-0283            TO EMI-ERROR
  7661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7662         MOVE -1                 TO NFSTPMTL
  7663         MOVE AL-UNBON           TO NFSTPMTA
  7664         GO TO 6300-EXIT.
  7665
  7666     MOVE CF-BENEFIT-ALPHA (SUB-1) TO PI-BENEFIT-SAVE.
  7667
  7668     IF PI-BEN-DAYS NOT NUMERIC
  7669        MOVE ZEROS               TO PI-BEN-DAYS.
  7670
  7671     IF PI-BEN-TYPE = 'R'
  7672         IF PI-BEN-DAYS IS EQUAL TO ZEROS
  7673             NEXT SENTENCE
  7674         ELSE
  7675             SUBTRACT 1 FROM PI-BEN-DAYS.
  7676
  7677     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  7678     MOVE PI-BEN-DAYS            TO DC-ELAPSED-DAYS.
  7679     MOVE +0                     TO DC-ELAPSED-MONTHS.
  7680     MOVE '6'                    TO DC-OPTION-CODE.
  7681     PERFORM 9700-DATE-LINK.
  7682     MOVE DC-BIN-DATE-2          TO RETRO-ELIM-DATE.
  7683     IF NO-EFFDTE-ENTERED
  7684        IF PI-BEN-TYPE EQUAL 'E'
  7685          MOVE  SPACES              TO  WS-ELIMINATION-SW
  7686          MOVE  DC-BIN-DATE-2       TO  NEFFDTE-SAVE
  7687          MOVE  DC-GREG-DATE-1-MDY  TO  NEFFDTEO
  7688          INSPECT NEFFDTEI CONVERTING SPACES TO '/'.
  7689
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 149
* EL154.cbl
  7690     IF PI-BEN-TYPE = 'E'
  7691         IF RETRO-ELIM-DATE GREATER THAN NEFFDTE-SAVE
  7692             MOVE ER-0541            TO EMI-ERROR
  7693             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7694             MOVE -1                 TO NEFFDTEL
  7695             MOVE AL-UNBON           TO NEFFDTEA.
  7696
  7697     IF PI-BEN-TYPE = 'R'
  7698         IF RETRO-ELIM-DATE GREATER THAN NFSTPMT-SAVE
  7699             MOVE ER-0541            TO EMI-ERROR
  7700             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7701             MOVE -1                 TO NEFFDTEL
  7702             MOVE AL-UNBON           TO NEFFDTEA.
  7703
  7704
  7705 6225-CONTINUE-EDIT.
  7706******************************************************
  7707*VERIFY THAT THE LAST PAYMENT DATE IS NOT BEYOND     *
  7708*THE EXPIRATION DATE.                                *
  7709******************************************************
  7710* FOR BIU ALLOW PAYMENT PAST EXP + 7 MONTHS
  7711     MOVE WS-EXP-DT TO DC-BIN-DATE-1.
  7712     MOVE 6         TO DC-OPTION-CODE.
  7713     MOVE 0         TO DC-ELAPSED-DAYS.
  7714     MOVE 7         TO DC-ELAPSED-MONTHS.
  7715     PERFORM 9700-DATE-LINK.
  7716     IF NO-CONVERSION-ERROR
  7717         MOVE DC-BIN-DATE-2 TO WS-EXP-DT-PLUS7
  7718     ELSE
  7719         MOVE WS-EXP-DT     TO WS-EXP-DT-PLUS7
  7720     END-IF.
  7721
  7722     IF NLSTPMT-SAVE GREATER THAN WS-EXP-DT
  7723       IF CL-CERT-ACCOUNT (9:2) = 'BI' AND
  7724                      NLSTPMT-SAVE <= WS-EXP-DT-PLUS7
  7725         IF PI-LAST-ERROR-NO EQUAL ER-3396 OR ER-0670
  7726             CONTINUE
  7727         ELSE
  7728             MOVE ER-3396             TO EMI-ERROR
  7729             MOVE AL-UABON            TO NLSTPMTA
  7730             MOVE -1                  TO NLSTPMTL
  7731             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7732         END-IF
  7733       ELSE
  7734        MOVE ER-0396             TO EMI-ERROR
  7735        MOVE AL-UABON            TO NLSTPMTA
  7736        MOVE -1                  TO NLSTPMTL
  7737        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7738        GO TO 6300-EXIT.
  7739
  7740******************************************************
  7741*VERIFY THAT THE LAST PAYMENT DATE IS GREATER THAN   *
  7742*THE FIRST PAYMENT DATE.                             *
  7743******************************************************
  7744
  7745     IF NLSTPMT-SAVE NOT GREATER THAN NFSTPMT-SAVE
  7746        MOVE ER-0559             TO EMI-ERROR
  7747        MOVE AL-UABON            TO NLSTPMTA
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 150
* EL154.cbl
  7748        MOVE -1                  TO NLSTPMTL
  7749        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7750        GO TO 6300-EXIT.
  7751
  7752******************************************************
  7753*    MAKE SURE THE DIFFERENCE BETWEEN THE FIRST      *
  7754*    PAYMENT DATE AND LAST PAYMENT DATE IS           *
  7755*    DIVISABLE BY THE INTERVAL OF MONTHS,            *
  7756*    AND THE DURATION IS IN FULL MONTH PMTS.         *
  7757******************************************************
  7758     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  7759     MOVE NLSTPMT-SAVE           TO DC-BIN-DATE-2.
  7760     MOVE '1'                    TO DC-OPTION-CODE.
  7761     PERFORM 9700-DATE-LINK.
  7762     move dc-elapsed-months      to ws-proposed-benefits
  7763     if dc-elapsed-days > 0
  7764        add 1 to ws-proposed-benefits
  7765     end-if
  7766     DIVIDE DC-ELAPSED-MONTHS BY NMONTHSI GIVING WS-WORK
  7767            REMAINDER WS-REMAINDER.
  7768     IF WS-REMAINDER NOT = 0
  7769        MOVE ER-0397             TO EMI-ERROR
  7770        MOVE -1                  TO NMONTHSL
  7771        MOVE AL-UNBON            TO NMONTHSA
  7772        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7773        GO TO 6300-EXIT.
  7774
  7775     IF DC-ODD-DAYS-OVER GREATER THAN +0
  7776        MOVE ER-0597             TO EMI-ERROR
  7777        MOVE -1                  TO NLSTPMTL
  7778        MOVE AL-UNBON            TO NLSTPMTA
  7779                                    NFSTPMTA
  7780        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7781        GO TO 6300-EXIT.
  7782
  7783******************************************************
  7784*    VERIFY THAT FIRST PAYMENT DATE IS NOT LESS      *
  7785*    THAN THE CURRENT DATE.                          *
  7786******************************************************
  7787     IF NFSTPMT-SAVE LESS THAN CURRENT-SAVE
  7788        MOVE ER-0563             TO EMI-ERROR
  7789        MOVE -1                  TO NFSTPMTL
  7790        MOVE AL-UNBON            TO NFSTPMTA
  7791        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7792        GO TO 6300-EXIT.
  7793
  7794******************************************************
  7795*                                                    *
  7796*    EDIT THE NUMBER OF DAYS IN FIRST PAYMENT        *
  7797*                                                    *
  7798******************************************************
  7799
  7800     MOVE NEFFDTE-SAVE       TO DC-BIN-DATE-1
  7801     MOVE -1                 TO DC-ELAPSED-DAYS
  7802     MOVE +0                 TO DC-ELAPSED-MONTHS
  7803     MOVE '6'                TO DC-OPTION-CODE
  7804     PERFORM 9700-DATE-LINK
  7805     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 151
* EL154.cbl
  7806        MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1.
  7807
  7808     MOVE NFSTPMT-SAVE       TO DC-BIN-DATE-2
  7809     MOVE +0                 TO DC-ELAPSED-MONTHS
  7810                                DC-ELAPSED-DAYS
  7811     MOVE '1'                TO DC-OPTION-CODE
  7812     PERFORM 9700-DATE-LINK
  7813     IF NO-CONVERSION-ERROR
  7814        MOVE DC-ELAPSED-DAYS  TO WS-ELAPSED-DAYS.
  7815
  7816     IF NDAYSFL EQUAL +0
  7817       OR
  7818        NDAYSFI NOT NUMERIC
  7819       OR
  7820        NDAYSFI EQUAL ZEROS
  7821        MOVE DC-ELAPSED-DAYS  TO NDAYSFI.
  7822
  7823     IF DATE1-GREATER-DATE2
  7824        MOVE ER-0450 TO EMI-ERROR
  7825        MOVE -1      TO NEFFDTEL
  7826        MOVE AL-UABON TO NEFFDTEA
  7827        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7828        GO TO 6300-EXIT.
  7829
  7830     ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL
  7831     SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL
  7832     IF WS-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  7833        WS-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  7834        NDAYSFI = ZEROS
  7835         MOVE ER-0398             TO EMI-ERROR
  7836         MOVE -1                  TO NDAYSFL
  7837         MOVE AL-UNBON            TO NDAYSFA
  7838         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7839         GO TO 6300-EXIT.
  7840
  7841******************************************************
  7842*                                                    *
  7843*    VERIFY OR CALCULATE THE FIRST PAYMENT AMOUNT    *
  7844*                                                    *
  7845******************************************************
  7846
  7847     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID.
  7848     MOVE NEFFDTE-SAVE          TO CP-PAID-FROM-DATE.
  7849     MOVE NFSTPMT-SAVE          TO CP-PAID-THRU-DT.
  7850     MOVE WS-CALC-METHOD        TO CP-CLAIM-CALC-METHOD.
  7851
  7852     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7853         MOVE PM-PRODUCER           TO CP-ACCOUNT-NUMBER
  7854         MOVE PM-INS-MONTH-BENEFIT  TO  CP-ORIGINAL-BENEFIT
  7855     ELSE
  7856         MOVE CM-AH-BENEFIT-AMT     TO CP-ORIGINAL-BENEFIT
  7857         MOVE CM-ACCOUNT            TO CP-ACCOUNT-NUMBER.
  7858
  7859
  7860* EXEC CICS LINK
  7861*         PROGRAM   ('ELPMNT')
  7862*         COMMAREA  (CALCULATION-PASS-AREA)
  7863*         LENGTH    (CP-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 152
* EL154.cbl
  7864*    END-EXEC.
  7865     MOVE 'ELPMNT' TO DFHEIV1
  7866*    MOVE '."C                   (   #00007469' TO DFHEIV0
  7867     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7869     MOVE X'2020233030303037343639' TO DFHEIV0(25:11)
  7870     CALL 'kxdfhei1' USING DFHEIV0,
  7871           DFHEIV1,
  7872           CALCULATION-PASS-AREA,
  7873           CP-COMM-LENGTH,
  7874           DFHEIV99,
  7875           DFHEIV99,
  7876           DFHEIV99,
  7877           DFHEIV99
  7878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7879
  7880
  7881     IF CP-CLAIM-PAYMENT NOT NUMERIC
  7882        MOVE +0 TO CP-CLAIM-PAYMENT.
  7883
  7884     IF CP-ACTUAL-DAYS NOT NUMERIC
  7885        MOVE +0 TO CP-ACTUAL-DAYS.
  7886
  7887     IF NFSTAMT-SAVE EQUAL +0
  7888        MOVE CP-CLAIM-PAYMENT TO NFSTAMT-SAVE
  7889                                 NFSTAMTO.
  7890
  7891     IF NDAYSFI EQUAL ZEROS
  7892        MOVE CP-ACTUAL-DAYS   TO NDAYSFI.
  7893
  7894
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 153
* EL154.cbl
  7896******************************************************
  7897*    VERIFY THAT DAYS IN FIRST PAY PERIOD IS REALLY  *
  7898*    THE DIFFERENCE BETWEEN THE IST PAYMENT DATE     *
  7899*    AND THE EFFECTIVE DATE                          *
  7900******************************************************
  7901*    MOVE NEFFDTE-SAVE           TO DC-BIN-DATE-1.
  7902*    MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-2.
  7903*    MOVE '1'                    TO DC-OPTION-CODE.
  7904*    PERFORM 9700-DATE-LINK.
  7905*    IF DATE1-GREATER-DATE2
  7906*       MOVE ER-0450 TO EMI-ERROR
  7907*       MOVE -1      TO NEFFDTEL
  7908*       MOVE AL-UABON TO NEFFDTEA
  7909*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7910*       GO TO 6300-EXIT.
  7911*
  7912*    ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL.
  7913*    SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL.
  7914*    IF DC-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  7915*       DC-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  7916*       NDAYSFI = ZEROS
  7917*        MOVE ER-0398             TO EMI-ERROR
  7918*        MOVE -1                  TO NDAYSFL
  7919*        MOVE AL-UNBON            TO NDAYSFA
  7920*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7921*        GO TO 6300-EXIT.
  7922*
  7923******************************************************
  7924*   VERIFY THAT THE FIRST PAYMENT AMOUNT IS WITHIN   *
  7925*   THE TOLERANCE OF THE DAILY BENEFITS              *
  7926******************************************************
  7927*    IF CL-PMT-CALC-METHOD = '2' OR '5'
  7928*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 365
  7929*    ELSE
  7930*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 360.
  7931
  7932     IF WS-AMT-TOL NOT = ZEROS
  7933        COMPUTE WS-AMT-PLUS-TOL = (NFSTAMT-SAVE + WS-AMT-TOL)
  7934        COMPUTE WS-AMT-MINUS-TOL = (NFSTAMT-SAVE - WS-AMT-TOL)
  7935        IF CP-CLAIM-PAYMENT LESS THAN WS-AMT-MINUS-TOL OR
  7936           CP-CLAIM-PAYMENT GREATER THAN WS-AMT-PLUS-TOL OR
  7937           NFSTAMT-SAVE = +0
  7938           MOVE ER-0399          TO EMI-ERROR
  7939           MOVE -1               TO NFSTAMTL
  7940           MOVE AL-UNBON         TO NFSTAMTA
  7941           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7942           GO TO 6300-EXIT.
  7943
  7944******************************************************
  7945*   VERIFY THERE IS AN ADDR TRAILER AVAILABLE        *
  7946*   FOR THE PAYEE CODE SPECIFIED                     *
  7947******************************************************
  7948     IF (WS-PAYEE-CD EQUAL 'I' AND
  7949        WS-PAYEE-SEQ-NUM GREATER THAN CL-INSURED-ADDR-CNT)
  7950       OR
  7951        (WS-PAYEE-CD EQUAL 'B' AND
  7952        WS-PAYEE-SEQ-NUM GREATER THAN CL-BENIF-ADDR-CNT)
  7953       OR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 154
* EL154.cbl
  7954        (WS-PAYEE-CD EQUAL 'A' AND
  7955        WS-PAYEE-SEQ-NUM GREATER THAN CL-ACCOUNT-ADDR-CNT)
  7956        GO TO 6250-ADDR-ERROR.
  7957
  7958     IF (WS-PAYEE-CD EQUAL 'I')
  7959       OR
  7960        ((WS-PAYEE-CD EQUAL 'B' OR 'A') AND
  7961        (WS-PAYEE-SEQ-NUM GREATER THAN 0))
  7962        GO TO 6260-CONT.
  7963
  7964     IF WS-PAYEE-CD EQUAL 'A'
  7965        GO TO 6260-CONT.
  7966
  7967     IF (WS-PAYEE-CD EQUAL 'B' AND
  7968        CL-BENEFICIARY EQUAL SPACES)
  7969        GO TO 6250-ADDR-ERROR.
  7970
  7971     MOVE PI-COMPANY-CD          TO BENE-CO.
  7972     MOVE 'B'                    TO BENE-REC-TYPE.
  7973     MOVE CL-BENEFICIARY         TO BENE-CODE.
  7974
  7975
  7976* EXEC CICS HANDLE CONDITION
  7977*         NOTFND   (6250-ADDR-ERROR)
  7978*         END-EXEC.
  7979*    MOVE '"$I                   ! , #00007569' TO DFHEIV0
  7980     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7982     MOVE X'2C20233030303037353639' TO DFHEIV0(25:11)
  7983     CALL 'kxdfhei1' USING DFHEIV0
  7984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7985
  7986
  7987
  7988* EXEC CICS READ
  7989*         DATASET     (BENE-ID)
  7990*         SET         (ADDRESS OF BENEFICIARY-MASTER)
  7991*         RIDFLD      (BENE-KEY)
  7992*         END-EXEC.
  7993*    MOVE '&"S        E          (   #00007573' TO DFHEIV0
  7994     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7995     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7996     MOVE X'2020233030303037353733' TO DFHEIV0(25:11)
  7997     CALL 'kxdfhei1' USING DFHEIV0,
  7998           BENE-ID,
  7999           DFHEIV20,
  8000           DFHEIV99,
  8001           BENE-KEY,
  8002           DFHEIV99,
  8003           DFHEIV99,
  8004           DFHEIV99
  8005     SET ADDRESS OF BENEFICIARY-MASTER TO
  8006         DFHEIV20
  8007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8008
  8009
  8010     GO TO 6260-CONT.
  8011
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 155
* EL154.cbl
  8012 6250-ADDR-ERROR.
  8013     IF (PI-COMPANY-ID EQUAL 'AIG' OR 'AUK' OR 'CIG' OR 'CUK')
  8014         IF (WS-PAYEE-CD EQUAL 'B')   AND
  8015            (WS-PAYEE-SEQ-NUM EQUAL 9)
  8016             GO TO 6260-CONT.
  8017
  8018     MOVE ER-0401         TO EMI-ERROR.
  8019     MOVE -1              TO NPAYEEL.
  8020     MOVE AL-UNBON        TO NPAYEEA.
  8021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8022
  8023 6260-CONT.
  8024******************************************************
  8025*   VERIFY THAT THE EFFECTIVE DATE IS NOT            *
  8026*   BEFORE THE INCURRED DATE                         *
  8027******************************************************
  8028     IF NEFFDTE-SAVE LESS THAN CL-INCURRED-DT
  8029        MOVE ER-0402             TO EMI-ERROR
  8030        MOVE -1                  TO NEFFDTEL
  8031        MOVE AL-UABON            TO NEFFDTEA
  8032        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8033
  8034******************************************************
  8035*   VERIFY THAT THE CLAIM HAS NOT BEEN CLOSED.       *
  8036******************************************************
  8037     IF CLAIM-IS-CLOSED
  8038        MOVE ER-1599            TO EMI-ERROR
  8039        MOVE -1                  TO TERML
  8040        MOVE AL-UABON            TO TERMA
  8041        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8042
  8043******************************************************
  8044*  VERIFY THAT THE EFFECTIVE DATE IS                 *
  8045*  SUBSEQUENT TO THE PAID-THRU DATE                  *
  8046******************************************************
  8047     IF NEFFDTE-SAVE NOT GREATER THAN CL-PAID-THRU-DT
  8048        MOVE ER-0403             TO EMI-ERROR
  8049        MOVE -1                  TO NEFFDTEL
  8050        MOVE AL-UABON            TO NEFFDTEA
  8051        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8052
  8053******************************************************
  8054*  VERIFY THAT THE NUMBER OF MONTHS BETWEEN          *
  8055*  THE EFFECTIVE DATE AND THE LAST PAYMENT DATE      *
  8056*  IS NOT GREATER THAN THE MAXIMUM ALLOWED           *
  8057******************************************************
  8058     IF WS-MAX-AUTO-MOS NOT = ZEROS
  8059        MOVE NEFFDTE-SAVE        TO DC-BIN-DATE-1
  8060        MOVE NLSTPMT-SAVE        TO DC-BIN-DATE-2
  8061        MOVE '1'                 TO DC-OPTION-CODE
  8062        PERFORM 9700-DATE-LINK
  8063        IF DC-ELAPSED-MONTHS GREATER THAN WS-MAX-AUTO-MOS
  8064           MOVE ER-0404             TO EMI-ERROR
  8065           MOVE -1                  TO NEFFDTEL
  8066           MOVE AL-UABON            TO NEFFDTEA NLSTPMTA
  8067           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8068
  8069******************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 156
* EL154.cbl
  8070*  VERIFY THAT THE CERTIFICATE DOES NOT HAVE A       *
  8071*  CURRENT STATUS OF '8' (CANCEL APPLIED)            *
  8072******************************************************
  8073
  8074     IF PI-COMPANY-ID IS EQUAL TO 'HAN' OR 'LGX'
  8075         IF CM-AH-CANCEL-APPLIED
  8076             MOVE ER-0839            TO  EMI-ERROR
  8077             MOVE -1                 TO  ENTERPFL
  8078             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8079******************************************************************
  8080*   check to see if the pd thru dates are past the benefit exp dt
  8081******************************************************************
  8082
  8083     if pi-company-id not = 'DCC' and 'CAP'
  8084        GO TO 6300-bypass-dcc
  8085     END-IF
  8086
  8087     move zeros                  to ws-max-benefit-amt
  8088                                    ws-max-benefit-pmts
  8089     perform 6320-read-acct      thru 6320-exit
  8090     if ws-dcc-product-code not = spaces
  8091        perform 6340-GET-DDF-LIMITS
  8092                                 thru 6340-exit
  8093        if pdef-found
  8094           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8095              (P1 > +8)
  8096              OR (PD-PROD-CODE (P1) = cl-claim-type)
  8097           END-PERFORM
  8098           IF P1 < +9
  8099              if pd-ben-pct (p1) not numeric
  8100                 move zeros      to pd-ben-pct (p1)
  8101              end-if
  8102              if pd-ben-pct (p1) = zeros
  8103                 move +1         to ws-work-ben-pct
  8104              else
  8105                 move pd-ben-pct (p1)
  8106                                 to ws-work-ben-pct
  8107              end-if
  8108              MOVE PD-MAX-AMT (P1)
  8109                                 TO ws-max-benefit-amt
  8110              compute ws-monthly-benefit =
  8111                 ws-monthly-benefit * ws-work-ben-pct
  8112              if ws-monthly-benefit > pd-max-amt (p1)
  8113                 move pd-max-amt (p1) to ws-monthly-benefit
  8114              end-if
  8115              move pd-crit-period (p1)
  8116                                 to ws-max-benefit-pmts
  8117           else
  8118              move er-1674       to emi-error
  8119              PERFORM 9900-ERROR-FORMAT
  8120                                 THRU 9900-EXIT
  8121           END-IF
  8122        else
  8123           move er-1672          to emi-error
  8124           PERFORM 9900-ERROR-FORMAT
  8125                                 THRU 9900-EXIT
  8126        END-IF
  8127     end-if
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 157
* EL154.cbl
  8128*    if (ws-max-benefit-amt not = zeros)
  8129*       and (ws-max-benefit-amt < ws-monthly-benefit)
  8130*       move ws-max-benefit-amt  to ws-monthly-benefit
  8131*    end-if
  8132     perform 6350-get-cert-trlr  thru 6350-exit
  8133
  8134     if (nfstamt-save = zeros)
  8135        or (nfstamt-save = cp-claim-payment)
  8136        move ws-monthly-benefit  to nfstamt-save
  8137                                    nfstamto
  8138     end-if
  8139
  8140     compute ws-edit-1st-pmt-amt rounded =
  8141        ws-monthly-benefit * (ndaysfi / 30)
  8142     if nfstamt-save > ws-edit-1st-pmt-amt
  8143        move er-1657             to emi-error
  8144        move -1                  to nfstamtl
  8145        move al-unbon            to nfstamta
  8146        perform 9900-error-format
  8147                                 thru 9900-exit
  8148     end-if
  8149
  8150     if nfstamt-save = zeros
  8151        move ws-monthly-benefit to nfstamt-save
  8152     end-if
  8153
  8154     move cm-ah-loan-expire-dt   to ws-benefit-expiration-dt
  8155     IF CL-CRITICAL-PERIOD NOT = ZEROS and spaces
  8156        move cl-critical-period  to dc-elapsed-months
  8157        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
  8158        MOVE ZEROS               TO DC-ELAPSED-DAYS
  8159        MOVE '6'                 TO DC-OPTION-CODE
  8160        PERFORM 9700-DATE-LINK
  8161        MOVE DC-BIN-DATE-2       TO ws-BENEFIT-EXPIRATION-DT
  8162     END-IF
  8163
  8164     if nlstpmt-save > ws-benefit-expiration-dt
  8165        move er-1658             to emi-error
  8166        move -1                  to nlstpmtl
  8167        move al-uabon            to nlstpmta
  8168        perform 9900-error-format thru 9900-exit
  8169     end-if
  8170
  8171     MOVE cl-control-primary     TO ELTRLR-KEY
  8172     MOVE +95                    TO TRLR-SEQ-NO
  8173
  8174* EXEC CICS READ
  8175*       DATASET  ('ELTRLR')
  8176*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8177*       RIDFLD   (ELTRLR-KEY)
  8178*       RESP     (WS-RESPONSE)
  8179*    END-EXEC
  8180     MOVE 'ELTRLR' TO DFHEIV1
  8181*    MOVE '&"S        E          (  N#00007742' TO DFHEIV0
  8182     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8184     MOVE X'204E233030303037373432' TO DFHEIV0(25:11)
  8185     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 158
* EL154.cbl
  8186           DFHEIV1,
  8187           DFHEIV20,
  8188           DFHEIV99,
  8189           ELTRLR-KEY,
  8190           DFHEIV99,
  8191           DFHEIV99,
  8192           DFHEIV99
  8193     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8194         DFHEIV20
  8195     MOVE EIBRESP  TO WS-RESPONSE
  8196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8197
  8198     if ws-resp-normal
  8199        perform varying s1 from +1 by +1 until
  8200           at-note-error-no (s1) = spaces
  8201           if at-note-error-no (s1) not = '1661' and '1662'
  8202           move at-note-error-no (s1)
  8203                                 to emi-error
  8204           if at-note-error-no (s1) = '1653'
  8205              evaluate true
  8206                 when cl-claim-type = 'L'
  8207                    move '  LF  '
  8208                                 to emi-claim-type
  8209                 when cl-claim-type = 'I'
  8210                    move '  IU  '
  8211                                 to emi-claim-type
  8212                 when cl-claim-type = 'F'
  8213                    move '  FL  '
  8214                                 to emi-claim-type
  8215                 when other
  8216                    move '  AH  '
  8217                                 to emi-claim-type
  8218              end-evaluate
  8219           end-if
  8220           move -1               to nlstpmtl
  8221           PERFORM 9900-ERROR-FORMAT
  8222                                 THRU 9900-EXIT
  8223           end-if
  8224        end-perform
  8225     end-if
  8226     go to 6300-exit
  8227     .
  8228 6300-bypass-dcc.
  8229
  8230
  8231     perform 6350-get-cert-trlr  thru 6350-exit
  8232
  8233     compute ws-benefits-prev-paid = ws-benefits-prev-paid +
  8234        (nfstamt-save / ws-monthly-benefit)
  8235     if cl-critical-period > zeros
  8236        if (ws-benefits-prev-paid + ws-proposed-benefits) >
  8237           cl-critical-period
  8238           move er-1658          to emi-error
  8239           move -1               to nlstpmtl
  8240           move al-uabon         to nlstpmta
  8241           perform 9900-error-format
  8242                                 thru 9900-exit
  8243        end-if
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 159
* EL154.cbl
  8244     end-if
  8245     .
  8246 6300-EXIT.
  8247      EXIT.
  8248 6320-read-acct.
  8249
  8250     move spaces              to WS-ACCT-RECORD-SW
  8251                                 ws-dcc-product-code
  8252                                 ws-clp-state
  8253
  8254     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
  8255     MOVE PI-CARRIER          TO ACCT-CARRIER
  8256     MOVE PI-GROUPING         TO ACCT-GROUPING
  8257     MOVE PI-STATE            TO ACCT-STATE
  8258     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
  8259     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
  8260     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
  8261
  8262
  8263* EXEC CICS READ
  8264*       DATASET ('ERACCT')
  8265*       RIDFLD  (ERACCT-KEY)
  8266*       SET     (ADDRESS OF ACCOUNT-MASTER)
  8267*       GTEQ
  8268*       resp    (WS-RESPONSE)
  8269*    END-EXEC
  8270     MOVE 'ERACCT' TO DFHEIV1
  8271*    MOVE '&"S        G          (  N#00007813' TO DFHEIV0
  8272     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8273     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8274     MOVE X'204E233030303037383133' TO DFHEIV0(25:11)
  8275     CALL 'kxdfhei1' USING DFHEIV0,
  8276           DFHEIV1,
  8277           DFHEIV20,
  8278           DFHEIV99,
  8279           ERACCT-KEY,
  8280           DFHEIV99,
  8281           DFHEIV99,
  8282           DFHEIV99
  8283     SET ADDRESS OF ACCOUNT-MASTER TO
  8284         DFHEIV20
  8285     MOVE EIBRESP  TO WS-RESPONSE
  8286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8287     IF WS-RESP-NORMAL
  8288        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
  8289        and pi-cert-eff-dt < am-expiration-dt
  8290        and pi-cert-eff-dt >= am-effective-dt
  8291        move am-dcc-product-code to ws-dcc-product-code
  8292        move am-dcc-clp-state    to ws-clp-state
  8293        set acct-found           to true
  8294     end-if
  8295
  8296     .
  8297 6320-exit.
  8298     exit.
  8299
  8300 6340-GET-DDF-LIMITS.
  8301
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 160
* EL154.cbl
  8302     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8303     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8304     MOVE pi-state               TO ERPDEF-STATE
  8305     if ws-clp-state not = pi-state and spaces and zeros
  8306        move ws-clp-state        to erpdef-state
  8307     end-if
  8308     MOVE WS-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8309     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8310     MOVE ws-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8311     MOVE pi-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8312
  8313     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8314
  8315
  8316* EXEC CICS STARTBR
  8317*        DATASET  ('ERPDEF')
  8318*        RIDFLD   (ERPDEF-KEY)
  8319*        GTEQ
  8320*        RESP     (WS-RESPONSE)
  8321*    END-EXEC
  8322     MOVE 'ERPDEF' TO DFHEIV1
  8323     MOVE 0
  8324       TO DFHEIV11
  8325*    MOVE '&,         G          &  N#00007848' TO DFHEIV0
  8326     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8327     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8328     MOVE X'204E233030303037383438' TO DFHEIV0(25:11)
  8329     CALL 'kxdfhei1' USING DFHEIV0,
  8330           DFHEIV1,
  8331           ERPDEF-KEY,
  8332           DFHEIV99,
  8333           DFHEIV11,
  8334           DFHEIV99
  8335     MOVE EIBRESP  TO WS-RESPONSE
  8336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8337
  8338     IF NOT WS-RESP-NORMAL
  8339        GO TO 6340-EXIT
  8340     END-IF
  8341
  8342     .
  8343 6340-READNEXT.
  8344
  8345
  8346* EXEC CICS READNEXT
  8347*       DATASET  ('ERPDEF')
  8348*       SET      (ADDRESS OF PRODUCT-MASTER)
  8349*       RIDFLD   (ERPDEF-KEY)
  8350*       RESP     (WS-RESPONSE)
  8351*    END-EXEC
  8352     MOVE 'ERPDEF' TO DFHEIV1
  8353     MOVE 0
  8354       TO DFHEIV11
  8355*    MOVE '&.S                   )  N#00007862' TO DFHEIV0
  8356     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8357     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8358     MOVE X'204E233030303037383632' TO DFHEIV0(25:11)
  8359     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 161
* EL154.cbl
  8360           DFHEIV1,
  8361           DFHEIV20,
  8362           DFHEIV99,
  8363           ERPDEF-KEY,
  8364           DFHEIV99,
  8365           DFHEIV11,
  8366           DFHEIV99,
  8367           DFHEIV99
  8368     SET ADDRESS OF PRODUCT-MASTER TO
  8369         DFHEIV20
  8370     MOVE EIBRESP  TO WS-RESPONSE
  8371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8372
  8373     IF NOT WS-RESP-NORMAL
  8374        GO TO 6340-ENDBR
  8375     END-IF
  8376
  8377     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8378        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8379           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8380        ELSE
  8381           GO TO 6340-READNEXT
  8382        END-IF
  8383     ELSE
  8384        GO TO 6340-ENDBR
  8385     END-IF
  8386     .
  8387 6340-ENDBR.
  8388
  8389
  8390* EXEC CICS ENDBR
  8391*       DATASET  ('ERPDEF')
  8392*    END-EXEC
  8393     MOVE 'ERPDEF' TO DFHEIV1
  8394     MOVE 0
  8395       TO DFHEIV11
  8396*    MOVE '&2                    $   #00007885' TO DFHEIV0
  8397     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8398     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8399     MOVE X'2020233030303037383835' TO DFHEIV0(25:11)
  8400     CALL 'kxdfhei1' USING DFHEIV0,
  8401           DFHEIV1,
  8402           DFHEIV11,
  8403           DFHEIV99
  8404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8405
  8406     .
  8407 6340-EXIT.
  8408     EXIT.
  8409
  8410 6350-get-cert-trlr.
  8411
  8412     move spaces                 to ws-cert-trlr-sw
  8413     move zeros                  to ws-benefits-prev-paid
  8414                                    ws-total-paid
  8415     move cl-cert-key-data       to elcrtt-key (2:21)
  8416     move cl-company-cd          to ctrlr-comp-cd
  8417     move cl-cert-no             to ctrlr-cert-no
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 162
* EL154.cbl
  8418     move 'B'                    to ctrlr-rec-type
  8419
  8420
  8421* EXEC CICS READ
  8422*       DATASET  ('ELCRTT')
  8423*       set      (address of CERTIFICATE-TRAILERS)
  8424*       RIDFLD   (ELCRTT-KEY)
  8425*       RESP     (WS-RESPONSE)
  8426*    END-EXEC
  8427     MOVE 'ELCRTT' TO DFHEIV1
  8428*    MOVE '&"S        E          (  N#00007903' TO DFHEIV0
  8429     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8431     MOVE X'204E233030303037393033' TO DFHEIV0(25:11)
  8432     CALL 'kxdfhei1' USING DFHEIV0,
  8433           DFHEIV1,
  8434           DFHEIV20,
  8435           DFHEIV99,
  8436           ELCRTT-KEY,
  8437           DFHEIV99,
  8438           DFHEIV99,
  8439           DFHEIV99
  8440     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8441         DFHEIV20
  8442     MOVE EIBRESP  TO WS-RESPONSE
  8443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8444     IF not WS-RESP-NORMAL
  8445        go to 6350-exit
  8446     end-if
  8447
  8448     set cert-trlr-found         to true
  8449     perform varying s1 from +1 by +1 until
  8450        (s1 > +24)
  8451        or (cs-claim-no (s1) = spaces)
  8452        if (cs-benefit-period (s1) = cl-benefit-period)
  8453           and (cs-claim-type (s1) = cl-claim-type)
  8454           and (cs-insured-type (s1) = cl-insured-type)
  8455           compute ws-total-paid =
  8456              ws-total-paid + cs-total-paid (s1)
  8457        end-if
  8458     end-perform
  8459     compute ws-benefits-prev-paid =
  8460        (ws-total-paid / ws-monthly-benefit)
  8461     .
  8462 6350-exit.
  8463     exit.
  8464 6400-PAYMENT-CALCULATION.
  8465
  8466     IF WS-CALC-METHOD = '1' OR '2' OR '3' OR '4' OR '5' OR '6'
  8467         IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  8468             COMPUTE NREGPMT-SAVE ROUNDED =
  8469                 (PM-INS-MONTH-BENEFIT * NMONTHSI)
  8470             MOVE NREGPMT-SAVE   TO  NREGAMTO
  8471             GO TO 6499-EXIT
  8472         ELSE
  8473             COMPUTE NREGPMT-SAVE ROUNDED =
  8474                 (ws-monthly-benefit * NMONTHSI)
  8475             MOVE NREGPMT-SAVE   TO  NREGAMTO
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 163
* EL154.cbl
  8476             GO TO 6499-EXIT.
  8477
  8478     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8479     MOVE +0                     TO DC-ELAPSED-DAYS.
  8480     MOVE NMONTHSI               TO DC-ELAPSED-MONTHS.
  8481     MOVE '6'                    TO DC-OPTION-CODE.
  8482     PERFORM 9700-DATE-LINK.
  8483
  8484     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8485     MOVE '1'                    TO DC-OPTION-CODE.
  8486     PERFORM 9700-DATE-LINK.
  8487
  8488     IF (PI-COMPANY-ID  = 'FIA' AND
  8489        CL-CERT-ACCOUNT = '0000011043')
  8490        COMPUTE WS-DAILY-RATE ROUNDED =
  8491                             (CM-AH-BENEFIT-AMT * 13) / 365
  8492        COMPUTE NREGPMT-SAVE ROUNDED =
  8493                             WS-DAILY-RATE * DC-ELAPSED-DAYS
  8494        MOVE NREGPMT-SAVE  TO  NREGAMTO
  8495        GO TO 6499-EXIT.
  8496
  8497*    IF WS-CALC-METHOD = '4'
  8498*       COMPUTE WS-DAILY-RATE ROUNDED =
  8499*                            (CM-AH-BENEFIT-AMT / 30)
  8500*       COMPUTE NREGPMT-SAVE ROUNDED =
  8501*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8502*
  8503*    IF WS-CALC-METHOD = '5'
  8504*       COMPUTE WS-DAILY-RATE ROUNDED =
  8505*                            (CM-AH-BENEFIT-AMT * 12) / 365
  8506*       COMPUTE NREGPMT-SAVE ROUNDED =
  8507*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8508
  8509 6499-EXIT.
  8510      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 164
* EL154.cbl
  8512 6900-SET-CODES.
  8513     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  8514                                    ACTV-CLAIM.
  8515
  8516     MOVE PI-COMPANY-ID          TO CNTL-CO.
  8517
  8518     MOVE PI-COMPANY-CD          TO CLAM-CO
  8519                                    ACTV-CO
  8520                                    CERT-CO
  8521                                    EMPLCY-COMPANY-CD.
  8522
  8523     MOVE PI-CARRIER             TO CLAM-CARRIER
  8524                                    ACTV-CARRIER
  8525                                    CERT-CARRIER
  8526                                    EMPLCY-CARRIER.
  8527
  8528     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  8529                                    ACTV-CERT-NUM
  8530                                    CERT-CERT-NUM.
  8531
  8532     MOVE PI-GROUPING            TO CERT-GROUPING
  8533                                    EMPLCY-GROUPING.
  8534     MOVE PI-STATE               TO CERT-STATE
  8535                                    EMPLCY-STATE.
  8536     MOVE PI-ACCOUNT             TO CERT-ACCOUNT
  8537                                    EMPLCY-PRODUCER.
  8538     MOVE PI-CERT-EFF-DT         TO CERT-EFF-DT
  8539                                    EMPLCY-EFF-DT.
  8540     MOVE '2'                    TO CNTL-RECORD-TYPE.
  8541     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
  8542     MOVE ZEROS                  TO CNTL-SEQ.
  8543
  8544 6999-EXIT.
  8545      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 165
* EL154.cbl
  8547 7000-BUILD-SCREEN.
  8548     PERFORM 6900-SET-CODES.
  8549
  8550
  8551* EXEC CICS HANDLE CONDITION
  8552*         NOTOPEN(8860-CLAM-NOT-OPEN)
  8553*         NOTFND (7090-CLAIM-NOT-FOUND)
  8554*         END-EXEC.
  8555*    MOVE '"$JI                  ! - #00008015' TO DFHEIV0
  8556     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8557     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8558     MOVE X'2D20233030303038303135' TO DFHEIV0(25:11)
  8559     CALL 'kxdfhei1' USING DFHEIV0
  8560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8561
  8562
  8563
  8564* EXEC CICS READ
  8565*         DATASET(CLAM-ID)
  8566*         SET    (ADDRESS OF CLAIM-MASTER)
  8567*         RIDFLD (CLAM-KEY)
  8568*         END-EXEC.
  8569*    MOVE '&"S        E          (   #00008020' TO DFHEIV0
  8570     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8572     MOVE X'2020233030303038303230' TO DFHEIV0(25:11)
  8573     CALL 'kxdfhei1' USING DFHEIV0,
  8574           CLAM-ID,
  8575           DFHEIV20,
  8576           DFHEIV99,
  8577           CLAM-KEY,
  8578           DFHEIV99,
  8579           DFHEIV99,
  8580           DFHEIV99
  8581     SET ADDRESS OF CLAIM-MASTER TO
  8582         DFHEIV20
  8583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8584
  8585
  8586     MOVE CL-CLAIM-NO            TO CLAIMO
  8587     MOVE CL-CERT-PRIME          TO CERTO
  8588     MOVE CL-CERT-SFX            TO SUFFIXO
  8589     MOVE CL-CARRIER             TO CARRO
  8590     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  8591
  8592     IF ACTV-SEQ = ZEROS
  8593        GO TO 7080-NO-TRAILER.
  8594
  8595
  8596* EXEC CICS HANDLE CONDITION
  8597*         NOTOPEN(8870-ACTV-NOT-OPEN)
  8598*         NOTFND (7080-NO-TRAILER)
  8599*         END-EXEC.
  8600*    MOVE '"$JI                  ! . #00008035' TO DFHEIV0
  8601     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8603     MOVE X'2E20233030303038303335' TO DFHEIV0(25:11)
  8604     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 166
* EL154.cbl
  8605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8606
  8607
  8608
  8609* EXEC CICS READ
  8610*         DATASET(ACTV-ID)
  8611*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  8612*         RIDFLD (ACTV-KEY)
  8613*    END-EXEC.
  8614*    MOVE '&"S        E          (   #00008040' TO DFHEIV0
  8615     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8617     MOVE X'2020233030303038303430' TO DFHEIV0(25:11)
  8618     CALL 'kxdfhei1' USING DFHEIV0,
  8619           ACTV-ID,
  8620           DFHEIV20,
  8621           DFHEIV99,
  8622           ACTV-KEY,
  8623           DFHEIV99,
  8624           DFHEIV99,
  8625           DFHEIV99
  8626     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8627         DFHEIV20
  8628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8629
  8630
  8631     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
  8632     MOVE SPACE                  TO DC-OPTION-CODE.
  8633     PERFORM 9700-DATE-LINK.
  8634     MOVE DC-GREG-DATE-1-EDIT    TO CESTDTEI.
  8635
  8636
  8637     MOVE AT-SCHEDULE-START-DT   TO DC-BIN-DATE-1.
  8638     MOVE SPACE                  TO DC-OPTION-CODE.
  8639     PERFORM 9700-DATE-LINK.
  8640     MOVE DC-GREG-DATE-1-EDIT    TO CEFFDTEI.
  8641
  8642     IF AT-AUTO-PAY-DAY NUMERIC
  8643         MOVE AT-AUTO-PAY-DAY    TO DAY2PAYI
  8644     ELSE
  8645         MOVE ZEROS              TO DAY2PAYI.
  8646
  8647     IF PI-USES-PAID-TO
  8648         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8649         MOVE '6'                     TO  DC-OPTION-CODE
  8650         MOVE +1                      TO  DC-ELAPSED-DAYS
  8651         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8652         PERFORM 9700-DATE-LINK
  8653         IF NO-CONVERSION-ERROR
  8654             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
  8655         ELSE
  8656             MOVE LOW-VALUES          TO  CFSTPMTI
  8657     ELSE
  8658         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8659         MOVE SPACE                   TO  DC-OPTION-CODE
  8660         PERFORM 9700-DATE-LINK
  8661         IF NO-CONVERSION-ERROR
  8662             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 167
* EL154.cbl
  8663         ELSE
  8664             MOVE LOW-VALUES          TO  CFSTPMTI.
  8665
  8666     IF PI-USES-PAID-TO
  8667         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8668         MOVE '6'                     TO  DC-OPTION-CODE
  8669         MOVE +1                      TO  DC-ELAPSED-DAYS
  8670         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8671         PERFORM 9700-DATE-LINK
  8672         IF NO-CONVERSION-ERROR
  8673             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8674         ELSE
  8675             MOVE LOW-VALUES          TO  CLSTPMTI
  8676     ELSE
  8677         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8678         MOVE SPACE                   TO  DC-OPTION-CODE
  8679         MOVE +0                      TO  DC-ELAPSED-DAYS
  8680                                          DC-ELAPSED-MONTHS
  8681         PERFORM 9700-DATE-LINK
  8682         IF NO-CONVERSION-ERROR
  8683             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8684         ELSE
  8685             MOVE LOW-VALUES          TO  CLSTPMTI.
  8686
  8687     MOVE AT-FIRST-PMT-AMT       TO CFSTAMTO.
  8688     MOVE AT-DAYS-IN-1ST-PMT     TO CDAYSFO.
  8689
  8690     IF AT-LAST-PMT-TYPE = 'F'
  8691        MOVE 'Y'                 TO CLASTO
  8692     ELSE
  8693        MOVE 'N'                 TO CLASTO.
  8694
  8695     MOVE AT-RECORDED-BY         TO CESTBYO.
  8696     MOVE AT-REGULAR-PMT-AMT     TO CREGPMTO.
  8697     MOVE AT-AUTO-CASH           TO CINDCTRO.
  8698
  8699     MOVE AT-AUTO-END-LETTER     TO PRINTI
  8700                                    PI-AUTO-END-LETTER.
  8701
  8702     IF AT-AUTO-PAYEE-TYPE EQUAL 'I'
  8703        MOVE 'INSURED'           TO CPAYEEO
  8704     ELSE
  8705     IF AT-AUTO-PAYEE-TYPE EQUAL 'B'
  8706        MOVE 'BENEFIC'           TO CPAYEEO
  8707     ELSE
  8708     IF AT-AUTO-PAYEE-TYPE EQUAL 'A'
  8709        MOVE 'ACCOUNT'           TO CPAYEEO.
  8710
  8711     MOVE AT-INTERVAL-MONTHS     TO CMONTHSO.
  8712     MOVE -1                     TO TERML.
  8713     GO TO 8100-SEND-INITIAL-MAP.
  8714
  8715 7080-NO-TRAILER.
  8716     MOVE 'A'                    TO TERMI.
  8717     MOVE AL-PADON               TO TERMA
  8718                                    PRINTA.
  8719     MOVE -1                     TO NFSTPMTL.
  8720     MOVE ER-0346                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 168
* EL154.cbl
  8721     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8722     GO TO 8100-SEND-INITIAL-MAP.
  8723
  8724 7090-CLAIM-NOT-FOUND.
  8725     MOVE ER-0186                TO EMI-ERROR.
  8726     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8727     GO TO 8100-SEND-INITIAL-MAP.
  8728
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 169
* EL154.cbl
  8730 7100-CHECK-AUTO-ACTIVITY.
  8731
  8732
  8733* EXEC CICS HANDLE CONDITION
  8734*        NOTFND   (7100-NOT-FOUND)
  8735*    END-EXEC.
  8736*    MOVE '"$I                   ! / #00008147' TO DFHEIV0
  8737     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8738     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8739     MOVE X'2F20233030303038313437' TO DFHEIV0(25:11)
  8740     CALL 'kxdfhei1' USING DFHEIV0
  8741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8742
  8743
  8744     MOVE PI-COMPANY-ID          TO  CNTL-CO.
  8745     MOVE 'T'                    TO  CNTL-RECORD-TYPE.
  8746     MOVE SPACES                 TO  CNTL-GENL.
  8747     MOVE +0                     TO  CNTL-SEQ.
  8748
  8749
  8750* EXEC CICS READ
  8751*        DATASET   (CNTL-ID)
  8752*        RIDFLD    (CNTL-KEY)
  8753*        SET       (ADDRESS OF CONTROL-FILE)
  8754*    END-EXEC.
  8755*    MOVE '&"S        E          (   #00008156' TO DFHEIV0
  8756     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8757     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8758     MOVE X'2020233030303038313536' TO DFHEIV0(25:11)
  8759     CALL 'kxdfhei1' USING DFHEIV0,
  8760           CNTL-ID,
  8761           DFHEIV20,
  8762           DFHEIV99,
  8763           CNTL-KEY,
  8764           DFHEIV99,
  8765           DFHEIV99,
  8766           DFHEIV99
  8767     SET ADDRESS OF CONTROL-FILE TO
  8768         DFHEIV20
  8769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8770
  8771
  8772     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
  8773
  8774 7100-CHECK-SYSTEM-ACTIVITY.
  8775
  8776     IF CL-ACTIVITY-CODE IS NOT EQUAL TO ZEROS
  8777         MOVE CL-ACTIVITY-CODE             TO  SUB-1
  8778         IF SUB-1 IS GREATER THAN +9
  8779             SUBTRACT +9 FROM SUB-1
  8780             MOVE CF-USER-RESET-SW (SUB-1) TO  WS-RESET-SW
  8781         ELSE
  8782             MOVE CF-SYS-RESET-SW  (SUB-1) TO  WS-RESET-SW
  8783     ELSE
  8784         MOVE 'Y'                          TO  WS-RESET-SW.
  8785
  8786     IF TERMI IS EQUAL TO 'A'
  8787         IF (CF-SYS-ACTIVE-SW (5) IS EQUAL TO 'N' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 170
* EL154.cbl
  8788             MOVE 'N'                TO  WS-LETTER-SW
  8789                                         WS-RESET-SW
  8790             GO TO 7100-EXIT.
  8791
  8792     IF TERMI IS EQUAL TO 'A'
  8793         IF (CF-SYS-LETTER-ID (5) EQUAL SPACES OR LOW-VALUES)
  8794             MOVE 'N'                TO  WS-LETTER-SW
  8795         ELSE
  8796             MOVE 'Y'                TO  WS-LETTER-SW.
  8797
  8798     IF TERMI IS EQUAL TO 'Y'
  8799         IF (CF-SYS-ACTIVE-SW (6) IS EQUAL TO 'N' OR ' ')
  8800             MOVE 'N'                TO  WS-LETTER-SW
  8801                                         WS-RESET-SW
  8802             GO TO 7100-EXIT.
  8803
  8804     IF TERMI IS EQUAL TO 'Y'
  8805         IF (CF-SYS-LETTER-ID (6) EQUAL SPACES OR LOW-VALUES)
  8806             MOVE 'N'                TO  WS-LETTER-SW
  8807         ELSE
  8808             MOVE 'Y'                TO  WS-LETTER-SW.
  8809
  8810     IF CL-ACTIVITY-CODE IS EQUAL TO 09
  8811         GO TO 7100-EXIT.
  8812
  8813     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK') AND
  8814        (CL-ACTIVITY-CODE IS EQUAL TO 11)
  8815         GO TO 7100-EXIT.
  8816
  8817     IF WS-RESET-SW IS EQUAL TO 'N'
  8818         GO TO 7100-EXIT.
  8819
  8820     MOVE CURRENT-BIN-DATE           TO  CL-ACTIVITY-MAINT-DT.
  8821
  8822     IF TERMI IS EQUAL TO 'A'
  8823         MOVE 05                     TO  CL-ACTIVITY-CODE
  8824         MOVE 'AUTO'                 TO  CL-ACTIVITY-MAINT-TYPE
  8825     ELSE
  8826         MOVE 06                     TO  CL-ACTIVITY-CODE
  8827         MOVE 'TERM'                 TO  CL-ACTIVITY-MAINT-TYPE.
  8828
  8829     GO TO 7100-EXIT.
  8830
  8831 7100-NOT-FOUND.
  8832
  8833     MOVE 'N'                        TO  WS-ACT-REC-FOUND-SW
  8834                                         WS-LETTER-SW.
  8835
  8836 7100-EXIT.
  8837     EXIT.
  8838
  8839 7150-CREATE-AUTO-LETTER.
  8840
  8841     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
  8842     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
  8843
  8844     IF TERMI IS EQUAL TO 'A'
  8845         IF WS-LETTER-FORM-NUM > SPACES
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 171
* EL154.cbl
  8846            MOVE WS-LETTER-FORM-NUM     TO  W-1523-FORM-NUMBER
  8847         ELSE
  8848         MOVE CF-SYS-LETTER-ID (5)   TO  W-1523-FORM-NUMBER
  8849         END-IF
  8850     ELSE
  8851         IF WS-END-LETTER-FORM-NUM > SPACES
  8852             MOVE WS-END-LETTER-FORM-NUM TO W-1523-FORM-NUMBER
  8853         ELSE
  8854         MOVE CF-SYS-LETTER-ID (6)   TO  W-1523-FORM-NUMBER.
  8855
  8856     IF TERMI IS EQUAL TO 'A'
  8857       IF CF-SYS-RESEND-DAYS (5) IS NOT EQUAL TO ZEROS
  8858         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8859         MOVE '6'                    TO  DC-OPTION-CODE
  8860         MOVE CF-SYS-RESEND-DAYS (5) TO  DC-ELAPSED-DAYS
  8861         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8862         PERFORM 9700-DATE-LINK
  8863         IF NO-CONVERSION-ERROR
  8864             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8865         ELSE
  8866             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8867
  8868
  8869     IF TERMI IS EQUAL TO 'A'
  8870       IF CF-SYS-FOLLOW-UP-DAYS (5) IS NOT EQUAL TO ZEROS
  8871         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8872         MOVE '6'                    TO  DC-OPTION-CODE
  8873         MOVE CF-SYS-FOLLOW-UP-DAYS (5)  TO  DC-ELAPSED-DAYS
  8874         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8875         PERFORM 9700-DATE-LINK
  8876         IF NO-CONVERSION-ERROR
  8877             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  8878         ELSE
  8879             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  8880
  8881     IF TERMI IS EQUAL TO 'Y'
  8882       IF CF-SYS-RESEND-DAYS (6) IS NOT EQUAL TO ZEROS
  8883         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8884         MOVE '6'                    TO  DC-OPTION-CODE
  8885         MOVE CF-SYS-RESEND-DAYS (6) TO  DC-ELAPSED-DAYS
  8886         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8887         PERFORM 9700-DATE-LINK
  8888         IF NO-CONVERSION-ERROR
  8889             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8890         ELSE
  8891             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8892
  8893
  8894     IF TERMI IS EQUAL TO 'Y'
  8895       IF CF-SYS-FOLLOW-UP-DAYS (6) IS NOT EQUAL TO ZEROS
  8896         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8897         MOVE '6'                    TO  DC-OPTION-CODE
  8898         MOVE CF-SYS-FOLLOW-UP-DAYS (6)  TO  DC-ELAPSED-DAYS
  8899         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8900         PERFORM 9700-DATE-LINK
  8901         IF NO-CONVERSION-ERROR
  8902             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  8903         ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 172
* EL154.cbl
  8904             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  8905
  8906     MOVE LETTDTE-SAVE               TO W-1523-LETTER-DATE.
  8907
  8908
  8909* EXEC CICS LINK
  8910*        PROGRAM    (LINK-1523)
  8911*        COMMAREA   (W-1523-LINKDATA)
  8912*        LENGTH     (W-1523-COMM-LENGTH)
  8913*    END-EXEC.
  8914*    MOVE '."C                   (   #00008298' TO DFHEIV0
  8915     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8916     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8917     MOVE X'2020233030303038323938' TO DFHEIV0(25:11)
  8918     CALL 'kxdfhei1' USING DFHEIV0,
  8919           LINK-1523,
  8920           W-1523-LINKDATA,
  8921           W-1523-COMM-LENGTH,
  8922           DFHEIV99,
  8923           DFHEIV99,
  8924           DFHEIV99,
  8925           DFHEIV99
  8926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8927
  8928
  8929     IF W-1523-ERROR-CODE IS EQUAL TO ZEROS
  8930         GO TO 7150-EXIT.
  8931
  8932     IF W-1523-FATAL-ERROR
  8933         MOVE ER-0802                TO  EMI-ERROR
  8934         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8935         GO TO 7150-EXIT.
  8936
  8937     IF W-1523-ERROR-CODE IS EQUAL TO 0191
  8938         MOVE ER-0803                TO  EMI-ERROR
  8939         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8940
  8941 7150-EXIT.
  8942     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 173
* EL154.cbl
  8944 7200-LOCATE-BENEFIT.
  8945     MOVE SPACES TO WS-BENEFIT-FOUND-SW.
  8946
  8947
  8948* EXEC CICS HANDLE CONDITION
  8949*        ENDFILE(7200-EXIT)
  8950*        NOTFND(7200-EXIT)
  8951*        END-EXEC.
  8952*    MOVE '"$''I                  ! 0 #00008322' TO DFHEIV0
  8953     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8954     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8955     MOVE X'3020233030303038333232' TO DFHEIV0(25:11)
  8956     CALL 'kxdfhei1' USING DFHEIV0
  8957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8958
  8959
  8960
  8961* EXEC CICS READ
  8962*        DATASET(CNTL-ID)
  8963*        SET(ADDRESS OF CONTROL-FILE)
  8964*        RIDFLD(CNTL-KEY)
  8965*        GTEQ
  8966*        END-EXEC.
  8967*    MOVE '&"S        G          (   #00008327' TO DFHEIV0
  8968     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8969     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8970     MOVE X'2020233030303038333237' TO DFHEIV0(25:11)
  8971     CALL 'kxdfhei1' USING DFHEIV0,
  8972           CNTL-ID,
  8973           DFHEIV20,
  8974           DFHEIV99,
  8975           CNTL-KEY,
  8976           DFHEIV99,
  8977           DFHEIV99,
  8978           DFHEIV99
  8979     SET ADDRESS OF CONTROL-FILE TO
  8980         DFHEIV20
  8981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8982
  8983
  8984     IF (CNTL-CO NOT = CF-COMPANY-ID)   OR
  8985        (CNTL-RECORD-TYPE NOT = CF-RECORD-TYPE)
  8986           GO TO 7200-EXIT.
  8987
  8988     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
  8989         VARYING SUB-1 FROM 1 BY 1 UNTIL
  8990            ((SUB-1 GREATER 8) OR
  8991            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
  8992
  8993     IF SUB-1 NOT = 9
  8994         MOVE 'Y' TO WS-BENEFIT-FOUND-SW.
  8995
  8996     GO TO 7200-EXIT.
  8997
  8998 7200-BENEFIT-DUMMY.
  8999
  9000 7200-DUMMY-EXIT.
  9001     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 174
* EL154.cbl
  9002
  9003 7200-EXIT.
  9004     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 175
* EL154.cbl
  9006 8100-SEND-INITIAL-MAP.
  9007     MOVE CURRENT-GREG-DATE      TO RUNDTEO.
  9008     MOVE EIBTIME                TO TIME-IN.
  9009     MOVE TIME-OUT               TO RUNTIMEO.
  9010     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  9011     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  9012
  9013     IF PI-USES-PAID-TO
  9014         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  9015                                     FSTHD2O
  9016         MOVE LAST-PMT-HD2       TO  LSTHD1O
  9017         MOVE LAST-PMT-HD4       TO  LSTHD2O
  9018     ELSE
  9019         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  9020                                     FSTHD2O
  9021         MOVE LAST-PMT-HD1       TO  LSTHD1O
  9022         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  9023
  9024
  9025* EXEC CICS SEND
  9026*        MAP(MAP-NAME)
  9027*        MAPSET(MAPSET-NAME)
  9028*        FROM(EL154AO)
  9029*        ERASE
  9030*        CURSOR
  9031*        END-EXEC.
  9032     MOVE LENGTH OF
  9033      EL154AO
  9034       TO DFHEIV12
  9035     MOVE -1
  9036       TO DFHEIV11
  9037*    MOVE '8$     CT  E    H L F ,   #00008374' TO DFHEIV0
  9038     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9039     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9040     MOVE X'2020233030303038333734' TO DFHEIV0(25:11)
  9041     CALL 'kxdfhei1' USING DFHEIV0,
  9042           MAP-NAME,
  9043           EL154AO,
  9044           DFHEIV12,
  9045           MAPSET-NAME,
  9046           DFHEIV99,
  9047           DFHEIV99,
  9048           DFHEIV99,
  9049           DFHEIV11,
  9050           DFHEIV99,
  9051           DFHEIV99,
  9052           DFHEIV99
  9053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9054
  9055
  9056     MOVE 'EL154   ' TO PI-CALLING-PROGRAM.
  9057     GO TO 9100-RETURN-TRAN.
  9058
  9059 8200-SEND-DATAONLY.
  9060     MOVE CURRENT-GREG-DATE TO RUNDTEO.
  9061     MOVE EIBTIME           TO TIME-IN.
  9062     MOVE TIME-OUT          TO RUNTIMEO.
  9063     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 176
* EL154.cbl
  9064     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  9065
  9066     IF PI-USES-PAID-TO
  9067         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  9068                                     FSTHD2O
  9069         MOVE LAST-PMT-HD2       TO  LSTHD1O
  9070         MOVE LAST-PMT-HD4       TO  LSTHD2O
  9071     ELSE
  9072         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  9073                                     FSTHD2O
  9074         MOVE LAST-PMT-HD1       TO  LSTHD1O
  9075         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  9076
  9077
  9078* EXEC CICS SEND
  9079*        MAP(MAP-NAME)
  9080*        MAPSET(MAPSET-NAME)
  9081*        FROM(EL154AO)
  9082*        DATAONLY
  9083*        ERASEAUP
  9084*        CURSOR
  9085*        END-EXEC.
  9086     MOVE LENGTH OF
  9087      EL154AO
  9088       TO DFHEIV12
  9089     MOVE -1
  9090       TO DFHEIV11
  9091*    MOVE '8$D    CT  A    H L F ,   #00008403' TO DFHEIV0
  9092     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9093     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9094     MOVE X'2020233030303038343033' TO DFHEIV0(25:11)
  9095     CALL 'kxdfhei1' USING DFHEIV0,
  9096           MAP-NAME,
  9097           EL154AO,
  9098           DFHEIV12,
  9099           MAPSET-NAME,
  9100           DFHEIV99,
  9101           DFHEIV99,
  9102           DFHEIV99,
  9103           DFHEIV11,
  9104           DFHEIV99,
  9105           DFHEIV99,
  9106           DFHEIV99
  9107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9108
  9109
  9110     GO TO 9100-RETURN-TRAN.
  9111
  9112 8300-SEND-TEXT.
  9113
  9114* EXEC CICS SEND TEXT
  9115*        FROM(LOGOFF-TEXT)
  9116*        LENGTH(LOGOFF-LENGTH)
  9117*        ERASE
  9118*        FREEKB
  9119*        END-EXEC.
  9120*    MOVE '8&      T  E F  H   F -   #00008415' TO DFHEIV0
  9121     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 177
* EL154.cbl
  9122     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9123     MOVE X'2020233030303038343135' TO DFHEIV0(25:11)
  9124     CALL 'kxdfhei1' USING DFHEIV0,
  9125           LOGOFF-TEXT,
  9126           LOGOFF-LENGTH,
  9127           DFHEIV99,
  9128           DFHEIV99,
  9129           DFHEIV99,
  9130           DFHEIV99,
  9131           DFHEIV99,
  9132           DFHEIV99,
  9133           DFHEIV99,
  9134           DFHEIV99,
  9135           DFHEIV99,
  9136           DFHEIV99
  9137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9138
  9139
  9140
  9141* EXEC CICS RETURN
  9142*        END-EXEC.
  9143*    MOVE '.(                    ''   #00008422' TO DFHEIV0
  9144     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9145     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9146     MOVE X'2020233030303038343232' TO DFHEIV0(25:11)
  9147     CALL 'kxdfhei1' USING DFHEIV0,
  9148           DFHEIV99,
  9149           DFHEIV99,
  9150           DFHEIV99,
  9151           DFHEIV99,
  9152           DFHEIV99,
  9153           DFHEIV99
  9154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9155
  9156
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 178
* EL154.cbl
  9158 8600-DEEDIT.
  9159
  9160* EXEC CICS BIF DEEDIT
  9161*         FIELD(DEEDIT-FIELD)
  9162*         LENGTH(15)
  9163*         END-EXEC.
  9164     MOVE 15
  9165       TO DFHEIV11
  9166*    MOVE '@"L                   #   #00008427' TO DFHEIV0
  9167     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9168     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9169     MOVE X'2020233030303038343237' TO DFHEIV0(25:11)
  9170     CALL 'kxdfhei1' USING DFHEIV0,
  9171           DEEDIT-FIELD,
  9172           DFHEIV11
  9173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9174
  9175
  9176 8800-UNAUTHORIZED-ACCESS.
  9177     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  9178     GO TO 8300-SEND-TEXT.
  9179
  9180 8810-PF23.
  9181     MOVE EIBAID TO PI-ENTRY-CD-1.
  9182     MOVE XCTL-005 TO PGM-NAME.
  9183     GO TO 9300-XCTL.
  9184
  9185
  9186 8850-CLAM-END-FILE.
  9187     MOVE -1                     TO  ENTERPFL.
  9188     MOVE ER-0130 TO EMI-ERROR.
  9189     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9190     GO TO 8200-SEND-DATAONLY.
  9191
  9192 8860-CLAM-NOT-OPEN.
  9193     MOVE -1                     TO  ENTERPFL.
  9194     MOVE ER-0154 TO EMI-ERROR.
  9195     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9196     GO TO 8200-SEND-DATAONLY.
  9197
  9198 8870-ACTV-NOT-OPEN.
  9199     MOVE -1                     TO  ENTERPFL.
  9200     MOVE ER-0172 TO EMI-ERROR.
  9201     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9202     GO TO 8200-SEND-DATAONLY.
  9203
  9204 8880-CERT-NOT-OPEN.
  9205     MOVE -1                     TO  ENTERPFL.
  9206     MOVE ER-0169                TO EMI-ERROR.
  9207     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9208     GO TO 8200-SEND-DATAONLY.
  9209
  9210 8885-EMPLCY-NOT-OPEN.
  9211     MOVE -1                     TO  ENTERPFL.
  9212     MOVE ER-9883                TO  EMI-ERROR.
  9213     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9214     GO TO 8200-SEND-DATAONLY.
  9215
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 179
* EL154.cbl
  9216 8890-CNTL-NOT-OPEN.
  9217     MOVE -1                     TO  ENTERPFL.
  9218     MOVE ER-0042                TO EMI-ERROR.
  9219     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9220     GO TO 8200-SEND-DATAONLY.
  9221
  9222 9000-RETURN-CICS.
  9223
  9224* EXEC CICS RETURN
  9225*        END-EXEC.
  9226*    MOVE '.(                    ''   #00008479' TO DFHEIV0
  9227     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9228     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9229     MOVE X'2020233030303038343739' TO DFHEIV0(25:11)
  9230     CALL 'kxdfhei1' USING DFHEIV0,
  9231           DFHEIV99,
  9232           DFHEIV99,
  9233           DFHEIV99,
  9234           DFHEIV99,
  9235           DFHEIV99,
  9236           DFHEIV99
  9237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9238
  9239
  9240 9100-RETURN-TRAN.
  9241     MOVE    EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  9242     MOVE '154A' TO PI-CURRENT-SCREEN-NO.
  9243
  9244* EXEC CICS RETURN
  9245*        TRANSID(TRANS-ID)
  9246*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9247*        LENGTH(PI-COMM-LENGTH)
  9248*        END-EXEC.
  9249*    MOVE '.(CT                  ''   #00008485' TO DFHEIV0
  9250     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9251     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9252     MOVE X'2020233030303038343835' TO DFHEIV0(25:11)
  9253     CALL 'kxdfhei1' USING DFHEIV0,
  9254           TRANS-ID,
  9255           PROGRAM-INTERFACE-BLOCK,
  9256           PI-COMM-LENGTH,
  9257           DFHEIV99,
  9258           DFHEIV99,
  9259           DFHEIV99
  9260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9261
  9262
  9263 9200-RETURN-MAIN-MENU.
  9264     MOVE XCTL-126 TO PGM-NAME.
  9265     GO TO 9300-XCTL.
  9266
  9267 9300-XCTL.
  9268
  9269* EXEC CICS XCTL
  9270*        PROGRAM(PGM-NAME)
  9271*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9272*        LENGTH(PI-COMM-LENGTH)
  9273*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 180
* EL154.cbl
  9274*    MOVE '.$C                   %   #00008496' TO DFHEIV0
  9275     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9276     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9277     MOVE X'2020233030303038343936' TO DFHEIV0(25:11)
  9278     CALL 'kxdfhei1' USING DFHEIV0,
  9279           PGM-NAME,
  9280           PROGRAM-INTERFACE-BLOCK,
  9281           PI-COMM-LENGTH,
  9282           DFHEIV99
  9283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9284
  9285
  9286 9400-CLEAR.
  9287     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  9288     GO TO 9300-XCTL.
  9289
  9290 9500-PF12.
  9291     MOVE XCTL-010 TO PGM-NAME.
  9292     GO TO 9300-XCTL.
  9293
  9294 9600-PGMID-ERROR.
  9295
  9296* EXEC CICS HANDLE CONDITION
  9297*        PGMIDERR(8300-SEND-TEXT)
  9298*        END-EXEC.
  9299*    MOVE '"$L                   ! 1 #00008511' TO DFHEIV0
  9300     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9302     MOVE X'3120233030303038353131' TO DFHEIV0(25:11)
  9303     CALL 'kxdfhei1' USING DFHEIV0
  9304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9305
  9306
  9307     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  9308     MOVE ' '          TO PI-ENTRY-CD-1.
  9309     MOVE XCTL-005     TO PGM-NAME.
  9310     MOVE PGM-NAME     TO LOGOFF-PGM.
  9311     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  9312     GO TO 9300-XCTL.
  9313
  9314 9700-DATE-LINK.
  9315     MOVE LINK-ELDATCV TO PGM-NAME
  9316
  9317* EXEC CICS LINK
  9318*        PROGRAM    (PGM-NAME)
  9319*        COMMAREA   (DATE-CONVERSION-DATA)
  9320*        LENGTH     (DC-COMM-LENGTH)
  9321*        END-EXEC.
  9322*    MOVE '."C                   (   #00008524' TO DFHEIV0
  9323     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9324     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9325     MOVE X'2020233030303038353234' TO DFHEIV0(25:11)
  9326     CALL 'kxdfhei1' USING DFHEIV0,
  9327           PGM-NAME,
  9328           DATE-CONVERSION-DATA,
  9329           DC-COMM-LENGTH,
  9330           DFHEIV99,
  9331           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 181
* EL154.cbl
  9332           DFHEIV99,
  9333           DFHEIV99
  9334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9335
  9336
  9337 9900-ERROR-FORMAT.
  9338     IF NOT EMI-ERRORS-COMPLETE
  9339         MOVE LINK-001 TO PGM-NAME
  9340
  9341* EXEC CICS LINK
  9342*            PROGRAM(PGM-NAME)
  9343*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  9344*            LENGTH(EMI-COMM-LENGTH)
  9345*            END-EXEC.
  9346*    MOVE '."C                   (   #00008533' TO DFHEIV0
  9347     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9349     MOVE X'2020233030303038353333' TO DFHEIV0(25:11)
  9350     CALL 'kxdfhei1' USING DFHEIV0,
  9351           PGM-NAME,
  9352           ERROR-MESSAGE-INTERFACE-BLOCK,
  9353           EMI-COMM-LENGTH,
  9354           DFHEIV99,
  9355           DFHEIV99,
  9356           DFHEIV99,
  9357           DFHEIV99
  9358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9359
  9360
  9361 9900-EXIT.
  9362     EXIT.
  9363
  9364 9990-ABEND.
  9365     MOVE LINK-004 TO PGM-NAME.
  9366     MOVE DFHEIBLK TO EMI-LINE1.
  9367
  9368* EXEC CICS LINK
  9369*        PROGRAM(PGM-NAME)
  9370*        COMMAREA(EMI-LINE1)
  9371*        LENGTH(72)
  9372*        END-EXEC.
  9373     MOVE 72
  9374       TO DFHEIV11
  9375*    MOVE '."C                   (   #00008545' TO DFHEIV0
  9376     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9378     MOVE X'2020233030303038353435' TO DFHEIV0(25:11)
  9379     CALL 'kxdfhei1' USING DFHEIV0,
  9380           PGM-NAME,
  9381           EMI-LINE1,
  9382           DFHEIV11,
  9383           DFHEIV99,
  9384           DFHEIV99,
  9385           DFHEIV99,
  9386           DFHEIV99
  9387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9388
  9389
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 182
* EL154.cbl
  9390     GO TO 8200-SEND-DATAONLY.
  9391
  9392* GOBACK.
  9393     MOVE '9%                    "   ' TO DFHEIV0
  9394     MOVE 'EL154' TO DFHEIV1
  9395     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9396     GOBACK.
  9397
  9398 9995-SECURITY-VIOLATION.
  9399*                            COPY ELCSCTP.
  9400******************************************************************
  9401*                                                                *
  9402*                            ELCSCTP                             *
  9403*                            VMOD=2.001                          *
  9404*                                                                *
  9405*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9406******************************************************************
  9407
  9408
  9409     MOVE EIBDATE          TO SM-JUL-DATE.
  9410     MOVE EIBTRMID         TO SM-TERMID.
  9411     MOVE THIS-PGM         TO SM-PGM.
  9412     MOVE EIBTIME          TO TIME-IN.
  9413     MOVE TIME-OUT         TO SM-TIME.
  9414     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9415
  9416
  9417* EXEC CICS LINK
  9418*         PROGRAM  ('EL003')
  9419*         COMMAREA (SECURITY-MESSAGE)
  9420*         LENGTH   (80)
  9421*    END-EXEC.
  9422     MOVE 'EL003' TO DFHEIV1
  9423     MOVE 80
  9424       TO DFHEIV11
  9425*    MOVE '."C                   (   #00008572' TO DFHEIV0
  9426     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9427     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9428     MOVE X'2020233030303038353732' TO DFHEIV0(25:11)
  9429     CALL 'kxdfhei1' USING DFHEIV0,
  9430           DFHEIV1,
  9431           SECURITY-MESSAGE,
  9432           DFHEIV11,
  9433           DFHEIV99,
  9434           DFHEIV99,
  9435           DFHEIV99,
  9436           DFHEIV99
  9437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9438
  9439
  9440******************************************************************
  9441
  9442
  9443 9995-EXIT.
  9444     EXIT.
  9445
  9446
  9447 9999-DFHBACK SECTION.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 183
* EL154.cbl
  9448     MOVE '9%                    "   ' TO DFHEIV0
  9449     MOVE 'EL154' TO DFHEIV1
  9450     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9451     GOBACK.
  9452 9999-DFHEXIT.
  9453     IF DFHEIGDJ EQUAL 0001
  9454         NEXT SENTENCE
  9455     ELSE IF DFHEIGDJ EQUAL 2
  9456         GO TO 8860-CLAM-NOT-OPEN,
  9457               9600-PGMID-ERROR,
  9458               9990-ABEND
  9459         DEPENDING ON DFHEIGDI
  9460     ELSE IF DFHEIGDJ EQUAL 3
  9461         GO TO 8850-CLAM-END-FILE,
  9462               8850-CLAM-END-FILE
  9463         DEPENDING ON DFHEIGDI
  9464     ELSE IF DFHEIGDJ EQUAL 4
  9465         GO TO 8850-CLAM-END-FILE,
  9466               8850-CLAM-END-FILE
  9467         DEPENDING ON DFHEIGDI
  9468     ELSE IF DFHEIGDJ EQUAL 5
  9469         GO TO 8870-ACTV-NOT-OPEN
  9470         DEPENDING ON DFHEIGDI
  9471     ELSE IF DFHEIGDJ EQUAL 6
  9472         GO TO 8870-ACTV-NOT-OPEN,
  9473               4099-EXIT
  9474         DEPENDING ON DFHEIGDI
  9475     ELSE IF DFHEIGDJ EQUAL 7
  9476         GO TO 9999-DFHBACK
  9477         DEPENDING ON DFHEIGDI
  9478     ELSE IF DFHEIGDJ EQUAL 8
  9479         GO TO 6150-READ-CARRIER,
  9480               8890-CNTL-NOT-OPEN
  9481         DEPENDING ON DFHEIGDI
  9482     ELSE IF DFHEIGDJ EQUAL 9
  9483         GO TO 6180-READ-CERT
  9484         DEPENDING ON DFHEIGDI
  9485     ELSE IF DFHEIGDJ EQUAL 10
  9486         GO TO 8880-CERT-NOT-OPEN,
  9487               6185-CERT-NOT-FOUND
  9488         DEPENDING ON DFHEIGDI
  9489     ELSE IF DFHEIGDJ EQUAL 11
  9490         GO TO 8885-EMPLCY-NOT-OPEN,
  9491               6195-EMPLCY-NOT-FOUND
  9492         DEPENDING ON DFHEIGDI
  9493     ELSE IF DFHEIGDJ EQUAL 12
  9494         GO TO 6250-ADDR-ERROR
  9495         DEPENDING ON DFHEIGDI
  9496     ELSE IF DFHEIGDJ EQUAL 13
  9497         GO TO 8860-CLAM-NOT-OPEN,
  9498               7090-CLAIM-NOT-FOUND
  9499         DEPENDING ON DFHEIGDI
  9500     ELSE IF DFHEIGDJ EQUAL 14
  9501         GO TO 8870-ACTV-NOT-OPEN,
  9502               7080-NO-TRAILER
  9503         DEPENDING ON DFHEIGDI
  9504     ELSE IF DFHEIGDJ EQUAL 15
  9505         GO TO 7100-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:10 Page 184
* EL154.cbl
  9506         DEPENDING ON DFHEIGDI
  9507     ELSE IF DFHEIGDJ EQUAL 16
  9508         GO TO 7200-EXIT,
  9509               7200-EXIT
  9510         DEPENDING ON DFHEIGDI
  9511     ELSE IF DFHEIGDJ EQUAL 17
  9512         GO TO 8300-SEND-TEXT
  9513         DEPENDING ON DFHEIGDI.
  9514     MOVE '9%                    "   ' TO DFHEIV0
  9515     MOVE 'EL154' TO DFHEIV1
  9516     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9517     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6012     Code:       19385
