* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   1
* EL152.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL152.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL152.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL152 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/14/94 08:03:40.
     7*                            VMOD=2.055.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX27 - CLAIMS LETTER WRITER.
    13
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   2
* EL152.cbl
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23*                                REMOVE OBSOLETE CODE
    24* 102703                   SMVA  MOD COPY MEMBER ELCNAMET TO LEAVE
    25*                                CERTIFICATION DESIGNATION ON
    26*                                PROCESSOR NAME LINE IN CAPS
    27* 121203                   SMVA  ADD PROCESSING FOR NEW CLM TYP G
    28* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    29* 042605    2005042100002  PEMA  FIX TEMP STORAGE PROBLEMS
    30* 010407    2006111300003  PEMA  ADD PROCESSING FOR CARRIER 8
    31* 060109  CR2008102800002  PEMA  ADD VAR 16.1
    32* 033110  CR2009122800001  AJRA  NAPERSOFT
    33* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
    34******************************************************************
    35 ENVIRONMENT DIVISION.
    36
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   3
* EL152.cbl
    38 DATA DIVISION.
    39 WORKING-STORAGE SECTION.
    40 01  DFH-START PIC X(04).
    41 77  FILLER  PIC X(32)  VALUE '********************************'.
    42 77  FILLER  PIC X(32)  VALUE '*    EL152 WORKING STORAGE     *'.
    43 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    44
    45*77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    46*77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    47*                                  USAGE POINTER.
    48 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    49 77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    50                                   USAGE POINTER.
    51 77  B1                          PIC S9(5) COMP-3 VALUE +0.
    52 77  S1                          PIC S9 VALUE +0.
    53 77  S2                          PIC S9 VALUE +0.
    54 01  P pointer.
    55 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    56 01  var-ptr pointer.
    57 01  env-var-len                 pic 9(4)  binary.
    58 01  rc                          pic 9(9)  binary.
    59 01  WS-KIXSYS.
    60     05  WS-KIX-FIL1             PIC X(10).
    61     05  WS-KIX-APPS             PIC X(10).
    62     05  WS-KIX-ENV              PIC X(10).
    63     05  WS-KIX-MYENV            PIC X(10).
    64     05  WS-KIX-SYS              PIC X(10).
    65 01  WS-HOLDING-ZIPS.
    66     05  FILLER              PIC X(10)  VALUE '--AM-ZIP--'.
    67     05  WS-AM-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    68     05  FILLER              PIC X(10)  VALUE '--AT-ZIP--'.
    69     05  WS-AT-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    70     05  FILLER              PIC X(10)  VALUE '--BE-ZIP--'.
    71     05  WS-BE-ZIP-CODE      PIC X(9)   VALUE 'XXXXXXXXX'.
    72     05  FILLER              PIC X(10)  VALUE '--CO-ZIP--'.
    73     05  WS-CO-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    74     05  FILLER              PIC X(17)  VALUE '--AM-ZIP-BEFORE--'.
    75     05  WS-AM-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    76     05  FILLER              PIC X(17)  VALUE '--AT-ZIP-BEFORE--'.
    77     05  WS-AT-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    78     05  FILLER              PIC X(17)  VALUE '--BE-ZIP-BEFORE--'.
    79     05  WS-BE-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    80     05  FILLER              PIC X(17)  VALUE '--CO-ZIP-BEFORE--'.
    81     05  WS-CO-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    82     05  FILLER              PIC X(17)  VALUE '-----------------'.
    83
    84*                            COPY ELCSCTM.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCTM                             *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    92*                                                                *
    93******************************************************************
    94 01  SECURITY-MESSAGE.
    95     12  FILLER                          PIC X(30)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   4
* EL152.cbl
    96            VALUE '** LOGIC SECURITY VIOLATION -'.
    97     12  SM-READ                         PIC X(6).
    98     12  FILLER                          PIC X(5)
    99            VALUE ' PGM='.
   100     12  SM-PGM                          PIC X(6).
   101     12  FILLER                          PIC X(5)
   102            VALUE ' OPR='.
   103     12  SM-PROCESSOR-ID                 PIC X(4).
   104     12  FILLER                          PIC X(6)
   105            VALUE ' TERM='.
   106     12  SM-TERMID                       PIC X(4).
   107     12  FILLER                          PIC XX   VALUE SPACE.
   108     12  SM-JUL-DATE                     PIC 9(5).
   109     12  FILLER                          PIC X    VALUE SPACE.
   110     12  SM-TIME                         PIC 99.99.
   111
   112
   113*                            COPY ELCSCRTY.
   114******************************************************************
   115*                                                                *
   116*                                                                *
   117*                            ELCSCRTY                            *
   118*                            VMOD=2.001                          *
   119*                                                                *
   120*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   121*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   122*        SAVED IN PI-SECURITY-ADDRESS.                           *
   123*                                                                *
   124******************************************************************
   125 01  SECURITY-CONTROL.
   126     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   127     12  FILLER                       PIC XX    VALUE 'SC'.
   128     12  SC-CREDIT-CODES.
   129         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   130             20  SC-CREDIT-DISPLAY    PIC X.
   131             20  SC-CREDIT-UPDATE     PIC X.
   132     12  SC-CLAIMS-CODES.
   133         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   134             20  SC-CLAIMS-DISPLAY    PIC X.
   135             20  SC-CLAIMS-UPDATE     PIC X.
   136
   137 01  WS-DATE-AREA.
   138     12  SAVE-DATE               PIC X(08)    VALUE SPACES.
   139     12  SAVE-BIN-DATE           PIC XX       VALUE SPACES.
   140     12  W-REVERSE-DATE-SW       PIC X        VALUE SPACES.
   141         88  W-REVERSE-DATE                   VALUE 'Y'.
   142     12  W-EDIT-DATE-1.
   143         16  W-ED1-MM            PIC XX.
   144         16  FILLER              PIC X        VALUE '/'.
   145         16  W-ED1-DD            PIC XX.
   146         16  FILLER              PIC X        VALUE '/'.
   147         16  W-ED1-YY            PIC XX.
   148     12  W-EDIT-DATE-2.
   149         16  W-ED2-DD            PIC XX.
   150         16  FILLER              PIC X        VALUE '/'.
   151         16  W-ED2-MM            PIC XX.
   152         16  FILLER              PIC X        VALUE '/'.
   153         16  W-ED2-YY            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   5
* EL152.cbl
   154 01  FILLER.
   155     05  WS-WORK-INT-RATE        PIC 99.999.
   156     05  WS-WORK-INT REDEFINES WS-WORK-INT-RATE
   157                                 PIC X(6).
   158 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   159     'BEGINJOB mode=''MVS'''.
   160 01  TRAN-DATA-LINE2.
   161*     05  FILLER                  PIC X(39)    VALUE
   162*     '"smtp -f EL152cl2 -t pema,kmsb,jmsb -s '.
   163     05  FILLER                  PIC X(29)    VALUE
   164     '"smtp -f EL152cl2 -t ajra -s '.
   165     05  TRAN-DETAIL.
   166         10  FILLER              PIC XX       VALUE
   167         ''' '.
   168         10  TRAN-DL2-USER       PIC X(05)    VALUE SPACES.
   169         10  TRAN-DL2-ARCHNO     PIC ZZZZ999  VALUE ZEROS.
   170         10  FILLER              PIC X        VALUE SPACES.
   171         10  TRAN-DL2-CCC        PIC X(22)    VALUE SPACES.
   172     05  FILLER                  PIC XX       VALUE '''"'.
   173     05  FILLER                  PIC X(30)    VALUE SPACES.
   174 01  TRAN-DATA-LINE3             PIC X(80)    VALUE
   175     'ENDJOB            '.
   176
   177 01  WS-PRINTER-ID               PIC X(4)    VALUE SPACES.
   178 01  STANDARD-AREAS.
   179     12  WS-ACCT-READ-SW         PIC X       VALUE ' '.
   180     12  WS-COMP-READ-SW         PIC X       VALUE ' '.
   181     12  WS-PROD-READ-SW         PIC X       VALUE ' '.
   182     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
   183     12  MAP-NAME.
   184         16  MAP-PREFIX          PIC XX      VALUE 'EL'.
   185         16  MAP-NUMBER          PIC X(4)    VALUE '152A'.
   186         16  MAP-FILLER          PIC XX      VALUE SPACES.
   187     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   188     12  MAPSET-NAME             PIC X(8)    VALUE 'EL152S'.
   189     12  TRANS-ID                PIC X(4)    VALUE 'EX27'.
   190     12  PRINT-TRANS             PIC X(4)    VALUE 'EX57'.
   191     12  LGXX-ID                 PIC X(4)    VALUE 'LGXX'.
   192     12  PGM-NAME                PIC X(8).
   193     12  TIME-IN                 PIC S9(7).
   194     12  TIME-OUT-R  REDEFINES TIME-IN.
   195         16  FILLER              PIC X.
   196         16  TIME-OUT            PIC 99V99.
   197         16  FILLER              PIC XX.
   198     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   199     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   200     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   201     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   202     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   203     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   204     12  THIS-PGM                PIC X(8)    VALUE 'EL152'.
   205     12  LINK-EL1522             PIC X(8)    VALUE 'EL1522'.
   206     12  PGM-EL126               PIC X(8)    VALUE 'EL126'.
   207     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   208     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   209     12  PGM-EL1042              PIC X(8)    VALUE 'EL1042'.
   210     12  SUB                     PIC 99.
   211     12  WS-LABELS-SW            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   6
* EL152.cbl
   212
   213     12  WS-PI-QID.
   214         16  QID-TERM            PIC X(4)    VALUE SPACES.
   215         16  FILLER              PIC X(4)    VALUE '152A'.
   216
   217     12  W-LETTER-ADDRESS-TYPE.
   218         16  W-LETTER-ADDR-TYPE  PIC  X VALUE SPACES.
   219         16  W-LETTER-ADDR-SEQ   PIC  9 VALUE ZEROS.
   220
   221     12  W-ADDRESS-SELECTION.
   222         16  W-ACCOUNT           PIC  9 VALUE ZEROS.
   223         16  W-BENEFICIARY       PIC  9 VALUE ZEROS.
   224         16  W-EMPLOYER          PIC  9 VALUE ZEROS.
   225         16  W-INSURED           PIC  9 VALUE ZEROS.
   226         16  W-OTHER-1           PIC  9 VALUE ZEROS.
   227         16  W-OTHER-2           PIC  9 VALUE ZEROS.
   228         16  W-PHYSICIAN         PIC  9 VALUE ZEROS.
   229
   230     12  W-Z-CONTROL-DATA.
   231         16  W-NUMBER-OF-COPIES  PIC  9.
   232         16  FILLER              PIC  X.
   233         16  W-DAYS-TO-FOLLOW-UP PIC  999.
   234         16  FILLER              PIC  X.
   235         16  W-DAYS-TO-RESEND-1  PIC  999.
   236         16  FILLER              PIC  X.
   237         16  W-FORM-TO-RESEND    PIC  X(4).
   238         16  FILLER              PIC  X(1).
   239         16  W-PROMPT-LETTER     PIC  X(1).
   240         16  FILLER              PIC  X(1).
   241         16  W-ENCLOSURE-CD      PIC  X(3).
   242         16  FILLER              PIC  X(1).
   243         16  W-AUTO-CLOSE-IND    PIC  X(1).
   244         16  FILLER              PIC  X(1).
   245         16  W-LETTER-TO-BENE    PIC  X(1).
   246
   247     12  W-CREDIT-CARD-LOAN-NO.
   248         16  W-LOAN-NO           PIC  X(08).
   249         16  W-CURRENT-LOAN-NO   PIC  X(12).
   250
   251     12  W-GROUPING.
   252         16  W-GROUP-3           PIC  XXX.
   253         16  FILLER              PIC  XXX.
   254
   255     12  W-NAME.
   256         16  W-FIRST-NAME        PIC  X(12).
   257         16  W-MIDDLE-NAME       PIC  X(12).
   258         16  W-LAST-NAME         PIC  X(15).
   259
   260     12  WS-PHONE-IN             PIC 9(11)   VALUE ZEROS.
   261     12  WS-PHONE-IN-R  REDEFINES WS-PHONE-IN.
   262         16  FILLER              PIC 9.
   263         16  WSPI-AREA           PIC 9(3).
   264         16  WSPI-PFX            PIC 9(3).
   265         16  WSPI-SFX            PIC 9(4).
   266     12  WS-PHONE-OUT.
   267         16  WSPO-AREA           PIC X(3).
   268         16  FILLER              PIC X       VALUE '-'.
   269         16  WSPO-PFX            PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   7
* EL152.cbl
   270         16  FILLER              PIC X       VALUE '-'.
   271         16  WSPO-SFX            PIC X(4).
   272
   273     12  WS-ZIP-NUMERIC          PIC 9(9).
   274     12  WS-ZIP-NONNUM  REDEFINES  WS-ZIP-NUMERIC
   275                                 PIC X(9).
   276
   277     12  WS-ZIP-CODE.
   278         16  WS-AM-ZIP-CODE      PIC X(5).
   279         16  WS-AM-ZIP-DASH      PIC X.
   280         16  WS-AM-ZIP-PLUS4     PIC X(4).
   281     12  WS-ZIP-CODE-CANADIAN  REDEFINES  WS-ZIP-CODE.
   282         16  WS-CAN-POSTAL-1     PIC XXX.
   283         16  FILLER              PIC X.
   284         16  WS-CAN-POSTAL-2     PIC XXX.
   285         16  FILLER              PIC XXX.
   286
   287     12  WS-LABEL-HOLD-AREA.
   288         16  WS-LABEL-LINES OCCURS 6 TIMES
   289                            INDEXED BY WS-NDX  WS-NDX2.
   290             20  WS-LABEL-ZIP.
   291                 24  WS-LABEL-1ST-ZIP  PIC X(5).
   292                 24  FILLER            PIC X.
   293                 24  WS-LABEL-2ND-ZIP  PIC X(4).
   294             20  FILLER                PIC X(9).
   295             20  WS-LAST-DIGIT         PIC X.
   296             20  WS-LAST-ZIP.
   297                 24  WS-LAST-1ST-ZIP   PIC X(5).
   298                 24  FILLER            PIC X.
   299                 24  WS-LAST-2ND-ZIP   PIC X(4).
   300
   301     12  WS-DATA-FOUND-SW            PIC X.
   302         88  NO-CHARACTERS-FOUND           VALUE 'N'.
   303
   304     12  WS-SKIP-EMAIL           PIC X       VALUE 'N'.
   305     12  WS-STATE-LINE           PIC X       VALUE 'N'.
   306     12  WS-PROCESSOR-LINE       PIC X(01)   VALUE 'N'.
   307     12  WS-CAPS-SW              PIC X(01)   VALUE 'N'.
   308         88  THE-REST-R-CAPS                 VALUE 'Y'.
   309     12  WS-POSITION2            PIC S9(4)   COMP.
   310     12  WS-POSITION21           PIC S9(4)   COMP.
   311     12  WS-WORD-LENGTH          PIC S9(4)   COMP-3.
   312
   313     12  WS-TEMP-AREA1.
   314         16  WS-TEMP-1           PIC X OCCURS 29
   315                                       INDEXED BY TA1.
   316     12  WS-TEMP-AREA2.
   317         16  WS-TEMP-2           PIC X OCCURS 30
   318                                       INDEXED BY TA2
   319                                                  TA21
   320                                                  MOVE-INDX.
   321
   322     12  WS-SAVE-TEMP-AREA2      PIC X(30)   VALUE SPACES.
   323
   324     12  ACCT-BROWSE-STARTED     PIC X       VALUE 'N'.
   325     12  TEXT-BROWSE-STARTED     PIC X       VALUE 'N'.
   326     12  ARCH-BROWSE-STARTED     PIC X       VALUE 'N'.
   327     12  ACTV-BROWSE-STARTED     PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   8
* EL152.cbl
   328     12  PROD-BROWSE-STARTED     PIC X       VALUE 'N'.
   329     12  INDX-WORK               PIC 99.
   330     12  TEMP-CURR-LINE          PIC S9(3)    COMP-3.
   331
   332     12  DATE-WORK               PIC 9(7).
   333     12  DT-REDEF REDEFINES DATE-WORK.
   334         16  FILLER              PIC XX.
   335         16  DT-WORK             PIC 9(5).
   336
   337     12  BEN-HOLD                PIC XX.
   338
   339     12  BENEFIT-WORK            PIC XXX.
   340     12  BEN-R REDEFINES BENEFIT-WORK.
   341         16  ELIM-DAYS           PIC XX.
   342         16  FILLER              PIC X.
   343
   344     12  GETMAIN-SWITCH          PIC 9        VALUE 0.
   345         88  NO-GETMAIN-DONE-YET              VALUE 0.
   346         88  REFRESH-GETMAIN-AREA             VALUE 1.
   347
   348     12  WORK-AMOUNT             PIC S9(9)V99 VALUE +0.
   349     12  CURRENT-SAVE            PIC XX.
   350     12  CURRENT-PLUS3-SAVE      PIC XX.
   351     12  RESEND-SAVE             PIC XX    VALUE LOW-VALUE.
   352     12  FOLLOW-UP-SAVE          PIC XX    VALUE LOW-VALUE.
   353     12  SEQ-COUNTER             PIC S9(4) COMP.
   354     12  CORR-TRLR-SEQ           PIC S9(4) COMP.
   355     12  DEEDIT-FIELD            PIC X(15).
   356     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   357
   358     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   359     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   360
   361     12  LOWER-CASE PIC X(26) VALUE 'abcdefghijklmnopqrstuvwxyz'.
   362     12  UPPER-CASE PIC X(26) VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
   363
   364     12  WS-CCN-12               PIC X(12).
   365
   366     12  WS-ADDR-TYPE-CD.
   367         16  WS-ADDR-TYPE        PIC X.
   368         16  WS-ADDR-SEQ         PIC X.
   369         16  WS-ADDR-SEQ-NUM REDEFINES
   370             WS-ADDR-SEQ         PIC 9.
   371
   372     12  WS-DMD-CERT-STATE       PIC XX.
   373     12  WS-DMD-CERT-GROUPING    PIC XX.
   374     12  WS-DMD-BEN-CODE         PIC XX.
   375     12  WS-DMD-CORR-TRLR-SEQ    PIC S9(4) COMP.
   376     12  WS-DMD-LETTER-FORM      PIC X(4).
   377     12  WS-DMD-RES-ST           PIC XX.
   378
   379     12  WS-DMD-UND-STATEMENT    PIC X(50)  VALUE
   380          'Central States provides plan administration for'.
   381
   382     12  WS-DMD-UND-COMPANYA     PIC X(50)  VALUE
   383          'Central States Health and Life Co.'.
   384
   385     12  WS-DMD-UND-COMPANYB     PIC X(50)  VALUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   9
* EL152.cbl
   386          'Central States Indemnity Co.'.
   387
   388* DLO023
   389 01  DL23-COMM-LENGTH            PIC S9(4) COMP VALUE +132.
   390 01  WS-DLO-CODES-TABLE.
   391     12  DL23-SYSTEM-ID          PIC XX.
   392     12  DL23-RECORD-TYPE        PIC XX.
   393     12  DL23-RECORD-KEY         PIC X(6).
   394     12  DL23-RETURN-CODE        PIC XX.
   395     12  DL23-CODE-DESC          PIC X(60).
   396     12  DL23-GEN-DESC-1         PIC X(20).
   397     12  DL23-GEN-DESC-2         PIC X(20).
   398     12  DL23-GEN-DESC-3         PIC X(20).
   399     12  WS-LETTER-STATUS        PIC X        VALUE ' '.
   400     12  WS-BLANK                PIC X        VALUE ' '.
   401
   402 01  WS-SAVE-ACCT-RECORD         PIC X(2000)  VALUE SPACES.
   403 01  WS-SAVE-PRODUCER-RECORD     PIC X(2000)  VALUE SPACES.
   404
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  10
* EL152.cbl
   406 01  ACCESS-KEYS-AND-FILE-IDS.
   407     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   408     12  ACCT-ID                  PIC X(8)    VALUE 'ERACCT'.
   409     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   410     12  ARCH-ID                  PIC X(8)    VALUE 'ELARCH'.
   411     12  ARCT-ID                  PIC X(8)    VALUE 'ELARCT'.
   412     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   413     12  TEXT-ID                  PIC X(8)    VALUE 'ELLETR'.
   414     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   415     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   416     12  PROD-ID                  PIC X(8)    VALUE 'MPPROD'.
   417     12  PLCY-ID                  PIC X(8)    VALUE 'MPPLCY'.
   418     12  PLAN-ID                  PIC X(8)    VALUE 'MPPLAN'.
   419     12  NAPS-ID                  PIC X(8)    VALUE 'ELNAPS'.
   420
   421     12  CNTL-KEY.
   422         16  CNTL-CO              PIC X(3).
   423         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   424         16  CNTL-GENL.
   425           18 CNTL-GEN1           PIC XX      VALUE SPACES.
   426           18 CNTL-GEN2.
   427             20 CNTL-GEN3         PIC X       VALUE SPACES.
   428             20 CNTL-GEN4         PIC X       VALUE SPACES.
   429         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   430
   431      12  WS-ERCOMP-KEY.
   432          16  WS-ERCOMP-COMPANY-CD PIC X.
   433          16  WS-ERCOMP-CARRIER    PIC X.
   434          16  WS-ERCOMP-GROUPING   PIC X(6).
   435          16  WS-ERCOMP-RESP-NO    PIC X(10).
   436          16  WS-ERCOMP-ACCOUNT    PIC X(10).
   437          16  WS-ERCOMP-TYPE       PIC X.
   438
   439     12  CLAM-KEY.
   440         16  CLAM-CO              PIC X.
   441         16  CLAM-CARRIER         PIC X.
   442         16  CLAM-CLAIM           PIC X(7).
   443         16  CLAM-CERT-NUM        PIC X(11).
   444
   445     12  TEXT-KEY.
   446         16  TEXT-PARTIAL-KEY.
   447             20  TEXT-CO          PIC X.
   448             20  TEXT-LETTER      PIC X(4).
   449         16  TEXT-FILLER          PIC X(8)    VALUE SPACES.
   450         16  TEXT-SEQ             PIC S9(4)   VALUE +0    COMP.
   451
   452     12  ACTV-KEY.
   453         16  ACTV-PARTIAL-KEY.
   454             20  ACTV-CO          PIC X.
   455             20  ACTV-CARRIER     PIC X.
   456             20  ACTV-CLAIM       PIC X(7).
   457             20  ACTV-CERT-NUM    PIC X(11).
   458         16  ACTV-SEQ             PIC S9(4)   VALUE +0    COMP.
   459
   460     12  CERT-KEY.
   461         16  CERT-CO              PIC X.
   462         16  CERT-CARRIER         PIC X.
   463         16  CERT-GROUPING        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  11
* EL152.cbl
   464         16  CERT-STATE           PIC XX.
   465         16  CERT-ACCOUNT         PIC X(10).
   466         16  CERT-EFF-DT          PIC XX.
   467         16  CERT-CERT-NUM        PIC X(11).
   468
   469     12  ACCT-KEY.
   470         16  ACCT-PARTIAL-KEY.
   471             20  ACCT-CO              PIC X.
   472             20  ACCT-CARRIER         PIC X.
   473             20  ACCT-GROUPING        PIC X(6).
   474             20  ACCT-STATE           PIC XX.
   475             20  ACCT-ACCOUNT         PIC X(10).
   476         16  ACCT-EXP-DATE            PIC XX.
   477
   478     12  ARCH-KEY.
   479         16  ARCH-PARTIAL-KEY.
   480             20  ARCH-CO          PIC X.
   481             20  ARCH-NUMBER      PIC S9(8)      COMP.
   482         16  ARCH-REC-TYPE        PIC X.
   483         16  ARCH-SEQ             PIC S9(4)      COMP VALUE +0.
   484
   485     12  BENE-KEY.
   486         16  BENE-COMP-CD         PIC X.
   487         16  BENE-REC-TYPE        PIC X.
   488         16  BENE-NUMBER.
   489             20  BENE-CREDITOR    PIC XXX.
   490             20  FILLER           PIC X(7).
   491
   492     12  PROD-KEY.
   493         16  PROD-PARTIAL-KEY.
   494             20  PROD-CO          PIC X.
   495             20  PROD-CARRIER     PIC X.
   496             20  PROD-GROUPING    PIC X(6).
   497             20  PROD-STATE       PIC XX.
   498             20  PROD-PRODUCER    PIC X(10).
   499         16  PROD-EXP-DATE        PIC XX.
   500
   501     12  PLCY-KEY.
   502         16  PLCY-CO              PIC X.
   503         16  PLCY-CARRIER         PIC X.
   504         16  PLCY-GROUPING        PIC X(06).
   505         16  PLCY-STATE           PIC XX.
   506         16  PLCY-PRODUCER        PIC X(10).
   507         16  PLCY-EFF-DT          PIC XX.
   508         16  PLCY-REFERENCE-NO    PIC X(20).
   509
   510     12  PLAN-KEY.
   511         16  PLAN-CO              PIC X.
   512         16  PLAN-CARRIER         PIC X.
   513         16  PLAN-GROUPING        PIC X(6).
   514         16  PLAN-STATE           PIC XX.
   515         16  PLAN-PRODUCER        PIC X(10).
   516         16  PLAN-CODE            PIC XX.
   517         16  PLAN-REV-NO          PIC 999.
   518
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  12
* EL152.cbl
   520     12  ARCH-SAVE-KEY           PIC X(5).
   521     12  ACTV-SAVE-KEY           PIC X(20).
   522     12  ACCT-SAVE-KEY           PIC X(20).
   523     12  PROD-SAVE-KEY           PIC X(20).
   524     12  ACCT-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   525     12  ARCH-LENGTH             PIC S9(4)  COMP  VALUE +90.
   526     12  ARCT-LENGTH             PIC S9(4)  COMP  VALUE +90.
   527     12  ACTV-LENGTH             PIC S9(4)  COMP  VALUE +200.
   528     12  PROD-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   529     12  NAPS-LENGTH             PIC S9(4)  COMP  VALUE +150.
   530     12  TEXT-SAVE-KEY           PIC X(5).
   531     12  SAVE-VARIABLE-POINTER   PIC S9(8)   COMP.
   532     12  VAR-HOLD.
   533         16  V1                  PIC X.
   534         16  V2                  PIC X.
   535         16  V3                  PIC X.
   536         16  V4                  PIC X.
   537     12  V-HOLD REDEFINES VAR-HOLD.
   538         16  V-NUM               PIC 99.
   539         16  V-PERIOD            PIC X.
   540         16  V-DECIMAL           PIC 9.
   541
   542     12  MAX-LINES               PIC 999     VALUE 300.
   543     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 13.
   544     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   545     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0     COMP-3.
   546     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   547     12  TS-ITEM                 PIC S9(4)   VALUE +0    COMP.
   548     12  TS-MAP-LENGTH           PIC S9(4)   VALUE +1343 COMP.
   549     12  ROLL-COUNTER            PIC S999    VALUE +0    COMP-3.
   550     12  TS-NAME-TEXT.
   551         16  TS-ID-TEXT          PIC X(4)    VALUE '104A'.
   552         16  TS-ID-TIME REDEFINES TS-ID-TEXT  PIC S9(7) COMP-3.
   553         16  TS-TERM-TEXT.
   554          17 TS-TERM-PREFIX      PIC XX.
   555          17 FILLER              PIC XX.
   556     12  TS-NAME-SCREEN.
   557         16  FILLER              PIC X(4)    VALUE '152X'.
   558         16  TS-TERM-SCREEN      PIC X(4).
   559
   560     12  LINE-NUM.
   561         16  LINE1               PIC X.
   562         16  LINE23              PIC 99.
   563     12  LIN-NUM REDEFINES LINE-NUM  PIC 999.
   564     12  TOP-FORM                PIC X(70)
   565         VALUE '*****TOP OF FORM *****'.
   566     12  SINGLE-LINE             PIC X(70).
   567     12  SINGLE-LINE-BY-1 REDEFINES SINGLE-LINE.
   568         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY INDX1 INDX2
   569                                 PIC X.
   570     12  NAPERSOFT-LETTER        PIC X(16)
   571         VALUE 'Napersoft letter'.
   572
   573 01  HAN-LETTER-REASON-DATA.
   574     12  WS-REASON-TEXT.
   575         16  WS-RE-NDX           PIC 99.
   576         16  FILLER              PIC X(68).
   577
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  13
* EL152.cbl
   578     12  HAN-REASON-TABLE.
   579         16  FILLER              PIC X(50) VALUE
   580           'ADDITIONAL INFO REQUESTED FROM PHYSICIAN          '.
   581         16  FILLER              PIC X(50) VALUE
   582           'CHECKING PRE-EXISTING CONDITION                   '.
   583         16  FILLER              PIC X(50) VALUE
   584           'ADDITIONAL INFO RECEIVED / CLAIM REOPENED         '.
   585         16  FILLER              PIC X(50) VALUE
   586           'LETTER TO INSURED                                 '.
   587         16  FILLER              PIC X(50) VALUE
   588           'LETTER TO CREDITOR                                '.
   589         16  FILLER              PIC X(50) VALUE
   590           'LETTER TO EMPLOYER                                '.
   591         16  FILLER              PIC X(50) VALUE
   592           'LETTER TO INSURED / 2ND REQUEST                   '.
   593         16  FILLER              PIC X(50) VALUE
   594           'LETTER TO CREDITOR / 2ND REQUEST                  '.
   595         16  FILLER              PIC X(50) VALUE
   596           'LETTER TO EMPLOYER / 2ND REQUEST                  '.
   597         16  FILLER              PIC X(50) VALUE
   598           'AWAITING INITIAL CLAIM FORM                       '.
   599         16  FILLER              PIC X(50) VALUE
   600           'AWAITING SUPPLEMENTAL INFORMATION                 '.
   601         16  FILLER              PIC X(50) VALUE
   602           'DENIED / PRE-EXISTING CONDITION                   '.
   603         16  FILLER              PIC X(50) VALUE
   604           'DENIED / WAITING PERIOD NOT MET                   '.
   605         16  FILLER              PIC X(50) VALUE
   606           'DENIED / NORMAL PREGNANCY                         '.
   607         16  FILLER              PIC X(50) VALUE
   608           'DENIED / ACT OF WAR                               '.
   609         16  FILLER              PIC X(50) VALUE
   610           'DENIED / NOT TOTALLY DISABLED                     '.
   611         16  FILLER              PIC X(50) VALUE
   612           'DENIED / NOT UNDER CARE & TREATMENT OF PHYSICIAN  '.
   613         16  FILLER              PIC X(50) VALUE
   614           'DENIED / NO COVERAGE INFORCE                      '.
   615         16  FILLER              PIC X(50) VALUE
   616           'DENIED / DISABLED ON DATE OF LOAN                 '.
   617         16  FILLER              PIC X(50) VALUE
   618           'DENIED / OVER MAXIMUM AGE                         '.
   619         16  FILLER              PIC X(50) VALUE
   620           'CLOSED / CLAIM INFO NOT PROVIDED                  '.
   621         16  FILLER              PIC X(50) VALUE
   622           'PHYSICIAN INFORMATION INCOMPLETE                  '.
   623         16  FILLER              PIC X(50) VALUE
   624           'ACKNOWLEDGEMENT LETTER TO INSURED                 '.
   625         16  FILLER              PIC X(50) VALUE
   626           'DENIED/SUICIDE EXCLUSION                          '.
   627         16  FILLER              PIC X(50) VALUE
   628           'DENIED/LOAN EFFECTIVE BEFORE POLICY EFFECTIVE DATE'.
   629         16  FILLER              PIC X(50) VALUE
   630           'DENIED/JOINT DEBTORS NOT COVERED                  '.
   631         16  FILLER              PIC X(50) VALUE
   632           'DENIED/GROUP POLICY LAPSED                        '.
   633         16  FILLER              PIC X(50) VALUE
   634           'DENIED/DECEASED PRIOR TO POLICY EFFECTIVE DATE    '.
   635         16  FILLER              PIC X(50) VALUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  14
* EL152.cbl
   636           'DENIED/LOAN TERM IN EXCESS OF MAXIMUM LOAN TERM   '.
   637         16  FILLER              PIC X(50) VALUE
   638           'DENIED/INSURED NOT PERMANENTLY & TOTALLY DISABLED '.
   639         16  FILLER              PIC X(50) VALUE
   640           'DENIED/IME EXAM DOES NOT SUPPORT CONT. DISABILITY '.
   641         16  FILLER              PIC X(50) VALUE
   642           'DENIED/INSURED DID NOT APPEAR FOR IME EXAM        '.
   643
   644     12  HAN-LETTER-REASON-TABLE  REDEFINES  HAN-REASON-TABLE.
   645         16  HAN-TABLE-ENTRIES  OCCURS  32  TIMES.
   646             20  HAN-REASON-TEXT PIC X(50).
   647
   648 01  ERROR-MESSAGES.
   649     12  ER-0000                 PIC X(4)  VALUE '0000'.
   650     12  ER-0004                 PIC X(4)  VALUE '0004'.
   651     12  ER-0006                 PIC X(4)  VALUE '0006'.
   652     12  ER-0008                 PIC X(4)  VALUE '0008'.
   653     12  ER-0013                 PIC X(4)  VALUE '0013'.
   654     12  ER-0023                 PIC X(4)  VALUE '0023'.
   655     12  ER-0029                 PIC X(4)  VALUE '0029'.
   656     12  ER-0033                 PIC X(4)  VALUE '0033'.
   657     12  ER-0042                 PIC X(4)  VALUE '0042'.
   658     12  ER-0047                 PIC X(4)  VALUE '0047'.
   659     12  ER-0051                 PIC X(4)  VALUE '0051'.
   660     12  ER-0066                 PIC X(4)  VALUE '0066'.
   661     12  ER-0067                 PIC X(4)  VALUE '0067'.
   662     12  ER-0070                 PIC X(4)  VALUE '0070'.
   663     12  ER-0133                 PIC X(4)  VALUE '0133'.
   664     12  ER-0154                 PIC X(4)  VALUE '0154'.
   665     12  ER-0168                 PIC X(4)  VALUE '0168'.
   666     12  ER-0169                 PIC X(4)  VALUE '0169'.
   667     12  ER-0172                 PIC X(4)  VALUE '0172'.
   668     12  ER-0174                 PIC X(4)  VALUE '0174'.
   669     12  ER-0175                 PIC X(4)  VALUE '0175'.
   670     12  ER-0176                 PIC X(4)  VALUE '0176'.
   671     12  ER-0177                 PIC X(4)  VALUE '0177'.
   672     12  ER-0178                 PIC X(4)  VALUE '0178'.
   673     12  ER-0179                 PIC X(4)  VALUE '0179'.
   674     12  ER-0180                 PIC X(4)  VALUE '0180'.
   675     12  ER-0181                 PIC X(4)  VALUE '0181'.
   676     12  ER-0182                 PIC X(4)  VALUE '0182'.
   677     12  ER-0183                 PIC X(4)  VALUE '0183'.
   678     12  ER-0184                 PIC X(4)  VALUE '0184'.
   679     12  ER-0185                 PIC X(4)  VALUE '0185'.
   680     12  ER-0186                 PIC X(4)  VALUE '0186'.
   681     12  ER-0187                 PIC X(4)  VALUE '0187'.
   682     12  ER-0188                 PIC X(4)  VALUE '0188'.
   683     12  ER-0189                 PIC X(4)  VALUE '0189'.
   684     12  ER-0190                 PIC X(4)  VALUE '0190'.
   685     12  ER-0191                 PIC X(4)  VALUE '0191'.
   686     12  ER-0206                 PIC X(4)  VALUE '0206'.
   687     12  ER-0211                 PIC X(4)  VALUE '0211'.
   688     12  ER-0279                 PIC X(4)  VALUE '0279'.
   689     12  ER-0280                 PIC X(4)  VALUE '0280'.
   690     12  ER-0281                 PIC X(4)  VALUE '0281'.
   691     12  ER-0332                 PIC X(4)  VALUE '0332'.
   692     12  ER-0343                 PIC X(4)  VALUE '0343'.
   693     12  ER-0373                 PIC X(4)  VALUE '0373'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  15
* EL152.cbl
   694     12  ER-0374                 PIC X(4)  VALUE '0374'.
   695     12  ER-0412                 PIC X(4)  VALUE '0412'.
   696     12  ER-0413                 PIC X(4)  VALUE '0413'.
   697     12  ER-0533                 PIC X(4)  VALUE '0533'.
   698     12  ER-0537                 PIC X(4)  VALUE '0537'.
   699     12  ER-0716                 PIC X(4)  VALUE '0716'.
   700     12  ER-0861                 PIC X(4)  VALUE '0861'.
   701     12  ER-0894                 PIC X(4)  VALUE '0894'.
   702     12  ER-0900                 PIC X(4)  VALUE '0900'.
   703     12  ER-0909                 PIC X(4)  VALUE '0909'.
   704     12  ER-0911                 PIC X(4)  VALUE '0911'.
   705     12  ER-0912                 PIC X(4)  VALUE '0912'.
   706     12  ER-1236                 PIC X(4)  VALUE '1236'.
   707     12  ER-1560                 PIC X(4)  VALUE '1560'.
   708     12  ER-2055                 PIC X(4)  VALUE '2055'.
   709     12  ER-2397                 PIC X(4)  VALUE '2397'.
   710     12  ER-2398                 PIC X(4)  VALUE '2398'.
   711     12  ER-3547                 PIC X(4)  VALUE '3547'.
   712     12  ER-3770                 PIC X(4)  VALUE '3770'.
   713     12  ER-3771                 PIC X(4)  VALUE '3771'.
   714     12  ER-3772                 PIC X(4)  VALUE '3772'.
   715     12  ER-7675                 PIC X(4)  VALUE '7675'.
   716     12  ER-7840                 PIC X(4)  VALUE '7840'.
   717     12  ER-7842                 PIC X(4)  VALUE '7842'.
   718     12  ER-7843                 PIC X(4)  VALUE '7843'.
   719     12  ER-8158                 PIC X(4)  VALUE '8158'.
   720     12  ER-9106                 PIC X(4)  VALUE '9106'.
   721     12  ER-9483                 PIC X(4)  VALUE '9483'.
   722     12  ER-9808                 PIC X(4)  VALUE '9808'.
   723     12  ER-9883                 PIC X(4)  VALUE '9883'.
   724     12  ER-9887                 PIC X(4)  VALUE '9887'.
   725
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  16
* EL152.cbl
   727****************************************************
   728*       WHEN ADDING OR DELETING ENTRIES TO         *
   729*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
   730*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
   731*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
   732*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
   733*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
   734*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
   735*                                                  *
   736*   3 FIELDS TO CHANGE:                            *
   737*      1 - SS-NUM-ENTRIES........(NO.OF ENTRIES)   *
   738*      2 - SS-WORK-AREA-LENGTH...(TOTAL LENGTH)    *
   739*      3 - SYSTEM-VARIABLES......( "      "   )    *
   740****************************************************
   741
   742*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
   743*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
   744
   745     12  SS-NUM-ENTRIES          PIC 999    VALUE 130      COMP-3.
   746     12  SS-COUNTER              PIC 999                   COMP-3.
   747     12  SS-WORK-AREA-LENGTH     PIC S9(4)  VALUE +3865    COMP.
   748
   749 01  VARIABLE-WORK-AREA.
   750     12  VAR-CODE                PIC X(4).
   751     12  VAR-LEN                 PIC 99.
   752     12  VAR-DATA                PIC X(100).
   753     12  VAR-DATA-R REDEFINES VAR-DATA.
   754       16  VAR-ONE-CHAR OCCURS 100 TIMES INDEXED BY INDXV PIC X.
   755
   756 01  SYSTEM-SUPPORTED-VARIABLES.
   757*****COMPANY NAME
   758     12  SS01                    PIC X(4)  VALUE     '01.0'.
   759     12  SS01L                   PIC 99    VALUE 36.
   760     12  SS01D                   PIC X(30) VALUE ALL '*'.
   761*****FULL COMPANY ADDRESS
   762     12  SS02-1                  PIC X(4)  VALUE     '02.1'.
   763     12  SS02-1L                 PIC 99    VALUE 36.
   764     12  SS02-1D                 PIC X(30) VALUE ALL '*'.
   765     12  SS02-2                  PIC X(4)  VALUE     '02.2'.
   766     12  SS02-2L                 PIC 99    VALUE 36.
   767     12  SS02-2D                 PIC X(30) VALUE ALL '*'.
   768     12  SS02-3                  PIC X(4)  VALUE     '02.3'.
   769     12  SS02-3L                 PIC 99    VALUE 36.
   770     12  SS02-3D                 PIC X(30) VALUE ALL '*'.
   771     12  SS02-4                  PIC X(4)  VALUE     '02.4'.
   772     12  SS02-4L                 PIC 99    VALUE 36.
   773     12  SS02-4D                 PIC X(30) VALUE ALL '*'.
   774     12  SS02-5                  PIC X(4)  VALUE     '02.5'.
   775     12  SS02-5L                 PIC 99    VALUE 36.
   776     12  SS02-5D                 PIC X(30) VALUE ALL '*'.
   777*****CARRIER NAME
   778     12  SS03                    PIC X(4)  VALUE     '03.0'.
   779     12  SS03L                   PIC 99    VALUE 36.
   780     12  SS03D                   PIC X(30) VALUE ALL '*'.
   781*****INVESTORS HERITAGE
   782* as Administrator for Investors Heritage Life Insurance Company
   783     12  SS03-1                  PIC X(4)  VALUE     '03.1'.
   784     12  SS03-1L                 PIC 99    VALUE 68.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  17
* EL152.cbl
   785     12  SS03-1D                 PIC X(62) VALUE ALL '*'.
   786*****FULL CARRIER ADDRESS
   787     12  SS04-1                  PIC X(4)  VALUE     '04.1'.
   788     12  SS04-1L                 PIC 99    VALUE 36.
   789     12  SS04-1D                 PIC X(30) VALUE ALL '*'.
   790     12  SS04-2                  PIC X(4)  VALUE     '04.2'.
   791     12  SS04-2L                 PIC 99    VALUE 36.
   792     12  SS04-2D                 PIC X(30) VALUE ALL '*'.
   793     12  SS04-3                  PIC X(4)  VALUE     '04.3'.
   794     12  SS04-3L                 PIC 99    VALUE 36.
   795     12  SS04-3D                 PIC X(30) VALUE ALL '*'.
   796     12  SS04-4                  PIC X(4)  VALUE     '04.4'.
   797     12  SS04-4L                 PIC 99    VALUE 36.
   798     12  SS04-4D                 PIC X(30) VALUE ALL '*'.
   799     12  SS04-5                  PIC X(4)  VALUE     '04.5'.
   800     12  SS04-5L                 PIC 99    VALUE 36.
   801     12  SS04-5D                 PIC X(30) VALUE ALL '*'.
   802*****CARRIER PHONE NUMBER
   803     12  SS04-6                  PIC X(4)  VALUE     '04.6'.
   804     12  SS04-6L                 PIC 99    VALUE 18.
   805     12  SS04-6D                 PIC X(12) VALUE ALL '*'.
   806*****FULL ADDRESEE LABEL
   807     12  SS05-1                  PIC X(4)  VALUE     '05.1'.
   808     12  SS05-1L                 PIC 99    VALUE 36.
   809     12  SS05-1D                 PIC X(30) VALUE ALL '*'.
   810     12  SS05-2                  PIC X(4)  VALUE     '05.2'.
   811     12  SS05-2L                 PIC 99    VALUE 36.
   812     12  SS05-2D                 PIC X(30) VALUE ALL '*'.
   813     12  SS05-3                  PIC X(4)  VALUE     '05.3'.
   814     12  SS05-3L                 PIC 99    VALUE 36.
   815     12  SS05-3D                 PIC X(30) VALUE ALL '*'.
   816     12  SS05-4                  PIC X(4)  VALUE     '05.4'.
   817     12  SS05-4L                 PIC 99    VALUE 36.
   818     12  SS05-4D                 PIC X(30) VALUE ALL '*'.
   819     12  SS05-5                  PIC X(4)  VALUE     '05.5'.
   820     12  SS05-5L                 PIC 99    VALUE 36.
   821     12  SS05-5D                 PIC X(30) VALUE ALL '*'.
   822     12  SS05-6                  PIC X(4)  VALUE     '05.6'.
   823     12  SS05-6L                 PIC 99    VALUE 36.
   824     12  SS05-6D                 PIC X(30) VALUE ALL '*'.
   825*****ACCOUNT NAME
   826     12  SS06                    PIC X(4)  VALUE     '06.0'.
   827     12  SS06L                   PIC 99    VALUE 36.
   828     12  SS06D                   PIC X(30) VALUE ALL '*'.
   829*****FULL ACCOUNT ADDRESS
   830     12  SS07-1                  PIC X(4)  VALUE     '07.1'.
   831     12  SS07-1L                 PIC 99    VALUE 36.
   832     12  SS07-1D                 PIC X(30) VALUE ALL '*'.
   833     12  SS07-2                  PIC X(4)  VALUE     '07.2'.
   834     12  SS07-2L                 PIC 99    VALUE 36.
   835     12  SS07-2D                 PIC X(30) VALUE ALL '*'.
   836     12  SS07-3                  PIC X(4)  VALUE     '07.3'.
   837     12  SS07-3L                 PIC 99    VALUE 36.
   838     12  SS07-3D                 PIC X(30) VALUE ALL '*'.
   839     12  SS07-4                  PIC X(4)  VALUE     '07.4'.
   840     12  SS07-4L                 PIC 99    VALUE 36.
   841     12  SS07-4D                 PIC X(30) VALUE ALL '*'.
   842     12  SS07-5                  PIC X(4)  VALUE     '07.5'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  18
* EL152.cbl
   843     12  SS07-5L                 PIC 99    VALUE 36.
   844     12  SS07-5D                 PIC X(30) VALUE ALL '*'.
   845*****ACCOUNT PHONE NUMBER
   846     12  SS07-6                  PIC X(4)  VALUE     '07.6'.
   847     12  SS07-6L                 PIC 99    VALUE 18.
   848     12  SS07-6D                 PIC X(12) VALUE ALL '*'.
   849*****EXECUTING PROCESSOR NAME
   850     12  SS08                    PIC X(4)  VALUE     '08.0'.
   851     12  SS08L                   PIC 99    VALUE 36.
   852     12  SS08D                   PIC X(30) VALUE ALL '*'.
   853*****PROCESSOR TITLE
   854     12  SS09                    PIC X(4)  VALUE     '09.0'.
   855     12  SS09L                   PIC 99    VALUE 32.
   856     12  SS09D                   PIC X(26) VALUE ALL '*'.
   857*****INSUREDS NAME
   858     12  SS10                    PIC X(4)  VALUE     '10.0'.
   859     12  SS10L                   PIC 99    VALUE 36.
   860     12  SS10D                   PIC X(30) VALUE ALL '*'.
   861*****INSUREDS ADDRESS
   862     12  SS11-1                  PIC X(4)  VALUE     '11.1'.
   863     12  SS11-1L                 PIC 99    VALUE 36.
   864     12  SS11-1D                 PIC X(30) VALUE ALL '*'.
   865     12  SS11-2                  PIC X(4)  VALUE     '11.2'.
   866     12  SS11-2L                 PIC 99    VALUE 36.
   867     12  SS11-2D                 PIC X(30) VALUE ALL '*'.
   868     12  SS11-3                  PIC X(4)  VALUE     '11.3'.
   869     12  SS11-3L                 PIC 99    VALUE 36.
   870     12  SS11-3D                 PIC X(30) VALUE ALL '*'.
   871     12  SS11-4                  PIC X(4)  VALUE     '11.4'.
   872     12  SS11-4L                 PIC 99    VALUE 36.
   873     12  SS11-4D                 PIC X(30) VALUE ALL '*'.
   874*****INSUREDS NAME FROM ADDR TRAILER
   875     12  SS11-5                  PIC X(4)  VALUE     '11.5'.
   876     12  SS11-5L                 PIC 99    VALUE 36.
   877     12  SS11-5D                 PIC X(30) VALUE ALL '*'.
   878*****INSUREDS PHONE NUMBER FROM ADDR TRAILER
   879     12  SS11-6                  PIC X(4)  VALUE     '11.6'.
   880     12  SS11-6L                 PIC 99    VALUE 18.
   881     12  SS11-6D                 PIC X(12) VALUE ALL '*'.
   882*****CLAIM TYPE NAME
   883     12  SS12                    PIC X(4)  VALUE     '12.0'.
   884     12  SS12L                   PIC 99    VALUE 12.
   885     12  SS12D                   PIC X(6)  VALUE ALL '*'.
   886*****CLAIM INCURRED DATE
   887     12  SS13                    PIC X(4)  VALUE     '13.0'.
   888     12  SS13L                   PIC 99    VALUE 14.
   889     12  SS13D                   PIC X(8)  VALUE ALL '*'.
   890*****CLAIM REPORTED DATE
   891     12  SS14                    PIC X(4)  VALUE     '14.0'.
   892     12  SS14L                   PIC 99    VALUE 14.
   893     12  SS14D                   PIC X(8)  VALUE ALL '*'.
   894*****LAST PAYMENT DATE
   895     12  SS15                    PIC X(4)  VALUE     '15.0'.
   896     12  SS15L                   PIC 99    VALUE 14.
   897     12  SS15D                   PIC X(8)  VALUE ALL '*'.
   898*****LAST PAYMENT AMOUNT
   899     12  SS16                    PIC X(4)  VALUE     '16.0'.
   900     12  SS16L                   PIC 99    VALUE 17.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  19
* EL152.cbl
   901     12  SS16D                   PIC $$$$,$$$.99 VALUE ZEROS.
   902*****CLAIM INTEREST RATE
   903     12  SS16-1                  PIC X(4)  VALUE     '16.1'.
   904     12  SS16-1L                 PIC 99    VALUE 13.
   905     12  SS16-1D                 PIC X(7)        VALUE SPACE.
   906*****CLAIM PAID THRU/TO DATE
   907     12  SS17                    PIC X(4)  VALUE     '17.0'.
   908     12  SS17L                   PIC 99    VALUE 14.
   909     12  SS17D                   PIC X(8)  VALUE ALL '*'.
   910*****TOTAL PAID TO DATE
   911     12  SS18                    PIC X(4)  VALUE     '18.0'.
   912     12  SS18L                   PIC 99    VALUE 17.
   913     12  SS18D                   PIC $$$$,$$$.99 VALUE ZEROS.
   914*****DIAGNOSIS OR CAUSE
   915     12  SS19                    PIC X(4)  VALUE     '19.0'.
   916     12  SS19L                   PIC 99    VALUE 32.
   917     12  SS19D                   PIC X(26) VALUE ALL '*'.
   918*****CAUSE CODE
   919     12  SS19-1                  PIC X(4)  VALUE     '19.1'.
   920     12  SS19-1L                 PIC 99    VALUE 12.
   921     12  SS19-1D                 PIC X(6)  VALUE ALL '*'.
   922*****CID LOAN NUMBER
   923     12  SS19-2                  PIC X(4)  VALUE     '19.2'.
   924     12  SS19-2L                 PIC 99    VALUE 31.
   925     12  SS19-2D                 PIC X(25) VALUE ALL '*'.
   926*****CURRENT DATE
   927     12  SS20                    PIC X(4)  VALUE     '20.0'.
   928     12  SS20L                   PIC 99    VALUE 14.
   929     12  SS20D                   PIC X(8)  VALUE ALL '*'.
   930*****FULL CURRENT DATE
   931     12  SS21                    PIC X(4)  VALUE     '21.0'.
   932     12  SS21L                   PIC 99    VALUE 24.
   933     12  SS21D                   PIC X(18) VALUE ALL '*'.
   934*****BENEFIT DESCRIPTION
   935     12  SS22                    PIC X(4)  VALUE     '22.0'.
   936     12  SS22L                   PIC 99    VALUE 16.
   937     12  SS22D                   PIC X(10) VALUE ALL '*'.
   938*****CARRIER CODE IN CERT
   939     12  SS23                    PIC X(4)  VALUE     '23.0'.
   940     12  SS23L                   PIC 99    VALUE 9.
   941     12  SS23D                   PIC XXX   VALUE ALL '*'.
   942*****GROUPING CODE IN CERT
   943     12  SS24                    PIC X(4)  VALUE     '24.0'.
   944     12  SS24L                   PIC 99    VALUE 12.
   945     12  SS24D                   PIC X(6)  VALUE ALL '*'.
   946*****ACCOUNT NUMBER IN CERT
   947     12  SS25                    PIC X(4)  VALUE     '25.0'.
   948     12  SS25L                   PIC 99    VALUE 16.
   949     12  SS25D                   PIC X(10) VALUE ALL '*'.
   950*****CERTIFICATE NUMBER
   951     12  SS26                    PIC X(4)  VALUE     '26.0'.
   952     12  SS26L                   PIC 99    VALUE 17.
   953     12  SS26D                   PIC X(11) VALUE ALL '*'.
   954*****CERT EFFECTIVE DATE
   955     12  SS27                    PIC X(4)  VALUE     '27.0'.
   956     12  SS27L                   PIC 99    VALUE 14.
   957     12  SS27D                   PIC X(8)  VALUE ALL '*'.
   958*****CERT EXPIRATION DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  20
* EL152.cbl
   959     12  SS28                    PIC X(4)  VALUE     '28.0'.
   960     12  SS28L                   PIC 99    VALUE 14.
   961     12  SS28D                   PIC X(8)  VALUE ALL '*'.
   962*****APPLICABLE COVERAGE TERM
   963     12  SS29                    PIC X(4)  VALUE     '29.0'.
   964     12  SS29L                   PIC 99    VALUE 9.
   965     12  SS29D                   PIC XXX   VALUE ALL '*'.
   966*****APPLICABLE COVERAGE AMOUNT
   967     12  SS30                    PIC X(4)  VALUE     '30.0'.
   968     12  SS30L                   PIC 99    VALUE 18.
   969     12  SS30D                   PIC $$$$$,$$$.99  VALUE ZEROS.
   970*****APPLICABLE COVERAGE CANCEL DATE
   971     12  SS31                    PIC X(4)  VALUE     '31.0'.
   972     12  SS31L                   PIC 99    VALUE 14.
   973     12  SS31D                   PIC X(8)  VALUE ALL '*'.
   974*****APPLICABLE COVERAGE FORM NUMBER
   975     12  SS32                    PIC X(4)  VALUE     '32.0'.
   976     12  SS32L                   PIC 99    VALUE 18.
   977     12  SS32D                   PIC X(12) VALUE ALL '*'.
   978*****INSURES AGE AT POLICY ISSUE
   979     12  SS33                    PIC X(4)  VALUE     '33.0'.
   980     12  SS33L                   PIC 99    VALUE 9.
   981     12  SS33D                   PIC XXX   VALUE ALL '*'.
   982*****CLAIM NUMBER
   983     12  SS34                    PIC X(4)  VALUE     '34.0'.
   984     12  SS34L                   PIC 99    VALUE 13.
   985     12  SS34D                   PIC X(7)  VALUE ALL '*'.
   986*****LAST DENIAL TEXT
   987     12  SS35-1                  PIC X(4)  VALUE     '35.1'.
   988     12  SS35-1L                 PIC 99    VALUE 66.
   989     12  SS35-1D                 PIC X(60) VALUE ALL '*'.
   990     12  SS35-2                  PIC X(4)  VALUE     '35.2'.
   991     12  SS35-2L                 PIC 99    VALUE 66.
   992     12  SS35-2D                 PIC X(60) VALUE ALL '*'.
   993*****LOAN NUMBER
   994     12  SS36                    PIC X(4)  VALUE     '36.0'.
   995     12  SS36L                   PIC 99    VALUE 14.
   996     12  SS36D                   PIC X(8)  VALUE ALL '*'.
   997*****CURRENT LOAN NUMBER
   998     12  SS36-1                  PIC X(4)  VALUE     '36.1'.
   999     12  SS36-1L                 PIC 99    VALUE 26.
  1000     12  SS36-1D                 PIC X(20) VALUE ALL '*'.
  1001*****LOAN BALANCE
  1002     12  SS37                    PIC X(4)  VALUE     '37.0'.
  1003     12  SS37L                   PIC 99    VALUE 18.
  1004     12  SS37D                   PIC $$$$$,$$$.99  VALUE ZEROS.
  1005*****MEMBER NUMBER
  1006     12  SS38                    PIC X(4)  VALUE     '38.0'.
  1007     12  SS38L                   PIC 99    VALUE 18.
  1008     12  SS38D                   PIC X(12) VALUE ALL '*'.
  1009*****INSURED NAME (FIRST M LAST)
  1010     12  SS39                    PIC X(4)  VALUE     '39.0'.
  1011     12  SS39L                   PIC 99    VALUE 36.
  1012     12  SS39D                   PIC X(30) VALUE ALL '*'.
  1013*****INSURED LAST NAME ONLY
  1014     12  SS40                    PIC X(4)  VALUE     '40.0'.
  1015     12  SS40L                   PIC 99    VALUE 21.
  1016     12  SS40D                   PIC X(15) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  21
* EL152.cbl
  1017*****TITLE (MR/MS)
  1018     12  SS41                    PIC X(4)  VALUE     '41.0'.
  1019     12  SS41L                   PIC 99    VALUE 9.
  1020     12  SS41D                   PIC X(3)  VALUE ALL '*'.
  1021*****ELIMINATION PERIOD
  1022     12  SS42                    PIC X(4)  VALUE     '42.0'.
  1023     12  SS42L                   PIC 99    VALUE 9.
  1024     12  SS42D                   PIC X(3)  VALUE ALL '*'.
  1025*****BENEFICIARY NAME
  1026     12  SS43                    PIC X(4)  VALUE     '43.0'.
  1027     12  SS43L                   PIC 99    VALUE 36.
  1028     12  SS43D                   PIC X(30) VALUE ALL '*'.
  1029*****BENEFICIARY ADDRESS
  1030     12  SS44-1                  PIC X(4)  VALUE     '44.1'.
  1031     12  SS44-1L                 PIC 99    VALUE 36.
  1032     12  SS44-1D                 PIC X(30) VALUE ALL '*'.
  1033     12  SS44-2                  PIC X(4)  VALUE     '44.2'.
  1034     12  SS44-2L                 PIC 99    VALUE 36.
  1035     12  SS44-2D                 PIC X(30) VALUE ALL '*'.
  1036     12  SS44-3                  PIC X(4)  VALUE     '44.3'.
  1037     12  SS44-3L                 PIC 99    VALUE 36.
  1038     12  SS44-3D                 PIC X(30) VALUE ALL '*'.
  1039     12  SS44-4                  PIC X(4)  VALUE     '44.4'.
  1040     12  SS44-4L                 PIC 99    VALUE 36.
  1041     12  SS44-4D                 PIC X(30) VALUE ALL '*'.
  1042     12  SS44-5                  PIC X(4)  VALUE     '44.5'.
  1043     12  SS44-5L                 PIC 99    VALUE 18.
  1044     12  SS44-5D                 PIC X(12) VALUE ALL '*'.
  1045     12  SS44-6                  PIC X(4)  VALUE     '44.6'.
  1046     12  SS44-6L                 PIC 99    VALUE 36.
  1047     12  SS44-6D                 PIC X(30) VALUE ALL '*'.
  1048*****INSUREDS DATE OF BIRTH
  1049     12  SS45                    PIC X(4)  VALUE     '45.0'.
  1050     12  SS45L                   PIC 99    VALUE 14.
  1051     12  SS45D                   PIC X(8)  VALUE ALL '*'.
  1052*****INSUREDS SOC SEC NUMBER
  1053     12  SS46                    PIC X(4)  VALUE     '46.0'.
  1054     12  SS46L                   PIC 99    VALUE 17.
  1055     12  SS46D                   PIC X(11) VALUE ALL '*'.
  1056*****PHYSICIANS  NAME
  1057     12  SS47                    PIC X(4)  VALUE     '47.0'.
  1058     12  SS47L                   PIC 99    VALUE 36.
  1059     12  SS47D                   PIC X(30) VALUE ALL '*'.
  1060*****PHYSICIANS  ADDRESS
  1061     12  SS47-1                  PIC X(4)  VALUE     '47.1'.
  1062     12  SS47-1L                 PIC 99    VALUE 36.
  1063     12  SS47-1D                 PIC X(30) VALUE ALL '*'.
  1064     12  SS47-2                  PIC X(4)  VALUE     '47.2'.
  1065     12  SS47-2L                 PIC 99    VALUE 36.
  1066     12  SS47-2D                 PIC X(30) VALUE ALL '*'.
  1067     12  SS47-3                  PIC X(4)  VALUE     '47.3'.
  1068     12  SS47-3L                 PIC 99    VALUE 36.
  1069     12  SS47-3D                 PIC X(30) VALUE ALL '*'.
  1070     12  SS47-4                  PIC X(4)  VALUE     '47.4'.
  1071     12  SS47-4L                 PIC 99    VALUE 36.
  1072     12  SS47-4D                 PIC X(30) VALUE ALL '*'.
  1073     12  SS47-5                  PIC X(4)  VALUE     '47.5'.
  1074     12  SS47-5L                 PIC 99    VALUE 18.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  22
* EL152.cbl
  1075     12  SS47-5D                 PIC X(12) VALUE ALL '*'.
  1076*****EMPLOYERS   NAME
  1077     12  SS48                    PIC X(4)  VALUE     '48.0'.
  1078     12  SS48L                   PIC 99    VALUE 36.
  1079     12  SS48D                   PIC X(30) VALUE ALL '*'.
  1080*****EMPLOYERS   ADDRESS
  1081     12  SS48-1                  PIC X(4)  VALUE     '48.1'.
  1082     12  SS48-1L                 PIC 99    VALUE 36.
  1083     12  SS48-1D                 PIC X(30) VALUE ALL '*'.
  1084     12  SS48-2                  PIC X(4)  VALUE     '48.2'.
  1085     12  SS48-2L                 PIC 99    VALUE 36.
  1086     12  SS48-2D                 PIC X(30) VALUE ALL '*'.
  1087     12  SS48-3                  PIC X(4)  VALUE     '48.3'.
  1088     12  SS48-3L                 PIC 99    VALUE 36.
  1089     12  SS48-3D                 PIC X(30) VALUE ALL '*'.
  1090     12  SS48-4                  PIC X(4)  VALUE     '48.4'.
  1091     12  SS48-4L                 PIC 99    VALUE 36.
  1092     12  SS48-4D                 PIC X(30) VALUE ALL '*'.
  1093     12  SS48-5                  PIC X(4)  VALUE     '48.5'.
  1094     12  SS48-5L                 PIC 99    VALUE 18.
  1095     12  SS48-5D                 PIC X(12) VALUE ALL '*'.
  1096*****OTHER1      NAME
  1097     12  SS49                    PIC X(4)  VALUE     '49.0'.
  1098     12  SS49L                   PIC 99    VALUE 36.
  1099     12  SS49D                   PIC X(30) VALUE ALL '*'.
  1100*****OTHER1      ADDRESS
  1101     12  SS49-1                  PIC X(4)  VALUE     '49.1'.
  1102     12  SS49-1L                 PIC 99    VALUE 36.
  1103     12  SS49-1D                 PIC X(30) VALUE ALL '*'.
  1104     12  SS49-2                  PIC X(4)  VALUE     '49.2'.
  1105     12  SS49-2L                 PIC 99    VALUE 36.
  1106     12  SS49-2D                 PIC X(30) VALUE ALL '*'.
  1107     12  SS49-3                  PIC X(4)  VALUE     '49.3'.
  1108     12  SS49-3L                 PIC 99    VALUE 36.
  1109     12  SS49-3D                 PIC X(30) VALUE ALL '*'.
  1110     12  SS49-4                  PIC X(4)  VALUE     '49.4'.
  1111     12  SS49-4L                 PIC 99    VALUE 36.
  1112     12  SS49-4D                 PIC X(30) VALUE ALL '*'.
  1113     12  SS49-5                  PIC X(4)  VALUE     '49.5'.
  1114     12  SS49-5L                 PIC 99    VALUE 18.
  1115     12  SS49-5D                 PIC X(12) VALUE ALL '*'.
  1116*****OTHER2      NAME
  1117     12  SS50                    PIC X(4)  VALUE     '50.0'.
  1118     12  SS50L                   PIC 99    VALUE 36.
  1119     12  SS50D                   PIC X(30) VALUE ALL '*'.
  1120*****OTHER2      ADDRESS
  1121     12  SS50-1                  PIC X(4)  VALUE     '50.1'.
  1122     12  SS50-1L                 PIC 99    VALUE 36.
  1123     12  SS50-1D                 PIC X(30) VALUE ALL '*'.
  1124     12  SS50-2                  PIC X(4)  VALUE     '50.2'.
  1125     12  SS50-2L                 PIC 99    VALUE 36.
  1126     12  SS50-2D                 PIC X(30) VALUE ALL '*'.
  1127     12  SS50-3                  PIC X(4)  VALUE     '50.3'.
  1128     12  SS50-3L                 PIC 99    VALUE 36.
  1129     12  SS50-3D                 PIC X(30) VALUE ALL '*'.
  1130     12  SS50-4                  PIC X(4)  VALUE     '50.4'.
  1131     12  SS50-4L                 PIC 99    VALUE 36.
  1132     12  SS50-4D                 PIC X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  23
* EL152.cbl
  1133     12  SS50-5                  PIC X(4)  VALUE     '50.5'.
  1134     12  SS50-5L                 PIC 99    VALUE 18.
  1135     12  SS50-5D                 PIC X(12) VALUE ALL '*'.
  1136*****A&H TERM TIMES MON. BEN.
  1137     12  SS51                    PIC X(4)  VALUE     '51.0'.
  1138     12  SS51L                   PIC 99    VALUE 17.
  1139     12  SS51D                   PIC $$$$,$$$.99 VALUE ZEROS.
  1140*****THIRD PARTY NAME
  1141     12  SS52                    PIC X(4)  VALUE     '52.0'.
  1142     12  SS52L                   PIC 99    VALUE 36.
  1143     12  SS52D                   PIC X(30) VALUE ALL '*'.
  1144*****THIRD PARTY ADDRESS
  1145     12  SS53-1                  PIC X(4)  VALUE     '53.1'.
  1146     12  SS53-1L                 PIC 99    VALUE 36.
  1147     12  SS53-1D                 PIC X(30) VALUE ALL '*'.
  1148     12  SS53-2                  PIC X(4)  VALUE     '53.2'.
  1149     12  SS53-2L                 PIC 99    VALUE 36.
  1150     12  SS53-2D                 PIC X(30) VALUE ALL '*'.
  1151     12  SS53-3                  PIC X(4)  VALUE     '53.3'.
  1152     12  SS53-3L                 PIC 99    VALUE 36.
  1153     12  SS53-3D                 PIC X(30) VALUE ALL '*'.
  1154     12  SS53-4                  PIC X(4)  VALUE     '53.4'.
  1155     12  SS53-4L                 PIC 99    VALUE 36.
  1156     12  SS53-4D                 PIC X(30) VALUE ALL '*'.
  1157     12  SS53-5                  PIC X(4)  VALUE     '53.5'.
  1158     12  SS53-5L                 PIC 99    VALUE 36.
  1159     12  SS53-5D                 PIC X(30) VALUE ALL '*'.
  1160*****THIRD PARTY PHONE NUMBER
  1161     12  SS53-6                  PIC X(4)  VALUE     '53.6'.
  1162     12  SS53-6L                 PIC 99    VALUE 18.
  1163     12  SS53-6D                 PIC X(12) VALUE ALL '*'.
  1164*****CERTIFICATE SEQUENCE
  1165     12  SS54                    PIC X(4)  VALUE     '54.0'.
  1166     12  SS54L                   PIC 99    VALUE 09.
  1167     12  SS54D                   PIC XXX VALUE ALL '*'.
  1168*****CERTIFICATE TOTAL  E
  1169     12  SS55                    PIC X(4)  VALUE     '55.0'.
  1170     12  SS55L                   PIC 99    VALUE 09.
  1171     12  SS55D                   PIC XXX VALUE ALL '*'.
  1172*****CREDITOR ID
  1173     12  SS56                    PIC  X(04) VALUE    '56.0'.
  1174     12  SS56L                   PIC  99 VALUE 36.
  1175     12  SS56D                   PIC  X(30) VALUE ALL '*'.
  1176*****INSUREDS NAME (CERTIFICATE)
  1177     12  SS57                    PIC X(4)  VALUE     '57.0'.
  1178     12  SS57L                   PIC 99    VALUE 36.
  1179     12  SS57D                   PIC X(30) VALUE ALL '*'.
  1180*****JOINT NAME (CERTIFICATE)
  1181     12  SS58                    PIC X(4)  VALUE     '58.0'.
  1182     12  SS58L                   PIC 99    VALUE 36.
  1183     12  SS58D                   PIC X(30) VALUE ALL '*'.
  1184*****POLICY REFERENCE NUMBER
  1185     12  SS59                    PIC X(4)  VALUE     '59.0'.
  1186     12  SS59L                   PIC 99    VALUE 26.
  1187     12  SS59D                   PIC X(20) VALUE ALL '*'.
  1188*****CREDIT CARD NUMBER (CLAIMS)
  1189     12  SS60                    PIC X(4)  VALUE     '60.0'.
  1190     12  SS60L                   PIC 99    VALUE 22.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  24
* EL152.cbl
  1191     12  SS60D                   PIC X(16) VALUE ALL '*'.
  1192*****CORRESPONDENCE BENEFICIARY NAME
  1193     12  SS61                    PIC X(4)  VALUE     '61.0'.
  1194     12  SS61L                   PIC 99    VALUE 36.
  1195     12  SS61D                   PIC X(30) VALUE ALL '*'.
  1196*****CORRESPONDENCE BENEFICIARY ADDRESS
  1197     12  SS61-1                  PIC X(4)  VALUE     '61.1'.
  1198     12  SS61-1L                 PIC 99    VALUE 36.
  1199     12  SS61-1D                 PIC X(30) VALUE ALL '*'.
  1200     12  SS61-2                  PIC X(4)  VALUE     '61.2'.
  1201     12  SS61-2L                 PIC 99    VALUE 36.
  1202     12  SS61-2D                 PIC X(30) VALUE ALL '*'.
  1203     12  SS61-3                  PIC X(4)  VALUE     '61.3'.
  1204     12  SS61-3L                 PIC 99    VALUE 36.
  1205     12  SS61-3D                 PIC X(30) VALUE ALL '*'.
  1206     12  SS61-4                  PIC X(4)  VALUE     '61.4'.
  1207     12  SS61-4L                 PIC 99    VALUE 36.
  1208     12  SS61-4D                 PIC X(30) VALUE ALL '*'.
  1209     12  SS61-5                  PIC X(4)  VALUE     '61.5'.
  1210     12  SS61-5L                 PIC 99    VALUE 36.
  1211     12  SS61-5D                 PIC X(30) VALUE ALL '*'.
  1212     12  SS61-6                  PIC X(4)  VALUE     '61.6'.
  1213     12  SS61-6L                 PIC 99    VALUE 18.
  1214     12  SS61-6D                 PIC X(12) VALUE ALL '*'.
  1215
  1216*****DMD UNDERWRITER STATEMENT
  1217     12  SS62                    PIC X(4)  VALUE     '62.0'.
  1218     12  SS62L                   PIC 99    VALUE 56.
  1219     12  SS62D                   PIC X(50) VALUE ALL '*'.
  1220
  1221*****DMD UNDERWRITER NAME
  1222     12  SS63                    PIC X(4)  VALUE     '63.0'.
  1223     12  SS63L                   PIC 99    VALUE 66.
  1224     12  SS63D                   PIC X(60) VALUE ALL '*'.
  1225
  1226*****DMD UNDERWRITER NAME
  1227     12  SS64                    PIC X(4)  VALUE     '64.0'.
  1228     12  SS64L                   PIC 99    VALUE 66.
  1229     12  SS64D                   PIC X(60) VALUE ALL '*'.
  1230
  1231****************************************************
  1232*       WHEN ADDING OR DELETING ENTRIES TO         *
  1233*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
  1234*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
  1235*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
  1236*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
  1237*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
  1238*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
  1239****************************************************
  1240*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  1241*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  1242
  1243 01  SYSTEM-VARIABLES            PIC X(3865).
  1244 01  SYS-VAR-ENTRY.
  1245     12  SYS-VAR-CODE            PIC X(4).
  1246     12  SYS-VAR-LEN             PIC 99.
  1247     12  SYS-VAR-DATA            PIC X(100).
  1248
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  25
* EL152.cbl
  1249*                                COPY ELCDATE.
  1250******************************************************************
  1251*                                                                *
  1252*                                                                *
  1253*                            ELCDATE.                            *
  1254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1255*                            VMOD=2.003
  1256*                                                                *
  1257*                                                                *
  1258*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1259*                 LENGTH = 200                                   *
  1260******************************************************************
  1261
  1262 01  DATE-CONVERSION-DATA.
  1263     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1264     12  DC-OPTION-CODE                PIC X.
  1265         88  BIN-TO-GREG                VALUE ' '.
  1266         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1267         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1268         88  YMD-GREG-TO-BIN            VALUE '3'.
  1269         88  MDY-GREG-TO-BIN            VALUE '4'.
  1270         88  JULIAN-TO-BIN              VALUE '5'.
  1271         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1272         88  FIND-CENTURY               VALUE '7'.
  1273         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1274         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1275         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1276         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1277         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1278         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1279         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1280         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1281         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1282         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1283         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1284         88  BIN-3-TO-GREG              VALUE 'I'.
  1285         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1286         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1287         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1288         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1289         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1290         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1291         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1292         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1293         88  THREE-CHARACTER-BIN
  1294                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1295         88  GREGORIAN-TO-BIN
  1296                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1297         88  BIN-TO-GREGORIAN
  1298                  VALUES ' ' '1' 'I' '8' 'G'.
  1299         88  JULIAN-TO-BINARY
  1300                  VALUES '5' 'C' 'E' 'F'.
  1301     12  DC-ERROR-CODE                 PIC X.
  1302         88  NO-CONVERSION-ERROR        VALUE ' '.
  1303         88  DATE-CONVERSION-ERROR
  1304                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1305         88  DATE-IS-ZERO               VALUE '1'.
  1306         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  26
* EL152.cbl
  1307         88  DATE-IS-INVALID            VALUE '3'.
  1308         88  DATE1-GREATER-DATE2        VALUE '4'.
  1309         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1310         88  DATE-INVALID-OPTION        VALUE '9'.
  1311         88  INVALID-CENTURY            VALUE 'A'.
  1312         88  ONLY-CENTURY               VALUE 'B'.
  1313         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1314         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1315     12  DC-END-OF-MONTH               PIC X.
  1316         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1317     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1318         88  USE-NORMAL-PROCESS         VALUE ' '.
  1319         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1320         88  ADJUST-UP-100-YRS          VALUE '2'.
  1321     12  FILLER                        PIC X.
  1322     12  DC-CONVERSION-DATES.
  1323         16  DC-BIN-DATE-1             PIC XX.
  1324         16  DC-BIN-DATE-2             PIC XX.
  1325         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1326         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1327                       DC-GREG-DATE-1-EDIT.
  1328             20  DC-EDIT1-MONTH        PIC 99.
  1329             20  SLASH1-1              PIC X.
  1330             20  DC-EDIT1-DAY          PIC 99.
  1331             20  SLASH1-2              PIC X.
  1332             20  DC-EDIT1-YEAR         PIC 99.
  1333         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1334         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1335                     DC-GREG-DATE-2-EDIT.
  1336             20  DC-EDIT2-MONTH        PIC 99.
  1337             20  SLASH2-1              PIC X.
  1338             20  DC-EDIT2-DAY          PIC 99.
  1339             20  SLASH2-2              PIC X.
  1340             20  DC-EDIT2-YEAR         PIC 99.
  1341         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1342         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1343                     DC-GREG-DATE-1-YMD.
  1344             20  DC-YMD-YEAR           PIC 99.
  1345             20  DC-YMD-MONTH          PIC 99.
  1346             20  DC-YMD-DAY            PIC 99.
  1347         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1348         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1349                      DC-GREG-DATE-1-MDY.
  1350             20  DC-MDY-MONTH          PIC 99.
  1351             20  DC-MDY-DAY            PIC 99.
  1352             20  DC-MDY-YEAR           PIC 99.
  1353         16  DC-GREG-DATE-1-ALPHA.
  1354             20  DC-ALPHA-MONTH        PIC X(10).
  1355             20  DC-ALPHA-DAY          PIC 99.
  1356             20  FILLER                PIC XX.
  1357             20  DC-ALPHA-CENTURY.
  1358                 24 DC-ALPHA-CEN-N     PIC 99.
  1359             20  DC-ALPHA-YEAR         PIC 99.
  1360         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1361         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1362         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1363         16  DC-JULIAN-DATE            PIC 9(05).
  1364         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  27
* EL152.cbl
  1365                                       PIC 9(05).
  1366         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1367             20  DC-JULIAN-YEAR        PIC 99.
  1368             20  DC-JULIAN-DAYS        PIC 999.
  1369         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1370         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1371         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1372     12  DATE-CONVERSION-VARIBLES.
  1373         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1374         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1375             20  FILLER                PIC 9(3).
  1376             20  HOLD-CEN-1-CCYY.
  1377                 24  HOLD-CEN-1-CC     PIC 99.
  1378                 24  HOLD-CEN-1-YY     PIC 99.
  1379             20  HOLD-CEN-1-MO         PIC 99.
  1380             20  HOLD-CEN-1-DA         PIC 99.
  1381         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1382             20  HOLD-CEN-1-R-MO       PIC 99.
  1383             20  HOLD-CEN-1-R-DA       PIC 99.
  1384             20  HOLD-CEN-1-R-CCYY.
  1385                 24  HOLD-CEN-1-R-CC   PIC 99.
  1386                 24  HOLD-CEN-1-R-YY   PIC 99.
  1387             20  FILLER                PIC 9(3).
  1388         16  HOLD-CENTURY-1-X.
  1389             20  FILLER                PIC X(3)  VALUE SPACES.
  1390             20  HOLD-CEN-1-X-CCYY.
  1391                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1392                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1393             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1394             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1395         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1396             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1397             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1398             20  HOLD-CEN-1-R-X-CCYY.
  1399                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1400                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1401             20  FILLER                PIC XXX.
  1402         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1403         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1404         16  DC-JULIAN-DATE-1          PIC 9(07).
  1405         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1406             20  DC-JULIAN-1-CCYY.
  1407                 24  DC-JULIAN-1-CC    PIC 99.
  1408                 24  DC-JULIAN-1-YR    PIC 99.
  1409             20  DC-JULIAN-DA-1        PIC 999.
  1410         16  DC-JULIAN-DATE-2          PIC 9(07).
  1411         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1412             20  DC-JULIAN-2-CCYY.
  1413                 24  DC-JULIAN-2-CC    PIC 99.
  1414                 24  DC-JULIAN-2-YR    PIC 99.
  1415             20  DC-JULIAN-DA-2        PIC 999.
  1416         16  DC-GREG-DATE-A-EDIT.
  1417             20  DC-EDITA-MONTH        PIC 99.
  1418             20  SLASHA-1              PIC X VALUE '/'.
  1419             20  DC-EDITA-DAY          PIC 99.
  1420             20  SLASHA-2              PIC X VALUE '/'.
  1421             20  DC-EDITA-CCYY.
  1422                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  28
* EL152.cbl
  1423                 24  DC-EDITA-YEAR     PIC 99.
  1424         16  DC-GREG-DATE-B-EDIT.
  1425             20  DC-EDITB-MONTH        PIC 99.
  1426             20  SLASHB-1              PIC X VALUE '/'.
  1427             20  DC-EDITB-DAY          PIC 99.
  1428             20  SLASHB-2              PIC X VALUE '/'.
  1429             20  DC-EDITB-CCYY.
  1430                 24  DC-EDITB-CENT     PIC 99.
  1431                 24  DC-EDITB-YEAR     PIC 99.
  1432         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1433         16  DC-GREG-DATE-CYMD-R REDEFINES
  1434                              DC-GREG-DATE-CYMD.
  1435             20  DC-CYMD-CEN           PIC 99.
  1436             20  DC-CYMD-YEAR          PIC 99.
  1437             20  DC-CYMD-MONTH         PIC 99.
  1438             20  DC-CYMD-DAY           PIC 99.
  1439         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1440         16  DC-GREG-DATE-MDCY-R REDEFINES
  1441                              DC-GREG-DATE-MDCY.
  1442             20  DC-MDCY-MONTH         PIC 99.
  1443             20  DC-MDCY-DAY           PIC 99.
  1444             20  DC-MDCY-CEN           PIC 99.
  1445             20  DC-MDCY-YEAR          PIC 99.
  1446    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1447        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1448    12  DC-EL310-DATE                  PIC X(21).
  1449    12  FILLER                         PIC X(28).
  1450
  1451*                                COPY ELCLOGOF.
  1452******************************************************************
  1453*                                                                *
  1454*                                                                *
  1455*                            ELCLOGOF.                           *
  1456*                            VMOD=2.001                          *
  1457*                                                                *
  1458*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1459*                                                                *
  1460******************************************************************
  1461 01  CLASIC-LOGOFF.
  1462     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1463     12  LOGOFF-TEXT.
  1464         16  FILLER          PIC X(5)    VALUE SPACES.
  1465         16  LOGOFF-MSG.
  1466             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1467             20  FILLER      PIC X       VALUE SPACES.
  1468             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1469         16  FILLER          PIC X(80)
  1470           VALUE '* YOU ARE NOW LOGGED OFF'.
  1471         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1472         16  FILLER          PIC X       VALUE QUOTE.
  1473         16  LOGOFF-SYS-MSG  PIC X(17)
  1474           VALUE 'S CLAS-IC SYSTEM '.
  1475     12  TEXT-MESSAGES.
  1476         16  UNACCESS-MSG    PIC X(29)
  1477             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1478         16  PGMIDERR-MSG    PIC X(17)
  1479             VALUE 'PROGRAM NOT FOUND'.
  1480
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  29
* EL152.cbl
  1482*                                COPY ELCNWA.
  1483*****************************************************************
  1484*                                                               *
  1485*                                                               *
  1486*                            ELCNWA.                            *
  1487*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1488*                            VMOD=2.003                         *
  1489*                                                               *
  1490*            M O V E   N A M E   W O R K   A R E A.             *
  1491*                                                               *
  1492*****************************************************************.
  1493
  1494 01  WS-NAME-WORK-AREA.
  1495     05  WS-INSURED-LAST-NAME        PIC X(15).
  1496     05  WS-INSURED-1ST-NAME         PIC X(12).
  1497     05  WS-INSURED-MID-INIT         PIC X.
  1498
  1499     05  WS-NAME-WORK.
  1500         10  WS-NW                   PIC X
  1501             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1502
  1503     05  WS-NAME-WORK2.
  1504         10  WS-NW2                  PIC X
  1505             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1506                                        NWA-INDEX0.
  1507
  1508     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1509                                     COMP-3.
  1510
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  30
* EL152.cbl
  1512*                                COPY ELCATTR.
  1513******************************************************************
  1514*                                                                *
  1515*                            ELCATTR.                            *
  1516*                            VMOD=2.001                          *
  1517*                                                                *
  1518*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1519*                                                                *
  1520*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1521*                                                                *
  1522*                   POS 1   P=PROTECTED                          *
  1523*                           U=UNPROTECTED                        *
  1524*                           S=ASKIP                              *
  1525*                   POS 2   A=ALPHA/NUMERIC                      *
  1526*                           N=NUMERIC                            *
  1527*                   POS 3   N=NORMAL                             *
  1528*                           B=BRIGHT                             *
  1529*                           D=DARK                               *
  1530*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1531*                           OF=MODIFIED DATA TAG OFF             *
  1532*                                                                *
  1533*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1534******************************************************************
  1535 01  ATTRIBUTE-LIST.
  1536     12  AL-PABOF            PIC X       VALUE 'Y'.
  1537     12  AL-PABON            PIC X       VALUE 'Z'.
  1538     12  AL-PADOF            PIC X       VALUE '%'.
  1539     12  AL-PADON            PIC X       VALUE '_'.
  1540     12  AL-PANOF            PIC X       VALUE '-'.
  1541     12  AL-PANON            PIC X       VALUE '/'.
  1542     12  AL-SABOF            PIC X       VALUE '8'.
  1543     12  AL-SABON            PIC X       VALUE '9'.
  1544     12  AL-SADOF            PIC X       VALUE '@'.
  1545     12  AL-SADON            PIC X       VALUE QUOTE.
  1546     12  AL-SANOF            PIC X       VALUE '0'.
  1547     12  AL-SANON            PIC X       VALUE '1'.
  1548     12  AL-UABOF            PIC X       VALUE 'H'.
  1549     12  AL-UABON            PIC X       VALUE 'I'.
  1550     12  AL-UADOF            PIC X       VALUE '<'.
  1551     12  AL-UADON            PIC X       VALUE '('.
  1552     12  AL-UANOF            PIC X       VALUE ' '.
  1553     12  AL-UANON            PIC X       VALUE 'A'.
  1554     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1555     12  AL-UNBON            PIC X       VALUE 'R'.
  1556     12  AL-UNDOF            PIC X       VALUE '*'.
  1557     12  AL-UNDON            PIC X       VALUE ')'.
  1558     12  AL-UNNOF            PIC X       VALUE '&'.
  1559     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  31
* EL152.cbl
  1561*                                COPY ELCEMIB.
  1562******************************************************************
  1563*                                                                *
  1564*                                                                *
  1565*                            ELCEMIB.                            *
  1566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1567*                            VMOD=2.005                          *
  1568*                                                                *
  1569*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1570*                                                                *
  1571******************************************************************
  1572 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1573     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1574     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1575     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1576     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1577     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1578     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1579     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1580     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1581     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1582         88  EMI-NO-ERRORS                    VALUE '1'.
  1583         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1584         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1585     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1586         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1587     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1588         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1589         88  EMI-AREA1-FULL                   VALUE '2'.
  1590     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1591         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1592         88  EMI-AREA2-FULL                   VALUE '2'.
  1593     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1594         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1595         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1596         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1597         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1598         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1599     12  EMI-ERROR-LINES.
  1600         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1601         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1602         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1603         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1604             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1605                 24  EMI-ERR-NUM         PIC X(4).
  1606                 24  EMI-FILLER          PIC X.
  1607                 24  EMI-SEV             PIC X.
  1608                 24  FILLER              PIC X.
  1609             20  FILLER                  PIC X(02).
  1610     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1611         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1612             20  EMI-ERROR-NUMBER    PIC X(4).
  1613             20  EMI-FILL            PIC X.
  1614             20  EMI-SEVERITY        PIC X.
  1615             20  FILLER              PIC X.
  1616             20  EMI-ERROR-TEXT.
  1617                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1618                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  32
* EL152.cbl
  1619     12  EMI-SEVERITY-SAVE           PIC X.
  1620         88  EMI-NOTE                    VALUE 'N'.
  1621         88  EMI-WARNING                 VALUE 'W'.
  1622         88  EMI-FORCABLE                VALUE 'F'.
  1623         88  EMI-FATAL                   VALUE 'X'.
  1624     12  EMI-MESSAGE-FLAG            PIC X.
  1625         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1626         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1627     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1628     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1629         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1630         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1631         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1632     12  FILLER                      PIC X(137)  VALUE SPACES.
  1633     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1634     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1635     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1636     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1637 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  33
* EL152.cbl
  1639*                                COPY ELCINTF.
  1640******************************************************************
  1641*                                                                *
  1642*                                                                *
  1643*                            ELCINTF.                            *
  1644*                            VMOD=2.017                          *
  1645*                                                                *
  1646*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1647*                                                                *
  1648*       LENGTH = 1024                                            *
  1649*                                                                *
  1650******************************************************************
  1651 01  PROGRAM-INTERFACE-BLOCK.
  1652     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1653     12  PI-CALLING-PROGRAM              PIC X(8).
  1654     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1655     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1656     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1657     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1658     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1659     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1660     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1661     12  PI-COMPANY-ID                   PIC XXX.
  1662     12  PI-COMPANY-CD                   PIC X.
  1663
  1664     12  PI-COMPANY-PASSWORD             PIC X(8).
  1665
  1666     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1667
  1668     12  PI-CONTROL-IN-PROGRESS.
  1669         16  PI-CARRIER                  PIC X.
  1670         16  PI-GROUPING                 PIC X(6).
  1671         16  PI-STATE                    PIC XX.
  1672         16  PI-ACCOUNT                  PIC X(10).
  1673         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1674                                         PIC X(10).
  1675         16  PI-CLAIM-CERT-GRP.
  1676             20  PI-CLAIM-NO             PIC X(7).
  1677             20  PI-CERT-NO.
  1678                 25  PI-CERT-PRIME       PIC X(10).
  1679                 25  PI-CERT-SFX         PIC X.
  1680             20  PI-CERT-EFF-DT          PIC XX.
  1681         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1682             20  PI-PLAN-CODE            PIC X(2).
  1683             20  PI-REVISION-NUMBER      PIC X(3).
  1684             20  PI-PLAN-EFF-DT          PIC X(2).
  1685             20  PI-PLAN-EXP-DT          PIC X(2).
  1686             20  FILLER                  PIC X(11).
  1687         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1688             20  PI-OE-REFERENCE-1.
  1689                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1690                 25  PI-OE-REF-1-SUFF    PIC XX.
  1691
  1692     12  PI-SESSION-IN-PROGRESS          PIC X.
  1693         88  CLAIM-SESSION                   VALUE '1'.
  1694         88  CREDIT-SESSION                  VALUE '2'.
  1695         88  WARRANTY-SESSION                VALUE '3'.
  1696         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  34
* EL152.cbl
  1697         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1698
  1699
  1700*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1701
  1702     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1703     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1704
  1705     12  PI-CREDIT-USER                  PIC X.
  1706         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1707         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1708
  1709     12  PI-CLAIM-USER                   PIC X.
  1710         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1711         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1712
  1713     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1714         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1715         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1716         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1717         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1718         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1719
  1720     12  PI-PROCESSOR-ID                 PIC X(4).
  1721
  1722     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1723
  1724     12  PI-MEMBER-CAPTION               PIC X(10).
  1725
  1726     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1727         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1728
  1729     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1730     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1731     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1732     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1733
  1734     12  PI-AH-OVERRIDE-L1               PIC X.
  1735     12  PI-AH-OVERRIDE-L2               PIC XX.
  1736     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1737     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1738
  1739     12  PI-NEW-SYSTEM                   PIC X(2).
  1740
  1741     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1742     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1743         88  PI-USES-PAID-TO                 VALUE '1'.
  1744     12  PI-CRDTCRD-SYSTEM.
  1745         16  PI-CRDTCRD-USER             PIC X.
  1746             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1747             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1748         16  PI-CC-MONTH-END-DT          PIC XX.
  1749     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1750
  1751     12  PI-OE-REFERENCE-2.
  1752         16  PI-OE-REF-2-PRIME           PIC X(10).
  1753         16  PI-OE-REF-2-SUFF            PIC X.
  1754
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  35
* EL152.cbl
  1755     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1756
  1757     12  PI-LANGUAGE-TYPE                PIC X.
  1758             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1759             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1760             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1761
  1762     12  PI-POLICY-LINKAGE-IND           PIC X.
  1763         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1764         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1765                                                   LOW-VALUES.
  1766
  1767     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1768     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1769         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1770         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1771     12  FILLER                          PIC X(4).
  1772
  1773     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1774
  1775     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1776         PI-SYSTEM-LEVEL.
  1777
  1778         16  PI-ENTRY-CODES.
  1779             20  PI-ENTRY-CD-1           PIC X.
  1780             20  PI-ENTRY-CD-2           PIC X.
  1781
  1782         16  PI-RETURN-CODES.
  1783             20  PI-RETURN-CD-1          PIC X.
  1784             20  PI-RETURN-CD-2          PIC X.
  1785
  1786         16  PI-UPDATE-STATUS-SAVE.
  1787             20  PI-UPDATE-BY            PIC X(4).
  1788             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1789
  1790         16  PI-LOWER-CASE-LETTERS       PIC X.
  1791             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1792
  1793*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1794*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1795*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1796
  1797         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1798             88  ST-ACCNT-CNTL               VALUE ' '.
  1799             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1800             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1801             88  ACCNT-CNTL                  VALUE '3'.
  1802             88  CARR-ACCNT-CNTL             VALUE '4'.
  1803
  1804         16  PI-PROCESSOR-CAP-LIST.
  1805             20  PI-SYSTEM-CONTROLS.
  1806                24 PI-SYSTEM-DISPLAY     PIC X.
  1807                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1808                24 PI-SYSTEM-MODIFY      PIC X.
  1809                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1810             20  FILLER                  PIC XX.
  1811             20  PI-DISPLAY-CAP          PIC X.
  1812                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  36
* EL152.cbl
  1813             20  PI-MODIFY-CAP           PIC X.
  1814                 88  MODIFY-CAP              VALUE 'Y'.
  1815             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1816                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1817             20  PI-FORCE-CAP            PIC X.
  1818                 88  FORCE-CAP               VALUE 'Y'.
  1819
  1820         16  PI-PROGRAM-CONTROLS.
  1821             20  PI-PGM-PRINT-OPT        PIC X.
  1822             20  PI-PGM-FORMAT-OPT       PIC X.
  1823             20  PI-PGM-PROCESS-OPT      PIC X.
  1824             20  PI-PGM-TOTALS-OPT       PIC X.
  1825
  1826         16  PI-HELP-INTERFACE.
  1827             20  PI-LAST-ERROR-NO        PIC X(4).
  1828             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1829
  1830         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1831             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1832
  1833         16  PI-CR-CONTROL-IN-PROGRESS.
  1834             20  PI-CR-CARRIER           PIC X.
  1835             20  PI-CR-GROUPING          PIC X(6).
  1836             20  PI-CR-STATE             PIC XX.
  1837             20  PI-CR-ACCOUNT           PIC X(10).
  1838             20  PI-CR-FIN-RESP          PIC X(10).
  1839             20  PI-CR-TYPE              PIC X.
  1840
  1841         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1842
  1843         16  PI-CR-MONTH-END-DT          PIC XX.
  1844
  1845         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1846             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1847             88  PI-ZERO-CARRIER             VALUE '1'.
  1848             88  PI-ZERO-GROUPING            VALUE '2'.
  1849             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1850
  1851         16  PI-CARRIER-SECURITY         PIC X.
  1852             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1853
  1854         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1855             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1856             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1857
  1858         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1859             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1860                                         INDEXED BY PI-ACCESS-NDX
  1861                                         PIC X.
  1862
  1863         16  PI-GA-BILLING-CONTROL       PIC X.
  1864             88  PI-GA-BILLING               VALUE '1'.
  1865
  1866         16  PI-MAIL-PROCESSING          PIC X.
  1867             88  PI-MAIL-YES                 VALUE 'Y'.
  1868
  1869         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1870
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  37
* EL152.cbl
  1871         16  PI-AR-SYSTEM.
  1872             20  PI-AR-PROCESSING-CNTL   PIC X.
  1873                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1874             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1875             20  PI-AR-MONTH-END-DT      PIC XX.
  1876
  1877         16  PI-MP-SYSTEM.
  1878             20  PI-MORTGAGE-USER            PIC X.
  1879                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1880                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1881             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1882                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1883                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1884                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1885                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1886                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1887             20  PI-MP-MONTH-END-DT          PIC XX.
  1888             20  PI-MP-REFERENCE-NO.
  1889                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1890                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1891
  1892         16  PI-LABEL-CONTROL            PIC X(01).
  1893             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1894             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1895
  1896         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1897             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1898
  1899         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1900             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1901             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1902
  1903         16  FILLER                      PIC X(14).
  1904
  1905     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1906******************************************************************
  1907     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1908*        COPY ELC1042.
  1909******************************************************************
  1910*                                                                *
  1911*                                                                *
  1912*                           ELC1042                              *
  1913*                            VMOD=2.002                          *
  1914*                                                                *
  1915*    NOTE                                                        *
  1916*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1917*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1918*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1919*        TO THESE PROGRAMS.                                      *
  1920*                                                                *
  1921*    NOTE                                                        *
  1922*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1923*        USE ONLY!                                               *
  1924*                                                                *
  1925******************************************************************
  1926
  1927         16  PI-1042-WA.
  1928             20  PI-ACTION       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  38
* EL152.cbl
  1929                 88 PI-SHOW-MODE           VALUE '1'.
  1930                 88 PI-CLEAR-MODE          VALUE '2'.
  1931                 88 PI-CREATE-MODE         VALUE '3'.
  1932             20  PI-COMM-CONTROL PIC  X(12).
  1933             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1934             20  PI-EOF-SW       PIC  X(01).
  1935                 88  PI-FILE-EOF           VALUE 'Y'.
  1936             20  PI-FILETYP      PIC  X(01).
  1937             20  PI-FORM-SQUEEZE-CONTROL
  1938                                 PIC  X(01).
  1939                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1940                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1941             20  PI-LAST-CONTROL PIC  X(12).
  1942             20  PI-TEMP-STOR-ITEMS
  1943                                 PIC S9(04) COMP.
  1944             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1945             20  PI-UPDATE-SW    PIC  9(01).
  1946                 88 ANY-UPDATES            VALUE 1.
  1947             20  PI-104-SCREEN-SENT-IND
  1948                                 PIC  X(01).
  1949                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1950                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1951             20  PI-1042-SCREEN-SENT-IND
  1952                                 PIC  X(01).
  1953                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1954                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1955             20  PI-1042-ARCHIVE-IND
  1956                                 PIC  X(01).
  1957                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1958             20  FILLER          PIC  X(29).
  1959**********************************************************
  1960*    NOTE                                                *
  1961*        THE WORK AREA IS USED BY EL152 AND EL1522       *
  1962*        AND CANNOT BE REARRANGED WITHOUT COMPILING      *
  1963*        BOTH PROGRAMS.                                  *
  1964*                                                        *
  1965**********************************************************
  1966         16  PI-EL152-WA.
  1967             20  PI-ALT-PRINTER-ID        PIC X(4).
  1968             20  PI-ARCHIVE-NUMBER        PIC 9(8).
  1969             20  PI-FORM-NUMBER           PIC X(4).
  1970             20  PI-ADDR-TYPE             PIC XX.
  1971             20  PI-TEMP-STOR-ID          PIC X(8).
  1972             20  PI-NUM-PRINT-COPIES      PIC 9.
  1973             20  PI-ADDR-SEQ              PIC S9(4)   COMP.
  1974             20  PI-PRINT-SW              PIC X.
  1975                 88 PRINT-PERFORMED  VALUE '1'.
  1976             20  PI-LETTER-ADDRESS-TYPE   PIC XX.
  1977             20  PI-RESEND-FORM-NUMBER    PIC X(4).
  1978             20  PI-PROMPT-LETTER         PIC X.
  1979             20  PI-ENCLOSURE-CD          PIC X(3).
  1980             20  PI-AUTO-CLOSE-IND        PIC X(1).
  1981             20  PI-LETTER-TO-BENE        PIC X(1).
  1982             20  PI-FILLER                PIC X(528).
  1983             20  PI-FORCE-7840            PIC X.
  1984                 88 FORCE-7840       VALUE '1'.
  1985
  1986             20  PI-BSR-LETTER-IND        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  39
* EL152.cbl
  1987                 88  PI-BSR-AUTOMATED VALUE 'BA'.
  1988             20  FILLER REDEFINES PI-BSR-LETTER-IND.
  1989                 22  PI-ELLETR-BSR        PIC X.
  1990                 22  PI-ELBENE-BSR        PIC X.
  1991
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  40
* EL152.cbl
  1993*                            COPY DFHBMSCA.
  1994*****************************************************************
  1995*                                                               *
  1996* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1997* All rights reserved.                                          *
  1998*                                                               *
  1999*****************************************************************
  2000 01    DFHBMSCA.
  2001*        VARIABLE  PROTECTION    INTENSITY    MODIFIED
  2002*                                             DATA TAG
  2003*
  2004*        DFHBMUNP  Unprotected   Normal       Off
  2005     02  DFHBMUNP PIC X VALUE SPACE.
  2006*        DFHBMUNN  Numeric       Normal       Off
  2007     02  DFHBMUNN PIC X VALUE "&".
  2008*        DFHBMPRO  Protected     Normal       Off
  2009     02  DFHBMPRO PIC X VALUE "-".
  2010*        DFHBMASK  Autoskip      Normal       Off
  2011     02  DFHBMASK PIC X VALUE "0".
  2012*************************************************
  2013*        DFHBMBRY  Unprotected   Bright       Off
  2014     02  DFHBMBRY PIC X VALUE "H".
  2015*        DFHPROTI  Protected     Bright       Off
  2016     02  DFHPROTI PIC X VALUE "Y".
  2017*        DFHBMASB  Autoskip      Bright       Off
  2018     02  DFHBMASB PIC X VALUE "8".
  2019*************************************************
  2020*        DFHBMDAR  Unprotected   Non-Display  Off
  2021     02  DFHBMDAR PIC X VALUE "<".
  2022*        DFHPROTN  Protected     Non-Display  Off
  2023     02  DFHPROTN PIC X VALUE "%".
  2024*************************************************
  2025*        DFHBMFSE  Unprotected   Normal       On
  2026     02  DFHBMFSE PIC X VALUE "A".
  2027*        DFHBMASF  Autoskip      Normal       On
  2028     02  DFHBMASF  PIC X VALUE "1".
  2029*        DFHUNNUM  Numeric       Normal       On
  2030     02  DFHUNNUM PIC X VALUE "J".
  2031*        DFHBMPRF  Protected     Normal       On
  2032     02  DFHBMPRF PIC X VALUE "/".
  2033*************************************************
  2034*        DFHUNIMD  Unprotected   Bright       On
  2035     02  DFHUNIMD PIC X VALUE "I".
  2036*        DFHUNINT  Numeric       Bright       On
  2037     02  DFHUNINT PIC X VALUE "R".
  2038*************************************************
  2039*        DFHUNNOD  Unprotected   Non-Display  On
  2040     02  DFHUNNOD PIC X VALUE "(".
  2041*        DFHUNNON  Numeric       Non-Display  On
  2042     02  DFHUNNON PIC X VALUE ")".
  2043*************************************************
  2044*
  2045*     COLOURS
  2046*
  2047     02  DFHDFCOL PIC X VALUE X"00".
  2048     02  DFHBLUE  PIC X VALUE "1".
  2049     02  DFHRED   PIC X VALUE "2".
  2050     02  DFHPINK  PIC X VALUE "3".
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  41
* EL152.cbl
  2051     02  DFHGREEN PIC X VALUE "4".
  2052     02  DFHTURQ  PIC X VALUE "5".
  2053     02  DFHYELLO PIC X VALUE "6".
  2054     02  DFHNEUTR PIC X VALUE "7".
  2055     02  DFH3270  PIC X VALUE "{".
  2056     02  DFHALL   PIC X VALUE LOW-VALUE.
  2057     02  DFHBASE  PIC X VALUE LOW-VALUE.
  2058     02  DFHBLINK PIC X VALUE "1".
  2059     02  DFHBMDET PIC X VALUE LOW-VALUE.
  2060     02  DFHBMEOF PIC X VALUE X"80".
  2061     02  DFHBMPEM PIC X VALUE X"19".
  2062* Newline, DFHBMPNL, is changed to be an ASCII 0x0A
  2063     02  DFHBMPNL PIC X VALUE X"0A".
  2064     02  DFHCOLOR PIC X VALUE "!".
  2065     02  DFHDFHI  PIC X VALUE LOW-VALUE.
  2066     02  DFHDFT   PIC X VALUE X"FF".
  2067     02  DFHERROR PIC X VALUE X"1A".
  2068     02  DFHHLT   PIC X VALUE " ".
  2069     02  DFHMENT  PIC X VALUE X"02".
  2070     02  DFHBMCUR  PIC X VALUE X"02".
  2071     02  DFHBMFLG  PIC X.
  2072         88 DFHCURSR VALUES ARE X"02" , X"82".
  2073     02  DFHMET   PIC X VALUE X"03".
  2074     02  DFHMFE   PIC X VALUE X"06".
  2075     02  DFHMFET  PIC X VALUE LOW-VALUE.
  2076     02  DFHMFIL  PIC X VALUE X"1C".
  2077     02  DFHMFT   PIC X VALUE X"09".
  2078     02  DFHMT    PIC X VALUE X"01".
  2079     02  DFHPS    PIC X VALUE '"'.
  2080     02  DFHREVRS PIC X VALUE "2".
  2081     02  DFHSA    PIC X VALUE X"08".
  2082     02  DFHUNDLN PIC X VALUE "4".
  2083     02  DFHVAL   PIC X VALUE "A".
  2084     02  DFHLEFT  PIC X VALUE X"97".
  2085     02  DFHOVER  PIC X VALUE X"9C".
  2086     02  DFHRIGHT PIC X VALUE X"02".
  2087     02  DFHUNDER PIC X VALUE X"01".
  2088     02  DFHBOX-BIN  PIC 9(4) COMP VALUE 15.
  2089     02  FILLER REDEFINES DFHBOX-BIN.
  2090         03  FILLER PIC X.
  2091         03  DFHBOX PIC X.
  2092     02  DFHSOSI  PIC X VALUE X"01".
  2093     02  DFHBMPSO-BIN    PIC 9(4) COMP VALUE 3599.
  2094     02  FILLER REDEFINES DFHBMPSO-BIN.
  2095         03 DFHBMPSO  PIC X.
  2096         03 DFHBMPSI  PIC X.
  2097     02  DFHBMEC  PIC X VALUE X"82".
  2098*    02  DFHDFFR  PIC X VALUE X"00".
  2099*    02  DFHOPAQ  PIC X VALUE X"00".
  2100*    02  DFHOUTLN PIC X VALUE X"00".
  2101*    02  DFHTRANS PIC X VALUE X"00".
  2102*    02  DFHBKTRN PIC X VALUE X"00".
  2103*                            COPY ELCAID.
  2104******************************************************************
  2105*                                                                *
  2106*                            ELCAID.                             *
  2107*                            VMOD=2.001                          *
  2108*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  42
* EL152.cbl
  2109*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2110*                                                                *
  2111*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2112*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2113******************************************************************
  2114
  2115 01  DFHAID.
  2116   02  DFHNULL   PIC  X  VALUE  ' '.
  2117   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2118   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2119   02  DFHPEN    PIC  X  VALUE  '='.
  2120   02  DFHOPID   PIC  X  VALUE  'W'.
  2121   02  DFHPA1    PIC  X  VALUE  '%'.
  2122   02  DFHPA2    PIC  X  VALUE  '>'.
  2123   02  DFHPA3    PIC  X  VALUE  ','.
  2124   02  DFHPF1    PIC  X  VALUE  '1'.
  2125   02  DFHPF2    PIC  X  VALUE  '2'.
  2126   02  DFHPF3    PIC  X  VALUE  '3'.
  2127   02  DFHPF4    PIC  X  VALUE  '4'.
  2128   02  DFHPF5    PIC  X  VALUE  '5'.
  2129   02  DFHPF6    PIC  X  VALUE  '6'.
  2130   02  DFHPF7    PIC  X  VALUE  '7'.
  2131   02  DFHPF8    PIC  X  VALUE  '8'.
  2132   02  DFHPF9    PIC  X  VALUE  '9'.
  2133   02  DFHPF10   PIC  X  VALUE  ':'.
  2134   02  DFHPF11   PIC  X  VALUE  '#'.
  2135   02  DFHPF12   PIC  X  VALUE  '@'.
  2136   02  DFHPF13   PIC  X  VALUE  'A'.
  2137   02  DFHPF14   PIC  X  VALUE  'B'.
  2138   02  DFHPF15   PIC  X  VALUE  'C'.
  2139   02  DFHPF16   PIC  X  VALUE  'D'.
  2140   02  DFHPF17   PIC  X  VALUE  'E'.
  2141   02  DFHPF18   PIC  X  VALUE  'F'.
  2142   02  DFHPF19   PIC  X  VALUE  'G'.
  2143   02  DFHPF20   PIC  X  VALUE  'H'.
  2144   02  DFHPF21   PIC  X  VALUE  'I'.
  2145*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2146   02  DFHPF22   PIC  X  VALUE  '['.
  2147   02  DFHPF23   PIC  X  VALUE  '.'.
  2148   02  DFHPF24   PIC  X  VALUE  '<'.
  2149   02  DFHMSRE   PIC  X  VALUE  'X'.
  2150   02  DFHSTRF   PIC  X  VALUE  'h'.
  2151   02  DFHTRIG   PIC  X  VALUE  '"'.
  2152 01  FILLER    REDEFINES DFHAID.
  2153     12  FILLER              PIC X(8).
  2154     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  43
* EL152.cbl
  2156*                            COPY EL152S.
  2157 01  EL152AI.
  2158     05  FILLER            PIC  X(0012).
  2159*    -------------------------------
  2160     05  DATEAL PIC S9(0004) COMP.
  2161     05  DATEAF PIC  X(0001).
  2162     05  FILLER REDEFINES DATEAF.
  2163         10  DATEAA PIC  X(0001).
  2164     05  DATEAI PIC  X(0008).
  2165*    -------------------------------
  2166     05  TIMEAL PIC S9(0004) COMP.
  2167     05  TIMEAF PIC  X(0001).
  2168     05  FILLER REDEFINES TIMEAF.
  2169         10  TIMEAA PIC  X(0001).
  2170     05  TIMEAI PIC  X(0005).
  2171*    -------------------------------
  2172     05  CARRL PIC S9(0004) COMP.
  2173     05  CARRF PIC  X(0001).
  2174     05  FILLER REDEFINES CARRF.
  2175         10  CARRA PIC  X(0001).
  2176     05  CARRI PIC  X(0001).
  2177*    -------------------------------
  2178     05  CLMNOL PIC S9(0004) COMP.
  2179     05  CLMNOF PIC  X(0001).
  2180     05  FILLER REDEFINES CLMNOF.
  2181         10  CLMNOA PIC  X(0001).
  2182     05  CLMNOI PIC  X(0007).
  2183*    -------------------------------
  2184     05  CRTNOL PIC S9(0004) COMP.
  2185     05  CRTNOF PIC  X(0001).
  2186     05  FILLER REDEFINES CRTNOF.
  2187         10  CRTNOA PIC  X(0001).
  2188     05  CRTNOI PIC  X(0011).
  2189*    -------------------------------
  2190     05  PROCL PIC S9(0004) COMP.
  2191     05  PROCF PIC  X(0001).
  2192     05  FILLER REDEFINES PROCF.
  2193         10  PROCA PIC  X(0001).
  2194     05  PROCI PIC  X(0004).
  2195*    -------------------------------
  2196     05  COMPIDL PIC S9(0004) COMP.
  2197     05  COMPIDF PIC  X(0001).
  2198     05  FILLER REDEFINES COMPIDF.
  2199         10  COMPIDA PIC  X(0001).
  2200     05  COMPIDI PIC  X(0003).
  2201*    -------------------------------
  2202     05  CLEANL PIC S9(0004) COMP.
  2203     05  CLEANF PIC  X(0001).
  2204     05  FILLER REDEFINES CLEANF.
  2205         10  CLEANA PIC  X(0001).
  2206     05  CLEANI PIC  X(0001).
  2207*    -------------------------------
  2208     05  SYSL PIC S9(0004) COMP.
  2209     05  SYSF PIC  X(0001).
  2210     05  FILLER REDEFINES SYSF.
  2211         10  SYSA PIC  X(0001).
  2212     05  SYSI PIC  X(0008).
  2213*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  44
* EL152.cbl
  2214     05  MAINTL PIC S9(0004) COMP.
  2215     05  MAINTF PIC  X(0001).
  2216     05  FILLER REDEFINES MAINTF.
  2217         10  MAINTA PIC  X(0001).
  2218     05  MAINTI PIC  X(0001).
  2219*    -------------------------------
  2220     05  ARCHNUML PIC S9(0004) COMP.
  2221     05  ARCHNUMF PIC  X(0001).
  2222     05  FILLER REDEFINES ARCHNUMF.
  2223         10  ARCHNUMA PIC  X(0001).
  2224     05  ARCHNUMI PIC  99999999.
  2225*    -------------------------------
  2226     05  FORML PIC S9(0004) COMP.
  2227     05  FORMF PIC  X(0001).
  2228     05  FILLER REDEFINES FORMF.
  2229         10  FORMA PIC  X(0001).
  2230     05  FORMI PIC  X(0004).
  2231*    -------------------------------
  2232     05  FOLLOWL PIC S9(0004) COMP.
  2233     05  FOLLOWF PIC  X(0001).
  2234     05  FILLER REDEFINES FOLLOWF.
  2235         10  FOLLOWA PIC  X(0001).
  2236     05  FOLLOWI PIC  X(0008).
  2237*    -------------------------------
  2238     05  RESENDL PIC S9(0004) COMP.
  2239     05  RESENDF PIC  X(0001).
  2240     05  FILLER REDEFINES RESENDF.
  2241         10  RESENDA PIC  X(0001).
  2242     05  RESENDI PIC  X(0008).
  2243*    -------------------------------
  2244     05  PRINTL PIC S9(0004) COMP.
  2245     05  PRINTF PIC  X(0001).
  2246     05  FILLER REDEFINES PRINTF.
  2247         10  PRINTA PIC  X(0001).
  2248     05  PRINTI PIC  X(0001).
  2249*    -------------------------------
  2250     05  COPIESL PIC S9(0004) COMP.
  2251     05  COPIESF PIC  X(0001).
  2252     05  FILLER REDEFINES COPIESF.
  2253         10  COPIESA PIC  X(0001).
  2254     05  COPIESI PIC  X(0001).
  2255*    -------------------------------
  2256     05  ENCL PIC S9(0004) COMP.
  2257     05  ENCF PIC  X(0001).
  2258     05  FILLER REDEFINES ENCF.
  2259         10  ENCA PIC  X(0001).
  2260     05  ENCI PIC  X(0003).
  2261*    -------------------------------
  2262     05  ADDRL PIC S9(0004) COMP.
  2263     05  ADDRF PIC  X(0001).
  2264     05  FILLER REDEFINES ADDRF.
  2265         10  ADDRA PIC  X(0001).
  2266     05  ADDRI PIC  X(0002).
  2267*    -------------------------------
  2268     05  ACTL PIC S9(0004) COMP.
  2269     05  ACTF PIC  X(0001).
  2270     05  FILLER REDEFINES ACTF.
  2271         10  ACTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  45
* EL152.cbl
  2272     05  ACTI PIC  X(0001).
  2273*    -------------------------------
  2274     05  BENL PIC S9(0004) COMP.
  2275     05  BENF PIC  X(0001).
  2276     05  FILLER REDEFINES BENF.
  2277         10  BENA PIC  X(0001).
  2278     05  BENI PIC  X(0001).
  2279*    -------------------------------
  2280     05  EMPL PIC S9(0004) COMP.
  2281     05  EMPF PIC  X(0001).
  2282     05  FILLER REDEFINES EMPF.
  2283         10  EMPA PIC  X(0001).
  2284     05  EMPI PIC  X(0001).
  2285*    -------------------------------
  2286     05  INSL PIC S9(0004) COMP.
  2287     05  INSF PIC  X(0001).
  2288     05  FILLER REDEFINES INSF.
  2289         10  INSA PIC  X(0001).
  2290     05  INSI PIC  X(0001).
  2291*    -------------------------------
  2292     05  PHYSL PIC S9(0004) COMP.
  2293     05  PHYSF PIC  X(0001).
  2294     05  FILLER REDEFINES PHYSF.
  2295         10  PHYSA PIC  X(0001).
  2296     05  PHYSI PIC  X(0001).
  2297*    -------------------------------
  2298     05  OTHR1L PIC S9(0004) COMP.
  2299     05  OTHR1F PIC  X(0001).
  2300     05  FILLER REDEFINES OTHR1F.
  2301         10  OTHR1A PIC  X(0001).
  2302     05  OTHR1I PIC  X(0001).
  2303*    -------------------------------
  2304     05  OTHR2L PIC S9(0004) COMP.
  2305     05  OTHR2F PIC  X(0001).
  2306     05  FILLER REDEFINES OTHR2F.
  2307         10  OTHR2A PIC  X(0001).
  2308     05  OTHR2I PIC  X(0001).
  2309*    -------------------------------
  2310     05  REL PIC S9(0004) COMP.
  2311     05  REF PIC  X(0001).
  2312     05  FILLER REDEFINES REF.
  2313         10  REA PIC  X(0001).
  2314     05  REI PIC  X(0070).
  2315*    -------------------------------
  2316     05  L1L PIC S9(0004) COMP.
  2317     05  L1F PIC  X(0001).
  2318     05  FILLER REDEFINES L1F.
  2319         10  L1A PIC  X(0001).
  2320     05  L1I PIC  X(0003).
  2321*    -------------------------------
  2322     05  TEXT1L PIC S9(0004) COMP.
  2323     05  TEXT1F PIC  X(0001).
  2324     05  FILLER REDEFINES TEXT1F.
  2325         10  TEXT1A PIC  X(0001).
  2326     05  TEXT1I PIC  X(0070).
  2327*    -------------------------------
  2328     05  L2L PIC S9(0004) COMP.
  2329     05  L2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  46
* EL152.cbl
  2330     05  FILLER REDEFINES L2F.
  2331         10  L2A PIC  X(0001).
  2332     05  L2I PIC  X(0003).
  2333*    -------------------------------
  2334     05  TEXT2L PIC S9(0004) COMP.
  2335     05  TEXT2F PIC  X(0001).
  2336     05  FILLER REDEFINES TEXT2F.
  2337         10  TEXT2A PIC  X(0001).
  2338     05  TEXT2I PIC  X(0070).
  2339*    -------------------------------
  2340     05  L3L PIC S9(0004) COMP.
  2341     05  L3F PIC  X(0001).
  2342     05  FILLER REDEFINES L3F.
  2343         10  L3A PIC  X(0001).
  2344     05  L3I PIC  X(0003).
  2345*    -------------------------------
  2346     05  TEXT3L PIC S9(0004) COMP.
  2347     05  TEXT3F PIC  X(0001).
  2348     05  FILLER REDEFINES TEXT3F.
  2349         10  TEXT3A PIC  X(0001).
  2350     05  TEXT3I PIC  X(0070).
  2351*    -------------------------------
  2352     05  L4L PIC S9(0004) COMP.
  2353     05  L4F PIC  X(0001).
  2354     05  FILLER REDEFINES L4F.
  2355         10  L4A PIC  X(0001).
  2356     05  L4I PIC  X(0003).
  2357*    -------------------------------
  2358     05  TEXT4L PIC S9(0004) COMP.
  2359     05  TEXT4F PIC  X(0001).
  2360     05  FILLER REDEFINES TEXT4F.
  2361         10  TEXT4A PIC  X(0001).
  2362     05  TEXT4I PIC  X(0070).
  2363*    -------------------------------
  2364     05  L5L PIC S9(0004) COMP.
  2365     05  L5F PIC  X(0001).
  2366     05  FILLER REDEFINES L5F.
  2367         10  L5A PIC  X(0001).
  2368     05  L5I PIC  X(0003).
  2369*    -------------------------------
  2370     05  TEXT5L PIC S9(0004) COMP.
  2371     05  TEXT5F PIC  X(0001).
  2372     05  FILLER REDEFINES TEXT5F.
  2373         10  TEXT5A PIC  X(0001).
  2374     05  TEXT5I PIC  X(0070).
  2375*    -------------------------------
  2376     05  L6L PIC S9(0004) COMP.
  2377     05  L6F PIC  X(0001).
  2378     05  FILLER REDEFINES L6F.
  2379         10  L6A PIC  X(0001).
  2380     05  L6I PIC  X(0003).
  2381*    -------------------------------
  2382     05  TEXT6L PIC S9(0004) COMP.
  2383     05  TEXT6F PIC  X(0001).
  2384     05  FILLER REDEFINES TEXT6F.
  2385         10  TEXT6A PIC  X(0001).
  2386     05  TEXT6I PIC  X(0070).
  2387*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  47
* EL152.cbl
  2388     05  L7L PIC S9(0004) COMP.
  2389     05  L7F PIC  X(0001).
  2390     05  FILLER REDEFINES L7F.
  2391         10  L7A PIC  X(0001).
  2392     05  L7I PIC  X(0003).
  2393*    -------------------------------
  2394     05  TEXT7L PIC S9(0004) COMP.
  2395     05  TEXT7F PIC  X(0001).
  2396     05  FILLER REDEFINES TEXT7F.
  2397         10  TEXT7A PIC  X(0001).
  2398     05  TEXT7I PIC  X(0070).
  2399*    -------------------------------
  2400     05  L8L PIC S9(0004) COMP.
  2401     05  L8F PIC  X(0001).
  2402     05  FILLER REDEFINES L8F.
  2403         10  L8A PIC  X(0001).
  2404     05  L8I PIC  X(0003).
  2405*    -------------------------------
  2406     05  TEXT8L PIC S9(0004) COMP.
  2407     05  TEXT8F PIC  X(0001).
  2408     05  FILLER REDEFINES TEXT8F.
  2409         10  TEXT8A PIC  X(0001).
  2410     05  TEXT8I PIC  X(0070).
  2411*    -------------------------------
  2412     05  L9L PIC S9(0004) COMP.
  2413     05  L9F PIC  X(0001).
  2414     05  FILLER REDEFINES L9F.
  2415         10  L9A PIC  X(0001).
  2416     05  L9I PIC  X(0003).
  2417*    -------------------------------
  2418     05  TEXT9L PIC S9(0004) COMP.
  2419     05  TEXT9F PIC  X(0001).
  2420     05  FILLER REDEFINES TEXT9F.
  2421         10  TEXT9A PIC  X(0001).
  2422     05  TEXT9I PIC  X(0070).
  2423*    -------------------------------
  2424     05  L10L PIC S9(0004) COMP.
  2425     05  L10F PIC  X(0001).
  2426     05  FILLER REDEFINES L10F.
  2427         10  L10A PIC  X(0001).
  2428     05  L10I PIC  X(0003).
  2429*    -------------------------------
  2430     05  TEXT10L PIC S9(0004) COMP.
  2431     05  TEXT10F PIC  X(0001).
  2432     05  FILLER REDEFINES TEXT10F.
  2433         10  TEXT10A PIC  X(0001).
  2434     05  TEXT10I PIC  X(0070).
  2435*    -------------------------------
  2436     05  L11L PIC S9(0004) COMP.
  2437     05  L11F PIC  X(0001).
  2438     05  FILLER REDEFINES L11F.
  2439         10  L11A PIC  X(0001).
  2440     05  L11I PIC  X(0003).
  2441*    -------------------------------
  2442     05  TEXT11L PIC S9(0004) COMP.
  2443     05  TEXT11F PIC  X(0001).
  2444     05  FILLER REDEFINES TEXT11F.
  2445         10  TEXT11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  48
* EL152.cbl
  2446     05  TEXT11I PIC  X(0070).
  2447*    -------------------------------
  2448     05  L12L PIC S9(0004) COMP.
  2449     05  L12F PIC  X(0001).
  2450     05  FILLER REDEFINES L12F.
  2451         10  L12A PIC  X(0001).
  2452     05  L12I PIC  X(0003).
  2453*    -------------------------------
  2454     05  TEXT12L PIC S9(0004) COMP.
  2455     05  TEXT12F PIC  X(0001).
  2456     05  FILLER REDEFINES TEXT12F.
  2457         10  TEXT12A PIC  X(0001).
  2458     05  TEXT12I PIC  X(0070).
  2459*    -------------------------------
  2460     05  L13L PIC S9(0004) COMP.
  2461     05  L13F PIC  X(0001).
  2462     05  FILLER REDEFINES L13F.
  2463         10  L13A PIC  X(0001).
  2464     05  L13I PIC  X(0003).
  2465*    -------------------------------
  2466     05  TEXT13L PIC S9(0004) COMP.
  2467     05  TEXT13F PIC  X(0001).
  2468     05  FILLER REDEFINES TEXT13F.
  2469         10  TEXT13A PIC  X(0001).
  2470     05  TEXT13I PIC  X(0070).
  2471*    -------------------------------
  2472     05  ERRMSGL PIC S9(0004) COMP.
  2473     05  ERRMSGF PIC  X(0001).
  2474     05  FILLER REDEFINES ERRMSGF.
  2475         10  ERRMSGA PIC  X(0001).
  2476     05  ERRMSGI PIC  X(0072).
  2477*    -------------------------------
  2478     05  ENTERPFL PIC S9(0004) COMP.
  2479     05  ENTERPFF PIC  X(0001).
  2480     05  FILLER REDEFINES ENTERPFF.
  2481         10  ENTERPFA PIC  X(0001).
  2482     05  ENTERPFI PIC  99.
  2483*    -------------------------------
  2484     05  PRINTERL PIC S9(0004) COMP.
  2485     05  PRINTERF PIC  X(0001).
  2486     05  FILLER REDEFINES PRINTERF.
  2487         10  PRINTERA PIC  X(0001).
  2488     05  PRINTERI PIC  X(0004).
  2489*    -------------------------------
  2490     05  PFKEY9L PIC S9(0004) COMP.
  2491     05  PFKEY9F PIC  X(0001).
  2492     05  FILLER REDEFINES PFKEY9F.
  2493         10  PFKEY9A PIC  X(0001).
  2494     05  PFKEY9I PIC  X(0014).
  2495 01  EL152AO REDEFINES EL152AI.
  2496     05  FILLER            PIC  X(0012).
  2497*    -------------------------------
  2498     05  FILLER            PIC  X(0003).
  2499     05  DATEAO PIC  X(0008).
  2500*    -------------------------------
  2501     05  FILLER            PIC  X(0003).
  2502     05  TIMEAO PIC  99.99.
  2503*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  49
* EL152.cbl
  2504     05  FILLER            PIC  X(0003).
  2505     05  CARRO PIC  X(0001).
  2506*    -------------------------------
  2507     05  FILLER            PIC  X(0003).
  2508     05  CLMNOO PIC  X(0007).
  2509*    -------------------------------
  2510     05  FILLER            PIC  X(0003).
  2511     05  CRTNOO PIC  X(0011).
  2512*    -------------------------------
  2513     05  FILLER            PIC  X(0003).
  2514     05  PROCO PIC  X(0004).
  2515*    -------------------------------
  2516     05  FILLER            PIC  X(0003).
  2517     05  COMPIDO PIC  X(0003).
  2518*    -------------------------------
  2519     05  FILLER            PIC  X(0003).
  2520     05  CLEANO PIC  X(0001).
  2521*    -------------------------------
  2522     05  FILLER            PIC  X(0003).
  2523     05  SYSO PIC  X(0008).
  2524*    -------------------------------
  2525     05  FILLER            PIC  X(0003).
  2526     05  MAINTO PIC  X(0001).
  2527*    -------------------------------
  2528     05  FILLER            PIC  X(0003).
  2529     05  ARCHNUMO PIC  X(0008).
  2530*    -------------------------------
  2531     05  FILLER            PIC  X(0003).
  2532     05  FORMO PIC  X(0004).
  2533*    -------------------------------
  2534     05  FILLER            PIC  X(0003).
  2535     05  FOLLOWO PIC  X(0008).
  2536*    -------------------------------
  2537     05  FILLER            PIC  X(0003).
  2538     05  RESENDO PIC  X(0008).
  2539*    -------------------------------
  2540     05  FILLER            PIC  X(0003).
  2541     05  PRINTO PIC  X(0001).
  2542*    -------------------------------
  2543     05  FILLER            PIC  X(0003).
  2544     05  COPIESO PIC  X(0001).
  2545*    -------------------------------
  2546     05  FILLER            PIC  X(0003).
  2547     05  ENCO PIC  X(0003).
  2548*    -------------------------------
  2549     05  FILLER            PIC  X(0003).
  2550     05  ADDRO PIC  X(0002).
  2551*    -------------------------------
  2552     05  FILLER            PIC  X(0003).
  2553     05  ACTO PIC  X(0001).
  2554*    -------------------------------
  2555     05  FILLER            PIC  X(0003).
  2556     05  BENO PIC  X(0001).
  2557*    -------------------------------
  2558     05  FILLER            PIC  X(0003).
  2559     05  EMPO PIC  X(0001).
  2560*    -------------------------------
  2561     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  50
* EL152.cbl
  2562     05  INSO PIC  X(0001).
  2563*    -------------------------------
  2564     05  FILLER            PIC  X(0003).
  2565     05  PHYSO PIC  X(0001).
  2566*    -------------------------------
  2567     05  FILLER            PIC  X(0003).
  2568     05  OTHR1O PIC  X(0001).
  2569*    -------------------------------
  2570     05  FILLER            PIC  X(0003).
  2571     05  OTHR2O PIC  X(0001).
  2572*    -------------------------------
  2573     05  FILLER            PIC  X(0003).
  2574     05  REO PIC  X(0070).
  2575*    -------------------------------
  2576     05  FILLER            PIC  X(0003).
  2577     05  L1O PIC  X(0003).
  2578*    -------------------------------
  2579     05  FILLER            PIC  X(0003).
  2580     05  TEXT1O PIC  X(0070).
  2581*    -------------------------------
  2582     05  FILLER            PIC  X(0003).
  2583     05  L2O PIC  X(0003).
  2584*    -------------------------------
  2585     05  FILLER            PIC  X(0003).
  2586     05  TEXT2O PIC  X(0070).
  2587*    -------------------------------
  2588     05  FILLER            PIC  X(0003).
  2589     05  L3O PIC  X(0003).
  2590*    -------------------------------
  2591     05  FILLER            PIC  X(0003).
  2592     05  TEXT3O PIC  X(0070).
  2593*    -------------------------------
  2594     05  FILLER            PIC  X(0003).
  2595     05  L4O PIC  X(0003).
  2596*    -------------------------------
  2597     05  FILLER            PIC  X(0003).
  2598     05  TEXT4O PIC  X(0070).
  2599*    -------------------------------
  2600     05  FILLER            PIC  X(0003).
  2601     05  L5O PIC  X(0003).
  2602*    -------------------------------
  2603     05  FILLER            PIC  X(0003).
  2604     05  TEXT5O PIC  X(0070).
  2605*    -------------------------------
  2606     05  FILLER            PIC  X(0003).
  2607     05  L6O PIC  X(0003).
  2608*    -------------------------------
  2609     05  FILLER            PIC  X(0003).
  2610     05  TEXT6O PIC  X(0070).
  2611*    -------------------------------
  2612     05  FILLER            PIC  X(0003).
  2613     05  L7O PIC  X(0003).
  2614*    -------------------------------
  2615     05  FILLER            PIC  X(0003).
  2616     05  TEXT7O PIC  X(0070).
  2617*    -------------------------------
  2618     05  FILLER            PIC  X(0003).
  2619     05  L8O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  51
* EL152.cbl
  2620*    -------------------------------
  2621     05  FILLER            PIC  X(0003).
  2622     05  TEXT8O PIC  X(0070).
  2623*    -------------------------------
  2624     05  FILLER            PIC  X(0003).
  2625     05  L9O PIC  X(0003).
  2626*    -------------------------------
  2627     05  FILLER            PIC  X(0003).
  2628     05  TEXT9O PIC  X(0070).
  2629*    -------------------------------
  2630     05  FILLER            PIC  X(0003).
  2631     05  L10O PIC  X(0003).
  2632*    -------------------------------
  2633     05  FILLER            PIC  X(0003).
  2634     05  TEXT10O PIC  X(0070).
  2635*    -------------------------------
  2636     05  FILLER            PIC  X(0003).
  2637     05  L11O PIC  X(0003).
  2638*    -------------------------------
  2639     05  FILLER            PIC  X(0003).
  2640     05  TEXT11O PIC  X(0070).
  2641*    -------------------------------
  2642     05  FILLER            PIC  X(0003).
  2643     05  L12O PIC  X(0003).
  2644*    -------------------------------
  2645     05  FILLER            PIC  X(0003).
  2646     05  TEXT12O PIC  X(0070).
  2647*    -------------------------------
  2648     05  FILLER            PIC  X(0003).
  2649     05  L13O PIC  X(0003).
  2650*    -------------------------------
  2651     05  FILLER            PIC  X(0003).
  2652     05  TEXT13O PIC  X(0070).
  2653*    -------------------------------
  2654     05  FILLER            PIC  X(0003).
  2655     05  ERRMSGO PIC  X(0072).
  2656*    -------------------------------
  2657     05  FILLER            PIC  X(0003).
  2658     05  ENTERPFO PIC  X(0002).
  2659*    -------------------------------
  2660     05  FILLER            PIC  X(0003).
  2661     05  PRINTERO PIC  X(0004).
  2662*    -------------------------------
  2663     05  FILLER            PIC  X(0003).
  2664     05  PFKEY9O PIC  X(0014).
  2665*    -------------------------------
  2666 01  MAP-REDEF REDEFINES EL152AI.
  2667     12  FILLER              PIC X(251).
  2668*    12  FILLER              PIC X(189).
  2669     12  EL152RI.
  2670       14  TEXT-LINES OCCURS 13 TIMES INDEXED BY SC-INDX.
  2671         16  SC-LINEL        PIC S9(4)  COMP.
  2672         16  SC-LINEA        PIC X.
  2673         16  SC-LINE         PIC XXX.
  2674         16  SC-TEXTL        PIC S9(4)  COMP.
  2675         16  SC-TEXTA        PIC X.
  2676         16  SC-TEXT         PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  52
* EL152.cbl
  2678 01  RECORD-TABLE            PIC X(21900) VALUE SPACES.
  2679
  2680 01  REC-TABLE REDEFINES RECORD-TABLE.
  2681     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX
  2682                             PIC X(3650).
  2683
  2684 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  2685     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  2686         16  REC-TEXT        PIC X(70).
  2687         16  REC-PC          PIC 99.
  2688         16  FILLER          PIC X.
  2689
  2690 01  TS-WORK-AREA            PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  53
* EL152.cbl
  2692****************************************************************
  2693*
  2694* Copyright (c) 2007 by Clerity Solutions, Inc.
  2695* All rights reserved.
  2696*
  2697****************************************************************
  2698 01  DFHEIV.
  2699   02  DFHEIV0               PIC X(35).
  2700   02  DFHEIV1               PIC X(08).
  2701   02  DFHEIV2               PIC X(08).
  2702   02  DFHEIV3               PIC X(08).
  2703   02  DFHEIV4               PIC X(06).
  2704   02  DFHEIV5               PIC X(04).
  2705   02  DFHEIV6               PIC X(04).
  2706   02  DFHEIV7               PIC X(02).
  2707   02  DFHEIV8               PIC X(02).
  2708   02  DFHEIV9               PIC X(01).
  2709   02  DFHEIV10              PIC S9(7) COMP-3.
  2710   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2711   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2712   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2713   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2714   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2715   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2716   02  DFHEIV17              PIC X(04).
  2717   02  DFHEIV18              PIC X(04).
  2718   02  DFHEIV19              PIC X(04).
  2719   02  DFHEIV20              USAGE IS POINTER.
  2720   02  DFHEIV21              USAGE IS POINTER.
  2721   02  DFHEIV22              USAGE IS POINTER.
  2722   02  DFHEIV23              USAGE IS POINTER.
  2723   02  DFHEIV24              USAGE IS POINTER.
  2724   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2725   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2726   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2727   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2728   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2729   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2730   02  FILLER                PIC X(02).
  2731   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2732   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2733   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2734   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2735   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2736 LINKAGE  SECTION.
  2737*****************************************************************
  2738*                                                               *
  2739* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2740* All rights reserved.                                          *
  2741*                                                               *
  2742*****************************************************************
  2743 01  dfheiblk.
  2744     02  eibtime          pic s9(7) comp-3.
  2745     02  eibdate          pic s9(7) comp-3.
  2746     02  eibtrnid         pic x(4).
  2747     02  eibtaskn         pic s9(7) comp-3.
  2748     02  eibtrmid         pic x(4).
  2749     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  54
* EL152.cbl
  2750     02  eibcposn         pic s9(4) comp.
  2751     02  eibcalen         pic s9(4) comp.
  2752     02  eibaid           pic x(1).
  2753     02  eibfiller1       pic x(1).
  2754     02  eibfn            pic x(2).
  2755     02  eibfiller2       pic x(2).
  2756     02  eibrcode         pic x(6).
  2757     02  eibfiller3       pic x(2).
  2758     02  eibds            pic x(8).
  2759     02  eibreqid         pic x(8).
  2760     02  eibrsrce         pic x(8).
  2761     02  eibsync          pic x(1).
  2762     02  eibfree          pic x(1).
  2763     02  eibrecv          pic x(1).
  2764     02  eibsend          pic x(1).
  2765     02  eibatt           pic x(1).
  2766     02  eibeoc           pic x(1).
  2767     02  eibfmh           pic x(1).
  2768     02  eibcompl         pic x(1).
  2769     02  eibsig           pic x(1).
  2770     02  eibconf          pic x(1).
  2771     02  eiberr           pic x(1).
  2772     02  eibrldbk         pic x(1).
  2773     02  eiberrcd         pic x(4).
  2774     02  eibsynrb         pic x(1).
  2775     02  eibnodat         pic x(1).
  2776     02  eibfiller5       pic x(2).
  2777     02  eibresp          pic 9(09) comp.
  2778     02  eibresp2         pic 9(09) comp.
  2779     02  dfheigdj         pic s9(4) comp.
  2780     02  dfheigdk         pic s9(4) comp.
  2781 01  DFHCOMMAREA                 PIC X(1024).
  2782
  2783 01  var  pic x(30).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  55
* EL152.cbl
  2785*                                COPY ELCMSTR.
  2786******************************************************************
  2787*                                                                *
  2788*                            ELCMSTR.                            *
  2789*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2790*                            VMOD=2.012                          *
  2791*                                                                *
  2792*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  2793*                                                                *
  2794*   FILE TYPE = VSAM,KSDS                                        *
  2795*   RECORD SIZE = 350  RECFORM = FIXED                           *
  2796*                                                                *
  2797*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  2798*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  2799*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  2800*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  2801*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  2802*                                                 RKP=75,LEN=21  *
  2803*                                                                *
  2804*   **** NOTE ****                                               *
  2805*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  2806*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  2807*                                                                *
  2808*   LOG = YES                                                    *
  2809*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2810******************************************************************
  2811*                   C H A N G E   L O G
  2812*
  2813* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2814*-----------------------------------------------------------------
  2815*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2816* EFFECTIVE    NUMBER
  2817*-----------------------------------------------------------------
  2818* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2819* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  2820******************************************************************
  2821 01  CLAIM-MASTER.
  2822     12  CL-RECORD-ID                PIC XX.
  2823         88  VALID-CL-ID         VALUE 'CL'.
  2824
  2825     12  CL-CONTROL-PRIMARY.
  2826         16  CL-COMPANY-CD           PIC X.
  2827         16  CL-CARRIER              PIC X.
  2828         16  CL-CLAIM-NO             PIC X(7).
  2829         16  CL-CERT-NO.
  2830             20  CL-CERT-PRIME       PIC X(10).
  2831             20  CL-CERT-SFX         PIC X.
  2832
  2833     12  CL-CONTROL-BY-NAME.
  2834         16  CL-COMPANY-CD-A1        PIC X.
  2835         16  CL-INSURED-LAST-NAME    PIC X(15).
  2836         16  CL-INSURED-NAME.
  2837             20  CL-INSURED-1ST-NAME PIC X(12).
  2838             20  CL-INSURED-MID-INIT PIC X.
  2839
  2840     12  CL-CONTROL-BY-SSN.
  2841         16  CL-COMPANY-CD-A2        PIC X.
  2842         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  56
* EL152.cbl
  2843             20  CL-SSN-STATE        PIC XX.
  2844             20  CL-SSN-ACCOUNT      PIC X(6).
  2845             20  CL-SSN-LN3          PIC X(3).
  2846
  2847     12  CL-CONTROL-BY-CERT-NO.
  2848         16  CL-COMPANY-CD-A4        PIC X.
  2849         16  CL-CERT-NO-A4.
  2850             20  CL-CERT-A4-PRIME    PIC X(10).
  2851             20  CL-CERT-A4-SFX      PIC X.
  2852
  2853     12  CL-CONTROL-BY-CCN.
  2854         16  CL-COMPANY-CD-A5        PIC X.
  2855         16  CL-CCN-A5.
  2856             20  CL-CCN.
  2857                 24  CL-CCN-PREFIX-A5 PIC X(4).
  2858                 24  CL-CCN-PRIME-A5 PIC X(12).
  2859             20  CL-CCN-FILLER-A5    PIC X(4).
  2860
  2861     12  CL-INSURED-PROFILE-DATA.
  2862         16  CL-INSURED-BIRTH-DT     PIC XX.
  2863         16  CL-INSURED-SEX-CD       PIC X.
  2864             88  INSURED-IS-MALE        VALUE 'M'.
  2865             88  INSURED-IS-FEMALE      VALUE 'F'.
  2866             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  2867         16  CL-INSURED-OCC-CD       PIC X(6).
  2868         16  FILLER                  PIC X(5).
  2869
  2870     12  CL-PROCESSING-INFO.
  2871         16  CL-PROCESSOR-ID         PIC X(4).
  2872         16  CL-CLAIM-STATUS         PIC X.
  2873             88  CLAIM-IS-OPEN          VALUE 'O'.
  2874             88  CLAIM-IS-CLOSED        VALUE 'C'.
  2875         16  CL-CLAIM-TYPE           PIC X.
  2876*            88  AH-CLAIM               VALUE 'A'.
  2877*            88  LIFE-CLAIM             VALUE 'L'.
  2878*            88  PROPERTY-CLAIM         VALUE 'P'.
  2879*            88  IUI-CLAIM              VALUE 'I'.
  2880*            88  GAP-CLAIM              VALUE 'G'.
  2881         16  CL-CLAIM-PREM-TYPE      PIC X.
  2882             88  SINGLE-PREMIUM         VALUE '1'.
  2883             88  O-B-COVERAGE           VALUE '2'.
  2884             88  OPEN-END-COVERAGE      VALUE '3'.
  2885         16  CL-INCURRED-DT          PIC XX.
  2886         16  CL-REPORTED-DT          PIC XX.
  2887         16  CL-FILE-ESTABLISH-DT    PIC XX.
  2888         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  2889         16  CL-LAST-PMT-DT          PIC XX.
  2890         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  2891         16  CL-PAID-THRU-DT         PIC XX.
  2892         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  2893         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  2894         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  2895         16  CL-PMT-CALC-METHOD      PIC X.
  2896             88  CL-360-DAY-YR          VALUE '1'.
  2897             88  CL-365-DAY-YR          VALUE '2'.
  2898             88  CL-FULL-MONTHS         VALUE '3'.
  2899         16  CL-CAUSE-CD             PIC X(6).
  2900
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  57
* EL152.cbl
  2901         16  CL-PRIME-CERT-NO.
  2902             20  CL-PRIME-CERT-PRIME PIC X(10).
  2903             20  CL-PRIME-CERT-SFX   PIC X.
  2904
  2905         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  2906             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  2907             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  2908
  2909         16  CL-MICROFILM-NO         PIC X(10).
  2910         16  CL-PROG-FORM-TYPE       PIC X.
  2911         16  CL-LAST-ADD-ON-DT       PIC XX.
  2912
  2913         16  CL-LAST-REOPEN-DT       PIC XX.
  2914         16  CL-LAST-CLOSE-DT        PIC XX.
  2915         16  CL-LAST-CLOSE-REASON    PIC X(01).
  2916             88  FINAL-PAID             VALUE '1'.
  2917             88  CLAIM-DENIED           VALUE '2'.
  2918             88  AUTO-CLOSE             VALUE '3'.
  2919             88  MANUAL-CLOSE           VALUE '4'.
  2920             88  BENEFITS-CHANGED       VALUE 'C'.
  2921             88  SETUP-ERRORS           VALUE 'E'.
  2922         16  CL-ASSOC-CERT-SEQU      PIC S99.
  2923         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  2924         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  2925             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  2926         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  2927         16  FILLER                  PIC X.
  2928
  2929     12  CL-CERTIFICATE-DATA.
  2930         16  CL-CERT-ORIGIN          PIC X.
  2931             88  CERT-WAS-ONLINE        VALUE '1'.
  2932             88  CERT-WAS-CREATED       VALUE '2'.
  2933             88  COVERAGE-WAS-ADDED     VALUE '3'.
  2934         16  CL-CERT-KEY-DATA.
  2935             20  CL-CERT-CARRIER     PIC X.
  2936             20  CL-CERT-GROUPING    PIC X(6).
  2937             20  CL-CERT-STATE       PIC XX.
  2938             20  CL-CERT-ACCOUNT.
  2939                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  2940                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  2941             20  CL-CERT-EFF-DT      PIC XX.
  2942
  2943     12  CL-STATUS-CONTROLS.
  2944         16  CL-PRIORITY-CD          PIC X.
  2945             88  CONFIDENTIAL-DATA      VALUE '8'.
  2946             88  HIGHEST-PRIORITY       VALUE '9'.
  2947         16  CL-SUPV-ATTN-CD         PIC X.
  2948             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  2949             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  2950         16  CL-PURGED-DT            PIC XX.
  2951         16  CL-RESTORED-DT          PIC XX.
  2952         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  2953         16  CL-NEXT-RESEND-DT       PIC XX.
  2954         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  2955         16  FILLER                  PIC XX.
  2956         16  CL-LAST-MAINT-DT        PIC XX.
  2957         16  CL-LAST-MAINT-USER      PIC X(4).
  2958         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  58
* EL152.cbl
  2959         16  CL-LAST-MAINT-TYPE      PIC X.
  2960             88  CLAIM-SET-UP           VALUE ' '.
  2961             88  PAYMENT-MADE           VALUE '1'.
  2962             88  LETTER-SENT            VALUE '2'.
  2963             88  MASTER-WAS-ALTERED     VALUE '3'.
  2964             88  MASTER-WAS-RESTORED    VALUE '4'.
  2965             88  INCURRED-DATE-CHANGED  VALUE '5'.
  2966             88  FILE-CONVERTED         VALUE '6'.
  2967             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  2968             88  ERROR-CORRECTION       VALUE 'E'.
  2969         16  CL-RELATED-CLAIM-NO     PIC X(7).
  2970         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  2971         16  CL-BENEFICIARY          PIC X(10).
  2972         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  2973         16  CL-DENIAL-TYPE          PIC X.
  2974             88  CL-TYPE-DENIAL          VALUE '1'.
  2975             88  CL-TYPE-RESCISSION      VALUE '2'.
  2976             88  CL-TYPE-REFORMATION     VALUE '3'.
  2977             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  2978             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  2979         16  FILLER                  PIC X(5).
  2980
  2981     12  CL-TRAILER-CONTROLS.
  2982         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  2983             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  2984             88  CL-LAST-TRL-AVAIL      VALUE +100.
  2985             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  2986         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  2987         16  FILLER                  PIC XX.
  2988         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  2989         16  CL-ADDRESS-TRAILER-CNT.
  2990             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  2991                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  2992             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  2993                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  2994             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  2995                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  2996             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  2997                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  2998             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  2999                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3000             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3001                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3002             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3003                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3004
  3005     12  CL-CV-REFERENCE-NO.
  3006         16  CL-CV-REFNO-PRIME       PIC X(18).
  3007         16  CL-CV-REFNO-SFX         PIC XX.
  3008
  3009     12  CL-FILE-LOCATION            PIC X(4).
  3010
  3011     12  CL-PROCESS-ERRORS.
  3012         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3013             88  NO-FATAL-ERRORS        VALUE ZERO.
  3014         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3015             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3016
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  59
* EL152.cbl
  3017     12  CL-PRODUCT-CD               PIC X.
  3018
  3019     12  CL-CURRENT-KEY-DATA.
  3020         16  CL-CURRENT-CARRIER      PIC X.
  3021         16  CL-CURRENT-GROUPING     PIC X(6).
  3022         16  CL-CURRENT-STATE        PIC XX.
  3023         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3024
  3025     12  CL-ASSOCIATES               PIC X.
  3026         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3027         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3028         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3029         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3030
  3031     12  CL-ACTIVITY-CODE            PIC 99.
  3032     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3033     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3034
  3035     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3036     12  CL-LAG-REPORT-CODE          PIC 9.
  3037     12  CL-LOAN-TYPE                PIC XX.
  3038     12  CL-LEGAL-STATE              PIC XX.
  3039
  3040*    12  FILLER                      PIC X(5).
  3041     12  CL-YESNOSW                  PIC X.
  3042     12  FILLER                      PIC X(4).
  3043
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  60
* EL152.cbl
  3045*                                COPY ELCCNTL.
  3046******************************************************************
  3047*                                                                *
  3048*                                                                *
  3049*                            ELCCNTL.                            *
  3050*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3051*                            VMOD=2.059                          *
  3052*                                                                *
  3053*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3054*                                                                *
  3055*   FILE TYPE = VSAM,KSDS                                        *
  3056*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3057*                                                                *
  3058*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3059*       ALTERNATE INDEX = NONE                                   *
  3060*                                                                *
  3061*   LOG = YES                                                    *
  3062*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3063******************************************************************
  3064*                   C H A N G E   L O G
  3065*
  3066* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3067*-----------------------------------------------------------------
  3068*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3069* EFFECTIVE    NUMBER
  3070*-----------------------------------------------------------------
  3071* 082503                   PEMA  ADD BENEFIT GROUP
  3072* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3073* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3074* 092705    2005050300006  PEMA  ADD SPP LEASES
  3075* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3076* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3077* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3078* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3079******************************************************************
  3080*
  3081 01  CONTROL-FILE.
  3082     12  CF-RECORD-ID                       PIC XX.
  3083         88  VALID-CF-ID                        VALUE 'CF'.
  3084
  3085     12  CF-CONTROL-PRIMARY.
  3086         16  CF-COMPANY-ID                  PIC XXX.
  3087         16  CF-RECORD-TYPE                 PIC X.
  3088             88  CF-COMPANY-MASTER              VALUE '1'.
  3089             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3090             88  CF-STATE-MASTER                VALUE '3'.
  3091             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3092             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3093             88  CF-CARRIER-MASTER              VALUE '6'.
  3094             88  CF-MORTALITY-MASTER            VALUE '7'.
  3095             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3096             88  CF-TERMINAL-MASTER             VALUE '9'.
  3097             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3098             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3099             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3100             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3101             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3102             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  61
* EL152.cbl
  3103             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3104             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3105             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3106         16  CF-ACCESS-CD-GENL              PIC X(4).
  3107         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3108             20  CF-PROCESSOR               PIC X(4).
  3109         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3110             20  CF-STATE-CODE              PIC XX.
  3111             20  FILLER                     PIC XX.
  3112         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3113             20  FILLER                     PIC XX.
  3114             20  CF-HI-BEN-IN-REC           PIC XX.
  3115         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3116             20  FILLER                     PIC XXX.
  3117             20  CF-CARRIER-CNTL            PIC X.
  3118         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3119             20  FILLER                     PIC XX.
  3120             20  CF-HI-TYPE-IN-REC          PIC 99.
  3121         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3122             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3123                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3124             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3125             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3126         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3127             20  FILLER                     PIC X.
  3128             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3129         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3130             20  FILLER                     PIC XX.
  3131             20  CF-MORTGAGE-PLAN           PIC XX.
  3132         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3133
  3134     12  CF-LAST-MAINT-DT                   PIC XX.
  3135     12  CF-LAST-MAINT-BY                   PIC X(4).
  3136     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3137
  3138     12  CF-RECORD-BODY                     PIC X(728).
  3139
  3140
  3141****************************************************************
  3142*             COMPANY MASTER RECORD                            *
  3143****************************************************************
  3144
  3145     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3146         16  CF-COMPANY-ADDRESS.
  3147             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3148             20  CF-CL-IN-CARE-OF           PIC X(30).
  3149             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3150             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3151             20  CF-CL-CITY-STATE           PIC X(30).
  3152             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3153             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3154         16  CF-COMPANY-CD                  PIC X.
  3155         16  CF-COMPANY-PASSWORD            PIC X(8).
  3156         16  CF-SECURITY-OPTION             PIC X.
  3157             88  ALL-SECURITY                   VALUE '1'.
  3158             88  COMPANY-VERIFY                 VALUE '2'.
  3159             88  PROCESSOR-VERIFY               VALUE '3'.
  3160             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  62
* EL152.cbl
  3161             88  ALL-BUT-TERM                   VALUE '5'.
  3162         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3163             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3164         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3165             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3166         16  CF-INFORCE-LOCATION            PIC X.
  3167             88  CERTS-ARE-ONLINE               VALUE '1'.
  3168             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3169             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3170         16  CF-LOWER-CASE-LETTERS          PIC X.
  3171         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3172             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3173             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3174             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3175             88  CF-ACCNT-CNTL                  VALUE '3'.
  3176             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3177
  3178         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3179         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3180
  3181         16  CF-LGX-CREDIT-USER             PIC X.
  3182             88  CO-IS-NOT-USER                 VALUE 'N'.
  3183             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3184
  3185         16 CF-CREDIT-CALC-CODES.
  3186             20  CF-CR-REM-TERM-CALC PIC X.
  3187               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3188               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3189               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3190               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3191               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3192               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3193               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3194             20  CF-CR-R78-METHOD           PIC X.
  3195               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3196               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3197
  3198         16  CF-CLAIM-CONTROL-COUNTS.
  3199             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3200                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3201
  3202             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3203                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3204
  3205             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3206                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3207
  3208             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3209                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3210
  3211         16  CF-CURRENT-MONTH-END           PIC XX.
  3212
  3213         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3214             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3215             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3216             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3217             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3218                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  63
* EL152.cbl
  3219                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3220             20  CF-CO-PREM-REJECT-SW       PIC X.
  3221                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3222                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3223             20  CF-CO-REF-REJECT-SW        PIC X.
  3224                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3225                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3226
  3227         16  CF-CO-REPORTING-DT             PIC XX.
  3228         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3229         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3230           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3231           88  CF-CO-MONTH-END                  VALUE '1'.
  3232
  3233         16  CF-LGX-CLAIM-USER              PIC X.
  3234             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3235             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3236
  3237         16  CF-CREDIT-EDIT-CONTROLS.
  3238             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3239             20  CF-MIN-AGE                 PIC 99.
  3240             20  CF-DEFAULT-AGE             PIC 99.
  3241             20  CF-MIN-TERM                PIC S999      COMP-3.
  3242             20  CF-MAX-TERM                PIC S999      COMP-3.
  3243             20  CF-DEFAULT-SEX             PIC X.
  3244             20  CF-JOINT-AGE-INPUT         PIC X.
  3245                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3246             20  CF-BIRTH-DATE-INPUT        PIC X.
  3247                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3248             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3249                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3250                 88  CF-ZERO-CARRIER            VALUE '1'.
  3251                 88  CF-ZERO-GROUPING           VALUE '2'.
  3252                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3253             20  CF-EDIT-SW                 PIC X.
  3254                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3255             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3256             20  CF-CR-PR-METHOD            PIC X.
  3257               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3258               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3259             20  FILLER                     PIC X.
  3260
  3261         16  CF-CREDIT-MISC-CONTROLS.
  3262             20  CF-REIN-TABLE-SW           PIC X.
  3263                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3264             20  CF-COMP-TABLE-SW           PIC X.
  3265                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3266             20  CF-EXPERIENCE-RETENTION-AGE
  3267                                            PIC S9        COMP-3.
  3268             20  CF-CONVERSION-DT           PIC XX.
  3269             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3270             20  CF-RUN-FREQUENCY-SW        PIC X.
  3271                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3272                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3273
  3274             20  CF-CR-CHECK-NO-CONTROL.
  3275                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3276                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  64
* EL152.cbl
  3277                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3278                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3279                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3280                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3281
  3282                 24  CF-CR-CHECK-COUNT       REDEFINES
  3283                     CF-CR-CHECK-COUNTER      PIC X(4).
  3284
  3285                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3286                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3287
  3288                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3289                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3290                 24  CF-MAIL-PROCESSING       PIC X.
  3291                     88  MAIL-PROCESSING          VALUE 'Y'.
  3292
  3293         16  CF-MISC-SYSTEM-CONTROL.
  3294             20  CF-SYSTEM-C                 PIC X.
  3295                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3296             20  CF-SYSTEM-D                 PIC X.
  3297                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3298             20  CF-SOC-SEC-NO-SW            PIC X.
  3299                 88  SOC-SEC-NO-USED             VALUE '1'.
  3300             20  CF-MEMBER-NO-SW             PIC X.
  3301                 88  MEMBER-NO-USED              VALUE '1'.
  3302             20  CF-TAX-ID-NUMBER            PIC X(11).
  3303             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3304             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3305                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3306                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3307                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3308                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3309             20  CF-SYSTEM-E                 PIC X.
  3310                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3311
  3312         16  CF-LGX-LIFE-USER               PIC X.
  3313             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3314             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3315
  3316         16  CF-CR-MONTH-END-DT             PIC XX.
  3317
  3318         16  CF-FILE-MAINT-DATES.
  3319             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3320                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3321             20  CF-LAST-BATCH       REDEFINES
  3322                 CF-LAST-BATCH-NO               PIC X(4).
  3323             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3324             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3325             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3326             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3327             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3328             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3329             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3330             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3331             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3332             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3333
  3334         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  65
* EL152.cbl
  3335         16  FILLER                         PIC X.
  3336
  3337         16  CF-ALT-MORT-CODE               PIC X(4).
  3338         16  CF-MEMBER-CAPTION              PIC X(10).
  3339
  3340         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3341             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3342             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3343             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3344             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3345             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3346
  3347         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3348
  3349         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3350         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3351         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3352         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3353
  3354         16  CF-AH-OVERRIDE-L1              PIC X.
  3355         16  CF-AH-OVERRIDE-L2              PIC XX.
  3356         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3357         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3358
  3359         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3360         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3361
  3362         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3363         16  CF-AR-LAST-EL860-DT            PIC XX.
  3364         16  CF-MP-MONTH-END-DT             PIC XX.
  3365
  3366         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3367         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3368             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3369
  3370         16  CF-AR-MONTH-END-DT             PIC XX.
  3371
  3372         16  CF-CRDTCRD-USER                PIC X.
  3373             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3374             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3375
  3376         16  CF-CC-MONTH-END-DT             PIC XX.
  3377
  3378         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3379
  3380         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3381             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3382             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3383             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3384         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3385         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3386         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3387         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3388             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3389             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3390         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3391         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3392         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  66
* EL152.cbl
  3393             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3394         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3395
  3396         16  CF-CL-ZIP-CODE.
  3397             20  CF-CL-ZIP-PRIME.
  3398                 24  CF-CL-ZIP-1ST          PIC X.
  3399                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3400                 24  FILLER                 PIC X(4).
  3401             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3402         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3403             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3404             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3405             20  FILLER                     PIC XXX.
  3406
  3407         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3408         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3409         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3410         16  CF-CO-OPTION-START-DATE        PIC XX.
  3411         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3412           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3413                                                      '3' '4'.
  3414           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3415           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3416           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3417           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3418           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3419           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3420
  3421         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3422
  3423         16  CF-PAYMENT-APPROVAL-LEVELS.
  3424             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3425             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3426             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3427             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3428             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3429             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3430
  3431         16  CF-END-USER-REPORTING-USER     PIC X.
  3432             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3433             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3434
  3435         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3436             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3437             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3438
  3439         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3440
  3441         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3442         16  FILLER                         PIC X.
  3443
  3444         16  CF-CREDIT-ARCHIVE-CNTL.
  3445             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3446             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3447             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3448
  3449         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3450
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  67
* EL152.cbl
  3451         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3452             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3453             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3454
  3455         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3456             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3457             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3458
  3459         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3460
  3461         16  CF-CO-ACH-ID-CODE              PIC  X.
  3462             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3463             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3464             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3465         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3466         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3467         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3468         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3469         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3470         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3471         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3472         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3473         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3474                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3475         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3476                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3477
  3478         16  CF-CO-OVER-SHORT.
  3479             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3480             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3481
  3482*         16  FILLER                         PIC X(102).
  3483         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3484             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3485             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3486
  3487         16  CF-AH-APPROVAL-DAYS.
  3488             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3489             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3490             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3491             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3492
  3493         16  FILLER                         PIC X(82).
  3494****************************************************************
  3495*             PROCESSOR/USER RECORD                            *
  3496****************************************************************
  3497
  3498     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3499         16  CF-PROCESSOR-NAME              PIC X(30).
  3500         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3501         16  CF-PROCESSOR-TITLE             PIC X(26).
  3502         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3503                 88  MESSAGE-YES                VALUE 'Y'.
  3504                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3505
  3506*****************************************************
  3507****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3508****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  68
* EL152.cbl
  3509****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3510****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3511*****************************************************
  3512
  3513         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3514             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3515             20  CF-APPLICATION-FORCE       PIC X.
  3516             20  CF-INDIVIDUAL-APP.
  3517                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3518                     28  CF-BROWSE-APP      PIC X.
  3519                     28  CF-UPDATE-APP      PIC X.
  3520
  3521         16  CF-CURRENT-TERM-ON             PIC X(4).
  3522         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3523             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3524             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3525             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3526             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3527             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3528             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3529             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3530         16  CF-PROCESSOR-CARRIER           PIC X.
  3531             88  NO-CARRIER-SECURITY            VALUE ' '.
  3532         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3533             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3534         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3535             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3536         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3537             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3538
  3539         16  CF-PROC-SYS-ACCESS-SW.
  3540             20  CF-PROC-CREDIT-CLAIMS-SW.
  3541                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3542                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3543                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3544                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3545             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3546                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3547                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3548             20  CF-PROC-LIFE-GNRLDGR-SW.
  3549                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3550                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3551                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3552                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3553             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3554                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3555                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3556         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3557             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3558             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3559         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3560
  3561         16  CF-APPROVAL-LEVEL                  PIC X.
  3562             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3563             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3564             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3565             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3566
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  69
* EL152.cbl
  3567         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3568
  3569         16  CF-LANGUAGE-TYPE                   PIC X.
  3570             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3571             88  CF-LANG-IS-FR                      VALUE 'F'.
  3572         16  FILLER                             PIC  X(240).
  3573
  3574****************************************************************
  3575*             PROCESSOR/REMINDERS RECORD                       *
  3576****************************************************************
  3577
  3578     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3579         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3580             20  CF-START-REMIND-DT         PIC XX.
  3581             20  CF-END-REMIND-DT           PIC XX.
  3582             20  CF-REMINDER-TEXT           PIC X(50).
  3583         16  FILLER                         PIC X(296).
  3584
  3585
  3586****************************************************************
  3587*             STATE MASTER RECORD                              *
  3588****************************************************************
  3589
  3590     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3591         16  CF-STATE-ABBREVIATION          PIC XX.
  3592         16  CF-STATE-NAME                  PIC X(25).
  3593         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3594         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3595             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3596             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3597             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3598             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3599                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3600                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3601             20  CF-ST-PREM-REJECT-SW       PIC X.
  3602                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3603                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3604             20  CF-ST-REF-REJECT-SW        PIC X.
  3605                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3606                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3607         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3608         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3609         16  CF-ST-REFUND-RULES.
  3610             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3611             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3612             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3613         16  CF-ST-FST-PMT-EXTENSION.
  3614             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3615             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3616                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3617                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3618                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3619                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3620         16  CF-ST-STATE-CALL.
  3621             20  CF-ST-CALL-UNEARNED        PIC X.
  3622             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3623             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3624         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  70
* EL152.cbl
  3625             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3626             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3627         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3628         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3629         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3630         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3631         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3632         16  FILLER                         PIC X.
  3633         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3634             20  CF-ST-BENEFIT-CD           PIC XX.
  3635             20  CF-ST-BENEFIT-KIND         PIC X.
  3636                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3637                 88  CF-ST-AH-KIND              VALUE 'A'.
  3638             20  CF-ST-REM-TERM-CALC        PIC X.
  3639                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3640                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3641                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3642                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3643                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3644                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3645                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3646                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3647
  3648             20  CF-ST-REFUND-CALC          PIC X.
  3649                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3650                 88  ST-REFD-BY-R78             VALUE '1'.
  3651                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3652                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3653                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3654                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3655                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3656                 88  ST-REFD-UTAH               VALUE '7'.
  3657                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3658                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3659                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3660
  3661             20  CF-ST-EARNING-CALC         PIC X.
  3662                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3663                 88  ST-EARN-BY-R78             VALUE '1'.
  3664                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3665                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3666                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3667                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3668                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3669                 88  ST-EARN-MEAN               VALUE '8'.
  3670                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3671
  3672             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3673                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3674                 88  ST-OVRD-BY-R78             VALUE '1'.
  3675                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3676                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3677                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3678                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3679                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3680                 88  ST-OVRD-MEAN               VALUE '8'.
  3681                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3682             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  71
* EL152.cbl
  3683
  3684         16  CF-ST-COMMISSION-CAPS.
  3685             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3686             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3687             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3688             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3689         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3690                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3691
  3692         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3693
  3694         16  CF-ST-STATUTORY-INTEREST.
  3695             20  CF-ST-STAT-DATE-FROM       PIC X.
  3696                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3697                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3698             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3699             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3700             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3701             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3702             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3703
  3704         16  CF-ST-OVER-SHORT.
  3705             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3706             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3707
  3708         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3709
  3710         16  CF-ST-RT-CALC                  PIC X.
  3711
  3712         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3713         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3714         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3715         16  CF-ST-RF-LR-CALC               PIC X.
  3716         16  CF-ST-RF-LL-CALC               PIC X.
  3717         16  CF-ST-RF-LN-CALC               PIC X.
  3718         16  CF-ST-RF-AH-CALC               PIC X.
  3719         16  CF-ST-RF-CP-CALC               PIC X.
  3720*        16  FILLER                         PIC X(206).
  3721*CIDMOD         16  FILLER                         PIC X(192).
  3722         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3723             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3724         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3725         16  FILLER                         PIC X(187).
  3726
  3727****************************************************************
  3728*             BENEFIT MASTER RECORD                            *
  3729****************************************************************
  3730
  3731     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3732         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3733             20  CF-BENEFIT-CODE            PIC XX.
  3734             20  CF-BENEFIT-NUMERIC  REDEFINES
  3735                 CF-BENEFIT-CODE            PIC XX.
  3736             20  CF-BENEFIT-ALPHA           PIC XXX.
  3737             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3738             20  CF-BENEFIT-COMMENT         PIC X(10).
  3739
  3740             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  72
* EL152.cbl
  3741                 88  CF-REDUCING                VALUE 'R'.
  3742                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3743
  3744             20  CF-SPECIAL-CALC-CD         PIC X.
  3745                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3746                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3747                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3748                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3749                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3750                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3751                 88  CF-FARM-PLAN               VALUE 'F'.
  3752                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3753                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3754                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3755                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3756                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3757                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3758                 88  CF-PRUDENTIAL              VALUE 'P'.
  3759                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3760                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3761                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3762                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3763                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3764                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3765
  3766             20  CF-JOINT-INDICATOR         PIC X.
  3767                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3768
  3769*            20  FILLER                     PIC X(12).
  3770             20  FILLER                     PIC X(11).
  3771             20  CF-BENEFIT-CATEGORY        PIC X.
  3772             20  CF-LOAN-TYPE               PIC X(8).
  3773
  3774             20  CF-CO-REM-TERM-CALC        PIC X.
  3775                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3776                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3777                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3778                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3779                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3780
  3781             20  CF-CO-EARNINGS-CALC        PIC X.
  3782                 88  CO-EARN-BY-R78             VALUE '1'.
  3783                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3784                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3785                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3786                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3787                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3788                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3789                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3790
  3791             20  CF-CO-REFUND-CALC          PIC X.
  3792                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3793                 88  CO-REFD-BY-R78             VALUE '1'.
  3794                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3795                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3796                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3797                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3798                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  73
* EL152.cbl
  3799                 88  CO-REFD-MEAN               VALUE '8'.
  3800                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3801                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3802                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3803
  3804             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3805                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3806                 88  CO-OVRD-BY-R78             VALUE '1'.
  3807                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3808                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3809                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3810                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3811                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3812                 88  CO-OVRD-MEAN               VALUE '8'.
  3813                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3814
  3815             20  CF-CO-BEN-I-G-CD           PIC X.
  3816                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3817                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3818                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3819
  3820         16  FILLER                         PIC X(304).
  3821
  3822
  3823****************************************************************
  3824*             CARRIER MASTER RECORD                            *
  3825****************************************************************
  3826
  3827     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3828         16  CF-ADDRESS-DATA.
  3829             20  CF-MAIL-TO-NAME            PIC X(30).
  3830             20  CF-IN-CARE-OF              PIC X(30).
  3831             20  CF-ADDRESS-LINE-1          PIC X(30).
  3832             20  CF-ADDRESS-LINE-2          PIC X(30).
  3833             20  CF-CITY-STATE              PIC X(30).
  3834             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3835             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3836
  3837         16  CF-CLAIM-NO-CONTROL.
  3838             20  CF-CLAIM-NO-METHOD         PIC X.
  3839                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3840                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3841                 88  CLAIM-NO-SEQ               VALUE '3'.
  3842                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3843             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3844                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3845                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3846                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3847
  3848         16  CF-CHECK-NO-CONTROL.
  3849             20  CF-CHECK-NO-METHOD         PIC X.
  3850                 88  CHECK-NO-MANUAL            VALUE '1'.
  3851                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3852                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3853                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3854             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3855                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3856
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  74
* EL152.cbl
  3857         16  CF-DOMICILE-STATE              PIC XX.
  3858
  3859         16  CF-EXPENSE-CONTROLS.
  3860             20  CF-EXPENSE-METHOD          PIC X.
  3861                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3862                 88  DOLLARS-PER-PMT            VALUE '2'.
  3863                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3864                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3865             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3866             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3867
  3868         16  CF-CORRESPONDENCE-CONTROL.
  3869             20  CF-LETTER-RESEND-OPT       PIC X.
  3870                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3871                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3872             20  FILLER                     PIC X(4).
  3873
  3874         16  CF-RESERVE-CONTROLS.
  3875             20  CF-MANUAL-SW               PIC X.
  3876                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3877             20  CF-FUTURE-SW               PIC X.
  3878                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3879             20  CF-PTC-SW                  PIC X.
  3880                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3881             20  CF-IBNR-SW                 PIC X.
  3882                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3883             20  CF-PTC-LF-SW               PIC X.
  3884                 88  CF-LF-PTC-USED             VALUE '1'.
  3885             20  CF-CDT-ACCESS-METHOD       PIC X.
  3886                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3887                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3888                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3889             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3890
  3891         16  CF-CLAIM-CALC-METHOD           PIC X.
  3892             88  360-PLUS-MONTHS                VALUE '1'.
  3893             88  365-PLUS-MONTHS                VALUE '2'.
  3894             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3895             88  360-DAILY                      VALUE '4'.
  3896             88  365-DAILY                      VALUE '5'.
  3897
  3898         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3899         16  FILLER                         PIC X(11).
  3900
  3901         16  CF-LIMIT-AMOUNTS.
  3902             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3903             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3904             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3905             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3906             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3907             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3908             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3909             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3910             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3911             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3912
  3913         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3914         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  75
* EL152.cbl
  3915         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3916
  3917         16  CF-ZIP-CODE.
  3918             20  CF-ZIP-PRIME.
  3919                 24  CF-ZIP-1ST             PIC X.
  3920                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3921                 24  FILLER                 PIC X(4).
  3922             20  CF-ZIP-PLUS4               PIC X(4).
  3923         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3924             20  CF-CAN-POSTAL-1            PIC XXX.
  3925             20  CF-CAN-POSTAL-2            PIC XXX.
  3926             20  FILLER                     PIC XXX.
  3927
  3928         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3929         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3930         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3931
  3932         16  CF-RATING-SWITCH               PIC X.
  3933             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3934             88  CF-NO-RATING                   VALUE 'N'.
  3935
  3936         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3937
  3938         16  CF-CARRIER-OVER-SHORT.
  3939             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3940             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3941
  3942         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3943         16  CF-SECPAY-SWITCH               PIC X.
  3944             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3945             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3946         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3947         16  FILLER                         PIC X(448).
  3948*        16  FILLER                         PIC X(452).
  3949
  3950
  3951****************************************************************
  3952*             MORTALITY MASTER RECORD                          *
  3953****************************************************************
  3954
  3955     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3956         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3957                                INDEXED BY CF-MORT-NDX.
  3958             20  CF-MORT-TABLE              PIC X(5).
  3959             20  CF-MORT-TABLE-TYPE         PIC X.
  3960                 88  CF-MORT-JOINT              VALUE 'J'.
  3961                 88  CF-MORT-SINGLE             VALUE 'S'.
  3962                 88  CF-MORT-COMBINED           VALUE 'C'.
  3963                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3964                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3965             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3966             20  CF-MORT-AGE-METHOD         PIC XX.
  3967                 88  CF-AGE-LAST                VALUE 'AL'.
  3968                 88  CF-AGE-NEAR                VALUE 'AN'.
  3969             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3970             20  CF-MORT-ADJUSTMENT-DIRECTION
  3971                                            PIC X.
  3972                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  76
* EL152.cbl
  3973                 88  CF-PLUS                    VALUE '+'.
  3974             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3975             20  CF-MORT-JOINT-CODE         PIC X.
  3976                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3977             20  CF-MORT-PC-Q               PIC X.
  3978                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3979             20  CF-MORT-TABLE-CODE         PIC X(4).
  3980             20  CF-MORT-COMMENTS           PIC X(15).
  3981             20  FILLER                     PIC X(14).
  3982
  3983         16  FILLER                         PIC X(251).
  3984
  3985
  3986****************************************************************
  3987*             BUSSINESS TYPE MASTER RECORD                     *
  3988****************************************************************
  3989
  3990     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3991* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3992* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3993* AND RECORD 05 IS TYPES 81-99
  3994         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3995             20  CF-BUSINESS-TITLE          PIC  X(19).
  3996             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3997                                            PIC S9V9(4) COMP-3.
  3998             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3999             20  FILLER                     PIC  X.
  4000         16  FILLER                         PIC  X(248).
  4001
  4002
  4003****************************************************************
  4004*             TERMINAL MASTER RECORD                           *
  4005****************************************************************
  4006
  4007     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4008
  4009         16  CF-COMPANY-TERMINALS.
  4010             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4011                                  PIC X(4).
  4012         16  FILLER               PIC X(248).
  4013
  4014
  4015****************************************************************
  4016*             LIFE EDIT MASTER RECORD                          *
  4017****************************************************************
  4018
  4019     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4020         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4021             20  CF-LIFE-CODE-IN            PIC XX.
  4022             20  CF-LIFE-CODE-OUT           PIC XX.
  4023         16  FILLER                         PIC X(248).
  4024
  4025
  4026****************************************************************
  4027*             AH EDIT MASTER RECORD                            *
  4028****************************************************************
  4029
  4030     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  77
* EL152.cbl
  4031         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4032             20  CF-AH-CODE-IN              PIC XXX.
  4033             20  CF-AH-CODE-OUT             PIC XX.
  4034         16  FILLER                         PIC X(248).
  4035
  4036
  4037****************************************************************
  4038*             CREDIBILITY TABLES                               *
  4039****************************************************************
  4040
  4041     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4042         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4043                             INDEXED BY CF-CRDB-NDX.
  4044             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4045             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4046             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4047         16  FILLER                         PIC  X(332).
  4048
  4049
  4050****************************************************************
  4051*             REPORT CUSTOMIZATION RECORD                      *
  4052****************************************************************
  4053
  4054     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4055         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4056             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4057             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4058             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4059**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4060****       A T-TRANSFER.                                   ****
  4061             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4062
  4063         16  FILLER                         PIC XX.
  4064
  4065         16  CF-CARRIER-CNTL-OPT.
  4066             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4067                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4068                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4069             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4070                                            PIC X.
  4071         16  CF-GROUP-CNTL-OPT.
  4072             20  CF-GROUP-OPT-SEQ           PIC 9.
  4073                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4074                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4075             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4076                                            PIC X(6).
  4077         16  CF-STATE-CNTL-OPT.
  4078             20  CF-STATE-OPT-SEQ           PIC 9.
  4079                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4080                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4081             20  CF-STATE-SELECT OCCURS 3 TIMES
  4082                                            PIC XX.
  4083         16  CF-ACCOUNT-CNTL-OPT.
  4084             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4085                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4086                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4087             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4088                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  78
* EL152.cbl
  4089         16  CF-BUS-TYP-CNTL-OPT.
  4090             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4091                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4092                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4093             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4094                                            PIC XX.
  4095         16  CF-LF-TYP-CNTL-OPT.
  4096             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4097                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4098                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4099             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4100                                            PIC XX.
  4101         16  CF-AH-TYP-CNTL-OPT.
  4102             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4103                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4104                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4105             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4106                                            PIC XX.
  4107         16  CF-REPTCD1-CNTL-OPT.
  4108             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4109                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4110                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4111             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4112                                            PIC X(10).
  4113         16  CF-REPTCD2-CNTL-OPT.
  4114             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4115                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4116                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4117             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4118                                            PIC X(10).
  4119         16  CF-USER1-CNTL-OPT.
  4120             20  CF-USER1-OPT-SEQ           PIC 9.
  4121                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4122                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4123             20  CF-USER1-SELECT OCCURS 3 TIMES
  4124                                            PIC X(10).
  4125         16  CF-USER2-CNTL-OPT.
  4126             20  CF-USER2-OPT-SEQ           PIC 9.
  4127                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4128                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4129             20  CF-USER2-SELECT OCCURS 3 TIMES
  4130                                            PIC X(10).
  4131         16  CF-USER3-CNTL-OPT.
  4132             20  CF-USER3-OPT-SEQ           PIC 9.
  4133                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4134                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4135             20  CF-USER3-SELECT OCCURS 3 TIMES
  4136                                            PIC X(10).
  4137         16  CF-USER4-CNTL-OPT.
  4138             20  CF-USER4-OPT-SEQ           PIC 9.
  4139                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4140                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4141             20  CF-USER4-SELECT OCCURS 3 TIMES
  4142                                            PIC X(10).
  4143         16  CF-USER5-CNTL-OPT.
  4144             20  CF-USER5-OPT-SEQ           PIC 9.
  4145                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4146                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  79
* EL152.cbl
  4147             20  CF-USER5-SELECT OCCURS 3 TIMES
  4148                                            PIC X(10).
  4149         16  CF-REINS-CNTL-OPT.
  4150             20  CF-REINS-OPT-SEQ           PIC 9.
  4151                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4152                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4153             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4154                 24  CF-REINS-PRIME         PIC XXX.
  4155                 24  CF-REINS-SUB           PIC XXX.
  4156
  4157         16  CF-AGENT-CNTL-OPT.
  4158             20  CF-AGENT-OPT-SEQ           PIC 9.
  4159                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4160                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4161             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4162                                            PIC X(10).
  4163
  4164         16  FILLER                         PIC X(43).
  4165
  4166         16  CF-LOSS-RATIO-SELECT.
  4167             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4168             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4169         16  CF-ENTRY-DATE-SELECT.
  4170             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4171             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4172         16  CF-EFFECTIVE-DATE-SELECT.
  4173             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4174             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4175
  4176         16  CF-EXCEPTION-LIST-IND          PIC X.
  4177             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4178
  4179         16  FILLER                         PIC X(318).
  4180
  4181****************************************************************
  4182*                  EXCEPTION REPORTING RECORD                  *
  4183****************************************************************
  4184
  4185     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4186         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4187             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4188
  4189         16  CF-COMBINED-LIFE-AH-OPT.
  4190             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4191             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4192             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4193             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4194
  4195         16  CF-LIFE-OPT.
  4196             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4197             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4198             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4199             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4200             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4201             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4202             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4203             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4204             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  80
* EL152.cbl
  4205             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4206
  4207         16  CF-AH-OPT.
  4208             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4209             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4210             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4211             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4212             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4213             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4214             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4215             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4216             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4217             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4218
  4219         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4220             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4221             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4222             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4223
  4224         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4225
  4226         16  FILLER                         PIC X(673).
  4227
  4228
  4229****************************************************************
  4230*             MORTGAGE SYSTEM PLAN RECORD                      *
  4231****************************************************************
  4232
  4233     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4234         16  CF-PLAN-TYPE                   PIC X.
  4235             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4236             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4237             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4238         16  CF-PLAN-ABBREV                 PIC XXX.
  4239         16  CF-PLAN-DESCRIPT               PIC X(10).
  4240         16  CF-PLAN-NOTES                  PIC X(20).
  4241         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4242         16  CF-PLAN-UNDERWRITING.
  4243             20  CF-PLAN-TERM-DATA.
  4244                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4245                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4246             20  CF-PLAN-AGE-DATA.
  4247                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4248                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4249                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4250             20  CF-PLAN-BENEFIT-DATA.
  4251                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4252                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4253                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4254                                            PIC S9(7)V99  COMP-3.
  4255         16  CF-PLAN-POLICY-FORMS.
  4256             20  CF-POLICY-FORM             PIC X(12).
  4257             20  CF-MASTER-APPLICATION      PIC X(12).
  4258             20  CF-MASTER-POLICY           PIC X(12).
  4259         16  CF-PLAN-RATING.
  4260             20  CF-RATE-CODE               PIC X(5).
  4261             20  CF-SEX-RATING              PIC X.
  4262                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  81
* EL152.cbl
  4263                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4264             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4265             20  CF-SUB-STD-TYPE            PIC X.
  4266                 88  CF-PCT-OF-PREM            VALUE '1'.
  4267                 88  CF-PCT-OF-BENE            VALUE '2'.
  4268         16  CF-PLAN-PREM-TOLERANCES.
  4269             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4270             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4271         16  CF-PLAN-PYMT-TOLERANCES.
  4272             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4273             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4274         16  CF-PLAN-MISC-DATA.
  4275             20  FILLER                     PIC X.
  4276             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4277             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4278         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4279         16  CF-PLAN-IND-GRP                PIC X.
  4280             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4281                                                     '1'.
  4282             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4283                                                     '2'.
  4284         16  CF-MIB-SEARCH-SW               PIC X.
  4285             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4286             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4287             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4288             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4289         16  CF-ALPHA-SEARCH-SW             PIC X.
  4290             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4291             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4292             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4293             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4294             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4295             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4296             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4297             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4298             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4299             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4300                                                     'A' 'B' 'C'
  4301                                                     'X' 'Y' 'Z'.
  4302         16  CF-EFF-DT-RULE-SW              PIC X.
  4303             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4304             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4305             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4306             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4307             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4308         16  FILLER                         PIC X(4).
  4309         16  CF-HEALTH-QUESTIONS            PIC X.
  4310             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4311         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4312         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4313         16  CF-PLAN-SNGL-JNT               PIC X.
  4314             88  CF-COMBINED-PLAN              VALUE 'C'.
  4315             88  CF-JNT-PLAN                   VALUE 'J'.
  4316             88  CF-SNGL-PLAN                  VALUE 'S'.
  4317         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4318         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4319         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4320         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  82
* EL152.cbl
  4321         16  CF-RERATE-CNTL                 PIC  X.
  4322             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4323             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4324             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4325             88  CF-AUTO-RECALC                 VALUE '4'.
  4326         16  CF-BENEFIT-TYPE                PIC  X.
  4327             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4328             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4329         16  CF-POLICY-FEE                  PIC S999V99
  4330                                                    COMP-3.
  4331         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4332         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4333         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4334         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4335         16  FILLER                         PIC  X(32).
  4336         16  CF-TERMINATION-FORM            PIC  X(04).
  4337         16  FILLER                         PIC  X(08).
  4338         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4339                                                       COMP-3.
  4340         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4341         16  CF-ISSUE-LETTER                PIC  X(4).
  4342         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4343         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4344             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4345             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4346         16  CF-MP-REFUND-CALC              PIC X.
  4347             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4348             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4349             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4350             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4351             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4352             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4353             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4354             88  CF-MP-REFD-MEAN                VALUE '8'.
  4355         16  CF-ALT-RATE-CODE               PIC  X(5).
  4356
  4357
  4358         16  FILLER                         PIC X(498).
  4359****************************************************************
  4360*             MORTGAGE COMPANY MASTER RECORD                   *
  4361****************************************************************
  4362
  4363     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4364         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4365         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4366             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4367             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4368             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4369             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4370             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4371
  4372         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4373         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4374         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4375         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4376         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4377
  4378         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  83
* EL152.cbl
  4379             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4380         16  CF-MP-RECON-USE-IND            PIC X(1).
  4381             88  CF-MP-USE-RECON             VALUE 'Y'.
  4382         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4383             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4384         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4385             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4386             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4387         16  FILLER                         PIC X(1).
  4388         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4389             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4390         16  CF-MORTG-MIB-VERSION           PIC X.
  4391             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4392             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4393             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4394         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4395             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4396                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4397             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4398                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4399             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4400                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4401             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4402                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4403             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4404                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4405             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4406                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4407         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4408         16  FILLER                         PIC X(7).
  4409         16  CF-MORTG-DESTINATION-SYMBOL.
  4410             20  CF-MORTG-MIB-COMM          PIC X(5).
  4411             20  CF-MORTG-MIB-TERM          PIC X(5).
  4412         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4413             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4414         16  FILLER                         PIC X(03).
  4415         16  CF-MP-CHECK-NO-CONTROL.
  4416             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4417                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4418                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4419                                                ' ' LOW-VALUES.
  4420                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4421                                               VALUE '3'.
  4422         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4423         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4424         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4425             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4426                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4427             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4428                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4429             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4430                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4431             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4432                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4433             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4434                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4435             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4436                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  84
* EL152.cbl
  4437         16  CF-MORTG-BILLING-AREA.
  4438             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4439                                            PIC X.
  4440         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4441         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4442         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4443         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4444             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4445             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4446         16  FILLER                         PIC X.
  4447         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4448             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4449             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4450         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4451         16  FILLER                         PIC X(8).
  4452         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4453         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4454         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4455         16  CF-ACH-COMPANY-ID.
  4456             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4457                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4458                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4459                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4460             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4461         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4462             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4463         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4464             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4465             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4466         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4467         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4468         16  FILLER                         PIC X(536).
  4469
  4470****************************************************************
  4471*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4472****************************************************************
  4473
  4474     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4475         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4476             20  CF-FEMALE-HEIGHT.
  4477                 24  CF-FEMALE-FT           PIC 99.
  4478                 24  CF-FEMALE-IN           PIC 99.
  4479             20  CF-FEMALE-MIN-WT           PIC 999.
  4480             20  CF-FEMALE-MAX-WT           PIC 999.
  4481         16  FILLER                         PIC X(428).
  4482
  4483     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4484         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4485             20  CF-MALE-HEIGHT.
  4486                 24  CF-MALE-FT             PIC 99.
  4487                 24  CF-MALE-IN             PIC 99.
  4488             20  CF-MALE-MIN-WT             PIC 999.
  4489             20  CF-MALE-MAX-WT             PIC 999.
  4490         16  FILLER                         PIC X(428).
  4491******************************************************************
  4492*             AUTOMATIC ACTIVITY RECORD                          *
  4493******************************************************************
  4494     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  85
* EL152.cbl
  4495         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4496             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4497             20  CF-SYS-LETTER-ID           PIC X(04).
  4498             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4499             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4500             20  CF-SYS-RESET-SW            PIC X(01).
  4501             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4502             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4503
  4504         16  FILLER                         PIC X(50).
  4505
  4506         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4507             20  CF-USER-ACTIVE-SW          PIC X(01).
  4508             20  CF-USER-LETTER-ID          PIC X(04).
  4509             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4510             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4511             20  CF-USER-RESET-SW           PIC X(01).
  4512             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4513             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4514             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4515
  4516         16  FILLER                         PIC X(246).
  4517
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  86
* EL152.cbl
  4519*                                COPY ELCARCH.
  4520******************************************************************
  4521*                                                                *
  4522*                            ELCARCH.                            *
  4523*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4524*                            VMOD=2.007                          *
  4525*                                                                *
  4526*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4527*                                                                *
  4528*   FILE TYPE = VSAM,KSDS                                        *
  4529*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4530*                                                                *
  4531*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  4532*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  4533*                                                                *
  4534*   LOG = NO                                                     *
  4535*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4536*                                                                *
  4537*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  4538******************************************************************
  4539 01  LETTER-ARCHIVE.
  4540     12  LA-RECORD-ID                PIC XX.
  4541         88  VALID-LA-ID                VALUE 'LA'.
  4542
  4543     12  LA-CONTROL-PRIMARY.
  4544         16  LA-COMPANY-CD           PIC X.
  4545         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  4546         16  LA-RECORD-TYPE          PIC X.
  4547             88  LA-HEADER-DATA         VALUE '1'.
  4548             88  LA-ADDRESS-DATA        VALUE '2'.
  4549             88  LA-TEXT-DATA           VALUE '3'.
  4550             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  4551         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  4552
  4553     12  LA-CONTROL-BY-TYPE.
  4554         16  LA-COMPANY-CD-A1        PIC X.
  4555         16  LA-RECORD-TYPE-A1       PIC X.
  4556         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4557         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4558
  4559     12  LA-TEXT-RECORD.
  4560         16  LA-SKIP-CONTROL         PIC XX.
  4561             88  NO-LINES-SKIPPED       VALUE SPACES.
  4562             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  4563         16  LA-TEXT-LINE            PIC X(70).
  4564
  4565     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  4566         16  FILLER                  PIC XX.
  4567         16  LA-ADDRESS-LINE         PIC X(30).
  4568         16  FILLER                  PIC X(40).
  4569
  4570     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  4571         16  FILLER                  PIC XX.
  4572         16  LA-CARRIER              PIC X.
  4573         16  LA-CLAIM-NO             PIC X(7).
  4574         16  LA-CERT-NO.
  4575             20  LA-CERT-PRIME       PIC X(10).
  4576             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  87
* EL152.cbl
  4577         16  LA-NO-OF-COPIES         PIC S9.
  4578         16  LA-RESEND-DATE          PIC XX.
  4579         16  LA-PROCESSOR-CD         PIC X(4).
  4580         16  LA-CREATION-DT          PIC XX.
  4581         16  LA-INITIAL-PRINT-DATE   PIC XX.
  4582         16  LA-RESEND-PRINT-DATE    PIC XX.
  4583         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4584         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  4585*
  4586* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  4587*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  4588*   I        20  LA-DMD-PROD-CODE        PIC XX.
  4589*   I        20  LA-DMD-RES-ST           PIC XX.
  4590*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4591*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  4592*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  4593*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  4594*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  4595*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  4596*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  4597*   I        20  LA-DMD-UND-CODE         PIC XX.
  4598*   I        20  LA-DMD-BEN-CODE         PIC XX.
  4599*   V    16  FILLER                  PIC X(15).
  4600* -----
  4601*
  4602* REINSERTED  CSO  MODS
  4603*
  4604         16  FILLER.
  4605             20  FILLER                  PIC X(29).
  4606             20  LA-CSO-LETTER-STATUS    PIC X.
  4607                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  4608                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  4609                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  4610             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  4611             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  4612*
  4613
  4614     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  4615         16  FILLER                  PIC XX.
  4616         16  LA4-CARRIER             PIC X.
  4617         16  LA4-CLAIM-NO            PIC X(7).
  4618         16  LA4-CERT-NO.
  4619             20  LA4-CERT-PRIME      PIC X(10).
  4620             20  LA4-CERT-SFX        PIC X.
  4621         16  LA4-NO-OF-COPIES        PIC S9.
  4622         16  LA4-RESEND-DATE         PIC XX.
  4623         16  LA4-PROCESSOR-CD        PIC X(4).
  4624         16  LA4-CREATION-DT         PIC XX.
  4625         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  4626         16  LA4-RESEND-PRINT-DATE   PIC XX.
  4627         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4628         16  LA4-FORM-TYPE           PIC X.
  4629             88  LA4-INITIAL-FORM    VALUE '1'.
  4630             88  LA4-PROGRESS-FORM   VALUE '2'.
  4631         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  4632         16  LA4-STATE               PIC X(02).
  4633         16  FILLER                  PIC X(31).
  4634******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  88
* EL152.cbl
  4635
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  89
* EL152.cbl
  4637*                                COPY ELCARCT.
  4638******************************************************************
  4639*                                                                *
  4640*                            ELCARCT.                            *
  4641*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4642*                            VMOD=2.003                          *
  4643*                                                                *
  4644*   FILE DESCRIPTION = TEMPORARY LETTER ARCHIVE FILE             *
  4645*                                                                *
  4646*   FILE TYPE = VSAM,KSDS                                        *
  4647*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4648*                                                                *
  4649*   BASE CLUSTER = ELARCT                        RKP=2,LEN=8     *
  4650*       ALTERNATE PATH1 = ELARCT2  (RECORD TYPE) RKP=10,LEN=8    *
  4651*                                                                *
  4652*   LOG = NO                                                     *
  4653*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4654*                                                                *
  4655*  NO  CID  MODS  IN  COPYBOOK  ELCARCT                          *
  4656******************************************************************
  4657 01  LETTER-ARCHIVE-TEMP.
  4658     12  LT-RECORD-ID                PIC XX.
  4659         88  VALID-LT-ID                VALUE 'LT'.
  4660
  4661     12  LT-CONTROL-PRIMARY.
  4662         16  LT-COMPANY-CD           PIC X.
  4663         16  LT-ARCHIVE-NO           PIC S9(8)     COMP.
  4664         16  LT-RECORD-TYPE          PIC X.
  4665             88  LT-HEADER-DATA         VALUE '1'.
  4666             88  LT-ADDRESS-DATA        VALUE '2'.
  4667             88  LT-TEXT-DATA           VALUE '3'.
  4668             88  LT-FORM-CONTROL-HDR    VALUE '4'.
  4669         16  LT-LINE-SEQ-NO          PIC S9(4)     COMP.
  4670
  4671     12  LT-CONTROL-BY-TYPE.
  4672         16  LT-COMPANY-CD-A1        PIC X.
  4673         16  LT-RECORD-TYPE-A1       PIC X.
  4674         16  LT-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4675         16  LT-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4676
  4677     12  LT-TEXT-RECORD.
  4678         16  LT-SKIP-CONTROL         PIC XX.
  4679         16  LT-TEXT-LINE            PIC X(70).
  4680
  4681     12  LT-ADDRESS-RECORD  REDEFINES  LT-TEXT-RECORD.
  4682         16  FILLER                  PIC XX.
  4683         16  LT-ADDRESS-LINE         PIC X(30).
  4684         16  FILLER                  PIC X(40).
  4685
  4686     12  LT-HEADER-RECORD  REDEFINES  LT-TEXT-RECORD.
  4687         16  FILLER                  PIC XX.
  4688         16  LT-CARRIER              PIC X.
  4689         16  LT-CLAIM-NO             PIC X(7).
  4690         16  LT-CERT-NO.
  4691             20  LT-CERT-PRIME       PIC X(10).
  4692             20  LT-CERT-SFX         PIC X.
  4693         16  LT-NO-OF-COPIES         PIC S9.
  4694         16  LT-RESEND-DATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  90
* EL152.cbl
  4695         16  LT-PROCESSOR-CD         PIC X(4).
  4696         16  LT-CREATION-DT          PIC XX.
  4697         16  LT-INITIAL-PRINT-DATE   PIC XX.
  4698         16  LT-RESEND-PRINT-DATE    PIC XX.
  4699         16  LT-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4700         16  LT-1ST-RESEND-PRINT-DT  PIC XX.
  4701         16  LT-DMD-ADDITIONAL-FIELDS.
  4702             20  LT-DMD-LETTER-FORM      PIC X(4).
  4703             20  LT-DMD-PROD-CODE        PIC XX.
  4704             20  LT-DMD-RES-ST           PIC XX.
  4705             20  LT-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4706             20  LT-DMD-LETTER-STATUS    PIC X.
  4707                 88  LT-DMD-LETTER-ONLINE   VALUE '1'.
  4708                 88  LT-DMD-LETTER-PURGED   VALUE '2'.
  4709                 88  LT-DMD-LETTER-RELOADED VALUE '3'.
  4710             20  LT-DMD-LETTER-PURGE-DT  PIC XX.
  4711             20  LT-DMD-LETTER-RELOAD-DT PIC XX.
  4712             20  LT-DMD-UND-CODE         PIC XX.
  4713             20  LT-DMD-BEN-CODE         PIC XX.
  4714         16  FILLER                  PIC X(15).
  4715
  4716     12  LT-FORM-CONTROL-HEADER REDEFINES  LT-TEXT-RECORD.
  4717         16  FILLER                  PIC XX.
  4718         16  LT4-CARRIER             PIC X.
  4719         16  LT4-CLAIM-NO            PIC X(7).
  4720         16  LT4-CERT-NO.
  4721             20  LT4-CERT-PRIME      PIC X(10).
  4722             20  LT4-CERT-SFX        PIC X.
  4723         16  LT4-NO-OF-COPIES        PIC S9.
  4724         16  LT4-RESEND-DATE         PIC XX.
  4725         16  LT4-PROCESSOR-CD        PIC X(4).
  4726         16  LT4-CREATION-DT         PIC XX.
  4727         16  LT4-INITIAL-PRINT-DATE  PIC XX.
  4728         16  LT4-RESEND-PRINT-DATE   PIC XX.
  4729         16  LT4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4730         16  LT4-FORM-TYPE           PIC X.
  4731             88  LT4-INITIAL-FORM    VALUE '1'.
  4732             88  LT4-PROGRESS-FORM   VALUE '2'.
  4733         16  LT4-FORM-REM-PRINT-DT   PIC XX.
  4734         16  LT4-STATE               PIC XX.
  4735         16  FILLER                  PIC X(31).
  4736******************************************************************
  4737
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  91
* EL152.cbl
  4739*                                COPY ELCCERT.
  4740******************************************************************
  4741*                                                                *
  4742*                            ELCCERT.                            *
  4743*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4744*                            VMOD=2.013                          *
  4745*                                                                *
  4746*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4747*                                                                *
  4748*   FILE TYPE = VSAM,KSDS                                        *
  4749*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4750*                                                                *
  4751*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4752*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4753*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4754*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4755*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4756*                                                                *
  4757*   LOG = YES                                                    *
  4758*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4759******************************************************************
  4760*                   C H A N G E   L O G
  4761*
  4762* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4763*-----------------------------------------------------------------
  4764*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4765* EFFECTIVE    NUMBER
  4766*-----------------------------------------------------------------
  4767* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4768* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4769* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4770* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4771* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4772* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4773* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4774******************************************************************
  4775
  4776 01  CERTIFICATE-MASTER.
  4777     12  CM-RECORD-ID                      PIC XX.
  4778         88  VALID-CM-ID                      VALUE 'CM'.
  4779
  4780     12  CM-CONTROL-PRIMARY.
  4781         16  CM-COMPANY-CD                 PIC X.
  4782         16  CM-CARRIER                    PIC X.
  4783         16  CM-GROUPING.
  4784             20  CM-GROUPING-PREFIX        PIC X(3).
  4785             20  CM-GROUPING-PRIME         PIC X(3).
  4786         16  CM-STATE                      PIC XX.
  4787         16  CM-ACCOUNT.
  4788             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4789             20  CM-ACCOUNT-PRIME          PIC X(6).
  4790         16  CM-CERT-EFF-DT                PIC XX.
  4791         16  CM-CERT-NO.
  4792             20  CM-CERT-PRIME             PIC X(10).
  4793             20  CM-CERT-SFX               PIC X.
  4794
  4795     12  CM-CONTROL-BY-NAME.
  4796         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  92
* EL152.cbl
  4797         16  CM-INSURED-LAST-NAME          PIC X(15).
  4798         16  CM-INSURED-INITIALS.
  4799             20  CM-INSURED-INITIAL1       PIC X.
  4800             20  CM-INSURED-INITIAL2       PIC X.
  4801
  4802     12  CM-CONTROL-BY-SSN.
  4803         16  CM-COMPANY-CD-A2              PIC X.
  4804         16  CM-SOC-SEC-NO.
  4805             20  CM-SSN-STATE              PIC XX.
  4806             20  CM-SSN-ACCOUNT            PIC X(6).
  4807             20  CM-SSN-LN3.
  4808                 25  CM-INSURED-INITIALS-A2.
  4809                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4810                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4811                 25 CM-PART-LAST-NAME-A2         PIC X.
  4812
  4813     12  CM-CONTROL-BY-CERT-NO.
  4814         16  CM-COMPANY-CD-A4              PIC X.
  4815         16  CM-CERT-NO-A4                 PIC X(11).
  4816
  4817     12  CM-CONTROL-BY-MEMB.
  4818         16  CM-COMPANY-CD-A5              PIC X.
  4819         16  CM-MEMBER-NO.
  4820             20  CM-MEMB-STATE             PIC XX.
  4821             20  CM-MEMB-ACCOUNT           PIC X(6).
  4822             20  CM-MEMB-LN4.
  4823                 25  CM-INSURED-INITIALS-A5.
  4824                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4825                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4826                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4827
  4828     12  CM-INSURED-PROFILE-DATA.
  4829         16  CM-INSURED-FIRST-NAME.
  4830             20  CM-INSURED-1ST-INIT       PIC X.
  4831             20  FILLER                    PIC X(9).
  4832         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4833         16  CM-INSURED-SEX                PIC X.
  4834             88  CM-SEX-MALE                  VALUE 'M'.
  4835             88  CM-SEX-FEMAL                 VALUE 'F'.
  4836         16  CM-INSURED-JOINT-AGE          PIC 99.
  4837         16  CM-JOINT-INSURED-NAME.
  4838             20  CM-JT-LAST-NAME           PIC X(15).
  4839             20  CM-JT-FIRST-NAME.
  4840                 24  CM-JT-1ST-INIT        PIC X.
  4841                 24  FILLER                PIC X(9).
  4842             20  CM-JT-INITIAL             PIC X.
  4843
  4844     12  CM-LIFE-DATA.
  4845         16  CM-LF-BENEFIT-CD              PIC XX.
  4846         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4847         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4848         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4849         16  CM-LF-DEV-CODE                PIC XXX.
  4850         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4851         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4852         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4853         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4854         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  93
* EL152.cbl
  4855         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4856         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4857         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4858         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4859         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4860         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4861         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4862         16  FILLER                        PIC XX.
  4863
  4864     12  CM-AH-DATA.
  4865         16  CM-AH-BENEFIT-CD              PIC XX.
  4866         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4867         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4868         16  CM-AH-DEV-CODE                PIC XXX.
  4869         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4870         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4871         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4872         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4873         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4874         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4875         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4876         16  CM-AH-PAID-THRU-DT            PIC XX.
  4877             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4878         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4879         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4880         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4881         16  FILLER                        PIC X.
  4882
  4883     12  CM-LOAN-INFORMATION.
  4884         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4885         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4886         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4887         16  CM-PAY-FREQUENCY              PIC S99.
  4888         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4889         16  CM-RATE-CLASS                 PIC XX.
  4890         16  CM-BENEFICIARY                PIC X(25).
  4891         16  CM-POLICY-FORM-NO             PIC X(12).
  4892         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4893         16  CM-LAST-ADD-ON-DT             PIC XX.
  4894         16  CM-DEDUCTIBLE-AMOUNTS.
  4895             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4896             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4897         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4898             20  CM-RESIDENT-STATE         PIC XX.
  4899             20  CM-RATE-CODE              PIC X(4).
  4900             20  FILLER                    PIC XX.
  4901         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4902             20  CM-LOAN-OFFICER           PIC X(5).
  4903             20  FILLER                    PIC XXX.
  4904         16  CM-CSR-CODE                   PIC XXX.
  4905         16  CM-UNDERWRITING-CODE          PIC X.
  4906             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4907         16  CM-POST-CARD-IND              PIC X.
  4908         16  CM-NH-INTERFACE-SW            PIC X.
  4909         16  CM-PREMIUM-TYPE               PIC X.
  4910             88  CM-SING-PRM                  VALUE '1'.
  4911             88  CM-O-B-COVERAGE              VALUE '2'.
  4912             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  94
* EL152.cbl
  4913         16  CM-IND-GRP-TYPE               PIC X.
  4914             88  CM-INDIVIDUAL                VALUE 'I'.
  4915             88  CM-GROUP                     VALUE 'G'.
  4916         16  CM-SKIP-CODE                  PIC X.
  4917             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4918             88  SKIP-JULY                    VALUE '1'.
  4919             88  SKIP-AUGUST                  VALUE '2'.
  4920             88  SKIP-SEPTEMBER               VALUE '3'.
  4921             88  SKIP-JULY-AUG                VALUE '4'.
  4922             88  SKIP-AUG-SEPT                VALUE '5'.
  4923             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4924             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4925             88  SKIP-JUNE                    VALUE '8'.
  4926             88  SKIP-JUNE-JULY               VALUE '9'.
  4927             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4928             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4929         16  CM-PAYMENT-MODE               PIC X.
  4930             88  PAY-MONTHLY                  VALUE SPACE.
  4931             88  PAY-WEEKLY                   VALUE '1'.
  4932             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4933             88  PAY-BI-WEEKLY                VALUE '3'.
  4934             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4935         16  CM-LOAN-NUMBER                PIC X(8).
  4936         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4937         16  CM-OLD-LOF                    PIC XXX.
  4938*        16  CM-LOAN-OFFICER               PIC XXX.
  4939         16  CM-REIN-TABLE                 PIC XXX.
  4940         16  CM-SPECIAL-REIN-CODE          PIC X.
  4941         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4942         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4943         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4944
  4945     12  CM-STATUS-DATA.
  4946         16  CM-ENTRY-STATUS               PIC X.
  4947         16  CM-ENTRY-DT                   PIC XX.
  4948
  4949         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4950         16  CM-LF-CANCEL-DT               PIC XX.
  4951         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4952
  4953         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4954         16  CM-LF-DEATH-DT                PIC XX.
  4955         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4956
  4957         16  CM-LF-CURRENT-STATUS          PIC X.
  4958             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4959                                                'M' '4' '5' '9'.
  4960             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4961             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4962             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4963             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4964             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4965             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4966             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4967             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4968             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4969             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4970             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  95
* EL152.cbl
  4971             88  CM-LF-VOIDED                 VALUE 'V'.
  4972
  4973         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4974         16  CM-AH-CANCEL-DT               PIC XX.
  4975         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4976
  4977         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4978         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4979         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4980
  4981         16  CM-AH-CURRENT-STATUS          PIC X.
  4982             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4983                                                'M' '4' '5' '9'.
  4984             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4985             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4986             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4987             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4988             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4989             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4990             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4991             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4992             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4993             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4994             88  CM-AH-DECLINED               VALUE 'D'.
  4995             88  CM-AH-VOIDED                 VALUE 'V'.
  4996
  4997         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4998             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4999             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5000             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5001         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5002
  5003         16  CM-ENTRY-BATCH                PIC X(6).
  5004         16  CM-LF-EXIT-BATCH              PIC X(6).
  5005         16  CM-AH-EXIT-BATCH              PIC X(6).
  5006         16  CM-LAST-MONTH-END             PIC XX.
  5007
  5008     12  CM-NOTE-SW                        PIC X.
  5009         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5010         88  CERT-NOTES-PRESENT               VALUE '1'.
  5011         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5012         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5013         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5014         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5015         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5016         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5017     12  CM-COMP-EXCP-SW                   PIC X.
  5018         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5019         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5020     12  CM-INSURED-ADDRESS-SW             PIC X.
  5021         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5022         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5023
  5024*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5025     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5026     12  FILLER                            PIC X.
  5027
  5028*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  96
* EL152.cbl
  5029     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5030     12  FILLER                            PIC X.
  5031*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5032     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5033
  5034     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5035         88  CERT-ADDED-BATCH                 VALUE ' '.
  5036         88  CERT-ADDED-ONLINE                VALUE '1'.
  5037         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5038         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5039         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5040     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5041         88  CERT-AS-LOADED                   VALUE ' '.
  5042         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5043         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5044         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5045         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5046         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5047         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5048         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5049
  5050     12  CM-ACCOUNT-COMM-PCTS.
  5051         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5052         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5053
  5054     12  CM-USER-FIELD                     PIC X.
  5055     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5056     12  CM-CLP-STATE                      PIC XX.
  5057     12  CM-USER-RESERVED                  PIC XXX.
  5058******************************************************************
  5059
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  97
* EL152.cbl
  5061*                                COPY ERCACCT.
  5062******************************************************************
  5063*                                                                *
  5064*                                                                *
  5065*                            ERCACCT                             *
  5066*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5067*                            VMOD=2.031                          *
  5068*                                                                *
  5069*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5070*                                                                *
  5071*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5072*   VSAM ACCOUNT MASTER FILES.                                   *
  5073*                                                                *
  5074*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5075*                                                                *
  5076*   FILE TYPE = VSAM,KSDS                                        *
  5077*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5078*                                                                *
  5079*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5080*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5081*                                                                *
  5082*   LOG = NO                                                     *
  5083*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5084*                                                                *
  5085*                                                                *
  5086******************************************************************
  5087*                   C H A N G E   L O G
  5088*
  5089* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5090*-----------------------------------------------------------------
  5091*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5092* EFFECTIVE    NUMBER
  5093*-----------------------------------------------------------------
  5094* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5095* 092705    2005050300006  PEMA  ADD SPP LEASES
  5096* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5097* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5098******************************************************************
  5099
  5100 01  ACCOUNT-MASTER.
  5101     12  AM-RECORD-ID                      PIC XX.
  5102         88  VALID-AM-ID                      VALUE 'AM'.
  5103
  5104     12  AM-CONTROL-PRIMARY.
  5105         16  AM-COMPANY-CD                 PIC X.
  5106         16  AM-MSTR-CNTRL.
  5107             20  AM-CONTROL-A.
  5108                 24  AM-CARRIER            PIC X.
  5109                 24  AM-GROUPING.
  5110                     28 AM-GROUPING-PREFIX PIC XXX.
  5111                     28 AM-GROUPING-PRIME  PIC XXX.
  5112                 24  AM-STATE              PIC XX.
  5113                 24  AM-ACCOUNT.
  5114                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5115                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5116             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5117                                           PIC X(19).
  5118             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  98
* EL152.cbl
  5119                 24  AM-EXPIRATION-DT      PIC XX.
  5120                 24  FILLER                PIC X(4).
  5121             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5122                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5123
  5124     12  AM-CONTROL-BY-VAR-GRP.
  5125         16  AM-COMPANY-CD-A1              PIC X.
  5126         16  AM-VG-CARRIER                 PIC X.
  5127         16  AM-VG-GROUPING                PIC X(6).
  5128         16  AM-VG-STATE                   PIC XX.
  5129         16  AM-VG-ACCOUNT                 PIC X(10).
  5130         16  AM-VG-DATE.
  5131             20  AM-VG-EXPIRATION-DT       PIC XX.
  5132             20  FILLER                    PIC X(4).
  5133         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5134                                           PIC 9(11)      COMP-3.
  5135     12  AM-MAINT-INFORMATION.
  5136         16  AM-LAST-MAINT-DT              PIC XX.
  5137         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5138         16  AM-LAST-MAINT-USER            PIC X(4).
  5139         16  FILLER                        PIC XX.
  5140
  5141     12  AM-EFFECTIVE-DT                   PIC XX.
  5142     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5143
  5144     12  AM-PREV-DATES  COMP-3.
  5145         16  AM-PREV-EXP-DT                PIC 9(11).
  5146         16  AM-PREV-EFF-DT                PIC 9(11).
  5147
  5148     12  AM-REPORT-CODE-1                  PIC X(10).
  5149     12  AM-REPORT-CODE-2                  PIC X(10).
  5150
  5151     12  AM-CITY-CODE                      PIC X(4).
  5152     12  AM-COUNTY-PARISH                  PIC X(6).
  5153
  5154     12  AM-NAME                           PIC X(30).
  5155     12  AM-PERSON                         PIC X(30).
  5156     12  AM-ADDRS                          PIC X(30).
  5157     12  AM-CITY.
  5158         16  AM-ADDR-CITY                  PIC X(28).
  5159         16  AM-ADDR-STATE                 PIC XX.
  5160     12  AM-ZIP.
  5161         16  AM-ZIP-PRIME.
  5162             20  AM-ZIP-PRI-1ST            PIC X.
  5163                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5164             20  FILLER                    PIC X(4).
  5165         16  AM-ZIP-PLUS4                  PIC X(4).
  5166     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5167         16  AM-CAN-POSTAL-1               PIC XXX.
  5168         16  AM-CAN-POSTAL-2               PIC XXX.
  5169         16  FILLER                        PIC XXX.
  5170     12  AM-TEL-NO.
  5171         16  AM-AREA-CODE                  PIC 999.
  5172         16  AM-TEL-PRE                    PIC 999.
  5173         16  AM-TEL-NBR                    PIC 9(4).
  5174     12  AM-TEL-LOC                        PIC X.
  5175         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5176         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  99
* EL152.cbl
  5177
  5178     12  AM-COMM-STRUCTURE.
  5179         16  AM-DEFN-1.
  5180             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5181                 24  AM-AGT.
  5182                     28  AM-AGT-PREFIX     PIC X(4).
  5183                     28  AM-AGT-PRIME      PIC X(6).
  5184                 24  AM-COM-TYP            PIC X.
  5185                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5186                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5187                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5188                 24  AM-RECALC-LV-INDIC    PIC X.
  5189                 24  AM-RETRO-LV-INDIC     PIC X.
  5190                 24  AM-GL-CODES           PIC X.
  5191                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5192                 24  FILLER                PIC X(01).
  5193         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5194             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5195                 24  FILLER                PIC X(11).
  5196                 24  AM-L-COMA             PIC XXX.
  5197                 24  AM-J-COMA             PIC XXX.
  5198                 24  AM-A-COMA             PIC XXX.
  5199                 24  FILLER                PIC X(6).
  5200
  5201     12  AM-COMM-CHANGE-STATUS             PIC X.
  5202         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5203
  5204     12  AM-CSR-CODE                       PIC X(4).
  5205
  5206     12  AM-BILLING-STATUS                 PIC X.
  5207         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5208         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5209     12  AM-AUTO-REFUND-SW                 PIC X.
  5210         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5211         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5212     12  AM-GPCD                           PIC 99.
  5213     12  AM-IG                             PIC X.
  5214         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5215         88  AM-HAS-GROUP                     VALUE '2'.
  5216     12  AM-STATUS                         PIC X.
  5217         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5218         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5219         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5220         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5221         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5222     12  AM-REMIT-TO                       PIC 99.
  5223     12  AM-ID-NO                          PIC X(11).
  5224
  5225     12  AM-CAL-TABLE                      PIC XX.
  5226     12  AM-LF-DEVIATION                   PIC XXX.
  5227     12  AM-AH-DEVIATION                   PIC XXX.
  5228     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5229     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5230     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5231     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5232     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5233     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5234
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 100
* EL152.cbl
  5235     12  AM-USER-FIELDS.
  5236         16  AM-FLD-1                      PIC XX.
  5237         16  AM-FLD-2                      PIC XX.
  5238         16  AM-FLD-3                      PIC XX.
  5239         16  AM-FLD-4                      PIC XX.
  5240         16  AM-FLD-5                      PIC XX.
  5241
  5242     12  AM-1ST-PROD-DATE.
  5243         16  AM-1ST-PROD-YR                PIC XX.
  5244         16  AM-1ST-PROD-MO                PIC XX.
  5245         16  AM-1ST-PROD-DA                PIC XX.
  5246     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5247     12  AM-CERTS-PURGED-DATE.
  5248         16  AM-PUR-YR                     PIC XX.
  5249         16  AM-PUR-MO                     PIC XX.
  5250         16  AM-PUR-DA                     PIC XX.
  5251     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5252     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5253     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5254     12  AM-INACTIVE-DATE.
  5255         16  AM-INA-MO                     PIC 99.
  5256         16  AM-INA-DA                     PIC 99.
  5257         16  AM-INA-YR                     PIC 99.
  5258     12  AM-AR-HI-CERT-DATE                PIC XX.
  5259
  5260     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5261     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5262
  5263     12  AM-OB-PAYMENT-MODE                PIC X.
  5264         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5265         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5266         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5267         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5268
  5269     12  AM-AH-ONLY-INDICATOR              PIC X.
  5270         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5271         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5272
  5273     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5274
  5275     12  AM-OVER-SHORT.
  5276         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5277         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5278
  5279     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5280     12  AM-DCC-CLP-STATE                  PIC XX.
  5281
  5282     12  AM-RECALC-COMM                    PIC X.
  5283     12  AM-RECALC-REIN                    PIC X.
  5284
  5285     12  AM-REI-TABLE                      PIC XXX.
  5286     12  AM-REI-ET-LF                      PIC X.
  5287     12  AM-REI-ET-AH                      PIC X.
  5288     12  AM-REI-PE-LF                      PIC X.
  5289     12  AM-REI-PE-AH                      PIC X.
  5290     12  AM-REI-PRT-ST                     PIC X.
  5291     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5292     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 101
* EL152.cbl
  5293     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5294     12  AM-REI-GROUP-A                    PIC X(6).
  5295     12  AM-REI-MORT                       PIC X(4).
  5296     12  AM-REI-PRT-OW                     PIC X.
  5297     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5298     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5299     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5300     12  AM-REI-GROUP-B                    PIC X(6).
  5301
  5302     12  AM-TRUST-TYPE                     PIC X(2).
  5303
  5304     12  AM-EMPLOYER-STMT-USED             PIC X.
  5305     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5306
  5307     12  AM-STD-AH-TYPE                    PIC XX.
  5308     12  AM-EARN-METHODS.
  5309         16  AM-EARN-METHOD-R              PIC X.
  5310             88 AM-REF-RL-R78                 VALUE 'R'.
  5311             88 AM-REF-RL-PR                  VALUE 'P'.
  5312             88 AM-REF-RL-MEAN                VALUE 'M'.
  5313             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5314         16  AM-EARN-METHOD-L              PIC X.
  5315             88 AM-REF-LL-R78                 VALUE 'R'.
  5316             88 AM-REF-LL-PR                  VALUE 'P'.
  5317             88 AM-REF-LL-MEAN                VALUE 'M'.
  5318             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5319         16  AM-EARN-METHOD-A              PIC X.
  5320             88 AM-REF-AH-R78                 VALUE 'R'.
  5321             88 AM-REF-AH-PR                  VALUE 'P'.
  5322             88 AM-REF-AH-MEAN                VALUE 'M'.
  5323             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5324             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5325             88 AM-REF-AH-NET                 VALUE 'N'.
  5326
  5327     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5328     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5329     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5330
  5331     12  AM-RET-Y-N                        PIC X.
  5332     12  AM-RET-P-E                        PIC X.
  5333     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5334     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5335     12  AM-RET-GRP                        PIC X(6).
  5336     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5337         16  AM-POOL-PRIME                 PIC XXX.
  5338         16  AM-POOL-SUB                   PIC XXX.
  5339     12  AM-RETRO-EARNINGS.
  5340         16  AM-RET-EARN-R                 PIC X.
  5341         16  AM-RET-EARN-L                 PIC X.
  5342         16  AM-RET-EARN-A                 PIC X.
  5343     12  AM-RET-ST-TAX-USE                 PIC X.
  5344         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5345         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5346     12  AM-RETRO-BEG-EARNINGS.
  5347         16  AM-RET-BEG-EARN-R             PIC X.
  5348         16  AM-RET-BEG-EARN-L             PIC X.
  5349         16  AM-RET-BEG-EARN-A             PIC X.
  5350     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 102
* EL152.cbl
  5351     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5352
  5353     12  AM-USER-SELECT-OPTIONS.
  5354         16  AM-USER-SELECT-1              PIC X(10).
  5355         16  AM-USER-SELECT-2              PIC X(10).
  5356         16  AM-USER-SELECT-3              PIC X(10).
  5357         16  AM-USER-SELECT-4              PIC X(10).
  5358         16  AM-USER-SELECT-5              PIC X(10).
  5359
  5360     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5361
  5362     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5363
  5364     12  AM-RPT045A-SWITCH                 PIC X.
  5365         88  RPT045A-OFF                   VALUE 'N'.
  5366
  5367     12  AM-INSURANCE-LIMITS.
  5368         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5369         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5370
  5371     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5372         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5373
  5374     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5375         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5376         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5377
  5378     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5379
  5380     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5381     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5382     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5383     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5384     12  FILLER                            PIC X(5).
  5385     12  AM-REPORT-CODE-3                  PIC X(10).
  5386*    12  FILLER                            PIC X(22).
  5387
  5388     12  AM-RESERVE-DATE.
  5389         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5390         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5391         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5392
  5393     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5394     12  AM-NOTIFICATION-TYPES.
  5395         16  AM-NOTIF-OF-LETTERS           PIC X.
  5396         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5397         16  AM-NOTIF-OF-REPORTS           PIC X.
  5398         16  AM-NOTIF-OF-STATUS            PIC X.
  5399
  5400     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5401         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5402         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5403         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5404         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5405
  5406     12  AM-BENEFIT-CONTROLS.
  5407         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5408             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 103
* EL152.cbl
  5409             20  AM-BENEFIT-TYPE           PIC X.
  5410             20  AM-BENEFIT-REVISION       PIC XXX.
  5411             20  AM-BENEFIT-REM-TERM       PIC X.
  5412             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5413             20  FILLER                    PIC XX.
  5414         16  FILLER                        PIC X(80).
  5415
  5416     12  AM-TRANSFER-DATA.
  5417         16  AM-TRANSFERRED-FROM.
  5418             20  AM-TRNFROM-CARRIER        PIC X.
  5419             20  AM-TRNFROM-GROUPING.
  5420                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5421                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5422             20  AM-TRNFROM-STATE          PIC XX.
  5423             20  AM-TRNFROM-ACCOUNT.
  5424                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5425                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5426             20  AM-TRNFROM-DTE            PIC XX.
  5427         16  AM-TRANSFERRED-TO.
  5428             20  AM-TRNTO-CARRIER          PIC X.
  5429             20  AM-TRNTO-GROUPING.
  5430                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5431                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5432             20  AM-TRNTO-STATE            PIC XX.
  5433             20  AM-TRNTO-ACCOUNT.
  5434                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5435                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5436             20  AM-TRNTO-DTE              PIC XX.
  5437         16  FILLER                        PIC X(10).
  5438
  5439     12  AM-SAVED-REMIT-TO                 PIC 99.
  5440
  5441     12  AM-COMM-STRUCTURE-SAVED.
  5442         16  AM-DEFN-1-SAVED.
  5443             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5444                 24  AM-AGT-SV             PIC X(10).
  5445                 24  AM-COM-TYP-SV         PIC X.
  5446                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5447                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5448                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5449                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5450                 24  FILLER                PIC X.
  5451                 24  AM-GL-CODES-SV        PIC X.
  5452                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5453                 24  FILLER                PIC X.
  5454         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5455             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5456                 24  FILLER                PIC X(11).
  5457                 24  AM-L-COMA-SV          PIC XXX.
  5458                 24  AM-J-COMA-SV          PIC XXX.
  5459                 24  AM-A-COMA-SV          PIC XXX.
  5460                 24  FILLER                PIC X(6).
  5461
  5462     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5463         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5464            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5465            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5466            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 104
* EL152.cbl
  5467
  5468     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5469     12  FILLER                            PIC X(120).
  5470
  5471     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5472         16  AM-CONTROL-NAME               PIC X(30).
  5473         16  AM-EXECUTIVE-ONE.
  5474             20  AM-EXEC1-NAME             PIC X(15).
  5475             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5476                                                          COMP-3.
  5477             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5478                                                          COMP-3.
  5479         16  AM-EXECUTIVE-TWO.
  5480             20  AM-EXEC2-NAME             PIC X(15).
  5481             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5482                                                          COMP-3.
  5483             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5484                                                          COMP-3.
  5485
  5486     12  AM-RETRO-ADDITIONAL-DATA.
  5487         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5488         16  AM-RETRO-PREM-P-E             PIC X.
  5489         16  AM-RETRO-CLMS-P-I             PIC X.
  5490         16  AM-RETRO-RET-BRACKET-LF.
  5491             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5492                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5493                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5494             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5495                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5496                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5497             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5498                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5499                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5500         16  AM-RETRO-RET-BRACKET-AH.
  5501             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5502                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5503                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5504                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5505             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5506                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5507                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5508             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5509                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5510                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5511
  5512     12  AM-COMMENTS.
  5513         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5514
  5515     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5516         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5517         16  AM-FLI-BILLING-CODE           PIC X.
  5518         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5519         16  AM-FLI-UNITED-IDENT           PIC X.
  5520         16  AM-FLI-INTEREST-LOST-DATA.
  5521             20  AM-FLI-BANK-NO            PIC X(5).
  5522             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5523             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5524             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 105
* EL152.cbl
  5525         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5526             20  AM-FLI-AGT                PIC X(9).
  5527             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5528             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5529         16  FILLER                        PIC X(102).
  5530
  5531     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5532         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5533             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5534             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5535             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5536             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5537             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5538         16  FILLER                          PIC X(10).
  5539******************************************************************
  5540
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 106
* EL152.cbl
  5542*                                COPY ELCTEXT.
  5543******************************************************************
  5544*                                                                *
  5545*                                                                *
  5546*                            ELCTEXT.                            *
  5547*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5548*                            VMOD=2.008                          *
  5549*                                                                *
  5550*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5551*                                     FORM LETTERS,              *
  5552*                                     CERT FORM DISPLAY.
  5553*                                                                *
  5554*   FILE TYPE = VSAM,KSDS                                        *
  5555*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5556*                                                                *
  5557*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5558*       ALTERNATE INDEX = NONE                                   *
  5559*                                                                *
  5560*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5561*       ALTERNATE INDEX = NONE                                   *
  5562*                                                                *
  5563*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5564*       ALTERNATE INDEX = NONE                                   *
  5565*                                                                *
  5566*   LOG = NO                                                     *
  5567*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5568******************************************************************
  5569 01  TEXT-FILES.
  5570     12  TEXT-FILE-ID                PIC XX.
  5571         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5572         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5573         88  HELP-FILE-TEXT             VALUE 'TH'.
  5574
  5575     12  TX-CONTROL-PRIMARY.
  5576         16  TX-COMPANY-CD           PIC X.
  5577             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5578         16  TX-ACCESS-CD-GENL       PIC X(12).
  5579
  5580         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5581             20  TX-LETTER-NO        PIC X(4).
  5582             20  FILLER              PIC X(8).
  5583
  5584         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5585             20  TX-FORM-NO          PIC X(12).
  5586
  5587         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5588             20  TX-HELP-TYPE        PIC X.
  5589                 88  HELP-FOR-GENERAL   VALUE ' '.
  5590                 88  HELP-BY-SCREEN     VALUE 'S'.
  5591                 88  HELP-BY-ERROR      VALUE 'E'.
  5592             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5593                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5594             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5595                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5596             20  FILLER              PIC X(4).
  5597
  5598         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5599
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 107
* EL152.cbl
  5600     12  TX-PROCESS-CONTROL          PIC XX.
  5601         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5602
  5603     12  TX-TEXT-LINE                PIC X(70).
  5604
  5605     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5606         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5607         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5608         88  TX-VALID-FORM-SQUEEZE-VALUE
  5609                                        VALUE 'Y' ' '.
  5610
  5611     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5612         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5613         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5614         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5615         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5616         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5617         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5618         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5619                                              'K' 'N' ' '
  5620                                              'Z'.
  5621
  5622     12  TX-ARCHIVE-SW               PIC X.
  5623         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5624         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5625         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5626
  5627     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5628     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5629
  5630     12  TX-BSR-CODE                 PIC X.
  5631         88  TX-BSR-LETTER              VALUE 'B'.
  5632         88  TX-NON-BSR-LETTER          VALUE ' '.
  5633
  5634     12  FILLER                      PIC X.
  5635*****************************************************************
  5636
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 108
* EL152.cbl
  5638*                                COPY ELCTRLR.
  5639******************************************************************
  5640*                                                                *
  5641*                            ELCTRLR.                            *
  5642*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5643*                            VMOD=2.014                          *
  5644*                                                                *
  5645*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5646*                                                                *
  5647*   FILE TYPE = VSAM,KSDS                                        *
  5648*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5649*                                                                *
  5650*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5651*       ALTERNATE INDEX = NONE                                   *
  5652*                                                                *
  5653*   LOG = YES                                                    *
  5654*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5655******************************************************************
  5656*                   C H A N G E   L O G
  5657*
  5658* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5659*-----------------------------------------------------------------
  5660*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5661* EFFECTIVE    NUMBER
  5662*-----------------------------------------------------------------
  5663* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5664* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5665* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5666* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5667* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5668* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5669* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5670* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5671* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5672* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5673* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5674* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5675******************************************************************
  5676 01  ACTIVITY-TRAILERS.
  5677     12  AT-RECORD-ID                    PIC XX.
  5678         88  VALID-AT-ID                       VALUE 'AT'.
  5679
  5680     12  AT-CONTROL-PRIMARY.
  5681         16  AT-COMPANY-CD               PIC X.
  5682         16  AT-CARRIER                  PIC X.
  5683         16  AT-CLAIM-NO                 PIC X(7).
  5684         16  AT-CERT-NO.
  5685             20  AT-CERT-PRIME           PIC X(10).
  5686             20  AT-CERT-SFX             PIC X.
  5687         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5688             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5689             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5690             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5691             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5692             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5693             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5694             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5695             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 109
* EL152.cbl
  5696             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5697             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5698             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5699             88  AT-BENEFICIARY-TRL           VALUE +91.
  5700             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5701
  5702     12  AT-TRAILER-TYPE                 PIC X.
  5703         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5704         88  PAYMENT-TR                       VALUE '2'.
  5705         88  AUTO-PAY-TR                      VALUE '3'.
  5706         88  CORRESPONDENCE-TR                VALUE '4'.
  5707         88  ADDRESS-TR                       VALUE '5'.
  5708         88  GENERAL-INFO-TR                  VALUE '6'.
  5709         88  AUTO-PROMPT-TR                   VALUE '7'.
  5710         88  DENIAL-TR                        VALUE '8'.
  5711         88  INCURRED-CHG-TR                  VALUE '9'.
  5712         88  FORM-CONTROL-TR                  VALUE 'A'.
  5713
  5714     12  AT-RECORDED-DT                  PIC XX.
  5715     12  AT-RECORDED-BY                  PIC X(4).
  5716     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5717
  5718     12  AT-TRAILER-BODY                 PIC X(165).
  5719
  5720     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5721         16  AT-RESERVE-CONTROLS.
  5722             20  AT-MANUAL-SW            PIC X.
  5723                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5724             20  AT-FUTURE-SW            PIC X.
  5725                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5726             20  AT-PTC-SW               PIC X.
  5727                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5728             20  AT-IBNR-SW              PIC X.
  5729                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5730             20  AT-PTC-LF-SW            PIC X.
  5731                 88  AT-LF-PTC-USED          VALUE '1'.
  5732             20  AT-CDT-ACCESS-METHOD    PIC X.
  5733                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5734                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5735                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5736             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5737         16  AT-LAST-COMPUTED-DT         PIC XX.
  5738         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5739         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5740         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5741         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5742         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5743         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5744         16  AT-EXPENSE-CONTROLS.
  5745             20  AT-EXPENSE-METHOD       PIC X.
  5746                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5747                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5748                 88  PERCENT-OF-PMT           VALUE '3'.
  5749                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5750             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5751             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5752         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5753         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 110
* EL152.cbl
  5754
  5755         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5756         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5757
  5758*        16  FILLER                      PIC X(53).
  5759         16  FILLER                      PIC X(47).
  5760
  5761         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5762         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5763
  5764         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5765             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5766             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5767*                    C = CLOSED
  5768*                    O = OPEN
  5769             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5770*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5771
  5772     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5773         16  AT-PAYMENT-TYPE             PIC X.
  5774             88  PARTIAL-PAYMENT                VALUE '1'.
  5775             88  FINAL-PAYMENT                  VALUE '2'.
  5776             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5777             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5778             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5779             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5780             88  VOIDED-PAYMENT                 VALUE '9'.
  5781             88  TRANSFER                       VALUE 'T'.
  5782             88  LIFE-INTEREST                  VALUE 'I'.
  5783
  5784         16  AT-CLAIM-TYPE               PIC X.
  5785             88  PAID-FOR-AH                    VALUE 'A'.
  5786             88  PAID-FOR-LIFE                  VALUE 'L'.
  5787             88  PAID-FOR-IUI                   VALUE 'I'.
  5788             88  PAID-FOR-GAP                   VALUE 'G'.
  5789         16  AT-CLAIM-PREM-TYPE          PIC X.
  5790             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5791             88  AT-O-B-COVERAGE                VALUE '2'.
  5792             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5793         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5794         16  AT-CHECK-NO                 PIC X(7).
  5795         16  AT-PAID-FROM-DT             PIC XX.
  5796         16  AT-PAID-THRU-DT             PIC XX.
  5797         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5798         16  FILLER                      PIC X.
  5799         16  AT-PAYEES-NAME              PIC X(30).
  5800         16  AT-PAYMENT-ORIGIN           PIC X.
  5801             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5802             88  ONLINE-AUTO-PMT                VALUE '2'.
  5803             88  OFFLINE-PMT                    VALUE '3'.
  5804         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5805         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5806         16  AT-VOID-DATA.
  5807             20  AT-VOID-DT              PIC XX.
  5808*00144       20  AT-VOID-REASON          PIC X(30).
  5809             20  AT-VOID-REASON          PIC X(26).
  5810         16  AT-PMT-APPROVED-BY          PIC X(04).
  5811         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 111
* EL152.cbl
  5812         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5813         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5814                                         PIC S99V9(5)  COMP-3.
  5815         16  AT-CREDIT-INTERFACE.
  5816             20  AT-PMT-SELECT-DT        PIC XX.
  5817                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5818             20  AT-PMT-ACCEPT-DT        PIC XX.
  5819                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5820             20  AT-VOID-SELECT-DT       PIC XX.
  5821                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5822             20  AT-VOID-ACCEPT-DT       PIC XX.
  5823                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5824
  5825         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5826                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5827                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5828         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5829
  5830         16  AT-FORCE-CONTROL            PIC X.
  5831             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5832         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5833         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5834         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5835         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5836         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5837         16  AT-BENEFIT-TYPE             PIC X.
  5838
  5839         16  AT-EXPENSE-TYPE             PIC X.
  5840         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5841
  5842         16  AT-PAYEE-TYPE-CD.
  5843             20  AT-PAYEE-TYPE           PIC X.
  5844                 88  INSURED-PAID           VALUE 'I'.
  5845                 88  BENEFICIARY-PAID       VALUE 'B'.
  5846                 88  ACCOUNT-PAID           VALUE 'A'.
  5847                 88  OTHER-1-PAID           VALUE 'O'.
  5848                 88  OTHER-2-PAID           VALUE 'Q'.
  5849                 88  DOCTOR-PAID            VALUE 'P'.
  5850                 88  EMPLOYER-PAID          VALUE 'E'.
  5851             20  AT-PAYEE-SEQ            PIC X.
  5852
  5853         16  AT-CASH-PAYMENT             PIC X.
  5854         16  AT-GROUPED-PAYMENT          PIC X.
  5855         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5856         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5857         16  AT-APPROVED-LEVEL           PIC X.
  5858         16  AT-VOID-TYPE                PIC X.
  5859             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5860             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5861         16  AT-AIG-UNEMP-IND            PIC X.
  5862             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5863         16  AT-ASSOCIATES               PIC X.
  5864             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5865             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5866
  5867         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5868         16  AT-CV-PMT-CODE              PIC X.
  5869             88  FULL-DEATH-PAYMENT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 112
* EL152.cbl
  5870             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5871             88  FULL-ADD-PAYMENT           VALUE '3'.
  5872             88  HALF-ADD-PAYMENT           VALUE '4'.
  5873             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5874             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5875             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5876             88  ADDL-PAYMENT               VALUE '8'.
  5877
  5878         16  AT-EOB-CODE1                PIC XXX.
  5879         16  AT-EOB-CODE2                PIC XXX.
  5880         16  AT-EOB-CODE3                PIC XXX.
  5881         16  AT-EOB-CODE4                PIC XXX.
  5882         16  FILLER REDEFINES AT-EOB-CODE4.
  5883             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5884             20  FILLER                  PIC X.
  5885         16  AT-EOB-CODE5                PIC XXX.
  5886         16  FILLER REDEFINES AT-EOB-CODE5.
  5887             20  AT-PMT-PROOF-DT         PIC XX.
  5888             20  FILLER                  PIC X.
  5889
  5890         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5891             88  AT-PRINT-EOB            VALUE 'Y'.
  5892
  5893         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5894         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5895
  5896     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5897         16  AT-SCHEDULE-START-DT        PIC XX.
  5898         16  AT-SCHEDULE-END-DT          PIC XX.
  5899         16  AT-TERMINATED-DT            PIC XX.
  5900         16  AT-LAST-PMT-TYPE            PIC X.
  5901             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5902             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5903         16  AT-FIRST-PMT-DATA.
  5904             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5905             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5906             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5907         16  AT-REGULAR-PMT-DATA.
  5908             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5909             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5910             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5911         16  AT-AUTO-PAYEE-CD.
  5912             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5913                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5914                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5915                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5916                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5917                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5918             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5919         16  AT-AUTO-PAY-DAY             PIC 99.
  5920         16  AT-AUTO-CASH                PIC X.
  5921             88  AT-CASH                      VALUE 'Y'.
  5922             88  AT-NON-CASH                  VALUE 'N'.
  5923*        16  FILLER                      PIC X(129).
  5924         16  AT-AUTO-END-LETTER          PIC X(4).
  5925         16  FILLER                      PIC X(125).
  5926
  5927         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 113
* EL152.cbl
  5928         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5929
  5930     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5931         16  AT-LETTER-SENT-DT           PIC XX.
  5932         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5933         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5934         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5935         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5936         16  AT-LETTER-ORIGIN            PIC X.
  5937             88  ONLINE-CREATION              VALUE '1' '3'.
  5938             88  OFFLINE-CREATION             VALUE '2' '4'.
  5939             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5940             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5941         16  AT-STD-LETTER-FORM          PIC X(4).
  5942         16  AT-REASON-TEXT              PIC X(70).
  5943         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5944         16  AT-ADDRESEE-TYPE            PIC X.
  5945              88  INSURED-ADDRESEE            VALUE 'I'.
  5946              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5947              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5948              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5949              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5950              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5951              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5952         16  AT-ADDRESSEE-NAME           PIC X(30).
  5953         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5954         16  AT-RESEND-PRINT-DATE        PIC XX.
  5955         16  AT-CORR-SOL-UNSOL           PIC X.
  5956         16  AT-LETTER-PURGED-DT         PIC XX.
  5957*
  5958*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5959*
  5960         16  AT-CSO-REDEFINITION.
  5961             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5962             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5963             20  AT-LETTER-TO-BENE       PIC X(1).
  5964             20  AT-STOP-LETTER-DT       PIC X(2).
  5965             20  FILLER                  PIC X(19).
  5966*             20  FILLER                  PIC X(27).
  5967             20  AT-CSO-LETTER-STATUS    PIC X.
  5968                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5969                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  5970                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5971             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5972             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5973*
  5974*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5975*
  5976*        16  FILLER                      PIC X(26).
  5977*
  5978*        16  AT-DMD-BSR-CODE             PIC X.
  5979*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  5980*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  5981*
  5982*        16  AT-DMD-LETTER-STATUS        PIC X.
  5983*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  5984*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  5985*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 114
* EL152.cbl
  5986*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  5987*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  5988
  5989         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  5990         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  5991
  5992     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  5993         16  AT-ADDRESS-TYPE             PIC X.
  5994             88  INSURED-ADDRESS               VALUE 'I'.
  5995             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  5996             88  ACCOUNT-ADDRESS               VALUE 'A'.
  5997             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  5998             88  EMPLOYER-ADDRESS              VALUE 'E'.
  5999             88  OTHER-ADDRESS-1               VALUE 'O'.
  6000             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6001         16  AT-MAIL-TO-NAME             PIC X(30).
  6002         16  AT-ADDRESS-LINE-1           PIC X(30).
  6003         16  AT-ADDRESS-LINE-2           PIC X(30).
  6004         16  AT-CITY-STATE.
  6005             20  AT-CITY                 PIC X(28).
  6006             20  AT-STATE                PIC XX.
  6007         16  AT-ZIP.
  6008             20  AT-ZIP-CODE.
  6009                 24  AT-ZIP-1ST          PIC X.
  6010                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6011                 24  FILLER              PIC X(4).
  6012             20  AT-ZIP-PLUS4            PIC X(4).
  6013         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6014             20  AT-CAN-POSTAL-1         PIC XXX.
  6015             20  AT-CAN-POSTAL-2         PIC XXX.
  6016             20  FILLER                  PIC XXX.
  6017         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6018         16  FILLER                      PIC X(23).
  6019         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6020         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6021
  6022     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6023         16  AT-INFO-LINE-1              PIC X(60).
  6024         16  AT-INFO-LINE-2              PIC X(60).
  6025         16  AT-INFO-TRAILER-TYPE        PIC X.
  6026             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6027             88  AT-CALL-NOTE            VALUE 'C'.
  6028             88  AT-MAINT-NOTE           VALUE 'M'.
  6029             88  AT-CERT-CHANGE          VALUE 'X'.
  6030             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6031             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6032         16  AT-CALL-TYPE                PIC X.
  6033             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6034             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6035         16  AT-NOTE-CONTINUATION        PIC X.
  6036             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6037         16  AT-EOB-CODES-EXIST          PIC X.
  6038             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6039         16  FILLER                      PIC X(35).
  6040         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6041         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6042
  6043     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 115
* EL152.cbl
  6044         16  AT-PROMPT-LINE-1            PIC X(60).
  6045         16  AT-PROMPT-LINE-2            PIC X(60).
  6046         16  AT-PROMPT-START-DT          PIC XX.
  6047         16  AT-PROMPT-END-DT            PIC XX.
  6048         16  FILLER                      PIC X(35).
  6049         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6050         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6051
  6052     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6053         16  AT-DENIAL-INFO-1            PIC X(60).
  6054         16  AT-DENIAL-INFO-2            PIC X(60).
  6055         16  AT-DENIAL-DT                PIC XX.
  6056         16  AT-RETRACTION-DT            PIC XX.
  6057         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6058*         16  FILLER                      PIC X(31).
  6059         16  AT-DENIAL-PROOF-DT          PIC XX.
  6060         16  FILLER                      PIC X(29).
  6061         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6062         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6063
  6064     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6065         16  AT-OLD-INCURRED-DT          PIC XX.
  6066         16  AT-OLD-REPORTED-DT          PIC XX.
  6067         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6068         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6069         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6070         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6071         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6072         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6073         16  FILLER                      PIC X(26).
  6074         16  AT-OLD-DIAG-CODE            PIC X(6).
  6075         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6076         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6077         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6078         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6079         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6080         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6081         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6082         16  FILLER                      PIC X(25).
  6083         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6084
  6085     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6086         16  AT-FORM-SEND-ON-DT          PIC XX.
  6087         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6088         16  AT-FORM-RE-SEND-DT          PIC XX.
  6089         16  AT-FORM-ANSWERED-DT         PIC XX.
  6090         16  AT-FORM-PRINTED-DT          PIC XX.
  6091         16  AT-FORM-REPRINT-DT          PIC XX.
  6092         16  AT-FORM-TYPE                PIC X.
  6093             88  INITIAL-FORM                  VALUE '1'.
  6094             88  PROGRESS-FORM                 VALUE '2'.
  6095         16  AT-INSTRUCT-LN-1            PIC X(28).
  6096         16  AT-INSTRUCT-LN-2            PIC X(28).
  6097         16  AT-INSTRUCT-LN-3            PIC X(28).
  6098         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6099         16  AT-FORM-ADDRESS             PIC X.
  6100             88  FORM-TO-INSURED              VALUE 'I'.
  6101             88  FORM-TO-ACCOUNT              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 116
* EL152.cbl
  6102             88  FORM-TO-OTHER-1              VALUE 'O'.
  6103             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6104         16  AT-RELATED-1.
  6105             20 AT-REL-CARR-1            PIC X.
  6106             20 AT-REL-CLAIM-1           PIC X(7).
  6107             20 AT-REL-CERT-1            PIC X(11).
  6108         16  AT-RELATED-2.
  6109             20 AT-REL-CARR-2            PIC X.
  6110             20 AT-REL-CLAIM-2           PIC X(7).
  6111             20 AT-REL-CERT-2            PIC X(11).
  6112         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6113         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6114         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6115         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6116         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6117         16  AT-STOP-FORM-DT             PIC X(2).
  6118
  6119         16  FILLER                      PIC X(09).
  6120         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6121         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6122******************************************************************
  6123
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 117
* EL152.cbl
  6125*                                COPY ELCBENE.
  6126******************************************************************
  6127*                                                                *
  6128*                            ELCBENE.                            *
  6129*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6130*                            VMOD=2.006                          *
  6131*                                                                *
  6132*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6133*                                                                *
  6134*   FILE TYPE = VSAM,KSDS                                        *
  6135*   RECORD SIZE = 500   RECFORM = FIX                            *
  6136*                                                                *
  6137*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6138*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6139*                                                                *
  6140*   LOG = YES                                                    *
  6141*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6142*                                                                *
  6143*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6144******************************************************************
  6145
  6146 01  BENEFICIARY-MASTER.
  6147     12  BE-RECORD-ID                PIC XX.
  6148         88  VALID-BE-ID                VALUE 'BE'.
  6149
  6150     12  BE-CONTROL-PRIMARY.
  6151         16  BE-COMPANY-CD           PIC X.
  6152         16  BE-RECORD-TYPE          PIC X.
  6153             88  BENEFICIARY-RECORD  VALUE 'B'.
  6154             88  ADJUSTOR-RECORD     VALUE 'A'.
  6155         16  BE-BENEFICIARY          PIC X(10).
  6156     12  BE-CONTROL-BY-NAME.
  6157         16  BE-COMPANY-CD-A1        PIC X.
  6158         16  BE-RECORD-TYPE-A1       PIC X.
  6159         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6160         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6161
  6162     12  BE-LAST-MAINT-DT            PIC XX.
  6163     12  BE-LAST-MAINT-BY            PIC X(4).
  6164     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6165
  6166     12  BE-ADDRESS-DATA.
  6167         16  BE-MAIL-TO-NAME         PIC X(30).
  6168         16  BE-ADDRESS-LINE-1       PIC X(30).
  6169         16  BE-ADDRESS-LINE-2       PIC X(30).
  6170         16  BE-ADDRESS-LINE-3       PIC X(30).
  6171         16  BE-CITY-STATE.
  6172             20  BE-CITY             PIC X(28).
  6173             20  BE-STATE            PIC XX.
  6174         16  BE-ZIP-CODE.
  6175             20  BE-ZIP-PRIME.
  6176                 24  BE-ZIP-1ST      PIC X.
  6177                     88  BE-CANADIAN-POST-CODE
  6178                                         VALUE 'A' THRU 'Z'.
  6179                 24  FILLER          PIC X(4).
  6180             20  BE-ZIP-PLUS4        PIC X(4).
  6181         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6182             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 118
* EL152.cbl
  6183             20  BE-CAN-POSTAL-2     PIC XXX.
  6184             20  FILLER              PIC XXX.
  6185         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6186         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6187
  6188******************************************************************
  6189*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6190*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6191******************************************************************
  6192     12  BE-CARRIER                  PIC X.
  6193
  6194     12  BE-ADDRESS-DATA2.
  6195         16  BE-MAIL-TO-NAME2        PIC X(30).
  6196         16  BE-ADDRESS-LINE-12      PIC X(30).
  6197         16  BE-ADDRESS-LINE-22      PIC X(30).
  6198         16  BE-ADDRESS-LINE-32      PIC X(30).
  6199         16  BE-CITY-STATE2.
  6200             20  BE-CITY2            PIC X(28).
  6201             20  BE-STATE2           PIC XX.
  6202         16  BE-ZIP-CODE2.
  6203             20  BE-ZIP-PRIME2.
  6204                 24  BE-ZIP-1ST2     PIC X.
  6205                     88  BE-CANADIAN-POST-CODE2
  6206                                         VALUE 'A' THRU 'Z'.
  6207                 24  FILLER          PIC X(4).
  6208             20  BE-ZIP-PLUS42       PIC X(4).
  6209         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6210             20  BE-CAN-POSTAL-12    PIC XXX.
  6211             20  BE-CAN-POSTAL-22    PIC XXX.
  6212             20  FILLER              PIC XXX.
  6213         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6214         16  BE-BILLING-STMT-DATA.
  6215             20  BE-BSR              PIC X.
  6216                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6217                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6218             20  BE-BSR-FROM         PIC X(30).
  6219             20  BE-BSR-DEPT         PIC X(30).
  6220             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6221             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6222             20  BE-OUTPUT-TYPE      PIC X.
  6223                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6224                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6225
  6226     12  FILLER                      PIC X(28).
  6227******************************************************************
  6228
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 119
* EL152.cbl
  6230*                                COPY ERCCOMP.
  6231******************************************************************
  6232*                                                                *
  6233*                                                                *
  6234*                            ERCCOMP                             *
  6235*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6236*                            VMOD=2.019                          *
  6237*                                                                *
  6238*   ONLINE CREDIT SYSTEM                                         *
  6239*                                                                *
  6240*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6241*                                                                *
  6242*   FILE TYPE = VSAM,KSDS                                        *
  6243*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6244*                                                                *
  6245*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6246*       ALTERNATE PATH = NONE                                    *
  6247*                                                                *
  6248*   LOG = NO                                                     *
  6249*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6250*                                                                *
  6251******************************************************************
  6252*                   C H A N G E   L O G
  6253*
  6254* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6255*-----------------------------------------------------------------
  6256*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6257* EFFECTIVE    NUMBER
  6258*-----------------------------------------------------------------
  6259* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6260* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6261* 092205    2005050300006  PEMA  ADD LEASE FEE
  6262* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6263* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6264* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6265* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6266* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6267******************************************************************
  6268
  6269 01  COMPENSATION-MASTER.
  6270     12  CO-RECORD-ID                          PIC XX.
  6271         88  VALID-CO-ID                          VALUE 'CO'.
  6272
  6273     12  CO-CONTROL-PRIMARY.
  6274         16  CO-COMPANY-CD                     PIC X.
  6275         16  CO-CONTROL.
  6276             20  CO-CTL-1.
  6277                 24  CO-CARR-GROUP.
  6278                     28  CO-CARRIER            PIC X.
  6279                     28  CO-GROUPING.
  6280                         32  CO-GROUP-PREFIX   PIC XXX.
  6281                         32  CO-GROUP-PRIME    PIC XXX.
  6282                 24  CO-RESP-NO.
  6283                     28  CO-RESP-PREFIX        PIC X(4).
  6284                     28  CO-RESP-PRIME         PIC X(6).
  6285             20  CO-CTL-2.
  6286                 24  CO-ACCOUNT.
  6287                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 120
* EL152.cbl
  6288                     28  CO-ACCT-PRIME         PIC X(6).
  6289         16  CO-TYPE                           PIC X.
  6290             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6291             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6292             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6293
  6294     12  CO-MAINT-INFORMATION.
  6295         16  CO-LAST-MAINT-DT                  PIC XX.
  6296         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6297         16  CO-LAST-MAINT-USER                PIC X(4).
  6298     12  FILLER                                PIC XX.
  6299     12  CO-STMT-TYPE                          PIC XXX.
  6300     12  CO-COMP-TYPE                          PIC X.
  6301         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6302     12  CO-STMT-OWNER                         PIC X(4).
  6303     12  CO-BALANCE-CONTROL                    PIC X.
  6304         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6305         88  CO-NO-BALANCE                        VALUE 'N'.
  6306
  6307     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6308         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6309         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6310         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6311
  6312     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6313         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6314         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6315
  6316     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6317     12  CO-GA-DIRECT-DEP                      PIC X.
  6318     12  CO-FUTURE-SPACE                       PIC X.
  6319         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6320
  6321     12  CO-ACCT-NAME                          PIC X(30).
  6322     12  CO-MAIL-NAME                          PIC X(30).
  6323     12  CO-ADDR-1                             PIC X(30).
  6324     12  CO-ADDR-2                             PIC X(30).
  6325     12  CO-ADDR-3.
  6326         16  CO-ADDR-CITY                      PIC X(27).
  6327         16  CO-ADDR-STATE                     PIC XX.
  6328     12  CO-CSO-1099                           PIC X.
  6329     12  CO-ZIP.
  6330         16  CO-ZIP-PRIME.
  6331             20  CO-ZIP-PRI-1ST                PIC X.
  6332                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6333             20  FILLER                        PIC X(4).
  6334         16  CO-ZIP-PLUS4                      PIC X(4).
  6335     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6336         16  CO-CAN-POSTAL-1                   PIC XXX.
  6337         16  CO-CAN-POSTAL-2                   PIC XXX.
  6338         16  FILLER                            PIC XXX.
  6339     12  CO-SOC-SEC                            PIC X(13).
  6340     12  CO-TELEPHONE.
  6341         16  CO-AREA-CODE                      PIC XXX.
  6342         16  CO-PREFIX                         PIC XXX.
  6343         16  CO-PHONE                          PIC X(4).
  6344
  6345     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 121
* EL152.cbl
  6346
  6347     12  CO-AR-BAL-LEVEL                       PIC X.
  6348         88  CO-AR-REF-LVL                        VALUE '1'.
  6349         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6350         88  CO-AR-BILL-LVL                       VALUE '2'.
  6351         88  CO-AR-AGT-LVL                        VALUE '3'.
  6352         88  CO-AR-FR-LVL                         VALUE '4'.
  6353
  6354     12  CO-AR-NORMAL-PRINT                    PIC X.
  6355         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6356         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6357
  6358     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6359
  6360     12  CO-AR-REPORTING                       PIC X.
  6361         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6362         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6363
  6364     12  CO-AR-PULL-CHECK                      PIC X.
  6365         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6366         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6367
  6368     12  CO-AR-BALANCE-PRINT                   PIC X.
  6369         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6370
  6371     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6372         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6373         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6374         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6375
  6376     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6377
  6378     12  CO-USER-CODE                          PIC X.
  6379     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6380
  6381******************************************************************
  6382*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6383*    THE LAST MONTH END RUN.
  6384******************************************************************
  6385
  6386     12  CO-LAST-ACTIVITY-DATE.
  6387         16  CO-ACT-YEAR                       PIC 99.
  6388         16  CO-ACT-MONTH                      PIC 99.
  6389         16  CO-ACT-DAY                        PIC 99.
  6390
  6391     12  CO-LAST-STMT-DT.
  6392         16  CO-LAST-STMT-YEAR                 PIC 99.
  6393         16  CO-LAST-STMT-MONTH                PIC 99.
  6394         16  CO-LAST-STMT-DAY                  PIC 99.
  6395
  6396     12  CO-MO-END-TOTALS.
  6397         16  CO-MONTHLY-TOTALS.
  6398             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6399             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6400             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6401             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6402             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  6403
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 122
* EL152.cbl
  6404         16  CO-AGING-TOTALS.
  6405             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6406             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6407             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6408             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6409
  6410         16  CO-YTD-TOTALS.
  6411             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6412             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6413
  6414         16  CO-OVER-UNDER-TOTALS.
  6415             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6416             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6417
  6418     12  CO-MISCELLANEOUS-TOTALS.
  6419         16  CO-FICA-TOTALS.
  6420             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6421             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6422
  6423         16  CO-CLAIM-TOTALS.
  6424             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6425             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6426
  6427******************************************************************
  6428*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6429*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6430******************************************************************
  6431
  6432     12  CO-CURRENT-TOTALS.
  6433         16  CO-CURRENT-LAST-STMT-DT.
  6434             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6435             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6436             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6437
  6438         16  CO-CURRENT-MONTHLY-TOTALS.
  6439             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6440             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6441             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6442             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6443             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6444
  6445         16  CO-CURRENT-AGING-TOTALS.
  6446             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6447             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6448             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6449             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6450
  6451         16  CO-CURRENT-YTD-TOTALS.
  6452             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6453             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6454
  6455     12  CO-PAID-COMM-TOTALS.
  6456         16  CO-YTD-PAID-COMMS.
  6457             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6458             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6459
  6460     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  6461         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 123
* EL152.cbl
  6462         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6463
  6464     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6465         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6466         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6467         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6468         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6469         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6470         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6471         88  CO-FINAL-LETTER                  VALUE 'F'.
  6472         88  CO-RECONCILING                   VALUE 'R'.
  6473         88  CO-PHONE-CALL                    VALUE 'P'.
  6474         88  CO-LEGAL                         VALUE 'L'.
  6475         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6476         88  CO-WRITE-OFF                     VALUE 'W'.
  6477         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6478
  6479     12  CO-CSR-CODE                       PIC X(4).
  6480
  6481     12  CO-GA-STATUS-INFO.
  6482         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6483         16  CO-GA-TERMINATION-DT          PIC XX.
  6484         16  CO-GA-STATUS-CODE             PIC X.
  6485             88  CO-GA-ACTIVE                 VALUE 'A'.
  6486             88  CO-GA-INACTIVE               VALUE 'I'.
  6487             88  CO-GA-PENDING                VALUE 'P'.
  6488         16  CO-GA-COMMENTS.
  6489             20  CO-GA-COMMENT-1           PIC X(40).
  6490             20  CO-GA-COMMENT-2           PIC X(40).
  6491             20  CO-GA-COMMENT-3           PIC X(40).
  6492             20  CO-GA-COMMENT-4           PIC X(40).
  6493
  6494     12  CO-RPTCD2                         PIC X(10).
  6495
  6496     12  CO-TYPE-AGENT                     PIC X(01).
  6497         88  CO-CORPORATION                   VALUE 'C'.
  6498         88  CO-PARTNERSHIP                   VALUE 'P'.
  6499         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6500         88  CO-TRUST                         VALUE 'T'.
  6501         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6502
  6503     12  CO-FAXNO.
  6504         16  CO-FAX-AREA-CODE                  PIC XXX.
  6505         16  CO-FAX-PREFIX                     PIC XXX.
  6506         16  CO-FAX-PHONE                      PIC X(4).
  6507
  6508     12  CO-BANK-INFORMATION.
  6509         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6510         16  CO-BANK-TRANSIT-NON REDEFINES
  6511             CO-BANK-TRANSIT-NO                PIC 9(8).
  6512
  6513         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6514     12  CO-MISC-DEDUCT-INFO REDEFINES
  6515                  CO-BANK-INFORMATION.
  6516         16  CO-MD-GL-ACCT                     PIC X(10).
  6517         16  CO-MD-DIV                         PIC XX.
  6518         16  CO-MD-CENTER                      PIC X(4).
  6519         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 124
* EL152.cbl
  6520         16  CO-CREATE-AP-CHECK                PIC X.
  6521         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6522         16  FILLER                            PIC XXX.
  6523     12  CO-ACH-STATUS                         PIC X.
  6524         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6525         88  CO-ACH-PENDING                        VALUE 'P'.
  6526
  6527     12  CO-BILL-SW                            PIC X.
  6528     12  CO-CONTROL-NAME                       PIC X(30).
  6529     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6530     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6531     12  CO-CLP-STATE                          PIC XX.
  6532     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6533     12  CO-SPP-REFUND-EDIT                    PIC X.
  6534
  6535******************************************************************
  6536
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 125
* EL152.cbl
  6538*                                COPY MPCPROD.
  6539*    EJECT
  6540*                                COPY MPCPLCY.
  6541*    EJECT
  6542*                                COPY MPCPLAN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 126
* EL152.cbl
  6544*                                COPY ELCNAPS.
  6545******************************************************************
  6546*                                                                *
  6547*                            ELCNAPS                             *
  6548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6549*                            VMOD=2.003                          *
  6550*                                                                *
  6551*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  6552*                                                                *
  6553*        FILE TYPE= VSAM,KSDS                                    *
  6554*        RECORD SIZE = 150    RECFORM = FIXED                    *
  6555*                                                                *
  6556*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  6557*                                                                *
  6558*        LOG = YES                                               *
  6559*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6560*                                                                *
  6561******************************************************************
  6562*                   C H A N G E   L O G
  6563*
  6564* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6565*-----------------------------------------------------------------
  6566*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6567* EFFECTIVE    NUMBER
  6568*-----------------------------------------------------------------
  6569* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  6570******************************************************************
  6571
  6572 01  NAPERSOFT-FILE.
  6573     12  NA-RECORD-ID                PIC  XX.
  6574         88  VALID-NA-ID                  VALUE 'NA'.
  6575
  6576     12  NA-CONTROL-PRIMARY.
  6577         16  NA-COMPANY-CD           PIC X.
  6578         16  NA-CARRIER              PIC X.
  6579         16  NA-CLAIM-NO             PIC X(7).
  6580         16  NA-CERT-NO.
  6581             20  NA-CERT-PRIME       PIC X(10).
  6582             20  NA-CERT-SFX         PIC X.
  6583         16  NA-ARCHIVE-NO           PIC 9(8).
  6584
  6585     12  NA-LETTER-INFORMATION.
  6586         16  NA-LETTER-ID            PIC X(4).
  6587         16  NA-PROCESSOR-ID         PIC X(4).
  6588         16  NA-CREATION-DT          PIC X(2).
  6589         16  NA-INITIAL-PRINT-DT     PIC X(2).
  6590         16  NA-FOLLOW-UP-DT         PIC X(2).
  6591         16  NA-RESEND-DT            PIC X(2).
  6592         16  NA-RESEND-LETTER-ID     PIC X(4).
  6593         16  NA-NO-OF-COPIES         PIC 9(2).
  6594         16  NA-ADDRESS-TYPE         PIC X(2).
  6595         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  6596         16  NA-RESEND-PRINT-DT      PIC X(2).
  6597         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  6598         16  NA-NEXT-DUE-DT          PIC X(2).
  6599         16  NA-AUTOPYDT             PIC X(2).
  6600         16  NA-ENCLOSURE-CD         PIC X(3).
  6601         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 127
* EL152.cbl
  6602         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  6603         16  NA-RESEND-PROMPT-IND    PIC X(1).
  6604         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  6605         16  FILLER                  PIC X(67).
  6606******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 128
* EL152.cbl
  6608*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  6609*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  6610
  6611*01  SYSTEM-VARIABLES            PIC X(3851).
  6612*01  SYS-VAR-ENTRY REDEFINES SYSTEM-VARIABLES.
  6613*    12  SYS-VAR-CODE            PIC X(4).
  6614*    12  SYS-VAR-LEN             PIC 99.
  6615*    12  SYS-VAR-DATA            PIC X(100).
  6616
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 129
* EL152.cbl
  6618 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CLAIM-MASTER
  6619                          CONTROL-FILE LETTER-ARCHIVE
  6620                          LETTER-ARCHIVE-TEMP
  6621                          CERTIFICATE-MASTER ACCOUNT-MASTER
  6622                          TEXT-FILES ACTIVITY-TRAILERS
  6623                          BENEFICIARY-MASTER
  6624                          COMPENSATION-MASTER NAPERSOFT-FILE.
  6625 0000-DFHEXIT SECTION.
  6626     MOVE '9#                    $   ' TO DFHEIV0.
  6627     MOVE 'EL152' TO DFHEIV1.
  6628     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6629
  6630     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6631     MOVE '5'                   TO DC-OPTION-CODE.
  6632     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  6633     MOVE DC-GREG-DATE-1-EDIT   TO SAVE-DATE.
  6634     MOVE DC-BIN-DATE-1         TO SAVE-BIN-DATE.
  6635
  6636     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  6637     MOVE 1                     TO EMI-NUMBER-OF-LINES.
  6638     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  6639                                TO EMI-SAVE-AREA.
  6640
  6641     MOVE EIBTRMID              TO TS-TERM-TEXT
  6642                                   TS-TERM-SCREEN
  6643                                   QID-TERM.
  6644
  6645     MOVE SAVE-BIN-DATE       TO CURRENT-SAVE.
  6646
  6647*    IF PI-COMPANY-ID = 'DMD'
  6648*       MOVE CURRENT-SAVE           TO DC-BIN-DATE-1
  6649*       MOVE '6'                    TO DC-OPTION-CODE
  6650*       MOVE +3                     TO DC-ELAPSED-MONTHS
  6651*       MOVE +0                     TO DC-ELAPSED-DAYS
  6652*       PERFORM 9700-DATE-LINK THRU 9700-EXIT
  6653*       MOVE DC-BIN-DATE-2          TO CURRENT-PLUS3-SAVE.
  6654
  6655
  6656* EXEC CICS HANDLE CONDITION
  6657*        PGMIDERR (9600-PGMID-ERROR)
  6658*        MAPFAIL  (0325-MAPFAIL)
  6659*        ERROR    (9990-ABEND)
  6660*    END-EXEC.
  6661*    MOVE '"$L?.                 ! " #00006651' TO DFHEIV0
  6662     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  6663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6664     MOVE X'2220233030303036363531' TO DFHEIV0(25:11)
  6665     CALL 'kxdfhei1' USING DFHEIV0
  6666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6667
  6668
  6669     IF PI-PROCESSOR-ID NOT = 'LGXX'
  6670
  6671* EXEC CICS READQ TS
  6672*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6673*            INTO    (SECURITY-CONTROL)
  6674*            LENGTH  (SC-COMM-LENGTH)
  6675*            ITEM    (SC-ITEM)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 130
* EL152.cbl
  6676*        END-EXEC
  6677*    MOVE '*$II   L              ''   #00006658' TO DFHEIV0
  6678     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6679     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6680     MOVE X'2020233030303036363538' TO DFHEIV0(25:11)
  6681     CALL 'kxdfhei1' USING DFHEIV0,
  6682           PI-SECURITY-TEMP-STORE-ID,
  6683           SECURITY-CONTROL,
  6684           SC-COMM-LENGTH,
  6685           SC-ITEM,
  6686           DFHEIV99,
  6687           DFHEIV99
  6688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6689         MOVE SC-CLAIMS-DISPLAY (7)  TO  PI-DISPLAY-CAP
  6690         MOVE SC-CLAIMS-UPDATE  (7)  TO  PI-MODIFY-CAP.
  6691
  6692     set P to address of KIXSYS
  6693     CALL "getenv" using by value P returning var-ptr
  6694     if var-ptr = null then
  6695        display ' kixsys not set '
  6696     else
  6697        set address of var to var-ptr
  6698        move 0 to env-var-len
  6699        inspect var tallying env-var-len
  6700          for characters before X'00'
  6701        unstring var (1:env-var-len) delimited by '/'
  6702           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6703              WS-KIX-SYS
  6704        end-unstring
  6705     end-if
  6706     IF EIBCALEN = 0
  6707         GO TO 8800-UNAUTHORIZED-ACCESS.
  6708
  6709     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6710         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6711             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6712             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6713             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6714             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6715             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6716             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6717             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6718             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6719             PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
  6720             PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
  6721             PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
  6722             MOVE SPACES              TO PI-WA
  6723                                         PI-FORCE-7840
  6724             MOVE ZEROS               TO PI-TOTAL-LINES
  6725                                         PI-CURRENT-LINE
  6726                                         PI-TEMP-STOR-ITEMS
  6727                                         PI-UPDATE-SW
  6728                                         PI-ADDR-SEQ
  6729             MOVE '2'                 TO PI-ACTION
  6730             MOVE LOW-VALUES          TO EL152AO
  6731                                         PI-ADDR-TYPE
  6732             GO TO 8100-SEND-INITIAL-MAP
  6733         ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 131
* EL152.cbl
  6734             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  6735             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6736             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6737             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6738             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6739             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6740             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6741             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6742             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6743             PERFORM 7500-READ-TS           THRU 7599-EXIT
  6744             PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT
  6745             IF PGM-NAME = PGM-EL141
  6746                PERFORM 500-RECOVER-PI-TEMP-STORAGE THRU 599-EXIT
  6747                SET TB-INDX TO PI-CURRENT-LINE
  6748                PERFORM 400-SET-CODES       THRU 499-EXIT
  6749                PERFORM 7000-READ-ADDR      THRU 7099-EXIT
  6750                PERFORM 7170-FORMAT-SCREEN  THRU 7170-EXIT
  6751                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6752                        SC-INDX > NUM-LINES-PER-SCREEN
  6753                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6754                MOVE AL-UANON           TO PRINTERA
  6755                GO TO 8100-SEND-INITIAL-MAP
  6756             ELSE
  6757                SET TB-INDX TO PI-CURRENT-LINE
  6758                PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  6759                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6760                        SC-INDX > NUM-LINES-PER-SCREEN
  6761                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6762                MOVE AL-UANON           TO PRINTERA
  6763                GO TO 8100-SEND-INITIAL-MAP.
  6764
  6765*0100-PA.
  6766*    MOVE ER-0008                TO EMI-ERROR.
  6767*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6768*    MOVE -1                     TO MAINTL.
  6769*    GO TO 8200-SEND-DATAONLY.
  6770
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 132
* EL152.cbl
  6772 0200-RECEIVE.
  6773     MOVE TRANS-ID         TO EIBTRNID.
  6774     MOVE EMI-SAVE-AREA    TO ERROR-MESSAGE-INTERFACE-BLOCK.
  6775     MOVE LOW-VALUES       TO EL152AI.
  6776     MOVE '104A'           TO TS-ID-TEXT.
  6777     MOVE EIBTRMID         TO TS-TERM-TEXT
  6778                              TS-TERM-SCREEN
  6779                              QID-TERM.
  6780
  6781
  6782* EXEC CICS HANDLE AID
  6783*        CLEAR    (9400-CLEAR)
  6784*        PA1      (0100-PA)
  6785*        PA2      (0100-PA)
  6786*        PA3      (0100-PA)
  6787*    END-EXEC.
  6788*    MOVE '"&=!"#               V! # #00006756' TO DFHEIV0
  6789     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  6790     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  6791     MOVE X'2320233030303036373536' TO DFHEIV0(25:11)
  6792     CALL 'kxdfhei1' USING DFHEIV0
  6793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6794
  6795
  6796
  6797* EXEC CICS HANDLE CONDITION
  6798*        MAPFAIL  (0325-MAPFAIL)
  6799*    END-EXEC.
  6800*    MOVE '"$?                   ! $ #00006763' TO DFHEIV0
  6801     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6803     MOVE X'2420233030303036373633' TO DFHEIV0(25:11)
  6804     CALL 'kxdfhei1' USING DFHEIV0
  6805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6806
  6807
  6808
  6809* EXEC CICS SYNCPOINT
  6810*    END-EXEC.
  6811*    MOVE '6"                    !   #00006767' TO DFHEIV0
  6812     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  6813     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6814     MOVE X'2020233030303036373637' TO DFHEIV0(25:11)
  6815     CALL 'kxdfhei1' USING DFHEIV0
  6816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6817
  6818
  6819     IF LOWER-CASE-LETTERS-USED
  6820
  6821* EXEC CICS RECEIVE
  6822*            MAP      (MAP-NAME)
  6823*            MAPSET   (MAPSET-NAME)
  6824*            INTO     (EL152AI)
  6825*            ASIS
  6826*       END-EXEC
  6827     MOVE LENGTH OF
  6828      EL152AI
  6829       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 133
* EL152.cbl
  6830*    MOVE '8"TAI  L              ''   #00006771' TO DFHEIV0
  6831     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  6832     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6833     MOVE X'2020233030303036373731' TO DFHEIV0(25:11)
  6834     CALL 'kxdfhei1' USING DFHEIV0,
  6835           MAP-NAME,
  6836           EL152AI,
  6837           DFHEIV11,
  6838           MAPSET-NAME,
  6839           DFHEIV99,
  6840           DFHEIV99
  6841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6842      ELSE
  6843
  6844* EXEC CICS RECEIVE
  6845*            MAP      (MAP-NAME)
  6846*            MAPSET   (MAPSET-NAME)
  6847*            INTO     (EL152AI)
  6848*       END-EXEC.
  6849     MOVE LENGTH OF
  6850      EL152AI
  6851       TO DFHEIV11
  6852*    MOVE '8"T I  L              ''   #00006778' TO DFHEIV0
  6853     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6854     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6855     MOVE X'2020233030303036373738' TO DFHEIV0(25:11)
  6856     CALL 'kxdfhei1' USING DFHEIV0,
  6857           MAP-NAME,
  6858           EL152AI,
  6859           DFHEIV11,
  6860           MAPSET-NAME,
  6861           DFHEIV99,
  6862           DFHEIV99
  6863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6864
  6865
  6866     IF NOT DISPLAY-CAP AND PI-PROCESSOR-ID NOT = 'LGXX'
  6867         MOVE 'READ'             TO  SM-READ
  6868         PERFORM 9995-SECURITY-VIOLATION
  6869         MOVE ER-0070            TO  EMI-ERROR
  6870         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6871         GO TO 8100-SEND-INITIAL-MAP.
  6872
  6873     INSPECT MAINTI CONVERTING LOWER-CASE TO UPPER-CASE.
  6874     MOVE 'N'                    TO CLEANI
  6875
  6876     IF ENTERPFL = 0
  6877         GO TO 0300-CHECK-PFKEYS.
  6878     IF EIBAID NOT = DFHENTER
  6879         MOVE ER-0004            TO EMI-ERROR
  6880         GO TO 0320-INPUT-ERROR.
  6881     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  6882         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  6883     ELSE
  6884         MOVE ER-0029            TO EMI-ERROR
  6885         GO TO 0320-INPUT-ERROR.
  6886
  6887 0300-CHECK-PFKEYS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 134
* EL152.cbl
  6888     IF EIBAID = DFHPF23
  6889         GO TO 8810-PF23.
  6890     IF EIBAID = DFHPF24
  6891         GO TO 9200-RETURN-MAIN-MENU.
  6892*    IF EIBAID = DFHPF12
  6893*        GO TO 9500-PF12.
  6894     IF EIBAID = DFHPF1
  6895         MOVE 7                  TO ROLL-COUNTER
  6896         GO TO 7900-ROLL-PAGE.
  6897     IF EIBAID = DFHPF2
  6898         MOVE -7                 TO ROLL-COUNTER
  6899         GO TO 7900-ROLL-PAGE.
  6900     IF EIBAID = DFHPF3
  6901         GO TO 6100-ADDR-MAINT.
  6902     IF EIBAID = DFHPF4
  6903         IF MODIFY-CAP
  6904             GO TO 6200-EDIT-MODE
  6905         ELSE
  6906             MOVE 'UPDATE'       TO  SM-READ
  6907             PERFORM 9995-SECURITY-VIOLATION
  6908             MOVE ER-0070        TO  EMI-ERROR
  6909             GO TO 0320-INPUT-ERROR.
  6910
  6911     IF EIBAID = DFHPF5
  6912         GO TO 0330-FUNCTION-CHECK.
  6913
  6914     IF EIBAID = DFHPF6
  6915         GO TO 0330-FUNCTION-CHECK.
  6916
  6917     IF EIBAID = DFHPF7
  6918        COMPUTE ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  6919        GO TO 7900-ROLL-PAGE.
  6920
  6921     IF EIBAID = DFHPF8
  6922        MOVE PI-TOTAL-LINES TO ROLL-COUNTER
  6923        GO TO 7900-ROLL-PAGE.
  6924
  6925*    IF EIBAID = DFHPF9 AND
  6926*       PI-COMPANY-ID = 'DMD'
  6927*        MOVE '1'           TO PI-FORCE-7840
  6928*        GO TO 0330-FUNCTION-CHECK.
  6929
  6930     IF EIBAID = DFHENTER
  6931         GO TO 0330-FUNCTION-CHECK.
  6932
  6933     PERFORM 7500-READ-TS        THRU 7599-EXIT
  6934
  6935     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  6936     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  6937             VARYING SC-INDX FROM 1 BY 1
  6938             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  6939
  6940     MOVE ER-0029                TO EMI-ERROR.
  6941 0320-INPUT-ERROR.
  6942     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6943     MOVE AL-UNBON               TO ENTERPFA.
  6944     IF ENTERPFL = 0
  6945         MOVE -1                 TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 135
* EL152.cbl
  6946     ELSE
  6947         MOVE -1                 TO ENTERPFL.
  6948
  6949     GO TO 8200-SEND-DATAONLY.
  6950
  6951 0100-PA.
  6952     MOVE ER-0008                TO EMI-ERROR.
  6953     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6954     MOVE -1                     TO MAINTL.
  6955     GO TO 8200-SEND-DATAONLY.
  6956
  6957 0325-MAPFAIL.
  6958***********************************************************
  6959*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  6960*      LETTERS ON A 3275 PRINTER.                         *
  6961***********************************************************
  6962
  6963     PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT.
  6964
  6965     SET TB-INDX         TO PI-CURRENT-LINE.
  6966     PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  6967                  VARYING SC-INDX FROM 1 BY 1 UNTIL
  6968                  SC-INDX > NUM-LINES-PER-SCREEN.
  6969
  6970     GO TO 8100-SEND-INITIAL-MAP.
  6971
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 136
* EL152.cbl
  6973 0330-FUNCTION-CHECK.
  6974     IF NOT MODIFY-CAP
  6975         IF MAINTI = 'S'
  6976             NEXT SENTENCE
  6977         ELSE
  6978             MOVE 'UPDATE'           TO  SM-READ
  6979             PERFORM 9995-SECURITY-VIOLATION
  6980             MOVE ER-0070            TO  EMI-ERROR
  6981             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6982             GO TO 8100-SEND-INITIAL-MAP.
  6983
  6984     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  6985
  6986     IF EIBAID = DFHPF5
  6987      IF PI-COMPANY-ID = 'CID' AND PI-PROMPT-LETTER = 'Y'
  6988         MOVE ER-0894            TO EMI-ERROR
  6989         MOVE -1             TO MAINTL
  6990         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6991         MOVE AL-UABON       TO MAINTA
  6992         GO TO 8200-SEND-DATAONLY
  6993      ELSE
  6994         IF MAINTI NOT = 'C'
  6995             MOVE ER-0716        TO EMI-ERROR
  6996             MOVE -1             TO MAINTL
  6997             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6998             MOVE AL-UABON       TO MAINTA
  6999             GO TO 8200-SEND-DATAONLY
  7000         ELSE
  7001             IF MODIFY-CAP
  7002                 GO TO 6400-LETTER-RELEASE
  7003             ELSE
  7004                 IF PRINT-PERFORMED
  7005                     GO TO 6400-LETTER-RELEASE
  7006                 ELSE
  7007                     MOVE AL-UNBON TO ENTERPFA
  7008                     MOVE -1       TO ENTERPFL
  7009                     MOVE ER-2398 TO EMI-ERROR
  7010                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7011                     GO TO 8200-SEND-DATAONLY.
  7012
  7013     IF EIBAID = DFHPF6
  7014      IF PI-COMPANY-ID = 'CID' AND PI-PROMPT-LETTER = 'Y'
  7015         MOVE ER-0894            TO EMI-ERROR
  7016         MOVE -1             TO MAINTL
  7017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7018         MOVE AL-UABON       TO MAINTA
  7019         GO TO 8200-SEND-DATAONLY
  7020      ELSE
  7021         GO TO 7800-PRINT-LETTER-NOW.
  7022
  7023     IF MAINTI = 'S'
  7024         GO TO 1000-SHOW.
  7025
  7026     IF MAINTI = 'C'
  7027         GO TO 2000-CREATE.
  7028
  7029     IF MAINTI = 'R'
  7030        IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 137
* EL152.cbl
  7031           MOVE ER-0070          TO EMI-ERROR
  7032           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7033           MOVE LOW-VALUES       TO EL152AO
  7034           GO TO 8100-SEND-INITIAL-MAP
  7035          ELSE
  7036           GO TO 3000-RECORD.
  7037
  7038     PERFORM 7500-READ-TS        THRU 7599-EXIT
  7039     PERFORM 7950-SET-INDX       THRU 7950-EXIT
  7040     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN
  7041                                 THRU 7960-EXIT
  7042        VARYING SC-INDX FROM 1 BY 1 UNTIL
  7043        SC-INDX > NUM-LINES-PER-SCREEN
  7044     MOVE ER-0023                TO EMI-ERROR.
  7045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7046     MOVE -1                     TO MAINTL.
  7047     MOVE AL-UABON               TO MAINTA.
  7048     GO TO 8200-SEND-DATAONLY.
  7049
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 138
* EL152.cbl
  7051 0350-EDIT-ROUTINE.
  7052     PERFORM 400-SET-CODES THRU 499-EXIT.
  7053     MOVE PI-CLAIM-NO    TO CLAM-CLAIM
  7054                            ACTV-CLAIM.
  7055
  7056     IF ADDRL NOT = +0
  7057        INSPECT ADDRI CONVERTING LOWER-CASE TO UPPER-CASE
  7058        MOVE ADDRI           TO WS-ADDR-TYPE-CD
  7059        IF WS-ADDR-TYPE = 'I' OR 'B' OR 'A' OR 'P' OR
  7060                          'O' OR 'Q' OR 'E'
  7061           MOVE AL-UANON         TO ADDRA
  7062        ELSE
  7063           MOVE -1               TO ADDRL
  7064           MOVE AL-UABON         TO ADDRA
  7065           MOVE ER-0176          TO EMI-ERROR
  7066           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7067*     ELSE
  7068*       IF PI-COMPANY-ID = 'DMD'
  7069*        IF MAINTI = 'C' OR 'R'
  7070*          MOVE -1               TO ADDRL
  7071*          MOVE AL-UABON         TO ADDRA
  7072*          MOVE ER-0861          TO EMI-ERROR
  7073*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7074
  7075     IF ADDRL NOT = +0
  7076        IF WS-ADDR-SEQ NOT NUMERIC
  7077           MOVE -1               TO ADDRL
  7078           MOVE AL-UABON         TO ADDRA
  7079           MOVE ER-0176          TO EMI-ERROR
  7080           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7081
  7082*    IF ADDRL NOT = +0
  7083*       IF PI-COMPANY-ID = 'DMD'
  7084*          IF WS-ADDR-TYPE = 'B' AND
  7085*             WS-ADDR-SEQ NOT = '9'
  7086*                MOVE -1               TO ADDRL
  7087*                MOVE AL-UABON         TO ADDRA
  7088*                MOVE ER-7842          TO EMI-ERROR
  7089*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7090
  7091     IF FORML NOT = ZEROS
  7092        INSPECT FORMI CONVERTING LOWER-CASE TO UPPER-CASE.
  7093
  7094     IF MAINTI = 'C' AND FORML = ZEROS
  7095        MOVE -1                  TO FORML
  7096        MOVE ER-0177             TO EMI-ERROR
  7097        MOVE AL-UABON            TO FORMA
  7098        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7099
  7100     IF FOLLOWL NOT = ZEROS
  7101        MOVE FOLLOWI             TO DEEDIT-FIELD
  7102        PERFORM 8600-DEEDIT
  7103        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7104        MOVE '4'                 TO DC-OPTION-CODE
  7105        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7106        IF DATE-CONVERSION-ERROR
  7107           MOVE ER-0182          TO EMI-ERROR
  7108           MOVE -1               TO FOLLOWL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 139
* EL152.cbl
  7109           MOVE AL-UABON         TO FOLLOWA
  7110           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7111        ELSE
  7112*          IF (PI-COMPANY-ID = 'DMD') AND
  7113*             (NOT FORCE-7840)        AND
  7114*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7115*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7116*              MOVE AL-SABON         TO PFKEY9A
  7117*              MOVE ER-7840          TO EMI-ERROR
  7118*              MOVE -1               TO FOLLOWL
  7119*              MOVE AL-UABON         TO FOLLOWA
  7120*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7121*          ELSE
  7122             MOVE SPACES                TO PFKEY9O
  7123             MOVE AL-SADON              TO PFKEY9A
  7124             MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWO
  7125             MOVE AL-UANON              TO FOLLOWA
  7126             MOVE DC-BIN-DATE-1         TO FOLLOW-UP-SAVE
  7127     ELSE
  7128        MOVE LOW-VALUES                 TO FOLLOW-UP-SAVE.
  7129
  7130     IF FOLLOW-UP-SAVE NOT = LOW-VALUES
  7131        IF FOLLOW-UP-SAVE NOT > CURRENT-SAVE
  7132           MOVE ER-0533          TO EMI-ERROR
  7133           MOVE AL-UABON         TO FOLLOWA
  7134           MOVE -1               TO FOLLOWL
  7135           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7136
  7137     IF RESENDL NOT = ZEROS
  7138        MOVE RESENDI             TO DEEDIT-FIELD
  7139        PERFORM 8600-DEEDIT
  7140        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7141        MOVE '4'                 TO DC-OPTION-CODE
  7142        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7143        IF DATE-CONVERSION-ERROR
  7144           MOVE ER-0185          TO EMI-ERROR
  7145           MOVE -1               TO RESENDL
  7146           MOVE AL-UABON         TO RESENDA
  7147           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7148         ELSE
  7149*          IF (PI-COMPANY-ID = 'DMD') AND
  7150*             (NOT FORCE-7840)        AND
  7151*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7152*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7153*              MOVE AL-SABON         TO PFKEY9A
  7154*              MOVE ER-7840          TO EMI-ERROR
  7155*              MOVE -1               TO RESENDL
  7156*              MOVE AL-UABON         TO RESENDA
  7157*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7158*          ELSE
  7159             MOVE SPACES                 TO PFKEY9O
  7160             MOVE AL-SADON               TO PFKEY9A
  7161             MOVE DC-GREG-DATE-1-EDIT    TO RESENDO
  7162             MOVE AL-UANON               TO RESENDA
  7163             MOVE DC-BIN-DATE-1          TO RESEND-SAVE
  7164     ELSE
  7165        MOVE LOW-VALUE                   TO RESEND-SAVE.
  7166
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 140
* EL152.cbl
  7167     IF RESEND-SAVE NOT = LOW-VALUES
  7168        IF RESEND-SAVE NOT > CURRENT-SAVE
  7169           MOVE ER-0537          TO EMI-ERROR
  7170           MOVE AL-UABON         TO RESENDA
  7171           MOVE -1               TO RESENDL
  7172           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7173
  7174     IF PRINTL NOT = ZEROS
  7175        INSPECT PRINTI CONVERTING LOWER-CASE TO UPPER-CASE
  7176        IF PRINTI = 'Y' OR = ' '
  7177           MOVE AL-UANON         TO PRINTA
  7178        ELSE
  7179           MOVE ER-0183          TO EMI-ERROR
  7180           MOVE -1               TO PRINTL
  7181           MOVE AL-UABON         TO PRINTA
  7182           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7183
  7184     MOVE 'Y'                    TO CLEANO
  7185     IF ENCL <= ZEROS
  7186        MOVE 'N'                 TO CLEANO
  7187     END-IF
  7188     IF ENCL > ZEROS
  7189        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  7190                                          PI-ENCLOSURE-CD
  7191        IF ENCI  = '1'   OR
  7192                      '1P'  OR
  7193                      '2'   OR
  7194                      '3'   OR
  7195                      '4'   OR
  7196                      '5'   OR
  7197                      '6'   OR
  7198                      '7'   OR
  7199                      '8'   OR
  7200                      '9'   OR
  7201                      'A'   OR
  7202                      'C'   OR
  7203                      'E'   OR
  7204                      'EP'  OR
  7205                      'ENV' OR
  7206                      'I'   OR
  7207                      '0'   OR
  7208                      '4P'  OR
  7209                      '5P'
  7210           MOVE ENCI             TO PI-ENCLOSURE-CD
  7211                                    W-ENCLOSURE-CD
  7212           MOVE AL-UANON         TO ENCA
  7213        ELSE
  7214           MOVE 'N'              TO CLEANO
  7215           MOVE ER-1560          TO EMI-ERROR
  7216           MOVE -1               TO ENCL
  7217           MOVE AL-UABON         TO ENCA
  7218           PERFORM 9900-ERROR-FORMAT
  7219                                 THRU 9900-EXIT
  7220        END-IF
  7221     END-IF
  7222     IF COPIESL NOT = ZEROS
  7223        IF COPIESI NOT NUMERIC OR
  7224           COPIESI = '0'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 141
* EL152.cbl
  7225           MOVE ER-0184          TO EMI-ERROR
  7226           MOVE -1               TO COPIESL
  7227           MOVE AL-UABON         TO COPIESA
  7228           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7229        ELSE
  7230           MOVE AL-UANON         TO COPIESA.
  7231
  7232     IF PI-PROCESSOR-PRINTER NOT = SPACES
  7233         MOVE PI-PROCESSOR-PRINTER   TO  PI-ALT-PRINTER-ID.
  7234
  7235     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  7236
  7237     IF PRINTERL > ZERO
  7238        INSPECT PRINTERI CONVERTING LOWER-CASE TO UPPER-CASE
  7239        MOVE AL-UANON            TO PRINTERA
  7240        MOVE PRINTERI            TO PI-ALT-PRINTER-ID
  7241                                    PI-ALT-DMD-PRT-ID
  7242     ELSE
  7243        IF (PI-NO-CARRIER-SECURITY AND
  7244            PI-NO-ACCOUNT-SECURITY) OR
  7245            PI-PROCESSOR-PRINTER NOT = SPACES
  7246             NEXT SENTENCE
  7247        ELSE
  7248            MOVE AL-UABON       TO PRINTERA
  7249            MOVE -1             TO PRINTERL
  7250            MOVE ER-2397        TO EMI-ERROR
  7251            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7252
  7253     IF ACTL NOT = +0
  7254         MOVE ZEROS              TO W-ACCOUNT
  7255         IF ACTI > SPACES
  7256             IF ACTI NUMERIC
  7257                     AND
  7258                ACTI NOT < 1
  7259                     AND
  7260                ACTI NOT > 9
  7261                 MOVE AL-UANON   TO ACTA
  7262                 MOVE ACTI       TO W-ACCOUNT
  7263                                    W-LETTER-ADDR-SEQ
  7264                 MOVE 'A'        TO W-LETTER-ADDR-TYPE
  7265             ELSE
  7266                 MOVE -1         TO ACTL
  7267                 MOVE AL-UABON   TO ACTA
  7268                 MOVE ER-3547    TO EMI-ERROR
  7269                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7270
  7271     IF BENL NOT = +0
  7272         MOVE ZEROS              TO W-BENEFICIARY
  7273         IF BENI > SPACES
  7274             IF BENI NUMERIC
  7275                     AND
  7276                BENI NOT < 1
  7277                     AND
  7278                BENI NOT > 9
  7279                 MOVE AL-UANON   TO BENA
  7280                 MOVE BENI       TO W-BENEFICIARY
  7281                                    W-LETTER-ADDR-SEQ
  7282                 MOVE 'B'        TO W-LETTER-ADDR-TYPE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 142
* EL152.cbl
  7283             ELSE
  7284                 MOVE -1         TO BENL
  7285                 MOVE AL-UABON   TO BENA
  7286                 MOVE ER-3547    TO EMI-ERROR
  7287                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7288
  7289     IF EMPL NOT = +0
  7290         MOVE ZEROS              TO W-EMPLOYER
  7291         IF EMPI > SPACES
  7292             IF EMPI NUMERIC
  7293                     AND
  7294                EMPI NOT < 1
  7295                     AND
  7296                EMPI NOT > 9
  7297                 MOVE AL-UANON   TO EMPA
  7298                 MOVE EMPI       TO W-EMPLOYER
  7299                                    W-LETTER-ADDR-SEQ
  7300                 MOVE 'E'        TO W-LETTER-ADDR-TYPE
  7301             ELSE
  7302                 MOVE -1         TO EMPL
  7303                 MOVE AL-UABON   TO EMPA
  7304                 MOVE ER-3547    TO EMI-ERROR
  7305                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7306
  7307     IF INSL NOT = +0
  7308         MOVE ZEROS              TO W-INSURED
  7309         IF INSI > SPACES
  7310             IF INSI NUMERIC
  7311                     AND
  7312                INSI NOT < 1
  7313                     AND
  7314                INSI NOT > 9
  7315                 MOVE AL-UANON   TO INSA
  7316                 MOVE INSI       TO W-INSURED
  7317                                    W-LETTER-ADDR-SEQ
  7318                 MOVE 'I'        TO W-LETTER-ADDR-TYPE
  7319             ELSE
  7320                 MOVE -1         TO INSL
  7321                 MOVE AL-UABON   TO INSA
  7322                 MOVE ER-3547    TO EMI-ERROR
  7323                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7324
  7325     IF PHYSL NOT = +0
  7326         MOVE ZEROS              TO W-PHYSICIAN
  7327         IF PHYSI > SPACES
  7328             IF PHYSI NUMERIC
  7329                     AND
  7330                PHYSI NOT < 1
  7331                     AND
  7332                PHYSI NOT > 9
  7333                 MOVE AL-UANON   TO PHYSA
  7334                 MOVE PHYSI      TO W-PHYSICIAN
  7335                                    W-LETTER-ADDR-SEQ
  7336                 MOVE 'P'        TO W-LETTER-ADDR-TYPE
  7337             ELSE
  7338                 MOVE -1         TO PHYSL
  7339                 MOVE AL-UABON   TO PHYSA
  7340                 MOVE ER-3547    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 143
* EL152.cbl
  7341                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7342
  7343     IF OTHR1L NOT = +0
  7344         MOVE ZEROS              TO W-OTHER-1
  7345         IF OTHR1I > SPACES
  7346             IF OTHR1I NUMERIC
  7347                     AND
  7348                OTHR1I NOT < 1
  7349                     AND
  7350                OTHR1I NOT > 9
  7351                 MOVE AL-UANON   TO OTHR1A
  7352                 MOVE OTHR1I     TO W-OTHER-1
  7353                                    W-LETTER-ADDR-SEQ
  7354                 MOVE 'O'        TO W-LETTER-ADDR-TYPE
  7355             ELSE
  7356                 MOVE -1         TO OTHR1L
  7357                 MOVE AL-UABON   TO OTHR1A
  7358                 MOVE ER-3547    TO EMI-ERROR
  7359                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7360
  7361     IF OTHR2L NOT = +0
  7362         MOVE ZEROS              TO W-OTHER-2
  7363         IF OTHR2I > SPACES
  7364             IF OTHR2I NUMERIC
  7365                     AND
  7366                OTHR2I NOT < 1
  7367                     AND
  7368                OTHR2I NOT > 9
  7369                 MOVE AL-UANON   TO OTHR2A
  7370                 MOVE OTHR2I     TO W-OTHER-2
  7371                                    W-LETTER-ADDR-SEQ
  7372                 MOVE 'Q'        TO W-LETTER-ADDR-TYPE
  7373             ELSE
  7374                 MOVE -1         TO OTHR2L
  7375                 MOVE AL-UABON   TO OTHR2A
  7376                 MOVE ER-3547    TO EMI-ERROR
  7377                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7378
  7379     IF NOT EMI-NO-ERRORS
  7380        GO TO 8200-SEND-DATAONLY.
  7381
  7382 0350-EXIT.
  7383      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 144
* EL152.cbl
  7385 400-SET-CODES.
  7386     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7387     MOVE PI-COMPANY-CD          TO CLAM-CO
  7388                                    TEXT-CO
  7389                                    ACTV-CO
  7390                                    CERT-CO
  7391                                    ACCT-CO
  7392                                    ARCH-CO
  7393                                    PROD-CO
  7394                                    PLCY-CO
  7395                                    PLAN-CO.
  7396
  7397     MOVE PI-CARRIER             TO CLAM-CARRIER
  7398                                    ACTV-CARRIER
  7399                                    CERT-CARRIER
  7400                                    ACCT-CARRIER
  7401                                    PROD-CARRIER
  7402                                    PLCY-CARRIER
  7403                                    PLAN-CARRIER.
  7404
  7405     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  7406                                    ACTV-CERT-NUM
  7407                                    CERT-CERT-NUM.
  7408 499-EXIT.
  7409      EXIT.
  7410
  7411 500-RECOVER-PI-TEMP-STORAGE.
  7412
  7413
  7414* EXEC CICS HANDLE CONDITION
  7415*        QIDERR   (590-QIDERR)
  7416*    END-EXEC.
  7417*    MOVE '"$N                   ! % #00007331' TO DFHEIV0
  7418     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  7419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7420     MOVE X'2520233030303037333331' TO DFHEIV0(25:11)
  7421     CALL 'kxdfhei1' USING DFHEIV0
  7422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7423
  7424
  7425
  7426* EXEC CICS READQ TS
  7427*        QUEUE    (WS-PI-QID)
  7428*        INTO     (PROGRAM-INTERFACE-BLOCK)
  7429*        LENGTH   (PI-COMM-LENGTH)
  7430*    END-EXEC.
  7431*    MOVE '*$I    L              ''   #00007335' TO DFHEIV0
  7432     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7433     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7434     MOVE X'2020233030303037333335' TO DFHEIV0(25:11)
  7435     CALL 'kxdfhei1' USING DFHEIV0,
  7436           WS-PI-QID,
  7437           PROGRAM-INTERFACE-BLOCK,
  7438           PI-COMM-LENGTH,
  7439           DFHEIV99,
  7440           DFHEIV99,
  7441           DFHEIV99
  7442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 145
* EL152.cbl
  7443
  7444
  7445     PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT.
  7446
  7447     GO TO 599-EXIT.
  7448
  7449 590-QIDERR.
  7450
  7451     IF EIBTRNID = TRANS-ID
  7452         MOVE ER-0033                   TO  EMI-ERROR
  7453         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7454         GO TO 8200-SEND-DATAONLY.
  7455
  7456 599-EXIT.
  7457     EXIT.
  7458
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 146
* EL152.cbl
  7460 1000-SHOW.
  7461***************************************************************
  7462*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
  7463*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN. THE TEXT      *
  7464*     WILL BE INSERTED INTO THE TS-TABLE AND DISPLAYED TO     *
  7465*     OPERATOR.                                               *
  7466***************************************************************
  7467
  7468     MOVE SPACES                 TO RECORD-TABLE.
  7469     IF ARCHNUML = ZEROS
  7470        MOVE -1                  TO ARCHNUML
  7471        MOVE AL-UNBON            TO ARCHNUMA
  7472        MOVE ER-0174             TO EMI-ERROR
  7473        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7474        GO TO 8200-SEND-DATAONLY.
  7475
  7476     IF ARCHNUMI NOT NUMERIC
  7477        MOVE -1                  TO ARCHNUML
  7478        MOVE AL-UNBON            TO ARCHNUMA
  7479        MOVE ER-0175             TO EMI-ERROR
  7480        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7481        GO TO 8200-SEND-DATAONLY.
  7482
  7483     IF PI-SHOW-MODE
  7484*       IF PI-ARCHIVE-NUMBER = ARCHNUMI
  7485*          MOVE -1               TO MAINTL
  7486*          GO TO 8200-SEND-DATAONLY
  7487*       ELSE
  7488           PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
  7489
  7490     MOVE ARCHNUMI               TO ARCH-NUMBER
  7491                                    PI-ARCHIVE-NUMBER.
  7492     MOVE ' '                    TO ARCH-REC-TYPE.
  7493     MOVE '1'                    TO PI-ACTION.
  7494     MOVE ZEROS                  TO PI-ADDR-SEQ.
  7495     MOVE LOW-VALUES             TO PI-ADDR-TYPE.
  7496     MOVE SPACES                 TO PI-PRINT-SW
  7497                                    PI-FORM-NUMBER.
  7498     SET TB-INDX TO 1.
  7499
  7500     MOVE SPACE                  TO WS-LETTER-STATUS.
  7501
  7502
  7503* EXEC CICS HANDLE CONDITION
  7504*         NOTOPEN    (8850-ARCH-NOT-OPEN)
  7505*         NOTFND     (1020-ENDBR)
  7506*         ENDFILE    (1020-ENDBR)
  7507*    END-EXEC.
  7508*    MOVE '"$JI''                 ! & #00007398' TO DFHEIV0
  7509     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  7510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7511     MOVE X'2620233030303037333938' TO DFHEIV0(25:11)
  7512     CALL 'kxdfhei1' USING DFHEIV0
  7513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7514
  7515
  7516     MOVE ARCH-PARTIAL-KEY       TO ARCH-SAVE-KEY.
  7517
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 147
* EL152.cbl
  7518
  7519* EXEC CICS STARTBR
  7520*         DATASET    (ARCH-ID)
  7521*         RIDFLD     (ARCH-KEY)
  7522*         GTEQ
  7523*    END-EXEC
  7524     MOVE 0
  7525       TO DFHEIV11
  7526*    MOVE '&,         G          &   #00007406' TO DFHEIV0
  7527     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7528     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7529     MOVE X'2020233030303037343036' TO DFHEIV0(25:11)
  7530     CALL 'kxdfhei1' USING DFHEIV0,
  7531           ARCH-ID,
  7532           ARCH-KEY,
  7533           DFHEIV99,
  7534           DFHEIV11,
  7535           DFHEIV99
  7536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7537
  7538     MOVE 'Y'                    TO ARCH-BROWSE-STARTED.
  7539
  7540 1010-READ-NEXT.
  7541
  7542* EXEC CICS READNEXT
  7543*         SET       (ADDRESS OF LETTER-ARCHIVE)
  7544*         DATASET   (ARCH-ID)
  7545*         RIDFLD    (ARCH-KEY)
  7546*    END-EXEC.
  7547     MOVE 0
  7548       TO DFHEIV11
  7549*    MOVE '&.S                   )   #00007415' TO DFHEIV0
  7550     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7551     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7552     MOVE X'2020233030303037343135' TO DFHEIV0(25:11)
  7553     CALL 'kxdfhei1' USING DFHEIV0,
  7554           ARCH-ID,
  7555           DFHEIV20,
  7556           DFHEIV99,
  7557           ARCH-KEY,
  7558           DFHEIV99,
  7559           DFHEIV11,
  7560           DFHEIV99,
  7561           DFHEIV99
  7562     SET ADDRESS OF LETTER-ARCHIVE TO
  7563         DFHEIV20
  7564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7565
  7566
  7567     IF LA-FORM-CONTROL-HDR
  7568        GO TO 1020-ENDBR.
  7569
  7570
  7571     IF NOT LA-HEADER-DATA
  7572         NEXT SENTENCE
  7573     ELSE
  7574         IF NOT LA-CSO-LETTER-PURGED
  7575             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 148
* EL152.cbl
  7576         ELSE
  7577             MOVE 'P'            TO WS-LETTER-STATUS
  7578             GO TO 1020-ENDBR.
  7579
  7580     IF ARCH-PARTIAL-KEY = ARCH-SAVE-KEY
  7581        IF LA-HEADER-DATA
  7582           PERFORM 1040-FORMAT-RESEND
  7583           MOVE LA-NO-OF-COPIES    TO COPIESO
  7584           PERFORM 1050-GET-CORRESPOND THRU 1059-EXIT
  7585           GO TO 1010-READ-NEXT
  7586        ELSE
  7587           IF LA-ADDRESS-DATA
  7588              MOVE LA-ADDRESS-LINE   TO REC-TEXT (TB-INDX)
  7589              MOVE ZEROS             TO REC-PC (TB-INDX)
  7590              SET TB-INDX UP BY 1
  7591              GO TO 1010-READ-NEXT
  7592           ELSE
  7593              PERFORM 1030-TEXT-BUILD
  7594              GO TO 1010-READ-NEXT.
  7595
  7596 1020-ENDBR.
  7597     IF ARCH-BROWSE-STARTED = 'Y'
  7598        MOVE 'N'                TO ARCH-BROWSE-STARTED
  7599
  7600* EXEC CICS ENDBR
  7601*            DATASET   (ARCH-ID)
  7602*       END-EXEC
  7603     MOVE 0
  7604       TO DFHEIV11
  7605*    MOVE '&2                    $   #00007453' TO DFHEIV0
  7606     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7607     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7608     MOVE X'2020233030303037343533' TO DFHEIV0(25:11)
  7609     CALL 'kxdfhei1' USING DFHEIV0,
  7610           ARCH-ID,
  7611           DFHEIV11,
  7612           DFHEIV99
  7613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7614     END-IF.
  7615
  7616*    IF PI-COMPANY-ID = 'CID'
  7617         IF TB-INDX = 1
  7618             IF WS-LETTER-STATUS EQUAL 'P'
  7619                 MOVE 9021           TO EMI-ERROR
  7620                 MOVE -1             TO ARCHNUML
  7621                 MOVE AL-UNBON       TO ARCHNUMA
  7622                 PERFORM 9900-ERROR-FORMAT THRU
  7623                         9900-EXIT
  7624                 GO TO 8200-SEND-DATAONLY
  7625             ELSE
  7626                 MOVE ER-0006             TO EMI-ERROR
  7627                 MOVE -1                  TO ARCHNUML
  7628                 MOVE AL-UNBON            TO ARCHNUMA
  7629                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7630                 GO TO 8200-SEND-DATAONLY
  7631             END-IF
  7632         END-IF
  7633*    ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 149
* EL152.cbl
  7634*        IF TB-INDX = 1
  7635*            MOVE ER-0006             TO EMI-ERROR
  7636*            MOVE -1                  TO ARCHNUML
  7637*            MOVE AL-UNBON            TO ARCHNUMA
  7638*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7639*            GO TO 8200-SEND-DATAONLY
  7640*        END-IF
  7641*    END-IF
  7642
  7643
  7644     SET TB-INDX DOWN BY 1.
  7645     SET PI-TOTAL-LINES          TO TB-INDX.
  7646     MOVE 1                      TO PI-CURRENT-LINE.
  7647     SET TB-INDX TO 1.
  7648
  7649     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  7650             VARYING SC-INDX FROM 1 BY 1
  7651               UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  7652
  7653     MOVE SPACES                 TO PI-ADDR-TYPE
  7654                                    MAINTI.
  7655     MOVE -1                     TO MAINTL.
  7656
  7657     GO TO 8100-SEND-INITIAL-MAP.
  7658
  7659 1030-TEXT-BUILD.
  7660***** IF THERE ARE NO ADDRESS LINES OR LESS THAN 6 LINES, SET TO
  7661***** TOP OF FORM.
  7662     IF TB-INDX < 7
  7663        SET TB-INDX   TO 7.
  7664
  7665     IF TB-INDX = 7
  7666        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7667        SET TB-INDX UP BY 1.
  7668
  7669     MOVE LA-TEXT-LINE           TO REC-TEXT (TB-INDX).
  7670     MOVE LA-SKIP-CONTROL        TO REC-PC (TB-INDX)
  7671                                    INDX-WORK.
  7672
  7673     IF INDX-WORK NOT = 99
  7674        SET TB-INDX UP BY 1
  7675        SET TB-INDX UP BY INDX-WORK
  7676     ELSE
  7677        SET TB-INDX UP BY 1
  7678        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7679        SET TB-INDX UP BY 1.
  7680
  7681 1040-FORMAT-RESEND.
  7682     IF LA-RESEND-DATE = LOW-VALUES
  7683        MOVE SPACES                 TO RESENDI
  7684       ELSE
  7685        MOVE LA-RESEND-DATE         TO DC-BIN-DATE-1
  7686        MOVE ' '                    TO DC-OPTION-CODE
  7687        PERFORM 9700-DATE-LINK  THRU 9700-EXIT
  7688        MOVE DC-GREG-DATE-1-EDIT    TO RESENDO.
  7689
  7690 1050-GET-CORRESPOND.
  7691     MOVE LA-CARRIER             TO ACTV-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 150
* EL152.cbl
  7692     MOVE LA-CLAIM-NO            TO ACTV-CLAIM.
  7693     MOVE LA-CERT-NO             TO ACTV-CERT-NUM.
  7694     MOVE LA-CORR-TRLR-SEQ       TO ACTV-SEQ.
  7695
  7696
  7697* EXEC CICS READ
  7698*         DATASET     (ACTV-ID)
  7699*         RIDFLD      (ACTV-KEY)
  7700*         SET         (ADDRESS OF ACTIVITY-TRAILERS)
  7701*    END-EXEC.
  7702*    MOVE '&"S        E          (   #00007538' TO DFHEIV0
  7703     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7705     MOVE X'2020233030303037353338' TO DFHEIV0(25:11)
  7706     CALL 'kxdfhei1' USING DFHEIV0,
  7707           ACTV-ID,
  7708           DFHEIV20,
  7709           DFHEIV99,
  7710           ACTV-KEY,
  7711           DFHEIV99,
  7712           DFHEIV99,
  7713           DFHEIV99
  7714     SET ADDRESS OF ACTIVITY-TRAILERS TO
  7715         DFHEIV20
  7716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7717
  7718
  7719     IF AT-RECEIPT-FOLLOW-UP = LOW-VALUES
  7720        MOVE SPACES                TO FOLLOWI
  7721     ELSE
  7722        MOVE SPACES                TO DC-OPTION-CODE
  7723        MOVE AT-RECEIPT-FOLLOW-UP  TO DC-BIN-DATE-1
  7724        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7725        MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWI.
  7726
  7727     MOVE SPACES                 TO ADDRI
  7728     MOVE AT-STD-LETTER-FORM     TO FORMI
  7729     MOVE AT-REASON-TEXT         TO REI.
  7730
  7731 1059-EXIT.
  7732      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 151
* EL152.cbl
  7734 2000-CREATE.
  7735***************************************************************
  7736*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
  7737*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
  7738*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
  7739*    WILL BE DISPLAYED ONTO THE SCREEN.                       *
  7740*                                                             *
  7741***************************************************************
  7742
  7743***************************************************************
  7744*    CHECK TO SEE IF SAME REQUEST OR NOT.                     *
  7745*    IF NEW REQUEST AND A LETTER WAS PRINTED, FORCE AN ERROR  *
  7746***************************************************************
  7747
  7748     IF PI-CREATE-MODE
  7749        IF PI-FORM-NUMBER = FORMI AND PI-ADDR-TYPE = ADDRI AND
  7750           PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7751           PERFORM 7500-READ-TS  THRU 7599-EXIT
  7752           PERFORM 7950-SET-INDX THRU 7950-EXIT
  7753           PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  7754             VARYING SC-INDX FROM 1 BY 1
  7755             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  7756           MOVE -1               TO MAINTL
  7757*          MOVE 'Y'              TO CLEANO
  7758           GO TO 8200-SEND-DATAONLY
  7759        ELSE
  7760           IF PRINT-PERFORMED AND
  7761              PI-RETURN-TO-PROGRAM  =  PGM-EL150 AND
  7762              FORMI NOT = 9999
  7763              MOVE ER-0279           TO EMI-ERROR
  7764              MOVE -1                TO MAINTL
  7765              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7766              GO TO 8200-SEND-DATAONLY.
  7767
  7768***************************************************************
  7769*   IF THE FORM NUMBER IS THE SAME BUT THE ADDRESS TYPE       *
  7770*   HAS CHANGED, THEN SAVE THE CURRENT SCREEN AND REBUILD     *
  7771*   THE ADDRESS DATA.                                         *
  7772***************************************************************
  7773
  7774     IF PI-FORM-NUMBER = FORMI AND
  7775        PI-ADDR-TYPE  =  ADDRI AND
  7776        PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7777           MOVE -1                  TO MAINTL
  7778           GO TO 8200-SEND-DATAONLY.
  7779
  7780     IF PI-LETTER-ADDRESS-TYPE NOT = W-LETTER-ADDRESS-TYPE
  7781         MOVE 0                  TO GETMAIN-SWITCH
  7782         MOVE 'N'                TO WS-ACCT-READ-SW
  7783                                    WS-PROD-READ-SW
  7784                                    WS-COMP-READ-SW.
  7785
  7786     MOVE SPACES                 TO RECORD-TABLE.
  7787
  7788     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  7789
  7790     SET TB-INDX TO 1
  7791     MOVE TOP-FORM               TO REC-TEXT (TB-INDX).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 152
* EL152.cbl
  7792     SET TB-INDX UP BY 1.
  7793
  7794***************************************************************
  7795*    IF A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE      *
  7796*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
  7797***************************************************************
  7798
  7799     IF FORMI = '9999'
  7800        MOVE 16                  TO PI-TOTAL-LINES
  7801        MOVE 1                   TO PI-CURRENT-LINE
  7802        PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
  7803        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT
  7804        MOVE '3'                 TO PI-ACTION
  7805        MOVE FORMI               TO PI-FORM-NUMBER
  7806                                    PI-COMM-CONTROL
  7807        MOVE ZEROS               TO PI-UPDATE-SW
  7808        MOVE PGM-EL1042          TO PGM-NAME
  7809        GO TO 9300-XCTL.
  7810
  7811     MOVE FORMI                  TO TEXT-LETTER.
  7812     MOVE TEXT-PARTIAL-KEY       TO TEXT-SAVE-KEY.
  7813
  7814
  7815* EXEC CICS HANDLE CONDITION
  7816*         NOTFND     (2120-ENDBR)
  7817*         ENDFILE    (2120-ENDBR)
  7818*         NOTOPEN    (8890-TEXT-NOT-OPEN)
  7819*    END-EXEC
  7820*    MOVE '"$I''J                 ! '' #00007639' TO DFHEIV0
  7821     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7822     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7823     MOVE X'2720233030303037363339' TO DFHEIV0(25:11)
  7824     CALL 'kxdfhei1' USING DFHEIV0
  7825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7826
  7827
  7828* EXEC CICS STARTBR
  7829*         DATASET    (TEXT-ID)
  7830*         RIDFLD     (TEXT-KEY)
  7831*         GTEQ
  7832*    END-EXEC.
  7833     MOVE 0
  7834       TO DFHEIV11
  7835*    MOVE '&,         G          &   #00007645' TO DFHEIV0
  7836     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7837     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7838     MOVE X'2020233030303037363435' TO DFHEIV0(25:11)
  7839     CALL 'kxdfhei1' USING DFHEIV0,
  7840           TEXT-ID,
  7841           TEXT-KEY,
  7842           DFHEIV99,
  7843           DFHEIV11,
  7844           DFHEIV99
  7845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7846
  7847
  7848     MOVE 'Y'                    TO TEXT-BROWSE-STARTED.
  7849
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 153
* EL152.cbl
  7850 2110-READ-NEXT.
  7851     IF TB-INDX > MAX-LINES
  7852        MOVE ER-0051             TO EMI-ERROR
  7853        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7854        GO TO 2120-ENDBR.
  7855
  7856
  7857* EXEC CICS READNEXT
  7858*         DATASET    (TEXT-ID)
  7859*         SET        (ADDRESS OF TEXT-FILES)
  7860*         RIDFLD     (TEXT-KEY)
  7861*    END-EXEC.
  7862     MOVE 0
  7863       TO DFHEIV11
  7864*    MOVE '&.S                   )   #00007659' TO DFHEIV0
  7865     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7866     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7867     MOVE X'2020233030303037363539' TO DFHEIV0(25:11)
  7868     CALL 'kxdfhei1' USING DFHEIV0,
  7869           TEXT-ID,
  7870           DFHEIV20,
  7871           DFHEIV99,
  7872           TEXT-KEY,
  7873           DFHEIV99,
  7874           DFHEIV11,
  7875           DFHEIV99,
  7876           DFHEIV99
  7877     SET ADDRESS OF TEXT-FILES TO
  7878         DFHEIV20
  7879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7880
  7881
  7882     IF TEXT-PARTIAL-KEY NOT = TEXT-SAVE-KEY
  7883        IF TB-INDX = +2
  7884           MOVE SPACES           TO PI-FORM-NUMBER
  7885           MOVE -1               TO FORML
  7886           MOVE AL-UABON         TO FORMA
  7887           MOVE ER-1236          TO EMI-ERROR
  7888           MOVE 'N'              TO CLEANO
  7889           PERFORM 9900-ERROR-FORMAT
  7890                                 THRU 9900-EXIT
  7891        END-IF
  7892        GO TO 2120-ENDBR
  7893     END-IF
  7894
  7895     MOVE FORMI                  TO PI-FORM-NUMBER.
  7896     IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  7897         PERFORM 2800-PROCESS-Z-CONTROLS THRU 2800-EXIT
  7898         GO TO 2110-READ-NEXT.
  7899
  7900      MOVE TX-BSR-CODE           TO PI-ELLETR-BSR.
  7901
  7902      IF (PI-COMPANY-ID = 'CID')
  7903         AND (PI-CARRIER NOT = '8')
  7904         PERFORM VARYING B1 FROM +1 BY +1 UNTIL
  7905            B1 > +20
  7906            IF TX-TEXT-LINE (B1:5) = '@03.1'
  7907               GO TO 2110-READ-NEXT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 154
* EL152.cbl
  7908            END-IF
  7909         END-PERFORM
  7910      END-IF
  7911      MOVE TX-TEXT-LINE          TO REC-TEXT (TB-INDX).
  7912      MOVE TX-PROCESS-CONTROL    TO REC-PC (TB-INDX)
  7913                                    INDX-WORK.
  7914      SET TB-INDX UP BY 1.
  7915      IF INDX-WORK = 99
  7916         MOVE TOP-FORM           TO REC-TEXT (TB-INDX)
  7917         SET TB-INDX UP BY 1
  7918         GO TO 2110-READ-NEXT
  7919      ELSE
  7920         SET TB-INDX UP BY INDX-WORK
  7921         GO TO 2110-READ-NEXT.
  7922
  7923 2120-ENDBR.
  7924     IF TEXT-BROWSE-STARTED = 'Y'
  7925        MOVE 'N'                 TO TEXT-BROWSE-STARTED
  7926
  7927* EXEC CICS ENDBR
  7928*            DATASET     (TEXT-ID)
  7929*       END-EXEC.
  7930     MOVE 0
  7931       TO DFHEIV11
  7932*    MOVE '&2                    $   #00007709' TO DFHEIV0
  7933     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7934     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7935     MOVE X'2020233030303037373039' TO DFHEIV0(25:11)
  7936     CALL 'kxdfhei1' USING DFHEIV0,
  7937           TEXT-ID,
  7938           DFHEIV11,
  7939           DFHEIV99
  7940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7941
  7942
  7943*02160      IF TB-INDX = 8
  7944*02161         MOVE ER-0006             TO EMI-ERROR
  7945*02162         MOVE -1                  TO FORML
  7946*02163         MOVE AL-UABON            TO FORMA
  7947*02164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7948*02165         GO TO 8200-SEND-DATAONLY-ERASEAUP.
  7949
  7950     SET TB-INDX DOWN BY 1.
  7951     SET PI-TOTAL-LINES          TO TB-INDX.
  7952     MOVE 1                      TO PI-CURRENT-LINE.
  7953
  7954***************************************************************
  7955*    IF IT IS A DESIGNATED CLAIM, THEN RESOLVE ALL            *
  7956*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
  7957***************************************************************
  7958
  7959     IF PI-RETURN-TO-PROGRAM = PGM-EL150
  7960        PERFORM 7200-RESOLVE-VARIABLES THRU 7269-EXIT
  7961        MOVE SPACES              TO W-REVERSE-DATE-SW
  7962        PERFORM 7300-VARIABLE-SEARCH   THRU 7399-EXIT
  7963                VARYING TB-INDX FROM 7 BY 1 UNTIL
  7964                TB-INDX > PI-TOTAL-LINES
  7965     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 155
* EL152.cbl
  7966        MOVE ER-0373             TO EMI-ERROR
  7967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7968
  7969     SET TB-INDX TO 1.
  7970     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  7971             VARYING SC-INDX FROM 1 BY 1 UNTIL
  7972             SC-INDX > NUM-LINES-PER-SCREEN.
  7973
  7974     MOVE '3'                    TO PI-ACTION.
  7975*    MOVE FORMI                  TO PI-FORM-NUMBER.
  7976     MOVE W-LETTER-ADDRESS-TYPE  TO PI-LETTER-ADDRESS-TYPE.
  7977     MOVE -1                     TO MAINTL.
  7978     GO TO 8200-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 156
* EL152.cbl
  7980 2800-PROCESS-Z-CONTROLS.
  7981
  7982     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
  7983
  7984     IF RESEND-SAVE = LOW-VALUES
  7985         IF W-DAYS-TO-RESEND-1 NUMERIC
  7986             IF W-DAYS-TO-RESEND-1 > ZEROS
  7987                 MOVE '6'                    TO DC-OPTION-CODE
  7988                 MOVE SAVE-BIN-DATE          TO DC-BIN-DATE-1
  7989                 MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  7990                 MOVE W-DAYS-TO-RESEND-1     TO DC-ELAPSED-DAYS
  7991                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7992                 IF NO-CONVERSION-ERROR
  7993                     MOVE DC-BIN-DATE-2       TO RESEND-SAVE
  7994                     MOVE DC-GREG-DATE-1-EDIT TO RESENDO
  7995                     MOVE AL-UANON            TO RESENDA
  7996                     MOVE +8                  TO RESENDL
  7997                 ELSE
  7998                     MOVE ER-3770             TO EMI-ERROR
  7999                     MOVE -1                  TO MAINTL
  8000                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8001                     GO TO 8200-SEND-DATAONLY.
  8002
  8003     IF FOLLOW-UP-SAVE = LOW-VALUES
  8004         IF W-DAYS-TO-FOLLOW-UP NUMERIC
  8005             IF W-DAYS-TO-FOLLOW-UP > ZEROS
  8006                 MOVE '6'                 TO DC-OPTION-CODE
  8007                 MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  8008                 MOVE ZEROS               TO DC-ELAPSED-MONTHS
  8009                 MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  8010                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8011                 IF NO-CONVERSION-ERROR
  8012                     MOVE DC-BIN-DATE-2       TO FOLLOW-UP-SAVE
  8013                     MOVE DC-GREG-DATE-1-EDIT TO FOLLOWO
  8014                     MOVE AL-UANON            TO FOLLOWA
  8015                     MOVE +8                  TO FOLLOWL
  8016                 ELSE
  8017                     MOVE ER-3771             TO EMI-ERROR
  8018                     MOVE -1                  TO MAINTL
  8019                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8020                     GO TO 8200-SEND-DATAONLY.
  8021
  8022     IF COPIESI NOT NUMERIC
  8023         IF W-NUMBER-OF-COPIES NUMERIC
  8024             IF W-NUMBER-OF-COPIES > ZEROS
  8025                 MOVE W-NUMBER-OF-COPIES  TO COPIESI
  8026                 MOVE AL-UNNON            TO COPIESA
  8027                 MOVE +1                  TO COPIESL
  8028             ELSE
  8029                 MOVE +1                  TO COPIESI
  8030                 MOVE AL-UNNON            TO COPIESA
  8031                 MOVE +1                  TO COPIESL.
  8032
  8033     IF W-FORM-TO-RESEND > SPACES
  8034         MOVE W-FORM-TO-RESEND          TO PI-RESEND-FORM-NUMBER
  8035     ELSE
  8036         MOVE LOW-VALUES                TO PI-RESEND-FORM-NUMBER
  8037     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 157
* EL152.cbl
  8038
  8039     IF W-PROMPT-LETTER = 'Y'
  8040         MOVE W-PROMPT-LETTER           TO PI-PROMPT-LETTER
  8041         MOVE ER-0894                   TO EMI-ERROR
  8042         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8043     ELSE
  8044         MOVE 'N'                       TO PI-PROMPT-LETTER
  8045     END-IF.
  8046
  8047     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
  8048                                           ENCO
  8049     MOVE AL-UANON                      TO ENCA
  8050     MOVE +3                            TO ENCL
  8051     MOVE 'N'                           TO CLEANO
  8052     MOVE W-AUTO-CLOSE-IND              TO PI-AUTO-CLOSE-IND.
  8053     MOVE W-LETTER-TO-BENE              TO PI-LETTER-TO-BENE.
  8054
  8055 2800-EXIT.
  8056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 158
* EL152.cbl
  8058 3000-RECORD.
  8059***************************************************************
  8060*    THIS ROUTINE WILL SAVE THE LETTER TEXT (IF ANY) AND      *
  8061*    BUILD A CORRESPONDENCE TRAILER WITH THE DATA FROM        *
  8062*    THE SCREEN.                                              *
  8063***************************************************************
  8064
  8065     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8066        MOVE ER-0211             TO EMI-ERROR
  8067        MOVE -1                  TO MAINTL
  8068        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8069        GO TO 8200-SEND-DATAONLY.
  8070
  8071
  8072* EXEC CICS HANDLE CONDITION
  8073*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  8074*         NOTFND     (3010-NOT-FOUND)
  8075*    END-EXEC.
  8076*    MOVE '"$JI                  ! ( #00007841' TO DFHEIV0
  8077     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8078     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8079     MOVE X'2820233030303037383431' TO DFHEIV0(25:11)
  8080     CALL 'kxdfhei1' USING DFHEIV0
  8081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8082
  8083
  8084     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8085     PERFORM 7950-SET-INDX     THRU 7950-EXIT.
  8086
  8087     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8088             VARYING SC-INDX FROM 1 BY 1
  8089             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8090
  8091     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8092
  8093     IF NOT EMI-NO-ERRORS
  8094        GO TO 8200-SEND-DATAONLY.
  8095
  8096     MOVE ZEROS               TO ARCH-NUMBER.
  8097     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8098     MOVE ER-0000             TO EMI-ERROR.
  8099     MOVE -1                  TO MAINTL.
  8100     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8101     GO TO 8200-SEND-DATAONLY.
  8102
  8103 3010-NOT-FOUND.
  8104     MOVE ER-0133             TO EMI-ERROR.
  8105     MOVE -1                  TO MAINTL.
  8106     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8107     GO TO 8200-SEND-DATAONLY.
  8108
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 159
* EL152.cbl
  8110*4000-SET-BSR. Remove as dead code
  8111*4001-READ-NEXT. Remove as dead code
  8112*4002-ENDBR. Remove as dead code
  8113*4000-EXIT. Remove as dead code
  8114
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 160
* EL152.cbl
  8116 5000-MOVE-NAME.
  8117*    COPY ELCMNS.
  8118*****************************************************************
  8119*                                                               *
  8120*                                                               *
  8121*                            ELCMNS.                            *
  8122*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8123*                            VMOD=2.002                         *
  8124*                                                               *
  8125*                     M O V E   N A M E   R O U T I N E         *
  8126*                                                               *
  8127*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8128*            NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8129*            NO EMBEDDED BLANKS.                                *
  8130*                                                               *
  8131*                  FIELD               VALUE                    *
  8132*                                                               *
  8133*                LAST NAME (CL15)      SMITH                    *
  8134*                1ST NAME  (CL12)      JOHN                     *
  8135*                MID NAME  (CL12)      ALLEN                    *
  8136*                                                               *
  8137*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8138*                                                               *
  8139*                        SMITH, JOHN ALLEN                      *
  8140*                                                               *
  8141*                TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8142*            STORAGE COPYBOOK:                                  *
  8143*                                                               *
  8144*                01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8145*                                                               *
  8146*****************************************************************.
  8147
  8148     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8149     MOVE ZERO                   TO  WS-NAME-SW.
  8150     SET NWA-INDEX TO +1.
  8151
  8152     IF CL-INSURED-1ST-NAME = SPACES  AND
  8153        CL-INSURED-MID-INIT = SPACES
  8154         MOVE +1                 TO  WS-NAME-SW.
  8155
  8156     MOVE CL-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8157     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8158
  8159     MOVE CL-INSURED-1ST-NAME   TO  WS-NAME-WORK2.
  8160     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8161
  8162     SET NWA-INDEX UP BY +1.
  8163     MOVE CL-INSURED-MID-INIT   TO  WS-NAME-WORK2.
  8164     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8165
  8166 5000-EXIT.
  8167     EXIT.
  8168
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 161
* EL152.cbl
  8170 5100-MOVE-NAME SECTION.
  8171     IF WS-NAME-SW GREATER THAN +1
  8172         GO TO 5190-EXIT.
  8173
  8174     IF WS-NAME-WORK2 = SPACES
  8175         GO TO 5190-EXIT.
  8176
  8177     SET NWA-INDEX2 TO +1.
  8178     SET NWA-INDEX3 TO +2.
  8179
  8180 5110-MOVE-NAME.
  8181     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8182
  8183     IF NWA-INDEX LESS THAN +30
  8184         SET NWA-INDEX UP BY +1
  8185       ELSE
  8186         ADD +2  TO  WS-NAME-SW
  8187         GO TO 5190-EXIT.
  8188
  8189     IF NWA-INDEX2 LESS THAN +20
  8190         SET NWA-INDEX3 UP BY +1
  8191         SET NWA-INDEX2 UP BY +1.
  8192
  8193     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8194        WS-NW2 (NWA-INDEX3) = SPACES
  8195         IF WS-NAME-SW = ZERO
  8196             MOVE ','            TO  WS-NW (NWA-INDEX)
  8197             SET NWA-INDEX UP BY +2
  8198             MOVE +1             TO  WS-NAME-SW
  8199             GO TO 5190-EXIT
  8200           ELSE
  8201             GO TO 5190-EXIT.
  8202
  8203     GO TO 5110-MOVE-NAME.
  8204
  8205 5190-EXIT.
  8206     EXIT.
  8207
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 162
* EL152.cbl
  8209 5200-MOVE-NAME.
  8210*    NOTE *******************************************************
  8211*         *           M O V E   N A M E   R O U T I N E         *
  8212*         *                                                     *
  8213*         *      THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8214*         *  NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8215*         *  NO EMBEDDED BLANKS.                                *
  8216*         *                                                     *
  8217*         *        FIELD               VALUE                    *
  8218*         *                                                     *
  8219*         *      LAST NAME (CL15)      SMITH                    *
  8220*         *      1ST NAME  (CL12)      JOHN                     *
  8221*         *      MID NAME  (CL1)       A                        *
  8222*         *                                                     *
  8223*         *      AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8224*         *                                                     *
  8225*         *              JOHN A. SMITH                          *
  8226*         *                                                     *
  8227*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8228*         *  STORAGE COPYBOOK:                                  *
  8229*         *                                                     *
  8230*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8231*         *                                                     *
  8232*         *******************************************************.
  8233
  8234     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8235     MOVE ZERO                   TO  WS-NAME-SW.
  8236     SET NWA-INDEX TO +1.
  8237
  8238     IF W-FIRST-NAME = SPACES
  8239             AND
  8240        W-MIDDLE-NAME = SPACES
  8241         MOVE W-LAST-NAME        TO WS-NAME-WORK
  8242         GO TO 5200-EXIT.
  8243
  8244     MOVE W-FIRST-NAME           TO  WS-NAME-WORK2.
  8245     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8246
  8247     SET NWA-INDEX UP BY +1.
  8248
  8249     IF W-MIDDLE-NAME NOT = SPACES
  8250        MOVE W-MIDDLE-NAME       TO  WS-NW (NWA-INDEX)
  8251        SET NWA-INDEX UP BY +1
  8252        MOVE '.'                 TO  WS-NW (NWA-INDEX)
  8253        SET NWA-INDEX UP BY +2.
  8254
  8255     MOVE W-LAST-NAME            TO  WS-NAME-WORK2.
  8256     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8257
  8258 5200-EXIT.
  8259     EXIT.
  8260
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 163
* EL152.cbl
  8262 5300-MOVE-NAME.
  8263     IF WS-NAME-SW > +1
  8264         GO TO 5390-EXIT.
  8265
  8266     IF WS-NAME-WORK2 = SPACES
  8267         GO TO 5390-EXIT.
  8268
  8269     SET NWA-INDEX2 TO +1.
  8270     SET NWA-INDEX3 TO +2.
  8271
  8272 5310-MOVE-NAME.
  8273     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8274
  8275     IF NWA-INDEX < +30
  8276        SET NWA-INDEX UP BY +1
  8277     ELSE
  8278        ADD +2  TO  WS-NAME-SW
  8279        GO TO 5390-EXIT.
  8280
  8281     IF NWA-INDEX2 < +20
  8282         SET NWA-INDEX2 UP BY +1
  8283         SET NWA-INDEX3 UP BY +1.
  8284
  8285     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8286        WS-NW2 (NWA-INDEX3) = SPACES
  8287        GO TO 5390-EXIT.
  8288
  8289     GO TO 5310-MOVE-NAME.
  8290
  8291 5390-EXIT.
  8292     EXIT.
  8293
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 164
* EL152.cbl
  8295 6100-ADDR-MAINT.
  8296***************************************************************
  8297*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8298*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8299*    IT WILL THEN XCTL TO THE ADDRESS MAINT PROGRAM.          *
  8300***************************************************************
  8301
  8302     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8303
  8304     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8305     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8306             VARYING SC-INDX FROM 1 BY 1
  8307             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8308
  8309     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8310        MOVE ER-0343             TO EMI-ERROR
  8311        MOVE -1                  TO MAINTL
  8312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8313        GO TO 8200-SEND-DATAONLY.
  8314
  8315*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8316*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8317*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8318*            VARYING SC-INDX FROM 1 BY 1
  8319*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8320
  8321     PERFORM 7700-PUT-TEMP-STOR    THRU 7749-EXIT.
  8322     PERFORM 7790-WRITE-SCREEN-TS  THRU 7790-EXIT.
  8323     PERFORM 7795-WRITE-PI-AREA-TS THRU 7795-EXIT.
  8324     MOVE PGM-EL141 TO PGM-NAME.
  8325
  8326     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 165
* EL152.cbl
  8328 6200-EDIT-MODE.
  8329***************************************************************
  8330*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8331*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8332*    IT WILL THEN XCTL TO THE TEXT-EDITOR PROGRAM.            *
  8333***************************************************************
  8334     IF PI-SHOW-MODE
  8335        MOVE ER-0188             TO EMI-ERROR
  8336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8337        MOVE -1                  TO MAINTL
  8338        MOVE AL-UABON            TO MAINTA
  8339        GO TO 8200-SEND-DATAONLY
  8340     END-IF
  8341
  8342*    IF PI-COMPANY-ID = 'DMD'
  8343*        IF PI-BSR-AUTOMATED
  8344*            MOVE ER-0912        TO EMI-ERROR
  8345*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8346*            MOVE -1             TO MAINTL
  8347*            MOVE AL-UABON       TO MAINTA
  8348*            GO TO 8200-SEND-DATAONLY.
  8349
  8350     IF PI-CURRENT-LINE = ZEROS
  8351        MOVE ER-0187             TO EMI-ERROR
  8352        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8353        MOVE -1                  TO MAINTL
  8354        GO TO 8200-SEND-DATAONLY.
  8355
  8356     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8357     PERFORM 7750-DELETE-TEMP-STOR
  8358                                 THRU 7750-EXIT
  8359     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8360     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8361             VARYING SC-INDX FROM 1 BY 1
  8362             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8363
  8364     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT.
  8365     PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
  8366
  8367     MOVE PI-FORM-NUMBER         TO PI-COMM-CONTROL.
  8368     MOVE ZEROS                  TO PI-UPDATE-SW.
  8369     MOVE '1'                    TO PI-ENTRY-CD-1.
  8370     MOVE PGM-EL1042             TO PGM-NAME.
  8371     GO TO 9300-XCTL.
  8372
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 166
* EL152.cbl
  8374 6400-LETTER-RELEASE.
  8375***************************************************************
  8376*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
  8377*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS ONTO     *
  8378*    THE ARCHIVE FILE.                                        *
  8379*    THE FOLLOWING FUNCTIONS WILL BE PERFORMED                *
  8380*        1. CHECK SECURITY AND IF IT IS A DESIGNATED LETTER.  *
  8381*        2. RE-EDIT DATA AND UPDATE TS-TABLE WITH CHANGES     *
  8382*        3. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS         *
  8383*        4. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
  8384*        5. WRITE THE NEW ARCHIVE RECORDS FROM TS-TABLE.      *
  8385*        7. BUILD A CORRESPONDENCE TRAILER                    *
  8386*        8. BUILD OR UPDATE THE ACTIVITY QUE FILE WITH THE    *
  8387*                 ARCHIVE NUMBER IF IT IS TO BE PRINTED LATER.*
  8388*        4. RESET ALL CONTROL FIELDS AND RETURN THE           *
  8389*                 ARCHIVE NUMBER USED TO FILE THE RECORDS.    *
  8390***************************************************************
  8391
  8392     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8393
  8394     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8395     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8396             VARYING SC-INDX FROM 1 BY 1
  8397             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8398
  8399     IF NOT MODIFY-CAP
  8400        MOVE ER-0070             TO EMI-ERROR
  8401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8402        MOVE -1                  TO MAINTL
  8403        GO TO 8200-SEND-DATAONLY.
  8404
  8405     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8406        MOVE ER-0211             TO EMI-ERROR
  8407        MOVE -1                  TO MAINTL
  8408        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8409        GO TO 8200-SEND-DATAONLY.
  8410
  8411*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8412*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8413*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8414*            VARYING SC-INDX FROM 1 BY 1
  8415*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8416
  8417     IF PI-ADDR-TYPE  NOT =  ADDRI
  8418        PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8419
  8420     IF NOT EMI-NO-ERRORS
  8421        GO TO 8200-SEND-DATAONLY.
  8422
  8423     MOVE +0                     TO TALLY.
  8424     INSPECT RECORD-TABLE TALLYING TALLY
  8425                                 FOR CHARACTERS BEFORE '@'.
  8426
  8427     IF TALLY < +21900
  8428        COMPUTE PI-CURRENT-LINE = TALLY / 73
  8429        MOVE ZEROS               TO ROLL-COUNTER
  8430        MOVE ER-0191             TO EMI-ERROR
  8431        MOVE -1                  TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 167
* EL152.cbl
  8432        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8433        GO TO 7900-ROLL-PAGE.
  8434
  8435     MOVE '1'                    TO CNTL-RECORD-TYPE.
  8436     MOVE ZEROS                  TO CNTL-SEQ.
  8437     MOVE SPACES                 TO CNTL-GENL.
  8438
  8439* EXEC CICS READ
  8440*         DATASET    (CNTL-ID)
  8441*         SET        (ADDRESS OF CONTROL-FILE)
  8442*         RIDFLD     (CNTL-KEY)
  8443*         UPDATE
  8444*    END-EXEC.
  8445*    MOVE '&"S        EU         (   #00008200' TO DFHEIV0
  8446     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8447     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8448     MOVE X'2020233030303038323030' TO DFHEIV0(25:11)
  8449     CALL 'kxdfhei1' USING DFHEIV0,
  8450           CNTL-ID,
  8451           DFHEIV20,
  8452           DFHEIV99,
  8453           CNTL-KEY,
  8454           DFHEIV99,
  8455           DFHEIV99,
  8456           DFHEIV99
  8457     SET ADDRESS OF CONTROL-FILE TO
  8458         DFHEIV20
  8459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8460
  8461
  8462     ADD 1                       TO CF-CO-ARCHIVE-COUNTER.
  8463     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
  8464     MOVE CF-PRINT-ADDRESS-LABELS   TO  WS-LABELS-SW.
  8465
  8466
  8467* EXEC CICS REWRITE
  8468*         FROM      (CONTROL-FILE)
  8469*         DATASET   (CNTL-ID)
  8470*    END-EXEC
  8471     MOVE LENGTH OF
  8472      CONTROL-FILE
  8473       TO DFHEIV11
  8474*    MOVE '&& L                  %   #00008211' TO DFHEIV0
  8475     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8476     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8477     MOVE X'2020233030303038323131' TO DFHEIV0(25:11)
  8478     CALL 'kxdfhei1' USING DFHEIV0,
  8479           CNTL-ID,
  8480           CONTROL-FILE,
  8481           DFHEIV11,
  8482           DFHEIV99
  8483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8484
  8485     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8486
  8487
  8488* EXEC CICS HANDLE CONDITION
  8489*         NOTOPEN   (9990-ABEND)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 168
* EL152.cbl
  8490*    END-EXEC.
  8491*    MOVE '"$J                   ! ) #00008218' TO DFHEIV0
  8492     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  8493     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8494     MOVE X'2920233030303038323138' TO DFHEIV0(25:11)
  8495     CALL 'kxdfhei1' USING DFHEIV0
  8496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8497
  8498
  8499
  8500* EXEC CICS GETMAIN
  8501*         SET      (ADDRESS OF LETTER-ARCHIVE)
  8502*         LENGTH   (ARCH-LENGTH)
  8503*    END-EXEC.
  8504*    MOVE '," L                  $   #00008222' TO DFHEIV0
  8505     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8506     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8507     MOVE X'2020233030303038323232' TO DFHEIV0(25:11)
  8508     CALL 'kxdfhei1' USING DFHEIV0,
  8509           DFHEIV20,
  8510           ARCH-LENGTH,
  8511           DFHEIV99
  8512     SET ADDRESS OF LETTER-ARCHIVE TO
  8513         DFHEIV20
  8514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8515
  8516
  8517     MOVE SPACES                 TO LETTER-ARCHIVE.
  8518     MOVE 'LA'                   TO LA-RECORD-ID.
  8519     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8520                                    LA-ARCHIVE-NO-A1.
  8521     MOVE '1'                    TO LA-RECORD-TYPE
  8522                                    LA-RECORD-TYPE-A1.
  8523     MOVE ZEROS                  TO LA-LINE-SEQ-NO
  8524                                    LA-LINE-SEQ-NO-A1.
  8525     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8526                                    LA-COMPANY-CD-A1.
  8527     MOVE CLAM-CARRIER           TO LA-CARRIER.
  8528     MOVE PI-CLAIM-NO            TO LA-CLAIM-NO.
  8529     MOVE PI-CERT-NO             TO LA-CERT-NO.
  8530
  8531*    IF PI-COMPANY-ID = 'DMD'
  8532*        MOVE WS-DMD-CERT-STATE    TO LA-DMD-UND-CODE
  8533*        MOVE WS-DMD-CERT-GROUPING TO LA-DMD-PROD-CODE
  8534*        MOVE WS-DMD-BEN-CODE      TO LA-DMD-BEN-CODE
  8535*        MOVE WS-DMD-CORR-TRLR-SEQ TO LA-DMD-CORR-TRLR-SEQ
  8536*        MOVE WS-DMD-LETTER-FORM   TO LA-DMD-LETTER-FORM
  8537*        MOVE WS-DMD-RES-ST        TO LA-DMD-RES-ST
  8538*        MOVE LOW-VALUES           TO LA-DMD-LETTER-PURGE-DT
  8539*                                     LA-DMD-LETTER-RELOAD-DT
  8540*        MOVE '1'                  TO LA-DMD-LETTER-STATUS
  8541*        EXEC CICS GETMAIN
  8542*            SET    (ADDRESS OF LETTER-ARCHIVE-TEMP)
  8543*            LENGTH (ARCT-LENGTH)
  8544*        END-EXEC.
  8545
  8546     IF COPIESL NOT = ZEROS
  8547        MOVE COPIESI             TO LA-NO-OF-COPIES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 169
* EL152.cbl
  8548     ELSE
  8549        MOVE  1                  TO LA-NO-OF-COPIES.
  8550
  8551     IF RESENDL NOT = ZEROS
  8552        MOVE RESEND-SAVE         TO LA-RESEND-DATE
  8553     ELSE
  8554        MOVE LOW-VALUES          TO LA-RESEND-DATE.
  8555
  8556     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
  8557     MOVE CURRENT-SAVE           TO LA-CREATION-DT.
  8558
  8559     IF PRINT-PERFORMED
  8560        MOVE CURRENT-SAVE        TO LA-INITIAL-PRINT-DATE
  8561     ELSE
  8562        MOVE LOW-VALUES          TO LA-INITIAL-PRINT-DATE.
  8563
  8564     MOVE LOW-VALUES             TO LA-RESEND-PRINT-DATE.
  8565     MOVE CORR-TRLR-SEQ          TO LA-CORR-TRLR-SEQ.
  8566     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8567
  8568     IF PI-PROMPT-LETTER NOT EQUAL 'Y'
  8569         PERFORM 6700-BUILD-NAPERSOFT THRU 6799-EXIT
  8570     END-IF.
  8571
  8572     IF WS-LABELS-SW = 'N'
  8573         NEXT SENTENCE
  8574     ELSE
  8575         SET TB-INDX TO 1
  8576         MOVE ZEROS                  TO SEQ-COUNTER
  8577         PERFORM 6480-FORMAT-ADDRESS
  8578               VARYING TB-INDX FROM 1 BY 1 UNTIL
  8579               TB-INDX > 6.
  8580
  8581     MOVE ZEROS                  TO SEQ-COUNTER.
  8582     MOVE 'N'                    TO WS-SKIP-EMAIL
  8583     PERFORM 6470-FORMAT-TEXT THRU 6479-EXIT
  8584             VARYING TB-INDX FROM 8 BY 1
  8585             UNTIL TB-INDX > PI-TOTAL-LINES.
  8586     MOVE 'Y'                    TO WS-SKIP-EMAIL.
  8587     IF SEQ-COUNTER < +15
  8588      AND WS-SKIP-EMAIL EQUAL 'N'
  8589        MOVE ARCH-NUMBER         TO TRAN-DL2-ARCHNO
  8590        MOVE PI-PROCESSOR-ID     TO TRAN-DL2-USER
  8591        MOVE SPACES              TO TRAN-DL2-CCC
  8592        STRING PI-CARRIER ' ' PI-CLAIM-NO ' ' PI-CERT-NO
  8593           DELIMITED BY SIZE
  8594           INTO TRAN-DL2-CCC
  8595        END-STRING
  8596
  8597* EXEC CICS WRITEQ TD
  8598*          QUEUE ('BTCH')
  8599*          FROM (TRAN-DATA-LINE1)
  8600*          LENGTH (80)
  8601*       END-EXEC
  8602     MOVE 80
  8603       TO DFHEIV11
  8604     MOVE 'BTCH' TO DFHEIV5
  8605*    MOVE '(" L                  &   #00008306' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 170
* EL152.cbl
  8606     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8607     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8608     MOVE X'2020233030303038333036' TO DFHEIV0(25:11)
  8609     CALL 'kxdfhei1' USING DFHEIV0,
  8610           DFHEIV5,
  8611           TRAN-DATA-LINE1,
  8612           DFHEIV11,
  8613           DFHEIV99,
  8614           DFHEIV99
  8615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8616
  8617* EXEC CICS WRITEQ TD
  8618*          QUEUE ('BTCH')
  8619*          FROM (TRAN-DATA-LINE2)
  8620*          LENGTH (80)
  8621*       END-EXEC
  8622     MOVE 80
  8623       TO DFHEIV11
  8624     MOVE 'BTCH' TO DFHEIV5
  8625*    MOVE '(" L                  &   #00008311' TO DFHEIV0
  8626     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8627     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8628     MOVE X'2020233030303038333131' TO DFHEIV0(25:11)
  8629     CALL 'kxdfhei1' USING DFHEIV0,
  8630           DFHEIV5,
  8631           TRAN-DATA-LINE2,
  8632           DFHEIV11,
  8633           DFHEIV99,
  8634           DFHEIV99
  8635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8636
  8637* EXEC CICS WRITEQ TD
  8638*          QUEUE ('BTCH')
  8639*          FROM (TRAN-DATA-LINE3)
  8640*          LENGTH (80)
  8641*       END-EXEC
  8642     MOVE 80
  8643       TO DFHEIV11
  8644     MOVE 'BTCH' TO DFHEIV5
  8645*    MOVE '(" L                  &   #00008316' TO DFHEIV0
  8646     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8647     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8648     MOVE X'2020233030303038333136' TO DFHEIV0(25:11)
  8649     CALL 'kxdfhei1' USING DFHEIV0,
  8650           DFHEIV5,
  8651           TRAN-DATA-LINE3,
  8652           DFHEIV11,
  8653           DFHEIV99,
  8654           DFHEIV99
  8655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8656     END-IF
  8657     MOVE ER-0280                TO EMI-ERROR.
  8658
  8659     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8660     MOVE ARCH-NUMBER            TO ARCH-SUPPRESS
  8661     MOVE ARCH-EDIT              TO EMI-TEXT-VARIABLE (1).
  8662
  8663     GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 171
* EL152.cbl
  8664
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 172
* EL152.cbl
  8666 6470-FORMAT-TEXT.
  8667
  8668     IF REC-TEXT (TB-INDX) (1:16) = NAPERSOFT-LETTER
  8669         MOVE 'Y'                TO WS-SKIP-EMAIL
  8670     END-IF.
  8671
  8672     MOVE SPACES                 TO LETTER-ARCHIVE.
  8673     MOVE '3'                    TO LA-RECORD-TYPE
  8674                                    LA-RECORD-TYPE-A1.
  8675     MOVE 'LA'                   TO LA-RECORD-ID.
  8676     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8677                                    LA-ARCHIVE-NO-A1.
  8678     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8679                                    LA-LINE-SEQ-NO-A1.
  8680     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8681                                    LA-COMPANY-CD-A1.
  8682     MOVE REC-TEXT (TB-INDX)     TO LA-TEXT-LINE.
  8683     SET TB-INDX1 TO TB-INDX.
  8684     SET TB-INDX1 UP BY 1.
  8685     MOVE ZEROS                  TO INDX-WORK.
  8686
  8687 6472-LOOP.
  8688     IF TB-INDX1 < PI-TOTAL-LINES AND
  8689        REC-TEXT (TB-INDX1) = SPACES
  8690           SET TB-INDX1 UP BY 1
  8691           ADD 1                 TO INDX-WORK
  8692           GO TO 6472-LOOP.
  8693
  8694     IF REC-TEXT (TB-INDX1) = TOP-FORM
  8695        MOVE '99'                TO LA-SKIP-CONTROL
  8696        SET TB-INDX1 UP BY 1
  8697     ELSE
  8698        MOVE INDX-WORK           TO LA-SKIP-CONTROL.
  8699
  8700     SET TB-INDX TO TB-INDX1.
  8701     SET TB-INDX DOWN BY 1.
  8702     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8703     ADD 1 TO SEQ-COUNTER.
  8704
  8705 6479-EXIT.
  8706      EXIT.
  8707
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 173
* EL152.cbl
  8709 6480-FORMAT-ADDRESS.
  8710     MOVE SPACES                 TO LETTER-ARCHIVE.
  8711     MOVE '2'                    TO LA-RECORD-TYPE
  8712                                    LA-RECORD-TYPE-A1.
  8713     MOVE 'LA'                   TO LA-RECORD-ID.
  8714     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8715                                    LA-ARCHIVE-NO-A1.
  8716     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8717                                    LA-LINE-SEQ-NO-A1.
  8718     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8719                                    LA-COMPANY-CD-A1.
  8720     MOVE REC-TEXT (TB-INDX)     TO LA-ADDRESS-LINE.
  8721
  8722     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8723     ADD 1 TO SEQ-COUNTER.
  8724
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 174
* EL152.cbl
  8726 6490-WRITE-ARCHIVE.
  8727
  8728* EXEC CICS HANDLE CONDITION
  8729*        DUPKEY    (6499-EXIT)
  8730*    END-EXEC.
  8731*    MOVE '"$$                   ! * #00008392' TO DFHEIV0
  8732     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8734     MOVE X'2A20233030303038333932' TO DFHEIV0(25:11)
  8735     CALL 'kxdfhei1' USING DFHEIV0
  8736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8737
  8738
  8739*    IF PI-COMPANY-ID = 'DMD'
  8740*        MOVE LETTER-ARCHIVE     TO LETTER-ARCHIVE-TEMP
  8741*        MOVE 'LT'               TO LT-RECORD-ID
  8742*        EXEC CICS WRITE
  8743*            DATASET   (ARCT-ID)
  8744*            FROM      (LETTER-ARCHIVE-TEMP)
  8745*            RIDFLD    (LT-CONTROL-PRIMARY)
  8746*        END-EXEC.
  8747
  8748
  8749* EXEC CICS WRITE
  8750*         DATASET   (ARCH-ID)
  8751*         FROM      (LETTER-ARCHIVE)
  8752*         RIDFLD    (LA-CONTROL-PRIMARY)
  8753*    END-EXEC.
  8754     MOVE LENGTH OF
  8755      LETTER-ARCHIVE
  8756       TO DFHEIV11
  8757*    MOVE '&$ L                  ''   #00008405' TO DFHEIV0
  8758     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8760     MOVE X'2020233030303038343035' TO DFHEIV0(25:11)
  8761     CALL 'kxdfhei1' USING DFHEIV0,
  8762           ARCH-ID,
  8763           LETTER-ARCHIVE,
  8764           DFHEIV11,
  8765           LA-CONTROL-PRIMARY,
  8766           DFHEIV99,
  8767           DFHEIV99
  8768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8769
  8770
  8771 6499-EXIT.
  8772     EXIT.
  8773
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 175
* EL152.cbl
  8775 6500-BUILD-CORRESPOND.
  8776***************************************************************
  8777*    THIS ROUTINE WILL GET THE TRAILER SEQUENCE NUMBER FROM   *
  8778*    THE CLAIM MASTER AND BUILD A CORRESPONDENCE TRAILER      *
  8779*    USING THE NEW SEQUENCE NUMBER.                           *
  8780*    INPUT DATA FROM THE SCREEN IS USED TO CREATE THE NEW     *
  8781*    TRAILER RECORD.                                          *
  8782***************************************************************
  8783
  8784     MOVE PI-CLAIM-NO            TO CLAM-CLAIM.
  8785
  8786
  8787* EXEC CICS READ
  8788*         DATASET    (CLAM-ID)
  8789*         SET        (ADDRESS OF CLAIM-MASTER)
  8790*         RIDFLD     (CLAM-KEY)
  8791*         UPDATE
  8792*    END-EXEC.
  8793*    MOVE '&"S        EU         (   #00008426' TO DFHEIV0
  8794     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8795     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8796     MOVE X'2020233030303038343236' TO DFHEIV0(25:11)
  8797     CALL 'kxdfhei1' USING DFHEIV0,
  8798           CLAM-ID,
  8799           DFHEIV20,
  8800           DFHEIV99,
  8801           CLAM-KEY,
  8802           DFHEIV99,
  8803           DFHEIV99,
  8804           DFHEIV99
  8805     SET ADDRESS OF CLAIM-MASTER TO
  8806         DFHEIV20
  8807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8808
  8809
  8810     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  8811
  8812     IF FOLLOW-UP-SAVE > CL-NEXT-FOLLOWUP-DT
  8813        MOVE FOLLOW-UP-SAVE      TO CL-NEXT-FOLLOWUP-DT.
  8814
  8815     IF RESEND-SAVE > CL-NEXT-FOLLOWUP-DT
  8816        MOVE RESEND-SAVE         TO CL-NEXT-FOLLOWUP-DT.
  8817
  8818     IF MAINTI = 'C'
  8819        MOVE '2'                 TO CL-LAST-MAINT-TYPE.
  8820
  8821     IF MAINTI = 'R'
  8822        PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT
  8823        MOVE ACTV-SEQ            TO PI-ADDR-SEQ.
  8824
  8825*    IF PI-COMPANY-ID = 'DMD'
  8826*        MOVE 04                 TO CL-ACTIVITY-CODE.
  8827
  8828
  8829* EXEC CICS GETMAIN
  8830*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  8831*         INITIMG   (GETMAIN-SPACE)
  8832*         LENGTH    (ACTV-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 176
* EL152.cbl
  8833*    END-EXEC.
  8834*    MOVE ',"IL                  $   #00008451' TO DFHEIV0
  8835     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8836     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8837     MOVE X'2020233030303038343531' TO DFHEIV0(25:11)
  8838     CALL 'kxdfhei1' USING DFHEIV0,
  8839           DFHEIV20,
  8840           ACTV-LENGTH,
  8841           GETMAIN-SPACE
  8842     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8843         DFHEIV20
  8844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8845
  8846
  8847     MOVE 'AT'                   TO AT-RECORD-ID.
  8848     MOVE  4                     TO AT-TRAILER-TYPE.
  8849     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  8850                                    CL-LAST-MAINT-DT
  8851                                    AT-CORR-LAST-MAINT-DT
  8852     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  8853                                    CL-LAST-MAINT-USER
  8854                                    AT-CORR-LAST-UPDATED-BY
  8855     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  8856                                    CL-LAST-MAINT-HHMMSS.
  8857     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  8858     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  8859     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  8860                                    CORR-TRLR-SEQ.
  8861     MOVE CURRENT-SAVE           TO AT-LETTER-SENT-DT.
  8862     MOVE FOLLOW-UP-SAVE         TO AT-RECEIPT-FOLLOW-UP.
  8863     MOVE RESEND-SAVE            TO AT-AUTO-RE-SEND-DT.
  8864     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  8865                                    AT-LETTER-PURGED-DT.
  8866     MOVE ARCH-NUMBER            TO AT-LETTER-ARCHIVE-NO.
  8867     MOVE '1'                    TO AT-LETTER-ORIGIN.
  8868     MOVE PI-RESEND-FORM-NUMBER  TO AT-RESEND-LETTER-FORM.
  8869     MOVE PI-AUTO-CLOSE-IND      TO AT-AUTO-CLOSE-IND.
  8870     MOVE PI-LETTER-TO-BENE      TO AT-LETTER-TO-BENE.
  8871
  8872*    IF PI-COMPANY-ID = 'DMD'
  8873*        MOVE '1'                TO AT-DMD-LETTER-STATUS
  8874*        IF PI-BSR-AUTOMATED
  8875*            MOVE 'A'            TO AT-DMD-BSR-CODE.
  8876*
  8877     IF FORML  NOT = ZEROS
  8878        MOVE FORMI               TO AT-STD-LETTER-FORM
  8879     ELSE
  8880        MOVE SPACES              TO AT-STD-LETTER-FORM.
  8881
  8882     IF REL NOT = ZEROS
  8883        MOVE REI                 TO AT-REASON-TEXT
  8884     ELSE
  8885        MOVE SPACES              TO AT-REASON-TEXT.
  8886
  8887*    IF PI-COMPANY-ID = 'HAN'  OR  'JHL'
  8888*        MOVE AT-REASON-TEXT     TO WS-REASON-TEXT
  8889*        IF WS-RE-NDX NUMERIC  AND
  8890*           WS-RE-NDX > ZERO   AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 177
* EL152.cbl
  8891*           WS-RE-NDX < 33
  8892*            MOVE HAN-REASON-TEXT (WS-RE-NDX)
  8893*                                TO AT-REASON-TEXT.
  8894
  8895     MOVE PI-ADDR-SEQ            TO AT-ADDRESS-REC-SEQ-NO.
  8896
  8897     IF PI-ADDR-TYPE > SPACES
  8898         MOVE PI-ADDR-TYPE          TO AT-ADDRESEE-TYPE
  8899         MOVE REC-TEXT (1)          TO AT-ADDRESSEE-NAME
  8900     ELSE
  8901     IF W-ACCOUNT > ZEROS
  8902         MOVE 'A'                   TO AT-ADDRESEE-TYPE
  8903         MOVE SS06D                 TO AT-ADDRESSEE-NAME
  8904     ELSE
  8905     IF W-BENEFICIARY > ZEROS
  8906          MOVE 'B'                  TO AT-ADDRESEE-TYPE
  8907          IF W-BENEFICIARY = 9
  8908              MOVE SS61D            TO AT-ADDRESSEE-NAME
  8909            ELSE
  8910              MOVE SS43D            TO AT-ADDRESSEE-NAME
  8911     ELSE
  8912     IF W-EMPLOYER > ZEROS
  8913          MOVE 'E'                  TO AT-ADDRESEE-TYPE
  8914          MOVE SS48D                TO AT-ADDRESSEE-NAME
  8915     ELSE
  8916     IF W-INSURED > ZEROS
  8917          MOVE 'I'                  TO AT-ADDRESEE-TYPE
  8918          MOVE SS57D                TO AT-ADDRESSEE-NAME
  8919     ELSE
  8920     IF W-PHYSICIAN > ZEROS
  8921          MOVE 'P'                  TO AT-ADDRESEE-TYPE
  8922          MOVE SS47D                TO AT-ADDRESSEE-NAME
  8923     ELSE
  8924     IF W-OTHER-1 > ZEROS
  8925          MOVE 'O'                  TO AT-ADDRESEE-TYPE
  8926          MOVE SS49D                TO AT-ADDRESSEE-NAME
  8927     ELSE
  8928     IF W-OTHER-2 > ZEROS
  8929          MOVE 'Q'                  TO AT-ADDRESEE-TYPE
  8930          MOVE SS50D                TO AT-ADDRESSEE-NAME
  8931     ELSE
  8932          MOVE SPACES               TO AT-ADDRESEE-TYPE
  8933                                       AT-ADDRESSEE-NAME.
  8934     IF PRINT-PERFORMED
  8935        MOVE CURRENT-SAVE        TO AT-INITIAL-PRINT-DATE
  8936     ELSE
  8937        MOVE LOW-VALUES          TO AT-INITIAL-PRINT-DATE.
  8938
  8939     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE.
  8940
  8941*    IF PI-COMPANY-ID = 'DMD'
  8942*        MOVE CL-CERT-STATE          TO WS-DMD-CERT-STATE
  8943*        MOVE CL-CERT-GROUPING (5:2) TO WS-DMD-CERT-GROUPING
  8944*        MOVE BEN-HOLD               TO WS-DMD-BEN-CODE
  8945*        MOVE AT-SEQUENCE-NO         TO WS-DMD-CORR-TRLR-SEQ
  8946*        MOVE AT-STD-LETTER-FORM     TO WS-DMD-LETTER-FORM.
  8947
  8948
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 178
* EL152.cbl
  8949* EXEC CICS WRITE
  8950*         DATASET    (ACTV-ID)
  8951*         FROM       (ACTIVITY-TRAILERS)
  8952*         RIDFLD     (AT-CONTROL-PRIMARY)
  8953*    END-EXEC.
  8954     MOVE LENGTH OF
  8955      ACTIVITY-TRAILERS
  8956       TO DFHEIV11
  8957*    MOVE '&$ L                  ''   #00008558' TO DFHEIV0
  8958     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8959     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8960     MOVE X'2020233030303038353538' TO DFHEIV0(25:11)
  8961     CALL 'kxdfhei1' USING DFHEIV0,
  8962           ACTV-ID,
  8963           ACTIVITY-TRAILERS,
  8964           DFHEIV11,
  8965           AT-CONTROL-PRIMARY,
  8966           DFHEIV99,
  8967           DFHEIV99
  8968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8969
  8970
  8971
  8972* EXEC CICS HANDLE CONDITION
  8973*        DUPKEY      (6599-EXIT)
  8974*    END-EXEC.
  8975*    MOVE '"$$                   ! + #00008564' TO DFHEIV0
  8976     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8978     MOVE X'2B20233030303038353634' TO DFHEIV0(25:11)
  8979     CALL 'kxdfhei1' USING DFHEIV0
  8980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8981
  8982
  8983
  8984* EXEC CICS REWRITE
  8985*         DATASET    (CLAM-ID)
  8986*         FROM       (CLAIM-MASTER)
  8987*    END-EXEC.
  8988     MOVE LENGTH OF
  8989      CLAIM-MASTER
  8990       TO DFHEIV11
  8991*    MOVE '&& L                  %   #00008568' TO DFHEIV0
  8992     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8993     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8994     MOVE X'2020233030303038353638' TO DFHEIV0(25:11)
  8995     CALL 'kxdfhei1' USING DFHEIV0,
  8996           CLAM-ID,
  8997           CLAIM-MASTER,
  8998           DFHEIV11,
  8999           DFHEIV99
  9000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9001
  9002
  9003 6599-EXIT.
  9004      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 179
* EL152.cbl
  9006 6600-SET-ADDR-SEQ.
  9007     IF ADDRL = ZEROS
  9008        GO TO 6699-EXIT.
  9009
  9010     MOVE ADDRI                  TO PI-ADDR-TYPE
  9011                                    WS-ADDR-TYPE-CD.
  9012     IF WS-ADDR-SEQ NOT NUMERIC
  9013        GO TO 6699-EXIT.
  9014
  9015     MOVE ZEROS                  TO PI-ADDR-SEQ.
  9016
  9017     IF WS-ADDR-TYPE = 'I'
  9018        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9019     ELSE
  9020     IF WS-ADDR-TYPE = 'A'
  9021        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9022        ADD +20                  TO ACTV-SEQ
  9023     ELSE
  9024     IF WS-ADDR-TYPE = 'B'
  9025        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9026        ADD +10                  TO ACTV-SEQ
  9027     ELSE
  9028     IF WS-ADDR-TYPE = 'P'
  9029        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9030        ADD +30                  TO ACTV-SEQ
  9031     ELSE
  9032     IF WS-ADDR-TYPE = 'E'
  9033        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9034        ADD +40                  TO ACTV-SEQ
  9035     ELSE
  9036     IF WS-ADDR-TYPE = 'O'
  9037        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9038        ADD +50                  TO ACTV-SEQ
  9039     ELSE
  9040     IF WS-ADDR-TYPE = 'Q'
  9041        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9042        ADD +60                  TO ACTV-SEQ.
  9043
  9044 6699-EXIT.
  9045      EXIT.
  9046
  9047 6700-BUILD-NAPERSOFT.
  9048
  9049
  9050* EXEC CICS GETMAIN
  9051*         SET      (ADDRESS OF NAPERSOFT-FILE)
  9052*         LENGTH   (NAPS-LENGTH)
  9053*    END-EXEC.
  9054*    MOVE '," L                  $   #00008619' TO DFHEIV0
  9055     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9056     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9057     MOVE X'2020233030303038363139' TO DFHEIV0(25:11)
  9058     CALL 'kxdfhei1' USING DFHEIV0,
  9059           DFHEIV20,
  9060           NAPS-LENGTH,
  9061           DFHEIV99
  9062     SET ADDRESS OF NAPERSOFT-FILE TO
  9063         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 180
* EL152.cbl
  9064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9065
  9066
  9067     MOVE LOW-VALUES            TO  NAPERSOFT-FILE.
  9068     MOVE 'NA'                  TO  NA-RECORD-ID.
  9069     MOVE PI-COMPANY-CD         TO  NA-COMPANY-CD.
  9070     MOVE PI-CARRIER            TO  NA-CARRIER.
  9071     MOVE PI-CLAIM-NO           TO  NA-CLAIM-NO.
  9072     MOVE PI-CERT-NO            TO  NA-CERT-NO.
  9073     MOVE ARCH-NUMBER           TO  NA-ARCHIVE-NO.
  9074     MOVE FORMI                 TO  NA-LETTER-ID.
  9075     MOVE PI-PROCESSOR-ID       TO  NA-PROCESSOR-ID.
  9076     MOVE CURRENT-SAVE          TO  NA-CREATION-DT.
  9077     IF PRINT-PERFORMED
  9078         MOVE CURRENT-SAVE      TO  NA-INITIAL-PRINT-DT
  9079     ELSE
  9080         MOVE LOW-VALUES        TO  NA-INITIAL-PRINT-DT
  9081     END-IF.
  9082     MOVE FOLLOW-UP-SAVE        TO  NA-FOLLOW-UP-DT.
  9083     MOVE RESEND-SAVE           TO  NA-RESEND-DT
  9084     MOVE PI-RESEND-FORM-NUMBER TO  NA-RESEND-LETTER-ID.
  9085     IF COPIESL NOT = ZEROS
  9086         MOVE COPIESI           TO  NA-NO-OF-COPIES
  9087     ELSE
  9088         MOVE 1                 TO  NA-NO-OF-COPIES
  9089     END-IF.
  9090     IF PI-LETTER-ADDRESS-TYPE = ' 0'
  9091         MOVE LOW-VALUES        TO  NA-ADDRESS-TYPE
  9092     ELSE
  9093         MOVE PI-LETTER-ADDRESS-TYPE TO NA-ADDRESS-TYPE
  9094     END-IF.
  9095     MOVE CORR-TRLR-SEQ         TO  NA-CORR-TRLR-SEQ.
  9096     MOVE PI-ENCLOSURE-CD       TO  NA-ENCLOSURE-CD.
  9097
  9098
  9099* EXEC CICS WRITE
  9100*         DATASET    (NAPS-ID)
  9101*         FROM       (NAPERSOFT-FILE)
  9102*         RIDFLD     (NA-CONTROL-PRIMARY)
  9103*    END-EXEC.
  9104     MOVE LENGTH OF
  9105      NAPERSOFT-FILE
  9106       TO DFHEIV11
  9107*    MOVE '&$ L                  ''   #00008655' TO DFHEIV0
  9108     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9109     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9110     MOVE X'2020233030303038363535' TO DFHEIV0(25:11)
  9111     CALL 'kxdfhei1' USING DFHEIV0,
  9112           NAPS-ID,
  9113           NAPERSOFT-FILE,
  9114           DFHEIV11,
  9115           NA-CONTROL-PRIMARY,
  9116           DFHEIV99,
  9117           DFHEIV99
  9118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9119
  9120
  9121 6799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 181
* EL152.cbl
  9122      EXIT.
  9123
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 182
* EL152.cbl
  9125 7000-READ-ADDR.
  9126     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  9127        IF ADDRL = ZEROS
  9128           GO TO 7099-EXIT
  9129        ELSE
  9130           MOVE ER-0374             TO EMI-ERROR
  9131           MOVE -1                  TO ADDRL
  9132           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9133           GO TO 7099-EXIT.
  9134
  9135     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  9136                                    ACTV-CLAIM.
  9137
  9138
  9139* EXEC CICS HANDLE CONDITION
  9140*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  9141*         NOTFND     (7090-CLAIM-NOT-FOUND)
  9142*     END-EXEC.
  9143*    MOVE '"$JI                  ! , #00008678' TO DFHEIV0
  9144     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9145     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9146     MOVE X'2C20233030303038363738' TO DFHEIV0(25:11)
  9147     CALL 'kxdfhei1' USING DFHEIV0
  9148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9149
  9150
  9151
  9152* EXEC CICS READ
  9153*         DATASET    (CLAM-ID)
  9154*         SET        (ADDRESS OF CLAIM-MASTER)
  9155*         RIDFLD     (CLAM-KEY)
  9156*    END-EXEC.
  9157*    MOVE '&"S        E          (   #00008683' TO DFHEIV0
  9158     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9160     MOVE X'2020233030303038363833' TO DFHEIV0(25:11)
  9161     CALL 'kxdfhei1' USING DFHEIV0,
  9162           CLAM-ID,
  9163           DFHEIV20,
  9164           DFHEIV99,
  9165           CLAM-KEY,
  9166           DFHEIV99,
  9167           DFHEIV99,
  9168           DFHEIV99
  9169     SET ADDRESS OF CLAIM-MASTER TO
  9170         DFHEIV20
  9171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9172
  9173
  9174*    IF PI-COMPANY-ID = 'DMD'
  9175*            AND
  9176*       NOT SYSTEM-MODIFY-CAP
  9177*            AND
  9178*        HIGHEST-PRIORITY
  9179*        IF MAINTI = 'R'
  9180*            MOVE ER-0909        TO EMI-ERROR
  9181*            MOVE -1             TO ADDRL
  9182*            MOVE AL-UABON       TO ADDRA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 183
* EL152.cbl
  9183*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9184*            GO TO 8200-SEND-DATAONLY
  9185*        ELSE
  9186*            MOVE ER-0900        TO EMI-ERROR
  9187*            MOVE -1             TO ADDRL
  9188*            MOVE AL-UABON       TO ADDRA
  9189*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9190*            GO TO 8200-SEND-DATAONLY.
  9191
  9192     IF ADDRL = ZEROS
  9193        GO TO 7099-EXIT.
  9194
  9195*    IF PI-COMPANY-ID = 'DMD'
  9196*        IF MAINTI = 'C'
  9197*           IF CL-BENEFICIARY = '0000B0CA10' OR '0000B0CAN0' OR
  9198*                               '0000B0CAS0' OR '0000B0CA50' OR
  9199*                               '0000B0CAA0' OR '0000B0CAB0' OR
  9200*                               '0000B0CAC0' OR '0000B0CAD0' OR
  9201*                               '0000B0CO20' OR '0000B0MN10' OR
  9202*                               '0000B0MN20' OR '0000B0MN30' OR
  9203*                               '0000B0MN40' OR '0000B0MN50' OR
  9204*                               '0000B0MN60' OR '0000B0MN70'
  9205*           IF ADDRI(1:1) = 'B'
  9206*              MOVE ER-8158     TO EMI-ERROR
  9207*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9208*              MOVE -1          TO MAINTL
  9209*              GO TO 8200-SEND-DATAONLY.
  9210*
  9211*    IF PI-COMPANY-ID = 'DMD'
  9212*      PERFORM 4000-SET-BSR THRU 4000-EXIT
  9213*      IF PI-BSR-AUTOMATED
  9214*        IF MAINTI = 'C'
  9215*           MOVE ER-7843          TO EMI-ERROR
  9216*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9217*           MOVE -1               TO MAINTL
  9218*           GO TO 8200-SEND-DATAONLY.
  9219
  9220     PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT.
  9221
  9222     MOVE ADDRI TO WS-ADDR-TYPE-CD.
  9223
  9224*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9225*        GO TO 7040-READ-PRODUCER.
  9226
  9227 7010-READ-ACCT.
  9228
  9229     MOVE CL-CERT-GROUPING       TO ACCT-GROUPING.
  9230     MOVE CL-CERT-STATE          TO ACCT-STATE.
  9231     MOVE CL-CERT-ACCOUNT        TO ACCT-ACCOUNT.
  9232     MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DATE.
  9233
  9234
  9235* EXEC CICS HANDLE CONDITION
  9236*         NOTOPEN    (8880-ACCT-NOT-OPEN)
  9237*         NOTFND     (7080-ACCT-NOT-FOUND)
  9238*    END-EXEC.
  9239*    MOVE '"$JI                  ! - #00008749' TO DFHEIV0
  9240     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 184
* EL152.cbl
  9241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9242     MOVE X'2D20233030303038373439' TO DFHEIV0(25:11)
  9243     CALL 'kxdfhei1' USING DFHEIV0
  9244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9245
  9246
  9247     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
  9248
  9249     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  9250
  9251 7020-READNEXT.
  9252
  9253     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
  9254
  9255     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  9256        IF WS-SAVE-ACCT-RECORD = SPACES
  9257            GO TO 7080-ACCT-NOT-FOUND
  9258        ELSE
  9259            MOVE 'Y'                 TO  WS-ACCT-READ-SW
  9260            MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
  9261            MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
  9262            GO TO 7030-CONTINUE-BUILD-ADDR.
  9263
  9264     IF AM-EXPIRATION-DT = HIGH-VALUES
  9265         NEXT SENTENCE
  9266     ELSE
  9267         MOVE ACCOUNT-MASTER         TO  WS-SAVE-ACCT-RECORD
  9268         GO TO 7020-READNEXT.
  9269
  9270     MOVE AM-CONTROL-PRIMARY TO ACCT-KEY.
  9271     MOVE 'Y'                TO WS-ACCT-READ-SW.
  9272
  9273 7030-CONTINUE-BUILD-ADDR.
  9274
  9275     MOVE SPACES             TO  WS-SAVE-ACCT-RECORD.
  9276
  9277     IF WS-ADDR-TYPE-CD = 'A0'
  9278        MOVE ZEROS               TO PI-ADDR-SEQ
  9279     ELSE
  9280        GO TO 7067-CHECK-BENE-ADDR.
  9281
  9282     MOVE SPACES             TO               WS-LABEL-HOLD-AREA.
  9283     MOVE AM-NAME            TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9284     MOVE AM-PERSON          TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9285     MOVE AM-ADDRS           TO  REC-TEXT (3) WS-LABEL-LINES (3).
  9286*    MOVE AM-CITY            TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9287     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
  9288        INTO WS-LABEL-LINES (4)
  9289     END-STRING
  9290     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9291     MOVE SPACES             TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9292
  9293     MOVE SPACES             TO  WS-ZIP-CODE.
  9294
  9295     IF AM-CANADIAN-POST-CODE
  9296         MOVE AM-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9297         MOVE AM-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9298     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 185
* EL152.cbl
  9299         MOVE AM-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9300         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9301             MOVE '-'            TO  WS-AM-ZIP-DASH
  9302             MOVE AM-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9303
  9304     MOVE WS-ZIP-CODE        TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9305
  9306     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9307
  9308     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9309     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9310     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9311     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9312     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9313     MOVE WS-LABEL-LINES (6) TO  REC-TEXT (6)    SS05-6D.
  9314
  9315     GO TO 7099-EXIT.
  9316
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 186
* EL152.cbl
  9318*7040-READ-PRODUCER. Remove as dead code
  9319*7050-READNEXT. Remove as dead code
  9320*7060-CONTINUE-BUILD-ADDR. Remove as dead code
  9321 7067-CHECK-BENE-ADDR.
  9322
  9323*    IF PI-COMPANY-ID = 'DMD'
  9324*        IF WS-ADDR-TYPE-CD = 'B9'
  9325*            GO TO 7067-CHECK-BENE-ADDR-9.
  9326
  9327     IF WS-ADDR-TYPE-CD NOT = 'B0'
  9328         GO TO 7068-CONTINUE-BUILD-ADDR.
  9329
  9330     IF CL-BENEFICIARY = SPACES
  9331         GO TO 7070-ACTV-NOT-FOUND.
  9332
  9333
  9334* EXEC CICS HANDLE CONDITION
  9335*         NOTFND     (7070-ACTV-NOT-FOUND)
  9336*    END-EXEC.
  9337*    MOVE '"$I                   ! . #00008840' TO DFHEIV0
  9338     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9339     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9340     MOVE X'2E20233030303038383430' TO DFHEIV0(25:11)
  9341     CALL 'kxdfhei1' USING DFHEIV0
  9342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9343
  9344
  9345     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9346     MOVE 'B'                    TO BENE-REC-TYPE.
  9347     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9348
  9349
  9350* EXEC CICS READ
  9351*         DATASET    (BENE-ID)
  9352*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9353*         RIDFLD     (BENE-KEY)
  9354*    END-EXEC.
  9355*    MOVE '&"S        E          (   #00008848' TO DFHEIV0
  9356     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9357     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9358     MOVE X'2020233030303038383438' TO DFHEIV0(25:11)
  9359     CALL 'kxdfhei1' USING DFHEIV0,
  9360           BENE-ID,
  9361           DFHEIV20,
  9362           DFHEIV99,
  9363           BENE-KEY,
  9364           DFHEIV99,
  9365           DFHEIV99,
  9366           DFHEIV99
  9367     SET ADDRESS OF BENEFICIARY-MASTER TO
  9368         DFHEIV20
  9369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9370
  9371
  9372     MOVE SPACES              TO  WS-LABEL-HOLD-AREA.
  9373     MOVE BE-MAIL-TO-NAME     TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9374     MOVE BE-ADDRESS-LINE-1   TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9375     MOVE BE-ADDRESS-LINE-2   TO  REC-TEXT (3) WS-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 187
* EL152.cbl
  9376     MOVE BE-ADDRESS-LINE-3   TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9377*    MOVE BE-CITY-STATE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9378     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
  9379        INTO WS-LABEL-LINES (5)
  9380     END-STRING
  9381     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9382
  9383     MOVE SPACES              TO  WS-ZIP-CODE.
  9384     IF BE-CANADIAN-POST-CODE
  9385         MOVE BE-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9386         MOVE BE-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9387     ELSE
  9388         MOVE BE-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9389         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9390             MOVE '-'            TO  WS-AM-ZIP-DASH
  9391             MOVE BE-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9392
  9393     MOVE WS-ZIP-CODE         TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9394
  9395     GO TO 7069-SET-ADDR.
  9396
  9397 7067-CHECK-BENE-ADDR-9.
  9398
  9399     IF CL-BENEFICIARY = SPACES
  9400         GO TO 7070-ACTV-NOT-FOUND.
  9401
  9402
  9403* EXEC CICS HANDLE CONDITION
  9404*         NOTFND     (7070-ACTV-NOT-FOUND)
  9405*    END-EXEC.
  9406*    MOVE '"$I                   ! / #00008884' TO DFHEIV0
  9407     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9409     MOVE X'2F20233030303038383834' TO DFHEIV0(25:11)
  9410     CALL 'kxdfhei1' USING DFHEIV0
  9411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9412
  9413
  9414     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9415     MOVE 'B'                    TO BENE-REC-TYPE.
  9416     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9417
  9418
  9419* EXEC CICS READ
  9420*         DATASET    (BENE-ID)
  9421*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9422*         RIDFLD     (BENE-KEY)
  9423*    END-EXEC.
  9424*    MOVE '&"S        E          (   #00008892' TO DFHEIV0
  9425     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9427     MOVE X'2020233030303038383932' TO DFHEIV0(25:11)
  9428     CALL 'kxdfhei1' USING DFHEIV0,
  9429           BENE-ID,
  9430           DFHEIV20,
  9431           DFHEIV99,
  9432           BENE-KEY,
  9433           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 188
* EL152.cbl
  9434           DFHEIV99,
  9435           DFHEIV99
  9436     SET ADDRESS OF BENEFICIARY-MASTER TO
  9437         DFHEIV20
  9438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9439
  9440
  9441     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
  9442     MOVE BE-MAIL-TO-NAME2       TO REC-TEXT (1)
  9443                                    WS-LABEL-LINES (1).
  9444     MOVE BE-ADDRESS-LINE-12     TO REC-TEXT (2)
  9445                                    WS-LABEL-LINES (2).
  9446     MOVE BE-ADDRESS-LINE-22     TO REC-TEXT (3)
  9447                                    WS-LABEL-LINES (3).
  9448     MOVE BE-ADDRESS-LINE-32     TO REC-TEXT (4)
  9449                                    WS-LABEL-LINES (4).
  9450*    MOVE BE-CITY-STATE2         TO REC-TEXT (5)
  9451*                                   WS-LABEL-LINES (5).
  9452     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
  9453        INTO WS-LABEL-LINES (5)
  9454     END-STRING
  9455     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9456
  9457     MOVE SPACES                 TO WS-ZIP-CODE.
  9458
  9459     IF BE-CANADIAN-POST-CODE2
  9460         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
  9461         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
  9462     ELSE
  9463         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
  9464         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
  9465             MOVE '-'            TO WS-AM-ZIP-DASH
  9466             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
  9467
  9468     MOVE WS-ZIP-CODE            TO REC-TEXT (6)
  9469                                    WS-LABEL-LINES (6).
  9470
  9471     GO TO 7069-SET-ADDR.
  9472
  9473 7068-CONTINUE-BUILD-ADDR.
  9474
  9475     IF ACTV-SEQ = ZEROS
  9476        GO TO 7070-ACTV-NOT-FOUND.
  9477
  9478     MOVE ACTV-SEQ               TO PI-ADDR-SEQ.
  9479
  9480
  9481* EXEC CICS HANDLE CONDITION
  9482*         NOTOPEN    (8870-ACTV-NOT-OPEN)
  9483*         NOTFND     (7070-ACTV-NOT-FOUND)
  9484*    END-EXEC.
  9485*    MOVE '"$JI                  ! 0 #00008937' TO DFHEIV0
  9486     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9488     MOVE X'3020233030303038393337' TO DFHEIV0(25:11)
  9489     CALL 'kxdfhei1' USING DFHEIV0
  9490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9491
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 189
* EL152.cbl
  9492
  9493
  9494* EXEC CICS READ
  9495*         DATASET    (ACTV-ID)
  9496*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
  9497*         RIDFLD     (ACTV-KEY)
  9498*    END-EXEC.
  9499*    MOVE '&"S        E          (   #00008942' TO DFHEIV0
  9500     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9502     MOVE X'2020233030303038393432' TO DFHEIV0(25:11)
  9503     CALL 'kxdfhei1' USING DFHEIV0,
  9504           ACTV-ID,
  9505           DFHEIV20,
  9506           DFHEIV99,
  9507           ACTV-KEY,
  9508           DFHEIV99,
  9509           DFHEIV99,
  9510           DFHEIV99
  9511     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9512         DFHEIV20
  9513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9514
  9515
  9516     MOVE SPACES            TO              WS-LABEL-HOLD-AREA.
  9517     MOVE AT-MAIL-TO-NAME   TO REC-TEXT (1) WS-LABEL-LINES (1).
  9518     MOVE AT-ADDRESS-LINE-1 TO REC-TEXT (2) WS-LABEL-LINES (2).
  9519     MOVE AT-ADDRESS-LINE-2 TO REC-TEXT (3) WS-LABEL-LINES (3).
  9520*    MOVE AT-CITY-STATE     TO REC-TEXT (4) WS-LABEL-LINES (4).
  9521     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
  9522        INTO WS-LABEL-LINES (4)
  9523     END-STRING
  9524     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9525
  9526     MOVE SPACES            TO  WS-ZIP-CODE.
  9527     IF AT-CANADIAN-POST-CODE
  9528         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9529         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9530     ELSE
  9531         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
  9532         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9533             MOVE '-'            TO  WS-AM-ZIP-DASH
  9534             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9535
  9536     MOVE WS-ZIP-CODE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9537
  9538     MOVE SPACES            TO  REC-TEXT (6).
  9539
  9540 7069-SET-ADDR.
  9541     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9542
  9543     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9544     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9545     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9546     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9547     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9548     MOVE SPACES             TO  REC-TEXT (6)    SS05-6D.
  9549
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 190
* EL152.cbl
  9550     GO TO 7099-EXIT.
  9551
  9552 7070-ACTV-NOT-FOUND.
  9553
  9554     IF ACTV-SEQ NOT = +29
  9555        GO TO 7075-CONTINUE-ACTV-ERROR.
  9556
  9557*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9558*        GO TO 7099-EXIT.
  9559
  9560     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
  9561        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
  9562        GO TO 7075-CONTINUE-ACTV-ERROR.
  9563
  9564     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
  9565        GO TO 7075-CONTINUE-ACTV-ERROR.
  9566
  9567     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD
  9568     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER
  9569     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING
  9570     MOVE 'A'             TO WS-ERCOMP-TYPE
  9571     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9572                          TO WS-ERCOMP-RESP-NO.
  9573
  9574     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
  9575         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
  9576                                       'G' OR 'B'
  9577             MOVE 'G'            TO WS-ERCOMP-TYPE
  9578             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
  9579         ELSE
  9580             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9581                                 TO WS-ERCOMP-ACCOUNT
  9582     ELSE
  9583         MOVE 'G'                TO WS-ERCOMP-TYPE
  9584         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
  9585
  9586     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  9587        MOVE ZEROS TO WS-ERCOMP-CARRIER.
  9588
  9589     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  9590        MOVE ZEROS TO WS-ERCOMP-GROUPING.
  9591
  9592
  9593* EXEC CICS HANDLE CONDITION
  9594*         NOTFND    (7075-CONTINUE-ACTV-ERROR)
  9595*    END-EXEC.
  9596*    MOVE '"$I                   ! 1 #00009024' TO DFHEIV0
  9597     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9599     MOVE X'3120233030303039303234' TO DFHEIV0(25:11)
  9600     CALL 'kxdfhei1' USING DFHEIV0
  9601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9602
  9603
  9604
  9605* EXEC CICS  READ
  9606*         SET      (ADDRESS OF COMPENSATION-MASTER)
  9607*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 191
* EL152.cbl
  9608*         RIDFLD   (WS-ERCOMP-KEY)
  9609*    END-EXEC.
  9610     MOVE 'ERCOMP' TO DFHEIV1
  9611*    MOVE '&"S        E          (   #00009028' TO DFHEIV0
  9612     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9613     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9614     MOVE X'2020233030303039303238' TO DFHEIV0(25:11)
  9615     CALL 'kxdfhei1' USING DFHEIV0,
  9616           DFHEIV1,
  9617           DFHEIV20,
  9618           DFHEIV99,
  9619           WS-ERCOMP-KEY,
  9620           DFHEIV99,
  9621           DFHEIV99,
  9622           DFHEIV99
  9623     SET ADDRESS OF COMPENSATION-MASTER TO
  9624         DFHEIV20
  9625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9626
  9627
  9628     MOVE 'Y'                   TO WS-COMP-READ-SW.
  9629     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
  9630     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
  9631
  9632     IF CO-ACCT-NAME = SPACES
  9633        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
  9634
  9635     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
  9636     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
  9637     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
  9638
  9639     MOVE SPACES                TO  WS-ZIP-CODE.
  9640     IF CO-CANADIAN-POST-CODE
  9641         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
  9642         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
  9643     ELSE
  9644         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
  9645         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9646             MOVE '-'           TO  WS-AM-ZIP-DASH
  9647             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
  9648
  9649     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
  9650
  9651     MOVE ZEROS                 TO WS-PHONE-IN.
  9652     MOVE CO-AREA-CODE          TO WSPO-AREA.
  9653     MOVE CO-PREFIX             TO WSPO-PFX.
  9654     MOVE CO-PHONE              TO WSPO-SFX.
  9655     MOVE WS-PHONE-OUT          TO SS53-6D.
  9656
  9657     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9658
  9659     MOVE WS-LABEL-LINES (1)     TO REC-TEXT (1)    SS52D.
  9660     MOVE WS-LABEL-LINES (2)     TO REC-TEXT (2)    SS53-1D.
  9661     MOVE WS-LABEL-LINES (3)     TO REC-TEXT (3)    SS53-2D.
  9662     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)    SS53-3D.
  9663     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)    SS53-4D.
  9664     MOVE WS-LABEL-LINES (6)     TO REC-TEXT (6)    SS53-5D.
  9665
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 192
* EL152.cbl
  9666     GO TO 7099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 193
* EL152.cbl
  9668
  9669 7075-CONTINUE-ACTV-ERROR.
  9670     MOVE ER-0178                TO EMI-ERROR.
  9671     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9672     MOVE -1                     TO ADDRL.
  9673     MOVE AL-UABON               TO ADDRA.
  9674     MOVE SPACES                 TO PI-ADDR-TYPE.
  9675     MOVE SPACES                 TO REC-TEXT (1)
  9676                                    REC-TEXT (2)
  9677                                    REC-TEXT (3)
  9678                                    REC-TEXT (4)
  9679                                    REC-TEXT (5)
  9680                                    REC-TEXT (6).
  9681     GO TO 7099-EXIT.
  9682
  9683 7080-ACCT-NOT-FOUND.
  9684     MOVE ER-0179                TO EMI-ERROR.
  9685     MOVE -1                     TO ADDRL.
  9686     MOVE AL-UABON               TO ADDRA.
  9687     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9688     GO TO 8200-SEND-DATAONLY.
  9689
  9690 7090-CLAIM-NOT-FOUND.
  9691     MOVE ER-0186                TO EMI-ERROR.
  9692     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9693     GO TO 8200-SEND-DATAONLY.
  9694
  9695*7095-PROD-NOT-FOUND. Remove as dead code
  9696
  9697 7099-EXIT.
  9698      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 194
* EL152.cbl
  9700
  9701 7170-FORMAT-SCREEN.
  9702     IF MAINTI = 'S'
  9703        MOVE AL-PANOF            TO SC-TEXTA (SC-INDX)
  9704       ELSE
  9705        MOVE AL-UANOF            TO SC-TEXTA (SC-INDX).
  9706
  9707     IF TB-INDX < 7
  9708        SET LINE23 TO TB-INDX
  9709        MOVE 'A'                 TO LINE1
  9710       ELSE
  9711        IF TB-INDX = 7
  9712           MOVE ZEROS            TO LINE-NUM
  9713        ELSE
  9714           SET LIN-NUM TO TB-INDX
  9715           SUBTRACT 7            FROM LIN-NUM.
  9716
  9717     MOVE LINE-NUM               TO SC-LINE (SC-INDX).
  9718     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  9719     SET TB-INDX UP BY 1.
  9720
  9721 7170-EXIT.
  9722      EXIT.
  9723
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 195
* EL152.cbl
  9725 7200-RESOLVE-VARIABLES.
  9726***************************************************************
  9727*    THIS ROUTINE WILL FORMAT THE SYSTEM-DEFINED SYMBOLS      *
  9728*    WITH DATA PERTAINING TO THE DESIGNATED CLAIM.            *
  9729*    THIS ROUTINE IS PERFORMED THRU 7269-EXIT TO              *
  9730*    RESOLVE ALL OF THE SYMBOLS.                              *
  9731***************************************************************
  9732
  9733*    IF PI-COMPANY-ID = 'AUK'
  9734*        MOVE 'Y'                TO W-REVERSE-DATE-SW.
  9735
  9736     MOVE PI-CLAIM-NO            TO SS34D.
  9737
  9738     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9739        MOVE PI-LIFE-OVERRIDE-L6 TO SS12D
  9740     ELSE
  9741        MOVE PI-AH-OVERRIDE-L6   TO SS12D.
  9742
  9743     MOVE CL-LAST-PMT-AMT        TO SS16D.
  9744     MOVE CL-TOTAL-PAID-AMT      TO SS18D.
  9745     MOVE CL-CAUSE-CD            TO SS19-1D.
  9746     MOVE CL-ASSOC-CERT-SEQU     TO SS54D.
  9747     MOVE CL-ASSOC-CERT-TOTAL    TO SS55D.
  9748
  9749*    IF PI-COMPANY-ID NOT = 'DMD'
  9750*        GO TO 7200-CONTINUE.
  9751
  9752     IF CL-CCN-PREFIX-A5 = '1111' OR '3333' OR '6666' OR
  9753                           '8888' OR '9876'
  9754         MOVE CL-CCN-PRIME-A5    TO WS-CCN-12
  9755         MOVE WS-CCN-12          TO CL-CCN.
  9756
  9757     IF CL-CERT-STATE NOT = '08' AND '09'
  9758         MOVE SPACES             TO SS62D
  9759                                    SS63D
  9760         GO TO 7200-CONTINUE.
  9761
  9762     MOVE WS-DMD-UND-STATEMENT   TO SS62D.
  9763
  9764     MOVE 'CL'                   TO DL23-SYSTEM-ID.
  9765     MOVE 'UN'                   TO DL23-RECORD-TYPE.
  9766     MOVE CL-CERT-STATE          TO DL23-RECORD-KEY.
  9767
  9768
  9769* EXEC CICS LINK
  9770*        PROGRAM    ('DLO023')
  9771*        COMMAREA   (WS-DLO-CODES-TABLE)
  9772*        LENGTH     (DL23-COMM-LENGTH)
  9773*    END-EXEC.
  9774     MOVE 'DLO023' TO DFHEIV1
  9775*    MOVE '."C                   ''   #00009174' TO DFHEIV0
  9776     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9777     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9778     MOVE X'2020233030303039313734' TO DFHEIV0(25:11)
  9779     CALL 'kxdfhei1' USING DFHEIV0,
  9780           DFHEIV1,
  9781           WS-DLO-CODES-TABLE,
  9782           DL23-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 196
* EL152.cbl
  9783           DFHEIV99,
  9784           DFHEIV99,
  9785           DFHEIV99
  9786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9787
  9788
  9789     IF DL23-RETURN-CODE = 'OK'
  9790         MOVE DL23-CODE-DESC     TO SS63D
  9791       ELSE
  9792         MOVE SPACES             TO SS63D.
  9793
  9794 7200-CONTINUE.
  9795     MOVE CL-CCN                 TO SS60D.
  9796
  9797     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  9798     MOVE SPACES                 TO DC-OPTION-CODE.
  9799     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9800     IF NO-CONVERSION-ERROR
  9801        MOVE DC-GREG-DATE-1-EDIT TO SS13D.
  9802
  9803     MOVE CL-REPORTED-DT         TO DC-BIN-DATE-1.
  9804     MOVE SPACES                 TO DC-OPTION-CODE.
  9805     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9806     IF NO-CONVERSION-ERROR
  9807        MOVE DC-GREG-DATE-1-EDIT TO SS14D.
  9808
  9809     MOVE CL-LAST-PMT-DT         TO DC-BIN-DATE-1.
  9810     MOVE SPACES                 TO DC-OPTION-CODE.
  9811     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9812     IF NO-CONVERSION-ERROR
  9813        MOVE DC-GREG-DATE-1-EDIT TO SS15D.
  9814
  9815     IF NOT PI-USES-PAID-TO
  9816        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
  9817        MOVE SPACES                 TO DC-OPTION-CODE
  9818        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9819        IF NO-CONVERSION-ERROR
  9820           MOVE DC-GREG-DATE-1-EDIT TO SS17D
  9821        ELSE
  9822           MOVE SPACES TO SS17D
  9823     ELSE
  9824        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
  9825        MOVE '6'                    TO DC-OPTION-CODE
  9826        MOVE +1                     TO DC-ELAPSED-DAYS
  9827        MOVE +0                     TO DC-ELAPSED-MONTHS
  9828        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  9829        IF NO-CONVERSION-ERROR
  9830           MOVE DC-GREG-DATE-1-EDIT TO SS17D.
  9831
  9832     MOVE CL-INSURED-BIRTH-DT    TO DC-BIN-DATE-1.
  9833     MOVE SPACES                 TO DC-OPTION-CODE.
  9834     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9835     IF NO-CONVERSION-ERROR
  9836        MOVE DC-GREG-DATE-1-EDIT TO SS45D
  9837     ELSE
  9838        MOVE '@@DOB'             TO SS45D.
  9839
  9840     IF CL-SSN-STATE   = CL-CERT-STATE  AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 197
* EL152.cbl
  9841        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
  9842             NEXT SENTENCE
  9843         ELSE
  9844             MOVE CL-SOC-SEC-NO  TO SS46D.
  9845
  9846     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
  9847                                    ACCT-GROUPING
  9848                                    PROD-GROUPING
  9849                                    PLCY-GROUPING
  9850                                    PLAN-GROUPING.
  9851     MOVE CL-CERT-STATE          TO CERT-STATE
  9852                                    ACCT-STATE
  9853                                    PROD-STATE
  9854                                    PLCY-STATE
  9855                                    PLAN-STATE.
  9856     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9857                                    ACCT-ACCOUNT
  9858                                    PROD-PRODUCER
  9859                                    PLCY-PRODUCER
  9860                                    PLAN-PRODUCER.
  9861     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT
  9862                                    PLCY-EFF-DT.
  9863     MOVE CL-CV-REFERENCE-NO     TO PLCY-REFERENCE-NO.
  9864
  9865     PERFORM 5000-MOVE-NAME THRU 5000-EXIT.
  9866
  9867*    IF PI-COMPANY-ID = 'DMD'
  9868*       MOVE WS-NAME-WORK           TO SS10D
  9869*       GO TO 7200-CONTINUE-2.
  9870
  9871     IF LOWER-CASE-LETTERS-USED
  9872        MOVE 'N'                    TO WS-STATE-LINE
  9873        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
  9874        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
  9875        MOVE WS-TEMP-AREA2          TO SS10D
  9876     ELSE
  9877        MOVE WS-NAME-WORK           TO SS10D.
  9878
  9879 7200-CONTINUE-2.
  9880     MOVE CL-INSURED-1ST-NAME     TO W-FIRST-NAME.
  9881     MOVE CL-INSURED-LAST-NAME    TO W-LAST-NAME.
  9882     MOVE CL-INSURED-MID-INIT     TO W-MIDDLE-NAME.
  9883     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9884
  9885     IF LOWER-CASE-LETTERS-USED
  9886        MOVE 'N'                    TO WS-STATE-LINE
  9887        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
  9888        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
  9889        MOVE WS-TEMP-AREA2          TO SS39D
  9890     ELSE
  9891        MOVE WS-NAME-WORK           TO SS39D.
  9892
  9893     MOVE CL-INSURED-LAST-NAME   TO SS40D.
  9894
  9895     IF INSURED-IS-FEMALE
  9896        MOVE 'MS.'               TO SS41D
  9897       ELSE
  9898        MOVE 'MR.'               TO SS41D.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 198
* EL152.cbl
  9899
  9900*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9901*        PERFORM 7290-RESOLVE-CREDITOR THRU 7290-EXIT.
  9902
  9903*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9904*        GO TO 7200-READ-EMPLCY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 199
* EL152.cbl
  9906
  9907* EXEC CICS HANDLE CONDITION
  9908*         NOTOPEN   (8900-CERT-NOT-OPEN)
  9909*         NOTFND    (8910-CERT-NOT-FOUND)
  9910*    END-EXEC.
  9911*    MOVE '"$JI                  ! 2 #00009297' TO DFHEIV0
  9912     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9914     MOVE X'3220233030303039323937' TO DFHEIV0(25:11)
  9915     CALL 'kxdfhei1' USING DFHEIV0
  9916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9917
  9918
  9919
  9920* EXEC CICS READ
  9921*         DATASET   (CERT-ID)
  9922*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9923*         RIDFLD    (CERT-KEY)
  9924*    END-EXEC.
  9925*    MOVE '&"S        E          (   #00009302' TO DFHEIV0
  9926     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9927     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9928     MOVE X'2020233030303039333032' TO DFHEIV0(25:11)
  9929     CALL 'kxdfhei1' USING DFHEIV0,
  9930           CERT-ID,
  9931           DFHEIV20,
  9932           DFHEIV99,
  9933           CERT-KEY,
  9934           DFHEIV99,
  9935           DFHEIV99,
  9936           DFHEIV99
  9937     SET ADDRESS OF CERTIFICATE-MASTER TO
  9938         DFHEIV20
  9939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9940
  9941
  9942*    IF PI-COMPANY-ID = 'DMD'
  9943*        MOVE CM-RESIDENT-STATE  TO WS-DMD-RES-ST
  9944*        IF CM-POLICY-FORM-NO(6:1) = '1'
  9945*            MOVE WS-DMD-UND-COMPANYA    TO SS64D
  9946*          ELSE
  9947*        IF CM-POLICY-FORM-NO(6:1) = '2'
  9948*            MOVE WS-DMD-UND-COMPANYB    TO SS64D
  9949*          ELSE
  9950*            MOVE SPACES                 TO SS64D.
  9951
  9952     MOVE CM-CERT-NO             TO SS26D.
  9953     MOVE CM-INSURED-ISSUE-AGE   TO SS33D.
  9954
  9955*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9956*        MOVE CL-CURRENT-CARRIER TO SS23D
  9957*        MOVE CL-CURRENT-GROUPING
  9958*                                TO SS24D
  9959*        MOVE CL-CURRENT-ACCOUNT TO SS25D
  9960*        MOVE CM-MEMBER-NO       TO SS36D
  9961*        MOVE CM-GROUPING        TO W-GROUPING
  9962*        IF W-GROUP-3 = 'C01' OR 'C02'
  9963*            MOVE CM-MEMBER-NO   TO W-CURRENT-LOAN-NO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 200
* EL152.cbl
  9964*            MOVE CM-LOAN-NUMBER TO W-LOAN-NO
  9965*            MOVE W-CREDIT-CARD-LOAN-NO
  9966*                                TO SS36-1D
  9967*        ELSE
  9968*            MOVE CM-MEMBER-NO   TO SS36-1D
  9969*    ELSE
  9970         MOVE CM-CARRIER         TO SS23D.
  9971         MOVE CM-GROUPING        TO SS24D.
  9972         MOVE CM-ACCOUNT         TO SS25D.
  9973         MOVE CM-LOAN-NUMBER     TO SS36D.
  9974
  9975     MOVE CM-LOAN-BALANCE        TO SS37D.
  9976     MOVE CM-MEMBER-NO           TO SS38D.
  9977
  9978     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
  9979     MOVE SPACES                 TO DC-OPTION-CODE.
  9980     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9981     IF NO-CONVERSION-ERROR
  9982        MOVE DC-GREG-DATE-1-EDIT TO SS27D.
  9983
  9984     MOVE CM-INSURED-FIRST-NAME  TO W-FIRST-NAME.
  9985     MOVE CM-INSURED-LAST-NAME   TO W-LAST-NAME.
  9986     MOVE CM-INSURED-INITIAL2    TO W-MIDDLE-NAME.
  9987     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9988
  9989     IF LOWER-CASE-LETTERS-USED
  9990         MOVE 'N'                TO WS-STATE-LINE
  9991         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
  9992         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
  9993         MOVE WS-TEMP-AREA2      TO SS57D
  9994     ELSE
  9995         MOVE WS-NAME-WORK       TO SS57D.
  9996
  9997     MOVE CM-JT-FIRST-NAME       TO W-FIRST-NAME.
  9998     MOVE CM-JT-LAST-NAME        TO W-LAST-NAME.
  9999     MOVE CM-JT-INITIAL          TO W-MIDDLE-NAME.
 10000     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10001
 10002     IF LOWER-CASE-LETTERS-USED
 10003         MOVE 'N'                TO WS-STATE-LINE
 10004         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10005         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10006         MOVE WS-TEMP-AREA2      TO SS58D
 10007     ELSE
 10008         MOVE WS-NAME-WORK       TO SS58D.
 10009
 10010     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10011        MOVE CM-LF-BENEFIT-CD    TO BEN-HOLD
 10012        MOVE CM-LF-ORIG-TERM     TO SS29D
 10013        MOVE CM-LF-BENEFIT-AMT   TO SS30D
 10014        MOVE CM-POLICY-FORM-NO   TO SS32D
 10015        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
 10016     ELSE
 10017        MOVE CM-AH-BENEFIT-CD    TO BEN-HOLD
 10018        MOVE CM-AH-ORIG-TERM     TO SS29D
 10019        MOVE CM-AH-BENEFIT-AMT   TO SS30D
 10020        MOVE CM-POLICY-FORM-NO   TO SS32D
 10021        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 201
* EL152.cbl
 10022
 10023     COMPUTE WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 10024
 10025     MOVE WORK-AMOUNT            TO SS51D.
 10026
 10027     MOVE SPACES                 TO DC-OPTION-CODE.
 10028     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10029     IF NO-CONVERSION-ERROR
 10030        MOVE DC-GREG-DATE-1-EDIT TO SS31D.
 10031
 10032     MOVE ' '                         TO  DC-OPTION-CODE.
 10033     MOVE +0                          TO  DC-ELAPSED-MONTHS
 10034                                          DC-ELAPSED-DAYS.
 10035
 10036     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10037         MOVE CM-LF-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10038         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10039         IF NO-CONVERSION-ERROR
 10040             MOVE DC-GREG-DATE-1-EDIT TO  SS28D
 10041         ELSE
 10042             NEXT SENTENCE
 10043     ELSE
 10044         MOVE CM-AH-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10045         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10046         IF NO-CONVERSION-ERROR
 10047             MOVE DC-GREG-DATE-1-EDIT TO  SS28D.
 10048
 10049*    GO TO 7200-READ-DIAGNOSIS.
 10050
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 202
* EL152.cbl
 10052*7200-READ-EMPLCY. Remove as dead code
 10053 7200-READ-DIAGNOSIS.
 10054
 10055* EXEC CICS HANDLE CONDITION
 10056*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10057*         NOTFND     (7200-READ-LOAN-NUMBER)
 10058*    END-EXEC.
 10059*    MOVE '"$JI                  ! 3 #00009420' TO DFHEIV0
 10060     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10061     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10062     MOVE X'3320233030303039343230' TO DFHEIV0(25:11)
 10063     CALL 'kxdfhei1' USING DFHEIV0
 10064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10065
 10066
 10067     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10068     MOVE +90                   TO ACTV-SEQ.
 10069
 10070
 10071* EXEC CICS READ
 10072*         DATASET  (ACTV-ID)
 10073*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10074*         RIDFLD   (ACTV-KEY)
 10075*    END-EXEC.
 10076*    MOVE '&"S        E          (   #00009428' TO DFHEIV0
 10077     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10078     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10079     MOVE X'2020233030303039343238' TO DFHEIV0(25:11)
 10080     CALL 'kxdfhei1' USING DFHEIV0,
 10081           ACTV-ID,
 10082           DFHEIV20,
 10083           DFHEIV99,
 10084           ACTV-KEY,
 10085           DFHEIV99,
 10086           DFHEIV99,
 10087           DFHEIV99
 10088     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10089         DFHEIV20
 10090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10091
 10092
 10093     IF AT-TRAILER-TYPE = '6'
 10094        MOVE AT-INFO-LINE-1         TO SS19D.
 10095
 10096 7200-READ-LOAN-NUMBER.
 10097
 10098
 10099* EXEC CICS HANDLE CONDITION
 10100*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10101*         NOTFND     (7201-READ-BENEFICIARY)
 10102*    END-EXEC.
 10103*    MOVE '"$JI                  ! 4 #00009439' TO DFHEIV0
 10104     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10106     MOVE X'3420233030303039343339' TO DFHEIV0(25:11)
 10107     CALL 'kxdfhei1' USING DFHEIV0
 10108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10109
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 203
* EL152.cbl
 10110
 10111     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10112     MOVE +91                   TO ACTV-SEQ.
 10113
 10114
 10115* EXEC CICS READ
 10116*         DATASET  (ACTV-ID)
 10117*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10118*         RIDFLD   (ACTV-KEY)
 10119*    END-EXEC.
 10120*    MOVE '&"S        E          (   #00009447' TO DFHEIV0
 10121     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10122     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10123     MOVE X'2020233030303039343437' TO DFHEIV0(25:11)
 10124     CALL 'kxdfhei1' USING DFHEIV0,
 10125           ACTV-ID,
 10126           DFHEIV20,
 10127           DFHEIV99,
 10128           ACTV-KEY,
 10129           DFHEIV99,
 10130           DFHEIV99,
 10131           DFHEIV99
 10132     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10133         DFHEIV20
 10134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10135
 10136
 10137     IF AT-TRAILER-TYPE = '6'
 10138        MOVE AT-INFO-LINE-1         TO SS19-2D.
 10139
 10140 7201-READ-BENEFICIARY.
 10141     IF CL-BENIF-ADDR-CNT = +0  AND
 10142        CL-BENEFICIARY = SPACES
 10143          GO TO 7205-READ-PHYSICIAN-ADDR.
 10144
 10145     IF W-BENEFICIARY > ZERO
 10146         COMPUTE ACTV-SEQ = W-BENEFICIARY + 10
 10147     ELSE
 10148         MOVE CL-BENIF-ADDR-CNT  TO ACTV-SEQ
 10149         ADD +10                 TO ACTV-SEQ.
 10150
 10151
 10152* EXEC CICS HANDLE CONDITION
 10153*         NOTOPEN    (7290-BENE-NOT-OPEN)
 10154*         NOTFND     (7205-READ-PHYSICIAN-ADDR)
 10155*    END-EXEC.
 10156*    MOVE '"$JI                  ! 5 #00009467' TO DFHEIV0
 10157     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10158     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10159     MOVE X'3520233030303039343637' TO DFHEIV0(25:11)
 10160     CALL 'kxdfhei1' USING DFHEIV0
 10161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10162
 10163
 10164     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10165
 10166     IF ACTV-SEQ = +19
 10167         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 204
* EL152.cbl
 10168     ELSE
 10169         IF ACTV-SEQ NOT = +10
 10170             GO TO 7202-GET-FROM-ACTIVITY.
 10171
 10172     MOVE PI-COMPANY-CD        TO BENE-COMP-CD.
 10173     MOVE 'B'                  TO BENE-REC-TYPE.
 10174     MOVE CL-BENEFICIARY       TO BENE-NUMBER.
 10175
 10176
 10177* EXEC CICS READ
 10178*         DATASET    (BENE-ID)
 10179*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 10180*         RIDFLD     (BENE-KEY)
 10181*    END-EXEC.
 10182*    MOVE '&"S        E          (   #00009484' TO DFHEIV0
 10183     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10184     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10185     MOVE X'2020233030303039343834' TO DFHEIV0(25:11)
 10186     CALL 'kxdfhei1' USING DFHEIV0,
 10187           BENE-ID,
 10188           DFHEIV20,
 10189           DFHEIV99,
 10190           BENE-KEY,
 10191           DFHEIV99,
 10192           DFHEIV99,
 10193           DFHEIV99
 10194     SET ADDRESS OF BENEFICIARY-MASTER TO
 10195         DFHEIV20
 10196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10197
 10198
 10199*    IF PI-COMPANY-ID = 'DMD'
 10200*        MOVE BE-BSR             TO PI-ELBENE-BSR.
 10201
 10202 7201-CONT.
 10203     MOVE BE-MAIL-TO-NAME2       TO WS-LABEL-LINES (1).
 10204     MOVE BE-ADDRESS-LINE-12     TO WS-LABEL-LINES (2).
 10205     MOVE BE-ADDRESS-LINE-22     TO WS-LABEL-LINES (3).
 10206     MOVE BE-ADDRESS-LINE-32     TO WS-LABEL-LINES (4).
 10207*    MOVE BE-CITY-STATE2         TO WS-LABEL-LINES (5).
 10208     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
 10209        INTO WS-LABEL-LINES (5)
 10210     END-STRING
 10211
 10212     MOVE SPACES                 TO WS-ZIP-CODE.
 10213
 10214     IF BE-CANADIAN-POST-CODE2
 10215         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
 10216         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
 10217     ELSE
 10218         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
 10219         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
 10220             MOVE '-'            TO WS-AM-ZIP-DASH
 10221             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
 10222
 10223     MOVE WS-ZIP-CODE            TO WS-LABEL-LINES (6).
 10224
 10225     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 205
* EL152.cbl
 10226
 10227     MOVE WS-LABEL-LINES (1)     TO SS61D.
 10228     MOVE WS-LABEL-LINES (2)     TO SS61-1D.
 10229     MOVE WS-LABEL-LINES (3)     TO SS61-2D.
 10230     MOVE WS-LABEL-LINES (4)     TO SS61-3D.
 10231     MOVE WS-LABEL-LINES (5)     TO SS61-4D.
 10232     MOVE WS-LABEL-LINES (6)     TO SS61-5D.
 10233
 10234     MOVE BE-PHONE-NO2           TO WS-PHONE-IN.
 10235     MOVE WSPI-AREA              TO WSPO-AREA.
 10236     MOVE WSPI-PFX               TO WSPO-PFX.
 10237     MOVE WSPI-SFX               TO WSPO-SFX.
 10238     MOVE WS-PHONE-OUT           TO SS61-6D.
 10239
 10240 7201-CONT-PROCESS.
 10241     MOVE BE-MAIL-TO-NAME      TO  WS-LABEL-LINES (1).
 10242     MOVE BE-ADDRESS-LINE-1    TO  WS-LABEL-LINES (2).
 10243     MOVE BE-ADDRESS-LINE-2    TO  WS-LABEL-LINES (3).
 10244     MOVE BE-ADDRESS-LINE-3    TO  WS-LABEL-LINES (4).
 10245*    MOVE BE-CITY-STATE        TO  WS-LABEL-LINES (5).
 10246     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
 10247        INTO WS-LABEL-LINES (5)
 10248     END-STRING
 10249
 10250     MOVE SPACES               TO  WS-ZIP-CODE.
 10251     IF BE-CANADIAN-POST-CODE
 10252         MOVE BE-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 10253         MOVE BE-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 10254     ELSE
 10255         MOVE BE-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 10256         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10257             MOVE '-'          TO  WS-AM-ZIP-DASH
 10258             MOVE BE-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 10259
 10260     MOVE WS-ZIP-CODE          TO  WS-LABEL-LINES (6).
 10261
 10262     MOVE BE-PHONE-NO          TO  WS-PHONE-IN.
 10263
 10264     GO TO 7204-SET-PHONE.
 10265
 10266 7202-GET-FROM-ACTIVITY.
 10267
 10268* EXEC CICS READ
 10269*         DATASET  (ACTV-ID)
 10270*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10271*         RIDFLD   (ACTV-KEY)
 10272*    END-EXEC.
 10273*    MOVE '&"S        E          (   #00009558' TO DFHEIV0
 10274     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10275     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10276     MOVE X'2020233030303039353538' TO DFHEIV0(25:11)
 10277     CALL 'kxdfhei1' USING DFHEIV0,
 10278           ACTV-ID,
 10279           DFHEIV20,
 10280           DFHEIV99,
 10281           ACTV-KEY,
 10282           DFHEIV99,
 10283           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 206
* EL152.cbl
 10284           DFHEIV99
 10285     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10286         DFHEIV20
 10287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10288
 10289
 10290     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10291     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10292     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10293*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10294     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10295        INTO WS-LABEL-LINES (4)
 10296     END-STRING
 10297
 10298     MOVE SPACES                 TO  WS-ZIP-CODE.
 10299     IF AT-CANADIAN-POST-CODE
 10300         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10301         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10302     ELSE
 10303         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10304         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10305             MOVE '-'            TO  WS-AM-ZIP-DASH
 10306             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10307
 10308     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10309
 10310     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10311
 10312 7204-SET-PHONE.
 10313     MOVE WSPI-AREA              TO WSPO-AREA.
 10314     MOVE WSPI-PFX               TO WSPO-PFX.
 10315     MOVE WSPI-SFX               TO WSPO-SFX.
 10316     MOVE WS-PHONE-OUT           TO SS44-5D.
 10317
 10318     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10319
 10320     MOVE WS-LABEL-LINES (1)     TO SS43D.
 10321     MOVE WS-LABEL-LINES (2)     TO SS44-1D.
 10322     MOVE WS-LABEL-LINES (3)     TO SS44-2D.
 10323     MOVE WS-LABEL-LINES (4)     TO SS44-3D.
 10324     MOVE WS-LABEL-LINES (5)     TO SS44-4D.
 10325     MOVE WS-LABEL-LINES (6)     TO SS44-6D.
 10326
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 207
* EL152.cbl
 10328 7205-READ-PHYSICIAN-ADDR.
 10329     IF W-PHYSICIAN > ZERO
 10330         COMPUTE ACTV-SEQ = W-PHYSICIAN + 30
 10331     ELSE
 10332         MOVE CL-DOCTOR-ADDR-CNT TO ACTV-SEQ
 10333         ADD +30                 TO ACTV-SEQ.
 10334
 10335     IF ACTV-SEQ = +30
 10336        GO TO 7210-READ-EMPLOYER-ADDR.
 10337
 10338
 10339* EXEC CICS HANDLE CONDITION
 10340*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10341*         NOTFND     (7210-READ-EMPLOYER-ADDR)
 10342*    END-EXEC.
 10343*    MOVE '"$JI                  ! 6 #00009612' TO DFHEIV0
 10344     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10346     MOVE X'3620233030303039363132' TO DFHEIV0(25:11)
 10347     CALL 'kxdfhei1' USING DFHEIV0
 10348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10349
 10350
 10351
 10352* EXEC CICS READ
 10353*         DATASET    (ACTV-ID)
 10354*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10355*         RIDFLD     (ACTV-KEY)
 10356*    END-EXEC.
 10357*    MOVE '&"S        E          (   #00009617' TO DFHEIV0
 10358     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10360     MOVE X'2020233030303039363137' TO DFHEIV0(25:11)
 10361     CALL 'kxdfhei1' USING DFHEIV0,
 10362           ACTV-ID,
 10363           DFHEIV20,
 10364           DFHEIV99,
 10365           ACTV-KEY,
 10366           DFHEIV99,
 10367           DFHEIV99,
 10368           DFHEIV99
 10369     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10370         DFHEIV20
 10371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10372
 10373
 10374     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10375     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10376     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10377     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10378*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10379     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10380        INTO WS-LABEL-LINES (4)
 10381     END-STRING
 10382
 10383     MOVE SPACES                 TO  WS-ZIP-CODE.
 10384     IF AT-CANADIAN-POST-CODE
 10385         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 208
* EL152.cbl
 10386         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10387     ELSE
 10388         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10389         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10390             MOVE '-'            TO  WS-AM-ZIP-DASH
 10391             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10392
 10393     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10394
 10395     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10396     MOVE WSPI-AREA              TO WSPO-AREA.
 10397     MOVE WSPI-PFX               TO WSPO-PFX.
 10398     MOVE WSPI-SFX               TO WSPO-SFX.
 10399     MOVE WS-PHONE-OUT           TO SS47-5D.
 10400
 10401     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10402
 10403     MOVE WS-LABEL-LINES (1)     TO SS47D.
 10404     MOVE WS-LABEL-LINES (2)     TO SS47-1D.
 10405     MOVE WS-LABEL-LINES (3)     TO SS47-2D.
 10406     MOVE WS-LABEL-LINES (4)     TO SS47-3D.
 10407     MOVE WS-LABEL-LINES (5)     TO SS47-4D.
 10408
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 209
* EL152.cbl
 10410
 10411 7210-READ-EMPLOYER-ADDR.
 10412     IF W-EMPLOYER > ZERO
 10413         COMPUTE ACTV-SEQ = W-EMPLOYER + 40
 10414     ELSE
 10415         MOVE CL-EMPLOYER-ADDR-CNT
 10416                                 TO ACTV-SEQ
 10417         ADD +40                 TO ACTV-SEQ.
 10418
 10419     IF ACTV-SEQ = +40
 10420        GO TO 7220-READ-INSURED-ADDR.
 10421
 10422
 10423* EXEC CICS HANDLE CONDITION
 10424*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10425*         NOTFND     (7220-READ-INSURED-ADDR)
 10426*    END-EXEC.
 10427*    MOVE '"$JI                  ! 7 #00009671' TO DFHEIV0
 10428     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10430     MOVE X'3720233030303039363731' TO DFHEIV0(25:11)
 10431     CALL 'kxdfhei1' USING DFHEIV0
 10432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10433
 10434
 10435
 10436* EXEC CICS READ
 10437*         DATASET    (ACTV-ID)
 10438*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10439*         RIDFLD     (ACTV-KEY)
 10440*    END-EXEC.
 10441*    MOVE '&"S        E          (   #00009676' TO DFHEIV0
 10442     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10443     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10444     MOVE X'2020233030303039363736' TO DFHEIV0(25:11)
 10445     CALL 'kxdfhei1' USING DFHEIV0,
 10446           ACTV-ID,
 10447           DFHEIV20,
 10448           DFHEIV99,
 10449           ACTV-KEY,
 10450           DFHEIV99,
 10451           DFHEIV99,
 10452           DFHEIV99
 10453     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10454         DFHEIV20
 10455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10456
 10457
 10458     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10459     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10460     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10461     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10462*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10463     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10464        INTO WS-LABEL-LINES (4)
 10465     END-STRING
 10466
 10467     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 210
* EL152.cbl
 10468     IF AT-CANADIAN-POST-CODE
 10469         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10470         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10471     ELSE
 10472         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10473         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10474             MOVE '-'            TO  WS-AM-ZIP-DASH
 10475             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10476
 10477     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10478
 10479     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10480     MOVE WSPI-AREA              TO WSPO-AREA.
 10481     MOVE WSPI-PFX               TO WSPO-PFX.
 10482     MOVE WSPI-SFX               TO WSPO-SFX.
 10483     MOVE WS-PHONE-OUT           TO SS48-5D.
 10484
 10485     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10486
 10487     MOVE WS-LABEL-LINES (1)     TO SS48D.
 10488     MOVE WS-LABEL-LINES (2)     TO SS48-1D.
 10489     MOVE WS-LABEL-LINES (3)     TO SS48-2D.
 10490     MOVE WS-LABEL-LINES (4)     TO SS48-3D.
 10491     MOVE WS-LABEL-LINES (5)     TO SS48-4D.
 10492
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 211
* EL152.cbl
 10494 7220-READ-INSURED-ADDR.
 10495
 10496     IF W-INSURED > ZERO
 10497         COMPUTE ACTV-SEQ = W-INSURED
 10498     ELSE
 10499         MOVE CL-INSURED-ADDR-CNT TO ACTV-SEQ.
 10500
 10501     IF ACTV-SEQ = +0
 10502        GO TO 7225-READ-OTHER1-ADDR.
 10503
 10504
 10505* EXEC CICS HANDLE CONDITION
 10506*         NOTOPEN   (8870-ACTV-NOT-OPEN)
 10507*         NOTFND    (7225-READ-OTHER1-ADDR)
 10508*    END-EXEC.
 10509*    MOVE '"$JI                  ! 8 #00009728' TO DFHEIV0
 10510     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10512     MOVE X'3820233030303039373238' TO DFHEIV0(25:11)
 10513     CALL 'kxdfhei1' USING DFHEIV0
 10514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10515
 10516
 10517
 10518* EXEC CICS READ
 10519*         DATASET   (ACTV-ID)
 10520*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10521*         RIDFLD    (ACTV-KEY)
 10522*    END-EXEC.
 10523*    MOVE '&"S        E          (   #00009733' TO DFHEIV0
 10524     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10526     MOVE X'2020233030303039373333' TO DFHEIV0(25:11)
 10527     CALL 'kxdfhei1' USING DFHEIV0,
 10528           ACTV-ID,
 10529           DFHEIV20,
 10530           DFHEIV99,
 10531           ACTV-KEY,
 10532           DFHEIV99,
 10533           DFHEIV99,
 10534           DFHEIV99
 10535     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10536         DFHEIV20
 10537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10538
 10539
 10540     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10541     MOVE SS10D                  TO WS-LABEL-LINES (1).
 10542     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10543     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10544*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10545     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10546        INTO WS-LABEL-LINES (4)
 10547     END-STRING
 10548
 10549     MOVE SPACES                 TO  WS-ZIP-CODE.
 10550     IF AT-CANADIAN-POST-CODE
 10551         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 212
* EL152.cbl
 10552         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10553     ELSE
 10554         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10555         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10556             MOVE '-'            TO  WS-AM-ZIP-DASH
 10557             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10558
 10559     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10560
 10561     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10562
 10563     MOVE WS-LABEL-LINES (1)     TO SS10D.
 10564     MOVE WS-LABEL-LINES (2)     TO SS11-1D.
 10565     MOVE WS-LABEL-LINES (3)     TO SS11-2D.
 10566     MOVE WS-LABEL-LINES (4)     TO SS11-3D.
 10567     MOVE WS-LABEL-LINES (5)     TO SS11-4D.
 10568     MOVE AT-MAIL-TO-NAME        TO SS11-5D.
 10569
 10570     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10571     MOVE WSPI-AREA              TO WSPO-AREA.
 10572     MOVE WSPI-PFX               TO WSPO-PFX.
 10573     MOVE WSPI-SFX               TO WSPO-SFX.
 10574     MOVE WS-PHONE-OUT           TO SS11-6D.
 10575
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 213
* EL152.cbl
 10577
 10578 7225-READ-OTHER1-ADDR.
 10579
 10580     IF W-OTHER-1 > ZERO
 10581         COMPUTE ACTV-SEQ = W-OTHER-1 + 50
 10582     ELSE
 10583         MOVE CL-OTHER-1-ADDR-CNT TO ACTV-SEQ
 10584         ADD +50                  TO ACTV-SEQ.
 10585
 10586     IF ACTV-SEQ = +50
 10587        GO TO 7230-READ-OTHER2-ADDR.
 10588
 10589
 10590* EXEC CICS HANDLE CONDITION
 10591*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10592*         NOTFND     (7230-READ-OTHER2-ADDR)
 10593*    END-EXEC.
 10594*    MOVE '"$JI                  ! 9 #00009788' TO DFHEIV0
 10595     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10596     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10597     MOVE X'3920233030303039373838' TO DFHEIV0(25:11)
 10598     CALL 'kxdfhei1' USING DFHEIV0
 10599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10600
 10601
 10602
 10603* EXEC CICS READ
 10604*         DATASET    (ACTV-ID)
 10605*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10606*         RIDFLD     (ACTV-KEY)
 10607*    END-EXEC.
 10608*    MOVE '&"S        E          (   #00009793' TO DFHEIV0
 10609     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10611     MOVE X'2020233030303039373933' TO DFHEIV0(25:11)
 10612     CALL 'kxdfhei1' USING DFHEIV0,
 10613           ACTV-ID,
 10614           DFHEIV20,
 10615           DFHEIV99,
 10616           ACTV-KEY,
 10617           DFHEIV99,
 10618           DFHEIV99,
 10619           DFHEIV99
 10620     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10621         DFHEIV20
 10622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10623
 10624
 10625     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10626     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10627     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10628     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10629*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10630     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10631        INTO WS-LABEL-LINES (4)
 10632     END-STRING
 10633
 10634     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 214
* EL152.cbl
 10635     IF AT-CANADIAN-POST-CODE
 10636         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10637         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10638     ELSE
 10639         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10640         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10641             MOVE '-'            TO  WS-AM-ZIP-DASH
 10642             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10643
 10644     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10645
 10646     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10647     MOVE WSPI-AREA              TO WSPO-AREA.
 10648     MOVE WSPI-PFX               TO WSPO-PFX.
 10649     MOVE WSPI-SFX               TO WSPO-SFX.
 10650     MOVE WS-PHONE-OUT           TO SS49-5D.
 10651
 10652     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10653
 10654     MOVE WS-LABEL-LINES (1)     TO SS49D.
 10655     MOVE WS-LABEL-LINES (2)     TO SS49-1D.
 10656     MOVE WS-LABEL-LINES (3)     TO SS49-2D.
 10657     MOVE WS-LABEL-LINES (4)     TO SS49-3D.
 10658     MOVE WS-LABEL-LINES (5)     TO SS49-4D.
 10659
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 215
* EL152.cbl
 10661 7230-READ-OTHER2-ADDR.
 10662
 10663     IF W-OTHER-2 > ZERO
 10664         COMPUTE ACTV-SEQ = W-OTHER-2 + 60
 10665     ELSE
 10666         MOVE CL-OTHER-2-ADDR-CNT TO ACTV-SEQ
 10667         ADD +60                  TO ACTV-SEQ.
 10668
 10669     IF ACTV-SEQ = +60
 10670        GO TO 7240-NOT-FOUND.
 10671
 10672
 10673* EXEC CICS HANDLE CONDITION
 10674*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10675*         NOTFND     (7240-NOT-FOUND)
 10676*    END-EXEC.
 10677*    MOVE '"$JI                  ! : #00009846' TO DFHEIV0
 10678     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10680     MOVE X'3A20233030303039383436' TO DFHEIV0(25:11)
 10681     CALL 'kxdfhei1' USING DFHEIV0
 10682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10683
 10684
 10685
 10686* EXEC CICS READ
 10687*         DATASET    (ACTV-ID)
 10688*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10689*         RIDFLD     (ACTV-KEY)
 10690*    END-EXEC.
 10691*    MOVE '&"S        E          (   #00009851' TO DFHEIV0
 10692     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10693     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10694     MOVE X'2020233030303039383531' TO DFHEIV0(25:11)
 10695     CALL 'kxdfhei1' USING DFHEIV0,
 10696           ACTV-ID,
 10697           DFHEIV20,
 10698           DFHEIV99,
 10699           ACTV-KEY,
 10700           DFHEIV99,
 10701           DFHEIV99,
 10702           DFHEIV99
 10703     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10704         DFHEIV20
 10705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10706
 10707
 10708     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10709     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10710     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10711     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10712*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10713     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10714        INTO WS-LABEL-LINES (4)
 10715     END-STRING
 10716
 10717     MOVE SPACES                 TO  WS-ZIP-CODE.
 10718     IF AT-CANADIAN-POST-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 216
* EL152.cbl
 10719         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10720         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10721     ELSE
 10722         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10723         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10724             MOVE '-'            TO  WS-AM-ZIP-DASH
 10725             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10726
 10727     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10728
 10729     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10730     MOVE WSPI-AREA              TO WSPO-AREA.
 10731     MOVE WSPI-PFX               TO WSPO-PFX.
 10732     MOVE WSPI-SFX               TO WSPO-SFX.
 10733     MOVE WS-PHONE-OUT           TO SS50-5D.
 10734
 10735     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10736
 10737     MOVE WS-LABEL-LINES (1)     TO SS50D.
 10738     MOVE WS-LABEL-LINES (2)     TO SS50-1D.
 10739     MOVE WS-LABEL-LINES (3)     TO SS50-2D.
 10740     MOVE WS-LABEL-LINES (4)     TO SS50-3D.
 10741     MOVE WS-LABEL-LINES (5)     TO SS50-4D.
 10742
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 217
* EL152.cbl
 10744 7240-NOT-FOUND.
 10745     IF ACCOUNT-IS-ONLINE
 10746        GO TO 7250-READ-ACCOUNT.
 10747
 10748     IF W-ACCOUNT > ZERO
 10749         COMPUTE ACTV-SEQ = W-ACCOUNT + 20
 10750     ELSE
 10751         MOVE CL-ACCOUNT-ADDR-CNT TO ACTV-SEQ
 10752         ADD +20                  TO ACTV-SEQ.
 10753
 10754     IF ACTV-SEQ = +20
 10755        GO TO 7250-READ-ACCOUNT.
 10756
 10757
 10758* EXEC CICS HANDLE CONDITION
 10759*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10760*         NOTFND     (7250-READ-ACCOUNT)
 10761*    END-EXEC.
 10762*    MOVE '"$JI                  ! ; #00009906' TO DFHEIV0
 10763     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10765     MOVE X'3B20233030303039393036' TO DFHEIV0(25:11)
 10766     CALL 'kxdfhei1' USING DFHEIV0
 10767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10768
 10769
 10770
 10771* EXEC CICS READ
 10772*         DATASET    (ACTV-ID)
 10773*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10774*         RIDFLD     (ACTV-KEY)
 10775*    END-EXEC.
 10776*    MOVE '&"S        E          (   #00009911' TO DFHEIV0
 10777     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10778     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10779     MOVE X'2020233030303039393131' TO DFHEIV0(25:11)
 10780     CALL 'kxdfhei1' USING DFHEIV0,
 10781           ACTV-ID,
 10782           DFHEIV20,
 10783           DFHEIV99,
 10784           ACTV-KEY,
 10785           DFHEIV99,
 10786           DFHEIV99,
 10787           DFHEIV99
 10788     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10789         DFHEIV20
 10790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10791
 10792
 10793     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10794     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10795     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10796     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10797*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10798     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10799        INTO WS-LABEL-LINES (4)
 10800     END-STRING
 10801
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 218
* EL152.cbl
 10802     MOVE SPACES                 TO  WS-ZIP-CODE.
 10803     IF AT-CANADIAN-POST-CODE
 10804         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10805         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10806     ELSE
 10807         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10808         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10809             MOVE '-'            TO  WS-AM-ZIP-DASH
 10810             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10811
 10812     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10813
 10814     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10815     MOVE WSPI-AREA              TO WSPO-AREA.
 10816     MOVE WSPI-PFX               TO WSPO-PFX.
 10817     MOVE WSPI-SFX               TO WSPO-SFX.
 10818     MOVE WS-PHONE-OUT           TO SS07-6D.
 10819
 10820*    IF PI-COMPANY-ID NOT = 'FLA'
 10821*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10822
 10823     MOVE WS-LABEL-LINES (1)     TO SS06D.
 10824     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 10825     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 10826     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 10827     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 10828     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 10829
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 219
* EL152.cbl
 10831 7250-READ-ACCOUNT.
 10832*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 10833*        GO TO 7250-READ-PRODUCER.
 10834
 10835     IF WS-ACCT-READ-SW = 'Y'
 10836        GO TO 7250-BUILD-ACCT-ADDR.
 10837
 10838     MOVE CM-CERT-EFF-DT TO ACCT-EXP-DATE.
 10839
 10840
 10841* EXEC CICS HANDLE CONDITION
 10842*         NOTOPEN   (8880-ACCT-NOT-OPEN)
 10843*         NOTFND    (7251-READ-3RD-PARTY)
 10844*    END-EXEC.
 10845*    MOVE '"$JI                  ! < #00009964' TO DFHEIV0
 10846     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10848     MOVE X'3C20233030303039393634' TO DFHEIV0(25:11)
 10849     CALL 'kxdfhei1' USING DFHEIV0
 10850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10851
 10852
 10853 7250-STARTBR-ACCOUNT.
 10854     MOVE ACCT-PARTIAL-KEY       TO  ACCT-SAVE-KEY.
 10855     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
 10856
 10857 7250-READNEXT-ACCOUNT.
 10858     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
 10859
 10860     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
 10861         IF WS-SAVE-ACCT-RECORD = SPACES
 10862             GO TO 7251-READ-3RD-PARTY
 10863         ELSE
 10864             MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
 10865             MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
 10866             GO TO 7250-BUILD-ACCT-ADDR.
 10867
 10868     IF AM-EXPIRATION-DT = HIGH-VALUES
 10869         MOVE AM-CONTROL-PRIMARY      TO  ACCT-KEY
 10870     ELSE
 10871         MOVE ACCOUNT-MASTER          TO  WS-SAVE-ACCT-RECORD
 10872         GO TO 7250-READNEXT-ACCOUNT.
 10873
 10874 7250-BUILD-ACCT-ADDR.
 10875     MOVE SPACES                TO  WS-SAVE-ACCT-RECORD.
 10876
 10877     IF NOT ACCOUNT-IS-ONLINE
 10878        GO TO 7251-READ-3RD-PARTY.
 10879
 10880     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 10881     MOVE AM-NAME               TO WS-LABEL-LINES (1).
 10882     MOVE AM-PERSON             TO WS-LABEL-LINES (2).
 10883     MOVE AM-ADDRS              TO WS-LABEL-LINES (3).
 10884*    MOVE AM-CITY               TO WS-LABEL-LINES (4).
 10885     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
 10886        INTO WS-LABEL-LINES (4)
 10887     END-STRING
 10888
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 220
* EL152.cbl
 10889     MOVE SPACES                TO  WS-ZIP-CODE.
 10890     IF AM-CANADIAN-POST-CODE
 10891         MOVE AM-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 10892         MOVE AM-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 10893     ELSE
 10894         MOVE AM-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 10895         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10896             MOVE '-'           TO  WS-AM-ZIP-DASH
 10897             MOVE AM-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 10898
 10899     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 10900
 10901     MOVE ZEROS                 TO WS-PHONE-IN.
 10902     MOVE AM-AREA-CODE          TO WSPO-AREA.
 10903     MOVE AM-TEL-PRE            TO WSPO-PFX.
 10904     MOVE AM-TEL-NBR            TO WSPO-SFX.
 10905     MOVE WS-PHONE-OUT          TO SS07-6D.
 10906
 10907*    IF PI-COMPANY-ID NOT = 'FLA'
 10908*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10909
 10910     MOVE WS-LABEL-LINES (1)     TO SS06D.
 10911     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 10912     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 10913     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 10914     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 10915     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 10916
 10917*    GO TO 7251-READ-3RD-PARTY.
 10918
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 221
* EL152.cbl
 10920*7250-READ-PRODUCER. Remove as dead code
 10921*7250-STARTBR-PRODUCER. Remove as dead code
 10922*7250-READNEXT-PRODUCER. Remove as dead code
 10923*7250-BUILD-PROD-ADDR. Remove as dead code
 10924 7251-READ-3RD-PARTY.
 10925
 10926     MOVE +29                    TO ACTV-SEQ.
 10927
 10928
 10929* EXEC CICS HANDLE CONDITION
 10930*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10931*         NOTFND     (7252-READ-COMP)
 10932*    END-EXEC.
 10933*    MOVE '"$JI                  ! = #00010044' TO DFHEIV0
 10934     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10936     MOVE X'3D20233030303130303434' TO DFHEIV0(25:11)
 10937     CALL 'kxdfhei1' USING DFHEIV0
 10938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10939
 10940
 10941
 10942* EXEC CICS READ
 10943*         DATASET    (ACTV-ID)
 10944*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10945*         RIDFLD     (ACTV-KEY)
 10946*    END-EXEC.
 10947*    MOVE '&"S        E          (   #00010049' TO DFHEIV0
 10948     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10949     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10950     MOVE X'2020233030303130303439' TO DFHEIV0(25:11)
 10951     CALL 'kxdfhei1' USING DFHEIV0,
 10952           ACTV-ID,
 10953           DFHEIV20,
 10954           DFHEIV99,
 10955           ACTV-KEY,
 10956           DFHEIV99,
 10957           DFHEIV99,
 10958           DFHEIV99
 10959     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10960         DFHEIV20
 10961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10962
 10963
 10964     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10965     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10966     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10967     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10968*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10969     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10970        INTO WS-LABEL-LINES (4)
 10971     END-STRING
 10972
 10973     MOVE SPACES                 TO  WS-ZIP-CODE.
 10974     IF AT-CANADIAN-POST-CODE
 10975         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10976         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10977     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 222
* EL152.cbl
 10978         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10979         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10980             MOVE '-'            TO  WS-AM-ZIP-DASH
 10981             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10982
 10983     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10984
 10985     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10986     MOVE WSPI-AREA              TO WSPO-AREA.
 10987     MOVE WSPI-PFX               TO WSPO-PFX.
 10988     MOVE WSPI-SFX               TO WSPO-SFX.
 10989     MOVE WS-PHONE-OUT           TO SS53-6D.
 10990
 10991     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10992
 10993     MOVE WS-LABEL-LINES (1)     TO SS52D.
 10994     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 10995     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 10996     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 10997     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 10998     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 10999
 11000     GO TO 7260-READ-DENIAL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 223
* EL152.cbl
 11002 7252-READ-COMP.
 11003
 11004     IF WS-COMP-READ-SW = 'Y'
 11005        GO TO 7255-BUILD-COMP-ADDR.
 11006
 11007     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
 11008        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
 11009        GO TO 7260-READ-DENIAL.
 11010
 11011     IF AM-3RD-PARTY-NOTIF-LEVEL > 00 AND < 11
 11012        NEXT SENTENCE
 11013     ELSE
 11014        GO TO 7260-READ-DENIAL.
 11015
 11016     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
 11017        GO TO 7260-READ-DENIAL.
 11018
 11019     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD.
 11020     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER.
 11021     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING.
 11022     MOVE 'A'             TO WS-ERCOMP-TYPE.
 11023     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11024                          TO WS-ERCOMP-RESP-NO.
 11025
 11026     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 11027         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 11028                                       'G' OR 'B'
 11029             MOVE 'G'            TO WS-ERCOMP-TYPE
 11030             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
 11031         ELSE
 11032             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11033                                 TO WS-ERCOMP-ACCOUNT
 11034     ELSE
 11035         MOVE 'G'                TO WS-ERCOMP-TYPE
 11036         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
 11037
 11038     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
 11039        MOVE ZEROS TO WS-ERCOMP-CARRIER.
 11040
 11041     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
 11042        MOVE ZEROS TO WS-ERCOMP-GROUPING.
 11043
 11044
 11045* EXEC CICS HANDLE CONDITION
 11046*         NOTFND    (7260-READ-DENIAL)
 11047*    END-EXEC.
 11048*    MOVE '"$I                   ! > #00010135' TO DFHEIV0
 11049     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11050     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11051     MOVE X'3E20233030303130313335' TO DFHEIV0(25:11)
 11052     CALL 'kxdfhei1' USING DFHEIV0
 11053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11054
 11055
 11056
 11057* EXEC CICS  READ
 11058*         SET      (ADDRESS OF COMPENSATION-MASTER)
 11059*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 224
* EL152.cbl
 11060*         RIDFLD   (WS-ERCOMP-KEY)
 11061*    END-EXEC.
 11062     MOVE 'ERCOMP' TO DFHEIV1
 11063*    MOVE '&"S        E          (   #00010139' TO DFHEIV0
 11064     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11065     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11066     MOVE X'2020233030303130313339' TO DFHEIV0(25:11)
 11067     CALL 'kxdfhei1' USING DFHEIV0,
 11068           DFHEIV1,
 11069           DFHEIV20,
 11070           DFHEIV99,
 11071           WS-ERCOMP-KEY,
 11072           DFHEIV99,
 11073           DFHEIV99,
 11074           DFHEIV99
 11075     SET ADDRESS OF COMPENSATION-MASTER TO
 11076         DFHEIV20
 11077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11078
 11079
 11080 7255-BUILD-COMP-ADDR.
 11081
 11082     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 11083     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
 11084     IF CO-ACCT-NAME = SPACES
 11085        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
 11086     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
 11087     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
 11088     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
 11089
 11090     MOVE SPACES                TO  WS-ZIP-CODE.
 11091     IF CO-CANADIAN-POST-CODE
 11092         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11093         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11094     ELSE
 11095         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11096         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11097             MOVE '-'           TO  WS-AM-ZIP-DASH
 11098             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11099
 11100     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 11101
 11102     MOVE ZEROS                 TO WS-PHONE-IN.
 11103     MOVE CO-AREA-CODE          TO WSPO-AREA.
 11104     MOVE CO-PREFIX             TO WSPO-PFX.
 11105     MOVE CO-PHONE              TO WSPO-SFX.
 11106     MOVE WS-PHONE-OUT          TO SS53-6D.
 11107
 11108     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11109
 11110     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11111     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11112     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11113     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11114     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11115     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11116
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 225
* EL152.cbl
 11118
 11119 7260-READ-DENIAL.
 11120
 11121     MOVE +93                    TO ACTV-SEQ
 11122
 11123
 11124* EXEC CICS HANDLE CONDITION
 11125*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 11126*         NOTFND     (7265-READ-CNTL1)
 11127*         ENDFILE    (7265-READ-CNTL1)
 11128*    END-EXEC.
 11129*    MOVE '"$JI''                 ! ? #00010188' TO DFHEIV0
 11130     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 11131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11132     MOVE X'3F20233030303130313838' TO DFHEIV0(25:11)
 11133     CALL 'kxdfhei1' USING DFHEIV0
 11134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11135
 11136
 11137
 11138* EXEC CICS STARTBR
 11139*         DATASET    (ACTV-ID)
 11140*         RIDFLD     (ACTV-KEY)
 11141*         GTEQ
 11142*    END-EXEC.
 11143     MOVE 0
 11144       TO DFHEIV11
 11145*    MOVE '&,         G          &   #00010194' TO DFHEIV0
 11146     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11147     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11148     MOVE X'2020233030303130313934' TO DFHEIV0(25:11)
 11149     CALL 'kxdfhei1' USING DFHEIV0,
 11150           ACTV-ID,
 11151           ACTV-KEY,
 11152           DFHEIV99,
 11153           DFHEIV11,
 11154           DFHEIV99
 11155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11156
 11157
 11158     MOVE 'Y'                    TO ACTV-BROWSE-STARTED.
 11159     MOVE ACTV-PARTIAL-KEY       TO ACTV-SAVE-KEY.
 11160
 11161 7262-READ-NEXT.
 11162
 11163
 11164* EXEC CICS READNEXT
 11165*         SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11166*         RIDFLD  (ACTV-KEY)
 11167*         DATASET (ACTV-ID)
 11168*    END-EXEC.
 11169     MOVE 0
 11170       TO DFHEIV11
 11171*    MOVE '&.S                   )   #00010205' TO DFHEIV0
 11172     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11173     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11174     MOVE X'2020233030303130323035' TO DFHEIV0(25:11)
 11175     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 226
* EL152.cbl
 11176           ACTV-ID,
 11177           DFHEIV20,
 11178           DFHEIV99,
 11179           ACTV-KEY,
 11180           DFHEIV99,
 11181           DFHEIV11,
 11182           DFHEIV99,
 11183           DFHEIV99
 11184     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11185         DFHEIV20
 11186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11187
 11188
 11189     IF ACTV-PARTIAL-KEY  NOT = ACTV-SAVE-KEY
 11190        GO TO 7265-READ-CNTL1.
 11191     IF AT-TRAILER-TYPE = '2'
 11192        AND AT-PAYMENT-TYPE = 'I'
 11193        AND AT-INT-RATE NUMERIC
 11194        AND AT-INT-RATE NOT = ZEROS
 11195        COMPUTE WS-WORK-INT-RATE = AT-INT-RATE * 100
 11196        MOVE +1                  TO S2
 11197        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
 11198           (S1 > +6)
 11199           IF WS-WORK-INT (S1:1) NOT = '0'
 11200              MOVE WS-WORK-INT (S1:1)
 11201                                 TO SS16-1D (S2:1)
 11202              ADD +1             TO S2
 11203           END-IF
 11204        END-PERFORM
 11205        MOVE '%'                 TO SS16-1D (S2:1)
 11206        GO TO 7262-READ-NEXT
 11207     END-IF
 11208     IF AT-TRAILER-TYPE = '8'
 11209        MOVE AT-DENIAL-INFO-1    TO SS35-1D
 11210        MOVE AT-DENIAL-INFO-2    TO SS35-2D
 11211        IF (CL-TOTAL-INT-PAID = ZEROS)
 11212           OR (CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1)
 11213           GO TO 7265-READ-CNTL1
 11214        END-IF
 11215     END-IF
 11216     GO TO 7262-READ-NEXT
 11217     .
 11218 7265-READ-CNTL1.
 11219     IF ACTV-BROWSE-STARTED = 'Y'
 11220        MOVE 'N'                  TO ACTV-BROWSE-STARTED
 11221
 11222* EXEC CICS ENDBR
 11223*            DATASET    (ACTV-ID)
 11224*       END-EXEC.
 11225     MOVE 0
 11226       TO DFHEIV11
 11227*    MOVE '&2                    $   #00010243' TO DFHEIV0
 11228     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11229     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11230     MOVE X'2020233030303130323433' TO DFHEIV0(25:11)
 11231     CALL 'kxdfhei1' USING DFHEIV0,
 11232           ACTV-ID,
 11233           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 227
* EL152.cbl
 11234           DFHEIV99
 11235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11236
 11237
 11238     IF SS35-1D = ALL '*'
 11239         MOVE '@@DENIAL1'        TO SS35-1D.
 11240
 11241     IF SS35-2D = ALL '*'
 11242         MOVE '@@DENIAL2'        TO SS35-2D.
 11243
 11244     MOVE '1'                    TO CNTL-RECORD-TYPE.
 11245     MOVE ZEROS                  TO CNTL-SEQ.
 11246
 11247* EXEC CICS HANDLE CONDITION
 11248*         NOTOPEN   (8840-CNTL-NOT-OPEN)
 11249*         NOTFND    (7266-READ-CNTL2)
 11250*    END-EXEC.
 11251*    MOVE '"$JI                  ! @ #00010255' TO DFHEIV0
 11252     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11254     MOVE X'4020233030303130323535' TO DFHEIV0(25:11)
 11255     CALL 'kxdfhei1' USING DFHEIV0
 11256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11257
 11258
 11259
 11260* EXEC CICS READ
 11261*         DATASET   (CNTL-ID)
 11262*         SET       (ADDRESS OF CONTROL-FILE)
 11263*         RIDFLD    (CNTL-KEY)
 11264*    END-EXEC.
 11265*    MOVE '&"S        E          (   #00010260' TO DFHEIV0
 11266     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11268     MOVE X'2020233030303130323630' TO DFHEIV0(25:11)
 11269     CALL 'kxdfhei1' USING DFHEIV0,
 11270           CNTL-ID,
 11271           DFHEIV20,
 11272           DFHEIV99,
 11273           CNTL-KEY,
 11274           DFHEIV99,
 11275           DFHEIV99,
 11276           DFHEIV99
 11277     SET ADDRESS OF CONTROL-FILE TO
 11278         DFHEIV20
 11279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11280
 11281
 11282     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11283     MOVE CF-CL-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11284     MOVE CF-CL-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11285     MOVE CF-CL-ADDR-LINE-1      TO WS-LABEL-LINES (3).
 11286     MOVE CF-CL-ADDR-LINE-2      TO WS-LABEL-LINES (4).
 11287     MOVE CF-CL-CITY-STATE       TO WS-LABEL-LINES (5).
 11288
 11289     IF CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11290         MOVE ZEROS              TO  CF-CL-ZIP-CODE-NUM.
 11291     IF CF-CL-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 228
* EL152.cbl
 11292         MOVE CF-CL-ZIP-CODE-NUM TO  WS-ZIP-NUMERIC
 11293         MOVE WS-ZIP-NONNUM      TO  CF-CL-ZIP-CODE.
 11294
 11295     MOVE SPACES                 TO  WS-ZIP-CODE.
 11296     IF CF-CL-CAN-POST-CODE
 11297         MOVE CF-CL-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11298         MOVE CF-CL-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11299     ELSE
 11300         MOVE CF-CL-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11301         IF CF-CL-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11302             MOVE '-'              TO  WS-AM-ZIP-DASH
 11303             MOVE CF-CL-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11304
 11305     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (6).
 11306
 11307     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11308
 11309     MOVE WS-LABEL-LINES (1)     TO SS01D.
 11310     MOVE WS-LABEL-LINES (2)     TO SS02-1D.
 11311     MOVE WS-LABEL-LINES (3)     TO SS02-2D.
 11312     MOVE WS-LABEL-LINES (4)     TO SS02-3D.
 11313     MOVE WS-LABEL-LINES (5)     TO SS02-4D.
 11314     MOVE WS-LABEL-LINES (6)     TO SS02-5D.
 11315
 11316 7266-READ-CNTL2.
 11317     IF PI-PROCESSOR-ID  =  LGXX-ID
 11318        GO TO 7267-READ-CNTL4.
 11319
 11320     MOVE '2'                    TO CNTL-RECORD-TYPE.
 11321     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
 11322     MOVE ZEROS                  TO CNTL-SEQ.
 11323
 11324
 11325* EXEC CICS HANDLE CONDITION
 11326*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11327*         NOTFND     (7267-READ-CNTL4)
 11328*    END-EXEC.
 11329*    MOVE '"$JI                  ! A #00010308' TO DFHEIV0
 11330     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11332     MOVE X'4120233030303130333038' TO DFHEIV0(25:11)
 11333     CALL 'kxdfhei1' USING DFHEIV0
 11334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11335
 11336
 11337
 11338* EXEC CICS READ
 11339*         DATASET    (CNTL-ID)
 11340*         SET        (ADDRESS OF CONTROL-FILE)
 11341*         RIDFLD     (CNTL-KEY)
 11342*    END-EXEC.
 11343*    MOVE '&"S        E          (   #00010313' TO DFHEIV0
 11344     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11346     MOVE X'2020233030303130333133' TO DFHEIV0(25:11)
 11347     CALL 'kxdfhei1' USING DFHEIV0,
 11348           CNTL-ID,
 11349           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 229
* EL152.cbl
 11350           DFHEIV99,
 11351           CNTL-KEY,
 11352           DFHEIV99,
 11353           DFHEIV99,
 11354           DFHEIV99
 11355     SET ADDRESS OF CONTROL-FILE TO
 11356         DFHEIV20
 11357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11358
 11359
 11360     MOVE CF-PROCESSOR-NAME      TO SS08D.
 11361     MOVE CF-PROCESSOR-TITLE     TO SS09D.
 11362
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 230
* EL152.cbl
 11364 7267-READ-CNTL4.
 11365*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 11366*        GO TO 7267-READ-EMPLAN.
 11367
 11368     IF BEN-HOLD = ZEROS
 11369        GO TO 7267-READ-CNTL6.
 11370
 11371     MOVE BEN-HOLD               TO CNTL-GEN2.
 11372     MOVE SPACES                 TO CNTL-GEN1.
 11373
 11374     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11375        MOVE '4'                 TO CNTL-RECORD-TYPE
 11376     ELSE
 11377        MOVE '5'                 TO CNTL-RECORD-TYPE.
 11378
 11379     MOVE ZEROS                  TO CNTL-SEQ.
 11380
 11381
 11382* EXEC CICS HANDLE CONDITION
 11383*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11384*         NOTFND     (7267-READ-CNTL6)
 11385*    END-EXEC.
 11386*    MOVE '"$JI                  ! B #00010340' TO DFHEIV0
 11387     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11388     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11389     MOVE X'4220233030303130333430' TO DFHEIV0(25:11)
 11390     CALL 'kxdfhei1' USING DFHEIV0
 11391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11392
 11393
 11394
 11395* EXEC CICS READ
 11396*         DATASET    (CNTL-ID)
 11397*         SET        (ADDRESS OF CONTROL-FILE)
 11398*         RIDFLD     (CNTL-KEY)
 11399*         GTEQ
 11400*    END-EXEC.
 11401*    MOVE '&"S        G          (   #00010345' TO DFHEIV0
 11402     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11403     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11404     MOVE X'2020233030303130333435' TO DFHEIV0(25:11)
 11405     CALL 'kxdfhei1' USING DFHEIV0,
 11406           CNTL-ID,
 11407           DFHEIV20,
 11408           DFHEIV99,
 11409           CNTL-KEY,
 11410           DFHEIV99,
 11411           DFHEIV99,
 11412           DFHEIV99
 11413     SET ADDRESS OF CONTROL-FILE TO
 11414         DFHEIV20
 11415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11416
 11417
 11418     MOVE 1                      TO SUB.
 11419 7267-LOOP.
 11420     IF SUB = 9
 11421        GO TO 7267-READ-CNTL6.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 231
* EL152.cbl
 11422
 11423     IF CF-BENEFIT-CODE (SUB) < BEN-HOLD
 11424        ADD 1 TO SUB
 11425        GO TO 7267-LOOP.
 11426
 11427     IF BEN-HOLD = CF-BENEFIT-CODE (SUB)
 11428        MOVE CF-BENEFIT-DESCRIP (SUB) TO SS22D
 11429        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 11430           OR CL-CLAIM-TYPE = 'I'
 11431           OR CL-CLAIM-TYPE = 'G'
 11432           MOVE CF-BENEFIT-ALPHA (SUB)   TO BENEFIT-WORK
 11433           MOVE ELIM-DAYS                TO SS42D.
 11434
 11435     GO TO 7267-READ-CNTL6.
 11436
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 232
* EL152.cbl
 11438*7267-READ-EMPLAN. Remove as dead code
 11439 7267-READ-CNTL6.
 11440     MOVE '6'                    TO CNTL-RECORD-TYPE.
 11441     MOVE SPACES                 TO CNTL-GENL.
 11442
 11443*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11444*        MOVE CL-CURRENT-CARRIER TO CNTL-GEN4
 11445*    ELSE
 11446         MOVE PI-CARRIER         TO CNTL-GEN4.
 11447
 11448     MOVE ZEROS                  TO CNTL-SEQ.
 11449
 11450
 11451* EXEC CICS HANDLE CONDITION
 11452*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11453*         NOTFND     (7268-SET-DATE)
 11454*    END-EXEC.
 11455*    MOVE '"$JI                  ! C #00010384' TO DFHEIV0
 11456     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11458     MOVE X'4320233030303130333834' TO DFHEIV0(25:11)
 11459     CALL 'kxdfhei1' USING DFHEIV0
 11460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11461
 11462
 11463
 11464* EXEC CICS READ
 11465*         DATASET    (CNTL-ID)
 11466*         SET        (ADDRESS OF CONTROL-FILE)
 11467*         RIDFLD     (CNTL-KEY)
 11468*    END-EXEC.
 11469*    MOVE '&"S        E          (   #00010389' TO DFHEIV0
 11470     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11472     MOVE X'2020233030303130333839' TO DFHEIV0(25:11)
 11473     CALL 'kxdfhei1' USING DFHEIV0,
 11474           CNTL-ID,
 11475           DFHEIV20,
 11476           DFHEIV99,
 11477           CNTL-KEY,
 11478           DFHEIV99,
 11479           DFHEIV99,
 11480           DFHEIV99
 11481     SET ADDRESS OF CONTROL-FILE TO
 11482         DFHEIV20
 11483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11484
 11485
 11486     MOVE SPACES              TO WS-LABEL-HOLD-AREA.
 11487     MOVE CF-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11488     MOVE CF-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11489     MOVE CF-ADDRESS-LINE-1   TO WS-LABEL-LINES (3).
 11490     MOVE CF-ADDRESS-LINE-2   TO WS-LABEL-LINES (4).
 11491     MOVE CF-CITY-STATE       TO WS-LABEL-LINES (5).
 11492
 11493     IF CF-ZIP-CODE-NUM NOT NUMERIC
 11494         MOVE ZEROS              TO  CF-ZIP-CODE-NUM.
 11495     IF CF-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 233
* EL152.cbl
 11496         MOVE CF-ZIP-CODE-NUM    TO  WS-ZIP-NUMERIC
 11497         MOVE WS-ZIP-NONNUM      TO  CF-ZIP-CODE.
 11498
 11499     MOVE SPACES              TO  WS-ZIP-CODE.
 11500     IF CF-CANADIAN-POST-CODE
 11501         MOVE CF-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 11502         MOVE CF-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 11503     ELSE
 11504         MOVE CF-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 11505         IF CF-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11506             MOVE '-'          TO  WS-AM-ZIP-DASH
 11507             MOVE CF-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 11508
 11509     MOVE WS-ZIP-CODE         TO  WS-LABEL-LINES (6).
 11510
 11511     MOVE CF-PHONE-NO         TO WS-PHONE-IN.
 11512     MOVE WSPI-AREA           TO WSPO-AREA.
 11513     MOVE WSPI-PFX            TO WSPO-PFX.
 11514     MOVE WSPI-SFX            TO WSPO-SFX.
 11515     MOVE WS-PHONE-OUT        TO SS04-6D.
 11516
 11517     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11518
 11519     MOVE WS-LABEL-LINES (1)  TO SS03D
 11520     IF PI-CARRIER = '8'
 11521        MOVE 'as Administrator for Investors Heritage Life Insuran
 11522-     'ce Company'               TO SS03-1D
 11523     END-IF
 11524     MOVE WS-LABEL-LINES (2)  TO SS04-1D.
 11525     MOVE WS-LABEL-LINES (3)  TO SS04-2D.
 11526     MOVE WS-LABEL-LINES (4)  TO SS04-3D.
 11527     MOVE WS-LABEL-LINES (5)  TO SS04-4D.
 11528     MOVE WS-LABEL-LINES (6)  TO SS04-5D.
 11529
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 234
* EL152.cbl
 11531 7268-SET-DATE.
 11532     MOVE EIBDATE                TO DATE-WORK.
 11533     MOVE DT-WORK                TO DC-JULIAN-YYDDD.
 11534     MOVE '5'                    TO DC-OPTION-CODE.
 11535     PERFORM 9700-DATE-LINK  THRU  9700-EXIT.
 11536     MOVE DC-GREG-DATE-1-EDIT    TO SS20D.
 11537     MOVE DC-GREG-DATE-1-ALPHA   TO SS21D.
 11538
 11539     IF NOT LOWER-CASE-LETTERS-USED
 11540        GO TO 7269-EXIT.
 11541
 11542*    IF PI-COMPANY-ID = 'DMD'
 11543*        MOVE SS21D              TO WS-TEMP-AREA2
 11544*        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11545*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11546*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11547*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11548*        END-IF
 11549*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11550*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11551*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11552*        END-IF
 11553*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11554*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11555*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11556*        END-IF
 11557*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11558*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11559*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11560*        END-IF
 11561*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11562*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11563*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11564*        END-IF
 11565*        MOVE WS-TEMP-AREA2      TO SS21D
 11566*        GO TO 7269-EXIT.
 11567*
 11568     INSPECT SS19D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11569     INSPECT SS35-1D CONVERTING UPPER-CASE TO LOWER-CASE.
 11570     INSPECT SS35-2D CONVERTING UPPER-CASE TO LOWER-CASE.
 11571     INSPECT SS22D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11572
 11573     MOVE 'N'                    TO WS-STATE-LINE.
 11574
 11575     MOVE 'Y'                    TO WS-PROCESSOR-LINE.
 11576     MOVE SS08D                  TO WS-TEMP-AREA2.
 11577     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11578     MOVE WS-TEMP-AREA2          TO SS08D.
 11579     MOVE 'N'                    TO WS-PROCESSOR-LINE.
 11580     MOVE 'N'                    TO WS-CAPS-SW.
 11581
 11582     MOVE SS09D                  TO WS-TEMP-AREA2.
 11583     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11584     MOVE WS-TEMP-AREA2          TO SS09D.
 11585
 11586     MOVE SS11-5D                TO WS-TEMP-AREA2.
 11587     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11588     MOVE WS-TEMP-AREA2          TO SS11-5D.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 235
* EL152.cbl
 11589
 11590     MOVE SS21D                  TO WS-TEMP-AREA2.
 11591     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11592     MOVE WS-TEMP-AREA2          TO SS21D.
 11593
 11594     MOVE SS40D                  TO WS-TEMP-AREA2.
 11595     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11596     MOVE WS-TEMP-AREA2          TO SS40D.
 11597
 11598     MOVE SS41D                  TO WS-TEMP-AREA2.
 11599     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11600     MOVE WS-TEMP-AREA2          TO SS41D.
 11601
 11602 7269-EXIT.
 11603     EXIT.
 11604
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 236
* EL152.cbl
 11606*            COPY ELCNAMET.
 11607*****************************************************************
 11608*                                                               *
 11609*                                                               *
 11610*                            ELCNAMET                           *
 11611*                            VMOD=2.003                         *
 11612*                                                               *
 11613*            TRANSLATION ROUTINE USED MAINLY FOR CONVERTING     *
 11614*            NAMES AND ADDRESSES AND OTHER VARIABLES TO         *
 11615*            LOWER CASE.  THE FIRST CHARACTER OF EACH WORD      *
 11616*            IS LEFT AS UPPER AND ALL OTHER LOWER CASE.         *
 11617*                                                               *
 11618*                                                               *
 11619*****************************************************************.
 11620*                   C H A N G E   L O G
 11621*
 11622* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 11623*-----------------------------------------------------------------
 11624*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 11625* EFFECTIVE    NUMBER
 11626*-----------------------------------------------------------------
 11627* 102703                   SMVA  LEAVE CERTIFICATION DESIGNATION O
 11628*                                PROCESSOR NAME LINE IN CAPS
 11629******************************************************************
 11630
 11631 7270-LABEL-MOVE.
 11632     IF WS-LABEL-HOLD-AREA = SPACES
 11633        GO TO 7279-EXIT.
 11634
 11635     IF PI-COMPANY-ID NOT = 'DMD'
 11636         PERFORM 7280-TRANSLATE-LOWER THRU 7280-EXIT.
 11637
 11638 7270-LABEL-MOVE-1.
 11639
 11640     IF WS-LABEL-LINES (1) = SPACES
 11641        MOVE WS-LABEL-LINES (2)  TO WS-LABEL-LINES (1)
 11642        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11643        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11644        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11645        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11646        MOVE SPACES              TO WS-LABEL-LINES (6)
 11647        GO TO 7270-LABEL-MOVE-1.
 11648
 11649     IF WS-LABEL-LINES (2) = SPACES AND
 11650        WS-LABEL-LINES (3) = SPACES AND
 11651        WS-LABEL-LINES (4) = SPACES AND
 11652        WS-LABEL-LINES (5) = SPACES AND
 11653        WS-LABEL-LINES (6) = SPACES
 11654        SET WS-NDX               TO 1
 11655        GO TO 7275-MOVE-ZIP.
 11656
 11657 7270-LABEL-MOVE-2.
 11658
 11659     IF WS-LABEL-LINES (2) = SPACES
 11660        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11661        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11662        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11663        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 237
* EL152.cbl
 11664        MOVE SPACES              TO WS-LABEL-LINES (6)
 11665        GO TO 7270-LABEL-MOVE-2.
 11666
 11667     IF WS-LABEL-LINES (3) = SPACES AND
 11668        WS-LABEL-LINES (4) = SPACES AND
 11669        WS-LABEL-LINES (5) = SPACES AND
 11670        WS-LABEL-LINES (6) = SPACES
 11671        SET WS-NDX               TO 2
 11672        GO TO 7275-MOVE-ZIP.
 11673
 11674 7270-LABEL-MOVE-3.
 11675
 11676     IF WS-LABEL-LINES (3) = SPACES
 11677        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11678        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11679        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11680        MOVE SPACES              TO WS-LABEL-LINES (6)
 11681        GO TO 7270-LABEL-MOVE-3.
 11682
 11683     IF WS-LABEL-LINES (4) = SPACES AND
 11684        WS-LABEL-LINES (5) = SPACES AND
 11685        WS-LABEL-LINES (6) = SPACES
 11686        SET WS-NDX               TO 3
 11687        GO TO 7275-MOVE-ZIP.
 11688
 11689 7270-LABEL-MOVE-4.
 11690
 11691     IF WS-LABEL-LINES (4) = SPACES
 11692        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11693        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11694        MOVE SPACES              TO WS-LABEL-LINES (6)
 11695        GO TO 7270-LABEL-MOVE-4.
 11696
 11697     IF WS-LABEL-LINES (5) = SPACES AND
 11698        WS-LABEL-LINES (6) = SPACES
 11699        SET WS-NDX               TO 4
 11700        GO TO 7275-MOVE-ZIP.
 11701
 11702 7270-LABEL-MOVE-5.
 11703
 11704     IF WS-LABEL-LINES (5) = SPACES
 11705        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11706        MOVE SPACES              TO WS-LABEL-LINES (6)
 11707        SET WS-NDX               TO 5
 11708        GO TO 7275-MOVE-ZIP
 11709
 11710     ELSE
 11711        IF WS-LABEL-LINES (6) = SPACES
 11712           SET WS-NDX            TO 5
 11713           GO TO 7275-MOVE-ZIP
 11714
 11715        ELSE
 11716           SET WS-NDX            TO 6.
 11717
 11718 7275-MOVE-ZIP.
 11719
 11720     SET WS-NDX2                 TO WS-NDX.
 11721     SET WS-NDX2 DOWN BY +1.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 238
* EL152.cbl
 11722
 11723     IF  WS-LAST-ZIP (WS-NDX2) = SPACES
 11724*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 11725         IF WS-LABEL-1ST-ZIP (WS-NDX) NUMERIC
 11726          IF PI-COMPANY-ID NOT = 'FLA'
 11727            MOVE WS-LABEL-ZIP (WS-NDX)
 11728                                     TO WS-LAST-ZIP (WS-NDX2)
 11729            MOVE SPACES              TO WS-LABEL-LINES (WS-NDX).
 11730
 11731 7279-EXIT.
 11732     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 239
* EL152.cbl
 11734
 11735 7280-TRANSLATE-LOWER.
 11736     IF LOWER-CASE-LETTERS-USED
 11737        MOVE 'N'                     TO WS-STATE-LINE
 11738     ELSE
 11739        GO TO 7280-EXIT.
 11740
 11741     IF WS-LABEL-LINES (1) NOT = SPACES
 11742        MOVE WS-LABEL-LINES (1)      TO WS-TEMP-AREA2
 11743        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11744        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (1).
 11745
 11746     IF WS-LABEL-LINES (2) NOT = SPACES
 11747        MOVE WS-LABEL-LINES (2)      TO WS-TEMP-AREA2
 11748        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11749        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (2).
 11750
 11751     IF WS-LABEL-LINES (3) NOT = SPACES
 11752        MOVE WS-LABEL-LINES (3)      TO WS-TEMP-AREA2
 11753        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11754        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (3).
 11755
 11756*****THE CITY STATE WILL BE ON LINE FOUR OR FIVE DEPENDING
 11757*****ON THE FORMAT USED.  THE SIXTH LINE BEING BLANK WILL TELL.
 11758
 11759
 11760     IF WS-LABEL-LINES (4) NOT = SPACES
 11761        IF (WS-LABEL-LINES (6) = SPACES  OR
 11762           WS-LABEL-LINES (5) = SPACES)
 11763           MOVE 'Y'                     TO WS-STATE-LINE
 11764           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11765           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11766           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4)
 11767        ELSE
 11768           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11769           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11770           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4).
 11771
 11772     IF WS-LABEL-LINES (5) NOT = SPACES
 11773        IF WS-LABEL-LINES (6) NOT = SPACES
 11774           MOVE 'Y'                     TO WS-STATE-LINE
 11775           MOVE WS-LABEL-LINES (5)      TO WS-TEMP-AREA2
 11776           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11777           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (5).
 11778
 11779 7280-EXIT.
 11780     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 240
* EL152.cbl
 11782
 11783 7281-SEARCH-AND-TRANSLATE.
 11784     SET TA1  TO +1.
 11785
 11786 7281-FIND-FIRST-NON-BLANK.
 11787     IF WS-TEMP-2 (TA1) = SPACES
 11788        SET TA1 UP BY 1
 11789        GO TO 7281-FIND-FIRST-NON-BLANK.
 11790
 11791*****SET INDEX TO THE NEXT CHAR TO START THE TRANSLATE.
 11792     SET TA2   TO TA1
 11793     SET TA2   UP BY 1
 11794     SET TA21  TO TA2
 11795     SET TA21  UP BY 1.
 11796
 11797     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 11798     PERFORM 7282-FIND-NEXT-BLANK THRU 7282-EXIT.
 11799
 11800 7281-EXIT.
 11801     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 241
* EL152.cbl
 11803
 11804 7282-FIND-NEXT-BLANK.
 11805     IF TA21 GREATER THAN 31
 11806        GO TO 7282-EXIT.
 11807
 11808     IF TA21 EQUAL TO 31
 11809        IF NO-CHARACTERS-FOUND
 11810           GO TO 7282-EXIT
 11811           ELSE
 11812           SET TA1   TO +1
 11813           MOVE SPACES             TO WS-TEMP-AREA1
 11814           PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 11815                   UNTIL MOVE-INDX EQUAL TO TA21
 11816           PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT
 11817           SET TA1   TO +1
 11818           PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 11819                   UNTIL MOVE-INDX EQUAL TO TA21
 11820           GO TO 7282-EXIT.
 11821
 11822     IF WS-TEMP-2 (TA2)  = SPACE OR ',' OR '/'
 11823         GO TO 7282-NEXT-GROUP-SEARCH.
 11824
 11825     IF WS-TEMP-2 (TA21) = SPACES OR ',' OR '/'
 11826         IF WS-TEMP-2 (TA21)  = ','
 11827            AND WS-PROCESSOR-LINE = 'Y'
 11828             SET THE-REST-R-CAPS TO TRUE
 11829         ELSE
 11830             CONTINUE
 11831     ELSE
 11832         MOVE 'Y'                  TO WS-DATA-FOUND-SW
 11833         SET TA21 UP BY +1
 11834         GO TO 7282-FIND-NEXT-BLANK.
 11835
 11836     SET TA1  TO +1
 11837     MOVE SPACES                   TO WS-TEMP-AREA1.
 11838     PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 11839             UNTIL MOVE-INDX EQUAL TO TA21
 11840     PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT.
 11841     SET TA1  TO +1
 11842     PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 11843             UNTIL MOVE-INDX EQUAL TO TA21
 11844     IF THE-REST-R-CAPS
 11845         GO TO 7282-EXIT.
 11846     SET TA2   TO TA21
 11847     SET TA21  UP BY 1
 11848     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 11849 7282-NEXT-GROUP-SEARCH.
 11850     IF WS-TEMP-2 (TA2) EQUAL TO SPACES OR ',' OR '/'
 11851        SET TA2   UP BY 1
 11852        IF TA2 = 30
 11853           GO TO 7282-EXIT
 11854           ELSE
 11855           GO TO 7282-NEXT-GROUP-SEARCH.
 11856
 11857     SET TA2    UP BY 1
 11858     SET TA21   TO TA2
 11859     SET TA21   UP BY 1
 11860     GO TO 7282-FIND-NEXT-BLANK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 242
* EL152.cbl
 11861
 11862 7282-EXIT.
 11863     EXIT.
 11864
 11865
 11866 7283-MOVE.
 11867     MOVE WS-TEMP-2 (MOVE-INDX) TO WS-TEMP-1 (TA1)
 11868     SET TA1 UP BY +1.
 11869
 11870
 11871 7284-MOVE-BACK.
 11872     MOVE WS-TEMP-1 (TA1)       TO WS-TEMP-2 (MOVE-INDX).
 11873     SET TA1 UP BY +1.
 11874
 11875 7285-TEST-AND-TRANSLATE.
 11876***BYPASS IF THE AREA MAY BE A PO BOX, OR RR NUMBER
 11877     IF WS-TEMP-AREA1 = '.O.' OR 'RR' OR 'O'
 11878        GO TO 7285-EXIT.
 11879
 11880***BYPASS IF IT IS A CITY/STATE LINE AND BEYOND CHARACTER 07
 11881***AND IT APPEARS THAT IT MAY BE A ABREVIATION.
 11882
 11883     SET WS-POSITION2   TO TA2
 11884     SET WS-POSITION21  TO TA21
 11885     COMPUTE WS-WORD-LENGTH = WS-POSITION21 - WS-POSITION2
 11886     IF WS-WORD-LENGTH LESS THAN 3 AND
 11887        WS-STATE-LINE = 'Y' AND
 11888        TA2 GREATER THAN 07
 11889        GO TO 7285-EXIT.
 11890
 11891     INSPECT WS-TEMP-AREA1 CONVERTING UPPER-CASE TO LOWER-CASE.
 11892
 11893 7285-EXIT.
 11894     EXIT.
 11895
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 243
* EL152.cbl
 11897 7290-RESOLVE-CREDITOR.
 11898
 11899
 11900* EXEC CICS HANDLE CONDITION
 11901*         NOTOPEN    (7290-BENE-NOT-OPEN)
 11902*         NOTFND     (7290-EXIT)
 11903*    END-EXEC.
 11904*    MOVE '"$JI                  ! D #00010808' TO DFHEIV0
 11905     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11906     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11907     MOVE X'4420233030303130383038' TO DFHEIV0(25:11)
 11908     CALL 'kxdfhei1' USING DFHEIV0
 11909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11910
 11911
 11912     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11913
 11914     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 11915     MOVE 'B'                    TO BENE-REC-TYPE.
 11916     MOVE SPACES                 TO BENE-NUMBER.
 11917     MOVE CL-CURRENT-GROUPING    TO BENE-CREDITOR.
 11918
 11919
 11920* EXEC CICS READ
 11921*         DATASET    (BENE-ID)
 11922*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 11923*         RIDFLD     (BENE-KEY)
 11924*    END-EXEC.
 11925*    MOVE '&"S        E          (   #00010820' TO DFHEIV0
 11926     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11927     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11928     MOVE X'2020233030303130383230' TO DFHEIV0(25:11)
 11929     CALL 'kxdfhei1' USING DFHEIV0,
 11930           BENE-ID,
 11931           DFHEIV20,
 11932           DFHEIV99,
 11933           BENE-KEY,
 11934           DFHEIV99,
 11935           DFHEIV99,
 11936           DFHEIV99
 11937     SET ADDRESS OF BENEFICIARY-MASTER TO
 11938         DFHEIV20
 11939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11940
 11941
 11942     IF LOWER-CASE-LETTERS-USED
 11943         MOVE BE-MAIL-TO-NAME    TO WS-TEMP-AREA2
 11944         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11945         MOVE WS-TEMP-AREA2      TO SS56D
 11946     ELSE
 11947         MOVE BE-MAIL-TO-NAME    TO SS56D.
 11948
 11949     GO TO 7290-EXIT.
 11950
 11951 7290-BENE-NOT-OPEN.
 11952
 11953     MOVE ER-7675                TO EMI-ERROR.
 11954     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 244
* EL152.cbl
 11955     MOVE -1                     TO MAINTL.
 11956     GO TO 8200-SEND-DATAONLY.
 11957
 11958 7290-EXIT.
 11959     EXIT.
 11960
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 245
* EL152.cbl
 11962 7300-VARIABLE-SEARCH.
 11963***************************************************************
 11964*    THIS ROUTINE SEARCHES THE NEWLY CREATED LETTER FOR ANY   *
 11965*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 11966*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 11967*    DATA THAT WAS GENERATED IN PARAGRAPHS 7200-7299.         *
 11968*                                                             *
 11969*    THE ADDRESSING OF THE VARIABLE TABLE IS ACCOMPLISHED     *
 11970*    BY DOING A GETMAIN, MOVING THE TABLE TO THE NEW STORAGE  *
 11971*    AND BY ADJUSTING THE BLL POINTER TO POINT AT THE DATA.   *
 11972***************************************************************
 11973
 11974     MOVE REC-TEXT (TB-INDX)     TO SINGLE-LINE.
 11975
 11976     SET INDX1 TO 1.
 11977 7301-LOOP.
 11978     IF INDX1 > 70
 11979        MOVE SINGLE-LINE         TO REC-TEXT (TB-INDX)
 11980        GO TO 7399-EXIT.
 11981
 11982     IF ONE-CHAR (INDX1) NOT = '@'
 11983        SET INDX1 UP BY 1
 11984        GO TO 7301-LOOP.
 11985
 11986     SET INDX2 TO INDX1.
 11987     SET INDX2 UP BY 1.
 11988
 11989     IF ONE-CHAR (INDX2) = '@'
 11990        SET INDX1 UP BY 2
 11991        GO TO 7301-LOOP.
 11992
 11993     MOVE ONE-CHAR (INDX2)       TO V1.
 11994     SET INDX2 UP BY 1.
 11995     MOVE ONE-CHAR (INDX2)       TO V2.
 11996     SET INDX2 UP BY 1.
 11997     MOVE ONE-CHAR (INDX2)       TO V3.
 11998     SET INDX2 UP BY 1.
 11999     MOVE ONE-CHAR (INDX2)       TO V4.
 12000
 12001     IF V-NUM NOT NUMERIC
 12002        GO TO 7330-VAR-ERROR.
 12003
 12004     IF V-PERIOD NOT = '.'
 12005        MOVE '.'                 TO V-PERIOD
 12006        MOVE ZERO                TO V-DECIMAL
 12007        GO TO 7340-TABLE-SEARCH.
 12008
 12009     IF V-DECIMAL NUMERIC
 12010        GO TO 7340-TABLE-SEARCH.
 12011
 12012 7330-VAR-ERROR.
 12013     MOVE ER-0180                TO EMI-ERROR.
 12014     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12015     SET INDX1 UP BY 1.
 12016     GO TO 7301-LOOP.
 12017
 12018 7340-TABLE-SEARCH.
 12019
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 246
* EL152.cbl
 12020     IF REFRESH-GETMAIN-AREA
 12021*        MOVE SAVE-VARIABLE-POINTER      TO LCP-WS-ADDR-COMP
 12022*        SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12023         MOVE SYSTEM-SUPPORTED-VARIABLES TO SYSTEM-VARIABLES
 12024         MOVE 2                          TO GETMAIN-SWITCH
 12025         MOVE 1                          TO SS-COUNTER
 12026                                            B1
 12027     ELSE
 12028         IF NO-GETMAIN-DONE-YET
 12029*            EXEC CICS GETMAIN
 12030*                 SET       (ADDRESS OF SYSTEM-VARIABLES)
 12031*                 LENGTH    (SS-WORK-AREA-LENGTH)
 12032*            END-EXEC
 12033             MOVE 2              TO GETMAIN-SWITCH
 12034*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12035*            MOVE LCP-WS-ADDR-COMP
 12036*                                TO SAVE-VARIABLE-POINTER
 12037             MOVE SYSTEM-SUPPORTED-VARIABLES
 12038                                 TO SYSTEM-VARIABLES
 12039             MOVE 1              TO SS-COUNTER
 12040                                    B1
 12041         ELSE
 12042             MOVE 1              TO SS-COUNTER
 12043                                    B1
 12044*            MOVE SAVE-VARIABLE-POINTER
 12045*                                TO LCP-WS-ADDR-COMP
 12046*            SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12047         END-IF
 12048     END-IF
 12049     .
 12050 7350-TABLE-LOOP.
 12051
 12052     IF SS-COUNTER  >  SS-NUM-ENTRIES
 12053        GO TO 7330-VAR-ERROR.
 12054
 12055     MOVE SYSTEM-VARIABLES (B1:106)
 12056                                 TO SYS-VAR-ENTRY
 12057     IF SYS-VAR-CODE NOT = VAR-HOLD
 12058        ADD SYS-VAR-LEN          TO B1
 12059*       SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12060*       ADD SYS-VAR-LEN          TO LCP-WS-ADDR-COMP
 12061*       SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12062        ADD 1                    TO SS-COUNTER
 12063        GO TO 7350-TABLE-LOOP
 12064     END-IF
 12065
 12066     MOVE SYS-VAR-ENTRY          TO VARIABLE-WORK-AREA.
 12067     SET INDXV TO 1.
 12068     SUBTRACT 6                  FROM VAR-LEN.
 12069     PERFORM 7400-MOVE-VAR-DATA VAR-LEN TIMES.
 12070     GO TO 7301-LOOP.
 12071
 12072 7399-EXIT.
 12073      EXIT.
 12074
 12075 7400-MOVE-VAR-DATA.
 12076     IF INDX1 > 70
 12077        MOVE ER-0181             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 247
* EL152.cbl
 12078        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12079        GO TO 7301-LOOP.
 12080
 12081     MOVE VAR-ONE-CHAR (INDXV)   TO ONE-CHAR (INDX1).
 12082     SET INDXV UP BY 1.
 12083     SET INDX1 UP BY 1.
 12084
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 248
* EL152.cbl
 12086 7500-READ-TS.
 12087
 12088* EXEC CICS HANDLE CONDITION
 12089*         QIDERR     (7590-TS-QIDERR)
 12090*         ITEMERR    (7585-TS-ITEMERR)
 12091*    END-EXEC.
 12092*    MOVE '"$N<                  ! E #00010971' TO DFHEIV0
 12093     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12094     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12095     MOVE X'4520233030303130393731' TO DFHEIV0(25:11)
 12096     CALL 'kxdfhei1' USING DFHEIV0
 12097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12098
 12099
 12100     SET TS-INDX TO 1.
 12101     MOVE 1                      TO TS-ITEM.
 12102
 12103 7501-LOOP.
 12104
 12105* EXEC CICS READQ TS
 12106*         INTO     (TS-WORK-AREA)
 12107*         QUEUE    (TS-NAME-TEXT)
 12108*         LENGTH   (TS-LENGTH)
 12109*         ITEM     (TS-ITEM)
 12110*    END-EXEC.
 12111*    MOVE '*$II   L              ''   #00010980' TO DFHEIV0
 12112     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12114     MOVE X'2020233030303130393830' TO DFHEIV0(25:11)
 12115     CALL 'kxdfhei1' USING DFHEIV0,
 12116           TS-NAME-TEXT,
 12117           TS-WORK-AREA,
 12118           TS-LENGTH,
 12119           TS-ITEM,
 12120           DFHEIV99,
 12121           DFHEIV99
 12122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12123
 12124
 12125     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
 12126     SET TS-INDX UP BY 1.
 12127     ADD 1                       TO TS-ITEM.
 12128     GO TO 7501-LOOP.
 12129
 12130 7585-TS-ITEMERR.
 12131     IF EIBTRNID NOT = TRANS-ID
 12132        SUBTRACT 1               FROM TS-ITEM
 12133        MOVE TS-ITEM             TO PI-TEMP-STOR-ITEMS.
 12134
 12135     GO TO 7599-EXIT.
 12136
 12137 7590-TS-QIDERR.
 12138     IF EIBTRNID = TRANS-ID
 12139        MOVE ER-0033             TO EMI-ERROR
 12140        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12141        GO TO 8200-SEND-DATAONLY.
 12142
 12143 7599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 249
* EL152.cbl
 12144      EXIT.
 12145
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 250
* EL152.cbl
 12147 7600-READ-SCREEN-TS.
 12148
 12149* EXEC CICS HANDLE CONDITION
 12150*         QIDERR     (7690-TS-QIDERR)
 12151*         ITEMERR    (7685-TS-ITEMERR)
 12152*    END-EXEC.
 12153*    MOVE '"$N<                  ! F #00011010' TO DFHEIV0
 12154     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12155     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12156     MOVE X'4620233030303131303130' TO DFHEIV0(25:11)
 12157     CALL 'kxdfhei1' USING DFHEIV0
 12158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12159
 12160
 12161     MOVE 1                      TO TS-ITEM.
 12162
 12163
 12164* EXEC CICS READQ TS
 12165*         INTO    (EL152AO)
 12166*         QUEUE   (TS-NAME-SCREEN)
 12167*         LENGTH  (TS-MAP-LENGTH)
 12168*         ITEM    (TS-ITEM)
 12169*    END-EXEC.
 12170*    MOVE '*$II   L              ''   #00011017' TO DFHEIV0
 12171     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12172     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12173     MOVE X'2020233030303131303137' TO DFHEIV0(25:11)
 12174     CALL 'kxdfhei1' USING DFHEIV0,
 12175           TS-NAME-SCREEN,
 12176           EL152AO,
 12177           TS-MAP-LENGTH,
 12178           TS-ITEM,
 12179           DFHEIV99,
 12180           DFHEIV99
 12181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12182
 12183
 12184     IF MAINTL NOT = ZEROS
 12185        MOVE AL-UANON            TO MAINTA.
 12186     IF ARCHNUML NOT = ZEROS
 12187        MOVE AL-UNNON            TO ARCHNUMA.
 12188     IF FORML NOT = ZEROS
 12189        MOVE AL-UANON            TO FORMA.
 12190     IF FOLLOWL NOT = ZEROS
 12191        MOVE AL-UANON            TO FOLLOWA.
 12192     IF RESENDL NOT = ZEROS
 12193        MOVE AL-UANON            TO RESENDA.
 12194     IF PRINTL NOT = ZEROS
 12195        MOVE AL-UANON            TO PRINTA.
 12196     IF COPIESL NOT = ZEROS
 12197        MOVE AL-UNNON            TO COPIESA.
 12198     IF ADDRL NOT = ZEROS
 12199        MOVE AL-UANON            TO ADDRA.
 12200     IF REL NOT = ZEROS
 12201        MOVE AL-UANON            TO REA.
 12202
 12203     GO TO 7699-EXIT.
 12204
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 251
* EL152.cbl
 12205 7685-TS-ITEMERR.
 12206     GO TO 7699-EXIT.
 12207
 12208 7690-TS-QIDERR.
 12209     IF EIBTRNID = TRANS-ID
 12210        MOVE ER-0033             TO EMI-ERROR
 12211        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12212        GO TO 8200-SEND-DATAONLY.
 12213
 12214 7699-EXIT.
 12215      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 252
* EL152.cbl
 12217
 12218 7700-PUT-TEMP-STOR.
 12219     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 12220     PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT.
 12221     SET TS-INDX TO 1.
 12222     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12223     PERFORM 7780-WRITE-TS THRU 7780-EXIT
 12224             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12225             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES.
 12226
 12227 7749-EXIT.
 12228      EXIT.
 12229
 12230 7750-DELETE-TEMP-STOR.
 12231
 12232* EXEC CICS HANDLE CONDITION
 12233*         QIDERR      (7750-EXIT)
 12234*    END-EXEC.
 12235*    MOVE '"$N                   ! G #00011071' TO DFHEIV0
 12236     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12238     MOVE X'4720233030303131303731' TO DFHEIV0(25:11)
 12239     CALL 'kxdfhei1' USING DFHEIV0
 12240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12241
 12242
 12243
 12244* EXEC CICS DELETEQ TS
 12245*         QUEUE       (TS-NAME-TEXT)
 12246*    END-EXEC.
 12247*    MOVE '*&                    #   #00011075' TO DFHEIV0
 12248     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12249     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12250     MOVE X'2020233030303131303735' TO DFHEIV0(25:11)
 12251     CALL 'kxdfhei1' USING DFHEIV0,
 12252           TS-NAME-TEXT,
 12253           DFHEIV99
 12254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12255
 12256
 12257 7750-EXIT.
 12258     EXIT.
 12259
 12260 7760-DELETE-TEMP-STOR-SCREEN.
 12261
 12262* EXEC CICS HANDLE CONDITION
 12263*         QIDERR     (7760-EXIT)
 12264*    END-EXEC.
 12265*    MOVE '"$N                   ! H #00011083' TO DFHEIV0
 12266     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12267     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12268     MOVE X'4820233030303131303833' TO DFHEIV0(25:11)
 12269     CALL 'kxdfhei1' USING DFHEIV0
 12270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12271
 12272
 12273
 12274* EXEC CICS DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 253
* EL152.cbl
 12275*         QUEUE      (TS-NAME-SCREEN)
 12276*    END-EXEC.
 12277*    MOVE '*&                    #   #00011087' TO DFHEIV0
 12278     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12279     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12280     MOVE X'2020233030303131303837' TO DFHEIV0(25:11)
 12281     CALL 'kxdfhei1' USING DFHEIV0,
 12282           TS-NAME-SCREEN,
 12283           DFHEIV99
 12284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12285
 12286
 12287 7760-EXIT.
 12288     EXIT.
 12289
 12290 7770-DELETE-TEMP-STOR-PI-AREA.
 12291
 12292* EXEC CICS HANDLE CONDITION
 12293*        QIDERR   (7770-EXIT)
 12294*    END-EXEC.
 12295*    MOVE '"$N                   ! I #00011095' TO DFHEIV0
 12296     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12298     MOVE X'4920233030303131303935' TO DFHEIV0(25:11)
 12299     CALL 'kxdfhei1' USING DFHEIV0
 12300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12301
 12302
 12303
 12304* EXEC CICS DELETEQ TS
 12305*        QUEUE    (WS-PI-QID)
 12306*    END-EXEC.
 12307*    MOVE '*&                    #   #00011099' TO DFHEIV0
 12308     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12309     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12310     MOVE X'2020233030303131303939' TO DFHEIV0(25:11)
 12311     CALL 'kxdfhei1' USING DFHEIV0,
 12312           WS-PI-QID,
 12313           DFHEIV99
 12314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12315
 12316
 12317 7770-EXIT.
 12318     EXIT.
 12319
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 254
* EL152.cbl
 12321 7780-WRITE-TS.
 12322     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
 12323     SET TS-INDX UP BY 1.
 12324     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 12325
 12326
 12327* EXEC CICS WRITEQ TS
 12328*         FROM    (TS-WORK-AREA)
 12329*         QUEUE   (TS-NAME-TEXT)
 12330*         LENGTH  (TS-LENGTH)
 12331*         ITEM    (PI-TEMP-STOR-ITEMS)
 12332*    END-EXEC.
 12333*    MOVE '*" I                  ''   #00011112' TO DFHEIV0
 12334     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12335     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12336     MOVE X'2020233030303131313132' TO DFHEIV0(25:11)
 12337     CALL 'kxdfhei1' USING DFHEIV0,
 12338           TS-NAME-TEXT,
 12339           TS-WORK-AREA,
 12340           TS-LENGTH,
 12341           PI-TEMP-STOR-ITEMS,
 12342           DFHEIV99,
 12343           DFHEIV99
 12344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12345
 12346
 12347 7780-EXIT.
 12348     EXIT.
 12349
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 255
* EL152.cbl
 12351 7790-WRITE-SCREEN-TS.
 12352     MOVE 1                      TO TS-ITEM.
 12353
 12354
 12355* EXEC CICS WRITEQ TS
 12356*         FROM    (EL152AI)
 12357*         QUEUE   (TS-NAME-SCREEN)
 12358*         LENGTH  (TS-MAP-LENGTH)
 12359*         ITEM    (TS-ITEM)
 12360*    END-EXEC.
 12361*    MOVE '*" I                  ''   #00011126' TO DFHEIV0
 12362     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12363     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12364     MOVE X'2020233030303131313236' TO DFHEIV0(25:11)
 12365     CALL 'kxdfhei1' USING DFHEIV0,
 12366           TS-NAME-SCREEN,
 12367           EL152AI,
 12368           TS-MAP-LENGTH,
 12369           TS-ITEM,
 12370           DFHEIV99,
 12371           DFHEIV99
 12372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12373
 12374
 12375 7790-EXIT.
 12376     EXIT.
 12377
 12378 7795-WRITE-PI-AREA-TS.
 12379
 12380* EXEC CICS WRITEQ TS
 12381*        QUEUE    (WS-PI-QID)
 12382*        FROM     (PROGRAM-INTERFACE-BLOCK)
 12383*        LENGTH   (PI-COMM-LENGTH)
 12384*    END-EXEC.
 12385*    MOVE '*"                    ''   #00011137' TO DFHEIV0
 12386     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 12387     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12388     MOVE X'2020233030303131313337' TO DFHEIV0(25:11)
 12389     CALL 'kxdfhei1' USING DFHEIV0,
 12390           WS-PI-QID,
 12391           PROGRAM-INTERFACE-BLOCK,
 12392           PI-COMM-LENGTH,
 12393           DFHEIV99,
 12394           DFHEIV99,
 12395           DFHEIV99
 12396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12397
 12398
 12399 7795-EXIT.
 12400     EXIT.
 12401
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 256
* EL152.cbl
 12403 7800-PRINT-LETTER-NOW.
 12404***************************************************************
 12405*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 12406*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 12407*        THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS,       *
 12408*        THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE,    *
 12409*        THE LETTER IS SAVED IN TEMP-STORAGE,                 *
 12410*        AND A START IS ISSUED FOR THE PRINT TRANSACTION.     *
 12411***************************************************************
 12412
 12413     PERFORM 400-SET-CODES THRU 499-EXIT.
 12414
 12415     PERFORM 7500-READ-TS        THRU 7599-EXIT
 12416     PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12417     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12418             VARYING SC-INDX FROM 1 BY 1
 12419             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12420
 12421     IF PI-TOTAL-LINES = 0
 12422        MOVE ER-0187             TO EMI-ERROR
 12423        MOVE -1                  TO MAINTL
 12424        MOVE AL-UABON            TO MAINTA
 12425        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12426        GO TO 8200-SEND-DATAONLY.
 12427
 12428     IF COPIESL NOT = ZEROS
 12429        IF COPIESI NOT NUMERIC
 12430           MOVE ER-0184          TO EMI-ERROR
 12431           MOVE -1               TO COPIESL
 12432           MOVE AL-UNBON         TO COPIESA
 12433           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12434           GO TO 8200-SEND-DATAONLY
 12435         ELSE
 12436           MOVE COPIESI          TO PI-NUM-PRINT-COPIES
 12437       ELSE
 12438        MOVE 1                   TO PI-NUM-PRINT-COPIES.
 12439
 12440*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12441*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12442*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12443*            VARYING SC-INDX FROM 1 BY 1
 12444*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12445
 12446     MOVE +0                     TO TALLY.
 12447     INSPECT RECORD-TABLE TALLYING TALLY
 12448                                 FOR CHARACTERS BEFORE '@'.
 12449
 12450     IF TALLY < +21900
 12451        COMPUTE PI-CURRENT-LINE = TALLY / 73
 12452        MOVE ZEROS               TO ROLL-COUNTER
 12453        MOVE ER-0191             TO EMI-ERROR
 12454        MOVE -1                  TO MAINTL
 12455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12456        GO TO 7900-ROLL-PAGE.
 12457
 12458 7800-UPDATE-CLAIM.
 12459
 12460     IF PI-RETURN-TO-PROGRAM = PGM-EL126
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 257
* EL152.cbl
 12461         GO TO 7800-GET-PRINTER.
 12462
 12463     MOVE PI-COMPANY-CD          TO  CLAM-CO.
 12464     MOVE PI-CARRIER             TO  CLAM-CARRIER.
 12465     MOVE PI-CLAIM-NO            TO  CLAM-CLAIM.
 12466     MOVE PI-CERT-NO             TO  CLAM-CERT-NUM.
 12467
 12468
 12469* EXEC CICS HANDLE CONDITION
 12470*        NOTOPEN   (8860-CLAM-NOT-OPEN)
 12471*        NOTFND    (7800-CLAIM-NOT-FOUND)
 12472*    END-EXEC.
 12473*    MOVE '"$JI                  ! J #00011212' TO DFHEIV0
 12474     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12475     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12476     MOVE X'4A20233030303131323132' TO DFHEIV0(25:11)
 12477     CALL 'kxdfhei1' USING DFHEIV0
 12478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12479
 12480
 12481
 12482* EXEC CICS READ
 12483*        DATASET   (CLAM-ID)
 12484*        RIDFLD    (CLAM-KEY)
 12485*        SET       (ADDRESS OF CLAIM-MASTER)
 12486*        UPDATE
 12487*    END-EXEC.
 12488*    MOVE '&"S        EU         (   #00011217' TO DFHEIV0
 12489     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12490     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12491     MOVE X'2020233030303131323137' TO DFHEIV0(25:11)
 12492     CALL 'kxdfhei1' USING DFHEIV0,
 12493           CLAM-ID,
 12494           DFHEIV20,
 12495           DFHEIV99,
 12496           CLAM-KEY,
 12497           DFHEIV99,
 12498           DFHEIV99,
 12499           DFHEIV99
 12500     SET ADDRESS OF CLAIM-MASTER TO
 12501         DFHEIV20
 12502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12503
 12504
 12505     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
 12506     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
 12507     MOVE CURRENT-SAVE           TO  CL-LAST-MAINT-DT.
 12508     MOVE '2'                    TO  CL-LAST-MAINT-TYPE.
 12509
 12510
 12511* EXEC CICS HANDLE CONDITION
 12512*        DUPKEY    (7800-GET-PRINTER)
 12513*    END-EXEC.
 12514*    MOVE '"$$                   ! K #00011229' TO DFHEIV0
 12515     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12516     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12517     MOVE X'4B20233030303131323239' TO DFHEIV0(25:11)
 12518     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 258
* EL152.cbl
 12519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12520
 12521
 12522
 12523* EXEC CICS REWRITE
 12524*        DATASET   (CLAM-ID)
 12525*        FROM      (CLAIM-MASTER)
 12526*    END-EXEC.
 12527     MOVE LENGTH OF
 12528      CLAIM-MASTER
 12529       TO DFHEIV11
 12530*    MOVE '&& L                  %   #00011233' TO DFHEIV0
 12531     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12532     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12533     MOVE X'2020233030303131323333' TO DFHEIV0(25:11)
 12534     CALL 'kxdfhei1' USING DFHEIV0,
 12535           CLAM-ID,
 12536           CLAIM-MASTER,
 12537           DFHEIV11,
 12538           DFHEIV99
 12539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12540
 12541
 12542     GO TO 7800-GET-PRINTER.
 12543
 12544 7800-CLAIM-NOT-FOUND.
 12545
 12546     MOVE ER-0133                TO  EMI-ERROR.
 12547     MOVE -1                     TO  MAINTL.
 12548     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12549     GO TO 8200-SEND-DATAONLY.
 12550
 12551 7800-GET-PRINTER.
 12552
 12553     IF PI-ALT-PRINTER-ID NOT = SPACES
 12554        GO TO 7800-CNTL-BYPASS.
 12555
 12556     MOVE '1'                    TO CNTL-RECORD-TYPE.
 12557     MOVE SPACES                 TO CNTL-GENL.
 12558     MOVE ZEROS                  TO CNTL-SEQ.
 12559
 12560
 12561* EXEC CICS HANDLE CONDITION
 12562*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 12563*         NOTFND     (7890-NOT-FOUND)
 12564*    END-EXEC.
 12565*    MOVE '"$JI                  ! L #00011256' TO DFHEIV0
 12566     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12568     MOVE X'4C20233030303131323536' TO DFHEIV0(25:11)
 12569     CALL 'kxdfhei1' USING DFHEIV0
 12570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12571
 12572
 12573
 12574* EXEC CICS READ
 12575*         DATASET    (CNTL-ID)
 12576*         SET        (ADDRESS OF CONTROL-FILE)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 259
* EL152.cbl
 12577*         RIDFLD     (CNTL-KEY)
 12578*    END-EXEC.
 12579*    MOVE '&"S        E          (   #00011261' TO DFHEIV0
 12580     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12582     MOVE X'2020233030303131323631' TO DFHEIV0(25:11)
 12583     CALL 'kxdfhei1' USING DFHEIV0,
 12584           CNTL-ID,
 12585           DFHEIV20,
 12586           DFHEIV99,
 12587           CNTL-KEY,
 12588           DFHEIV99,
 12589           DFHEIV99,
 12590           DFHEIV99
 12591     SET ADDRESS OF CONTROL-FILE TO
 12592         DFHEIV20
 12593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12594
 12595
 12596*    MOVE CF-FORMS-PRINTER-ID       TO TS-TERM-TEXT.
 12597     MOVE CF-FORMS-PRINTER-ID    TO WS-PRINTER-ID
 12598     GO TO 7800-SET-UP-TS.
 12599
 12600 7800-CNTL-BYPASS.
 12601*    MOVE PI-ALT-PRINTER-ID         TO TS-TERM-TEXT.
 12602     MOVE PI-ALT-PRINTER-ID      TO WS-PRINTER-ID.
 12603
 12604 7800-SET-UP-TS.
 12605
 12606***********************************************************
 12607*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 12608*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 12609***********************************************************
 12610
 12611     IF TS-TERM-PREFIX = 'DU'
 12612        PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT
 12613        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
 12614
 12615     SET TS-INDX TO 1.
 12616
 12617
 12618* EXEC CICS ASKTIME
 12619*    END-EXEC.
 12620*    MOVE '0"                    "   #00011288' TO DFHEIV0
 12621     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
 12622     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 12623     MOVE X'2020233030303131323838' TO DFHEIV0(25:11)
 12624     CALL 'kxdfhei1' USING DFHEIV0,
 12625           DFHEIV99
 12626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12627
 12628
 12629     MOVE EIBTIME                TO TS-ID-TIME.
 12630*    MOVE '152A'                 TO TS-ID-TEXT
 12631     MOVE TS-NAME-TEXT           TO PI-TEMP-STOR-ID.
 12632     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12633
 12634     PERFORM 7780-WRITE-TS THRU 7780-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 260
* EL152.cbl
 12635             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12636             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES
 12637
 12638     IF NOT PI-SHOW-MODE
 12639        MOVE '1'                 TO PI-PRINT-SW.
 12640
 12641
 12642* EXEC CICS HANDLE CONDITION
 12643*         TERMIDERR  (8820-TERM-ERROR)
 12644*         TRANSIDERR (8830-TRAN-ERROR)
 12645*    END-EXEC.
 12646*    MOVE '"$[\                  ! M #00011303' TO DFHEIV0
 12647     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 12648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12649     MOVE X'4D20233030303131333033' TO DFHEIV0(25:11)
 12650     CALL 'kxdfhei1' USING DFHEIV0
 12651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12652
 12653
 12654*    IF PI-COMPANY-ID = 'DMD' OR 'XXX'
 12655*        MOVE EIBTRMID    TO TS-TERM-TEXT
 12656*        EXEC CICS START
 12657*             INTERVAL    (0)
 12658*             TRANSID     (PRINT-TRANS)
 12659*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12660*             LENGTH      (PI-COMM-LENGTH)
 12661*             TERMID      (TS-TERM-TEXT)
 12662*        END-EXEC
 12663*    ELSE
 12664
 12665* EXEC CICS START
 12666*             INTERVAL    (0)
 12667*             TRANSID     (PRINT-TRANS)
 12668*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12669*             LENGTH      (PI-COMM-LENGTH)
 12670*             TERMID      (TS-TERM-TEXT)
 12671*             TERMID      (WS-PRINTER-ID)
 12672*        END-EXEC.
 12673     MOVE 0 TO DFHEIV10
 12674*    MOVE '0(ILFT                0   #00011318' TO DFHEIV0
 12675     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 12676     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
 12677     MOVE X'2020233030303131333138' TO DFHEIV0(25:11)
 12678     CALL 'kxdfhei1' USING DFHEIV0,
 12679           DFHEIV10,
 12680           PRINT-TRANS,
 12681           DFHEIV99,
 12682           PROGRAM-INTERFACE-BLOCK,
 12683           PI-COMM-LENGTH,
 12684           WS-PRINTER-ID,
 12685           DFHEIV99,
 12686           DFHEIV99,
 12687           DFHEIV99,
 12688           DFHEIV99,
 12689           DFHEIV99,
 12690           DFHEIV99,
 12691           DFHEIV99,
 12692           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 261
* EL152.cbl
 12693           DFHEIV99
 12694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12695
 12696
 12697     MOVE '104A'                 TO TS-ID-TEXT
 12698     MOVE ER-0189                TO EMI-ERROR.
 12699     MOVE -1                     TO MAINTL.
 12700     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 12701     MOVE ' PRINT TRANS STARTED ' TO EMI-MESSAGE-AREA (1)
 12702     MOVE PI-TEMP-STOR-ID TO EMI-MESSAGE-AREA (1) (25:10)
 12703
 12704     GO TO 8200-SEND-DATAONLY.
 12705
 12706 7890-NOT-FOUND.
 12707     MOVE ER-0190                TO EMI-ERROR.
 12708     MOVE -1                     TO MAINTL.
 12709     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12710     GO TO 8200-SEND-DATAONLY.
 12711
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 262
* EL152.cbl
 12713 7900-ROLL-PAGE.
 12714     IF ENTERPFL NOT = ZEROS
 12715        MOVE -1                  TO ENTERPFL
 12716       ELSE
 12717        MOVE -1                  TO MAINTL.
 12718
 12719     PERFORM 7500-READ-TS     THRU 7599-EXIT
 12720     PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12721     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12722        VARYING SC-INDX FROM 1 BY 1 UNTIL
 12723        SC-INDX > NUM-LINES-PER-SCREEN
 12724     IF PI-TOTAL-LINES = 0
 12725        MOVE ER-0047             TO EMI-ERROR
 12726        MOVE -1                  TO MAINTL
 12727        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12728        GO TO 8200-SEND-DATAONLY.
 12729
 12730     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
 12731
 12732     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12733        MOVE ER-0067             TO EMI-ERROR
 12734        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12735        MOVE 1                   TO TEMP-CURR-LINE.
 12736
 12737     IF TEMP-CURR-LINE > PI-TOTAL-LINES
 12738        MOVE ER-0066             TO EMI-ERROR
 12739        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12740        COMPUTE TEMP-CURR-LINE
 12741            = PI-TOTAL-LINES + 1 - NUM-LINES-PER-SCREEN
 12742        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12743            MOVE 1 TO TEMP-CURR-LINE.
 12744
 12745*    IF EMI-ERROR NOT = ER-0191
 12746*       PERFORM 7500-READ-TS     THRU 7599-EXIT
 12747*       PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12748*       PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12749*                VARYING SC-INDX FROM 1 BY 1 UNTIL
 12750*                SC-INDX > NUM-LINES-PER-SCREEN
 12751*    END-IF
 12752
 12753     IF EMI-ERROR = ER-0066 OR ER-0067 OR ER-0000 OR ER-0191
 12754        NEXT SENTENCE
 12755     ELSE
 12756        GO TO 8200-SEND-DATAONLY.
 12757
 12758*    PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 12759     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
 12760     SET TB-INDX                 TO PI-CURRENT-LINE.
 12761     MOVE LOW-VALUES             TO EL152RI.
 12762
 12763*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12764     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
 12765             VARYING SC-INDX FROM 1 BY 1
 12766             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12767
 12768     GO TO 8200-SEND-DATAONLY.
 12769
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 263
* EL152.cbl
 12771 7950-SET-INDX.
 12772     IF PI-CURRENT-LINE = 0
 12773        SET TB-INDX TO 1
 12774       ELSE
 12775        SET TB-INDX              TO PI-CURRENT-LINE.
 12776
 12777 7950-EXIT.
 12778      EXIT.
 12779
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 264
* EL152.cbl
 12781 7960-UPDATE-TABLE-FROM-SCREEN.
 12782     IF SC-TEXTL (SC-INDX) NOT = ZEROS
 12783        IF TB-INDX > PI-TOTAL-LINES
 12784           IF PI-TOTAL-LINES = MAX-LINES
 12785              MOVE ER-0051       TO EMI-ERROR
 12786              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12787              GO TO 8200-SEND-DATAONLY
 12788           ELSE
 12789              MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX)
 12790              ADD 1              TO PI-TOTAL-LINES
 12791        ELSE
 12792           MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX).
 12793
 12794     SET TB-INDX UP BY 1.
 12795
 12796 7960-EXIT.
 12797      EXIT.
 12798
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 265
* EL152.cbl
 12800 8000-STARTBR-ERACCT.
 12801
 12802     IF WS-ACCT-READ-SW = 'Y'
 12803         NEXT SENTENCE
 12804     ELSE
 12805
 12806* EXEC CICS GETMAIN
 12807*             SET       (ADDRESS OF ACCOUNT-MASTER)
 12808*             LENGTH    (ACCT-LENGTH)
 12809*        END-EXEC.
 12810*    MOVE '," L                  $   #00011435' TO DFHEIV0
 12811     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12812     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12813     MOVE X'2020233030303131343335' TO DFHEIV0(25:11)
 12814     CALL 'kxdfhei1' USING DFHEIV0,
 12815           DFHEIV20,
 12816           ACCT-LENGTH,
 12817           DFHEIV99
 12818     SET ADDRESS OF ACCOUNT-MASTER TO
 12819         DFHEIV20
 12820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12821
 12822
 12823
 12824* EXEC CICS STARTBR
 12825*        RIDFLD      (ACCT-KEY)
 12826*        DATASET     (ACCT-ID)
 12827*        KEYLENGTH   (20)
 12828*        GENERIC
 12829*    END-EXEC.
 12830     MOVE 20
 12831       TO DFHEIV11
 12832     MOVE 0
 12833       TO DFHEIV12
 12834*    MOVE '&,   KG    G          &   #00011440' TO DFHEIV0
 12835     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 12836     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12837     MOVE X'2020233030303131343430' TO DFHEIV0(25:11)
 12838     CALL 'kxdfhei1' USING DFHEIV0,
 12839           ACCT-ID,
 12840           ACCT-KEY,
 12841           DFHEIV11,
 12842           DFHEIV12,
 12843           DFHEIV99
 12844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12845
 12846
 12847     MOVE 'Y'         TO ACCT-BROWSE-STARTED.
 12848 8000-STARTBR-EXIT.
 12849     EXIT.
 12850
 12851 8000-READNEXT-ERACCT.
 12852
 12853
 12854* EXEC CICS READNEXT
 12855*        DATASET   (ACCT-ID)
 12856*        INTO      (ACCOUNT-MASTER)
 12857*        RIDFLD    (ACCT-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 266
* EL152.cbl
 12858*    END-EXEC.
 12859     MOVE LENGTH OF
 12860      ACCOUNT-MASTER
 12861       TO DFHEIV12
 12862     MOVE 0
 12863       TO DFHEIV11
 12864*    MOVE '&.IL                  )   #00011453' TO DFHEIV0
 12865     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12866     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12867     MOVE X'2020233030303131343533' TO DFHEIV0(25:11)
 12868     CALL 'kxdfhei1' USING DFHEIV0,
 12869           ACCT-ID,
 12870           ACCOUNT-MASTER,
 12871           DFHEIV12,
 12872           ACCT-KEY,
 12873           DFHEIV99,
 12874           DFHEIV11,
 12875           DFHEIV99,
 12876           DFHEIV99
 12877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12878
 12879
 12880 8000-READNEXT-EXIT.
 12881     EXIT.
 12882
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 267
* EL152.cbl
 12884*8050-STARTBR-EMPROD. Remove as dead code
 12885*8050-EXIT. Remove as dead code
 12886*8060-READNEXT-EMPROD. Remove as dead code
 12887*8060-EXIT. Remove as dead code
 12888
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 268
* EL152.cbl
 12890 8100-SEND-INITIAL-MAP.
 12891     PERFORM 7700-PUT-TEMP-STOR  THRU 7749-EXIT
 12892     MOVE SAVE-DATE              TO DATEAO.
 12893     MOVE EIBTIME                TO TIME-IN.
 12894     MOVE TIME-OUT               TO TIMEAO.
 12895
 12896     MOVE PI-CARRIER             TO CARRO
 12897     MOVE PI-CLAIM-NO            TO CLMNOO
 12898     MOVE PI-CERT-NO             TO CRTNOO
 12899     MOVE PI-PROCESSOR-ID        TO PROCO
 12900     MOVE PI-COMPANY-ID          TO COMPIDO
 12901     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 12902                                 TO SYSO
 12903     MOVE PI-ENCLOSURE-CD        TO ENCO
 12904     IF NOT EMI-NO-ERRORS
 12905         SET EMI-INDX TO 1
 12906         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSGO
 12907     ELSE
 12908         MOVE SPACES             TO ERRMSGO.
 12909
 12910     MOVE -1                     TO MAINTL.
 12911
 12912
 12913* EXEC CICS SEND
 12914*        MAP      (MAP-NAME)
 12915*        MAPSET   (MAPSET-NAME)
 12916*        FROM     (EL152AO)
 12917*        ERASE
 12918*        CURSOR
 12919*    END-EXEC.
 12920     MOVE LENGTH OF
 12921      EL152AO
 12922       TO DFHEIV12
 12923     MOVE -1
 12924       TO DFHEIV11
 12925*    MOVE '8$     CT  E    H L F ,   #00011491' TO DFHEIV0
 12926     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 12927     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 12928     MOVE X'2020233030303131343931' TO DFHEIV0(25:11)
 12929     CALL 'kxdfhei1' USING DFHEIV0,
 12930           MAP-NAME,
 12931           EL152AO,
 12932           DFHEIV12,
 12933           MAPSET-NAME,
 12934           DFHEIV99,
 12935           DFHEIV99,
 12936           DFHEIV99,
 12937           DFHEIV11,
 12938           DFHEIV99,
 12939           DFHEIV99,
 12940           DFHEIV99
 12941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12942
 12943
 12944     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 12945     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 12946
 12947     GO TO 9000-RETURN-TRANS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 269
* EL152.cbl
 12948*    GO TO 0200-RECEIVE.
 12949
 12950 8200-SEND-DATAONLY.
 12951     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 12952     MOVE PI-ENCLOSURE-CD        TO ENCO
 12953     MOVE SAVE-DATE              TO DATEAO.
 12954     MOVE EIBTIME                TO TIME-IN.
 12955     MOVE TIME-OUT               TO TIMEAO.
 12956     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 12957
 12958*    IF PI-COMPANY-ID = 'DMD'
 12959*       IF FORCE-7840
 12960*          MOVE '7840 FORCED' TO PFKEY9O
 12961*          MOVE AL-SABON      TO PFKEY9A.
 12962
 12963
 12964* EXEC CICS SEND
 12965*        MAP      (MAP-NAME)
 12966*        MAPSET   (MAPSET-NAME)
 12967*        FROM     (EL152AO)
 12968*        DATAONLY
 12969*        CURSOR
 12970*    END-EXEC.
 12971     MOVE LENGTH OF
 12972      EL152AO
 12973       TO DFHEIV12
 12974     MOVE -1
 12975       TO DFHEIV11
 12976*    MOVE '8$D    CT       H L F ,   #00011518' TO DFHEIV0
 12977     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 12978     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 12979     MOVE X'2020233030303131353138' TO DFHEIV0(25:11)
 12980     CALL 'kxdfhei1' USING DFHEIV0,
 12981           MAP-NAME,
 12982           EL152AO,
 12983           DFHEIV12,
 12984           MAPSET-NAME,
 12985           DFHEIV99,
 12986           DFHEIV99,
 12987           DFHEIV99,
 12988           DFHEIV11,
 12989           DFHEIV99,
 12990           DFHEIV99,
 12991           DFHEIV99
 12992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12993
 12994
 12995     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 12996     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 12997
 12998     GO TO 9000-RETURN-TRANS.
 12999*    GO TO 0200-RECEIVE.
 13000
 13001 8200-SEND-DATAONLY-ERASEAUP.
 13002     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13003     MOVE PI-ENCLOSURE-CD        TO ENCO
 13004     MOVE SAVE-DATE              TO DATEAO.
 13005     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 270
* EL152.cbl
 13006     MOVE TIME-OUT               TO TIMEAO.
 13007     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 13008
 13009* EXEC CICS SEND
 13010*        MAP      (MAP-NAME)
 13011*        MAPSET   (MAPSET-NAME)
 13012*        FROM     (EL152AO)
 13013*        DATAONLY
 13014*        ERASEAUP
 13015*        CURSOR
 13016*    END-EXEC.
 13017     MOVE LENGTH OF
 13018      EL152AO
 13019       TO DFHEIV12
 13020     MOVE -1
 13021       TO DFHEIV11
 13022*    MOVE '8$D    CT  A    H L F ,   #00011539' TO DFHEIV0
 13023     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 13024     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13025     MOVE X'2020233030303131353339' TO DFHEIV0(25:11)
 13026     CALL 'kxdfhei1' USING DFHEIV0,
 13027           MAP-NAME,
 13028           EL152AO,
 13029           DFHEIV12,
 13030           MAPSET-NAME,
 13031           DFHEIV99,
 13032           DFHEIV99,
 13033           DFHEIV99,
 13034           DFHEIV11,
 13035           DFHEIV99,
 13036           DFHEIV99,
 13037           DFHEIV99
 13038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13039
 13040
 13041     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13042     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13043
 13044     GO TO 9000-RETURN-TRANS.
 13045*    GO TO 0200-RECEIVE.
 13046
 13047 8210-ENDBR.
 13048     IF ACCT-BROWSE-STARTED = 'Y'
 13049        MOVE 'N'                  TO ACCT-BROWSE-STARTED
 13050
 13051* EXEC CICS ENDBR
 13052*            DATASET    (ACCT-ID)
 13053*       END-EXEC.
 13054     MOVE 0
 13055       TO DFHEIV11
 13056*    MOVE '&2                    $   #00011557' TO DFHEIV0
 13057     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13058     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13059     MOVE X'2020233030303131353537' TO DFHEIV0(25:11)
 13060     CALL 'kxdfhei1' USING DFHEIV0,
 13061           ACCT-ID,
 13062           DFHEIV11,
 13063           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 271
* EL152.cbl
 13064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13065
 13066
 13067 8210-EXIT.
 13068     EXIT.
 13069
 13070 8220-ENDBR-EMPROD.
 13071     IF PROD-BROWSE-STARTED = 'Y'
 13072        MOVE 'N'                  TO PROD-BROWSE-STARTED
 13073
 13074* EXEC CICS ENDBR
 13075*            DATASET    (PROD-ID)
 13076*       END-EXEC.
 13077     MOVE 0
 13078       TO DFHEIV11
 13079*    MOVE '&2                    $   #00011567' TO DFHEIV0
 13080     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13081     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13082     MOVE X'2020233030303131353637' TO DFHEIV0(25:11)
 13083     CALL 'kxdfhei1' USING DFHEIV0,
 13084           PROD-ID,
 13085           DFHEIV11,
 13086           DFHEIV99
 13087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13088
 13089
 13090 8220-EXIT.
 13091     EXIT.
 13092
 13093 8300-SEND-TEXT.
 13094
 13095* EXEC CICS SEND TEXT
 13096*        FROM    (LOGOFF-TEXT)
 13097*        LENGTH  (LOGOFF-LENGTH)
 13098*        ERASE
 13099*        FREEKB
 13100*    END-EXEC.
 13101*    MOVE '8&      T  E F  H   F -   #00011575' TO DFHEIV0
 13102     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 13103     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 13104     MOVE X'2020233030303131353735' TO DFHEIV0(25:11)
 13105     CALL 'kxdfhei1' USING DFHEIV0,
 13106           LOGOFF-TEXT,
 13107           LOGOFF-LENGTH,
 13108           DFHEIV99,
 13109           DFHEIV99,
 13110           DFHEIV99,
 13111           DFHEIV99,
 13112           DFHEIV99,
 13113           DFHEIV99,
 13114           DFHEIV99,
 13115           DFHEIV99,
 13116           DFHEIV99,
 13117           DFHEIV99
 13118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13119
 13120
 13121
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 272
* EL152.cbl
 13122* EXEC CICS RETURN
 13123*    END-EXEC.
 13124*    MOVE '.(                    &   #00011582' TO DFHEIV0
 13125     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 13126     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13127     MOVE X'2020233030303131353832' TO DFHEIV0(25:11)
 13128     CALL 'kxdfhei1' USING DFHEIV0,
 13129           DFHEIV99,
 13130           DFHEIV99,
 13131           DFHEIV99,
 13132           DFHEIV99,
 13133           DFHEIV99
 13134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13135
 13136
 13137 8600-DEEDIT.
 13138
 13139* EXEC CICS BIF DEEDIT
 13140*         FIELD    (DEEDIT-FIELD)
 13141*         LENGTH   (15)
 13142*    END-EXEC.
 13143     MOVE 15
 13144       TO DFHEIV11
 13145*    MOVE '@"L                   #   #00011586' TO DFHEIV0
 13146     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13147     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13148     MOVE X'2020233030303131353836' TO DFHEIV0(25:11)
 13149     CALL 'kxdfhei1' USING DFHEIV0,
 13150           DEEDIT-FIELD,
 13151           DFHEIV11
 13152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13153
 13154
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 273
* EL152.cbl
 13156 8800-UNAUTHORIZED-ACCESS.
 13157     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 13158     GO TO 8300-SEND-TEXT.
 13159
 13160 8810-PF23.
 13161     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13162     MOVE ZEROS                  TO PI-TOTAL-LINES.
 13163     MOVE ZEROS                  TO PI-CURRENT-LINE.
 13164     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 13165     MOVE XCTL-005               TO PGM-NAME.
 13166     GO TO 9300-XCTL.
 13167
 13168 8820-TERM-ERROR.
 13169     MOVE ER-0412                TO EMI-ERROR.
 13170     MOVE SPACES                 TO PI-PRINT-SW.
 13171     GO TO 8999-OPEN-ERROR.
 13172
 13173 8830-TRAN-ERROR.
 13174     MOVE ER-0413                TO EMI-ERROR.
 13175     MOVE SPACES                 TO PI-PRINT-SW.
 13176     GO TO 8999-OPEN-ERROR.
 13177
 13178 8840-CNTL-NOT-OPEN.
 13179     MOVE ER-0042                TO EMI-ERROR.
 13180     GO TO 8999-OPEN-ERROR.
 13181
 13182 8850-ARCH-NOT-OPEN.
 13183     MOVE ER-0332                TO EMI-ERROR.
 13184     GO TO 8999-OPEN-ERROR.
 13185
 13186 8860-CLAM-NOT-OPEN.
 13187     MOVE ER-0154                TO EMI-ERROR.
 13188     GO TO 8999-OPEN-ERROR.
 13189
 13190 8870-ACTV-NOT-OPEN.
 13191     MOVE ER-0172                TO EMI-ERROR.
 13192     GO TO 8999-OPEN-ERROR.
 13193
 13194 8880-ACCT-NOT-OPEN.
 13195     MOVE ER-0168                TO EMI-ERROR.
 13196     GO TO 8999-OPEN-ERROR.
 13197
 13198 8890-TEXT-NOT-OPEN.
 13199     MOVE ER-0013                TO EMI-ERROR.
 13200     GO TO 8999-OPEN-ERROR.
 13201
 13202 8900-CERT-NOT-OPEN.
 13203     MOVE ER-0169                TO EMI-ERROR.
 13204     GO TO 8999-OPEN-ERROR.
 13205
 13206 8910-CERT-NOT-FOUND.
 13207     MOVE ER-0206                TO EMI-ERROR.
 13208     GO TO 8999-OPEN-ERROR.
 13209
 13210 8915-PROD-NOT-OPEN.
 13211     MOVE ER-9106                TO EMI-ERROR.
 13212     GO TO 8999-OPEN-ERROR.
 13213
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 274
* EL152.cbl
 13214 8920-PLCY-NOT-OPEN.
 13215     MOVE ER-9883                TO EMI-ERROR.
 13216     GO TO 8999-OPEN-ERROR.
 13217
 13218 8925-PLAN-NOT-OPEN.
 13219     MOVE ER-9808                TO EMI-ERROR.
 13220     GO TO 8999-OPEN-ERROR.
 13221
 13222 8930-PLCY-NOT-FOUND.
 13223     MOVE ER-9483                TO EMI-ERROR.
 13224     GO TO 8999-OPEN-ERROR.
 13225
 13226 8999-OPEN-ERROR.
 13227     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13228     MOVE -1                     TO MAINTL.
 13229     GO TO 8200-SEND-DATAONLY.
 13230
 13231 9000-RETURN-TRANS.
 13232
 13233     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 13234
 13235* EXEC CICS RETURN
 13236*        TRANSID    (TRANS-ID)
 13237*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13238*        LENGTH     (PI-COMM-LENGTH)
 13239*    END-EXEC.
 13240*    MOVE '.(CT                  &   #00011670' TO DFHEIV0
 13241     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 13242     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13243     MOVE X'2020233030303131363730' TO DFHEIV0(25:11)
 13244     CALL 'kxdfhei1' USING DFHEIV0,
 13245           TRANS-ID,
 13246           PROGRAM-INTERFACE-BLOCK,
 13247           PI-COMM-LENGTH,
 13248           DFHEIV99,
 13249           DFHEIV99
 13250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13251
 13252
 13253
 13254 9000-EXIT.
 13255     EXIT.
 13256 9200-RETURN-MAIN-MENU.
 13257     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13258
 13259     MOVE ZEROS                  TO PI-TOTAL-LINES
 13260                                    PI-CURRENT-LINE.
 13261     MOVE XCTL-126               TO PGM-NAME.
 13262
 13263     GO TO 9300-XCTL.
 13264
 13265 9300-XCTL.
 13266
 13267* EXEC CICS XCTL
 13268*        PROGRAM    (PGM-NAME)
 13269*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13270*        LENGTH     (PI-COMM-LENGTH)
 13271*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 275
* EL152.cbl
 13272*    MOVE '.$C                   $   #00011689' TO DFHEIV0
 13273     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 13274     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13275     MOVE X'2020233030303131363839' TO DFHEIV0(25:11)
 13276     CALL 'kxdfhei1' USING DFHEIV0,
 13277           PGM-NAME,
 13278           PROGRAM-INTERFACE-BLOCK,
 13279           PI-COMM-LENGTH
 13280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13281
 13282
 13283 9400-CLEAR.
 13284     IF PI-CLEAR-MODE
 13285         MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
 13286         GO TO 9300-XCTL
 13287     ELSE
 13288         PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
 13289         PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
 13290         PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
 13291         MOVE SPACES             TO PI-WA
 13292                                    RECORD-TABLE
 13293                                    TS-WORK-AREA
 13294         MOVE ZEROS              TO PI-TOTAL-LINES
 13295                                    PI-CURRENT-LINE
 13296                                    PI-TEMP-STOR-ITEMS
 13297                                    PI-UPDATE-SW
 13298                                    PI-ADDR-SEQ
 13299         MOVE '2'                TO PI-ACTION
 13300         MOVE LOW-VALUES         TO EL152AO
 13301                                    PI-ADDR-TYPE
 13302         SET TS-INDX
 13303             TA1
 13304             TA2
 13305             TA21
 13306             TB-INDX
 13307             TB-INDX1
 13308             MOVE-INDX
 13309             SC-INDX             TO +1
 13310         IF GETMAIN-SWITCH = '2'
 13311             MOVE 1              TO GETMAIN-SWITCH
 13312             GO TO 8100-SEND-INITIAL-MAP
 13313         ELSE
 13314             GO TO 8100-SEND-INITIAL-MAP.
 13315
 13316 9600-PGMID-ERROR.
 13317
 13318* EXEC CICS HANDLE CONDITION
 13319*        PGMIDERR    (8300-SEND-TEXT)
 13320*    END-EXEC.
 13321*    MOVE '"$L                   ! N #00011729' TO DFHEIV0
 13322     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 13323     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13324     MOVE X'4E20233030303131373239' TO DFHEIV0(25:11)
 13325     CALL 'kxdfhei1' USING DFHEIV0
 13326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13327
 13328
 13329     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 276
* EL152.cbl
 13330     MOVE ' '                    TO PI-ENTRY-CD-1.
 13331     MOVE XCTL-005               TO PGM-NAME.
 13332     MOVE PGM-NAME               TO LOGOFF-PGM.
 13333     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 13334     GO TO 9300-XCTL.
 13335
 13336 9700-DATE-LINK.
 13337     MOVE LINK-ELDATCV           TO PGM-NAME.
 13338
 13339* EXEC CICS LINK
 13340*        PROGRAM   (PGM-NAME)
 13341*        COMMAREA  (DATE-CONVERSION-DATA)
 13342*        LENGTH    (DC-COMM-LENGTH)
 13343*    END-EXEC.
 13344*    MOVE '."C                   ''   #00011742' TO DFHEIV0
 13345     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13346     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13347     MOVE X'2020233030303131373432' TO DFHEIV0(25:11)
 13348     CALL 'kxdfhei1' USING DFHEIV0,
 13349           PGM-NAME,
 13350           DATE-CONVERSION-DATA,
 13351           DC-COMM-LENGTH,
 13352           DFHEIV99,
 13353           DFHEIV99,
 13354           DFHEIV99
 13355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13356
 13357
 13358*    IF NO-CONVERSION-ERROR
 13359*            AND
 13360*       W-REVERSE-DATE
 13361*            AND
 13362*       PI-COMPANY-ID = 'AUK'
 13363*           MOVE DC-GREG-DATE-1-EDIT TO W-EDIT-DATE-1
 13364*           MOVE W-ED1-MM            TO W-ED2-MM
 13365*           MOVE W-ED1-DD            TO W-ED2-DD
 13366*           MOVE W-ED1-YY            TO W-ED2-YY
 13367*           MOVE W-EDIT-DATE-2       TO DC-GREG-DATE-1-EDIT.
 13368
 13369 9700-EXIT.
 13370      EXIT.
 13371
 13372 9900-ERROR-FORMAT.
 13373     IF NOT EMI-ERRORS-COMPLETE
 13374         MOVE LINK-001           TO PGM-NAME
 13375
 13376* EXEC CICS LINK
 13377*            PROGRAM   (PGM-NAME)
 13378*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 13379*            LENGTH    (EMI-COMM-LENGTH)
 13380*        END-EXEC.
 13381*    MOVE '."C                   ''   #00011765' TO DFHEIV0
 13382     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13383     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13384     MOVE X'2020233030303131373635' TO DFHEIV0(25:11)
 13385     CALL 'kxdfhei1' USING DFHEIV0,
 13386           PGM-NAME,
 13387           ERROR-MESSAGE-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 277
* EL152.cbl
 13388           EMI-COMM-LENGTH,
 13389           DFHEIV99,
 13390           DFHEIV99,
 13391           DFHEIV99
 13392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13393
 13394
 13395 9900-EXIT.
 13396     EXIT.
 13397
 13398 9990-ABEND.
 13399     MOVE LINK-004               TO PGM-NAME.
 13400     MOVE DFHEIBLK               TO EMI-LINE1.
 13401
 13402* EXEC CICS LINK
 13403*        PROGRAM   (PGM-NAME)
 13404*        COMMAREA  (EMI-LINE1)
 13405*        LENGTH    (72)
 13406*    END-EXEC.
 13407     MOVE 72
 13408       TO DFHEIV11
 13409*    MOVE '."C                   ''   #00011777' TO DFHEIV0
 13410     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13411     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13412     MOVE X'2020233030303131373737' TO DFHEIV0(25:11)
 13413     CALL 'kxdfhei1' USING DFHEIV0,
 13414           PGM-NAME,
 13415           EMI-LINE1,
 13416           DFHEIV11,
 13417           DFHEIV99,
 13418           DFHEIV99,
 13419           DFHEIV99
 13420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13421
 13422
 13423     GO TO 8200-SEND-DATAONLY.
 13424
 13425 9995-SECURITY-VIOLATION.
 13426*                            COPY ELCSCTP.
 13427******************************************************************
 13428*                                                                *
 13429*                            ELCSCTP                             *
 13430*                            VMOD=2.001                          *
 13431*                                                                *
 13432*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 13433******************************************************************
 13434
 13435
 13436     MOVE EIBDATE          TO SM-JUL-DATE.
 13437     MOVE EIBTRMID         TO SM-TERMID.
 13438     MOVE THIS-PGM         TO SM-PGM.
 13439     MOVE EIBTIME          TO TIME-IN.
 13440     MOVE TIME-OUT         TO SM-TIME.
 13441     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 13442
 13443
 13444* EXEC CICS LINK
 13445*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 278
* EL152.cbl
 13446*         COMMAREA (SECURITY-MESSAGE)
 13447*         LENGTH   (80)
 13448*    END-EXEC.
 13449     MOVE 'EL003' TO DFHEIV1
 13450     MOVE 80
 13451       TO DFHEIV11
 13452*    MOVE '."C                   ''   #00011803' TO DFHEIV0
 13453     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13454     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13455     MOVE X'2020233030303131383033' TO DFHEIV0(25:11)
 13456     CALL 'kxdfhei1' USING DFHEIV0,
 13457           DFHEIV1,
 13458           SECURITY-MESSAGE,
 13459           DFHEIV11,
 13460           DFHEIV99,
 13461           DFHEIV99,
 13462           DFHEIV99
 13463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13464
 13465
 13466******************************************************************
 13467
 13468
 13469
 13470 9999-DFHBACK SECTION.
 13471     MOVE '9%                    "   ' TO DFHEIV0
 13472     MOVE 'EL152' TO DFHEIV1
 13473     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13474     GOBACK.
 13475 9999-DFHEXIT.
 13476     IF DFHEIGDJ EQUAL 0001
 13477         NEXT SENTENCE
 13478     ELSE IF DFHEIGDJ EQUAL 2
 13479         GO TO 9600-PGMID-ERROR,
 13480               0325-MAPFAIL,
 13481               9990-ABEND
 13482         DEPENDING ON DFHEIGDI
 13483     ELSE IF DFHEIGDJ EQUAL 3
 13484         GO TO 9400-CLEAR,
 13485               0100-PA,
 13486               0100-PA,
 13487               0100-PA
 13488         DEPENDING ON DFHEIGDI
 13489     ELSE IF DFHEIGDJ EQUAL 4
 13490         GO TO 0325-MAPFAIL
 13491         DEPENDING ON DFHEIGDI
 13492     ELSE IF DFHEIGDJ EQUAL 5
 13493         GO TO 590-QIDERR
 13494         DEPENDING ON DFHEIGDI
 13495     ELSE IF DFHEIGDJ EQUAL 6
 13496         GO TO 8850-ARCH-NOT-OPEN,
 13497               1020-ENDBR,
 13498               1020-ENDBR
 13499         DEPENDING ON DFHEIGDI
 13500     ELSE IF DFHEIGDJ EQUAL 7
 13501         GO TO 2120-ENDBR,
 13502               2120-ENDBR,
 13503               8890-TEXT-NOT-OPEN
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 279
* EL152.cbl
 13504         DEPENDING ON DFHEIGDI
 13505     ELSE IF DFHEIGDJ EQUAL 8
 13506         GO TO 8860-CLAM-NOT-OPEN,
 13507               3010-NOT-FOUND
 13508         DEPENDING ON DFHEIGDI
 13509     ELSE IF DFHEIGDJ EQUAL 9
 13510         GO TO 9990-ABEND
 13511         DEPENDING ON DFHEIGDI
 13512     ELSE IF DFHEIGDJ EQUAL 10
 13513         GO TO 6499-EXIT
 13514         DEPENDING ON DFHEIGDI
 13515     ELSE IF DFHEIGDJ EQUAL 11
 13516         GO TO 6599-EXIT
 13517         DEPENDING ON DFHEIGDI
 13518     ELSE IF DFHEIGDJ EQUAL 12
 13519         GO TO 8860-CLAM-NOT-OPEN,
 13520               7090-CLAIM-NOT-FOUND
 13521         DEPENDING ON DFHEIGDI
 13522     ELSE IF DFHEIGDJ EQUAL 13
 13523         GO TO 8880-ACCT-NOT-OPEN,
 13524               7080-ACCT-NOT-FOUND
 13525         DEPENDING ON DFHEIGDI
 13526     ELSE IF DFHEIGDJ EQUAL 14
 13527         GO TO 7070-ACTV-NOT-FOUND
 13528         DEPENDING ON DFHEIGDI
 13529     ELSE IF DFHEIGDJ EQUAL 15
 13530         GO TO 7070-ACTV-NOT-FOUND
 13531         DEPENDING ON DFHEIGDI
 13532     ELSE IF DFHEIGDJ EQUAL 16
 13533         GO TO 8870-ACTV-NOT-OPEN,
 13534               7070-ACTV-NOT-FOUND
 13535         DEPENDING ON DFHEIGDI
 13536     ELSE IF DFHEIGDJ EQUAL 17
 13537         GO TO 7075-CONTINUE-ACTV-ERROR
 13538         DEPENDING ON DFHEIGDI
 13539     ELSE IF DFHEIGDJ EQUAL 18
 13540         GO TO 8900-CERT-NOT-OPEN,
 13541               8910-CERT-NOT-FOUND
 13542         DEPENDING ON DFHEIGDI
 13543     ELSE IF DFHEIGDJ EQUAL 19
 13544         GO TO 8870-ACTV-NOT-OPEN,
 13545               7200-READ-LOAN-NUMBER
 13546         DEPENDING ON DFHEIGDI
 13547     ELSE IF DFHEIGDJ EQUAL 20
 13548         GO TO 8870-ACTV-NOT-OPEN,
 13549               7201-READ-BENEFICIARY
 13550         DEPENDING ON DFHEIGDI
 13551     ELSE IF DFHEIGDJ EQUAL 21
 13552         GO TO 7290-BENE-NOT-OPEN,
 13553               7205-READ-PHYSICIAN-ADDR
 13554         DEPENDING ON DFHEIGDI
 13555     ELSE IF DFHEIGDJ EQUAL 22
 13556         GO TO 8870-ACTV-NOT-OPEN,
 13557               7210-READ-EMPLOYER-ADDR
 13558         DEPENDING ON DFHEIGDI
 13559     ELSE IF DFHEIGDJ EQUAL 23
 13560         GO TO 8870-ACTV-NOT-OPEN,
 13561               7220-READ-INSURED-ADDR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 280
* EL152.cbl
 13562         DEPENDING ON DFHEIGDI
 13563     ELSE IF DFHEIGDJ EQUAL 24
 13564         GO TO 8870-ACTV-NOT-OPEN,
 13565               7225-READ-OTHER1-ADDR
 13566         DEPENDING ON DFHEIGDI
 13567     ELSE IF DFHEIGDJ EQUAL 25
 13568         GO TO 8870-ACTV-NOT-OPEN,
 13569               7230-READ-OTHER2-ADDR
 13570         DEPENDING ON DFHEIGDI
 13571     ELSE IF DFHEIGDJ EQUAL 26
 13572         GO TO 8870-ACTV-NOT-OPEN,
 13573               7240-NOT-FOUND
 13574         DEPENDING ON DFHEIGDI
 13575     ELSE IF DFHEIGDJ EQUAL 27
 13576         GO TO 8870-ACTV-NOT-OPEN,
 13577               7250-READ-ACCOUNT
 13578         DEPENDING ON DFHEIGDI
 13579     ELSE IF DFHEIGDJ EQUAL 28
 13580         GO TO 8880-ACCT-NOT-OPEN,
 13581               7251-READ-3RD-PARTY
 13582         DEPENDING ON DFHEIGDI
 13583     ELSE IF DFHEIGDJ EQUAL 29
 13584         GO TO 8870-ACTV-NOT-OPEN,
 13585               7252-READ-COMP
 13586         DEPENDING ON DFHEIGDI
 13587     ELSE IF DFHEIGDJ EQUAL 30
 13588         GO TO 7260-READ-DENIAL
 13589         DEPENDING ON DFHEIGDI
 13590     ELSE IF DFHEIGDJ EQUAL 31
 13591         GO TO 8870-ACTV-NOT-OPEN,
 13592               7265-READ-CNTL1,
 13593               7265-READ-CNTL1
 13594         DEPENDING ON DFHEIGDI
 13595     ELSE IF DFHEIGDJ EQUAL 32
 13596         GO TO 8840-CNTL-NOT-OPEN,
 13597               7266-READ-CNTL2
 13598         DEPENDING ON DFHEIGDI
 13599     ELSE IF DFHEIGDJ EQUAL 33
 13600         GO TO 8840-CNTL-NOT-OPEN,
 13601               7267-READ-CNTL4
 13602         DEPENDING ON DFHEIGDI
 13603     ELSE IF DFHEIGDJ EQUAL 34
 13604         GO TO 8840-CNTL-NOT-OPEN,
 13605               7267-READ-CNTL6
 13606         DEPENDING ON DFHEIGDI
 13607     ELSE IF DFHEIGDJ EQUAL 35
 13608         GO TO 8840-CNTL-NOT-OPEN,
 13609               7268-SET-DATE
 13610         DEPENDING ON DFHEIGDI
 13611     ELSE IF DFHEIGDJ EQUAL 36
 13612         GO TO 7290-BENE-NOT-OPEN,
 13613               7290-EXIT
 13614         DEPENDING ON DFHEIGDI
 13615     ELSE IF DFHEIGDJ EQUAL 37
 13616         GO TO 7590-TS-QIDERR,
 13617               7585-TS-ITEMERR
 13618         DEPENDING ON DFHEIGDI
 13619     ELSE IF DFHEIGDJ EQUAL 38
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 281
* EL152.cbl
 13620         GO TO 7690-TS-QIDERR,
 13621               7685-TS-ITEMERR
 13622         DEPENDING ON DFHEIGDI
 13623     ELSE IF DFHEIGDJ EQUAL 39
 13624         GO TO 7750-EXIT
 13625         DEPENDING ON DFHEIGDI
 13626     ELSE IF DFHEIGDJ EQUAL 40
 13627         GO TO 7760-EXIT
 13628         DEPENDING ON DFHEIGDI
 13629     ELSE IF DFHEIGDJ EQUAL 41
 13630         GO TO 7770-EXIT
 13631         DEPENDING ON DFHEIGDI
 13632     ELSE IF DFHEIGDJ EQUAL 42
 13633         GO TO 8860-CLAM-NOT-OPEN,
 13634               7800-CLAIM-NOT-FOUND
 13635         DEPENDING ON DFHEIGDI
 13636     ELSE IF DFHEIGDJ EQUAL 43
 13637         GO TO 7800-GET-PRINTER
 13638         DEPENDING ON DFHEIGDI
 13639     ELSE IF DFHEIGDJ EQUAL 44
 13640         GO TO 8840-CNTL-NOT-OPEN,
 13641               7890-NOT-FOUND
 13642         DEPENDING ON DFHEIGDI
 13643     ELSE IF DFHEIGDJ EQUAL 45
 13644         GO TO 8820-TERM-ERROR,
 13645               8830-TRAN-ERROR
 13646         DEPENDING ON DFHEIGDI
 13647     ELSE IF DFHEIGDJ EQUAL 46
 13648         GO TO 8300-SEND-TEXT
 13649         DEPENDING ON DFHEIGDI.
 13650     MOVE '9%                    "   ' TO DFHEIV0
 13651     MOVE 'EL152' TO DFHEIV1
 13652     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13653     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       47156     Code:       45157
